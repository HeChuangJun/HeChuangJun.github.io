{
  "version": "https://jsonfeed.org/version/1.1",
  "title": "JavaGuide",
  "home_page_url": "https://javaguide.cn/",
  "feed_url": "https://javaguide.cn/feed.json",
  "description": "ã€ŒJavaå­¦ä¹ æŒ‡åŒ— + Javaé¢è¯•æŒ‡å—ã€ä¸€ä»½æ¶µç›–å¤§éƒ¨åˆ† Java ç¨‹åºå‘˜æ‰€éœ€è¦æŒæ¡çš„æ ¸å¿ƒçŸ¥è¯†ã€‚å‡†å¤‡ Java é¢è¯•ï¼Œå¤ä¹  Java çŸ¥è¯†ç‚¹ï¼Œé¦–é€‰ JavaGuideï¼  ",
  "favicon": "https://javaguide.cn/favicon.ico",
  "items": [
    {
      "title": "CSS",
      "url": "https://javaguide.cn/frontend/css.html",
      "id": "https://javaguide.cn/frontend/css.html",
      "summary": "css 1. css(cascacing style sheet)å±‚å æ ·å¼è¡¨ 2. cssè¯­æ³• 3. å—å…ƒç´ å’Œè¡Œå†…å…ƒç´  4. é€‰æ‹©å™¨:CSSå¯»æ‰¾å®ç°æ•ˆæœçš„ç›®æ ‡å…ƒç´ çš„å·¥å…·ï¼ˆæ ¸å¿ƒï¼‰ 5. CSSçš„æ ·å¼ã€å±æ€§ï¼šå±æ€§å€¼ 6. ç›’å­æ¨¡å‹ 7. è·å–å…ƒç´ çš„ç»å¯¹ä½ç½® 8. ä½¿ç”¨div+cssçš„æ­¥éª¤æ„å»ºé¡µé¢çš„æ­¥éª¤ï¼ˆä¸ªäººçœ‹æ³•ï¼‰ 9. æµ®åŠ¨ 1. css(cascacin...",
      "content_html": "<p>css</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-csscascacing-style-sheet%E5%B1%82%E5%8F%A0%E6%A0%B7%E5%BC%8F%E8%A1%A8\">1. css(cascacing style sheet)å±‚å æ ·å¼è¡¨</a></li>\n<li><a href=\"#2-css%E8%AF%AD%E6%B3%95\">2. cssè¯­æ³•</a></li>\n<li><a href=\"#3-%E5%9D%97%E5%85%83%E7%B4%A0%E5%92%8C%E8%A1%8C%E5%86%85%E5%85%83%E7%B4%A0\">3. å—å…ƒç´ å’Œè¡Œå†…å…ƒç´ </a></li>\n<li><a href=\"#4-%E9%80%89%E6%8B%A9%E5%99%A8css%E5%AF%BB%E6%89%BE%E5%AE%9E%E7%8E%B0%E6%95%88%E6%9E%9C%E7%9A%84%E7%9B%AE%E6%A0%87%E5%85%83%E7%B4%A0%E7%9A%84%E5%B7%A5%E5%85%B7%E6%A0%B8%E5%BF%83\">4. é€‰æ‹©å™¨:CSSå¯»æ‰¾å®ç°æ•ˆæœçš„ç›®æ ‡å…ƒç´ çš„å·¥å…·ï¼ˆæ ¸å¿ƒï¼‰</a></li>\n<li><a href=\"#5-css%E7%9A%84%E6%A0%B7%E5%BC%8F%E5%B1%9E%E6%80%A7%E5%B1%9E%E6%80%A7%E5%80%BC\">5. CSSçš„æ ·å¼ã€å±æ€§ï¼šå±æ€§å€¼</a></li>\n<li><a href=\"#6-%E7%9B%92%E5%AD%90%E6%A8%A1%E5%9E%8B\">6. ç›’å­æ¨¡å‹</a></li>\n<li><a href=\"#7-%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0%E7%9A%84%E7%BB%9D%E5%AF%B9%E4%BD%8D%E7%BD%AE\">7. è·å–å…ƒç´ çš„ç»å¯¹ä½ç½®</a></li>\n<li><a href=\"#8-%E4%BD%BF%E7%94%A8divcss%E7%9A%84%E6%AD%A5%E9%AA%A4%E6%9E%84%E5%BB%BA%E9%A1%B5%E9%9D%A2%E7%9A%84%E6%AD%A5%E9%AA%A4%E4%B8%AA%E4%BA%BA%E7%9C%8B%E6%B3%95\">8. ä½¿ç”¨div+cssçš„æ­¥éª¤æ„å»ºé¡µé¢çš„æ­¥éª¤ï¼ˆä¸ªäººçœ‹æ³•ï¼‰</a></li>\n<li><a href=\"#9-%E6%B5%AE%E5%8A%A8\">9. æµ®åŠ¨</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. css(cascacing style sheet)å±‚å æ ·å¼è¡¨</h1>\n<ul>\n<li>å®ƒæ˜¯ç”¨äºæ§åˆ¶ç½‘é¡µæ ·å¼å¹¶å…è®¸å°†æ ·å¼ä¿¡æ¯ä¸ç½‘é¡µå†…å®¹åˆ†ç¦»çš„ä¸€ç§æ ‡è®°æ€§è¯­è¨€</li>\n<li>ç”¨äºè®¾ç½®HTMLé¡µé¢ä¸­çš„æ–‡æœ¬å†…å®¹ï¼ˆå­—ä½“ã€å¤§å°ã€å¯¹é½æ–¹å¼ç­‰ï¼‰ã€å›¾ç‰‡çš„å¤–å½¢ï¼ˆé«˜åº¦ã€è¾¹æ¡†æ ·å¼ã€è¾¹è·ç­‰ï¼‰ä»¥åŠç‰ˆé¢çš„å¸ƒå±€ç­‰å¤–è§‚æ˜¾ç¤ºæ ·å¼ï¼Œå°±æ˜¯ä½¿htmlé¡µé¢æ›´å¥½çœ‹ã€‚</li>\n<li>æ ·å¼ï¼šç»™HTMLæ ‡ç­¾æ·»åŠ éœ€è¦æ˜¾ç¤ºçš„æ•ˆæœï¼Œé€šå¸¸å­˜å‚¨åœ¨æ ·å¼è¡¨ä¸­</li>\n<li>å±‚å ï¼šä½¿ç”¨ä¸åŒçš„æ·»åŠ æ–¹å¼çµ¦åŒä¸€ä¸ªHTMLæ ‡ç­¾æ·»åŠ æ ·å¼ï¼Œæœ€åæ‰€æœ‰çš„æ ·å¼å åœ¨ä¸€èµ·å…±åŒä½œç”¨äºè¯¥æ ‡ç­¾</li>\n</ul>\n<h1>2. cssè¯­æ³•</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€‰æ‹©å™¨{//é€‰æ‹©å™¨åŒºåˆ†å¤§å°å†™\n\tå±æ€§1ï¼šå±æ€§å€¼;//å±æ€§å’Œå±æ€§å€¼ä¸åŒºåˆ†å¤§å°å†™ï¼Œ\n\tå±æ€§2ï¼šå±æ€§å€¼;//å¦‚æœå±æ€§å€¼ä¸­é—´ç”±å¤šä¸ªå•è¯ç»„æˆä¸”ä¸­é—´åŒ…å«ç©ºæ ¼ï¼Œåˆ™å¿…é¡»ä¸ºè¿™ä¸ªå±æ€§å€¼åŠ ä¸Šè‹±æ–‡åŒå¼•å·\n\t/*cssæ³¨é‡Š*/å¿«æ·é”®ctrl+/\n\t..\n}\n</code></pre></div><h1>3. å—å…ƒç´ å’Œè¡Œå†…å…ƒç´ </h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">åˆ†ç±»</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">div</td>\n<td style=\"text-align:center\">htmlå—çº§æ ‡ç­¾ï¼Œè¿›è¡ŒåŒºåŸŸåˆ’åˆ†ï¼Œç‹¬è‡ªå ä¸€è¡Œï¼Œåæ¥åŠ ä¸Šçš„ä¸œè¥¿åªèƒ½æ‹èµ·ä¸€è¡Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">span</td>\n<td style=\"text-align:center\">htmlæ ‡ç­¾è¡Œå†…å…ƒç´ ï¼Œé»˜è®¤æ‰€æœ‰çš„åœ¨ä¸€è¡Œï¼Œspanåé¢åŠ çš„ä¸œè¥¿å¯ä»¥å’Œå®ƒåŒä¸€è¡Œï¼Œæ— é«˜åº¦å®½åº¦</td>\n</tr>\n</tbody>\n</table>\n<h1>4. é€‰æ‹©å™¨:CSSå¯»æ‰¾å®ç°æ•ˆæœçš„ç›®æ ‡å…ƒç´ çš„å·¥å…·ï¼ˆæ ¸å¿ƒï¼‰</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">é€‰æ‹©å™¨åˆ†ç±»</th>\n<th style=\"text-align:center\">è¯­æ³•</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">idé€‰æ‹©å™¨</td>\n<td style=\"text-align:center\">#id{}</td>\n<td style=\"text-align:center\">å¯¹ä¸€ä¸ªå…ƒç´ å•ç‹¬è®¾ç½®æ ·å¼ä¸€ä¸ª id åªå¯ä»¥ä½œç”¨äºä¸€ä¸ªæ ‡ç­¾ä¸Šé¢ï¼Œä¸€ä¸ªæ ‡ç­¾ä¹Ÿåªæœ‰ä¸€ä¸ª id åã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç±»é€‰æ‹©å™¨</td>\n<td style=\"text-align:center\">.class{}</td>\n<td style=\"text-align:center\">å¯¹ä¸€ä¸ªå…ƒç´ å®šä¹‰å•ç‹¬æ ·å¼æˆ–å¯¹å¤šä¸ªå…ƒç´ è®¾ç½®ç›¸åŒçš„æ ·å¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">ç±»é€‰æ‹©å™¨ä¸idé€‰æ‹©å™¨åœ¨å‘½ååªèƒ½æ˜¯è‹±æ–‡å­—æ¯ã€æ•°å­—ã€è¿æ¥ç¬¦(-)ã€ä¸‹åˆ’çº¿(_)ï¼Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">æ•°å­—ä¸èƒ½æ‰“å¤´ã€‚(è¿æ¥ç¬¦ã€ä¸‹åˆ’çº¿æ‰“å¤´åé¢éœ€è¦è·Ÿå­—æ¯)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">ä¸€ä¸ªç±»åå¯ä½œç”¨äºå¤šä¸ªæ ‡ç­¾ä¸Šé¢ï¼Œä¸€ä¸ªæ ‡ç­¾ä¹Ÿå¯æœ‰å¤šä¸ªç±»å(å¤šä¸ªç±»åç”¨ç©ºæ ¼éš”å¼€)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å…ƒç´ é€‰æ‹©å™¨</td>\n<td style=\"text-align:center\">htmlæ ‡ç­¾å{}</td>\n<td style=\"text-align:center\">å¯¹åŒç±»å‹çš„htmlæ ‡ç­¾è®¾ç½®ç›¸åŒæ ·å¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å±‚çº§ï¼ˆåŒ…å«ï¼‰é€‰æ‹©å™¨</td>\n<td style=\"text-align:center\">çˆ¶å…ƒç´  å­å…ƒç´ </td>\n<td style=\"text-align:center\">å¦‚ï¼šdiv p</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å±æ€§é€‰æ‹©å™¨</td>\n<td style=\"text-align:center\">åŸºæœ¬é€‰æ‹©å™¨[å±æ€§=â€˜å±æ€§å€¼â€™]</td>\n<td style=\"text-align:center\">å¦‚ï¼šinput[type='text']</td>\n</tr>\n</tbody>\n</table>\n<h1>5. CSSçš„æ ·å¼ã€å±æ€§ï¼šå±æ€§å€¼</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">CSSå¸¸è§æ ·å¼</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">border</td>\n<td style=\"text-align:center\">è¾¹ç•Œ 1px solid black;  solidå®çº¿ã€noneæ— è¾¹ã€doubleåŒçº¿</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">border-top-styleã€border-right-styleã€border-bottom-styleã€border-left-style</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">width</td>\n<td style=\"text-align:center\">å®½åº¦ 10px</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">height</td>\n<td style=\"text-align:center\">é«˜åº¦ 10px</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">float</td>\n<td style=\"text-align:center\">æµ®åŠ¨ left/right/none;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">clear</td>\n<td style=\"text-align:center\">æ¸…é™¤æµ®åŠ¨ left/right/both æµ®åŠ¨ä¸å†å ç”¨åŸæ–‡æ¡£æµçš„ä½ç½®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">display</td>\n<td style=\"text-align:center\">blockå—æ ‡ç­¾ï¼Œä»¥åŒºåŸŸçš„æ–¹å¼å‡ºç°ï¼Œæ¯ä¸ªæ ‡ç­¾ç‹¬è‡ªå æ®ä¸€æ•´è¡Œæˆ–å¤šæ•´è¡Œã€‚a,span</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">inlineè¡Œå†…å…ƒç´ ï¼Œä¸å¿…å†æ–°çš„ä¸€è¡Œå¼€å§‹ï¼Œä¸å¼ºè¿«å…¶ä»–å…ƒç´ åœ¨æ–°ä¸€è¡Œæ˜¾ç¤ºhn,div,ul,olï¼Œæ— é«˜åº¦å®½åº¦</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">inline-blockå°†å¯¹è±¡å‘ˆé€’ä¸ºå†…è”å¯¹è±¡ï¼Œä½†æ˜¯å¯¹è±¡çš„å†…å®¹ä½œä¸ºå—å¯¹è±¡å‘ˆé€’</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">none,ä¸æ˜¾ç¤ºä¸å ç”¨é¡µé¢ç©ºé—´</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">margin</td>\n<td style=\"text-align:center\">å¤–è¾¹è·auto;é¡µé¢å±…ä¸­</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">margin-topã€margin-rightã€margin-bottomã€margin-left</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">padding</td>\n<td style=\"text-align:center\">å†…è¾¹è· padding:10px 0.25em 2ex 20%;æŒ‰ä¸Šå³ä¸‹å·¦çš„é¡ºåºè®¾ç½®å„è¾¹çš„å†…è¾¹è·ï¼Œå¯ä¸ºåƒç´ ç™¾åˆ†æ¯”ç­‰ä¸åŒå•ä½</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">padding-topã€padding-rightã€padding-bottomã€padding-left</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">font-style</td>\n<td style=\"text-align:center\">italic(æ–œä½“)ã€normal(æ­£å¸¸çš„);</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">font-size</td>\n<td style=\"text-align:center\">30px;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">font-family</td>\n<td style=\"text-align:center\">\"æ¥·ä½“\";</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">color</td>\n<td style=\"text-align:center\">å­—ä½“é¢œè‰²æ²¡æœ‰font-colorå±æ€§ï¼ï¼ï¼ï¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">(1)(è‹±æ–‡å•è¯)red;(2)åå…­è¿›åˆ¶æ•°å­—ï¼Œ colorï¼š#FF00FF</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">(3)rgb è¡¨ç¤ºrgb(0,0,0)ï¼Œä¸‰ä¸ªå€¼çº¢ã€ç»¿ã€è“ï¼Œæ¯ä¸ªå–å€¼éƒ½æ˜¯ 0-255 æˆ–è€…ç™¾åˆ†æ¯”</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">font-weight</td>\n<td style=\"text-align:center\">æ•°å­—(100-900 çš„æ•´ç™¾æ•°å€¼)ã€boldåŠ ç²—ï¼Œbolder æ¯”åŠ ç²—æ›´ç²—ï¼Œlighter ç»†çº¿)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">text-align</td>\n<td style=\"text-align:center\">center å†…å®¹ï¼ˆåŒ…æ‹¬å›¾ç‰‡æ–‡å­—ï¼‰å±…ä¸­</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">text-decoration</td>\n<td style=\"text-align:center\">none è¶…é“¾æ¥çš„ä¸‹åˆ’çº¿å»æ‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">background-color</td>\n<td style=\"text-align:center\">èƒŒæ™¯é¢œè‰² red</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">background-image</td>\n<td style=\"text-align:center\">èƒŒæ™¯å›¾ç‰‡ url(../aaa/bbb/love.jpg);</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Background-repeat</td>\n<td style=\"text-align:center\">æ˜¯å¦å¹³é“º repeat-X:åœ¨æ°´å¹³æ–¹å‘è¿›è¡Œå¹³é“º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Background-position</td>\n<td style=\"text-align:center\">center</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">transform</td>\n<td style=\"text-align:center\">translateX(10px);translateX(100%/-100%);å°†æ•´ä¸ªdivç§»åˆ°å½“å‰ä½ç½®çš„æœ€å³/å·¦</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">opacity</td>\n<td style=\"text-align:center\">ä¸é€æ˜åº¦opacity:1;//é»˜è®¤1ï¼Œä¸é€æ˜,é€æ˜0ï¼Œçœ‹ä¸è§</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">overflow</td>\n<td style=\"text-align:center\">overflow-x:hidden;è¶…å‡ºå¤§å°æ˜¯å¦æ˜¾ç¤ºæ»šåŠ¨æ¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">transition</td>\n<td style=\"text-align:center\">ll 0.8s ease;//æ¸å˜</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">position:absolute;</td>\n<td style=\"text-align:center\">ç”Ÿæˆç»å¯¹å®šä½çš„å…ƒç´ ï¼Œç›¸å¯¹äºstatic å®šä½ä»¥å¤–çš„ç¬¬ä¸€ä¸ªçˆ¶å…ƒç´ è¿›è¡Œå®šä½</td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å¼•å…¥CSSæ ·å¼æ–¹æ³•</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">è¡Œå†…å¼•å…¥</td>\n<td style=\"text-align:center\">&lt;div style=\"font-size: 20px;\"&gt; æ²¡æœ‰åšåˆ°ç»“æ„ä¸æ˜¾ç¤ºåˆ†ç¦»ï¼Œè€¦åˆæ€§å¤§ï¼Œå°‘ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å†…éƒ¨å¼•å…¥</td>\n<td style=\"text-align:center\">&lt;style type=\"text/css\"&gt;&lt;/style&gt;//åœ¨headæ ‡ç­¾ä¹‹é—´,æ— æ³•é‡ç”¨äºå…¶ä»–é¡µé¢</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¤–éƒ¨å¼•å…¥</td>\n<td style=\"text-align:center\">&lt;link rel=\"stylesheet\" href=\"\" type=\"text/css\"/&gt;//åœ¨headæ ‡ç­¾ä¹‹é—´,ç»“æ„ä¸æ˜¾ç¤ºåˆ†ç¦»</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ä¼˜å…ˆçº§</td>\n<td style=\"text-align:center\">ç†è®ºä¸Šï¼šè¡Œå†…&gt;å†…åµŒ&gt;é“¾æ¥ + å°±è¿‘åŸåˆ™</td>\n</tr>\n</tbody>\n</table>\n<br>\n<h1>6. ç›’å­æ¨¡å‹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b6fb687624b49e601d278.png\" alt=\"f6.png\" tabindex=\"0\"><figcaption>f6.png</figcaption></figure>\n<ul>\n<li>paddingå’Œmarginä¿®æ”¹æ³¨æ„æ€»å°ºå¯¸å˜åŒ–<br>\n|å®šä½åˆ†ç±»|è¯´æ˜|<br>\n|:-ğŸ˜ :-: |<br>\n|ç›¸å¯¹å®šä½|position: relative;left: 30px;top: 20px;è°ƒæ•´å…ƒç´ å‡ºç°åœ¨åŸä½ç½®çš„ç›¸å¯¹ä½ç½®ï¼Œå æ®ç©ºé—´|<br>\n|ç»å¯¹å®šä½|position: absolute;left: 30px;top: 20px;ä¸æ–‡æ¡£æµæ— å…³ï¼Œä¸å æ®ç©ºé—´ï¼Œç›¸å¯¹äºç¥–å…ˆå…ƒç´ å®šä½|<br>\n|æµ®åŠ¨|å‘å·¦æˆ–å‘å³ç§»åŠ¨ï¼Œç›´åˆ°å¤–è¾¹ç¼˜ç¢°åˆ°åŒ…å«æ¡†æˆ–å¦ä¸€ä¸ªæµ®åŠ¨æ¡†çš„è¾¹æ¡†ä¸ºæ­¢,ä¸åœ¨æ–‡æ¡£çš„æ™®é€šæµ|</li>\n</ul>\n<h1>7. è·å–å…ƒç´ çš„ç»å¯¹ä½ç½®</h1>\n<ul>\n<li>const Position=document.getElement.getBoundingClientRect();è¿”å›çš„æ˜¯ä¸€ä¸ªåŒ…å«ç»å¯¹ä½ç½®çš„åƒç´ å€¼Position.left,top,right,bottom</li>\n</ul>\n<h1>8. ä½¿ç”¨div+cssçš„æ­¥éª¤æ„å»ºé¡µé¢çš„æ­¥éª¤ï¼ˆä¸ªäººçœ‹æ³•ï¼‰</h1>\n<ul>\n<li>1ã€å…ˆåˆ†æç½‘é¡µç”±å¤šå°‘ä¸ªdivç»„æˆ</li>\n<li>2ã€æ ¹æ®å…·ä½“divè®¾ç½®ç›¸åº”é€‰æ‹©å™¨åŠæ ·å¼widthã€heightã€borderå¿…å†™ï¼Œæ ¹æ®F12çš„å¼€å‘äººå‘˜å·¥å…·æ¥å®Œæˆä»¥ä¸Šé—®é¢˜çš„è®¾ç½®</li>\n<li>3ã€æœ€åæ…¢æ…¢è°ƒæ•´é—´éš™ï¼Œæ³¨æ„æµ®åŠ¨çš„å¦™ç”¨ã€‚</li>\n</ul>\n<h1>9. æµ®åŠ¨</h1>\n<ul>\n<li>ç”±äºæµ®åŠ¨æ¡†ä¸åœ¨æ–‡æ¡£çš„æ™®é€šæµä¸­ï¼Œæ–‡æ¡£çš„æ™®é€šæµä¸­çš„å—æ¡†å°±åƒæµ®åŠ¨æ¡†ä¸å­˜åœ¨ä¸€æ ·</li>\n<li>æµ®åŠ¨çš„æ¡†å¯èƒ½è¦†ç›–ä¸æµ®åŠ¨ï¼ˆæ–‡æ¡£æµï¼‰æ¡†ï¼Œ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d2bc4784b896cf8e15c64.png\" alt=\"f1.png\"><br>\næµ®åŠ¨æ¡†ç¢°åˆ°æµ®åŠ¨æ¡†æŒ‰é¡ºåºæ’åˆ—ï¼Œ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b2cf0aa2a3c78765d1be9.png\" alt=\"f2.png\"><br>\nå¦‚æœåŒ…å«æ¡†å¤ªçª„ï¼Œæ— æ³•å®¹çº³æ°´å¹³æ’åˆ—çš„ä¸‰ä¸ªæµ®åŠ¨å…ƒç´ ï¼Œé‚£ä¹ˆå…¶å®ƒæµ®åŠ¨å—å‘ä¸‹ç§»åŠ¨ï¼Œç›´åˆ°æœ‰è¶³å¤Ÿçš„ç©ºé—´ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/48be5f3730a140a0f9d7c.png\" alt=\"f3.png\"><br>\nå¦‚æœæµ®åŠ¨å…ƒç´ çš„é«˜åº¦ä¸åŒï¼Œé‚£ä¹ˆå½“å®ƒä»¬å‘ä¸‹ç§»åŠ¨æ—¶å¯èƒ½è¢«å…¶å®ƒæµ®åŠ¨å…ƒç´ â€œå¡ä½â€ï¼š<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/796254cdc35b55416d035.png\" alt=\"f4.png\"><br>\næ¸…é™¤æµ®åŠ¨<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/dd3750454853e58bb7222.png\" alt=\"f5.png\"></li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/b6fb687624b49e601d278.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "å‰ç«¯"
      ]
    },
    {
      "title": "Html",
      "url": "https://javaguide.cn/frontend/html.html",
      "id": "https://javaguide.cn/frontend/html.html",
      "summary": "Html 1. Htmlä»‹ç» è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼ˆHyperText Markup Languageï¼‰ä¸æ˜¯ç¼–ç¨‹è¯­è¨€ è¶…æ–‡æœ¬æŒ‡é¡µé¢å¯ä»¥åŒ…å«å›¾ç‰‡ã€é“¾æ¥ç­‰éæ–‡å­—å†…å®¹ï¼Œæ¯”æ™®é€šæ–‡æœ¬æ›´å¼ºå¤§ æ ‡è®°å°±æ˜¯ä½¿ç”¨æ ‡ç­¾çš„æ–¹æ³•å°†éœ€è¦çš„å†…å®¹åŒ…èµ·æ¥ã€‚ä½¿ç”¨ä¸€ç»„æ ‡ç­¾å¯¹å†…å®¹è¿›è¡Œæè¿°çš„è¯­è¨€ æ ‡ç­¾ä¸åŒºåˆ†å¤§å°å†™ï¼Œå»ºè®®å°å†™ï¼Œæ‰©å±•åhtmlæˆ–htm HTMLï¼šå®ƒæ˜¯æ•´ä¸ªç½‘ç«™çš„éª¨æ¶ã€‚ CSSï¼šå®ƒæ˜¯å¯¹æ•´ä¸ªç½‘...",
      "content_html": "<p>Html</p>\n<!--more-->\n<h1>1. Htmlä»‹ç»</h1>\n<ul>\n<li>è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€ï¼ˆHyperText Markup Languageï¼‰ä¸æ˜¯ç¼–ç¨‹è¯­è¨€</li>\n<li>è¶…æ–‡æœ¬æŒ‡é¡µé¢å¯ä»¥åŒ…å«å›¾ç‰‡ã€é“¾æ¥ç­‰éæ–‡å­—å†…å®¹ï¼Œæ¯”æ™®é€šæ–‡æœ¬æ›´å¼ºå¤§</li>\n<li>æ ‡è®°å°±æ˜¯ä½¿ç”¨æ ‡ç­¾çš„æ–¹æ³•å°†éœ€è¦çš„å†…å®¹åŒ…èµ·æ¥ã€‚ä½¿ç”¨ä¸€ç»„æ ‡ç­¾å¯¹å†…å®¹è¿›è¡Œæè¿°çš„è¯­è¨€</li>\n<li>æ ‡ç­¾ä¸åŒºåˆ†å¤§å°å†™ï¼Œå»ºè®®å°å†™ï¼Œæ‰©å±•åhtmlæˆ–htm</li>\n<li>HTMLï¼šå®ƒæ˜¯æ•´ä¸ªç½‘ç«™çš„éª¨æ¶ã€‚</li>\n<li>CSSï¼šå®ƒæ˜¯å¯¹æ•´ä¸ªç½‘ç«™éª¨æ¶çš„å†…å®¹è¿›è¡Œç¾åŒ–(ä¿®é¥°)</li>\n<li>Javascriptï¼šå®ƒèƒ½å¤Ÿè®©æ•´ä¸ªé¡µé¢å…·æœ‰åŠ¨æ€æ•ˆæœã€‚</li>\n</ul>\n<h1>2. Htmlæ–‡æ¡£ç»“æ„</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;!DOCTYPE html&gt;&lt;!--html5çš„å¤´,æ¯”html4.01çš„æ–‡ä»¶å¤´ç®€æ´--&gt;\n&lt;html lang=\"zh\"&gt;&lt;!--æ ¹æ ‡ç­¾ï¼Œç”±å¤´å’Œä½“ç»„æˆ , langè¯­è¨€--&gt;\n&lt;head&gt;&lt;!--å¤´æ ‡ç­¾ï¼Œç”¨äºå¼•å…¥è„šæœ¬ã€å¯¼å…¥æ ·å¼ã€æä¾›å…ƒä¿¡æ¯ç­‰ï¼Œæµè§ˆå™¨ç«¯ä¸æ˜¾ç¤º--&gt;\n\t&lt;meta charset=\"UTF-8\"&gt;&lt;!--è®¾ç½®htmlé¡µé¢ç¼–ç --&gt;\n\t&lt;title&gt;æ˜¾ç¤ºæµè§ˆå™¨æ ‡é¢˜&lt;/title&gt;\n&lt;/head&gt;\n\t&lt;body&gt;ä½“æ ‡ç­¾ï¼Œç½‘é¡µä¸»ä½“&lt;/body&gt;\n&lt;/html&gt;\n\nvscode çš„ \"!\" å¿«æ·é”®\n</code></pre></div><h1>3. Htmlè¯­æ³•</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨é‡Š:&lt;!--æ³¨é‡Šå†…å®¹--&gt;  å¿«æ·é”®ctrl+/ï¼Œæºç å¯è§ï¼Œä¸èƒ½åµŒå¥—\n\nè¶…é“¾æ¥ï¼š&lt;a href=\"ç›®æ ‡åœ°å€url\" target=\"_blank(æ–°å¼€)/_self(æ›¿æ¢)/frameçš„nameå±æ€§\" title=\"æç¤ºæ–‡æœ¬\"&gt;è¶…é“¾æ¥&lt;/a&gt; ç›®æ ‡åœ°å€ \"2.html\" ã€\"http://www.baidu.com\" \"#p1\" é”šç‚¹ &lt;p id=\"p1\"&gt;ä¸‹é¢å†…å®¹&lt;/p&gt;\n&lt;a href=\"#\"&gt;å›åˆ°é¡¶éƒ¨&lt;/a&gt;\n\n&lt;b&gt;ç²—ä½“&lt;/b&gt;\n\n&lt;br/&gt;æ’å…¥å•ä¸ªæ¢è¡Œ\n\n&lt;div&gt;11&lt;/div&gt;\n\n&lt;!--framesetï¼ˆäº†è§£ï¼‰ --&gt;\n&lt;!--å¤šä¸ªçª—å£é¡µé¢æ•´åˆåœ¨ä¸€èµ·çš„ä¸€ä¸ªé›†åˆï¼ˆæ¡†æ¶é›†ï¼‰ï¼Œæ¯ä¸ªé¡µé¢éƒ½æ˜¯å•ç‹¬æ–‡æ¡£ï¼Œ--&gt;\n&lt;!--éœ€è¦ç”¨å­æ ‡ç­¾&lt;frame&gt;æ¥ç¡®å®šé¡µé¢çš„ä½ç½®ã€‚å¤šä¸ªframesetå¯ä»¥åµŒå¥—ä½¿ç”¨ï¼Œframesetå’Œbodyä¸èƒ½å…±å­˜--&gt;\n&lt;a href=\"right.html\" target=\"right\"&gt;&lt;/a&gt;\n&lt;frameset rows=\"20%,*/ï¼Ÿpxï¼Œ*(è¡¨ç¤ºä¸Šè¾¹å ï¼Ÿ%/ï¼Ÿåƒç´ ï¼Œä¸‹è¾¹100-ï¼Ÿ%)\"&gt;\n\t&lt;frameset cols=\"20%,*/ï¼Ÿpxï¼Œ*(å·¦è¾¹å 20%/ï¼Ÿåƒç´ ï¼Œå³è¾¹å 80%)\"&gt;\n\t&lt;frame src=\"urlç”¨äºæŒ‡å‘htmlé¡µé¢\" nonresize=â€trueâ€noresizeæ¡†æ¶åˆ†å‰²çº¿ä¸èƒ½ç§»åŠ¨/&gt;\n\t&lt;frame name=\"right(frameä¸­çš„name å±æ€§å¿…é¡»æ˜¯è¶…é“¾æ¥çš„çš„targetå±æ€§å€¼)\" /&gt;\n&lt;/frameset&gt;\n\n&lt;!--è¡¨å•æ ‡ç­¾ï¼ˆé‡è¦ï¼‰\nactionå±æ€§ï¼Œè¯·æ±‚è·¯å¾„ï¼Œç¡®å®šè¡¨å•æäº¤åˆ°æœåŠ¡å™¨çš„åœ°å€ï¼ˆè·¯å¾„ï¼‰\nmethodå±æ€§ï¼Œè¯·æ±‚æ–¹å¼ï¼Œé»˜è®¤getï¼Œæäº¤çš„æ•°æ®è¿½åŠ åœ¨è¯·æ±‚è·¯å¾„ä¸Šã€‚ä¸å®‰å…¨ã€‚\nå¦‚/1.html?username=jack&amp;password=1234.æ•°æ®æ ¼å¼k/vï¼Œè¿½åŠ ä½¿ç”¨ï¼Ÿæ‹¦æˆªï¼Œ\nä¹‹åæ¯ä¸€å¯¹æ•°æ®ä½¿ç”¨&amp;è¿æ¥ï¼Œurlé™åˆ¶æäº¤é•¿åº¦\npostå±æ€§å€¼ï¼Œæäº¤çš„æ•°æ®ä¸åœ¨è¯·æ±‚è·¯å¾„ä¸Šï¼Œä¸æ˜¾ç¤ºåœ¨åœ°å€æ ä¸Šï¼Œå®‰å…¨ï¼Œé•¿åº¦æ— é™åˆ¶\nè¡¨å•æ ‡ç­¾ï¼Œæ— æ˜¾ç¤ºï¼Œè¦æäº¤çš„æ•°æ®å¿…é¡»æ”¾åœ¨è¡¨å•æ ‡ç­¾å†…\nenctype åœ¨ post è¯·æ±‚æ—¶ï¼ŒæŒ‡å®šè¯·æ±‚ä½“çš„æ•°æ®æ ¼å¼\no application/x-www-form-urlencoded(é»˜è®¤)\no multipart/form-data\nå…¶ä¸­è¡¨å•é¡¹æä¾›å¤šç§æ”¶é›†æ•°æ®çš„æ–¹å¼\nã€‚ æœ‰ name å±æ€§çš„è¡¨å•é¡¹æ•°æ®ï¼Œæ‰ä¼šè¢«å‘é€ç»™æœåŠ¡å™¨\n--&gt;\n&lt;form action=\"#/${pageContext.request.contextPath}/è™šæ‹Ÿè·¯å¾„\" method=\"get/post\" entype=â€multipart/form-data(åŒ…å«ä¸Šä¼ æ§ä»¶) name=\"regist\"â€œâ€&gt;\n\tè¾“å…¥æ¡†:\n\t&lt;input type=\"text\" disabled name=\"a\" readonly=\"readonly(åªè¯»)\" value=\"a\" maxlength=\"5\"  placeholder=\"ç”¨æˆ·æç¤º\" /&gt;\n\t&lt;input type=\"password\" name=\"password\" required=\"requiredï¼ˆå¿…å¡«ï¼‰\"/&gt;\n\tç”Ÿæ—¥ &lt;input type=\"date\"name=\"birthday\"&gt; javaç”¨LocalDate birthdayæ¥æ”¶@DateTimeFormat(pattern =\"yyyy-MM-dd\")\n\tå•é€‰æŒ‰é’® javaç”¨String sexæ¥æ”¶\n\t&lt;input type=\"radio\" name=\"sex\" value=\"ç”·\"/&gt;ç”·\n\t&lt;input type=\"radio\" name=\"sex\" value=\"å¥³\" checked=\"checkedï¼ˆé»˜é€‰ï¼‰\"/&gt;å¥³\n\tå¤é€‰æŒ‰é’® javaç”¨Listæ¥æ”¶\n\t&lt;input type=\"checkbox\" name=\"hobby\" value=\"é’“é±¼\"/&gt;é’“é±¼\n\t&lt;input type=\"checkbox\" name=\"hobby\" value=\"a\" checked=\"checked\"/&gt;a\n\tæäº¤æŒ‰é’®ï¼š&lt;input type=\"submit\" value=\"æ³¨å†Œï¼ˆæ˜¾ç¤ºæ–‡æœ¬ï¼‰\"/&gt;\n\tæ™®é€šæŒ‰é’®ï¼š&lt;input type=\"button\" value=\"zhuce\"/&gt;\n\té‡ç½®æŒ‰é’®ï¼šï¼ˆå°†è¡¨å•æ¢å¤åˆ°é»˜è®¤å€¼ï¼‰&lt;input type=\"reset\" /&gt;\n\t&lt;!--å›¾å½¢æäº¤æŒ‰é’®é€šè¿‡srcç»™æŒ‰é’®è®¾ç½®å›¾ç‰‡image--&gt;\n\téšè—å­—æ®µ:&lt;input type=\"hidden\" name=\"id\" value=\"ï¼ˆæš—ä¸­ä¼ è¾“ä¸€äº›å‚æ•°ï¼‰\" /&gt;\n\tä¸Šä¼ æ–‡ä»¶&lt;input type=\"file(ä¸Šä¼ )\" name=\"avatar\"/&gt; åç«¯ç”¨MultipartFile avataræ¥æ”¶\n\t&lt;!--nameå±æ€§ï¼ˆå¿…å†™ï¼‰æœåŠ¡å™¨é€šè¿‡nameå±æ€§å€¼è·å¾—è¡¨å•æäº¤çš„æ•°æ®ã€è§é—»èµ·ä¹‰\n\tvalueå±æ€§:è®¾ç½®inputé»˜è®¤å€¼,submitå’Œresetä¸ºæŒ‰é’®æ˜¾ç¤ºæ•°æ®,å‘ç»™æœåŠ¡å™¨çš„å€¼--&gt;\n\tä¸‹æ‹‰æ¡†ï¼š\n\t&lt;select name=\"province\" multiple=â€multipleï¼ˆå¤šé€‰ï¼‰â€size=â€œ3ï¼ˆå¯è§é€‰é¡¹æ•°ï¼‰â€&gt;\n\t&lt;option&gt;--è¯·é€‰æ‹©--&lt;/option&gt;\n\t&lt;option value=\"åŒ—äº¬\"&gt;åŒ—äº¬&lt;/option&gt;\n\t&lt;option value=\"ä¸Šæµ·\" selected=\"selectedï¼ˆé»˜è®¤å‹¾é€‰ï¼‰\"&gt;ä¸Šæµ·&lt;/option&gt;\n\t&lt;/select&gt;\n\tæ–‡æœ¬åŸŸï¼š\n\t&lt;textarea name=\"zwjs\" cos=â€?ï¼ˆåˆ—æ•°ï¼‰â€ rows=â€?ï¼ˆè¡Œæ•°ï¼‰â€&gt;&lt;/textarea&gt;\n&lt;/form&gt;\n\n&lt;font size=\"7\"(1-7ï¼Œé»˜è®¤3ï¼Œå¤§äº7çš„æŒ‰7æ˜¾ç¤º)color=\"#FF0000(blue)\" face=â€œæ¥·ä½“â€&gt;&lt;/font&gt;\n\n&lt;h2&gt;æ ‡é¢˜æ ‡ç­¾hn 1-6ï¼Œnè¶Šå¤§ï¼Œå­—ä½“è¶Šå°ï¼Œå¤§äº6åˆ™æŒ‰6ç®—&lt;/h2&gt;åŠ ç²—åŠ é»‘æ˜¾ç¤ºï¼Œå•ç‹¬å ç”¨ä¸€è¡Œï¼Œä¸å…¶ä»–è¡Œæœ‰ä¸€å®šçš„é—´è·\n\n&lt;hr size=â€5â€ï¼ˆæ°´å¹³çº¿çš„é«˜åº¦ï¼Œå•ä½åƒç´ ï¼‰ noshade=â€noshade(æ°´å¹³çº¿æ ‡ç­¾:noshadeè¡¨ç¤ºæ²¡é˜´å½±ã€çº¯è‰²)â€/&gt;\n\n&lt;i&gt;æ–œä½“&lt;/i&gt;\n\n&lt;img src=\"å›¾ç‰‡è·¯å¾„url/#ï¼ˆä¸è·³è½¬ï¼‰\"  width=\"ï¼Ÿpx/ï¼Ÿ%\" height=\"ï¼Ÿpx\" alt=\"åŠ è½½å¤±è´¥ä¿¡æ¯\"/&gt;\n&lt;!--widthå’Œheightè®¾ç½®ç™¾åˆ†æ•°ç”¨äºå¡«å……æ»¡æ•´ä¸ªè¡¨æ ¼æˆ–è¯¥åƒç´ \nsrc:æŒ‡çš„æ˜¯å›¾ç‰‡æ˜¾ç¤ºçš„è·¯å¾„(ä½ç½®)\nç»å¯¹è·¯å¾„ï¼šE:\\Users\\Desktop\\WEB01_HTML\\èµ„æ–™\\WEB01\\image\nç›¸å¯¹è·¯å¾„ï¼š\nâ‘ åŒä¸€çº§ï¼šç›´æ¥å†™æ–‡ä»¶åç§°æˆ–è€…./æ–‡ä»¶åç§°\nâ‘¡ä¸Šä¸€çº§ï¼š../æ–‡ä»¶åç§°â‘¢ä¸‹ä¸€çº§ï¼šç›®å½•åç§°/æ–‡ä»¶åç§°--&gt;\næ–‡ä»¶åœ°å€\ndata URL\ndata:åª’ä½“ç±»å‹;base64,æ•°æ®\nobject URL\n\n&lt;video src=\"æ–‡ä»¶è·¯å¾„\" controls&gt;&lt;/video&gt;\n&lt;audio src=\"æ–‡ä»¶è·¯å¾„\" controls&gt;&lt;/audio&gt;\n\n&lt;ol start=\"4\" reversed=\"reversed(æœ‰åºåˆ—è¡¨é™åºæ’åˆ—)\" type=\"a/A/i/I/1\"&gt;\n\t&lt;li&gt;CSDN&lt;/li&gt;\n\t&lt;li&gt;ç™¾åº¦&lt;/li&gt;\n&lt;/ol&gt;\n\n&lt;p title=\"I'm a tooltip\"&gt;æ®µè½æ ‡ç­¾ï¼Œè‡ªåŠ¨åœ¨å…¶å‰ååˆ›å»ºä¸€äº›ç©ºç™½ titleå°†é¼ æ ‡æ‚¬åœåœ¨å…ƒç´ ä¸Šæ—¶ï¼Œtitle å±æ€§çš„å€¼å°†æ˜¾ç¤ºä¸ºå·¥å…·æç¤º&lt;/p&gt;\n\ntable(åŠ è½½å¤ªæ…¢ï¼Œäº†è§£)\næ–¹å¼1\n&lt;table align=\"center/right/center\" border=\"2px\" cellspacing=\"0px\" cellpadding=\"0px\" align=\"center\"\n\twidth=\"500px\" height=\"400px\" bgcolor=\"blue\"&gt;\t\t\t\n\t&lt;tr&gt;\n\t\t&lt;td colspan=\"2\"&gt;2&lt;/td&gt;//åˆ—\n\t\t&lt;td rowspan=\"2\"&gt;3&lt;/td&gt;\n\t&lt;/tr&gt;\n\t&lt;tr&gt;\n\t\t&lt;td &gt;4&lt;/td&gt;\n\t\t&lt;td &gt;5&lt;/td&gt;\n\t&lt;/tr&gt;\n&lt;/table&gt;\t\næ–¹å¼2\ntbodiesï¼Œæ‰€æœ‰çš„tbodyï¼Œtbodies[i]ï¼Œè¡¨ç¤ºç¬¬å‡ ä¸ªtbodyï¼Œrowså¤šå°‘è¡Œï¼Œrows[i],ç¬¬å‡ è¡Œã€‚lengthï¼Œé•¿åº¦\n&lt;table border=\"1px\" width=\"500px\" height=\"50px\" align=\"center\" id=\"tbl\"&gt;\n\t&lt;thead&gt;\n\t\t&lt;tr&gt;\n\t\t&lt;th&gt;ç¼–å·&lt;/th&gt;//è¡¨å¤´ï¼Œè¯¥å†…å®¹é»˜è®¤å±…ä¸­ã€åŠ ç²—\n\t\t&lt;th&gt;å§“å&lt;/th&gt;\n\t\t&lt;th&gt;å¹´é¾„&lt;/th&gt;\n\t\t&lt;/tr&gt;\n\t&lt;/thead&gt;\n\t&lt;tbody&gt;\n\t\t&lt;tr &gt;\n\t\t&lt;td&gt;1&lt;/td&gt;\n\t\t&lt;td&gt;å¼ ä¸‰&lt;/td&gt;\n\t\t&lt;td&gt;22&lt;/td&gt;\n\t\t&lt;/tr&gt;\n\t\t&lt;tr &gt;\n\t\t&lt;td&gt;2&lt;/td&gt;\n\t\t&lt;td&gt;æå››&lt;/td&gt;\n\t\t&lt;td&gt;25&lt;/td&gt;\n\t\t&lt;/tr&gt;\n\t&lt;/tbody&gt;\n&lt;/table&gt;\n\n&lt;ul type=\"square/circle/disc(æ— åºåˆ—è¡¨æ–¹å—/ç©ºå¿ƒåœ†/å®å¿ƒåœ†)\"&gt;\n\t&lt;li&gt;CSDN&lt;/li&gt;\n\t&lt;li&gt;ç™¾åº¦&lt;/li&gt;\n&lt;/ul&gt;\n\n&amp;nbspï¼›&amp;lt;\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "å‰ç«¯"
      ]
    },
    {
      "title": "javascript",
      "url": "https://javaguide.cn/frontend/javascript.html",
      "id": "https://javaguide.cn/frontend/javascript.html",
      "summary": "javaScript 1. æ¦‚å¿µ&ä½œç”¨ 2. javascriptå¼•å…¥æ–¹å¼ 3. æ•°æ®ç±»å‹ 4. typeofã€instanceofã€=== 5. javaScriptè¯­æ³• 6. BOMæµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼ˆæ•´ä¸ªHTMLé¡µé¢å†…å®¹ï¼‰ 7. javascriptæ­£åˆ™åŒ¹é… 8. è½¬æ¢æˆjqå¯¹è±¡ 9. å…¨å±€å±æ€§å’Œå‡½æ•°å¯ç”¨äºæ‰€æœ‰å†…å»ºçš„JavaScriptå¯¹è±¡ 10. ...",
      "content_html": "<p>javaScript</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E6%A6%82%E5%BF%B5%E4%BD%9C%E7%94%A8\">1. æ¦‚å¿µ&amp;ä½œç”¨</a></li>\n<li><a href=\"#2-javascript%E5%BC%95%E5%85%A5%E6%96%B9%E5%BC%8F\">2. javascriptå¼•å…¥æ–¹å¼</a></li>\n<li><a href=\"#3-%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\">3. æ•°æ®ç±»å‹</a></li>\n<li><a href=\"#4-typeofinstanceof\">4. typeofã€instanceofã€===</a></li>\n<li><a href=\"#5-javascript%E8%AF%AD%E6%B3%95\">5. javaScriptè¯­æ³•</a></li>\n<li><a href=\"#6-bom%E6%B5%8F%E8%A7%88%E5%99%A8%E5%AF%B9%E8%B1%A1%E6%A8%A1%E5%9E%8B%E6%95%B4%E4%B8%AAhtml%E9%A1%B5%E9%9D%A2%E5%86%85%E5%AE%B9\">6. BOMæµè§ˆå™¨å¯¹è±¡æ¨¡å‹ï¼ˆæ•´ä¸ªHTMLé¡µé¢å†…å®¹ï¼‰</a></li>\n<li><a href=\"#7-javascript%E6%AD%A3%E5%88%99%E5%8C%B9%E9%85%8D\">7. javascriptæ­£åˆ™åŒ¹é…</a></li>\n<li><a href=\"#8-%E8%BD%AC%E6%8D%A2%E6%88%90jq%E5%AF%B9%E8%B1%A1\">8. è½¬æ¢æˆjqå¯¹è±¡</a></li>\n<li><a href=\"#9-%E5%85%A8%E5%B1%80%E5%B1%9E%E6%80%A7%E5%92%8C%E5%87%BD%E6%95%B0%E5%8F%AF%E7%94%A8%E4%BA%8E%E6%89%80%E6%9C%89%E5%86%85%E5%BB%BA%E7%9A%84javascript%E5%AF%B9%E8%B1%A1\">9. å…¨å±€å±æ€§å’Œå‡½æ•°å¯ç”¨äºæ‰€æœ‰å†…å»ºçš„JavaScriptå¯¹è±¡</a></li>\n<li><a href=\"#10-%E4%B8%BA%E4%BB%80%E4%B9%88js%E6%98%AF%E5%8D%95%E7%BA%BF%E7%A8%8B%E7%9A%84\">10. ä¸ºä»€ä¹ˆJSæ˜¯å•çº¿ç¨‹çš„ï¼Ÿ</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. æ¦‚å¿µ&amp;ä½œç”¨</h1>\n<ul>\n<li>ç¼–ç¨‹è¯­è¨€ ç”¨äºå¼€å‘äº¤äº’å¼webé¡µé¢ï¼ˆå‘HTMLé¡µé¢æ·»åŠ äº¤äº’è¡Œä¸ºï¼‰</li>\n<li>è„šæœ¬è¯­è¨€ï¼ˆè½»é‡çº§ç¼–ç¨‹è¯­è¨€ï¼‰</li>\n<li>ä¸éœ€ç¼–è¯‘ï¼ˆè§£é‡Šæ€§è¯­è¨€ï¼‰ç›´æ¥åµŒå…¥HTMLé¡µé¢ä¸­ï¼Œç”±æµè§ˆå™¨æ‰§è¡Œ</li>\n<li>HTMLé¡µé¢ä¸­åµŒå…¥åŠ¨æ€æ–‡æœ¬ã€å¯¹æµè§ˆå™¨äº‹ä»¶å“åº”ï¼Œè¯»å†™HTMLå…ƒç´ ï¼Œ</li>\n<li>éªŒè¯æäº¤æ•°æ®ï¼Œæ£€æµ‹è®¿å®¢æ•°åŠè®¿å®¢çš„æµè§ˆä¿¡æ¯ç­‰ã€‚ä½¿é¡µé¢å…·æœ‰åŠ¨æ€æ•ˆæœ</li>\n</ul>\n<h1>2. javascriptå¼•å…¥æ–¹å¼</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">javascriptå¼•å…¥æ–¹å¼</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å†…åµŒå¼</td>\n<td style=\"text-align:center\">&lt;script type=\"text/javascript(é»˜è®¤ï¼Œå¯çœç•¥)\"&gt;javascriptä»£ç &lt;/script&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¤–è”å¼</td>\n<td style=\"text-align:center\">&lt;script type=\"text/javascript\" src=â€œ1.jsâ€ charset=â€œutf-8â€&gt;&lt;/script&gt;</td>\n</tr>\n</tbody>\n</table>\n<h1>3. æ•°æ®ç±»å‹</h1>\n<p>|åŸºæœ¬ï¼ˆå€¼ï¼‰æ•°æ®ç±»å‹|è¯´æ˜|ä¸¾ä¾‹|<br>\n|:-ğŸ˜:-ğŸ˜<br>\n|String|ä½¿ç”¨åŒå¼•å· \" æˆ–å•å¼•å· ' æ‹¬èµ·æ¥çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—ç¬¦|\"<a href=\"http://caibaojian.com\" target=\"_blank\" rel=\"noopener noreferrer\">http://caibaojian.com</a>\"ã€'å­—ç¬¦ä¸²'|<br>\n|Number|åŒ…æ‹¬æ•´æ•°å’Œæµ®ç‚¹æ•°ï¼ˆåŒ…å«å°æ•°ç‚¹çš„æ•°æˆ–ç§‘å­¦è®°æ•°æ³•çš„æ•°ï¼‰|30ã€-10ã€11.2ã€2.35e10|<br>\n|Boolean|è¡¨ç¤º true æˆ– false è¿™ä¸¤ç§çŠ¶æ€|5 == 2 å…¶è¿ç®—ç»“æœä¸º false|<br>\n|Null|å˜é‡æˆ–å†…å®¹å€¼ä¸ºç©ºï¼ˆnullï¼‰ï¼Œå¯ä»¥é€šè¿‡ç»™ä¸€ä¸ªå˜é‡èµ‹ null å€¼æ¥æ¸…é™¤å˜é‡çš„å†…å®¹|str = null|<br>\n|Undefined|å˜é‡è¢«åˆ›å»ºåï¼Œæœªç»™è¯¥å˜é‡èµ‹å€¼ï¼Œ|var str|<br>\n|å¯¹è±¡ï¼ˆå¼•ç”¨ï¼‰ç±»å‹|è¯´æ˜|ä¸¾ä¾‹|<br>\n|Array|var cars=new Array();|var cars=[\"Audi\",\"BMW\",\"Volvo\"];|<br>\n|Object|JavaScript æ“ä½œçš„å¯¹è±¡|var person={firstname:\"Bill\", lastname:\"Gates\", id:5566};|<br>\n|Function|JavaScript æ“ä½œçš„å¯¹è±¡|å¯ä»¥æ‰§è¡Œçš„ä¸€ç§ç‰¹åˆ«å¯¹è±¡|<br>\n<br></p>\n<h1>4. typeofã€instanceofã€===</h1>\n<ul>\n<li>typeofè¿”å›ç±»å‹å­—ç¬¦ä¸²\n<ul>\n<li>å¯ä»¥åˆ¤æ–­undefinedã€Numberã€stringã€booleanã€function</li>\n<li>ä¸èƒ½åˆ¤æ–­ï¼šnullä¸object</li>\n</ul>\n</li>\n<li>instanceof åˆ¤æ–­å¯¹è±¡å…·ä½“ç±»å‹</li>\n<li>=== å¯ä»¥åˆ¤æ–­null undefined<br>\nä¸¥æ ¼ç›¸ç­‰è¿ç®—ç¬¦ï¼Œç”¨ä½œé€»è¾‘åˆ¤ç­‰</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>1 == 1 // è¿”å› true\n1 === '1'// è¿”å› trueï¼Œä¼šå…ˆå°†å³ä¾§çš„å­—ç¬¦ä¸²è½¬ä¸ºæ•°å­—ï¼Œå†åšæ¯”è¾ƒ\n1 === 1 // è¿”å› falseï¼Œç±»å‹ä¸ç­‰ï¼Œç›´æ¥è¿”å› fa1se\n</code></pre></div><p>typeof æŸ¥çœ‹æŸä¸ªå€¼çš„ç±»å‹</p>\n<p>||<br>\néœ€æ±‚ï¼Œå¦‚æœå‚æ•°næ²¡æœ‰ä¼ é€’ï¼Œç»™å®ƒä¸€ä¸ªã€ç”·ã€‘</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ¨èåšæ³•\nfunction test(n='ç”·'){conso1e.1og(n);}\nä½ å¯èƒ½çš„åšæ³•\nfunction test(n){\n\tif(n === undefined){\n\t\tn='ç”·';\n\t}\n\tconso1e.1og(n);\n}\nè¿˜å¯èƒ½æ˜¯è¿™æ ·\nfunction test(n){\n\tn=(n=== undefined)?'ç”·â€™:n;\n\tconsole.1og(n);\n}\nä¸€äº›è€æ—§ä»£ç ä¸­å¯èƒ½çš„åšæ³•\nfunction test(n){\n\tn = n ||'ç”·'\n\tconsole.1og(n);\n}\nå®ƒçš„è¯­æ³•æ˜¯\nå€¼1 || å€¼2\nå¦‚æœå€¼1 æ˜¯ Truthyï¼Œè¿”å›å€¼1ï¼Œå¦‚æœå€¼1 æ˜¯ Falsy è¿”å›å€¼ 2\n\n3)??ä¸?.\néœ€æ±‚ï¼Œå¦‚æœå‚æ•° næ²¡æœ‰ä¼ é€’æˆ–æ˜¯ nullï¼Œç»™å®ƒä¸€ä¸ªã€ç”·ã€‘\nå¦‚æœç”¨ä¼ ç»ŸåŠæ³•\nfunction test(n){\n\tif(n == undefined || n=== nu11){\n\t\tn='ç”·'\n    }\n\tconsole.1og(n);\n}\nç”¨??\nfunction test(n){\n\tn = n ?? 'ç”·';\n\tconsole.1og(n);\n}\n\néœ€æ±‚ï¼Œå‡½æ•°å‚æ•°æ˜¯ä¸€ä¸ªå¯¹è±¡ï¼Œå¯èƒ½åŒ…å«æœ‰å­å±æ€§\nä¾‹å¦‚ï¼Œå‚æ•°å¯èƒ½æ˜¯\nlet stul={\n\tname :\"å¼ ä¸‰â€ï¼Œ\n\taddress:{\n\t\tcity:'åŒ—äº¬\n\t};\n}\nlet stu2 ={\n\tname:\"æå››â€\n}\nlet stu3={\nname:\"æå››\"\naddress:nu11\n}\nç°åœ¨è¦è®¿é—®å­å±æ€§(æœ‰é—®é¢˜)\nfunction test(stu){\nconsole.1og(stu.address.city)\n}\nç°åœ¨å¸Œæœ›å½“æŸä¸ªå±æ€§æ˜¯ nulish æ—¶ï¼ŒçŸ­è·¯å¹¶è¿”å› undefined\nfunction test(stu){\n\tconsole.1og(stu.address?.city)\n}\nç”¨ä¼ ç»ŸåŠæ³•\nfunction test(stu){\n\tif(stu.address ===undefined ll stu.address === nu11){\n\t\tconsole.1og(undefined);\n\t\treturn;\n    }\n\tconsole.1og(stu.address.city)\n}\n\n...\nå±•å¼€è¿ç®—ç¬¦\nä½œç”¨1:æ‰“æ•£æ•°ç»„ä¼ é€’ç»™å¤šä¸ªå‚æ•°\nlet arr = [1, 2, 3];\nfunction test(a,b,c){\n\tconsole.1og(a,b,c);\n}\ntest(arr[0],arr[1],arr[2]);// è¾“å‡º 1,2,3\nå±•å¼€è¿ç®—ç¬¦å†™æ³•\ntest(...arr);// è¾“å‡º 1,2,3\næ‰“æ•£å¯ä»¥ç†è§£ä¸ºã€å»æ‰äº†ã€‘æ•°ç»„å¤–ä¾§çš„ä¸­æ‹¬å·ï¼Œåªå‰©ä¸‹æ•°ç»„å…ƒç´ \nä½œç”¨2:å¤åˆ¶æ•°ç»„æˆ–å¯¹è±¡\næ•°ç»„\nlet arr1 = [1,2,3];\nlet arr2= [...arrl]; // å¤åˆ¶æ•°ç»„\n\næ³¨æ„:å±•å¼€è¿ç®—ç¬¦å¤åˆ¶å±äºæµ…æ‹·è´ï¼Œä¾‹å¦‚\nlet ol = {name:'å¼ ä¸‰',address: {city:ã€åŒ—äº¬'}}\nlet o2 = {...01};\n\nå¯¹è±¡\nlet objl = {name:'å¼ ä¸‰',age: 18};\nTet obj2 = {...obj1}; //å¤åˆ¶å¯¹è±¡\nä½œç”¨3:åˆå¹¶æ•°ç»„æˆ–å¯¹è±¡\nlet a1 = [1,2];\nlet a2 = [3,4];\nlet b1= [...al,...a2];// ç»“æœ[1,2,3,4]\nlet b2 = [...a2,5,...al]// ç»“æœ[3,4,5,1,2]\n\nåˆå¹¶å¯¹è±¡\nlet ol= {name:'å¼ ä¸‰'};\nTet o2 = {age:18};\nlet o3 ={name:'æå››'};\nlet nl={...ol,...02};\nlet n2 = {...03,...o2,..o1}:\nåŒååé¢è¦†ç›–å‰é¢\n\n5)[] {}\nè§£æ„èµ‹å€¼\n[]\nç”¨åœ¨å£°æ˜å˜é‡æ—¶\nlet arr = [1,2,3];\nlet [a,bï¼Œc]= arr;//ç»“æœ a=1ï¼Œb=2ï¼Œc=3\n\nç”¨åœ¨å£°æ˜å‚æ•°æ—¶\nlet arr =[1,2,3];\nfunction test([a,b,c]){\n\tconsofe.1og(a,b,c)\n}\ntest(arr) // ç»“æœ a=1ï¼Œb=2ï¼Œc=3\n\n{}\nç”¨åœ¨å£°æ˜å˜é‡æ—¶\nlet obj = {name:\"å¼ ä¸‰\",age:18};\nlet {name,age} = obj;\nç”¨åœ¨å£°æ˜å‚æ•°æ—¶\nlet obj = {name:\"å¼ ä¸‰\", age:18};\nfunction test({name, age]) {console.1og(nameï¼Œage);}\ntest(obj)\n</code></pre></div><h2>æ§åˆ¶è¯­å¥</h2>\n<p>if ...else<br>\nswitch<br>\nwhile<br>\ndo...while<br>\nfor<br>\nfor ... in â˜†</p>\n<p>for ... of â˜†</p>\n<p>try ... catchâ˜†</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>1) for in\nä¸»è¦ç”¨æ¥éå†å¯¹è±¡\nlet father = {name:'å¼ ä¸‰', age:18, study:function(){}};\nfor(const n in father){\nconsole.1og(n);\n}\nå…¶ä¸­ const nä»£è¡¨éå†å‡ºæ¥çš„å±æ€§å\næ³¨æ„1:æ–¹æ³•åä¹Ÿèƒ½è¢«éå†å‡ºæ¥(å®ƒå…¶å®ä¹Ÿç®—ä¸€ç§ç‰¹æ®Šå±æ€§)\næ³¨æ„2:éå†å­å¯¹è±¡æ—¶ï¼Œçˆ¶å¯¹è±¡çš„å±æ€§ä¼šè·Ÿç€éå†å‡ºæ¥\nTet son =object.create(father);\nson.sex =â€œç”·\"\n\nfor(const n in son){\n\tconsole.1og(n);\n}\n\næ³¨æ„3:åœ¨ for in å†…è·å–å±æ€§å€¼ï¼Œè¦ä½¿ç”¨[]è¯­æ³•ï¼Œè€Œä¸èƒ½ç”¨.è¯­æ³•\nfor(const n in son){\n\tconsole.log(n, son[n]);\n}\n\n2) for of\nä¸»è¦ç”¨æ¥éå†æ•°ç»„ï¼Œä¹Ÿå¯ä»¥æ˜¯å…¶å®ƒå¯è¿­ä»£å¯¹è±¡ï¼Œå¦‚ Mapï¼Œset ç­‰\nlet al =[1,2,3];\n\nfor(const i of al){\nconsole.1og(i);\n}\nlet a2 =[\n{name:'å¼ ä¸‰', age:18},\n{name:'æå››'ï¼Œage:20}\n{name:'ç‹äº”'ï¼Œage:22}\n];\n\nfor(const obj of a2){\nconsole.1og(obj.nameï¼Œ obj.age);\n}\nfor(const {name,age} of a2){\nconsole.1og(name, age);\n}\n\n3) try catch\nlet stu1 = {name:'å¼ ä¸‰',age:18, address: {city:'åŒ—äº¬'}};\n1et stu2 ={name:'å¼ ä¸‰',age:18};\n\nfunction test(stu){\n\ttry {\n\t\tconsole.1og(stu.address.city)\n    } catch(e){\n\t\tconsole.1og('å‡ºç°äº†å¼‚å¸¸'ï¼Œe.message)\n    } finally {\n    \tconsole.1og('fina11y');\n    }\n}\n</code></pre></div><h1>5. javaScriptè¯­æ³•</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">javaScriptç»„æˆ</th>\n<th style=\"text-align:center\">åŸºæœ¬è¯­æ³•</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ECMAScriptï¼ˆæ ¸å¿ƒï¼‰</td>\n<td style=\"text-align:center\">å˜é‡å®šä¹‰</td>\n<td style=\"text-align:center\">var å˜é‡å[=å€¼];(å¯ä»¥ä¸å£°æ˜ï¼Œç›´æ¥ä½¿ç”¨ï¼Œé»˜è®¤å€¼undefinedã€å˜é‡å­˜åœ¨ä½†æ²¡èµ‹å€¼)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">ï¼ˆå˜é‡å¼±ç±»å‹ï¼šåŒä¸€ä¸ªå˜é‡å¯ä»¥å­˜æ”¾ä¸åŒç±»å‹çš„æ•°æ®ï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å¦‚æœåœ¨å‡½æ•°çš„å†…å®¹ç”¨varå®šä¹‰ï¼Œé‚£ä¹ˆå®ƒæ˜¯ä¸€ä¸ªå±€éƒ¨å˜é‡ï¼Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å¦‚æœæ²¡æœ‰ä½¿ç”¨varå®ƒæ˜¯ä¸€ä¸ªå…¨å±€çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œæ³¨é‡Šä¸javaç›¸åŒ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">è¿ç®—ç¬¦</td>\n<td style=\"text-align:center\">jsæ¯”è¾ƒ===å…¨ç­‰ï¼Œå€¼å’Œç±»å‹ï¼Œç›¸æ¯”javaæ²¡æœ‰equalsï¼Œnullå†™æˆ\"\"</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">== å®ƒåœ¨åšæ¯”è¾ƒçš„æ—¶å€™ä¼šè¿›è¡Œè‡ªåŠ¨è½¬æ¢ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">=== å®ƒåœ¨åšæ¯”è¾ƒçš„æ—¶å€™ä¸ä¼šè¿›è¡Œè‡ªåŠ¨è½¬æ¢ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">åŸºæœ¬æ•°æ®ç±»å‹</td>\n<td style=\"text-align:center\">numberï¼ˆä»»ä½•æ•°å­—ï¼‰ã€bigint<br>number ç±»å‹æ ‡è¯†çš„æ˜¯åŒç²¾åº¦æµ®åŠ¨å°æ•°ï¼Œä¾‹å¦‚<br>10 /3;// ç»“æœ 3.3333333333333335<br>æ—¢ç„¶æ˜¯æµ®ç‚¹å°æ•°ï¼Œé‚£ä¹ˆå¯ä»¥é™¤é›¶<br>10 /0;// ç»“æœ Infinity æ­£æ— ç©·å¤§-10/0;//ç»“æœ -Infinity è´Ÿæ— ç©·å¤§<br>æµ®ç‚¹å°æ•°éƒ½æœ‰è¿ç®—ç²¾åº¦é—®é¢˜ï¼Œä¾‹å¦‚<br>2.0-1.1;//ç»“æœ 0.8999999999999999<br>å­—ç¬¦ä¸²è½¬æ•°å­—<br>parseInt(\"10\");// ç»“æœæ˜¯æ•°å­— 10<br>parseInt(\"10.5\")//ç»“æœæ˜¯æ•°å­— 10ï¼Œå»é™¤äº†å°æ•°éƒ¨åˆ†;<br>parseInt(\"10\")/3;//ç»“æœä»è§†ä¸º number æµ®ç‚¹æ•°ï¼Œå› æ­¤ç»“æœä¸º3.3333333333333335<br>parseInt(\"abc\");<br>//è½¬æ¢å¤±è´¥ï¼Œç»“æœæ˜¯ç‰¹æ®Šå€¼ NaN(Not a Number)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">stringï¼ˆâ€œâ€â€˜â€™ï¼‰<br>let s1 ='è¶…é“¾æ¥'<br>let s2 ='è¶…é“¾æ¥';<br>Tet name=;//zhang li...<br>Tet age =;// 18 20<br>let uri2=<code>/test?name=$iname}&amp;age=${age}</code> ;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">boolean Truthyã€Falsy<br>åœ¨js ä¸­ï¼Œå¹¶ä¸æ˜¯ boolean æ‰èƒ½ç”¨äºæ¡ä»¶åˆ¤æ–­ï¼Œä½ å¯ä»¥åœ¨ifè¯­å¥ä¸­ä½¿ç”¨ã€æ•°å­—ã€‘ã€å­—ç¬¦ä¸²ã€‘.. ä½œä¸ºåˆ¤æ–­æ¡ä»¶<br>è¿™æ—¶å°±æœ‰ä¸€ä¸ªè§„åˆ™ï¼Œå½“éœ€è¦æ¡ä»¶åˆ¤æ–­æ—¶ï¼Œè¿™ä¸ªå€¼è¢«å½“ä½œ true è¿˜æ˜¯falseï¼Œå½“ä½œ trueçš„å€¼å½’ç±»ä¸º truthyï¼Œå½“ä½œ false çš„å€¼å½’ç±»ä¸º falsy<br>false<br>Nullish (null, undefined)<br>0, 0n, NaN<br>\"\",\",``</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">nullï¼ˆå¯¹è±¡çš„é»˜è®¤å€¼ï¼‰å’Œundefined(å˜é‡æ— åˆå§‹åŒ–æ—¶çš„é»˜è®¤å€¼))<br>æ‰§è¡Œè¡¨è¾¾å¼æˆ–å‡½æ•°ï¼Œæ²¡æœ‰è¿”å›ç»“æœï¼Œå‡ºç° undefined<br>è®¿é—®æ•°ç»„ä¸å­˜åœ¨çš„å…ƒç´ ï¼Œè®¿é—®å¯¹è±¡ä¸å­˜åœ¨çš„å±æ€§ï¼Œå‡ºç° undefined<br>å®šä¹‰å˜é‡ï¼Œæ²¡æœ‰åˆå§‹åŒ–ï¼Œå‡ºç° undefined<br>äºŒè€…å…±åŒç‚¹<br>éƒ½æ²¡æœ‰å±æ€§ã€æ–¹æ³•<br>äºŒè€…åŒºåˆ«<br>undefined ç”±jsäº§ç”Ÿï¼Œnull ç”±ç¨‹åºå‘˜æä¾›<br>Nullish</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å¼•ç”¨æ•°æ®ç±»å‹</td>\n<td style=\"text-align:center\">Number</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">String match()æ‰¾åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªæ­£åˆ™è¡¨è¾¾å¼çš„åŒ¹é….substr(a,b)ä»èµ·å§‹ç´¢å¼•å·æå–å­—ç¬¦ä¸²ä¸­æŒ‡å®šæ•°ç›®çš„å­—ç¬¦.substring(a,b)æå–å­—ç¬¦ä¸²ä¸­ä¸¤ä¸ªæŒ‡å®šçš„ç´¢å¼•å·ä¹‹é—´çš„å­—ç¬¦ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Boolean new Boolean(value)valueä¸å†™é»˜è®¤false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Array</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Boolean</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">DateDate.getTime()è¿”å›1970å¹´1æœˆ1æ—¥è‡³ä»Šçš„æ¯«ç§’æ•°ã€è§£å†³æµè§ˆå™¨ç¼“å­˜é—®é¢˜</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Math</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">ReqExpå¯¹è±¡æ­£åˆ™è¡¨è¾¾å¼å¯¹è±¡ ReqExp.test(è¦æµ‹çš„å¯¹è±¡)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">æ™®é€šå‡½æ•°</td>\n<td style=\"text-align:center\">[window/element.onload/var å˜é‡å=]function å‡½æ•°å(å‚æ•°[=é»˜è®¤å€¼],å‚æ•°){å‡½æ•°ä½“,return è¿”å›å€¼}</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">åŒ¿åå‡½æ•°</td>\n<td style=\"text-align:center\"><code>[window/element.onload/var å˜é‡å=]</code>(function(å‚æ•°,å‚æ•°){å‡½æ•°ä½“ï¼Œreturn è¿”å›å€¼})<br>(function(a,b){return a + b;})<br>(function(a,b){return a+ b;})(1,2)<br></td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">ç®­å¤´å‡½æ•°</td>\n<td style=\"text-align:center\">(å‚æ•°)=&gt;{å‡½æ•°ä½“ returnç»“æœ}<br>å¦‚æœåªæœ‰ä¸€ä¸ªå‚æ•°ï¼Œ()å¯ä»¥çœç•¥<br>å¦‚æœå‡½æ•°ä½“å†…åªæœ‰ä¸€è¡Œä»£ç ï¼Œ{}å¯ä»¥çœç•¥document.getElementById(\"p1\").onclick=()=&gt;<br>console.1og(â€œé¼ æ ‡å•å‡»äº†...ç®­å¤´å‡½æ•°\");<br></td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">è°ƒç”¨å‡½æ•°</td>\n<td style=\"text-align:center\">å‡½æ•°å(å‚æ•°ï¼Œå‚æ•°)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">äº‹ä»¶(è°ƒç”¨å‡½æ•°)</td>\n<td style=\"text-align:center\">äº‹ä»¶=â€œ[return] å‡½æ•°å([å‚æ•°ï¼Œå‚æ•°])â€</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onload åªèƒ½å†™ä¸€æ¬¡å¹¶ä¸”æ”¾åˆ°bodyæ ‡ç­¾ä¸­</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onsubmit   å†™åœ¨formæ ‡ç­¾ä¸­ï¼Œå¿…é¡»æœ‰è¿”å›å€¼ã€‚return falseä¸æäº¤</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onclickã€ondbclick</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onblur è¡¨å•æ ¡éªŒï¼Œtextç¦»ç„¦</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onfocus è¡¨å•æ ¡éªŒï¼Œtextè·å¾—ç„¦ç‚¹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onchange äºŒçº§è”åŠ¨ã€onkeydownæœç´¢å¼•æ“</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onkeypress æœç´¢å¼•æ“</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onkeyupã€onmousdown</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onmouseupã€onmouseoveré¼ æ ‡æ‚¬ç©ºé«˜äº®é—®é¢˜</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">onmouseouté¼ æ ‡ç¦»å¼€ã€onmousemove</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">è®©æŒ‰é’®ç‚¹å‡»å¤±æ•ˆï¼šonclick=â€javascript:volid(0)â€</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">eventå¯¹è±¡</td>\n<td style=\"text-align:center\">clientX,é¼ æ ‡æŒ‡é’ˆæ°´å¹³åæ ‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">clientYé¼ æ ‡æŒ‡é’ˆå‚ç›´åæ ‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">keyCodeè¿”å›é”®ç›˜è¾“å…¥çš„ASCIIç </td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">preventDefault()é˜»æ­¢æµè§ˆå™¨é»˜è®¤è¡Œä¸º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">stopPropagation()é˜»æ­¢äº‹ä»¶ä¼ æ’­</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">BOMæµè§ˆå™¨å¯¹è±¡</td>\n<td style=\"text-align:center\">windowå¯¹è±¡</td>\n<td style=\"text-align:center\">è¡¨ç¤ºæµè§ˆå™¨ä¸­æ‰“å¼€çš„çª—å£,éƒ½æ˜¯å…¨å±€å‡½æ•°ï¼Œwindowå¯çœç•¥</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">alert(â€œæç¤ºæ¡†æç¤ºä¿¡æ¯â€);confirm(\"ç¡®è®¤æç¤ºä¿¡æ¯\");prompt(\"æç¤ºä¿¡æ¯æ¡†\");</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">var xx=setInterval(function(),millisec)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">setIntervalï¼ˆâ€œfunction()â€,æ¯«ç§’å€¼)</td>\n</tr>\n</tbody>\n</table>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/7046ecfecabe6d05a7142.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "å‰ç«¯"
      ]
    },
    {
      "title": "jQuery",
      "url": "https://javaguide.cn/frontend/jquery.html",
      "id": "https://javaguide.cn/frontend/jquery.html",
      "summary": "jQuery 1. jquery(é‡ç‚¹) 2. jsdomä¸jqå¯¹è±¡äº’æ¢ 3. å‡½æ•° 4. é€‰æ‹©å™¨ï¼šè·å–å…ƒç´  5. jqueryçš„Domæ“ä½œ 6. apache POIæŠ€æœ¯ 1. jquery(é‡ç‚¹) 2. jsdomä¸jqå¯¹è±¡äº’æ¢ 3. å‡½æ•° 4. é€‰æ‹©å™¨ï¼šè·å–å…ƒç´  5. jqueryçš„Domæ“ä½œ 6. apache POIæŠ€æœ¯",
      "content_html": "<p>jQuery</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-jquery%E9%87%8D%E7%82%B9\">1. jquery(é‡ç‚¹)</a></li>\n<li><a href=\"#2-jsdom%E4%B8%8Ejq%E5%AF%B9%E8%B1%A1%E4%BA%92%E6%8D%A2\">2. jsdomä¸jqå¯¹è±¡äº’æ¢</a></li>\n<li><a href=\"#3-%E5%87%BD%E6%95%B0\">3. å‡½æ•°</a></li>\n<li><a href=\"#4-%E9%80%89%E6%8B%A9%E5%99%A8%E8%8E%B7%E5%8F%96%E5%85%83%E7%B4%A0\">4. é€‰æ‹©å™¨ï¼šè·å–å…ƒç´ </a></li>\n<li><a href=\"#5-jquery%E7%9A%84dom%E6%93%8D%E4%BD%9C\">5. jqueryçš„Domæ“ä½œ</a></li>\n<li><a href=\"#6-apache-poi%E6%8A%80%E6%9C%AF\">6. apache POIæŠ€æœ¯</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. jquery(é‡ç‚¹)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>javascriptçš„ä¸€ä¸ªè½»é‡çº§æ¡†æ¶ï¼Œå¯¹javascriptè¿›è¡Œå°è£…ï¼Œæä¾›ç®€ä¾¿é€‰æ‹©å™¨å’Œæ–¹æ³•ã€‚\nâ‘ Jqueryå®ƒæ˜¯ä¸€ä¸ªåº“(æ¡†æ¶)ï¼Œè¦æƒ³ä½¿ç”¨å®ƒï¼Œå¿…é¡»å…ˆå¼•å…¥ï¼\n&lt;script type=\"text/javascript\" src=\"../../js/jquery-1.8.3.js\" &gt;\n&lt;/script&gt;\nâ‘¡åœ¨&lt;scrpit&gt;&lt;/script&gt;ä¹‹é—´å†™jqueryä»£ç ,ç”¨æ³•jQuery(é€‰æ‹©å™¨)==$(é€‰æ‹©å™¨)\nå˜é‡å°½é‡$å¼€å¤´ï¼Œ//å•è¡Œæ³¨é‡Š   /*å¤šè¡Œæ³¨é‡Š*/\n</code></pre></div><h1>2. jsdomä¸jqå¯¹è±¡äº’æ¢</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>jsdomå¯¹è±¡â†’jqueryå¯¹è±¡ï¼š$(domå¯¹è±¡)æˆ–jQuery(domå¯¹è±¡)\njqueryå¯¹è±¡â†’jsdomå¯¹è±¡ï¼šjqueryå¯¹è±¡[ç´¢å¼•]ã€\njqueryå¯¹è±¡.get(ç´¢å¼•)å…¶ä¸­ç´¢å¼•ä¸ºåŒ¹é…åˆ°çš„jqå¯¹è±¡ï¼Œä¸€èˆ¬ä¸º0\njså’Œjqå¯¹è±¡çš„apiä¸èƒ½ç›¸äº’è°ƒç”¨ \n</code></pre></div><h1>3. å‡½æ•°</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>jsï¼šwindow.onload=function(){}åªèµ‹å€¼ä¸€æ¬¡ï¼Œè¦†ç›–ï¼ŒåŠ è½½æ…¢(æ•´ä¸ªé¡µé¢åŠ è½½å®Œæ¯•æ—¶æ‰§è¡Œ&lt;åŒ…æ‹¬å›¾ç‰‡&gt;)\njq:$(document).ready(function(){});å¤šæ¬¡èµ‹å€¼ï¼Œä¾æ¬¡æ‰§è¡Œå¿«ï¼\n(æ•´ä¸ªdomæ ‘ç»“æ„ç»˜åˆ¶å®Œæ¯•&lt;domæ ‘å›¾ç‰‡å¯èƒ½æ²¡åŠ è½½å®Œ&gt;åŠ è½½)ç®€å†™$(function(){});\n\njqé€‰æ‹©å™¨å¯¹è±¡.äº‹ä»¶=function(){});\njqé€‰æ‹©å™¨å¯¹è±¡.äº‹ä»¶(function(){})\nå¯ä»¥ç”¨thisä»£è¡¨å½“å‰çš„jqå¯¹è±¡\n</code></pre></div><h1>4. é€‰æ‹©å™¨ï¼šè·å–å…ƒç´ </h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åŸºæœ¬é€‰æ‹©å™¨\nidé€‰æ‹©å™¨$(\"#id\")\nç±»é€‰æ‹©å™¨$(\".class\")\nå…ƒç´ é€‰æ‹©å™¨$(\"å…ƒç´ \")\n$(\"*\")\n$(\"å…ƒç´ ï¼Œå…ƒç´ \") é€‰æ‹©ä¸¤ä¸ªæ ·å¼éƒ½æœ‰çš„å…ƒç´ \n\nå±‚çº§é€‰æ‹©å™¨\n$(\"çˆ¶å…ƒç´ é€‰æ‹©å™¨   å­å…ƒç´ é€‰æ‹©å™¨\")é€‰æ‹©çˆ¶å…ƒç´ ä¸­æ‰€æœ‰çš„å­å…ƒç´ \n$(\"çˆ¶å…ƒç´ é€‰æ‹©å™¨&gt;å­å…ƒç´ é€‰æ‹©å™¨\")é€‰æ‹©çˆ¶å…ƒç´ ä¸­çš„æ‰€æœ‰ç¬¬ä¸€çº§å­å…ƒç´ \n$(\"çˆ¶å…ƒç´ é€‰æ‹©å™¨+å­å…ƒç´ é€‰æ‹©å™¨\")é€‰æ‹©çˆ¶å…ƒç´ åé¢çš„æ‰€æœ‰å­å…ƒç´ \n$(\"çˆ¶å…ƒç´ é€‰æ‹©å™¨~å­å…ƒç´ é€‰æ‹©å™¨\")é€‰æ‹©çˆ¶å…ƒç´ çš„æ‰€æœ‰åŒçº§å…„å¼Ÿå…ƒç´ \n\nå±æ€§é€‰æ‹©å™¨\nåŸºæœ¬é€‰æ‹©å™¨[å±æ€§å=â€˜å±æ€§å€¼â€™]\nåŸºæœ¬é€‰æ‹©å™¨[å±æ€§å]\nåŸºæœ¬é€‰æ‹©å™¨[å±æ€§å!='å±æ€§å€¼']\nåŸºæœ¬é€‰æ‹©å™¨[å±æ€§å^='å±æ€§å€¼']å¼€å¤´\nåŸºæœ¬é€‰æ‹©å™¨[å±æ€§å$='å±æ€§å€¼']ç»“å°¾\nåŸºæœ¬é€‰æ‹©å™¨[å±æ€§å*='å±æ€§å€¼']\n\nè¡¨å•å±æ€§è¿‡æ»¤é€‰æ‹©å™¨\n$(\"select option:selected\")\n$(\"input:checked\")\n$(\":text\")\n\nåŸºæœ¬è¿‡æ»¤é€‰æ‹©å™¨ï¼ˆå¸¸ç”¨ï¼‰\n:first\nå¦™ç”¨</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "å‰ç«¯"
      ]
    },
    {
      "title": "è®¡ç®—æœºç½‘ç»œ",
      "url": "https://javaguide.cn/interview/computernetwork.html",
      "id": "https://javaguide.cn/interview/computernetwork.html",
      "summary": "1. TCPä¸‰æ¬¡æ¡æ‰‹åŸå›  [TCP](è®¡ç®—æœºç½‘ç»œ.md/#53-ä¼ è¾“æ§åˆ¶åè®®tcptransmission-control-protocol)",
      "content_html": "<!-- more -->\n<h1>1. TCPä¸‰æ¬¡æ¡æ‰‹åŸå› </h1>\n<p><code>[TCP](è®¡ç®—æœºç½‘ç»œ.md/#53-ä¼ è¾“æ§åˆ¶åè®®tcptransmission-control-protocol)</code></p>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "åˆ†åº“åˆ†è¡¨",
      "url": "https://javaguide.cn/interview/databasesharding.html",
      "id": "https://javaguide.cn/interview/databasesharding.html",
      "summary": "1. ä¸ºä»€ä¹ˆè¦åˆ†åº“ï¼Ÿä¸ºä»€ä¹ˆè¦åˆ†è¡¨ï¼Ÿ ä¸šåŠ¡é‡å‰§å¢ï¼Œç£ç›˜å®¹é‡ä¸è¶³ï¼Œå¹¶å‘è¿æ¥æ•°ä¸è¶³ï¼Œæ‰€ä»¥è¦åˆ†åº“ <<é˜¿é‡Œå¼€å‘æ‰‹å†Œ>>å•è¡¨è¡Œæ•°è¶…è¿‡500ä¸‡è¡Œæˆ–è€…å•è¡¨å®¹é‡è¶…è¿‡2GBã€‚å­˜å‚¨å’ŒæŸ¥è¯¢çš„æ€§èƒ½å°±ä¼šé‡åˆ°ç“¶é¢ˆäº† 2. ä»€ä¹ˆæ˜¯åˆ†åº“åˆ†è¡¨ï¼Ÿ æ•°æ®åˆ†ç‰‡ï¼ŒæŒ‡æŒ‰ç…§æŸä¸ªç»´åº¦å°†å­˜æ”¾åœ¨å•ä¸€æ•°æ®åº“ä¸­çš„æ•°æ®åˆ†æ•£åœ°å­˜æ”¾è‡³å¤šä¸ªæ•°æ®åº“æˆ–è¡¨ä¸­ä»¥è¾¾åˆ°æå‡æ€§èƒ½ç“¶é¢ˆä»¥åŠå¯ç”¨æ€§çš„æ•ˆæœã€‚æ•°æ®åˆ†ç‰‡çš„æœ‰æ•ˆæ‰‹æ®µæ˜¯å¯¹å…³ç³»å‹...",
      "content_html": "<!-- more -->\n<h1>1. ä¸ºä»€ä¹ˆè¦åˆ†åº“ï¼Ÿä¸ºä»€ä¹ˆè¦åˆ†è¡¨ï¼Ÿ</h1>\n<ul>\n<li>ä¸šåŠ¡é‡å‰§å¢ï¼Œç£ç›˜å®¹é‡ä¸è¶³ï¼Œå¹¶å‘è¿æ¥æ•°ä¸è¶³ï¼Œæ‰€ä»¥è¦åˆ†åº“</li>\n<li>&lt;&lt;é˜¿é‡Œå¼€å‘æ‰‹å†Œ&gt;&gt;å•è¡¨è¡Œæ•°è¶…è¿‡500ä¸‡è¡Œæˆ–è€…å•è¡¨å®¹é‡è¶…è¿‡2GBã€‚å­˜å‚¨å’ŒæŸ¥è¯¢çš„æ€§èƒ½å°±ä¼šé‡åˆ°ç“¶é¢ˆäº†</li>\n</ul>\n<h1>2. ä»€ä¹ˆæ˜¯åˆ†åº“åˆ†è¡¨ï¼Ÿ</h1>\n<ul>\n<li>æ•°æ®åˆ†ç‰‡ï¼ŒæŒ‡æŒ‰ç…§æŸä¸ªç»´åº¦å°†å­˜æ”¾åœ¨å•ä¸€æ•°æ®åº“ä¸­çš„æ•°æ®åˆ†æ•£åœ°å­˜æ”¾è‡³å¤šä¸ªæ•°æ®åº“æˆ–è¡¨ä¸­ä»¥è¾¾åˆ°æå‡æ€§èƒ½ç“¶é¢ˆä»¥åŠå¯ç”¨æ€§çš„æ•ˆæœã€‚æ•°æ®åˆ†ç‰‡çš„æœ‰æ•ˆæ‰‹æ®µæ˜¯å¯¹å…³ç³»å‹æ•°æ®åº“è¿›è¡Œåˆ†åº“å’Œåˆ†è¡¨</li>\n</ul>\n<h1>3. å¦‚ä½•é€‰æ‹©åˆ†è¡¨é”®ï¼Ÿ</h1>\n<ul>\n<li>éœ€è¦å…ˆæ‰¾åˆ°ä¸šåŠ¡çš„ä¸»é¢˜ã€‚æ¯”å¦‚ä½ çš„æ•°æ®åº“è¡¨æ˜¯ä¸€å¼ ä¼ä¸šå®¢æˆ·ä¿¡æ¯è¡¨ï¼Œå°±å¯ä»¥è€ƒè™‘ç”¨äº†å®¢æˆ·å·åšä¸ºåˆ†è¡¨é”®ã€‚</li>\n<li>ä¿¡æ¯è¡¨ï¼Œä½¿ç”¨ id è¿›è¡Œåˆ†ç‰‡ã€‚ä¾‹å¦‚è¯´ï¼Œæ–‡ç« ã€å•†å“ä¿¡æ¯ç­‰ç­‰ã€‚</li>\n<li>ä¸šåŠ¡è¡¨ï¼Œä½¿ç”¨ user_id è¿›è¡Œåˆ†ç‰‡ã€‚ä¾‹å¦‚è¯´ï¼Œè®¢å•è¡¨ã€æ”¯ä»˜è¡¨ç­‰ç­‰ã€‚</li>\n<li>æ—¥å¿—è¡¨ï¼Œä½¿ç”¨ create_time è¿›è¡Œåˆ†ç‰‡ã€‚ä¾‹å¦‚è¯´ï¼Œè®¿é—®æ—¥å¿—ã€ç™»é™†æ—¥å¿—ç­‰ç­‰ã€‚</li>\n</ul>\n<h1>4. éåˆ†è¡¨é”®å¦‚ä½•æŸ¥è¯¢ï¼Ÿ</h1>\n<ul>\n<li>å‡è®¾ä¸€å¼ ç”¨æˆ·è¡¨ï¼Œæ ¹æ®userIdåšåˆ†è¡¨é”®ï¼Œæ¥åˆ†åº“åˆ†è¡¨ã€‚ä½†æ˜¯ç”¨æˆ·ç™»å½•æ—¶ï¼Œéœ€è¦æ ¹æ®ç”¨æˆ·æ‰‹æœºå·æ¥ç™»é™†ã€‚è¿™æ—¶å€™ï¼Œå°±éœ€è¦é€šè¿‡æ‰‹æœºå·æŸ¥è¯¢ç”¨æˆ·ä¿¡æ¯ã€‚è€Œæ‰‹æœºå·æ˜¯éåˆ†è¡¨é”®ã€‚</li>\n<li>éåˆ†è¡¨é”®æŸ¥è¯¢ï¼Œä¸€èˆ¬æœ‰è¿™å‡ ç§æ–¹æ¡ˆï¼š\n<ul>\n<li>å°†ç”¨æˆ·ä¿¡æ¯å†—ä½™åŒæ­¥åˆ°ESï¼ŒåŒæ­¥å‘é€åˆ°ESï¼Œç„¶åé€šè¿‡ESæ¥æŸ¥è¯¢ï¼ˆæ¨èï¼‰</li>\n<li>åŸºå› æ³•ï¼šæ¯”å¦‚éåˆ†è¡¨é”®å¯ä»¥è§£æå‡ºåˆ†è¡¨é”®å‡ºæ¥ï¼Œæ¯”å¦‚å¸¸è§çš„ï¼Œè®¢å•å·ç”Ÿæˆæ—¶ï¼Œå¯ä»¥åŒ…å«å®¢æˆ·å·è¿›å»ï¼Œé€šè¿‡è®¢å•å·æŸ¥è¯¢ï¼Œå°±å¯ä»¥è§£æå‡ºå®¢æˆ·å·ã€‚ä½†æ˜¯è¿™ä¸ªåœºæ™¯é™¤å¤–ï¼Œæ‰‹æœºå·ä¼¼ä¹ä¸é€‚åˆå†—ä½™userIdã€‚</li>\n<li>æ˜ å°„å…³ç³»ï¼šåˆ›å»ºæ˜ å°„è¡¨ï¼Œåªæœ‰åˆ†è¡¨é”®ã€éåˆ†è¡¨é”®ä¸¤åˆ—å­—æ®µã€‚ä½¿ç”¨éåˆ†è¡¨é”®æŸ¥è¯¢æ—¶ï¼Œå…ˆä»æ˜ å°„è¡¨è·å¾—éåˆ†è¡¨é”®å¯¹åº”çš„åˆ†è¡¨é”®ï¼Œç„¶åå†ä½¿ç”¨éåˆ†è¡¨é”®+åˆ†è¡¨é”®å»æŸ¥è¯¢å¯¹åº”çš„è¡¨ã€‚æ˜ å°„è¡¨å¯ä»¥æ”¹æˆç¼“å­˜åˆ°Redisç­‰ç¼“å­˜ä¸­ã€‚å½“ç„¶ï¼Œéœ€è¦è€ƒè™‘å¦‚æœ Redis æŒä¹…åŒ–çš„æƒ…å†µã€‚å°†æ˜ å°„è¡¨ç¼“å­˜åˆ°å†…å­˜ä¸­ï¼Œå‡å°‘ä¸€æ¬¡åˆ°æ˜ å°„è¡¨çš„æŸ¥è¯¢ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>5. åˆ†è¡¨ç­–ç•¥å¦‚ä½•é€‰æ‹©ï¼Ÿæ°´å¹³åˆ†è¡¨æœ‰å“ªå‡ ç§è·¯ç”±æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>\n<p>è·¯ç”±ï¼šæ•°æ®åº”è¯¥åˆ†åˆ°å“ªä¸€å¼ è¡¨ã€‚</p>\n</li>\n<li>\n<p>æ ¹æ®èŒƒå›´ï¼šé€‰å–æœ‰åºçš„æ•°æ®åˆ—ï¼ˆä¾‹å¦‚ï¼Œä¸»é”®idã€æ—¶é—´æˆ³ç­‰ï¼‰ä½œä¸ºè·¯ç”±çš„æ¡ä»¶ï¼Œä¸åŒåˆ†æ®µåˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®åº“è¡¨ä¸­ã€‚æ”¯ä»˜ç³»ç»Ÿåªèƒ½æŸ¥ä¸€å¹´èŒƒå›´å†…çš„æ”¯ä»˜è®°å½•å¯èƒ½å°±æ˜¯æŒ‰ç…§æ—¶é—´è¿›è¡Œäº†åˆ†è¡¨</p>\n<ul>\n<li>èŒƒå›´è·¯ç”±è®¾è®¡çš„å¤æ‚ç‚¹ä¸»è¦ä½“ç°åœ¨åˆ†æ®µå¤§å°çš„é€‰å–ä¸Šï¼Œåˆ†æ®µå¤ªå°ä¼šå¯¼è‡´åˆ‡åˆ†åå­è¡¨æ•°é‡è¿‡å¤šï¼Œå¢åŠ ç»´æŠ¤å¤æ‚åº¦ï¼›åˆ†æ®µå¤ªå¤§å¯èƒ½ä¼šå¯¼è‡´å•è¡¨ä¾ç„¶å­˜åœ¨æ€§èƒ½é—®é¢˜ï¼Œä¸€èˆ¬å»ºè®®åˆ†æ®µå¤§å°åœ¨100ä¸‡è‡³2000ä¸‡ä¹‹é—´ï¼Œå…·ä½“éœ€è¦æ ¹æ®ä¸šåŠ¡é€‰å–åˆé€‚çš„åˆ†æ®µå¤§å°ã€‚</li>\n<li>ä¼˜ç‚¹æ˜¯æœ‰åˆ©äºæ‰©å®¹ã€‚åªéœ€è¦å¢åŠ æ–°çš„è¡¨å°±å¯ä»¥äº†ï¼ŒåŸæœ‰çš„æ•°æ®ä¸éœ€è¦åŠ¨ã€‚</li>\n<li>ç¼ºç‚¹åˆ†å¸ƒä¸å‡åŒ€å’Œçƒ­ç‚¹é—®é¢˜ã€‚å‡å¦‚æŒ‰ç…§1000ä¸‡æ¥è¿›è¡Œåˆ†è¡¨ï¼Œæœ‰å¯èƒ½æŸä¸ªåˆ†æ®µå®é™…å­˜å‚¨çš„æ•°æ®é‡åªæœ‰1000æ¡ï¼Œè€Œå¦å¤–ä¸€ä¸ªåˆ†æ®µå®é™…å­˜å‚¨çš„æ•°æ®é‡æœ‰900ä¸‡æ¡ã€‚æœ€è¿‘ä¸€ä¸ªæœˆçš„è®¢å•éƒ½åœ¨300ä¸‡~600ä¸‡ä¹‹é—´ï¼Œå¹³æ—¶ç”¨æˆ·ä¸€èˆ¬éƒ½æŸ¥æœ€è¿‘ä¸€ä¸ªæœˆçš„è®¢å•æ¯”è¾ƒå¤šï¼Œè¯·æ±‚éƒ½æ‰“åˆ°åŒä¸€å¼ è¡¨</li>\n</ul>\n</li>\n<li>\n<p>æ ¹æ®Hashå–æ¨¡ï¼šé€‰å–æŸä¸ªåˆ—ï¼ˆæˆ–è€…æŸå‡ ä¸ªåˆ—ç»„åˆä¹Ÿå¯ä»¥ï¼‰çš„å€¼è¿›è¡ŒHashè¿ç®—ï¼Œç„¶åæ ¹æ®Hashç»“æœå–ä½™åˆ†æ•£åˆ°ä¸åŒçš„æ•°æ®åº“è¡¨ä¸­ã€‚åŒæ ·ä»¥è®¢å•idä¸ºä¾‹ï¼Œå‡å¦‚æˆ‘ä»¬ä¸€å¼€å§‹å°±è§„åˆ’äº†4ä¸ªæ•°æ®åº“è¡¨ï¼Œè·¯ç”±ç®—æ³•å¯ä»¥ç®€å•åœ°ç”¨id%4çš„å€¼æ¥è¡¨ç¤ºæ•°æ®æ‰€å±çš„æ•°æ®åº“è¡¨ç¼–å·ï¼Œidä¸º12çš„è®¢å•æ”¾åˆ°ç¼–å·ä¸º50çš„å­è¡¨ä¸­ï¼Œidä¸º13çš„è®¢å•æ”¾åˆ°ç¼–å·ä¸º61çš„å­—è¡¨ä¸­ã€‚</p>\n<ul>\n<li>Hashè·¯ç”±è®¾è®¡çš„å¤æ‚ç‚¹ä¸»è¦ä½“ç°åœ¨åˆå§‹è¡¨æ•°é‡çš„é€‰å–ä¸Šï¼Œè¡¨æ•°é‡å¤ªå¤šç»´æŠ¤æ¯”è¾ƒéº»çƒ¦ï¼Œè¡¨æ•°é‡å¤ªå°‘åˆå¯èƒ½å¯¼è‡´å•è¡¨æ€§èƒ½å­˜åœ¨é—®é¢˜</li>\n<li>ä¼˜ç‚¹ï¼šè¡¨åˆ†å¸ƒæ¯”è¾ƒå‡åŒ€ï¼Œä¸ä¼šå­˜åœ¨æ˜æ˜¾çš„çƒ­ç‚¹é—®é¢˜ã€‚å¯ä»¥å¹³å‡åˆ†é…æ¯ä¸ªåº“çš„æ•°æ®é‡å’Œè¯·æ±‚å‹åŠ›ã€‚</li>\n<li>ç¼ºç‚¹ï¼šå‰æœŸè§„åˆ’ä¸å¥½ï¼Œéœ€è¦æ‰©å®¹äºŒæ¬¡åˆ†è¡¨ï¼Œè¡¨çš„æ•°é‡éœ€è¦å¢åŠ ï¼Œæ‰€ä»¥hashå€¼éœ€è¦é‡æ–°è®¡ç®—ï¼Œè¿™æ—¶å€™éœ€è¦è¿ç§»æ•°æ®äº†ã€‚æ¯”å¦‚æˆ‘ä»¬å¼€å§‹åˆ†äº†10å¼ è¡¨ï¼Œä¹‹åä¸šåŠ¡æ‰©å±•éœ€è¦ï¼Œå¢åŠ åˆ°20å¼ è¡¨ã€‚é‚£é—®é¢˜å°±æ¥äº†ï¼Œä¹‹å‰æ ¹æ®orderIdå–æ¨¡10åçš„æ•°æ®åˆ†æ•£åœ¨äº†å„ä¸ªè¡¨ä¸­ï¼Œç°åœ¨éœ€è¦é‡æ–°å¯¹æ‰€æœ‰æ•°æ®é‡æ–°å–æ¨¡20æ¥åˆ†é…æ•°æ®ã€‚</li>\n</ul>\n</li>\n<li>\n<p>ä¸€è‡´æ€§Hash</p>\n<ul>\n<li>å¦‚æœç”¨hashæ–¹å¼åˆ†è¡¨ï¼Œä¸ºäº†è§£å†³è¿™ä¸ªæ‰©å®¹è¿ç§»é—®é¢˜ï¼Œå¯ä»¥ä½¿ç”¨ä¸€è‡´æ€§hashæ€æƒ³æ¥è§£å†³ã€‚</li>\n<li>ä¸€è‡´æ€§å“ˆå¸Œï¼šåœ¨ç§»é™¤æˆ–è€…æ·»åŠ ä¸€ä¸ªæœåŠ¡å™¨æ—¶ï¼Œèƒ½å¤Ÿå°½å¯èƒ½å°åœ°æ”¹å˜å·²å­˜åœ¨çš„æœåŠ¡è¯·æ±‚ä¸å¤„ç†è¯·æ±‚æœåŠ¡å™¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ã€‚ä¸€è‡´æ€§å“ˆå¸Œè§£å†³äº†ç®€å•å“ˆå¸Œç®—æ³•åœ¨åˆ†å¸ƒå¼å“ˆå¸Œè¡¨å­˜åœ¨çš„åŠ¨æ€ä¼¸ç¼©ç­‰é—®é¢˜</li>\n<li>é¦–å…ˆï¼Œé€‰æ‹©ä¸€ä¸ªè¶³å¤Ÿå¤§çš„Hashç©ºé—´ï¼ˆä¸€èˆ¬æ˜¯ 0 ~ 2^32ï¼‰æ„æˆä¸€ä¸ªå“ˆå¸Œç¯ã€‚</li>\n<li>ç„¶åï¼Œå¯¹äºç¼“å­˜é›†ç¾¤å†…çš„æ¯ä¸ªå­˜å‚¨æœåŠ¡å™¨èŠ‚ç‚¹è®¡ç®— Hash å€¼ï¼Œå¯ä»¥ç”¨æœåŠ¡å™¨çš„ IP æˆ– ä¸»æœºåè®¡ç®—å¾—åˆ°å“ˆå¸Œå€¼ï¼Œè®¡ç®—å¾—åˆ°çš„å“ˆå¸Œå€¼å°±æ˜¯æœåŠ¡èŠ‚ç‚¹åœ¨ Hash ç¯ä¸Šçš„ä½ç½®ã€‚</li>\n<li>æœ€åï¼Œå¯¹æ¯ä¸ªéœ€è¦å­˜å‚¨çš„æ•°æ® key åŒæ ·ä¹Ÿè®¡ç®—ä¸€æ¬¡å“ˆå¸Œå€¼ï¼Œè®¡ç®—ä¹‹åçš„å“ˆå¸Œä¹Ÿæ˜ å°„åˆ°ç¯ä¸Šï¼Œæ•°æ®å­˜å‚¨çš„ä½ç½®æ˜¯æ²¿é¡ºæ—¶é’ˆçš„æ–¹å‘æ‰¾åˆ°çš„ç¯ä¸Šçš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚</li>\n<li>æ‰©å®¹æœåŠ¡å™¨æ—¶åªéœ€æ›¿ç§»åŠ¨é‡å¤çš„hashå¯¹åº”çš„èµ„æº</li>\n<li>å¯ä»¥ä½¿ç”¨Guava // bucket çš„èŒƒå›´åœ¨ 0 ~ buckets ä¹‹é—´ int bucket = Hashing.consistentHash(id, buckets)</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Main {\n    //çœŸå®èŠ‚ç‚¹\n    private static String[] serverIpArray = new String[]{\"192.168.1.100\", \"47.100.61.70\", \"172.87.2.10\", \"1.1.1.1\", \"34.125.90.32\"};\n    //è™šæ‹ŸèŠ‚ç‚¹\n    private static TreeMap&lt;Integer, String&gt; virtualNodeMap;\n \n    static {\n        virtualNodeMap = new TreeMap&lt;&gt;();\n        //é»˜è®¤ä¸ºæ¯ä¸ªçœŸå®èŠ‚ç‚¹ç”Ÿæˆ3ä¸ªè™šæ‹ŸèŠ‚ç‚¹\n        for (String realIp : serverIpArray) {\n            for (int i = 0; i &lt; 3; i++) {\n                //è¿™è¾¹åŠ ä¸Šéšæœºæ•°,åªæ˜¯ä¸ºäº†ä½¿å¾—è™šæ‹ŸèŠ‚ç‚¹çš„hashå€¼æ›´åŠ åˆ†æ•£\n                //ä½†æ˜¯åœ¨å®é™…æƒ…å†µä¸­ï¼Œè™šæ‹ŸèŠ‚ç‚¹çš„hashå€¼éœ€è¦å›ºå®š\n                String virtualIp = new Random().nextInt(10000) + \"#\" + realIp;\n                virtualNodeMap.put(getHash(virtualIp), realIp);\n            }\n        }\n    }\n \n    //è·å–ipçš„å“ˆå¸Œå€¼,å¯ä»¥æœ‰å¤šç§ç®—æ³•å®ç°,è¿™é‡Œåªç”¨hashCode()æ¼”ç¤º\n    //å½“ç„¶ä¹Ÿæœ‰å…¶ä»–çš„å®ç°,é¿å…ipç›¸è¿‘,hashç›¸è¿‘çš„æƒ…å†µ\n    private static int getHash(String ip) {\n        int hashCode = Math.abs(ip.hashCode());\n        System.out.println(ip + \":\" + hashCode);\n        return hashCode;\n    }\n \n    //ç”±å®¢æˆ·ç«¯è·å–æœ€è¿‘çš„è™šæ‹ŸèŠ‚ç‚¹,æœ€åè¿”å›è™šæ‹ŸèŠ‚ç‚¹å¯¹åº”çš„çœŸå®èŠ‚ç‚¹\n    private static String getRealServerIp(String client) {\n        int clientHash = getHash(client);\n        Integer higherKey = virtualNodeMap.higherKey(clientHash);\n        if (higherKey == null) {\n            //è¿”å›hashç¯ä¸­çš„ç¬¬ä¸€ä¸ªè™šæ‹Ÿip\n            return virtualNodeMap.get(virtualNodeMap.firstKey());\n        }\n        //è¿”å›æ¯”å®¢æˆ·ç«¯çš„å“ˆå¸Œå€¼ç¨å¾®å¤§ä¸€ç‚¹çš„è™šæ‹Ÿip\n        return virtualNodeMap.get(higherKey);\n    }\n \n    public static void main(String[] args) {\n        String[] clientIpArray = new String[]{\"å°æ˜å®¶çš„ç”µè„‘\", \"å°çº¢çš„å¹³æ¿\", \"å°åçš„æ‰‹æœº\"};\n        for (String client : clientIpArray) {\n            String realIp = getRealServerIp(client);\n            System.out.println(client + \"è¿æ¥åˆ°äº†\" + realIp);\n        }\n    }\n}\n</code></pre></div><h1>6. åˆ†åº“åˆ†è¡¨å¸¦æ¥çš„é—®é¢˜</h1>\n<ul>\n<li>ä»åˆ†åº“çš„è§’åº¦\n<ul>\n<li>è·¨åº“äº‹åŠ¡é—®é¢˜ï¼šéœ€è¦åˆ†å¸ƒå¼äº‹åŠ¡æ¥è§£å†³</li>\n<li>è·¨åº“æ— æ³•ä½¿ç”¨JOINé—®é¢˜ï¼š\n<ul>\n<li>ä¸šåŠ¡ä»£ç ä¸­è¿›è¡Œå…³è”ï¼Œå…ˆæŠŠä¸€ä¸ªè¡¨çš„æ•°æ®æŸ¥å‡ºæ¥ï¼Œç„¶åé€šè¿‡å¾—åˆ°çš„ç»“æœå†å»æŸ¥å¦ä¸€å¼ è¡¨ï¼Œç„¶ååˆ©ç”¨ä»£ç æ¥å…³è”å¾—åˆ°æœ€ç»ˆçš„ç»“æœ</li>\n<li>é€‚å½“çš„å†—ä½™ä¸€äº›å­—æ®µã€‚æ¯”å¦‚ä»¥å‰çš„è¡¨å°±å­˜å‚¨ä¸€ä¸ªå…³è”IDï¼Œä½†æ˜¯ä¸šåŠ¡æ—¶å¸¸è¦æ±‚è¿”å›å¯¹åº”çš„Nameæˆ–è€…å…¶ä»–å­—æ®µã€‚è¿™æ—¶å€™å°±å¯ä»¥æŠŠè¿™äº›å­—æ®µå†—ä½™åˆ°å½“å‰è¡¨ä¸­ï¼Œæ¥å»é™¤éœ€è¦å…³è”çš„æ“ä½œã€‚</li>\n<li>æ•°æ®å¼‚æ„ï¼Œé€šè¿‡binlogåŒæ­¥ç­‰æ–¹å¼ï¼ŒæŠŠéœ€è¦è·¨åº“joinçš„æ•°æ®å¼‚æ„åˆ°ESç­‰å­˜å‚¨ç»“æ„ä¸­ï¼Œé€šè¿‡ESè¿›è¡ŒæŸ¥è¯¢ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ä»åˆ†è¡¨çš„è§’åº¦\n<ul>\n<li>è·¨èŠ‚ç‚¹çš„count,orderby,groupbyä»¥åŠèšåˆå‡½æ•°é—®é¢˜:åªèƒ½ç”±ä¸šåŠ¡ä»£ç æ¥å®ç°æˆ–è€…ç”¨ä¸­é—´ä»¶å°†å„è¡¨ä¸­çš„æ•°æ®æ±‡æ€»ã€æ’åºã€åˆ†é¡µç„¶åè¿”å›ã€‚</li>\n<li>æ•°æ®è¿ç§»ï¼Œå®¹é‡è§„åˆ’ï¼Œæ‰©å®¹ç­‰é—®é¢˜:æ•°æ®çš„è¿ç§»ï¼Œå®¹é‡å¦‚ä½•è§„åˆ’ï¼Œæœªæ¥æ˜¯å¦å¯èƒ½å†æ¬¡éœ€è¦æ‰©å®¹ç­‰</li>\n<li>IDé—®é¢˜:æ•°æ®åº“è¡¨è¢«åˆ‡åˆ†åï¼Œä¸èƒ½å†ä¾èµ–æ•°æ®åº“è‡ªèº«çš„ä¸»é”®ç”Ÿæˆæœºåˆ¶ï¼Œæ‰€ä»¥éœ€è¦ä¸€äº›æ‰‹æ®µæ¥ä¿è¯å…¨å±€ä¸»é”®å”¯ä¸€ã€‚\n<ul>\n<li>è‡ªå¢ä½†è®¾ç½®ä¸åŒè‡ªå¢æ­¥é•¿ã€‚æ¯”å¦‚ç°åœ¨æœ‰ä¸‰å¼ è¡¨ï¼Œæ­¥é•¿è®¾ç½®ä¸º3ï¼Œä¸‰å¼ è¡¨IDåˆå§‹å€¼åˆ†åˆ«æ˜¯1ã€2ã€3ã€‚è¿™æ ·ç¬¬ä¸€å¼ è¡¨çš„IDå¢é•¿æ˜¯1ã€4ã€7ã€‚ç¬¬äºŒå¼ è¡¨æ˜¯2ã€5ã€8ã€‚ç¬¬ä¸‰å¼ è¡¨æ˜¯3ã€6ã€9ï¼Œè¿™æ ·å°±ä¸ä¼šé‡å¤äº†</li>\n<li>UUIDï¼Œç®€å•ï¼Œä½†æ˜¯ä¸è¿ç»­çš„ä¸»é”®æ’å…¥ä¼šå¯¼è‡´ä¸¥é‡çš„é¡µåˆ†è£‚ï¼Œæ€§èƒ½å·®</li>\n<li>åˆ†å¸ƒå¼IDï¼ŒTwitterå¼€æºçš„sonwflakeé›ªèŠ±ç®—æ³•</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>7. å¦‚æœæŸ¥è¯¢æ¡ä»¶ä¸å¸¦åˆ†ç‰‡é”®ï¼Œæ€ä¹ˆåŠï¼Ÿ</h1>\n<ul>\n<li>å½“æŸ¥è¯¢ä¸å¸¦åˆ†ç‰‡é”®æ—¶ï¼Œåˆ™ä¸­é—´ä»¶ä¸€èˆ¬ä¼šæ‰«ææ‰€æœ‰åº“è¡¨ï¼Œç„¶åèšåˆç»“æœï¼Œç„¶åè¿›è¡Œè¿”å›ã€‚</li>\n</ul>\n<h1>8. å¦‚ä½•é¿å…çƒ­ç‚¹é—®é¢˜æ•°æ®å€¾æ–œï¼ˆçƒ­ç‚¹æ•°æ®ï¼‰</h1>\n<ul>\n<li>å¦‚æœæˆ‘ä»¬æ ¹æ®æ—¶é—´èŒƒå›´åˆ†ç‰‡ï¼ŒæŸç”µå•†å…¬å¸11æœˆæè¥é”€æ´»åŠ¨ï¼Œé‚£ä¹ˆå¤§éƒ¨åˆ†çš„æ•°æ®éƒ½è½åœ¨11æœˆä»½çš„è¡¨é‡Œé¢äº†ï¼Œå…¶ä»–åˆ†ç‰‡è¡¨å¯èƒ½å¾ˆå°‘è¢«æŸ¥è¯¢ï¼Œå³æ•°æ®å€¾æ–œäº†ï¼Œæœ‰çƒ­ç‚¹æ•°æ®é—®é¢˜äº†ã€‚</li>\n<li>å¯ä»¥ä½¿ç”¨rangeèŒƒå›´+ hashå“ˆå¸Œå–æ¨¡ç»“åˆçš„åˆ†è¡¨ç­–ç•¥ï¼Œåœ¨æ‹†åˆ†åº“çš„æ—¶å€™ï¼Œå¯ä»¥å…ˆç”¨rangeèŒƒå›´æ–¹æ¡ˆï¼Œæ¯”å¦‚è®¢å•idåœ¨0~4000ä¸‡çš„åŒºé—´ï¼Œåˆ’åˆ†ä¸ºè®¢å•åº“1;idåœ¨4000ä¸‡~8000ä¸‡çš„æ•°æ®ï¼Œåˆ’åˆ†åˆ°è®¢å•åº“2,å°†æ¥è¦æ‰©å®¹æ—¶ï¼Œidåœ¨8000ä¸‡~1.2äº¿çš„æ•°æ®ï¼Œåˆ’åˆ†åˆ°è®¢å•åº“3ã€‚ç„¶åè®¢å•åº“å†…ï¼Œå†ç”¨hashå–æ¨¡çš„ç­–ç•¥ï¼ŒæŠŠä¸åŒè®¢å•åˆ’åˆ†åˆ°ä¸åŒçš„è¡¨ã€‚</li>\n</ul>\n<h1>9. åˆ†åº“è·¨èŠ‚ç‚¹Joinå…³è”é—®é¢˜</h1>\n<ul>\n<li>å­—æ®µå†—ä½™ï¼šæŠŠéœ€è¦å…³è”çš„å­—æ®µæ”¾å…¥ä¸»è¡¨ä¸­ï¼Œé¿å…å…³è”æ“ä½œï¼›æ¯”å¦‚è®¢å•è¡¨ä¿å­˜äº†å–å®¶IDï¼ˆsellerIdï¼‰ï¼Œä½ æŠŠå–å®¶åå­—sellerNameä¹Ÿä¿å­˜åˆ°è®¢å•è¡¨ï¼Œè¿™å°±ä¸ç”¨å»å…³è”å–å®¶è¡¨äº†ã€‚è¿™æ˜¯ä¸€ç§ç©ºé—´æ¢æ—¶é—´çš„æ€æƒ³ã€‚</li>\n<li>å…¨å±€è¡¨ï¼šæ¯”å¦‚ç³»ç»Ÿä¸­æ‰€æœ‰æ¨¡å—éƒ½å¯èƒ½ä¼šä¾èµ–åˆ°çš„ä¸€äº›åŸºç¡€è¡¨ï¼ˆå³å…¨å±€è¡¨ï¼‰ï¼Œåœ¨æ¯ä¸ªæ•°æ®åº“ä¸­å‡ä¿å­˜ä¸€ä»½ã€‚</li>\n<li>æ•°æ®æŠ½è±¡åŒæ­¥ï¼šæ¯”å¦‚Aåº“ä¸­çš„aè¡¨å’ŒBåº“ä¸­çš„bè¡¨æœ‰å…³è”ï¼Œå¯ä»¥å®šæ—¶å°†æŒ‡å®šçš„è¡¨åšåŒæ­¥ï¼Œå°†æ•°æ®æ±‡åˆèšé›†ï¼Œç”Ÿæˆæ–°çš„è¡¨ã€‚ä¸€èˆ¬å¯ä»¥å€ŸåŠ©ETLå·¥å…·ã€‚</li>\n<li>åº”ç”¨å±‚ä»£ç ç»„è£…ï¼šåˆ†å¼€å¤šæ¬¡æŸ¥è¯¢ï¼Œè°ƒç”¨ä¸åŒæ¨¡å—æœåŠ¡ï¼Œè·å–åˆ°æ•°æ®åï¼Œä»£ç å±‚è¿›è¡Œå­—æ®µè®¡ç®—æ‹¼è£…ã€‚</li>\n</ul>\n<h1>10. è·¨èŠ‚ç‚¹çš„count,order by,group byç­‰èšåˆå‡½æ•°é—®é¢˜</h1>\n<ul>\n<li>ä¸€èˆ¬éƒ½éœ€è¦åŸºäºå…¨éƒ¨æ•°æ®é›†åˆè¿›è¡Œè®¡ç®—ã€‚å¯ä»¥åˆ†åˆ«åœ¨å„ä¸ªèŠ‚ç‚¹ä¸Šå¾—åˆ°ç»“æœåï¼Œå†åœ¨åº”ç”¨ç¨‹åºç«¯è¿›è¡Œåˆå¹¶ã€‚</li>\n</ul>\n<h1>11. åˆ†åº“åˆ†è¡¨åçš„åˆ†é¡µé—®é¢˜</h1>\n<ul>\n<li>å…¨å±€è§†é‡æ³•ï¼šåœ¨å„ä¸ªæ•°æ®åº“èŠ‚ç‚¹æŸ¥åˆ°å¯¹åº”ç»“æœåï¼Œåœ¨ä»£ç ç«¯æ±‡èšå†åˆ†é¡µã€‚è¿™æ ·ä¼˜ç‚¹æ˜¯ä¸šåŠ¡æ— æŸï¼Œç²¾å‡†è¿”å›æ‰€éœ€æ•°æ®ï¼›ç¼ºç‚¹åˆ™æ˜¯ä¼šè¿”å›è¿‡å¤šæ•°æ®ï¼Œå¢å¤§ç½‘ç»œä¼ è¾“æ¯”å¦‚åˆ†åº“åˆ†è¡¨å‰ï¼Œä½ æ˜¯æ ¹æ®åˆ›å»ºæ—¶é—´æ’åºï¼Œç„¶åè·å–ç¬¬2é¡µæ•°æ®ã€‚å¦‚æœä½ æ˜¯åˆ†äº†ä¸¤ä¸ªåº“ï¼Œé‚£ä½ å°±å¯ä»¥æ¯ä¸ªåº“éƒ½æ ¹æ®æ—¶é—´æ’åºï¼Œç„¶åéƒ½è¿”å›2é¡µæ•°æ®ï¼Œç„¶åæŠŠä¸¤ä¸ªæ•°æ®åº“æŸ¥è¯¢å›æ¥çš„æ•°æ®æ±‡æ€»ï¼Œå†æ ¹æ®åˆ›å»ºæ—¶é—´è¿›è¡Œå†…å­˜æ’åºï¼Œæœ€åå†å–ç¬¬2é¡µçš„æ•°æ®ã€‚</li>\n<li>ä¸šåŠ¡æŠ˜è¡·æ³•-ç¦æ­¢è·³é¡µæŸ¥è¯¢ï¼šä¸å…è®¸è·³é¡µæŸ¥è¯¢äº†åªæœ‰ä¸Šä¸€é¡µå’Œä¸‹ä¸€é¡µï¼Œã€‚æŸ¥è¯¢ç¬¬ä¸€é¡µæ—¶ï¼Œæ˜¯è·Ÿå…¨å±€è§†é‡æ³•ä¸€æ ·çš„ã€‚ä½†æ˜¯ä¸‹ä¸€é¡µæ—¶ï¼Œéœ€è¦æŠŠå½“å‰æœ€å¤§çš„åˆ›å»ºæ—¶é—´ä¼ è¿‡æ¥ï¼Œç„¶åæ¯ä¸ªèŠ‚ç‚¹ï¼Œéƒ½æŸ¥è¯¢å¤§äºåˆ›å»ºæ—¶é—´çš„ä¸€é¡µæ•°æ®ï¼Œæ¥ç€æ±‡æ€»ï¼Œå†…å­˜æ’åºè¿”å›</li>\n</ul>\n<h1>12. åˆ†åº“åˆ†è¡¨å®ç°æ–¹å¼ï¼š</h1>\n<ul>\n<li>Client æ¨¡å¼</li>\n<li>Proxy æ¨¡å¼</li>\n</ul>\n<h1>13. åˆ†åº“åˆ†è¡¨é€‰æ‹©å“ªç§ä¸­é—´ä»¶ï¼Ÿå¦‚ä½•é€‰æ‹©</h1>\n<ul>\n<li><strong>Sharding-JDBC</strong> å½“å½“å¼€æº jdbcå±‚é¢æ“ä½œ  client å±‚æ–¹æ¡ˆ</li>\n<li>cobar é˜¿é‡Œ Proxyæ–¹å¼ å¿…é¡»å°†æ‹†åˆ†åçš„è¡¨åˆ†åˆ«æ”¾å…¥ä¸åŒçš„åº“å®ç°åˆ†å¸ƒå¼</li>\n<li><strong>Mycat</strong> å›½å†…å¼€æº  Proxy æ–¹å¼</li>\n<li>Atlas 360 Proxyæ–¹å¼ ä¸èƒ½å®ç°åˆ†å¸ƒå¼åˆ†è¡¨ æ‰€æœ‰è¡¨éƒ½åœ¨åŒä¸€ä¸ªåº“</li>\n<li>TDDLï¼ˆæ·˜å®ï¼‰é˜¿é‡Œ Clientæ–¹å¼ åŠŸèƒ½å¼ºå¤§ è¿‡äºå¤æ‚éƒ¨åˆ†å¼€æº</li>\n<li>vitess è°·æ­Œ é›†ç¾¤åŸºäºZookeeperç®¡ç†ï¼Œé€šè¿‡RPCæ–¹å¼è¿›è¡Œæ•°æ®å¤„ç†ï¼Œå¯æ”¯æ’‘é«˜æµé‡</li>\n<li>Sharding Sphereå¯èƒ½æ˜¯ç›®å‰æœ€å¥½çš„å¼€æºçš„åˆ†åº“åˆ†è¡¨è§£å†³æ–¹æ¡ˆï¼Œç›®å‰å·²ç»è¿›å…¥ Apache å­µåŒ–ï¼Œæä¾›ä¸‰ç§æ¨¡å¼\n<ul>\n<li>Sharding-JDBC</li>\n<li>Sharding-Proxy</li>\n<li>Sharding-Sidecar è®¡åˆ’å¼€å‘ä¸­ã€‚</li>\n</ul>\n</li>\n<li>Sharding Sphere ï¼Œè¿™ä¸ªå¯ä»¥æ»¡è¶³æˆ‘ä»¬çš„è¯‰æ±‚ã€‚Sharding-JDBC æ–¹æ¡ˆï¼Œè¿™ç§ Client å±‚æ–¹æ¡ˆçš„ä¼˜ç‚¹åœ¨äºä¸ç”¨éƒ¨ç½²ï¼Œè¿ç»´æˆæœ¬ä½ï¼Œä¸éœ€è¦ä»£ç†å±‚çš„äºŒæ¬¡è½¬å‘è¯·æ±‚ï¼Œæ€§èƒ½å¾ˆé«˜ï¼Œä½†æ˜¯å¦‚æœé‡åˆ°å‡çº§å•¥çš„éœ€è¦å„ä¸ªç³»ç»Ÿéƒ½é‡æ–°å‡çº§ç‰ˆæœ¬å†å‘å¸ƒï¼Œå„ä¸ªç³»ç»Ÿéƒ½éœ€è¦è€¦åˆ sharding-jdbc çš„ä¾èµ–ã€‚ä¾‹å¦‚é˜¿é‡Œã€ç¾å›¢å†…éƒ¨ï¼Œæ›´å¤šä½¿ç”¨çš„æ˜¯ Client æ¨¡å¼ã€‚</li>\n<li>Sharding Sphere çš„ Sharding-Proxy æ–¹æ¡ˆï¼Œè¿™ç§ Proxy å±‚æ–¹æ¡ˆï¼Œå¯ä»¥è§£å†³æˆ‘ä»¬å¹³æ—¶æŸ¥è¯¢æ•°æ®åº“çš„éœ€æ±‚ã€‚æˆ‘ä»¬åªéœ€è¦è¿æ¥ä¸€ä¸ª Sharding-Proxy ï¼Œå°±å¯ä»¥æŸ¥è¯¢åˆ†åº“åˆ†è¡¨ä¸­çš„æ•°æ®ã€‚å¦å¤–ï¼Œå¦‚æœæˆ‘ä»¬æœ‰è·¨è¯­è¨€çš„éœ€æ±‚ï¼Œä¾‹å¦‚ PHPã€GO ç­‰ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨å®ƒã€‚</li>\n</ul>\n<h1>14. å¦‚ä½•è¿ç§»åˆ°åˆ†åº“åˆ†è¡¨ï¼Ÿ</h1>\n<ul>\n<li>1ã€åœæ­¢éƒ¨ç½²æ³•ã€‚å‡Œæ™¨åœæœºï¼Œå†™è¿ç§»ç¨‹åºè¯»æ—§æ•°æ®åº“æ•°æ®ï¼Œé€šè¿‡ä¸­é—´ä»¶å†™å…¥åˆ°æ–°åˆ†åº“åˆ†è¡¨ä¸­ï¼Œç»“æŸåæ ¡éªŒè¿ç§»å‰åä¸€è‡´æ€§ï¼Œæ²¡é—®é¢˜å°±è¿ç§»ä¸šåŠ¡åˆ°æ–°åº“</li>\n<li>2ã€åŒå†™éƒ¨ç½²æ³•ï¼ŒåŸºäºä¸šåŠ¡å±‚ã€‚\n<ul>\n<li>æ ¹æ®ä¸»é”®æˆ–è€…åˆ›å»ºæ—¶é—´å¤§å°å°†è¡¨testæ•°æ®åŒºåˆ†ä¸ºå†å²æ•°æ®å’Œå¢é‡æ•°æ®</li>\n<li>å°†ä¸testè¡¨æœ‰å…³çš„å†™ä¸šåŠ¡sqlå†™å…¥åˆ°æ¶ˆæ¯é˜Ÿåˆ—ä¸­</li>\n<li>ç³»ç»Ÿä¸Šçº¿ï¼Œå†™è¿ç§»ç¨‹åº(1.æŸ¥å‡ºæœ€å¤§id2.æ¯æ¬¡æŠ“å–id&gt;? adn id &lt;?+stepæ­¥é•¿çš„æ•°æ®ï¼Œå†™å…¥åˆ°æ–°åº“ä¸­&gt;)å°†testè¡¨å†å²æ•°æ®è¿ç§»åˆ°æ–°æ•°æ®åº“ä¸­ï¼Œå†å²æ•°æ®è¿ç§»å®Œæˆåå†è¿ç§»æ¶ˆæ¯é˜Ÿåˆ—é‡Œé¢çš„æ•°æ®</li>\n<li>å°†è¿ç§»ç¨‹åºä¸‹çº¿ï¼Œå†™ä¸€æ®µè®¢é˜…ç¨‹åºè®¢é˜…æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ•°æ®ã€‚è®¢é˜…ç¨‹åºå°†è®¢é˜…åˆ°åˆ°æ•°æ®ï¼Œé€šè¿‡ä¸­é—´ä»¶å†™å…¥æ–°åº“</li>\n<li>æ–°è€åº“ä¸€è‡´æ€§éªŒè¯ï¼Œå»é™¤ä»£ç ä¸­çš„åŒå†™ä»£ç ï¼Œå°†æ¶‰åŠåˆ° test_tb è¡¨çš„è¯»å†™æ“ä½œï¼ŒæŒ‡å‘æ–°åº“ã€‚</li>\n</ul>\n</li>\n<li>3ã€åŒå†™éƒ¨ç½²æ³•ï¼ŒåŸºäº binlog ã€‚\n<ul>\n<li>æ ¹æ®ä¸»é”®æˆ–è€…åˆ›å»ºæ—¶é—´å¤§å°å°†è¡¨testæ•°æ®åŒºåˆ†ä¸ºå†å²æ•°æ®å’Œå¢é‡æ•°æ®</li>\n<li>æ‰“å¼€binlogæ—¥å¿—ï¼Œç³»ç»Ÿæ­£å¸¸ä¸Šçº¿ã€‚å†™è¿ç§»ç¨‹åºå°†testè¡¨å†å²æ•°æ®è¿ç§»åˆ°æ–°æ•°æ®åº“ä¸­ï¼Œå†å²æ•°æ®è¿ç§»å®Œæˆåå†è¿ç§»å¢é‡æ•°æ®</li>\n<li>å†™ä¸€ä¸ªè®¢é˜…ç¨‹åºï¼Œè®¢é˜…binlog(mysqlä¸­æœ‰canal ã€‚è‡³äºoracleä¸­ï¼Œå¤§å®¶å°±éšç¼˜è‡ªå·±å†™å§)ã€‚ç„¶åå°†è®¢é˜…åˆ°åˆ°æ•°æ®é€šè¿‡ä¸­é—´ä»¶ï¼Œå†™å…¥æ–°åº“ã€‚</li>\n<li>æ£€éªŒä¸€è‡´æ€§ï¼Œæ²¡é—®é¢˜å°±åˆ‡åº“</li>\n</ul>\n</li>\n<li>æ€ä¹ˆéªŒæ•°æ®ä¸€è‡´æ€§\n<ul>\n<li>å…ˆéªŒæ•°é‡æ˜¯å¦ä¸€è‡´ï¼Œå› ä¸ºéªŒæ•°é‡æ¯”è¾ƒå¿«ã€‚</li>\n<li>éªŒå…³é”®æ€§çš„å‡ ä¸ªå­—æ®µæ˜¯å¦ä¸€è‡´ã€‚</li>\n<li>ä¸€æ¬¡å–50æ¡(ä¸ä¸€å®š50æ¡ï¼Œå…·ä½“è‡ªå·±å®šï¼Œæˆ‘åªæ˜¯ä¸¾ä¾‹),ç„¶ååƒæ‹¼å­—ç¬¦ä¸²ä¸€æ ·ï¼Œæ‹¼åœ¨ä¸€èµ·ã€‚ç”¨md5è¿›è¡ŒåŠ å¯†ï¼Œå¾—åˆ°ä¸€ä¸²æ•°å€¼ã€‚æ–°åº“ä¸€æ ·å¦‚æ³•ç‚®åˆ¶ï¼Œä¹Ÿå¾—åˆ°ä¸€ä¸²æ•°å€¼ï¼Œæ¯”è¾ƒä¸¤ä¸²æ•°å€¼æ˜¯å¦ä¸€è‡´ã€‚å¦‚æœä¸€è‡´ï¼Œç»§ç»­æ¯”è¾ƒä¸‹50æ¡æ•°æ®ã€‚å¦‚æœå‘ç°ä¸ä¸€è‡´ï¼Œç”¨äºŒåˆ†æ³•ç¡®å®šä¸ä¸€è‡´çš„æ•°æ®åœ¨0-25æ¡ï¼Œè¿˜æ˜¯26æ¡-50æ¡ã€‚ä»¥æ­¤ç±»æ¨ï¼Œæ‰¾å‡ºä¸ä¸€è‡´çš„æ•°æ®ï¼Œè¿›è¡Œè®°å½•å³å¯ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>15. å¦‚ä½•è¯„ä¼°åˆ†åº“æ•°é‡</h1>\n<ul>\n<li>MySQLä¸€èˆ¬å•åº“è¶…è¿‡5åƒä¸‡è®°å½•å‹åŠ›å°±éå¸¸å¤§äº†ã€‚å¦‚æœåˆ†åº“æ•°é‡å°‘ï¼Œè¾¾ä¸åˆ°åˆ†æ•£å­˜å‚¨å’Œå‡è½»DBæ€§èƒ½å‹åŠ›çš„ç›®çš„ï¼›å¦‚æœåˆ†åº“çš„æ•°é‡å¤šï¼Œå¯¹äºè·¨å¤šä¸ªåº“çš„è®¿é—®ï¼Œåº”ç”¨ç¨‹åºéœ€è¦è®¿é—®å¤šä¸ªåº“ã€‚å»ºè®®åˆ†4~10ä¸ªåº“</li>\n</ul>\n<h1>16. å‚ç›´åˆ†åº“ã€æ°´å¹³åˆ†åº“ã€å‚ç›´åˆ†è¡¨ã€æ°´å¹³åˆ†è¡¨çš„åŒºåˆ«ï¼Ÿæ€ä¹ˆåˆ†åº“åˆ†è¡¨ï¼Ÿâˆš</h1>\n<ul>\n<li>æ°´å¹³åˆ†åº“ï¼šä»¥å­—æ®µä¸ºä¾æ®ï¼ŒæŒ‰ç…§ä¸€å®šç­–ç•¥ï¼ˆhashã€rangeç­‰ï¼‰ï¼Œå°†ä¸€ä¸ªåº“ä¸­çš„æ•°æ®æ‹†åˆ†åˆ°å¤šä¸ªåº“ä¸­ã€‚æ¯ä¸ªåº“çš„ç»“æ„éƒ½ä¸€æ ·ï¼Œæ•°æ®ä¸ä¸€æ ·ï¼Œæ²¡æœ‰äº¤é›† id 1-1000</li>\n<li>æ°´å¹³åˆ†è¡¨ï¼šä»¥å­—æ®µä¸ºä¾æ®ï¼ŒæŒ‰ç…§ä¸€å®šç­–ç•¥ï¼ˆhashã€rangeç­‰ï¼‰ï¼Œå°†ä¸€ä¸ªè¡¨ä¸­çš„æ•°æ®æ‹†åˆ†åˆ°å¤šä¸ªè¡¨ä¸­ã€‚æ¯ä¸ªè¡¨çš„ç»“æ„éƒ½ä¸€æ ·ï¼Œæ•°æ®ä¸ä¸€æ ·ï¼Œæ²¡æœ‰äº¤é›† id 1-1000</li>\n<li>å‚ç›´åˆ†åº“ï¼šä»¥è¡¨ä¸ºä¾æ®ï¼ŒæŒ‰ç…§ä¸šåŠ¡å½’å±ä¸åŒï¼Œå°†ä¸åŒçš„è¡¨æ‹†åˆ†åˆ°ä¸åŒçš„åº“ä¸­ã€‚æ¯ä¸ªåº“çš„ç»“æ„éƒ½ä¸ä¸€æ ·ï¼Œæ•°æ®ä¹Ÿä¸ä¸€æ ·ï¼Œæ²¡æœ‰äº¤é›†ã€‚æŒ‰ç…§ç”¨æˆ·ã€å•†å“ã€è®¢å•åˆ†åˆ°ä¸åŒçš„åº“ä¸­ã€‚</li>\n<li>å‚ç›´åˆ†è¡¨ï¼šä»¥å­—æ®µä¸ºä¾æ®ï¼ŒæŒ‰ç…§å­—æ®µçš„æ´»è·ƒæ€§ï¼Œå°†è¡¨ä¸­å­—æ®µæ‹†åˆ°ä¸åŒçš„è¡¨ï¼ˆä¸»è¡¨å’Œæ‰©å±•è¡¨ï¼‰ä¸­ã€‚æ¯ä¸ªè¡¨çš„ç»“æ„ä¸ä¸€æ ·ã€‚æ•°æ®ä¹Ÿä¸ä¸€æ ·ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œæ¯ä¸ªè¡¨çš„å­—æ®µè‡³å°‘æœ‰ä¸€åˆ—äº¤é›†ï¼Œä¸€èˆ¬æ˜¯ä¸»é”®ï¼Œç”¨äºå…³è”æ•°æ®</li>\n</ul>\n<h1>18. ä¸åœæœºæ‰©å®¹æ€ä¹ˆå®ç°ï¼Ÿ</h1>\n<ul>\n<li>\n<p>åœ¨çº¿åŒå†™ï¼ŒæŸ¥è¯¢èµ°è€åº“</p>\n<ul>\n<li>å»ºç«‹å¥½æ–°çš„åº“è¡¨ç»“æ„ï¼Œæ•°æ®å†™å…¥ä¹…åº“çš„åŒæ—¶ï¼Œä¹Ÿå†™å…¥æ‹†åˆ†çš„æ–°åº“</li>\n<li>æ•°æ®è¿ç§»ï¼Œä½¿ç”¨æ•°æ®è¿ç§»ç¨‹åºï¼Œå°†æ—§åº“ä¸­çš„å†å²æ•°æ®è¿ç§»åˆ°æ–°åº“</li>\n<li>ä½¿ç”¨å®šæ—¶ä»»åŠ¡ï¼Œæ–°æ—§åº“çš„æ•°æ®å¯¹æ¯”ï¼ŒæŠŠå·®å¼‚è¡¥é½<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/539f395d31202ddb73744.png\" alt=\"databaseexpand1.jpg\"></li>\n</ul>\n</li>\n<li>\n<p>åœ¨çº¿åŒå†™ï¼ŒæŸ¥è¯¢èµ°æ–°åº“</p>\n<ul>\n<li>å®Œæˆäº†å†å²æ•°æ®çš„åŒæ­¥å’Œæ ¡éªŒ</li>\n<li>æŠŠå¯¹æ•°æ®çš„è¯»åˆ‡æ¢åˆ°æ–°åº“<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/da218b19c04ecca511246.png\" alt=\"databaseexpand2.jpg\"></li>\n</ul>\n</li>\n<li>\n<p>æ—§åº“ä¸‹çº¿</p>\n<ul>\n<li>æ—§åº“ä¸å†å†™å…¥æ–°çš„æ•°æ®</li>\n<li>ç»è¿‡ä¸€æ®µæ—¶é—´ï¼Œç¡®å®šæ—§åº“æ²¡æœ‰è¯·æ±‚ä¹‹åï¼Œå°±å¯ä»¥ä¸‹çº¿è€åº“<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a9383293a12f5db0fe72b.png\" alt=\"databaseexpand3.jpg\"></li>\n</ul>\n</li>\n</ul>\n<h1>19. å¦‚ä½•è§£å†³åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ</h1>\n<ul>\n<li>æ•°æ®åœ¨åˆ†åº“åˆ†è¡¨æ—¶ï¼Œéœ€è¦ä¿è¯ä¸€ä¸ªé€»è¾‘ä¸­ï¼Œèƒ½å¤Ÿå½¢æˆæœ¬åœ°äº‹åŠ¡ã€‚ä¸¾ä¸ªä¾‹å­ï¼Œåˆ›å»ºè®¢å•æ—¶ï¼Œæˆ‘ä»¬ä¼šæ’å…¥è®¢å•è¡¨å’Œè®¢å•æ˜ç»†è¡¨ï¼Œé‚£ä¹ˆï¼šå¦‚æœæˆ‘ä»¬åŸºäºè¿™ä¸¤ä¸ªè¡¨çš„ id è¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œå°†ä¼šå¯¼è‡´æ’å…¥çš„è®°å½•è¢«åˆ†åˆ°ä¸åŒçš„åº“è¡¨ä¸­ï¼Œå› ä¸ºåˆ›å»ºä¸‹å•å¯ä»¥è´­ä¹° n ä¸ªå•†å“ï¼Œé‚£ä¹ˆå°±ä¼šæœ‰ 1 æ¡è®¢å•è®°å½•å’Œ n æ¡ è®¢å•æ˜ç»†è®°å½•ã€‚è€Œè¿™ n æ¡è®¢å•æ˜ç»†è®°å½•æ— æ³•å’Œ 1 æ¡è®¢å•è®°å½•åˆ†åˆ°ä¸€ä¸ªåº“è¡¨ä¸­ã€‚å¦‚æœæˆ‘ä»¬åŸºäºè¿™ä¸¤ä¸ªè¡¨çš„ user_id è¿›è¡Œåˆ†åº“åˆ†è¡¨ï¼Œé‚£ä¹ˆæ’å…¥çš„è®°å½•è¢«åˆ†åˆ°ç›¸åŒçš„åº“è¡¨ä¸­ã€‚è¿™ä¹Ÿæ˜¯ä¸ºä»€ä¹ˆä¸šåŠ¡è¡¨ä¸€èˆ¬ä½¿ç”¨ user_id è¿›è¡Œåˆ†åº“åˆ†è¡¨çš„åŸå› ä¹‹ä¸€ã€‚</li>\n<li>ä¸ºä»€ä¹ˆä¸€å®šè¦å½¢æˆæœ¬åœ°äº‹åŠ¡ï¼Ÿåœ¨æœ‰äº†æœ¬åœ°äº‹åŠ¡çš„åŸºç¡€ä¸Šï¼Œé€šè¿‡ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡çš„è§£å†³æ–¹æ¡ˆï¼Œåè°ƒå¤šä¸ªæœ¬åœ°äº‹åŠ¡ï¼Œå½¢æˆæœ€ç»ˆä¸€è‡´æ€§ã€‚å¦å¤–ï¼ŒğŸ˜ˆ æœ¬åœ°äº‹åŠ¡åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œèƒ½å¤Ÿä¿è¯ä¸‡ä¸€æ‰§è¡Œå¤±è´¥ï¼Œå†é‡è¯•æ—¶ï¼Œä¸ä¼šäº§ç”Ÿè„æ•°æ®ã€‚</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/539f395d31202ddb73744.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "è®¾è®¡æ¨¡å¼",
      "url": "https://javaguide.cn/interview/designpattern.html",
      "id": "https://javaguide.cn/interview/designpattern.html",
      "summary": "è®¾è®¡æ¨¡å¼",
      "content_html": "<p>è®¾è®¡æ¨¡å¼</p>\n<!-- more -->\n<h1>1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨è®¾è®¡æ¨¡å¼?</h1>\n<ul>\n<li>ä»£ç é‡ç”¨æ€§ (ç›¸åŒåŠŸèƒ½çš„ä»£ç ï¼Œä¸ç”¨å¤šæ¬¡ç¼–å†™)</li>\n<li>å¯è¯»æ€§ (ç¼–ç¨‹è§„èŒƒæ€§, ä¾¿äºå…¶ä»–ç¨‹åºå‘˜çš„é˜…è¯»å’Œç†è§£)</li>\n<li>å¯æ‰©å±•æ€§ (å½“éœ€è¦å¢åŠ æ–°çš„åŠŸèƒ½æ—¶ï¼Œéå¸¸çš„æ–¹ä¾¿ï¼Œç§°ä¸ºå¯ç»´æŠ¤)</li>\n<li>å¯é æ€§ (å½“æˆ‘ä»¬å¢åŠ æ–°çš„åŠŸèƒ½åï¼Œå¯¹åŸæ¥çš„åŠŸèƒ½æ²¡æœ‰å½±å“)</li>\n<li>ä½¿ç¨‹åºå‘ˆç°é«˜å†…èšï¼Œä½è€¦åˆçš„ç‰¹æ€§</li>\n</ul>\n<h1>2. è®¾è®¡æ¨¡å¼ä¸ƒå¤§åŸåˆ™</h1>\n<ul>\n<li>å•ä¸€èŒè´£åŸåˆ™SRP(Single Responsibility Principle):ä¸€ä¸ªç±»æˆ–è€…ä¸€ä¸ªæ–¹æ³•åº”è¯¥åªè´Ÿè´£ä¸€é¡¹èŒè´£</li>\n<li>æ¥å£éš”ç¦»åŸåˆ™ISP(the Interface Segregation Principle ISP):å®¢æˆ·ç«¯ä¸åº”è¯¥ä¾èµ–å®ƒä¸éœ€è¦çš„æ¥å£(æ¥å£æœ‰Aã€Bæ–¹æ³•ï¼Œåªç”¨åˆ°Açš„è¯ï¼ŒæŠŠæ¥å£æ‹†æˆä¸¤ä¸ª)</li>\n<li>ä¾èµ–å€’è½¬(å€’ç½®)åŸåˆ™DIP(the Dependency Inversion Principle DIP):é¢å‘æ¥å£ç¼–ç¨‹ï¼Œç§æœ‰å±æ€§ä¾èµ–æ¥å£æˆ–æŠ½è±¡ç±»ï¼Œç»§æ‰¿æ—¶éµå¾ªé‡Œæ°æ›¿æ¢åŸåˆ™</li>\n<li>é‡Œæ°æ›¿æ¢åŸåˆ™(the Liskov Substitution Principle LSP):ç»§æ‰¿æ—¶ï¼Œå­ç±»çš„å°½é‡ä¸è¦é‡å†™çˆ¶ç±»æ–¹æ³•ï¼Œçˆ¶ç±»çš„é€šç”¨æ–¹æ³•å°½é‡ä¸è¦æ”¹ï¼Œé¿å…å‘ç”ŸæœªçŸ¥é”™è¯¯ï¼Œå¯ç”¨èšåˆã€ç»„åˆã€ä¾èµ–è§£å†³</li>\n<li>å¼€é—­åŸåˆ™ocp(Openï¼Close Principle):æ¨¡å—å’Œå‡½æ•°åº”è¯¥å¯¹æ‰©å±•å¼€æ”¾(å¯¹æä¾›æ–¹)ï¼Œå¯¹ä¿®æ”¹å…³é—­(å¯¹ä½¿ç”¨æ–¹)ã€‚(é€šè¿‡å¢åŠ ä»£ç è€Œä¸æ˜¯ä¿®æ”¹ä»£ç å®Œæˆ)ç”¨æŠ½è±¡æ„å»ºæ¡†æ¶ï¼Œç”¨å®ç°æ‰©å±•ç»†èŠ‚</li>\n<li>è¿ªç±³ç‰¹æ³•åˆ™:ä¸€ä¸ªå¯¹è±¡å°½é‡é™ä½å¯¹å…¶ä»–ç±»çš„ä¾èµ–ï¼Œæ— å…³çš„ç±»ä¸è¦ä»¥å±€éƒ¨å˜é‡å‡ºç°åœ¨ç±»çš„å†…éƒ¨</li>\n<li>åˆæˆå¤ç”¨åŸåˆ™:ä½¿ç”¨åˆæˆ/èšåˆçš„æ–¹å¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ç»§æ‰¿;ä¾èµ–ï¼šæ–¹æ³•ä¼ å‚ä¼ ç»™ä»– èšåˆï¼šå£°æ˜å±æ€§å’Œsetçš„æ–¹æ³•ï¼Œç»„åˆ ç›´æ¥å±æ€§newä¸€ä¸ª</li>\n</ul>\n<h1>3. è®¾è®¡æ¨¡å¼åŠå…¶ç±»å‹ï¼ˆ23ç§ï¼‰</h1>\n<h2>3.1. åˆ›å»ºå‹æ¨¡å¼</h2>\n<h3>3.1.1. å•ä¾‹æ¨¡å¼</h3>\n<ul>\n<li>å•ä¾‹æ¨¡å¼ï¼šä¿è¯åœ¨ç³»ç»Ÿä¸­ï¼Œå¯¹æŸä¸ªç±»åªèƒ½å­˜åœ¨ä¸€ä¸ªå¯¹è±¡å®ä¾‹ï¼Œå¹¶ä¸”è¯¥ç±»åªæä¾›ä¸€ä¸ªå–å¾—å…¶å¯¹è±¡å®ä¾‹çš„æ–¹æ³•(é™æ€æ–¹æ³•)</li>\n<li>ä½¿ç”¨åœºæ™¯ï¼šé¢‘ç¹çš„åˆ›å»ºå’Œé”€æ¯çš„å¯¹è±¡ã€åˆ›å»ºå¯¹è±¡æ—¶è€—æ—¶è¿‡å¤šæˆ–è€—è´¹èµ„æºè¿‡å¤š(é‡é‡çº§å¯¹è±¡)ï¼Œä½†åˆå¸¸ç”¨çš„å·¥å…·ç±»å¯¹è±¡ã€é¢‘ç¹è®¿é—®æ•°æ®åº“æˆ–æ–‡ä»¶çš„å¯¹è±¡(æ•°æ®åº“è¿æ¥æ± ã€å¤šçº¿ç¨‹æ± ã€SessionFactoryç­‰)</li>\n<li>æ­¥éª¤ï¼š1. æ„é€ å™¨ç§æœ‰åŒ–, å¤–éƒ¨ä¸èƒ½new 2.æœ¬ç±»å†…éƒ¨åˆ›å»ºå¯¹è±¡å®ä¾‹  3. æä¾›ä¸€ä¸ªå…¬æœ‰çš„é™æ€æ–¹æ³•ï¼Œè¿”å›å®ä¾‹å¯¹è±¡</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//é¥¿æ±‰å¼ï¼šçº¿ç¨‹å®‰å…¨ã€æ— å»¶æ—¶åŠ è½½ã€å†…å­˜æµªè´¹(åœ¨ç±»è£…è½½çš„æ—¶å€™å°±å®Œæˆå®ä¾‹ï¼Œé¿å…äº†å¤šçº¿ç¨‹çš„åŒæ­¥é—®é¢˜)\nclass Singleton {\n    private Singleton() {}\n    private final static Singleton instance = new Singleton();\n    public static Singleton getInstance() { return instance; }\n}\n\n//æ‡’æ±‰å¼ï¼šçº¿ç¨‹å®‰å…¨ï¼ŒåŒæ­¥æ–¹æ³•,ä½†æ•ˆç‡å¤ªä½\nclass Singleton {\n    private Singleton() {}\n    private static Singleton instance;\n    public static synchronized Singleton getInstance() {\n        if(instance == null) { \n            instance = new Singleton();\n        }\n        return instance;\n    }\n}\n\n//åŒé‡æ£€æŸ¥ï¼šçº¿ç¨‹å®‰å…¨ï¼›å»¶è¿ŸåŠ è½½ï¼›æ•ˆç‡è¾ƒé«˜âˆš\nclass Singleton {\n    private Singleton() {}\n    private static volatile Singleton instance;//å°†çº¿ç¨‹ä¸­çš„ä¸œè¥¿æ›´æ–°åˆ°ä¸»å­˜\n    //éœ€è¦åŠ volatileå…³é”®å­—ï¼Œå¦åˆ™ä¼šå‡ºç°é”™è¯¯ï¼Œå› ä¸ºJVMæŒ‡ä»¤çš„é‡æ’ä¼˜åŒ–\n    //åˆ›å»ºå¯¹è±¡åŒ…æ‹¬ä¸‰ä¸ªæŒ‡ä»¤\n    //    1.new #2 &lt;T&gt; ï¼šåˆ†é…å†…å­˜åœ°å€ï¼Œå±æ€§åˆå§‹åŒ–å¹¶èµ‹äºˆé»˜è®¤å€¼\n    //    2.invokespecial #3 &lt;T.&lt;init&gt;&gt; è°ƒç”¨æ„é€ æ–¹æ³•å¹¶å®Œæˆå¯¹è±¡åˆå§‹åŒ–\n    //    3.astore_1 å°†å¯¹è±¡æŒ‡é’ˆæŒ‡å‘å¯¹è±¡ å¦‚æœä»¥ä¸Šä¸‰ä¸ªæŒ‡ä»¤é¡ºåºé”™è¯¯ï¼Œå°†å¯¼è‡´ç¨‹åºå‡ºé”™\n    public static Singleton getInstance() {\n        if(instance == null) {\n            synchronized (Singleton.class) {\n                if(instance == null) {\n                    instance = new Singleton();\n                }\n            }\n        }\n        return instance;\n    }\n}\n\n//é™æ€å†…éƒ¨ç±»ï¼šå»¶æ—¶åŠ è½½ï¼Œæ•ˆç‡é«˜ï¼›ç±»çš„é™æ€å±æ€§åªä¼šåœ¨ç¬¬ä¸€æ¬¡åŠ è½½ç±»çš„æ—¶å€™åˆå§‹åŒ–ï¼Œåœ¨ç±»è¿›è¡Œåˆå§‹åŒ–æ—¶ï¼Œåˆ«çš„çº¿ç¨‹æ˜¯æ— æ³•è¿›å…¥çš„ã€‚ä¿è¯äº†çº¿ç¨‹çš„å®‰å…¨æ€§âˆš\nclass Singleton {\n    private Singleton() {}\n    private static class SingletonInstance {\n        private static final Singleton INSTANCE = new Singleton(); //å†™ä¸€ä¸ªé™æ€å†…éƒ¨ç±»,è¯¥ç±»ä¸­æœ‰ä¸€ä¸ªé™æ€å±æ€§ Singleton\n    }\n    public static Singleton getInstance() {\n        return SingletonInstance.INSTANCE;\n    }\n}\n\n//æšä¸¾ï¼šæšä¸¾çº¿ç¨‹å®‰å…¨ï¼Œè€Œä¸”è¿˜èƒ½é˜²æ­¢ååºåˆ—åŒ–é‡æ–°åˆ›å»ºæ–°çš„å¯¹è±¡ã€‚\npublic class Cilent {\n    public static void main(String[] args) {\n        Singleton instance = Singleton.INSTANCE;            \n        instance.sayOK();\n    }\n}\nenum Singleton {\n    INSTANCE;\n    public void sayOK() { System.out.println(\"ok~\"); }\n}\n</code></pre></div><h3>3.1.2. å·¥å‚æ¨¡å¼</h3>\n<ul>\n<li>å·¥å‚æ¨¡å¼:å¤§é‡çš„åˆ›å»ºæŸç§ã€æŸç±»æˆ–è€…æŸæ‰¹å¯¹è±¡ï¼Œå®šä¹‰åˆ›å»ºå¯¹è±¡çš„æŠ½è±¡æ–¹æ³•ï¼Œç”±å­ç±»å†³å®šè¦å®ä¾‹åŒ–çš„ç±»ã€‚å·¥å‚æ–¹æ³•æ¨¡å¼å°†å¯¹è±¡çš„å®ä¾‹åŒ–æ¨è¿Ÿåˆ°å­ç±»ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>class Client{\n    public static void main(String[] args) {\n        new ProductFactoryB().useProduct(\"ProductC\");\n    }\n}\n\ninterface Product{void createProduct();}\n\nclass ProductA implements Product{public void createProduct(){System.out.println(\"ProductA\");}}\nclass ProductB implements Product{public void createProduct(){System.out.println(\"ProductB\");}}\nclass ProductC implements Product{public void createProduct(){System.out.println(\"ProductC\");}}\nclass ProductD implements Product{public void createProduct(){System.out.println(\"ProductD\");}}\n\n//æŠ½è±¡å·¥å‚ï¼šæè¿°å…·ä½“å·¥å‚çš„å…¬å…±æ¥å£ æ ¸å¿ƒï¼Œåªéœ€ä¼ å…¥åå­—\nabstract class ProductFactory {\n    private Product product = null;\n    void useProduct(String name){product = getProduct(name);product.createProduct();}\n    abstract Product getProduct(String name);\n}\n\n//å…·ä½“å·¥å‚ï¼šæè¿°å…·ä½“å·¥å‚ï¼Œåˆ›å»ºäº§å“çš„å®ä¾‹ï¼Œä¾›å¤–ç•Œè°ƒç”¨\nclass ProductFactoryA extends ProductFactory{\n    public Product getProduct(String name){\n        if(name.equals(\"ProductA\")){ return new ProductA(); }else{ return new ProductB(); }\n    }\n}\n\nclass ProductFactoryB extends ProductFactory{\n    public Product getProduct(String name){\n        if(name.equals(\"ProductC\")){ return new ProductC(); }else{ return new ProductD(); }\n    }\n}\n</code></pre></div><h3>3.1.3. æŠ½è±¡å·¥å‚æ¨¡å¼</h3>\n<ul>\n<li>æŠ½è±¡å·¥å‚æ¨¡å¼ï¼šå®šä¹‰äº†ä¸€ä¸ªinterfaceç”¨äºåˆ›å»ºç›¸å…³æˆ–æœ‰ä¾èµ–å…³ç³»çš„å¯¹è±¡ç°‡ï¼Œè€Œæ— éœ€æŒ‡æ˜å…·ä½“çš„ç±»</li>\n<li>å°†å·¥å‚æŠ½è±¡æˆä¸¤å±‚ï¼ŒAbsFactory(æŠ½è±¡å·¥å‚) å’Œ å…·ä½“å®ç°çš„å·¥å‚å­ç±»ã€‚ç¨‹åºå‘˜å¯ä»¥æ ¹æ®åˆ›å»ºå¯¹è±¡ç±»å‹ä½¿ç”¨å¯¹åº”çš„å·¥å‚å­ç±»ã€‚è¿™æ ·å°†å•ä¸ªçš„ç®€å•å·¥å‚ç±»å˜æˆäº†å·¥å‚ç°‡ï¼Œæ›´åˆ©äºä»£ç çš„ç»´æŠ¤å’Œæ‰©å±•</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>class Client{\n    public static void main(String[] args) {\n        new FoodFactory(new ProductFactoryB()).getProduct(\"ProductC\");\n    }\n}\n\ninterface Product{void createProduct();}\n\nclass ProductA implements Product{public void createProduct(){System.out.println(\"ProductA\");}}\nclass ProductB implements Product{public void createProduct(){System.out.println(\"ProductB\");}}\nclass ProductC implements Product{public void createProduct(){System.out.println(\"ProductC\");}}\nclass ProductD implements Product{public void createProduct(){System.out.println(\"ProductD\");}}\n\n//æŠ½è±¡å·¥å‚ï¼šæè¿°å…·ä½“å·¥å‚çš„å…¬å…±æ¥å£\ninterface AbsProductFactory {public Product getProduct(String name);}\n\n//å…·ä½“å·¥å‚ï¼šæè¿°å…·ä½“å·¥å‚ï¼Œåˆ›å»ºäº§å“çš„å®ä¾‹ï¼Œä¾›å¤–ç•Œè°ƒç”¨\nclass ProductFactoryA implements AbsProductFactory{\n    public Product getProduct(String name){\n        if(name.equals(\"ProductA\")){ return new ProductA(); }else{ return new ProductB(); }\n    }\n}\n\nclass ProductFactoryB implements AbsProductFactory{\n    public Product getProduct(String name){\n        if(name.equals(\"ProductC\")){ return new ProductC(); }else{ return new ProductD(); }\n    }\n}\n\n//æŠ½è±¡äº§å“æ—ï¼šæè¿°æŠ½è±¡äº§å“çš„å…¬å…±æ¥å£ æ ¸å¿ƒã€‚ä¼ å…¥å·¥å‚å’Œåå­— å¢åŠ äº†è¿™ä¸ªç±»å¯ä»¥æŒ‡å®šå·¥å‚ç”Ÿäº§\nclass FoodFactory {\n    AbsProductFactory factory;\n    public FoodFactory(AbsProductFactory factory) {\n        this.factory = factory;\n    }\n    public void getProduct(String name) {\n        this.factory.getProduct(name).createProduct();\n    }\n}\n</code></pre></div><h3>3.1.4. åŸå‹æ¨¡å¼</h3>\n<ul>\n<li>åŸå‹æ¨¡å¼(Prototypeæ¨¡å¼):æ‹·è´å¯¹è±¡å®ä¾‹ï¼ˆä¸æ˜¯åŒä¸€ä¸ªå¯¹è±¡ï¼‰è¿èƒŒäº†ocpåŸåˆ™ï¼›é€ƒé¿æ„é€ å‡½æ•°çš„çº¦æŸ</li>\n<li>èµ„æºä¼˜åŒ–åœºæ™¯:ç±»åˆå§‹åŒ–éœ€è¦æ¶ˆåŒ–éå¸¸å¤šçš„èµ„æºï¼Œè¿™ä¸ªèµ„æºåŒ…æ‹¬æ•°æ®ã€ç¡¬ä»¶èµ„æºç­‰ã€‚</li>\n<li>æ€§èƒ½å’Œå®‰å…¨è¦æ±‚çš„åœºæ™¯:é€šè¿‡newäº§ç”Ÿä¸€ä¸ªå¯¹è±¡éœ€è¦éå¸¸ç¹ççš„æ•°æ®å‡†å¤‡æˆ–è®¿é—®æƒé™æ—¶</li>\n<li>ä¸€ä¸ªå¯¹è±¡å¤šä¸ªä¿®æ”¹è€…çš„åœºæ™¯:ä¸€ä¸ªå¯¹è±¡éœ€è¦æä¾›ç»™å…¶ä»–å¯¹è±¡è®¿é—®ï¼Œè€Œä¸”å„ä¸ªè°ƒç”¨è€…å¯èƒ½éƒ½éœ€è¦ä¿®æ”¹å…¶å€¼æ—¶ï¼Œå¯ä»¥ä½¿ç”¨åŸå‹æ¨¡å¼æ‹·è´å¤šä¸ªå¯¹è±¡ä¾›è°ƒç”¨è€…ä½¿ç”¨</li>\n<li>åˆ›å»ºæ–°çš„å¯¹è±¡æ¯”è¾ƒå¤æ‚æ—¶ï¼Œå¯ä»¥åˆ©ç”¨åŸå‹æ¨¡å¼ç®€åŒ–å¯¹è±¡çš„åˆ›å»ºè¿‡ç¨‹ï¼ŒåŒæ—¶ä¹Ÿèƒ½å¤Ÿæé«˜æ•ˆç‡</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æµ…æ‹·è´ä»…ä»…å¤åˆ¶æ‰€è€ƒè™‘çš„å¯¹è±¡ï¼Œè€Œä¸å¤åˆ¶å®ƒæ‰€å¼•ç”¨çš„å¯¹è±¡(åŸºæœ¬æ•°æ®ç±»å‹ç›´æ¥å¤åˆ¶ï¼Œå¼•ç”¨æ•°æ®ç±»å‹å¼•ç”¨ä¼ é€’)\n//1.å®ç°Cloneableæ¥å£ï¼Œ2.é‡å†™clone()æ–¹æ³•ï¼š\npublic class Client {\n    public static void main(String[] args) {\n        Sheep sheep = new Sheep(\"tom\");\n        Sheep firend = new Sheep(\"jack\");\n        sheep.setFriend(firend);\n        Sheep sheep2 = (Sheep)sheep.clone(); //å…‹éš†\n        System.out.println(\"firend=\" + firend + \",sheep2.friend=\" + sheep2.getFriend());\n    }\n}\n\nclass Sheep implements Cloneable {\n    private String name;//åŸºæœ¬æ•°æ®ç±»å‹ç›´æ¥å¤åˆ¶\n    private Sheep friend; //å¼•ç”¨æ•°æ®ç±»å‹å¼•ç”¨ä¼ é€’\n    public Sheep(String name) {this.name = name;}\n\n    public String getName() { return name; }\n    public Sheep getFriend() { return friend; }\n    public void setFriend(Sheep friend) { this.friend = friend; }\n\n    @Override\n    protected Object clone()  {//å…‹éš†è¯¥å®ä¾‹ï¼Œä½¿ç”¨é»˜è®¤çš„cloneæ–¹æ³•æ¥å®Œæˆ\n        Sheep sheep = null;\n        try {\n            sheep = (Sheep)super.clone();\n        } catch (Exception e) {}\n        return sheep;\n    }\n}\n\n//æ·±æ‹·è´æŠŠè¦å¤åˆ¶çš„å¯¹è±¡æ‰€å¼•ç”¨çš„å¯¹è±¡éƒ½å¤åˆ¶äº†ä¸€é\n//1.é‡å†™cloneæ–¹æ³•æ¥å®ç°æ·±æ‹·è´ï¼Œç„¶åå¯¹æ‰€æœ‰å¼•ç”¨å±æ€§è¿›è¡Œæ‹·è´\n//2.é€šè¿‡å¯¹è±¡åºåˆ—åŒ–å®ç°æ·±æ‹·è´(æ¨è)\npublic class Client {\n    public static void main(String[] args) throws Exception {\n        Sheep sheep = new Sheep(\"tom\");\n        Sheep firend = new Sheep(\"jack\");\n        sheep.setFriend(firend);\n        //æ–¹å¼1 å®Œæˆæ·±æ‹·è´\n//      Sheep sheep2 = (Sheep)sheep.clone();\n//      System.out.println(\"firend=\" + firend + \",sheep2.friend=\" + sheep2.getFriend());\n        //æ–¹å¼2 å®Œæˆæ·±æ‹·è´\n        Sheep sheep2 = (Sheep)sheep.deepClone();\n        System.out.println(\"firend=\" + firend + \",sheep2.friend=\" + sheep2.getFriend());\n    }\n}\n\nclass Sheep implements Cloneable,Serializable {\n    private String name;//åŸºæœ¬æ•°æ®ç±»å‹ç›´æ¥å¤åˆ¶\n    private Sheep friend; //å¼•ç”¨æ•°æ®ç±»å‹å¼•ç”¨ä¼ é€’\n    public Sheep(String name) { this.name = name; }\n\n    public String getName() { return name; }\n    public Sheep getFriend() { return friend; }\n    public void setFriend(Sheep friend) { this.friend = friend; }\n\n    @Override\n    protected Object clone()  {//å…‹éš†è¯¥å®ä¾‹ï¼Œä½¿ç”¨é»˜è®¤çš„cloneæ–¹æ³•æ¥å®Œæˆ\n        Sheep sheep = null;\n        try {\n            sheep = (Sheep)super.clone();\n            sheep.setFriend((Sheep) friend.clone());\n        } catch (Exception e) {}\n        return sheep;\n    }\n\n    //æ·±æ‹·è´ - æ–¹å¼2 é€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å®ç° (æ¨è)\n    public Object deepClone() {\n        ByteArrayOutputStream bos = null;\n        ObjectOutputStream oos = null;\n        ByteArrayInputStream bis = null;\n        ObjectInputStream ois = null;\n        try {\n            //åºåˆ—åŒ–\n            bos = new ByteArrayOutputStream();\n            oos = new ObjectOutputStream(bos);\n            oos.writeObject(this); //å½“å‰è¿™ä¸ªå¯¹è±¡ä»¥å¯¹è±¡æµçš„æ–¹å¼è¾“å‡º\n            //ååºåˆ—åŒ–\n            bis = new ByteArrayInputStream(bos.toByteArray());\n            ois = new ObjectInputStream(bis);\n            Sheep copyObj = (Sheep) ois.readObject();\n            return copyObj;\n        } catch (Exception e) {\n            e.printStackTrace();\n            return null;\n        } finally {//å…³é—­æµ\n            try {\n                bos.close();\n                oos.close();\n                bis.close();\n                ois.close();\n            } catch (Exception e2) {\n                System.out.println(e2.getMessage());\n            }\n        }\n    }\n}\n</code></pre></div><h3>3.1.5. å»ºé€ è€…æ¨¡å¼</h3>\n<ul>\n<li>å»ºé€ è€…æ¨¡å¼ï¼Œå°†<strong>ç»„æˆéƒ¨åˆ†ç›¸ä¼¼</strong>çš„å¤æ‚å¯¹è±¡çš„å»ºé€ è¿‡ç¨‹æŠ½è±¡å‡ºæ¥ï¼ˆæŠ½è±¡ç±»åˆ«ï¼‰ï¼Œä½¿è¿™ä¸ªæŠ½è±¡è¿‡ç¨‹çš„ä¸åŒå®ç°æ–¹æ³•å¯ä»¥æ„é€ å‡ºä¸åŒè¡¨ç°ï¼ˆå±æ€§ï¼‰çš„å¯¹è±¡ã€‚</li>\n<li>å»ºé€ è€…æ¨¡å¼æ˜¯ä¸€æ­¥ä¸€æ­¥åˆ›å»ºä¸€ä¸ªå¤æ‚çš„å¯¹è±¡ï¼Œå®ƒå…è®¸ç”¨æˆ·åªé€šè¿‡æŒ‡å®šå¤æ‚å¯¹è±¡çš„ç±»å‹å’Œå†…å®¹å°±å¯ä»¥æ„å»ºå®ƒä»¬ï¼Œç”¨æˆ·ä¸éœ€è¦çŸ¥é“å†…éƒ¨çš„å…·ä½“æ„å»ºç»†èŠ‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client{\n    public static void main(String[] args) {\n        System.out.println(new ProductDricter().build(new ProductBuilder()));\n    }\n}\n\n//Productï¼ˆäº§å“è§’è‰²ï¼‰ï¼š ä¸€ä¸ªå…·ä½“çš„äº§å“å¯¹è±¡ã€‚\nclass Product{\n    private String name;\n    private String price;\n    public String getName() { return name; }\n    public void setName(String name) { this.name = name; }\n    public String getPrice() { return price; }\n    public void setPrice(String price) { this.price = price; }\n\n    public String toString() { return \"Product{name=\" + name + \", price=\" + price + \"}\"; }\n}\n\n//æŠ½è±¡å»ºé€ è€…ï¼š åˆ›å»ºä¸€ä¸ªProductå¯¹è±¡çš„å„ä¸ªéƒ¨ä»¶æŒ‡å®šçš„ æ¥å£/æŠ½è±¡ç±»\nabstract class Builder{\n    protected Product product = new Product();\n    abstract void buildName();\n    abstract void bulidPrice();\n    public Product getProduct(){return product;}\n}\n\n//å¤šä¸ªå…·ä½“å»ºé€ è€…\nclass ProductBuilder extends Builder{\n    public void buildName(){this.product.setName(\"ç‚¸é¸¡\");}\n    public void bulidPrice(){this.product.setPrice(\"10å…ƒ\");}\n    public Product getProduct(){return product;}\n}\n\n//æŒ‡æŒ¥è€… ä¼ å…¥ä¸åŒçš„åˆ¶é€ è€…\nclass ProductDricter {\n    public Product build(Builder builder){\n        builder.buildName();\n        builder.bulidPrice();\n        return builder.getProduct();\n    }\n}\n</code></pre></div><h2>3.2. ç»“æ„å‹æ¨¡å¼</h2>\n<h3>3.2.1. é€‚é…å™¨æ¨¡å¼</h3>\n<ul>\n<li>é€‚é…å™¨æ¨¡å¼(Adapter Pattern)å°†ä¸€ä¸ªç±»çš„æ¥å£è½¬æ¢æˆå¦ä¸€ç§æ¥å£.è®©åŸæœ¬æ¥å£ä¸å…¼å®¹çš„ç±»å¯ä»¥å…¼å®¹</li>\n<li>ç”¨æˆ·è°ƒç”¨é€‚é…å™¨è½¬åŒ–å¤„ç†çš„ç›®æ ‡æ¥å£æ–¹æ³•ï¼Œé€‚é…å™¨åœ¨è°ƒç”¨è¢«é€‚é…è€…çš„ç›¸å…³æ¥å£æ–¹æ³•</li>\n<li><strong>Cæ ¹æ®æ¥å£è¦æ±‚å°†ä¸åˆé€‚çš„ç±»Aè½¬æˆæ¥å£è¦çš„ç±»Bï¼Œåªä¸è¿‡ä¼ å…¥ä¸åˆé€‚ç±»Açš„æ–¹å¼ä¸ä¸€æ ·</strong></li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        new ClassAdapter().request();\n        new ObjectAdapter(new Adaptee()).request();\n    }\n}\n\n//ç›®æ ‡æ¥å£\ninterface Target{public void request();}\n\n//è¢«é€‚é…ç±»ï¼ˆä¸ç¬¦åˆè¦æ±‚çš„ç±»ï¼‰\nclass Adaptee{public void specialRequest(){System.out.println(\"é€‚é…è€…ä¸­çš„ä¸šåŠ¡ä»£ç è¢«è°ƒç”¨!\");}}\n\n\n//ç±»é€‚é…å™¨æ¨¡å¼-é€‚é…å™¨ç±»å®ç°ç›®æ ‡æ¥å£å¹¶ç»§æ‰¿è¢«é€‚é…ç±»å®Œæˆç›®æ ‡æ¥å£è½¬æ¢\nclass ClassAdapter extends Adaptee implements Target{\n    @Override\n    public void request(){\n        specialRequest();\n    };\n}\n\n//å¯¹è±¡é€‚é…æ¨¡å¼-å¯¹è±¡é€‚é…ç±»\nclass ObjectAdapter implements Target{\n    private Adaptee adaptee;//ç»§æ‰¿æ”¹æˆå®ç° å…³è”å…³ç³»-èšåˆ\n    public ObjectAdapter(Adaptee adaptee) {\n        this.adaptee = adaptee;\n    }\n    @Override\n    public void request(){\n        adaptee.specialRequest();\n    }\n}\n\n//æ¥å£é€‚é…å™¨æ¨¡å¼-æ¥å£é€‚é…ç±»\nabstract class InterfaceAdapter implements Target{public void request(){}}\n\npublic class Client {\n    public static void main(String[] args) {\n        InterfaceAdapter interfaceAdapter = new InterfaceAdapter() {\n            @Override\n            public void request() {\n                System.out.println(\"ä½¿ç”¨äº†m1çš„æ–¹æ³•\");\n            }\n        };\n        interfaceAdapter.request();\n    }\n}\n\n</code></pre></div><h3>3.2.2. æ¡¥æ¥æ¨¡å¼</h3>\n<ul>\n<li>æ¡¥æ¥æ¨¡å¼(Bridgeæ¨¡å¼)ï¼šå°†å®ç°ä¸æŠ½è±¡æ”¾åœ¨ä¸¤ä¸ªä¸åŒçš„ç±»å±‚æ¬¡ä¸­ï¼Œä½¿ä¸¤ä¸ªå±‚æ¬¡å¯ä»¥ç‹¬ç«‹æ”¹å˜ã€‚</li>\n<li>æ¡¥æ¥æ¨¡å¼è¦æ±‚æ­£ç¡®è¯†åˆ«å‡ºç³»ç»Ÿä¸­<strong>ä¸¤ä¸ªç‹¬ç«‹å˜åŒ–çš„ç»´åº¦</strong>ï¼Œå› æ­¤å…¶ä½¿ç”¨èŒƒå›´æœ‰ä¸€å®šçš„å±€é™æ€§ï¼Œå³éœ€è¦æœ‰è¿™æ ·çš„åº”ç”¨åœºæ™¯ã€‚</li>\n<li>å¯¹äºé‚£äº›ä¸å¸Œæœ›ä½¿ç”¨ç»§æ‰¿æˆ–å› ä¸ºå¤šå±‚æ¬¡ç»§æ‰¿å¯¼è‡´ç³»ç»Ÿç±»çš„ä¸ªæ•°æ€¥å‰§å¢åŠ çš„ç³»ç»Ÿï¼Œæ¡¥æ¥æ¨¡å¼å°¤ä¸ºé€‚ç”¨.</li>\n<li>å¸¸è§çš„åº”ç”¨åœºæ™¯: -JDBCé©±åŠ¨ç¨‹åº</li>\n<li>é“¶è¡Œè½¬è´¦ç³»ç»Ÿ\n<ul>\n<li>è½¬è´¦åˆ†ç±»: ç½‘ä¸Šè½¬è´¦ï¼ŒæŸœå°è½¬è´¦ï¼ŒAMTè½¬è´¦</li>\n<li>è½¬è´¦ç”¨æˆ·ç±»å‹ï¼šæ™®é€šç”¨æˆ·ï¼Œé“¶å¡ç”¨æˆ·ï¼Œé‡‘å¡ç”¨æˆ·..</li>\n</ul>\n</li>\n<li>æ¶ˆæ¯ç®¡ç†\n<ul>\n<li>æ¶ˆæ¯ç±»å‹ï¼šå³æ—¶æ¶ˆæ¯ï¼Œå»¶æ—¶æ¶ˆæ¯</li>\n<li>æ¶ˆæ¯åˆ†ç±»ï¼šæ‰‹æœºçŸ­ä¿¡ï¼Œé‚®ä»¶æ¶ˆæ¯ï¼ŒQQæ¶ˆæ¯...</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æ¡¥æ¥æ¨¡å¼:å°†Cçš„åŠŸèƒ½æŠ½è±¡ä¸ºæ¥å£Aï¼Œå°†Açš„åŠŸèƒ½æ¡¥æ¥å›åˆ°Cä¸Šï¼Œè°ƒç”¨Cçš„æ–¹æ³•ç›¸å½“äºè°ƒç”¨Açš„å®ç°æ–¹æ³•\npublic class Client{\n    public static void main(String[] args) {\n        RefinedAbstraction refinedAbstraction = new RefinedAbstraction();\n        refinedAbstraction.setImplementor(new ConcreteImplementorA());\n        refinedAbstraction.do1();\n    }\n}\n\n//å®ç°åŒ–è§’è‰²\ninterface Implementor{public void do1();}\n\n//å…·ä½“å®ç°åŒ–è§’è‰²\nclass ConcreteImplementorA implements Implementor{public void do1(){}}\n\n//æŠ½è±¡åŒ–è§’è‰²\nabstract class Abstraction {//æ¡¥æ¥ç±»\n    protected Implementor implementor;\n    public void setImplementor(Implementor implementor){this.implementor = implementor;}\n    protected abstract void do1();\n}\n\n//æ‰©å±•æŠ½è±¡åŒ–è§’è‰²\nclass RefinedAbstraction extends Abstraction{\n    public void do1(){this.implementor.do1();System.out.println(\"å­ç±»è‡ªå·±çš„åŠŸèƒ½\");}\n}\n</code></pre></div><h3>3.2.3. è£…é¥°è€…æ¨¡å¼</h3>\n<ul>\n<li>è£…é¥°è€…æ¨¡å¼ï¼šåŠ¨æ€çš„å°†æ–°åŠŸèƒ½é™„åŠ åˆ°å¯¹è±¡ä¸Šã€‚åœ¨å¯¹è±¡åŠŸèƒ½æ‰©å±•æ–¹é¢ï¼Œå®ƒæ¯”ç»§æ‰¿æ›´æœ‰å¼¹æ€§</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        D d = new D();\n        d.setA(new B());\n        System.out.println(d.fun());\n    }\n}\n\n//æŠ½è±¡æ„ä»¶è§’è‰²\ninterface A{int fun();}\n\n//å…·ä½“æ„ä»¶è§’è‰²\nclass B implements A{public int fun(){return 1;}}\n\n//æŠ½è±¡è£…é¥°è§’è‰²\nabstract class C implements A{\n    private A a;\n    public void setA(A a){this.a = a;}\n    public int fun(){return a.fun();};\n}\n\n//å…·ä½“è£…é¥°è§’è‰²\nclass D extends C{\n    public int fun(){\n        return super.fun() + decorate();\n    }\n    private int decorate(){System.out.println(\"ä¸ºå…·ä½“æ„ä»¶è§’è‰²å¢åŠ é¢å¤–çš„åŠŸèƒ½\");return 1;}//è£…é¥°\n}\n</code></pre></div><h3>3.2.4. ç»„åˆæ¨¡å¼</h3>\n<ul>\n<li>ç»„åˆæ¨¡å¼ï¼ˆComposite Patternï¼‰ï¼Œåˆå«éƒ¨åˆ†æ•´ä½“æ¨¡å¼ï¼Œå®ƒåˆ›å»ºäº†å¯¹è±¡ç»„çš„æ ‘å½¢ç»“æ„ï¼Œå°†å¯¹è±¡ç»„åˆæˆæ ‘çŠ¶ç»“æ„ä»¥è¡¨ç¤ºâ€œæ•´ä½“-éƒ¨åˆ†â€çš„å±‚æ¬¡å…³ç³»</li>\n<li>ç»„åˆæ¨¡å¼è®©å®¢æˆ·ä»¥ä¸€è‡´çš„æ–¹å¼å¤„ç†ä¸ªåˆ«å¯¹è±¡ä»¥åŠç»„åˆå¯¹è±¡</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client{\n    public static void main(String[] args) {\n        B b = new B();\n        C c = new C();\n        D d = new D();\n        b.addA(c);\n        c.addA(d);\n        b.print();\n    }\n}\n\n//BCDå®ç°ç»§æ‰¿ä¸€ä¸ªæŠ½è±¡ç±»è¾¾åˆ°åµŒå¥—ç»„åˆçš„ç›®çš„ï¼Œå±‚å±‚åŒ…å«çš„å…³ç³»\nabstract class A{protected void addA(A a){} protected abstract void print();}\n\nclass B extends A{\n    private List&lt;A&gt; list = new ArrayList&lt;A&gt;();\n    public void addA(A a){list.add(a);}\n    public void print(){for(A a:list){a.print();}}\n}\n\nclass C extends A{\n    private List&lt;A&gt; list = new ArrayList&lt;A&gt;();\n    public void addA(A a){list.add(a);}\n    public void print(){for(A a:list){a.print();}}\n}\n\nclass D extends A{\n    private List&lt;A&gt; list = new ArrayList&lt;A&gt;();\n    public void addA(A a){list.add(a);}\n    public void print(){System.out.print(\"D\");};\n}\n</code></pre></div><h3>3.2.5. å¤–è§‚è€…æ¨¡å¼</h3>\n<ul>\n<li>å¤–è§‚æ¨¡å¼ï¼ˆFacadeï¼‰ä¸ºå­ç³»ç»Ÿä¸­çš„ä¸€ç»„æ¥å£æä¾›ä¸€ä¸ªä¸€è‡´çš„ç•Œé¢ï¼Œæ­¤æ¨¡å¼å®šä¹‰äº†ä¸€ä¸ªé«˜å±‚æ¥å£ï¼Œè¿™ä¸ªæ¥å£ä½¿å¾—è¿™ä¸€å­ç³»ç»Ÿæ›´åŠ å®¹æ˜“ä½¿ç”¨</li>\n<li>å¤–è§‚æ¨¡å¼é€šè¿‡å®šä¹‰ä¸€ä¸ªä¸€è‡´çš„æ¥å£ï¼Œç”¨ä»¥å±è”½å†…éƒ¨å­ç³»ç»Ÿçš„ç»†èŠ‚ï¼Œä½¿å¾—è°ƒç”¨ç«¯åªéœ€è·Ÿè¿™ä¸ªæ¥å£å‘ç”Ÿè°ƒç”¨ï¼Œè€Œæ— éœ€å…³å¿ƒè¿™ä¸ªå­ç³»ç»Ÿçš„å†…éƒ¨ç»†èŠ‚</li>\n<li>å½“ç³»ç»Ÿéœ€è¦åˆ†å±‚æ¬¡è®¾è®¡æ—¶ï¼Œå¯ä»¥ä½¿ç”¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å¯¹Facadeæ“ä½œå®ç°å¯¹Aå’ŒBæ“ä½œ\npublic class Client{\n    public static void main(String[] args) {\n        Facade f = new Facade();\n        f.setA(new A());\n        f.setB(new B());\n        f.fun();\n        f.fun2();\n    }\n}\n\nclass Facade{\n    private A a;\n    private B b;\n    public void setA(A a){this.a=a;}\n    public void setB(B b){this.b=b;}\n    public void fun(){\n        a.fun1();b.fun4();//åˆ†ä¸¤ä¸ªå±‚æ¬¡äº†\n    }\n    public void fun2(){\n        b.fun3();a.fun2();\n    }\n}\n\nclass A {public void fun1(){System.out.println(\"fun1\");} public void fun2(){System.out.println(\"fun2\");}}\nclass B {public void fun3(){System.out.println(\"fun3\");} public void fun4(){System.out.println(\"fun4\");}}\n</code></pre></div><h3>3.2.6. äº«å…ƒæ¨¡å¼(æ± æŠ€æœ¯)</h3>\n<ul>\n<li>äº«å…ƒæ¨¡å¼ï¼ˆFlyweight Patternï¼‰: è¿ç”¨å…±äº«æŠ€æœ¯æœ‰æ•ˆåœ°æ”¯æŒå¤§é‡ç»†ç²’åº¦çš„å¯¹è±¡ï¼Œå‡å°‘å¯¹è±¡çš„åˆ›å»º</li>\n<li>å¸¸ç”¨äºç³»ç»Ÿåº•å±‚å¼€å‘ï¼Œè§£å†³ç³»ç»Ÿçš„æ€§èƒ½é—®é¢˜ã€‚åƒæ•°æ®åº“è¿æ¥æ± ï¼Œé‡Œé¢éƒ½æ˜¯åˆ›å»ºå¥½çš„è¿æ¥å¯¹è±¡ï¼Œåœ¨è¿™äº›è¿æ¥å¯¹è±¡ä¸­æœ‰æˆ‘ä»¬éœ€è¦çš„åˆ™ç›´æ¥æ‹¿æ¥ç”¨ï¼Œé¿å…é‡æ–°åˆ›å»ºï¼Œå¦‚æœæ²¡æœ‰æˆ‘ä»¬éœ€è¦çš„ï¼Œåˆ™åˆ›å»ºä¸€ä¸ª</li>\n<li>äº«å…ƒæ¨¡å¼èƒ½å¤Ÿè§£å†³é‡å¤å¯¹è±¡çš„å†…å­˜æµªè´¹çš„é—®é¢˜ï¼Œå½“ç³»ç»Ÿä¸­æœ‰å¤§é‡ç›¸ä¼¼å¯¹è±¡ï¼Œéœ€è¦ç¼“å†²æ± æ—¶ã€‚ä¸éœ€æ€»æ˜¯åˆ›å»ºæ–°å¯¹è±¡ï¼Œå¯ä»¥ä»ç¼“å†²æ± é‡Œæ‹¿ã€‚è¿™æ ·å¯ä»¥é™ä½ç³»ç»Ÿå†…å­˜ï¼ŒåŒæ—¶æé«˜æ•ˆç‡</li>\n<li>äº«å…ƒæ¨¡å¼ç»å…¸çš„åº”ç”¨åœºæ™¯å°±æ˜¯æ± æŠ€æœ¯äº†ï¼ŒStringå¸¸é‡æ± ã€æ•°æ®åº“è¿æ¥æ± ã€ç¼“å†²æ± ç­‰ç­‰éƒ½æ˜¯äº«å…ƒæ¨¡å¼çš„åº”ç”¨ï¼Œäº«å…ƒæ¨¡å¼æ˜¯æ± æŠ€æœ¯çš„é‡è¦å®ç°æ–¹å¼</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client{\n    public static void main(String[] args) {\n        B b = new B();\n        ((A) b.getA(\"test\")).fun();\n        ((A) b.getA(\"test\")).fun();\n    }\n}\nclass A{public void fun(){System.out.println(this);}}\n\nclass B{\n    private Map&lt;String,A&gt; map = new HashMap&lt;String,A&gt;();\n    public A getA(String name){\n        A a = map.get(name);\n        if(a == null){\n            A nA = new A();\n            map.put(name,nA);\n            return nA;\n        }\n        return a;\n    }\n}\n</code></pre></div><h3>3.2.7. ä»£ç†æ¨¡å¼(JDKä¸cglib)</h3>\n<ul>\n<li>ä»£ç†æ¨¡å¼ï¼šä¸ºä¸€ä¸ªå¯¹è±¡æä¾›ä¸€ä¸ªæ›¿èº«ï¼Œä»¥æ§åˆ¶å¯¹è¿™ä¸ªå¯¹è±¡çš„è®¿é—®ã€‚å³é€šè¿‡ä»£ç†å¯¹è±¡è®¿é—®ç›®æ ‡å¯¹è±¡.è¿™æ ·åšçš„å¥½å¤„æ˜¯:å¯ä»¥åœ¨ç›®æ ‡å¯¹è±¡å®ç°çš„åŸºç¡€ä¸Š,å¢å¼ºé¢å¤–çš„åŠŸèƒ½æ“ä½œ,å³æ‰©å±•ç›®æ ‡å¯¹è±¡çš„åŠŸèƒ½ã€‚</li>\n<li>è¢«ä»£ç†çš„å¯¹è±¡å¯ä»¥æ˜¯è¿œç¨‹å¯¹è±¡ã€åˆ›å»ºå¼€é”€å¤§çš„å¯¹è±¡æˆ–éœ€è¦å®‰å…¨æ§åˆ¶çš„å¯¹è±¡</li>\n<li>ä»£ç†æ¨¡å¼æœ‰ä¸åŒçš„å½¢å¼, ä¸»è¦æœ‰ä¸‰ç§ é™æ€ä»£ç†ã€åŠ¨æ€ä»£ç† (JDKä»£ç†ã€æ¥å£ä»£ç†)å’Œ Cglibä»£ç† (å¯ä»¥åœ¨å†…å­˜åŠ¨æ€çš„åˆ›å»ºå¯¹è±¡ï¼Œè€Œä¸éœ€è¦å®ç°æ¥å£ï¼Œ ä»–æ˜¯å±äºåŠ¨æ€ä»£ç†çš„èŒƒç•´) ã€‚</li>\n<li>ä»£ç†æ¨¡å¼(Proxy)çš„å˜ä½“\n<ul>\n<li>é˜²ç«å¢™ä»£ç†:å†…ç½‘é€šè¿‡ä»£ç†ç©¿é€é˜²ç«å¢™ï¼Œå®ç°å¯¹å…¬ç½‘çš„è®¿é—®ã€‚</li>\n<li>ç¼“å­˜ä»£ç†:æ¯”å¦‚ï¼šå½“è¯·æ±‚å›¾ç‰‡æ–‡ä»¶ç­‰èµ„æºæ—¶ï¼Œå…ˆåˆ°ç¼“å­˜ä»£ç†å–ï¼Œå¦‚æœå–åˆ°èµ„æºåˆ™ok,å¦‚æœå–ä¸åˆ°èµ„æºï¼Œå†åˆ°å…¬ç½‘æˆ–è€…æ•°æ®åº“å–ï¼Œç„¶åç¼“å­˜ã€‚</li>\n<li>è¿œç¨‹ä»£ç†:è¿œç¨‹å¯¹è±¡çš„æœ¬åœ°ä»£è¡¨ï¼Œé€šè¿‡å®ƒå¯ä»¥æŠŠè¿œç¨‹å¯¹è±¡å½“æœ¬åœ°å¯¹è±¡æ¥è°ƒç”¨ã€‚è¿œç¨‹ä»£ç†é€šè¿‡ç½‘ç»œå’ŒçœŸæ­£çš„è¿œç¨‹å¯¹è±¡æ²Ÿé€šä¿¡æ¯</li>\n<li>åŒæ­¥ä»£ç†:ä¸»è¦ä½¿ç”¨åœ¨å¤šçº¿ç¨‹ç¼–ç¨‹ä¸­ï¼Œå®Œæˆå¤šçº¿ç¨‹é—´åŒæ­¥å·¥ä½œ</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>- é™æ€ä»£ç†ï¼šéœ€è¦å®šä¹‰æ¥å£æˆ–è€…çˆ¶ç±»,è¢«ä»£ç†å¯¹è±¡(å³ç›®æ ‡å¯¹è±¡)ä¸ä»£ç†å¯¹è±¡ä¸€èµ·å®ç°ç›¸åŒçš„æ¥å£æˆ–è€…æ˜¯ç»§æ‰¿ç›¸åŒçˆ¶ç±»ï¼›ä¸€æ—¦æ¥å£å¢åŠ æ–¹æ³•ï¼Œç›®æ ‡å¯¹è±¡å’Œä»£ç†å¯¹è±¡éƒ½è¦ç»´æŠ¤ï¼Œå› ä¸ºä»£ç†å¯¹è±¡å’Œç›®æ ‡å¯¹è±¡å®ç°ä¸€æ ·çš„æ¥å£ï¼Œæ‰€ä»¥ä¼šæœ‰å¾ˆå¤šä»£ç†ç±»\npublic class Client{\n    public static void main(String[] args) {\n        B b = new B();\n        C c = new C();\n        c.setA(b);\n        c.fun();\n    }\n}\ninterface A{void fun();}\n\nclass B implements A{public void fun(){System.out.println(\"ç›®æ ‡å¯¹è±¡...\");}}//è¢«ä»£ç†å¯¹è±¡/ç›®æ ‡å¯¹è±¡\n\nclass C implements A{//ä»£ç†å¯¹è±¡\n    private B b;\n    private A a;\n    public void setA(A a){this.a = a;}\n    public void fun(){\n        System.out.println(\"å‰å¤„ç†....\");\n        this.a.fun();\n        System.out.println(\"åå¤„ç†....\");\n    }\n}\n\nåŠ¨æ€ä»£ç†æ¨¡å¼çš„(JDKä»£ç†ã€æ¥å£ä»£ç†)\n- ä»£ç†å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œä½†æ˜¯ç›®æ ‡å¯¹è±¡è¦å®ç°æ¥å£\n- ä»£ç†ç±»æ‰€åœ¨åŒ…:java.lang.reflect.Proxy\n- JDKå®ç°ä»£ç†åªéœ€è¦ä½¿ç”¨newProxyInstanceæ–¹æ³•,ä½†æ˜¯è¯¥æ–¹æ³•éœ€è¦æ¥æ”¶ä¸‰ä¸ªå‚æ•°,å®Œæ•´çš„å†™æ³•æ˜¯: \n    - static Object newProxyInstance(ClassLoader loader, Class&lt;?&gt;[] interfaces,InvocationHandler h )\n    - ClassLoader æŒ‡å®šå½“å‰ç›®æ ‡å¯¹è±¡ä½¿ç”¨çš„ç±»åŠ è½½å™¨ï¼Œè·å–åŠ è½½å™¨çš„æ–¹æ³•å›ºå®š\n    - Class&lt;?&gt;[] interfaces ç›®æ ‡å¯¹è±¡å®ç°çš„æ¥å£ç±»å‹ï¼Œä½¿ç”¨æ³›å‹æ–¹æ³•ç¡®è®¤ç±»å‹\n    - InvocationHandler h æ‰§è¡Œç›®æ ‡å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œä¼šè§¦å‘è¯¥æ–¹æ³•ï¼Œä¼šæŠŠå½“å‰æ‰§è¡Œçš„å¯¹è±¡æ–¹æ³•å½“å‚æ•°ä¼ å…¥\n\npublic class Client {\n    public static void main(String[] args) {\n        A proxyInstance = (A)new ProxyFactory(new B()).getProxyInstance();\n        proxyInstance.a();\n    }\n}\n\ninterface A {void a();}\n\nclass B implements A{ public void a() {System.out.println(\"ä»£ç†å¯¹è±¡\");} }//è¢«ä»£ç†å¯¹è±¡/ç›®æ ‡å¯¹è±¡\n\nclass ProxyFactory {\n    private Object target;\n    public ProxyFactory(Object target) {this.target = target;}\n    public Object getProxyInstance() {//ä»£ç†å¯¹è±¡\n        return Proxy.newProxyInstance(target.getClass().getClassLoader(), target.getClass().getInterfaces(),\n                new InvocationHandler() {\n                    public Object invoke(Object proxy, Method method, Object[] args) throws Throwable {\n                        System.out.println(\"å‰å¤„ç†....\");\n                        Object object = method.invoke(target, args);\n                        System.out.println(\"åå¤„ç†....\");\n                        return object;\n                    }\n                });\n    }\n}\n\nCglibä»£ç†/å­ç±»ä»£ç†\n- Cglibä»£ç†æ˜¯åœ¨å†…å­˜ä¸­æ„å»ºä¸€ä¸ªå­ç±»å¯¹è±¡ä»è€Œå®ç°å¯¹ç›®æ ‡å¯¹è±¡åŠŸèƒ½æ‰©å±•ã€‚\n- Cglibæ˜¯ä¸€ä¸ªå¼ºå¤§çš„é«˜æ€§èƒ½çš„ä»£ç ç”ŸæˆåŒ…,å®ƒå¯ä»¥åœ¨è¿è¡ŒæœŸæ‰©å±•javaç±»ä¸å®ç°javaæ¥ å£.å®ƒå¹¿æ³›çš„è¢«è®¸å¤šAOPçš„æ¡†æ¶ä½¿ç”¨,ä¾‹å¦‚Spring AOPï¼Œå®ç°æ–¹æ³•æ‹¦æˆª\n- åœ¨AOPç¼–ç¨‹ä¸­å¦‚ä½•é€‰æ‹©ä»£ç†æ¨¡å¼ï¼šç›®æ ‡å¯¹è±¡éœ€è¦å®ç°æ¥å£ï¼Œç”¨JDKä»£ç†ã€ç›®æ ‡å¯¹è±¡ä¸éœ€è¦å®ç°æ¥å£ï¼Œç”¨Cglibä»£ç†\n- CglibåŒ…çš„åº•å±‚æ˜¯é€šè¿‡ä½¿ç”¨å­—èŠ‚ç å¤„ç†æ¡†æ¶ASMæ¥è½¬æ¢å­—èŠ‚ç å¹¶ç”Ÿæˆæ–°çš„ç±»\npublic class Client {\n    public static void main(String[] args) {\n        A target = new A();\n        ((A)new ProxyFactory(target).getProxyInstance()).fun();\n    }\n}\n\nclass A{public void fun(){System.out.println(\"ä»£ç†å¯¹è±¡...\");}}\n\nclass ProxyFactory implements MethodInterceptor {\n    private Object target;\n    public ProxyFactory(Object target) {this.target = target;}\n    public Object getProxyInstance() {\n        Enhancer enhancer = new Enhancer();\n        enhancer.setSuperclass(target.getClass());\n        enhancer.setCallback(this);\n        return enhancer.create();\n    }\n    @Override\n    public Object intercept(Object arg0, Method method, Object[] args, MethodProxy proxy) throws Throwable {\n        System.out.println(\"å‰å¤„ç†....\");\n        Object object = method.invoke(target, args);\n        System.out.println(\"åå¤„ç†....\");\n        return object;\n    }\n}\n</code></pre></div><h2>3.3. è¡Œä¸ºå‹æ¨¡å¼</h2>\n<h3>3.3.1. æ¨¡æ¿æ–¹æ³•æ¨¡å¼</h3>\n<ul>\n<li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ï¼ˆTemplate Method Patternï¼‰ï¼Œåœ¨ä¸€ä¸ªæŠ½è±¡ç±»å…¬å¼€å®šä¹‰äº†æ‰§è¡Œå®ƒçš„æ–¹æ³•çš„æ¨¡æ¿ã€‚å®ƒçš„å­ç±»å¯ä»¥æŒ‰éœ€è¦é‡å†™æ–¹æ³•å®ç°ï¼Œä½†è°ƒç”¨å°†ä»¥æŠ½è±¡ç±»ä¸­å®šä¹‰çš„æ–¹å¼è¿›è¡Œã€‚</li>\n<li>æ¨¡æ¿æ–¹æ³•æ¨¡å¼ å®šä¹‰ä¸€ä¸ªæ“ä½œä¸­çš„ç®—æ³•çš„éª¨æ¶ï¼Œè€Œå°†ä¸€äº›æ­¥éª¤å»¶è¿Ÿåˆ°å­ç±»ä¸­ï¼Œä½¿å¾—å­ç±»å¯ä»¥ä¸æ”¹å˜ä¸€ä¸ªç®—æ³•çš„ç»“æ„ï¼Œå°±å¯ä»¥é‡å®šä¹‰è¯¥ç®—æ³•çš„æŸäº›ç‰¹å®šæ­¥éª¤</li>\n<li>ä¸€èˆ¬æ¨¡æ¿æ–¹æ³•åŠ ä¸Šfinalå…³é”®å­—ï¼Œé˜²æ­¢å­ç±»é‡æ–°æ¨¡æ¿æ–¹æ³•</li>\n<li>å½“è¦å®ŒæˆæŸä¸ªè¿‡ç¨‹ã€‚è¯¥è¿‡ç¨‹è¦æ‰§è¡Œä¸€ç³»åˆ—æ­¥éª¤ï¼Œè¿™ä¸€ç³»åˆ—çš„æ­¥éª¤åŸºæœ¬ç›¸åŒï¼Œä½†å…¶ä¸ªåˆ«æ­¥éª¤åœ¨å®ç°å¯èƒ½ä¸åŒï¼Œè€ƒè™‘ä½¿ç”¨æ¨¡æ¿æ–¹æ³•æ¨¡å¼æ¥å¤„ç†</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        A a = new B(); a.make();\n    }\n}\n\nabstract class A {\n    //æ¨¡æ¿æ–¹æ³•, make , æ¨¡æ¿æ–¹æ³•å¯ä»¥åšæˆfinal , ä¸è®©å­ç±»å»è¦†ç›–.\n    final void make() {if(gouzi()){B();}C();}\n    abstract void B();\n    abstract void C();\n    boolean gouzi(){return false;}//é»˜è®¤ä¸åšä»»ä½•äº‹ï¼Œå­ç±»å¯ä»¥è§†æƒ…å†µè¦ä¸è¦è¦†ç›–å®ƒï¼Œè¯¥æ–¹æ³•ç§°ä¸ºâ€œé’©å­â€ã€‚\n}\n\nclass B extends A{\n    void B(){System.out.println(\"Bå®ç°äº†æ¨¡æ¿æ–¹æ³•B\");};\n    void C(){System.out.println(\"Bå®ç°äº†æ¨¡æ¿æ–¹æ³•C\");};\n    boolean gouzi(){return true;}\n}\n</code></pre></div><h3>3.3.2. å‘½ä»¤æ¨¡å¼</h3>\n<ul>\n<li>å‘½ä»¤æ¨¡å¼ï¼šæˆ‘ä»¬ç»å¸¸éœ€è¦å‘æŸäº›å¯¹è±¡å‘é€è¯·æ±‚ï¼Œä½†æ˜¯å¹¶ä¸çŸ¥é“è¯·æ±‚çš„æ¥æ”¶è€…æ˜¯è°ï¼Œä¹Ÿä¸çŸ¥é“è¢«è¯·æ±‚çš„æ“ä½œæ˜¯å“ªä¸ªï¼Œåªéœ€åœ¨ç¨‹åºè¿è¡Œæ—¶æŒ‡å®šå…·ä½“çš„è¯·æ±‚æ¥æ”¶è€…å³å¯</li>\n<li>å‘½åæ¨¡å¼é€šè¿‡å‘½ä»¤å¯¹è±¡ä½¿å¾—è¯·æ±‚å‘é€è€…ä¸è¯·æ±‚æ¥æ”¶è€…æ¶ˆé™¤å½¼æ­¤ä¹‹é—´çš„è€¦åˆï¼Œè®©å¯¹è±¡ä¹‹é—´çš„è°ƒç”¨å…³ç³»æ›´åŠ çµæ´»ï¼Œå®ç°è§£è€¦ã€‚</li>\n<li>åœ¨å‘½åæ¨¡å¼ä¸­ï¼Œä¼šå°†ä¸€ä¸ªè¯·æ±‚å°è£…ä¸ºä¸€ä¸ªå¯¹è±¡ï¼Œä»¥ä¾¿ä½¿ç”¨ä¸åŒå‚æ•°æ¥è¡¨ç¤ºä¸åŒçš„è¯·æ±‚(å³å‘½å)ï¼ŒåŒæ—¶å‘½ä»¤æ¨¡å¼ä¹Ÿæ”¯æŒå¯æ’¤é”€çš„æ“ä½œã€‚</li>\n<li>å®¹æ˜“è®¾è®¡ä¸€ä¸ªå‘½ä»¤é˜Ÿåˆ—ã€‚åªè¦æŠŠå‘½ä»¤å¯¹è±¡æ”¾åˆ°åˆ—é˜Ÿï¼Œå°±å¯ä»¥å¤šçº¿ç¨‹çš„æ‰§è¡Œå‘½ä»¤ï¼›å®¹æ˜“å®ç°å¯¹è¯·æ±‚çš„æ’¤é”€å’Œé‡åš</li>\n<li>å‘½ä»¤æ¨¡å¼å¯èƒ½å¯¼è‡´æŸäº›ç³»ç»Ÿæœ‰è¿‡å¤šçš„å…·ä½“å‘½ä»¤ç±»ï¼Œå¢åŠ äº†ç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œè¿™ç‚¹åœ¨ä½¿ç”¨çš„æ—¶å€™è¦æ³¨æ„</li>\n<li>å‘½ä»¤æ¨¡å¼ç»å…¸ä½¿ç”¨åœºæ™¯ï¼šç•Œé¢çš„ä¸€ä¸ªæŒ‰é’®éƒ½æ˜¯ä¸€æ¡å‘½ä»¤ã€æ¨¡æ‹ŸCMDã€è®¢å•çš„æ’¤é”€/æ¢å¤ã€è§¦å‘-åé¦ˆæœºåˆ¶</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å‘½ä»¤è°ƒç”¨è€…é›†åˆäº†æ‰€æœ‰çš„å‘½ä»¤ï¼Œè°ƒç”¨å‘½ä»¤æ—¶å®é™…è°ƒç”¨æ¥æ”¶è€…çš„æ–¹æ³•ï¼Œè€Œå‘½ä»¤å¯ä»¥é€‰æ‹©è°ƒç”¨ä¸åŒçš„æ¥å—è€…æ–¹æ³•\npublic class Client {\n    public static void main(String[] args) {\n        Receiver receiver = new Receiver();\n        ConcreteCommand concreteCommand = new ConcreteCommand(receiver);\n        Invoker invoker = new Invoker();\n        invoker.takeCommand(concreteCommand);\n        invoker.placeCommands();\n    }\n}\n\n//å‘½ä»¤æ¨¡å¼ å‘½ä»¤æ¥å£å‘½ä»¤è§’è‰²Command\ninterface Command {void execute();}\n\n//è¯·æ±‚å®ç°ç±» å‘½ä»¤å®ç°ç±» ä¾èµ–æ¥æ”¶è€… å°†ä¸€ä¸ªæ¥å—è€…å¯¹è±¡ä¸ä¸€ä¸ªåŠ¨ä½œç»‘å®šï¼Œè°ƒç”¨æ¥å—è€…ç›¸åº”çš„åŠ¨ä½œï¼Œå®ç°execute\nclass ConcreteCommand implements Command {\n    private Receiver receiver;\n    public ConcreteCommand(Receiver receiver){this.receiver = receiver;}\n    public void execute() {receiver.buy();}\n}\n\n//è¯·æ±‚ç±» æ¥å—è€…Receiver\nclass Receiver {\n    public void buy(){}\n}\n\n//å‘½ä»¤è°ƒç”¨ç±»ï¼šè°ƒç”¨è€…è§’è‰²\nclass Invoker {\n    private List&lt;Command&gt; commandList = new ArrayList&lt;Command&gt;();\n    public void takeCommand(Command command){commandList.add(command);}\n    public void placeCommands(){\n        for (Command command : commandList) {\n            command.execute();\n        }\n    }\n}\n</code></pre></div><h3>3.3.3. è®¿é—®è€…æ¨¡å¼</h3>\n<ul>\n<li>è®¿é—®è€…æ¨¡å¼ï¼ˆVisitor Patternï¼‰ï¼Œå°è£…ä¸€äº›ä½œç”¨äºæŸç§æ•°æ®ç»“æ„çš„å„å…ƒç´ çš„æ“ä½œï¼Œå®ƒå¯ä»¥åœ¨ä¸æ”¹å˜æ•°æ®ç»“æ„çš„å‰æä¸‹å®šä¹‰ä½œç”¨äºè¿™äº›å…ƒç´ çš„æ–°çš„æ“ä½œã€‚</li>\n<li>ä¸»è¦å°†æ•°æ®ç»“æ„ä¸æ•°æ®æ“ä½œåˆ†ç¦»ï¼Œè§£å†³ æ•°æ®ç»“æ„å’Œæ“ä½œè€¦åˆæ€§é—®é¢˜</li>\n<li>è®¿é—®è€…æ¨¡å¼çš„åŸºæœ¬å·¥ä½œåŸç†æ˜¯ï¼šåœ¨è¢«è®¿é—®çš„ç±»é‡Œé¢åŠ ä¸€ä¸ªå¯¹å¤–æä¾›æ¥å¾…è®¿é—®è€…çš„æ¥å£</li>\n<li>è®¿é—®è€…æ¨¡å¼ä¸»è¦åº”ç”¨åœºæ™¯æ˜¯ï¼šéœ€è¦å¯¹ä¸€ä¸ªå¯¹è±¡ç»“æ„ä¸­çš„å¯¹è±¡è¿›è¡Œå¾ˆå¤šä¸åŒæ“ä½œ(è¿™äº›æ“ä½œå½¼æ­¤æ²¡æœ‰å…³è”)ï¼ŒåŒæ—¶éœ€è¦é¿å…è®©è¿™äº›æ“ä½œ\"æ±¡æŸ“\"è¿™äº›å¯¹è±¡çš„ç±»ï¼Œå¯ä»¥é€‰ç”¨è®¿é—®è€…æ¨¡å¼è§£å†³</li>\n<li>é‡è½½æ˜¯é™æ€ç»‘å®šï¼Œé‡å†™æ˜¯åŠ¨æ€ç»‘å®šï¼ŒåŒåˆ†æ´¾æŠŠé‡å†™æ”¾åœ¨é‡è½½ä¹‹å‰ï¼Œä»¥å®ç°åœ¨è¿è¡Œæ—¶åŠ¨æ€åˆ¤æ–­æ‰§è¡Œé‚£ä¸ªå­ç±»çš„æ–¹æ³•ã€‚</li>\n<li>è®¿é—®è€…æ¨¡å¼å¯ä»¥å¯¹åŠŸèƒ½è¿›è¡Œç»Ÿä¸€ï¼Œå¯ä»¥åšæŠ¥è¡¨ã€UIã€æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨ï¼Œé€‚ç”¨äºæ•°æ®ç»“æ„ç›¸å¯¹ç¨³å®šçš„ç³»ç»Ÿ</li>\n<li>å› æ­¤ï¼Œå¦‚æœä¸€ä¸ªç³»ç»Ÿæœ‰æ¯”è¾ƒç¨³å®šçš„æ•°æ®ç»“æ„ï¼Œåˆæœ‰ç»å¸¸å˜åŒ–çš„åŠŸèƒ½éœ€æ±‚ï¼Œé‚£ä¹ˆè®¿é—®è€…æ¨¡å¼å°±æ˜¯æ¯”è¾ƒåˆé€‚çš„.</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        ObjectStructure objectStructure = new ObjectStructure();\n        objectStructure.attach(new Man());\n        objectStructure.attach(new Woman());\n\n        //æˆåŠŸ\n        Success success = new Success();\n        objectStructure.display(success);\n\n        Fail fail = new Fail();\n        objectStructure.display(fail);\n    }\n}\n\n//æŠ½è±¡è®¿é—®è€… VisitoræŠ½è±¡è®¿é—®è€…\nabstract class Action {\n    public abstract void getManResult(Man man);\n    public abstract void getWomanResult(Woman woman);\n}\n\n//å®é™…è®¿é—®è€…  ConcreteVisitorå…·ä½“è®¿é—®è€…\nclass Success extends Action {\n    public void getManResult(Man man) {System.out.println(\" ç”·äººç»™çš„è¯„ä»·è¯¥æ­Œæ‰‹å¾ˆæˆåŠŸ !\");}\n    public void getWomanResult(Woman woman) {System.out.println(\" å¥³äººç»™çš„è¯„ä»·è¯¥æ­Œæ‰‹å¾ˆæˆåŠŸ !\");}\n}\n\nclass Fail extends Action {\n    public void getManResult(Man man) {System.out.println(\" ç”·äººç»™çš„è¯„ä»·è¯¥æ­Œæ‰‹å¤±è´¥ !\");}\n    public void getWomanResult(Woman woman) {System.out.println(\" å¥³äººç»™çš„è¯„ä»·è¯¥æ­Œæ‰‹å¤±è´¥ !\");}\n}\n\n//æŠ½è±¡å…ƒç´  æ¥æ”¶ä¸€ä¸ªè®¿é—®è€…å¯¹è±¡\nabstract class Person {\n    public abstract void accept(Action action);\n}\n\n//å®é™…å…ƒç´ \n//ä½¿ç”¨äº†åŒåˆ†æ´¾, å³\n//é¦–å…ˆåœ¨å®¢æˆ·ç«¯ç¨‹åºä¸­ï¼Œå°†å…·ä½“çŠ¶æ€ä½œä¸ºå‚æ•°ä¼ é€’Womanä¸­(ç¬¬ä¸€æ¬¡åˆ†æ´¾)\n// ç„¶åWoman ç±»è°ƒç”¨ä½œä¸ºå‚æ•°çš„ \"å…·ä½“æ–¹æ³•\" ä¸­æ–¹æ³•getWomanResult, åŒæ—¶å°†è‡ªå·±(this)ä½œä¸ºå‚æ•°ä¼ å…¥ï¼Œå®Œæˆç¬¬äºŒæ¬¡çš„åˆ†æ´¾\n//åŒåˆ†æ´¾æ˜¯æŒ‡ä¸ç®¡ç±»æ€ä¹ˆå˜åŒ–ï¼Œæˆ‘ä»¬éƒ½èƒ½æ‰¾åˆ°æœŸæœ›çš„æ–¹æ³•è¿è¡Œã€‚\n//åŒåˆ†æ´¾æ„å‘³ç€å¾—åˆ°æ‰§è¡Œçš„æ“ä½œå–å†³äºè¯·æ±‚çš„ç§ç±»å’Œä¸¤ä¸ªæ¥æ”¶è€…çš„ç±»å‹ -\n//å‡è®¾æˆ‘ä»¬è¦æ·»åŠ ä¸€ä¸ªWaitçš„çŠ¶æ€ç±»ï¼Œåªéœ€å¢åŠ ä¸€ä¸ªActionå­ç±»å³å¯åœ¨å®¢æˆ·ç«¯è°ƒç”¨å³å¯ï¼Œä¸éœ€è¦æ”¹åŠ¨ä»»ä½•å…¶ä»–ç±»çš„ä»£ç \nclass Woman extends Person{\n    public void accept(Action action) {action.getWomanResult(this);}\n}\n\nclass Man extends Person {\n    public void accept(Action action) {action.getManResult(this);}\n}\n\n//æ•°æ®ç»“æ„ï¼Œç®¡ç†å¾ˆå¤šäººï¼ˆMan , Womanï¼‰ObjectStructure\nclass ObjectStructure {\n    private List&lt;Person&gt; persons = new LinkedList&lt;&gt;();\n    public void attach(Person p) {persons.add(p);}\n    public void detach(Person p) {persons.remove(p);}\n    public void display(Action action) {\n        for(Person p: persons) {\n            p.accept(action);\n        }\n    }\n}\n</code></pre></div><h3>3.3.4. è¿­ä»£å™¨æ¨¡å¼</h3>\n<ul>\n<li>å¦‚æœæˆ‘ä»¬çš„é›†åˆå…ƒç´ æ˜¯ç”¨ä¸åŒçš„æ–¹å¼å®ç°çš„ï¼Œæœ‰æ•°ç»„ï¼Œè¿˜æœ‰javaçš„é›†åˆç±»ï¼Œæˆ–è€…è¿˜æœ‰å…¶ä»–æ–¹å¼ï¼Œå½“å®¢æˆ·ç«¯è¦éå†è¿™äº›é›†åˆå…ƒç´ çš„æ—¶å€™å°±è¦ä½¿ç”¨å¤šç§éå†æ–¹å¼ï¼Œè€Œä¸”è¿˜ä¼šæš´éœ²å…ƒç´ çš„å†…éƒ¨ç»“æ„ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼è§£å†³ã€‚</li>\n<li>è¿­ä»£å™¨æ¨¡å¼ï¼Œæä¾›ä¸€ç§éå†é›†åˆå…ƒç´ çš„ç»Ÿä¸€æ¥å£ï¼Œç”¨ä¸€è‡´çš„æ–¹æ³•éå†é›†åˆå…ƒç´ ï¼Œä¸éœ€è¦çŸ¥é“é›†åˆå¯¹è±¡çš„åº•å±‚è¡¨ç¤ºï¼Œå³ï¼šä¸æš´éœ²å…¶å†…éƒ¨çš„ç»“æ„ã€‚</li>\n<li>æä¾›äº†ä¸€ç§è®¾è®¡æ€æƒ³ï¼Œå°±æ˜¯ä¸€ä¸ªç±»åº”è¯¥åªæœ‰ä¸€ä¸ªå¼•èµ·å˜åŒ–çš„åŸå› ï¼ˆå«åšå•ä¸€è´£ä»»åŸåˆ™ï¼‰ã€‚åœ¨èšåˆç±»ä¸­ï¼Œæˆ‘ä»¬æŠŠè¿­ä»£å™¨åˆ†å¼€ï¼Œå°±æ˜¯è¦æŠŠç®¡ç†å¯¹è±¡é›†åˆå’Œéå†å¯¹è±¡é›†åˆçš„è´£ä»»åˆ†å¼€ï¼Œè¿™æ ·ä¸€æ¥é›†åˆæ”¹å˜çš„è¯ï¼Œåªå½±å“åˆ°èšåˆå¯¹è±¡ã€‚è€Œå¦‚æœéå†æ–¹å¼æ”¹å˜çš„è¯ï¼Œåªå½±å“åˆ°äº†è¿­ä»£å™¨ã€‚</li>\n<li>å½“è¦å±•ç¤ºä¸€ç»„ç›¸ä¼¼å¯¹è±¡ï¼Œæˆ–è€…éå†ä¸€ç»„ç›¸åŒå¯¹è±¡æ—¶ä½¿ç”¨, é€‚åˆä½¿ç”¨è¿­ä»£å™¨æ¨¡å¼<br>\n-æ¯ä¸ªèšåˆå¯¹è±¡éƒ½è¦ä¸€ä¸ªè¿­ä»£å™¨ï¼Œä¼šç”Ÿæˆå¤šä¸ªè¿­ä»£å™¨ä¸å¥½ç®¡ç†ç±»</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        ConcreteAggregate aggregate = new ConcreteAggregate();\n        Iterator iterator = aggregate.createIterator();\n        while(iterator.hasNext()) {\n            Element e = (Element)iterator.next();\n            System.out.println(e.getName());\n        }\n    }\n}\n\n//éœ€è¦è¢«è¿­ä»£çš„å¯¹è±¡\nclass Element {\n    private String name;//set/get\n    public Element(String name) {this.name = name;}\n    public String getName() { return name; }\n}\n//aggregateæ¥å£\ninterface Aggregate {\n    Iterator createIterator();\n}\n\n//aggregateæ¥å£å®ç°\nclass ConcreteAggregate implements Aggregate {\n    Element[] elements;\n    public ConcreteAggregate() {elements = new Element[]{new Element(\"test1\"),new Element(\"test2\")};}\n    @Override\n    public Iterator createIterator() {return new ConcreteIterator(elements);}\n}\n\n//è¿­ä»£å™¨å®ç°\nclass ConcreteIterator implements Iterator {\n    Element[] elements;\n    int position = 0; //éå†çš„ä½ç½®\n    public ConcreteIterator(Element[] elements) {this.elements = elements;}\n    //åˆ¤æ–­æ˜¯å¦è¿˜æœ‰ä¸‹ä¸€ä¸ªå…ƒç´ \n    @Override\n    public boolean hasNext() {\n        if(position &gt;= elements.length || elements[position] == null) {\n            return false;\n        }else {\n            return true;\n        }\n    }\n    @Override\n    public Object next() {\n        Element element = elements[position];\n        position += 1;\n        return element;\n    }\n}\n</code></pre></div><h3>3.3.5. è§‚å¯Ÿè€…æ¨¡å¼</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        Subject subject = new Subject();\n        new BinaryObserver(subject);\n        subject.setState(15);\n    }\n}\n\n//é€šçŸ¥è€…\nclass Subject {\n    private List&lt;Observer&gt; observers = new ArrayList&lt;Observer&gt;();\n    private int state;\n    public int getState() {return state;}\n    //é€šçŸ¥æ ¸å¿ƒ\n    public void setState(int state) {\n        this.state = state;\n        notifyAllObservers();\n    }\n    public void attach(Observer observer){observers.add(observer);}\n    public void notifyAllObservers(){\n        for (Observer observer : observers) {\n            observer.update();\n        }\n    }\n}\n\n//è§‚å¯Ÿè€…æŠ½è±¡\nabstract class Observer {\n    protected Subject subject;\n    public abstract void update();\n}\n\n//è§‚å¯Ÿè€…\nclass BinaryObserver extends Observer{\n    public BinaryObserver(Subject subject){\n        this.subject = subject;\n        this.subject.attach(this);\n    }\n    @Override\n    public void update() {\n        System.out.println( \"Binary String: \" + Integer.toBinaryString( subject.getState() ) );\n    }\n}\n</code></pre></div><h3>3.3.6. ä¸­ä»‹è€…æ¨¡å¼</h3>\n<ul>\n<li>ä¸­ä»‹è€…æ¨¡å¼ï¼ˆMediator Patternï¼‰ï¼Œç”¨ä¸€ä¸ªä¸­ä»‹å¯¹è±¡æ¥å°è£…ä¸€ç³»åˆ—çš„å¯¹è±¡äº¤äº’ã€‚ä¸­ä»‹è€…ä½¿å„ä¸ªå¯¹è±¡ä¸éœ€è¦æ˜¾å¼åœ°ç›¸äº’å¼•ç”¨ï¼Œä»è€Œä½¿å…¶è€¦åˆæ¾æ•£ï¼Œè€Œä¸”å¯ä»¥ç‹¬ç«‹åœ°æ”¹å˜å®ƒä»¬ä¹‹é—´çš„äº¤äº’</li>\n<li>æ¯”å¦‚MVCæ¨¡å¼ï¼ŒCï¼ˆControlleræ§åˆ¶å™¨ï¼‰æ˜¯Mï¼ˆModelæ¨¡å‹ï¼‰å’ŒVï¼ˆViewè§†å›¾ï¼‰çš„ä¸­ä»‹è€…ï¼Œåœ¨å‰åç«¯äº¤äº’æ—¶èµ·åˆ°äº†ä¸­é—´äººçš„ä½œç”¨</li>\n<li>å¤šä¸ªç±»ç›¸äº’è€¦åˆï¼Œä¼šå½¢æˆç½‘çŠ¶ç»“æ„, ä½¿ç”¨ä¸­ä»‹è€…æ¨¡å¼å°†ç½‘çŠ¶ç»“æ„åˆ†ç¦»ä¸ºæ˜Ÿå‹ç»“æ„ï¼Œè¿›è¡Œè§£è€¦</li>\n<li>ä¸­ä»‹è€…æ‰¿æ‹…äº†è¾ƒå¤šçš„è´£ä»»ï¼Œä¸€æ—¦ä¸­ä»‹è€…å‡ºç°äº†é—®é¢˜ï¼Œæ•´ä¸ªç³»ç»Ÿå°±ä¼šå—åˆ°å½±å“</li>\n<li>å¦‚æœè®¾è®¡ä¸å½“ï¼Œä¸­ä»‹è€…å¯¹è±¡æœ¬èº«å˜å¾—è¿‡äºå¤æ‚ï¼Œè¿™ç‚¹åœ¨å®é™…ä½¿ç”¨æ—¶ï¼Œè¦ç‰¹åˆ«æ³¨æ„</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        Mediator mediator = new ConcreteMediator();\n        ConcreteColleague concreteColleague = new ConcreteColleague(mediator, \"alarm\");\n        concreteColleague.SendMessage(0);\n    }\n}\n\n//åŒäº‹æŠ½è±¡ç±»\nabstract class Colleague {\n    private Mediator mediator;\n    public String name;\n    public Colleague(Mediator mediator, String name) {this.mediator = mediator;this.name = name;mediator.Register(name, this);}\n    public Mediator GetMediator() {return this.mediator;}\n    public abstract void SendMessage(int stateChange);\n    public Colleague(){}\n\n}\n\n//å…·ä½“åŒäº‹ç±»\nclass ConcreteColleague extends Colleague {\n    public ConcreteColleague(Mediator mediator, String alarm) {\n        super(mediator,alarm);\n    }\n    @Override\n    public void SendMessage(int stateChange) {this.GetMediator().GetMessage(stateChange, this.name);}\n    public void StartCoffee() {System.out.println(\"It's time to startcoffee!\");}\n}\n\n//æŠ½è±¡ä¸­ä»‹è€…\nabstract class Mediator {\n    public abstract void Register(String colleagueName, Colleague colleague);//å°†ç»™ä¸­ä»‹è€…å¯¹è±¡ï¼ŒåŠ å…¥åˆ°é›†åˆä¸­\n    public abstract void GetMessage(int stateChange, String colleagueName);//æ¥æ”¶æ¶ˆæ¯, å…·ä½“çš„åŒäº‹å¯¹è±¡å‘å‡º\n}\n\n//å…·ä½“çš„ä¸­ä»‹è€…ç±»\nclass ConcreteMediator extends Mediator {\n    private HashMap&lt;String, Colleague&gt; colleagueMap = new HashMap&lt;String, Colleague&gt;();//é›†åˆï¼Œæ”¾å…¥æ‰€æœ‰çš„åŒäº‹å¯¹è±¡\n    private HashMap&lt;String, String&gt; interMap = new HashMap&lt;String, String&gt;();\n    public ConcreteMediator() {}\n\n    @Override\n    public void Register(String colleagueName, Colleague colleague) {\n        colleagueMap.put(colleagueName, colleague);\n        if (colleague instanceof ConcreteColleague) {interMap.put(\"ConcreteColleague\", colleagueName);}\n    }\n\n    //å…·ä½“ä¸­ä»‹è€…çš„æ ¸å¿ƒæ–¹æ³•\n    //1. æ ¹æ®å¾—åˆ°æ¶ˆæ¯ï¼Œå®Œæˆå¯¹åº”ä»»åŠ¡\n    //2. ä¸­ä»‹è€…åœ¨è¿™ä¸ªæ–¹æ³•ï¼Œåè°ƒå„ä¸ªå…·ä½“çš„åŒäº‹å¯¹è±¡ï¼Œå®Œæˆä»»åŠ¡\n    @Override\n    public void GetMessage(int stateChange, String colleagueName) {\n        if (colleagueMap.get(colleagueName) instanceof ConcreteColleague) {\n            if (stateChange == 0) {((ConcreteColleague) (colleagueMap.get(interMap.get(\"ConcreteColleague\")))).StartCoffee();}\n        }\n    }\n}\n</code></pre></div><h3>3.3.7. è§£é‡Šå™¨æ¨¡å¼</h3>\n<ul>\n<li>åœ¨ç¼–è¯‘åŸç†ä¸­ï¼Œä¸€ä¸ªç®—æœ¯è¡¨è¾¾å¼é€šè¿‡è¯æ³•åˆ†æå™¨å½¢æˆè¯æ³•å•å…ƒï¼Œè€Œåè¿™äº›è¯æ³•å•å…ƒå†é€šè¿‡è¯­æ³•åˆ†æå™¨æ„å»ºè¯­æ³•åˆ†ææ ‘ï¼Œæœ€ç»ˆå½¢æˆä¸€é¢—æŠ½è±¡çš„è¯­æ³•åˆ†ææ ‘ã€‚è¿™é‡Œçš„è¯æ³•åˆ†æå™¨å’Œè¯­æ³•åˆ†æå™¨éƒ½å¯ä»¥çœ‹åšæ˜¯è§£é‡Šå™¨</li>\n<li>è§£é‡Šå™¨æ¨¡å¼ï¼ˆInterpreter Patternï¼‰ï¼šæ˜¯æŒ‡ç»™å®šä¸€ä¸ªè¯­è¨€(è¡¨è¾¾å¼)ï¼Œå®šä¹‰å®ƒçš„æ–‡æ³•çš„ä¸€ç§è¡¨ç¤ºï¼Œå¹¶å®šä¹‰ä¸€ä¸ªè§£é‡Šå™¨ï¼Œä½¿ç”¨è¯¥è§£é‡Šå™¨æ¥è§£é‡Šè¯­è¨€ä¸­çš„å¥å­(è¡¨è¾¾å¼)</li>\n<li>åº”ç”¨åœºæ™¯:å¯ä»¥å°†ä¸€ä¸ªéœ€è¦è§£é‡Šæ‰§è¡Œçš„è¯­è¨€ä¸­çš„å¥å­è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ ;ä¸€äº›é‡å¤å‡ºç°çš„é—®é¢˜å¯ä»¥ç”¨ä¸€ç§ç®€å•çš„è¯­è¨€æ¥è¡¨è¾¾ ä¸€ä¸ªç®€å•è¯­æ³•éœ€è¦è§£é‡Šçš„åœºæ™¯;è¿™æ ·çš„ä¾‹å­è¿˜æœ‰ï¼Œæ¯”å¦‚ç¼–è¯‘å™¨ã€è¿ç®—è¡¨è¾¾å¼è®¡ç®—ã€æ­£åˆ™è¡¨è¾¾å¼ã€æœºå™¨äººç­‰</li>\n<li>å½“æœ‰ä¸€ä¸ªè¯­è¨€éœ€è¦è§£é‡Šæ‰§è¡Œï¼Œå¯å°†è¯¥è¯­è¨€ä¸­çš„å¥å­è¡¨ç¤ºä¸ºä¸€ä¸ªæŠ½è±¡è¯­æ³•æ ‘ï¼Œå°±å¯ä»¥è€ƒè™‘ä½¿ç”¨è§£é‡Šå™¨æ¨¡å¼ï¼Œè®©ç¨‹åºå…·æœ‰è‰¯å¥½çš„æ‰©å±•æ€§</li>\n<li>ä½¿ç”¨è§£é‡Šå™¨å¯èƒ½å¸¦æ¥çš„é—®é¢˜ï¼šè§£é‡Šå™¨æ¨¡å¼ä¼šå¼•èµ·ç±»è†¨èƒ€ã€è§£é‡Šå™¨æ¨¡å¼é‡‡ç”¨é€’å½’è°ƒç”¨æ–¹æ³•ï¼Œå°†ä¼šå¯¼è‡´è°ƒè¯•éå¸¸å¤æ‚ã€æ•ˆç‡å¯èƒ½é™ä½.</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//è¡¨è¾¾å¼æ¥å£\npublic interface Expression {\n    public boolean interpret(String context);\n}\n\n//è¡¨è¾¾å¼å®ç°\npublic class TerminalExpression implements Expression {\n    private String data;\n    public TerminalExpression(String data){this.data = data; }\n    @Override\n    public boolean interpret(String context) {\n        if(context.contains(data)){return true;}\n        return false;\n    }\n}\n\npublic class OrExpression implements Expression {\n    private Expression expr1 = null;\n    private Expression expr2 = null;\n    public OrExpression(Expression expr1, Expression expr2) { \n        this.expr1 = expr1;\n        this.expr2 = expr2;\n    }\n    @Override\n    public boolean interpret(String context) {      \n        return expr1.interpret(context) || expr2.interpret(context);\n    }\n}\n\npublic class AndExpression implements Expression {\n    private Expression expr1 = null;\n    private Expression expr2 = null;\n    public AndExpression(Expression expr1, Expression expr2) { \n        this.expr1 = expr1;\n        this.expr2 = expr2;\n    }\n    @Override\n    public boolean interpret(String context) {      \n        return expr1.interpret(context) &amp;&amp; expr2.interpret(context);\n    }\n}\n\npublic class client {\n    //è§„åˆ™ï¼šRobert å’Œ John æ˜¯ç”·æ€§\n    public static Expression getMaleExpression(){\n        Expression robert = new TerminalExpression(\"Robert\");\n        Expression john = new TerminalExpression(\"John\");\n        return new OrExpression(robert, john);    \n    }\n    //è§„åˆ™ï¼šJulie æ˜¯ä¸€ä¸ªå·²å©šçš„å¥³æ€§\n    public static Expression getMarriedWomanExpression(){\n        Expression julie = new TerminalExpression(\"Julie\");\n        Expression married = new TerminalExpression(\"Married\");\n        return new AndExpression(julie, married);    \n    }\n    public static void main(String[] args) {\n        Expression isMale = getMaleExpression();\n        Expression isMarriedWoman = getMarriedWomanExpression();\n        System.out.println(\"John is male? \" + isMale.interpret(\"John\"));\n        System.out.println(\"Julie is a married women? \" + isMarriedWoman.interpret(\"Married Julie\"));\n    }\n}\n</code></pre></div><h3>3.3.8. å¤‡å¿˜å½•æ¨¡å¼</h3>\n<ul>\n<li>å¤‡å¿˜å½•æ¨¡å¼ï¼ˆMemento Patternï¼‰åœ¨ä¸ç ´åå°è£…æ€§çš„å‰æä¸‹ï¼Œæ•è·ä¸€ä¸ªå¯¹è±¡çš„å†…éƒ¨çŠ¶æ€ï¼Œå¹¶åœ¨è¯¥å¯¹è±¡ä¹‹å¤–ä¿å­˜è¿™ä¸ªçŠ¶æ€ã€‚è¿™æ ·ä»¥åå°±å¯å°†è¯¥å¯¹è±¡æ¢å¤åˆ°åŸå…ˆä¿å­˜çš„çŠ¶æ€</li>\n<li>å¤‡å¿˜å½•å¯¹è±¡ä¸»è¦ç”¨æ¥è®°å½•ä¸€ä¸ªå¯¹è±¡çš„æŸç§çŠ¶æ€ï¼Œæˆ–è€…æŸäº›æ•°æ®ï¼Œå½“è¦åšå›é€€æ—¶ï¼Œå¯ä»¥ä»å¤‡å¿˜å½•å¯¹è±¡é‡Œè·å–åŸæ¥çš„æ•°æ®è¿›è¡Œæ¢å¤æ“ä½œ</li>\n<li>ç»™ç”¨æˆ·æä¾›äº†ä¸€ç§å¯ä»¥æ¢å¤çŠ¶æ€çš„æœºåˆ¶ï¼Œå¯ä»¥ä½¿ç”¨æˆ·èƒ½å¤Ÿæ¯”è¾ƒæ–¹ä¾¿åœ°å›åˆ°æŸä¸ªå†å²çš„çŠ¶æ€</li>\n<li>å¦‚æœç±»çš„æˆå‘˜å˜é‡è¿‡å¤šï¼ŒåŠ¿å¿…ä¼šå ç”¨æ¯”è¾ƒå¤§çš„èµ„æºï¼Œè€Œä¸”æ¯ä¸€æ¬¡ä¿å­˜éƒ½ä¼šæ¶ˆè€—ä¸€å®šçš„å†…å­˜, è¿™ä¸ªéœ€è¦æ³¨æ„</li>\n<li>é€‚ç”¨çš„åº”ç”¨åœºæ™¯ï¼š1ã€åæ‚”è¯ã€‚ 2ã€æ‰“æ¸¸æˆæ—¶çš„å­˜æ¡£ã€‚ 3ã€Windows é‡Œçš„ ctri + zã€‚ 4ã€IE ä¸­çš„åé€€ã€‚ 4ã€æ•°æ®åº“çš„äº‹åŠ¡ç®¡ç†</li>\n<li>ä¸ºäº†èŠ‚çº¦å†…å­˜ï¼Œå¤‡å¿˜å½•æ¨¡å¼å¯ä»¥å’ŒåŸå‹æ¨¡å¼é…åˆä½¿ç”¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        Originator originator = new Originator();\n        Caretaker caretaker = new Caretaker();\n        originator.setState(\" çŠ¶æ€#1 æ”»å‡»åŠ› 100 \");\n        //ä¿å­˜äº†å½“å‰çš„çŠ¶æ€\n        caretaker.add(originator.saveStateMemento());\n        originator.setState(\" çŠ¶æ€#2 æ”»å‡»åŠ› 80 \");\n        caretaker.add(originator.saveStateMemento());\n        originator.setState(\" çŠ¶æ€#3 æ”»å‡»åŠ› 50 \");\n        caretaker.add(originator.saveStateMemento());\n        System.out.println(\"å½“å‰çš„çŠ¶æ€æ˜¯ =\" + originator.getState());\n        //å¸Œæœ›å¾—åˆ°çŠ¶æ€ 1, å°† originator æ¢å¤åˆ°çŠ¶æ€1\n        originator.getStateFromMemento(caretaker.get(0));\n        System.out.println(\"æ¢å¤åˆ°çŠ¶æ€1 , å½“å‰çš„çŠ¶æ€æ˜¯\");\n        System.out.println(\"å½“å‰çš„çŠ¶æ€æ˜¯ =\" + originator.getState());\n    }\n}\n\n//å¤‡å¿˜å½•å¯¹è±¡\nclass Memento {\n    private String state;\n    public Memento(String state) {this.state = state;}\n    public String getState() {return state;}\n}\n\n//å®ˆæŠ¤è€…å¯¹è±¡,è´Ÿè´£ä¿å­˜å¤šä¸ªå¤‡å¿˜å½•å¯¹è±¡\nclass Caretaker {\n    //åœ¨List é›†åˆä¸­ä¼šæœ‰å¾ˆå¤šçš„å¤‡å¿˜å½•å¯¹è±¡\n    private List&lt;Memento&gt; mementoList = new ArrayList&lt;Memento&gt;();\n    public void add(Memento memento) {mementoList.add(memento);}\n    //è·å–åˆ°ç¬¬indexä¸ªOriginator çš„ å¤‡å¿˜å½•å¯¹è±¡(å³ä¿å­˜çŠ¶æ€)\n    public Memento get(int index) {return mementoList.get(index);}\n}\n\n//originator : å¯¹è±¡(éœ€è¦ä¿å­˜çŠ¶æ€çš„å¯¹è±¡)\nclass Originator {\n    private String state;//çŠ¶æ€ä¿¡æ¯\n    public String getState() {return state;}\n    public void setState(String state) {this.state = state;}\n    //ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ä¿å­˜ä¸€ä¸ªçŠ¶æ€å¯¹è±¡ Memento\n    //å› æ­¤ç¼–å†™ä¸€ä¸ªæ–¹æ³•ï¼Œè¿”å› Memento\n    public Memento saveStateMemento() {return new Memento(state);}\n    //é€šè¿‡å¤‡å¿˜å½•å¯¹è±¡ï¼Œæ¢å¤çŠ¶æ€(å°†è‡ªå·±çš„å±æ€§è½¬æˆä¼ å…¥æ¥çš„å±æ€§)\n    public void getStateFromMemento(Memento memento) {state = memento.getState();}\n}\n</code></pre></div><h3>3.3.9. çŠ¶æ€æ¨¡å¼</h3>\n<ul>\n<li>çŠ¶æ€æ¨¡å¼ï¼ˆState Patternï¼‰ï¼šå®ƒä¸»è¦ç”¨æ¥è§£å†³å¯¹è±¡åœ¨å¤šç§çŠ¶æ€è½¬æ¢æ—¶ï¼Œéœ€è¦å¯¹å¤–è¾“å‡ºä¸åŒçš„è¡Œä¸ºçš„é—®é¢˜ã€‚çŠ¶æ€å’Œè¡Œä¸ºæ˜¯ä¸€ä¸€å¯¹åº”çš„ï¼ŒçŠ¶æ€ä¹‹é—´å¯ä»¥ç›¸äº’è½¬æ¢</li>\n<li>å½“ä¸€ä¸ªå¯¹è±¡çš„å†…åœ¨çŠ¶æ€æ”¹å˜æ—¶ï¼Œå…è®¸æ”¹å˜å…¶è¡Œä¸ºï¼Œè¿™ä¸ªå¯¹è±¡çœ‹èµ·æ¥åƒæ˜¯æ”¹å˜äº†å…¶ç±»</li>\n<li>æ–¹ä¾¿ç»´æŠ¤ã€‚å°†å®¹æ˜“äº§ç”Ÿé—®é¢˜çš„if-elseè¯­å¥åˆ é™¤äº†ï¼Œå¦‚æœæŠŠæ¯ä¸ªçŠ¶æ€çš„è¡Œä¸ºéƒ½æ”¾åˆ°ä¸€ä¸ªç±»ä¸­ï¼Œæ¯æ¬¡è°ƒç”¨æ–¹æ³•æ—¶éƒ½è¦åˆ¤æ–­å½“å‰æ˜¯ä»€ä¹ˆçŠ¶æ€ï¼Œä¸ä½†ä¼šäº§å‡ºå¾ˆå¤šif-elseè¯­å¥ï¼Œè€Œä¸”å®¹æ˜“å‡ºé”™,å®¹æ˜“å¢åˆ çŠ¶æ€</li>\n<li>ä¼šäº§ç”Ÿå¾ˆå¤šç±»ã€‚æ¯ä¸ªçŠ¶æ€éƒ½è¦ä¸€ä¸ªå¯¹åº”çš„ç±»ï¼Œå½“çŠ¶æ€è¿‡å¤šæ—¶ä¼šäº§ç”Ÿå¾ˆå¤šç±»ï¼ŒåŠ å¤§ç»´æŠ¤éš¾åº¦</li>\n<li>åº”ç”¨åœºæ™¯ï¼šå½“ä¸€ä¸ªäº‹ä»¶æˆ–è€…å¯¹è±¡æœ‰å¾ˆå¤šç§çŠ¶æ€ï¼ŒçŠ¶æ€ä¹‹é—´ä¼šç›¸äº’è½¬æ¢ï¼Œå¯¹ä¸åŒçš„çŠ¶æ€è¦æ±‚æœ‰ä¸åŒçš„è¡Œä¸ºçš„æ—¶å€™ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨çŠ¶æ€æ¨¡å¼</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        Context context = new Context();\n        StartState startState = new StartState();\n        startState.doAction(context);\n        System.out.println(context.getState().toString());\n        StopState stopState = new StopState();\n        stopState.doAction(context);\n        System.out.println(context.getState().toString());\n    }\n}\n\n//çŠ¶æ€æ¥å£\ninterface State {\n    void doAction(Context context);\n}\n\n//çŠ¶æ€å®ç°\nclass StartState implements State {\n    public void doAction(Context context) {\n        System.out.println(\"Player is in start state\");\n        context.setState(this);\n    }\n    public String toString(){return \"Start State\";}\n}\n\nclass StopState implements State {\n    public void doAction(Context context) {\n        System.out.println(\"Player is in stop state\");\n        context.setState(this);\n    }\n    public String toString(){return \"Stop State\";}\n}\n\n//context\nclass Context {\n    private State state;\n    public void setState(State state){\n        this.state = state;\n    }\n    public State getState(){\n        return state;\n    }\n}\n//å°†æ¥å£å®ç°ç±»æ”¾å…¥åˆ°ä¼ å…¥å‚æ•°contextçš„æ¥å£å±æ€§ä¸­ï¼Œè°ƒç”¨ä¼ å…¥å‚æ•°contextå¯è·å¾—æ¥å£å®ç°ç±»åŠè°ƒç”¨å…¶æ–¹æ³•\n</code></pre></div><h3>3.3.10. ç­–ç•¥æ¨¡å¼</h3>\n<ul>\n<li>ç­–ç•¥æ¨¡å¼ï¼ˆStrategy Patternï¼‰ä¸­å®šä¹‰ç®—æ³•æ—ï¼Œåˆ†åˆ«å°è£…èµ·æ¥ï¼Œè®©ä»–ä»¬ä¹‹é—´å¯ä»¥äº’ç›¸æ›¿æ¢ï¼Œæ­¤æ¨¡å¼è®©ç®—æ³•çš„å˜åŒ–ç‹¬ç«‹äºä½¿ç”¨ç®—æ³•çš„å®¢æˆ·åˆ†åˆ«å°è£…è¡Œä¸ºæ¥å£ï¼Œå®ç°ç®—æ³•æ—ï¼Œè¶…ç±»é‡Œæ”¾è¡Œä¸ºæ¥å£å¯¹è±¡ï¼Œåœ¨å­ç±»é‡Œå…·ä½“è®¾å®šè¡Œä¸ºå¯¹è±¡ã€‚åŸåˆ™å°±æ˜¯ï¼šåˆ†ç¦»å˜åŒ–éƒ¨åˆ†ï¼Œå°è£…æ¥å£ï¼ŒåŸºäºæ¥å£ç¼–ç¨‹å„ç§åŠŸèƒ½ã€‚æ­¤æ¨¡å¼è®©è¡Œä¸ºçš„å˜åŒ–ç‹¬ç«‹äºç®—æ³•çš„ä½¿ç”¨è€…</li>\n<li>ç­–ç•¥æ¨¡å¼çš„å…³é”®æ˜¯ï¼šåˆ†æé¡¹ç›®ä¸­å˜åŒ–éƒ¨åˆ†ä¸ä¸å˜éƒ¨åˆ†</li>\n<li>ç­–ç•¥æ¨¡å¼çš„æ ¸å¿ƒæ€æƒ³æ˜¯ï¼šå¤šç”¨ç»„åˆ/èšåˆ å°‘ç”¨ç»§æ‰¿ï¼›ç”¨è¡Œä¸ºç±»ç»„åˆï¼Œè€Œä¸æ˜¯è¡Œä¸ºçš„ç»§æ‰¿ã€‚æ›´æœ‰å¼¹æ€§</li>\n<li>æä¾›äº†å¯ä»¥æ›¿æ¢ç»§æ‰¿å…³ç³»çš„åŠæ³•ï¼š ç­–ç•¥æ¨¡å¼å°†ç®—æ³•å°è£…åœ¨ç‹¬ç«‹çš„Strategyç±»ä¸­ä½¿å¾—ä½ å¯ä»¥ç‹¬ç«‹äºå…¶Contextæ”¹å˜å®ƒï¼Œä½¿å®ƒæ˜“äºåˆ‡æ¢ã€æ˜“äºç†è§£ã€æ˜“äºæ‰©å±•</li>\n<li>éœ€è¦æ³¨æ„çš„æ˜¯ï¼šæ¯æ·»åŠ ä¸€ä¸ªç­–ç•¥å°±è¦å¢åŠ ä¸€ä¸ªç±»ï¼Œå½“ç­–ç•¥è¿‡å¤šæ˜¯ä¼šå¯¼è‡´ç±»æ•°ç›®åºå¤§</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n        Context context = new Context(new OperationAdd());    \n        System.out.println(\"10 + 5 = \" + context.executeStrategy(10, 5));\n        context = new Context(new OperationSubstract());      \n        System.out.println(\"10 - 5 = \" + context.executeStrategy(10, 5));\n    }\n}\n//ç­–ç•¥æ¥å£\ninterface Strategy {\n    public int doOperation(int num1, int num2);\n}\n//ç­–ç•¥å®ç°\nclass OperationAdd implements Strategy{\n    @Override\n    public int doOperation(int num1, int num2) {\n        return num1 + num2;\n    }\n}\nclass OperationSubstract implements Strategy{\n    @Override\n    public int doOperation(int num1, int num2) {\n        return num1 - num2;\n    }\n}\n//context\nclass Context {\n    private Strategy strategy;\n    public Context(Strategy strategy){\n        this.strategy = strategy;\n    }\n    public int executeStrategy(int num1, int num2){\n        return strategy.doOperation(num1, num2);\n    }\n}\n</code></pre></div><h3>3.3.11. èŒè´£é“¾æ¨¡å¼</h3>\n<ul>\n<li>èŒè´£é“¾æ¨¡å¼Chain of Responsibility Patternè´£ä»»é“¾æ¨¡å¼ï¼Œä¸ºè¯·æ±‚åˆ›å»ºäº†ä¸€ä¸ªæ¥æ”¶è€…å¯¹è±¡çš„é“¾å¯¹è¯·æ±‚çš„å‘é€è€…å’Œæ¥æ”¶è€…è¿›è¡Œè§£è€¦ã€‚</li>\n<li>èŒè´£é“¾æ¨¡å¼é€šå¸¸æ¯ä¸ªæ¥æ”¶è€…éƒ½åŒ…å«å¯¹å¦ä¸€ä¸ªæ¥æ”¶è€…çš„å¼•ç”¨ã€‚å¦‚æœä¸€ä¸ªå¯¹è±¡ä¸èƒ½å¤„ç†è¯¥è¯·æ±‚ï¼Œé‚£ä¹ˆå®ƒä¼šæŠŠç›¸åŒçš„è¯·æ±‚ä¼ ç»™ä¸‹ä¸€ä¸ªæ¥æ”¶è€…ï¼Œä¾æ­¤ç±»æ¨ã€‚</li>\n<li>æ€§èƒ½ä¼šå—åˆ°å½±å“ï¼Œç‰¹åˆ«æ˜¯åœ¨é“¾æ¯”è¾ƒé•¿çš„æ—¶å€™ï¼Œå› æ­¤éœ€æ§åˆ¶é“¾ä¸­æœ€å¤§èŠ‚ç‚¹æ•°é‡ï¼Œä¸€èˆ¬é€šè¿‡åœ¨Handlerä¸­è®¾ç½®ä¸€ä¸ªæœ€å¤§èŠ‚ç‚¹æ•°é‡ï¼Œåœ¨setNext()æ–¹æ³•ä¸­åˆ¤æ–­æ˜¯å¦å·²ç»è¶…è¿‡é˜€å€¼ï¼Œè¶…è¿‡åˆ™ä¸å…è®¸è¯¥é“¾å»ºç«‹ï¼Œé¿å…å‡ºç°è¶…é•¿é“¾æ— æ„è¯†åœ°ç ´åç³»ç»Ÿæ€§èƒ½</li>\n<li>æœ€ä½³åº”ç”¨åœºæ™¯ï¼šæœ‰å¤šä¸ªå¯¹è±¡å¯ä»¥å¤„ç†åŒä¸€ä¸ªè¯·æ±‚æ—¶ï¼Œæ¯”å¦‚ï¼šå¤šçº§è¯·æ±‚ã€è¯·å‡/åŠ è–ªç­‰å®¡æ‰¹æµç¨‹ã€Java Webä¸­Tomcatå¯¹Encodingçš„å¤„ç†ã€æ‹¦æˆªå™¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Client {\n    public static void main(String[] args) {\n\n        DepartmentApprover departmentApprover = new DepartmentApprover(\"å¼ ä¸»ä»»\");//åˆ›å»ºç›¸å…³çš„å®¡æ‰¹äºº\n        CollegeApprover collegeApprover = new CollegeApprover(\"æé™¢é•¿\");\n        SchoolMasterApprover schoolMasterApprover = new SchoolMasterApprover(\"ä½Ÿæ ¡é•¿\");\n\n        departmentApprover.setApprover(collegeApprover);//éœ€è¦å°†å„ä¸ªå®¡æ‰¹çº§åˆ«çš„ä¸‹ä¸€ä¸ªè®¾ç½®å¥½ (å¤„ç†äººæ„æˆç¯å½¢: )\n        collegeApprover.setApprover(schoolMasterApprover);\n        schoolMasterApprover.setApprover(departmentApprover);\n\n        departmentApprover.processRequest(new PurchaseRequest(31000, 1));\n        collegeApprover.processRequest(new PurchaseRequest(200, 2));\n    }\n}\n\n//å¤„ç†è€…æŠ½è±¡\nabstract class Approver {\n    Approver approver;  //ä¸‹ä¸€ä¸ªå¤„ç†è€…\n    String name; // åå­—\n    public Approver(String name) {this.name = name;}\n    public void setApprover(Approver approver) {this.approver = approver;}\n    //å¤„ç†å®¡æ‰¹è¯·æ±‚çš„æ–¹æ³•ï¼Œå¾—åˆ°ä¸€ä¸ªè¯·æ±‚, å¤„ç†æ˜¯å­ç±»å®Œæˆï¼Œå› æ­¤è¯¥æ–¹æ³•åšæˆæŠ½è±¡\n    public abstract void processRequest(PurchaseRequest purchaseRequest);\n}\n\n//å…·ä½“å¤„ç†è€…\nclass CollegeApprover extends Approver {\n    public CollegeApprover(String name) {super(name);}\n    @Override\n    public void processRequest(PurchaseRequest purchaseRequest) {\n        if(purchaseRequest.getPrice() &gt; 5000 &amp;&amp; purchaseRequest.getPrice() &lt;= 10000) {\n            System.out.println(\" è¯·æ±‚ç¼–å· id= \" + purchaseRequest.getId() + \" è¢« \" + this.name + \" å¤„ç†\");\n        }else {\n            approver.processRequest(purchaseRequest);\n        }\n    }\n}\n\nclass DepartmentApprover extends Approver {\n    public DepartmentApprover(String name) {super(name);}\n    @Override\n    public void processRequest(PurchaseRequest purchaseRequest) {\n        if(purchaseRequest.getPrice() &lt;= 5000) {\n            System.out.println(\" è¯·æ±‚ç¼–å· id= \" + purchaseRequest.getId() + \" è¢« \" + this.name + \" å¤„ç†\");\n        }else {\n            approver.processRequest(purchaseRequest);\n        }\n    }\n}\n\nclass SchoolMasterApprover extends Approver {\n    public SchoolMasterApprover(String name) {super(name);}\n    @Override\n    public void processRequest(PurchaseRequest purchaseRequest) {\n        if(purchaseRequest.getPrice() &gt; 10000) {\n            System.out.println(\" è¯·æ±‚ç¼–å· id= \" + purchaseRequest.getId() + \" è¢« \" + this.name + \" å¤„ç†\");\n        }else {\n            approver.processRequest(purchaseRequest);\n        }\n    }\n}\n\n//è¯·æ±‚ç±»\nclass PurchaseRequest {\n    private float price = 0.0f; //è¯·æ±‚é‡‘é¢\n    private int id = 0;\n    public PurchaseRequest(float price, int id) {\n        this.price = price;\n        this.id = id;\n    }\n    public float getPrice() {\n        return price;\n    }\n    public int getId() {\n        return id;\n    }\n}\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "åˆ†å¸ƒå¼",
      "url": "https://javaguide.cn/interview/distributed.html",
      "id": "https://javaguide.cn/interview/distributed.html",
      "summary": "1. ä»€ä¹ˆæ˜¯CAPå®šç†ï¼Ÿ CAPå®šç†æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ CAPä¸‰è€…ä¸å¯å…¼å¾— ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®å¤‡ä»½ï¼Œåœ¨åŒä¸€æ—¶åˆ»æ˜¯å¦åŒæ ·çš„å€¼ã€‚ï¼ˆç­‰åŒäºæ‰€æœ‰èŠ‚ç‚¹è®¿é—®åŒä¸€ä»½æœ€æ–°çš„æ•°æ®å‰¯æœ¬ï¼‰ å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼šä¿è¯æ¯ä¸ªè¯·æ±‚ä¸ç®¡æˆåŠŸæˆ–è€…å¤±è´¥éƒ½æœ‰å“åº”ã€‚ åˆ†åŒºå®¹å¿æ€§ï¼ˆPartition toleranceï¼‰ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é‡åˆ°...",
      "content_html": "<!-- more -->\n<h1>1. ä»€ä¹ˆæ˜¯CAPå®šç†ï¼Ÿ</h1>\n<ul>\n<li>CAPå®šç†æ˜¯æŒ‡åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ï¼Œ CAPä¸‰è€…ä¸å¯å…¼å¾—\n<ul>\n<li>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼šåœ¨åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ‰€æœ‰æ•°æ®å¤‡ä»½ï¼Œåœ¨åŒä¸€æ—¶åˆ»æ˜¯å¦åŒæ ·çš„å€¼ã€‚ï¼ˆç­‰åŒäºæ‰€æœ‰èŠ‚ç‚¹è®¿é—®åŒä¸€ä»½æœ€æ–°çš„æ•°æ®å‰¯æœ¬ï¼‰</li>\n<li>å¯ç”¨æ€§ï¼ˆAvailabilityï¼‰ï¼šä¿è¯æ¯ä¸ªè¯·æ±‚ä¸ç®¡æˆåŠŸæˆ–è€…å¤±è´¥éƒ½æœ‰å“åº”ã€‚</li>\n<li>åˆ†åŒºå®¹å¿æ€§ï¼ˆPartition toleranceï¼‰ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿåœ¨é‡åˆ°æŸèŠ‚ç‚¹æˆ–ç½‘ç»œåˆ†åŒºæ•…éšœçš„æ—¶å€™ï¼Œä»ç„¶èƒ½å¤Ÿå¯¹å¤–æä¾›æ»¡è¶³ä¸€è‡´æ€§æˆ–å¯ç”¨æ€§çš„æœåŠ¡ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>2. ä¸ºä»€ä¹ˆCAPä¸å¯å…¼å¾—å‘¢ï¼Ÿ</h1>\n<ul>\n<li>åˆ†å¸ƒå¼ç³»ç»Ÿï¼Œåˆ†åŒºæ˜¯å¿…ç„¶å­˜åœ¨çš„ï¼Œæ‰€è°“åˆ†åŒºæŒ‡çš„æ˜¯åˆ†å¸ƒå¼ç³»ç»Ÿå¯èƒ½å‡ºç°çš„å­—åŒºåŸŸç½‘ç»œä¸é€šï¼Œæˆä¸ºå­¤ç«‹åŒºåŸŸçš„çš„æƒ…å†µã€‚</li>\n<li>ä¿è¯ä¸€è‡´æ€§ã€‚åˆ™å¯ç”¨æ€§ä¿è¯ä¸äº†ï¼Œå› ä¸ºè¦ç­‰ä¸€è‡´</li>\n<li>ä¿è¯å¯ç”¨æ€§ã€‚åˆ™ä¸€è‡´æ€§ä¿è¯ä¸äº†ï¼Œè¾¾åˆ°ä¸€è‡´è¦æ—¶é—´</li>\n</ul>\n<h1>3. CAPå¯¹åº”çš„æ¨¡å‹å’Œåº”ç”¨ï¼ŒZookeeperï¼ŒEurekaï¼ŒNacosï¼Œconsoulåˆ†åˆ«å±äºä»€ä¹ˆæ¶æ„ï¼Ÿâˆš</h1>\n<ul>\n<li>CA(å•æœº):æ”¾å¼ƒåˆ†åŒºå®¹é”™æ€§ï¼ŒåŠ å¼ºä¸€è‡´æ€§å’Œå¯ç”¨æ€§ï¼Œé›†ç¾¤æ•°æ®åº“ã€xFSæ–‡ä»¶ç³»ç»Ÿ</li>\n<li>AP:æ”¾å¼ƒä¸€è‡´æ€§ï¼Œåˆ†åŒºå®¹é”™æ€§å’Œå¯ç”¨æ€§ï¼Œä¸€æ—¦åˆ†åŒºå‘ç”Ÿï¼ŒèŠ‚ç‚¹ä¹‹é—´å¯èƒ½ä¼šå¤±å»è”ç³»ï¼Œä¸ºäº†é«˜å¯ç”¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åªèƒ½ç”¨æœ¬åœ°æ•°æ®æä¾›æœåŠ¡ï¼Œè€Œè¿™æ ·ä¼šå¯¼è‡´å…¨å±€æ•°æ®çš„ä¸ä¸€è‡´æ€§ã€‚ç³»ç»Ÿä¸ä¿è¯æ”¹å˜æäº¤ä»¥åç«‹å³æ”¹å˜é›†ç¾¤çš„çŠ¶æ€ï¼Œä½†æ˜¯éšç€æ—¶é—´çš„æ¨ç§»æœ€ç»ˆçŠ¶æ€æ˜¯ä¸€è‡´çš„ã€‚-&gt;Webç¼“å­˜ã€DNSã€GOSSIP.MySQLä¸»ä»å¼‚æ­¥å¤åˆ¶\\Redis \\Eureka</li>\n<li>CP:æ”¾å¼ƒå¯ç”¨æ€§ï¼Œè¿½æ±‚ä¸€è‡´æ€§å’Œåˆ†åŒºå®¹é”™æ€§ï¼ŒPï¼ˆåˆ†åŒºï¼‰ä¼šå¯¼è‡´åŒæ­¥æ—¶é—´æ— é™å»¶é•¿ï¼Œç½‘ç»œé—®é¢˜ä¼šç›´æ¥è®©æ•´ä¸ªç³»ç»Ÿä¸å¯ç”¨.ä¿è¯ç³»ç»Ÿæ”¹å˜æäº¤ä»¥åç«‹å³æ”¹å˜é›†ç¾¤çš„çŠ¶æ€ã€‚-&gt;åˆ†å¸ƒå¼æ•°æ®åº“ã€åˆ†å¸ƒå¼é”ï¼Œpaxoï¼Œraftï¼Œzab.MySQLä¸»ä»åŠåŒæ­¥å¤åˆ¶\\Zookeeper</li>\n<li>ä¸šç•Œä¸»è¦é‡‡ç”¨äº† XA åè®®çš„å¼ºä¸€è‡´è§„èŒƒä»¥åŠæŸ”æ€§äº‹åŠ¡çš„æœ€ç»ˆä¸€è‡´è§„èŒƒã€‚</li>\n</ul>\n<h1>4. BASEç†è®º</h1>\n<ul>\n<li>BASEç†è®ºæ˜¯å¯¹CAPä¸­APçš„ä¸€ä¸ªæ‰©å±•ï¼Œä¸šåŠ¡ç³»ç»Ÿç‰ºç‰²ä¸€è‡´æ€§æ¥æ¢å–ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œåˆ†åŒºå®¹é”™æ€§ã€‚BASEæ˜¯ä¸‹é¢ä¸‰ä¸ªçŸ­è¯­çš„ç¼©å†™\n<ul>\n<li>Basically Available åŸºæœ¬å¯ç”¨ï¼šé€šè¿‡æ”¯æŒå±€éƒ¨æ•…éšœè€Œä¸æ˜¯ç³»ç»Ÿå…¨å±€æ•…éšœæ¥å®ç°çš„ã€‚å¦‚å°†ç”¨æˆ·åˆ†åŒºåœ¨ 5 ä¸ªæ•°æ®åº“æœåŠ¡å™¨ä¸Šï¼Œä¸€ä¸ªç”¨æˆ·æ•°æ®åº“çš„æ•…éšœåªå½±å“è¿™å°ç‰¹å®šä¸»æœºé‚£ 20% çš„ç”¨æˆ·ï¼Œå…¶ä»–ç”¨æˆ·ä¸å—å½±å“ã€‚</li>\n<li>Soft State è½¯çŠ¶æ€ï¼Œå…è®¸ç³»ç»Ÿä¸­å­˜åœ¨ä¸­é—´çŠ¶æ€ï¼Œè¿™ä¸ªçŠ¶æ€ä¸å½±å“ç³»ç»Ÿå¯ç”¨æ€§ï¼Œè¿™é‡ŒæŒ‡çš„æ˜¯ CAP ä¸­çš„ä¸ä¸€è‡´ã€‚</li>\n<li>Eventually Consistent æœ€ç»ˆä¸€è‡´æ˜¯æŒ‡ç»è¿‡ä¸€æ®µæ—¶é—´åï¼Œæ‰€æœ‰èŠ‚ç‚¹æ•°æ®éƒ½å°†ä¼šè¾¾åˆ°ä¸€è‡´ã€‚è¿™ä¸ªæ—¶é—´å–å†³äºç½‘ç»œå»¶æ—¶ã€ç³»ç»Ÿè´Ÿè½½ã€æ•°æ®å¤åˆ¶æ–¹æ¡ˆè®¾è®¡ç­‰ç­‰å› ç´ ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>5. ä¸ºä»€ä¹ˆéœ€è¦ä¸€è‡´æ€§ç®—æ³•ï¼Ÿ</h1>\n<ul>\n<li>æ•°æ®ä¸èƒ½å­˜åœ¨å•ä¸ªèŠ‚ç‚¹ï¼ˆä¸»æœºï¼‰ä¸Šï¼Œå¦åˆ™å¯èƒ½å‡ºç°å•ç‚¹æ•…éšœï¼›å¤šä¸ªèŠ‚ç‚¹ï¼ˆä¸»æœºï¼‰éœ€è¦ä¿è¯å…·æœ‰ç›¸åŒçš„æ•°æ®</li>\n</ul>\n<h1>6. å¸¸ç”¨çš„ä¸€è‡´æ€§ç®—æ³•åˆ†ç±»ï¼Ÿ</h1>\n<ul>\n<li>Paxosç®—æ³•ï¼šèƒ½å¤Ÿåœ¨å­˜åœ¨æ•…éšœèŠ‚ç‚¹çš„æƒ…å†µä¸‹ä¿è¯ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚</li>\n<li>Raftç®—æ³•ï¼šæ¯”Paxosç®—æ³•æ›´æ˜“äºç†è§£å’Œå®ç°çš„ä¸€è‡´æ€§ç®—æ³•ï¼Œå®ƒå°†åˆ†å¸ƒå¼ä¸€è‡´æ€§é—®é¢˜åˆ†è§£æˆå¤šä¸ªæ˜“äºå¤„ç†çš„å­é—®é¢˜ã€‚</li>\n<li>ZABåè®®ï¼šZookeeperä¸­ä½¿ç”¨çš„ä¸€ç§ä¸€è‡´æ€§åè®®ï¼Œå®ƒé€šè¿‡é€‰ä¸¾ä¸€ä¸ªleaderæ¥åè°ƒå¤šä¸ªfollowerä¹‹é—´çš„æ•°æ®æ›´æ–°ã€‚</li>\n<li>2PCåè®®ï¼šåˆ†å¸ƒå¼ç³»ç»Ÿä¸­å¸¸ç”¨çš„ä¸€è‡´æ€§åè®®ï¼Œå®ƒé€šè¿‡é¢„æäº¤å’Œæäº¤ä¸¤ä¸ªé˜¶æ®µæ¥ä¿è¯ç³»ç»Ÿçš„ä¸€è‡´æ€§ã€‚</li>\n<li>3PCåè®®ï¼š3åœ¨2PCåè®®çš„åŸºç¡€ä¸Šå¢åŠ äº†è¶…æ—¶æœºåˆ¶å’Œå‡†å¤‡é˜¶æ®µçš„â€œå¯ä»¥æäº¤â€çŠ¶æ€ï¼Œä»¥æé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå¯é æ€§ã€‚</li>\n<li>Gossipåè®®ï¼šä¸€ç§åŸºäºéšæœºåŒ–çš„åˆ†å¸ƒå¼ä¸€è‡´æ€§åè®®ï¼Œå®ƒé€šè¿‡èŠ‚ç‚¹ä¹‹é—´çš„éšæœºé€šè®¯æ¥ä¼ æ’­æ•°æ®å’ŒçŠ¶æ€ä¿¡æ¯ï¼Œä»è€Œè¾¾åˆ°ä¸€è‡´æ€§çš„ç›®çš„ã€‚</li>\n</ul>\n<h1>7. Paxosç®—æ³•</h1>\n<ul>\n<li>Paxosç®—æ³•æ˜¯åŸºäºæ¶ˆæ¯ä¼ é€’ä¸”å…·æœ‰é«˜æ•ˆå®¹é”™ç‰¹æ€§çš„ä¸€è‡´æ€§ç®—æ³•</li>\n<li>åœ¨Paxosä¸­æœ‰è¿™ä¹ˆå‡ ä¸ªè§’è‰²,ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥åŒæ—¶å……å½“ä¸åŒè§’è‰²ã€‚\n<ul>\n<li>Proposerï¼ˆæè®®è€…ï¼‰:æè®®è€…æå‡ºææ¡ˆï¼Œç”¨äºæŠ•ç¥¨è¡¨å†³ã€‚ææ¡ˆ=ç¼–å·+valueï¼Œå¯ä»¥è¡¨ç¤ºä¸º[M,V]ï¼Œæ¯ä¸ªææ¡ˆéƒ½æœ‰å”¯ä¸€ç¼–å·ï¼Œè€Œä¸”ç¼–å·çš„å¤§å°æ˜¯è¶‹åŠ¿é€’å¢çš„</li>\n<li>Accecptorï¼ˆæ¥å—è€…ï¼‰:å¯¹ææ¡ˆè¿›è¡ŒæŠ•ç¥¨ï¼Œå¹¶æ¥å—è¾¾æˆå…±è¯†çš„ææ¡ˆã€‚</li>\n<li>Learnerï¼ˆå­¦ä¹ è€…ï¼‰:è¢«å‘ŠçŸ¥æŠ•ç¥¨çš„ç»“æœï¼Œæ¥å—è¾¾æˆå…±è¯†çš„ææ¡ˆã€‚</li>\n<li>Proposal(æè®®)</li>\n</ul>\n</li>\n<li>ç®—æ³•æµç¨‹:\n<ul>\n<li>1.å‡†å¤‡é˜¶æ®µ(Prepare Phase)\n<ul>\n<li>æè®®è€…Proposeræè®®ä¸€ä¸ªç¼–å·ä¸ºNï¼ˆNå¿…é¡»å¤§äºä¹‹å‰æœ¬æè®®è€…æ‰€æœ‰Proposalææ¡ˆçš„ç¼–å·ï¼‰çš„Proposalææ¡ˆï¼Œç„¶åå‘æ¥å—è€…Accecptorçš„æŸä¸ªè¶…è¿‡åŠæ•°çš„å­é›†æˆå‘˜å‘é€åŒ…å«Proposalææ¡ˆçš„prepareè¯·æ±‚ï¼Œç”±æ¥å—è€…Accecptorå†³å®šå“ªä¸ªè¯·æ±‚å å¤§å¤šæ•°</li>\n<li>å¦‚æœä¸€ä¸ªæ¥å—è€…Accecptoræ”¶åˆ°åŒ…å«ç¼–å·ä¸ºNçš„Proposalçš„prepareè¯·æ±‚ï¼Œå¹¶ä¸”ç¼–å·Nå¤§äºå®ƒå·²ç»æ¥æ”¶çš„æ‰€æœ‰prepareè¯·æ±‚çš„ç¼–å·ï¼Œç„¶åæ¥å—è€…ä¼šè¿”å›promiseæ‰¿è¯ºï¼Œå¿½ç•¥ä»»ä½•ç¼–å·å°äºNçš„Proposalææ¡ˆã€‚åŒæ—¶åŒ…æ‹¬å·²ç»acceptè¿‡çš„æœ€å¤§ç¼–å·çš„Proposalææ¡ˆä½œä¸ºå“åº”åé¦ˆç»™æè®®è€…</li>\n<li>æ¥å—è€…åœ¨æ”¶åˆ°ææ¡ˆåï¼Œä¼šç»™ä¸æè®®è€…ä¸¤ä¸ªæ‰¿è¯ºä¸ä¸€ä¸ªåº”ç­”ï¼š\n<ul>\n<li>ä¸¤ä¸ªæ‰¿è¯ºï¼šæ‰¿è¯ºå¿½ç•¥ææ¡ˆå·å°äºæˆ–ç­‰äºNçš„Prepareè¯·æ±‚ï¼›æ‰¿è¯ºå¿½ç•¥ææ¡ˆå·å°äºNçš„Acceptè¯·æ±‚</li>\n<li>ä¸€ä¸ªåº”ç­”ï¼šå›å¤å·²ç»acceptçš„ææ¡ˆä¸­ææ¡ˆå·æœ€å¤§çš„é‚£ä¸ªææ¡ˆæ‰€è®¾å®šçš„å€¼NmaxValueå’Œææ¡ˆå·Nmaxï¼Œå¦‚æœè¿™ä¸ªå€¼ä»æ¥æ²¡æœ‰è¢«ä»»ä½•ææ¡ˆè®¾å®šè¿‡ï¼Œåˆ™è¿”å›ç©ºå€¼ã€‚å¦‚æœä¸æ»¡è¶³å·²ç»åšå‡ºçš„æ‰¿è¯ºï¼Œå³æ”¶åˆ°çš„ææ¡ˆå·å¹¶ä¸æ˜¯å†³ç­–èŠ‚ç‚¹æ”¶åˆ°è¿‡çš„æœ€å¤§çš„ï¼Œé‚£å…è®¸ç›´æ¥å¯¹æ­¤ Prepare è¯·æ±‚ä¸äºˆç†ä¼š</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>2.Accept(æ¥å—)é˜¶æ®µ\n<ul>\n<li>å¦‚æœæè®®è€…Proposeræ”¶åˆ°æ¥è‡ªåŠæ•°ä»¥ä¸Šçš„æ¥å—è€…å¯¹äºå®ƒå‘å‡ºçš„ç¼–å·ä¸ºNçš„prepareè¯·æ±‚çš„å“åº”ï¼Œç„¶åç»™Proposalææ¡ˆè®¾ç½®å€¼valueï¼Œvalueå°±æ˜¯ä»Accecptoræ¥æ”¶è€…ä¸­æ”¶åˆ°çš„å“åº”ä¸­ç¼–å·æœ€å¤§çš„ææ¡ˆçš„å€¼ï¼Œå¦‚æœå“åº”ä¸­ä¸åŒ…å«ä»»ä½•ææ¡ˆï¼Œé‚£ä¹ˆå®ƒå¯ä»¥éšæ„é€‰å®šä¸€ä¸ªå€¼ã€‚æ­¤æ—¶ï¼Œæè®®è€…Proposerä¼šå‘æ¥å—è€…Accecptorçš„æŸä¸ªè¶…è¿‡åŠæ•°çš„å­é›†æˆå‘˜å‘å‡ºå·²ç»è®¾ç½®å€¼çš„Accept Request Message</li>\n<li>å¦‚æœæ¥å—è€…Accecptoræ”¶åˆ°è¿™ä¸ªç¼–å·ä¸ºNçš„Proposalææ¡ˆçš„Accept Request Messageï¼Œå¦‚æœè¿™ä¸ªç¼–å·Nå¤§äºæ¥å—è€…Accecptorä¹‹å‰æ‰€æœ‰è¿”å›promiseæ‰¿è¯ºï¼Œåˆ™æ¥å—è€…Accecptorå°±ä¼šAcceptï¼ŒåŒæ—¶å‘æè®®è€…Proposerå’Œæ‰€æœ‰å­¦ä¹ è€…Learnerå‘é€Accepted Messageï¼Œå…¶ä»–æƒ…å†µåˆ™æ¥å—è€…Accecptorå¿½ç•¥Accept Request Message</li>\n<li>æ³¨æ„:æ¥å—è€…Accecptorå¯ä»¥Acceptå¤šä¸ªProposalææ¡ˆï¼Œåœ¨æŸäº›å¤±è´¥æƒ…å†µä¸‹ï¼ŒProposalææ¡ˆå¯èƒ½æœ‰ä¸åŒçš„å€¼ï¼Œä½†æ˜¯Paxosç®—æ³•ä¿è¯å€¼æœ€ç»ˆè¾¾åˆ°ä¸€è‡´ï¼›å½“å¤šä¸ªæè®®è€…Proposerå‘é€å†²çªçš„Prepareè¯·æ±‚ï¼Œæˆ–è€…æè®®è€…Proposeræ²¡æœ‰æ¥æ”¶åˆ°è¶…è¿‡åŠæ•°Promiseæ‰¿è¯ºæˆ–è€…Accepted Messageï¼Œä»¥ä¸Šè¿™äº›æƒ…å†µéƒ½ä¼šä½¿æ–°ä¸€è½®æè®®è€…å‘èµ·ç¼–å·æ›´å¤§çš„proposal; å½“æ¥æ”¶è€…Accecptoræ¥æ”¶acceptAccept Requeset Messageæ—¶ï¼Œä¹Ÿä¼šé€‰å‡ºåœ¨æè®®è€…Proposerçš„leaderï¼Œå› æ­¤ï¼ŒPaxosç®—æ³•ä¹Ÿé€‚åˆåœ¨é›†ç¾¤ä¸­é€‰å‡ºleader</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Paxosç®—æ³•æœ‰ä»€ä¹ˆç¼ºç‚¹å—ï¼Ÿæ€ä¹ˆä¼˜åŒ–ï¼Ÿ\n<ul>\n<li>ä¸Šè¿°ä¸ºBasic Paxos ç®—æ³•ï¼Œåœ¨å•æè®®è€…çš„å‰æä¸‹æ˜¯æ²¡æœ‰é—®é¢˜çš„ï¼Œä½†æ˜¯å‡å¦‚æœ‰å¤šä¸ªæè®®è€…äº’ä¸ç›¸è®©ï¼Œé‚£ä¹ˆå°±å¯èƒ½å¯¼è‡´æ•´ä¸ªæè®®çš„è¿‡ç¨‹è¿›å…¥äº†æ­»å¾ªç¯ã€‚</li>\n<li>Lamport æå‡ºäº† Multi Paxos çš„ç®—æ³•æ€æƒ³ã€‚åœ¨å¤šä¸ªæè®®è€…çš„æƒ…å†µä¸‹ï¼Œé€‰å‡ºä¸€ä¸ªLeaderï¼ˆé¢†å¯¼è€…ï¼‰ï¼Œç”±é¢†å¯¼è€…ä½œä¸ºå”¯ä¸€çš„æè®®è€…ï¼Œè¿™æ ·å°±å¯ä»¥è§£å†³æè®®è€…å†²çªçš„é—®é¢˜ã€‚<br>\n![paxos.png)</li>\n</ul>\n</li>\n</ul>\n<h2>7.1. Raftç®—æ³•</h2>\n<ul>\n<li>Raftç®—æ³•çš„è§’è‰²\n<ul>\n<li>Leaderï¼ˆé¢†å¯¼è€…ï¼‰</li>\n<li>Followerï¼ˆè·Ÿéšè€…ï¼‰</li>\n<li>Candidateï¼ˆå€™é€‰äººï¼‰</li>\n</ul>\n</li>\n<li>é¢†å¯¼è€…ç”±è·Ÿéšè€…æŠ•ç¥¨é€‰å‡ºã€‚åˆšå¼€å§‹æ²¡æœ‰ é¢†å¯¼è€…ï¼Œæ‰€æœ‰é›†ç¾¤ä¸­çš„ å‚ä¸è€… éƒ½æ˜¯ è·Ÿéšè€…ã€‚æ‰€æœ‰è·Ÿéšè€… éƒ½èƒ½å‚ä¸ç«é€‰ï¼Œè¿™æ—¶æ‰€æœ‰è·Ÿéšè€…çš„è§’è‰²å°±å˜æˆäº† å€™é€‰äººï¼Œæ°‘ä¸»æŠ•ç¥¨é€‰å‡ºé¢†è¢–åå°±å¼€å§‹äº†è¿™å±Šé¢†è¢–çš„ä»»æœŸTermï¼Œç„¶åé€‰ä¸¾ç»“æŸï¼Œæ‰€æœ‰é™¤ é¢†å¯¼è€… çš„ å€™é€‰äºº åˆå˜å› è·Ÿéšè€… æœä»é¢†å¯¼è€…é¢†å¯¼ã€‚</li>\n<li>Leaderé€‰ä¸¾è¿‡ç¨‹\n<ul>\n<li>Raft ä½¿ç”¨å¿ƒè·³ï¼ˆheartbeatï¼‰è§¦å‘Leaderé€‰ä¸¾ã€‚å½“Serverå¯åŠ¨æ—¶ï¼Œåˆå§‹åŒ–ä¸ºFollowerã€‚Leaderå‘æ‰€æœ‰Followerså‘¨æœŸæ€§å‘é€heartbeatã€‚å¦‚æœFolloweråœ¨é€‰ä¸¾è¶…æ—¶æ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°Leaderçš„heartbeatï¼Œå°±ä¼šç­‰å¾…ä¸€æ®µéšæœºçš„æ—¶é—´åå‘èµ·ä¸€æ¬¡Leaderé€‰ä¸¾ã€‚Followerå°†å…¶å½“å‰termåŠ ä¸€ç„¶åè½¬æ¢ä¸ºCandidateã€‚å®ƒé¦–å…ˆç»™è‡ªå·±æŠ•ç¥¨å¹¶ä¸”ç»™é›†ç¾¤ä¸­çš„å…¶ä»–æœåŠ¡å™¨å‘é€ RequestVote RPC ã€‚ç»“æœæœ‰ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</li>\n<li>èµ¢å¾—äº†å¤šæ•°ï¼ˆè¶…è¿‡1/2ï¼‰çš„é€‰ç¥¨ï¼ŒæˆåŠŸé€‰ä¸¾ä¸ºLeaderï¼›</li>\n<li>æ”¶åˆ°äº†Leaderçš„æ¶ˆæ¯ï¼Œè¡¨ç¤ºæœ‰å…¶å®ƒæœåŠ¡å™¨å·²ç»æŠ¢å…ˆå½“é€‰äº†Leaderï¼›</li>\n<li>æ²¡æœ‰Serverèµ¢å¾—å¤šæ•°çš„é€‰ç¥¨ï¼ŒLeaderé€‰ä¸¾å¤±è´¥ï¼Œç­‰å¾…é€‰ä¸¾æ—¶é—´è¶…æ—¶ï¼ˆElection Timeoutï¼‰åå‘èµ·ä¸‹ä¸€æ¬¡é€‰ä¸¾ã€‚</li>\n<li>é€‰å‡º Leader åï¼ŒLeader é€šè¿‡ å®šæœŸ å‘æ‰€æœ‰ Follower å‘é€ å¿ƒè·³ä¿¡æ¯ ç»´æŒå…¶ç»Ÿæ²»ã€‚è‹¥ Follower ä¸€æ®µæ—¶é—´æœªæ”¶åˆ° Leader çš„ å¿ƒè·³ï¼Œåˆ™è®¤ä¸º Leader å¯èƒ½å·²ç»æŒ‚äº†ï¼Œç„¶åå†æ¬¡å‘èµ· é€‰ä¸¾ è¿‡ç¨‹ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>8. åˆ†å¸ƒå¼idéœ€è¦æ»¡è¶³ä»€ä¹ˆæ¡ä»¶ï¼Ÿå¸¸è§ç”Ÿæˆæ–¹æ³•æœ‰å“ªäº›ï¼Ÿâˆš</h1>\n<ul>\n<li>\n<p>å…¨å±€å”¯ä¸€</p>\n</li>\n<li>\n<p>é«˜æ€§èƒ½ï¼šé«˜å¯ç”¨ä½å»¶æ—¶ï¼ŒIDç”Ÿæˆå“åº”è¦å—ï¼Œå¦åˆ™åå€’ä¼šæˆä¸ºä¸šåŠ¡ç“¶é¢ˆ</p>\n</li>\n<li>\n<p>é«˜å¯ç”¨ï¼š100%çš„å¯ç”¨æ€§æ˜¯éª—äººçš„ï¼Œä½†æ˜¯ä¹Ÿè¦æ— é™æ¥è¿‘äº100%çš„å¯ç”¨æ€§</p>\n</li>\n<li>\n<p>å¥½æ¥å…¥ï¼šè¦ç§‰ç€æ‹¿æ¥å³ç”¨çš„è®¾è®¡åŸåˆ™ï¼Œåœ¨ç³»ç»Ÿè®¾è®¡å’Œå®ç°ä¸Šè¦å°½å¯èƒ½çš„ç®€å•</p>\n</li>\n<li>\n<p>è¶‹åŠ¿é€’å¢ï¼šæœ€å¥½è¶‹åŠ¿é€’å¢ï¼Œè¿™ä¸ªè¦æ±‚å°±å¾—çœ‹å…·ä½“ä¸šåŠ¡åœºæ™¯äº†ï¼Œä¸€èˆ¬ä¸ä¸¥æ ¼è¦æ±‚</p>\n</li>\n<li>\n<p>Redisæ˜¯å•çº¿ç¨‹çš„å¹¶ä¸”reidsä¸­çš„incrå‘½ä»¤æ˜¯åŸå­è‡ªå¢çš„ã€‚redisæ˜¯ç¬¬ä¸‰æ–¹çš„ç»„ä»¶ï¼Œå¦‚æœæœ¬èº«ç³»ç»Ÿä¸­å°±æ²¡æœ‰ä½¿ç”¨redisï¼Œè¿™æ—¶ä½¿ç”¨rediså°±ä¼šå¢åŠ ç³»ç»Ÿçš„è´Ÿæ‹…ï¼Œå› ä¸ºä¸€æ—¦ä½¿ç”¨å°±æ˜¯é›†ç¾¤ï¼Œè€Œä¸”è‡³å°‘å¾—ä¸‰ä¸ªå“¨å…µé›†ç¾¤ã€‚<br>\nrediså¦‚æœä½¿ç”¨RBDä½œä¸ºæŒä¹…åŒ–ï¼Œé‚£åœ¨ä¸€ä¸ªå¿«ç…§æ—¶é—´å†…å®•æœºäº†ï¼Œæ­¤æ—¶è¿˜æœªè¿›è¡Œåƒå°±ä¼šï¼Œæ¢å¤åä¼šå‡ºç°IDé‡å¤.ä½¿ç”¨AOFè¿›è¡ŒæŒä¹…åŒ–ï¼Œæ¢å¤è¾ƒæ…¢ã€‚ï¼ˆè‡³å°‘ä¸¢å¤±1så¾—æ•°æ®ï¼‰</p>\n</li>\n<li>\n<p>UUID</p>\n</li>\n<li>\n<p>é›ªèŠ±ç®—æ³•:twitterå¼€æºå¾—åˆ†å¸ƒå¼idç”Ÿæˆæ–¹æ¡ˆã€‚å…¶æ ¸å¿ƒæ€æƒ³å°±æ˜¯ï¼šä½¿ç”¨ä¸€ä¸ª64bitå¾—longå‹æ•°å­—ä½œä¸ºå…¨å±€å”¯ä¸€idã€‚</p>\n</li>\n<li>\n<p>ç¬¬ä¸€éƒ¨åˆ†1ä¸ªbitï¼š0ï¼ŒäºŒè¿›åˆ¶çš„æœ€é«˜ä½ä¸ºç¬¦å·ä½ã€‚0è¡¨ç¤ºæ•´æ•°ï¼Œ1è¡¨ç¤ºè´Ÿæ•°ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äºŒéƒ¨åˆ†æ˜¯41bitçš„æ—¶é—´æˆ³ã€‚å•ä½æ˜¯æ¯«ç§’ã€‚41bitå¯ä»¥è¡¨ç¤ºçš„æ•°å­—å¤šè¾¾241-1,ä¹Ÿå°±æ˜¯å¯ä»¥æ ‡è¯†241-1æ¯«ç§’ï¼Œçº¦ç­‰äº69å¹´(ä»1970å¹´å¼€å§‹)ã€‚</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰éƒ¨åˆ†5ä¸ªbitï¼šè¡¨ç¤ºæœºæˆ¿idï¼Œæœ€å¤šè¡¨ç¤º2^5ä¸ªæœºæˆ¿</p>\n</li>\n<li>\n<p>ç¬¬å››éƒ¨åˆ†ä¸º5ä¸ªbitï¼šè¡¨ç¤ºçš„æ˜¯æœºå™¨idã€‚æ¯ä¸ªæˆ¿é—´é‡Œå¯ä»¥æœ‰2^5ä¸ªæœºå™¨ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äº”éƒ¨åˆ†12ä¸ªbitï¼šè¡¨ç¤ºåºå·ï¼Œå°±æ˜¯æŸä¸ªæœºæˆ¿æŸå°æœºå™¨ä¸Šä¸€æ¯«ç§’å†…åŒæ—¶ç”Ÿæˆçš„idçš„åºå·ã€‚12bitå¯ä»¥ä»£è¡¨çš„æœ€å¤§æ­£æ•´æ•°æ˜¯2^12-1,ä¸€å…±4096ä¸ªæ•°ï¼Œä¹Ÿå°±æ˜¯è¯´ä¸€æ¯«ç§’å†…å¯ä»¥ç”Ÿæˆ4096ä¸ªå”¯ä¸€idã€‚å¦‚æœåœ¨åŒä¸€æ¯«ç§’å†…ï¼Œåˆ™å°†åºåˆ—å·é€’å¢1ï¼Œä½¿ç”¨æ©ç ï¼ˆæœ€ä½12ä½ä¸º1ï¼Œé«˜ä½éƒ½ä¸º0ï¼‰è¿›è¡Œä½ä¸è¿è¡Œåå¦‚æœå€¼ä¸º0ï¼Œåˆ™è‡ªå¢åçš„åºåˆ—å·è¶…è¿‡äº†4095</p>\n</li>\n<li>\n<p>é«˜æ€§èƒ½é«˜å¯ç”¨ï¼Œç”Ÿæˆæ—¶ä¸ä¾èµ–äºæ•°æ®åº“ï¼Œå®Œå…¨åœ¨å†…å­˜ä¸­ç”Ÿæˆã€‚å®¹é‡å¤§ï¼šæ¯ç§’èƒ½ç”Ÿæˆç™¾ä¸‡çš„è‡ªå¢idã€‚idè‡ªå¢:æ—¶é—´æ—¶è‡ªå¢çš„ï¼Œæ‰€ä»¥ç”Ÿæˆçš„idä¹Ÿæ˜¯è‡ªå¢çš„ã€‚</p>\n</li>\n<li>\n<p>ç¼ºç‚¹ï¼šä¾èµ–ä¸ç³»ç»Ÿæ—¶é—´çš„ä¸€è‡´æ€§ï¼Œå¦‚æœç³»ç»Ÿæ—¶é—´è¢«å›è°ƒï¼Œæˆ–è€…æ”¹å˜ï¼Œå¯èƒ½é€ æˆé‡å¤çš„idã€‚ç®—æ³•ä¸­å¯é€šè¿‡è®°å½•æœ€åä¸€ä¸ªç”Ÿæˆ id æ—¶çš„æ—¶é—´æˆ³æ¥è§£å†³ï¼Œæ¯æ¬¡ç”Ÿæˆ id ä¹‹å‰æ¯”è¾ƒå½“å‰æœåŠ¡å™¨æ—¶é’Ÿæ˜¯å¦è¢«å›æ‹¨ï¼Œé¿å…ç”Ÿæˆé‡å¤ id</p>\n</li>\n<li>\n<p>redisé›†ç¾¤çš„incræ–¹æ³•</p>\n</li>\n</ul>\n<h1>9. å¦‚ä½•è®¾è®¡åˆ†å¸ƒå¼é”ï¼Ÿåˆ†å¸ƒå¼é”æ€ä¹ˆå®ç°ï¼Ÿâˆš</h1>\n<ul>\n<li>å…·å¤‡åŸå­æ€§ã€å¯é‡å…¥æ€§ï¼›å…·å¤‡é”å¤±æ•ˆæœºåˆ¶ï¼Œé˜²æ­¢æ­»é”ï¼›å…·å¤‡éé˜»å¡é”ç‰¹æ€§ï¼Œå³æ²¡è·å–åˆ°é”è¿”å›è·å–é”å¤±è´¥ï¼Œè€Œä¸æ˜¯ä¸€ç›´ç­‰å¾…</li>\n<li>é«˜æ€§èƒ½ã€é«˜å¯ç”¨çš„è·å–ä¸é‡Šæ”¾é”</li>\n<li>åˆ†å¸ƒå¼é”çš„å®ç°æ–¹å¼ï¼š\n<ul>\n<li>åŸºäºæ•°æ®åº“ï¼š\n<ul>\n<li>ç”¨æ•°æ®åº“çš„æ’ä»–é”å®ç°select * from xxx for update</li>\n<li>åˆ›å»ºä¸€å¼ é”è¡¨ï¼Œæ•°æ®åº“å¯¹å­—æ®µä½œå”¯ä¸€æ€§çº¦æŸã€‚åŠ é”çš„æ—¶å€™ï¼Œåœ¨é”è¡¨ä¸­å¢åŠ ä¸€æ¡è®°å½•å³å¯ï¼›é‡Šæ”¾é”çš„æ—¶å€™åˆ é™¤è®°å½•å°±è¡Œã€‚å¦‚æœæœ‰å¹¶å‘è¯·æ±‚åŒæ—¶æäº¤åˆ°æ•°æ®åº“ï¼Œæ•°æ®åº“ä¼šä¿è¯åªæœ‰ä¸€ä¸ªè¯·æ±‚èƒ½å¤Ÿå¾—åˆ°é”ã€‚å±äºæ•°æ®åº“ IO æ“ä½œï¼Œæ•ˆç‡ä¸é«˜ï¼Œè€Œä¸”é¢‘ç¹æ“ä½œä¼šå¢å¤§æ•°æ®åº“çš„å¼€é”€ï¼Œå› æ­¤è¿™ç§æ–¹å¼åœ¨é«˜å¹¶å‘ã€é«˜æ€§èƒ½çš„åœºæ™¯ä¸­ç”¨çš„ä¸å¤šã€‚</li>\n</ul>\n</li>\n<li>åŸºäºredisï¼šåˆ©ç”¨redisçš„set key value NX EX 30000ï¼›ä¹Ÿå¯ä»¥ç”¨redisçš„ç¬¬ä¸‰æ–¹åº“æ¯”å¦‚Redisson</li>\n<li>åŸºäºzookeeperï¼šåˆ©ç”¨zookeeperçš„ä¸´æ—¶é¡ºåºèŠ‚ç‚¹å®ç°ï¼›æ¯ä¸ªçº¿ç¨‹éƒ½æ˜¯å…ˆåˆ›å»ºä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œç„¶åè·å–å½“å‰ç›®å½•ä¸‹æœ€å°çš„èŠ‚ç‚¹(åºå·)ï¼Œåˆ¤æ–­æœ€å°èŠ‚ç‚¹æ˜¯ä¸æ˜¯å½“å‰èŠ‚ç‚¹ï¼Œå¦‚æœæ˜¯é‚£ä¹ˆè·å–é”æˆåŠŸï¼Œå¦‚æœä¸æ˜¯é‚£ä¹ˆè·å–é”å¤±è´¥ã€‚è·å–é”å¤±è´¥çš„çº¿ç¨‹è·å–å½“å‰èŠ‚ç‚¹ä¸Šä¸€ä¸ªä¸´æ—¶é¡ºåºèŠ‚ç‚¹ï¼Œå¹¶å¯¹å¯¹æ­¤èŠ‚ç‚¹è¿›è¡Œç›‘å¬ï¼Œå½“è¯¥èŠ‚ç‚¹åˆ é™¤çš„æ—¶å€™(ä¸Šä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œç»“æŸåˆ é™¤æˆ–è€…æ˜¯æ‰çº¿zkåˆ é™¤ä¸´æ—¶èŠ‚ç‚¹)è¿™ä¸ªçº¿ç¨‹ä¼šè·å–åˆ°é€šçŸ¥ï¼Œä»£è¡¨è·å–åˆ°äº†é”ã€‚å…¬å¹³é”ä½¿ç”¨ä¸´æ—¶èŠ‚ç‚¹å®ç°ï¼Œéå…¬å¹³é”ä½¿ç”¨ä¸´æ—¶é¡ºåºèŠ‚ç‚¹å®ç°.ä¹Ÿå¯ä»¥ç”¨zookeeperçš„ç¬¬ä¸‰æ–¹åº“æ¯”å¦‚Curator</li>\n</ul>\n</li>\n</ul>\n<h1>10. åˆ†å¸ƒå¼äº‹åŠ¡</h1>\n<ul>\n<li>åˆ†å¸ƒå¼äº‹åŠ¡æ˜¯æŒ‡äº‹åŠ¡çš„å‚ä¸è€…ã€æ”¯æŒäº‹åŠ¡çš„æœåŠ¡å™¨ã€èµ„æºæœåŠ¡å™¨ä»¥åŠäº‹åŠ¡ç®¡ç†å™¨åˆ†åˆ«ä½äºä¸åŒçš„åˆ†å¸ƒå¼ç³»ç»Ÿçš„ä¸åŒèŠ‚ç‚¹ä¹‹ä¸Šã€‚å¸ƒå¼äº‹åŠ¡éœ€è¦ä¿è¯è¿™äº›åˆ†æ”¯äº‹åŠ¡è¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/93416270ed2d740c33a9d.png\" alt=\"distributedtransaction.png\" tabindex=\"0\"><figcaption>distributedtransaction.png</figcaption></figure>\n<ul>\n<li>\n<p>XAæ–¹æ¡ˆ/2PCäºŒé˜¶æ®µæäº¤</p>\n<ul>\n<li>XAåˆ†å¸ƒå¼äº‹åŠ¡çš„è§„èŒƒï¼Œç”±X/Openç»„ç»‡æå‡ºï¼Œå®šä¹‰äº†(å…¨å±€)äº‹åŠ¡ç®¡ç†å™¨(TM)å’Œ(å±€éƒ¨)èµ„æºç®¡ç†å™¨(RM)ä¹‹é—´çš„æ¥å£ã€‚ä¸»æµçš„æ•°æ®åº“åŸºæœ¬éƒ½æ”¯æŒXAäº‹åŠ¡ï¼ŒåŒ…æ‹¬mysqlã€oracleã€sqlserver</li>\n<li>XAäº‹åŠ¡ç”±ä¸€ä¸ªæˆ–å¤šä¸ªèµ„æºç®¡ç†å™¨ï¼ˆRMï¼‰(æ•°æ®åº“)ã€ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨ï¼ˆTMï¼‰å’Œä¸€ä¸ªåº”ç”¨ç¨‹åºï¼ˆApplicationProgramï¼‰ç»„æˆã€‚</li>\n<li>XAä¸€å…±åˆ†ä¸ºä¸¤é˜¶æ®µï¼š\n<ul>\n<li>ç¬¬ä¸€é˜¶æ®µï¼ˆprepareï¼‰æ‰€æœ‰çš„å‚ä¸è€…RMå‡†å¤‡æ‰§è¡Œäº‹åŠ¡å¹¶é”ä½éœ€è¦çš„èµ„æºã€‚å‚ä¸è€…readyæ—¶ï¼Œå‘TMæŠ¥å‘Šå·²å‡†å¤‡å°±ç»ªã€‚</li>\n<li>ç¬¬äºŒé˜¶æ®µ (commit/rollback)ï¼šå½“äº‹åŠ¡ç®¡ç†è€…(TM)ç¡®è®¤æ‰€æœ‰å‚ä¸è€…(RM)éƒ½readyåï¼Œå‘æ‰€æœ‰å‚ä¸è€…å‘é€commitå‘½ä»¤ã€‚æœ‰ä»»ä½•ä¸€ä¸ªå‚ä¸è€…(RM)readyå¤±è´¥ï¼Œå‘æ‰€æœ‰å‚ä¸è€…å‘é€rollbackå‘½ä»¤ï¼Œè‹¥åœ¨commitè¿‡ç¨‹ä¸­å‡ºç°å®•æœºç­‰å¼‚å¸¸æ—¶ï¼Œåˆ™åœ¨èŠ‚ç‚¹æœåŠ¡é‡å¯åï¼Œå¯æ ¹æ® XA recover å†æ¬¡è¿›è¡Œ commit è¡¥å¿ï¼Œä»¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>é—®é¢˜</p>\n<ul>\n<li>å•ç‚¹é—®é¢˜ï¼šå•æœºäº‹åŠ¡ç®¡ç†å™¨å®•æœºå¯¼è‡´èµ„æºç®¡ç†å™¨é˜»å¡ï¼Œæ•°æ®åº“æ— æ³•ä½¿ç”¨.</li>\n<li>æ€§èƒ½é—®é¢˜ï¼šå‡†å¤‡å°±ç»ªåèµ„æºä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œç›´åˆ°æäº¤å®Œæˆï¼Œé‡Šæ”¾èµ„æº.å¹¶å‘åº¦ä½</li>\n<li>æ•°æ®ä¸€è‡´æ€§é—®é¢˜ï¼Œå› ä¸ºç½‘ç»œé—®é¢˜éƒ¨åˆ†èµ„æºç®¡ç†å™¨æ‰§è¡Œäº†æäº¤ï¼Œä½†å…¶ä»–èµ„æºç®¡ç†å™¨æ²¡æœ‰æ‰§è¡Œã€‚æ•°æ®ä¸ä¸€è‡´</li>\n</ul>\n</li>\n<li>\n<p>javaè¯­è¨€å¯å‚è€ƒseataã€Sharding Sphereã€Spring JTA + Atomikos</p>\n</li>\n<li>\n<p>åº”ç”¨åœºæ™¯ï¼šé€‚åˆå•å—åº”ç”¨é‡Œï¼Œè·¨å¤šä¸ªåº“çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Œè€Œä¸”å› ä¸ºä¸¥é‡ä¾èµ–äºæ•°æ®åº“å±‚é¢æ¥æå®šå¤æ‚çš„äº‹åŠ¡ï¼Œæ•ˆç‡å¾ˆä½ï¼Œç»å¯¹ä¸é€‚åˆé«˜å¹¶å‘çš„åœºæ™¯ã€‚å¾®æœåŠ¡è§„å®šå’Œè§„èŒƒï¼Œæ˜¯è¦æ±‚æ¯ä¸ªæœåŠ¡åªèƒ½æ“ä½œè‡ªå·±å¯¹åº”çš„ä¸€ä¸ªæ•°æ®åº“ã€‚å¦‚æœä½ è¦æ“ä½œåˆ«äººçš„æœåŠ¡çš„åº“ï¼Œä½ å¿…é¡»æ˜¯é€šè¿‡è°ƒç”¨åˆ«çš„æœåŠ¡çš„æ¥å£æ¥å®ç°ï¼Œç»å¯¹ä¸å…è®¸äº¤å‰è®¿é—®åˆ«äººçš„æ•°æ®åº“<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ca34bd75f2c04b1738005.png\" alt=\"xatransaction.png\"></p>\n</li>\n<li>\n<p>3PCï¼ˆä¸‰é˜¶æ®µæäº¤ï¼‰</p>\n<ul>\n<li>ä¸ºè§£å†³ä¸¤é˜¶æ®µæäº¤åè®®çš„å•ç‚¹æ•…éšœå’ŒåŒæ­¥é˜»å¡é—®é¢˜ã€‚</li>\n<li>ä¸‰é˜¶æ®µæäº¤æœ‰è¿™ä¹ˆä¸‰ä¸ªé˜¶æ®µï¼šCanCommitï¼ŒPreCommitï¼ŒDoCommitä¸‰ä¸ªé˜¶æ®µ\n<ul>\n<li>CanCommitï¼šå‡†å¤‡é˜¶æ®µã€‚åè°ƒè€…å‘å‚ä¸è€…å‘é€commitè¯·æ±‚ï¼Œå‚ä¸è€…å¦‚æœå¯ä»¥æäº¤å°±è¿”å›Yeså“åº”ï¼Œå¦åˆ™è¿”å›Noå“åº”ã€‚</li>\n<li>PreCommitï¼šé¢„æäº¤é˜¶æ®µã€‚åè°ƒè€…æ ¹æ®å‚ä¸è€…åœ¨å‡†å¤‡é˜¶æ®µçš„å“åº”åˆ¤æ–­æ˜¯å¦æ‰§è¡Œäº‹åŠ¡è¿˜æ˜¯ä¸­æ–­äº‹åŠ¡ï¼Œå‚ä¸è€…æ‰§è¡Œå®Œæ“ä½œä¹‹åè¿”å›ACKå“åº”ï¼ŒåŒæ—¶å¼€å§‹ç­‰å¾…æœ€ç»ˆæŒ‡ä»¤ã€‚</li>\n<li>DoCommitï¼šæäº¤é˜¶æ®µã€‚åè°ƒè€…æ ¹æ®å‚ä¸è€…åœ¨å‡†å¤‡é˜¶æ®µçš„å“åº”åˆ¤æ–­æ˜¯å¦æ‰§è¡Œäº‹åŠ¡è¿˜æ˜¯ä¸­æ–­äº‹åŠ¡ï¼š\n<ul>\n<li>å¦‚æœæ‰€æœ‰å‚ä¸è€…éƒ½è¿”å›æ­£ç¡®çš„ACKå“åº”ï¼Œåˆ™æäº¤äº‹åŠ¡</li>\n<li>å¦‚æœå‚ä¸è€…æœ‰ä¸€ä¸ªæˆ–å¤šä¸ªå‚ä¸è€…æ”¶åˆ°é”™è¯¯çš„ACKå“åº”æˆ–è€…è¶…æ—¶ï¼Œåˆ™ä¸­æ–­äº‹åŠ¡</li>\n<li>å¦‚æœå‚ä¸è€…æ— æ³•åŠæ—¶æ¥æ”¶åˆ°æ¥è‡ªåè°ƒè€…çš„æäº¤æˆ–è€…ä¸­æ–­äº‹åŠ¡è¯·æ±‚æ—¶ï¼Œåœ¨ç­‰å¾…è¶…æ—¶ä¹‹åï¼Œä¼šç»§ç»­è¿›è¡Œäº‹åŠ¡æäº¤</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>è§£å†³çš„åªæ˜¯ä¸¤é˜¶æ®µæäº¤ä¸­å•ä½“æ•…éšœå’ŒåŒæ­¥é˜»å¡çš„é—®é¢˜ï¼Œå› ä¸ºåŠ å…¥äº†è¶…æ—¶æœºåˆ¶ï¼Œè¿™é‡Œçš„è¶…æ—¶çš„æœºåˆ¶ä½œç”¨äº é¢„æäº¤é˜¶æ®µ å’Œ æäº¤é˜¶æ®µã€‚å¦‚æœç­‰å¾… é¢„æäº¤è¯·æ±‚ è¶…æ—¶ï¼Œå‚ä¸è€…ç›´æ¥å›åˆ°å‡†å¤‡é˜¶æ®µä¹‹å‰ã€‚å¦‚æœç­‰åˆ°æäº¤è¯·æ±‚è¶…æ—¶ï¼Œé‚£å‚ä¸è€…å°±ä¼šæäº¤äº‹åŠ¡äº†ã€‚</p>\n</li>\n<li>\n<p>æ— è®ºæ˜¯2PCè¿˜æ˜¯3PCéƒ½ä¸èƒ½ä¿è¯åˆ†å¸ƒå¼ç³»ç»Ÿä¸­çš„æ•°æ®100%ä¸€è‡´ã€‚</p>\n</li>\n<li>\n<p>TCCï¼ˆTry-Confirm-Cancelï¼‰ æ–¹æ¡ˆï¼ˆè¡¥å¿æœºåˆ¶ï¼‰</p>\n<ul>\n<li>TCCæ¨¡å‹é’ˆå¯¹æ¯ä¸ªæ“ä½œï¼Œéƒ½éœ€è¦æœ‰ä¸€ä¸ªå…¶å¯¹åº”çš„ç¡®è®¤å’Œå–æ¶ˆæ“ä½œï¼Œå½“æ“ä½œæˆåŠŸæ—¶è°ƒç”¨ç¡®è®¤æ“ä½œï¼Œå½“æ“ä½œå¤±è´¥æ—¶è°ƒç”¨å–æ¶ˆæ“ä½œï¼ŒæŠŠé”çš„ç²’åº¦å®Œå…¨äº¤ç»™ä¸šåŠ¡å¤„ç†ï¼Œå®ƒéœ€è¦æ¯ä¸ªå­äº‹åŠ¡ä¸šåŠ¡éƒ½å®ç°Try-Confirm/Cancelæ¥å£ã€‚TCCæ¨¡å¼æœ¬è´¨ä¹Ÿæ˜¯2PC ï¼Œåªæ˜¯TCCåœ¨åº”ç”¨å±‚æ§åˆ¶ã€‚</li>\n<li>TCCåˆ†ä¸º3ä¸ªé˜¶æ®µ\n<ul>\n<li>Tryé˜¶æ®µï¼šå°è¯•æ‰§è¡Œï¼Œå®Œæˆæ‰€æœ‰ä¸šåŠ¡æ£€æŸ¥ï¼ˆä¸€è‡´æ€§ï¼‰, é¢„ç•™å¿…é¡»ä¸šåŠ¡èµ„æºï¼ˆå‡†éš”ç¦»æ€§ï¼‰å¯¹å„ä¸ªæœåŠ¡çš„èµ„æºåšæ£€æµ‹ä»¥åŠå¯¹èµ„æºè¿›è¡Œé”å®šæˆ–è€…é¢„ç•™ã€‚</li>\n<li>Confirmé˜¶æ®µï¼šç¡®è®¤æ‰§è¡ŒçœŸæ­£æ‰§è¡Œä¸šåŠ¡ï¼Œä¸ä½œä»»ä½•ä¸šåŠ¡æ£€æŸ¥ï¼Œåªä½¿ç”¨Tryé˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºï¼ŒConfirmæ“ä½œè¦æ±‚å…·å¤‡å¹‚ç­‰è®¾è®¡ï¼ŒConfirmå¤±è´¥åéœ€è¦è¿›è¡Œé‡è¯•ã€‚</li>\n<li>Cancelé˜¶æ®µï¼šå–æ¶ˆæ‰§è¡Œï¼Œé‡Šæ”¾Tryé˜¶æ®µé¢„ç•™çš„ä¸šåŠ¡èµ„æºã€‚Cancelé˜¶æ®µæ»¡è¶³å¹‚ç­‰è®¾è®¡ã€‚å¦‚æœä»»ä½•ä¸€ä¸ªæœåŠ¡çš„ä¸šåŠ¡æ–¹æ³•æ‰§è¡Œå‡ºé”™ï¼Œé‚£ä¹ˆè¿™é‡Œå°±éœ€è¦è¿›è¡Œè¡¥å¿ï¼Œå°±æ˜¯æ‰§è¡Œå·²ç»æ‰§è¡ŒæˆåŠŸçš„ä¸šåŠ¡é€»è¾‘çš„å›æ»šæ“ä½œã€‚ï¼ˆæŠŠé‚£äº›æ‰§è¡ŒæˆåŠŸçš„å›æ»šï¼‰</li>\n</ul>\n</li>\n<li>é€šå¸¸ä¼šåœ¨Tryé‡Œé¢å†»ç»“é‡‘é¢ï¼Œä½†ä¸æ‰£æ¬¾ï¼ŒConfirmé‡Œé¢æ‰£æ¬¾ï¼ŒCancelé‡Œé¢è§£å†»é‡‘é¢ï¼Œä¸€ä¸ªæˆåŠŸå®Œæˆçš„TCCäº‹åŠ¡æ—¶åºå›¾å¦‚ä¸‹ï¼š</li>\n</ul>\n</li>\n<li>\n<p>ä¼˜ç¼ºç‚¹</p>\n<ul>\n<li>è§„é¿äº†æ•°æ®åº“çš„2PCæ€§èƒ½ä½ä¸‹é—®é¢˜ã€‚å¹¶å‘åº¦è¾ƒé«˜ï¼Œæ— é•¿æœŸèµ„æºé”å®šã€‚</li>\n<li>ä¸€è‡´æ€§è¾ƒå¥½ï¼Œä¸ä¼šå‘ç”ŸSAGAå·²æ‰£æ¬¾æœ€ååˆè½¬è´¦å¤±è´¥çš„æƒ…å†µ</li>\n<li>åº”ç”¨ä¾µå…¥æ€§å¼ºï¼Œå¼€å‘é‡è¾ƒå¤§ï¼Œtryã€confirmã€cancelä¸‰ä¸ªé˜¶æ®µéƒ½éœ€è¦ä¸šåŠ¡é€»è¾‘å®ç°ã€‚éœ€è¦æ ¹æ®ç½‘ç»œã€ç³»ç»Ÿæ•…éšœç­‰ä¸åŒå¤±è´¥åŸå› å®ç°ä¸åŒçš„å›æ»šç­–ç•¥ï¼Œå®ç°éš¾åº¦å¤§</li>\n<li>é€‚ç”¨äºè®¢å•ç±»ä¸šåŠ¡ï¼Œå¯¹ä¸­é—´çŠ¶æ€æœ‰çº¦æŸçš„ä¸šåŠ¡</li>\n<li>åœ¨éœ€è¦å‰ç½®èµ„æºé”å®šçš„åœºæ™¯ï¼Œä¸å¾—ä¸ä½¿ç”¨ XA æˆ– TCC çš„æ–¹å¼ã€‚å¦‚ä¸‹å•åœºæ™¯ï¼Œåœ¨è®¢å•åˆ›å»ºä¹‹å‰ï¼Œéœ€è¦æ‰£é™¤ä¼˜æƒ åˆ¸ã€é’±åŒ…ä½™é¢ã€ç§¯åˆ†ç­‰ä¸å¾—ä¸è¿›è¡Œå‰ç½®å¤šèµ„æºé”å®šï¼Œæ— éæ˜¯ä½¿ç”¨ XA çš„å¼ºé”ï¼Œè¿˜æ˜¯ TCC çš„å¼±é”ã€‚å½“ç„¶ï¼Œå¦‚æœèƒ½ä¸ç”¨ TCC çš„æƒ…å†µä¸‹ï¼Œå°½é‡ä¸è¦ç”¨ TCC ã€‚å› ä¸ºï¼Œç¼–å†™å›æ»šé€»è¾‘çš„ä»£ç ï¼Œå¯èƒ½ä¼šæ¯”è¾ƒæ¶å¿ƒã€‚</li>\n<li>ByteTCCï¼ŒTCC-transactionï¼ŒHimlyã€‚javaè¯­è¨€å¯å‚è€ƒseata<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2276c860cf983b0edff09.png\" alt=\"tcctransaction.png\"></li>\n</ul>\n</li>\n<li>\n<p>SAGAæ–¹æ¡ˆ</p>\n<ul>\n<li>Sagaæ˜¯å°†é•¿äº‹åŠ¡æ‹†åˆ†ä¸ºå¤šä¸ªæœ¬åœ°çŸ­äº‹åŠ¡ï¼Œç”±Sagaäº‹åŠ¡åè°ƒå™¨åè°ƒï¼Œå¦‚æœæ­£å¸¸ç»“æŸé‚£å°±æ­£å¸¸å®Œæˆï¼Œå¦‚æœæŸä¸ªæ­¥éª¤å¤±è´¥ï¼Œåˆ™æ ¹æ®ç›¸åé¡ºåºä¸€æ¬¡è°ƒç”¨è¡¥å¿æ“ä½œã€‚</li>\n<li>Sagaç»„æˆå¦‚ä¸‹ï¼š\n<ul>\n<li>æ¯ä¸ªSagaç”±ä¸€ç³»åˆ—sub-transaction Ti ç»„æˆ</li>\n<li>æ¯ä¸ªTiéƒ½æœ‰å¯¹åº”çš„è¡¥å¿åŠ¨ä½œCi ï¼Œè¡¥å¿åŠ¨ä½œç”¨äºæ’¤é”€Tié€ æˆçš„ç»“æœã€‚æ¯ä¸ªTéƒ½æ˜¯ä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ã€‚</li>\n<li>å’ŒTCCç›¸æ¯”ï¼ŒSagaæ²¡æœ‰tryåŠ¨ä½œ ï¼Œå®ƒçš„Tiå°±æ˜¯ç›´æ¥æäº¤åˆ°åº“</li>\n</ul>\n</li>\n<li>Sagaçš„æ‰§è¡Œé¡ºåºæœ‰ä¸¤ç§ï¼š\n<ul>\n<li>å­äº‹åŠ¡åºåˆ— T1, T2, â€¦, Tnå¾—ä»¥å®Œæˆ (æœ€ä½³æƒ…å†µ)ã€‚</li>\n<li>æˆ–è€…åºåˆ— T1, T2, â€¦, Tj, Cj, â€¦, C2, C1, 0 &lt; j &lt; n, å¾—ä»¥å®Œæˆã€‚</li>\n</ul>\n</li>\n<li>Saga å®šä¹‰äº†ä¸¤ç§æ¢å¤ç­–ç•¥ï¼š\n<ul>\n<li>å‘åæ¢å¤ï¼šè¡¥å¿æ‰€æœ‰å·²å®Œæˆçš„äº‹åŠ¡ï¼Œå¦‚æœä»»ä¸€å­äº‹åŠ¡å¤±è´¥ã€‚ï¼ˆç¬¬äºŒç§æ‰§è¡Œé¡ºåºï¼‰</li>\n<li>å‘å‰æ¢å¤ï¼šé‡è¯•å¤±è´¥çš„äº‹åŠ¡ï¼Œå‡è®¾æ¯ä¸ªå­äº‹åŠ¡æœ€ç»ˆéƒ½ä¼šæˆåŠŸã€‚å‘å‰æ¢å¤æ²¡æœ‰å¿…è¦æä¾›è¡¥å¿äº‹åŠ¡ï¼Œå¦‚æœä½ çš„ä¸šåŠ¡ä¸­ï¼Œå­äº‹åŠ¡ï¼ˆæœ€ç»ˆï¼‰æ€»ä¼šæˆåŠŸï¼Œæˆ–è¡¥å¿äº‹åŠ¡éš¾ä»¥å®šä¹‰æˆ–ä¸å¯èƒ½ï¼Œå‘å‰æ¢å¤æ›´ç¬¦åˆä½ çš„éœ€æ±‚ã€‚ç†è®ºä¸Šè¡¥å¿äº‹åŠ¡æ°¸ä¸å¤±è´¥ï¼Œç„¶è€Œï¼Œåœ¨åˆ†å¸ƒå¼ä¸–ç•Œä¸­ï¼ŒæœåŠ¡å™¨å¯èƒ½ä¼šå®•æœºã€ç½‘ç»œå¯èƒ½ä¼šå¤±è´¥ï¼Œç”šè‡³æ•°æ®ä¸­å¿ƒä¹Ÿå¯èƒ½ä¼šåœç”µï¼Œè¿™æ—¶éœ€è¦æä¾›æ•…éšœæ¢å¤åå›é€€çš„æœºåˆ¶ï¼Œæ¯”å¦‚äººå·¥å¹²é¢„ã€‚</li>\n</ul>\n</li>\n<li>å¦‚ä½•è§£å†³æ²¡æœ‰ Prepareé˜¶æ®µå¯èƒ½å¸¦æ¥çš„é—®é¢˜ï¼Ÿç”±äº Saga æ¨¡å‹ä¸­æ²¡æœ‰ Prepare é˜¶æ®µï¼Œå› æ­¤äº‹åŠ¡é—´ä¸èƒ½ä¿è¯éš”ç¦»æ€§ï¼Œå½“å¤šä¸ª Saga äº‹åŠ¡æ“ä½œåŒä¸€èµ„æºæ—¶ï¼Œå°±ä¼šäº§ç”Ÿæ›´æ–°ä¸¢å¤±ã€è„æ•°æ®è¯»å–ç­‰é—®é¢˜ï¼Œè¿™æ—¶éœ€è¦åœ¨ä¸šåŠ¡å±‚æ§åˆ¶å¹¶å‘ã€‚ä¾‹å¦‚ï¼šåœ¨åº”ç”¨å±‚é¢åŠ é”ã€‚åº”ç”¨å±‚é¢é¢„å…ˆå†»ç»“èµ„æºã€‚</li>\n<li>å¹¶å‘åº¦é«˜ï¼Œä¸ç”¨åƒXAäº‹åŠ¡é‚£æ ·é•¿æœŸé”å®šèµ„æº</li>\n<li>éœ€è¦å®šä¹‰æ­£å¸¸æ“ä½œä»¥åŠè¡¥å¿æ“ä½œï¼Œå¼€å‘é‡æ¯”XAå¤§</li>\n<li>ä¸€è‡´æ€§è¾ƒå¼±ï¼Œå¯¹äºè½¬è´¦ï¼Œå¯èƒ½å‘ç”ŸAç”¨æˆ·å·²æ‰£æ¬¾ï¼Œæœ€åè½¬è´¦åˆå¤±è´¥çš„æƒ…å†µ</li>\n<li>é€‚ç”¨äºé•¿äº‹åŠ¡ï¼Œå¯¹ä¸­é—´ç»“æœä¸æ•æ„Ÿçš„ä¸šåŠ¡åœºæ™¯é€‚ç”¨</li>\n<li>goè¯­è¨€å¯å‚è€ƒDTMï¼Œjavaè¯­è¨€å¯å‚è€ƒseataã€Apache Service Comb çš„ Saga äº‹åŠ¡å¼•æ“ã€Sharding Sphere çš„ Saga æ”¯æŒ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a62fef45ab701a92cfb2f.png\" alt=\"sagatransaction.png\"></li>\n</ul>\n</li>\n<li>\n<p>æœ¬åœ°æ¶ˆæ¯è¡¨ebay</p>\n<ul>\n<li>åœ¨æ¶ˆæ¯å‘é€æ–¹çš„åŒä¸€ä¸ªä¸šåŠ¡æ•°æ®åº“ä¸­æ·»åŠ ä¸€ä¸ªè®°å½•ç€æ¶ˆæ¯çŠ¶æ€ç›¸å…³ä¿¡æ¯çš„æ¶ˆæ¯è¡¨ï¼Œä¿è¯ä¸šåŠ¡è¡¨ä¸æ¶ˆæ¯è¡¨åœ¨åŒä¸€ä¸ªäº‹åŠ¡ï¼Œä½¿ç”¨å®šæ—¶ä»»åŠ¡è½®è¯¢æŸ¥è¯¢çŠ¶æ€ä¸ºæœªåŒæ­¥çš„æ¶ˆæ¯è¡¨ï¼Œå‘é€åˆ°MQï¼Œå¦‚æœå‘é€å¤±è´¥ï¼Œå°±é‡è¯•å‘é€</li>\n<li>æ¶ˆæ¯æ¶ˆè´¹æ–¹å¤„ç†æ¶ˆæ¯é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œå®Œæˆè‡ªå·±çš„ä¸šåŠ¡é€»è¾‘ã€‚åŒæ—¶ä¿è¯ä¸ä¼šå¤„ç†é‡å¤æ¶ˆæ¯ã€‚å¦‚æœæœ¬åœ°äº‹åŠ¡å¤„ç†å¤±è´¥ï¼Œé‚£ä¹ˆå°±ä¼šé‡è¯•æ‰§è¡Œã€‚å¦‚æœæ˜¯ä¸šåŠ¡ä¸Šé¢çš„å¤±è´¥ï¼Œç»™æ¶ˆæ¯ç”Ÿäº§æ–¹å‘é€ä¸€ä¸ªä¸šåŠ¡è¡¥å¿æ¶ˆæ¯ï¼Œé€šçŸ¥è¿›è¡Œå›æ»šç­‰æ“ä½œã€‚ä½¿ç”¨å®šæ—¶ä»»åŠ¡è½®è¯¢æŸ¥è¯¢çŠ¶æ€ä¸ºæœªåŒæ­¥çš„æ¶ˆæ¯è¡¨ï¼Œå‘é€åˆ°MQï¼Œå¦‚æœå‘é€å¤±è´¥ï¼Œå°±é‡è¯•å‘é€</li>\n<li>ä¼˜ç‚¹&amp;ç¼ºç‚¹ï¼š\n<ul>\n<li>å¾ˆå¥½åœ°è§£å†³äº†åˆ†å¸ƒå¼äº‹åŠ¡é—®é¢˜ï¼Œå®ç°äº†æœ€ç»ˆä¸€è‡´æ€§ã€‚é•¿äº‹åŠ¡ä»…éœ€è¦åˆ†æ‹†æˆå¤šä¸ªä»»åŠ¡ï¼Œä½¿ç”¨ç®€å•</li>\n<li>ç¼ºç‚¹æ˜¯æ¶ˆæ¯è¡¨ä¼šè€¦åˆåˆ°ä¸šåŠ¡ç³»ç»Ÿä¸­ã€‚æœ€ç»ˆä¸€è‡´æ€§çš„é—´éš”ä¸»è¦æœ‰å®šæ—¶ä»»åŠ¡çš„é—´éš”æ—¶é—´å†³å®šã€‚ç”Ÿäº§è€…éœ€è¦é¢å¤–çš„åˆ›å»ºæ¶ˆæ¯è¡¨ã€‚æ¯ä¸ªæœ¬åœ°æ¶ˆæ¯è¡¨éƒ½éœ€è¦è¿›è¡Œè½®è¯¢ã€‚æ¶ˆè´¹è€…çš„é€»è¾‘å¦‚æœæ— æ³•é€šè¿‡é‡è¯•æˆåŠŸï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ›´å¤šçš„æœºåˆ¶ï¼Œæ¥å›æ»šæ“ä½œ</li>\n</ul>\n</li>\n<li>é€‚ç”¨äºå¯å¼‚æ­¥æ‰§è¡Œçš„ä¸šåŠ¡ï¼Œä¸”åç»­æ“ä½œæ— éœ€å›æ»šçš„ä¸šåŠ¡</li>\n</ul>\n</li>\n<li>\n<p>å¯é æ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆ</p>\n<ul>\n<li>é˜¿é‡Œå¼€æºçš„RocketMQ4.3ä¹‹åçš„ç‰ˆæœ¬æ­£å¼æ”¯æŒäº‹åŠ¡æ¶ˆæ¯</li>\n<li>æ¶ˆæ¯å‘é€æ–¹å…ˆå‘é€ä¸€ä¸ªpreparedæ¶ˆæ¯åˆ°mqï¼Œå¦‚æœè¿™ä¸ªpreparedæ¶ˆæ¯å‘é€å¤±è´¥é‚£ä¹ˆå°±ç›´æ¥å–æ¶ˆæ“ä½œåˆ«æ‰§è¡Œäº†ï¼›å¦‚æœè¿™ä¸ªæ¶ˆæ¯å‘é€æˆåŠŸè¿‡äº†ï¼Œé‚£ä¹ˆæ¥ç€æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼Œå¦‚æœæˆåŠŸå°±å‘Šè¯‰mqå‘é€ç¡®è®¤æ¶ˆæ¯ï¼Œå¦‚æœå¤±è´¥å°±å‘Šè¯‰mqå›æ»šæ¶ˆæ¯</li>\n<li>å¦‚æœå‘é€äº†ç¡®è®¤æ¶ˆæ¯ï¼Œé‚£ä¹ˆæ­¤æ—¶æ¶ˆæ¯æ¥æ”¶æ–¹ä¼šæ¥æ”¶åˆ°ç¡®è®¤æ¶ˆæ¯ï¼Œç„¶åæ‰§è¡Œæœ¬åœ°çš„äº‹åŠ¡ï¼›</li>\n<li>mqä¼šè‡ªåŠ¨å®šæ—¶è½®è¯¢æ‰€æœ‰ prepared æ¶ˆæ¯å›è°ƒä½ çš„æ¥å£ï¼Œæ¥å£é‡Œé¢å¯ä»¥æŸ¥ä¸‹æ•°æ®åº“çœ‹ä¹‹å‰æœ¬åœ°äº‹åŠ¡å·²ç»æäº¤/å›æ»š/å¼‚å¸¸ï¼Œå›å¤ç¡®è®¤/å›æ»š/é‡è¯•ã€‚é¿å…æœ¬åœ°äº‹åŠ¡æ‰§è¡ŒæˆåŠŸäº†ï¼Œè€Œç¡®è®¤æ¶ˆæ¯å´å‘é€å¤±è´¥äº†ã€‚</li>\n<li>å¦‚æœç³»ç»ŸBçš„äº‹åŠ¡å¤±è´¥äº†è¿™è‡ªåŠ¨ä¸æ–­é‡è¯•ç›´åˆ°æˆåŠŸï¼Œå¦‚æœå®åœ¨æ˜¯ä¸è¡Œï¼Œè¦ä¹ˆå°±æ˜¯é’ˆå¯¹é‡è¦çš„èµ„é‡‘ç±»ä¸šåŠ¡è¿›è¡Œå›æ»šï¼Œæ¯”å¦‚Bç³»ç»Ÿæœ¬åœ°å›æ»šåï¼Œæƒ³åŠæ³•é€šçŸ¥ç³»ç»ŸAä¹Ÿå›æ»šï¼›æˆ–è€…æ˜¯å‘é€æŠ¥è­¦ç”±äººå·¥æ¥æ‰‹å·¥å›æ»šå’Œè¡¥å¿ã€‚</li>\n<li>é•¿äº‹åŠ¡ä»…éœ€è¦åˆ†æ‹†æˆå¤šä¸ªä»»åŠ¡ï¼Œå¹¶æä¾›ä¸€ä¸ªåæŸ¥æ¥å£ï¼Œä½¿ç”¨ç®€å•ã€æ¶ˆè´¹è€…çš„é€»è¾‘å¦‚æœæ— æ³•é€šè¿‡é‡è¯•æˆåŠŸï¼Œé‚£ä¹ˆè¿˜éœ€è¦æ›´å¤šçš„æœºåˆ¶ï¼Œæ¥å›æ»šæ“ä½œ</li>\n<li>é€‚ç”¨äºå¯å¼‚æ­¥æ‰§è¡Œçš„ä¸šåŠ¡ï¼Œä¸”åç»­æ“ä½œæ— éœ€å›æ»šçš„ä¸šåŠ¡</li>\n<li>ä¸éœ€è¦å†å»ºæ¶ˆæ¯è¡¨ï¼Œå¯¹æ€§èƒ½çš„æŸè€—å’Œä¸šåŠ¡çš„å…¥ä¾µæ›´å°</li>\n<li>å¯å‚è€ƒrocketmqï¼ŒDTMä¹Ÿæä¾›äº†ç®€å•å®ç°ï¼Œã€ŠRabbitMQ ä¹‹æ¶ˆæ¯ç¡®è®¤æœºåˆ¶ï¼ˆäº‹åŠ¡+Confirmï¼‰ã€‹</li>\n</ul>\n</li>\n<li>\n<p>æœ€å¤§åŠªåŠ›é€šçŸ¥æ–¹æ¡ˆ</p>\n<ul>\n<li>é€‚ç”¨äºä¸€äº›å¯¹æœ€ç»ˆä¸€è‡´æ€§å®æ—¶æ€§è¦æ±‚æ²¡é‚£ä¹ˆé«˜çš„ä¸šåŠ¡ï¼Œæ¯”å¦‚æ”¯ä»˜é€šçŸ¥ï¼ŒçŸ­ä¿¡é€šçŸ¥ã€‚</li>\n<li>å‘é€æ–¹æä¾›æ¥å£ï¼Œè®©æ¥å—é€šçŸ¥æ–¹èƒ½å¤Ÿé€šè¿‡æ¥å£æŸ¥è¯¢ä¸šåŠ¡å¤„ç†ç»“æœ</li>\n<li>å‘é€æ–¹æ¶ˆæ¯é˜Ÿåˆ—ACKæœºåˆ¶ï¼Œæ¶ˆæ¯é˜Ÿåˆ—æŒ‰ç…§é—´éš”1minã€5minã€10minã€30minã€1hã€2hã€5hã€10hçš„æ–¹å¼ï¼Œé€æ­¥æ‹‰å¤§é€šçŸ¥é—´éš” ï¼Œç›´åˆ°è¾¾åˆ°é€šçŸ¥è¦æ±‚çš„æ—¶é—´çª—å£ä¸Šé™ã€‚ä¹‹åä¸å†é€šçŸ¥</li>\n<li>æœ€å¤§åŠªåŠ›é€šçŸ¥é€‚ç”¨äºä¸šåŠ¡é€šçŸ¥ç±»å‹ï¼Œä¾‹å¦‚å¾®ä¿¡äº¤æ˜“çš„ç»“æœï¼Œå°±æ˜¯é€šè¿‡æœ€å¤§åŠªåŠ›é€šçŸ¥æ–¹å¼é€šçŸ¥å„ä¸ªå•†æˆ·ï¼Œæ—¢æœ‰å›è°ƒé€šçŸ¥ï¼Œä¹Ÿæœ‰äº¤æ˜“æŸ¥è¯¢æ¥å£</li>\n<li>ä»¥æ”¯ä»˜é€šçŸ¥ä¸ºä¾‹ï¼Œä¸šåŠ¡ç³»ç»Ÿè°ƒç”¨æ”¯ä»˜å¹³å°è¿›è¡Œæ”¯ä»˜ï¼Œæ”¯ä»˜å¹³å°è¿›è¡Œæ”¯ä»˜ï¼Œè¿›è¡Œæ“ä½œæ”¯ä»˜ä¹‹åæ”¯ä»˜å¹³å°ä¼šå»åŒæ­¥é€šçŸ¥ä¸šåŠ¡ç³»ç»Ÿæ”¯ä»˜æ“ä½œæ˜¯å¦æˆåŠŸï¼Œå¦‚æœä¸æˆåŠŸï¼Œä¼šä¸€ç›´å¼‚æ­¥é‡è¯•ï¼Œä½†æ˜¯ä¼šæœ‰ä¸€ä¸ªæœ€å¤§é€šçŸ¥æ¬¡æ•°ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªæ¬¡æ•°åè¿˜æ˜¯é€šçŸ¥å¤±è´¥ï¼Œå°±ä¸å†é€šçŸ¥ï¼Œä¸šåŠ¡ç³»ç»Ÿè‡ªè¡Œè°ƒç”¨æ”¯ä»˜å¹³å°æä¾›ä¸€ä¸ªæŸ¥è¯¢æ¥å£ï¼Œä¾›ä¸šåŠ¡ç³»ç»Ÿè¿›è¡ŒæŸ¥è¯¢æ”¯ä»˜æ“ä½œæ˜¯å¦æˆåŠŸã€‚</li>\n</ul>\n</li>\n<li>\n<p>æœ¬åœ°æ¶ˆæ¯è¡¨å’Œäº‹åŠ¡æ¶ˆæ¯éƒ½å±äºå¯é æ¶ˆæ¯ä¸æœ€å¤§åŠªåŠ›é€šçŸ¥åŒºåˆ«?</p>\n<ul>\n<li>å¯é æ¶ˆæ¯ä¸€è‡´æ€§ï¼Œå‘èµ·é€šçŸ¥æ–¹éœ€è¦ä¿è¯å°†æ¶ˆæ¯å‘å‡ºå»ï¼Œå¹¶ä¸”å°†æ¶ˆæ¯å‘åˆ°æ¥æ”¶é€šçŸ¥æ–¹ï¼Œæ¶ˆæ¯çš„å¯é æ€§å…³é”®ç”±å‘èµ·é€šçŸ¥æ–¹æ¥ä¿è¯ã€‚</li>\n<li>æœ€å¤§åŠªåŠ›é€šçŸ¥ï¼Œå‘èµ·é€šçŸ¥æ–¹å°½æœ€å¤§çš„åŠªåŠ›å°†ä¸šåŠ¡å¤„ç†ç»“æœé€šçŸ¥ä¸ºæ¥æ”¶é€šçŸ¥æ–¹ï¼Œä½†æ˜¯å¯èƒ½æ¶ˆæ¯æ¥æ”¶ä¸åˆ°ï¼Œæ­¤æ—¶éœ€è¦æ¥æ”¶é€šçŸ¥æ–¹ä¸»åŠ¨è°ƒç”¨å‘èµ·é€šçŸ¥æ–¹çš„æ¥å£æŸ¥è¯¢ä¸šåŠ¡å¤„ç†ç»“æœï¼Œé€šçŸ¥çš„å¯é æ€§å…³é”®åœ¨æ¥æ”¶é€šçŸ¥æ–¹ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>11. seataå®ç°</h1>\n<ul>\n<li>\n<p>Seataæ˜¯ä»ä¸šåŠ¡æ— ä¾µå…¥çš„ä¸¤é˜¶æ®µæäº¤ï¼ˆå…¨å±€äº‹åŠ¡ï¼‰ç€æ‰‹ï¼Œåœ¨ä¼ ç»Ÿçš„ä¸¤é˜¶æ®µä¸Šè¿›è¡Œæ”¹è¿›ï¼ŒæŠŠä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ç†è§£æˆä¸€ä¸ªåŒ…å«äº†è‹¥å¹²åˆ†æ”¯äº‹åŠ¡çš„å…¨å±€äº‹åŠ¡ã€‚è€Œå…¨å±€äº‹åŠ¡çš„èŒè´£æ˜¯åè°ƒå®ƒç®¡ç†çš„åˆ†æ”¯äº‹åŠ¡è¾¾æˆä¸€è‡´æ€§ï¼Œè¦ä¹ˆä¸€èµ·æˆåŠŸæäº¤ï¼Œè¦ä¹ˆä¸€èµ·å¤±è´¥å›æ»š</p>\n</li>\n<li>\n<p>Seataä¸­å­˜åœ¨è¿™ä¹ˆå‡ ç§é‡è¦è§’è‰²ï¼š</p>\n<ul>\n<li>TCï¼ˆTransaction Coordinatorï¼‰ï¼šäº‹åŠ¡åè°ƒè€…ã€‚ç®¡ç†å…¨å±€çš„åˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œç”¨äºå…¨å±€æ€§äº‹åŠ¡çš„æäº¤å’Œå›æ»šã€‚</li>\n<li>TMï¼ˆTransaction Managerï¼‰ï¼šäº‹åŠ¡ç®¡ç†è€…ã€‚ç”¨äºå¼€å¯ã€æäº¤æˆ–å›æ»šäº‹åŠ¡ã€‚</li>\n<li>RMï¼ˆResource Managerï¼‰ï¼šèµ„æºç®¡ç†å™¨ã€‚ç”¨äºåˆ†æ”¯äº‹åŠ¡ä¸Šçš„èµ„æºç®¡ç†ï¼Œå‘TCæ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œä¸ŠæŠ¥åˆ†æ”¯äº‹åŠ¡çš„çŠ¶æ€ï¼Œæ¥æ”¶TCçš„å‘½ä»¤æ¥æäº¤æˆ–è€…å›æ»šåˆ†æ”¯äº‹åŠ¡ã€‚</li>\n</ul>\n</li>\n<li>\n<p>Seataæ•´ä½“æ‰§è¡Œæµç¨‹</p>\n<ul>\n<li>æœåŠ¡Aä¸­çš„TMå‘TCç”³è¯·å¼€å¯ä¸€ä¸ªå…¨å±€äº‹åŠ¡ï¼ŒTCå°±ä¼šåˆ›å»ºä¸€ä¸ªå…¨å±€äº‹åŠ¡å¹¶è¿”å›ä¸€ä¸ªå”¯ä¸€çš„XID</li>\n<li>æœåŠ¡Aä¸­çš„RMå‘TCæ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œç„¶åå°†è¿™ä¸ªåˆ†æ”¯äº‹åŠ¡çº³å…¥ XID å¯¹åº”çš„å…¨å±€äº‹åŠ¡ç®¡è¾–ä¸­</li>\n<li>æœåŠ¡Aå¼€å§‹æ‰§è¡Œåˆ†æ”¯äº‹åŠ¡</li>\n<li>æœåŠ¡Aå¼€å§‹è¿œç¨‹è°ƒç”¨BæœåŠ¡ï¼Œæ­¤æ—¶ XID ä¼šæ ¹æ®è°ƒç”¨é“¾ä¼ æ’­</li>\n<li>æœåŠ¡Bä¸­çš„ RM ä¹Ÿå‘ TC æ³¨å†Œåˆ†æ”¯äº‹åŠ¡ï¼Œç„¶åå°†è¿™ä¸ªåˆ†æ”¯äº‹åŠ¡çº³å…¥ XID å¯¹åº”çš„å…¨å±€äº‹åŠ¡ç®¡è¾–ä¸­</li>\n<li>æœåŠ¡Bå¼€å§‹æ‰§è¡Œåˆ†æ”¯äº‹åŠ¡</li>\n<li>å…¨å±€äº‹åŠ¡è°ƒç”¨å¤„ç†ç»“æŸåï¼ŒTM ä¼šæ ¹æ®æœ‰è¯¯å¼‚å¸¸æƒ…å†µï¼Œå‘ TC å‘èµ·å…¨å±€äº‹åŠ¡çš„æäº¤æˆ–å›æ»š</li>\n<li>TC åè°ƒå…¶ç®¡è¾–ä¹‹ä¸‹çš„æ‰€æœ‰åˆ†æ”¯äº‹åŠ¡ï¼Œå†³å®šæ˜¯æäº¤è¿˜æ˜¯å›æ»š<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/60852f1b024765c3a8189.png\" alt=\"seata.png\"></li>\n</ul>\n</li>\n<li>\n<p>ä½ ä»¬å…¬å¸æ˜¯å¦‚ä½•å¤„ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„ï¼Ÿ</p>\n<ul>\n<li>æˆ‘ä»¬æŸæŸç‰¹åˆ«ä¸¥æ ¼çš„åœºæ™¯ï¼Œç”¨çš„æ˜¯ TCC æ¥ä¿è¯å¼ºä¸€è‡´æ€§ã€‚</li>\n<li>å…¶ä»–åœºåŸºäºé˜¿é‡Œçš„ RocketMQ æ¥å®ç°äº†åˆ†å¸ƒå¼äº‹åŠ¡ã€‚å¦‚æœæ˜¯ä¸€èˆ¬çš„åˆ†å¸ƒå¼äº‹åŠ¡åœºæ™¯ï¼Œè®¢å•æ’å…¥ä¹‹åè¦è°ƒç”¨åº“å­˜æœåŠ¡æ›´æ–°åº“å­˜ï¼Œåº“å­˜æ•°æ®æ²¡æœ‰èµ„é‡‘é‚£ä¹ˆçš„æ•æ„Ÿï¼Œå¯ä»¥ç”¨å¯é æ¶ˆæ¯æœ€ç»ˆä¸€è‡´æ€§æ–¹æ¡ˆã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>12. åˆ†å¸ƒå¼é™æµç®—æ³•</h1>\n<h2>12.1. è®¡æ•°å™¨</h2>\n<ul>\n<li>æ¯”å¦‚æˆ‘ä»¬è¦é™åˆ¶1sèƒ½å¤Ÿé€šè¿‡çš„è¯·æ±‚æ•°ï¼Œå®ç°çš„æ€è·¯å°±æ˜¯ä»ç¬¬ä¸€ä¸ªè¯·æ±‚è¿›æ¥å¼€å§‹è®¡æ—¶ï¼Œåœ¨æ¥ä¸‹æ¥çš„1så†…ï¼Œæ¯ä¸ªè¯·æ±‚è¿›æ¥è¯·æ±‚æ•°å°±+1ï¼Œè¶…è¿‡æœ€å¤§è¯·æ±‚æ•°çš„è¯·æ±‚ä¼šè¢«æ‹’ç»ï¼Œç­‰åˆ°1sç»“æŸåè®¡æ•°æ¸…é›¶ï¼Œé‡æ–°å¼€å§‹è®¡æ•°ã€‚å¼Šç«¯ï¼šæ¯”å¦‚å‰10mså·²ç»é€šè¿‡äº†æœ€å¤§çš„è¯·æ±‚æ•°ï¼Œé‚£ä¹ˆåé¢çš„990msçš„è¯·æ±‚åªèƒ½æ‹’ç»ï¼Œè¿™ç§ç°è±¡å«åšâ€œçªåˆºç°è±¡â€</li>\n</ul>\n<h2>12.2. æ¼æ¡¶ç®—æ³•</h2>\n<ul>\n<li>æ¡¶åº•å‡ºæ°´çš„é€Ÿåº¦æ’å®šï¼Œè¿›æ°´çš„é€Ÿåº¦å¯èƒ½å¿«æ…¢ä¸ä¸€ï¼Œä½†æ˜¯å½“è¿›æ°´é‡å¤§äºå‡ºæ°´é‡çš„æ—¶å€™ï¼Œæ°´ä¼šè¢«è£…åœ¨æ¡¶é‡Œï¼Œä¸ä¼šç›´æ¥è¢«ä¸¢å¼ƒï¼›ä½†æ˜¯æ¡¶ä¹Ÿæ˜¯æœ‰å®¹é‡é™åˆ¶çš„ï¼Œå½“æ¡¶è£…æ»¡æ°´åæº¢å‡ºçš„éƒ¨åˆ†è¿˜æ˜¯ä¼šè¢«ä¸¢å¼ƒçš„ã€‚å¯ä»¥å‡†å¤‡ä¸€ä¸ªé˜Ÿåˆ—æ¥ä¿å­˜æš‚æ—¶å¤„ç†ä¸äº†çš„è¯·æ±‚ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªçº¿ç¨‹æ± å®šæœŸä»é˜Ÿåˆ—ä¸­è·å–è¯·æ±‚æ¥æ‰§è¡Œ</li>\n</ul>\n<h2>12.3. ä»¤ç‰Œæ¡¶ç®—æ³•</h2>\n<ul>\n<li>ä»¤ç‰Œæ¡¶å°±æ˜¯ç”Ÿäº§è®¿é—®ä»¤ç‰Œçš„ä¸€ä¸ªåœ°æ–¹ï¼Œç”Ÿäº§çš„é€Ÿåº¦æ’å®šï¼Œç”¨æˆ·è®¿é—®çš„æ—¶å€™å½“æ¡¶ä¸­æœ‰ä»¤ç‰Œæ—¶å°±å¯ä»¥è®¿é—®ï¼Œå¦åˆ™å°†è§¦å‘é™æµã€‚Guava RateLimiteræ˜¯ä¸€ä¸ªè°·æ­Œæä¾›çš„é™æµï¼Œå…¶åŸºäºä»¤ç‰Œæ¡¶ç®—æ³•ï¼Œæ¯”è¾ƒé€‚ç”¨äºå•å®ä¾‹çš„ç³»ç»Ÿ</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/93416270ed2d740c33a9d.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "dubbo",
      "url": "https://javaguide.cn/interview/dubbo.html",
      "id": "https://javaguide.cn/interview/dubbo.html",
      "summary": "Dubbo",
      "content_html": "<p>Dubbo</p>\n<!-- more -->\n<h1>1. Dubboç»„ä»¶</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/74cce94dc95c242560901.png\" alt=\"dubboarchitecture.png\" tabindex=\"0\"><figcaption>dubboarchitecture.png</figcaption></figure>\n<ul>\n<li>Provider: æš´éœ²æœåŠ¡çš„æœåŠ¡æä¾›æ–¹ã€‚åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±æä¾›çš„æœåŠ¡ã€‚</li>\n<li>Consumer: è°ƒç”¨è¿œç¨‹æœåŠ¡çš„æœåŠ¡æ¶ˆè´¹æ–¹ã€‚åœ¨å¯åŠ¨æ—¶ï¼Œå‘æ³¨å†Œä¸­å¿ƒè®¢é˜…è‡ªå·±æ‰€éœ€çš„æœåŠ¡ã€‚</li>\n<li>Registry: æœåŠ¡æ³¨å†Œä¸å‘ç°çš„æ³¨å†Œä¸­å¿ƒã€‚è¿”å›æœåŠ¡æä¾›è€…åœ°å€åˆ—è¡¨ç»™æ¶ˆè´¹è€…ï¼Œå¦‚æœæœ‰å˜æ›´ï¼Œæ³¨å†Œä¸­å¿ƒå°†åŸºäºé•¿è¿æ¥æ¨é€å˜æ›´æ•°æ®ç»™æ¶ˆè´¹è€…ã€‚æœåŠ¡æ¶ˆè´¹è€…ä»æä¾›è€…åœ°å€åˆ—è¡¨ä¸­ï¼ŒåŸºäºè½¯è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Œé€‰ä¸€å°æä¾›è€…è¿›è¡Œè°ƒç”¨ï¼Œå¦‚æœè°ƒç”¨å¤±è´¥ï¼Œå†é€‰å¦ä¸€å°è°ƒç”¨ã€‚</li>\n<li>Monitor: ç»Ÿè®¡æœåŠ¡çš„è°ƒç”¨æ¬¡è°ƒå’Œè°ƒç”¨æ—¶é—´çš„ç›‘æ§ä¸­å¿ƒã€‚æœåŠ¡æ¶ˆè´¹è€…å’Œæä¾›è€…ï¼Œåœ¨å†…å­˜ä¸­ç´¯è®¡è°ƒç”¨æ¬¡æ•°å’Œè°ƒç”¨æ—¶é—´ï¼Œå®šæ—¶æ¯åˆ†é’Ÿå‘é€ä¸€æ¬¡ç»Ÿè®¡æ•°æ®åˆ°ç›‘æ§ä¸­å¿ƒã€‚</li>\n<li>Container: æœåŠ¡è¿è¡Œå®¹å™¨ã€‚è´Ÿè´£å¯åŠ¨ï¼ŒåŠ è½½ï¼Œè¿è¡ŒæœåŠ¡æä¾›è€…ã€‚</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/74cce94dc95c242560901.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "é¢è¯•",
      "url": "https://javaguide.cn/interview/interview.html",
      "id": "https://javaguide.cn/interview/interview.html",
      "summary": "è‡ªæˆ‘ä»‹ç» é¢è¯•å®˜æ—©ä¸Šå¥½ï¼Œæˆ‘æ˜¯xxxï¼Œæ¥è‡ªå¹¿ä¸œæ¸…è¿œï¼Œ2018å¹´ä»å¹¿ä¸œè¯ç§‘å¤§å­¦åˆ¶è¯å·¥ç¨‹ä¸“ä¸šæ¯•ä¸šï¼Œç›®å‰æœ‰5å¹´javaå¼€å‘ç»éªŒï¼Œåšè¿‡ä¼ ç»ŸåŒ»ç–—é¡¹ç›®å’Œäº’è”ç½‘ç¤¾äº¤é¡¹ç›®ï¼Œåœ¨é¡¹ç›®é‡Œé¢ä½¿ç”¨è¿‡springbootã€mybatisæ¡†æ¶ã€redisåˆ†å¸ƒå¼ç¼“å­˜ç»„ä»¶ï¼Œrabbitmqæ¶ˆæ¯é˜Ÿåˆ—ï¼Œmysqlæ•°æ®åº“ç­‰ï¼Œåœ¨ä¸Šä¸€ä»½å·¥ä½œä¸­è´Ÿè´£æ ¸å¿ƒæ¨¡å—å¼€å‘ï¼Œå‚ä¸è¿‡éœ€æ±‚è¯„å®¡å’Œæ•°æ®åº“è®¾è®¡ï¼Œæœ‰åœ¨lin...",
      "content_html": "<!-- TOC -->\n<h1>è‡ªæˆ‘ä»‹ç»</h1>\n<ul>\n<li>\n<p>é¢è¯•å®˜æ—©ä¸Šå¥½ï¼Œæˆ‘æ˜¯xxxï¼Œæ¥è‡ªå¹¿ä¸œæ¸…è¿œï¼Œ2018å¹´ä»å¹¿ä¸œè¯ç§‘å¤§å­¦åˆ¶è¯å·¥ç¨‹ä¸“ä¸šæ¯•ä¸šï¼Œç›®å‰æœ‰5å¹´javaå¼€å‘ç»éªŒï¼Œåšè¿‡ä¼ ç»ŸåŒ»ç–—é¡¹ç›®å’Œäº’è”ç½‘ç¤¾äº¤é¡¹ç›®ï¼Œåœ¨é¡¹ç›®é‡Œé¢ä½¿ç”¨è¿‡springbootã€mybatisæ¡†æ¶ã€redisåˆ†å¸ƒå¼ç¼“å­˜ç»„ä»¶ï¼Œrabbitmqæ¶ˆæ¯é˜Ÿåˆ—ï¼Œmysqlæ•°æ®åº“ç­‰ï¼Œåœ¨ä¸Šä¸€ä»½å·¥ä½œä¸­è´Ÿè´£æ ¸å¿ƒæ¨¡å—å¼€å‘ï¼Œå‚ä¸è¿‡éœ€æ±‚è¯„å®¡å’Œæ•°æ®åº“è®¾è®¡ï¼Œæœ‰åœ¨linuxä¸Šæ’æŸ¥çº¿ä¸Šé—®é¢˜çš„ç»éªŒã€‚å¸Œæœ›èƒ½åŠ å…¥è´µå…¬å¸æ‹…ä»»javaå¼€å‘å·¥ç¨‹å¸ˆï¼Œè°¢è°¢</p>\n</li>\n<li>\n<p>Good morning, interviewer, My name is xxx,I come from Qingyuan,a city in Guangdong Province. I was graduated from Guangdong Pharmaceutical University in 2018, majoring in pharmaceutical engineering. l have been working as a java development engineer for 5 years, and have done traditional medical projects and Internet social projects, in which I have used springboot, mybatis framework and redis distributed cache component. rabbitmq message queue, mysql database, etc. In my last job, I was responsible for core module development, participated in requirement review and database design, and had experience in troubleshooting online problems on linux. I hope I can make a good performance today. Thatâ€™s  all. Thank you for giving me the chance.</p>\n</li>\n<li>\n<p>é¢è¯•å®˜æ—©ä¸Šå¥½ï¼Œæˆ‘æ˜¯xxxï¼Œå¹¿ä¸œæ¸…è¿œäººï¼Œ18å¹´å¹¿ä¸œè¯ç§‘å¤§å­¦æ¯•ä¸šï¼Œåˆ¶è¯å·¥ç¨‹ä¸“ä¸šï¼Œç›®å‰ä½åœ¨å¤©æ²³æ¢…èŠ±å›­ï¼Œæ˜¯ä¸€ä¸ªiäººï¼Œå¹³æ—¶å–œæ¬¢çœ‹ä¹¦è·‘æ­¥ï¼Œä¸é™Œç”Ÿäººç†Ÿæ‚‰åå°±ä¼šå˜æˆeäººï¼Œä¹è§‚å¼€æœ—</p>\n</li>\n</ul>\n<h1>åœºæ™¯è®¾è®¡</h1>\n<ul>\n<li>å…ˆå®Œæˆå†å®Œç¾ï¼šæˆ‘æƒ³äº†ä¸€ä¸‹å¯ä»¥è¿™ä¹ˆåšï¼Œæ—¶é—´æœ‰é™ï¼Œå¯èƒ½æœ‰äº›ä¸åˆç†åœ°æ–¹ï¼Œç„¶åè¯´æ–¹æ¡ˆ</li>\n<li>æƒ³åˆ°å¤šå°‘è¯´å¤šå°‘ï¼Œéƒ¨åˆ†ä¹Ÿæ²¡å…³ç³»</li>\n<li>ä¸ä¼šå°±å¦è¯šè¯´è¿˜æœ‰xxéƒ¨åˆ†ï¼Œå› ä¸ºxxåœ°æ–¹æ²¡æœ‰æƒ³åˆ°ï¼Œå¯ä¸å¯ä»¥ç»™ç‚¹æç¤º</li>\n<li>ä¸çŸ¥é“é€‰ä»€ä¹ˆæ–¹æ¡ˆå°±æå‡ºé€‰æ‹©å›°éš¾åŸå› </li>\n</ul>\n<h1>é‡åˆ°ä¸æ‡‚çš„åœ°æ–¹</h1>\n<ul>\n<li>æ²¡å¬æ¸…ï¼Œä¸å¥½æ„æ€ä½ æ˜¯æŒ‡xxxå†…å®¹è¿˜æ˜¯xxxå†…å®¹ï¼ŒæŠŠèŒƒå›´ç¼©å°ï¼Œä¸ä¼šå°±ä¸è¦è¯´</li>\n<li>ä¸æ‡‚ï¼Œè¿™ä¸ªæˆ‘ä¸å¤§äº†è§£ï¼Œæˆ‘çŒœæ˜¯è¿™æ ·çš„æˆ–è€…æˆ‘æ²¡æ€ä¹ˆäº†è§£ï¼Œä½†æˆ‘çŸ¥é“xxxxå’Œå®ƒå·®ä¸å¤šï¼Œä¹Ÿèƒ½åšåˆ°zzzç›®çš„</li>\n</ul>\n<h1>é¡¹ç›®</h1>\n<ul>\n<li>é¡¹ç›®éš¾ç‚¹æˆ–è€…äº®ç‚¹ï¼Ÿ</li>\n<li>é¡¹ç›®ä¸ºä»€ä¹ˆç”¨ï¼Ÿè€Œä¸ç”¨ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Ÿ</li>\n<li>é¡¹ç›®æè¿°\n<ul>\n<li>1.é¡¹ç›®çš„èƒŒæ™¯(è¿™ä¸ªé¡¹ç›®è§£å†³ä»€ä¹ˆé—®é¢˜)ï¼Œ1åˆ†é’Ÿä»¥å†…è¦æè¿°å®Œ</li>\n<li>2.é¡¹ç›®åŒ…å«çš„åŠŸèƒ½/æ¨¡å—ï¼Œç®€å•è¯´æ˜æ¯ä¸ªåŠŸèƒ½çš„ä½œç”¨</li>\n<li>3.ä½ å‚ä¸å¹¶è´Ÿè´£çš„æ¨ªå—</li>\n<li>4.é¡¹ç›®é‡‡ç”¨çš„æŠ€æœ¯æ¶æ„</li>\n<li>5.é¡¹ç›®ä¸­çš„éš¾ç‚¹ã€äº®ç‚¹å’Œä¸ªäººçš„æˆé•¿\n<ul>\n<li>1.ä½“ç°ä½ è§£å†³é—®é¢˜çš„èƒ½åŠ›</li>\n<li>2.ä½“ç°ä½ çš„å­¦ä¹ èƒ½åŠ›</li>\n<li>3.ä½“ç°ä½ çš„æ¶æ„æ€ç»´</li>\n<li>4.ä½“ç°ä½ çš„å›¢é˜Ÿåä½œèƒ½åŠ›</li>\n<li>5.ä½“ç°ä½ çš„ç®¡ç†èƒ½å¶</li>\n<li>6.ä½“ç°ä½ çš„æŠ€æœ¯èƒ½åŠ›</li>\n<li>ä¹Ÿå°±æ˜¯åªè¦èƒ½å¤Ÿä½“ç°ä¸Šè¿°è¿™äº›èƒ½åŠ›çš„ï¼Œéƒ½å¯ä»¥å»æ€»ç»“å‡ºæ¥ï¼Œä¸ä¸€å®šæ˜¯é«˜å¹¶å‘/é«˜æ€§èƒ½çš„ä¸€äº›äº‹æƒ…æ¯”å¦‚ç‹¬ç«‹ä»0åˆ°1æ­å»ºå¾®æœåŠ¡æ¶æ„ã€ç¬¬ä¸€æ¬¡å‚ä¸çº¿ä¸Šé—®é¢˜çš„è¯Šæ–­å’Œè§£å†³</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>ä½ æœ‰æ²¡æœ‰ä»€ä¹ˆæƒ³é—®çš„ï¼Ÿ</h1>\n<ul>\n<li>å¦‚æœèŒä½æè¿°æ²¡æœ‰å†™éƒ¨é—¨æˆ–è€…ä¸šåŠ¡ï¼Œå¯ä»¥é—®å…·ä½“åšä»€ä¹ˆä¸šåŠ¡ï¼Œå›¢é˜Ÿè§„æ¨¡å¤šå°‘</li>\n<li>å°±åˆšæ‰çš„é¢è¯•ï¼Œä½ è§‰å¾—æˆ‘è¿˜æœ‰å“ªäº›åœ°æ–¹éœ€è¦åŠ å¼ºçš„åœ°æ–¹</li>\n<li>æ‚¨å½“åˆé€‰æ‹©è¿™å®¶å…¬å¸çš„åŸå› æ˜¯ä»€ä¹ˆå‘¢?</li>\n<li>å›¢é˜Ÿæ°›å›´å¦‚ä½•ï¼Œå¹³æ—¶å‡ ç‚¹ä¸‹ç­</li>\n</ul>\n<h1>é¢è¯•å¤ç›˜</h1>\n<ul>\n<li>é‡åˆ°ä¸æ‡‚æˆ–è€…å›ç­”ä¸å¥½çš„é—®é¢˜ï¼Œé¢è¯•ç»“æŸåè¦å¼„æ‡‚</li>\n</ul>\n<h1>hré¢</h1>\n<ul>\n<li>\n<p>äººç”Ÿã€å¯¹æ–¹å…¬å¸æƒ…å†µå’Œè°ˆè–ªèµ„ï¼Œå¡æ¶¨å¹…30%</p>\n</li>\n<li>\n<p>å‹å·¥èµ„ï¼Œå¯ä»¥è¯´æœ‰ä¸€ä¸ªofferï¼Œå¯¹æ–¹ç»™äº†xxxï¼Œä½†è‡ªå·±æ›´å¸Œæœ›æ¥è´µå…¬å¸+ç†ç”±ï¼Œå¸Œæœ›è–ªèµ„å¯ä»¥ç»™åˆ°</p>\n</li>\n<li>\n<p>è°ˆè–ªèµ„ï¼š</p>\n<ul>\n<li>1è–ªèµ„ç»“æ„&amp;å‘æ”¾æ—¶é—´ã€‚\n<ul>\n<li>è–ªèµ„ç»“æ„ä¸€èˆ¬åŒ…æ‹¬æ— è´£åº•è–ª+ç»©æ•ˆ+ææˆ+å¥–é‡‘+å„ç§è¡¥è´´+å¹´ç»ˆå¥–+å…¶ä»–ç¦åˆ©</li>\n<li>å‘æ”¾æ—¶é—´ï¼šæœ€å¥½15å·å‰</li>\n<li>å¹´ç»ˆå¥–13ã€14è–ª</li>\n<li>ç¨å‰ç¨å</li>\n<li>è°ƒè–ªåˆ¶åº¦ï¼Œä¸€å¹´ä¸€èˆ¬10%</li>\n</ul>\n</li>\n<li>2åŠ³åŠ¨åˆåŒ&amp;è¯•ç”¨æœŸï¼š\n<ul>\n<li>æ³¨æ„:åŠ³åŠ¨æ³•è§„å®šåŠ³åŠ¨åˆåŒæœŸé™åœ¨6ä¸ªæœˆåˆ°ä¸€å¹´çš„ï¼Œè¯•ç”¨æœŸæœ€é•¿ä¸è¶…è¿‡30å¤©;</li>\n<li>åŠ³åŠ¨åˆåŒæœŸé™åœ¨ä¸€å¹´ä»¥ä¸Šä¸‰å¹´ä»¥ä¸‹çš„ï¼Œè¯•ç”¨æœŸæœ€é•¿ä¸å¾—è¶…è¿‡ 60å¤©;</li>\n<li>åŠ³åŠ¨åˆåŒæœŸé™åœ¨ä¸‰å¹´ä»¥ä¸Šçš„ï¼Œè¯•ç”¨æœŸä¸å¾—è¶…è¿‡6ä¸ªæœˆã€‚è¯•ç”¨æœŸæœ€é•¿ä¸å¾—è¶…è¿‡å…­ä¸ªæœˆï¼Œ</li>\n<li>è¯•ç”¨æœŸå·¥èµ„æŠ˜æ‰£ä¸å¾—ä½äºæ­£å¼å·¥èµ„çš„ 80%(ä¸€èˆ¬é¢è¯•çš„æ—¶å€™é—®å¥½)</li>\n</ul>\n</li>\n<li>3ç¦åˆ©å¾…é‡ ç¦åˆ©å¾…é‡ä¸€èˆ¬åŒ…æ‹¬æˆ¿è¡¥ã€è¯è¡¥ã€äº¤é€šè¡¥è´´ã€é¤è¡¥ç­‰ç¦åˆ©</li>\n<li>4äº”é™©ä¸€é‡‘ï¼š\n<ul>\n<li>æ³¨æ„:äº”é™©ä¸€é‡‘åŒ…æ‹¬:å…»è€ä¿é™©+åŒ»ç–—ä¿é™©+å¤±ä¸šä¿é™©+å·¥ä¼¤ä¿é™©+ç”Ÿè‚²ä¿é™©+ä½æˆ¿å…¬ç§¯é‡‘ï¼Œç¼´çº³åŸºæ•°å’Œæ¯”ä¾‹</li>\n<li>å…­é™©ä¸€é‡‘ï¼šåœ¨äº”é™©ä¸€é‡‘çš„åŸºç¡€ä¸Šå¢åŠ ã€æ”¶èµ·.ä¸šä¿é™©ï¼Œå³å¤§ç—…ä¿é™©ï¼Œæ˜¯ä¸€ç§è¡¥å……åŒ»ç–—ä¿ï¼Œç¼´çº³åŸºæ•°å’Œæ¯”ä¾‹</li>\n</ul>\n</li>\n<li>å·¥ä½œæ—¶é—´ï¼ŒåŒä¼‘å•ä¼‘</li>\n<li>å¹´å‡ï¼šå·²æ»¡1å¹´ä¸æ»¡10å¹´çš„ï¼Œå¹´ä¼‘å‡5å¤©;å·²æ»¡10å¹´ä¸æ»¡20å¹´çš„ï¼Œå¹´ä¼‘å‡10å¤©;å·²æ»¡20å¹´çš„ï¼Œå¹´ä¼‘å‡15å¤©;å›½å®¶æ³•å®šä¼‘å‡æ—¥ã€ä¼‘æ¯æ—¥ä¸è®¡å…¥å¹´ä¼‘å‡çš„å‡æœŸã€‚å¹´å‡åº”äº«ä¸æ­£å¸¸å·¥ä½œæœŸé—´ç›¸åŒçš„å·¥èµ„æ”¶å…¥</li>\n<li>å¹´ç»ˆ</li>\n<li>åŠ ç­è´¹</li>\n<li>æ™‹å‡æ¸ é“ï¼Œå‡èŒ</li>\n<li>æ‰“å¡</li>\n<li>è¡¥è´´</li>\n</ul>\n</li>\n<li>\n<p>å·¥ä½œå†…å®¹</p>\n</li>\n<li>\n<p>ä¼˜ç‚¹</p>\n<ul>\n<li>å­¦ä¹ æ–¹é¢:å­¦ä¹ èƒ½åŠ›å¼ºï¼Œèƒ½å¤Ÿè¾ƒå¿«çš„æ”»å…‹ä¸€äº›æ¯”è¾ƒéš¾çš„ä»»åŠ¡</li>\n<li>ç”Ÿæ´»æ–¹é¢:ç§¯æä¹è§‚:è¡ŒåŠ¨åŠ›å¼º;å–œæ¬¢å¤ç›˜ï¼Œå¯¹è‡ªå·±æœ‰é•¿æœŸè§„åˆ’å’ŒçŸ­æœŸè§„åˆ’:å®šå¥½ç›®æ ‡å°±ä¼šåšæŒä¸æ‡ˆçš„èµ°ä¸‹å»ï¼Œæœ‰éŸ§æ€§;æ¯”è¾ƒæ´»æ³¼å¤–å‘ä¸€äº›ï¼Œå–œæ¬¢ä¸äººäº¤é™…ï¼Œä¹Ÿæœ‰å¾ˆå¤šå¥½æœ‹å‹ã€‚</li>\n</ul>\n</li>\n<li>\n<p>ç¼ºç‚¹(ä»å¦ä¸€ä¸ªè§’åº¦çœ‹å°±æ˜¯ä¼˜ç‚¹ï¼Œåˆ‡è®°ä¸èƒ½è¯´çº¯ç¼ºç‚¹)</p>\n<ul>\n<li>æœ‰ç‚¹å¼ºè¿«ç—‡ï¼Œä¼šå¯¹ä»»åŠ¡çš„ç»†èŠ‚æ ¸å¯¹å¤šéï¼Œæ¯”å¦‚å‘é€é‡è¦çš„é‚®ä»¶ï¼Œå°±ä¼šæŠŠæ”¶ä¿¡äººè¿˜æœ‰é‚®ä»¶å†…å®¹æ£€æŸ¥ä¸¤éä½†å…¶ä»–äººå¯èƒ½ä¸ä¼šæ£€æŸ¥ï¼Œæˆ‘è¿™æ ·å­å°±æœ‰ç‚¹æµªè´¹æ—¶é—´äº†ã€‚</li>\n<li>æœ‰ç‚¹é’»ç‰›è§’å°–ï¼Œå°¤å…¶åœ¨å­¦ä¹ æ–°çš„çŸ¥è¯†æ—¶ï¼Œæˆ‘æœ‰ä¸ªç‚¹ä¸æ‡‚å°±ä¼šå»æ‰¾èµ„æ–™ï¼Œå¿…é¡»æŠŠä»–ææ‡‚ï¼Œæˆ–è€…è‡³å°‘ç†è§£ä¸ªå¤§æ¦‚æ‰ä¼šæ”¾æ‰‹ï¼Œè¿™ä¸ªè¿‡ç¨‹å¾ˆèŠ±æ—¶é—´ï¼Œä½†æˆ‘ä¸è¿™æ ·å­åšçš„è¯å°±éš¾å—ã€‚ä¹‹åæˆ‘çš„æœ‹å‹ç»™æˆ‘è¯´ä»–ä»¬çš„æ–¹æ³•å°±æ˜¯æŠŠä¸æ‡‚çš„å…ˆæ”¾ç€ï¼Œç­‰å­¦äº†åˆ«çš„çŸ¥è¯†ï¼Œå†è¿”å›æ¥çœ‹è¿™ä¸ªçŸ¥è¯†ç‚¹å°±è§¦ç±»æ—é€šäº†ï¼Œæˆ‘ç›®å‰ä¹Ÿåœ¨æ…¢æ…¢åœ°å¯¹æƒ…å†µè¿›è¡Œåˆ†ç±»è®¨è®ºï¼Œæœ‰çš„ç”¨æˆ‘ä¹‹å‰æ–¹æ³•ï¼Œæœ‰çš„ç”¨æˆ‘æœ‹å‹ç»™æˆ‘è¯´çš„æ–¹æ³•ï¼Œæ•ˆæœä¹Ÿä¸é”™ã€‚</li>\n</ul>\n</li>\n<li>\n<p>å…´è¶£çˆ±å¥½</p>\n<ul>\n<li>å–œæ¬¢çˆ¬å±±ã€å¾’æ­¥è¿™äº›æˆ·å¤–æ´»åŠ¨ã€‚ä¸ä»…å¯ä»¥äº²è¿‘å¤§è‡ªç„¶ï¼Œè€Œä¸”å¯ä»¥ä¸æ–­æŒ‘æˆ˜è‡ªå·±ä½“èƒ½çš„æé™ï¼Œæˆ‘å¾ˆå–œæ¬¢è¿™ç§çªç ´è‡ªæˆ‘å¸¦ç»™æˆ‘çš„æˆå°±æ„Ÿã€‚</li>\n<li>å–œæ¬¢è¿åŠ¨ï¼Œå°¤å…¶æ˜¯ä¸€äº›çƒç±»è¿åŠ¨ï¼Œæ¯”å¦‚ç¾½æ¯›çƒã€ä¹’ä¹“çƒï¼Œæˆ‘ä¸€èˆ¬å‘¨æœ«ä¼šå«ä¸Šå¥½æœ‹å‹ä¸€èµ·ï¼Œè¿™ç§ç«æŠ€æ´»åŠ¨ä¸ä»…å¯ä»¥å¢åŠ æœ‹å‹é—´çš„æ„Ÿæƒ…ï¼Œè€Œä¸”å¯ä»¥é‡Šæ”¾å¤§é‡å¤šå·´èƒºï¼Œç¼“è§£ä¸€å‘¨çš„å·¥ä½œå‹åŠ›;</li>\n<li>å–œæ¬¢é˜…è¯»ï¼Œåœ¨å·¥ä½œå­¦ä¹ ä¹‹ä½™ï¼Œå–œæ¬¢è¯»ä¸€äº›äººç‰©ä¼ è®°ã€æ•£æ–‡ä¹‹ç±»çš„æ–‡å­¦ä¹¦ç±ï¼Œä¹Ÿå–œæ¬¢çœ‹ä¸€äº›èƒ½æ‹“å®½è§†é‡çš„çºªå½•ç‰‡ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>å…¶ä»–é—®é¢˜</h1>\n<ul>\n<li>\n<p>ä½ æœ‰ä»€ä¹ˆç¼ºç‚¹?ç”±äºæˆ‘ä¹ æƒ¯è‡ªå­¦ï¼Œå¯¼è‡´æœ‰æ—¶å€™å¾ˆå®¹æ˜“é™·å…¥è¯¯åŒºèµ°ä¸å‡ºæ¥ã€‚é™·å…¥è¯¯åŒºçš„åŸå› ä¸€èˆ¬æ˜¯è¿™ä¸ªéƒ¨åˆ†çš„è‡ªèº«åŸºç¡€ä¸ç‰¢é ,æˆ–è€…æ˜¯å…¬å¸å†…éƒ¨çš„æ–‡æ¡£èµ„æ–™ä¸é½å…¨æˆ‘å¯èƒ½éœ€è¦èŠ±è´¹æ¯”è¾ƒå¤šçš„æ—¶é—´åœ¨è‡ªæˆ‘çº ç»“ä¸Šã€‚ä¸è¿‡æˆ‘ç›®å‰ä¹Ÿåœ¨æ”¹å–„è¿™ä¸ªé—®é¢˜ï¼Œä»¥åä¼šå¥½å¥½åˆ©ç”¨æ–°äººå¤šé—®ä¸ä¼šè¢«éª‚çš„æƒåˆ©</p>\n</li>\n<li>\n<p>èŒä¸šè§„åˆ’æ˜¯ä»€ä¹ˆï¼Ÿå¸Œæœ›èƒ½å¤Ÿåœ¨è¿™ä¸ªå²—ä½ä¸Šåšåˆ°ç‹¬å½“ä¸€é¢ï¼Œè´Ÿè´£ä¸€äº›å¤§çš„ã€è·¨ç»„çš„å¤§äº‹é¡¹ã€‚å½“ç„¶å¦‚æœä¼´éšç€èƒ½åŠ›çš„æå‡ï¼Œèƒ½å¤Ÿæœ‰å¸¦äººæˆ–è€…å¸¦å›¢é˜Ÿçš„æœºä¼šæˆ‘ä¹Ÿä¼šå»æå‡å…¶ä»–ç›¸å…³çš„æŠ€èƒ½ï¼Œæå‡è‡ªå·±çš„ç®¡ç†èƒ½åŠ›ã€‚</p>\n</li>\n<li>\n<p>å¯¹åŠ ç­æ€ä¹ˆçœ‹?åˆšè¿›å»å…¬å¸åŠ ç­å¾ˆæ­£å¸¸ï¼Œå› ä¸ºä¸€åˆ‡éƒ½ä¸ç†Ÿæ‚‰ï¼Œæˆ‘ä¼šä¸ºäº†å¿«é€Ÿä¸Šæ‰‹ä¸šåŠ¡ã€è¿…é€Ÿèå…¥å›¢é˜Ÿè€ŒåŠ ç­ã€‚éšç€å·¥ä½œç†Ÿç»ƒåº¦çš„æå‡ï¼Œå•ä½æ—¶é—´å†…çš„äº§å‡ºä¼šç›¸å¯¹æœ‰æ‰€å¢åŠ ï¼Œåœ¨äº§å‡ºç¬¦åˆé¢„æœŸçš„æƒ…å†µä¸‹ï¼Œé¢„è®¡å·¥ä½œæ—¶é—´åº”è¯¥æ˜¯æœ‰äº›ç¼©çŸ­çš„ã€‚è¿™æ—¶å€™å¦‚æœé‡åˆ°ç´§æ€¥çš„ä¸šåŠ¡éœ€æ±‚æˆ–è€…æ˜¯ä¸šåŠ¡æ‰©å¼ è€Œäººæ‰‹ä¸è¶³çš„æƒ…å†µï¼Œæˆ‘æ˜¯èƒ½æ¥å—åŠ ç­çš„ç›´è‡³äººæ‰‹æ‰©å……ã€‚ä½†å¦‚æœè¯´åŠ ç­å¹¶ä¸æ˜¯å› ä¸ºä¸ªäººäº§å‡ºæˆ–è€…ç´§æ€¥çš„éœ€æ±‚ï¼Œè€Œæ˜¯å› ä¸ºä¸€äº›æµç¨‹ä¹‹ç±»çš„é—®é¢˜ï¼Œæˆ‘è§‰å¾—åŠ ç­å¹¶ä¸æ˜¯èƒ½æ ¹æœ¬è§£å†³é—®é¢˜çš„æ–¹å¼ã€‚</p>\n</li>\n<li>\n<p>æ€ä¹ˆå¤„ç†ä¸Šçº§å†²çª?å’Œä¸Šçº§å‘ç”Ÿå†²çªçš„æ—¶å€™ï¼Œæˆ‘é¦–å…ˆåšçš„æ˜¯ç§¯æå’Œä¸Šçº§æ²Ÿé€šè‡ªå·±çš„æƒ³æ³•ï¼ŒåŒæ—¶åˆ—å‡ºè‡ªå·±çš„è®ºæ®ï¼Œç„¶åä¹Ÿä¼šå»äº†è§£ä¸Šçº§çš„æƒ³æ³•ã€‚æœ€ç»ˆä¼šä¿è¯åœ¨ä»¥å…¬å¸åˆ©ç›Šä¸ºå‰æä¸‹è¾¾æˆä¸€è‡´ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¸­å¯èƒ½ä¼šå¼•å…¥å…¶ä»–åŒäº‹ã€‚å›¢é˜Ÿå†…è¾¾æˆä¸€è‡´æ‰èƒ½ä¸ºä¸€ä¸ªå…±åŒç›®æ ‡å»åŠªåŠ›ã€‚æˆ‘è®¤ä¸ºæ„è§å†²çªæ˜¯æ²¡æ³•é¿å…çš„ï¼Œåˆç†çš„è®¨è®ºæ‰èƒ½èšé›†å›¢é˜Ÿçš„æ™ºæ…§ï¼Œæå‡å›¢é˜Ÿçº é”™èƒ½åŠ›</p>\n</li>\n</ul>\n<h1>ç¦»èŒåŸå› </h1>\n<p>åœ¨åŸå…¬å¸æ‰€è´Ÿè´£çš„å·¥ä½œå†…å®¹æ¯”è¾ƒå•ä¸€ä¸”é‡å¤æ€§æ¯”è¾ƒé«˜ï¼Œæ— æ³•æ»¡è¶³æˆ‘ä¸ªäººçš„èŒä¸šå‘å±•éœ€æ±‚ã€‚æˆ‘æƒ³æ‰¾ä¸€ä¸ªæ›´æœ‰æŒ‘æˆ˜æ€§å¹¶ä¸”æœ‰æ›´å¤§æˆé•¿ç©ºé—´çš„å·¥ä½œã€‚è€Œè´µå…¬å¸çš„æƒ…å†µéå¸¸ç¬¦åˆæˆ‘çš„é¢„æœŸ:<br>\né¦–å…ˆï¼Œæˆ‘å¾ˆè®¤å¯è´µå…¬å¸æ‰€æ¨å´‡çš„äººæ€§åŒ–ç®¡ç†ï¼Œéå¸¸ç¬¦åˆæˆ‘å¯¹å·¥ä½œç¯å¢ƒçš„é¢„æœŸï¼Œæˆ‘ä¹Ÿç›¸ä¿¡åœ¨è¿™æ ·çš„ç¯å¢ƒä¸­ï¼Œæˆ‘èƒ½å‘æŒ¥æ›´å¤§çš„ä¸»è§‚èƒ½åŠ¨æ€§ã€‚<br>\nå¹¶ä¸”æˆ‘éå¸¸çœ‹å¥½è´µå…¬å¸æ‰€å¤„çš„è¡Œä¸šå’Œæ‰€åšçš„äº‹ï¼Œå¦‚æœæˆ‘èƒ½æœ‰å¹¸åŠ å…¥è´µå…¬å¸ï¼Œç›¸ä¿¡ä¸€å®šèƒ½å’Œè´µå…¬å¸ä¸€èµ·å‘å±•ã€å…±åŒè¿›æ­¥ã€‚</p>\n<h1>1. What Do You Know About Us?</h1>\n<p>Sir Thomas Sunderland founded HSBC in <a href=\"http://1865.lt\" target=\"_blank\" rel=\"noopener noreferrer\">1865.lt</a> standsfor Hongkong Shanghai Business Corporation and iscurrently the seventh-largest bank worldwide in terms ofassets.With over 48 million customers in 66 countries.HSBC qualifies as one of the largest banking and financialservices <a href=\"http://organizations.lt\" target=\"_blank\" rel=\"noopener noreferrer\">organizations.lt</a> is listed on the London StockExchange as the Hong Kong Stock Exchange.<br>\næ‰˜é©¬æ–¯â€¢æ¡‘å¾·å…°çˆµå£«(Sir Thomas Sunderland)äº1865å¹´åˆ›ç«‹äº†æ±‡ä¸°é“¶è¡Œã€‚å®ƒä»£è¡¨é¦™æ¸¯ä¸Šæµ·å•†ä¸šå…¬å¸ï¼Œç›®å‰æ˜¯å…¨çƒç¬¬ä¸ƒå¤§èµ„äº§é“¶è¡Œã€‚åœ¨66ä¸ªå›½å®¶æ‹¥æœ‰è¶…è¿‡4800ä¸‡å®¢æˆ·ã€‚æ±‡ä¸°é“¶è¡Œæ˜¯ä¸–ç•Œä¸Šæœ€å¤§çš„é“¶è¡Œå’Œé‡‘èæœåŠ¡æœºæ„ä¹‹ä¸€ã€‚å®ƒåœ¨ä¼¦æ•¦è¯åˆ¸äº¤æ˜“æ‰€ä½œä¸ºé¦™æ¸¯è¯åˆ¸äº¤æ˜“æ‰€ä¸Šå¸‚ã€‚</p>\n<h1>2.Tell Us About Yourself</h1>\n<p>I am an accountant with seven years of experience.l haveworked in several departments, with the recent one beingcredit and loans.l have vast experience with differentaccounting software that will benefit me in this job. Being indifferent teams also means that l can fit well in teamsettings and deliver in collaborative work. l believe that allthe skills l have gathered over time have prepared me forthis job.<br>\næˆ‘æ˜¯ä¸€åæœ‰ä¸ƒå¹´ç»éªŒçš„ä¼šè®¡ã€‚æˆ‘åœ¨å¥½å‡ ä¸ªéƒ¨é—¨å·¥ä½œè¿‡ï¼Œæœ€è¿‘çš„ä¸€æ¬¡æ˜¯ä¿¡è´·éƒ¨é—¨ã€‚æˆ‘å¯¹å„ç§ä¼šè®¡è½¯ä»¶æœ‰ä¸°å¯Œçš„ç»éªŒï¼Œè¿™å¯¹æˆ‘åšè¿™ä»½å·¥ä½œå¾ˆæœ‰å¸®åŠ©ã€‚ä½œä¸ºå†·æ¼ çš„å›¢é˜Ÿä¹Ÿæ„å‘³ç€æˆ‘å¯ä»¥å¾ˆå¥½åœ°é€‚åº”å›¢é˜Ÿç¯å¢ƒï¼Œå¹¶åœ¨åä½œå·¥ä½œä¸­äº¤ä»˜æˆæœã€‚æˆ‘ç›¸ä¿¡è¿™äº›å¹´æ¥æˆ‘æ‰€å­¦åˆ°çš„æŠ€èƒ½å·²ç»ä¸ºè¿™ä»½å·¥ä½œåšå¥½äº†å‡†å¤‡ã€‚</p>\n<h1>Why Do You Want to Work Of Us?</h1>\n<p>I want a career in banking and feel that this is the bestplace to grow my career and be better at what l do. l havealso had the chance to talk to some of your former andcurrent employees, and they all agree that this is the bestworkplace for anybody who wants to advance. AdditionallyI would be proud to work in a company that has beenfeatured in the Times repeatedly.l will use all my skills,expertise and experiences to succeed in this job<br>\næˆ‘æƒ³åœ¨é“¶è¡Œå·¥ä½œï¼Œæˆ‘è§‰å¾—è¿™æ˜¯æˆ‘äº‹ä¸šå‘å±•çš„æœ€å¥½çš„åœ°æ–¹ï¼Œä¹Ÿæ˜¯æˆ‘åšå¾—æ›´å¥½çš„åœ°æ–¹ã€‚æˆ‘ä¹Ÿæœ‰æœºä¼šä¸è´µå…¬å¸çš„ä¸€äº›å‰ä»»å’Œç°ä»»å‘˜å·¥äº¤è°ˆè¿‡ï¼Œä»–ä»¬éƒ½è®¤ä¸ºå¯¹äºä»»ä½•æƒ³è¦æ™‹å‡çš„äººæ¥è¯´ï¼Œè¿™æ˜¯æœ€å¥½çš„å·¥ä½œåœºæ‰€ã€‚æ­¤å¤–ï¼Œæˆ‘å¾ˆè‡ªè±ªèƒ½åœ¨ä¸€å®¶å¤šæ¬¡ç™»ä¸Šã€Šçº½çº¦æ—¶æŠ¥ã€‹ä¸“é¢˜æŠ¥é“çš„å…¬å¸å·¥ä½œã€‚æˆ‘å°†è¿ç”¨æˆ‘æ‰€æœ‰çš„æŠ€èƒ½ã€ä¸“ä¸šçŸ¥è¯†å’Œç»éªŒæ¥åšå¥½è¿™ä»½å·¥ä½œ</p>\n<h1>Why Should We Hire You?</h1>\n<p>I am a customer service executive with over ten years nfexperience.lhave strong communication skills that will help me efficiently manage inbound and outbound callsand resolve customer queries. l am also a quick learnerand can work well under pressure.l can electronicallyprocess data and respond to any customer queriestouching on banking transactions across the world<br>\næˆ‘æ˜¯ä¸€åæœ‰åå¤šå¹´ç»éªŒçš„å®¢æˆ·æœåŠ¡ä¸»ç®¡ã€‚æˆ‘æœ‰å¾ˆå¼ºçš„æ²Ÿé€šæŠ€å·§ï¼Œè¿™å°†å¸®åŠ©æˆ‘æœ‰æ•ˆåœ°ç®¡ç†å‘¼å…¥å’Œå‘¼å‡ºç”µè¯ï¼Œå¹¶è§£å†³å®¢æˆ·çš„ç–‘é—®ã€‚æˆ‘å­¦ä¸œè¥¿å¾ˆå¿«ï¼Œèƒ½åœ¨å‹åŠ›ä¸‹å¾ˆå¥½åœ°å·¥ä½œã€‚æˆ‘å¯ä»¥ç”¨ç”µå­æ–¹å¼å¤„ç†æ•°æ®ï¼Œå¹¶å¯¹ä»»ä½•æ¶‰åŠå…¨çƒé“¶è¡Œäº¤æ˜“çš„å®¢æˆ·æŸ¥è¯¢ä½œå‡ºå›åº”</p>\n<h1>5.Some of Our Positions Have RoutineTasks.What Do You Think about Such?</h1>\n<p>I believe that i handle routine work quite well from my previous experience.lusually stay in the moment ancremain focused all through, which allows me to satisfycustomer needs.l also maintain high levels of accuracyand timeliness regardless of how repetitive thie jobs are<br>\næ ¹æ®æˆ‘ä»¥å‰çš„ç»éªŒï¼Œæˆ‘ç›¸ä¿¡æˆ‘èƒ½å¾ˆå¥½åœ°å¤„ç†æ—¥å¸¸å·¥ä½œã€‚æˆ‘é€šå¸¸ä¸“æ³¨äºå½“ä¸‹ï¼Œå§‹ç»ˆä¿æŒä¸“æ³¨ï¼Œè¿™ä½¿æˆ‘èƒ½å¤Ÿæ»¡è¶³å®¢æˆ·çš„éœ€æ±‚ã€‚æˆ‘ä¹Ÿè¦ä¿æŒé«˜æ°´å¹³çš„å‡†ç¡®æ€§å’ŒåŠæ—¶æ€§ï¼Œä¸ç®¡å·¥ä½œæœ‰å¤šé‡å¤</p>\n<h2>15.5. ä¾‹å­16</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package c_019_m;\n\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * é¢è¯•ï¼ˆæ·˜å®ï¼Ÿï¼‰\n * å®ç°ä¸€ä¸ªå®¹å™¨ï¼Œæä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œaddï¼Œsize\n * å†™ä¸¤ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹1æ·»åŠ 10ä¸ªå…ƒç´ åˆ°å®¹å™¨ä¸­ï¼Œçº¿ç¨‹2å®ç°ç›‘æ§å…ƒç´ çš„ä¸ªæ•°ï¼Œå½“ä¸ªæ•°åˆ°è¾¾5æ—¶ï¼Œçº¿ç¨‹2ç»™å‡ºæç¤ºå¹¶ç»“æŸ\n */\npublic class MyContainer3 {\n\n    private List&lt;Object&gt; list = new ArrayList&lt;&gt;();\n\n    public void add(Object ele) {\n        list.add(ele);\n    }\n\n    public int size() {\n        return list.size();\n    }\n\n    public static void main(String[] args) {\n\n        MyContainer3 container = new MyContainer3();\n\n        final Object lock = new Object();\n\n        new Thread(() -&gt; {\n            synchronized (lock) {\n                System.out.println(\"t2 å¯åŠ¨\");\n                if (container.size() != 5) {\n                    try {\n                        lock.wait();\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n                System.out.println(\"ç›‘æµ‹åˆ°å®¹å™¨é•¿åº¦ä¸º5ï¼Œçº¿ç¨‹2ç«‹å³é€€å‡º\");\n                lock.notify();\n            }\n        }, \"t2\").start();\n\n        // å…ˆå¯åŠ¨t2çº¿ç¨‹ï¼Œè®©t2çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€\n        try {\n            TimeUnit.SECONDS.sleep(2);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n        \n        new Thread(() -&gt; {\n            synchronized (lock) {\n                for (int i = 0; i &lt; 10; i++) {\n                    container.add(new Object());\n                    System.out.println(\"add \" + i);\n                    // å½“é•¿åº¦ä¸º5æ—¶ï¼Œé€šçŸ¥ t2 è¿›è¡Œé€€å‡º\n                    if (container.size() == 5) {\n                        lock.notify(); // notify ä¸ä¼šé‡Šæ”¾é”ï¼Œå³ä¾¿é€šçŸ¥t2ï¼Œt2ä¹Ÿè·å–ä¸åˆ°é”\n                        // å¯ä»¥åœ¨waitä¸€ä¸‹ï¼Œå°†é”é‡Šæ”¾ï¼Œå†è®©t2é€šçŸ¥t1ç»§ç»­æ‰§è¡Œ\n\t\t\t\t\t\t//notifyä¸èƒ½å”¤é†’ç‰¹å®šçº¿ç¨‹ï¼Œç”±cpuå†³å®šçš„\n\t\t\t\t\t\t//notifyä¼šè®©çº¿ç¨‹ä»ä¸Šæ¬¡çš„waitçš„åœ°æ–¹ç»§ç»­æ‰§è¡Œ\n                        try {\n                            lock.wait();\n                        } catch (InterruptedException e) {\n                            e.printStackTrace();\n                        }\n                    }\n                    try {\n                        TimeUnit.SECONDS.sleep(1);\n                    } catch (InterruptedException e) {\n                        e.printStackTrace();\n                    }\n                }\n            }\n        }, \"t1\").start();\n    }\n\n}\n\n/*\nä½¿ç”¨waitå’Œnotify\nwait()ä¸notify() æ–¹æ³•çš„è°ƒç”¨å¿…é¡»åœ¨åŒæ­¥ä»£ç å—ä¸­\nwaitä¼šé‡Šæ”¾é”ï¼Œnotifyä¸ä¼šé‡Šæ”¾é”ï¼Œä¸€èˆ¬ä¸è¦ç”¨\né”å®šå¯¹è±¡aï¼Œè°ƒç”¨a.wait() æ–¹æ³•ï¼Œå½“å‰çº¿ç¨‹å°±ä¼šè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç„¶åé‡Šæ”¾é”ã€‚\nå½“æŸçº¿ç¨‹è°ƒç”¨ a.notify() / a.notifyAll()ï¼Œ å«é†’åœ¨aå¯¹è±¡ç­‰å¾…çš„æ‰€æœ‰çº¿ç¨‹\n */\n</code></pre></div><h2>15.6. ä¾‹å­17</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package c_019_m;\n\nimport java.sql.Time;\nimport java.util.ArrayList;\nimport java.util.List;\nimport java.util.concurrent.CountDownLatch;\nimport java.util.concurrent.TimeUnit;\n\n/**\n * é¢è¯•ï¼ˆæ·˜å®ï¼Ÿï¼‰\n * å®ç°ä¸€ä¸ªå®¹å™¨ï¼Œæä¾›ä¸¤ä¸ªæ–¹æ³•ï¼Œaddï¼Œsize\n * å†™ä¸¤ä¸ªçº¿ç¨‹ï¼Œçº¿ç¨‹1æ·»åŠ 10ä¸ªå…ƒç´ åˆ°å®¹å™¨ä¸­ï¼Œçº¿ç¨‹2å®ç°ç›‘æ§å…ƒç´ çš„ä¸ªæ•°ï¼Œå½“ä¸ªæ•°åˆ°è¾¾5æ—¶ï¼Œçº¿ç¨‹2ç»™å‡ºæç¤ºå¹¶ç»“æŸ\n */\npublic class MyContainer5 {\n\n    private volatile List&lt;Object&gt; list = new ArrayList&lt;&gt;();\n\n    public void add(Object ele) {\n        list.add(ele);\n    }\n\n    public int size() {\n        return list.size();\n    }\n\n    public static void main(String[] args) {\n\n        MyContainer5 container = new MyContainer5();\n\n        // Count down å¾€ä¸‹æ•°  Latch é—¨é—©\n        // é—¨é—©ä¸èƒ½ä¿è¯å¯è§æ€§ï¼Œä¸æ˜¯ä¸€ç§åŒæ­¥æ–¹å¼ï¼Œåªæ˜¯ä¸€ç§çº¿ç¨‹é€šä¿¡æ–¹å¼ï¼Œä¿è¯ä¸äº†å¯è§æ€§\n        // é—¨é—©çš„ç­‰å¾…ï¼Œä¸ä¼šæŒæœ‰ä»»ä½•é”\n        CountDownLatch latch = new CountDownLatch(1);\n\n        new Thread(() -&gt; {\n            System.out.println(\"t2 å¯åŠ¨\");\n            if (container.size() != 5) {\n                try {\n                    latch.await();\n                    // æŒ‡å®šç­‰å¾…æ—¶é—´\n                    //latch.await(5000, TimeUnit.MILLISECONDS);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n            System.out.println(\"ç›‘æµ‹åˆ°å®¹å™¨é•¿åº¦ä¸º5ï¼Œçº¿ç¨‹2ç«‹å³é€€å‡º\");\n        }, \"t2\").start();\n\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        new Thread(() -&gt; {\n            System.out.println(\"t1 å¯åŠ¨\");\n            for (int i = 0; i &lt; 10; i++) {\n                container.add(new Object());\n                System.out.println(\"add \" + i);\n                // å½“é•¿åº¦ä¸º5æ—¶ï¼Œæ’¤æ‰ä¸€ä¸ªé—¨é—©ï¼Œæ­¤æ—¶é—¨é—©ä¸º0ï¼Œé—¨ä¼šæ‰“å¼€ï¼Œå³t2ä¼šç»§ç»­æ‰§è¡Œ\n                if (container.size() == 5) {\n                    latch.countDown();\n                }\n                try {\n                    TimeUnit.SECONDS.sleep(1);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n            }\n        }, \"t1\").start();\n    }\n\n}\n\n/*\n\nä½¿ç”¨CountDownLatchå®ç°ï¼ˆæœ€ç®€å•çš„æ–¹å¼ï¼‰\n\nLatchï¼šé—¨é—©\n\n\nä½¿ç”¨Latchæ›¿ä»£ wait notifyæ¥è¿›è¡Œé€šä¿¡\nå¥½å¤„æ˜¯ï¼Œé€šä¿¡ç®€å•ï¼ŒåŒæ—¶ä¹Ÿå¯ä»¥æŒ‡å®šç­‰å¾…æ—¶é—´\nä½¿ç”¨awaitå’ŒcountDown æ–¹æ³•æ›¿ä»£ wait å’Œ notify\nCountDownLatchä¸æ¶‰åŠé”å®šï¼Œå½“countå€¼ä¸º0æ—¶ï¼Œå½“å‰çº¿ç¨‹ç»§ç»­è¿è¡Œ\nå½“ä¸æ¶‰åŠåŒæ­¥ï¼Œåªæ¶‰åŠçº¿ç¨‹é€šä¿¡çš„æ—¶å€™ï¼Œç”¨synchronized + wait + notify å°±æ˜¾å¾—å¤ªé‡äº†\n */\n</code></pre></div><h2>15.7. ä¾‹å­6</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package c_021_m;\n\nimport java.util.LinkedList;\n\n/**\n * ç»å…¸é¢è¯•ï¼šå†™ä¸€ä¸ªå›ºå®šå®¹é‡çš„å®¹å™¨ï¼Œæ‹¥æœ‰putå’Œgetæ–¹æ³•ï¼Œä»¥åŠgetCountæ–¹æ³•\n * èƒ½å¤Ÿæ”¯æŒ2ä¸ªç”Ÿäº§è€…çº¿ç¨‹ä»¥åŠ10ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹çš„é˜»å¡è°ƒç”¨\n * \n * ç‚¹ï¼šç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼\n * \n * å¦‚æœè°ƒç”¨ getæ–¹æ³•æ—¶ï¼Œå®¹å™¨ä¸ºç©ºï¼Œgetæ–¹æ³•å°±éœ€è¦é˜»å¡ç­‰å¾…\n * å¦‚æœè°ƒç”¨ putæ–¹æ³•æ—¶ï¼Œå®¹å™¨æ»¡äº†ï¼Œputæ–¹æ³•å°±éœ€è¦é˜»å¡ç­‰å¾…\n * \n * å®ç°æ–¹å¼ï¼š\n * 1. wait/notify\n * 2. Condition\n */\npublic class MyContainer1&lt;T&gt; {\n    \n    private final LinkedList&lt;T&gt; list = new LinkedList&lt;&gt;();\n    private final int MAX = 10;\n    private int count = 0;\n\n    public synchronized void put(T t) {\n        while (MAX == count) { // å¦‚æœå®¹é‡æœ€å¤§ï¼Œé‡Šæ”¾é”ç­‰å¾…    ///ã€è¿™é‡Œä¸ºä»€ä¹ˆä½¿ç”¨whileï¼Œè€Œä¸æ˜¯ä½¿ç”¨ifï¼Ÿï¼Ÿï¼Ÿã€‘\n            try {\n                this.wait();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n        // å¦åˆ™ put \n        list.add(t);\n        ++count;\n        this.notifyAll(); // é€šçŸ¥æ¶ˆè´¹è€…çº¿ç¨‹ï¼Œå¯ä»¥æ¶ˆè´¹äº†\n        // ã€è¿™é‡Œä¸ºä»€ä¹ˆè°ƒç”¨ notifyAll è€Œä¸æ˜¯ notify ï¼Ÿã€‘\n    }\n\n    public synchronized T get() {\n        while (list.size() == 0) { // å¦‚æœå®¹é‡ä¸ºç©ºï¼Œé‡Šæ”¾é”ç­‰å¾…  \n            try {\n                this.wait();\n            } catch (InterruptedException e) {\n                e.printStackTrace();\n            }\n        }\n        // å¦åˆ™è·å–\n        T t = list.removeFirst();\n        count--;\n        this.notifyAll(); // é€šçŸ¥ç”Ÿäº§è€…çº¿ç¨‹ç”Ÿäº§\n        return t;\n    }\n}\n\n/*\n\nä¸ºä»€ä¹ˆä½¿ç”¨while è€Œä¸æ˜¯ä½¿ç”¨ if ï¼Ÿï¼Ÿï¼Ÿ\nåœ¨ä¸wait()çš„é…åˆä¸­ï¼Œç™¾åˆ†ä¹‹99çš„ç¨‹åºéƒ½æ˜¯ä¸whileè€Œä¸æ˜¯ifç»“åˆä½¿ç”¨ã€‚\nä¸Šè¿°ä»£ç ä¸­ï¼Œåœ¨å®¹å™¨å·²æ»¡çš„æƒ…å†µä¸‹ï¼Œputæ–¹æ³•ä¼šwaitç­‰å¾…ï¼Œå½“å®¹å™¨ä¸­çš„å…ƒç´ è¢«æ¶ˆè´¹è€…æ¶ˆè´¹äº†ä¸€éƒ¨åˆ†ï¼Œå°±ä¼šå”¤é†’æ‰€æœ‰putæ–¹æ³•ï¼Œ\nputæ–¹æ³•ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œç›´æ¥æ‰§è¡Œlist.add(t)ï¼Œé‚£ä¹ˆå¤šä¸ªç”Ÿäº§è€…çº¿ç¨‹æ‰§è¡Œlist.add() å°±æœ‰å¯èƒ½å‡ºç°æ•°æ®ä¸€è‡´æ€§çš„é—®é¢˜ã€‚\nå¦‚æœä½¿ç”¨whileåˆ™ä¼šå¾ªç¯åˆ¤æ–­ï¼Œå°±é¿å…äº†è¿™äº›é—®é¢˜ã€‚\n\nä¸æ˜¯æœ‰é”å—ï¼Ÿä¸ºä»€ä¹ˆä¼šéœ€è¦å¾ªç¯åˆ¤æ–­ï¼Ÿ\nwaitä¹‹åï¼Œé”å°±ä¼šå¤±å»ï¼Œå†æ¬¡è¢«å”¤é†’æ—¶ï¼Œå¹¶ä¸”å¾—åˆ°é”ä¹‹åï¼Œ**æ˜¯ä»list.add()å¼€å§‹æ‰§è¡Œçš„**ï¼Œä¼šæ— åˆ¤æ–­ç›´æ¥åŠ å…¥åˆ°å®¹å™¨ä¸­ã€‚\n\n\nä¸ºä»€ä¹ˆè°ƒç”¨ notifyAll è€Œä¸æ˜¯ notify ï¼Ÿ\nå› ä¸ºnotifyæœ‰å¯èƒ½å†æ¬¡å«é†’ä¸€ä¸ªç”Ÿäº§è€…çº¿ç¨‹\n\n\n */\n</code></pre></div><h2>15.8. ä¾‹å­7</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package c_021_m;\n\nimport java.util.LinkedList;\nimport java.util.concurrent.TimeUnit;\nimport java.util.concurrent.locks.Condition;\nimport java.util.concurrent.locks.Lock;\nimport java.util.concurrent.locks.ReentrantLock;\n\n/**\n * ç»å…¸é¢è¯•ï¼šå†™ä¸€ä¸ªå›ºå®šå®¹é‡çš„å®¹å™¨ï¼Œæ‹¥æœ‰putå’Œgetæ–¹æ³•ï¼Œä»¥åŠgetCountæ–¹æ³•\n * èƒ½å¤Ÿæ”¯æŒ2ä¸ªç”Ÿäº§è€…çº¿ç¨‹ä»¥åŠ10ä¸ªæ¶ˆè´¹è€…çº¿ç¨‹çš„é˜»å¡è°ƒç”¨\n * &lt;p&gt;\n * ç‚¹ï¼šç”Ÿäº§è€…æ¶ˆè´¹è€…æ¨¡å¼\n * &lt;p&gt;\n * å¦‚æœè°ƒç”¨ getæ–¹æ³•æ—¶ï¼Œå®¹å™¨ä¸ºç©ºï¼Œgetæ–¹æ³•å°±éœ€è¦é˜»å¡ç­‰å¾…\n * å¦‚æœè°ƒç”¨ putæ–¹æ³•æ—¶ï¼Œå®¹å™¨æ»¡äº†ï¼Œputæ–¹æ³•å°±éœ€è¦é˜»å¡ç­‰å¾…\n * &lt;p&gt;\n * å®ç°æ–¹å¼ï¼š\n * 1. wait/notify\n * 2. Condition\n * &lt;p&gt;\n * &lt;p&gt;\n * ä½¿ç”¨Lockå’ŒConditionå®ç°ï¼Œå¯ä»¥ç²¾ç¡®å”¤é†’æŸäº›çº¿ç¨‹\n */\npublic class MyContainer2&lt;T&gt; {\n\n    private final LinkedList&lt;T&gt; list = new LinkedList&lt;&gt;();\n    private final int MAX = 10;\n    private int count = 0;\n\n    private Lock lock = new ReentrantLock();\n    private Condition producer = lock.newCondition();\n    private Condition consumer = lock.newCondition();\n\n\n    public synchronized void put(T t) {\n        lock.lock();\n        try {\n            while (MAX == count) {\n                producer.await();\n            }\n            list.add(t);\n            ++count;\n            consumer.signalAll();\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n    }\n\n    public synchronized T get() {\n        lock.lock();\n        try {\n            while (list.size() == 0) {\n                consumer.await();\n            }\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        } finally {\n            lock.unlock();\n        }\n        T t = list.removeFirst();\n        count--;\n        producer.signalAll();\n        return t;\n    }\n\n    public static void main(String[] args) {\n        MyContainer2&lt;String&gt; c = new MyContainer2&lt;&gt;();\n        // å¯åŠ¨æ¶ˆè´¹è€…çº¿ç¨‹\n        for (int i = 0; i &lt; 10; i++) {\n            new Thread(() -&gt; {\n                for (int j = 0; j &lt; 5; j++) {\n                    System.out.println(c.get());\n                }\n            }, \"c_\" + i ).start();\n        }\n\n        try {\n            TimeUnit.SECONDS.sleep(1);\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n        }\n\n        for (int i = 0; i &lt; 2; i++) {\n            new Thread(()-&gt;{\n                for (int j = 0; j &lt; 2; j++) {\n                    c.put(Thread.currentThread().getName() + \" \" + j);\n                }\n            }, \"p_\" + i).start();\n        }\n    }\n}\n\n</code></pre></div><h1>21. vueæ˜¯å¦‚ä½•å®ç°æ•°æ®åŒå‘ç»‘å®šçš„</h1>\n<h1>22. vueæ€ä¹ˆå®ç°å¯¹è±¡å’Œæ•°ç»„ç›‘å¬</h1>\n<h1>23. mybatisæ‰§è¡Œæµç¨‹é¡ºåºæ’åº</h1>\n<p>(1)è¯»å– MyBatis é…ç½®æ–‡ä»¶ mybatis-config.xmlã€‚mybatis-config.xmlä½œä¸ºMyBatis çš„å…¨å±€é…ç½®æ–‡ä»¶ï¼Œé…ç½®äº† MyBatisçš„è¿è¡Œç¯å¢ƒç­‰ä¿¡æ¯ï¼Œå…¶ä¸­ä¸»è¦å†…å®¹æ˜¯è·å–æ•°æ®åº“è¿æ¥ã€‚<br>\n(2)åŠ è½½æ˜ å°„æ–‡ä»¶ Mapper.xmlã€‚Mapper.xml æ–‡ä»¶å³ SQL æ˜ å°„æ–‡ä»¶ï¼Œè¯¥æ–‡ä»¶ä¸­é…ç½®äº†æ“ä½œæ•°æ®åº“çš„ SQL è¯­å¥ï¼Œéœ€è¦åœ¨ mybatis-config.xml ä¸­åŠ è½½æ‰èƒ½æ‰§è¡Œã€‚mybatis-config.xmlå¯ä»¥åŠ è½½å¤šä¸ªé…ç½®æ–‡ä»¶ï¼Œæ¯ä¸ªé…ç½®æ–‡ä»¶å¯¹åº”æ•°æ®åº“ä¸­çš„ä¸€å¼ è¡¨ã€‚<br>\n(3)æ„å»ºä¼šè¯å·¥å‚ã€‚é€šè¿‡ MyBatis çš„ç¯å¢ƒç­‰é…ç½®ä¿¡æ¯æ„å»ºä¼šè¯å·¥å‚SqlSessionFactoryã€‚<br>\n(4)åˆ›å»ºSqlSession å¯¹è±¡ã€‚ç”±ä¼šè¯å·¥å‚åˆ›å»º SqlSession å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­åŒ…å«äº†æ‰§è¡Œ SQL çš„æ‰€æœ‰æ–¹æ³•ã€‚<br>\n(5)åœ¨ Executor æ¥å£çš„æ‰§è¡Œæ–¹æ³•ä¸­ï¼ŒåŒ…å«ä¸€ä¸ª MappedStatement ç±»å‹çš„å‚æ•°ï¼Œè¯¥å‚æ•°æ˜¯å¯¹æ˜ å°„ä¿¡æ¯çš„å°è£…ï¼Œç”¨äºå­˜å‚¨è¦æ˜ å°„çš„ SQLè¯­å¥çš„idã€å‚æ•°ç­‰ã€‚<br>\nMapper.xmlæ–‡ä»¶ä¸­ä¸€ä¸ª SQL å¯¹åº”ä¸€ä¸ª MappedStatementå¯¹è±¡ï¼ŒSQLçš„idå³æ˜¯ MappedStatement çš„ idã€‚<br>\n(6)MyBatisåº•å±‚å®šä¹‰äº†ä¸€ä¸ªExecutoræ¥å£æ¥æ“ä½œæ•°æ®åº“,å®ƒä¼šæ ¹æ®SqlSessionä¼ é€’çš„å‚æ•°åŠ¨æ€åœ°ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼ŒåŒæ—¶è´Ÿè´£æŸ¥è¯¢ç¼“å­˜çš„ç»´æŠ¤ã€‚<br>\n(7)è¾“å…¥å‚æ•°æ˜ å°„ã€‚åœ¨æ‰§è¡Œæ–¹æ³•æ—¶ï¼ŒMappedStatement å¯¹è±¡ä¼šå¯¹ç”¨æˆ·æ‰§è¡Œ SQLè¯­å¥çš„è¾“å…¥å‚æ•°è¿›è¡Œå®šä¹‰(å¯ä»¥å®šä¹‰ä¸º Mapã€Listç±»å‹ã€åŸºæœ¬ç±»å‹å’Œ POJOç±»å‹)ï¼ŒExecutor æ‰§è¡Œå™¨ä¼šé€šè¿‡ MappedStatement å¯¹è±¡åœ¨æ‰§è¡Œ SQL å‰ï¼Œå°†è¾“å…¥çš„Java å¯¹è±¡æ˜ å°„åˆ° SQL è¯­å¥ä¸­ã€‚è¿™é‡Œå¯¹è¾“å…¥å‚æ•°çš„æ˜ å°„è¿‡ç¨‹å°±ç±»ä¼¼äº JDBCç¼–ç¨‹ä¸­å¯¹ preparedStatement å¯¹è±¡è®¾ç½®å‚æ•°çš„è¿‡ç¨‹ã€‚<br>\n(8)è¾“å‡ºç»“æœæ˜ å°„ã€‚åœ¨æ•°æ®åº“ä¸­æ‰§è¡Œå®Œ SQL è¯­å¥åï¼ŒMappedStatement å¯¹è±¡ä¼šå¯¹ SQL æ‰§è¡Œè¾“å‡ºçš„ç»“æœè¿›è¡Œå®šä¹‰(å¯ä»¥å®šä¹‰ä¸º Map å’Œ Listç±»å‹ã€åŸºæœ¬ç±»å‹ã€POJOç±»å‹)ï¼ŒExecutor æ‰§è¡Œå™¨ä¼šé€šè¿‡ MappedStatement å¯¹è±¡åœ¨æ‰§è¡Œ SQL è¯­å¥åï¼Œå°†è¾“å‡ºç»“æœæ˜ å°„è‡³ Java å¯¹è±¡ä¸­ã€‚è¿™ç§å°†è¾“å‡ºç»“æœæ˜ å°„åˆ° Java å¯¹è±¡çš„è¿‡ç¨‹å°±ç±»ä¼¼äº JDBCç¼–ç¨‹ä¸­å¯¹ç»“æœçš„è§£æå¤„ç†è¿‡ç¨‹ã€‚</p>\n<p>2ã€å…³äº mybatisï¼Œè¯·æ‰¾å‡ºé”™è¯¯çš„æè¿°ã€‚<br>\n1ã€Configuration:ç”¨äºæè¿° JDBC ä¸»é…ç½®æ–‡ä»¶ä¿¡æ¯ï¼ŒMyBatis æ¡†æ¶åœ¨å¯åŠ¨å®Œæˆä»¥åä¼šåŠ è½½ä¸»é…ç½®æ–‡ä»¶ï¼Œå°†é…ç½®ä¿¡æ¯è½¬æ¢ä¸º Configuration å¯¹è±¡ã€‚<br>\n2ã€SqlSession:é¢å‘ç”¨æˆ·çš„ APIï¼Œæ˜¯ JDBC ä¸æ•°æ®åº“äº¤äº’çš„æ¥å£ã€‚<br>\n3ã€Executor:SQL æ‰§è¡Œå™¨,ç”¨äºå’Œæ•°æ®åº“äº¤äº’.SqlSession å¯ä»¥ç†è§£ä¸º Executorç»„ä»¶çš„å¤–è§‚ï¼ŒçœŸæ­£æ‰§è¡Œ SQL çš„æ˜¯ SqlSession ç»„ä»¶ã€‚<br>\n4ã€MappedStatement:ç”¨äºæè¿°SQLé…ç½®ä¿¡æ¯ï¼ŒMyBatis æ¡†æ¶å¯åŠ¨æ—¶ï¼ŒXMLæ–‡ä»¶æˆ–è€…æ³¨è§£é…ç½®çš„SQLä¿¡æ¯ä¼šè¢«è½¬æ¢ä¸ºMappedStatementå¯¹è±¡æ³¨å†Œåˆ°Configuration ç»„ä»¶ä¸­ã€‚<br>\n5ã€StatementHandler:å°è£…äº†å¯¹JDBCä¸­Statement å¯¹è±¡çš„æ“ä½œï¼ŒåŒ…æ‹¬ä¸ºStatement å‚æ•°å ä½ç¬¦è®¾ç½®å€¼ï¼Œé€šè¿‡ Statement å¯¹è±¡æ‰§è¡Œ SQLè¯­å¥<br>\n6ã€TypeHandler:ç±»å‹å¤„ç†å™¨ï¼Œç”¨äºJavaç±»å‹ä¸åŸºç¡€ç±»å‹ä¹‹é—´çš„è½¬æ¢ã€‚<br>\n7ã€ParameterHandler:ç”¨äºå¤„ç† SQLä¸­çš„å‚æ•°å ä½ç¬¦ï¼Œä¸ºå‚æ•°å ä½ç¬¦è®¾ç½®å€¼ã€‚<br>\n8ã€ResultSetHandler:å°è£…äº†å¯¹Setå¯¹è±¡çš„å¤„ç†é€»è¾‘ï¼Œå°†ç»“æœé›†è½¬æ¢ä¸ºJavaå®ä½“å¯¹è±¡</p>\n<p>3ã€å…³äº mybatis æµç¨‹ï¼Œè¯·æ’å¥½ä¸‹åˆ—é¡ºåº?<br>\n1ã€åŠ è½½ mybatis å…¨å±€é…ç½®æ–‡ä»¶(æ•°æ®æºã€mapperæ˜ å°„æ–‡ä»¶ç­‰)<br>\n2ã€è§£æé…ç½®æ–‡ä»¶<br>\n3ã€SqlSessionFactoryBuilder é€š è¿‡Configurationå¯¹è±¡ç”ŸæˆSqlSessionFactory<br>\n4ã€MyBatis åŸºäº XML é…ç½®æ–‡ä»¶ç”Ÿæˆ Configuration<br>\n5ã€å’Œä¸€ä¸ªä¸ª MappedStatement(åŒ…æ‹¬äº†å‚æ•°æ˜ å°„é…ç½®ã€åŠ¨æ€ SQL è¯­å¥ã€<br>\nç»“æœæ˜ å°„é…ç½®)ï¼Œå…¶å¯¹åº”ç€<code>&lt;select|update|delete|insert&gt;</code>æ ‡ç­¾é¡¹ã€‚</p>\n<p>4ã€Mybatis ä¸­çš„ SQLSession æµç¨‹è¯·æ’å¥½ä¸‹åˆ—é¡ºåº<br>\naã€ç”¨æˆ·ç¨‹åºè°ƒç”¨ mybatis æ¥å£å±‚ api(å³ Mapper æ¥å£ä¸­çš„æ–¹æ³•)<br>\nbã€é€šè¿‡ Executor(è´Ÿè´£åŠ¨æ€ SQLçš„ç”Ÿæˆå’ŒæŸ¥è¯¢ç¼“å­˜çš„ç»´æŠ¤)å°†MappedStatement å¯¹è±¡è¿›è¡Œè§£æ<br>\ncã€ä½¿ç”¨ Paramterhandler å¡«å……å‚æ•°ï¼Œä½¿ç”¨ statementHandlerç»‘å®šå‚æ•°<br>\ndã€sql å‚æ•°è½¬åŒ–ã€åŠ¨æ€ sql æ‹¼æ¥ï¼Œç”Ÿæˆ jdbc Statement å¯¹è±¡<br>\neã€SqlSession é€šè¿‡è°ƒç”¨ apiçš„StatementID æ‰¾åˆ°å¯¹åº”çš„ MappedStatement å¯¹è±¡<br>\nfã€JDBC æ‰§è¡Œ sqlä¹Ÿè¡Œæ•°<br>\ngã€ä½¿ç”¨ ResultSetHandler å°†è¿”å›ç»“æœè½¬åŒ–æˆ HashMapã€JavaBeanç­‰å­˜å‚¨ç»“æ„å¹¶è¿”å›<br>\nhã€å€ŸåŠ© MappedStatementä¸­çš„ç»“æœæ˜ å°„å…³ç³»<br>\niã€å…³é—­ sqlsession ä¼šè¯</p>\n<p>5ã€åˆ¤æ–­å…³äº springcloud config é…ç½®ä¸­å¿ƒä¸‹åˆ—è¯´æ³•å¯¹é”™<br>\n1ã€é…ç½®æœåŠ¡å™¨:ä¸ºé…ç½®å®¢æˆ·ç«¯æä¾›å…¶å¯¹åº”çš„é…ç½®ä¿¡æ¯ï¼Œé…ç½®ä¿¡æ¯çš„æ¥æºä¸ºé…ç½®ä»“åº“ï¼Œå¯åŠ¨æ—¶å³æ‹‰å–é…ç½®ä»“åº“çš„ä¿¡æ¯ï¼Œç¼“å­˜åˆ°æœ¬åœ°ä»“åº“ä¸­ã€‚<br>\n2ã€é…ç½®å®¢æˆ·ç«¯:é™¤äº†é…ç½®æœåŠ¡å™¨ä¹‹å¤–çš„åº”ç”¨æœåŠ¡ï¼Œå¯åŠ¨æ—¶ä»é…ç½®æœåŠ¡å™¨æ‹‰å–å…¶å¯¹åº”çš„é…ç½®ä¿¡æ¯ã€‚<br>\n3ã€é…ç½®ä»“åº“:ä¸ºé…ç½®æœåŠ¡å™¨æä¾›é…ç½®æºä¿¡æ¯ï¼Œé…ç½®ä»“åº“çš„å®ç°å¯ä»¥æ”¯æŒå¤šç§æ–¹å¼ã€‚</p>\n<p>6ã€å…³äº Spring Cloud Config æ„å»ºåˆ¤æ–­ä¸‹åˆ—æ“ä½œæ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœæ˜¯é”™è¯¯çš„ï¼Œè¯·è¯´æ˜ç†ç”±<br>\næ„å»º Spring cloud config é…ç½®ä¸­å¿ƒ<br>\n1ã€åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Spring Boot é¡¹ç›®<br>\n2ã€åœ¨ pom.xml æ–‡ä»¶ä¸­æ·»åŠ  config-server ä¾èµ–<br>\n3ã€åœ¨å…¥å£ç±»ï¼Œä¹Ÿå°±æ˜¯ main æ–¹æ³•çš„ç±»ä¸Šæ·»åŠ æ³¨è§£ @EnableConfigServer<br>\n4ã€åœ¨ application.properties ä¸­é…ç½®ä¸€ä¸‹ git ä»“åº“ä¿¡æ¯ï¼Œæ­¤å¤„æˆ‘ä»¬ä½¿ç”¨<br>\nGitHub( ä¹Ÿå¯ä»¥ä½¿ç”¨ç äº‘ gitee)ã€‚<br>\næ¥å£ URL:/{application}/{profile}/{label}<br>\næ„å»º Springcloud config é…ç½®ä¸­å¿ƒä»“åº“<br>\næ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦åœ¨ github ä¸Šè®¾ç½®å¥½é…ç½®ä¸­å¿ƒï¼Œé¦–å…ˆåœ¨æœ¬åœ°åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å«wkctoï¼Œç„¶ååœ¨é‡Œé¢åˆ›å»ºä¸€ä¸ªæ–‡ä»¶å¤¹å« config-centerï¼Œç„¶ååœ¨ config-center ä¸­åˆ›å»ºå››ä¸ªé…ç½®æ–‡ä»¶ã€‚<br>\nç»è¿‡å¯¹ wkcto ç›®å½•ä¸‹çš„æ–‡ä»¶è¿›è¡Œæ“ä½œåï¼Œæœ€ç»ˆä½¿ç”¨ git push æ¨é€åˆ°è¿œç¨‹ä»“åº“ï¼Œç„¶åå¯åŠ¨æˆ‘ä»¬çš„é…ç½®ä¸­å¿ƒï¼Œé€šè¿‡/{application}/{profile}/{label}å°±èƒ½è®¿é—®åˆ°æˆ‘ä»¬çš„é…ç½®æ–‡ä»¶äº†ã€‚</p>\n<p>æ„å»º Spring cloud config é…ç½®ä¸­å¿ƒå®¢æˆ·ç«¯<br>\n1ã€åˆ›å»ºä¸€ä¸ªæ™®é€šçš„ Spring Boot å·¥ç¨‹ 08-springcloud-config-clientï¼Œå¹¶æ·»åŠ <br>\nstarter-conifd ä¾èµ–.<br>\n2ã€åˆ›å»º bootstrap.properties æ–‡ä»¶ï¼Œç”¨äºè·å–é…ç½®ä¿¡æ¯ã€‚<br>\nname å¯¹åº”é…ç½®æ–‡ä»¶ä¸­çš„ application éƒ¨åˆ†ï¼Œprofile å¯¹åº”äº† profile éƒ¨åˆ†ï¼Œlabel<br>\nå¯¹åº”äº† label éƒ¨åˆ†ï¼Œuri è¡¨ç¤ºé…ç½®ä¸­å¿ƒçš„åœ°å€ã€‚<br>\nç„¶åä½¿ç”¨@RefreshScope è¿›è¡Œå¯¹é…ç½®æ–‡ä»¶çš„åˆ·æ–°ï¼Œæ¥ä¸‹æ¥å°±æ˜¯ç”¨ Spring è‡ªå¸¦<br>\næ³¨è§£å¯ä»¥è·å–é…ç½®å†…å®¹ã€‚ä¾‹å¦‚@value</p>\n<p>7ã€å…³äºé…ç½®ä¸­å¿ƒæ‰§è¡Œæµç¨‹ï¼Œåˆ¤æ–­ä¸‹å›¾çš„æ˜¯å¦æ­£ç¡®ï¼Œå¦‚æœä¸æ­£ç¡®ï¼Œè¯·è¯´æ˜ç†ç”±ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f4fe8a438b4fca2f17b6b.png\" alt=\"é…ç½®ä¸­å¿ƒæ‰§è¡Œæµç¨‹.jpg\"></p>\n<p>8ã€ä¸ºä¸‹åˆ— Eureka å·¥ä½œæµç¨‹æ’åº<br>\n1ã€Eureka Server å¯åŠ¨æˆåŠŸï¼Œç­‰å¾…æœåŠ¡ç«¯æ³¨å†Œã€‚åœ¨å¯åŠ¨è¿‡ç¨‹ä¸­å¦‚æœé…ç½®äº†é›†ç¾¤ï¼Œé›†ç¾¤ä¹‹é—´å®šæ—¶é€šè¿‡ Replicate åŒæ­¥æ³¨å†Œè¡¨,æ¯ä¸ª Eureka Server éƒ½å­˜åœ¨ç‹¬ç«‹å®Œæ•´çš„æœåŠ¡æ³¨å†Œè¡¨ä¿¡æ¯<br>\n2ã€Eureka Client å¯åŠ¨æ—¶æ ¹æ®é…ç½®çš„ Eureka Server åœ°å€å»æ³¨å†Œä¸­å¿ƒæ³¨å†ŒæœåŠ¡<br>\n3ã€Eureka Client ä¼šæ¯ 30s å‘ Eureka Server å‘é€ä¸€æ¬¡å¿ƒè·³è¯·æ±‚ï¼Œè¯æ˜å®¢æˆ·ç«¯æœåŠ¡æ­£å¸¸<br>\n4ã€å½“ Eureka Server 90s å†…æ²¡æœ‰æ”¶åˆ° Eureka Client çš„å¿ƒè·³ï¼Œæ³¨å†Œä¸­å¿ƒåˆ™è®¤ä¸ºè¯¥èŠ‚ç‚¹å¤±æ•ˆï¼Œä¼šæ³¨é”€è¯¥å®ä¾‹<br>\n5ã€å•ä½æ—¶é—´å†… Eureka Server ç»Ÿè®¡åˆ°æœ‰å¤§é‡çš„ Eureka Client æ²¡æœ‰ä¸Šé€å¿ƒè·³ï¼Œåˆ™è®¤ä¸ºå¯èƒ½ä¸ºç½‘ç»œå¼‚å¸¸ï¼Œè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ï¼Œä¸å†å‰”é™¤æ²¡æœ‰ä¸Šé€å¿ƒè·³çš„å®¢æˆ·ç«¯æµç§»<br>\n6ã€å½“ Eureka Client å¿ƒè·³è¯·æ±‚æ¢å¤æ­£å¸¸ä¹‹åï¼ŒEureka Server è‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼<br>\n7ã€Eureka Client å®šæ—¶å…¨é‡æˆ–è€…å¢é‡ä»æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡æ³¨å†Œè¡¨ï¼Œå¹¶ä¸”å°†è·å–åˆ°çš„ä¿¡æ¯ç¼“å­˜åˆ°æœ¬åœ°<br>\n8ã€æœåŠ¡è°ƒç”¨æ—¶ï¼ŒEureka Client ä¼šå…ˆä»æœ¬åœ°ç¼“å­˜æ‰¾å¯»è°ƒå–çš„æœåŠ¡ã€‚å¦‚æœè·å–ä¸åˆ°ï¼Œå…ˆä»æ³¨å†Œä¸­å¿ƒåˆ·æ–°æ³¨å†Œè¡¨ï¼Œå†åŒæ­¥åˆ°æœ¬åœ°ç¼“å­˜<br>\n9ã€Eureka Client è·å–åˆ°ç›®æ ‡æœåŠ¡å™¨ä¿¡æ¯ï¼Œå‘èµ·æœåŠ¡è°ƒç”¨<br>\n10ã€Eureka Client ç¨‹åºå…³é—­æ—¶å‘ Eureka Server å‘é€å–æ¶ˆè¯·æ±‚ï¼ŒEureka Server å°†å®ä¾‹ä»æ³¨å†Œè¡¨ä¸­åˆ é™¤</p>\n<p>9ã€springGateway çš„æ‰§è¡Œæµç¨‹æ’åº<br>\n1ã€æ¥å—è¯·æ±‚<br>\n2ã€å¯»æ‰¾è·¯ç”±è§„åˆ™<br>\n3ã€WEB è¿‡æ»¤å™¨é“¾<br>\n4ã€è¯·æ±‚è½¬å‘<br>\n5ã€æ ¸å¿ƒè¿‡æ»¤å™¨é“¾æ‰§è¡Œ<br>\n6ã€å“åº”å›å†™</p>\n<p>10ã€è¡¥å……æˆ–è€…åˆ é™¤ Redis çš„åŸºæœ¬æ•°æ®ç»“æ„ç±»å‹<br>\n1ã€String<br>\n2ã€Hash<br>\n3ã€ArrayList<br>\n4ã€HashSet<br>\n5ã€zset</p>\n<p>11ã€å…³äº redis ä½¿ç”¨ï¼Œåˆ¤æ–­ä¸‹åˆ—æªæ–½æ˜¯å¦æ­£ç¡®<br>\nMySQL é‡Œæœ‰ 2000w æ•°æ®ï¼Œredis ä¸­åªå­˜ 20w çš„æ•°æ®ï¼Œå¦‚ä½•ä¿è¯ redisä¸­çš„æ•°æ®éƒ½æ˜¯çƒ­ç‚¹æ•°æ®<br>\nä½<br>\næªæ–½:redis å†…å­˜æ•°æ®é›†å¤§å°ä¸Šå‡åˆ°ä¸€å®šå¤§å°çš„æ—¶å€™ï¼Œå°±æ–½è¡Œæ•°æ®æ·˜æ±°ç­–ç•¥ã€‚</p>\n<p>12ã€Redis é€‚åˆçš„åœºæ™¯æ­£ç¡®çš„æœ‰å“ªäº›ï¼Œé”™è¯¯çš„æœ‰å“ªäº›<br>\n(1)ä¼šè¯ç¼“å­˜V<br>\n(2)é˜Ÿåˆ— V<br>\n(3)æ’è¡Œæ¦œ/è®¡æ•°å™¨V<br>\n(4)å‘å¸ƒ/è®¢é˜…</p>\n<p>13ã€MongoDB æ˜¯å¦æ”¯æŒæ•°æ®ç±»å‹ï¼Œå¦‚æœä¸å¯¹è¯·æ ‡è®°å‡ºæ¥<br>\n1ã€String<br>\n2ã€Integer<br>\n3ã€Double<br>\n4ã€Boolean<br>\n5ã€Object<br>\n6ã€Object ID<br>\n7ã€Arrays<br>\n8ã€Min/Max Keys<br>\n9ã€Datetime<br>\n10ã€Code<br>\n11ã€Regular Expression ç­‰</p>\n<p>14ã€è¯·ä¸ºä¸‹åˆ— rabbitmq ç”Ÿäº§è€…å‘é€æ¶ˆæ¯çš„æµç¨‹æ’åº )ï¼Œ<br>\n1ã€ç”Ÿäº§è€…è¿æ¥ RabbitMQï¼Œå»ºç«‹TCP è¿æ¥(Connection)ï¼Œå¼€å¯ä¿¡é“(Channel)<br>\n2ã€ç”Ÿäº§è€…å£°æ˜ä¸€ä¸ª Exchange(äº¤æ¢å™¨)ï¼Œå¹¶è®¾ç½®ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚äº¤æ¢å™¨ç±»å‹ã€æ˜¯å¦æŒä¹…åŒ–ç­‰<br>\n3ã€ç”Ÿäº§è€…å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—äº•è®¾ç½®ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚æ˜¯å¦æ’ä»–ã€æ˜¯å¦æŒä¹…åŒ–ã€æ˜¯å¦è‡ªåŠ¨åˆ é™¤ç­‰<br>\n4ã€ç”Ÿäº§è€…é€šè¿‡ bindingKey(ç»‘å®š Key)å°†äº¤æ¢å™¨å’Œé˜Ÿåˆ—ç»‘å®š(binding)èµ·æ¥<br>\n5ã€ç”Ÿäº§è€…å‘é€æ¶ˆæ¯è‡³ RabbitMQBrokerï¼Œå…¶ä¸­åŒ…å«routingKey(è·¯ç”±é”®)ã€äº¤æ¢å™¨ç­‰ä¿¡æ¯<br>\n6ã€ç›¸åº”çš„äº¤æ¢å™¨æ ¹æ®æ¥æ”¶åˆ°çš„ routingKey æŸ¥æ‰¾ç›¸åŒ¹é…çš„é˜Ÿåˆ—ã€‚<br>\n7ã€å¦‚æœæ‰¾åˆ°ï¼Œåˆ™å°†ä»ç”Ÿäº§è€…å‘é€è¿‡æ¥çš„æ¶ˆæ¯å­˜å…¥ç›¸åº”çš„é˜Ÿåˆ—ä¸­ã€‚<br>\n8ã€å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æ ¹æ®ç”Ÿäº§è€…é…ç½®çš„å±æ€§é€‰æ‹©ä¸¢å¼ƒè¿˜æ˜¯å›é€€ç»™ç”Ÿäº§è€…<br>\n9ã€å…³é—­ä¿¡é“ã€‚<br>\n10ã€å…³é—­è¿æ¥ã€‚</p>\n<p>15ã€è¯·ä¸ºä¸‹åˆ— rabbitmq æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯çš„æµç¨‹æ’åº<br>\n1ã€æ¶ˆè´¹è€…è¿æ¥åˆ° RabbitMQ Broker ï¼Œå»ºç«‹ä¸€ä¸ªè¿æ¥(Connection)ï¼Œå¼€å¯ä¸€ä¸ªä¿¡é“(Channel)ã€‚<br>\n2ã€æ¶ˆè´¹è€…å‘ RabbitMQ Broker è¯·æ±‚æ¶ˆè´¹ç›¸åº”é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯,å¯èƒ½ä¼šè®¾ç½®ç›¸åº”çš„å›è°ƒå‡½æ•°ï¼Œä»¥<br>\nåŠåšä¸€äº›å‡†å¤‡å·¥ä½œ<br>\n3ã€ç­‰å¾… RabbitMQ Broker å›åº”å¹¶æŠ•é€’ç›¸åº”é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œ æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯ã€‚<br>\n4ã€æ¶ˆè´¹è€…ç¡®è®¤(ack) æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚<br>\n5ã€RabbitMQ ä»é˜Ÿåˆ—ä¸­åˆ é™¤ç›¸åº”å·±ç»è¢«ç¡®è®¤çš„æ¶ˆæ¯ã€‚<br>\n6ã€å…³é—­ä¿¡é“ã€‚<br>\n7ã€å…³é—­è¿æ¥ã€‚</p>\n<h1>17. é€»è¾‘é¢˜</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>På…ˆç”Ÿã€Qå…ˆç”Ÿå…·æœ‰è¶³å¤Ÿçš„æ¨ç†èƒ½åŠ›ã€‚ä»–ä»¬çŸ¥é“æ¡Œå­çš„æŠ½å±‰é‡Œæœ‰16å¼ æ‰‘å…‹ç‰Œï¼š\nçº¢æ¡ƒ A Q 4\né»‘æ¡ƒ J 8 4 2 7 3\nè‰èŠ± K Q 5 4 6\næ–¹å— A 5\nçº¦ç€šæ•™æˆä»è¿™16å¼ ç‰Œä¸­æŒ‘å‡ºä¸€å¼ ç‰Œæ¥ï¼Œå¹¶æŠŠè¿™å¼ ç‰Œçš„ç‚¹æ•°å‘Šè¯‰På…ˆç”Ÿï¼ŒæŠŠè¿™å¼ ç‰Œçš„èŠ±è‰²å‘Šè¯‰Qå…ˆç”Ÿã€‚çº¦ç¿°æ•™æˆé—®På…ˆç”Ÿå’ŒQå…ˆç”Ÿï¼šä½ ä»¬èƒ½ä»å·²çŸ¥çš„ç‚¹æ•°æˆ–èŠ±è‰²ä¸­æ¨çŸ¥è¿™å¼ ç‰Œæ˜¯ä»€ä¹ˆç‰Œå—ï¼Ÿ\nPå…ˆç”Ÿï¼š\"æˆ‘ä¸çŸ¥é“è¿™å¼ ç‰Œã€‚\"\nQå…ˆç”Ÿï¼š\"æˆ‘çŸ¥é“ä½ ä¸çŸ¥é“è¿™å¼ ç‰Œã€‚\"\nPå…ˆç”Ÿï¼š\"ç°åœ¨æˆ‘çŸ¥é“è¿™å¼ ç‰Œäº†ã€‚\"\nQå…ˆç”Ÿï¼š\"æˆ‘ä¹ŸçŸ¥é“äº†ã€‚\"\n\nè¯·é—®è¿™å¼ ç‰Œæ˜¯ä»€ä¹ˆç‰Œï¼Ÿ\nç­”æ¡ˆï¼šæ–¹å—5\n\nç¬¬ä¸€å¥è¯è¡¨æ˜ç‚¹æ•°æœ‰é‡å¤\nç¬¬äºŒå¥è¯è¡¨æ˜å¯¹åº”èŠ±è‰²ä¸­å…¨éƒ¨éƒ½æ˜¯æœ‰é‡å¤çš„ç‚¹æ•°ï¼Œæ‰€ä»¥æ˜¯çº¢æ¡ƒæˆ–è€…æ–¹å—\nç¬¬ä¸‰å¥è¯ï¼Œé¦–å…ˆæ’é™¤äº†Aï¼Œå‰©ä¸‹Q, 4ï¼Œ5\nç¬¬å››å¥è¯æ—¢ç„¶çŸ¥é“èŠ±è‰²å°±èƒ½ç¡®å®šåªèƒ½æ˜¯æ–¹å—5äº†\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æœ‰ç”²ã€ä¹™ã€ä¸™ä¸‰ä¸ªå­¦ç”Ÿï¼Œä¸€ä¸ªå‡ºç”Ÿåœ¨åŒ—äº¬ï¼Œä¸€ä¸ªå‡ºç”Ÿåœ¨ä¸Šæµ·ï¼Œä¸€ä¸ªå‡ºç”Ÿåœ¨æ­¦æ±‰ï¼›ä»–ä»¬ä¸­ä¸€ä¸ªå­¦å›½é™…é‡‘èä¸“ä¸šï¼Œä¸€ä¸ªå­¦å·¥å•†ç®¡ç†ä¸“ä¸šï¼Œä¸€ä¸ªå­¦å¤–è¯­ã€‚å…¶ä¸­ï¼šI.ç”²ä¸æ˜¯å­¦å›½é™…é‡‘èçš„ï¼Œä¹™ä¸æ˜¯å­¦å¤–è¯­çš„ã€‚IIï¼å­¦å›½é™…é‡‘èçš„ä¸å‡ºç”Ÿåœ¨ä¸Šæµ·ã€‚IIIï¼å­¦å¤–è¯­çš„å‡ºç”Ÿåœ¨åŒ—äº¬ã€‚IVï¼ä¹™ä¸å‡ºç”Ÿåœ¨æ­¦æ±‰ã€‚è¯·æ ¹æ®ä¸Šè¿°æ¡ä»¶ï¼Œåˆ¤æ–­ç”²çš„ä¸“ä¸šï¼›ï¼ˆï¼‰ Aï¼å›½é™…é‡‘èBï¼å·¥å•†ç®¡ç†Cï¼å¤–è¯­Dï¼ä¸‰ç§ä¸“ä¸šéƒ½å¯èƒ½\n\nç­”æ¡ˆï¼š C\n</code></pre></div><h2>16.4. è®¡ç®—nçš„é˜¶ä¹˜çš„æœ«å°¾æœ‰å‡ ä¸ª0âˆš</h2>\n<p>åœ¨çº¿è®¡ç®—é˜¶ä¹˜çš„åœ°å€<a href=\"http://www.99cankao.com/statistics/factorial-calculator.php\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.99cankao.com/statistics/factorial-calculator.php</a><br>\nå°¾éƒ¨çš„0ä¸€å…±æœ‰å¤šå°‘ä¸ªï¼Œå°±è¦çœ‹è¿™ä¸ªæ•°åŒ…å«å¤šå°‘ä¸ª5çš„å› å­</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public static int SelectZero(int n){\n    int count=0;\n    while(n!=0){\n        count+=n/5;\n        n=n/5;\n    }\n    return count;\n}\n</code></pre></div><h2>16.3. 1äº¿ä¸ªintç±»å‹æ•°å­—ï¼Œå¦‚ä½•æ‰¾å‡ºé‡å¤æ•°å­—ï¼Ÿâˆš</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Test{\n    public static void main(String[] args){\n        long time=new Date().getTime();\n        int[] arr=new int[100000000];//1äº¿é•¿åº¦\n        for(int i=0;i&lt;arr.length;i++){\n            arr[i]=i+1;\n        }\n        arr[99999999]=2020;\n        int min=arr[0];\n        int max=arr[0];\n        for(int i=0;i&lt;arr.length;i++){\n            if(arr[i]&lt;min)\n                min=arr[i];\n            if(arr[i]&gt;max)\n                max=arr[i];\n        }\n        byte[] bucket=new byte[(max-min)/8+1];\n        for(int i=0;i&lt;arr.length;i++){\n            int num=arr[i];\n            int j=(num-min)/8;\n            int k=(num-min)%8;\n            if(((bucket[j]&gt;&gt;k)&amp;1)&gt;0){//é‡å¤äº†\n                System.out.println(\"Number of repeatsï¼š\"+num);\n                break;\n            }else{\n               bucket[j]|=(1&lt;&lt;k);\n            }\n        }\n        long time2=new Date().getTime();\n        System.out.println(\"millisecond:\"+(time2-time));\n    }\n}\n</code></pre></div><h2>13.7. æ±‚ä»¥ä¸‹è¡¨è¾¾å¼1-2+3-4+...+mçš„å€¼ï¼Œå†™å‡ºæ‚¨æƒ³åˆ°çš„ä¸€ç§æˆ–å‡ ç§å®ç°æ–¹æ³•</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public int fun(int m){\n\tint sum=0;\n\tfor(int i=1;i&lt;m+1;i++){\n\t\tif(i%2==0){\n\t\t\tsum=sum-i;\n\t\t}else{\n\t\t\tsum=sum+i;\n\t\t}\n\t}\n\treturn sum;\n}\n</code></pre></div><h1>æŸ¥çœ‹åç¼–è¯‘ä»£ç </h1>\n<ul>\n<li>C:\\Java\\jdk-11.0.8\\bin\\serveræ”¾å…¥hsdis-amd64.dll</li>\n<li>ideaè¿è¡Œæ·»åŠ vmå‚æ•°</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>-server\n-Xcomp\n-XX:+UnlockDiagnosticVMOptions\n-XX:+PrintAssembly\n-XX:CompileCommand=compileonly,*MyTest.fun\n</code></pre></div><p>cd /opt/banzhutest &amp;&amp; sh <a href=\"http://stop.sh\" target=\"_blank\" rel=\"noopener noreferrer\">stop.sh</a> &amp;&amp; cd admin &amp;&amp; sh <a href=\"http://stop.sh\" target=\"_blank\" rel=\"noopener noreferrer\">stop.sh</a> &amp;&amp; cd &amp;&amp; cd code/banzhunewserver &amp;&amp; git pull &amp;&amp; mvn clean package -Ptest &amp;&amp; cp banzhu-api/target/testbanzhu.jar /opt/banzhutest/testbanzhu.jar &amp;&amp; cp banzhu-admin/target/admintestbanzhu.jar /opt/banzhutest/admin/admintestbanzhu.jar &amp;&amp; cd /opt/banzhutest &amp;&amp; sh <a href=\"http://start.sh\" target=\"_blank\" rel=\"noopener noreferrer\">start.sh</a> &amp;&amp; cd admin &amp;&amp; sh <a href=\"http://start.sh\" target=\"_blank\" rel=\"noopener noreferrer\">start.sh</a> &amp;</p>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/f4fe8a438b4fca2f17b6b.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "javaåŸºç¡€",
      "url": "https://javaguide.cn/interview/javabasics.html",
      "id": "https://javaguide.cn/interview/javabasics.html",
      "summary": "javaåŸºç¡€ 1. ä»€ä¹ˆæ˜¯ Javaï¼Ÿç‰¹ç‚¹ï¼Ÿ Java æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€ é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼Œè·¨å¹³å°(ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ) 2. JVMã€JDKã€JREåŒºåˆ« JVMï¼šJava Virtual Machineï¼ŒJava è™šæ‹Ÿæœºï¼ŒJava ç¨‹åºè¿è¡Œåœ¨ Java è™šæ‹Ÿæœºä¸Šã€‚é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„å®ç°ï¼ˆWindowsï¼ŒLinuxï¼ŒmacOSï¼‰ä¸åŒçš„ ...",
      "content_html": "<p>javaåŸºç¡€</p>\n<!--more-->\n<h1>1. ä»€ä¹ˆæ˜¯ Javaï¼Ÿç‰¹ç‚¹ï¼Ÿ</h1>\n<ul>\n<li>Java æ˜¯ä¸€é—¨é¢å‘å¯¹è±¡çš„ç¼–ç¨‹è¯­è¨€</li>\n<li>é¢å‘å¯¹è±¡ï¼ˆå°è£…ï¼Œç»§æ‰¿ï¼Œå¤šæ€ï¼‰ï¼Œè·¨å¹³å°(ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ)</li>\n</ul>\n<h1>2. JVMã€JDKã€JREåŒºåˆ«</h1>\n<ul>\n<li>JVMï¼šJava Virtual Machineï¼ŒJava è™šæ‹Ÿæœºï¼ŒJava ç¨‹åºè¿è¡Œåœ¨ Java è™šæ‹Ÿæœºä¸Šã€‚é’ˆå¯¹ä¸åŒç³»ç»Ÿçš„å®ç°ï¼ˆWindowsï¼ŒLinuxï¼ŒmacOSï¼‰ä¸åŒçš„ JVMï¼Œå› æ­¤ Java è¯­è¨€å¯ä»¥å®ç°è·¨å¹³å°ã€‚</li>\n<li>JREï¼š Java è¿â¾æ—¶ç¯å¢ƒã€‚åŒ…æ‹¬ Java è™šæ‹Ÿæœºï¼ˆJVMï¼‰å’ŒJava ç±»åº“</li>\n<li>JDK: Java Development Kitï¼Œå®ƒæ˜¯åŠŸèƒ½â»¬å…¨çš„ Java SDKï¼ˆè½¯ä»¶å¼€å‘å·¥å…·åŒ…ï¼‰ã€‚åŒ…æ‹¬äº† JRE ä»¥åŠç¼–è¯‘å™¨ï¼ˆjavacï¼‰ã€Java æ–‡æ¡£ç”Ÿæˆå·¥å…·ï¼ˆJavadocï¼‰ã€Java è°ƒè¯•å™¨ç­‰å¼€å‘å·¥å…·ã€‚ä¸ºå¼€å‘è€…æä¾›äº†å¼€å‘ã€ç¼–è¯‘ã€è°ƒè¯• Java ç¨‹åºçš„ä¸€æ•´å¥—ç¯å¢ƒã€‚</li>\n<li>JDK åŒ…å« JREï¼ŒJRE åŒ…å« JVMã€‚</li>\n</ul>\n<h1>3. javaè·¨å¹³å°å®ç°åŸç†</h1>\n<ul>\n<li>è·¨å¹³å°æ€§ï¼Œæ˜¯æŒ‡Javaè¯­è¨€ç¼–å†™çš„ç¨‹åºï¼Œä¸€æ¬¡ç¼–è¯‘åï¼Œå¯ä»¥åœ¨å¤šä¸ªç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œã€‚</li>\n<li>å®ç°åŸç†ï¼šJavaç¨‹åºæ˜¯é€šè¿‡Javaè™šæ‹Ÿæœºåœ¨ç³»ç»Ÿå¹³å°ä¸Šè¿è¡Œçš„ï¼Œåªè¦è¯¥ç³»ç»Ÿå¯ä»¥å®‰è£…ç›¸åº”çš„ Java è™šæ‹Ÿæœºå°±å¯ä»¥è¿è¡Œ java ç¨‹åº</li>\n</ul>\n<h1>4. javaæ•°æ®ç±»å‹æœ‰å“ªäº›?</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">åŸºæœ¬æ•°æ®ç±»å‹</th>\n<th style=\"text-align:center\">å…«ç§</th>\n<th style=\"text-align:center\">å­—èŠ‚æ•°</th>\n<th style=\"text-align:center\">æ•°æ®è¡¨ç¤ºèŒƒå›´</th>\n<th style=\"text-align:center\">é»˜è®¤å€¼</th>\n<th style=\"text-align:center\">åŒ…è£…ç±»</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">æ•´å‹</td>\n<td style=\"text-align:center\">byte</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">-2^7^-1,2^7^-1</td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">Byte</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">short</td>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">-2^15^,2^15^-1</td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">Short</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">-2^31,2^31-1 <strong>é»˜è®¤æ˜¯int</strong></td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">Integer</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">long</td>\n<td style=\"text-align:center\">8</td>\n<td style=\"text-align:center\">-2^63^,2^63^-1 +L</td>\n<td style=\"text-align:center\">0</td>\n<td style=\"text-align:center\">Long</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æµ®ç‚¹å‹</td>\n<td style=\"text-align:center\">float</td>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">-3.403E38ï½3.403E38 Eç§‘å­¦è®¡æ•°10^38 128-127æ¬¡æ–¹+F 1ä½ç¬¦å·ä½ï¼Œ8ä½æŒ‡æ•°ä½(åç§»é‡127ï¼Œå®é™…å€¼åº”è¯¥å‡å»127)ï¼Œ23ä½å°¾æ•°ä½ï¼Œ7ä½æœ‰æ•ˆæ•°å­—</td>\n<td style=\"text-align:center\">0.0f</td>\n<td style=\"text-align:center\">Float</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">double</td>\n<td style=\"text-align:center\">8</td>\n<td style=\"text-align:center\">-1.798E308ï½1.798E308 Eç§‘å­¦è®¡æ•°10^308 1024-1023æ¬¡æ–¹+D 1ä½ç¬¦å·ä½ï¼Œ11ä½æŒ‡æ•°ä½ï¼Œ52ä½å°¾æ•°ä½ï¼Œ16ä½æœ‰æ•ˆæ•°å­—ï¼Œ<strong>é»˜è®¤æ˜¯åŒç²¾åº¦</strong></td>\n<td style=\"text-align:center\">0.0d</td>\n<td style=\"text-align:center\">Double</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¸ƒå°”å‹</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">trueã€false</td>\n<td style=\"text-align:center\">false</td>\n<td style=\"text-align:center\">Boolean</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å­—ç¬¦å‹</td>\n<td style=\"text-align:center\">char</td>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">''åŒ…è£¹ï¼ŒåªåŒ…å«ä¸€å­—ç¬¦ï¼Œè¿ç®—æŒ‰ASCIIç å¯¹åº”çš„æ•´æ•°è¿ç®—</td>\n<td style=\"text-align:center\">''</td>\n<td style=\"text-align:center\">Character</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¼•ç”¨æ•°æ®ç±»å‹</td>\n<td style=\"text-align:center\">æ•°ç»„ã€ç±»ã€æ¥å£</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Stringæ˜¯å¯¹è±¡</td>\n<td style=\"text-align:center\">null</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<h1>5. charèƒ½ä¸èƒ½å­˜ä¸€ä¸ªä¸­æ–‡æ±‰å­—?</h1>\n<ul>\n<li>Javaä¸­æ— è®ºæ±‰å­—è¿˜æ˜¯è‹±æ–‡å­—æ¯éƒ½ç”¨Unicodeç¼–ç ï¼ˆ2å­—èŠ‚ï¼‰è¡¨ç¤ºã€‚charç±»å‹å 2ä¸ªå­—èŠ‚ã€‚æ‰€ä»¥å¯ä»¥å­˜å‚¨ä¸€ä¸ªä¸­æ–‡æ±‰å­—</li>\n</ul>\n<h1>6. å­˜åœ¨æ•°å­—iåŠ 1å°äºiæˆ–è€…iå‡1å°äºi?âˆš</h1>\n<ul>\n<li>æ•´å‹ç±»å‹æ˜¯æœ‰èŒƒå›´çš„ï¼Œå¦‚æœå‘ç”Ÿè¶Šç•Œï¼Œé‚£ä¹ˆå°†å‡ºç°è¯¥æƒ…å†µ</li>\n</ul>\n<h1>7. ä»€ä¹ˆæ˜¯è‡ªåŠ¨ç±»å‹è½¬æ¢ä¸å¼ºåˆ¶ç±»å‹è½¬æ¢?</h1>\n<ul>\n<li>Javaæ‰€æœ‰çš„æ•°å€¼å‹å˜é‡å¯ä»¥ç›¸äº’è½¬æ¢ï¼Œå½“æŠŠä¸€ä¸ªè¡¨æ•°èŒƒå›´å°çš„æ•°å€¼æˆ–å˜é‡ç›´æ¥èµ‹ç»™å¦ä¸€ä¸ªè¡¨æ•°èŒƒå›´å¤§çš„å˜é‡æ—¶ï¼Œå¯ä»¥è¿›è¡Œè‡ªåŠ¨ç±»å‹è½¬æ¢ï¼›åä¹‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ã€‚</li>\n<li>æ•°æ®ç±»å‹æ•°æ®èŒƒå›´ä»å°åˆ°å¤§ï¼šbyte -&gt; short -&gt; int -&gt; long -&gt; float -&gt; double</li>\n<li>float f=3.4ï¼ˆÃ—ï¼‰3.4 æ˜¯åŒç²¾åº¦æ•°ã€‚éœ€è¦å¼ºåˆ¶ç±»å‹è½¬æ¢float f =(float)3.4;æˆ–è€…å†™æˆfloat f =3.4F</li>\n<li>short s1 = 1; s1 = s1 + 1; ç¼–è¯‘å‡ºé”™ï¼Œç”±äº1æ˜¯intç±»å‹ï¼Œå› æ­¤s1+1è¿ç®—ç»“æœä¹Ÿæ˜¯intå‹ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ç±»å‹æ‰èƒ½èµ‹å€¼ç»™short</li>\n<li>short s1 = 1; s1 += 1;ç¼–è¯‘æ­£ç¡®ï¼Œå› ä¸ºs1+= 1ç›¸å½“äºs1 = short(s1 + 1);æœ‰éšå«å¼ºåˆ¶ç±»å‹è½¬æ¢ã€‚</li>\n</ul>\n<h1>8. è‡ªåŠ¨è£…æ‹†ç®±å’Œè®¾è®¡ç†ç”±ï¼Ÿ</h1>\n<ul>\n<li>è‡ªåŠ¨è£…ç®±æ˜¯Javaç¼–è¯‘å™¨åœ¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¯¹åº”çš„åŒ…è£…ç±»ä¹‹é—´åšè½¬åŒ–ã€‚æ¯”å¦‚ï¼šæŠŠintè½¬åŒ–æˆIntegerã€‚åä¹‹å°±æ˜¯è‡ªåŠ¨æ‹†ç®±ã€‚</li>\n<li>ä¸ºäº†ç®€åŒ–ä»£ç ï¼Œå› ä¸ºjdk1.5éœ€è¦æ‰‹å†™ä»£ç æ‰èƒ½å®ŒæˆåŸºæœ¬æ•°æ®ç±»å‹è½¬æˆåŒ…è£…ç±»æ”¾å…¥é›†åˆä¸­</li>\n</ul>\n<h1>9. &amp;&amp;è¿ç®—ç¬¦å’Œ&amp;è¿ç®—ç¬¦åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>éƒ½æ˜¯è¡¨ç¤ºä¸çš„é€»è¾‘è¿ç®—ç¬¦andï¼Œå½“ä¸¤è¾¹çš„è¡¨è¾¾å¼éƒ½ä¸ºtrueï¼Œç»“æœæ‰ä¸ºtrue</li>\n<li>&amp;&amp;ï¼šæœ‰çŸ­è·¯åŠŸèƒ½ï¼Œå½“ç¬¬ä¸€ä¸ªè¡¨è¾¾å¼çš„å€¼ä¸ºfalseçš„æ—¶å€™ï¼Œåˆ™ä¸å†è®¡ç®—ç¬¬äºŒä¸ªè¡¨è¾¾å¼ï¼›</li>\n<li>&amp;ï¼š2ä¸ªè¡¨è¾¾å¼éƒ½ä¼šæ‰§è¡Œã€‚å½“ä¸¤è¾¹çš„è¡¨è¾¾å¼ä¸æ˜¯Booleanç±»å‹åˆ™è¡¨ç¤ºæŒ‰ä½æ“ä½œ</li>\n</ul>\n<h1>10. switchè¡¨è¾¾å¼çš„å€¼ï¼Ÿ</h1>\n<ul>\n<li>byteã€shortã€intã€charã€enumæšä¸¾ã€String</li>\n</ul>\n<h1>11. break,continue,returnåŒºåˆ«åŠä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>breakè·³å‡ºæ•´ä¸ªå¾ªç¯ï¼Œä¸å†æ‰§è¡Œå¾ªç¯</li>\n<li>continueè·³å‡ºæœ¬æ¬¡å¾ªç¯ï¼Œç»§ç»­æ‰§è¡Œä¸‹æ¬¡å¾ªç¯</li>\n<li>returnç»“æŸå½“å‰çš„æ–¹æ³• ç›´æ¥è¿”å›</li>\n</ul>\n<h1>12. ç”¨æœ€æœ‰æ•ˆç‡çš„æ–¹æ³•è®¡ç®—2ä¹˜ä»¥8ï¼Ÿ</h1>\n<ul>\n<li>2&lt;&lt;3ã€‚ä½è¿ç®—ï¼ŒäºŒè¿›åˆ¶ä½å·¦ç§»ä¸‰ä½ç›¸å½“äºä¹˜ä»¥2çš„ä¸‰æ¬¡æ–¹ã€‚</li>\n</ul>\n<h1>13. è‡ªå¢è‡ªå‡è¿ç®—ç›¸å…³é—®é¢˜</h1>\n<ul>\n<li>å½“è¿ç®—ç¬¦æ”¾åœ¨å˜é‡ä¹‹å‰æ—¶(å‰ç¼€)ï¼Œå…ˆè‡ªå¢/å‡ï¼Œå†èµ‹å€¼ï¼›å½“è¿ç®—ç¬¦æ”¾åœ¨å˜é‡ä¹‹åæ—¶(åç¼€)ï¼Œå…ˆèµ‹å€¼ï¼Œå†è‡ªå¢/å‡ã€‚</li>\n<li>i=i++ç»“æœiä¸å˜ï¼Œå› ä¸ºJVMå¯¹è‡ªå¢è¿ç®—ä¼šå®šä¹‰ä¸€ä¸ªä¸´æ—¶å˜é‡æ¥æ¥æ”¶iå€¼ï¼Œç„¶åè¿›è¡Œè‡ªå¢ï¼Œç­‰ä»·äºint temp = i;i++;i = temp;</li>\n</ul>\n<h1>14. Java ä¸­çš„ Math.round(-1.5) ç­‰äºå¤šå°‘ï¼Ÿ</h1>\n<ul>\n<li>roundè¡¨ç¤º'å››èˆäº”å…¥'ï¼Œç®—æ³•ä¸ºMath.floor(x+0.5)å³åŠ 0.5åå†å‘ä¸‹å–æ•´ï¼Œæ‰€ä»¥Math.round(1.5)=2ï¼ŒMath.round(-1.5)=-1</li>\n</ul>\n<h1>15. é¢å‘å¯¹è±¡OOPå’Œé¢å‘è¿‡ç¨‹OPPåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>é¢å‘å¯¹è±¡ï¼Œå®ƒå°†ç°å®ä¸–ç•Œä¸­çš„äº‹ç‰©æŠ½è±¡æˆå¯¹è±¡ï¼Œå¹¶é€šè¿‡ç±»å’Œå¯¹è±¡çš„æ¦‚å¿µæ¥æ¨¡æ‹ŸçœŸå®ä¸–ç•Œä¸­çš„å„ç§å…³ç³»å’Œæ“ä½œã€‚</li>\n<li>é¢å‘è¿‡ç¨‹ï¼Œåˆ†æå‡ºè§£å†³é—®é¢˜æ‰€éœ€è¦çš„æ­¥éª¤ï¼Œç„¶åç”¨å‡½æ•°æŠŠè¿™äº›æ­¥éª¤ä¸€æ­¥ä¸€æ­¥å®ç°ï¼Œä½¿ç”¨çš„æ—¶å€™å†ä¸€ä¸ªä¸€ä¸ªçš„ä¸€æ¬¡è°ƒç”¨å°±å¯ä»¥</li>\n<li>åŒºåˆ«\n<ul>\n<li>å…³æ³¨ç‚¹ä¸åŒ:é¢å‘å¯¹è±¡å…³æ³¨ç°å®ä¸–ç•Œä¸­çš„å¯¹è±¡åŠå…¶å…³ç³»ï¼Œè€Œé¢å‘è¿‡ç¨‹å…³æ³¨è§£å†³é—®é¢˜çš„æ­¥éª¤å’Œè¿‡ç¨‹ã€‚</li>\n<li>æ•°æ®å’Œå‡½æ•°çš„å…³ç³»ä¸åŒ:åœ¨é¢å‘å¯¹è±¡ä¸­ï¼Œæ•°æ®å’Œæ“ä½œæ•°æ®çš„æ–¹æ³•è¢«å°è£…åœ¨å¯¹è±¡ä¸­ï¼Œè€Œåœ¨é¢å‘è¿‡ç¨‹ä¸­ï¼Œæ•°æ®å’Œå‡½æ•°æ˜¯åˆ†ç¦»çš„</li>\n<li>ä»£ç ç»„ç»‡æ–¹å¼ä¸åŒ:é¢å‘å¯¹è±¡é€šè¿‡ç±»å’Œå¯¹è±¡æ¥ç»„ç»‡ä»£ç ï¼Œå…·æœ‰æ›´å¥½çš„æ¨¡å—åŒ–å’Œå¯é‡ç”¨æ€§;è€Œé¢å‘è¿‡ç¨‹é€šå¸¸æŒ‰ç…§åŠŸèƒ½æˆ–æ­¥éª¤æ¥ç»„ç»‡ä»£ç ï¼Œå¯èƒ½å¯¼è‡´ä»£ç ç»“æ„æ··ä¹±</li>\n<li>æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§ä¸åŒ:é¢å‘å¯¹è±¡é€šè¿‡å°è£…ã€ç»§æ‰¿å’Œå¤šæ€ç­‰ç‰¹æ€§æé«˜äº†ä»£ç çš„æ‰©å±•æ€§å’Œå¯ç»´æŠ¤æ€§;è€Œé¢å‘è¿‡ç¨‹åœ¨è¿™æ–¹é¢è¡¨ç°ç›¸å¯¹è¾ƒå·®</li>\n</ul>\n</li>\n</ul>\n<h1>16. é¢å‘å¯¹è±¡æœ‰å“ªäº›ç‰¹æ€§ï¼Ÿ</h1>\n<ul>\n<li>å°è£…ï¼šæŠŠå¯¹è±¡çš„å±æ€§ç§æœ‰åŒ–ï¼ŒåŒæ—¶æä¾›å¯ä»¥è¢«å¤–ç•Œè®¿é—®çš„å±æ€§çš„æ–¹æ³•.ä»£ç å¤ç”¨ã€å®‰å…¨æ€§é«˜</li>\n<li>ç»§æ‰¿: ä»¥å·²å­˜åœ¨çš„ç±»çš„å®šä¹‰ä½œä¸ºåŸºç¡€å»ºç«‹æ–°ç±»ã€‚æ–°ç±»çš„å®šä¹‰å¯ä»¥å¢åŠ æ–°çš„å±æ€§æˆ–æ–°çš„æ–¹æ³•ï¼Œä¹Ÿå¯ä»¥ç»§æ‰¿çˆ¶ç±»çš„å±æ€§å’Œæ–¹æ³•ã€‚é€šè¿‡ç»§æ‰¿å¯ä»¥å¾ˆæ–¹ä¾¿åœ°è¿›è¡Œä»£ç å¤ç”¨ï¼Œæ‰©å±•æ€§å¼ºï¼Œä½†è€¦åˆåº¦å¢å¼º\n<ul>\n<li>ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç±»ï¼Œæ‰€æœ‰çš„ç±»éƒ½ç›´æ¥æˆ–è€…é—´æ¥çš„ç»§æ‰¿äº†Objectç±»</li>\n<li>å­ç±»è‡ªåŠ¨æ‹¥æœ‰çˆ¶ç±»æ‰€æœ‰æœ‰å±æ€§å’Œæ–¹æ³•,ä½†åªèƒ½è®¿é—®çˆ¶ç±»éç§æœ‰å±æ€§å’Œæ–¹æ³•</li>\n<li>é»˜è®¤è®¿é—®å­ç±»çš„[åŒå]æˆå‘˜å˜é‡/æ–¹æ³•ï¼Œä¸å­˜åœ¨åˆ™è®¿é—®çˆ¶ç±»éç§æœ‰[åŒå]æˆå‘˜å˜é‡/æ–¹æ³•ã€‚å³ä½¿åœ¨çˆ¶ç±»æ„é€ æ–¹æ³•ä¸­è°ƒç”¨ä¹Ÿèƒ½è‡ªåŠ¨è°ƒå­ç±»æ–¹æ³•</li>\n</ul>\n</li>\n<li>å¤šæ€ï¼šæŒ‡ç¨‹åºä¸­å®šä¹‰çš„å¼•â½¤å˜é‡æ‰€æŒ‡å‘çš„å…·ä½“ç±»å‹å’Œé€šè¿‡è¯¥å¼•â½¤å˜é‡è°ƒç”¨çš„â½…æ³•åœ¨ç¼–ç¨‹æ—¶å¹¶ä¸ç¡®å®šï¼Œâ½½æ˜¯åœ¨ç¨‹åºè¿â¾æœŸé—´æ‰ç¡®å®šï¼Œå³â¼€ä¸ªå¼•â½¤å˜é‡åˆ°åº•ä¼šæŒ‡å‘å“ªä¸ªç±»çš„å®ä¾‹å¯¹è±¡ï¼Œè¯¥å¼•â½¤å˜é‡å‘å‡ºçš„â½…æ³•è°ƒâ½¤åˆ°åº•æ˜¯å“ªä¸ªç±»ä¸­å®ç°çš„â½…æ³•ï¼Œå¿…é¡»åœ¨ç”±ç¨‹åºè¿â¾æœŸé—´æ‰èƒ½å†³å®šã€‚å®ç°æ–¹å¼ï¼šå­ç±»ç»§æ‰¿çˆ¶ç±»ã€å­ç±»é‡å†™çˆ¶ç±»çš„æ–¹æ³•ã€çˆ¶ç±»å¼•ç”¨æŒ‡å‘å­ç±»çš„å¯¹è±¡æˆ–è€…ç±»å®ç°æ¥å£ã€ç±»å®ç°æ¥å£çš„æ–¹æ³•ï¼Œç±»å¼•ç”¨æŒ‡å‘æ¥å£</li>\n</ul>\n<h1>17. é‡è½½å’Œé‡å†™åŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>æ–¹æ³•é‡è½½overload:<strong>åŒä¸€ä¸ªç±»</strong>ä¸­å¤šä¸ªåç§°ç›¸åŒã€å‚æ•°ç±»å‹æˆ–ä¸ªæ•°æˆ–é¡ºåºä¸åŒçš„æ–¹æ³•</li>\n<li>æ–¹æ³•é‡å†™override:<strong>çˆ¶å­ç±»</strong>ä¸­æ–¹æ³•åã€å‚æ•°åˆ—è¡¨ã€è¿”å›å€¼ç›¸åŒã€ä½†æ–¹æ³•ä½“ä¸åŒçš„æ–¹æ³•\n<ul>\n<li>è¿”å›å€¼ã€å¼‚å¸¸å°äºç­‰äºï¼Œå°‘äºç­‰äºçˆ¶ç±»</li>\n<li>è®¿é—®ä¿®é¥°ç¬¦å¤§äºç­‰äºçˆ¶ç±»</li>\n<li>staticæ–¹æ³•ï¼Œfinalæ–¹æ³•ï¼Œprivateæ–¹æ³•ï¼Œæ„é€ å™¨Constructorä¸èƒ½è¢«ç»§æ‰¿ï¼Œå› æ­¤ä¸èƒ½é‡å†™Override</li>\n</ul>\n</li>\n</ul>\n<h1>18. privateï¼Œdefaultï¼Œprotectedï¼Œpublicè®¿é—®æ§åˆ¶ç¬¦èŒƒå›´</h1>\n<ul>\n<li>privateæœ¬ç±»ï¼ŒdefaultåŒåŒ…ã€protectedåŒåŒ…åŠå…¶å­ç±»ï¼Œpublicæ‰€æœ‰</li>\n</ul>\n<h1>19. thiså…³é”®å­—æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>thisä»£è¡¨å¯¹è±¡æœ¬èº«</li>\n<li>ä½œç”¨ï¼š\n<ul>\n<li>å¯¹è±¡æœ¬èº«çš„å¼•ç”¨</li>\n<li>åŒºåˆ†é‡åçš„å½¢å‚å’Œæˆå‘˜å˜é‡</li>\n<li>å¼•ç”¨æœ¬ç±»æ„é€ å‡½æ•°</li>\n</ul>\n</li>\n</ul>\n<h1>20. æŠ½è±¡ç±»å’Œæ¥å£æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿå¦‚ä½•é€‰ç”¨ï¼Ÿâˆš</h1>\n<ul>\n<li>ç›¸åŒç‚¹\n<ul>\n<li>éƒ½å¯ä»¥åŒ…å«æŠ½è±¡æ–¹æ³•</li>\n<li>éƒ½ä¸èƒ½ç›´æ¥å®ä¾‹åŒ–å¯¹è±¡;ç›´åˆ°æŠ½è±¡æ–¹æ³•éƒ½è¦†ç›–å®Œäº†æ‰å¯ä»¥åˆ›å»ºå¯¹è±¡</li>\n</ul>\n</li>\n<li>ä¸åŒç‚¹\n<ul>\n<li>ä¸€ä¸ªç±»åªèƒ½ç»§æ‰¿ä¸€ä¸ªç›´æ¥çˆ¶ç±»(å¯èƒ½æ˜¯æŠ½è±¡ç±»),å´å¯ä»¥å®ç°å¤šä¸ªæ¥å£;(æ¥å£å¼¥è¡¥äº†å•ç»§æ‰¿)</li>\n<li>æŠ½è±¡ç±»å¯ä»¥å®šä¹‰æ„é€ å‡½æ•°;æ¥å£ä¸èƒ½</li>\n<li>æŠ½è±¡ç±»å¯ä»¥åŒ…å«å…·ä½“æ–¹æ³•;æ¥å£åœ¨jdk8æ‰æœ‰é»˜è®¤æ–¹æ³•</li>\n<li>æŠ½è±¡ç±»å¯ä»¥åŒ…å«ç§æœ‰æ–¹æ³•ï¼Œæ¥å£åœ¨jdk9æ‰æœ‰</li>\n</ul>\n</li>\n<li>äºŒè€…çš„é€‰ç”¨\n<ul>\n<li>ä¼˜å…ˆé€‰ç”¨æ¥å£,å°½é‡å°‘ç”¨æŠ½è±¡ç±»</li>\n<li>éœ€è¦å®šä¹‰å­ç±»çš„è¡Œä¸º,åˆè¦ä¸ºå­ç±»æä¾›å…±æ€§åŠŸèƒ½æ—¶æ‰é€‰ç”¨æŠ½è±¡ç±»</li>\n</ul>\n</li>\n</ul>\n<h1>21. æˆå‘˜å˜é‡ä¸å±€éƒ¨å˜é‡çš„åŒºåˆ«æœ‰å“ªäº›ï¼Ÿ</h1>\n<ul>\n<li>ä»è¯­æ³•å½¢å¼ä¸Šçœ‹ï¼šæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œâ½½å±€éƒ¨å˜é‡æ˜¯åœ¨â½…æ³•ä¸­å®šä¹‰çš„å˜é‡æˆ–æ˜¯â½…æ³•çš„å‚æ•°ï¼›æˆå‘˜å˜é‡å¯ä»¥è¢« public , private , static ç­‰ä¿®é¥°ç¬¦æ‰€ä¿®é¥°ï¼Œâ½½å±€éƒ¨å˜é‡ä¸èƒ½è¢«è®¿é—®æ§åˆ¶ä¿®é¥°ç¬¦åŠ static æ‰€ä¿®é¥°ï¼›ä½†æ˜¯ï¼Œæˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡éƒ½èƒ½è¢« final æ‰€ä¿®é¥°ã€‚</li>\n<li>ä»å˜é‡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨â½…å¼æ¥çœ‹ï¼šå¦‚æœæˆå‘˜å˜é‡æ˜¯ä½¿â½¤ static ä¿®é¥°çš„ï¼Œé‚£ä¹ˆè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºç±»çš„ï¼Œå¦‚æœæ²¡æœ‰ä½¿â½¤ static ä¿®é¥°ï¼Œè¿™ä¸ªæˆå‘˜å˜é‡æ˜¯å±äºå®ä¾‹çš„ã€‚å¯¹è±¡å­˜äºå †å†…å­˜ï¼Œå¦‚æœå±€éƒ¨å˜é‡ç±»å‹ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼Œé‚£ä¹ˆå­˜å‚¨åœ¨æ ˆå†…å­˜ï¼Œå¦‚æœä¸ºå¼•â½¤æ•°æ®ç±»å‹ï¼Œé‚£å­˜æ”¾çš„æ˜¯æŒ‡å‘å †å†…å­˜å¯¹è±¡çš„å¼•â½¤æˆ–è€…æ˜¯æŒ‡å‘å¸¸é‡æ± ä¸­çš„åœ°å€ã€‚</li>\n<li>ä»å˜é‡åœ¨å†…å­˜ä¸­çš„â½£å­˜æ—¶é—´ä¸Šçœ‹ï¼šæˆå‘˜å˜é‡æ˜¯å¯¹è±¡çš„â¼€éƒ¨åˆ†ï¼Œå®ƒéšç€å¯¹è±¡çš„åˆ›å»ºâ½½å­˜åœ¨ï¼Œâ½½å±€éƒ¨å˜é‡éšç€â½…æ³•çš„è°ƒâ½¤â½½â¾ƒåŠ¨æ¶ˆå¤±ã€‚</li>\n<li>æˆå‘˜å˜é‡å¦‚æœæ²¡æœ‰è¢«èµ‹åˆå€¼ï¼šåˆ™ä¼šâ¾ƒåŠ¨ä»¥ç±»å‹çš„é»˜è®¤å€¼â½½èµ‹å€¼ï¼ˆâ¼€ç§æƒ…å†µä¾‹å¤–:è¢« final ä¿®é¥°çš„æˆå‘˜å˜é‡ä¹Ÿå¿…é¡»æ˜¾å¼åœ°èµ‹å€¼ï¼‰ï¼Œâ½½å±€éƒ¨å˜é‡åˆ™ä¸ä¼šâ¾ƒåŠ¨èµ‹å€¼ã€‚</li>\n</ul>\n<h1>22. é™æ€å˜é‡å’Œå®ä¾‹å˜é‡çš„åŒºåˆ«ï¼Ÿé™æ€æ–¹æ³•å’Œå®ä¾‹æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>é™æ€å˜é‡: è¢«staticä¿®é¥°ç¬¦ä¿®é¥°çš„å˜é‡ï¼Œå±äºç±»ï¼Œä¸€ä¸ªç±»ä¸ç®¡åˆ›å»ºå¤šå°‘ä¸ªå¯¹è±¡ï¼Œé™æ€å˜é‡åœ¨å†…å­˜ä¸­æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªå‰¯æœ¬ã€‚</li>\n<li>å®ä¾‹å˜é‡: å±äºæŸä¸€å¯¹è±¡ï¼Œéœ€è¦å…ˆåˆ›å»ºå¯¹è±¡ç„¶åé€šè¿‡å¯¹è±¡æ‰èƒ½è®¿é—®åˆ°å®ƒã€‚</li>\n<li>ç±»/é™æ€æ–¹æ³•ä¸èƒ½è®¿é—®éé™æ€æ–¹æ³•å’Œå˜é‡ï¼Œå®ä¾‹æ–¹æ³•å¯ä»¥è®¿é—®ç±»çš„æ‰€æœ‰æˆå‘˜å˜é‡å’Œæ–¹æ³•</li>\n</ul>\n<h1>23. finalã€finallyã€finalizeåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>finalæ˜¯ä¿®é¥°ç¬¦ï¼Œä¿®é¥°ç±»ä¸èƒ½è¢«ç»§æ‰¿ï¼Œä¿®é¥°æ–¹æ³•ä¸èƒ½è¢«é‡å†™ï¼Œä¿®é¥°å˜é‡ä¸èƒ½è¢«ä¿®æ”¹ä¸”å¿…é¡»åœ¨å£°æ˜æ—¶åˆå§‹åŒ–å€¼ã€‚ä¸å¯å˜æŒ‡çš„æ˜¯å˜é‡çš„å¼•ç”¨ä¸å¯å˜ï¼Œä¸æ˜¯å¼•ç”¨æŒ‡å‘çš„å†…å®¹çš„ä¸å¯å˜ã€‚</li>\n<li>finallyåªèƒ½åœ¨try/catchè¯­å¥ä¸­ï¼Œæ— è®ºtryå—ä¸­çš„ä»£ç æ˜¯å¦æŠ›å‡ºå¼‚å¸¸ï¼Œfinallyå—ä¸­çš„ä»£ç ä¸€å®šä¼šæ‰§è¡Œã€‚å¸¸ç”¨äºé‡Šæ”¾èµ„æº(I/O)ã€‚ä¸ä¼šè¢«æ‰§è¡Œçš„æƒ…å†µï¼šåœ¨finallyè¯­å¥å—ä¸­å‘ç”Ÿäº†å¼‚å¸¸ï¼›åœ¨ä»£ç ä¸­ç”¨äº†System.exit()é€€å‡ºç¨‹åºï¼›</li>\n<li>finalize:åœ¨Objectç±»ä¸­çš„æ–¹æ³•ï¼Œåœ¨åƒåœ¾æ”¶é›†å™¨åˆ é™¤å¯¹è±¡ä¹‹å‰å¯¹è¿™ä¸ªå¯¹è±¡è°ƒç”¨ä¸€æ¬¡ã€‚finalizeè¢«è°ƒç”¨ä¸ä¸€å®šä¼šç«‹å³å›æ”¶è¯¥å¯¹è±¡ï¼Œæ‰€ä»¥æœ‰å¯èƒ½è°ƒç”¨finalizeåï¼Œè¯¥å¯¹è±¡åˆä¸éœ€è¦è¢«å›æ”¶äº†ï¼Œç„¶ååˆ°äº†çœŸæ­£è¦è¢«å›æ”¶çš„æ—¶å€™ï¼Œå› ä¸ºå‰é¢è°ƒç”¨è¿‡ä¸€æ¬¡ï¼Œæ‰€ä»¥ä¸ä¼šå†æ¬¡è°ƒç”¨finalizeäº†ï¼Œè¿›è€Œäº§ç”Ÿé—®é¢˜ï¼Œå› æ­¤ä¸æ¨èä½¿ç”¨ã€‚</li>\n</ul>\n<h1>24. ==å’ŒequalsåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>==ï¼šå¦‚æœæ¯”è¾ƒçš„å¯¹è±¡æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯æ•°å€¼æ˜¯å¦ç›¸ç­‰ï¼›å¦‚æœæ¯”è¾ƒçš„å¯¹è±¡æ˜¯å¼•ç”¨æ•°æ®ç±»å‹ï¼Œåˆ™æ¯”è¾ƒçš„æ˜¯å¯¹è±¡çš„åœ°å€å€¼æ˜¯å¦ç›¸ç­‰</li>\n<li>equalsæ–¹æ³•ï¼šæ²¡æœ‰é‡å†™ç›¸å½“äº==ï¼Œé‡å†™åæ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡çš„å†…å®¹æ˜¯å¦ç›¸ç­‰ã€‚Stringã€Integeré‡å†™äº†</li>\n</ul>\n<h1>25. hashcodeæ–¹æ³•ä½œç”¨ï¼Ÿä¸¤ä¸ªå¯¹è±¡çš„hashCodeæ–¹æ³•ç›¸åŒï¼Œåˆ™equalsæ–¹æ³•ä¹Ÿä¸€å®šä¸ºtrueå—ï¼Ÿ</h1>\n<ul>\n<li>hashCode æ–¹æ³•ä¸»è¦ç”¨æ¥è·å–å¯¹è±¡çš„å“ˆå¸Œç ï¼Œå“ˆå¸Œç æ˜¯ç”±å¯¹è±¡çš„å†…å­˜åœ°å€æˆ–è€…å¯¹è±¡çš„å±æ€§è®¡ç®—å‡ºæ¥çš„ï¼Œå®ƒæ˜¯â¼€ä¸ªintç±»å‹çš„æ•´æ•°ï¼Œé€šå¸¸æ˜¯ä¸ä¼šé‡å¤çš„ï¼Œå› æ­¤å¯ä»¥ç”¨æ¥ä½œä¸ºé”®å€¼å¯¹çš„é”®ï¼Œä»¥æé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</li>\n<li>ä¸ä¸€å®šã€‚å› ä¸ºå­˜åœ¨å“ˆå¸Œç¢°æ’ï¼Œåœ¨æ•£åˆ—è¡¨ä¸­ï¼ŒhashCode()ç›¸ç­‰å³ä¸¤ä¸ªé”®å€¼å¯¹çš„å“ˆå¸Œå€¼ç›¸ç­‰ï¼Œç„¶è€Œå“ˆå¸Œå€¼ç›¸ç­‰ï¼Œå¹¶ä¸ä¸€å®šèƒ½å¾—å‡ºé”®å€¼å¯¹ç›¸ç­‰</li>\n<li>ä¸ºäº†è§£å†³å“ˆå¸Œå†²çªçš„é—®é¢˜ï¼Œå“ˆå¸Œè¡¨åœ¨å¤„ç†é”®æ—¶ï¼Œä¸ä»…ä¼šæ¯”è¾ƒé”®å¯¹è±¡çš„å“ˆå¸Œç ï¼Œè¿˜ä¼šä½¿ç”¨ equals æ–¹æ³•æ¥æ£€æŸ¥é”®å¯¹è±¡æ˜¯å¦çœŸæ­£ç›¸ç­‰ã€‚å¦‚æœä¸¤ä¸ªå¯¹è±¡çš„å“ˆå¸Œç ç›¸åŒï¼Œä½†é€šè¿‡ equals æ–¹æ³•æ¯”è¾ƒç»“æœä¸º falseï¼Œé‚£ä¹ˆè¿™ä¸¤ä¸ªå¯¹è±¡å°±ä¸è¢«è§†ä¸ºç›¸ç­‰ã€‚</li>\n</ul>\n<h1>26. ä¸ºä»€ä¹ˆé‡å†™equalsæ–¹æ³•å°±ä¸€å®šè¦é‡å†™hashCodeæ–¹æ³•ï¼Ÿ</h1>\n<ul>\n<li>ä¿è¯åœ¨equalsç›¸åŒçš„æƒ…å†µä¸‹hashcodeå€¼å¿…å®šç›¸åŒï¼šå¦‚æœåªé‡å†™equalsæ–¹æ³•ï¼Œé‚£ä¹ˆè¢«è®¤ä¸ºç›¸ç­‰çš„å¯¹è±¡å¯èƒ½ä¼šæœ‰ä¸åŒçš„å“ˆå¸Œç ï¼ˆé»˜è®¤æ˜¯å¯¹è±¡çš„åœ°å€ï¼Œå› æ­¤æ‰€æœ‰å¯¹è±¡éƒ½æ˜¯ä¸åŒçš„å“ˆå¸Œç ï¼‰ï¼Œå­˜å‚¨åœ¨é›†åˆä¸åŒçš„ä½ç½®ï¼Œå¯¼è‡´é›†åˆå‡ºç°é‡å¤å…ƒç´ æˆ–è€…æ— æ³•æ‰¾åˆ°å¯¹åº”å…ƒç´ ï¼ˆå› ä¸ºequalsæ˜¯æ ¹æ®å¯¹è±¡çš„ç‰¹å¾è¿›è¡Œé‡å†™ï¼‰</li>\n<li>æå‡æ€§èƒ½ï¼šhashCodeèƒ½æé«˜hashmapç­‰é›†åˆå»é‡çš„æ€§èƒ½ï¼Œå¦‚æœæ²¡æœ‰é‡å†™hashCode()æ–¹æ³•,é‚£ä¹ˆé›†åˆæ¯æ¬¡æ·»åŠ å…ƒç´ éƒ½è¦éå†å·²æœ‰å…ƒç´ è°ƒç”¨equalsæ–¹æ³•ï¼Œæ€§èƒ½å¤ªå·®ï¼Œé‡å†™hashcodeèƒ½å‡å°‘equalsæ–¹æ³•è°ƒç”¨æ¬¡æ•°</li>\n</ul>\n<h1>27. Javaä¸­çš„å‚æ•°ä¼ é€’æ—¶ä¼ å€¼å‘¢è¿˜æ˜¯ä¼ å¼•ç”¨ï¼Ÿ</h1>\n<ul>\n<li>javaåŸºæœ¬ç±»å‹ä½œä¸ºå‚æ•°è¢«ä¼ é€’æ—¶æ˜¯å€¼ä¼ é€’ï¼›å¼•ç”¨ç±»å‹ä½œä¸ºå‚æ•°è¢«ä¼ é€’æ—¶ä¹Ÿæ˜¯å€¼ä¼ é€’ï¼Œå‚æ•°å€¼æ˜¯å¯¹è±¡çš„å¼•ç”¨ã€‚</li>\n</ul>\n<h1>28. æ·±æ‹·è´å’Œæµ…æ‹·è´ï¼Ÿ</h1>\n<ul>\n<li>æµ…æ‹·è´ä»…æ‹·è´è¢«æ‹·è´å¯¹è±¡çš„åŸºæœ¬æ•°æ®ç±»å‹å˜é‡çš„å€¼å’Œå¼•ç”¨æ•°æ®ç±»å‹å˜é‡çš„åœ°å€å€¼ï¼Œè€Œå¯¹äºå¼•ç”¨ç±»å‹å˜é‡æŒ‡å‘çš„å †ä¸­çš„å¯¹è±¡ä¸ä¼šæ‹·è´</li>\n<li>æ·±æ‹·è´å®Œå…¨æ‹·è´ä¸€ä¸ªå¯¹è±¡ï¼Œæ‹·è´è¢«æ‹·è´å¯¹è±¡çš„æˆå‘˜å˜é‡çš„å€¼ï¼Œå †ä¸­çš„å¯¹è±¡ä¹Ÿä¼šæ‹·è´ä¸€ä»½ã€‚</li>\n<li>æµ…æ‹·è´å®ç°Cloneableæ¥å£å¹¶é‡å†™Objectç±»ä¸­çš„clone()æ–¹æ³•;</li>\n<li>æ·±æ‹·è´å®ç°Serializableæ¥å£ï¼Œé€šè¿‡å¯¹è±¡çš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Œæˆ–è€…ä½¿æ‰€æœ‰å¼•ç”¨ç±»å‹å±æ€§å®ç°Cloneableæ¥å£</li>\n</ul>\n<h1>29. Javaä¸­åˆ›å»ºå¯¹è±¡çš„å‡ ç§æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨newå…³é”®å­—</li>\n<li>ä½¿ç”¨Classç±»çš„newInstanceæ–¹æ³•ï¼ŒClass.forName.newInstance()</li>\n<li>ä½¿ç”¨cloneæ–¹æ³•</li>\n<li>ååºåˆ—åŒ–ï¼Œæ¯”å¦‚è°ƒç”¨ObjectInputStreamç±»çš„readObject()æ–¹æ³•</li>\n</ul>\n<h1>30. Javaå¯¹è±¡åˆå§‹åŒ–è¿‡ç¨‹âˆš</h1>\n<ul>\n<li>çˆ¶ç±»é™æ€å±æ€§</li>\n<li>çˆ¶ç±»é™æ€ä»£ç å—</li>\n<li>å­ç±»é™æ€å±æ€§</li>\n<li>å­ç±»é™æ€ä»£ç å—</li>\n<li>çˆ¶ç±»éé™æ€å±æ€§</li>\n<li>çˆ¶ç±»æ„é€ ä»£ç å—</li>\n<li>çˆ¶ç±»æ„é€ æ–¹æ³•</li>\n<li>å­ç±»éé™æ€å±æ€§</li>\n<li>å­ç±»æ„é€ ä»£ç å—</li>\n<li>å­ç±»æ„é€ æ–¹æ³•</li>\n</ul>\n<h1>31. æ€ä¹ˆç²¾ç¡®è¡¨ç¤ºä»»æ„ç²¾åº¦çš„æ•´æ•°å’Œä»»ä½•ç²¾åº¦çš„å®šç‚¹æ•°æˆ–è€…è´§å¸ï¼Ÿâˆš</h1>\n<ul>\n<li>BigIntegerä»»æ„ç²¾åº¦çš„æ•´æ•°</li>\n<li>BigDecimalä»»ä½•ç²¾åº¦çš„å®šç‚¹æ•°-&gt;è´§å¸</li>\n<li>è½¬æˆåˆ†ç”¨intè¿ç®—</li>\n</ul>\n<h1>32. Stringæ˜¯JavaåŸºæœ¬æ•°æ®ç±»å‹å—ï¼Ÿå¯ä»¥è¢«ç»§æ‰¿å—ï¼Ÿ</h1>\n<ul>\n<li>å¼•ç”¨ç±»å‹ï¼ŒStringè¢«finalä¿®é¥°ä¸èƒ½è¢«ç»§æ‰¿</li>\n</ul>\n<h1>33. Stringæ˜¯ä¸å¯å˜ç±»å—ï¼Ÿå­—ç¬¦ä¸²æ‹¼æ¥æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h1>\n<ul>\n<li>Stringæ˜¯ä¸å¯å˜çš„ï¼Œ1.8ä»¥å‰+çš„æ‹¼æ¥æ“ä½œï¼Œå¦‚æœå­—ç¬¦ä¸²åœ¨å¸¸é‡æ± ä¸­ä¸å­˜åœ¨ï¼Œåˆ™ä¼šç”Ÿæˆæ–°çš„å¯¹è±¡ã€‚1.8æ—¶è¢«ä¼˜åŒ–ä¸ºåŸºäºStringBuilderçš„appendæ–¹æ³•è¿›è¡Œå¤„ç†</li>\n</ul>\n<h1>34. ä¸åŒStringåˆ›å»ºæ–¹æ³•åˆ†åˆ«åˆ›å»ºäº†å‡ ä¸ªå¯¹è±¡ï¼Ÿâˆš</h1>\n<ul>\n<li>1.String str1 = \"abc\";2.String str2 = new String(\"abc\")</li>\n<li>1åœ¨å†…å­˜çš„å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å­˜å‚¨abcå­—ç¬¦ä¸²å¯¹è±¡</li>\n<li>2åœ¨å†…å­˜çš„å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­æ‰¾abcå­—ç¬¦ä¸²å¯¹è±¡ï¼Œæ²¡æœ‰åˆ™åˆ›å»ºï¼›åœ¨å †ä¸­åˆ›å»ºstr2å¯¹è±¡ï¼Œå¼•ç”¨æŒ‡å‘abcå­—ç¬¦ä¸²å¯¹è±¡</li>\n</ul>\n<h1>35. Stringä¸ºä»€ä¹ˆæ˜¯ä¸å¯å˜çš„ï¼Ÿè®¾è®¡åŸå› ï¼Ÿâˆš</h1>\n<ul>\n<li>ä¸å¯å˜ï¼šä¸€æ—¦Stringå¯¹è±¡è¢«åˆ›å»ºï¼Œå®ƒæ‰€åŒ…å«çš„å­—ç¬¦ä¸²å†…å®¹æ˜¯ä¸å¯æ”¹å˜çš„ã€‚</li>\n<li>ä¸å¯å˜æ˜¯å› ä¸ºå¼•ç”¨çš„charæ•°ç»„(jdk1.9åæ”¹ä¸ºbyteæ•°ç»„)è¢«finalä¿®é¥°ã€‚å­—ç¬¦ä¸²çš„å€¼æœ¬èº«ä¸èƒ½æ”¹å˜ï¼Œä½†å¼•ç”¨å­—ç¬¦ä¸²çš„å˜é‡ä¸­è®°å½•çš„åœ°å€å€¼æ˜¯å¯ä»¥æ”¹å˜çš„ã€‚æ¯æ¬¡ä¿®æ”¹æ“ä½œï¼ˆå¦‚æ‹¼æ¥ã€æ›¿æ¢ç­‰ï¼‰éƒ½ä¼šäº§ç”Ÿæ–°å¯¹è±¡ã€‚</li>\n<li>é¿å…å†…å­˜æµªè´¹ï¼šå½“åˆ›å»ºä¸€ä¸ªStringå¯¹è±¡æ—¶ï¼Œå¦‚æœå­—ç¬¦ä¸²å€¼åœ¨å¸¸é‡æ± ä¸­å·²ç»å­˜åœ¨åˆ™ä¸ä¼šåˆ›å»ºï¼Œåªæ˜¯å¼•ç”¨å·²ç»å­˜åœ¨çš„å¯¹è±¡</li>\n<li>æ€§èƒ½ä¼˜åŒ–ï¼šå­—ç¬¦ä¸²ä¸å˜æ€§ä¿è¯äº†hashç çš„å”¯ä¸€æ€§ï¼Œå…è®¸Stringå¯¹è±¡ç¼“å­˜é¢‘ç¹ä½¿ç”¨çš„HashCodeï¼ˆå¦‚HashMapï¼‰ï¼Œä¸å¿…æ¯æ¬¡éƒ½å»è®¡ç®—æ–°çš„å“ˆå¸Œç </li>\n<li>å®‰å…¨æ€§ï¼šStringè¢«è®¸å¤šçš„Javaç±»ç”¨æ¥å½“åšå‚æ•°ï¼Œä¾‹å¦‚ï¼šç½‘ç»œè¿æ¥åœ°å€URLã€æ–‡ä»¶è·¯å¾„pathã€åå°„æœºåˆ¶çš„Stringå‚æ•°ç­‰, å¦‚æœStringä¸æ˜¯å›ºå®šä¸å˜çš„ï¼Œå°†ä¼šå¼•èµ·å„ç§å®‰å…¨éšæ‚£ã€‚</li>\n</ul>\n<h1>36. Stringã€StringBuilderã€StringBuffer çš„åŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>Stringï¼šç±»çš„å¯¹è±¡æ˜¯ä¸å¯å˜çš„ï¼›é€‚ç”¨äºå­—ç¬¦ä¸²å†…å®¹ä¸ç»å¸¸æ”¹å˜çš„åœºæ™¯ã€‚åœ¨ä½¿ç”¨å­—ç¬¦ä¸²å¸¸é‡æˆ–è¿›è¡Œå°‘é‡çš„å­—ç¬¦ä¸²æ“ä½œæ—¶ä½¿ç”¨ã€‚æ¯æ¬¡å¯¹Stringå¯¹è±¡è¿›è¡Œä¿®æ”¹æ“ä½œï¼ˆå¦‚æ‹¼æ¥ã€æ›¿æ¢ç­‰ï¼‰å®é™…ä¸Šéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„Stringå¯¹è±¡ï¼Œè€Œä¸æ˜¯ä¿®æ”¹åŸæœ‰å¯¹è±¡ã€‚å¤§é‡å­—ç¬¦ä¸²è¿æ¥æƒ…å†µä¸‹ï¼Œäº§ç”Ÿå¤ªå¤šå¯¹è±¡æµªè´¹å†…å­˜ã€‚çº¿ç¨‹å®‰å…¨</li>\n<li>StringBuilderï¼šé€‚ç”¨äºå•çº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦é¢‘ç¹ä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹çš„åœºæ™¯ï¼Œæ¯”å¦‚åœ¨å¾ªç¯ä¸­æ‹¼æ¥æˆ–ä¿®æ”¹å­—ç¬¦ä¸²ï¼Œä½¿ç”¨å­—ç¬¦æ•°ç»„char[]ä¿å­˜å­—ç¬¦ä¸²,å¯å˜ç±»ï¼Œæ¯æ¬¡å¯¹Stringå¯¹è±¡è¿›è¡Œä¿®æ”¹æ“ä½œï¼ˆå¦‚æ‹¼æ¥ã€æ›¿æ¢ç­‰ï¼‰éƒ½æ˜¯ç›´æ¥åœ¨åŸæœ‰å­—ç¬¦ä¸²å¯¹è±¡çš„åº•å±‚æ•°ç»„ä¸Šè¿›è¡Œï¼Œä¸äº§ç”Ÿæ–°å¯¹è±¡ï¼Œçº¿ç¨‹ä¸å®‰å…¨ï¼›æ•ˆç‡é«˜</li>\n<li>StringBufferï¼šé€‚ç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒä¸‹éœ€è¦é¢‘ç¹ä¿®æ”¹å­—ç¬¦ä¸²å†…å®¹çš„åœºæ™¯ï¼Œä½¿ç”¨å­—ç¬¦æ•°ç»„char[]ä¿å­˜å­—ç¬¦ä¸²,å¯å˜ç±»ï¼Œæ–¹æ³•åŠ åŒæ­¥é”synchronizedï¼Œçº¿ç¨‹å®‰å…¨ï¼›æ•ˆç‡ä½</li>\n<li>å¤šçº¿ç¨‹å¼ºåˆ¶ä½¿ç”¨StringBuilder()</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class StringBuilderHolder {\n    private final StringBuilder sb;\n    \n    public StringBuilderHolder(int capacity) {\n        sb = new StringBuidler(capacity);\n    }\n    //3.é¿å…é‡å¤æ„é€ Stringï¼Œé‡ç”¨StringBuilder\n    public StringBuilder resetAndGetStringBuilder() {\n        sb.setLength(0);\n        return sb;\n    }\n}\n//2.ThreadLocalé¿å…å¤šçº¿ç¨‹å†²çª\nprivate static final ThreadLocal&lt;StringBuilderHolder&gt; threadLocalStringBuilderHolder = new ThreadLocal&lt;StringBuilderHolder&gt;() {\n    protected StringBuilderHolder initialValue() {\n        //1.è®¾ç½®å¥½åˆå§‹é•¿åº¦ï¼Œè¶…è¿‡char[]é»˜è®¤16è°ƒç”¨System.arraycopyæˆå€å¤åˆ¶æ‰©å®¹å¤ªæµªè´¹èµ„æº\n        return new StringBuilderHolder(256);\n    }\n}\n\nStringBuilder sb = threadLocalStringBuilderHolder.get().resetAndGetStringBuilder();\n</code></pre></div><h1>37. intern æ–¹æ³•æœ‰ä»€ä¹ˆä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>å¦‚æœå½“å‰å­—ç¬¦ä¸²å†…å®¹å­˜åœ¨äºå­—ç¬¦ä¸²å¸¸é‡æ± ï¼Œç›´æ¥è¿”å›å­—ç¬¦ä¸²å¸¸é‡æ± ä¸­çš„å­—ç¬¦ä¸²ï¼›å¦åˆ™ï¼Œå°†æ­¤Stringå¯¹è±¡æ·»åŠ åˆ°æ± ä¸­ï¼Œå¹¶è¿”å›Stringå¯¹è±¡çš„å¼•ç”¨</li>\n</ul>\n<h1>38. intå’ŒIntegeræœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>integeræ˜¯intçš„åŒ…è£…ç±»ï¼Œå±äºå¼•ç”¨æ•°æ®ç±»å‹ï¼Œè€Œintæ˜¯Javaçš„åŸºæœ¬æ•°æ®ç±»å‹</li>\n<li>Integeré»˜è®¤å€¼æ˜¯nullï¼Œintçš„é»˜è®¤å€¼æ˜¯0</li>\n<li>Integeræ˜¯å¯¹è±¡çš„å¼•ç”¨ï¼Œå½“newä¸€ä¸ªIntegeræ—¶ï¼Œå®é™…ä¸Šæ˜¯ç”Ÿæˆä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘æ­¤å¯¹è±¡ï¼›è€Œintåˆ™æ˜¯ç›´æ¥å­˜å‚¨æ•°æ®å€¼</li>\n<li>Integerå˜é‡å¿…é¡»å®ä¾‹åŒ–åæ‰å¯ä»¥ä½¿ç”¨ï¼Œè€Œintä¸éœ€è¦ã€‚</li>\n</ul>\n<h1>39. ==æ¯”è¾ƒIntegerã€new Integerã€intçš„å€¼âˆš</h1>\n<p>é™¤ä»¥ä¸‹æƒ…å†µå¤–,==æ¯”è¾ƒéƒ½æ˜¯true</p>\n<ul>\n<li>new Integer(100) != new Integer(100) å› ä¸ºnewç”Ÿæˆçš„ä¸¤ä¸ªintegeræŒ‡å‘å †ä¸­çš„åœ°å€ï¼Œè€Œå¼•ç”¨æ•°æ®ç±»å‹æ¯”è¾ƒæ—¶å®é™…æ˜¯æ¯”è¾ƒåœ°å€æ˜¯å¦ç›¸åŒã€‚</li>\n<li>new Integer(100) != Integer i=100 å› ä¸ºénewç”Ÿæˆçš„Integerå˜é‡æŒ‡å‘çš„æ˜¯javaå¸¸é‡æ± ä¸­çš„å¯¹è±¡ï¼Œè€Œnew Integer()ç”Ÿæˆçš„å˜é‡æŒ‡å‘å †ä¸­æ–°å»ºçš„å¯¹è±¡</li>\n<li>Integer i = 128 != Integer j=128(Integerç¼“å­˜-128-127çš„Integerå¯¹è±¡ï¼Œè‡ªåŠ¨è£…ç®±æ—¶ä¸ä¼šnewæ–°çš„Integerå¯¹è±¡ï¼Œè€Œæ˜¯ç›´æ¥å¼•ç”¨ç¼“å­˜æ± ä¸­çš„Integerå¯¹è±¡)</li>\n</ul>\n<h1>40. Stringè½¬æˆIntegeråŸç†ï¼Ÿ</h1>\n<ul>\n<li>Stringè½¬æˆIntegerï¼šInteger.parseInt(String s)Integer.valueOf(String s)</li>\n<li>æœ€ç»ˆè°ƒç”¨Integerç±»ä¸­çš„parseInt(String s, int radix)æ–¹æ³•ï¼Œå­—ç¬¦ä¸²éå†è®¡ç®—è´Ÿçš„å€¼ç´¯å‡ï¼Œ1314=-1 * (-1+-3<em>10+-1</em>100)</li>\n</ul>\n<h1>41. Errorå’ŒExceptionçš„åŒºåˆ«ï¼Ÿ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e35afb80114c9ff59b1db.jpg\" alt=\"Exception.jpg\" tabindex=\"0\"><figcaption>Exception.jpg</figcaption></figure>\n<ul>\n<li>å—æ£€å¼‚å¸¸ï¼šç¼–è¯‘å™¨ä¼šæ£€æŸ¥å¹¶è¦æ±‚å¿…é¡»å¤„ç†çš„å¼‚å¸¸ã€‚</li>\n<li>éå—æ£€å¼‚å¸¸ï¼šç¼–è¯‘å™¨ä¸ä¼šæ£€æŸ¥ä¹Ÿä¸è¦æ±‚å¿…é¡»å¤„ç†çš„å¼‚å¸¸.</li>\n<li>Throwableï¼šæ‰€æœ‰é”™è¯¯æˆ–å¼‚å¸¸çš„è¶…ç±»ï¼Œè¡¨ç¤ºç¨‹åºä¸­å¯èƒ½ä¼šäº§ç”Ÿçš„å¼‚å¸¸\n<ul>\n<li>Error(éå—æ£€å¼‚å¸¸)ç³»ç»Ÿçº§çš„é”™è¯¯;è¿è¡Œç¯å¢ƒä¸­çš„å†…éƒ¨é”™è¯¯æˆ–è€…ç¡¬ä»¶é—®é¢˜,ä¼šå¯¼è‡´åº”ç”¨ç¨‹åºä¸­æ–­.å¦‚ï¼šç³»ç»Ÿå´©æºƒã€è™šæ‹Ÿæœºé”™è¯¯ã€å†…å­˜ç©ºé—´ä¸è¶³ã€æ–¹æ³•è°ƒç”¨æ ˆæº¢å‡ºç­‰</li>\n<li>Exceptionï¼šç¨‹åºå¯ä»¥å¤„ç†çš„å¼‚å¸¸\n<ul>\n<li>ç¼–è¯‘æœŸå¼‚å¸¸Checked Exception(<strong>å—æ£€å¼‚å¸¸</strong>)Exceptionä¸­é™¤RuntimeExceptionåŠå…¶å­ç±»ä¹‹å¤–çš„å¼‚å¸¸ã€‚é€šå¸¸ä¸ä¼šè‡ªå®šä¹‰è¯¥ç±»å¼‚å¸¸ï¼Œè€Œæ˜¯ç›´æ¥ä½¿ç”¨ç³»ç»Ÿæä¾›çš„å¼‚å¸¸ç±»ã€‚</li>\n<li>è¿è¡Œæ—¶æœŸå¼‚å¸¸RuntimeExceptionåŠå…¶å­ç±»å¼‚å¸¸(éå—æ£€å¼‚å¸¸)ï¼Œå‡ºç°åŸå› å¤§å¤šå› ä¸ºä»£ç æœ¬èº«æœ‰é—®é¢˜åº”è¯¥ä»é€»è¾‘ä¸Šå»è§£å†³å¹¶æ”¹è¿›ä»£ç </li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>42. å¼‚å¸¸çš„å¤„ç†æ–¹å¼?</h1>\n<ul>\n<li>throwï¼ŒthrowsæŠ›å‡ºï¼Œè‡ªå·±ä¸å¤„ç†ï¼ŒæŠ›ç»™è°ƒç”¨è€…å¤„ç†(throwså¼‚å¸¸ç±»ç”¨åœ¨æ–¹æ³•ä¸Šï¼Œå¯ä»¥è·Ÿå¤šä¸ªå¼‚å¸¸ç±»ï¼›throwå¼‚å¸¸å¯¹è±¡ç”¨åœ¨æ–¹æ³•å†…)</li>\n<li>try catchæ•è·å¼‚å¸¸;å¯é€‰æ‹©åŠ ä¸Šfinallyè¯­å¥å—ï¼Œfinally è¯­å¥å—ä¸ç®¡ç¨‹åºæ˜¯å¦æ­£å¸¸æ‰§è¡Œï¼Œæœ€ç»ˆå®ƒéƒ½ä¼šå¿…ç„¶æ‰§è¡Œã€‚</li>\n</ul>\n<h1>43. å¼‚å¸¸å¤„ç†ç»å…¸é¢˜?</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//tryreturnå‡†å¤‡-&gt;catch-&gt;finally-&gt;tryreturn\npublic class TryDemo {\n    public static void main(String[] args) {\n        System.out.println(test1());//æ‰§è¡Œç»“æœ31ã€‚åœ¨returnå‰ä¼šå…ˆæ‰§è¡Œfinallyï¼Œæ‰€ä»¥æ˜¯å…ˆè¾“å‡º3ï¼Œå†è¾“å‡º1\n        System.out.println(test2());//æ‰§è¡Œç»“æœ3ã€‚tryè¿”å›å‰å…ˆæ‰§è¡Œfinallyï¼Œç»“æœfinallyç›´æ¥returnäº†ï¼Œå°±èµ°ä¸åˆ°tryé‡Œé¢çš„returnäº†\n        System.out.println(test3());//æ‰§è¡Œç»“æœ2.æ‰§è¡Œfinallyä¹‹å‰å°†içš„ç»“æœæš‚å­˜ï¼Œfinallyæ‰§è¡Œå®Œæ¯•åè¿”å›ä¹‹å‰æš‚å­˜çš„ç»“æœï¼Œè€Œä¸æ˜¯è¿”å›3\n    }\n    public static int test1() {\n        try {\n            return 1;\n        } catch (Exception e) {\n            return 2;\n        } finally {\n            System.out.print(\"3\");\n        }\n    }\n    public static int test2() {\n        try {\n            return 2;\n        } finally {\n            return 3;\n        }\n    }\n    public static int test3() {\n        int i = 0;\n        try {\n            i = 2;\n            return i;\n        } finally {\n            i = 3;\n        }\n    }\n}\n\n</code></pre></div><h1>44. ä»€ä¹ˆæ˜¯java IO?</h1>\n<ul>\n<li>Java IOæµçš„40å¤šä¸ªç±»éƒ½æ˜¯ä»å¦‚ä¸‹4ä¸ªæŠ½è±¡ç±»åŸºç±»ä¸­æ´¾ç”Ÿå‡ºæ¥çš„ã€‚</li>\n<li>InputStream/Reader: æ‰€æœ‰è¾“å…¥æµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å…¥æµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å…¥æµã€‚</li>\n<li>OutputStream/Writer: æ‰€æœ‰è¾“å‡ºæµçš„åŸºç±»ï¼Œå‰è€…æ˜¯å­—èŠ‚è¾“å‡ºæµï¼Œåè€…æ˜¯å­—ç¬¦è¾“å‡ºæµã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6e44bc67911b299c3cb3c.jpg\" alt=\"IO.jpg\"></li>\n</ul>\n<h1>45. InputStreamä¸ºä»€ä¹ˆä¸èƒ½é‡å¤è¯»å–ï¼Ÿå¦‚ä½•å®ç°é‡å¤è¯»å–ï¼Ÿâˆš</h1>\n<ul>\n<li>å› ä¸ºinputStreamè®¾è®¡å°±æ˜¯è¿™æ ·çš„</li>\n<li>ä½¿ç”¨ByteArrayOutputStream</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class InputStreamCacher {  \n    private ByteArrayOutputStream byteArrayOutputStream = null;\n    public InputStreamCacher(InputStream inputStream) {\n        byteArrayOutputStream = new ByteArrayOutputStream();  \n        byte[] buffer = new byte[1024];    \n        int len;    \n        try {  \n            while ((len = inputStream.read(buffer)) &gt; -1 ) {    \n                byteArrayOutputStream.write(buffer, 0, len);    \n            }  \n            byteArrayOutputStream.flush();  \n        } catch (IOException e) {  \n            logger.error(e.getMessage(), e);  \n        }    \n    }\n    public InputStream getInputStream() { \n        return new ByteArrayInputStream(byteArrayOutputStream.toByteArray());  \n    }  \n}  \nInputStreamCacher  cacher = new InputStreamCacher(inputStream);  \nInputStream stream = cacher.getInputStream();\n</code></pre></div><h1>46. å­—èŠ‚æµå’Œå­—ç¬¦æµåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>Javaç”¨Unicodeç¼–ç å­˜å‚¨å­—ç¬¦</li>\n<li>å…¶å®å­—ç¬¦æµæ˜¯ç”± Java è™šæ‹Ÿæœºå°†å­—èŠ‚è½¬æ¢å¾—åˆ°çš„ï¼Œä¸ºäº†æ–¹ä¾¿åœ¨ä¸çŸ¥é“ç¼–ç çš„æƒ…å†µä¸‹æ“ä½œå­—ç¬¦ï¼Œæé«˜è¯»å†™æ•ˆç‡</li>\n<li>å­—èŠ‚æµæŒ‰8ä½ä¼ è¾“(æ“ä½œå­—èŠ‚å’Œå­—èŠ‚æ•°ç»„ã€æ•°å­—_)ä»¥å­—èŠ‚ä¸ºå•ä½è¾“å…¥è¾“å‡ºæ•°æ®</li>\n<li>å­—ç¬¦æµæŒ‰16ä½ä¼ è¾“(ç”±Javaè™šæ‹Ÿæœºå°†å­—èŠ‚è½¬åŒ–ä¸º2ä¸ªå­—èŠ‚çš„Unicodeå­—ç¬¦ä¸ºå•ä½çš„å­—ç¬¦è€Œæˆçš„)å¯¹å¤šå›½è¯­è¨€æ”¯æŒæ€§æ¯”è¾ƒå¥½</li>\n<li>éŸ³é¢‘æ–‡ä»¶ã€å›¾ç‰‡ã€æ­Œæ›²ä½¿ç”¨ç”¨å­—èŠ‚æµï¼Œä¸­æ–‡æ–‡æœ¬çš„ï¼Œä½¿ç”¨å­—ç¬¦æµ</li>\n<li>ä¸ç®¡æ–‡ä»¶è¯»å†™è¿˜æ˜¯ç½‘ç»œå‘é€æ¥æ”¶ï¼Œä¿¡æ¯çš„æœ€å°å­˜å‚¨å•å…ƒéƒ½æ˜¯å­—èŠ‚</li>\n</ul>\n<h1>47. BIO,NIO,AIO åŒºåˆ«</h1>\n<ul>\n<li>BIO(Block IO):åŒæ­¥é˜»å¡ã€‚æœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªè¿æ¥ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯æœ‰è¿æ¥è¯·æ±‚æ—¶æœåŠ¡å™¨ç«¯å°±éœ€è¦å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†ï¼Œå¦‚æœè¿™ä¸ªè¿æ¥ä¸åšä»»ä½•äº‹æƒ…ä¼šé€ æˆä¸å¿…è¦çš„çº¿ç¨‹å¼€é”€ï¼Œå¯ä»¥é€šè¿‡çº¿ç¨‹æ± æœºåˆ¶æ”¹å–„.é€‚ç”¨äºè¿æ¥æ•°è¾ƒå°‘çš„åœºæ™¯ã€‚åŸºäº Socket å’Œ ServerSocket è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚</li>\n<li>NIO(non-blocking IO)åŒæ­¥éé˜»å¡ã€‚æœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªIOè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå³å®¢æˆ·ç«¯å‘é€çš„è¿æ¥è¯·æ±‚éƒ½ä¼šæ³¨å†Œåˆ°å¤šè·¯å¤ç”¨å™¨ä¸Šï¼Œå¤šè·¯å¤ç”¨å™¨è½®è¯¢åˆ°è¿æ¥æœ‰I/Oè¯·æ±‚æ—¶æ‰å¯åŠ¨ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œå¤„ç†.é€‚ç”¨äºè¿æ¥æ•°å¤šä½†è¿æ¥æ—¶é—´çŸ­çš„åœºæ™¯ã€‚åŸºäº SocketChannel å’Œ ServerSocketChannel è¿›è¡Œç½‘ç»œé€šä¿¡ã€‚æœåŠ¡å™¨å¯ä»¥ç”¨ä¸€ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯è¿æ¥ï¼Œé€šè¿‡ Selector ç›‘å¬å¤šä¸ª Channel æ¥å®ç°å¤šè·¯å¤ç”¨ï¼Œæå¤§åœ°æé«˜äº†ç½‘ç»œç¼–ç¨‹çš„æ€§èƒ½ã€‚</li>\n<li>AIO(Asynchronous I/O)å¼‚æ­¥ä¸é˜»å¡ã€‚æœåŠ¡å™¨å®ç°æ¨¡å¼ä¸ºä¸€ä¸ªæœ‰æ•ˆè¯·æ±‚ä¸€ä¸ªçº¿ç¨‹ï¼Œå®¢æˆ·ç«¯çš„I/Oè¯·æ±‚éƒ½æ˜¯ç”±OSå…ˆå®Œæˆäº†å†é€šçŸ¥æœåŠ¡å™¨åº”ç”¨å»å¯åŠ¨çº¿ç¨‹è¿›è¡Œå¤„ç†.é€‚ç”¨äºè¿æ¥æ•°è¾ƒå¤šä¸”è¿æ¥æ—¶é—´è¾ƒé•¿çš„åº”ç”¨,é€‚ç”¨äºè¿æ¥æ•°å¤šä¸”è¿æ¥æ—¶é—´é•¿çš„åœºæ™¯ã€‚</li>\n</ul>\n<h1>48. ä»€ä¹ˆæ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼Ÿ</h1>\n<ul>\n<li>åºåˆ—åŒ– (Serialization)æŠŠJavaå¯¹è±¡è½¬ä¸ºäºŒè¿›åˆ¶æµï¼Œæ–¹ä¾¿å­˜å‚¨å’Œä¼ è¾“.ååºåˆ—åŒ–å°±æ˜¯æŠŠäºŒè¿›åˆ¶æµæ¢å¤æˆå¯¹è±¡ã€‚</li>\n<li>åœºæ™¯:å°†å†…å­˜ä¸­çš„å¯¹è±¡çŠ¶æ€ä¿å­˜åˆ°ä¸€ä¸ªæ–‡ä»¶ä¸­æˆ–è€…æ•°æ®åº“ä¸­;å¥—æ¥å­—åœ¨ç½‘ç»œä¸Šä¼ é€å¯¹è±¡;é€šè¿‡RMIä¼ è¾“å¯¹è±¡</li>\n<li>Serializableæ¥å£ä½œç”¨:åªæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œæ— ä½œç”¨ï¼Œä½†æ˜¯å¦‚æœä¸å®ç°è¿™ä¸ªæ¥å£ï¼Œåœ¨æœ‰äº›åºåˆ—åŒ–åœºæ™¯ä¼šæŠ¥é”™,æ¨èå®ç°</li>\n<li>serialVersionUIDä½œç”¨:ç”¨æ¥éªŒè¯åºåˆ—åŒ–çš„å¯¹è±¡å’Œååºåˆ—åŒ–å¯¹åº”çš„å¯¹è±¡IDæ˜¯å¦ä¸€è‡´ã€‚å¦‚æœæ²¡æœ‰æ˜¾ç¤ºæŒ‡å®šserialVersionUIDï¼Œåˆ™ç¼–è¯‘å™¨ä¼šæ ¹æ®ç±»çš„ç›¸å…³ä¿¡æ¯è‡ªåŠ¨ç”Ÿæˆä¸€ä¸ªã€‚å¦‚æœä½ æ²¡æœ‰å®šä¹‰serialVersionUIDï¼Œ ç»“æœåºåˆ—åŒ–å¯¹è±¡ä¹‹åï¼Œåœ¨ååºåˆ—åŒ–ä¹‹å‰æŠŠå¯¹è±¡çš„ç±»çš„ç»“æ„æ”¹äº†ï¼Œæ¯”å¦‚å¢åŠ äº†ä¸€ä¸ªæˆå‘˜å˜é‡ï¼Œåˆ™æ­¤æ—¶çš„ååºåˆ—åŒ–ä¼šå¤±è´¥ã€‚</li>\n<li>åºåˆ—åŒ–ä¸åŒ…å«transientä¿®é¥°å˜é‡å’Œé™æ€å˜é‡ã€‚transientåªèƒ½ä¿®é¥°å˜é‡ï¼Œä¸èƒ½ä¿®é¥°ç±»å’Œæ–¹æ³•ã€‚</li>\n<li>åºåˆ—åŒ–æ–¹æ³•ï¼š\n<ul>\n<li>Javaå¯¹è±¡åºåˆ—åŒ–:é€šè¿‡å¯¹è±¡è¾“å‡ºæµObjectOutputStreamå’Œå¯¹è±¡è¾“å…¥æµObjectInputStreamã€‚</li>\n<li>Jsonåºåˆ—åŒ–:ä½¿ç”¨jacksonåŒ…ï¼Œé€šè¿‡ObjectMapperç±»æ“ä½œï¼Œæ¯”å¦‚å°†å¯¹è±¡è½¬åŒ–ä¸ºbyteæ•°ç»„æˆ–è€…å°†jsonä¸²è½¬åŒ–ä¸ºå¯¹è±¡ã€‚</li>\n<li>ProtoBuffåºåˆ—åŒ–:ProtocolBufferæ˜¯ä¸€ç§è½»ä¾¿é«˜æ•ˆçš„ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼ŒProtoBuffåºåˆ—åŒ–å¯¹è±¡å¯ä»¥å¾ˆå¤§ç¨‹åº¦ä¸Šå°†å…¶å‹ç¼©ï¼Œå¯ä»¥å¤§å¤§å‡å°‘æ•°æ®ä¼ è¾“å¤§å°ï¼Œæé«˜ç³»ç»Ÿæ€§èƒ½ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>49. ä»€ä¹ˆæ˜¯é›¶æ‹·è´ï¼Ÿ</h1>\n<ul>\n<li>\n<p>DMAï¼šç›´æ¥å†…å­˜è®¿é—®ï¼ˆDirect Memory Accessï¼‰æ˜¯ä¸€ç§ç¡¬ä»¶è®¾å¤‡(ç½‘å¡ã€æ˜¾å¡ç­‰)ç»•å¼€CPUç‹¬ç«‹ç›´æ¥è®¿é—®å†…å­˜çš„æœºåˆ¶ã€‚æé«˜äº†CPUæ•ˆç‡ã€‚DMAå’Œç¡¬ä»¶äº¤äº’å¹¶ä¸”å°†æ•°æ®ä»ç£ç›˜ç¼“å†²åŒºæ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒº</p>\n</li>\n<li>\n<p>ä¼ ç»Ÿæ•°æ®äº¤äº’æ¨¡å¼</p>\n<ul>\n<li>è¯»æ•°æ®è¿‡ç¨‹ï¼šæ¶‰åŠ2æ¬¡ç©ºé—´åˆ‡æ¢(å†…æ ¸æ€&lt;=&gt;ç”¨æˆ·æ€)ã€1æ¬¡DMAæ‹·è´(ç£ç›˜=&gt;å†…æ ¸ç¼“å†²åŒº)ã€1æ¬¡CPUæ‹·è´(å†…æ ¸ç¼“å†²åŒº=&gt;ç”¨æˆ·ç¼“å†²åŒº)ï¼›\n<ul>\n<li>åº”ç”¨ç¨‹åºè¦è¯»å–ç£ç›˜æ•°æ®ï¼Œè°ƒç”¨read()å‡½æ•°å®ç°ç”¨æˆ·æ€åˆ‡æ¢å†…æ ¸æ€ï¼Œè¿™æ˜¯ç¬¬1æ¬¡çŠ¶æ€åˆ‡æ¢ï¼›</li>\n<li>DMAæ§åˆ¶å™¨å°†æ•°æ®ä»ç£ç›˜æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œè¿™æ˜¯ç¬¬1æ¬¡DMAæ‹·è´ï¼›å‘CPUå‘èµ·I/Oä¸­æ–­ï¼ŒæŠ¥å‘ŠCPUæ•°æ®å·²ç»Readyäº†ï¼›</li>\n<li>CPUæ”¶DMAçš„I/Oä¸­æ–­ä¹‹åï¼ŒCPUå°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œè¿™æ˜¯ç¬¬1æ¬¡CPUæ‹·è´ï¼›</li>\n<li>CPUå®Œæˆæ‹·è´ä¹‹åï¼Œread()å‡½æ•°è¿”å›å®ç°å†…æ ¸æ€åˆ‡æ¢ç”¨æˆ·æ€ï¼Œè¿™æ˜¯ç¬¬2æ¬¡çŠ¶æ€åˆ‡æ¢ï¼›</li>\n</ul>\n</li>\n<li>å†™æ•°æ®è¿‡ç¨‹ï¼šæ¶‰åŠ2æ¬¡ç©ºé—´åˆ‡æ¢(å†…æ ¸æ€&lt;=&gt;ç”¨æˆ·æ€)ã€1æ¬¡DMAæ‹·è´(å†…æ ¸ç¼“å†²åŒº=&gt;socketç¼“å†²åŒº)ã€1æ¬¡CPUæ‹·è´(ç”¨æˆ·ç¼“å†²åŒº=&gt;å†…æ ¸ç¼“å†²åŒº)ï¼›\n<ul>\n<li>åº”ç”¨ç¨‹åºè¦å‘ç½‘å¡å†™æ•°æ®ï¼Œè°ƒç”¨write()å‡½æ•°å®ç°ç”¨æˆ·æ€åˆ‡æ¢å†…æ ¸æ€ï¼Œè¿™æ˜¯ç¬¬1æ¬¡åˆ‡æ¢ï¼›</li>\n<li>CPUå°†ç”¨æˆ·ç¼“å†²åŒºæ•°æ®æ‹·è´åˆ°å†…æ ¸ç¼“å†²åŒºï¼Œè¿™æ˜¯ç¬¬1æ¬¡CPUæ‹·è´ï¼›</li>\n<li>DMAæ§åˆ¶å™¨å°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºå¤åˆ¶åˆ°socketç¼“å†²åŒºï¼Œè¿™æ˜¯ç¬¬1æ¬¡DMAæ‹·è´ï¼›</li>\n<li>å®Œæˆæ‹·è´ä¹‹åï¼Œwrite()å‡½æ•°è¿”å›å®ç°å†…æ ¸æ€åˆ‡æ¢ç”¨æˆ·æ€ï¼Œè¿™æ˜¯ç¬¬2æ¬¡åˆ‡æ¢ï¼›<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3d46750277356c44306b4.jpg\" alt=\"basicsmodel.jpg\"></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>é›¶æ‹·è´æŠ€æœ¯ï¼šåœ¨åº”ç”¨ç¨‹åºä¸å¯¹æ•°æ®åšä¿®æ”¹å‰æä¸‹ï¼Œå‡å°‘ä»å†…æ ¸ç¼“å†²åŒºåˆ°ç”¨æˆ·ç¼“å†²åŒºï¼Œå†ä»ç”¨æˆ·ç¼“å†²åŒºåˆ°å†…æ ¸ç¼“å†²åŒºä¸¤æ¬¡æ•°æ®æ‹·è´ï¼ˆéœ€è¦CPUå‚ä¸ï¼‰å’Œç”¨æˆ·æ€ä¸å†…æ ¸æ€çš„ä¸¤æ¬¡åˆ‡æ¢ï¼Œç›´æ¥åœ¨å†…æ ¸æ€å®Œæˆæ•°æ®æ‹·è´</p>\n</li>\n<li>\n<p>å®ç°æ‹·è´æ–¹æ³•ï¼šmmap+write(RocketMQ)ï¼Œsendfile(Kafa)ï¼Œsendfile+DMAæ”¶é›†ï¼Œspliceæ–¹å¼</p>\n</li>\n<li>\n<p>mmapæ˜¯Linuxæä¾›çš„ä¸€ç§å†…å­˜æ˜ å°„æ–‡ä»¶çš„æœºåˆ¶ï¼Œå°†å†…æ ¸ä¸­è¯»ç¼“å†²åŒºåœ°å€ä¸ç”¨æˆ·ç©ºé—´ç¼“å†²åŒºåœ°å€è¿›è¡Œæ˜ å°„ï¼Œå®ç°å†…æ ¸ç¼“å†²åŒºä¸ç”¨æˆ·ç¼“å†²åŒºçš„å…±äº«ã€‚æ•ˆæœæ˜¯å°†è¯»å†™2ä¸ªCPUæ‹·è´æ”¹ä¸º1ä¸ªå†…æ ¸ç¼“å†²åŒºåˆ°socketç¼“å†²åŒºçš„CPUæ‹·è´ï¼Œmmapå¯¹å¤§æ–‡ä»¶ä¼ è¾“æœ‰ä¼˜åŠ¿ï¼Œè€Œå°æ–‡ä»¶å¯èƒ½å‡ºç°ç¢ç‰‡ï¼›å½“ä½ çš„ç¨‹åºmapäº†ä¸€ä¸ªæ–‡ä»¶ï¼Œç„¶åè¢«å¦ä¸€ä¸ªè¿›ç¨‹æˆªæ–­(truncate)æ—¶, writeç³»ç»Ÿè°ƒç”¨ä¼šå› ä¸ºè®¿é—®éæ³•åœ°å€è€Œè¢«SIGBUSä¿¡å·ç»ˆæ­¢ã€‚SIGBUSä¿¡å·é»˜è®¤ä¼šæ€æ­»ä½ çš„è¿›ç¨‹å¹¶äº§ç”Ÿä¸€ä¸ªcoredumpå¹¶ä¸­æ­¢æœåŠ¡ï¼›ä¸å¯é ï¼Œå†™åˆ°mmapä¸­çš„æ•°æ®å¹¶æ²¡æœ‰è¢«çœŸæ­£çš„å†™åˆ°ç¡¬ç›˜ï¼Œæ“ä½œç³»ç»Ÿä¼šåœ¨ç¨‹åºä¸»åŠ¨è°ƒç”¨flushçš„æ—¶å€™æ‰æŠŠæ•°æ®çœŸæ­£çš„å†™åˆ°ç¡¬ç›˜<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d537052894e30f887dfb5.jpg\" alt=\"mmapandwritemodel.jpg\"></p>\n</li>\n<li>\n<p>sendfileæ–¹å¼ï¼Œå»ºç«‹äº†ä¸¤ä¸ªæ–‡ä»¶ä¹‹é—´çš„ä¼ è¾“é€šé“ã€‚æ•ˆæœæ˜¯å°‘äº†(è¯»æ•°æ®æ—¶å†…æ ¸åˆ°ç”¨æˆ·å’Œå†™æ•°æ®æ—¶ç”¨æˆ·åˆ°å†…æ ¸)2æ¬¡çŠ¶æ€åˆ‡æ¢å’Œå°†è¯»å†™2ä¸ªCPUæ‹·è´æ”¹ä¸º1ä¸ªå†…æ ¸ç¼“å†²åŒºåˆ°socketç¼“å†²åŒºçš„CPUæ‹·è´ï¼Œç”±äºæ•°æ®ä¸ç»è¿‡ç”¨æˆ·ç¼“å†²åŒºï¼Œå› æ­¤è¯¥æ•°æ®æ— æ³•è¢«ä¿®æ”¹ã€‚åªæœ‰2æ¬¡çŠ¶æ€åˆ‡æ¢ã€1æ¬¡CPUæ‹·è´ã€2æ¬¡DMAæ‹·è´ã€‚ä½†æ˜¯sendfileåœ¨å†…æ ¸ç¼“å†²åŒºå’Œsocketç¼“å†²åŒºä»ç„¶å­˜åœ¨ä¸€æ¬¡CPUæ‹·è´<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/19b55697111330ca1a1b2.jpg\" alt=\"sendfileandwritemodel.jpg\"></p>\n</li>\n<li>\n<p>sendfile+DMAæ”¶é›†ï¼Œéœ€è¦ç¡¬ä»¶DMAæ§åˆ¶å™¨çš„é…åˆã€‚å‡çº§åçš„sendfileå°†å†…æ ¸ç©ºé—´ç¼“å†²åŒºä¸­å¯¹åº”çš„æ•°æ®æè¿°ä¿¡æ¯ï¼ˆæ–‡ä»¶æè¿°ç¬¦ã€åœ°å€åç§»é‡ç­‰ä¿¡æ¯ï¼‰è®°å½•åˆ°socketç¼“å†²åŒºä¸­ã€‚DMAæ§åˆ¶å™¨æ ¹æ®socketç¼“å†²åŒºä¸­çš„åœ°å€å’Œåç§»é‡å°†æ•°æ®ä»å†…æ ¸ç¼“å†²åŒºæ‹·è´åˆ°ç½‘å¡ä¸­ï¼Œåªæœ‰2æ¬¡çŠ¶æ€åˆ‡æ¢ã€0æ¬¡CPUæ‹·è´ã€2æ¬¡DMAæ‹·è´ï¼Œä½†æ˜¯ä»ç„¶æ— æ³•å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå¹¶ä¸”éœ€è¦ç¡¬ä»¶å±‚é¢DMAçš„æ”¯æŒï¼Œå¹¶ä¸”sendfileåªèƒ½å°†æ–‡ä»¶æ•°æ®æ‹·è´åˆ°socketæè¿°ç¬¦ä¸Šï¼Œæœ‰å±€é™æ€§<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0460e61b4ca24d6b947cb.jpg\" alt=\"sendfileanddmamodel.jpg\"></p>\n</li>\n<li>\n<p>spliceæ— éœ€ç¡¬ä»¶æ”¯æŒï¼Œå¹¶ä¸”ä¸å†é™å®šäºsocketä¸Šï¼Œå®ç°ä¸¤ä¸ªæ™®é€šæ–‡ä»¶ä¹‹é—´çš„æ•°æ®é›¶æ‹·è´ã€‚spliceç³»ç»Ÿè°ƒç”¨å¯ä»¥åœ¨å†…æ ¸ç¼“å†²åŒºå’Œsocketç¼“å†²åŒºä¹‹é—´å»ºç«‹ç®¡é“æ¥ä¼ è¾“æ•°æ®ï¼Œé¿å…äº†ä¸¤è€…ä¹‹é—´çš„CPUæ‹·è´æ“ä½œã€‚spliceçš„ä¸¤ä¸ªæ–‡ä»¶æè¿°ç¬¦å‚æ•°ä¸­æœ‰ä¸€ä¸ªå¿…é¡»æ˜¯ç®¡é“è®¾å¤‡<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0c7eec840e083b88c0e99.jpg\" alt=\"splicemodel.jpg\"></p>\n</li>\n</ul>\n<h1>50. æ³›å‹å’Œç±»å‹æ“¦é™¤åŸç†?</h1>\n<ul>\n<li>æ³›å‹ï¼ˆgenericsï¼‰æä¾›äº†ç¼–è¯‘æ—¶ç±»å‹å®‰å…¨æ£€æµ‹æœºåˆ¶ï¼Œæœ¬è´¨æ˜¯å‚æ•°åŒ–ç±»å‹ï¼Œæ‰€æ“ä½œçš„æ•°æ®ç±»å‹è¢«æŒ‡å®šä¸ºä¸€ä¸ªå‚æ•°ã€‚</li>\n<li>å¥½å¤„æ˜¯ç¼–è¯‘æ—¶æ£€æŸ¥ç±»å‹å®‰å…¨ï¼Œå¹¶ä¸”æ‰€æœ‰çš„å¼ºåˆ¶è½¬æ¢éƒ½æ˜¯è‡ªåŠ¨å’Œéšå¼çš„ï¼Œä¸éœ€è¦ä½¿ç”¨æ˜¾å¼è½¬æ¢å’ŒinstanceOfæ“ä½œç¬¦ï¼Œæé«˜ä»£ç é‡ç”¨ç‡</li>\n<li>æ³›å‹æ“¦é™¤æ˜¯æŒ‡ç¼–è¯‘å™¨åœ¨ç¼–è¯‘æ—¶æ“¦æ“¦é™¤äº†æ‰€æœ‰ç±»å‹ç›¸å…³çš„ä¿¡æ¯ï¼Œæ‰€ä»¥åœ¨è¿è¡Œæ—¶ä¸å­˜åœ¨ä»»ä½•ç±»å‹ç›¸å…³çš„ä¿¡æ¯</li>\n<li>ä¸ºä»€ä¹ˆéœ€è¦æ³›å‹æ“¦é™¤ï¼Ÿä¸ºäº†å‘ä¸‹å…¼å®¹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æ³›å‹ç±»\n//åœ¨å®ä¾‹åŒ–æ³›å‹ç±»æ—¶ï¼Œå¿…é¡»æŒ‡å®šTçš„å…·ä½“ç±»å‹Generic&lt;Integer&gt; genericInteger = new Generic&lt;Integer&gt;(123456);\npublic class Generic&lt;T&gt;{\n    private T key;\n    public Generic(T key) {this.key = key;}\n    public T getKey(){return key;}\n}\n//æ³›å‹æ¥å£\npublic interface Generator&lt;T&gt; {\n    public T method(T key);\n}\n//å®ç°æ³›å‹æ¥å£ï¼ŒæŒ‡å®šç±»å‹ï¼š\nclass GeneratorImpl&lt;T&gt; implements Generator&lt;String&gt;{\n    @Override\n    public String method() {\n        return \"hello\";\n    }\n}\n//æ³›å‹æ–¹æ³•\npublic static &lt;E&gt; void printArray(E[] inputArray)\n{\n  for (E element:inputArray){\n    System.out.printf(\"%s\", element);\n  }\n  System.out.println();\n}\n// åˆ›å»ºä¸åŒç±»å‹æ•°ç»„ï¼š Integer, Double å’Œ Character\nInteger[] intArray = { 1, 2, 3 };\nString[] stringArray = { \"Hello\", \"World\" };\nprintArray( intArray  );\nprintArray( stringArray  );\n</code></pre></div><h1>51. Listä¸­æ³›å‹çš„åŒºåˆ«?</h1>\n<ul>\n<li>List&lt;? extends T&gt;æ¥å—ä»»ä½•ç»§æ‰¿è‡ªTçš„ç±»å‹çš„List</li>\n<li>List&lt;? super T&gt;æ¥å—ä»»ä½•Tçš„çˆ¶ç±»æ„æˆçš„List</li>\n</ul>\n<h1>52. è¯´ä¸€ä¸‹ä½ å¯¹æ³¨è§£çš„ç†è§£ï¼Ÿ</h1>\n<ul>\n<li>æ³¨è§£æœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªæ ‡è®°ï¼Œæ³¨è§£å¯ä»¥æ ‡è®°åœ¨ç±»ä¸Šã€æ–¹æ³•ä¸Šã€å±æ€§ä¸Šç­‰ï¼Œæ ‡è®°è‡ªèº«ä¹Ÿå¯ä»¥è®¾ç½®ä¸€äº›å€¼</li>\n<li>æ³¨è§£ç”Ÿå‘½å‘¨æœŸæœ‰ä¸‰å¤§ç±»ï¼Œåˆ†åˆ«æ˜¯ï¼š\n<ul>\n<li>RetentionPolicy.SOURCEï¼šç»™ç¼–è¯‘å™¨ç”¨çš„ï¼Œä¸ä¼šå†™å…¥classæ–‡ä»¶@Override,lombokæ³¨è§£</li>\n<li>RetentionPolicy.CLASSï¼šä¼šå†™å…¥classæ–‡ä»¶ï¼Œåœ¨ç±»åŠ è½½é˜¶æ®µä¸¢å¼ƒï¼Œä¹Ÿå°±æ˜¯è¿è¡Œçš„æ—¶å€™å°±æ²¡è¿™ä¸ªä¿¡æ¯äº†</li>\n<li>RetentionPolicy.RUNTIMEï¼šä¼šå†™å…¥classæ–‡ä»¶ï¼Œæ°¸ä¹…ä¿å­˜ï¼Œå¯ä»¥é€šè¿‡åå°„è·å–æ³¨è§£ä¿¡æ¯@Autowired.AOPæ³¨è§£</li>\n</ul>\n</li>\n</ul>\n<h1>53. ä»€ä¹ˆæ˜¯åå°„ï¼Ÿä¼˜ç¼ºç‚¹ï¼Ÿåº”ç”¨åœºæ™¯ï¼Ÿ</h1>\n<ul>\n<li>åœ¨ç¨‹åºçš„è¿è¡ŒçŠ¶æ€ä¸­ï¼Œå¯ä»¥æ„é€ ä»»æ„ä¸€ä¸ªç±»çš„å¯¹è±¡ï¼Œäº†è§£ä»»æ„ä¸€ä¸ªå¯¹è±¡æ‰€å±çš„ç±»ï¼Œäº†è§£ä»»æ„ä¸€ä¸ªç±»çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•ï¼Œè°ƒç”¨ä»»æ„ä¸€ä¸ªå¯¹è±¡çš„å±æ€§å’Œæ–¹æ³•ã€‚è¿™ç§åŠ¨æ€è·å–ç¨‹åºä¿¡æ¯ä»¥åŠåŠ¨æ€è°ƒç”¨å¯¹è±¡çš„åŠŸèƒ½ç§°ä¸ºåå°„æœºåˆ¶</li>\n<li>ä¼˜ç‚¹ï¼šè¿è¡ŒæœŸç±»å‹çš„åˆ¤æ–­ï¼ŒåŠ¨æ€åŠ è½½ç±»ï¼Œæé«˜ä»£ç çµæ´»åº¦</li>\n<li>ç¼ºç‚¹ï¼šåå°„ç›¸å½“äºè§£é‡Šæ“ä½œï¼Œæ€§èƒ½æ¯”ç›´æ¥çš„javaä»£ç è¦æ…¢å¾ˆå¤š</li>\n<li>åŠŸèƒ½ï¼š\n<ul>\n<li>åœ¨è¿è¡Œæ—¶æ„é€ ä¸€ä¸ªç±»çš„å¯¹è±¡</li>\n<li>åˆ¤æ–­ä¸€ä¸ªç±»æ‰€å…·æœ‰çš„æˆå‘˜å˜é‡å’Œæ–¹æ³•</li>\n<li>è°ƒç”¨ä¸€ä¸ªå¯¹è±¡çš„æ–¹æ³•</li>\n<li>ç”ŸæˆåŠ¨æ€ä»£ç†</li>\n</ul>\n</li>\n<li>åº”ç”¨åœºæ™¯\n<ul>\n<li>JDBCè¿æ¥æ•°æ®åº“æ—¶ä½¿ç”¨Class.forName()é€šè¿‡åå°„åŠ è½½æ•°æ®åº“çš„é©±åŠ¨ç¨‹åº</li>\n<li>Springé€šè¿‡XMLé…ç½®åå°„è£…è½½Beançš„è¿‡ç¨‹</li>\n<li>Javaç±»é‡Œé¢è§£æxmlæˆ–propertiesé‡Œé¢çš„å†…å®¹ï¼Œå¾—åˆ°å¯¹åº”å®ä½“ç±»çš„å­—èŠ‚ç å­—ç¬¦ä¸²ä»¥åŠç›¸å…³çš„å±æ€§ä¿¡æ¯</li>\n<li>ä½¿ç”¨åå°„æœºåˆ¶ï¼Œæ ¹æ®è¿™ä¸ªå­—ç¬¦ä¸²è·å¾—æŸä¸ªç±»çš„Classå®ä¾‹ï¼Œæ³¨è§£ç­‰ä¿¡æ¯</li>\n<li>åŠ¨æ€é…ç½®å®ä¾‹çš„å±æ€§</li>\n<li>å·¥å‚æ¨¡å¼ï¼Œä½¿ç”¨åå°„æœºåˆ¶ï¼Œæ ¹æ®å…¨é™å®šç±»åè·å¾—æŸä¸ªç±»çš„Classå®ä¾‹</li>\n</ul>\n</li>\n<li>åŸç†ï¼šJavaç¨‹åºæ‰§è¡Œåˆ†ä¸ºç¼–è¯‘å’Œè¿è¡Œä¸¤æ­¥ï¼Œç¼–è¯‘ä¹‹åä¼šç”Ÿæˆå­—èŠ‚ç (.class)æ–‡ä»¶ï¼ŒJVMç±»åŠ è½½çš„æ—¶å€™ï¼Œä¼šåŠ è½½å­—èŠ‚ç æ–‡ä»¶ï¼Œå°†ç±»å‹ç›¸å…³çš„æ‰€æœ‰ä¿¡æ¯åŠ è½½è¿›æ–¹æ³•åŒºï¼Œåå°„å°±æ˜¯å»è·å–è¿™äº›ä¿¡æ¯ï¼Œç„¶åè¿›è¡Œå„ç§æ“ä½œ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c196cc46ea032f3e55685.png\" alt=\"javareflect.png\"></li>\n</ul>\n<h1>54. åå°„ä¸­ï¼ŒClass.forNameå’ŒClassLoaderåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>éƒ½å¯ç”¨æ¥å¯¹ç±»è¿›è¡ŒåŠ è½½</li>\n<li>Class.forName(...)æ–¹æ³•ä¼šå°†ç±»çš„.classæ–‡ä»¶åŠ è½½åˆ°JVMå¹¶å¯¹ç±»è¿›è¡Œè§£é‡Šå¹¶æ‰§è¡Œç±»ä¸­çš„staticå—</li>\n<li>ClassLoaderåªä¼šå°†.classæ–‡ä»¶åŠ è½½åˆ°JVMä¸­ï¼Œåœ¨newInstanceæ‰æ‰§è¡Œç±»ä¸­çš„staticå—</li>\n<li>Class.forName(name, initialize, loader) æ–¹æ³•ä¹Ÿå¯æ§åˆ¶æ˜¯å¦åŠ è½½staticå—ï¼Œå¹¶ä¸”åªæœ‰è°ƒç”¨äº†newInstanceæ–¹æ³•é‡‡ç”¨è°ƒç”¨æ„é€ å‡½æ•°ï¼Œåˆ›å»ºç±»çš„å¯¹è±¡ã€‚</li>\n</ul>\n<h1>55. jdk1.8æ–°ç‰¹æ€§</h1>\n<ul>\n<li>æ¥å£é»˜è®¤æ–¹æ³•ï¼šå…è®¸ç»™æ¥å£æ·»åŠ ä¸€ä¸ªéæŠ½è±¡çš„æ–¹æ³•å®ç°ï¼Œä½¿ç”¨defaultå…³é”®å­—ä¿®é¥°</li>\n<li>Lambdaè¡¨è¾¾å¼å’Œå‡½æ•°å¼æ¥å£ï¼šLambdaè¡¨è¾¾å¼æœ¬è´¨ä¸Šæ˜¯ä¸€æ®µåŒ¿åå†…éƒ¨ç±»ï¼Œå…è®¸æŠŠå‡½æ•°ä½œä¸ºä¸€ä¸ªæ–¹æ³•çš„å‚æ•°ï¼ˆå‡½æ•°ä½œä¸ºå‚æ•°ä¼ é€’åˆ°æ–¹æ³•ä¸­ï¼‰ï¼Œä½¿ä»£ç æ›´åŠ ç®€æ´ï¼Œä½†æœ€å¥½ä¸è¦è¶…è¿‡3è¡Œ</li>\n<li>Stream APIï¼šç”¨å‡½æ•°å¼ç¼–ç¨‹æ–¹å¼åœ¨é›†åˆç±»ä¸Šè¿›è¡Œå¤æ‚æ“ä½œçš„å·¥å…·ï¼Œé…åˆLambdaè¡¨è¾¾å¼å¯ä»¥æ–¹ä¾¿çš„å¯¹é›†åˆè¿›è¡Œå¤„ç†</li>\n<li>æ—¥æœŸæ—¶é—´APIï¼šJava 8 å¼•å…¥äº†æ–°çš„æ—¥æœŸæ—¶é—´ API æ”¹è¿›äº†æ—¥æœŸæ—¶é—´çš„ç®¡ç†ã€‚</li>\n<li>Optionalç±»ï¼šç”¨æ¥è§£å†³ç©ºæŒ‡é’ˆå¼‚å¸¸çš„é—®é¢˜ã€‚</li>\n</ul>\n<h1>56. Lambdaè¡¨è¾¾å¼</h1>\n<ul>\n<li>Lambda è¡¨è¾¾å¼æœ¬è´¨ä¸Šæ˜¯ä¸€æ®µåŒ¿åå†…éƒ¨ç±»ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€æ®µå¯ä»¥ä¼ é€’çš„ä»£ç ã€‚</li>\n<li>å‡½æ•°å¼æ¥å£ï¼ˆFunctional Interfaceï¼‰ è¢«@FunctionalInterface æ³¨è§£ä¿®é¥°çš„èƒ½ç¼©å†™æˆLambdaè¡¨ç¤ºå¼ï¼Œå¦‚Runnableï¼ŒComparatorï¼ŒCallableã€Predicateã€Functionã€Supplierã€Consumerç­‰ç­‰</li>\n<li>Lambdaä¸¾ä¾‹ï¼šnew Thread( () -&gt; System.out.println(\"Thread is running since Java8!\") ).start();</li>\n</ul>\n<h1>57. Optionalä½¿ç”¨</h1>\n<ul>\n<li>Optionalæ˜¯ç”¨äºé˜²èŒƒNullPointerExceptionã€‚åŒ…è£…å¯¹è±¡ï¼ˆå¯èƒ½æ˜¯ null, ä¹Ÿæœ‰å¯èƒ½é nullï¼‰çš„å®¹å™¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Optional&lt;String&gt; optional = Optional.of(\"bam\");\n\noptional.isPresent();           // true\noptional.get();                 // \"bam\"\noptional.orElse(\"fallback\");    // \"bam\"\n\noptional.ifPresent((s) -&gt; System.out.println(s.charAt(0)));     // \"b\"\n</code></pre></div><h1>58. Streamæµç”¨è¿‡å—ï¼Ÿ</h1>\n<ul>\n<li>Streamå¯¹ä¸€ä¸ªåŒ…å«ä¸€ä¸ªæˆ–å¤šä¸ªå…ƒç´ çš„é›†åˆåšä¸­é—´æ“ä½œæˆ–ç»ˆç«¯æ“ä½œã€‚ç»ˆç«¯æ“ä½œä¼šè¿”å›ä¸€ä¸ªç»“æœï¼Œè€Œä¸­é—´æ“ä½œä¼šè¿”å›ä¸€ä¸ªStreamæµ</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/84dcdbd58d40d05030439.png\" alt=\"javasteam.png\" tabindex=\"0\"><figcaption>javasteam.png</figcaption></figure>\n<h1>59. mavenå¸¸ç”¨å‘½ä»¤</h1>\n<ul>\n<li>mvn packageæ‰“åŒ…åˆ°target</li>\n<li>mvn installæ‰“åŒ…åˆ°æœ¬åœ°</li>\n<li>mvn deployå‘é€åˆ°ç§æœ</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/e35afb80114c9ff59b1db.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "javaé›†åˆ",
      "url": "https://javaguide.cn/interview/javacollections.html",
      "id": "https://javaguide.cn/interview/javacollections.html",
      "summary": "1. é›†åˆç»§æ‰¿ç»“æ„ Collectionï¼Œä¸»è¦ç”± Listã€Setã€Queue ç»„æˆ Listï¼šå­˜å‚¨çš„å…ƒç´ æœ‰åºï¼Œå¯é‡å¤ã€‚åŠ¨æ€æ•°ç»„çš„ ArrayList å’Œå°è£…äº†é“¾è¡¨çš„ LinkedListï¼› Setï¼šå­˜å‚¨çš„å…ƒç´ æ— åºï¼Œä¸å¯é‡å¤ã€‚HashSet å’Œ TreeSetï¼› Queueï¼šé˜Ÿåˆ—ã€‚åŒç«¯é˜Ÿåˆ— ArrayDequeï¼Œä»¥åŠä¼˜å…ˆçº§é˜Ÿåˆ— PriorityQueu...",
      "content_html": "<!-- more -->\n<!--TOC-->\n<h1>1. é›†åˆç»§æ‰¿ç»“æ„</h1>\n<ul>\n<li>Collectionï¼Œä¸»è¦ç”± Listã€Setã€Queue ç»„æˆ\n<ul>\n<li>Listï¼šå­˜å‚¨çš„å…ƒç´ æœ‰åºï¼Œå¯é‡å¤ã€‚åŠ¨æ€æ•°ç»„çš„ ArrayList å’Œå°è£…äº†é“¾è¡¨çš„ LinkedListï¼›</li>\n<li>Setï¼šå­˜å‚¨çš„å…ƒç´ æ— åºï¼Œä¸å¯é‡å¤ã€‚HashSet å’Œ TreeSetï¼›</li>\n<li>Queueï¼šé˜Ÿåˆ—ã€‚åŒç«¯é˜Ÿåˆ— ArrayDequeï¼Œä»¥åŠä¼˜å…ˆçº§é˜Ÿåˆ— PriorityQueueã€‚</li>\n</ul>\n</li>\n<li>Mapï¼Œé”®å€¼å¯¹é›†åˆã€‚HashMapã€‚é”®ä¸èƒ½é‡å¤ï¼Œæ¯ä¸ªé”®åªèƒ½å¯¹åº”ä¸€ä¸ªå€¼ã€‚HashMapã€LinkedHashMapã€TreeMap</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9d9065dbe4e0a916ac96f.jpg\" alt=\"collection.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/bfd03cc15ac4e7881d444.jpg\" alt=\"map.png\"></p>\n<h1>2. ç®€å•ä»‹ç»ä¸€ä¸‹é˜Ÿåˆ— Queue</h1>\n<ul>\n<li>Javaé˜Ÿåˆ—ä¸»è¦é€šè¿‡ java.util.Queue æ¥å£å’Œ java.util.concurrent.BlockingQueue ä¸¤ä¸ªæ¥å£æ¥å®ç°ã€‚</li>\n<li>PriorityQueue æ˜¯ä¸€ä¸ªåŸºäºä¼˜å…ˆçº§å †çš„æ— ç•Œé˜Ÿåˆ—ï¼Œå®ƒçš„å…ƒç´ æŒ‰ç…§è‡ªç„¶é¡ºåºæ’åºæˆ–è€… Comparator è¿›è¡Œæ’åºã€‚</li>\n<li>ArrayDeque æ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„çš„åŒç«¯é˜Ÿåˆ—ï¼Œå¯ä»¥åœ¨ä¸¤ç«¯æ’å…¥å’Œåˆ é™¤å…ƒç´ ã€‚</li>\n<li>LinkedListæ—¢å¯ä»¥å½“ä½œ List ä½¿ç”¨ï¼Œä¹Ÿå¯ä»¥å½“ä½œ Queue ä½¿ç”¨ã€‚</li>\n<li>BlockingQueue çº¿ç¨‹å®‰å…¨çš„é˜Ÿåˆ—ï¼Œè¿˜æ·»åŠ äº†ç­‰å¾…/é€šçŸ¥æœºåˆ¶ï¼Œä»¥ä¾¿åœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶é˜»å¡è·å–å…ƒç´ çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—å˜å¾—å¯ç”¨ï¼Œæˆ–è€…åœ¨é˜Ÿåˆ—æ»¡æ—¶é˜»å¡æ’å…¥å…ƒç´ çš„çº¿ç¨‹ï¼Œç›´åˆ°é˜Ÿåˆ—å˜å¾—å¯ç”¨ã€‚è¢«å¹¿æ³›ç”¨äºâ€œç”Ÿäº§è€…-æ¶ˆè´¹è€…â€é—®é¢˜ä¸­ï¼Œå…¶åŸå› æ˜¯ BlockingQueue æä¾›äº†å¯é˜»å¡çš„æ’å…¥å’Œç§»é™¤æ–¹æ³•ã€‚å½“é˜Ÿåˆ—å®¹å™¨å·²æ»¡ï¼Œç”Ÿäº§è€…çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°é˜Ÿåˆ—æœªæ»¡ï¼›å½“é˜Ÿåˆ—å®¹å™¨ä¸ºç©ºæ—¶ï¼Œæ¶ˆè´¹è€…çº¿ç¨‹ä¼šè¢«é˜»å¡ï¼Œç›´è‡³é˜Ÿåˆ—éç©ºæ—¶ä¸ºæ­¢ã€‚</li>\n<li>BlockingQueue æ¥å£çš„å®ç°ç±»æœ‰ ArrayBlockingQueueã€DelayQueueã€LinkedBlockingDequeã€LinkedBlockingQueueã€LinkedTransferQueueã€PriorityBlockingQueueã€SynchronousQueue ç­‰ã€‚</li>\n<li>é˜»å¡æŒ‡çš„æ˜¯ä¸€ç§ç¨‹åºæ‰§è¡ŒçŠ¶æ€ï¼Œå…¶ä¸­æŸä¸ªçº¿ç¨‹åœ¨ç­‰å¾…æŸä¸ªæ¡ä»¶æ»¡è¶³æ—¶æš‚åœå…¶æ‰§è¡Œï¼ˆå³é˜»å¡ï¼‰ï¼Œç›´åˆ°æ¡ä»¶æ»¡è¶³æ—¶æ¢å¤å…¶æ‰§è¡Œã€‚</li>\n</ul>\n<h1>3. é˜»å¡é˜Ÿåˆ—æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h1>\n<ul>\n<li>ArrayBlockingQueueæ˜¯ä¸€ä¸ªåŸºäºæ•°ç»„çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œé‡‡ç”¨ ReentrantLock é”æ¥å®ç°çº¿ç¨‹çš„äº’æ–¥ï¼Œè€Œ ReentrantLock åº•å±‚é‡‡ç”¨çš„æ˜¯ AQS å®ç°çš„é˜Ÿåˆ—åŒæ­¥ï¼Œçº¿ç¨‹çš„é˜»å¡è°ƒç”¨ LockSupport.park å®ç°ï¼Œå”¤é†’è°ƒç”¨ LockSupport.unpark å®ç°ã€‚</li>\n</ul>\n<h1>4. é˜Ÿåˆ—å’Œæ ˆçš„åŒºåˆ«</h1>\n<ul>\n<li>é˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡ºï¼ˆFIFO, First-In-First-Outï¼‰çš„æ•°æ®ç»“æ„ã€‚åœ¨é˜Ÿåˆ—ä¸­ï¼Œç¬¬ä¸€ä¸ªåŠ å…¥é˜Ÿåˆ—çš„å…ƒç´ ä¼šæ˜¯ç¬¬ä¸€ä¸ªè¢«ç§»é™¤çš„ã€‚é˜Ÿåˆ—å¸¸ç”¨äºå¤„ç†æŒ‰é¡ºåºæ¥çš„ä»»åŠ¡ã€‚</li>\n<li>æ ˆæ˜¯ä¸€ç§åè¿›å…ˆå‡ºï¼ˆLIFO, Last-In-First-Outï¼‰çš„æ•°æ®ç»“æ„ã€‚åœ¨è¿™ç§ç»“æ„ä¸­ï¼Œæœ€åä¸€ä¸ªåŠ å…¥æ ˆçš„å…ƒç´ ä¼šæ˜¯ç¬¬ä¸€ä¸ªè¢«ç§»é™¤çš„ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—æ ˆéå¸¸é€‚åˆäºé‚£äº›éœ€è¦è®¿é—®æœ€æ–°æ·»åŠ çš„æ•°æ®å…ƒç´ çš„åœºåˆã€‚</li>\n</ul>\n<h1>5. ArrayListå’ŒLinkedListåŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>ArrayListåŸºäºæ•°ç»„å®ç°ï¼ŒLinkedListåŸºäºåŒå‘é“¾è¡¨å®ç°</li>\n<li>ArrayListæŸ¥æ‰¾å¿«(æ•°ç»„ä¸‹æ ‡æŸ¥æ‰¾)ï¼Œå¢åˆ æ…¢(éœ€è¦å¤åˆ¶æ•°ç»„å’Œç§»åŠ¨å…ƒç´ )ï¼Œé€‚åˆé¡ºåºæ·»åŠ ã€éšæœºè®¿é—®åœºæ™¯ï¼›LinkedListæŸ¥æ‰¾æ…¢(ç§»åŠ¨æŒ‡é’ˆä»å‰å¾€åä¾æ¬¡æŸ¥æ‰¾)ã€å¢åˆ å¿«(æ”¹å˜å‰åé©±èŠ‚ç‚¹æŒ‡å‘)é€‚åˆå¤šæ¬¡å¢åŠ åˆ é™¤ä¿®æ”¹åœºæ™¯</li>\n<li>ArrayListæ”¯æŒéšæœºè®¿é—®ï¼Œå¯é€šè¿‡ä¸‹æ ‡ç›´æ¥è·å–å…ƒç´ ï¼Œå®ç°äº†RandmoAccessæ¥å£ï¼ŒLinkedListä¸æ”¯æŒï¼Œæ²¡æœ‰å®ç°RandmoAccessæ¥å£</li>\n<li>ArrayListåŸºäºæ•°ç»„ï¼Œæ˜¯ä¸€å—è¿ç»­çš„å†…å­˜ç©ºé—´ï¼Œæ‰©å®¹åç©ºé—´æ˜¯åŸæ¥çš„1.5å€ï¼Œå¯èƒ½ä¼šæœ‰ç©ºçš„å†…å­˜ç©ºé—´ï¼Œå­˜åœ¨ä¸€å®šç©ºé—´æµªè´¹ï¼ŒLinkedListåŸºäºé“¾è¡¨ï¼Œå†…å­˜ç©ºé—´ä¸è¿ç»­ï¼Œæ¯ä¸ªèŠ‚ç‚¹éœ€è¦å­˜å‚¨å‰é©±å’Œåç»§ï¼Œæ‰€ä»¥ä¼šå ç”¨æ›´å¤šçš„ç©ºé—´</li>\n</ul>\n<h1>6. ArrayListæ‰©å®¹æœºåˆ¶ï¼Ÿ</h1>\n<ul>\n<li>ArrayListåŸºäºæ•°ç»„å®ç°ï¼Œæ•°ç»„çš„å®¹é‡æ˜¯åœ¨å®šä¹‰çš„æ—¶å€™ç¡®å®šçš„ï¼Œåœ¨æ’å…¥æ—¶å€™ï¼Œä¼šå…ˆæ£€æŸ¥æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå¦‚æœå½“å‰å®¹é‡+1è¶…è¿‡æ•°ç»„é•¿åº¦ï¼Œå°±ä¼šè¿›è¡Œæ‰©å®¹</li>\n<li>æ‰©å®¹æ˜¯åˆ›å»ºä¸€ä¸ª1.5å€çš„æ–°æ•°ç»„ï¼Œç„¶åæŠŠåŸæ•°ç»„çš„å€¼æ‹·è´è¿‡å»</li>\n<li>åˆå§‹å®¹é‡10ï¼Œåˆå§‹åŒ–æŒ‡å®šå®¹é‡ä¼šæå‡æ€§èƒ½</li>\n</ul>\n<h1>7. ArrayListæ€ä¹ˆåºåˆ—åŒ–?ä¸ºä»€ä¹ˆç”¨transientä¿®é¥°æ•°ç»„?</h1>\n<ul>\n<li>ArrayListé€šè¿‡ä¸¤ä¸ªæµObjectOutputStreamå’ŒObjectInputStreamçš„ä¸¤ä¸ªæ–¹æ³•readObjectã€writeObjectè¿›è¡Œåºåˆ—åŒ–å’Œååºåˆ—åŒ–ã€‚jsonåºåˆ—åŒ–ä¹Ÿå¯ä»¥</li>\n<li>å› ä¸ºArrayListçš„æ•°ç»„ä¸­æœ‰éƒ¨åˆ†æ•°æ®æ˜¯nullå­˜åœ¨å†…å­˜æµªè´¹ï¼ŒåŒæ—¶å‡å°‘ä¸å¿…è¦åºåˆ—åŒ–å’Œååºåˆ—åŒ–ï¼ŒArrayListä½¿ç”¨transientä¿®é¥°å­˜å‚¨å…ƒç´ çš„elementDataçš„æ•°ç»„ï¼Œä½¿ä¹‹ä¸è¢«åºåˆ—åŒ–ã€‚</li>\n</ul>\n<h1>8. å¹¶å‘ä¿®æ”¹å¼‚å¸¸å’Œé›†åˆçš„å¿«é€Ÿå¤±è´¥(fail-fast)?</h1>\n<ul>\n<li>å¿«é€Ÿå¤±è´¥(failâ€”fast)ï¼šJava é›†åˆçš„ä¸€ç§é”™è¯¯æ£€æµ‹æœºåˆ¶ï¼Œåœ¨ç”¨è¿­ä»£å™¨éå†ä¸€ä¸ªé›†åˆå¯¹è±¡æ—¶ï¼Œå¦‚æœçº¿ç¨‹Aéå†è¿‡ç¨‹ä¸­ï¼Œçº¿ç¨‹Bå¯¹é›†åˆå¯¹è±¡çš„å†…å®¹è¿›è¡Œäº†ä¿®æ”¹ï¼ˆå¢åŠ ã€åˆ é™¤ã€ä¿®æ”¹ï¼‰ï¼Œåˆ™ä¼šæŠ›å‡ºConcurrentModificationException</li>\n<li>åŸç†ï¼šè¿­ä»£å™¨åœ¨éå†æ—¶ä½¿ç”¨ä¸€ä¸ªmodCountå˜é‡ã€‚éå†å¼€å§‹æ—¶èµ‹å€¼ç»™expectedmodCountï¼Œé›†åˆåœ¨è¢«éå†æœŸé—´å¦‚æœå†…å®¹å‘ç”Ÿå˜åŒ–ï¼Œå°±ä¼šæ”¹å˜modCountçš„å€¼ã€‚æ¯å½“è¿­ä»£å™¨ä½¿ç”¨ hashNext()/next()éå†ä¸‹ä¸€ä¸ªå…ƒç´ ä¹‹å‰ï¼Œéƒ½ä¼šæ£€æµ‹modCountå˜é‡æ˜¯å¦ä¸º expectedmodCountå€¼ï¼Œæ˜¯çš„è¯å°±è¿”å›éå†ï¼›å¦åˆ™æŠ›å‡ºå¼‚å¸¸ï¼Œç»ˆæ­¢éå†ã€‚</li>\n<li>åœºæ™¯ï¼šjava.utilåŒ…ä¸‹çš„é›†åˆç±»éƒ½æ˜¯å¿«é€Ÿå¤±è´¥çš„ï¼Œä¸èƒ½åœ¨å¤šçº¿ç¨‹ä¸‹å‘ç”Ÿå¹¶å‘ä¿®æ”¹ï¼ˆè¿­ä»£è¿‡ç¨‹ä¸­è¢«ä¿®æ”¹ï¼‰ï¼Œå¦‚ArrayList</li>\n<li>è§£å†³æ–¹æ³•ï¼šå¤šçº¿ç¨‹ä¸‹æ‰€æœ‰æ¶‰åŠåˆ°æ”¹å˜modCountå€¼å¾—åœ°æ–¹å…¨éƒ¨åŠ ä¸Šsynchronizedã€‚ä½¿ç”¨CopyOnWriteArrayListæ¥æ›¿æ¢ArrayList</li>\n<li>å¦‚ä½•åˆ é™¤å…ƒç´ \n<ul>\n<li>ä½¿ç”¨Iteratorï¼Œé¡ºåºå‘ä¸‹ï¼Œå¦‚æœæ‰¾åˆ°å…ƒç´ ä½¿ç”¨removeæ–¹æ³•ç§»é™¤</li>\n<li>å€’åºéå†Listï¼Œå¦‚æœæ‰¾åˆ°å…ƒç´ ä½¿ç”¨removeæ–¹æ³•ç§»é™¤</li>\n</ul>\n</li>\n</ul>\n<h1>9. å®‰å…¨å¤±è´¥(fail-safe)?</h1>\n<ul>\n<li>é‡‡ç”¨å®‰å…¨å¤±è´¥æœºåˆ¶çš„é›†åˆå®¹å™¨ï¼Œåœ¨éå†æ—¶ä¸æ˜¯ç›´æ¥åœ¨é›†åˆå†…å®¹ä¸Šè®¿é—®çš„ï¼Œè€Œæ˜¯å…ˆå¤åˆ¶åŸæœ‰é›†åˆå†…å®¹ï¼Œåœ¨æ‹·è´çš„é›†åˆä¸Šè¿›è¡Œéå†</li>\n<li>åŸç†ï¼šç”±äºè¿­ä»£æ—¶æ˜¯å¯¹åŸé›†åˆçš„æ‹·è´è¿›è¡Œéå†ï¼Œæ‰€ä»¥åœ¨éå†è¿‡ç¨‹ä¸­å¯¹åŸé›†åˆæ‰€ä½œçš„ä¿®æ”¹å¹¶ä¸èƒ½è¢«è¿­ä»£å™¨æ£€æµ‹åˆ°ï¼Œæ‰€ä»¥ä¸ä¼šè§¦å‘ConcurrentModificationException</li>\n<li>ç¼ºç‚¹ï¼šåŸºäºæ‹·è´å†…å®¹çš„ä¼˜ç‚¹æ˜¯é¿å…äº†ConcurrentModificationExceptionï¼Œä½†è¿­ä»£å™¨å¹¶ä¸èƒ½è®¿é—®åˆ°ä¿®æ”¹åçš„å†…å®¹</li>\n<li>åœºæ™¯ï¼šjava.util.concurrentåŒ…ä¸‹çš„å®¹å™¨éƒ½æ˜¯å®‰å…¨å¤±è´¥ï¼Œå¯ä»¥åœ¨å¤šçº¿ç¨‹ä¸‹å¹¶å‘ä¿®æ”¹ï¼Œå¦‚CopyOnWriteArrayList</li>\n</ul>\n<h1>10. å¦‚ä½•ä¿è¯ArrayListçº¿ç¨‹å®‰å…¨?</h1>\n<ul>\n<li>ä½¿ç”¨Collections.synchronizedListåŒ…è£…ArrayListï¼Œç„¶åæ“ä½œåŒ…è£…åçš„listã€‚</li>\n<li>ä½¿ç”¨CopyOnWriteArrayListä»£æ›¿ArrayListã€‚</li>\n<li>ä½¿ç”¨ArrayListæ—¶é€šè¿‡åŒæ­¥æœºåˆ¶å»æ§åˆ¶ArrayListè¯»å†™ã€‚</li>\n</ul>\n<h1>11. CopyOnWriteArrayListï¼Ÿ</h1>\n<ul>\n<li>çº¿ç¨‹å®‰å…¨ç‰ˆæœ¬çš„ ArrayListã€‚é‡‡ç”¨è¯»å†™åˆ†ç¦»çš„å¹¶å‘ç­–ç•¥ã€‚å…è®¸å¹¶å‘è¯»ï¼Œè¯»æ“ä½œæ˜¯æ— é”çš„ï¼Œæ€§èƒ½é«˜ã€‚å†™æ“ä½œé¦–å…ˆå°†å½“å‰å®¹å™¨å¤åˆ¶ä¸€ä»½ï¼Œç„¶ååœ¨æ–°å‰¯æœ¬ä¸Šæ‰§è¡Œå†™æ“ä½œï¼Œç»“æŸä¹‹åå†å°†åŸå®¹å™¨çš„å¼•ç”¨æŒ‡å‘æ–°å®¹å™¨ã€‚</li>\n</ul>\n<h1>12. hashMapçš„å®ç°åŸç†/åº•å±‚æ•°æ®ç»“æ„?</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c204ae8e1025043161cad.png\" alt=\"hashmapstructure.png\" tabindex=\"0\"><figcaption>hashmapstructure.png</figcaption></figure>\n<ul>\n<li>jdk1.8çš„æ•°æ®ç»“æ„æ˜¯Nodeæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ï¼Œ</li>\n<li>HashMapçš„Nodeæ•°ç»„ç”¨äºå­˜å‚¨é”®å€¼å¯¹,å½“å‘ HashMap ä¸­æ·»åŠ ä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼Œä¼šä½¿ç”¨å“ˆå¸Œå‡½æ•°è®¡ç®—é”®çš„å“ˆå¸Œç ï¼Œç¡®å®šå…¶åœ¨æ•°ç»„ä¸­çš„ä½ç½®ï¼Œå½“å¤šä¸ªé”®ç»å“ˆå¸Œå¤„ç†åå¾—åˆ°ç›¸åŒçš„ç´¢å¼•æ—¶ï¼Œä¼šå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œå¦‚æœé”®å·²ç»å­˜åœ¨ï¼Œå…¶å¯¹åº”çš„å€¼å°†è¢«æ–°å€¼è¦†ç›–ã€‚å¦åˆ™æ–°å…ƒç´ å°†è¢«æ·»åŠ åˆ°é“¾è¡¨çš„æœ«å°¾ã€‚ä¸ºäº†æå‡æŸ¥è¯¢æ€§èƒ½ã€‚å½“é“¾è¡¨ä¸Šçš„å…ƒç´ ä¸ªæ•°è¶…è¿‡8ä¸ªä¸”æ•°ç»„å¤§å°&gt;=64æ—¶ï¼Œé“¾è¡¨è½¬åŒ–æˆçº¢é»‘æ ‘ï¼ŒèŠ‚ç‚¹å˜æˆæ ‘èŠ‚ç‚¹ï¼Œçº¢é»‘æ ‘çš„æŸ¥è¯¢æ•ˆç‡æ˜¯ O(logN)ï¼Œæ¯”é“¾è¡¨çš„ O(n) è¦å¿«ã€‚æ•°ç»„çš„æŸ¥è¯¢æ•ˆç‡æ˜¯ O(1)ã€‚ä½†æ˜¯å½“çº¢é»‘æ ‘èŠ‚ç‚¹ä¸ªæ•°å°äº6æ—¶è½¬ä¸ºé“¾è¡¨ï¼›å½“ä» HashMap ä¸­è·å–å…ƒç´ æ—¶ï¼Œä¹Ÿä¼šä½¿ç”¨å“ˆå¸Œå‡½æ•°è®¡ç®—é”®çš„ä½ç½®ï¼Œç„¶åæ ¹æ®ä½ç½®åœ¨æ•°ç»„ã€é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ä¸­æŸ¥æ‰¾å…ƒç´ ã€‚</li>\n<li>HashMap çš„åˆå§‹å®¹é‡æ˜¯ 16ï¼Œéšç€å…ƒç´ çš„ä¸æ–­æ·»åŠ ï¼ŒHashMap çš„å®¹é‡ï¼ˆæ•°ç»„å¤§å°ï¼‰å¯èƒ½ä¸è¶³ï¼Œéœ€è¦è¿›è¡Œæ‰©å®¹ï¼Œé˜ˆå€¼æ˜¯capacity * loadFactorï¼Œcapacity ä¸ºå®¹é‡ï¼ŒloadFactor ä¸ºè´Ÿè½½å› å­ï¼Œé»˜è®¤ä¸º 0.75ã€‚æ‰©å®¹åçš„æ•°ç»„å¤§å°æ˜¯åŸæ¥çš„ 2 å€ï¼Œç„¶åæŠŠåŸæ¥çš„å…ƒç´ é‡æ–°è®¡ç®—å“ˆå¸Œå€¼ï¼Œæ”¾åˆ°æ–°çš„æ•°ç»„ä¸­</li>\n</ul>\n<h1>13. ä¸ºä»€ä¹ˆä½¿ç”¨çº¢é»‘æ ‘è€Œä¸ä½¿ç”¨äºŒå‰æ ‘æˆ–è€…å¹³è¡¡æ ‘å‘¢ï¼Ÿ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7b404a96dad386d65dbd5.png\" alt=\"mangrove.png\" tabindex=\"0\"><figcaption>mangrove.png</figcaption></figure>\n<ul>\n<li>çº¢é»‘æ ‘ä¸€ç§è‡ªå¹³è¡¡çš„äºŒå‰æŸ¥æ‰¾æ ‘ï¼š\n<ul>\n<li>æ¯ä¸ªèŠ‚ç‚¹è¦ä¹ˆæ˜¯çº¢è‰²ï¼Œè¦ä¹ˆæ˜¯é»‘è‰²ï¼›</li>\n<li>æ ¹èŠ‚ç‚¹æ°¸è¿œæ˜¯é»‘è‰²çš„ï¼›</li>\n<li>æ‰€æœ‰çš„å¶å­èŠ‚ç‚¹éƒ½æ˜¯æ˜¯é»‘è‰²çš„ï¼ˆæ³¨æ„è¿™é‡Œè¯´å¶å­èŠ‚ç‚¹å…¶å®æ˜¯å›¾ä¸­çš„ NULL èŠ‚ç‚¹ï¼‰ï¼›</li>\n<li>æ¯ä¸ªçº¢è‰²èŠ‚ç‚¹çš„ä¸¤ä¸ªå­èŠ‚ç‚¹ä¸€å®šéƒ½æ˜¯é»‘è‰²ï¼›</li>\n<li>ä»ä»»ä¸€èŠ‚ç‚¹åˆ°å…¶å­æ ‘ä¸­æ¯ä¸ªå¶å­èŠ‚ç‚¹çš„è·¯å¾„éƒ½åŒ…å«ç›¸åŒæ•°é‡çš„é»‘è‰²èŠ‚ç‚¹ï¼›</li>\n</ul>\n</li>\n<li>ä¸ç”¨äºŒå‰æ ‘åŸå› ï¼šäºŒå‰æ ‘å®¹æ˜“å‡ºç°æç«¯æƒ…å†µï¼Œæ¯”å¦‚æ’å…¥çš„æ•°æ®æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆäºŒå‰æ ‘å°±ä¼šé€€åŒ–æˆé“¾è¡¨ï¼ŒæŸ¥è¯¢æ•ˆç‡å°±ä¼šå˜æˆ O(n)ã€‚</li>\n<li>ä¸ç”¨å¹³è¡¡äºŒå‰æ ‘åŸå› ï¼šå¹³è¡¡äºŒå‰æ ‘æ’å…¥å’Œåˆ é™¤æ•°æ®æ—¶ï¼Œä¸ºäº†ä¿æŒä¿æŒå¹³è¡¡éœ€è¦æ—‹è½¬çš„æ¬¡æ•°æ›´å¤šï¼Œä¿æŒå¹³è¡¡æ•ˆç‡æ¯”çº¢é»‘æ ‘ä½</li>\n</ul>\n<h1>14. çº¢é»‘æ ‘æ€ä¹ˆä¿æŒå¹³è¡¡ï¼Ÿ</h1>\n<ul>\n<li>çº¢é»‘æ ‘æœ‰ä¸¤ç§æ–¹å¼ä¿æŒå¹³è¡¡ï¼šæ—‹è½¬(åˆ†ä¸ºå·¦æ—‹å’Œå³æ—‹)å’ŒæŸ“è‰²ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8a63028a99dc3e0be747e.png\" alt=\"levorotation.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c0088556697b01d568da0.png\" alt=\"dextrorotation.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1211584c77b4609a91bd5.png\" alt=\"dye.png\"></li>\n</ul>\n<h1>15. hashMapçš„putæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹?</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f96cde9b8f5122da3d674.jpg\" alt=\"put.jpg\" tabindex=\"0\"><figcaption>put.jpg</figcaption></figure>\n<ul>\n<li>1.é€šè¿‡ hash æ–¹æ³•è®¡ç®— key çš„å“ˆå¸Œå€¼</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>static final int hash(Object key) {\n    int h;\n    return (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16);\n}\n</code></pre></div><ul>\n<li>2.åˆ¤æ–­tabæ˜¯å¦ä¸ºç©ºæˆ–è€…é•¿åº¦ä¸º0ï¼Œå¦‚æœæ˜¯åˆ™è¿›è¡Œæ‰©å®¹æ“ä½œã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>if ((tab = table) == null || (n = tab.length) == 0) \n  n = (tab = resize()).length;\n</code></pre></div><ul>\n<li>3.æ ¹æ®å“ˆå¸Œå€¼è®¡ç®—ä¸‹æ ‡ï¼Œå¦‚æœæ•°ç»„å¯¹åº”ä¸‹æ ‡æ­£å¥½æ²¡æœ‰å­˜æ”¾æ•°æ®ï¼Œåˆ™ç›´æ¥æ’å…¥ï¼Œ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>if ((p = tab[i = (n - 1) &amp; hash]) == null)\n    tab[i] = newNode(hash, key, value, null);\n</code></pre></div><ul>\n<li>4.å¦‚æœå¯¹åº”ä¸‹æ ‡å·²ç»æœ‰æ•°æ®äº†ï¼Œå°±éœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºç›¸åŒçš„keyï¼Œæ˜¯åˆ™è¦†ç›– valueï¼Œå¦åˆ™éœ€è¦åˆ¤æ–­æ˜¯å¦ä¸ºæ ‘èŠ‚ç‚¹ï¼Œæ˜¯åˆ™å‘æ ‘ä¸­æ’å…¥èŠ‚ç‚¹ï¼Œå¦åˆ™å‘é“¾è¡¨ä¸­æ’å…¥æ•°æ®ã€‚åœ¨é“¾è¡¨ä¸­æ’å…¥èŠ‚ç‚¹çš„æ—¶å€™ï¼Œå¦‚æœé“¾è¡¨é•¿åº¦å¤§äºç­‰äº 8æˆ–è€…æ•°ç»„é•¿åº¦&gt;=64ï¼Œåˆ™éœ€è¦æŠŠé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>else {\n    Node&lt;K,V&gt; e; K k;\n    //\n    if (p.hash == hash &amp;&amp;\n        ((k = p.key) == key || (key != null &amp;&amp; key.equals(k))))\n        e = p;\n    else if (p instanceof TreeNode)\n        e = ((TreeNode&lt;K,V&gt;)p).putTreeVal(this, tab, hash, key, value);\n    else {\n        for (int binCount = 0; ; ++binCount) {\n            if ((e = p.next) == null) {\n                p.next = newNode(hash, key, value, null);\n                if (binCount &gt;= TREEIFY_THRESHOLD - 1) // -1 for 1st è½¬é“¾è¡¨\n                    treeifyBin(tab, hash);\n                break;\n            }\n            if (e.hash == hash &amp;&amp;\n                ((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))\n                break;\n            p = e;\n        }\n    }\n}\n</code></pre></div><ul>\n<li>5.æœ€åæ‰€æœ‰å…ƒç´ å¤„ç†å®Œæˆåï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡é˜ˆå€¼ï¼›thresholdï¼Œè¶…è¿‡åˆ™æ‰©å®¹ã€‚ç„¶årehashåŸæ•°ç»„</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>if (++size &gt; threshold)\n    resize();\n</code></pre></div><h1>16. åªé‡å†™ equals æ²¡é‡å†™ hashcodeï¼Œmap put çš„æ—¶å€™ä¼šå‘ç”Ÿä»€ä¹ˆ?</h1>\n<ul>\n<li>ä¼šå¯¼è‡´ equals ç›¸ç­‰çš„ä¸¤ä¸ªå¯¹è±¡ï¼Œhashcode ä¸ç›¸ç­‰ï¼Œè¿™æ ·çš„è¯ï¼Œè¿™ä¸¤ä¸ªå¯¹è±¡ä¼šè¢«æ”¾åˆ°ä¸åŒçš„æ¡¶ä¸­ï¼Œè¿™æ ·å°±ä¼šå¯¼è‡´ get çš„æ—¶å€™ï¼Œæ‰¾ä¸åˆ°å¯¹åº”çš„å€¼ã€‚</li>\n</ul>\n<h1>17. HashMapçš„getæ–¹æ³•æ‰§è¡Œè¿‡ç¨‹?</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ffa2d69b3051e98ee501c.png\" alt=\"get.png\" tabindex=\"0\"><figcaption>get.png</figcaption></figure>\n<ul>\n<li>ä½¿ç”¨æ‰°åŠ¨å‡½æ•°ï¼Œè·å–æ–°çš„å“ˆå¸Œå€¼</li>\n<li>è®¡ç®—æ•°ç»„ä¸‹æ ‡ï¼Œè·å–èŠ‚ç‚¹</li>\n<li>å½“å‰èŠ‚ç‚¹å’Œ key åŒ¹é…ï¼Œç›´æ¥è¿”å›</li>\n<li>å¦åˆ™ï¼Œå½“å‰èŠ‚ç‚¹æ˜¯å¦ä¸ºæ ‘èŠ‚ç‚¹ï¼ŒæŸ¥æ‰¾çº¢é»‘æ ‘</li>\n<li>å¦åˆ™ï¼Œéå†é“¾è¡¨æŸ¥æ‰¾</li>\n</ul>\n<h1>18. hashMapè®¡ç®—hashçš„æ–¹æ³•ï¼Ÿä¸ºä»€ä¹ˆè¿™ä¹ˆè®¾è®¡ï¼Ÿ</h1>\n<ul>\n<li>hash = (key == null) ? 0 : (h = key.hashCode()) ^ (h &gt;&gt;&gt; 16) keyçš„hashCodeä½16ä½ä¸é«˜16ä½å¼‚æˆ–</li>\n<li>é™ä½é™ä½hashç¢°æ’çš„æ¦‚ç‡ï¼Œè®©hashCodeå–å€¼å‡ºçš„é«˜ä½å‚ä¸è¿ç®—ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡çš„æ“ä½œ</li>\n<li>é«˜é¢‘æ“ä½œé‡‡ç”¨ä½è¿ç®—ï¼Œç®—æ³•é«˜æ•ˆ</li>\n</ul>\n<h1>19. ä¸ºä»€ä¹ˆå“ˆå¸Œå‡½æ•°èƒ½é™ä½hashç¢°æ’ï¼Ÿ</h1>\n<ul>\n<li>å› ä¸ºé«˜16ä½ä¸ä½16ä½äº¦æˆ–èƒ½å¢åŠ ä½ä½çš„éšæœºæ€§ï¼Œå‡å°‘ç¢°æ’ã€‚ï¼ˆåœ¨è®¡ç®—å…ƒç´ ä½ç½®æ—¶æŠŠæ•£åˆ—å€¼å’Œæ•°ç»„é•¿åº¦-1åšä¸æ“ä½œã€‚åŒæ—¶å› ä¸ºæ•°ç»„é•¿åº¦ä¸º2çš„æ•´æ•°å¹‚ï¼Œæ•°ç»„é•¿åº¦-1ç›¸å½“äºä½ä½æ©ç ã€‚ä¸æ“ä½œçš„ç»“æœå°±æ˜¯æ•£åˆ—å€¼çš„é«˜ä½å…¨éƒ¨å½’é›¶ï¼Œåªä¿ç•™ä½ä½å€¼ï¼Œç”¨æ¥åšæ•°ç»„ä¸‹æ ‡è®¿é—®ã€‚ä»¥åˆå§‹é•¿åº¦16ä¸ºä¾‹ï¼Œ16-1=15ã€‚2è¿›åˆ¶è¡¨ç¤ºæ˜¯0000 0000 0000 0000 0000 0000 0000 1111ã€‚å’ŒæŸä¸ªæ•£åˆ—å€¼åšä¸æ“ä½œç»“æœå°±æ˜¯æˆªå–äº†æœ€ä½çš„å››ä½å€¼ã€‚å°±ç®—æ•£åˆ—å€¼åˆ†å¸ƒå†æ¾æ•£ï¼Œè¦æ˜¯åªå–æœ€åå‡ ä½çš„è¯ï¼Œç¢°æ’ä¹Ÿä¼šå¾ˆä¸¥é‡ã€‚å¦‚æœæ•£åˆ—æœ¬èº«åšå¾—ä¸å¥½ï¼Œåˆ†å¸ƒä¸Šæˆç­‰å·®æ•°åˆ—çš„æ¼æ´ï¼Œå¦‚æœæ­£å¥½è®©æœ€åå‡ ä¸ªä½ä½å‘ˆç°è§„å¾‹æ€§é‡å¤ï¼Œé‚£å°±å®¹æ˜“ç¢°æ’äº†ã€‚å³ç§»16ä½ï¼Œ32bitçš„ä¸€åŠï¼Œè‡ªå·±çš„é«˜åŠåŒºå’Œä½åŠåŒºåšå¼‚æˆ–ï¼Œå°±æ˜¯ä¸ºäº†æ··åˆåŸå§‹å“ˆå¸Œç çš„é«˜ä½å’Œä½ä½ï¼Œä»¥æ­¤æ¥åŠ å¤§ä½ä½çš„éšæœºæ€§ã€‚è€Œä¸”æ··åˆåçš„ä½ä½æºæ‚äº†é«˜ä½çš„éƒ¨åˆ†ç‰¹å¾ï¼Œé«˜ä½çš„ä¿¡æ¯ä¹Ÿè¢«å˜ç›¸ä¿ç•™ä¸‹æ¥ï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/67d6ae212618b6636f2b2.jpg\" alt=\"hash.jpg\"></li>\n</ul>\n<h1>20. hashMapè®¡ç®—æ•°ç»„çš„ä½ç½®ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨hashCode()å¤„ç†åçš„å“ˆå¸Œå€¼ç›´æ¥ä½œä¸ºtableçš„ä¸‹æ ‡ï¼Ÿ</h1>\n<ul>\n<li>i = (length - 1) &amp; hash æ±‚å‡ºhashä¸æ•°ç»„é•¿åº¦-1è¿›è¡Œä¸(&amp;)æ“ä½œï¼ˆç»“æœå°±æ˜¯æ•£åˆ—å€¼çš„é«˜ä½å…¨éƒ¨å½’é›¶ï¼Œåªä¿ç•™ä½ä½å€¼ï¼‰</li>\n<li>åŸå› 1å½“æ•°ç»„é•¿åº¦ä¸º2çš„å¹‚æ¬¡æ–¹æ—¶ï¼Œh&amp;(length-1)ç­‰ä»·äºh%lengthå–æ¨¡,æ¯”å–ä½™æ“ä½œæ›´åŠ æœ‰æ•ˆç‡</li>\n<li>åŸå› 2é€šè¿‡å–æ¨¡æ“ä½œè§£å†³äº†â€œå“ˆå¸Œå€¼ä¸æ•°ç»„å¤§å°èŒƒå›´ä¸åŒ¹é…â€çš„é—®é¢˜ï¼›key.hashCode()è¿”å›intç±»å‹èŒƒå›´-(2 ^ 31)~(2 ^ 31 - 1)ï¼Œçº¦40äº¿ã€‚è€ŒHashMapçš„å®¹é‡èŒƒå›´æ˜¯åœ¨16ï¼ˆé»˜è®¤åˆå§‹å€¼ï¼‰~2 ^ 30ï¼Œå†…å­˜æ”¾ä¸ä¸‹</li>\n</ul>\n<h1>21. HashMapçš„sizeä¸ºä»€ä¹ˆå¿…é¡»æ˜¯2çš„æ•´æ•°æ¬¡æ–¹ï¼Ÿ</h1>\n<ul>\n<li>å……åˆ†åˆ©ç”¨æ•°ç»„ç©ºé—´ï¼Œè®©æ•°æ®æ›´å‡åŒ€åˆ†å¸ƒï¼Œå‡å°‘hashå†²çªï¼Œå¦‚æœlengthä¸æ˜¯2çš„æ¬¡å¹‚ï¼Œæ¯”å¦‚15ï¼Œåˆ™lengthâ€“1=14ï¼ŒäºŒè¿›åˆ¶ä¸º 1110ï¼Œå†ä¸hä¸æ“ä½œï¼Œæœ€åä¸€ä½éƒ½ä¸º0ï¼Œè€Œ 0001ï¼Œ0011ï¼Œ0101ï¼Œ1001ï¼Œ1011ï¼Œ0111ï¼Œ1101è¿™å‡ ä¸ªä½ç½®ä¸èƒ½å­˜æ”¾å…ƒç´ äº†ï¼Œæ­¤æ—¶æ•°ç»„å¯ç”¨ä½ç½®æ¯”æ•°ç»„é•¿åº¦å°‘ï¼Œå¢åŠ äº†ç¢°æ’çš„å‡ ç‡ï¼Œå‡æ…¢äº†æŸ¥è¯¢çš„æ•ˆç‡ã€‚</li>\n<li>å½“sizeä¸º2çš„næ¬¡æ–¹æ—¶ï¼Œh &amp; (length â€“ 1) ç­‰ä»·äºh%lengthå–æ¨¡ï¼Œä½è¿ç®—é€Ÿåº¦å¿«</li>\n<li>åœ¨æ‰©å®¹è¿ç§»çš„æ—¶å€™ä¸éœ€è¦å†é‡æ–°é€šè¿‡å“ˆå¸Œå®šä½æ–°çš„ä½ç½®äº†ã€‚å› ä¸ºæ¯æ¬¡æ‰©å®¹éƒ½æ˜¯ç¿»å€ï¼Œä¸ (n-1)&amp;hashåŸä½ç½®ç›¸æ¯”ï¼Œåªæ˜¯å¤šäº†ä¸€ä¸ªbitä½ã€‚ä½¿å¾—æ‰©å®¹åçš„ä½ç½®=åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡</li>\n</ul>\n<h1>22. å¦‚æœåˆå§‹åŒ–HashMapä¼ 17ä½œä¸ºåˆå§‹å®¹é‡ä¼šæ€ä¹ˆå¤„ç†ï¼Ÿ</h1>\n<ul>\n<li>åˆå§‹åŒ–æ—¶ä¸æ˜¯2çš„å€æ•°æ—¶ï¼ŒHashMapä¼šå°†å€¼è½¬åŒ–ä¸ºå¤§äºè¯¥å€¼çš„æœ€å°çš„2æ¬¡å¹‚ï¼Œæ‰€ä»¥ä¼ å…¥17æ—¶HashMapçš„å®é™…å®¹é‡æ˜¯32ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//MAXIMUM_CAPACITY = 1 &lt;&lt; 30è¿™ä¸ªæ˜¯ä¸´ç•ŒèŒƒå›´ï¼Œå³æœ€â¼¤çš„Mapé›†åˆ\n//æˆ–è¿ç®—ä¸»è¦æ˜¯ä¸ºäº†æŠŠâ¼†è¿›åˆ¶çš„å„ä¸ªä½ç½®éƒ½å¡«ä¸Š1ï¼Œå½“â¼†è¿›åˆ¶çš„å„ä¸ªä½ç½®éƒ½æ˜¯1ä»¥åï¼Œå°±æ˜¯æ ‡å‡†çš„2çš„å€æ•°å‡1äº†ï¼Œæœ€åæŠŠç»“æœåŠ 1å†è¿”å›å³å¯\nstatic final int tableSizeFor(int cap) {\n int n = cap - 1;\n n |= n &gt;&gt;&gt; 1;\n n |= n &gt;&gt;&gt; 2;\n n |= n &gt;&gt;&gt; 4;\n n |= n &gt;&gt;&gt; 8;\n n |= n &gt;&gt;&gt; 16;\n return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1; }\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/662c58176e0ac38a0a26f.png\" alt=\"hashmaptablesize.png\" tabindex=\"0\"><figcaption>hashmaptablesize.png</figcaption></figure>\n<h1>23. åˆå§‹åŒ– HashMap çš„æ—¶å€™éœ€è¦ä¼ å…¥å®¹é‡å€¼å—ï¼Ÿ</h1>\n<ul>\n<li>åœ¨åˆ›å»º HashMap æ—¶å¯ä»¥æŒ‡å®šåˆå§‹å®¹é‡å€¼ã€‚è¿™ä¸ªå®¹é‡æ˜¯æŒ‡ Map å†…éƒ¨ç”¨äºå­˜å‚¨æ•°æ®çš„æ•°ç»„å¤§å°ã€‚</li>\n<li>å¦‚æœé¢„å…ˆçŸ¥é“ Map å°†å­˜å‚¨å¤§é‡é”®å€¼å¯¹ï¼Œæå‰æŒ‡å®šä¸€ä¸ªè¶³å¤Ÿå¤§çš„åˆå§‹å®¹é‡å¯ä»¥å‡å°‘å› æ‰©å®¹å¯¼è‡´çš„é‡å“ˆå¸Œï¼ˆrehashingï¼‰æ“ä½œï¼Œä»è€Œæé«˜æ€§èƒ½ã€‚å› ä¸ºæ¯æ¬¡æ‰©å®¹æ—¶ï¼ŒHashMap éœ€è¦æ–°åˆ†é…ä¸€ä¸ªæ›´å¤§çš„æ•°ç»„å¹¶é‡æ–°å°†ç°æœ‰çš„å…ƒç´ æ’å…¥åˆ°è¿™ä¸ªæ–°æ•°ç»„ä¸­ï¼Œè¿™ä¸ªè¿‡ç¨‹ç›¸å¯¹è€—æ—¶ï¼Œå°¤å…¶æ˜¯å½“ Map ä¸­å·²æœ‰å¤§é‡æ•°æ®æ—¶ã€‚</li>\n<li>è¿‡å¤§çš„åˆå§‹å®¹é‡ä¼šæµªè´¹å†…å­˜ï¼Œç‰¹åˆ«æ˜¯å½“å®é™…å­˜å‚¨çš„å…ƒç´ è¿œå°‘äºåˆå§‹å®¹é‡æ—¶ã€‚å¦‚æœä¸æŒ‡å®šåˆå§‹å®¹é‡ï¼Œåˆ™é»˜è®¤çš„åˆå§‹å®¹é‡ 16ã€‚</li>\n</ul>\n<h1>24. æœ‰ä»€ä¹ˆå“ˆå¸Œå‡½æ•°çš„æ„é€ æ–¹æ³•å‘¢ï¼Ÿ</h1>\n<ul>\n<li>HashMapé‡Œå“ˆå¸Œæ„é€ å‡½æ•°çš„æ–¹æ³•å«é™¤ç•™å–ä½™æ³•ï¼šH(key)=key%p(p&lt;=N)ï¼Œå…³é”®å­—é™¤ä»¥ä¸€ä¸ªä¸å¤§äºå“ˆå¸Œè¡¨é•¿åº¦çš„æ­£æ•´æ•°pï¼Œæ‰€å¾—ä½™æ•°ä¸ºåœ°å€</li>\n<li>ç›´æ¥å®šå€æ³•ï¼šç›´æ¥æ ¹æ®keyæ¥æ˜ å°„åˆ°å¯¹åº”çš„æ•°ç»„ä½ç½®ï¼Œä¾‹å¦‚ 1232 æ”¾åˆ°ä¸‹æ ‡ 1232 çš„ä½ç½®ã€‚</li>\n<li>æ•°å­—åˆ†ææ³•ï¼šå–keyçš„æŸäº›æ•°å­—ï¼ˆä¾‹å¦‚åä½å’Œç™¾ä½ï¼‰ä½œä¸ºæ˜ å°„çš„ä½ç½®</li>\n<li>å¹³æ–¹å–ä¸­æ³•ï¼šå–keyå¹³æ–¹çš„ä¸­é—´å‡ ä½ä½œä¸ºæ˜ å°„çš„ä½ç½®</li>\n<li>æŠ˜å æ³•ï¼šå°†keyåˆ†å‰²æˆä½æ•°ç›¸åŒçš„å‡ æ®µï¼Œç„¶åæŠŠå®ƒä»¬çš„å åŠ å’Œä½œä¸ºæ˜ å°„çš„ä½ç½®</li>\n</ul>\n<h1>25. hashMapä½¿ç”¨äº†ä»€ä¹ˆæ–¹æ³•è§£å†³Hashå†²çªï¼Ÿ</h1>\n<ul>\n<li>é“¾åœ°å€æ³•ï¼ˆä½¿ç”¨æ•£åˆ—è¡¨ï¼‰é“¾æ¥ç›¸åŒhashå€¼çš„æ•°æ®</li>\n<li>ä½¿ç”¨2æ¬¡æ‰°åŠ¨å‡½æ•°ï¼ˆhashå‡½æ•°ï¼‰æ¥é™ä½å“ˆå¸Œå†²çªçš„æ¦‚ç‡ï¼Œä½¿å¾—æ•°æ®åˆ†å¸ƒæ›´å¹³å‡</li>\n<li>å¼•å…¥çº¢é»‘æ ‘è¿›ä¸€æ­¥é™ä½éå†çš„æ—¶é—´å¤æ‚åº¦ï¼Œä½¿å¾—éå†æ›´å¿«ï¼›</li>\n</ul>\n<h1>26. è§£å†³å“ˆå¸Œå†²çªæœ‰å“ªäº›æ–¹æ³•ï¼Ÿ</h1>\n<ul>\n<li>å†å“ˆå¸Œæ³•ï¼šä¸¤å¥—å“ˆå¸Œç®—æ³•ï¼Œå½“å‘ç”Ÿå“ˆå¸Œå†²çªçš„æ—¶å€™ï¼Œä½¿ç”¨å¦å¤–ä¸€ç§å“ˆå¸Œç®—æ³•ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºæ§½ä¸ºæ­¢ã€‚è®¾è®¡è¦æ±‚é«˜</li>\n<li>å¼€æ”¾åœ°å€æ³•ï¼šé‡åˆ°å“ˆå¸Œå†²çªçš„æ—¶å€™ï¼Œå°±å»å¯»æ‰¾ä¸‹ä¸€ä¸ªç©ºçš„æ§½ã€‚æœ‰ 3 ç§æ–¹æ³•ï¼š\n<ul>\n<li>çº¿æ€§æ¢æµ‹ï¼šä»å†²çªçš„ä½ç½®å¼€å§‹ï¼Œä¾æ¬¡å¾€åæ‰¾ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºæ§½ã€‚</li>\n<li>äºŒæ¬¡æ¢æµ‹ï¼šä»å†²çªçš„ä½ç½® x å¼€å§‹ï¼Œç¬¬ä¸€æ¬¡å¢åŠ  1^2ä¸ªä½ç½®ï¼Œç¬¬äºŒæ¬¡å¢åŠ  2^2ï¼Œç›´åˆ°æ‰¾åˆ°ç©ºæ§½ã€‚</li>\n<li>åŒé‡å“ˆå¸Œï¼šå‡†å¤‡å¤šä¸ªå“ˆå¸Œå‡½æ•°ï¼Œå‘ç”Ÿå†²çªçš„æ—¶å€™ï¼Œä½¿ç”¨å¦å¤–ä¸€ä¸ªå“ˆå¸Œå‡½æ•°ã€‚</li>\n</ul>\n</li>\n<li>é“¾åœ°å€æ³•ï¼Œå½“å‘ç”Ÿå“ˆå¸Œå†²çªçš„æ—¶å€™ï¼Œä½¿ç”¨é“¾è¡¨å°†å†²çªçš„å…ƒç´ ä¸²èµ·æ¥ã€‚HashMap é‡‡ç”¨çš„æ­£æ˜¯æ‹‰é“¾æ³•ã€‚</li>\n</ul>\n<h1>27. æ€ä¹ˆåˆ¤æ–­keyç›¸ç­‰å‘¢ï¼Ÿ</h1>\n<ul>\n<li>ä¾èµ–äºkeyçš„equals()æ–¹æ³•å’ŒhashCode()æ–¹æ³•ï¼Œä»¥åŠ == è¿ç®—ç¬¦ã€‚\n<ul>\n<li>hashCode()ï¼šè®¡ç®—keyçš„å“ˆå¸Œç ã€‚ç”±äºä¸åŒçš„keyå¯èƒ½æœ‰ç›¸åŒçš„å“ˆå¸Œç ï¼ŒhashCode()åªæ˜¯ç¬¬ä¸€æ­¥ç­›é€‰ã€‚</li>\n<li>equals()ï¼šå½“ä¸¤ä¸ªkeyçš„å“ˆå¸Œç ç›¸åŒæ—¶ï¼Œå†ç”¨keyçš„equals()æ–¹æ³•ç²¾ç¡®æ¯”è¾ƒã€‚åªæœ‰è¿”å›trueæ—¶ï¼Œä¸¤ä¸ªkeyæ‰å®Œå…¨ç›¸åŒ</li>\n<li>==ï¼šå¦‚æœä¸¤ä¸ªkeyçš„å¼•ç”¨æŒ‡å‘åŒä¸€ä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆhashCode()å’Œequals()æ–¹æ³•éƒ½ä¼šè¿”å›trueï¼Œæ‰€ä»¥equalsåˆ¤æ–­å‰ä½¿ç”¨==è¿ç®—ç¬¦åˆ¤æ–­</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>if (e.hash == hash &amp;&amp;\n((k = e.key) == key || (key != null &amp;&amp; key.equals(k))))\n</code></pre></div><h1>28. ä¸ºä»€ä¹ˆæ¡¶é‡Œé¢çš„é“¾è¡¨è¦è½¬çº¢é»‘æ ‘ï¼Ÿä¸ºä»€ä¹ˆä¸ç›´æ¥ä½¿ç”¨çº¢é»‘æ ‘ï¼Ÿé“¾è¡¨è½¬æ¢ä¸ºçº¢é»‘æ ‘é˜ˆå€¼æ˜¯8ï¼Ÿçº¢é»‘æ ‘è½¬é“¾è¡¨é˜ˆå€¼æ˜¯6?</h1>\n<ul>\n<li>çº¢é»‘æ ‘èŠ‚ç‚¹çš„å¤§å°å¤§æ¦‚æ˜¯æ™®é€šèŠ‚ç‚¹å¤§å°çš„ä¸¤å€ï¼Œæ‰€ä»¥è½¬çº¢é»‘æ ‘ç‰ºç‰²äº†ç©ºé—´æ¢æ—¶é—´ï¼Œæ˜¯ä¸€ç§å…œåº•ç­–ç•¥ï¼Œä¿è¯æç«¯æƒ…å†µä¸‹çš„æŸ¥æ‰¾æ•ˆç‡</li>\n<li>å› ä¸ºå½“è´Ÿè½½å› å­æ˜¯0.75æœä»æ³Šæ¾åˆ†å¸ƒï¼Œå½“å•ä¸ªæ¡¶å†…çš„å…ƒç´ è¾¾åˆ°8ä¸ªæ—¶çš„æ¦‚ç‡å°äºåƒä¸‡åˆ†ä¹‹ä¸€ï¼Œå‡ ä¹ä¸å¯èƒ½ï¼Œæ›´å°è¯äº†è½¬çº¢é»‘æ ‘åªæ˜¯å…œåº•ç­–ç•¥</li>\n<li>å› ä¸ºå¦‚æœè¿™ä¸ªé˜ˆå€¼ä¹Ÿè®¾ç½®æˆ8ï¼Œå‡å¦‚å‘ç”Ÿç¢°æ’ï¼ŒèŠ‚ç‚¹å¢å‡åˆšå¥½åœ¨8é™„è¿‘ï¼Œä¼šå‘ç”Ÿé“¾è¡¨å’Œçº¢é»‘æ ‘çš„ä¸æ–­è½¬æ¢ï¼Œå¯¼è‡´èµ„æºæµªè´¹ã€‚</li>\n</ul>\n<h1>29. hashå†²çªåï¼Œå°†å…ƒç´ æ”¾åˆ°é“¾è¡¨å¤´è¿˜æ˜¯å°¾ï¼Ÿâˆš</h1>\n<ul>\n<li>JDK1.7æ’å…¥æ—¶é‡‡ç”¨å¤´æ’æ³•ï¼Œå¤šçº¿ç¨‹ä¸‹ï¼Œæœ‰é“¾è¡¨é—­ç¯çš„bugã€‚å‡è®¾é“¾è¡¨åŸæ¥çš„å…ƒç´ æ˜¯å…ƒç´ çš„é¡ºåºæ˜¯C-&gt;B-&gt;Aï¼Œæ­¤æ—¶çº¿ç¨‹1å’Œ2æŒ‡å‘æŒ‡å‘Cï¼Œçº¿ç¨‹1å’Œ2.nextæŒ‡å‘Bï¼Œå½“hashMapæ‰©å®¹å¹¶ä¸”çº¿ç¨‹2å®Œæˆæ’å…¥ï¼Œæ­¤æ—¶é“¾è¡¨çš„çŠ¶æ€ä¸ºA-&gt;B-&gt;Cï¼Œæ­¤æ—¶çº¿ç¨‹1æŒ‡å‘Cï¼Œçº¿ç¨‹1.nextæŒ‡å‘Bï¼Œæ­¤æ—¶çº¿ç¨‹1æƒ³è¦å˜é‡å°±å˜æˆC-&gt;B-&gt;Cäº†ï¼Œå› ä¸ºæ­¤æ—¶B.next-&gt;C</li>\n<li>JDK1.8æ”¹æˆäº†å°¾æ’æ³•ï¼Œä¸»è¦æ˜¯ä¸ºäº†å‡å°‘çº¿ç¨‹å®‰å…¨çš„é—®é¢˜ï¼Œè½¬æˆçº¢é»‘æ ‘åæŒ‰ç…§çº¢é»‘æ ‘çš„è§„åˆ™æ¥æ’äº†</li>\n</ul>\n<h1>30. HashMapå“ªäº›æ“ä½œä¼šå¯¼è‡´æ‰©å®¹ï¼Ÿ æ‰©å®¹æœºåˆ¶ï¼Ÿresizeæ–¹æ³•çš„æ‰§è¡Œè¿‡ç¨‹ï¼Ÿæ‰©å®¹åçš„ä½ç½®è®¡ç®—ï¼Ÿä¸ºä»€ä¹ˆè´Ÿè½½å› å­æ˜¯0.75?</h1>\n<ul>\n<li>ä¸ºäº†å‡å°‘å“ˆå¸Œå†²çªå‘ç”Ÿçš„æ¦‚ç‡ï¼Œå½“HashMapå…ƒç´ ä¸ªæ•°è¾¾åˆ°ä¸€ä¸ªä¸´ç•Œå€¼thresholdçš„æ—¶å€™ï¼Œå°±ä¼šè§¦å‘æ‰©å®¹ï¼Œæ˜¯ä¸€ä¸ªç›¸å½“è€—æ—¶çš„æ“ä½œã€‚</li>\n<li>æ‰©å®¹æ—¶æœº\n<ul>\n<li>ç¬¬ä¸€æ¬¡è°ƒç”¨HashMapçš„putæ–¹æ³•ä¸”æ•°ç»„ä¸ºnullæ—¶ï¼Œä¼šè°ƒç”¨resizeæ–¹æ³•å¯¹tableæ•°ç»„è¿›è¡Œåˆå§‹åŒ–ï¼Œé»˜è®¤å¤§å°ä¸º16ã€‚</li>\n<li>å½“hashMapå…ƒç´ ä¸ªæ•°å¤§äºæ‰©å®¹é˜ˆå€¼threshold = è´Ÿè½½å› å­loadFactor(0.75) * åˆå§‹å®¹é‡capacity(16)æ—¶ã€‚å®¹é‡å˜ä¸ºåŸæ¥çš„2å€ï¼Œå…ˆæ’å…¥æ•°æ®å†æ‰©å®¹</li>\n</ul>\n</li>\n<li>å®¹é‡èŒƒå›´ï¼š16-2^30ä¸ª</li>\n<li>åŠ è½½å› å­è¿‡é«˜ï¼Œæ‰©å®¹é¢‘ç‡å˜ä½ï¼Œhashç¢°æ’å‡ ç‡å˜å¤§ï¼ŒæŸ¥æ‰¾æ—¶é—´é•¿ï¼Œä½†å ç”¨ç©ºé—´å°ï¼Œç©ºé—´åˆ©ç”¨ç‡å˜é«˜</li>\n<li>åŠ è½½å› å­è¿‡ä½ï¼Œæ‰©å®¹é¢‘ç‡å˜é«˜ï¼Œhashç¢°æ’å‡ ç‡å˜ä½ï¼ŒæŸ¥æ‰¾æ—¶é—´çŸ­ï¼Œä½†å ç”¨ç©ºé—´å¤§ï¼Œç©ºé—´åˆ©ç”¨ç‡å˜ä½</li>\n<li>æ‰©å®¹æœºåˆ¶ï¼šæ‰©å®¹æ—¶ï¼ŒHashMap ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„æ•°ç»„ï¼Œå…¶å®¹é‡æ˜¯åŸæ•°ç»„å®¹é‡çš„ä¸¤å€ã€‚ç„¶åå°†é”®å€¼å¯¹æ”¾åˆ°æ–°è®¡ç®—å‡ºçš„ç´¢å¼•ä½ç½®ä¸Šã€‚æ ¹æ®(e.hash &amp; oldCap)æ˜¯å¦ä¸º0ï¼Œä½¿å¾—æ‰©å®¹åçš„ä½ç½®=åŸä½ç½® or åŸä½ç½® + æ—§å®¹é‡ï¼ˆåŸå“ˆå¸Œå€¼çš„é«˜ä½ä¸­æ–°å¢çš„é‚£ä¸€ä½æ˜¯å¦ä¸º1ï¼Œå› ä¸ºä½ç½®è®¡ç®—å®é™…ä¸Šæ˜¯ä¿ç•™ä½ä½å€¼ï¼Œå»æ‰æ‰€æœ‰é«˜ä½å€¼ï¼Œæ¯”å¦‚åŸå®¹é‡16åˆ™ä¿ç•™4ä½ä½ä½ï¼Œæ‰©å®¹å32ä¸ºä¿ç•™5ä½ä½ä½ï¼Œç›¸å·®1ä½ï¼Œè€Œè¿™1ä½åˆšå¥½æ˜¯åŸå®¹é‡16æ‰€åœ¨çš„ä½ç½®ï¼Œå› æ­¤åªéœ€hashä¸åŸå®¹é‡ä¸æ“ä½œå¾—åˆ°æœ€æ–°çš„ä½æ˜¯1è¿˜æ˜¯0å†³å®šæ–°å…ƒç´ çš„ä½ç½®ï¼Œä¸Šé¢çš„æ¨è®ºéƒ½å¾—ç›Šäºé•¿åº¦æ˜¯2çš„å€æ•°å’Œhashçš„é«˜ä½ä½è¿ç®—ï¼‰</li>\n</ul>\n<h1>31. jdk1.8 å¯¹ HashMap ä¸»è¦åšäº†å“ªäº›ä¼˜åŒ–å‘¢ï¼Ÿä¸ºä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>æ•°æ®ç»“æ„ï¼šæ•°ç»„+é“¾è¡¨æ”¹æˆäº†æ•°ç»„+é“¾è¡¨æˆ–çº¢é»‘æ ‘ åŸå› ï¼šå‘ç”Ÿ hash å†²çªï¼Œå…ƒç´ ä¼šå­˜å…¥é“¾è¡¨ï¼Œé“¾è¡¨è¿‡é•¿è½¬ä¸ºçº¢é»‘æ ‘ï¼Œå°†æ—¶é—´å¤æ‚åº¦ç”±O(n)é™ä¸ºO(logn)</li>\n<li>é“¾è¡¨æ’å…¥æ–¹å¼ï¼šé“¾è¡¨çš„æ’å…¥æ–¹å¼ä»å¤´æ’æ³•æ”¹æˆäº†å°¾æ’æ³• åŸå› ï¼šå› ä¸ºå¤´æ’æ³•æ‰©å®¹æ—¶ï¼Œå¤´æ’æ³•ä¼šä½¿é“¾è¡¨å‘ç”Ÿåè½¬ï¼Œå¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šäº§ç”Ÿç¯</li>\n<li>æ‰©å®¹rehashï¼š1.7 éœ€è¦å¯¹åŸæ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œé‡æ–°hashå®šä½åœ¨æ–°æ•°ç»„çš„ä½ç½®ï¼Œ1.8æ–°çš„ä½ç½®ä¸å˜æˆ–ç´¢å¼•+æ–°å¢å®¹é‡å¤§å°ã€‚åŸå› ï¼šæé«˜æ‰©å®¹çš„æ•ˆç‡ï¼Œæ›´å¿«åœ°æ‰©å®¹ã€‚</li>\n<li>æ‰©å®¹æ—¶æœºï¼šåœ¨æ’å…¥æ—¶ï¼Œ1.7å…ˆåˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼Œå†æ’å…¥ï¼Œ1.8å…ˆæ’å…¥ï¼Œå®Œæˆå†åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹ï¼›</li>\n<li>æ•£åˆ—å‡½æ•°ï¼š1.7 åšäº†å››æ¬¡ç§»ä½å’Œå››æ¬¡å¼‚æˆ–ï¼Œjdk1.8åªåšä¸€æ¬¡ã€‚åŸå› ï¼šåš4æ¬¡è¾¹é™…æ•ˆç”¨ä¹Ÿä¸å¤§ï¼Œæ”¹ä¸ºä¸€æ¬¡ï¼Œæå‡æ•ˆç‡ã€‚</li>\n</ul>\n<h1>32. ä½ èƒ½è‡ªå·±è®¾è®¡å®ç°ä¸€ä¸ªHashMapå—ï¼Ÿ</h1>\n<ul>\n<li>æ•£åˆ—å‡½æ•°ï¼šhashCode()+é™¤ç•™ä½™æ•°æ³•</li>\n<li>å†²çªè§£å†³ï¼šé“¾åœ°å€æ³•</li>\n<li>æ‰©å®¹ï¼šèŠ‚ç‚¹é‡æ–°hashè·å–ä½ç½®<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/007d9857d0d6a245a66cb.png\" alt=\"myhashmap.png\"></li>\n</ul>\n<h1>33. HashMap ä¸ºä»€ä¹ˆä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</h1>\n<ul>\n<li>JDK1.7å¤šçº¿ç¨‹ä¸‹æ‰©å®¹ä¼šæ­»å¾ªç¯ã€‚ä½¿ç”¨å¤´æ’æ³•æ’å…¥å…ƒç´ ï¼Œåœ¨å¤šçº¿ç¨‹çš„ç¯å¢ƒä¸‹ï¼Œæ‰©å®¹æ—¶æœ‰å¯èƒ½å¯¼è‡´å‡ºç°ç¯å½¢é“¾è¡¨ï¼Œé€ æˆæ­»å¾ªç¯ï¼ŒJDK8ä½¿ç”¨å°¾æ’æ³•ï¼Œæ‰©å®¹æ—¶ä¼šä¿æŒé“¾è¡¨åŸæ¥çš„é¡ºåºã€‚</li>\n<li>å¤šçº¿ç¨‹putå¯èƒ½ä¼šå¯¼è‡´å…ƒç´ çš„ä¸¢å¤±ã€‚å› ä¸ºè®¡ç®—å‡ºæ¥çš„ä½ç½®å¯èƒ½ä¼šè¢«å…¶ä»–çº¿ç¨‹çš„putè¦†ç›–ï¼Œæœ¬æ¥å“ˆå¸Œå†²çªæ˜¯åº”è¯¥ç”¨é“¾è¡¨çš„ï¼Œä½†å¤šçº¿ç¨‹æ—¶ç”±äºæ²¡æœ‰åŠ é”ï¼Œç›¸åŒä½ç½®çš„å…ƒç´ å¯èƒ½å°±è¢«å¹²æ‰äº†ã€‚</li>\n<li>putå’Œgetå¹¶å‘æ—¶ï¼Œå¯èƒ½å¯¼è‡´getä¸ºnullã€‚çº¿ç¨‹1æ‰§è¡Œputæ—¶ï¼Œå› ä¸ºå…ƒç´ ä¸ªæ•°è¶…å‡ºé˜ˆå€¼è€Œå¯¼è‡´å‡ºç°æ‰©å®¹ï¼Œçº¿ç¨‹2æ­¤æ—¶æ‰§è¡Œgetï¼Œå°±æœ‰å¯èƒ½å‡ºç°è¿™ä¸ªé—®é¢˜ï¼Œå› ä¸ºçº¿ç¨‹1æ‰§è¡Œå®Œtable = newTabåï¼Œçº¿ç¨‹2ä¸­çš„tableæ­¤æ—¶ä¹Ÿå‘ç”Ÿäº†å˜åŒ–ï¼Œæ­¤æ—¶å»getæ—¶å½“ç„¶ä¼šgetåˆ°nullï¼Œå› ä¸ºå…ƒç´ è¿˜æ²¡æœ‰è½¬ç§»ã€‚</li>\n</ul>\n<h1>34. å¦‚ä½•è§£å†³HashMapçº¿ç¨‹ä¸å®‰å…¨çš„é—®é¢˜å‘¢ï¼Ÿ</h1>\n<ul>\n<li>HashTableç›´æ¥åœ¨æ–¹æ³•ä¸ŠåŠ synchronizedå…³é”®å­—ï¼Œé”ä½æ•´ä¸ªtableæ•°ç»„ï¼Œç²’åº¦å¤§</li>\n<li>Collections.synchronizedMapä½¿ç”¨ Collections é›†åˆå·¥å…·çš„å†…éƒ¨ç±»ï¼Œå†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡é”ï¼Œæ–¹æ³•å†…é€šè¿‡å¯¹è±¡é”å®ç°ï¼›</li>\n<li>ConcurrentHashMapåœ¨jdk1.7ä¸­ä½¿ç”¨åˆ†æ®µé”ï¼Œåœ¨ jdk1.8 ä¸­ä½¿ç”¨ CAS+synchronizedã€‚</li>\n</ul>\n<h1>35. ConcurrentHashmapçš„å®ç°ï¼Ÿ</h1>\n<ul>\n<li>jdk1.8 æ˜¯åŸºäºCAS+synchronizedå®ç°ã€‚</li>\n<li>æ•°æ®ç»“æ„å’Œ HashMap æ˜¯ä¸€æ ·çš„ï¼Œæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘ã€‚å®ƒå®ç°çº¿ç¨‹å®‰å…¨çš„å…³é”®ç‚¹åœ¨äº put æµç¨‹ã€‚</li>\n<li>putæµç¨‹\n<ul>\n<li>é¦–å…ˆè®¡ç®— hashï¼Œéå† node æ•°ç»„ï¼Œå¦‚æœ node æ˜¯ç©ºçš„è¯ï¼Œå°±é€šè¿‡ CAS+è‡ªæ—‹çš„æ–¹å¼åˆå§‹åŒ–</li>\n<li>å¦‚æœå½“å‰æ•°ç»„ä½ç½®æ˜¯ç©ºåˆ™ç›´æ¥é€šè¿‡ CAS è‡ªæ—‹å†™å…¥æ•°æ®</li>\n<li>å¦‚æœ hash==MOVEDï¼Œè¯´æ˜éœ€è¦æ‰©å®¹ï¼Œæ‰§è¡Œæ‰©å®¹</li>\n<li>å¦‚æœéƒ½ä¸æ»¡è¶³ï¼Œå°±ä½¿ç”¨ synchronized å†™å…¥æ•°æ®ï¼Œå†™å…¥æ•°æ®åŒæ ·åˆ¤æ–­é“¾è¡¨ã€çº¢é»‘æ ‘ï¼Œé“¾è¡¨å†™å…¥å’Œ HashMap çš„æ–¹å¼ä¸€æ ·ï¼Œkey hash ä¸€æ ·å°±è¦†ç›–ï¼Œåä¹‹å°±å°¾æ’æ³•ï¼Œé“¾è¡¨é•¿åº¦è¶…è¿‡ 8 å°±è½¬æ¢æˆçº¢é»‘æ ‘</li>\n</ul>\n</li>\n<li>getæŸ¥è¯¢ï¼šå’ŒHashMap åŸºæœ¬ç›¸åŒï¼Œé€šè¿‡ key è®¡ç®—ä½ç½®ï¼Œtable è¯¥ä½ç½® key ç›¸åŒå°±è¿”å›ï¼Œå¦‚æœæ˜¯çº¢é»‘æ ‘æŒ‰ç…§çº¢é»‘æ ‘è·å–ï¼Œå¦åˆ™å°±éå†é“¾è¡¨è·å–ã€‚</li>\n</ul>\n<h1>36. HashMap å†…éƒ¨èŠ‚ç‚¹æ˜¯æœ‰åºçš„å—ï¼Ÿ</h1>\n<ul>\n<li>HashMap æ˜¯æ— åºçš„ï¼Œæ ¹æ® hash å€¼éšæœºæ’å…¥ã€‚LinkedHashMap æˆ–è€… TreeMapæœ‰åº</li>\n</ul>\n<h1>37. LinkedHashMapæ€ä¹ˆå®ç°æœ‰åºçš„ï¼Ÿ</h1>\n<ul>\n<li>LinkedHashMapç»´æŠ¤äº†ä¸€ä¸ªåŒå‘é“¾è¡¨ï¼Œæœ‰å¤´å°¾èŠ‚ç‚¹ï¼ŒåŒæ—¶èŠ‚ç‚¹é™¤äº†ç»§æ‰¿HashMapçš„Nodeå±æ€§ï¼Œè¿˜æœ‰beforeå’Œafterç”¨äºæ ‡è¯†å‰ç½®èŠ‚ç‚¹å’Œåç½®èŠ‚ç‚¹ã€‚å¯ä»¥å®ç°æŒ‰æ’å…¥çš„é¡ºåºæˆ–è®¿é—®é¡ºåºæ’åºã€‚</li>\n</ul>\n<h1>38. TreeMapæ€ä¹ˆå®ç°æœ‰åºçš„ï¼Ÿ</h1>\n<ul>\n<li>TreeMapæŒ‰ç…§Keyè‡ªç„¶é¡ºåºæˆ–Compratoré¡ºåºè¿›è¡Œæ’åºï¼Œå†…éƒ¨æ˜¯é€šè¿‡çº¢é»‘æ ‘æ¥å®ç°ã€‚æ‰€ä»¥è¦ä¹ˆkeyæ‰€å±çš„ç±»å®ç°Comparableæ¥å£ï¼Œæˆ–è€…è‡ªå®šä¹‰ä¸€ä¸ªå®ç°äº†Comparatoræ¥å£çš„æ¯”è¾ƒå™¨ï¼Œç”¨äºkeyæ¯”è¾ƒ</li>\n</ul>\n<h1>39. TreeMap å’Œ HashMap çš„åŒºåˆ«</h1>\n<ul>\n<li>HashMap æ˜¯åŸºäºæ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘å®ç°çš„ï¼Œput å…ƒç´ çš„æ—¶å€™ä¼šå…ˆè®¡ç®— key çš„å“ˆå¸Œå€¼ï¼Œç„¶åé€šè¿‡å“ˆå¸Œå€¼è®¡ç®—å‡ºæ•°ç»„çš„ç´¢å¼•ï¼Œç„¶åå°†å…ƒç´ æ’å…¥åˆ°æ•°ç»„ä¸­ï¼Œå¦‚æœå‘ç”Ÿå“ˆå¸Œå†²çªï¼Œä¼šä½¿ç”¨é“¾è¡¨æ¥è§£å†³ï¼Œå¦‚æœé“¾è¡¨é•¿åº¦å¤§äº 8ï¼Œä¼šè½¬æ¢ä¸ºçº¢é»‘æ ‘ã€‚get å…ƒç´ çš„æ—¶å€™åŒæ ·ä¼šå…ˆè®¡ç®— key çš„å“ˆå¸Œå€¼ï¼Œç„¶åé€šè¿‡å“ˆå¸Œå€¼è®¡ç®—å‡ºæ•°ç»„çš„ç´¢å¼•ï¼Œå¦‚æœé‡åˆ°é“¾è¡¨æˆ–è€…çº¢é»‘æ ‘ï¼Œä¼šé€šè¿‡ key çš„ equals æ–¹æ³•æ¥åˆ¤æ–­æ˜¯å¦æ˜¯è¦æ‰¾çš„å…ƒç´ ã€‚åœ¨æ²¡æœ‰å‘ç”Ÿå“ˆå¸Œå†²çªçš„æƒ…å†µä¸‹ï¼ŒHashMap çš„æŸ¥æ‰¾æ•ˆç‡æ˜¯ O(1)ã€‚é€‚ç”¨äºæŸ¥æ‰¾æ“ä½œæ¯”è¾ƒé¢‘ç¹çš„åœºæ™¯ã€‚</li>\n<li>TreeMap æ˜¯åŸºäºçº¢é»‘æ ‘å®ç°çš„ï¼Œput å…ƒç´ çš„æ—¶å€™ä¼šå…ˆåˆ¤æ–­æ ¹èŠ‚ç‚¹æ˜¯å¦ä¸ºç©ºï¼Œå¦‚æœä¸ºç©ºï¼Œç›´æ¥æ’å…¥åˆ°æ ¹èŠ‚ç‚¹ï¼Œå¦‚æœä¸ä¸ºç©ºï¼Œä¼šé€šè¿‡ key çš„æ¯”è¾ƒå™¨æ¥åˆ¤æ–­å…ƒç´ åº”è¯¥æ’å…¥åˆ°å·¦å­æ ‘è¿˜æ˜¯å³å­æ ‘ã€‚get å…ƒç´ çš„æ—¶å€™ä¼šé€šè¿‡ key çš„æ¯”è¾ƒå™¨æ¥åˆ¤æ–­å…ƒç´ çš„ä½ç½®ï¼Œç„¶åé€’å½’æŸ¥æ‰¾ã€‚TreeMap çš„æŸ¥æ‰¾æ•ˆç‡æ˜¯ O(logn)ã€‚å¹¶ä¸”ä¿è¯äº†å…ƒç´ çš„é¡ºåºï¼Œå› æ­¤é€‚ç”¨äºéœ€è¦å¤§é‡èŒƒå›´æŸ¥æ‰¾æˆ–è€…æœ‰åºéå†çš„åœºæ™¯ã€‚</li>\n</ul>\n<h1>40. HashSetåº•å±‚å®ç°ï¼Ÿ</h1>\n<ul>\n<li>HashSetåº•å±‚åŸºäºHashMapå®ç°ï¼ˆé™¤äº†clone()ã€writeObject()ã€readObject()æ˜¯HashSetâ¾ƒâ¼°å®ç°ä¹‹å¤–ï¼Œå…¶ä»–â½…æ³•éƒ½æ˜¯ç›´æ¥è°ƒâ½¤HashMapä¸­çš„â½…æ³•ã€‚HashSet ä¼šè‡ªåŠ¨å»é‡ï¼Œå› ä¸ºHashMap çš„é”®æ˜¯å”¯ä¸€çš„ï¼ˆå“ˆå¸Œå€¼ï¼‰ï¼Œç›¸åŒé”®çš„å€¼ä¼šè¦†ç›–æ‰åŸæ¥çš„å€¼ï¼Œ</li>\n</ul>\n<h1>41. HashSet å’Œ ArrayList çš„åŒºåˆ«</h1>\n<ul>\n<li>ArrayList æ˜¯åŸºäºåŠ¨æ€æ•°ç»„å®ç°çš„ï¼ŒHashSet æ˜¯åŸºäº HashMap å®ç°çš„ã€‚</li>\n<li>ArrayList å…è®¸é‡å¤å…ƒç´ å’Œ null å€¼ï¼›HashSet å…ƒç´ å”¯ä¸€ï¼ŒåŸºäºå…ƒç´ çš„ hashCode å’Œ equals æ–¹æ³•æ¥ç¡®å®šå…ƒç´ çš„å”¯ä¸€æ€§ã€‚<br>\nArrayList ä¿æŒå…ƒç´ çš„æ’å…¥é¡ºåºï¼Œå¯ä»¥é€šè¿‡ç´¢å¼•è®¿é—®å…ƒç´ ï¼›HashSet ä¸ä¿è¯å…ƒç´ çš„é¡ºåºï¼Œå­˜å‚¨é¡ºåºä¾èµ–äºå“ˆå¸Œç®—æ³•ï¼Œå¹¶ä¸”å¯èƒ½éšç€å…ƒç´ çš„æ·»åŠ æˆ–åˆ é™¤è€Œæ”¹å˜</li>\n</ul>\n<h1>42. HashMapä¸HashtableåŒºåˆ«âˆš</h1>\n<ul>\n<li>HashMapå¯ä»¥æ¥æ”¶nullé”®å’Œå€¼ã€‚å½“keyä¸ºnullæ—¶è¿”å›çš„å€¼ä¸º0ï¼ŒHashtableä¸èƒ½æ¥å—nullé”®å’Œå€¼ï¼Œä¼šæŠ›å‡ºç©ºæŒ‡é’ˆå¼‚å¸¸</li>\n<li>HashMapçº¿ç¨‹ä¸å®‰å…¨ï¼ŒHashtableçº¿ç¨‹å®‰å…¨</li>\n<li>HashMapé»˜è®¤å¤§å°æ˜¯16ï¼Œæ‰©å®¹æ¯æ¬¡ä¸º2çš„æŒ‡æ•°å¤§å°ï¼ŒHashTableä¸­æ•°ç»„é»˜è®¤å¤§å°æ˜¯11 ï¼Œæ‰©å®¹æ–¹æ³•æ˜¯old*2 + 1</li>\n</ul>\n<h1>43. HashMapå’ŒConcurrentHashMapçš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>ConcurrentHashMapçº¿ç¨‹å®‰å…¨ï¼›å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segment)ï¼Œæ¯ä¸€ä¸ªåˆ†æ®µä¸Šéƒ½ç”¨locké”ä¿æŠ¤ï¼ŒConCurrentHashMapä¸å…è®¸é”®å€¼å¯¹null</li>\n<li>HashMapçº¿ç¨‹ä¸å®‰å…¨ï¼›HashMapçš„é”®å€¼å¯¹å…è®¸æœ‰null</li>\n</ul>\n<h1>44. ConcurrentHashMapå’ŒHashtableåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>ConcurrentHashMapå’ŒHashtableåŒºåˆ«ä¸»è¦ä½“ç°åœ¨å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ä¸Šä¸åŒã€‚</li>\n<li>åº•å±‚æ•°æ®ç»“æ„ï¼š ConcurrentHashMapå’ŒhashMapä¸€æ ·ã€‚Hashtableå’ŒJDK1.7çš„HashMapä¸€æ ·</li>\n<li>å®ç°çº¿ç¨‹å®‰å…¨çš„æ–¹å¼ï¼š\n<ul>\n<li>ConcurrentHashMapï¼šï¼ˆJDK1.7åˆ†æ®µé”ï¼‰ å¯¹æ•´ä¸ªæ¡¶æ•°ç»„è¿›è¡Œäº†åˆ†å‰²åˆ†æ®µ(Segment)ï¼Œæ¯ä¸€æŠŠé”åªé”å®¹å™¨å…¶ä¸­ä¸€éƒ¨åˆ†æ•°æ®ï¼Œå¤šçº¿ç¨‹è®¿é—®å®¹å™¨é‡Œä¸åŒæ•°æ®æ®µçš„æ•°æ®ï¼Œå°±ä¸ä¼šå­˜åœ¨é”ç«äº‰ï¼Œæé«˜å¹¶å‘è®¿é—®ç‡ã€‚ï¼ˆé»˜è®¤åˆ†é…16ä¸ªSegmentï¼‰ JDK1.8ï¼Œä½¿ç”¨ Node æ•°ç»„+é“¾è¡¨+çº¢é»‘æ ‘çš„æ•°æ®ç»“æ„æ¥å®ç°ï¼Œå¹¶å‘æ§åˆ¶ä½¿ç”¨ synchronized å’Œ CAS æ¥æ“ä½œã€‚ï¼ˆJDK1.6ä»¥å å¯¹ synchronizedé”åšäº†å¾ˆå¤šä¼˜åŒ–ï¼‰ HashTable åœ¨æ¯æ¬¡åŒæ­¥æ‰§è¡Œæ—¶éƒ½è¦é”ä½æ•´ä¸ªç»“æ„ã€‚ ConcurrentHashMapé”çš„æ–¹å¼æ˜¯ç¨å¾®ç»†ç²’åº¦çš„</li>\n<li>Hashtable(åŒä¸€æŠŠé”) :ä½¿ç”¨synchronizedä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œæ•ˆç‡ä½ä¸‹ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥æ–¹æ³•æ—¶ï¼Œå…¶ä»–çº¿ç¨‹ä¹Ÿè®¿é—®åŒæ­¥æ–¹æ³•ï¼Œå¯èƒ½ä¼šè¿›å…¥é˜»å¡æˆ–è½®è¯¢çŠ¶æ€</li>\n</ul>\n</li>\n</ul>\n<h1>45. æœ‰å“ªäº›çº¿ç¨‹ä¸å®‰å…¨çš„é›†åˆï¼Ÿé«˜å¹¶å‘æƒ…å†µä¸‹å¦‚ä½•ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Ÿâˆš</h1>\n<ul>\n<li>Vectorã€HashTableã€Propertiesæ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼›</li>\n<li>ArrayListã€LinkedListã€HashSetã€TreeSetã€HashMapã€TreeMapç­‰éƒ½æ˜¯çº¿ç¨‹ä¸å®‰å…¨çš„ã€‚</li>\n<li>ä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„ç±»ï¼Œä½¿ç”¨synchronizedå…³é”®å­—ç­‰</li>\n<li>æ™®é€šé›†åˆå˜ä¸ºåŒæ­¥é›†åˆçš„å·¥å…·æ–¹æ³•Collections.synchronizedList(&lt;? extends Collection&gt; collection);</li>\n</ul>\n<h1>46. é›†åˆå¦‚ä½•æ’åºï¼Ÿ</h1>\n<ul>\n<li>æ’åºï¼šå®ç°Comparatoræ¥å£compare(T o1,T o2)å°äºã€ç­‰äºæˆ–è€…å¤§äºo2åˆ†åˆ«è¿”å›è´Ÿæ•´æ•°ã€0æˆ–è€…æ­£æ•´æ•°</li>\n</ul>\n<h1>47. setå®ç°ç±»HashSetã€LinkedHashSetã€TreeSetçš„æ•°æ®ç»“æ„ä»¥åŠå„è‡ªæœ‰ä¼˜ç‚¹</h1>\n<ul>\n<li>HashSetï¼šæ— åºï¼Œå”¯ä¸€ï¼Œåº•å±‚é‡‡ç”¨HashMapæ¥ä¿å­˜å…ƒç´ ï¼ˆæ•°ç»„æœºåˆ¶ï¼‰</li>\n<li>LinkedHashSetï¼šæœ‰åºï¼Œå”¯ä¸€ï¼ŒåŸºäº LinkedHashMap å®ç° é“¾è¡¨å’Œå“ˆå¸Œè¡¨ç»„åˆ</li>\n<li>TreeSetï¼šæœ‰åºï¼Œå”¯ä¸€ï¼Œçº¢é»‘æ ‘(è‡ªå¹³è¡¡çš„æ’åºäºŒå‰æ ‘)</li>\n</ul>\n<h1>49. Comparableå’ŒComparatoråŒºåˆ«?</h1>\n<ul>\n<li>Comparableæ¥å£ç”¨äºå½“å‰å¯¹è±¡å’Œå…¶å®ƒå¯¹è±¡çš„æ¯”è¾ƒï¼ŒcompareTo(Object obj) æ–¹æ³•ç”¨æ¥æ’åº,åœ¨æ¯”è¾ƒç±»ä¸Šä¿®æ”¹</li>\n<li>Comparatoræ¥å£ç”¨äºä¼ å…¥çš„ä¸¤ä¸ªå¯¹è±¡çš„æ¯”è¾ƒï¼Œcompare(Object obj1, Object obj2) æ–¹æ³•ç”¨æ¥æ’åºï¼Œæ–°å¢ä¸€ä¸ªç±»ä¸“é—¨ç”¨äºæ¯”è¾ƒ</li>\n</ul>\n<h1>50. é›†åˆç±»ä½¿ç”¨æ³¨æ„äº‹é¡¹</h1>\n<ul>\n<li>åŸºäºåº”ç”¨çš„éœ€æ±‚æ¥é€‰æ‹©ä½¿ç”¨æ­£ç¡®ç±»å‹çš„é›†åˆã€‚å¦‚æœå…ƒç´ çš„å¤§å°æ˜¯å›ºå®šçš„ä¸”å·²çŸ¥ä¼˜å…ˆçº§æ­¤æ—¶ä½¿ç”¨Arrayï¼Œè€Œä¸æ˜¯ArrayList</li>\n<li>æŒ‡å®šåˆå§‹å¤§å°é¿å…é‡å¤æ‰©å®¹</li>\n<li>ä½¿ç”¨æ³›å‹æ¥ä¿è¯ç±»å‹å®‰å…¨ï¼Œå¯é æ€§å’Œå¥å£®æ€§</li>\n<li>Mapä¸­å°½é‡ä½¿ç”¨ä¸å¯å˜ç±»Stringä½œä¸ºä¸€ä¸ªkeyï¼Œå¯é¿å…hashcodeçš„å®ç°å’Œæˆ‘ä»¬è‡ªå®šä¹‰ç±»çš„equalsæ–¹æ³•</li>\n<li>è¿”å›é›¶é•¿åº¦çš„é›†åˆæˆ–è€…æ•°ç»„ï¼Œè€Œä¸æ˜¯è¿”å›ä¸€ä¸ªnull ï¼Œè¿™æ ·å¯ä»¥é˜²æ­¢åº•å±‚é›†åˆæ˜¯ç©ºçš„</li>\n</ul>\n<h1>51. Arrayä¸ArrayListåŒºåˆ«ä¸é€‰ç”¨ï¼Ÿ</h1>\n<ul>\n<li>Arrayå¯ä»¥å®¹çº³åŸºæœ¬ç±»å‹å’Œå¯¹è±¡ï¼Œè€ŒArrayListåªèƒ½å®¹çº³å¯¹è±¡ã€‚</li>\n<li>Arrayæ˜¯æŒ‡å®šå¤§å°çš„ï¼Œè€ŒArrayListå¤§å°æ˜¯å›ºå®šçš„ï¼Œå¯è‡ªåŠ¨æ‰©å®¹ã€‚</li>\n<li>åˆ—è¡¨çš„å¤§å°å·²ç»æŒ‡å®šä¸”å­˜å‚¨å’Œéå†æ¨èä½¿ç”¨Array</li>\n<li>å¤šç»´æ•°ç»„æ¨èä½¿ç”¨Array[][]</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/9d9065dbe4e0a916ac96f.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "javaå¹¶å‘",
      "url": "https://javaguide.cn/interview/javahighconcurrency.html",
      "id": "https://javaguide.cn/interview/javahighconcurrency.html",
      "summary": "1. å¹¶å‘ä¸å¹¶è¡ŒåŒºåˆ«? å¹¶å‘:æŒ‡å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶é—´æ‰§è¡Œã€‚è¿™äº›ä»»åŠ¡åœ¨å•æ ¸æˆ–å¤šæ ¸å¤„ç†å™¨ä¸Šé€šè¿‡è¿›ç¨‹æˆ–çº¿ç¨‹è½®æµåœ°å æœ‰å¤„ç†å™¨èµ„æºæ¥æ‰§è¡Œã€‚ å¹¶è¡Œ:æŒ‡å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œã€‚å¤šä¸ªå¤„ç†å™¨åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªæ ¸å¿ƒå®é™…ä¸Šå¯ä»¥åœ¨åŒä¸€æ—¶é—´ç‹¬ç«‹åœ°æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚ ä¸²è¡Œ:å¤šä¸ªäº‹ä»¶æŒ‰é¡ºåºæ‰§è¡Œ å¹¶è¡Œå°±æ˜¯æ¯ä¸ªäººå¯¹åº”ä¸€ä¸ªé˜¿å§¨ï¼ŒåŒæ—¶æ‰“é¥­ï¼›è€Œå¹¶å‘å°±æ˜¯ä¸€ä¸ªé˜¿å§¨ï¼Œè½®æµç»™æ¯ä¸ªäººæ‰“é¥­ã€‚ 2. è¿›ç¨‹...",
      "content_html": "<!-- more -->\n<h1>1. å¹¶å‘ä¸å¹¶è¡ŒåŒºåˆ«?</h1>\n<ul>\n<li>å¹¶å‘:æŒ‡å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶é—´æ‰§è¡Œã€‚è¿™äº›ä»»åŠ¡åœ¨å•æ ¸æˆ–å¤šæ ¸å¤„ç†å™¨ä¸Šé€šè¿‡è¿›ç¨‹æˆ–çº¿ç¨‹è½®æµåœ°å æœ‰å¤„ç†å™¨èµ„æºæ¥æ‰§è¡Œã€‚</li>\n<li>å¹¶è¡Œ:æŒ‡å¤šä¸ªä»»åŠ¡åœ¨åŒä¸€æ—¶åˆ»æ‰§è¡Œã€‚å¤šä¸ªå¤„ç†å™¨åŒæ—¶æ‰§è¡Œå¤šä¸ªä»»åŠ¡ï¼Œæ¯ä¸ªæ ¸å¿ƒå®é™…ä¸Šå¯ä»¥åœ¨åŒä¸€æ—¶é—´ç‹¬ç«‹åœ°æ‰§è¡Œä¸åŒçš„ä»»åŠ¡ã€‚</li>\n<li>ä¸²è¡Œ:å¤šä¸ªäº‹ä»¶æŒ‰é¡ºåºæ‰§è¡Œ</li>\n<li>å¹¶è¡Œå°±æ˜¯æ¯ä¸ªäººå¯¹åº”ä¸€ä¸ªé˜¿å§¨ï¼ŒåŒæ—¶æ‰“é¥­ï¼›è€Œå¹¶å‘å°±æ˜¯ä¸€ä¸ªé˜¿å§¨ï¼Œè½®æµç»™æ¯ä¸ªäººæ‰“é¥­ã€‚</li>\n</ul>\n<h1>2. è¿›ç¨‹å’Œçº¿ç¨‹çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>è¿›ç¨‹æ˜¯ç¨‹åºè¿è¡Œå’Œæ“ä½œç³»ç»Ÿèµ„æºåˆ†é…çš„åŸºæœ¬å•ä½ï¼Œè€Œçº¿ç¨‹æ˜¯cpuè°ƒåº¦å’Œæ‰§è¡Œçš„åŸºæœ¬å•ä½</li>\n</ul>\n<h1>3. åˆ›å»ºçº¿ç¨‹çš„å‡ ç§æ–¹å¼ï¼Ÿâˆš</h1>\n<ul>\n<li>ç»§æ‰¿Threadç±»å¹¶è¦†ç›–runæ–¹æ³•</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class MyThread extends Thread {\n  @Override\n  public void run() {\n      System.out.println(Thread.currentThread().getName() + \"æ­£åœ¨æ‰§è¡Œï¼\");\n  }\n  public static void main(String[] args) {\n      new MyThread(\"æ–°çš„çº¿ç¨‹ï¼\").start();\n  }\n}\n</code></pre></div><ul>\n<li>å®ç°Runnableæ¥å£å¹¶å®ç°runæ–¹æ³•</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class MyRunnable implements Runnable{\n  @Override\n  public void run() {\n    System.out.println(Thread.currentThread().getName() + \"æ­£åœ¨æ‰§è¡Œï¼\");\n  }\n  public static void main(String[] args) {\n    new Thread(new MyRunnable()).start();\n  }\n}\n</code></pre></div><ul>\n<li>é€šè¿‡Callableå’ŒFutureåˆ›å»ºçº¿ç¨‹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class MyCallable implements Callable&lt;Integer&gt;{\n    @Override\n    public Integer call() {//è°ƒç”¨FutureTask.get()å¾—åˆ°è¿”å›å€¼ï¼Œè°ƒç”¨åä¼šé˜»å¡ä¸»è¿›ç¨‹çš„ç»§ç»­å¾€ä¸‹æ‰§è¡Œ\n        System.out.println(Thread.currentThread().getName() + \" call()æ–¹æ³•æ‰§è¡Œä¸­...\");\n        return 1;\n    }\n    public static void main(String[] args) throws ExecutionException, InterruptedException{\n        FutureTask&lt;Integer&gt; futureTask = new FutureTask&lt;Integer&gt;(new MyCallable());\n        Thread thread = new Thread(futureTask);\n        thread.start();\n        System.out.println(\"è¿”å›ç»“æœ \" + futureTask.get());\n    }\n}\n</code></pre></div><h1>4. çº¿ç¨‹çš„runå’Œstartæ–¹æ³•æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>startæ–¹æ³•å¯åŠ¨çº¿ç¨‹å¹¶ä½¿çº¿ç¨‹è¿›å…¥å°±ç»ªçŠ¶æ€ï¼Œjvmè°ƒç”¨è¯¥çº¿ç¨‹çš„runæ–¹æ³•</li>\n<li>runæ–¹æ³•æ™®é€šæ–¹æ³•è°ƒç”¨</li>\n</ul>\n<h1>5. å¦‚ä½•åœæ­¢ä¸€ä¸ªæ­£åœ¨è¿è¡Œçš„çº¿ç¨‹ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨volatileé€€å‡ºæ ‡å¿—ï¼Œä½¿çº¿ç¨‹æ­£å¸¸é€€å‡ºï¼Œä¹Ÿå°±æ˜¯å½“runæ–¹æ³•å®Œæˆåçº¿ç¨‹ç»ˆæ­¢</li>\n<li>ä½¿ç”¨interruptæ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚æ•è·ä¸­æ–­å¼‚å¸¸åé€€å‡ºçº¿ç¨‹å¹¶ç»“æŸé˜»å¡çŠ¶æ€</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å“åº”ä¸­æ–­\npublic void run() {\n    try {\n        while (!Thread.currentThread().isInterrupted()) {\n            // æ‰§è¡Œä»»åŠ¡\n        }\n    } catch (InterruptedException e) {\n        // çº¿ç¨‹è¢«ä¸­æ–­æ—¶çš„æ¸…ç†ä»£ç \n    } finally {\n        // çº¿ç¨‹ç»“æŸå‰çš„æ¸…ç†ä»£ç \n    }\n}\n\n</code></pre></div><ul>\n<li>runæ–¹æ³•ç»“æŸ</li>\n</ul>\n<h1>6. ä¸€ä¸ªçº¿ç¨‹å¦‚æœå‡ºç°äº†è¿è¡Œæ—¶å¼‚å¸¸ä¼šæ€ä¹ˆæ ·?</h1>\n<ul>\n<li>å¦‚æœå¼‚å¸¸æ²¡æœ‰è¢«æ•è·ï¼Œé‚£ä¹ˆçº¿ç¨‹å°±åœæ­¢æ‰§è¡Œäº†ã€‚</li>\n<li>å¦‚æœçº¿ç¨‹æŒæœ‰æŸä¸ªæŸä¸ªå¯¹è±¡çš„ç›‘è§†å™¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡ç›‘è§†å™¨ä¼šè¢«ç«‹å³é‡Šæ”¾ã€‚</li>\n</ul>\n<h1>7. ä¸»çº¿ç¨‹å¯ä»¥æ•è·åˆ°å­çº¿ç¨‹çš„å¼‚å¸¸å—ï¼Ÿâˆš</h1>\n<ul>\n<li>ä¸èƒ½ã€‚ä½†ä¸»çº¿ç¨‹å¯ç”¨Thread.setDefaultUncaughtExceptionHandler(new MyUncaughtExceptionHandler())æ•è·å­çº¿ç¨‹å¼‚å¸¸</li>\n</ul>\n<h1>8. çº¿ç¨‹æœ‰å“ªäº›å¸¸ç”¨çš„è°ƒåº¦æ–¹æ³•ï¼Ÿ</h1>\n<ul>\n<li>åœ¨Objectç±»ä¸­ç”¨äºçº¿ç¨‹çš„ç­‰å¾…ä¸é€šçŸ¥æ–¹æ³•\n<ul>\n<li>wait()ï¼šå½“çº¿ç¨‹Aè°ƒç”¨å…±äº«å˜é‡çš„wait()æ–¹æ³•æ—¶ï¼Œçº¿ç¨‹Aä¼šè¢«é˜»å¡æŒ‚èµ·ï¼Œç›´åˆ°çº¿ç¨‹Bè°ƒç”¨äº†å…±äº«å¯¹è±¡notify()æˆ–è€…notifyAll()æ–¹æ³•æˆ–è€…å…¶ä»–çº¿ç¨‹è°ƒç”¨äº†çº¿ç¨‹Açš„interrupt()æ–¹æ³•ï¼Œçº¿ç¨‹AæŠ›å‡ºInterruptedExceptionå¼‚å¸¸æ‰è¿”å›ã€‚</li>\n<li>wait(long timeout)ï¼šå¦‚æœçº¿ç¨‹Aæ²¡æœ‰åœ¨timeoutæ—¶é—´å†…è¢«å…¶å®ƒçº¿ç¨‹å”¤é†’ï¼Œé‚£ä¹ˆè¿™ä¸ªæ–¹æ³•ä¼šå› ä¸ºè¶…æ—¶è€Œè¿”å›ã€‚</li>\n<li>wait(long timeout, int nanos)ï¼Œå…¶å†…éƒ¨è°ƒç”¨çš„æ˜¯ wait(long timout) æ–¹æ³•ã€‚</li>\n<li>notify()ï¼šçº¿ç¨‹Aè°ƒç”¨å…±äº«å¯¹è±¡çš„notify()æ–¹æ³•åï¼Œä¼šéšæœºå”¤é†’ä¸€ä¸ªåœ¨è¿™ä¸ªå…±äº«å˜é‡ä¸Šè°ƒç”¨waitç³»åˆ—æ–¹æ³•åè¢«æŒ‚èµ·çš„çº¿ç¨‹</li>\n<li>notifyAll()ï¼šå”¤é†’æ‰€æœ‰åœ¨è¯¥å…±äº«å˜é‡ä¸Šè°ƒç”¨waitç³»åˆ—æ–¹æ³•è€Œè¢«æŒ‚èµ·çš„çº¿ç¨‹ã€‚</li>\n<li>join()ï¼Œçº¿ç¨‹Aæ‰§è¡Œäº†thread.join()ï¼Œå½“å‰çº¿ç¨‹Aä¼šç­‰å¾…threadçº¿ç¨‹ç»ˆæ­¢ä¹‹åæ‰ä»thread.join()è¿”å›</li>\n</ul>\n</li>\n<li>çº¿ç¨‹ä¼‘çœ \n<ul>\n<li>sleep(long millis)ï¼šé™æ€æ–¹æ³•ï¼Œè®©å‡ºcpuã€‚ä½†ä¸é‡Šæ”¾é”ã€‚æŒ‡å®šçš„ç¡çœ æ—¶é—´åˆ°äº†åè¯¥æ–¹æ³•ä¼šæ­£å¸¸è¿”å›ï¼Œæ¥ç€å‚ä¸CPUè°ƒåº¦ï¼Œè·å–åˆ°CPUèµ„æºåå°±å¯ä»¥ç»§ç»­è¿è¡Œã€‚</li>\n</ul>\n</li>\n<li>è®©å‡ºä¼˜å…ˆæƒ\n<ul>\n<li>yield()ï¼šé™æ€æ–¹æ³•ï¼Œè®©å‡ºCPUï¼Œä½†æ˜¯æœ‰å¯èƒ½ç«‹é©¬åˆå¾—åˆ°CPUè°ƒåº¦</li>\n</ul>\n</li>\n<li>çº¿ç¨‹ä¸­æ–­ï¼šæ˜¯ä¸€ç§çº¿ç¨‹é—´çš„åä½œæ¨¡å¼ï¼Œé€šè¿‡è®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—å¹¶ä¸èƒ½ç›´æ¥ç»ˆæ­¢è¯¥çº¿ç¨‹çš„æ‰§è¡Œï¼Œè€Œæ˜¯è¢«ä¸­æ–­çš„çº¿ç¨‹ä¼šæ ¹æ®ä¸­æ–­çŠ¶æ€è‡ªè¡Œå¤„ç†ã€‚\n<ul>\n<li>void interrupt()ï¼šä¸­æ–­çº¿ç¨‹ï¼Œè®¾ç½®çº¿ç¨‹çš„ä¸­æ–­æ ‡å¿—ä¸ºtrueã€‚å¹¶æŠ›å‡ºInterruptedExceptionï¼Œä½†ä¸ä¼šåœæ­¢çº¿ç¨‹ã€‚éœ€è¦ç”¨ç›‘è§†çº¿ç¨‹çš„çŠ¶æ€ä¸ºå¹¶åšå¤„ç†ã€‚ä¼šä½¿waitã€joinã€sleepæ–¹æ³•æŠ›å‡ºInterruptedExceptionï¼Œç„¶åæ‰§è¡Œcatchä»£ç </li>\n<li>isInterrupted()ï¼š æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ã€‚ä¸æ¸…é™¤æ ‡å¿—ä½</li>\n<li>interrupted()ï¼š æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦è¢«ä¸­æ–­ï¼Œå¦‚æœå‘ç°å½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œåˆ™ä¼šæ¸…é™¤ä¸­æ–­æ ‡å¿—ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹è¢«ä¸­æ–­äº†ï¼Œç¬¬ä¸€æ¬¡è°ƒç”¨è¿”å›trueï¼Œåé¢è¿”å›falseã€‚å½“æŠ›å‡ºInterruptedExceptionæ—¶å€™ï¼Œä¼šæ¸…é™¤ä¸­æ–­æ ‡å¿—ä½ï¼Œä¹Ÿå°±æ˜¯è¯´åœ¨è°ƒç”¨isInterruptedä¼šè¿”å›false</li>\n</ul>\n</li>\n</ul>\n<h1>9. sleep()å’Œwait()çš„åŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>wait()æ˜¯Objectå®ä¾‹æ–¹æ³•ï¼Œsleep()æ–¹æ³•æ˜¯Threadçš„é™æ€æ–¹æ³•</li>\n<li>wait()å¿…é¡»åœ¨åŒæ­¥æ–¹æ³•æˆ–è€…åŒæ­¥å—ä¸­è°ƒç”¨(å¿…é¡»å·²è·å¾—å¯¹è±¡é”)ã€‚å¦åˆ™æŠ›å‡ºIllegalMonitorStateExceptionå¼‚å¸¸ï¼Œsleep()å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹ç§ä½¿ç”¨</li>\n<li>wait()ä¼šè®©å‡ºCPUå¹¶é‡Šæ”¾å æœ‰çš„å¯¹è±¡é”ã€‚sleep()ä¼šè®©å‡ºCPUä½†ä¸ä¼šé‡Šæ”¾æ‰å¯¹è±¡é”</li>\n<li>wait()å¿…é¡»ç­‰å¾…Object.notify/notifyAllé€šçŸ¥æˆ–è€…wait()ç­‰å¾…æ—¶é—´åˆ°æœŸåï¼Œå†æ¬¡è·å¾—CPUæ—¶é—´ç‰‡æ‰ä¼šç»§ç»­æ‰§è¡Œï¼Œsleep()åœ¨ä¼‘çœ æ—¶é—´è¾¾åˆ°åå¦‚æœå†æ¬¡è·å¾—CPUæ—¶é—´ç‰‡å°±ä¼šç»§ç»­æ‰§è¡Œ</li>\n</ul>\n<h1>10. çº¿ç¨‹çŠ¶æ€åŠè½¬æ¢ï¼Ÿ</h1>\n<p>Threadæºç ä¸­å®šä¹‰äº†6ç§çŠ¶æ€ï¼š</p>\n<ul>\n<li>new:åˆå§‹çŠ¶æ€ï¼Œçº¿ç¨‹è¢«æ„å»ºï¼Œè¿˜æ²¡æœ‰è°ƒç”¨startæ–¹æ³•</li>\n<li>runnnable:è¿è¡ŒçŠ¶æ€ï¼Œjavaçº¿ç¨‹å°†æ“ä½œç³»ç»Ÿçš„å°±ç»ªå’Œè¿è¡Œä¸¤ç§çŠ¶æ€ç»Ÿç§°ä¸ºè¿è¡Œä¸­</li>\n<li>blocked:é˜»å¡çŠ¶æ€ï¼Œè¡¨ç¤ºçº¿ç¨‹é˜»å¡ä¸é”</li>\n<li>waiting:ç­‰å¾…çŠ¶æ€ï¼Œè¡¨ç¤ºå½“å‰çº¿ç¨‹éœ€è¦ç­‰å¾…å…¶ä»–çº¿ç¨‹é€šçŸ¥æˆ–è€…ä¸­æ–­</li>\n<li>time_waiting:è¶…æ—¶ç­‰å¾…çŠ¶æ€ï¼Œå¯ä»¥åœ¨æŒ‡å®šæ—¶é—´è‡ªè¡Œè¿”å›</li>\n<li>terminated:ç»ˆæ­¢çŠ¶æ€ï¼Œè¡¨ç¤ºçº¿ç¨‹æ‰§è¡Œå®Œæ¯•<br>\n![threadstatus.png)</li>\n</ul>\n<h1>11. ä»€ä¹ˆæ˜¯çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿ</h1>\n<ul>\n<li>çº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢æ˜¯æŒ‡æ“ä½œç³»ç»Ÿåœ¨å¤šä¸ªçº¿ç¨‹ä¹‹é—´åˆ‡æ¢æ‰§è¡Œæ—¶ï¼Œä¿å­˜å½“å‰çº¿ç¨‹çš„æ‰§è¡ŒçŠ¶æ€å¹¶æ¢å¤å¦ä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡ŒçŠ¶æ€çš„è¿‡ç¨‹ã€‚</li>\n</ul>\n<h1>12. å®ˆæŠ¤çº¿ç¨‹Daemonä¸ç”¨æˆ·çº¿ç¨‹UseråŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>ç”¨æˆ·(User)çº¿ç¨‹ï¼šè¿è¡Œåœ¨å‰å°ï¼Œæ‰§è¡Œå…·ä½“çš„ä»»åŠ¡ï¼Œå¦‚è¿æ¥ç½‘ç»œçš„å­çº¿ç¨‹ã€mainå‡½æ•°æ‰€åœ¨çš„çº¿ç¨‹ç­‰</li>\n<li>å®ˆæŠ¤(Daemon)çº¿ç¨‹ï¼šè¿è¡Œåœ¨åå°ï¼Œä¸ºå…¶ä»–å‰å°çº¿ç¨‹æœåŠ¡ã€‚åœ¨å®ˆæŠ¤çº¿ç¨‹ä¸­äº§ç”Ÿçš„æ–°çº¿ç¨‹ä¹Ÿæ˜¯å®ˆæŠ¤çº¿ç¨‹ï¼Œå¿…é¡»åœ¨start()ä¹‹å‰setDaemon(true)è®¾ç½®ä¸ºå®ˆæŠ¤çº¿ç¨‹ï¼Œå¦åˆ™ä¼šæŠ›å¼‚å¸¸ï¼Œå¦‚åƒåœ¾å›æ”¶çº¿ç¨‹</li>\n<li>åŒºåˆ«:ç¨‹åºè¿è¡Œå®Œæ¯•ï¼ŒJVMä¼šç­‰å¾…éå®ˆæŠ¤çº¿ç¨‹å®Œæˆåå…³é—­ï¼Œä½†ä¸ä¼šç­‰å¾…å®ˆæŠ¤çº¿ç¨‹å®Œæˆï¼Œå› æ­¤å®ˆæŠ¤çº¿ç¨‹ä¸­ä¸èƒ½ä¾é finallyå—çš„å†…å®¹æ¥ç¡®ä¿æ‰§è¡Œå…³é—­æˆ–æ¸…ç†èµ„æºçš„é€»è¾‘</li>\n</ul>\n<h1>13. çº¿ç¨‹é—´æœ‰å“ªäº›é€šä¿¡æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>volatileå’Œsynchronizedå…³é”®å­—\n<ul>\n<li>volatileä¿®é¥°æˆå‘˜å˜é‡ï¼Œå‘ŠçŸ¥ç¨‹åºä»»ä½•å¯¹è¯¥å˜é‡çš„è®¿é—®å‡éœ€è¦ä»å…±äº«å†…å­˜ä¸­è·å–ï¼Œè€Œå¯¹å®ƒçš„æ”¹å˜å¿…é¡»åŒæ­¥åˆ·æ–°å›å…±äº«å†…å­˜ï¼Œä¿è¯æ‰€æœ‰çº¿ç¨‹å¯¹å˜é‡è®¿é—®çš„å¯è§æ€§ã€‚</li>\n<li>synchronizedä¿®é¥°æ–¹æ³•ï¼Œæˆ–è€…ä»¥åŒæ­¥ä»£ç å—çš„å½¢å¼æ¥ä½¿ç”¨ï¼Œç¡®ä¿å¤šä¸ªçº¿ç¨‹åœ¨åŒä¸€ä¸ªæ—¶åˆ»ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹åœ¨æ‰§è¡ŒæŸä¸ªæ–¹æ³•æˆ–æŸä¸ªä»£ç å—ã€‚</li>\n</ul>\n</li>\n<li>Objectç­‰å¾…/é€šçŸ¥æœºåˆ¶\n<ul>\n<li>ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨å…±äº«å¯¹è±¡çš„wait()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šè¿›å…¥è¯¥å¯¹è±¡çš„ç­‰å¾…æ± ï¼Œå¹¶é‡Šæ”¾å·²ç»æŒæœ‰çš„è¯¥å¯¹è±¡çš„é”ï¼Œè¿›å…¥ç­‰å¾…çŠ¶æ€ï¼Œç›´åˆ°å…¶ä»–çº¿ç¨‹è°ƒç”¨ç›¸åŒå¯¹è±¡çš„notify()æˆ–notifyAll()æ–¹æ³•ã€‚</li>\n<li>ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨å…±äº«å¯¹è±¡çš„notify()æ–¹æ³•æ—¶ï¼Œå®ƒä¼šå”¤é†’åœ¨è¯¥å¯¹è±¡ç­‰å¾…æ± ä¸­ç­‰å¾…çš„ä¸€ä¸ªçº¿ç¨‹ï¼Œä½¿å…¶è¿›å…¥é”æ± ï¼Œç­‰å¾…è·å–é”ã€‚</li>\n</ul>\n</li>\n<li>ReentrantLockç­‰å¾…/é€šçŸ¥æœºåˆ¶\n<ul>\n<li>Condition await()è´Ÿè´£ç­‰å¾…ã€signal()å’ŒsignalAll()è´Ÿè´£é€šçŸ¥ã€‚ä¸é”ReentrantLockä¸€èµ·ä½¿ç”¨ï¼Œä¸ºçº¿ç¨‹æä¾›äº†ä¸€ç§ç­‰å¾…æŸä¸ªæ¡ä»¶æˆçœŸçš„æœºåˆ¶ï¼Œå¹¶å…è®¸å…¶ä»–çº¿ç¨‹åœ¨è¯¥æ¡ä»¶å˜åŒ–æ—¶é€šçŸ¥ç­‰å¾…çº¿ç¨‹ã€‚</li>\n</ul>\n</li>\n<li>ç®¡é“è¾“å…¥/è¾“å‡ºæµ\n<ul>\n<li>ä¸»è¦ç”¨äºçº¿ç¨‹ä¹‹é—´çš„æ•°æ®ä¼ è¾“ï¼Œè€Œä¼ è¾“çš„åª’ä»‹ä¸ºå†…å­˜ã€‚ä¸»è¦åŒ…æ‹¬äº†å¦‚ä¸‹4ç§å…·ä½“å®ç°ï¼šPipedOutputStreamã€PipedInputStreamã€PipedReaderå’ŒPipedWriterï¼Œå‰ä¸¤ç§é¢å‘å­—èŠ‚ï¼Œè€Œåä¸¤ç§é¢å‘å­—ç¬¦ã€‚</li>\n</ul>\n</li>\n<li>Thread.join()\n<ul>\n<li>å¦‚æœä¸€ä¸ªçº¿ç¨‹Aæ‰§è¡Œäº†thread.join()è¯­å¥ï¼Œå…¶å«ä¹‰æ˜¯ï¼šå½“å‰çº¿ç¨‹Aç­‰å¾…threadçº¿ç¨‹ç»ˆæ­¢ä¹‹åæ‰ä»thread.join()è¿”å›ã€‚</li>\n</ul>\n</li>\n<li>ä½¿ç”¨ThreadLocal\n<ul>\n<li>ä¸€ç§ç”¨äºå®ç°çº¿ç¨‹å±€éƒ¨å˜é‡çš„å·¥å…·ã€‚å®ƒå…è®¸æ¯ä¸ªçº¿ç¨‹éƒ½æ‹¥æœ‰è‡ªå·±çš„ç‹¬ç«‹å‰¯æœ¬ï¼Œä»è€Œå®ç°çº¿ç¨‹éš”ç¦»ã€‚ç”¨äºè§£å†³å¤šçº¿ç¨‹ä¸­å…±äº«å¯¹è±¡çš„çº¿ç¨‹å®‰å…¨é—®é¢˜ã€‚</li>\n</ul>\n</li>\n<li>CountDownLatchã€CyclicBarrierã€Semaphoreç­‰å¹¶å‘å·¥å…·ç±»ã€‚</li>\n</ul>\n<h1>14. ä»€ä¹ˆæ˜¯çº¿ç¨‹å®‰å…¨ï¼Ÿå¯¼è‡´åŸå› ï¼Ÿè§£å†³çº¿ç¨‹å®‰å…¨é—®é¢˜çš„æ–¹æ³•ï¼Ÿ</h1>\n<ul>\n<li>\n<p>çº¿ç¨‹å®‰å…¨ï¼ŒæŒ‡å¹¶å‘ç¼–ç¨‹ä¸­ï¼Œä»£ç èƒ½å¤Ÿæ­£ç¡®åœ°å¤„ç†å¤šä¸ªçº¿ç¨‹å¯¹å…±äº«æ•°æ®çš„å¹¶å‘è®¿é—®ï¼Œä¸ä¼šå¯¼è‡´æ•°æ®çš„ä¸ä¸€è‡´æˆ–å…¶ä»–ä¸å¯é¢„è§çš„ç»“æœ</p>\n</li>\n<li>\n<p>Servletçº¿ç¨‹ä¸å®‰å…¨ï¼ŒServletå•å®ä¾‹å¤šçº¿ç¨‹ï¼Œå½“å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®åŒä¸€ä¸ªæ–¹æ³•ï¼Œä¸èƒ½ä¿è¯å…±äº«å˜é‡çš„çº¿ç¨‹å®‰å…¨ã€‚</p>\n</li>\n<li>\n<p>Struts2çº¿ç¨‹å®‰å…¨ï¼ŒActionå¤šå®ä¾‹å¤šçº¿ç¨‹ï¼Œæ¯ä¸ªè¯·æ±‚è¿‡æ¥éƒ½ä¼šnewä¸€ä¸ªæ–°çš„Actionå¤„ç†ï¼Œå®Œæˆåé”€æ¯ã€‚</p>\n</li>\n<li>\n<p>SpringMVCçº¿ç¨‹ä¸å®‰å…¨ï¼Œå’ŒServletç±»ä¼¼</p>\n</li>\n<li>\n<p>åŸå› ï¼šä¸»å†…å­˜å’Œå·¥ä½œå†…å­˜æ•°æ®ä¸ä¸€è‡´å’Œé‡æ’åºå¯¼è‡´è¡¨ç°å…¨å±€å˜é‡åŠé™æ€å˜é‡åŒæ—¶è¯»å†™å¼•èµ·</p>\n</li>\n<li>\n<p>synchronized å…³é”®å­—å¯ä»¥ç”¨äºæ–¹æ³•å’Œä»£ç å—ï¼Œç¡®ä¿åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥æ‰§è¡Œç‰¹å®šçš„ä»£ç æ®µã€‚</p>\n</li>\n<li>\n<p>volatile å˜é‡ä¿è¯äº†å˜é‡çš„å¯è§æ€§ï¼Œä¿®æ”¹æ“ä½œæ˜¯ç«‹å³åŒæ­¥åˆ°ä¸»å­˜çš„ï¼Œè¯»æ“ä½œä»ä¸»å­˜ä¸­è¯»å–ã€‚</p>\n</li>\n<li>\n<p>ThreadLocal ä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›äº†å˜é‡çš„ç‹¬ç«‹å‰¯æœ¬ï¼Œæ¯ä¸ªçº¿ç¨‹éƒ½åªèƒ½è®¿é—®è‡ªå·±çš„å‰¯æœ¬ï¼Œä»è€Œå®ç°äº†çº¿ç¨‹éš”ç¦»ï¼Œä¿è¯äº†çº¿ç¨‹å®‰å…¨</p>\n</li>\n<li>\n<p>å¹¶å‘åŒ…ï¼ˆjava.util.concurrent.locksï¼‰ä¸­æä¾›äº† Lock æ¥å£å’Œä¸€äº›å®ç°ç±»ï¼Œå¦‚ ReentrantLockã€‚ç›¸æ¯”äº synchronizedï¼ŒReentrantLock æä¾›äº†å…¬å¹³é”å’Œéå…¬å¹³é”ã€‚</p>\n</li>\n<li>\n<p>åŸå­å˜é‡ç±»ï¼ˆå¦‚ AtomicIntegerï¼ŒAtomicLong ç­‰ï¼‰ï¼Œå®ƒä»¬åˆ©ç”¨ CASï¼ˆæ¯”è¾ƒå¹¶äº¤æ¢ï¼‰ï¼Œå®ç°äº†æ— é”çš„åŸå­æ“ä½œï¼Œé€‚ç”¨äºç®€å•çš„è®¡æ•°å™¨åœºæ™¯ã€‚</p>\n</li>\n<li>\n<p>çº¿ç¨‹å®‰å…¨çš„é›†åˆç±»ï¼Œå¦‚ ConcurrentHashMapï¼ŒCopyOnWriteArrayList ç­‰ã€‚è¿™äº›é›†åˆç±»å†…éƒ¨å®ç°äº†å¿…è¦çš„åŒæ­¥ç­–ç•¥ï¼Œæä¾›äº†æ›´é«˜æ•ˆçš„å¹¶å‘è®¿é—®ã€‚</p>\n</li>\n</ul>\n<h1>15. ThreadLocalçš„ç†è§£ï¼Ÿ</h1>\n<ul>\n<li>çº¿ç¨‹å±€éƒ¨å˜é‡ç±»ã€‚ä½¿å¾—æ¯ä¸ªçº¿ç¨‹éƒ½å¯ä»¥å­˜å‚¨å’Œè®¿é—®å…¶è‡ªå·±çš„çº¿ç¨‹å±€éƒ¨å˜é‡ï¼Œä»è€Œå®ç°äº†çº¿ç¨‹é—´çš„æ•°æ®éš”ç¦»ã€‚é¿å…äº†çº¿ç¨‹å®‰å…¨é—®é¢˜</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static ThreadLocal&lt;Connection&gt; connectionHolder = new ThreadLocal&lt;Connection&gt;() {\n  public Connection initialValue() {\n      return DriverManager.getConnection(DB_URL);\n  }\n};\npublic static Connection getConnection() {\n  return connectionHolder.get();\n}\n</code></pre></div><h1>16. ThreadLocal ä½¿ç”¨åœºæ™¯ï¼Ÿ</h1>\n<ul>\n<li>ç”¨æˆ·ä¿¡æ¯ä¸Šä¸‹æ–‡çš„å­˜å‚¨ã€‚ç”¨æˆ·ç™»å½•åçš„æ¯æ¬¡è®¿é—®æ¥å£ï¼Œéƒ½ä¼šåœ¨è¯·æ±‚å¤´ä¸­æºå¸¦ä¸€ä¸ªtokenï¼Œåœ¨æ§åˆ¶å±‚å¯ä»¥æ ¹æ®è¿™ä¸ªtokenï¼Œè§£æå‡ºç”¨æˆ·çš„åŸºæœ¬ä¿¡æ¯ã€‚åœ¨æ§åˆ¶å±‚æ‹¦æˆªè¯·æ±‚æŠŠç”¨æˆ·ä¿¡æ¯å­˜å…¥ThreadLocalï¼Œè¿™æ ·åœ¨ä»»ä½•åœ°æ–¹éƒ½å¯ä»¥å–å‡ºThreadLocalä¸­çš„ç”¨æˆ·æ•°æ®</li>\n<li>çº¿ç¨‹çº§å•ä¾‹</li>\n<li>ä¸ºæ¯ä¸ªçº¿ç¨‹åˆ†é…ä¸€ä¸ªJDBCè¿æ¥ã€‚ä¿è¯æ¯ä¸ªçº¿ç¨‹çš„éƒ½åœ¨å„è‡ªçš„JDBCè¿æ¥ä¸Šè¿›è¡Œæ•°æ®åº“çš„æ“ä½œï¼Œä¸ä¼šå‡ºç°Açº¿ç¨‹å…³äº†Bçº¿ç¨‹æ­£åœ¨ä½¿ç”¨çš„JDBCè¿æ¥</li>\n<li>tomcatå¤„ç†è¯·æ±‚</li>\n<li>sessionã€cookieç®¡ç†</li>\n</ul>\n<h1>17. ThreadLocalæ€ä¹ˆå®ç°çš„å‘¢ï¼Ÿ</h1>\n<ul>\n<li>ThreadLocal é€šè¿‡ä¸ºæ¯ä¸ªçº¿ç¨‹æä¾›ä¸€ä¸ªç‹¬ç«‹çš„ ThreadLocalMap æ¥å®ç°çº¿ç¨‹é—´çš„æ•°æ®éš”ç¦»ï¼ŒThreadLocalMap æ˜¯ ThreadLocalé™æ€å†…éƒ¨ç±»ï¼ŒThreadLocalMapå†…éƒ¨ç»´æŠ¤ç€Entryæ•°ç»„ï¼Œæ¯ä¸ªEntryä»£è¡¨ä¸€ä¸ªå®Œæ•´çš„å¯¹è±¡ï¼Œkeyæ˜¯ThreadLocalçš„å¼±å¼•ç”¨ï¼Œvalueæ˜¯ThreadLocalçš„æ³›å‹å€¼ã€‚Entry ç»§æ‰¿äº† WeakReferenceï¼Œå› æ­¤ key æ˜¯ä¸€ä¸ªå¼±å¼•ç”¨ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ ThreadLocalçš„setæˆ–getæ–¹æ³•æ—¶ï¼Œå®é™…ä¸Šæ˜¯è®¿é—®çº¿ç¨‹è‡ªå·±çš„ThreadLocal.ThreadLocalMap</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ThreadLocal&lt;T&gt; {\n  public T get() {\n      Thread t = Thread.currentThread();\n      ThreadLocalMap map = getMap(t);\n      if (map != null) {\n          ThreadLocalMap.Entry e = map.getEntry(this);\n          if (e != null) {\n              @SuppressWarnings(\"unchecked\")\n              T result = (T)e.value;\n              return result;\n          }\n      }\n      return setInitialValue();\n  }\n  public void set(T value) {\n      //è·å–å½“å‰çº¿ç¨‹\n      Thread t = Thread.currentThread();\n      //è·å–ThreadLocalMap\n      ThreadLocalMap map = getMap(t);\n      //å°†å½“å‰å…ƒç´ å­˜å…¥map\n      if (map != null)\n          map.set(this, value);\n      else\n          createMap(t, value);\n  }\n  ThreadLocalMap getMap(Thread t) {\n      return t.threadLocals;\n  }\n  static class ThreadLocalMap {\n    static class Entry extends WeakReference&lt;ThreadLocal&lt;?&gt;&gt; {\n        Object value;\n        Entry(ThreadLocal&lt;?&gt; k, Object v) {\n            super(k);\n            value = v;\n        }\n    }\n    private Entry[] table;\n  }\n}\npublic class Thread implements Runnable {\n  //ThreadLocal.ThreadLocalMapæ˜¯Threadçš„å±æ€§\n  ThreadLocal.ThreadLocalMap threadLocals = null;\n}\npublic class WeakReference&lt;T&gt; extends Reference&lt;T&gt; {\n  public WeakReference(T referent) {\n      super(referent);\n  }\n}\n</code></pre></div><h1>18. ä¸ºä»€ä¹ˆkeyè®¾è®¡æˆå¼±å¼•ç”¨ï¼Ÿ</h1>\n<ul>\n<li>ä¸ºäº†é˜²æ­¢å†…å­˜æ³„æ¼ã€‚ä¿è¯çº¿ç¨‹ç»“æŸjvmåƒåœ¾å›æ”¶æ—¶ã€æˆ–è€…å†…å­˜ä¸è¶³æ—¶å›æ”¶keyã€‚ä¸€æ—¦ key è¢«å›æ”¶ï¼ŒThreadLocalMap åœ¨è¿›è¡Œ setã€get çš„æ—¶å€™å°±ä¼šå¯¹ key ä¸º null çš„ Entry è¿›è¡Œæ¸…ç†ã€‚é¿å…å†…å­˜æ³„æ¼</li>\n</ul>\n<h1>19. ThreadLocalå†…å­˜æ³„éœ²é—®é¢˜åŠè§£å†³æ–¹æ¡ˆï¼Ÿ</h1>\n<ul>\n<li>ThreadLocalçš„ç§æœ‰å±æ€§ThreadLocalMapä¸­ä½¿ç”¨çš„keyä¸ºThreadLocalå®ä¾‹ï¼Œå¼±å¼•ç”¨,è€Œvalueæ˜¯å¼ºå¼•ç”¨ã€‚é€šå¸¸æƒ…å†µä¸‹ï¼Œéšç€çº¿ç¨‹ Thread çš„ç»“æŸï¼Œå…¶å†…éƒ¨çš„ ThreadLocalMap ä¹Ÿä¼šè¢«å›æ”¶ï¼Œä»è€Œé¿å…äº†å†…å­˜æ³„æ¼ã€‚ä½†å¦‚æœä¸€ä¸ªçº¿ç¨‹ä¸€ç›´åœ¨è¿è¡Œï¼Œå¹¶ä¸”å…¶ ThreadLocalMap ä¸­çš„ Entry.value ä¸€ç›´æŒ‡å‘æŸä¸ªå¼ºå¼•ç”¨å¯¹è±¡ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°±ä¸ä¼šè¢«å›æ”¶ï¼Œä»è€Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚å½“ Entry éå¸¸å¤šæ—¶ï¼Œå¯èƒ½å°±ä¼šå¼•å‘æ›´ä¸¥é‡çš„å†…å­˜æº¢å‡ºé—®é¢˜ã€‚</li>\n<li>æ¯æ¬¡ä½¿ç”¨å®ŒThreadLocalï¼Œéƒ½finallyè°ƒç”¨å®ƒçš„remove()æ–¹æ³•ï¼Œæ¸…é™¤æ•°æ®ã€‚</li>\n</ul>\n<h1>20. ThreadLocalMapçš„ç»“æ„ï¼Ÿ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9c42c9f380bcb496ccaae.png\" alt=\"threadlocalmapstructure.png\" tabindex=\"0\"><figcaption>threadlocalmapstructure.png</figcaption></figure>\n<ul>\n<li>å…ƒç´ æ•°ç»„:å­˜å‚¨Entryç±»å‹çš„å…ƒç´ çš„æ•°ç»„ï¼ŒEntry æ˜¯ ThreaLocal å¼±å¼•ç”¨ä½œä¸º keyï¼ŒObject ä½œä¸º value çš„ç»“æ„ã€‚</li>\n<li>æ•£åˆ—æ–¹æ³•:å“ˆå¸Œå–ä½™æ³•å–å‡º key çš„ threadLocalHashCodeï¼Œç„¶åå’Œ table æ•°ç»„é•¿åº¦å‡ä¸€&amp;è¿ç®—ï¼ˆç›¸å½“äºå–ä½™ï¼‰ã€‚æŠŠå¯¹åº”çš„keyæ˜ å°„åˆ°table æ•°ç»„çš„ç›¸åº”ä¸‹æ ‡int i = key.threadLocalHashCode &amp; (table.length - 1);æ¯åˆ›å»ºä¸€ä¸ªThreadLocalå¯¹è±¡ï¼ŒthreadLocalHashCodeå°±ä¼šæ–°å¢0x61c88647ï¼Œå®ƒæ˜¯æ–æ³¢é‚£å¥‘æ•°ã€‚å¥½å¤„æ˜¯ hash åˆ†å¸ƒéå¸¸å‡åŒ€ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static final int HASH_INCREMENT = 0x61c88647;\n\nprivate static int nextHashCode() {\n    return nextHashCode.getAndAdd(HASH_INCREMENT);\n}\n</code></pre></div><h1>21. ThreadLocalMapæ€ä¹ˆè§£å†³Hashå†²çª</h1>\n<ul>\n<li>å¼€æ”¾å®šå€æ³•:\n<ul>\n<li>æ’å…¥æ•°æ®æ—¶é€šè¿‡hashè®¡ç®—åå¾—åˆ°æ•°ç»„ä¸‹æ ‡ï¼Œå¦‚æœå¯¹åº”ä½ç½®å·²ç»æœ‰æ•°æ®ï¼Œè€Œä¸”Entryæ•°æ®çš„keyå’Œå½“å‰ä¸ç›¸ç­‰ã€‚å°±ä¼šçº¿æ€§å‘åæŸ¥æ‰¾ï¼Œä¸€ç›´æ‰¾åˆ°Entryä¸ºnullçš„æ§½ä½æ‰ä¼šåœæ­¢æŸ¥æ‰¾ï¼ŒæŠŠå…ƒç´ æ”¾åˆ°ç©ºçš„æ§½ä¸­ã€‚</li>\n<li>åœ¨è·å–æ•°æ®æ—¶ä¹Ÿä¼šæ ¹æ®ThreadLocalå¯¹è±¡çš„hashå€¼ï¼Œå®šä½åˆ°tableä¸­çš„ä½ç½®ï¼Œç„¶ååˆ¤æ–­è¯¥æ§½ä½Entryå¯¹è±¡ä¸­çš„keyæ˜¯å¦å’Œgetçš„keyä¸€è‡´ï¼Œå¦‚æœä¸ä¸€è‡´ï¼Œå°±åˆ¤æ–­ä¸‹ä¸€ä¸ªä½ç½®</li>\n</ul>\n</li>\n</ul>\n<h1>22. ThreadLocalMapæ‰©å®¹æœºåˆ¶ï¼Ÿ</h1>\n<ul>\n<li>åœ¨ThreadLocalMap.set()æœ€åï¼Œå¦‚æœæ‰§è¡Œå®Œå¯å‘å¼æ¸…ç†å·¥ä½œåï¼Œæœªæ¸…ç†åˆ°ä»»ä½•æ•°æ®ï¼Œä¸”å½“å‰æ•£åˆ—æ•°ç»„ä¸­Entryçš„æ•°é‡å·²ç»è¾¾åˆ°äº†åˆ—è¡¨çš„æ‰©å®¹é˜ˆå€¼(len*2/3)ï¼Œå°±å¼€å§‹æ‰§è¡Œrehash()é€»è¾‘ï¼š</li>\n<li>rehash()ä¼šå…ˆå»æ¸…ç†è¿‡æœŸçš„Entryï¼Œç„¶åè¿˜è¦æ ¹æ®æ¡ä»¶åˆ¤æ–­size &gt;= threshold* 3/4æ¥å†³å®šæ˜¯å¦éœ€è¦æ‰©å®¹ã€‚</li>\n<li>resize()æ‰©å®¹åçš„newTabçš„å¤§å°ä¸ºè€æ•°ç»„çš„ä¸¤å€ï¼Œç„¶åéå†è€çš„tableæ•°ç»„ï¼Œæ•£åˆ—æ–¹æ³•é‡æ–°è®¡ç®—ä½ç½®ï¼Œå¼€æ”¾åœ°å€è§£å†³å†²çªï¼Œç„¶åæ”¾åˆ°æ–°çš„newTabï¼Œéå†å®Œæˆä¹‹åï¼ŒoldTabä¸­æ‰€æœ‰çš„entryæ•°æ®éƒ½å·²ç»æ”¾å…¥åˆ°newTabä¸­äº†ï¼Œç„¶åtableå¼•ç”¨æŒ‡å‘newTab</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>if (!cleanSomeSlots(i, sz) &amp;&amp; sz &gt;= threshold)\n    rehash();\nprivate void rehash() {\n    //æ¸…ç†è¿‡æœŸEntry\n    expungeStaleEntries();\n\n    //æ‰©å®¹\n    if (size &gt;= threshold - threshold / 4)\n        resize();\n}\n\n//æ¸…ç†è¿‡æœŸEntry\nprivate void expungeStaleEntries() {\n    Entry[] tab = table;\n    int len = tab.length;\n    for (int j = 0; j &lt; len; j++) {\n        Entry e = tab[j];\n        if (e != null &amp;&amp; e.get() == null)\n            expungeStaleEntry(j);\n    }\n}\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/73d10d14f94df858737e5.png\" alt=\"javathreadlocalresize.png\" tabindex=\"0\"><figcaption>javathreadlocalresize.png</figcaption></figure>\n<h1>23. çˆ¶å­çº¿ç¨‹æ€ä¹ˆå…±äº«æ•°æ®ï¼Ÿ</h1>\n<ul>\n<li>çˆ¶çº¿ç¨‹ä½¿ç”¨InheritableThreadLocalæ¥ç»™å­çº¿ç¨‹ä¼ å€¼</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class InheritableThreadLocalTest {\n    public static void main(String[] args) {\n        final ThreadLocal threadLocal = new InheritableThreadLocal();\n        // ä¸»çº¿ç¨‹\n        threadLocal.set(\"ä¸æ“…æŠ€æœ¯\");\n        //å­çº¿ç¨‹\n        Thread t = new Thread() {\n            @Override\n            public void run() {\n                super.run();\n                System.out.println(\"é„™äººä¸‰æŸ ï¼Œ\" + threadLocal.get());\n            }\n        };\n        t.start();\n    }\n}\n</code></pre></div><ul>\n<li>åŸç†ï¼Ÿåœ¨ Thread ç±»é‡Œè¿˜æœ‰å¦å¤–ä¸€ä¸ªå˜é‡inheritableThreadLocalsã€‚åœ¨Thread.initçš„æ—¶å€™ï¼Œå¦‚æœçˆ¶çº¿ç¨‹çš„inheritableThreadLocalsä¸ä¸ºç©ºï¼Œå°±æŠŠå®ƒèµ‹ç»™å½“å‰çº¿ç¨‹ï¼ˆå­çº¿ç¨‹ï¼‰çš„inheritableThreadLocals ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Thread {\n  ThreadLocal.ThreadLocalMap inheritableThreadLocals = null;\n}\n\nif (inheritThreadLocals &amp;&amp; parent.inheritableThreadLocals != null)\n    this.inheritableThreadLocals =\n        ThreadLocal.createInheritedMap(parent.inheritableThreadLocals);\n</code></pre></div><h1>24. ä»€ä¹ˆæ˜¯JMMå†…å­˜æ¨¡å‹ï¼Ÿ</h1>\n<ul>\n<li>\n<p>Javaå†…å­˜æ¨¡å‹ï¼ˆJava Memory Model,JMMï¼‰æ˜¯ä¸€ç§æŠ½è±¡çš„æ¨¡å‹.ä¸»è¦ç”¨æ¥å®šä¹‰å¤šçº¿ç¨‹ä¸­å˜é‡çš„è®¿é—®è§„åˆ™ï¼Œç”¨æ¥è§£å†³å˜é‡çš„å¯è§æ€§ã€æœ‰åºæ€§å’ŒåŸå­æ€§é—®é¢˜ï¼Œç¡®ä¿åœ¨å¹¶å‘ç¯å¢ƒä¸­å®‰å…¨åœ°è®¿é—®å…±äº«å˜é‡ã€‚</p>\n</li>\n<li>\n<p>JMMè§„å®šå…±äº«å˜é‡å­˜å‚¨åœ¨ä¸»å†…å­˜ï¼ˆMain Memoryï¼‰ä¸­ã€‚æ¯æ¡çº¿ç¨‹éƒ½æœ‰ç§æœ‰çš„æœ¬åœ°å†…å­˜ï¼ˆLocal Memoryï¼‰ï¼Œæœ¬åœ°å†…å­˜ä¸­å­˜å‚¨äº†å…±äº«å˜é‡çš„å‰¯æœ¬ï¼Œçº¿ç¨‹å¯¹å˜é‡çš„æ‰€æœ‰æ“ä½œï¼ˆè¯»å–ã€èµ‹å€¼ç­‰ï¼‰éƒ½å¿…é¡»åœ¨æœ¬åœ°å†…å­˜ä¸­è¿›è¡Œï¼Œè€Œä¸èƒ½ç›´æ¥è¯»å†™ä¸»å†…å­˜ä¸­çš„å˜é‡ã€‚ä¸åŒçš„çº¿ç¨‹ä¹‹é—´ä¹Ÿæ— æ³•ç›´æ¥è®¿é—®å¯¹æ–¹æœ¬åœ°å†…å­˜ä¸­çš„å˜é‡ï¼Œçº¿ç¨‹é—´çš„å˜é‡å€¼çš„ä¼ é€’å‡éœ€è¦é€šè¿‡ä¸»å†…å­˜æ¥å®Œæˆã€‚å› æ­¤çº¿ç¨‹ä¹‹é—´çš„å˜é‡å˜å¾—ä¸å¯è§</p>\n</li>\n<li>\n<p>å½“ä¸€ä¸ªçº¿ç¨‹æ›´æ”¹äº†æœ¬åœ°å†…å­˜ä¸­å…±äº«å˜é‡çš„å‰¯æœ¬åï¼Œå®ƒéœ€è¦å°†è¿™äº›æ›´æ”¹åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­ï¼Œä»¥ç¡®ä¿å…¶ä»–çº¿ç¨‹å¯ä»¥çœ‹åˆ°è¿™äº›æ›´æ”¹ã€‚</p>\n</li>\n<li>\n<p>å½“ä¸€ä¸ªçº¿ç¨‹éœ€è¦è¯»å–å…±äº«å˜é‡æ—¶ï¼Œå®ƒå¯èƒ½é¦–å…ˆä»æœ¬åœ°å†…å­˜ä¸­è¯»å–ã€‚å¦‚æœæœ¬åœ°å†…å­˜ä¸­çš„å‰¯æœ¬æ˜¯è¿‡æ—¶çš„ï¼Œçº¿ç¨‹å°†ä»ä¸»å†…å­˜ä¸­é‡æ–°åŠ è½½å…±äº«å˜é‡çš„æœ€æ–°å€¼åˆ°æœ¬åœ°å†…å­˜ä¸­ã€‚</p>\n</li>\n<li>\n<p>æœ¬åœ°å†…å­˜æ˜¯JMMä¸­çš„æŠ½è±¡æ¦‚å¿µï¼Œå¹¶ä¸çœŸå®å­˜åœ¨ã€‚å®é™…ä¸Šï¼Œæœ¬åœ°å†…å­˜å¯èƒ½å¯¹åº”äºCPUç¼“å­˜ã€å¯„å­˜å™¨æˆ–è€…å…¶ä»–ç¡¬ä»¶å’Œç¼–è¯‘å™¨ä¼˜åŒ–ã€‚</p>\n</li>\n<li>\n<p>å¯¹äºå¤šæ ¸CPUçš„ç³»ç»Ÿæ¶æ„ï¼Œæ¯ä¸ªæ ¸åŒ…æ‹¬ALUè®¡ç®—å•å…ƒ+PC+Registers(å¯„å­˜å™¨)+L1ç¼“å­˜+L2ç¼“å­˜ï¼ŒåŒä¸€ä¸ªCPUæ‰€æœ‰æ ¸å…±äº«L3ç¼“å­˜ï¼Œè¿˜æœ‰é™¤CPUå¤–çš„ä¸»å­˜(æŒ‰å—8å­—èŠ‚ï¼ˆç¼“å­˜è¡Œï¼‰å°†L3è¯»å…¥åˆ°å†…å­˜),ç¼“å­˜çš„ç›®çš„å°±æ˜¯ä¸ºäº†æé«˜æ€§èƒ½ï¼Œé¿å…æ¯æ¬¡éƒ½è¦å‘ä¸»å†…å­˜å–ï¼ˆå…·ä½“æŒ‡ç¼“å­˜è¡Œçš„çŠ¶æ€Modifiedã€Exclusiveã€Sharedã€Invalidï¼‰ä¸ºäº†æé«˜å­˜å–æ•ˆç‡éœ€è¦ç¼“å­˜è¡Œå¯¹é½ã€‚JMMçš„æœ¬åœ°å†…å­˜å¯èƒ½å¯¹åº”çš„L1ã€L2ã€L3ç¼“å­˜æˆ–è€…CPUå¯„å­˜å™¨ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/36e655d8c884c2fc1727a.jpg\" alt=\"multicorecpuarchitecture.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/20ce26451ceb038b9daac.png\" alt=\"JMMå†…å­˜æ¨¡å‹JMM.png\"></p>\n</li>\n<li>\n<p>ä¸ºä»€ä¹ˆçº¿ç¨‹è¦ç”¨è‡ªå·±çš„å†…å­˜ï¼Ÿ</p>\n<ul>\n<li>å¤šçº¿ç¨‹ç¯å¢ƒä¸­ï¼Œå¦‚æœæ‰€æœ‰çº¿ç¨‹éƒ½ç›´æ¥æ“ä½œä¸»å†…å­˜ä¸­çš„å…±äº«å˜é‡ï¼Œä¼šå¼•å‘æ›´å¤šçš„å†…å­˜è®¿é—®ç«äº‰ï¼Œè¿™ä¸ä»…å½±å“æ€§èƒ½ï¼Œè¿˜å¢åŠ äº†çº¿ç¨‹å®‰å…¨é—®é¢˜çš„å¤æ‚åº¦ã€‚é€šè¿‡è®©æ¯ä¸ªçº¿ç¨‹ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼Œå¯ä»¥å‡å°‘å¯¹ä¸»å†…å­˜çš„ç›´æ¥è®¿é—®å’Œç«äº‰ï¼Œæé«˜ç¨‹åºçš„å¹¶å‘æ€§èƒ½</li>\n<li>ç°ä»£CPUä¸ºäº†ä¼˜åŒ–æ‰§è¡Œæ•ˆç‡ï¼Œå¯èƒ½ä¼šå¯¹æŒ‡ä»¤é‡æ’åºã€‚ä½¿ç”¨æœ¬åœ°å†…å­˜ï¼ˆCPU ç¼“å­˜å’Œå¯„å­˜å™¨ï¼‰å¯ä»¥åœ¨ä¸å½±å“æœ€ç»ˆæ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œæé«˜æ‰§è¡Œæ•ˆç‡ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>25. åœ¨ Java ç¨‹åºä¸­æ€ä¹ˆä¿è¯å¤šçº¿ç¨‹çš„è¿è¡Œå®‰å…¨å’Œå¹¶å‘ç¼–ç¨‹ä¸‰è¦ç´ ?</h1>\n<ul>\n<li>åŸå­æ€§ï¼šä¸€ä¸ªæ“ä½œæ˜¯ä¸å¯åˆ†å‰²ã€ä¸å¯ä¸­æ–­çš„ï¼Œè¦ä¹ˆå…¨éƒ¨æ‰§è¡Œå¹¶ä¸”æ‰§è¡Œçš„è¿‡ç¨‹ä¸ä¼šè¢«ä»»ä½•å› ç´ æ‰“æ–­ï¼Œè¦ä¹ˆå°±å…¨ä¸æ‰§è¡Œ(çº¿ç¨‹åˆ‡æ¢å¼•èµ·:synchronized,LOCK,åŸå­ç±»)</li>\n<li>å¯è§æ€§ï¼šä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†æŸä¸€ä¸ªå…±äº«å˜é‡çš„å€¼æ—¶ï¼Œå…¶å®ƒçº¿ç¨‹èƒ½å¤Ÿç«‹å³çŸ¥é“è¿™ä¸ªä¿®æ”¹ã€‚ï¼ˆå·¥ä½œå†…å­˜å’Œä¸»å†…å­˜ä¸ä¸€è‡´å¼•èµ·synchronized,volatile,LOCK,finalï¼‰</li>\n<li>æœ‰åºæ€§ï¼šå¯¹äºä¸€ä¸ªçº¿ç¨‹çš„æ‰§è¡Œä»£ç ï¼Œä»å‰å¾€åä¾æ¬¡æ‰§è¡Œï¼Œå•çº¿ç¨‹ä¸‹å¯ä»¥è®¤ä¸ºç¨‹åºæ˜¯æœ‰åºçš„ï¼Œä½†æ˜¯å¹¶å‘æ—¶æœ‰å¯èƒ½ä¼šå‘ç”ŸæŒ‡ä»¤é‡æ’ã€‚(é‡æ’åºå¼•èµ·synchronized,volatile,LOCK)</li>\n</ul>\n<p>ç¼–è¯‘ä¼˜åŒ–-å¤„ç†å™¨å¯èƒ½ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åº</p>\n<h1>26. ä»€ä¹ˆæ˜¯æŒ‡ä»¤é‡æ’ï¼Ÿ</h1>\n<ul>\n<li>åœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†æé«˜æ€§èƒ½ï¼Œå¤„ç†å™¨å’Œç¼–è¯‘å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œåˆ†ç±»å¦‚ä¸‹\n<ul>\n<li>ç¼–è¯‘å™¨ä¼˜åŒ–çš„é‡æ’åºã€‚ç¼–è¯‘å™¨åœ¨ä¸æ”¹å˜å•çº¿ç¨‹ç¨‹åºè¯­ä¹‰çš„å‰æä¸‹ï¼Œå¯ä»¥é‡æ–°å®‰æ’è¯­å¥çš„æ‰§è¡Œé¡ºåºï¼›JMMçš„ç¼–è¯‘å™¨é‡æ’åºè§„åˆ™ä¼šç¦æ­¢ç‰¹å®šç±»å‹çš„ç¼–è¯‘å™¨é‡æ’åº</li>\n<li>æŒ‡ä»¤çº§å¹¶è¡Œçš„é‡æ’åºã€‚ç°ä»£å¤„ç†å™¨é‡‡ç”¨äº†æŒ‡ä»¤çº§å¹¶è¡ŒæŠ€æœ¯ILPæ¥å°†å¤šæ¡æŒ‡ä»¤é‡å æ‰§è¡Œã€‚å¦‚æœä¸å­˜åœ¨æ•°æ®ä¾èµ–æ€§ï¼Œå¤„ç†å™¨å¯ä»¥æ”¹å˜è¯­å¥å¯¹åº”æœºå™¨æŒ‡ä»¤çš„æ‰§è¡Œé¡ºåºï¼›</li>\n<li>å†…å­˜ç³»ç»Ÿçš„é‡æ’åºã€‚ç”±äºå¤„ç†å™¨ä½¿ç”¨ç¼“å­˜å’Œè¯»/å†™ç¼“å†²åŒºï¼Œä½¿å¾—åŠ è½½å’Œå­˜å‚¨æ“ä½œçœ‹ä¸Šå»å¯èƒ½æ˜¯åœ¨ä¹±åºæ‰§è¡Œçš„</li>\n</ul>\n</li>\n<li>ä»Javaæºä»£ç åˆ°æœ€ç»ˆå®é™…æ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ï¼Œç»å†3ç§é‡æ’åºï¼Œæºä»£ç -&gt;ç¼–è¯‘å™¨ä¼˜åŒ–é‡æ’åº-&gt;æŒ‡ä»¤çº§å¹¶è¡Œé‡æ’åº-&gt;å†…å­˜ç³»ç»Ÿé‡æ’åº-&gt;æœ€ç»ˆæ‰§è¡Œçš„æŒ‡ä»¤åºåˆ—ã€‚é‡æ’åºå¯èƒ½ä¼šå¯¼è‡´å¤šçº¿ç¨‹ç¨‹åºå‡ºç°å†…å­˜å¯è§æ€§é—®é¢˜</li>\n<li>åŒé‡æ ¡éªŒå•ä¾‹æ¨¡å¼ï¼šSingleton instance=new Singleton()å¯¹åº”çš„JVMæŒ‡ä»¤åˆ†ä¸ºä¸‰æ­¥ï¼šåˆ†é…å†…å­˜ç©ºé—´-&gt;åˆå§‹åŒ–å¯¹è±¡-&gt;å¯¹è±¡æŒ‡å‘åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œç»è¿‡ç¼–è¯‘å™¨æŒ‡ä»¤é‡æ’åºï¼Œç¬¬äºŒã€ç¬¬ä¸‰æ­¥å°±å¯èƒ½ä¼šé‡æ’åºã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b2a1c6c49d8b99afb099f.png\" alt=\"doublecheckerror.png\"></li>\n</ul>\n<h1>27. æŒ‡ä»¤é‡æ’æœ‰é™åˆ¶å—ï¼Ÿhappens-before äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>happens-beforeä¿è¯å¤šçº¿ç¨‹æƒ…å†µä¸‹æŒ‡ä»¤é‡æ’åºåç¨‹åºæ­£ç¡®æ€§å’Œå†…å­˜çš„å¯è§æ€§</li>\n<li>happens-beforeå®šä¹‰:\n<ul>\n<li>å¦‚æœä¸€ä¸ªæ“ä½œhappens-beforeå¦ä¸€ä¸ªæ“ä½œï¼Œé‚£ä¹ˆç¬¬ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œç»“æœå°†å¯¹ç¬¬äºŒä¸ªæ“ä½œå¯è§.è€Œä¸”ç¬¬ä¸€ä¸ªæ“ä½œçš„æ‰§è¡Œé¡ºåºåœ¨ç¬¬äºŒä¸ªæ“ä½œä¹‹å‰</li>\n<li>ä¸¤ä¸ªæ“ä½œä¹‹é—´å­˜åœ¨happens-beforeå…³ç³»ï¼Œå¹¶ä¸æ„å‘³ç€ä¸€å®šè¦æŒ‰ç…§happens-beforeåŸåˆ™åˆ¶å®šçš„é¡ºåºæ¥æ‰§è¡Œã€‚åªéœ€é‡æ’åºä¹‹åçš„æ‰§è¡Œç»“æœä¸happens-beforeå…³ç³»æ¥æ‰§è¡Œçš„ç»“æœä¸€è‡´</li>\n</ul>\n</li>\n<li>è§„åˆ™\n<ul>\n<li>ç¨‹åºæ¬¡åºè§„åˆ™ï¼ˆProgram Order Ruleï¼‰ï¼šåœ¨ä¸€ä¸ªçº¿ç¨‹å†…ï¼ŒæŒ‰ç…§ç¨‹åºä»£ç é¡ºåºï¼Œä¹¦å†™åœ¨å‰é¢çš„æ“ä½œå…ˆè¡Œå‘ç”Ÿäºä¹¦å†™åœ¨åé¢çš„æ“ä½œ</li>\n<li>ç›‘è§†å™¨é”å®šè§„åˆ™ï¼ˆMonitor Lock Ruleï¼‰ï¼šä¸€ä¸ªé”çš„unlockæ“ä½œhappens-beforeå¯¹åŒä¸€ä¸ªé”çš„lockæ“ä½œã€‚</li>\n<li>volatileå˜é‡è§„åˆ™ï¼ˆVolatile Variable Ruleï¼‰ï¼šå¯¹ä¸€ä¸ªvolatileå˜é‡çš„å†™æ“ä½œhappens-beforeåé¢å¯¹è¿™ä¸ªå˜é‡çš„è¯»æ“ä½œï¼Œå¯ä»¥çœ‹æˆå¯¹å˜é‡è¯»å†™åŠ äº†é”</li>\n<li>çº¿ç¨‹å¯åŠ¨è§„åˆ™ï¼ˆThread Start Ruleï¼‰ï¼šThreadå¯¹è±¡çš„start()æ–¹æ³•happens-beforeæ­¤çº¿ç¨‹çš„æ¯ä¸€ä¸ªåŠ¨ä½œã€‚ä¿è¯é‡Šæ”¾é”å’Œè·å–é”çš„ä¸¤ä¸ªçº¿ç¨‹ä¹‹é—´çš„å†…å­˜å¯è§æ€§</li>\n<li>çº¿ç¨‹ç»ˆæ­¢è§„åˆ™ï¼ˆThread Termination Ruleï¼‰ï¼šçº¿ç¨‹ä¸­çš„æ‰€æœ‰æ“ä½œhappens-beforeå¯¹æ­¤çº¿ç¨‹çš„ç»ˆæ­¢æ£€æµ‹ï¼Œå¯é€šè¿‡Thread.join()æ–¹æ³•ç»“æŸã€Thread.isAlive()çš„è¿”å›å€¼ç­‰æ‰‹æ®µæ£€æµ‹åˆ°çº¿ç¨‹å·²ç»ç»ˆæ­¢æ‰§è¡Œã€‚</li>\n<li>çº¿ç¨‹ä¸­æ–­è§„åˆ™ï¼ˆThread Interruption Ruleï¼‰ï¼šå¯¹çº¿ç¨‹interrupt()æ–¹æ³•çš„è°ƒç”¨happens-beforeè¢«ä¸­æ–­çº¿ç¨‹çš„ä»£ç æ£€æµ‹åˆ°ä¸­æ–­äº‹ä»¶çš„å‘ç”Ÿï¼Œå¯é€šè¿‡Thread.interrupted()æ–¹æ³•æ£€æµ‹åˆ°æ˜¯å¦æœ‰ä¸­æ–­å‘ç”Ÿã€‚</li>\n<li>å¯¹è±¡ç»ˆç»“è§„åˆ™ï¼ˆFinalizer Ruleï¼‰ï¼šä¸€ä¸ªå¯¹è±¡çš„åˆå§‹åŒ–å®Œæˆï¼ˆæ„é€ å‡½æ•°æ‰§è¡Œç»“æŸï¼‰happens-beforeå®ƒçš„finalize()æ–¹æ³•çš„å¼€å§‹</li>\n<li>ä¼ é€’æ€§ï¼ˆTransitivityï¼‰ï¼šå¦‚æœæ“ä½œA happens-before Bï¼ŒB happens-before Cï¼Œå¯ä»¥å¾—å‡ºA happens-before C</li>\n<li>join()è§„åˆ™ï¼šå¦‚æœçº¿ç¨‹ A æ‰§è¡Œæ“ä½œ ThreadB.join()å¹¶æˆåŠŸè¿”å›ï¼Œé‚£ä¹ˆçº¿ç¨‹ B ä¸­çš„ä»»æ„æ“ä½œ happens-before äºçº¿ç¨‹ A ä» ThreadB.join()æ“ä½œæˆåŠŸè¿”å›</li>\n</ul>\n</li>\n</ul>\n<h1>28. as-if-serialåˆæ˜¯ä»€ä¹ˆï¼Ÿå•çº¿ç¨‹çš„ç¨‹åºä¸€å®šæ˜¯é¡ºåºçš„å—ï¼Ÿ</h1>\n<ul>\n<li>as-if-serialä¿è¯å•çº¿ç¨‹æƒ…å†µä¸‹æŒ‡ä»¤é‡æ’åºåç¨‹åºæ­£ç¡®æ€§å’Œå†…å­˜çš„å¯è§æ€§</li>\n<li>as-if-serialè¯­ä¹‰:ä¸ç®¡æ€ä¹ˆé‡æ’åºï¼Œå•çº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œç»“æœä¸å˜ã€‚ç¼–è¯‘å™¨ã€runtimeå’Œå¤„ç†å™¨éƒ½å¿…é¡»éµå®ˆ</li>\n<li>ä¸ºäº†éµå®ˆ as-if-serial è¯­ä¹‰ï¼Œå­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åº</li>\n</ul>\n<h1>29. volatileå…³é”®å­—?âˆš</h1>\n<ul>\n<li>ä¿è¯å¯è§æ€§ï¼šç¡®ä¿å¯¹æŸä¸ªå˜é‡çš„æ›´æ–°å¯¹å…¶ä»–çº¿ç¨‹é©¬ä¸Šå¯è§ï¼Œä¸€ä¸ªå˜é‡è¢«å£°æ˜ä¸ºvolatileæ—¶ï¼Œçº¿ç¨‹åœ¨å†™å…¥å˜é‡æ—¶ä¸ä¼šæŠŠå€¼ç¼“å­˜åœ¨å¯„å­˜å™¨æˆ–è€…å…¶ä»–åœ°æ–¹ï¼Œè€Œæ˜¯ä¼šæŠŠå€¼åˆ·æ–°å›ä¸»å†…å­˜ å½“å…¶å®ƒçº¿ç¨‹è¯»å–è¯¥å…±äº«å˜é‡ï¼Œä¼šä»ä¸»å†…å­˜é‡æ–°è·å–æœ€æ–°å€¼ï¼Œè€Œä¸æ˜¯ä½¿ç”¨å½“å‰çº¿ç¨‹çš„æœ¬åœ°å†…å­˜ä¸­çš„å€¼ï¼Œæ— ä¸Šä¸‹æ–‡åˆ‡æ¢å’Œè°ƒåº¦ï¼Œä¸ä¼šé€ æˆçº¿ç¨‹é˜»å¡.</li>\n<li>æœ‰åºæ€§ï¼šç¦æ­¢ç¼–è¯‘å™¨å’Œå¤„ç†å™¨é‡æ’åº;</li>\n<li>åŸå­æ€§ï¼šéƒ¨åˆ†åŸå­æ€§ï¼švolatileä¿®é¥°longå’Œdoubleå¯ä»¥ä¿è¯å…¶æ“ä½œåŸå­æ€§ï¼›volatileç±»å‹çš„å¼•ç”¨çš„æ”¹å˜æ˜¯åŸå­æ€§çš„ï¼Œå¦‚æœå¼•ç”¨æ˜¯æ•°ç»„/å¯¹è±¡ï¼Œä¿®æ”¹æ•°ç»„å…ƒç´ /å¯¹è±¡å±æ€§ä¸æ˜¯åŸå­æ€§çš„ï¼Œ</li>\n<li>volatile å¸¸ç”¨äºå¤šçº¿ç¨‹ç¯å¢ƒä¸‹çš„å•æ¬¡æ“ä½œ(å•æ¬¡è¯»æˆ–è€…å•æ¬¡å†™)ã€‚</li>\n<li>å¸¸ç”¨åœºæ™¯ï¼šçŠ¶æ€æ ‡è®°å˜é‡ï¼ˆåœæ­¢çº¿ç¨‹ï¼‰ã€å•ä¾‹ç¦æ­¢é‡æ’åºåŒé‡æ£€æŸ¥</li>\n</ul>\n<h1>30. volatileæ€ä¹ˆä¿è¯å¯è§æ€§?</h1>\n<ul>\n<li>JVMå®ç°é€šè¿‡å¯¹æœ‰volatileå…³é”®å­—çš„å˜é‡æ—¶ï¼Œç¼–è¯‘æ—¶åœ¨æ±‡ç¼–ä»£ç ä¸­åŠ å…¥lockå‰ç¼€æŒ‡ä»¤ï¼ˆlock addlï¼‰é”ä½ç¼“å­˜è¡Œï¼Œå¼•èµ·å¤„ç†å™¨CPUç¼“å­˜è¡Œçš„æ•°æ®å†™å›å†…å­˜å¹¶å¯¼è‡´å…¶ä»–å¤„ç†å™¨çš„ç¼“å­˜å¤±æ•ˆï¼ˆå¤„ç†å™¨é€šè¿‡å—…æ¢åœ¨æ€»çº¿ä¸Šä¼ æ’­çš„æ•°æ®æ¥æ£€æŸ¥è‡ªå·±ç¼“å­˜çš„å€¼æ˜¯ä¸æ˜¯è¿‡æœŸï¼‰ã€‚å½“å¤„ç†å™¨å‘ç°æœ¬åœ°ç¼“å­˜å¤±æ•ˆåï¼Œå°±ä¼šä»å†…å­˜ä¸­é‡è¯»è¯¥å˜é‡æ•°æ®ï¼Œå³å¯ä»¥è·å–å½“å‰æœ€æ–°å€¼ï¼ˆä¸€æ¬¡è¯»å–64å­—èŠ‚ç¼“å­˜è¡Œï¼‰å…¶å®å°±ç›¸å½“äºä¸€ä¸ªå†…å­˜å±éšœï¼ˆä¸€ç»„å¤„ç†æŒ‡ä»¤ï¼‰ï¼Œç”¨æ¥å®ç°å¯¹å†…å­˜æ“ä½œçš„é¡ºåºé™åˆ¶ã€‚å†…å­˜å±éšœä½¿ç”¨sfence mfence lfenceç­‰ç³»ç»ŸåŸè¯­æˆ–è€…é”æ€»çº¿å®ç°</li>\n</ul>\n<h1>31. volatileæ€ä¹ˆä¿è¯æœ‰åºæ€§?</h1>\n<ul>\n<li>valatileé™åˆ¶ç¼–è¯‘å™¨å’Œå¤„ç†å™¨é‡æ’åº<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/76465270e62b6e41c4af9.png\" alt=\"reorder.png\"></li>\n<li>ä¸ºäº†å®ç° volatile çš„å†…å­˜è¯­ä¹‰ï¼Œç¼–è¯‘å™¨åœ¨ç”Ÿæˆå­—èŠ‚ç æ—¶ï¼Œä¼šåœ¨æŒ‡ä»¤åºåˆ—ä¸­æ’å…¥å†…å­˜å±éšœæ¥ç¦æ­¢ç‰¹å®šç±»å‹çš„å¤„ç†å™¨é‡æ’åºï¼Œå¼ºåˆ¶æŠŠå†™ç¼“å†²åŒº/é«˜é€Ÿç¼“å­˜ä¸­çš„è„æ•°æ®ç­‰å†™å›ä¸»å†…å­˜\n<ul>\n<li>â‘ åœ¨æ¯ä¸ª volatile å†™æ“ä½œçš„å‰é¢æ’å…¥ä¸€ä¸ª StoreStore å±éšœï¼ˆç¦æ­¢volatileå†™/æ™®é€šå†™ä¸volatileå†™é‡æ’åºï¼‰</li>\n<li>â‘¡åœ¨æ¯ä¸ª volatile å†™æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª StoreLoad å±éšœï¼ˆç¦æ­¢volatileå†™-volatileè¯»ï¼‰</li>\n<li>â‘¢åœ¨æ¯ä¸ª volatile è¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª LoadLoad å±éšœï¼ˆç¦æ­¢volatileè¯»ä¸åé¢çš„è¯»æ“ä½œé‡æ’åºï¼‰</li>\n<li>â‘£åœ¨æ¯ä¸ª volatile è¯»æ“ä½œçš„åé¢æ’å…¥ä¸€ä¸ª LoadStore å±éšœï¼ˆç¦æ­¢volatileè¯»ä¸åé¢çš„å†™æ“ä½œé‡æ’åºï¼‰</li>\n<li>ä¸ºä»€ä¹ˆå°‘äº†æ™®é€šè¯»--volatileå†™ç¦æ­¢é‡æ’åºï¼Ÿï¼ˆvolatileå†™å‰LoadStoreå±éšœï¼‰å› ä¸ºä¸€ä¸ªæ˜¯æ™®é€šå˜é‡è¯»ï¼Œä¸€ä¸ªæ˜¯volatileçš„è¯»\\å†™ï¼Œä¸¤ä¸ªå˜é‡ä¹‹é—´æœ¬èº«ä¸å­˜åœ¨æ•°æ®ä¾èµ–ä¸ç«æ€æ¡ä»¶ï¼› æ™®é€šå˜é‡å†™ã€‚å› ä¸ºæ™®é€šå˜é‡è¯»ä¸æ™®é€šå˜é‡å†™ä¹‹é—´æ²¡æœ‰happens-beforeè§„åˆ™ï¼Œæ‰€ä»¥ä¼šæœ‰ç«æ€æ¡ä»¶ã€‚ä½†æ˜¯volatileçš„å†™æ“ä½œçš„å†…å­˜è¯­ä¹‰ä¸é‡Šæ”¾é”ç›¸åŒï¼Œå³ä¼šåˆ·æ–°è¯¥çº¿ç¨‹çš„å†™ç¼“å†²åˆ°å†…å­˜ä¸­ï¼Œè€Œæ™®é€šå˜é‡è¯»æ ¹æœ¬ä¸æ¶‰åŠåˆ°å†™ç¼“å†²ï¼Œæ‰€ä»¥å³ä½¿é‡æ’åºäº†ä¹Ÿä¸ä¼šç ´åvolatileçš„å†…å­˜è¯­ä¹‰ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ed5d433a7450dbaf88e23.jpg\" alt=\"memorybarrier.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>32. çº¿ç¨‹åŒæ­¥</h1>\n<ul>\n<li>å¦‚æœå¤šä¸ªçº¿ç¨‹åŒæ—¶è¯»å†™æŸä¸ªå…±äº«èµ„æºï¼ˆå¦‚å˜é‡ã€æ–‡ä»¶ç­‰ï¼‰ï¼Œè€Œæ²¡æœ‰é€‚å½“çš„åŒæ­¥æœºåˆ¶ï¼Œå°±å¯èƒ½å¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€æ•°æ®æŸåç­‰é—®é¢˜å‡ºç°</li>\n<li>çº¿ç¨‹åŒæ­¥çš„å®ç°æ–¹å¼\n<ul>\n<li>äº’æ–¥é‡ï¼ˆmutexï¼‰ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€æŠŠé”ï¼Œåœ¨è®¿é—®å…±äº«èµ„æºå‰å…ˆå¯¹äº’æ–¥é‡è¿›è¡ŒåŠ é”ï¼Œè®¿é—®å®Œåå†è§£é”ã€‚å¯¹äº’æ–¥é‡åŠ é”åï¼Œä»»ä½•å…¶ä»–è¯•å›¾å†æ¬¡å¯¹äº’æ–¥é‡åŠ é”çš„çº¿ç¨‹éƒ½ä¼šè¢«é˜»å¡ï¼Œç›´åˆ°å½“å‰çº¿ç¨‹è§£é”ã€‚</li>\n<li>è¯»å†™é”ï¼šæœ‰ä¸‰ç§çŠ¶æ€ï¼Œè¯»æ¨¡å¼åŠ é”ã€å†™æ¨¡å¼åŠ é”å’Œä¸åŠ é”ï¼›ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥å æœ‰å†™æ¨¡å¼çš„è¯»å†™é”ï¼Œä½†æ˜¯å¯ä»¥æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶å æœ‰è¯»æ¨¡å¼çš„è¯»å†™é”ã€‚é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</li>\n<li>æ¡ä»¶å˜é‡ï¼šå…è®¸çº¿ç¨‹åœ¨æ»¡è¶³ç‰¹å®šæ¡ä»¶æ—¶æ‰ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚æ¡ä»¶å˜é‡é€šå¸¸ä¸äº’æ–¥é‡ä¸€èµ·ä½¿ç”¨ï¼Œé˜²æ­¢ç«äº‰æ¡ä»¶çš„å‘ç”Ÿ</li>\n<li>è‡ªæ—‹é”ï¼šä¸€ç§é”çš„å®ç°æ–¹å¼ï¼Œå®ƒä¸ä¼šè®©çº¿ç¨‹è¿›å…¥ç¡çœ çŠ¶æ€ï¼Œè€Œæ˜¯ä¸€ç›´å¾ªç¯æ£€æµ‹é”æ˜¯å¦è¢«é‡Šæ”¾ã€‚è‡ªæ—‹é”é€‚ç”¨äºé”çš„æŒæœ‰æ—¶é—´éå¸¸çŸ­çš„æƒ…å†µã€‚</li>\n<li>ä¿¡å·é‡ï¼ˆSemaphoreï¼‰ï¼šæœ¬è´¨ä¸Šæ˜¯ä¸€ä¸ªè®¡æ•°å™¨ï¼Œç”¨äºä¸ºå¤šä¸ªè¿›ç¨‹æä¾›å…±äº«æ•°æ®å¯¹è±¡çš„è®¿é—®ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>33. synchronizedå…³é”®å­—</h1>\n<ul>\n<li>éå…¬å¹³é”ã€æ‚²è§‚é”ã€äº’æ–¥é”</li>\n<li>å½“ä¸€ä¸ªçº¿ç¨‹è®¿é—®æŸå¯¹è±¡çš„ synchronized æ–¹æ³•æˆ–ä»£ç å—æ—¶ï¼Œå…¶ä»–çº¿ç¨‹å¯¹è¯¥å¯¹è±¡çš„æ‰€æœ‰ synchronized æ–¹æ³•æˆ–ä»£ç å—çš„è®¿é—®å°†è¢«é˜»å¡ï¼Œç›´åˆ°ç¬¬ä¸€ä¸ªçº¿ç¨‹å®Œæˆæ“ä½œã€‚</li>\n<li>synchronizedå…³é”®å­—å±äºäº’æ–¥é‡ï¼Œå®ƒä¿è¯äº†åŒä¸€æ—¶é—´åªæœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è®¿é—®å…±äº«èµ„æºã€‚</li>\n<li>synchronizedä¿è¯åŸå­æ€§ã€å¯è§æ€§ï¼ˆé”é‡Šæ”¾ä¼šæŠŠæ•°æ®åˆ·å›åˆ°ä¸»å­˜ï¼‰ã€æœ‰åºæ€§</li>\n</ul>\n<h1>34. synchronizedé”ç±»å’Œé™æ€æ–¹æ³•çš„é”å¯¹è±¡åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>åŒæ­¥ä»£ç å—synchronized (å®ä¾‹å¯¹è±¡/this/xxx.class) {} é”å¯¹è±¡æ˜¯æŒ‡å®šçš„å®ä¾‹å¯¹è±¡/ç±»</li>\n<li>åŒæ­¥æ–¹æ³•synchronized void method(){} é”å¯¹è±¡æ˜¯å½“å‰å®ä¾‹å¯¹è±¡</li>\n<li>é™æ€åŒæ­¥æ–¹æ³•public static synchronized void method(){}é”å¯¹è±¡æ˜¯å½“å‰Classç±»</li>\n<li>æ³¨æ„äº‹é¡¹\n<ul>\n<li>é”å¯¹è±¡å±æ€§å˜åŒ–ä¸å½±å“ï¼Œå¼•ç”¨æ”¹å˜å½±å“ï¼Œä¸€èˆ¬è®¾ç½®ä¸ºfinal</li>\n<li>é”å¯¹è±¡ä¸èƒ½ç”¨å­—ç¬¦ä¸²å¸¸é‡ï¼Œå¯èƒ½ä¸ç±»åº“ä½¿ç”¨åŒä¸€æŠŠé”</li>\n</ul>\n</li>\n</ul>\n<h1>35. synchronizedåŒæ­¥ä»£ç ã€é™æ€åŒæ­¥æ–¹æ³•åŸç†ï¼Ÿ</h1>\n<ul>\n<li>åŒæ­¥ä»£ç å—åŸç†ï¼šä½¿ç”¨jvmçš„å­—èŠ‚ç æŒ‡ä»¤monitorenterå’Œmonitorexitï¼ŒmonitorenteræŒ‡ä»¤æ˜¯åœ¨ç¼–è¯‘åæ’å…¥åˆ°åŒæ­¥ä»£ç å—çš„å¼€å§‹ä½ç½®ï¼Œè€Œmonitorexitæ˜¯æ’å…¥åˆ°æ–¹æ³•ç»“æŸå¤„å’Œå¼‚å¸¸å¤„ï¼ŒJVMä¿è¯æ¯ä¸ªmonitorenterå¿…é¡»æœ‰å¯¹åº”çš„monitorexitä¸ä¹‹é…å¯¹ã€‚ä¾èµ–äºåº•å±‚çš„æ“ä½œç³»ç»Ÿçš„Mutex Lockæ¥å®ç°ï¼Œéœ€è¦å°†å½“å‰çº¿ç¨‹æŒ‚èµ·å¹¶ä»ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€æ¥æ‰§è¡Œï¼Œæ•ˆç‡ä½ã€‚jvmä¿è¯æ¯ä¸ªå¯¹è±¡çš„éƒ½æœ‰Monitorç›‘è§†å™¨ï¼ˆJavaä»»æ„å¯¹è±¡éƒ½å¯ä»¥ä½œä¸ºé”çš„åŸå› ï¼‰ï¼Œä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ï¼Œé¦–å…ˆå°è¯•è·å–monitorçš„æŒæœ‰æƒã€‚å½“çº¿ç¨‹å°è¯•è·å–é”çš„æ—¶å€™ï¼Œå¦‚æœè·å–ä¸åˆ°é”ä¼šä¸€ç›´é˜»å¡ã€‚å¦‚æœè·å–å¯¹è±¡é”å¤±è´¥ï¼Œé‚£å½“å‰çº¿ç¨‹å°±è¦é˜»å¡ç­‰å¾…ï¼Œç›´åˆ°é”è¢«å¦å¤–ä¸€ä¸ªçº¿ç¨‹é‡Šæ”¾ä¸ºæ­¢ã€å¦‚æœè·å–é”çš„çº¿ç¨‹è¿›å…¥ä¼‘çœ æˆ–è€…é˜»å¡ï¼Œé™¤éå½“å‰çº¿ç¨‹å¼‚å¸¸ï¼Œå¦åˆ™å…¶ä»–çº¿ç¨‹å°è¯•è·å–é”å¿…é¡»ä¸€ç›´ç­‰å¾…ã€‚åœ¨æ‰§è¡Œå®Œä»£ç å—ä¹‹åï¼Œæ‰§è¡Œmonitorexité‡Šæ”¾é”ã€‚æœ€åä¸€ä¸ªmonitorexitæ˜¯ä¿è¯åœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼Œé”ä¹Ÿå¯ä»¥å¾—åˆ°é‡Šæ”¾ï¼Œé¿å…æ­»é”.<br>\n<code>javap -c -s -v -l SynchronizedDemo.class</code><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/567a83434eb62881d322b.png\" alt=\"javamonitorenter.png\"></li>\n<li>é™æ€/æ™®é€šåŒæ­¥æ–¹æ³•åŸç†ï¼šä¾é æ–¹æ³•ä¿®é¥°ç¬¦ACC_SYNCHRONIZEDï¼Œ å…·ä½“æ˜¯åœ¨Classæ–‡ä»¶çš„æ–¹æ³•è¡¨ä¸­å°†è¯¥æ–¹æ³•çš„access_flagså­—æ®µä¸­çš„synchronizedæ ‡å¿—ä½ç½®è®¾ç½®ä¸º1ï¼Œè¡¨ç¤ºè¯¥æ–¹æ³•æ˜¯åŒæ­¥æ–¹æ³•ï¼Œå¹¶ä½¿ç”¨è°ƒç”¨è¯¥æ–¹æ³•çš„å¯¹è±¡æˆ–è¯¥æ–¹æ³•æ‰€å±çš„Classåœ¨JVMçš„å†…éƒ¨å¯¹è±¡è¡¨ç¤ºKlass(ç±»åœ¨HotSpotä¸­çš„c++å¯¹ç­‰ä½“)ä½œä¸ºé”å¯¹è±¡ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/06ab05afe794f6421797d.png\" alt=\"javaaccsynchornized.png\"></li>\n<li>monitorenterã€monitorexitæˆ–è€…ACC_SYNCHRONIZED éƒ½æ˜¯åŸºäºMonitorå®ç°ã€‚\n<ul>\n<li>å®ä¾‹å¯¹è±¡ç»“æ„é‡Œæœ‰å¯¹è±¡å¤´ï¼Œå¯¹è±¡å¤´é‡Œé¢æœ‰ä¸€å—ç»“æ„å«Mark Wordï¼ŒMark WordæŒ‡é’ˆæŒ‡å‘äº†monitorã€‚</li>\n<li>Monitorå…¶å®æ˜¯ä¸€ç§åŒæ­¥æœºåˆ¶ã€‚åœ¨Javaè™šæ‹ŸæœºHotSpotä¸­ï¼ŒMonitoræ˜¯ç”±ObjectMonitorå®ç°</li>\n</ul>\n</li>\n<li>ObjectMonitorå·¥ä½œåŸç†\n<ul>\n<li>ObjectMonitoræœ‰ä¸¤ä¸ªé˜Ÿåˆ—ï¼š_WaitSetã€_EntryListï¼Œç”¨æ¥ä¿å­˜ObjectWaiterå¯¹è±¡åˆ—è¡¨ï¼›</li>\n<li>_ownerï¼Œè·å–Monitorå¯¹è±¡çš„çº¿ç¨‹è¿›å…¥_owneråŒºæ—¶ï¼Œ_count+1ã€‚å¦‚æœçº¿ç¨‹è°ƒç”¨äº†wait()æ–¹æ³•ï¼Œæ­¤æ—¶ä¼šé‡Šæ”¾Monitor å¯¹è±¡ï¼Œ_owneræ¢å¤ä¸ºç©ºï¼Œ _count-1ã€‚åŒæ—¶è¯¥ç­‰å¾…çº¿ç¨‹è¿›å…¥_WaitSet ä¸­ï¼Œç­‰å¾…è¢«å”¤é†’ã€‚</li>\n</ul>\n</li>\n<li>monitorenteråœ¨åˆ¤æ–­æ‹¥æœ‰åŒæ­¥æ ‡è¯†ACC_SYNCHRONIZEDæŠ¢å…ˆè¿›å…¥æ­¤æ–¹æ³•çš„çº¿ç¨‹ä¼šä¼˜å…ˆæ‹¥æœ‰Monitorçš„ownerï¼Œæ­¤æ—¶è®¡æ•°å™¨+1</li>\n<li>monitorexitå½“æ‰§è¡Œå®Œé€€å‡ºåè®¡æ•°å™¨-1ï¼Œå½’0åè¢«å…¶ä»–è¿›å…¥çš„çº¿ç¨‹è·å¾—ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ObjectMonitor() {\n    _header       = NULL;\n    _count        = 0; // è®°å½•çº¿ç¨‹è·å–é”çš„æ¬¡æ•°\n    _waiters      = 0,\n    _recursions   = 0;  //é”çš„é‡å…¥æ¬¡æ•°\n    _object       = NULL;\n    _owner        = NULL;  // æŒ‡å‘æŒæœ‰ObjectMonitorå¯¹è±¡çš„çº¿ç¨‹\n    _WaitSet      = NULL;  // å¤„äºwaitçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°_WaitSet\n    _WaitSetLock  = 0 ;\n    _Responsible  = NULL ;\n    _succ         = NULL ;\n    _cxq          = NULL ;\n    FreeNext      = NULL ;\n    _EntryList    = NULL ;  // å¤„äºç­‰å¾…é”blockçŠ¶æ€çš„çº¿ç¨‹ï¼Œä¼šè¢«åŠ å…¥åˆ°è¯¥åˆ—è¡¨\n    _SpinFreq     = 0 ;\n    _SpinClock    = 0 ;\n    OwnerIsThread = 0 ;\n  }\n\n</code></pre></div><h1>36. synchronized æ€ä¹ˆä¿è¯å¯è§æ€§ï¼Ÿ</h1>\n<ul>\n<li>çº¿ç¨‹åŠ é”å‰ï¼Œå°†æ¸…ç©ºå·¥ä½œå†…å­˜ä¸­å…±äº«å˜é‡çš„å€¼ï¼Œä»è€Œä½¿ç”¨å…±äº«å˜é‡æ—¶éœ€è¦ä»ä¸»å†…å­˜ä¸­é‡æ–°è¯»å–æœ€æ–°çš„å€¼ã€‚</li>\n<li>çº¿ç¨‹åŠ é”åï¼Œå…¶å®ƒçº¿ç¨‹æ— æ³•è·å–ä¸»å†…å­˜ä¸­çš„å…±äº«å˜é‡</li>\n<li>çº¿ç¨‹è§£é”å‰ï¼ŒæŠŠå…±äº«å˜é‡çš„æœ€æ–°å€¼åˆ·æ–°åˆ°ä¸»å†…å­˜ä¸­</li>\n</ul>\n<h1>37. synchronized æ€ä¹ˆä¿è¯æœ‰åºæ€§ï¼Ÿ</h1>\n<ul>\n<li>synchronized åŒæ­¥çš„ä»£ç å—ï¼Œå…·æœ‰æ’ä»–æ€§ï¼Œä¸€æ¬¡åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹æ‹¥æœ‰ï¼Œæ‰€ä»¥ synchronized ä¿è¯åŒä¸€æ—¶åˆ»ï¼Œä»£ç æ˜¯å•çº¿ç¨‹æ‰§è¡Œçš„ã€‚å› ä¸º as-if-serial è¯­ä¹‰çš„å­˜åœ¨ï¼Œå•çº¿ç¨‹çš„ç¨‹åºèƒ½ä¿è¯æœ€ç»ˆç»“æœæ˜¯æœ‰åºçš„ï¼Œä½†æ˜¯ä¸ä¿è¯ä¸ä¼šæŒ‡ä»¤é‡æ’ã€‚æ‰€ä»¥ synchronized ä¿è¯çš„æœ‰åºæ˜¯æ‰§è¡Œç»“æœçš„æœ‰åºæ€§ï¼Œè€Œä¸æ˜¯é˜²æ­¢æŒ‡ä»¤é‡æ’çš„æœ‰åºæ€§ã€‚</li>\n</ul>\n<h1>38. synchronized æ€ä¹ˆå®ç°å¯é‡å…¥çš„å‘¢ï¼Ÿ</h1>\n<ul>\n<li>synchronized æ˜¯å¯é‡å…¥é”ï¼Œå…è®¸ä¸€ä¸ªçº¿ç¨‹äºŒæ¬¡è¯·æ±‚è‡ªå·±æŒæœ‰å¯¹è±¡é”çš„ä¸´ç•Œèµ„æºã€‚</li>\n<li>å› ä¸º synchronized é”å¯¹è±¡æœ‰ä¸ªè®¡æ•°å™¨ï¼Œä¼šéšç€çº¿ç¨‹è·å–é”å +1 è®¡æ•°ï¼Œå½“çº¿ç¨‹æ‰§è¡Œå®Œæ¯•å -1ï¼Œç›´åˆ°æ¸…é›¶é‡Šæ”¾é”ã€‚</li>\n</ul>\n<h1>39. synchronizedé”å‡çº§åŸç†ï¼Ÿ</h1>\n<ul>\n<li>åœ¨Javaå¯¹è±¡å¤´é‡Œçš„Mark Wordè®°å½•å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ•°æ®ï¼Œå¦‚å“ˆå¸Œç ã€GC åˆ†ä»£å¹´é¾„ã€é”çŠ¶æ€æ ‡å¿—ã€åå‘æ—¶é—´æˆ³ï¼ˆEpochï¼‰ç­‰ã€‚å…¶ä¸­çš„é”çŠ¶æ€æ ‡å¿—ä½å°±æ˜¯ç”¨æ¥è®°å½•é”çš„çŠ¶æ€çš„</li>\n<li>jdk1.6ä¸­ä¸ºäº†å‡å°‘è·å¾—é”å’Œé‡Šæ”¾é”å¸¦æ¥çš„æ€§èƒ½æ¶ˆè€—è€Œå¼•å…¥çš„åå‘é”å’Œè½»é‡çº§é”</li>\n<li>æ— é”-&gt;åå‘é”-&gt;è½»é‡çº§é”-&gt;é‡é‡çº§é”ï¼ˆæ‰§è¡Œè¿‡ç¨‹è‡ªåŠ¨å‡çº§ æ›´ä½å±‚ lock comxchgï¼‰(å †)</li>\n<li>æ— é”ï¼šæ²¡æœ‰çº¿ç¨‹è¯•å›¾è·å–é”</li>\n<li>åå‘é”:å½“ç¬¬ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—æ—¶ï¼Œé”ä¼šè¿›å…¥åå‘æ¨¡å¼.Mark Word ä¼šè¢«è®¾ç½®ä¸ºåå‘æ¨¡å¼ï¼Œå¹¶ä¸”å­˜å‚¨äº†è·å–å®ƒçš„çº¿ç¨‹ ID.ä¸ºäº†æ¶ˆé™¤åŒä¸€çº¿ç¨‹çš„åç»­é”è·å–å’Œé‡Šæ”¾çš„å¼€é”€ã€‚å¦‚æœåŒä¸€çº¿ç¨‹å†æ¬¡è¯·æ±‚é”ï¼Œå°±æ— éœ€å†æ¬¡åŒæ­¥ã€‚\n<ul>\n<li><strong>è·å–åå‘é”</strong>\n<ul>\n<li>1.æ£€æµ‹å¯¹è±¡å¤´ä¸­Mark Wordæ˜¯å¦ä¸ºå¯åå‘çŠ¶æ€ï¼ˆåå‘é”çš„æ ‡è¯†ä½ä¸º1ï¼Œé”æ ‡è¯†ä½ä¸º01ï¼‰</li>\n<li>2.è‹¥ä¸ºå¯åå‘çŠ¶æ€ï¼Œåˆ™æµ‹è¯•çº¿ç¨‹IDæ˜¯å¦ä¸ºå½“å‰çº¿ç¨‹IDï¼Ÿå¦‚æœæ˜¯åˆ™æ‰§è¡Œæ­¥éª¤ï¼ˆ5ï¼‰ï¼›å¦åˆ™ï¼Œæ‰§è¡Œæ­¥éª¤ï¼ˆ3ï¼‰ã€‚</li>\n<li>3.å¦‚æœçº¿ç¨‹IDä¸ä¸ºå½“å‰çº¿ç¨‹IDï¼Œåˆ™é€šè¿‡CASæ“ä½œç«äº‰é”ã€‚æˆåŠŸåˆ™å°†Mark Wordçš„çº¿ç¨‹IDæ›¿æ¢ä¸ºå½“å‰çº¿ç¨‹IDï¼Œåˆ™æ‰§è¡Œæ­¥éª¤ï¼ˆ5ï¼‰ï¼›å¦åˆ™æ‰§è¡Œæ­¥éª¤ï¼ˆ4ï¼‰ã€‚</li>\n<li>4.é€šè¿‡CASç«äº‰é”å¤±è´¥ï¼Œè¯æ˜å½“å‰å­˜åœ¨å¤šçº¿ç¨‹ç«äº‰æƒ…å†µï¼Œå½“åˆ°è¾¾å…¨å±€å®‰å…¨ç‚¹ï¼Œè·å¾—åå‘é”çš„çº¿ç¨‹è¢«æŒ‚èµ·ï¼Œåå‘é”å‡çº§ä¸ºè½»é‡çº§é”ï¼Œç„¶åè¢«é˜»å¡åœ¨å®‰å…¨ç‚¹çš„çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡ŒåŒæ­¥ä»£ç å—ã€‚</li>\n<li>5.æ‰§è¡ŒåŒæ­¥ä»£ç å—</li>\n</ul>\n</li>\n<li>åå‘é”æ’¤é”€ï¼šåå‘é”ä½¿ç”¨äº†ç­‰åˆ°ç«äº‰å‡ºç°æ‰é‡Šæ”¾é”çš„æœºåˆ¶ï¼Œæ‰€ä»¥å½“å…¶ä»–çº¿ç¨‹å°è¯•ç«äº‰åå‘é”æ—¶ï¼ŒæŒæœ‰åå‘é”çš„çº¿ç¨‹æ‰ä¼šé‡Šæ”¾é”ã€‚éœ€è¦ç­‰å¾…å…¨å±€å®‰å…¨ç‚¹ï¼ˆåœ¨è¿™ä¸ªæ—¶é—´ç‚¹ä¸Šæ²¡æœ‰æ­£åœ¨æ‰§è¡Œçš„å­—èŠ‚ç ï¼‰\n<ul>\n<li>é¦–å…ˆæš‚åœæ‹¥æœ‰åå‘é”çš„çº¿ç¨‹ï¼Œç„¶åæ£€æŸ¥æŒæœ‰åå‘é”çš„çº¿ç¨‹æ˜¯å¦æ´»ç€</li>\n<li>å¦‚æœçº¿ç¨‹ä¸å¤„äºæ´»åŠ¨çŠ¶æ€ï¼Œåˆ™å°†å¯¹è±¡å¤´è®¾ç½®æˆæ— é”çŠ¶æ€</li>\n<li>å¦‚æœçº¿ç¨‹ä»ç„¶æ´»ç€ï¼Œæ‹¥æœ‰åå‘é”çš„æ ˆä¼šè¢«æ‰§è¡Œï¼Œéå†åå‘å¯¹è±¡çš„é”è®°å½•ï¼Œæ ˆä¸­çš„é”è®°å½•å’Œå¯¹è±¡å¤´çš„Mark Wordè¦ä¹ˆé‡æ–°åå‘äºå…¶ä»–çº¿ç¨‹ï¼Œè¦ä¹ˆæ¢å¤åˆ°æ— é”æˆ–è€…æ ‡è®°å¯¹è±¡ä¸é€‚åˆä½œä¸ºåå‘é”ï¼Œæœ€åå”¤é†’æš‚åœçš„çº¿ç¨‹ï¼Œè¢«é˜»å¡åœ¨å®‰å…¨ç‚¹çš„çº¿ç¨‹ç»§ç»­å¾€ä¸‹æ‰§è¡ŒåŒæ­¥ä»£ç å—</li>\n</ul>\n</li>\n<li>åå‘é”æ³¨æ„äº‹é¡¹\n<ul>\n<li>ä¼˜åŠ¿ï¼šåå‘é”åªéœ€è¦åœ¨ç½®æ¢ThreadIDçš„æ—¶å€™ä¾èµ–ä¸€æ¬¡CASåŸå­æŒ‡ä»¤ï¼Œå…¶ä½™æ—¶åˆ»ä¸éœ€è¦CASæŒ‡ä»¤(ç›¸æ¯”å…¶ä»–é”)</li>\n<li>éšæ‚£ï¼šç”±äºä¸€æ—¦å‡ºç°å¤šçº¿ç¨‹ç«äº‰çš„æƒ…å†µå°±å¿…é¡»æ’¤é”€åå‘é”ï¼Œæ‰€ä»¥åå‘é”çš„æ’¤é”€æ“ä½œçš„æ€§èƒ½æŸè€—å¿…é¡»å°äºèŠ‚çœä¸‹æ¥çš„CASåŸå­æŒ‡ä»¤çš„æ€§èƒ½æ¶ˆè€—ï¼ˆè¿™ä¸ªé€šå¸¸åªèƒ½é€šè¿‡å¤§é‡å‹æµ‹æ‰å¯çŸ¥ï¼‰</li>\n<li>å¯¹æ¯”ï¼šè½»é‡çº§é”æ˜¯ä¸ºäº†åœ¨çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—æ—¶æé«˜æ€§èƒ½ï¼Œè€Œåå‘é”åˆ™æ˜¯åœ¨åªæœ‰ä¸€ä¸ªçº¿ç¨‹æ‰§è¡ŒåŒæ­¥å—æ—¶è¿›ä¸€æ­¥æé«˜æ€§èƒ½</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>è½»é‡çº§é”ï¼šå½“æœ‰å¤šä¸ªçº¿ç¨‹ç«äº‰é”ï¼Œä½†æ²¡æœ‰é”ç«äº‰çš„å¼ºçƒˆè¿¹è±¡ï¼ˆå³çº¿ç¨‹äº¤æ›¿æ‰§è¡ŒåŒæ­¥å—ï¼‰æ—¶ï¼Œåå‘é”ä¼šå‡çº§ä¸ºè½»é‡çº§é”ã€‚\n<ul>\n<li><strong>JVMä¼šå…ˆåœ¨å½“å‰çº¿ç¨‹çš„æ ˆæ¡¢ä¸­åˆ›å»ºç”¨äºå­˜å‚¨é”è®°å½•çš„ç©ºé—´Lock Recordï¼Œå¹¶å°†å¯¹è±¡å¤´ä¸­çš„Mark Wordå¤åˆ¶åˆ°é”è®°å½•ä¸­ï¼Œå®˜æ–¹ç§°ä¸ºDisplaced Mark Wordã€‚ç„¶åçº¿ç¨‹å°è¯•ä½¿ç”¨CASå°†å¯¹è±¡å¤´ä¸­çš„Mark Wordæ›¿æ¢ä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€‚å¦‚æœæˆåŠŸï¼Œå½“å‰çº¿ç¨‹è·å¾—é”ï¼Œå¦‚æœå¤±è´¥ï¼Œè¡¨ç¤ºå…¶ä»–çº¿ç¨‹ç«äº‰é”ï¼Œå½“å‰çº¿ç¨‹ä¾¿å°è¯•ä½¿ç”¨è‡ªæ—‹æ¥è·å–é”ã€‚å½“ä¸€ä¸ªçº¿ç¨‹æ—‹è¶…è¿‡10æ¬¡ï¼Œæˆ–è€…è‡ªæ—‹çº¿ç¨‹æ•°è¶…è¿‡CPUæ ¸æ•°çš„ä¸€åŠï¼Œå¦‚æœè¿˜æ²¡æœ‰æ­£å¸¸è·å–åˆ°è¦ä½¿ç”¨çš„å¯¹è±¡ï¼Œæ­¤æ—¶å°±ä¼šæŠŠé”ä»è½»é‡çº§å‡çº§ä¸ºé‡é‡çº§é”</strong></li>\n<li>è½»é‡çº§è§£é”æ—¶ï¼Œä¼šä½¿ç”¨åŸå­çš„CASæ“ä½œå°†Displaced Mark Wordæ›¿æ¢å›åˆ°å¯¹è±¡å¤´ï¼Œå¦‚æœæˆåŠŸï¼Œåˆ™è¡¨ç¤ºæ²¡æœ‰ç«äº‰å‘ç”Ÿã€‚å¦‚æœå¤±è´¥ï¼Œè¡¨ç¤ºå½“å‰é”å­˜åœ¨ç«äº‰ï¼Œé”å°±ä¼šè†¨èƒ€æˆé‡é‡çº§é”ã€‚éœ€è¦åœ¨é‡Šæ”¾é”çš„åŒæ—¶å”¤é†’è¢«é˜»å¡çš„çº¿ç¨‹ï¼Œä¹‹åçº¿ç¨‹é—´è¦æ ¹æ®é‡é‡çº§é”è§„åˆ™é‡æ–°ç«äº‰é‡é‡çº§é”ã€å› ä¸ºè‡ªæ—‹ä¼šæ¶ˆè€—CPUï¼Œä¸ºäº†é¿å…æ— ç”¨çš„è‡ªæ—‹ï¼ˆæ¯”å¦‚è·å¾—é”çš„çº¿ç¨‹è¢«é˜»å¡ä½äº†ï¼‰ï¼Œä¸€æ—¦é”å‡çº§æˆé‡é‡çº§é”ï¼Œå°±ä¸ä¼šå†æ¢å¤åˆ°è½»é‡çº§é”çŠ¶æ€ã€‚å½“é”å¤„äºè¿™ä¸ªçŠ¶æ€ä¸‹ï¼Œå…¶ä»–çº¿ç¨‹è¯•å›¾è·å–é”æ—¶ï¼Œéƒ½ä¼šè¢«é˜»å¡ä½ï¼Œå½“æŒæœ‰é”çš„çº¿ç¨‹é‡Šæ”¾é”ä¹‹åä¼šå”¤é†’è¿™äº›çº¿ç¨‹ï¼Œè¢«å”¤é†’çš„çº¿ç¨‹å°±ä¼šè¿›è¡Œæ–°ä¸€è½®çš„å¤ºé”ä¹‹äº‰</li>\n</ul>\n</li>\n<li>é‡é‡çº§é”ï¼šå½“é”ç«äº‰æ¿€çƒˆæ—¶ï¼Œè½»é‡çº§é”ä¼šè†¨èƒ€ä¸ºé‡é‡çº§é”ã€‚æ•ˆç‡ä½ï¼Œç”±æ“ä½œç³»ç»Ÿçš„Mutex Lockå®ç°ï¼Œå¦‚æœè¦æŒ‚èµ·æˆ–è€…å”¤é†’ä¸€ä¸ªçº¿ç¨‹ï¼Œéƒ½éœ€è¦æ“ä½œç³»ç»Ÿå¸®å¿™å®Œæˆï¼Œè€Œæ“ä½œç³»ç»Ÿå®ç°çº¿ç¨‹ä¹‹é—´çš„åˆ‡æ¢æ—¶éœ€è¦ä»ç”¨æˆ·æ€è½¬æ¢åˆ°å†…æ ¸æ€ï¼Œæ—¶é—´æˆæœ¬é«˜ã€‚é‡é‡çº§é”é€šè¿‡å°†å¯¹è±¡å¤´çš„ Mark Word æŒ‡å‘ç›‘è§†å™¨ï¼ˆMonitorï¼‰å¯¹è±¡æ¥å®ç°ï¼Œè¯¥å¯¹è±¡åŒ…å«äº†é”çš„æŒæœ‰è€…ã€é”çš„ç­‰å¾…é˜Ÿåˆ—ç­‰ä¿¡æ¯ã€‚</li>\n<li>é”çš„ä¼˜ç¼ºç‚¹å¯¹æ¯”\n<ul>\n<li>åå‘é”ï¼šåŠ é”å’Œè§£é”ä¸éœ€è¦é¢å¤–çš„æ¶ˆè€—ï¼Œå’Œæ‰§è¡ŒéåŒæ­¥æ–¹æ³•ç›¸æ¯”ä»…å­˜åœ¨çº³ç§’çº§çš„å·®è·ã€‚å¦‚æœçº¿ç¨‹é—´å­˜åœ¨é”ç«äº‰ï¼Œä¼šå¸¦æ¥é¢å¤–çš„é”æ’¤é”€çš„æ¶ˆè€—ã€‚é€‚ç”¨äºåªæœ‰ä¸€ä¸ªçº¿ç¨‹è®¿é—®åŒæ­¥å—çš„åœºæ™¯</li>\n<li>è½»é‡çº§é”ï¼šçº¿ç¨‹ç«äº‰ä¸é˜»å¡ï¼Œæé«˜äº†ç¨‹åºçš„å“åº”é€Ÿåº¦ï¼Œå¾—ä¸åˆ°é”çš„çº¿ç¨‹è‡ªæ—‹ä¼šæ¶ˆè€—CPUï¼Œé€‚ç”¨äºè¿½æ±‚å“åº”æ—¶é—´å“åº”é€Ÿåº¦ã€‚åŒæ­¥å—æ‰§è¡Œé€Ÿåº¦éå¸¸å¿«</li>\n<li>é‡é‡çº§é”ï¼šçº¿ç¨‹ç«äº‰ä¸è‡ªæ—‹ã€ä¸æ¶ˆè€—CPUï¼›çº¿ç¨‹é˜»å¡ï¼Œå“åº”æ—¶é—´æ…¢ã€‚é€‚ç”¨äºè¿½æ±‚ååé‡ã€‚åŒæ­¥å—æ‰§è¡Œé€Ÿåº¦è¾ƒé•¿<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b0a1f7d7ac59d447ff05f.png\" alt=\"64bithotSpotmarkword.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>40. synchronized åšäº†å“ªäº›ä¼˜åŒ–ï¼Ÿ</h1>\n<ul>\n<li>åå‘é”ï¼šå½“ä¸€ä¸ªçº¿ç¨‹é¦–æ¬¡è·å¾—é”æ—¶ï¼ŒJVM ä¼šå°†é”æ ‡è®°ä¸ºåå‘è¿™ä¸ªçº¿ç¨‹ï¼Œå°†é”çš„æ ‡å¿—ä½è®¾ç½®ä¸ºåå‘æ¨¡å¼ï¼Œå¹¶ä¸”åœ¨å¯¹è±¡å¤´ä¸­è®°å½•ä¸‹è¯¥çº¿ç¨‹çš„ IDã€‚ä¹‹åï¼Œå½“ç›¸åŒçš„çº¿ç¨‹å†æ¬¡è¯·æ±‚è¿™ä¸ªé”æ—¶ï¼Œå°±æ— éœ€è¿›è¡Œé¢å¤–çš„åŒæ­¥ã€‚å¦‚æœå¦ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–è¿™ä¸ªé”ï¼Œåå‘æ¨¡å¼ä¼šè¢«æ’¤é”€ï¼Œå¹¶ä¸”é”ä¼šå‡çº§ä¸ºè½»é‡çº§é”ã€‚</li>\n<li>è½»é‡çº§é”ï¼šå¤šä¸ªçº¿ç¨‹åœ¨ä¸åŒæ—¶æ®µè·å–åŒä¸€æŠŠé”ï¼Œå³ä¸å­˜åœ¨é”ç«äº‰çš„æƒ…å†µï¼Œä¹Ÿå°±æ²¡æœ‰çº¿ç¨‹é˜»å¡ã€‚é’ˆå¯¹è¿™ç§æƒ…å†µï¼ŒJVM é‡‡ç”¨è½»é‡çº§é”æ¥é¿å…çº¿ç¨‹çš„é˜»å¡ä¸å”¤é†’ã€‚å½“ä¸€ä¸ªçº¿ç¨‹å°è¯•è·å–è½»é‡çº§é”æ—¶ï¼Œå®ƒä¼šåœ¨è‡ªå·±çš„æ ˆå¸§ä¸­åˆ›å»ºä¸€ä¸ªé”è®°å½•ï¼ˆLock Recordï¼‰ï¼Œç„¶åå°è¯•ä½¿ç”¨ CAS æ“ä½œå°†å¯¹è±¡å¤´çš„ Mark Word æ›¿æ¢ä¸ºæŒ‡å‘é”è®°å½•çš„æŒ‡é’ˆã€‚å¦‚æœæˆåŠŸï¼Œè¯¥çº¿ç¨‹æŒæœ‰é”ï¼›å¦‚æœå¤±è´¥ï¼Œè¡¨ç¤ºæœ‰å…¶ä»–çº¿ç¨‹ç«äº‰ï¼Œé”ä¼šå‡çº§ä¸ºé‡é‡çº§é”ã€‚</li>\n<li>è‡ªæ—‹é”ï¼šå½“çº¿ç¨‹å°è¯•è·å–è½»é‡çº§é”å¤±è´¥æ—¶ï¼Œå®ƒä¼šè¿›è¡Œè‡ªæ—‹ï¼Œå³å¾ªç¯æ£€æŸ¥é”æ˜¯å¦å¯ç”¨ï¼Œä»¥é¿å…ç«‹å³è¿›å…¥é˜»å¡çŠ¶æ€ã€‚è‡ªæ—‹çš„æ¬¡æ•°ä¸æ˜¯å›ºå®šçš„ï¼Œè€Œæ˜¯æ ¹æ®ä¹‹å‰åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´å’Œé”çš„çŠ¶æ€åŠ¨æ€è°ƒæ•´çš„ã€‚</li>\n<li>é”ç²—åŒ–ï¼šå¦‚æœ JVM æ£€æµ‹åˆ°ä¸€ç³»åˆ—è¿ç»­çš„é”æ“ä½œå®é™…ä¸Šæ˜¯åœ¨å•ä¸€çº¿ç¨‹ä¸­å®Œæˆçš„ï¼Œåˆ™ä¼šå°†å¤šä¸ªé”æ“ä½œåˆå¹¶ä¸ºä¸€ä¸ªæ›´å¤§èŒƒå›´çš„é”æ“ä½œï¼Œè¿™å¯ä»¥å‡å°‘é”è¯·æ±‚çš„æ¬¡æ•°ã€‚é”ç²—åŒ–ä¸»è¦é’ˆå¯¹å¾ªç¯å†…è¿ç»­åŠ é”è§£é”çš„æƒ…å†µè¿›è¡Œä¼˜åŒ–ã€‚</li>\n<li>é”æ¶ˆé™¤ï¼šJVMçš„å³æ—¶ç¼–è¯‘å™¨ï¼ˆJITï¼‰å¯ä»¥åœ¨è¿è¡Œæ—¶è¿›è¡Œä»£ç åˆ†æï¼Œå¦‚æœå‘ç°æŸäº›é”æ“ä½œä¸å¯èƒ½è¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œé‚£ä¹ˆé”æ“ä½œå°±ä¼šè¢«æ¶ˆé™¤ã€‚å‡å°‘ä¸å¿…è¦çš„åŒæ­¥å¼€é”€</li>\n</ul>\n<h1>41. synchronizedå’ŒReenTrantLockå¼‚åŒï¼Ÿâˆš</h1>\n<ul>\n<li>éƒ½æ˜¯å¯é‡å…¥é”</li>\n<li>ç”¨æ³•ä¸åŒï¼šsynchronizedæ˜¯å…³é”®å­—ï¼Œå¯ä¿®é¥°æ–¹æ³•ã€ä»£ç å—ï¼Œæ— éœ€æ‰‹åŠ¨é‡Šæ”¾é”ã€‚ReentrantLockæ˜¯ç±»ï¼Œè°ƒç”¨tryLockå’Œlockæ–¹æ³•ï¼Œéœ€è¦åœ¨finallyå—ä¸­é‡Šæ”¾é”</li>\n<li>åŠŸèƒ½ç‰¹ç‚¹ä¸åŒï¼šsynchronizedåªæ”¯æŒéå…¬å¹³é”ï¼ŒReentrantLockæä¾›å…¬å¹³é”å’Œéå…¬å¹³é”ã€ç­‰å¾…å¯ä¸­æ–­ã€é€‰æ‹©æ€§é€šçŸ¥ï¼ˆé”å¯ä»¥ç»‘å®šå¤šä¸ªæ¡ä»¶ï¼‰ç­‰ç‰¹æ€§</li>\n<li>synchronizedå‘ç”Ÿå¼‚å¸¸æ—¶è‡ªåŠ¨é‡Šæ”¾é”ï¼Œæ•…ä¸ä¼šæ­»é”ã€‚Lockå‘ç”Ÿå¼‚å¸¸ï¼Œè‹¥æ²¡æœ‰ä¸»åŠ¨é‡Šæ”¾ï¼Œæœ‰æ­»é”ï¼Œæ•…éœ€åœ¨finallyä¸­è°ƒç”¨unLockæ–¹æ³•é‡Šæ”¾é”</li>\n<li>å®ç°æœºåˆ¶ä¸åŒï¼šsynchronizedé€šè¿‡Javaå¯¹è±¡å¤´é”æ ‡è®°å’ŒMonitorå¯¹è±¡å®ç°åŒæ­¥ã€‚ReentrantLocké€šè¿‡CASã€AQSï¼ˆAbstractQueuedSynchronizerï¼‰å’Œ LockSupportï¼ˆç”¨äºé˜»å¡å’Œè§£é™¤é˜»å¡ï¼‰å®ç°åŒæ­¥ã€‚</li>\n<li>å¯è§æ€§å®ç°æœºåˆ¶ä¸åŒï¼šsynchronizedä¾èµ–JVMå†…å­˜æ¨¡å‹ä¿è¯åŒ…å«å…±äº«å˜é‡çš„å¤šçº¿ç¨‹å†…å­˜å¯è§æ€§ã€‚ReentrantLocké€šè¿‡AQSçš„volatile stateä¿è¯åŒ…å«å…±äº«å˜é‡çš„å¤šçº¿ç¨‹å†…å­˜å¯è§æ€§</li>\n<li>ReentrantLock å¯ä»¥å®ç°å¤šæ¡ä»¶é€šçŸ¥ï¼ˆå¯ä»¥ç»‘å®šå¤šä¸ª Conditionï¼‰ï¼Œè€Œ synchronized åªèƒ½é€šè¿‡ wait å’Œ notify/notifyAll æ–¹æ³•å”¤é†’ä¸€ä¸ªçº¿ç¨‹æˆ–è€…å”¤é†’å…¨éƒ¨çº¿ç¨‹ï¼ˆå•æ¡ä»¶é€šçŸ¥ï¼‰ï¼›</li>\n</ul>\n<h1>42. AQSäº†è§£å¤šå°‘ï¼Ÿ</h1>\n<ul>\n<li>AbstractQueuedSynchronizeræŠ½è±¡åŒæ­¥é˜Ÿåˆ—ï¼Œç®€ç§°AQSã€‚å¹¶å‘åŒ…ä¸­çš„é”å°±æ˜¯åŸºäºAQSå®ç°ã€‚</li>\n<li>AQSæ˜¯åŸºäºä¸€ä¸ªFIFOçš„åŒå‘é˜Ÿåˆ—ï¼Œå…¶å†…éƒ¨å®šä¹‰äº†ä¸€ä¸ªèŠ‚ç‚¹ç±»Nodeï¼ŒNodeèŠ‚ç‚¹å†…éƒ¨çš„SHAREDç”¨æ¥æ ‡è®°è¯¥çº¿ç¨‹æ˜¯è·å–å…±äº«èµ„æºæ—¶è¢«é˜»æŒ‚èµ·åæ”¾å…¥AQSé˜Ÿåˆ—çš„ï¼ŒEXCLUSIVEç”¨æ¥æ ‡è®°çº¿ç¨‹æ˜¯å–ç‹¬å èµ„æºæ—¶è¢«æŒ‚èµ·åæ”¾å…¥AQSé˜Ÿåˆ—</li>\n<li>AQSä½¿ç”¨ä¸€ä¸ªvolatileä¿®é¥°çš„intç±»å‹çš„æˆå‘˜å˜é‡stateæ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œä¿®æ”¹åŒæ­¥çŠ¶æ€æˆåŠŸå³ä¸ºè·å¾—é”ï¼Œvolatileä¿è¯äº†å˜é‡åœ¨å¤šçº¿ç¨‹ä¹‹é—´çš„å¯è§æ€§ï¼Œä¿®æ”¹Stateå€¼æ—¶é€šè¿‡CASæœºåˆ¶æ¥ä¿è¯ä¿®æ”¹çš„åŸå­æ€§</li>\n<li>è·å–stateçš„æ–¹å¼åˆ†ä¸ºä¸¤ç§ï¼Œç‹¬å æ–¹å¼å’Œå…±äº«æ–¹å¼ï¼Œä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ç‹¬å æ–¹å¼è·å–äº†èµ„æºï¼Œå…¶å®ƒçº¿ç¨‹å°±ä¼šåœ¨è·å–å¤±è´¥åè¢«é˜»å¡ã€‚ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨å…±äº«æ–¹å¼è·å–äº†èµ„æºï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹è¿˜å¯ä»¥é€šè¿‡CASçš„æ–¹å¼è¿›è¡Œè·å–ã€‚</li>\n<li>å¦‚æœå…±äº«èµ„æºè¢«å ç”¨ï¼Œéœ€è¦ä¸€å®šçš„é˜»å¡ç­‰å¾…å”¤é†’æœºåˆ¶æ¥ä¿è¯é”çš„åˆ†é…ï¼ŒAQSä¸­ä¼šå°†ç«äº‰å…±äº«èµ„æºå¤±è´¥çš„çº¿ç¨‹æ·»åŠ åˆ°ä¸€ä¸ªå˜ä½“çš„CLHé˜Ÿåˆ—ä¸­</li>\n<li>AQSä¸­çš„é˜Ÿåˆ—æ˜¯CLHå˜ä½“çš„è™šæ‹ŸåŒå‘é˜Ÿåˆ—ï¼Œé€šè¿‡å°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ªèŠ‚ç‚¹æ¥å®ç°é”çš„åˆ†é…ï¼šæ‹¥æœ‰ä»¥ä¸‹ç‰¹æ€§ï¼š\n<ul>\n<li>AQSä¸­é˜Ÿåˆ—æ˜¯ä¸ªåŒå‘é“¾è¡¨ï¼ŒFIFOå…ˆè¿›å…ˆå‡º</li>\n<li>é€šè¿‡Headã€Tailå¤´å°¾ä¸¤ä¸ªèŠ‚ç‚¹æ¥ç»„æˆé˜Ÿåˆ—ç»“æ„ï¼Œé€šè¿‡volatileä¿®é¥°ä¿è¯å¯è§æ€§</li>\n<li>HeadæŒ‡å‘èŠ‚ç‚¹ä¸ºå·²è·å¾—é”çš„èŠ‚ç‚¹ï¼Œæ˜¯ä¸€ä¸ªè™šæ‹ŸèŠ‚ç‚¹ï¼ŒèŠ‚ç‚¹æœ¬èº«ä¸æŒæœ‰å…·ä½“çº¿ç¨‹</li>\n<li>è·å–ä¸åˆ°åŒæ­¥çŠ¶æ€ï¼Œä¼šå°†èŠ‚ç‚¹è¿›è¡Œè‡ªæ—‹è·å–é”ï¼Œè‡ªæ—‹ä¸€å®šæ¬¡æ•°å¤±è´¥åä¼šå°†çº¿ç¨‹é˜»å¡</li>\n<li>è§£é”æ—¶å”¤é†’åç»§èŠ‚ç‚¹</li>\n</ul>\n</li>\n</ul>\n<h1>43. ReentrantLockå®ç°åŸç†ï¼Ÿ</h1>\n<ul>\n<li>ReentrantLockæ˜¯å¯é‡å…¥çš„ç‹¬å é”ï¼Œåªèƒ½æœ‰ä¸€ä¸ªçº¿ç¨‹å¯ä»¥è·å–è¯¥é”ï¼Œå…¶å®ƒè·å–è¯¥é”çš„çº¿ç¨‹ä¼šè¢«é˜»å¡ã€‚å¯é‡å…¥è¡¨ç¤ºåŒä¸€ä¸ªçº¿ç¨‹å¯ä»¥å¤šæ¬¡è·å¾—åŒä¸€ä¸ªé”è€Œä¸ä¼šå‘ç”Ÿæ­»é”ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//åˆ›å»ºéå…¬å¹³é”\nReentrantLock lock=new ReentrantLock();\n//è·å–é”æ“ä½œ\nlock.lock();\ntry{\n//æ‰§è¡Œä»£ç é€»è¾‘\n}catch(Exceptionex){\n//...\n}finally{\n//è§£é”æ“ä½œ\nlock.unlock();\n}\n</code></pre></div><ul>\n<li>åœ¨å…¬å¹³é”æ¨¡å¼ä¸‹ï¼Œé”ä¼šæˆäºˆç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹ã€‚åœ¨éå…¬å¹³é”æ¨¡å¼ä¸‹ï¼Œé”å¯èƒ½ä¼šæˆäºˆåˆšåˆšè¯·æ±‚å®ƒçš„çº¿ç¨‹ï¼Œè€Œä¸è€ƒè™‘ç­‰å¾…æ—¶é—´ã€‚</li>\n<li>ReentrantLockå†…éƒ¨é€šè¿‡ä¸€ä¸ªè®¡æ•°å™¨æ¥è·Ÿè¸ªé”çš„æŒæœ‰æ¬¡æ•°ã€‚\n<ul>\n<li>å½“çº¿ç¨‹è°ƒç”¨lock()æ–¹æ³•è·å–é”æ—¶ï¼ŒReentrantLockä¼šæ£€æŸ¥å½“å‰çŠ¶æ€ï¼Œåˆ¤æ–­é”æ˜¯å¦å·²ç»è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ã€‚å¦‚æœæ²¡æœ‰è¢«æŒæœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹å°†è·å¾—é”ï¼›å¦‚æœé”å·²è¢«å…¶ä»–çº¿ç¨‹æŒæœ‰ï¼Œåˆ™å½“å‰çº¿ç¨‹å°†æ ¹æ®é”çš„å…¬å¹³æ€§ç­–ç•¥ï¼Œå¯èƒ½ä¼šè¢«åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li>\n<li>çº¿ç¨‹é¦–æ¬¡è·å–é”æ—¶ï¼Œè®¡æ•°å™¨å€¼å˜ä¸º1ï¼›å¦‚æœåŒä¸€çº¿ç¨‹å†æ¬¡è·å–é”ï¼Œè®¡æ•°å™¨å¢åŠ ï¼›æ¯é‡Šæ”¾ä¸€æ¬¡é”ï¼Œè®¡æ•°å™¨å‡1ã€‚</li>\n<li>å½“çº¿ç¨‹è°ƒç”¨unlock()æ–¹æ³•æ—¶ï¼ŒReentrantLockä¼šå°†æŒæœ‰é”çš„è®¡æ•°å‡1ï¼Œå¦‚æœè®¡æ•°åˆ°è¾¾0åˆ™é‡Šæ”¾é”ï¼Œå¹¶å”¤é†’ç­‰å¾…é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹æ¥ç«äº‰é”</li>\n</ul>\n</li>\n</ul>\n<h1>44. ReentrantLock æ€ä¹ˆå®ç°å…¬å¹³é”çš„ï¼Ÿ</h1>\n<ul>\n<li>new ReentrantLock()</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æ„é€ æ–¹æ³•é»˜è®¤åˆ›å»ºçš„æ˜¯éå…¬å¹³é” NonfairSync\npublic ReentrantLock() {\n    sync = new NonfairSync();\n}\n//åˆ›å»ºé”æ„é€ æ–¹æ³•ä¸­ä¼ å…¥å…·ä½“å‚æ•°åˆ›å»ºå…¬å¹³é” FairSync\nReentrantLock lock = new ReentrantLock(true);\n\n// true ä»£è¡¨å…¬å¹³é”ï¼Œfalse ä»£è¡¨éå…¬å¹³é”\n//FairSyncã€NonfairSync ä»£è¡¨å…¬å¹³é”å’Œéå…¬å¹³é”ï¼Œä¸¤è€…éƒ½æ˜¯ ReentrantLock é™æ€å†…éƒ¨ç±»ï¼Œåªä¸è¿‡å®ç°ä¸åŒé”è¯­ä¹‰ã€‚\npublic ReentrantLock(boolean fair) {\n    sync = fair ? new FairSync() : new NonfairSync();\n}\n</code></pre></div><ul>\n<li>éå…¬å¹³é”å’Œå…¬å¹³é”çš„ä¸¤å¤„ä¸åŒï¼š\n<ul>\n<li>éå…¬å¹³é”åœ¨è°ƒç”¨ lock åï¼Œé¦–å…ˆå°±ä¼šè°ƒç”¨ CAS è¿›è¡Œä¸€æ¬¡æŠ¢é”ï¼Œå¦‚æœè¿™ä¸ªæ—¶å€™æ°å·§é”æ²¡æœ‰è¢«å ç”¨ï¼Œé‚£ä¹ˆç›´æ¥å°±è·å–åˆ°é”è¿”å›äº†ã€‚</li>\n<li>éå…¬å¹³é”åœ¨ CAS å¤±è´¥åï¼Œå’Œå…¬å¹³é”ä¸€æ ·éƒ½ä¼šè¿›å…¥åˆ° tryAcquire æ–¹æ³•ï¼Œåœ¨ tryAcquire æ–¹æ³•ä¸­ï¼Œå¦‚æœå‘ç°é”è¿™ä¸ªæ—¶å€™è¢«é‡Šæ”¾äº†ï¼ˆstate == 0ï¼‰ï¼Œéå…¬å¹³é”ä¼šç›´æ¥ CAS æŠ¢é”ï¼Œä½†æ˜¯å…¬å¹³é”ä¼šåˆ¤æ–­ç­‰å¾…é˜Ÿåˆ—æ˜¯å¦æœ‰çº¿ç¨‹å¤„äºç­‰å¾…çŠ¶æ€ï¼Œå¦‚æœæœ‰åˆ™ä¸å»æŠ¢é”ï¼Œä¹–ä¹–æ’åˆ°åé¢ã€‚</li>\n</ul>\n</li>\n<li>éå…¬å¹³é”æ€§èƒ½æ›´å¥½ï¼Œå› ä¸ºååé‡å¤§ã€‚ä½†éå…¬å¹³é”è®©è·å–é”çš„æ—¶é—´å˜å¾—æ›´åŠ ä¸ç¡®å®šï¼Œé˜»å¡é˜Ÿåˆ—ä¸­çš„çº¿ç¨‹å¯èƒ½é•¿æœŸå¤„äºé¥¥é¥¿çŠ¶æ€</li>\n<li>æ€ä¹ˆå®ç°ä¸€ä¸ªéå…¬å¹³é”å‘¢ï¼Ÿåªéœ€è¦åœ¨åˆ›å»ºReentrantLockå®ä¾‹æ—¶ï¼Œä¸ä¼ é€’ä»»ä½•å‚æ•°æˆ–è€…ä¼ é€’falseç»™æ„é€ æ–¹æ³•ã€‚</li>\n</ul>\n<h1>45. ä»€ä¹ˆæ˜¯cas?</h1>\n<ul>\n<li>CASå«åšCompareAndSwapï¼Œâ½è¾ƒå¹¶äº¤æ¢ï¼Œæ˜¯ä¸€ä¸ªæ— é”çš„åŸå­æ“ä½œã€‚CASæ“ä½œåŒ…å«3ä¸ªå‚æ•°ï¼šå…±äº«å˜é‡çš„å†…å­˜åœ°å€Aã€é¢„æœŸçš„å€¼Bå’Œå…±äº«å˜é‡çš„æ–°å€¼Cã€‚åªæœ‰å½“å†…å­˜ä¸­åœ°å€Aå¤„çš„å€¼ç­‰äºBæ—¶ï¼Œæ‰èƒ½å°†å†…å­˜ä¸­åœ°å€Aå¤„çš„å€¼æ›´æ–°ä¸ºæ–°å€¼Cã€‚</li>\n<li>synchronized æ˜¯æ‚²è§‚é”ï¼Œçº¿ç¨‹å¼€å§‹æ‰§è¡Œç¬¬ä¸€æ­¥å°±è¦è·å–é”ï¼Œä¸€æ—¦è·å¾—é”ï¼Œå…¶ä»–çš„çº¿ç¨‹è¿›å…¥åå°±ä¼šé˜»å¡å¹¶ç­‰å¾…é”ã€‚</li>\n<li>CASæ˜¯ä¹è§‚é”ï¼Œçº¿ç¨‹æ‰§è¡Œçš„æ—¶å€™ä¸ä¼šåŠ é”ï¼Œå®ƒä¼šå‡è®¾æ­¤æ—¶æ²¡æœ‰å†²çªï¼Œç„¶åå®ŒæˆæŸé¡¹æ“ä½œï¼›å¦‚æœå› ä¸ºå†²çªå¤±è´¥äº†å°±é‡è¯•ï¼Œç›´åˆ°æˆåŠŸä¸ºæ­¢</li>\n<li>ä¸»è¦æ˜¯é€šè¿‡å¤„ç†å™¨çš„æŒ‡ä»¤æ¥ä¿è¯æ“ä½œçš„åŸâ¼¦æ€§çš„ã€‚Unsafe å¯¹ CAS çš„å®ç°æ˜¯é€šè¿‡ C++ å®ç°çš„ã€‚Linux çš„ X86 ä¸‹ä¸»è¦æ˜¯é€šè¿‡ cmpxchg æŒ‡ä»¤åœ¨ CPU ä¸Šå®Œæˆ CAS æ“ä½œçš„ï¼Œä½†åœ¨å¤šå¤„ç†å™¨æƒ…å†µä¸‹ï¼Œå¿…é¡»ä½¿ç”¨ lock æŒ‡ä»¤åŠ é”æ¥å®Œæˆã€‚ä¸åŒçš„æ“ä½œç³»ç»Ÿå’Œå¤„ç†å™¨åœ¨å®ç°æ–¹å¼ä¸Šè‚¯å®šä¼šæœ‰æ‰€ä¸åŒã€‚</li>\n</ul>\n<h1>46. casé—®é¢˜ï¼Ÿ</h1>\n<ul>\n<li>ABAé—®é¢˜ï¼šå¦‚æœä¸€ä¸ªå˜é‡Våˆæ¬¡è¯»å–çš„æ—¶å€™æ˜¯Aå€¼ï¼Œåœ¨èµ‹å€¼çš„æ—¶ä»ç„¶æ˜¯Aå€¼ï¼Œåœ¨è¿™æ®µæ—¶é—´å®ƒçš„å€¼å¯èƒ½è¢«æ”¹ä¸ºå…¶ä»–å€¼ï¼Œç„¶ååˆæ”¹å›Aï¼ŒCASæ“ä½œä¼šè¯¯è®¤ä¸ºå®ƒä»æ¥æ²¡æœ‰è¢«ä¿®æ”¹è¿‡ã€‚\n<ul>\n<li>ä½¿ç”¨AtomicStampedReferenceç±»è§£å†³ï¼Œå¸¦æœ‰æ—¶é—´æˆ³çš„å¯¹è±¡å¼•ç”¨ï¼Œå…¶ä¸­compareAndSetæ–¹æ³•ä¼šæ¯”è¾ƒå‰å¼•ç”¨æ˜¯å¦ç­‰äºé¢„æœŸå¼•ç”¨å¹¶ä¸”å°æˆ³æ˜¯å¦ç­‰äºé¢„æœŸå°æˆ³ï¼Œå¦‚æœå…¨éƒ¨ç›¸ç­‰ï¼Œåˆ™ä»¥åŸå­æ–¹å¼å°†è¯¥å¼•ç”¨å’Œè¯¥æ ‡å¿—çš„å€¼è®¾ç½®ä¸ºç»™å®šçš„æ›´æ–°å€¼</li>\n<li>ä½¿ç”¨ç‰ˆæœ¬å·å»è§£å†³ã€‚æ¯æ¬¡ä¿®æ”¹å˜é‡ï¼Œéƒ½åœ¨è¿™ä¸ªå˜é‡çš„ç‰ˆæœ¬å·ä¸ŠåŠ 1ï¼Œæ­¤æ—¶è™½ç„¶å€¼æ²¡å˜ï¼Œä½†ç‰ˆæœ¬å·å˜äº†ã€‚</li>\n</ul>\n</li>\n<li>å¾ªç¯æ€§èƒ½å¼€é”€ï¼šè‡ªæ—‹CASï¼ˆä¸æˆåŠŸå°±ä¸€ç›´å¾ªç¯æ‰§è¡Œç›´åˆ°æˆåŠŸï¼‰å¦‚æœé•¿æ—¶é—´ä¸æˆåŠŸï¼Œä¼šç»™CPUå¸¦æ¥éå¸¸å¤§çš„æ‰§è¡Œå¼€é”€ã€‚\n<ul>\n<li>é™åˆ¶è‡ªæ—‹æ¬¡æ•°ï¼Œè¶…è¿‡ä¸€å®šæ¬¡æ•°åœæ­¢è‡ªæ—‹ã€‚</li>\n</ul>\n</li>\n<li>åªèƒ½ä¿è¯ä¸€ä¸ªå…±äº«å˜é‡çš„åŸå­æ“ä½œï¼šcasæ— æ³•ä¿è¯å¤šä¸ªå…±äº«å˜é‡æ“ä½œçš„åŸå­æ€§ï¼Œå¯ä»¥ä½¿ç”¨é”æˆ–è€…AtomicReferenceç±»æŠŠå¤šä¸ªå…±äº«å˜é‡åˆå¹¶æˆä¸€ä¸ªå…±äº«å˜é‡æ¥æ“ä½œ</li>\n</ul>\n<h1>47. Javaä¿è¯åŸå­æ€§çš„æ–¹æ³•ï¼Ÿå¦‚ä½•ä¿è¯å¤šçº¿ç¨‹ä¸‹ i++ ç»“æœæ­£ç¡®ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨å¾ªç¯åŸå­ç±»ï¼Œä¾‹å¦‚AtomicIntegerï¼Œå®ç°i++åŸå­æ“ä½œ</li>\n<li>ä½¿ç”¨jucåŒ…ä¸‹çš„é”ï¼Œå¦‚ReentrantLockï¼Œå¯¹i++æ“ä½œåŠ é”lock.lock()æ¥å®ç°åŸå­æ€§</li>\n<li>ä½¿ç”¨synchronizedï¼Œå¯¹i++æ“ä½œåŠ é”</li>\n</ul>\n<h1>48. Javaä¸­çš„13ä¸ªåŸå­æ“ä½œç±»âˆš</h1>\n<ul>\n<li>java.util.concurrent.atomicåŒ…ä¸­çš„åŸå­æ“ä½œç±»æä¾›äº†ä¸€ç§ç”¨æ³•ç®€å•ã€æ€§èƒ½é«˜æ•ˆã€çº¿ç¨‹å®‰å…¨åœ°æ›´æ–°ä¸€ä¸ªå˜é‡çš„æ–¹å¼ã€‚</li>\n<li>åŸç†CAS(Compare&amp;Setæˆ–Compare&amp;Swap)åŸå­æ“ä½œvolatileå˜é‡</li>\n<li>åŸå­æ›´æ–°åŸºæœ¬ç±»å‹ç±»:\n<ul>\n<li>AtomicBooleanï¼šåŸå­æ›´æ–°å¸ƒå°”ç±»å‹;</li>\n<li>AtomicIntegerï¼šåŸå­æ›´æ–°æ•´å‹;</li>\n<li>AtomicLongï¼šåŸå­æ›´æ–°é•¿æ•´å‹ã€‚</li>\n<li>charã€floatå’ŒdoubleåŸå­ç±»å‹çš„æ›´æ–°:ä½¿ç”¨compareAndSwapObjectã€compareAndSwapIntã€compareAndSwapLongï¼Œå‚è€ƒAtomicBoolean</li>\n</ul>\n</li>\n<li>åŸå­æ›´æ–°æ•°ç»„æŸä¸ªå…ƒç´ ï¼š\n<ul>\n<li>AtomicIntegerArrayï¼šåŸå­æ›´æ–°æ•´å‹æ•°ç»„é‡Œçš„å…ƒç´ ã€‚</li>\n<li>AtomicLongArrayï¼šåŸå­æ›´æ–°é•¿æ•´å‹æ•°ç»„é‡Œçš„å…ƒç´ ã€‚</li>\n<li>AtomicReferenceArrayï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹æ•°ç»„é‡Œçš„å…ƒç´ ã€‚</li>\n</ul>\n</li>\n<li>åŸå­æ›´æ–°å¼•ç”¨ç±»å‹/å¤šä¸ªå¯¹è±¡å±æ€§ï¼š\n<ul>\n<li>AtomicReferenceï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹ã€‚</li>\n<li>AtomicReferenceFieldUpdaterï¼šåŸå­æ›´æ–°å¼•ç”¨ç±»å‹é‡Œçš„å­—æ®µã€‚</li>\n<li>AtomicMarkableReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰æ ‡è®°ä½çš„å¼•ç”¨ç±»å‹ã€‚è§£å†³ABAé—®é¢˜ã€‚å¯ä»¥åŸå­æ›´æ–°ä¸€ä¸ªå¸ƒå°”ç±»å‹çš„æ ‡è®°ä½å’Œå¼•ç”¨ç±»å‹ã€‚æ„é€ æ–¹æ³•æ˜¯AtomicMarkableReferenceï¼ˆV initialRefï¼Œboolean initialMarkï¼‰ã€‚</li>\n</ul>\n</li>\n<li>åŸå­æ›´æ–°å­—æ®µç±»ï¼š\n<ul>\n<li>AtomicIntegerFieldUpdaterï¼šåŸå­æ›´æ–°æ•´å‹çš„å­—æ®µã€‚</li>\n<li>AtomicLongFieldUpdaterï¼šåŸå­æ›´æ–°é•¿æ•´å‹å­—æ®µã€‚</li>\n<li>AtomicStampedReferenceï¼šåŸå­æ›´æ–°å¸¦æœ‰ç‰ˆæœ¬å·çš„å¼•ç”¨ç±»å‹(è§£å†³ABA)</li>\n</ul>\n</li>\n</ul>\n<h1>49. AtomicInteger çš„åŸç†ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨CAS+volatile intå®ç°</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//AtomicInteger çš„æ·»åŠ æ–¹æ³•ã€‚ä»¥Unsafeç±»çš„å®ä¾‹æ¥è¿›è¡Œæ·»åŠ æ“ä½œ\npublic final int getAndIncrement() {\n    return unsafe.getAndAddInt(this, valueOffset, 1);\n}\n//compareAndSwapIntæ˜¯ä¸€ä¸ªnativeæ–¹æ³•ï¼ŒåŸºäºCASæ¥æ“ä½œintç±»å‹å˜é‡ã€‚å…¶å®ƒçš„åŸå­æ“ä½œç±»åŸºæœ¬éƒ½æ˜¯å¤§åŒå°å¼‚ã€‚\npublic final int getAndAddInt(Object var1, long var2, int var4) {\n    int var5;\n    do {\n        var5 = this.getIntVolatile(var1, var2);\n    } while(!this.compareAndSwapInt(var1, var2, var5, var5 + var4));\n    return var5;\n}\n</code></pre></div><h1>50. ä»€ä¹ˆæ˜¯æ­»é”</h1>\n<ul>\n<li>æ­»é”ï¼šä¸¤ä¸ªæˆ–ä¸¤ä¸ªä»¥ä¸Šçš„è¿›ç¨‹æˆ–çº¿ç¨‹åœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­å› äº‰å¤ºèµ„æºè€Œé€ æˆçš„ä¸€ç§äº’ç›¸ç­‰å¾…çš„ç°è±¡ï¼Œè‹¥æ— å¤–åŠ›ä½œç”¨ï¼Œå®ƒä»¬éƒ½å°†æ— æ³•æ¨è¿›ä¸‹å»</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>class DeadLockDemo {\n    private static final Object lock1 = new Object();\n    private static final Object lock2 = new Object();\n\n    public static void main(String[] args) {\n        new Thread(() -&gt; {\n            synchronized (lock1) {\n                System.out.println(\"çº¿ç¨‹1è·å–åˆ°äº†é”1\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                synchronized (lock2) {\n                    System.out.println(\"çº¿ç¨‹1è·å–åˆ°äº†é”2\");\n                }\n            }\n        }).start();\n\n        new Thread(() -&gt; {\n            synchronized (lock2) {\n                System.out.println(\"çº¿ç¨‹2è·å–åˆ°äº†é”2\");\n                try {\n                    Thread.sleep(1000);\n                } catch (InterruptedException e) {\n                    e.printStackTrace();\n                }\n                synchronized (lock1) {\n                    System.out.println(\"çº¿ç¨‹2è·å–åˆ°äº†é”1\");\n                }\n            }\n        }).start();\n    }\n}\n</code></pre></div><h1>51. æ­»é”çš„äº§ç”Ÿæ¡ä»¶</h1>\n<ul>\n<li>äº’æ–¥æ¡ä»¶ï¼šèµ„æºä¸èƒ½è¢«å¤šä¸ªçº¿ç¨‹å…±äº«ï¼Œä¸€æ¬¡åªèƒ½ç”±ä¸€ä¸ªçº¿ç¨‹ä½¿ç”¨ã€‚å¦‚æœä¸€ä¸ªçº¿ç¨‹å·²ç»å ç”¨äº†ä¸€ä¸ªèµ„æºï¼Œå…¶ä»–è¯·æ±‚è¯¥èµ„æºçš„çº¿ç¨‹å¿…é¡»ç­‰å¾…ï¼Œç›´åˆ°èµ„æºè¢«é‡Šæ”¾ã€‚</li>\n<li>è¯·æ±‚å’Œä¿æŒæ¡ä»¶ï¼šä¸€ä¸ªçº¿ç¨‹è‡³å°‘å·²ç»æŒæœ‰è‡³å°‘ä¸€ä¸ªèµ„æºï¼Œä¸”æ­£åœ¨ç­‰å¾…è·å–é¢å¤–çš„èµ„æºï¼Œè¿™äº›é¢å¤–çš„èµ„æºè¢«å…¶ä»–çº¿ç¨‹å æœ‰ã€‚</li>\n<li>ä¸å¯å‰¥å¤ºæ¡ä»¶ï¼šèµ„æºä¸èƒ½è¢«å¼ºåˆ¶ä»ä¸€ä¸ªçº¿ç¨‹ä¸­æŠ¢å è¿‡æ¥ï¼Œåªèƒ½ç”±æŒæœ‰èµ„æºçš„çº¿ç¨‹ä¸»åŠ¨é‡Šæ”¾ã€‚</li>\n<li>å¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå­˜åœ¨ä¸€ç§çº¿ç¨‹èµ„æºçš„å¾ªç¯é“¾ï¼Œæ¯ä¸ªçº¿ç¨‹è‡³å°‘æŒæœ‰ä¸€ä¸ªå…¶ä»–çº¿ç¨‹æ‰€éœ€è¦çš„èµ„æºï¼Œç„¶ååˆç­‰å¾…ä¸‹ä¸€ä¸ªçº¿ç¨‹æ‰€å æœ‰çš„èµ„æºã€‚è¿™å½¢æˆäº†ä¸€ä¸ªå¾ªç¯ç­‰å¾…çš„ç¯è·¯ã€‚</li>\n</ul>\n<h1>52. æ­»é”é¿å…ï¼Ÿ</h1>\n<p>è‡³å°‘ç ´åæ­»é”å‘ç”Ÿçš„ä¸€ä¸ªæ¡ä»¶</p>\n<ul>\n<li>ç ´åäº’æ–¥æ¡ä»¶ï¼šé€šå¸¸ä¸å¯è¡Œï¼Œå› ä¸ºåŠ é”å°±æ˜¯ä¸ºäº†äº’æ–¥ã€‚</li>\n<li>ç ´åæŒæœ‰å¹¶ç­‰å¾…æ¡ä»¶ï¼šè¦æ±‚çº¿ç¨‹åœ¨å¼€å§‹æ‰§è¡Œå‰ä¸€æ¬¡æ€§åœ°ç”³è¯·æ‰€æœ‰éœ€è¦çš„èµ„æºã€‚</li>\n<li>ç ´åéæŠ¢å æ¡ä»¶ï¼šå ç”¨éƒ¨åˆ†èµ„æºçš„çº¿ç¨‹è¿›ä¸€æ­¥ç”³è¯·å…¶ä»–èµ„æºæ—¶ï¼Œå¦‚æœç”³è¯·ä¸åˆ°ï¼Œå¯ä»¥ä¸»åŠ¨é‡Šæ”¾å®ƒå æœ‰çš„èµ„æºã€‚</li>\n<li>ç ´åå¾ªç¯ç­‰å¾…æ¡ä»¶ï¼šå¯¹æ‰€æœ‰èµ„æºç±»å‹è¿›è¡Œæ’åºï¼Œå¼ºåˆ¶æ¯ä¸ªçº¿ç¨‹æŒ‰é¡ºåºç”³è¯·èµ„æºï¼Œè¿™æ ·å¯ä»¥é¿å…å¾ªç¯ç­‰å¾…çš„å‘ç”Ÿã€‚</li>\n<li>é¿å…ä¸€ä¸ªçº¿ç¨‹åŒæ—¶è·å–å¤šä¸ªé”ã€‚</li>\n<li>é¿å…ä¸€ä¸ªçº¿ç¨‹åœ¨é”å†…åŒæ—¶å ç”¨å¤šä¸ªèµ„æºï¼Œå°½é‡ä¿è¯æ¯ä¸ªé”åªå ç”¨ä¸€ä¸ªèµ„æºã€‚</li>\n<li>å°è¯•ä½¿ç”¨å®šæ—¶é”ï¼Œä½¿ç”¨lock.tryLockï¼ˆtimeoutï¼‰æ¥æ›¿ä»£ä½¿ç”¨å†…éƒ¨é”æœºåˆ¶ã€‚</li>\n</ul>\n<h1>87. æ‚²è§‚é”å’Œä¹è§‚é”ï¼Ÿ</h1>\n<ul>\n<li>æ‚²è§‚é”ï¼šè®¤ä¸ºæ¯æ¬¡è®¿é—®å…±äº«èµ„æºæ—¶ä¼šå‘ç”Ÿå†²çªï¼Œæ‰€ä»¥æ¯æ¬¡è®¿é—®å…±äº«èµ„æºçš„æ—¶å€™éƒ½ä¼šä¸Šé”ï¼Œè¿™æ ·åˆ«äººæƒ³æ‹¿è¿™ä¸ªæ•°æ®å°±ä¼šé˜»å¡ç›´åˆ°å®ƒæ‹¿åˆ°é”ã€‚å…³ç³»å‹æ•°æ®åº“é‡Œè¾¹çš„è¡Œé”ï¼Œè¡¨é”ç­‰ï¼Œè¯»é”ï¼Œå†™é”ç­‰.synchronized å’Œ ReentrantLock ç­‰ç‹¬å é”ã€‚é€‚ç”¨äºå¤šå†™çš„æƒ…å†µã€‚CAS è‡ªæ—‹çš„æ¦‚ç‡ä¼šæ¯”è¾ƒå¤§ï¼Œä»è€Œæµªè´¹æ›´å¤šçš„ CPU èµ„æºï¼Œæ•ˆç‡ä½äº synchronizedã€‚</li>\n<li>ä¹è§‚é”ï¼šè®¤ä¸ºæ¯æ¬¡è®¿é—®å…±äº«èµ„æºæ—¶ä¸ä¼šå‘ç”Ÿå†²çªï¼Œæ‰€ä»¥ä¸ä¼šä¸Šé”ï¼Œä½†æ˜¯åœ¨æ›´æ–°çš„æ—¶å€™ä¼šåˆ¤æ–­ä¸€ä¸‹åœ¨æ­¤æœŸé—´åˆ«äººæœ‰æ²¡æœ‰å»æ›´æ–°è¿™ä¸ªæ•°æ®ï¼Œé€‚ç”¨äºå¤šè¯»çš„åº”ç”¨ç±»å‹ï¼Œå¦‚æ•°æ®åº“çš„write_condition æœºåˆ¶ï¼ŒatomicåŒ…ä¸‹é¢çš„åŸå­å˜é‡ç±».å¯ä»¥ä½¿ç”¨ç‰ˆæœ¬å·æœºåˆ¶å’Œ CAS ç®—æ³•å®ç°ã€‚ä½¿ç”¨ç‰ˆæœ¬æ ‡è¯†æ¥ç¡®å®šè¯»åˆ°çš„æ•°æ®ä¸æäº¤æ—¶çš„æ•°æ®æ˜¯å¦ä¸€è‡´ã€‚æäº¤åä¿®æ”¹ç‰ˆæœ¬æ ‡è¯†ï¼Œä¸ä¸€è‡´æ—¶å¯ä»¥é‡‡å–ä¸¢å¼ƒå’Œå†æ¬¡å°è¯•çš„ç­–ç•¥.CAS ï¼Œå½“å¤šä¸ªçº¿ç¨‹å°è¯•ä½¿ç”¨ CAS åŒæ—¶æ›´æ–°åŒä¸€ä¸ªå˜é‡æ—¶ï¼Œåªæœ‰å…¶ä¸­ä¸€ä¸ªçº¿ç¨‹èƒ½æ›´æ–°å˜é‡çš„å€¼ï¼Œè€Œå…¶å®ƒçº¿ç¨‹éƒ½å¤±è´¥ï¼Œå¤±è´¥çš„çº¿ç¨‹å¹¶ä¸ä¼šè¢«æŒ‚èµ·ï¼Œè€Œæ˜¯è¢«å‘ŠçŸ¥è¿™æ¬¡ç«äº‰ä¸­å¤±è´¥ï¼Œå¹¶å¯ä»¥å†æ¬¡å°è¯•ã€‚CAS åŸºäºç¡¬ä»¶å®ç°ï¼Œä¸éœ€è¦è¿›å…¥å†…æ ¸ï¼Œä¸éœ€è¦åˆ‡æ¢çº¿ç¨‹ï¼Œæ“ä½œè‡ªæ—‹å‡ ç‡è¾ƒå°‘ï¼Œå› æ­¤å¯ä»¥è·å¾—æ›´é«˜çš„æ€§èƒ½ï¼Œè¿™æ ·å¯ä»¥æé«˜ååé‡ã€‚</li>\n</ul>\n<h1>54. jdk7ä¸­ConcurrentHashMapå®ç°</h1>\n<ul>\n<li>JDK7æ—¶é‡‡ç”¨çš„æ˜¯åˆ†æ®µé”æœºåˆ¶ï¼ˆSegment Lockingï¼‰ï¼Œæ•´ä¸ª Map è¢«åˆ†ä¸ºè‹¥å¹²æ®µï¼Œæ¯ä¸ªæ®µéƒ½å¯ä»¥ç‹¬ç«‹åœ°åŠ é”ã€‚å› æ­¤ï¼Œä¸åŒçš„çº¿ç¨‹å¯ä»¥åŒæ—¶æ“ä½œä¸åŒçš„æ®µï¼Œä»è€Œå®ç°å¹¶å‘è®¿é—®ã€‚</li>\n<li>ç”±Segmentæ•°ç»„ç»“æ„å’ŒHashEntryæ•°ç»„æ„æˆçš„ã€‚Segmentæ˜¯ä¸€ç§å¯é‡å…¥çš„é”ReentrantLockï¼ŒHashEntryç”¨äºå­˜å‚¨é”®å€¼å¯¹æ•°æ®ã€‚</li>\n<li>ä¸€ä¸ª ConcurrentHashMap é‡ŒåŒ…å«ä¸€ä¸ª Segment æ•°ç»„ï¼ŒSegment çš„ç»“æ„å’Œ HashMap ç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ï¼Œä¸€ä¸ª Segment é‡ŒåŒ…å«ä¸€ä¸ª HashEntry æ•°ç»„ï¼Œæ¯ä¸ª HashEntry æ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ ï¼Œæ¯ä¸ª Segment å®ˆæŠ¤ç€ä¸€ä¸ª HashEntry æ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹ HashEntry æ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—å®ƒå¯¹åº”çš„ Segment é”ã€‚</li>\n<li>put æµç¨‹ï¼š\n<ul>\n<li>è®¡ç®— hashï¼Œå®šä½åˆ° segmentï¼Œsegment å¦‚æœæ˜¯ç©ºå°±å…ˆåˆå§‹åŒ–ï¼›</li>\n<li>ä½¿ç”¨ ReentrantLock åŠ é”ï¼Œå¦‚æœè·å–é”å¤±è´¥åˆ™å°è¯•è‡ªæ—‹ï¼Œè‡ªæ—‹è¶…è¿‡æ¬¡æ•°å°±é˜»å¡è·å–ï¼Œä¿è¯ä¸€å®šèƒ½è·å–åˆ°é”ï¼›</li>\n<li>éå† HashEntryï¼Œkey ç›¸åŒå°±ç›´æ¥æ›¿æ¢ï¼Œä¸å­˜åœ¨å°±æ’å…¥ã€‚</li>\n<li>é‡Šæ”¾é”</li>\n</ul>\n</li>\n<li>getæµç¨‹:é€šè¿‡ hash(key)å®šä½åˆ°segmentï¼Œå†éå†é“¾è¡¨å®šä½åˆ°å…·ä½“çš„å…ƒç´ ä¸Šï¼Œå› ä¸ºvalueæ˜¯volatileçš„ï¼Œæ‰€ä»¥ä¸éœ€è¦åŠ é”<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/798b56179a1383beb4c98.png\" alt=\"jdk7concurrenthashmapput.png\"></li>\n</ul>\n<h1>55. jdk8ä¸­ConcurrentHashMapå®ç°</h1>\n<ul>\n<li>JDK8ä»¥ä¸ŠConcurrentHashMapä½¿ç”¨æ¡¶é”ä»¥åŠCASæ— é”ç®—æ³•ã€‚æ¯ä¸ªæ¡¶ï¼ˆNode æ•°ç»„çš„æ¯ä¸ªå…ƒç´ ï¼‰éƒ½å¯ä»¥ç‹¬ç«‹åœ°åŠ é”ï¼Œé”ç²’åº¦æ›´å°</li>\n<li>å¯¹äºè¯»æ“ä½œï¼Œé€šå¸¸ä¸éœ€è¦åŠ é”ï¼Œå¯ä»¥ç›´æ¥è¯»å–ï¼Œå› ä¸º ConcurrentHashMap å†…éƒ¨ä½¿ç”¨äº† volatile å˜é‡æ¥ä¿è¯å†…å­˜å¯è§æ€§ã€‚</li>\n<li>å¯¹äºå†™æ“ä½œï¼ŒConcurrentHashMap ä½¿ç”¨ CAS æ“ä½œæ¥å®ç°æ— é”çš„æ›´æ–°ï¼Œè¿™æ˜¯ä¸€ç§ä¹è§‚é”çš„å®ç°ï¼Œå› ä¸ºå®ƒå‡è®¾æ²¡æœ‰å†²çªå‘ç”Ÿï¼Œåœ¨å®é™…æ›´æ–°æ•°æ®æ—¶æ‰æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹åœ¨å°è¯•ä¿®æ”¹æ•°æ®ï¼Œå¦‚æœæœ‰ï¼Œé‡‡ç”¨æ‚²è§‚çš„é”ç­–ç•¥ï¼Œå¦‚ synchronized ä»£ç å—æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€‚</li>\n<li>é‡‡ç”¨ CAS + synchronized æ¥ä¿è¯å¹¶å‘å®‰å…¨æ€§ï¼Œæ•´ä¸ªå®¹å™¨åªæœ‰ä¸€ä¸ªSegmentï¼Œå³tableæ•°ç»„ã€‚Nodeä½¿ç”¨ volatile å…³é”®å­—ï¼Œä¿è¯å¤šçº¿ç¨‹æ“ä½œæ—¶ï¼Œå˜é‡çš„å¯è§æ€§ï¼</li>\n<li>put æµç¨‹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//1. è®¡ç®— hashï¼Œéå† node æ•°ç»„ï¼Œå¦‚æœ node æ˜¯ç©ºçš„è¯ï¼Œå°±é€šè¿‡ CAS+è‡ªæ—‹çš„æ–¹å¼åˆå§‹åŒ–ã€‚\n// å‡†å¤‡åˆå§‹åŒ–\ntab = initTable();\n// å…·ä½“å®ç°\nprivate final Node&lt;K,V&gt;[] initTable() {\n    Node&lt;K,V&gt;[] tab; int sc;\n    while ((tab = table) == null || tab.length == 0) {\n        //å¦‚æœæ­£åœ¨åˆå§‹åŒ–æˆ–è€…æ‰©å®¹\n        if ((sc = sizeCtl) &lt; 0)\n            //ç­‰å¾…\n            Thread.yield(); // lost initialization race; just spin\n        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {   //CASæ“ä½œ\n            try {\n                if ((tab = table) == null || tab.length == 0) {\n                    int n = (sc &gt; 0) ? sc : DEFAULT_CAPACITY;\n                    @SuppressWarnings(\"unchecked\")\n                    Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                    table = tab = nt;\n                    sc = n - (n &gt;&gt;&gt; 2);\n                }\n            } finally {\n                sizeCtl = sc;\n            }\n            break;\n        }\n    }\n    return tab;\n}\n//2. å¦‚æœå½“å‰æ•°ç»„ä½ç½®æ˜¯ç©ºï¼Œç›´æ¥é€šè¿‡ CAS è‡ªæ—‹å†™å…¥æ•°æ®ã€‚\nstatic final &lt;K,V&gt; boolean casTabAt(Node&lt;K,V&gt;[] tab, int i,\n                                    Node&lt;K,V&gt; c, Node&lt;K,V&gt; v) {\n    return U.compareAndSwapObject(tab, ((long)i &lt;&lt; ASHIFT) + ABASE, c, v);\n}\n//3. å¦‚æœ hash==MOVEDï¼Œè¯´æ˜éœ€è¦æ‰©å®¹ã€‚\nelse if ((fh = f.hash) == MOVED)\n    tab = helpTransfer(tab, f);\n//æ‰©å®¹çš„å…·ä½“å®ç°ï¼š\nfinal Node&lt;K,V&gt;[] helpTransfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt; f) {\n    Node&lt;K,V&gt;[] nextTab; // ä¸‹ä¸€ä¸ªè¡¨çš„å¼•ç”¨ï¼Œå³æ–°çš„æ‰©å®¹åçš„æ•°ç»„\n    int sc; // ç”¨äºç¼“å­˜sizeCtlçš„å€¼\n    // æ£€æŸ¥æ¡ä»¶ï¼šä¼ å…¥çš„è¡¨ä¸ä¸ºç©ºï¼ŒèŠ‚ç‚¹fæ˜¯ForwardingNodeç±»å‹ï¼Œä¸”fä¸­çš„nextTableä¸ä¸ºç©º\n    if (tab != null &amp;&amp; (f instanceof ForwardingNode) &amp;&amp;\n        (nextTab = ((ForwardingNode&lt;K,V&gt;)f).nextTable) != null) {\n        int rs = resizeStamp(tab.length); // æ ¹æ®å½“å‰è¡¨é•¿åº¦è®¡ç®—resize stamp\n        // æ£€æŸ¥å¾ªç¯æ¡ä»¶ï¼šnextTabç­‰äºnextTableï¼Œtableç­‰äºä¼ å…¥çš„tabï¼Œä¸”sizeCtlä¸ºè´Ÿæ•°ï¼ˆè¡¨ç¤ºæ­£åœ¨è¿›è¡Œæˆ–å‡†å¤‡è¿›è¡Œæ‰©å®¹ï¼‰\n        while (nextTab == nextTable &amp;&amp; table == tab &amp;&amp;\n               (sc = sizeCtl) &lt; 0) {\n            // æ£€æŸ¥æ˜¯å¦åº”è¯¥åœæ­¢æ‰©å®¹ï¼ˆæ¯”å¦‚ï¼šresize stampä¸åŒ¹é…ï¼Œæˆ–è€…å·²è¾¾åˆ°æœ€å¤§å¹¶å‘æ‰©å®¹çº¿ç¨‹æ•°ï¼Œæˆ–è€…transferIndexå·²ç»ä¸å¤§äº0ï¼‰\n            if ((sc &gt;&gt;&gt; RESIZE_STAMP_SHIFT) != rs || sc == rs + 1 ||\n                sc == rs + MAX_RESIZERS || transferIndex &lt;= 0)\n                break;\n            // å°è¯•é€šè¿‡CASå¢åŠ sizeCtlçš„å€¼ï¼Œä»¥è¡¨ç¤ºæœ‰æ›´å¤šçº¿ç¨‹å‚ä¸æ‰©å®¹\n            if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1)) {\n                transfer(tab, nextTab); // è°ƒç”¨transferæ–¹æ³•ï¼Œå®é™…è¿›è¡Œæ•°æ®è¿ç§»\n                break;\n            }\n        }\n        return nextTab; // è¿”å›æ–°çš„è¡¨å¼•ç”¨\n    }\n    return table; // å¦‚æœä¸ç¬¦åˆæ‰©å®¹ååŠ©æ¡ä»¶ï¼Œè¿”å›å½“å‰è¡¨å¼•ç”¨\n}\n//ç¬¬å››æ­¥ï¼Œå¦‚æœéƒ½ä¸æ»¡è¶³ï¼Œå°±ä½¿ç”¨ synchronized å†™å…¥æ•°æ®ï¼Œå’Œ HashMap ä¸€æ ·ï¼Œkey çš„ hash ä¸€æ ·å°±è¦†ç›–ï¼Œåä¹‹ä½¿ç”¨æ‹‰é“¾æ³•è§£å†³å“ˆå¸Œå†²çªï¼Œå½“é“¾è¡¨é•¿åº¦è¶…è¿‡ 8 å°±è½¬æ¢æˆçº¢é»‘æ ‘ã€‚\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b9c204aae190e13fcbfd2.jpg\" alt=\"jdk7concurrenthashmapput.jpg\" tabindex=\"0\"><figcaption>jdk7concurrenthashmapput.jpg</figcaption></figure>\n<h1>56. ConcurrentHashMap æ€ä¹ˆä¿è¯å¯è§æ€§ï¼Ÿ</h1>\n<ul>\n<li>ConcurrentHashMap ä¿è¯å¯è§æ€§ä¸»è¦é€šè¿‡ä½¿ç”¨ volatile å…³é”®å­—å’Œ synchronized åŒæ­¥å—ã€‚</li>\n<li>volatile å…³é”®å­—ä¿è¯äº†å˜é‡çš„å¯è§æ€§ï¼Œå³ä¸€ä¸ªçº¿ç¨‹ä¿®æ”¹äº†ä¸€ä¸ª volatile å˜é‡åï¼Œå…¶ä»–çº¿ç¨‹å¯ä»¥ç«‹å³çœ‹åˆ°è¿™ä¸ªä¿®æ”¹ã€‚åœ¨ ConcurrentHashMap çš„å†…éƒ¨å®ç°ä¸­ï¼Œæœ‰äº›å…³é”®çš„å˜é‡è¢«å£°æ˜ä¸º volatileï¼Œæ¯”å¦‚ Segment æ•°ç»„å’Œ Node æ•°ç»„ç­‰ã€‚</li>\n<li>synchronized åŒæ­¥å—æ¥ä¿è¯å¤åˆæ“ä½œçš„åŸå­æ€§ã€‚å½“ä¸€ä¸ªçº¿ç¨‹è¿›å…¥ synchronized åŒæ­¥å—æ—¶ï¼Œå®ƒä¼šè·å¾—é”ï¼Œç„¶åæ‰§è¡ŒåŒæ­¥å—å†…çš„ä»£ç ã€‚å½“å®ƒé€€å‡º synchronized åŒæ­¥å—æ—¶ï¼Œå®ƒä¼šé‡Šæ”¾é”ï¼Œå¹¶å°†åœ¨åŒæ­¥å—å†…å¯¹å…±äº«å˜é‡çš„æ‰€æœ‰ä¿®æ”¹ç«‹å³åˆ·æ–°åˆ°ä¸»å†…å­˜ï¼Œè¿™æ ·å…¶ä»–çº¿ç¨‹å°±å¯ä»¥çœ‹åˆ°è¿™äº›ä¿®æ”¹äº†ã€‚</li>\n</ul>\n<h1>57. ä¸ºä»€ä¹ˆ ConcurrentHashMap æ¯” Hashtable æ•ˆç‡é«˜</h1>\n<ul>\n<li>Hashtable åœ¨ä»»ä½•æ—¶åˆ»åªå…è®¸ä¸€ä¸ªçº¿ç¨‹è®¿é—®æ•´ä¸ª Mapï¼Œé€šè¿‡å¯¹æ•´ä¸ª Map åŠ é”æ¥å®ç°çº¿ç¨‹å®‰å…¨ã€‚</li>\n<li>ConcurrentHashMapï¼ˆå°¤å…¶JDK8åï¼‰é€šè¿‡é”åˆ†ç¦»å’Œ CAS æ“ä½œå®ç°æ›´ç»†ç²’åº¦çš„é”å®šç­–ç•¥ï¼Œå…è®¸æ›´é«˜çš„å¹¶å‘ã€‚</li>\n<li>CAS æ“ä½œæ˜¯ä¹è§‚é”ï¼Œå®ƒä¸ä¼šé˜»å¡çº¿ç¨‹ï¼Œè€Œæ˜¯åœ¨æ›´æ–°æ—¶æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–çº¿ç¨‹å·²ç»ä¿®æ”¹äº†æ•°æ®ï¼Œå¦‚æœæ²¡æœ‰å°±æ›´æ–°ï¼Œå¦‚æœæœ‰å°±é‡è¯•ã€‚ConcurrentHashMap å…è®¸å¤šä¸ªè¯»æ“ä½œå¹¶å‘è¿›è¡Œè€Œä¸åŠ é”ï¼Œå› ä¸ºå®ƒé€šè¿‡ volatile å˜é‡æ¥ä¿è¯è¯»å–æ“ä½œçš„å†…å­˜å¯è§æ€§ã€‚ç›¸æ¯”ä¹‹ä¸‹ï¼ŒHashtable å¯¹è¯»æ“ä½œä¹ŸåŠ é”ï¼Œå¢åŠ äº†å¼€é”€</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>static final &lt;K,V&gt; boolean casTabAt(Node&lt;K,V&gt;[] tab, int i,\n                                    Node&lt;K,V&gt; c, Node&lt;K,V&gt; v) {\n    return U.compareAndSwapObject(tab, ((long)i &lt;&lt; ASHIFT) + ABASE, c, v);\n}\n\npublic V get(Object key) {\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; e, p; int n, eh; K ek;\n\t// 1. é‡hash\n    int h = spread(key.hashCode());\n    if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;\n        (e = tabAt(tab, (n - 1) &amp; h)) != null) {\n        // 2. table[i]æ¡¶èŠ‚ç‚¹çš„keyä¸æŸ¥æ‰¾çš„keyç›¸åŒï¼Œåˆ™ç›´æ¥è¿”å›\n\t\tif ((eh = e.hash) == h) {\n            if ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek)))\n                return e.val;\n        }\n\t\t// 3. å½“å‰èŠ‚ç‚¹hashå°äº0è¯´æ˜ä¸ºæ ‘èŠ‚ç‚¹ï¼Œåœ¨çº¢é»‘æ ‘ä¸­æŸ¥æ‰¾å³å¯\n        else if (eh &lt; 0)\n            return (p = e.find(h, key)) != null ? p.val : null;\n        while ((e = e.next) != null) {\n\t\t//4. ä»é“¾è¡¨ä¸­æŸ¥æ‰¾ï¼ŒæŸ¥æ‰¾åˆ°åˆ™è¿”å›è¯¥èŠ‚ç‚¹çš„valueï¼Œå¦åˆ™å°±è¿”å›nullå³å¯\n            if (e.hash == h &amp;&amp;\n                ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek))))\n                return e.val;\n        }\n    }\n    return null;\n}\n</code></pre></div><h1>58. CountDownLatchâˆš</h1>\n<ul>\n<li>CountDownLatchå…è®¸ä¸€ä¸ªæˆ–å¤šä¸ªçº¿ç¨‹ç­‰å¾…å…¶ä»–çº¿ç¨‹å®Œæˆæ“ä½œã€‚</li>\n<li>åœºæ™¯ï¼š\n<ul>\n<li>åè°ƒå­çº¿ç¨‹ç»“æŸåŠ¨ä½œï¼šç­‰å¾…æ‰€æœ‰å­çº¿ç¨‹è¿è¡Œç»“æŸ</li>\n<li>åè°ƒå­çº¿ç¨‹å¼€å§‹åŠ¨ä½œï¼šç»Ÿä¸€å„çº¿ç¨‹åŠ¨ä½œå¼€å§‹çš„æ—¶æœº</li>\n<li>å¤šçº¿ç¨‹è§£æä¸€ä¸ªExcelé‡Œå¤šä¸ªsheetçš„æ•°æ®ï¼ˆæˆ–è€…ä½¿ç”¨joinï¼‰</li>\n</ul>\n</li>\n<li>CountDownLatchçš„æ„é€ å‡½æ•°æ¥ä¼ å…¥countDownè°ƒç”¨æ¬¡æ•°nã€‚ç›´åˆ°countDownè°ƒç”¨æ¬¡æ•°è¾¾åˆ°nï¼Œæ‰ä»awaitæ–¹æ³•è¿”å›</li>\n<li>CountDownLatchä¸èƒ½é‡æ–°åˆå§‹åŒ–æˆ–è€…ä¿®æ”¹CountDownLatchå¯¹è±¡çš„å†…éƒ¨è®¡æ•°å™¨çš„å€¼ã€‚ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨countDownæ–¹æ³•happen-beforeï¼Œå¦å¤–ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨awaitæ–¹æ³•</li>\n</ul>\n<h1>59. CyclicBarrieråŒæ­¥å±éšœ</h1>\n<ul>\n<li>CyclicBarrieræ„é€ æ–¹æ³•ä¼ å…¥å±éšœæ‹¦æˆªçš„çº¿ç¨‹æ•°é‡nï¼Œç›´åˆ°awaitè°ƒç”¨æ¬¡æ•°è¾¾åˆ°nï¼Œæ‰ä»awaitæ–¹æ³•è¿”å›ç»§ç»­æ‰§è¡Œ</li>\n<li>æ„é€ å‡½æ•°CyclicBarrierï¼ˆint partiesï¼ŒRunnable barrierActionï¼‰ï¼Œç”¨äºåœ¨çº¿ç¨‹åˆ°è¾¾å±éšœæ—¶ï¼Œä¼˜å…ˆæ‰§è¡ŒbarrierAction</li>\n<li>CyclicBarrierå¯ä»¥ç”¨äºå¤šçº¿ç¨‹è®¡ç®—æ•°æ®ï¼Œæœ€ååˆå¹¶è®¡ç®—ç»“æœçš„åœºæ™¯</li>\n<li>CyclicBarrierå¯ä»¥é‡å¤åˆ©ç”¨</li>\n</ul>\n<h1>60. CycliBarriar å’Œ CountdownLatch æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>\n<p>éƒ½æ˜¯ç”¨äºæ§åˆ¶å¹¶å‘çš„å·¥å…·ç±»ï¼Œéƒ½å¯ä»¥å®ç°è®©ä¸€æ®µç¨‹åºå¹¶å‘çš„æ‰§è¡Œï¼Œå¹¶æœ€ç»ˆæ±‡æ€»ç»“æœ</p>\n</li>\n<li>\n<p>CyclicBarrieræ˜¯å¯é‡ç”¨çš„ï¼Œå…¶ä¸­çš„çº¿ç¨‹ä¼šç­‰å¾…æ‰€æœ‰çš„çº¿ç¨‹å®Œæˆä»»åŠ¡ã€‚å±Šæ—¶ï¼Œå±éšœå°†è¢«æ‹†é™¤ï¼Œå¹¶å¯ä»¥é€‰æ‹©æ€§åœ°åšä¸€äº›ç‰¹å®šçš„åŠ¨ä½œï¼›CountDownLatchæ˜¯ä¸€æ¬¡æ€§çš„ï¼Œä¸åŒçš„çº¿ç¨‹åœ¨åŒä¸€ä¸ªè®¡æ•°å™¨ä¸Šå·¥ä½œï¼Œç›´åˆ°è®¡æ•°å™¨ä¸º0</p>\n</li>\n<li>\n<p>CyclicBarrieré¢å‘çš„æ˜¯çº¿ç¨‹æ•°\tCountDownLatché¢å‘çš„æ˜¯ä»»åŠ¡æ•°</p>\n</li>\n<li>\n<p>åœ¨ä½¿ç”¨CyclicBarrieræ—¶ï¼Œä½ å¿…é¡»åœ¨æ„é€ ä¸­æŒ‡å®šå‚ä¸åä½œçš„çº¿ç¨‹æ•°ï¼Œè¿™äº›çº¿ç¨‹å¿…é¡»è°ƒç”¨await()æ–¹æ³•\tä½¿ç”¨CountDownLatchæ—¶ï¼Œåˆ™å¿…é¡»è¦æŒ‡å®šä»»åŠ¡æ•°ï¼Œè‡³äºè¿™äº›ä»»åŠ¡ç”±å“ªäº›çº¿ç¨‹å®Œæˆæ— å…³ç´§è¦</p>\n</li>\n<li>\n<p>CyclicBarrierå¯ä»¥åœ¨æ‰€æœ‰çš„çº¿ç¨‹é‡Šæ”¾åé‡æ–°ä½¿ç”¨\tCountDownLatchåœ¨è®¡æ•°å™¨ä¸º0æ—¶ä¸èƒ½å†ä½¿ç”¨</p>\n</li>\n<li>\n<p>åœ¨CyclicBarrierä¸­ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹é‡åˆ°äº†ä¸­æ–­ã€è¶…æ—¶ç­‰é—®é¢˜æ—¶ï¼Œåˆ™å¤„äºawaitçš„çº¿ç¨‹éƒ½ä¼šå‡ºç°é—®é¢˜\tåœ¨CountDownLatchä¸­ï¼Œå¦‚æœæŸä¸ªçº¿ç¨‹å‡ºç°é—®é¢˜ï¼Œå…¶ä»–çº¿ç¨‹ä¸å—å½±å“</p>\n</li>\n<li>\n<p>CyclicBarrier ä¸­çš„å„ä¸ªçº¿ç¨‹å¯ä»¥ç­‰å¾…å…¶ä»–çº¿ç¨‹ï¼›CountDownLatchä¸­çš„å„ä¸ªå­çº¿ç¨‹ä¸å¯ä»¥ç­‰å¾…å…¶ä»–çº¿ç¨‹ï¼Œåªèƒ½å®Œæˆè‡ªå·±çš„ä»»åŠ¡</p>\n</li>\n<li>\n<p>CountDownLatchä½¿ç”¨å‡æ•°æ–¹å¼ç›´è‡³è®¡æ•°ä¸º0æ—¶é‡Šæ”¾æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼ŒCyclicBarrierä½¿ç”¨åŠ æ•°æ–¹å¼ç›´è‡³è®¡æ•°ä¸ºæŒ‡å®šæ—¶é‡Šæ”¾æ‰€æœ‰ç­‰å¾…çº¿ç¨‹ï¼Œå¹¶ä¸”é‡ç½®ä¸º0ï¼Œè¿˜å¯æŒ‡å®šåˆ°è¾¾æ …æ åä¼˜å…ˆæ‰§è¡Œçš„ä»»åŠ¡ï¼Œå¦‚æœè®¡ç®—å‘ç”Ÿé”™è¯¯ï¼Œå¯ä»¥reseté‡ç½®è®¡æ•°å™¨ï¼Œå¹¶è®©çº¿ç¨‹é‡æ–°æ‰§è¡Œä¸€æ¬¡ã€‚</p>\n</li>\n<li>\n<p>CountDownLatchè°ƒç”¨countDown()æ–¹æ³•è®¡æ•°å‡ä¸€ï¼Œè°ƒç”¨await()æ–¹æ³•åªè¿›è¡Œé˜»å¡ï¼Œå¯¹è®¡æ•°æ²¡å½±å“ï¼›CyclicBarrierè°ƒç”¨await()æ–¹æ³•è®¡æ•°åŠ 1 ï¼Œè‹¥åŠ 1åçš„å€¼ä¸ç­‰äºæ„é€ æ–¹æ³•çš„å€¼ï¼Œåˆ™çº¿ç¨‹é˜»å¡</p>\n</li>\n<li>\n<p>CountDownLatchå¼ºè°ƒä¸€ä¸ªçº¿ç¨‹ç­‰å¤šä¸ªçº¿ç¨‹å®ŒæˆæŸä»¶äº‹æƒ…ã€‚CyclicBarrieræ˜¯å¤šä¸ªçº¿ç¨‹äº’ç­‰ï¼Œç­‰å¤§å®¶éƒ½å®Œæˆï¼Œå†æºæ‰‹å…±è¿›</p>\n</li>\n</ul>\n<h1>61. æ§åˆ¶å¹¶å‘çº¿ç¨‹æ•°çš„Semaphore</h1>\n<ul>\n<li>Semaphoreï¼ˆä¿¡å·é‡ï¼‰æ˜¯ç”¨æ¥æ§åˆ¶åŒæ—¶è®¿é—®ç‰¹å®šèµ„æºçš„çº¿ç¨‹æ•°é‡</li>\n<li>åœºæ™¯ï¼šæµé‡æ§åˆ¶ï¼Œå…¬ç”¨èµ„æºæœ‰é™çš„åº”ç”¨åœºæ™¯ï¼Œæ¯”å¦‚æ•°æ®åº“è¿æ¥ã€‚</li>\n<li>Semaphoreçš„acquire()æ–¹æ³•è·å–ä¸€ä¸ªè®¸å¯è¯ï¼Œä½¿ç”¨å®Œä¹‹åè°ƒç”¨release()æ–¹æ³•å½’è¿˜è®¸å¯è¯ã€‚è¿˜å¯ä»¥ç”¨tryAcquire()æ–¹æ³•å°è¯•è·å–è®¸å¯è¯ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SemaphoreTest {\n    private static final int THREAD_COUNT = 30;\n    private static ExecutorService threadPool = Executors.newFixedThreadPool(THREAD_COUNT);\n    private static Semaphore s = new Semaphore(10);\n\n    public static void main(String[] args) {\n        for (int i = 0; i &lt; THREAD_COUNT; i++) {\n            threadPool.execute(new Runnable() {\n                @Override\n                public void run() {\n                    try {\n                        s.acquire();\n                        System.out.println(\"save data\");\n                        s.release();\n                    } catch (InterruptedException e) {\n                    }\n                }\n            });\n        }\n        threadPool.shutdown();\n    }\n}\n\n</code></pre></div><h1>62. Exchanger</h1>\n<ul>\n<li>Exchangerç”¨äºè¿›è¡Œçº¿ç¨‹é—´çš„æ•°æ®äº¤æ¢ã€‚å®ƒæä¾›ä¸€ä¸ªåŒæ­¥ç‚¹ä½¿å¾—ä¸¤ä¸ªçº¿ç¨‹å¯ä»¥é€šè¿‡exchangeæ–¹æ³•äº¤æ¢å½¼æ­¤çš„æ•°æ®ï¼Œå¦‚æœç¬¬ä¸€ä¸ªçº¿ç¨‹å…ˆæ‰§è¡Œexchange()æ–¹æ³•ï¼Œå®ƒä¼šä¸€ç›´ç­‰å¾…ç¬¬äºŒä¸ªçº¿ç¨‹ä¹Ÿæ‰§è¡Œexchangeæ–¹æ³•ï¼Œå½“ä¸¤ä¸ªçº¿ç¨‹éƒ½åˆ°è¾¾åŒæ­¥ç‚¹æ—¶ï¼Œè¿™ä¸¤ä¸ªçº¿ç¨‹å°±å¯ä»¥äº¤æ¢æ•°æ®ï¼Œå°†æœ¬çº¿ç¨‹ç”Ÿäº§å‡ºæ¥çš„æ•°æ®ä¼ é€’ç»™å¯¹æ–¹ã€‚ä¸ºäº†é¿å…ä¸€ç›´ç­‰å¾…ï¼Œå¯ä»¥ä½¿ç”¨exchange(V x, long timeOut, TimeUnit unit) è®¾ç½®æœ€å¤§ç­‰å¾…æ—¶é•¿ã€‚</li>\n<li>åœºæ™¯</li>\n<li>é—ä¼ ç®—æ³•ï¼Œé€‰å‡ºä¸¤ä¸ªäººä½œä¸ºäº¤é…å¯¹è±¡ï¼Œè¿™æ—¶å€™ä¼šäº¤æ¢ä¸¤äººçš„æ•°æ®ï¼Œå¹¶ä½¿ç”¨äº¤å‰è§„åˆ™å¾—å‡º2ä¸ªäº¤é…ç»“æœã€‚</li>\n<li>æ ¡å¯¹å·¥ä½œï¼Œæ¯”å¦‚çº¸åˆ¶é“¶è¡Œæµæ°´é€šè¿‡äººå·¥çš„æ–¹å¼å½•å…¥æˆç”µå­é“¶è¡Œæµæ°´ï¼Œä¸ºäº†é¿å…é”™è¯¯ï¼Œé‡‡ç”¨ABå²—ä¸¤äººè¿›è¡Œå½•å…¥ï¼Œå¹¶çœ‹çœ‹ä¸¤ä¸ªExcelæ•°æ®æ˜¯å¦å½•å…¥ä¸€è‡´</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ExchangerTest {\n    private static final Exchanger&lt;String&gt; exgr = new Exchanger&lt;String&gt;();\n    private static ExecutorService threadPool = Executors.newFixedThreadPool(2);\n\n    public static void main(String[] args) {\n        threadPool.execute(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    String A = \"é“¶è¡Œæµæ°´A\"; // Aå½•å…¥é“¶è¡Œæµæ°´æ•°æ®\n                    exgr.exchange(A);\n                } catch (InterruptedException e) {\n                }\n            }\n        });\n        threadPool.execute(new Runnable() {\n            @Override\n            public void run() {\n                try {\n                    String B = \"é“¶è¡Œæµæ°´B\"; // Bå½•å…¥é“¶è¡Œæµæ°´æ•°æ®\n                    String A = exgr.exchange(\"B\");\n                    System.out.println(\"Aå’ŒBæ•°æ®æ˜¯å¦ä¸€è‡´ï¼š\" + A.equals(B) + \"ï¼ŒAå½•å…¥çš„æ˜¯ï¼š\"\n                            + A + \"ï¼ŒBå½•å…¥æ˜¯ï¼š\" + B);\n                } catch (InterruptedException e) {\n                }\n            }\n        });\n        threadPool.shutdown();\n    }\n}\n</code></pre></div><h1>63. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨çº¿ç¨‹æ± ï¼Ÿ</h1>\n<ul>\n<li>é™ä½èµ„æºæ¶ˆè€—ï¼šé€šè¿‡é‡å¤åˆ©ç”¨å·²åˆ›å»ºçš„çº¿ç¨‹é™ä½é¢‘ç¹çº¿ç¨‹åˆ›å»ºå’Œé”€æ¯é€ æˆçš„æ¶ˆè€—</li>\n<li>æé«˜å“åº”é€Ÿåº¦ï¼šå½“ä»»åŠ¡åˆ°è¾¾æ—¶ï¼Œä»»åŠ¡å¯ä»¥ä¸éœ€è¦çš„ç­‰åˆ°çº¿ç¨‹åˆ›å»ºå°±èƒ½ç«‹å³æ‰§è¡Œ</li>\n<li>çº¿ç¨‹æ± æ”¯æŒå®šæ—¶æ‰§è¡Œã€å‘¨æœŸæ€§æ‰§è¡Œã€å•çº¿ç¨‹æ‰§è¡Œå’Œå¹¶å‘æ•°æ§åˆ¶ç­‰åŠŸèƒ½</li>\n</ul>\n<h1>64. çº¿ç¨‹æ± çš„åº”ç”¨ï¼Ÿ</h1>\n<ul>\n<li>å¤šçº¿ç¨‹å‘é€çŸ­ä¿¡ï¼Œå…¬ä¼—å·æ¶ˆæ¯</li>\n<li>å¤„ç†9å›¾gif</li>\n<li>ä¿å­˜ç§å¯†æ–‡ä»¶(å¤´åƒã€èº«ä»½è¯)</li>\n</ul>\n<h1>65. çº¿ç¨‹æ± çš„å¤„ç†æµç¨‹âˆš</h1>\n<ul>\n<li>å¦‚æœå½“å‰æ± ä¸­çº¿ç¨‹æ•°å°äºcorePoolSizeï¼Œåˆ™åˆ›å»ºä¸€ä¸ªçº¿ç¨‹æ‰§è¡Œè¯¥ä»»åŠ¡,å³ä½¿å½“å‰æ ¸å¿ƒçº¿ç¨‹æ± æœ‰ç©ºé—²çš„çº¿ç¨‹ã€‚</li>\n<li>å¦‚æœå½“å‰çº¿ç¨‹æ± ä¸­çº¿ç¨‹æ•°å·²ç»è¾¾åˆ° corePoolSizeï¼Œåˆ™å°†ä»»åŠ¡æ”¾å…¥ç­‰å¾…é˜Ÿåˆ—ã€‚</li>\n<li>å¦‚æœä»»åŠ¡ç­‰å¾…é˜Ÿåˆ—å·²æ»¡ï¼Œè‹¥å½“å‰æ± ä¸­çº¿ç¨‹æ•°å°äºmaximumPoolSizeï¼Œåˆ™åˆ›å»ºä¸€ä¸ªä¸´æ—¶çº¿ç¨‹æ‰§è¡Œè¯¥ä»»åŠ¡ã€‚</li>\n<li>å¦‚æœå½“å‰æ± ä¸­çº¿ç¨‹æ•°å·²ç»ç­‰äºmaximumPoolSizeï¼Œæ­¤æ—¶æ— æ³•æ‰§è¡Œè¯¥ä»»åŠ¡ï¼Œæ ¹æ®æ‹’ç»æ‰§è¡Œç­–ç•¥å¤„ç†ã€‚</li>\n<li>ç©ºé—²çš„çº¿ç¨‹ä¼šä»ä»»åŠ¡é˜Ÿåˆ—ä¸­å–å‡ºä»»åŠ¡æ¥æ‰§è¡Œï¼Œå½“ä»»åŠ¡æ‰§è¡Œå®Œæ¯•åï¼Œçº¿ç¨‹å¹¶ä¸ä¼šç«‹å³é”€æ¯ï¼Œè€Œæ˜¯ç»§ç»­ä¿æŒåœ¨æ± ä¸­ç­‰å¾…ä¸‹ä¸€ä¸ªä»»åŠ¡ã€‚</li>\n<li>å½“çº¿ç¨‹ç©ºé—²æ—¶é—´è¶…å‡ºæŒ‡å®šæ—¶é—´ï¼Œä¸”å½“å‰çº¿ç¨‹æ•°é‡å¤§äºæ ¸å¿ƒçº¿ç¨‹æ•°æ—¶ï¼Œçº¿ç¨‹ä¼šè¢«å›æ”¶ã€‚</li>\n</ul>\n<h1>66. å¦‚ä½•åˆ›å»ºçº¿ç¨‹æ± ï¼Ÿçº¿ç¨‹æ± å¸¸ç”¨å‚æ•°?âˆš</h1>\n<p>é€šè¿‡ThreadPoolExecutoræ„é€ æ–¹æ³•,å‚æ•°å¦‚ä¸‹</p>\n<ul>\n<li>corePoolSizeæ ¸å¿ƒæ± å¤§å°ã€‚å³ä½¿è¿™äº›çº¿ç¨‹å¤„äºç©ºé—²çŠ¶æ€ï¼Œå®ƒä»¬ä¹Ÿä¸ä¼šè¢«å›æ”¶.çº¿ç¨‹æ± ä¿æŒåœ¨ç­‰å¾…çŠ¶æ€ä¸‹çš„çº¿ç¨‹æ•°ã€‚</li>\n<li>maximumPoolSizeå…è®¸çš„æœ€å¤§çº¿ç¨‹æ•°ï¼Œå½“å·¥ä½œé˜Ÿåˆ—æ»¡äº†ä¹‹åï¼Œçº¿ç¨‹æ± ä¼šåˆ›å»ºæ–°çº¿ç¨‹æ¥å¤„ç†ä»»åŠ¡ï¼Œç›´åˆ°çº¿ç¨‹æ•°è¾¾åˆ°è¿™ä¸ªæœ€å¤§å€¼</li>\n<li>workQueueç”¨äºä¿å­˜ä»»åŠ¡çš„é˜»å¡é˜Ÿåˆ—,æ¨èä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ã€‚</li>\n<li>RejectedExecutionHandleræ‹’ç»ç­–ç•¥ã€‚å®šä¹‰äº†å½“çº¿ç¨‹æ± å’Œå·¥ä½œé˜Ÿåˆ—éƒ½æ»¡äº†ä¹‹åå¯¹æ–°æäº¤çš„ä»»åŠ¡çš„å¤„ç†ç­–ç•¥ã€‚</li>\n<li>keepAliveTimeç©ºé—²çº¿ç¨‹ç©ºé—²å­˜æ´»æ—¶é—´ã€‚å¦‚æœçº¿ç¨‹æ± ä¸­çš„çº¿ç¨‹æ•°é‡è¶…è¿‡äº†corePoolSizeï¼Œé‚£ä¹ˆè¿™äº›å¤šä½™çš„çº¿ç¨‹åœ¨ç©ºé—²æ—¶é—´è¶…è¿‡keepAliveTimeæ—¶ä¼šè¢«ç»ˆæ­¢ã€‚å¦‚æœä»»åŠ¡å¾ˆå¤šï¼Œå¹¶ä¸”æ¯ä¸ªä»»åŠ¡æ‰§è¡Œçš„æ—¶é—´æ¯”è¾ƒçŸ­ï¼Œå¯ä»¥è°ƒå¤§æ—¶é—´ï¼Œæé«˜çº¿ç¨‹çš„åˆ©ç”¨ç‡ã€‚</li>\n<li>unit keepAliveTimeå‚æ•°çš„å•ä½ï¼Œå¦‚ï¼šæ¯«ç§’ã€ç§’ã€‚</li>\n<li>threadFactoryåˆ›å»ºçº¿ç¨‹çš„å·¥ç¨‹ç±»ã€‚æŒ‡å®šçº¿ç¨‹å·¥å‚ä¸ºæ¯ä¸ªåˆ›å»ºå‡ºæ¥çš„çº¿ç¨‹è®¾ç½®æ›´æœ‰æ„ä¹‰çš„åå­—ï¼Œæ–¹ä¾¿æŸ¥æ‰¾å¹¶å‘é—®é¢˜åŸå› </li>\n</ul>\n<h1>67. æ‹’ç»ç­–ç•¥?âˆš</h1>\n<ul>\n<li>AbortPolicyï¼šæŠ›å‡º RejectedExecutionExceptionæ¥æ‹’ç»æ–°ä»»åŠ¡çš„å¤„ç†(é»˜è®¤)</li>\n<li>CallerRunsPolicyï¼šä½¿ç”¨å½“å‰çº¿ç¨‹æ‰§è¡Œä»»åŠ¡ï¼Œå¯èƒ½ä¼šé˜»å¡ä¸»çº¿ç¨‹</li>\n<li>DiscardOldestPolicyï¼š ä¸¢å¼ƒåœ¨é˜Ÿåˆ—ä¸­é˜Ÿé¦–çš„ä»»åŠ¡ï¼Œå¹¶æ‰§è¡Œå½“å‰ä»»åŠ¡ã€‚</li>\n<li>DiscardPolicyï¼šç›´æ¥ä¸¢å¼ƒåæ¥çš„ä»»åŠ¡</li>\n<li>å®ç°RejectedExecutionHandleræ¥å£è‡ªå®šä¹‰ç­–ç•¥ã€‚å¦‚è®°å½•æ—¥å¿—æˆ–æŒä¹…åŒ–å­˜å‚¨ä¸èƒ½å¤„ç†çš„ä»»åŠ¡ã€‚</li>\n</ul>\n<h1>68. çº¿ç¨‹æ± çš„é˜»å¡é˜Ÿåˆ—</h1>\n<ul>\n<li>BlockingQueue:æ˜¯ä¸€ä¸ªæ”¯æŒä¸¤ä¸ªé™„åŠ æ“ä½œçš„é˜»å¡é˜Ÿåˆ—ï¼šåœ¨é˜Ÿåˆ—ä¸ºç©ºæ—¶ï¼Œè·å–å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—ï¼ˆé˜»å¡ï¼‰å˜ä¸ºéç©ºã€‚å½“é˜Ÿåˆ—æ»¡æ—¶ï¼Œå­˜å‚¨å…ƒç´ çš„çº¿ç¨‹ä¼šç­‰å¾…é˜Ÿåˆ—å¯ç”¨ï¼ˆé˜»å¡ï¼‰\n<ul>\n<li>å¸¸ç”¨äºç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åœºæ™¯ï¼Œç”Ÿäº§è€…æ˜¯å¾€é˜Ÿåˆ—é‡Œæ·»åŠ å…ƒç´ çš„çº¿ç¨‹ï¼Œæ¶ˆè´¹è€…æ˜¯ä»é˜Ÿåˆ—é‡Œæ‹¿å…ƒç´ çš„çº¿ç¨‹ã€‚é˜»å¡é˜Ÿåˆ—å°±æ˜¯ç”Ÿäº§è€…å­˜æ”¾å…ƒç´ çš„å®¹å™¨ï¼Œè€Œæ¶ˆè´¹è€…ä¹Ÿåªä»å®¹å™¨é‡Œæ‹¿å…ƒç´ </li>\n<li>å¸¸ç”¨äºsocketå®¢æˆ·ç«¯æ•°æ®çš„è¯»å–å’Œè§£æçš„åœºæ™¯ï¼Œè¯»å–æ•°æ®çš„çº¿ç¨‹ä¸æ–­å°†æ•°æ®æ”¾å…¥é˜Ÿåˆ—ï¼Œç„¶åè§£æçº¿ç¨‹ä¸æ–­ä»é˜Ÿåˆ—å–æ•°æ®è§£æ</li>\n</ul>\n</li>\n<li>ArrayBlockingQueueï¼šç”¨æ•°ç»„å®ç°çš„æœ‰ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œæœ‰åºï¼ŒæŒ‰FIFOæ’åºé‡ã€‚ä¸ä¿è¯çº¿ç¨‹å…¬å¹³çš„è®¿é—®é˜Ÿåˆ—</li>\n<li>LinkedBlockingQueueï¼šæ˜¯åŸºäºé“¾è¡¨ç»“æ„çš„é˜»å¡é˜Ÿåˆ—ï¼ŒæŒ‰FIFOæ’åºä»»åŠ¡ï¼Œå®¹é‡å¯ä»¥é€‰æ‹©è¿›è¡Œè®¾ç½®ï¼Œä¸è®¾ç½®çš„è¯ï¼Œå°†æ˜¯ä¸€ä¸ªæ— è¾¹ç•Œçš„é˜»å¡é˜Ÿåˆ—ï¼Œæœ€å¤§é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œååé‡é€šå¸¸è¦é«˜äºArrayBlockingQueneï¼›</li>\n<li>DelayQueueï¼ˆå»¶è¿Ÿé˜Ÿåˆ—ï¼‰æ˜¯ä¸€ä¸ªä»»åŠ¡å®šæ—¶å‘¨æœŸçš„å»¶è¿Ÿæ‰§è¡Œçš„é˜Ÿåˆ—ã€‚æ ¹æ®æŒ‡å®šçš„æ‰§è¡Œæ—¶é—´ä»å°åˆ°å¤§æ’åºï¼Œå¦åˆ™æ ¹æ®æ’å…¥åˆ°é˜Ÿåˆ—çš„å…ˆåæ’åºã€‚newScheduledThreadPoolçº¿ç¨‹æ± ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚é˜Ÿåˆ—ä¸­çš„å…ƒç´ å¿…é¡»å®ç°Delayedæ¥å£ï¼Œåœ¨åˆ›å»ºå…ƒç´ æ—¶å¯ä»¥æŒ‡å®šå¤šä¹…æ‰èƒ½ä»é˜Ÿåˆ—ä¸­è·å–å½“å‰å…ƒç´ ã€‚åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡æ—¶æ‰èƒ½ä»é˜Ÿåˆ—ä¸­æå–å…ƒç´ ã€‚\n<ul>\n<li>ç¼“å­˜ç³»ç»Ÿçš„è®¾è®¡ï¼šDelayQueueä¿å­˜ç¼“å­˜å…ƒç´ çš„æœ‰æ•ˆæœŸï¼Œä½¿ç”¨ä¸€ä¸ªçº¿ç¨‹å¾ªç¯æŸ¥è¯¢DelayQueueï¼Œä¸€æ—¦èƒ½ä»DelayQueueä¸­è·å–å…ƒç´ æ—¶ï¼Œè¡¨ç¤ºç¼“å­˜æœ‰æ•ˆæœŸåˆ°äº†ã€‚</li>\n<li>å®šæ—¶ä»»åŠ¡è°ƒåº¦ï¼šDelayQueueä¿å­˜æ‰§è¡Œçš„ä»»åŠ¡å’Œæ‰§è¡Œæ—¶é—´ï¼Œä¸€æ—¦ä»DelayQueueä¸­è·å–åˆ°ä»»åŠ¡å°±æ‰§è¡Œï¼Œæ¯”å¦‚TimerQueueå°±æ˜¯ä½¿ç”¨DelayQueueå®ç°çš„</li>\n</ul>\n</li>\n<li>PriorityBlockingQueueï¼ˆä¼˜å…ˆçº§é˜Ÿåˆ—ï¼‰æ˜¯å…·æœ‰ä¼˜å…ˆçº§çš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ï¼Œä¸èƒ½ä¿è¯åŒä¼˜å…ˆçº§å…ƒç´ çš„é¡ºåº</li>\n<li>SynchronousQueueï¼ˆåŒæ­¥é˜Ÿåˆ—ï¼‰æ˜¯ä¸€ä¸ªä¸å­˜å‚¨å…ƒç´ çš„é˜»å¡é˜Ÿåˆ—ï¼Œæ¯ä¸ªæ’å…¥putæ“ä½œå¿…é¡»ç­‰åˆ°å¦ä¸€ä¸ªçº¿ç¨‹è°ƒç”¨ç§»é™¤takeæ“ä½œï¼Œå¦åˆ™æ’å…¥æ“ä½œä¸€ç›´å¤„äºé˜»å¡çŠ¶æ€ï¼Œååé‡é€šå¸¸è¦é«˜äºLinkedBlockingQueneï¼ŒnewCachedThreadPoolçº¿ç¨‹æ± ä½¿ç”¨äº†è¿™ä¸ªé˜Ÿåˆ—ã€‚</li>\n<li>LinkedTransferQueueï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„æ— ç•Œé˜»å¡é˜Ÿåˆ—ã€‚</li>\n<li>LinkedBlockingDequeï¼šä¸€ä¸ªç”±é“¾è¡¨ç»“æ„ç»„æˆçš„åŒå‘é˜»å¡é˜Ÿåˆ—ã€‚</li>\n</ul>\n<h1>69. Runnable å’Œ Callable æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿâˆš</h1>\n<ul>\n<li>Runnableæ¥å£ä¸­çš„run()æ–¹æ³•æ— è¿”å›å€¼ï¼Œåªæ˜¯æ‰§è¡Œrun()æ–¹æ³•ä¸­çš„ä»£ç ï¼Œä¸èƒ½æŠ›å¼‚å¸¸</li>\n<li>Callableæ¥å£ä¸­çš„call()æ–¹æ³•è¿”å›å€¼æ˜¯æ³›å‹ï¼Œèƒ½æŠ›å‡ºå¼‚å¸¸ï¼Œå’ŒFutureã€FutureTaské…åˆå¯ç”¨æ¥è·å–å¼‚æ­¥æ‰§è¡Œçš„ç»“æœ</li>\n</ul>\n<h1>70. æ‰§è¡Œexecute()å’Œsubmit()æ–¹æ³•çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>execute(Runnable command)åªèƒ½æäº¤Runnableç±»å‹çš„ä»»åŠ¡ï¼Œæ— æ³•åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¢«çº¿ç¨‹æ± æ‰§è¡ŒæˆåŠŸä¸å¦ï¼›ç”¨äºæäº¤ä¸éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡</li>\n<li>submit(Runnable&nbsp;task)å’Œsubmit(Callable&nbsp;task)ç”¨äºæäº¤éœ€è¦è¿”å›å€¼çš„ä»»åŠ¡ã€æ—¢èƒ½æäº¤Runnableç±»å‹ä»»åŠ¡ä¹Ÿèƒ½æäº¤Callableç±»å‹ä»»åŠ¡ã€‚å¯ä»¥é€šè¿‡Futureçš„get()æ–¹æ³•é˜»å¡å½“å‰çº¿ç¨‹ç›´åˆ°ä»»åŠ¡å®Œæˆå¹¶è·å–è¿”å›å€¼ï¼Œä½¿ç”¨getï¼ˆlong timeoutï¼ŒTimeUnit unitï¼‰æ–¹æ³•åˆ™ä¼šé˜»å¡å½“å‰çº¿ç¨‹ä¸€æ®µæ—¶é—´åç«‹å³è¿”å›ï¼ˆæœ‰å¯èƒ½ä»»åŠ¡æ²¡æœ‰æ‰§è¡Œå®Œï¼‰ã€‚</li>\n</ul>\n<h1>71. çº¿ç¨‹æ± çš„å…³é—­</h1>\n<ul>\n<li>shutdownå’ŒshutdownNowæ–¹æ³•,åŸç†éƒ½æ˜¯éå†çº¿ç¨‹æ± ä¸­æ‰€æœ‰çš„çº¿ç¨‹ï¼Œç„¶åä¾æ¬¡è°ƒç”¨interruptæ–¹æ³•ä¸­æ–­çº¿ç¨‹ã€‚æ— æ³•å“åº”ä¸­æ–­çš„ä»»åŠ¡å¯èƒ½æ°¸è¿œæ— æ³•ç»ˆæ­¢</li>\n<li>shutdown() å°†çº¿ç¨‹æ± çŠ¶æ€ç½®ä¸º shutdown,å¹¶ä¸ä¼šç«‹å³åœæ­¢ï¼Œé¦–å…ˆåœæ­¢æ¥æ”¶å¤–éƒ¨ submit çš„ä»»åŠ¡ï¼Œç›´åˆ°å†…éƒ¨æ­£åœ¨è·‘çš„ä»»åŠ¡å’Œé˜Ÿåˆ—é‡Œç­‰å¾…çš„ä»»åŠ¡å…¨éƒ¨æ‰§è¡Œå®Œæˆåæ‰çœŸæ­£åœæ­¢</li>\n<li>shutdownNowå°†çº¿ç¨‹æ± çš„çŠ¶æ€è®¾ç½®ä¸ºSTOP,ä¸€èˆ¬ä¼šç«‹å³åœæ­¢ï¼Œé£é™©è¾ƒå¤§.é¦–å…ˆåœæ­¢æ¥æ”¶å¤–éƒ¨æäº¤çš„ä»»åŠ¡ï¼Œç„¶åå¿½ç•¥é˜Ÿåˆ—é‡Œç­‰å¾…çš„ä»»åŠ¡å¹¶å°è¯•å°†æ­£åœ¨è·‘çš„ä»»åŠ¡ interrupt ä¸­æ–­æœ€åè¿”å›æœªæ‰§è¡Œçš„ä»»åŠ¡åˆ—è¡¨ï¼Œ</li>\n<li>ä¸¤ä¸ªæ–¹æ³•éƒ½ä¼šä½¿isShutdownæ–¹æ³•è¿”å›trueï¼Œå½“æ‰€æœ‰çš„çº¿ç¨‹éƒ½å…³é—­æˆåŠŸï¼Œæ‰è¡¨ç¤ºçº¿ç¨‹æ± æˆåŠŸå…³é—­ï¼Œè¿™æ—¶è°ƒç”¨isTerminatedæ–¹æ³•æ‰ä¼šè¿”å›trueã€‚</li>\n<li>é€šå¸¸è°ƒç”¨shutdownæ–¹æ³•æ¥å…³é—­çº¿ç¨‹æ± ï¼Œå¦‚æœä»»åŠ¡ä¸ä¸€å®šè¦æ‰§è¡Œå®Œï¼Œåˆ™å¯ä»¥è°ƒç”¨shutdownNowæ–¹æ³•</li>\n</ul>\n<h1>72. çº¿ç¨‹æ± å‚æ•°æ€ä¹ˆè®¾ç½®ï¼Ÿâˆš</h1>\n<ul>\n<li>ä»»åŠ¡çš„æ€§è´¨ï¼šNä¸ºCPUæ ¸æ•°ï¼šè¿‡å°çš„çº¿ç¨‹æ± å¯èƒ½ä¼šå¯¼è‡´ä»»åŠ¡ä¸€ç›´åœ¨æ’é˜Ÿã€‚è¿‡å¤§çš„çº¿ç¨‹æ± å¯èƒ½ä¼šå¯¼è‡´å¤§å®¶éƒ½åœ¨ç«äº‰ CPU èµ„æºï¼Œå¢åŠ ä¸Šä¸‹æ–‡åˆ‡æ¢çš„å¼€é”€\n<ul>\n<li>CPUå¯†é›†å‹ä»»åŠ¡(åŠ è§£å¯†é€»è¾‘æ“ä½œ)ï¼ˆNcpu+1ï¼‰ï¼Œ+1 æ˜¯å› ä¸ºå¯èƒ½å­˜åœ¨é¡µç¼ºå¤±(å°±æ˜¯å¯èƒ½å­˜åœ¨æœ‰äº›æ•°æ®åœ¨ç¡¬ç›˜ä¸­éœ€è¦å¤šæ¥ä¸€ä¸ªçº¿ç¨‹å°†æ•°æ®è¯»å…¥å†…å­˜)ã€‚</li>\n<li>IOå¯†é›†å‹ä»»åŠ¡(æ•°æ®åº“é“¾æ¥ï¼Œé€šè®¯ä¼ è¾“ç­‰)ï¼ˆ2xNcpuï¼‰</li>\n<li>æ··åˆå‹ä»»åŠ¡ï¼ˆæ‹†åˆ†æˆä¸€ä¸ªCPUå¯†é›†å‹ä»»åŠ¡å’Œä¸€ä¸ªIOå¯†é›†å‹ä»»åŠ¡ï¼‰</li>\n</ul>\n</li>\n<li>cpu ä½¿ç”¨ç‡ï¼šè§‚å¯Ÿæœºå™¨çš„ cpu ä½¿ç”¨ç‡å’Œ cpu è´Ÿè½½ä¸¤ä¸ªå‚æ•°æ¥åˆ¤æ–­çº¿ç¨‹æ•°æ˜¯å¦åˆç†ã€‚</li>\n<li>å†…å­˜ä½¿ç”¨ç‡ï¼šé˜Ÿåˆ—çš„å¤§å°åº”è¯¥é€šè¿‡å‰æœŸè®¡ç®—çº¿ç¨‹æ± ä»»åŠ¡çš„æ¡æ•°ï¼Œæ¥åˆç†çš„è®¾ç½®é˜Ÿåˆ—çš„å¤§å°ï¼Œä¸å®œè¿‡å°ï¼Œè®©å…¶ä¸ä¼šæº¢å‡ºï¼Œå› ä¸ºæº¢å‡ºä¼šèµ°æ‹’ç»ç­–ç•¥ï¼Œå¤šå°‘ä¼šå½±å“æ€§èƒ½ï¼Œä¹Ÿä¼šå¢åŠ å¤æ‚åº¦ã€‚</li>\n<li>ä¸‹æ¸¸ç³»ç»ŸæŠ—å¹¶å‘èƒ½åŠ›ï¼šè€ƒè™‘ä¸‹æ¸¸ç³»ç»Ÿæ˜¯å¦èƒ½æŠ—çš„ä½è¿™ä¹ˆå¤šå¹¶å‘é‡ï¼Œä¸èƒ½æŠŠä¸‹æ¸¸ç³»ç»Ÿæ‰“æŒ‚äº†ã€‚</li>\n<li>ä»»åŠ¡çš„ä¼˜å…ˆçº§ï¼šé«˜ï¼Œä¸­å’Œä½ã€‚PriorityBlockingQueue å¦‚æœä¸€ç›´æœ‰ä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡æäº¤åˆ°é˜Ÿåˆ—é‡Œï¼Œé‚£ä¹ˆä¼˜å…ˆçº§ä½çš„ä»»åŠ¡å¯èƒ½æ°¸è¿œä¸èƒ½æ‰§è¡Œã€‚</li>\n<li>ä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´ï¼šé•¿ï¼Œä¸­å’ŒçŸ­ã€‚å¦‚æœä¸€ç›´æœ‰ä¼˜å…ˆçº§é«˜çš„ä»»åŠ¡æäº¤åˆ°é˜Ÿåˆ—é‡Œï¼Œé‚£ä¹ˆä¼˜å…ˆçº§ä½çš„ä»»åŠ¡å¯èƒ½æ°¸è¿œä¸èƒ½æ‰§è¡Œã€‚</li>\n<li>ä»»åŠ¡çš„ä¾èµ–æ€§ï¼šæ˜¯å¦ä¾èµ–å…¶ä»–ç³»ç»Ÿèµ„æºï¼Œå¦‚æ•°æ®åº“è¿æ¥ã€‚çº¿ç¨‹æ•°åº”è¯¥è®¾ç½®è¶Šå¤§</li>\n<li>å¯ä»¥é€šè¿‡Runtime.getRuntime().availableProcessors()æ–¹æ³•è·å¾—å½“å‰è®¾å¤‡çš„CPUä¸ªæ•°</li>\n<li>å»ºè®®ä½¿ç”¨æœ‰ç•Œé˜Ÿåˆ—ã€‚æœ‰ç•Œé˜Ÿåˆ—èƒ½å¢åŠ ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œé¢„è­¦èƒ½åŠ›ï¼Œå¯ä»¥æ ¹æ®éœ€è¦è®¾å¤§ä¸€ç‚¹å„¿ï¼Œæ¯”å¦‚å‡ åƒã€‚é¿å…oom</li>\n<li>å°½é‡ä½¿ç”¨è‡ªå®šä¹‰çš„çº¿ç¨‹æ± ï¼Œè€Œä¸æ˜¯ä½¿ç”¨ Executors åˆ›å»ºçš„çº¿ç¨‹æ± ï¼Œå› ä¸º newFixedThreadPool çº¿ç¨‹æ± ç”±äºä½¿ç”¨äº† LinkedBlockingQueueï¼Œé˜Ÿåˆ—çš„å®¹é‡é»˜è®¤æ— é™å¤§ï¼Œå®é™…ä½¿ç”¨ä¸­å‡ºç°ä»»åŠ¡è¿‡å¤šæ—¶ä¼šå¯¼è‡´å†…å­˜æº¢å‡ºï¼›newCachedThreadPool çº¿ç¨‹æ± ç”±äºæ ¸å¿ƒçº¿ç¨‹æ•°æ— é™å¤§ï¼Œå½“ä»»åŠ¡è¿‡å¤šçš„æ—¶å€™ä¼šå¯¼è‡´åˆ›å»ºå¤§é‡çš„çº¿ç¨‹ï¼Œå¯èƒ½æœºå™¨è´Ÿè½½è¿‡é«˜å¯¼è‡´æœåŠ¡å®•æœºã€‚</li>\n</ul>\n<h1>73. Executorsåˆ›å»ºçº¿ç¨‹æ± å¯¹è±¡çš„å¼Šç«¯? é˜¿é‡Œå¼€å‘è§„èŒƒä¸ºä»€ä¹ˆä¸å…è®¸Executorså¿«é€Ÿåˆ›å»ºçº¿ç¨‹æ± ï¼Ÿ</h1>\n<ul>\n<li>newSingleThreadExecutor (å•çº¿ç¨‹çš„çº¿ç¨‹æ± ) é€‚ç”¨äºä¸²è¡Œæ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ï¼Œä¸€ä¸ªä»»åŠ¡ä¸€ä¸ªä»»åŠ¡åœ°æ‰§è¡Œã€‚</li>\n<li>newFixedThreadPool (å›ºå®šæ•°ç›®çº¿ç¨‹çš„çº¿ç¨‹æ± ) CPUå¯†é›†å‹çš„ä»»åŠ¡</li>\n<li>newCachedThreadPool (å¯ç¼“å­˜çº¿ç¨‹çš„çº¿ç¨‹æ± )ç”¨äºå¹¶å‘æ‰§è¡Œå¤§é‡çŸ­æœŸçš„å°ä»»åŠ¡ã€‚ï¼ˆ60 ç§’ä¸æ‰§è¡Œä»»åŠ¡ï¼‰çš„çº¿ç¨‹å°†è¢«å›æ”¶</li>\n<li>newScheduledThreadPool (å®šæ—¶åŠå‘¨æœŸæ‰§è¡Œçš„çº¿ç¨‹æ± )å‘¨æœŸæ€§æ‰§è¡Œä»»åŠ¡çš„åœºæ™¯ï¼Œéœ€è¦é™åˆ¶çº¿ç¨‹æ•°é‡çš„åœºæ™¯</li>\n<li>FixedThreadPoolå’ŒSingleThreadExecutorä½¿ç”¨LinkedBlockingQueueå…è®¸è¯·æ±‚çš„é˜Ÿåˆ—é•¿åº¦ä¸ºInteger.MAX_VALUEï¼Œä»»åŠ¡æ‰§è¡Œæ—¶é—´é•¿ï¼Œé˜Ÿåˆ—å †ç§¯å¯¼è‡´OOM</li>\n<li>CachedThreadPoolå’ŒScheduledThreadPoolæœ€å¤§çº¿ç¨‹æ•°é‡ä¸ºInteger.MAX_VALUEï¼Œä»»åŠ¡æ‰§è¡Œæ—¶é—´é•¿ï¼Œä»»åŠ¡å †ç§¯å¯¼è‡´åˆ›å»ºå¤§é‡çº¿ç¨‹å¯¼è‡´OOM</li>\n</ul>\n<h1>74. çº¿ç¨‹æ± å¼‚å¸¸æ€ä¹ˆå¤„ç†</h1>\n<ul>\n<li>trycatchæ•è·</li>\n<li>submitæ‰§è¡Œï¼ŒFuture.getæ¥å—å¼‚å¸¸</li>\n<li>é‡å†™ThreadPoolExcutor.afterExcuteæ–¹æ³•ï¼Œå¤„ç†ä¼ é€’çš„å¼‚å¸¸å¼•ç”¨</li>\n<li>å®ä¾‹åŒ–æ—¶ï¼Œä¼ å…¥è‡ªå®šä¹‰ThreadFactory,è®¾ç½®Thread.uncaughtExceptionHandlerå¤„ç†æœªæ£€æµ‹çš„å¼‚å¸¸</li>\n</ul>\n<h1>75. çº¿ç¨‹æ± çŠ¶æ€</h1>\n<ul>\n<li>RUNNINGï¼šæ­£å¸¸çŠ¶æ€ï¼Œæ¥å—æ–°çš„ä»»åŠ¡ï¼Œå¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚</li>\n<li>SHUTDOWNï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä½†æ˜¯ä¼šç»§ç»­å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ã€‚é˜Ÿåˆ—ä¸ºç©ºï¼Œå¹¶ä¸”çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„ä»»åŠ¡ä¹Ÿä¸ºç©º,è¿›å…¥TIDYINGçŠ¶æ€;(shutdown)</li>\n<li>STOPï¼šä¸æ¥å—æ–°çš„ä»»åŠ¡æäº¤ï¼Œä¸å†å¤„ç†ç­‰å¾…é˜Ÿåˆ—ä¸­çš„ä»»åŠ¡ï¼Œä¸­æ–­æ­£åœ¨æ‰§è¡Œä»»åŠ¡çš„çº¿ç¨‹ã€‚çº¿ç¨‹æ± ä¸­æ‰§è¡Œçš„ä»»åŠ¡ä¸ºç©º,è¿›å…¥TIDYINGçŠ¶æ€;(shutdownnow)</li>\n<li>TIDYINGï¼šæ‰€æœ‰çš„ä»»åŠ¡éƒ½é”€æ¯äº†ï¼ŒworkCountä¸º0ï¼Œè½¬æ¢ä¸ºæ­¤çŠ¶æ€æ—¶ä¼šæ‰§è¡Œterminated()ã€‚</li>\n<li>TERMINATEDï¼šterminated()æ–¹æ³•ç»“æŸåçº¿ç¨‹æ± çš„çŠ¶æ€ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/77b2ca8a8016db88b8754.png\" alt=\"threadpoolstatus.png\"></li>\n</ul>\n<h1>76. çº¿ç¨‹æ± è°ƒä¼˜</h1>\n<ul>\n<li>äº‹å‰è¯„ä¼°-&gt;ç›‘æ§/å‘Šè­¦-&gt;åŠ¨æ€è°ƒæ•´-&gt;äº‹åè§‚å¯Ÿ</li>\n</ul>\n<h1>77. çº¿ç¨‹æ± ä½¿ç”¨æ³¨æ„äº‹é¡¹</h1>\n<ul>\n<li>é€‰æ‹©åˆé€‚çš„çº¿ç¨‹æ± å¤§å°</li>\n<li>é€‰æ‹©æœ‰ç•Œé˜Ÿåˆ—å¹¶è®¾ç½®å¤§å°ï¼Œé˜²æ­¢OOM</li>\n<li>å°½é‡ä½¿ç”¨è‡ªå®šä¹‰ThreadPoolExecutorè€Œä¸æ˜¯Executors åˆ›å»ºçš„çº¿ç¨‹æ± </li>\n</ul>\n<h1>78. ä½ èƒ½è®¾è®¡å®ç°ä¸€ä¸ªçº¿ç¨‹æ± å—</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/16f08fa922ac6a89fcaea.png\" alt=\"customthreadpool.png\" tabindex=\"0\"><figcaption>customthreadpool.png</figcaption></figure>\n<h1>79. å•æœºçº¿ç¨‹æ± æ‰§è¡Œæ–­ç”µäº†åº”è¯¥æ€ä¹ˆå¤„ç†ï¼Ÿ</h1>\n<ul>\n<li>å¯¹é˜»å¡é˜Ÿåˆ—æŒä¹…åŒ–ï¼›æ­£åœ¨å¤„ç†ä»»åŠ¡äº‹åŠ¡æ§åˆ¶ï¼›æ–­ç”µä¹‹åæ­£åœ¨å¤„ç†ä»»åŠ¡çš„å›æ»šï¼Œé€šè¿‡æ—¥å¿—æ¢å¤è¯¥æ¬¡æ“ä½œï¼›æœåŠ¡å™¨é‡å¯åé˜»å¡é˜Ÿåˆ—ä¸­çš„æ•°æ®å†åŠ è½½ã€‚</li>\n</ul>\n<h1>80. Fork/Joinæ¡†æ¶ï¼Ÿ</h1>\n<ul>\n<li>ç”¨äºå¹¶è¡Œæ‰§è¡Œä»»åŠ¡çš„æ¡†æ¶ï¼Œæ˜¯ä¸€ä¸ªæŠŠå¤§ä»»åŠ¡åˆ†å‰²æˆè‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼Œæœ€ç»ˆæ±‡æ€»æ¯ä¸ªå°ä»»åŠ¡ç»“æœåå¾—åˆ°å¤§ä»»åŠ¡ç»“æœçš„æ¡†æ¶ã€‚</li>\n<li>åˆ†è€Œæ²»ä¹‹:Fork/Join æ¡†æ¶çš„å®šä¹‰ä½“ç°äº†åˆ†æ²»æ€æƒ³ï¼šå°†ä¸€ä¸ªè§„æ¨¡ä¸º N çš„é—®é¢˜åˆ†è§£ä¸º K ä¸ªè§„æ¨¡è¾ƒå°çš„å­é—®é¢˜ï¼Œè¿™äº›å­é—®é¢˜ç›¸äº’ç‹¬ç«‹ä¸”ä¸åŸé—®é¢˜æ€§è´¨ç›¸åŒã€‚æ±‚å‡ºå­é—®é¢˜çš„è§£ï¼Œå°±å¯å¾—åˆ°åŸé—®é¢˜çš„è§£ã€‚</li>\n<li>å·¥ä½œçªƒå–ç®—æ³•:å¤§ä»»åŠ¡æ‹†æˆäº†è‹¥å¹²ä¸ªå°ä»»åŠ¡ï¼ŒæŠŠè¿™äº›å°ä»»åŠ¡æ”¾åˆ°ä¸åŒçš„é˜Ÿåˆ—é‡Œï¼Œå„è‡ªåˆ›å»ºå•ç‹¬çº¿ç¨‹æ¥æ‰§è¡Œé˜Ÿåˆ—é‡Œçš„ä»»åŠ¡ã€‚æœ‰çš„çº¿ç¨‹å¹²æ´»å—ï¼Œæœ‰çš„çº¿ç¨‹å¹²æ´»æ…¢ã€‚å¹²å®Œæ´»çš„çº¿ç¨‹å»å¸®æ²¡å¹²å®Œæ´»çš„çº¿ç¨‹å¹²æ´»ã€‚å»å…¶å®ƒçº¿ç¨‹çš„é˜Ÿåˆ—é‡Œçªƒå–ä¸€ä¸ªä»»åŠ¡æ¥æ‰§è¡Œï¼Œè¿™å°±æ˜¯æ‰€è°“çš„å·¥ä½œçªƒå–ã€‚å·¥ä½œçªƒå–å‘ç”Ÿçš„æ—¶å€™ï¼Œå®ƒä»¬ä¼šè®¿é—®åŒä¸€ä¸ªé˜Ÿåˆ—ï¼Œä¸ºäº†å‡å°‘çªƒå–ä»»åŠ¡çº¿ç¨‹å’Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹ä¹‹é—´çš„ç«äº‰ï¼Œé€šå¸¸ä»»åŠ¡ä¼šä½¿ç”¨åŒç«¯é˜Ÿåˆ—ï¼Œè¢«çªƒå–ä»»åŠ¡çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å¤´éƒ¨æ‹¿ï¼Œè€Œçªƒå–ä»»åŠ¡çš„çº¿ç¨‹æ°¸è¿œä»åŒç«¯é˜Ÿåˆ—çš„å°¾éƒ¨æ‹¿ä»»åŠ¡æ‰§è¡Œã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//è®¡ç®— 1~n ä¹‹é—´çš„å’Œï¼š1+2+3+â€¦+n è®¾ç½®ä¸€ä¸ªåˆ†å‰²é˜ˆå€¼ï¼Œä»»åŠ¡å¤§äºé˜ˆå€¼å°±æ‹†åˆ†ä»»åŠ¡ ä»»åŠ¡æœ‰ç»“æœï¼Œæ‰€ä»¥éœ€è¦ç»§æ‰¿ RecursiveTask\n\npublic class CountTask extends RecursiveTask&lt;Integer&gt; {\n    private static final int THRESHOLD = 16; // é˜ˆå€¼\n    private int start;\n    private int end;\n\n    public CountTask(int start, int end) {\n        this.start = start;\n        this.end = end;\n    }\n\n    @Override\n    protected Integer compute() {\n        int sum = 0;\n        // å¦‚æœä»»åŠ¡è¶³å¤Ÿå°å°±è®¡ç®—ä»»åŠ¡\n        boolean canCompute = (end - start) &lt;= THRESHOLD;\n        if (canCompute) {\n            for (int i = start; i &lt;= end; i++) {\n                sum += i;\n            }\n        } else {\n            // å¦‚æœä»»åŠ¡å¤§äºé˜ˆå€¼ï¼Œå°±åˆ†è£‚æˆä¸¤ä¸ªå­ä»»åŠ¡è®¡ç®—\n            int middle = (start + end) / 2;\n            CountTask leftTask = new CountTask(start, middle);\n            CountTask rightTask = new CountTask(middle + 1, end);\n            // æ‰§è¡Œå­ä»»åŠ¡\n            leftTask.fork();\n            rightTask.fork(); // ç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œï¼Œå¹¶å¾—åˆ°å…¶ç»“æœ\n            int leftResult = leftTask.join();\n            int rightResult = rightTask.join(); // åˆå¹¶å­ä»»åŠ¡\n            sum = leftResult + rightResult;\n        }\n        return sum;\n    }\n\n    public static void main(String[] args) {\n        ForkJoinPool forkJoinPool = new ForkJoinPool(); // ç”Ÿæˆä¸€ä¸ªè®¡ç®—ä»»åŠ¡ï¼Œè´Ÿè´£è®¡ç®—1+2+3+4\n        CountTask task = new CountTask(1, 100); // æ‰§è¡Œä¸€ä¸ªä»»åŠ¡\n        Future&lt;Integer&gt; result = forkJoinPool.submit(task);\n        try {\n            System.out.println(result.get());\n        } catch (InterruptedException e) {\n        } catch (ExecutionException e) {\n        }\n    }\n\n}\n</code></pre></div><ul>\n<li>ForkJoinTask ä¸ä¸€èˆ¬ Task çš„ä¸»è¦åŒºåˆ«åœ¨äºå®ƒéœ€è¦å®ç° compute æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªæ–¹æ³•é‡Œï¼Œé¦–å…ˆéœ€è¦åˆ¤æ–­ä»»åŠ¡æ˜¯å¦è¶³å¤Ÿå°ï¼Œå¦‚æœè¶³å¤Ÿå°å°±ç›´æ¥æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœæ¯”è¾ƒå¤§ï¼Œå°±å¿…é¡»åˆ†å‰²æˆä¸¤ä¸ªå­ä»»åŠ¡ï¼Œæ¯ä¸ªå­ä»»åŠ¡åœ¨è°ƒç”¨ fork æ–¹æ³•æ—¶ï¼Œåˆä¼šè¿› compute æ–¹æ³•ï¼Œçœ‹çœ‹å½“å‰å­ä»»åŠ¡æ˜¯å¦éœ€è¦ç»§ç»­åˆ†å‰²æˆå­ä»»åŠ¡ï¼Œå¦‚æœä¸éœ€è¦ç»§ç»­åˆ†å‰²ï¼Œåˆ™æ‰§è¡Œå½“å‰å­ä»»åŠ¡å¹¶è¿”å›ç»“æœã€‚ä½¿ç”¨ join æ–¹æ³•ä¼šç­‰å¾…å­ä»»åŠ¡æ‰§è¡Œå®Œå¹¶å¾—åˆ°å…¶ç»“æœã€‚</li>\n</ul>\n<p>=====================================================================================================================</p>\n<h1>81. å¤šçº¿ç¨‹çš„ä¼˜ç¼ºç‚¹?</h1>\n<ul>\n<li>\n<p>ä¼˜ç‚¹</p>\n<ul>\n<li>ä½¿ç”¨å¤šçº¿ç¨‹å¯ä»¥æŠŠç¨‹åºä¸­å æ®æ—¶é—´é•¿çš„ä»»åŠ¡æ”¾åˆ°åå°å»å¤„ç†ï¼Œå¦‚å›¾ç‰‡ã€è§†é¢‘çš„ä¸‹è½½ã€‚ç”Ÿæˆè®¢å•å¿«ç…§ã€å‘é€é‚®ä»¶ç­‰</li>\n<li>å‘æŒ¥å¤šæ ¸å¤„ç†å™¨çš„ä¼˜åŠ¿ï¼Œå¹¶å‘æ‰§è¡Œè®©ç³»ç»Ÿè¿è¡Œçš„æ›´å¿«ã€æ›´æµç•…ï¼Œç”¨æˆ·ä½“éªŒæ›´å¥½</li>\n</ul>\n</li>\n<li>\n<p>ç¼ºç‚¹</p>\n<ul>\n<li>å¤§é‡çš„çº¿ç¨‹é™ä½ä»£ç çš„å¯è¯»æ€§</li>\n<li>æ›´å¤šçš„çº¿ç¨‹éœ€è¦æ›´å¤šçš„å†…å­˜ç©ºé—´</li>\n<li>å½“å¤šä¸ªçº¿ç¨‹å¯¹åŒä¸€ä¸ªèµ„æºå‡ºç°äº‰å¤ºæ—¶å€™è¦æ³¨æ„çº¿ç¨‹å®‰å…¨çš„é—®é¢˜</li>\n</ul>\n</li>\n<li>\n<p>CPUæ ¸ä¹‹é—´çš„æ•°æ®ä¸€è‡´æ€§ä¿è¯æ–¹æ³•</p>\n<ul>\n<li>æ€»çº¿åŠ é”ï¼šé€šè¿‡åœ¨æ€»çº¿åŠ LOCK#é”çš„æ–¹å¼ï¼›åªèƒ½æœ‰ä¸€ä¸ªCPUèƒ½å¤Ÿè¿è¡Œï¼Œå…¶ä»–CPUéƒ½é˜»å¡ï¼Œæ•ˆç‡ä½ä¸‹</li>\n<li>ç¼“å­˜ä¸€è‡´æ€§åè®®MESIï¼šç¡®ä¿æ¯ä¸ªç¼“å­˜ä¸­ä½¿ç”¨çš„å…±äº«å˜é‡çš„å‰¯æœ¬æ˜¯ä¸€è‡´çš„ï¼šå½“æŸä¸ªCPUåœ¨å†™æ•°æ®æ—¶ï¼Œå¦‚æœå‘ç°æ“ä½œçš„å˜é‡æ˜¯å…±äº«å˜é‡ï¼Œåˆ™ä¼šé€šçŸ¥å…¶ä»–CPUå‘ŠçŸ¥è¯¥å˜é‡çš„ç¼“å­˜è¡Œæ˜¯æ— æ•ˆçš„ï¼Œå…¶ä»–CPUåœ¨è¯»å–è¯¥å˜é‡æ—¶ï¼Œå‘ç°å…¶æ— æ•ˆä¼šé‡æ–°ä»ä¸»å­˜ä¸­åŠ è½½æ•°æ®</li>\n</ul>\n</li>\n</ul>\n<h1>82. javaå¦‚ä½•å®ç°åŸå­æ“ä½œï¼Ÿ</h1>\n<ul>\n<li>åŸå­æ“ä½œæ˜¯æŒ‡ä¸€ä¸ªä¸å—å…¶ä»–æ“ä½œå½±å“çš„æ“ä½œä»»åŠ¡å•å…ƒã€‚å¤„ç†å™¨ä½¿ç”¨åŸºäºå¯¹ç¼“å­˜åŠ é”æˆ–æ€»çº¿åŠ é”çš„æ–¹å¼ï¼Œæ¥å®ç°å¤šå¤„ç†å™¨ä¹‹é—´çš„åŸå­æ“ä½œ</li>\n<li>ä½¿ç”¨æ€»çº¿é”ä¿è¯åŸå­æ€§ï¼šä½¿ç”¨å¤„ç†å™¨æä¾›çš„ä¸€ä¸ªLOCKï¼ƒä¿¡å·ï¼Œå½“ä¸€ä¸ªå¤„ç†å™¨åœ¨æ€»çº¿ä¸Šè¾“å‡ºæ­¤ä¿¡å·æ—¶ï¼Œå…¶ä»–å¤„ç†å™¨çš„è¯·æ±‚å°†è¢«é˜»å¡ä½ï¼Œé‚£ä¹ˆè¯¥å¤„ç†å™¨å¯ä»¥ç‹¬å å…±äº«å†…å­˜ã€‚å¯¹åº”#lockå‰ç¼€ åŠ ä¸Šåé¢å…·ä½“çš„æŒ‡ä»¤</li>\n<li>ä½¿ç”¨ç¼“å­˜é”ä¿è¯åŸå­æ€§ï¼šé€šè¿‡ç¼“å­˜ä¸€è‡´æ€§åè®®å®ç°ï¼Œå¯¹åº”ä½æµ‹è¯•å’Œä¿®æ”¹æŒ‡ä»¤ï¼šBTSã€BTRã€BTCï¼›äº¤æ¢æŒ‡ä»¤XADDã€CMPXCHGï¼Œä»¥åŠå…¶ä»–ä¸€äº›æ“ä½œæ•°å’Œé€»è¾‘æŒ‡ä»¤ï¼ˆå¦‚ADDã€ORï¼‰ç­‰</li>\n<li>ä½¿ç”¨å¾ªç¯CASå®ç°åŸå­æ“ä½œï¼ŒCASåˆ©ç”¨äº†å¤„ç†å™¨æä¾›çš„CMPXCHGæŒ‡ä»¤(java)</li>\n<li>ä½¿ç”¨é”æœºåˆ¶å®ç°åŸå­æ“ä½œï¼Œé”æœºåˆ¶ä¿è¯äº†åªæœ‰è·å¾—é”çš„çº¿ç¨‹æ‰èƒ½å¤Ÿæ“ä½œé”å®šçš„å†…å­˜åŒºåŸŸã€‚JVMå†…éƒ¨å®ç°äº†å¾ˆå¤šç§é”æœºåˆ¶ï¼Œæœ‰åå‘é”ã€è½»é‡çº§é”å’Œäº’æ–¥é”ã€‚é™¤äº†åå‘é”ï¼ŒJVMå®ç°é”çš„æ–¹å¼éƒ½ç”¨äº†å¾ªç¯CASï¼Œå³å½“ä¸€ä¸ªçº¿ç¨‹æƒ³è¿›å…¥åŒæ­¥å—çš„æ—¶å€™ä½¿ç”¨å¾ªç¯CASçš„æ–¹å¼æ¥è·å–é”ï¼Œå½“å®ƒé€€å‡ºåŒæ­¥å—çš„æ—¶å€™ä½¿ç”¨å¾ªç¯CASé‡Šæ”¾é”ã€‚</li>\n</ul>\n<h1>83. waitå’Œnotifyå…¸å‹èŒƒå¼ï¼Ÿ</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># ç­‰å¾…æ–¹\nsynchronized(å¯¹è±¡){\n    while(æ¡ä»¶ä¸æ»¡è¶³){//ä¸ºä»€ä¹ˆè¢«é€šçŸ¥åä»è¦æ£€æŸ¥æ¡ä»¶ï¼Ÿé˜²æ­¢å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œéƒ½ä»wait()è¿”å›æ—¶æ¡ä»¶ä¸æ»¡è¶³å¯¼è‡´ç¨‹åºå‡ºé”™\n        å¯¹è±¡.wait();\n    }\n    å¯¹åº”çš„å¤„ç†é€»è¾‘\n}\n# é€šçŸ¥æ–¹\nsynchronized(å¯¹è±¡){\n    æ”¹å˜æ¡ä»¶\n    å¯¹è±¡.notifyAll();\n}\n</code></pre></div><h1>84. å¤šçº¿ç¨‹å¼€å‘æ³¨æ„äº‹é¡¹</h1>\n<ul>\n<li>ç»™çº¿ç¨‹å‘½åï¼Œæ–¹ä¾¿æ‰¾bugå’Œè·Ÿè¸ªã€jstackåˆ†æç¨‹åºæˆ–è€…é—®é¢˜æ’æŸ¥</li>\n<li>æœ€å°åŒ–åŒæ­¥èŒƒå›´</li>\n<li>ä¼˜å…ˆä½¿ç”¨volatileï¼Œè€Œä¸æ˜¯ synchronized</li>\n<li>å°½å¯èƒ½ä½¿ç”¨æ›´é«˜å±‚æ¬¡çš„å¹¶å‘å·¥å…·è€Œéwaitå’Œnotifyæ–¹æ³•æ¥å®ç°çº¿ç¨‹é€šä¿¡</li>\n<li>ä¼˜å…ˆä½¿ç”¨å¹¶å‘å®¹å™¨ï¼Œè€ŒéåŒæ­¥å®¹å™¨</li>\n<li>è€ƒè™‘ä½¿ç”¨çº¿ç¨‹æ± </li>\n<li>å°å¿ƒæ­»é”</li>\n<li>å°½é‡é¿å…ä¸Šä¸‹æ–‡åˆ‡æ¢</li>\n<li>æ§åˆ¶èµ„æº\n<ul>\n<li>ç¡¬ä»¶èµ„æºï¼šå¸¦å®½çš„ä¸Šä¼ /ä¸‹è½½é€Ÿåº¦ã€ç¡¬ç›˜è¯»å†™é€Ÿåº¦å’ŒCPUçš„å¤„ç†é€Ÿåº¦ï¼›ä½¿ç”¨é›†ç¾¤å¹¶è¡Œæ‰§è¡Œç¨‹åºã€‚è®©ç¨‹åºåœ¨å¤šæœºä¸Šè¿è¡Œã€‚æ¯”å¦‚ä½¿ç”¨ODPSã€Hadoopæˆ–è€…è‡ªå·±æ­å»ºæœåŠ¡å™¨é›†ç¾¤ï¼Œä¸åŒçš„æœºå™¨å¤„ç†ä¸åŒçš„æ•°æ®ã€‚å¯ä»¥é€šè¿‡â€œæ•°æ®ID%æœºå™¨æ•°â€ï¼Œè®¡ç®—å¾—åˆ°ä¸€ä¸ªæœºå™¨ç¼–å·ï¼Œç„¶åç”±å¯¹åº”ç¼–å·çš„æœºå™¨å¤„ç†è¿™ç¬”æ•°æ®ã€‚</li>\n<li>è½¯ä»¶èµ„æºï¼šæ•°æ®åº“çš„è¿æ¥æ•°å’Œsocketè¿æ¥æ•°ç­‰ï¼›ä½¿ç”¨èµ„æºæ± å°†èµ„æºå¤ç”¨ã€‚æ¯”å¦‚ä½¿ç”¨è¿æ¥æ± å°†æ•°æ®åº“å’ŒSocketè¿æ¥å¤ç”¨ï¼Œæˆ–è€…åœ¨è°ƒç”¨å¯¹æ–¹webserviceæ¥å£è·å–æ•°æ®æ—¶ï¼Œåªå»ºç«‹ä¸€ä¸ªè¿æ¥ã€‚</li>\n<li>æ ¹æ®ä¸åŒçš„èµ„æºé™åˆ¶è°ƒæ•´ç¨‹åºçš„å¹¶å‘åº¦</li>\n</ul>\n</li>\n</ul>\n<h1>85. finalåŸŸçš„é‡æ’</h1>\n<ul>\n<li>åŸºæœ¬æ•°æ®ç±»å‹:\n<ul>\n<li>finalåŸŸå†™ï¼šç¦æ­¢finalåŸŸå†™ä¸æ„é€ æ–¹æ³•é‡æ’åºï¼Œä¿è¯è¯¥å¯¹è±¡å¯¹æ‰€æœ‰çº¿ç¨‹å¯è§æ—¶ï¼Œè¯¥å¯¹è±¡çš„finalåŸŸå…¨éƒ¨å·²ç»åˆå§‹åŒ–è¿‡</li>\n<li>finalåŸŸè¯»ï¼ˆé’ˆå¯¹å¤„ç†å™¨ï¼‰ï¼šç¦æ­¢åˆæ¬¡è¯»å¯¹è±¡çš„å¼•ç”¨ä¸è¯»è¯¥å¯¹è±¡åŒ…å«çš„finalåŸŸçš„é‡æ’åºã€‚ä¿è¯è¯»ä¸€ä¸ªå¯¹è±¡çš„finalåŸŸä¹‹å‰å…ˆè¯»è¿™ä¸ªåŒ…å«è¿™ä¸ªfinalåŸŸçš„å¯¹è±¡çš„å¼•ç”¨</li>\n</ul>\n</li>\n<li>å¼•ç”¨æ•°æ®ç±»å‹ï¼š\n<ul>\n<li>é¢å¤–çº¦æŸï¼šç¦æ­¢åœ¨æ„é€ å‡½æ•°å¯¹ä¸€ä¸ªfinalä¿®é¥°çš„å¯¹è±¡çš„æˆå‘˜åŸŸçš„å†™å…¥ä¸éšåå°†è¿™ä¸ªè¢«æ„é€ çš„å¯¹è±¡çš„å¼•ç”¨èµ‹å€¼ç»™å¼•ç”¨å˜é‡é‡æ’åº</li>\n</ul>\n</li>\n<li>finalå®ç°\n<ul>\n<li>å†™finalåŸŸä¼šè¦æ±‚ç¼–è¯‘å™¨åœ¨finalåŸŸå†™ä¹‹åï¼Œæ„é€ å‡½æ•°è¿”å›å‰æ’å…¥ä¸€ä¸ªStoreStoreå±éšœ</li>\n<li>è¯»finalåŸŸä¼šè¦æ±‚ç¼–è¯‘å™¨åœ¨è¯»finalåŸŸçš„æ“ä½œå‰æ’å…¥ä¸€ä¸ªLoadLoadå±éšœ</li>\n</ul>\n</li>\n</ul>\n<h1>86. é”åˆ†ç±»ï¼ˆé‡å…¥é”ã€äº’æ–¥é”ã€è¯»å†™é”ã€å…¬å¹³é”ã€éå…¬å¹³é”ã€è‡ªæ—‹é”ã€é€‚åº”è‡ªæ—‹é”ï¼‰</h1>\n<ul>\n<li>äº’æ–¥é”ï¼šæ²¡æœ‰è·å–åˆ°é”çš„çº¿ç¨‹è¿›å…¥é˜»å¡ï¼Œçº¿ç¨‹é˜»å¡æ¶‰åŠåˆ°ç”¨æˆ·æ€å’Œå†…æ ¸æ€åˆ‡æ¢çš„é—®é¢˜ï¼Œæ€§èƒ½å¯èƒ½å¾ˆå·®</li>\n<li>è¯»å†™é”ï¼šè¯»å–é”å…è®¸å¤šä¸ªreaderçº¿ç¨‹åŒæ—¶æŒæœ‰ï¼Œè€Œå†™å…¥é”æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªwriterçº¿ç¨‹æŒæœ‰</li>\n<li>å…¬å¹³é”ï¼šå…ˆè¯·æ±‚é”çš„äººï¼Œåœ¨é”è¢«é‡Šæ”¾æ—¶ï¼Œä¼˜å…ˆè·å¾—é”ï¼Œå³åŒæ­¥é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹å…ˆè·å–é”ï¼Œéœ€è¦é¢‘ç¹çš„ä¸Šä¸‹æ–‡åˆ‡æ¢</li>\n<li>ä¸å…¬å¹³é”ï¼šæ— è®ºå…ˆåï¼Œçº¿ç¨‹è°ƒåº¦å™¨å°†ä¼šéšæœºç»™æŸä¸ªçº¿ç¨‹é”ï¼Œä¸ç”¨è®¡ç®—çº¿ç¨‹æ—¶åºï¼Œä¸Šä¸‹æ–‡åˆ‡æ¢è¾ƒå°‘ï¼Œæœ‰å¯èƒ½åˆšé‡Šæ”¾é”çš„çº¿ç¨‹èƒ½å†æ¬¡è·å–åˆ°é”ï¼Œå¯¼è‡´å…¶ä»–çº¿ç¨‹æ°¸è¿œæ— æ³•è·å–åˆ°é”ï¼Œé€ æˆâ€œé¥¥é¥¿â€ç°è±¡</li>\n<li>è‡ªæ—‹é”ï¼šæ²¡æœ‰è·å–åˆ°é”çš„çº¿ç¨‹ä¸è¿›å…¥é˜»å¡ï¼Œè€Œæ˜¯è®©è¯¥çº¿ç¨‹ç­‰å¾…ä¸€æ®µæ—¶é—´ï¼ˆæ‰§è¡Œä¸€æ®µæ— æ„ä¹‰çš„å¾ªç¯ï¼‰ï¼Œä¸€ç›´å¾ªç¯ç­‰å¾…é‡Šæ”¾é”ã€‚è‡ªæ—‹ç­‰å¾…ä¸èƒ½æ›¿ä»£é˜»å¡ï¼Œè™½ç„¶å¯ä»¥é¿å…çº¿ç¨‹åˆ‡æ¢å¸¦æ¥çš„å¼€é”€ï¼Œä½†æ˜¯å®ƒå ç”¨äº†å¤„ç†å™¨çš„æ—¶é—´ã€‚å¦‚æœæŒæœ‰é”çš„çº¿ç¨‹å¾ˆå¿«å°±é‡Šæ”¾äº†é”ï¼Œé‚£ä¹ˆè‡ªæ—‹çš„æ•ˆç‡é«˜ï¼Œåä¹‹ï¼Œè‡ªæ—‹çš„çº¿ç¨‹å°±ä¼šæµªè´¹å¤„ç†å™¨çš„èµ„æºï¼Œæ‰€ä»¥ï¼Œè‡ªæ—‹ç­‰å¾…çš„æ—¶é—´ï¼ˆè‡ªæ—‹æ¬¡æ•°ï¼‰å¿…é¡»è¦æœ‰ä¸Šé™ï¼Œå¦‚æœè‡ªæ—‹è¶…è¿‡äº†å®šä¹‰çš„æ—¶é—´ä»ç„¶æ²¡æœ‰è·å–åˆ°é”ï¼Œåˆ™åº”è¯¥è¢«æŒ‚èµ·</li>\n<li>è‡ªé€‚åº”æ˜¯æŒ‡ç”±å‰ä¸€æ¬¡åœ¨åŒä¸€ä¸ªé”ä¸Šçš„è‡ªæ—‹æ—¶é—´åŠé”çš„æ‹¥æœ‰è€…çš„çŠ¶æ€æ¥å†³å®šè‡ªæ—‹æ¬¡æ•°ã€‚çº¿ç¨‹å¦‚æœè‡ªæ—‹æˆåŠŸäº†ï¼Œé‚£ä¹ˆä¸‹æ¬¡è‡ªæ—‹çš„æ¬¡æ•°ä¼šæ›´åŠ å¤šï¼Œå› ä¸ºè™šæ‹Ÿæœºè®¤ä¸ºæ—¢ç„¶ä¸Šæ¬¡æˆåŠŸäº†ï¼Œé‚£ä¹ˆæ­¤æ¬¡è‡ªæ—‹ä¹Ÿå¾ˆæœ‰å¯èƒ½ä¼šå†æ¬¡æˆåŠŸï¼Œé‚£ä¹ˆå®ƒå°±ä¼šå…è®¸è‡ªæ—‹ç­‰å¾…æŒç»­çš„æ¬¡æ•°æ›´å¤šã€‚åä¹‹ï¼Œå¦‚æœå¯¹äºæŸä¸ªé”ï¼Œå¾ˆå°‘æœ‰è‡ªæ—‹èƒ½å¤ŸæˆåŠŸçš„ï¼Œé‚£ä¹ˆåœ¨ä»¥åè¦æˆ–è€…è¿™ä¸ªé”çš„æ—¶å€™è‡ªæ—‹çš„æ¬¡æ•°ä¼šå‡å°‘ç”šè‡³çœç•¥æ‰è‡ªæ—‹è¿‡ç¨‹ï¼Œä»¥å…æµªè´¹å¤„ç†å™¨èµ„æºã€‚</li>\n</ul>\n<h1>88. ä¹è§‚é”å¸¸è§çš„ä¸¤ç§å®ç°æ–¹å¼æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>ç‰ˆæœ¬å·æœºåˆ¶:ä¸€èˆ¬æ˜¯åœ¨æ•°æ®è¡¨ä¸­åŠ ä¸Šä¸€ä¸ªæ•°æ®ç‰ˆæœ¬å·versionå­—æ®µè¡¨ç¤ºæ•°æ®è¢«ä¿®æ”¹çš„æ¬¡æ•°ï¼Œå½“æ•°æ®è¢«ä¿®æ”¹æ—¶versionä¼šåŠ 1ã€‚å½“çº¿ç¨‹è¦æ›´æ–°æ•°æ®å€¼æ—¶,ä¼šå…ˆè¯»å–versionå€¼ï¼Œåœ¨æäº¤æ›´æ–°æ—¶ï¼Œè‹¥åˆšæ‰è¯»å–åˆ°çš„versionå€¼ä¸ºå½“å‰æ•°æ®åº“ä¸­çš„versionå€¼ç›¸ç­‰æ—¶æ‰æ›´æ–°ï¼Œå¦åˆ™é‡è¯•æ›´æ–°æ“ä½œç›´åˆ°æˆåŠŸ</li>\n<li>CASç®—æ³•:compare and swapï¼ˆæ¯”è¾ƒä¸äº¤æ¢ï¼Œæ˜¯åŸå­æ“ä½œï¼‰ï¼Œä¸ä½¿ç”¨é”çš„æƒ…å†µä¸‹å®ç°å¤šçº¿ç¨‹ä¹‹é—´çš„å˜é‡åŒæ­¥ï¼ˆéé˜»å¡åŒæ­¥Non-blocking Synchronizationï¼‰ã€‚CASç®—æ³•æ¶‰åŠåˆ°ä¸‰ä¸ªæ“ä½œæ•°ï¼šéœ€è¦è¯»å†™çš„å†…å­˜å€¼Vï¼›è¿›è¡Œæ¯”è¾ƒçš„å€¼Aï¼›æ‹Ÿå†™å…¥çš„æ–°å€¼B;å½“ä¸”ä»…å½“Vçš„å€¼ç­‰äºAæ—¶ï¼ŒCASé€šè¿‡åŸå­æ–¹å¼ç”¨æ–°å€¼Bæ¥æ›´æ–°Vå€¼ï¼Œå¦åˆ™ä¸ä¼šæ‰§è¡Œä»»ä½•æ“ä½œã€‚ä¸€èˆ¬æƒ…å†µä¸‹ä¼šè‡ªæ—‹ï¼ˆä¸æ–­çš„é‡è¯•ã€‚æ— é™å¾ªç¯ï¼‰</li>\n</ul>\n<h1>89. synchronized å’Œ volatile çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>volatile æœ¬è´¨æ˜¯åœ¨å‘Šè¯‰ JVMå½“å‰å˜é‡åœ¨å¯„å­˜å™¨ï¼ˆå·¥ä½œå†…å­˜ï¼‰ä¸­çš„å€¼æ˜¯ä¸ç¡®å®šçš„ï¼Œéœ€è¦ä»ä¸»å­˜ä¸­è¯»å–ï¼›synchronized åˆ™æ˜¯é”å®šå½“å‰å˜é‡ï¼Œåªæœ‰å½“å‰çº¿ç¨‹å¯ä»¥è®¿é—®è¯¥å˜é‡ï¼Œå…¶ä»–çº¿ç¨‹è¢«é˜»å¡ä½ã€‚</li>\n<li>volatile ä»…èƒ½ä½¿ç”¨åœ¨å˜é‡çº§åˆ«ï¼›synchronized åˆ™å¯ä»¥ä½¿ç”¨åœ¨å˜é‡ã€æ–¹æ³•ã€å’Œç±»çº§åˆ«çš„ã€‚</li>\n<li>volatile ä»…èƒ½å®ç°å˜é‡çš„ä¿®æ”¹å¯è§æ€§ï¼Œä¸èƒ½ä¿è¯åŸå­æ€§ï¼›è€Œ synchronized åˆ™å¯ä»¥ä¿è¯å˜é‡çš„ä¿®æ”¹å¯è§æ€§å’ŒåŸå­æ€§ã€‚</li>\n<li>volatile ä¸ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ï¼›synchronized å¯èƒ½ä¼šé€ æˆçº¿ç¨‹çš„é˜»å¡ã€‚</li>\n<li>volatile æ ‡è®°çš„å˜é‡ä¸ä¼šè¢«ç¼–è¯‘å™¨ä¼˜åŒ–ï¼›synchronized æ ‡è®°çš„å˜é‡å¯ä»¥è¢«ç¼–è¯‘å™¨ä¼˜åŒ–ã€‚</li>\n</ul>\n<h1>90. ä»€ä¹ˆåœºæ™¯ä¸‹å¯ä»¥ä½¿ç”¨ volatile æ›¿æ¢ synchronized ï¼Ÿ</h1>\n<ul>\n<li>åªéœ€è¦ä¿è¯å…±äº«èµ„æºçš„å¯è§æ€§çš„æ—¶ï¼Œsynchronizedä¿è¯å¯æ“ä½œçš„åŸå­æ€§ä¸€è‡´æ€§å’Œå¯è§æ€§ã€‚volatileé€‚ç”¨äºæ–°å€¼ä¸ä¾èµ–äºæ—§å€¼çš„æƒ…å½¢</li>\n<li>1 å†™ N è¯»</li>\n<li>ä¸ä¸å…¶ä»–å˜é‡æ„æˆä¸å˜æ€§æ¡ä»¶æ—¶å€™ä½¿ç”¨ volatile</li>\n</ul>\n<h1>91. SimpleDateFormatæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿ</h1>\n<ul>\n<li>DateFormatæ‰€æœ‰å®ç°ï¼ŒåŒ…æ‹¬SimpleDateFormatéƒ½ä¸æ˜¯çº¿ç¨‹å®‰å…¨çš„ï¼Œå¯å°†SimpleDateFormaté™åˆ¶åœ¨ThreadLocalä¸­ã€‚æˆ–è€…ä½¿ç”¨joda-timeåº“</li>\n</ul>\n<h1>91.1. ConcurrentHashMapâˆš</h1>\n<ul>\n<li>CopyOnWriteArrayList:é€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ï¼Œä¸èƒ½ç”¨äºå®æ—¶è¯»ï¼Œå› ä¸ºæ‰§è¡Œå†™æ“ä½œæ—¶ä¼šå¤åˆ¶åŸæ•°ç»„å¹¶æ‰§è¡Œå†™å…¥æ“ä½œï¼Œè¯»æ“ä½œå¯ä»¥å®‰å…¨è¿›è¡Œï¼Œä½†è¯»å–çš„å¯èƒ½æ˜¯æ—§æ•°æ®ï¼ŒåŸæ•°ç»„æ¯”è¾ƒå¤§æ—¶å¯èƒ½å‘ç”Ÿyoung gcæˆ–è€…full gc</li>\n<li>ConcurrentLinkedQueueæ˜¯ä¸€ä¸ªåŸºäºé“¾æ¥èŠ‚ç‚¹çš„æ— ç•Œçº¿ç¨‹å®‰å…¨é˜Ÿåˆ—ï¼Œå…ˆè¿›å…ˆå‡º</li>\n</ul>\n<h1>91.2. volatile å˜é‡å’Œ atomic å˜é‡æœ‰ä»€ä¹ˆä¸åŒï¼Ÿ</h1>\n<ul>\n<li>volatileå˜é‡ç¡®ä¿æœ‰åºæ€§ï¼Œå³å†™æ“ä½œä¼šå‘ç”Ÿåœ¨åç»­çš„è¯»æ“ä½œä¹‹å‰ï¼Œä½†å®ƒå¹¶ä¸èƒ½ä¿è¯åŸå­æ€§ã€‚</li>\n<li>AtomicIntegerç±»æä¾›çš„atomicæ–¹æ³•å…·æœ‰åŸå­æ€§</li>\n</ul>\n<h1>91.3. ä»€ä¹ˆæ˜¯ Callableã€Futureã€FutureTaskï¼Ÿ</h1>\n<ul>\n<li>Callable æ¥å£ç±»ä¼¼å›è°ƒçš„ Runnableå¯ä»¥è¢« Future æ‹¿åˆ°</li>\n<li>Future æ¥å£ï¼Œè¡¨ç¤ºå¼‚æ­¥ä»»åŠ¡ï¼Œæ˜¯è¿˜æ²¡æœ‰å®Œæˆçš„ä»»åŠ¡ç»™å‡ºçš„æœªæ¥ç»“æœã€‚æ‰€ä»¥è¯´ Callable ç”¨äºäº§ç”Ÿç»“æœï¼ŒFuture ç”¨äºè·å–ç»“æœã€‚</li>\n<li>FutureTaskè¡¨ç¤ºä¸€ä¸ªå¯ä»¥å–æ¶ˆçš„å¼‚æ­¥è¿ç®—ã€‚å®ƒæœ‰å¯åŠ¨å’Œå–æ¶ˆè¿ç®—ã€æŸ¥è¯¢è¿ç®—æ˜¯å¦å®Œæˆå’Œå–å›è¿ç®—ç»“æœç­‰æ–¹æ³•ã€‚åªæœ‰å½“è¿ç®—å®Œæˆçš„æ—¶å€™ç»“æœæ‰èƒ½å–å›ï¼Œå¦‚æœè¿ç®—å°šæœªå®Œæˆgetæ–¹æ³•å°†ä¼šé˜»å¡ã€‚å®ç°åŸºäºAQS</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/9c42c9f380bcb496ccaae.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "jvm",
      "url": "https://javaguide.cn/interview/javavirtualmachine.html",
      "id": "https://javaguide.cn/interview/javavirtualmachine.html",
      "summary": "1. ä»€ä¹ˆæ˜¯JVM? JVMï¼ŒJavaè™šæ‹Ÿæœºï¼ŒJavaå®ç°è·¨å¹³å°çš„åŸºçŸ³ã€‚Java ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šå°† Java æºä»£ç ï¼ˆ.javaï¼‰ç¼–è¯‘æˆå¹³å°æ— å…³çš„ Java å­—èŠ‚ç æ–‡ä»¶ï¼ˆ.classï¼‰ï¼Œæ¥ä¸‹æ¥å¯¹åº”å¹³å°çš„ JVM ä¼šå¯¹å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œè§£é‡Šï¼Œç¿»è¯‘æˆå¯¹åº”å¹³å°çš„æœºå™¨æŒ‡ä»¤å¹¶è¿è¡Œã€‚ 2. Jvmä¸»è¦ç»„æˆéƒ¨åˆ†åŠå…¶ä½œç”¨ï¼Ÿ ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ï¼šè´Ÿ...",
      "content_html": "\n<ul>\n<li>JVMï¼ŒJavaè™šæ‹Ÿæœºï¼ŒJavaå®ç°è·¨å¹³å°çš„åŸºçŸ³ã€‚Java ç¨‹åºè¿è¡Œçš„æ—¶å€™ï¼Œç¼–è¯‘å™¨ä¼šå°† Java æºä»£ç ï¼ˆ.javaï¼‰ç¼–è¯‘æˆå¹³å°æ— å…³çš„ Java å­—èŠ‚ç æ–‡ä»¶ï¼ˆ.classï¼‰ï¼Œæ¥ä¸‹æ¥å¯¹åº”å¹³å°çš„ JVM ä¼šå¯¹å­—èŠ‚ç æ–‡ä»¶è¿›è¡Œè§£é‡Šï¼Œç¿»è¯‘æˆå¯¹åº”å¹³å°çš„æœºå™¨æŒ‡ä»¤å¹¶è¿è¡Œã€‚</li>\n</ul>\n<h1>2. Jvmä¸»è¦ç»„æˆéƒ¨åˆ†åŠå…¶ä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰ï¼šè´Ÿè´£ä»æ–‡ä»¶ç³»ç»Ÿã€ç½‘ç»œæˆ–å…¶ä»–æ¥æºåŠ è½½Classæ–‡ä»¶ï¼Œå°†Classæ–‡ä»¶ä¸­çš„äºŒè¿›åˆ¶æ•°æ®è¯»å…¥åˆ°å†…å­˜ä¸­</p>\n</li>\n<li>\n<p>è¿è¡Œæ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰JVM åœ¨æ‰§è¡Œ Java ç¨‹åºæ—¶ï¼Œéœ€è¦åœ¨å†…å­˜ä¸­åˆ†é…ç©ºé—´æ¥å¤„ç†å„ç§æ•°æ®ï¼Œè¿™äº›å†…å­˜åŒºåŸŸä¸»è¦åŒ…æ‹¬æ–¹æ³•åŒºã€å †ã€æ ˆã€ç¨‹åºè®¡æ•°å™¨å’Œæœ¬åœ°æ–¹æ³•æ ˆã€‚</p>\n</li>\n<li>\n<p>æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰è´Ÿè´£æ‰§è¡Œclassæ–‡ä»¶ä¸­åŒ…å«çš„å­—èŠ‚ç æŒ‡ä»¤ï¼ŒåŒ…æ‹¬ä¸€ä¸ªè™šæ‹Ÿå¤„ç†å™¨ï¼Œè¿˜åŒ…æ‹¬å³æ—¶ç¼–è¯‘å™¨ï¼ˆJIT Compilerï¼‰å’Œåƒåœ¾å›æ”¶å™¨ï¼ˆGarbage Collectorï¼‰ã€‚</p>\n</li>\n<li>\n<p>æœ¬åœ°åº“æ¥å£ï¼ˆNative Interfaceï¼‰è°ƒç”¨Cæˆ–C++å®ç°çš„æœ¬åœ°æ–¹æ³•çš„ä»£ç è¿”å›ç»“æœ</p>\n</li>\n<li>\n<p>å„ç»„ä»¶çš„ä½œç”¨ï¼šé¦–å…ˆé€šè¿‡ç±»åŠ è½½å™¨ï¼ˆClassLoaderï¼‰æŠŠJavaä»£ç è½¬æ¢æˆå­—èŠ‚ç ï¼Œè¿è¡Œæ—¶æ•°æ®åŒºï¼ˆRuntime Data Areaï¼‰å†æŠŠå­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç”±ç‰¹å®šçš„å‘½ä»¤è§£æå™¨æ‰§è¡Œå¼•æ“ï¼ˆExecution Engineï¼‰ï¼Œå°†å­—èŠ‚ç ç¿»è¯‘æˆåº•å±‚ç³»ç»ŸæŒ‡ä»¤ï¼Œå†äº¤ç”±CPUæ‰§è¡Œï¼Œè€Œè¿™ä¸ªè¿‡ç¨‹ä¸­éœ€è¦è°ƒç”¨å…¶ä»–è¯­è¨€çš„æœ¬åœ°åº“æ¥å£ï¼ˆNative Interfaceï¼‰æ¥å®ç°æ•´ä¸ªç¨‹åºçš„åŠŸèƒ½<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/70d43d52d3b9c5460213d.png\" alt=\"jvmstructure.jpg\"></p>\n</li>\n</ul>\n<h1>3. è°ˆè°ˆå¯¹è¿è¡Œæ—¶æ•°æ®åŒºçš„ç†è§£ï¼Ÿ</h1>\n<ul>\n<li>ç¨‹åºè®¡æ•°å™¨(Program Counter Register)(çº¿ç¨‹ç§æœ‰) å½“å‰çº¿ç¨‹æ‰€æ‰§è¡Œçš„å­—èŠ‚ç çš„è¡Œå·æŒ‡ç¤ºå™¨</li>\n<li>javaè™šæ‹Ÿæœºæ ˆ(Java Virtual Machine Statcks)(çº¿ç¨‹ç§æœ‰)javaæ–¹æ³•æ‰§è¡Œçš„å†…å­˜æ¨¡å‹ï¼Œç”Ÿå‘½å‘¨æœŸä¸çº¿ç¨‹ç›¸åŒã€‚å½“çº¿ç¨‹æ‰§è¡Œä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œä¼šåˆ›å»ºä¸€ä¸ªå¯¹åº”çš„æ ˆå¸§ï¼Œç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ã€æ“ä½œæ•°æ ˆã€åŠ¨æ€é“¾æ¥ã€æ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ï¼Œç„¶åæ ˆå¸§ä¼šè¢«å‹å…¥æ ˆä¸­ã€‚å½“æ–¹æ³•æ‰§è¡Œå®Œæ¯•åï¼Œæ ˆå¸§ä¼šä»æ ˆä¸­ç§»é™¤ã€‚</li>\n<li>æœ¬åœ°æ–¹æ³•æ ˆ(Native Method Stack)(çº¿ç¨‹ç§æœ‰) æ‰§è¡Œè™šæ‹Ÿæœºä½¿ç”¨åˆ°çš„nativeæ–¹æ³•æœåŠ¡ã€‚å­˜æ”¾äº†nativeæ–¹æ³•çš„å±€éƒ¨å˜é‡ã€åŠ¨æ€é“¾æ¥å’Œæ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯</li>\n<li>javaå †(Java Heap)(çº¿ç¨‹å…±äº«)ä¸»è¦ç”¨äºå­˜æ”¾å¯¹è±¡å®ä¾‹ï¼Œå‡ ä¹æ‰€æœ‰çš„å¯¹è±¡å®ä¾‹éƒ½åœ¨è¿™åˆ†é…å†…å­˜</li>\n<li>æ–¹æ³•åŒºï¼ˆMethod Areaï¼‰å’Œè¿è¡Œæ—¶å¸¸é‡æ± (Runtime Constant Pool)(çº¿ç¨‹å…±äº«)å¹¶ä¸çœŸå®å­˜åœ¨ï¼Œå±äºJava è™šæ‹Ÿæœºè§„èŒƒä¸­çš„ä¸€ä¸ªé€»è¾‘æ¦‚å¿µï¼Œå­˜å‚¨å·²è¢«è™šæ‹ŸæœºåŠ è½½çš„ç±»ä¿¡æ¯ï¼Œå¸¸é‡ï¼Œé™æ€å˜é‡ï¼Œå³æ—¶ç¼–è¯‘å™¨ç¼–è¯‘åçš„ä»£ç ç­‰æ•°æ®ã€‚åœ¨ HotSpot è™šæ‹Ÿæœºä¸­ï¼Œæ–¹æ³•åŒºçš„å®ç°ç§°ä¸ºæ°¸ä¹…ä»£ï¼ˆPermGenï¼‰ï¼Œåœ¨Jdk1.8åï¼Œå·²ç»è¢«å…ƒç©ºé—´ï¼ˆMetaspaceï¼‰æ‰€æ›¿ä»£ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/75528e4b71c72c5449bd7.png\" alt=\"jvmmemorystructure.jpg\"></li>\n</ul>\n<h1>4. Javaå†…å­˜å †å’Œæ ˆåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>å †å±äºçº¿ç¨‹å…±äº«çš„å†…å­˜åŒºåŸŸï¼Œæ ˆå±äºçº¿ç¨‹ç§æœ‰çš„å†…å­˜åŒºåŸŸ</li>\n<li>å †å­˜å‚¨å¤§éƒ¨åˆ†å¯¹è±¡ï¼Œæ ˆå­˜å‚¨å±€éƒ¨å˜é‡ã€æ–¹æ³•å‚æ•°ã€å¯¹è±¡å¼•ç”¨ç­‰</li>\n<li>å †å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå¯ä»¥åœ¨æ–¹æ³•è°ƒç”¨ç»“æŸåç»§ç»­å­˜åœ¨ï¼Œç›´åˆ°ä¸å†è¢«ä»»ä½•å˜é‡å¼•ç”¨ï¼Œç„¶åè¢«åƒåœ¾æ”¶é›†å™¨å›æ”¶ã€‚æ ˆå¯¹è±¡é€šå¸¸éšç€æ–¹æ³•è°ƒç”¨çš„ç»“æŸè€Œè‡ªåŠ¨é‡Šæ”¾ï¼Œä¸éœ€è¦åƒåœ¾æ”¶é›†å™¨å¤„ç†</li>\n</ul>\n<h1>5. JDK678å†…å­˜åŒºåŸŸçš„å˜åŒ–</h1>\n<ul>\n<li>JDK1.6 ä½¿ç”¨æ°¸ä¹…ä»£å®ç°æ–¹æ³•åŒº<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/bbae62bdce7fa9267b600.png\" alt=\"jdk6memory.png\"></li>\n<li>JDK1.7 æ—¶å‘ç”Ÿäº†ä¸€äº›å˜åŒ–ï¼Œå°†å­—ç¬¦ä¸²å¸¸é‡æ± ã€é™æ€å˜é‡ï¼Œå­˜æ”¾åœ¨å †ä¸Š<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ba9fce13a180a20954a3b.png\" alt=\"jdk7memory.png\"></li>\n<li>åœ¨ JDK1.8 æ—¶å½»åº•å¹²æ‰äº†æ°¸ä¹…ä»£ï¼Œè€Œåœ¨ç›´æ¥å†…å­˜ä¸­åˆ’å‡ºä¸€å—åŒºåŸŸä½œä¸ºå…ƒç©ºé—´ï¼Œè¿è¡Œæ—¶å¸¸é‡æ± ã€ç±»å¸¸é‡æ± éƒ½ç§»åŠ¨åˆ°å…ƒç©ºé—´ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d9b02e589e79a1b781b2b.png\" alt=\"jdk8memory.png\"></li>\n</ul>\n<h1>6. javaå¯¹è±¡ï¼ˆæ™®é€šJavaå¯¹è±¡ï¼Œä¸åŒ…æ‹¬æ•°ç»„å’ŒClasså¯¹è±¡ç­‰ï¼‰åˆ›å»ºè¿‡ç¨‹ï¼Ÿ</h1>\n<ul>\n<li>1.ç±»åŠ è½½æ£€æŸ¥ï¼šè™šæ‹Ÿæœºé‡åˆ°ä¸€æ¡newæŒ‡ä»¤æ—¶ï¼Œé¦–å…ˆæ£€æŸ¥è¿™ä¸ªæŒ‡ä»¤çš„å‚æ•°æ˜¯å¦èƒ½åœ¨å¸¸é‡æ± ä¸­å®šä½åˆ°ä¸€ä¸ªç±»çš„ç¬¦å·çš„å¼•ç”¨ï¼Œä»¥åŠè¿™ä¸ªç¬¦å·å¼•ç”¨ä»£è¡¨çš„ç±»æ˜¯å¦å·²è¢«åŠ è½½ï¼Œè§£æå’Œåˆå§‹åŒ–è¿‡ï¼Œå¦‚æœæ²¡æœ‰ï¼Œåˆ™æ‰§è¡Œç±»åŠ è½½è¿‡ç¨‹</li>\n<li>2.åˆ†é…å†…å­˜ï¼šä¸ºæ–°ç”Ÿå¯¹è±¡åˆ†é…å†…å­˜ï¼Œå†…å­˜å¤§å°åœ¨ç±»åŠ è½½å®Œæˆåä¾¿å¯å®Œå…¨ç¡®å®šã€‚ä¸ºå¯¹è±¡åˆ†é…ç©ºé—´çš„ä»»åŠ¡ç­‰åŒäºæŠŠä¸€å—ç¡®å®šå¤§å°çš„å†…å­˜ä»javaå †ä¸­åˆ’åˆ†å‡ºæ¥ã€‚æœ‰2ç§åˆ†é…æ–¹æ³•</li>\n<li>3.åˆå§‹åŒ–ï¼šå°†åˆ†é…åˆ°çš„å†…å­˜ç©ºé—´éƒ½åˆå§‹åŒ–ä¸ºé›¶å€¼ï¼ˆä¸åŒ…æ‹¬å¯¹è±¡å¤´ï¼‰ï¼Œå¯æå‰è‡³TLABåˆ†é…æ—¶è¿›è¡Œã€‚ä¿è¯äº†å¯¹è±¡å®ä¾‹å­—æ®µåœ¨javaä»£ç ä¸­ä¸èµ‹åˆå§‹å€¼å°±èƒ½è®¿é—®åˆ°è¿™äº›å­—æ®µçš„æ•°æ®ç±»å‹æ‰€å¯¹åº”çš„é›¶å€¼</li>\n<li>4.è®¾ç½®å¯¹è±¡å¤´ä¿¡æ¯ï¼šå¯¹å¯¹è±¡è¿›è¡Œè®¾ç½®ï¼Œä¾‹å¦‚è¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ï¼Œå¦‚ä½•æ‰èƒ½æ‰¾åˆ°ç±»çš„å…ƒæ•°æ®ä¿¡æ¯ï¼Œå¯¹è±¡çš„å“ˆå¸Œç ï¼Œå¯¹è±¡GCåˆ†ä»£å¹´é¾„ç­‰ä¿¡æ¯ã€‚è¿™äº›ä¿¡æ¯å­˜æ”¾åœ¨å¯¹è±¡çš„å¯¹è±¡å¤´(Object Header)ä¸­</li>\n<li>5.ä¸Šé¢çš„å·¥ä½œå®Œæˆåï¼Œä»è™šæ‹Ÿæœºçš„è§’åº¦çœ‹ï¼Œä¸€ä¸ªæ–°çš„å¯¹è±¡å·²ç»äº§ç”Ÿäº†ï¼Œä½†ä»javaç¨‹åºçš„è§†è§’çœ‹è¿˜éœ€è¦æ‰§è¡Œinitæ–¹æ³•ã€‚ç”±å­—èŠ‚ç ä¸­æ˜¯å¦è·ŸéšinvokespecialæŒ‡ä»¤æ‰€å†³å®šï¼Œæ‰§è¡ŒnewæŒ‡ä»¤ä¹‹åä¼šæ¥ç€æ‰§è¡Œinitæ–¹æ³•ï¼ŒæŠŠå¯¹è±¡åˆå§‹åŒ–ï¼Œè¿™æ ·ä¸€ä¸ªçœŸæ­£å¯ç”¨çš„å¯¹è±¡æ‰ç®—å®Œå…¨ç”Ÿäº§å‡ºæ¥ã€‚</li>\n</ul>\n<h1>7. å¯¹è±¡çš„é”€æ¯è¿‡ç¨‹äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>å¯¹è±¡åˆ›å»ºå®Œæˆåï¼Œå°±å¯ä»¥é€šè¿‡å¼•ç”¨æ¥è®¿é—®å¯¹è±¡çš„æ–¹æ³•å’Œå±æ€§ï¼Œå½“å¯¹è±¡ä¸å†è¢«ä»»ä½•å¼•ç”¨æŒ‡å‘æ—¶ï¼Œå¯¹è±¡å°±ä¼šå˜æˆåƒåœ¾ã€‚åƒåœ¾æ”¶é›†å™¨ä¼šé€šè¿‡å¯è¾¾æ€§åˆ†æç®—æ³•åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»ï¼Œå¦‚æœå¯¹è±¡ä¸å¯è¾¾ï¼Œå°±ä¼šè¢«å›æ”¶ã€‚åƒåœ¾æ”¶é›†å™¨ä¼šé€šè¿‡æ ‡è®°æ¸…é™¤ã€æ ‡è®°å¤åˆ¶ã€æ ‡è®°æ•´ç†ç­‰ç®—æ³•æ¥å›æ”¶å†…å­˜ï¼Œå°†å¯¹è±¡å ç”¨çš„å†…å­˜ç©ºé—´é‡Šæ”¾å‡ºæ¥ã€‚å¸¸ç”¨çš„åƒåœ¾æ”¶é›†å™¨æœ‰ CMSã€G1ã€ZGC ç­‰ï¼Œå®ƒä»¬çš„å›æ”¶ç­–ç•¥å’Œæ•ˆç‡ä¸åŒï¼Œå¯ä»¥æ ¹æ®å…·ä½“çš„åœºæ™¯é€‰æ‹©åˆé€‚çš„åƒåœ¾æ”¶é›†å™¨ã€‚</li>\n</ul>\n<h1>8. ä»€ä¹ˆæ˜¯æŒ‡é’ˆç¢°æ’ï¼Ÿä»€ä¹ˆæ˜¯ç©ºé—²åˆ—è¡¨ï¼Ÿjavaå†…å­˜åˆ†é…æ–¹æ³•</h1>\n<ul>\n<li>å†…å­˜åˆ†é…æœ‰ä¸¤ç§æ–¹å¼ï¼ŒæŒ‡é’ˆç¢°æ’ï¼ˆBump The Pointerï¼‰ã€ç©ºé—²åˆ—è¡¨ï¼ˆFree Listï¼‰ã€‚</li>\n<li>æŒ‡é’ˆç¢°æ’(Bump the Pointer)ï¼šå‡è®¾å †å†…å­˜æ˜¯ä¸€ä¸ªè¿ç»­çš„ç©ºé—´ï¼Œåˆ†ä¸ºä¸¤ä¸ªéƒ¨åˆ†ï¼Œä¸€éƒ¨åˆ†æ˜¯å·²ç»è¢«ä½¿ç”¨çš„å†…å­˜ï¼Œå¦ä¸€éƒ¨åˆ†æ˜¯æœªè¢«ä½¿ç”¨çš„å†…å­˜ã€‚åœ¨åˆ†é…å†…å­˜æ—¶ï¼ŒJava è™šæ‹Ÿæœºç»´æŠ¤ä¸€ä¸ªæŒ‡é’ˆï¼ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå¯ç”¨çš„å†…å­˜åœ°å€ï¼Œæ¯æ¬¡åˆ†é…å†…å­˜æ—¶ï¼Œåªéœ€è¦å°†æŒ‡é’ˆå‘åç§»åŠ¨ï¼ˆç¢°æ’ï¼‰ä¸€æ®µè·ç¦»ï¼Œç„¶åå°†è¿™æ®µå†…å­˜åˆ†é…ç»™å¯¹è±¡å®ä¾‹å³å¯ã€‚</li>\n<li>ç©ºé—²åˆ—è¡¨(Free List)ï¼šå¦‚æœjavaå †ä¸­çš„å†…å­˜ä¸è¿ç»­ï¼Œå·²ä½¿ç”¨çš„å†…å­˜å’Œç©ºé—²çš„å†…å­˜ç›¸äº’äº¤é”™ï¼Œè™šæ‹Ÿæœºå°±å¿…é¡»ç»´æŠ¤ä¸€ä¸ªåˆ—è¡¨ï¼Œè®°å½•å¯ç”¨çš„å†…å­˜å—ï¼Œä»åˆ—è¡¨ä¸­æ‰¾åˆ°ä¸€å—è¶³å¤Ÿå¤§çš„ç©ºé—´åˆ†é…ç»™å¯¹è±¡å®ä¾‹ï¼Œå¹¶æ›´æ–°åˆ—è¡¨ä¸Šçš„è®°å½•ï¼Œè¿™ç§åˆ†é…æ–¹å¼ç§°ä¸ºç©ºé—²åˆ—è¡¨(Free List)</li>\n<li>æŒ‡é’ˆç¢°æ’é€‚ç”¨äºç®¡ç†ç®€å•ã€ç¢ç‰‡åŒ–è¾ƒå°‘çš„å†…å­˜åŒºåŸŸï¼ˆå¦‚å¹´è½»ä»£ï¼‰ï¼Œè€Œç©ºé—²åˆ—è¡¨é€‚ç”¨äºå†…å­˜ç¢ç‰‡åŒ–è¾ƒä¸¥é‡æˆ–å¯¹è±¡å¤§å°å·®å¼‚è¾ƒå¤§çš„åœºæ™¯ï¼ˆå¦‚è€å¹´ä»£ï¼‰ã€‚</li>\n</ul>\n<h1>9. JVMé‡Œnewå¯¹è±¡æ—¶ï¼Œå †ä¼šå‘ç”ŸæŠ¢å å—ï¼ŸJVM æ˜¯æ€ä¹ˆè®¾è®¡æ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„ï¼Ÿ</h1>\n<ul>\n<li>è§£å†³åˆ†é…å†…å­˜æ—¶çº¿ç¨‹ä¸å®‰å…¨ï¼ˆå¤šçº¿ç¨‹å¹¶å‘æ—¶æ­£åœ¨ç»™å¯¹è±¡Aåˆ†é…å†…å­˜ï¼Œè¿˜æ²¡æ¥å¾—åŠä¿®æ”¹æŒ‡é’ˆï¼Œå¯¹è±¡Båˆç”¨è¿™ä¸ªæŒ‡é’ˆåˆ†é…å†…å­˜ï¼‰æ–¹æ¡ˆ</li>\n<li>æ–¹æ¡ˆ1å¯¹åˆ†é…å†…å­˜ç©ºé—´åŠ¨ä½œè¿›è¡ŒåŒæ­¥å¤„ç†ï¼Œé‡‡ç”¨CASé…ä¸Šå¤±è´¥é‡è¯•çš„æ–¹å¼ä¿è¯æ›´æ–°æ“ä½œçš„åŸå­æ€§</li>\n<li>æ–¹æ¡ˆ2æŠŠå†…å­˜åˆ†é…çš„åŠ¨ä½œæŒ‰ç…§çº¿ç¨‹åˆ’åˆ†åœ¨ä¸åŒçš„ç©ºé—´ä¸­è¿›è¡Œï¼Œå³æ¯ä¸ªçº¿ç¨‹åœ¨javaå †ä¸­é¢„å…ˆåˆ†é…ä¸€å°å—å†…å­˜ï¼Œç§°ä¸ºæœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼ˆThread Local Allocation Buffer,TLABï¼‰ã€‚å“ªä¸ªçº¿ç¨‹è¦åˆ†é…å†…å­˜ï¼Œå°±åœ¨å“ªä¸ªçº¿ç¨‹çš„TLABä¸Šåˆ†é…ï¼Œåªæœ‰TLABç”¨å®Œå¹¶åˆ†é…æ–°çš„TLABæ—¶ï¼Œæ‰éœ€è¦åŒæ­¥é”å®šï¼Œé€šè¿‡-XX:+/-UseTLABå‚æ•°ä½¿ç”¨TALBï¼Œ</li>\n</ul>\n<h1>10. å¯¹è±¡åœ¨å†…å­˜ä¸­çš„å­˜å‚¨å¸ƒå±€</h1>\n<ul>\n<li>å¯¹è±¡åœ¨å †çš„å†…å­˜å¸ƒå±€æ˜¯ç”± Java è™šæ‹Ÿæœºè§„èŒƒå®šä¹‰çš„ï¼Œåœ¨ HotSpot ä¸­å¯ä»¥åˆ’åˆ†ä¸ºä¸‰ä¸ªéƒ¨åˆ†ï¼š\n<ul>\n<li>å¯¹è±¡å¤´ï¼ˆObject Headerï¼‰å­˜å‚¨å †å¯¹è±¡çš„å¸ƒå±€ã€ç±»å‹ã€GCçŠ¶æ€ã€åŒæ­¥çŠ¶æ€å’Œæ ‡è¯†å“ˆå¸Œç çš„åŸºæœ¬ä¿¡æ¯ã€‚</li>\n<li>å®ä¾‹æ•°æ®ï¼ˆInstance Dataï¼‰å­˜å‚¨å¯¹è±¡çš„æ•°æ®ä¿¡æ¯ï¼Œçˆ¶ç±»çš„ä¿¡æ¯ï¼Œå¯¹è±¡å­—æ®µå±æ€§ä¿¡æ¯ã€‚</li>\n<li>å¯¹é½å¡«å……ï¼ˆPaddingï¼‰å¯é€‰ï¼Œå½“å¯¹è±¡å®ä¾‹æ•°æ®éƒ¨åˆ†æ²¡æœ‰å¯¹é½æ—¶ï¼Œå°±éœ€è¦é€šè¿‡å¯¹é½å¡«å……æ¥è¡¥å…¨ï¼Œä¸ºäº†è®¡ç®—æœºé«˜æ•ˆå¯»å€ã€‚Hotspotçš„è‡ªåŠ¨å†…å­˜ç®¡ç†ç³»ç»Ÿè¦æ±‚å¯¹è±¡çš„çœŸå®åœ°å€å’Œå¤§å°å¿…é¡»æ˜¯8å­—èŠ‚æ•´æ•°å€ã€‚å¦åˆ™æœ‰å¯èƒ½å‡ºç°è·¨ç¼“å­˜è¡Œçš„å­—æ®µã€‚æ•ˆç‡ä½</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/400b56e58c83f21914264.jpg\" alt=\"objectstructure.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0eb05907be32a0d335364.jpg\" alt=\"objectstructureandspace.png\"></p>\n<ul>\n<li>å¯¹è±¡å¤´\n<ul>\n<li>mark wordå­˜å‚¨å¯¹è±¡è‡ªèº«çš„è¿è¡Œæ•°æ®ï¼Œå¦‚å“ˆå¸Œç ï¼ŒGCåˆ†ä»£å¹´é¾„ï¼Œé”çŠ¶æ€æ ‡å¿—ï¼Œçº¿ç¨‹æŒæœ‰çš„é”ï¼Œåå‘çº¿ç¨‹IDç­‰.åœ¨64ä½æ“ä½œç³»ç»Ÿä¸‹å 8ä¸ªå­—èŠ‚ï¼Œ-XX:+/-UseCompressedClassPointers //å¼€å¯/å…³é—­å‹ç¼©ç±»æŒ‡é’ˆ,-XX:+/-UseCompressedOops//å¼€å¯/å…³é—­å‹ç¼©æ™®é€šå¯¹è±¡æŒ‡é’ˆ\n<ul>\n<li>é”æ ‡å¿—ä½ï¼ˆlockï¼‰ï¼šåŒºåˆ†é”çŠ¶æ€ï¼Œ11æ—¶è¡¨ç¤ºå¯¹è±¡å¾…GCå›æ”¶çŠ¶æ€, æœ€å2ä½é”æ ‡è¯†(11)æœ‰æ•ˆ</li>\n<li>biased_lockï¼šæ˜¯å¦åå‘é”ï¼Œç”±äºæ— é”å’Œåå‘é”çš„é”æ ‡è¯†éƒ½æ˜¯01ï¼Œæ²¡åŠæ³•åŒºåˆ†ï¼Œå¼•å…¥ä¸€ä½çš„åå‘é”æ ‡è¯†ä½</li>\n<li>åˆ†ä»£å¹´é¾„ï¼ˆageï¼‰ï¼šè¡¨ç¤ºå¯¹è±¡è¢«GCçš„æ¬¡æ•°ï¼Œå½“æ¬¡æ•°åˆ°è¾¾é˜ˆå€¼çš„æ—¶å€™ï¼Œå¯¹è±¡å°±ä¼šè½¬ç§»åˆ°è€å¹´ä»£</li>\n<li>å¯¹è±¡çš„hashcodeï¼ˆhashï¼‰ï¼šå¯¹è±¡åŠ é”åï¼Œè®¡ç®—çš„ç»“æœ31ä½ä¸å¤Ÿè¡¨ç¤ºï¼Œåœ¨åå‘é”ï¼Œè½»é‡é”ï¼Œé‡é‡é”ï¼Œhashcodeä¼šè¢«è½¬ç§»åˆ°Monitorä¸­</li>\n<li>åå‘é”çš„çº¿ç¨‹IDï¼ˆJavaThreadï¼‰ï¼šåå‘æ¨¡å¼çš„æ—¶å€™ï¼Œå½“æŸä¸ªçº¿ç¨‹æŒæœ‰åå‘é”å¯¹è±¡çš„æ—¶å€™ï¼Œå¯¹è±¡è¿™é‡Œå°±ä¼šè¢«ç½®ä¸ºè¯¥çº¿ç¨‹çš„IDã€‚ åç»­æ“ä½œæ— éœ€å†è¿›è¡Œå°è¯•è·å–é”çš„åŠ¨ä½œã€‚</li>\n<li>epochï¼šåå‘é”åœ¨CASé”æ“ä½œè¿‡ç¨‹ä¸­ï¼Œåå‘æ€§æ ‡è¯†ï¼Œè¡¨ç¤ºå¯¹è±¡æ›´åå‘å“ªä¸ªé”ã€‚</li>\n<li>ptr_to_lock_recordï¼šè½»é‡çº§é”çŠ¶æ€ä¸‹ï¼ŒJVMé€šè¿‡CASæ“ä½œåœ¨å¯¹è±¡çš„æ ‡é¢˜å­—ä¸­è®¾ç½®æŒ‡å‘æ ˆä¸­é”è®°å½•çš„æŒ‡é’ˆã€‚å½“é”è·å–æ˜¯æ— ç«äº‰çš„æ—¶ï¼ŒJVMä½¿ç”¨åŸå­æ“ä½œè€Œä¸æ˜¯OSäº’æ–¥ã€‚è¿™ç§æŠ€æœ¯ç§°ä¸ºè½»é‡çº§é”å®šã€‚</li>\n<li>ptr_to_heavyweight_monitorï¼šé‡é‡çº§é”çŠ¶æ€ä¸‹ï¼ŒæŒ‡å‘å¯¹è±¡ç›‘è§†å™¨Monitorçš„æŒ‡é’ˆã€‚å¦‚æœä¸¤ä¸ªä¸åŒçš„çº¿ç¨‹åŒæ—¶åœ¨åŒä¸€ä¸ªå¯¹è±¡ä¸Šç«äº‰ï¼Œåˆ™å¿…é¡»å°†è½»é‡çº§é”å®šå‡çº§åˆ°Monitorä»¥ç®¡ç†ç­‰å¾…çš„çº¿ç¨‹ã€‚</li>\n</ul>\n</li>\n<li>ç±»å‹æŒ‡é’ˆKlass Pointerï¼ŒæŒ‡å‘å¯¹è±¡æ‰€å±ç±»çš„å…ƒæ•°æ®çš„æŒ‡é’ˆï¼Œç”¨äºç¡®å®šè¿™ä¸ªå¯¹è±¡æ˜¯å“ªä¸ªç±»çš„å®ä¾‹ã€‚å¹¶ä¸æ˜¯æ‰€æœ‰è™šæ‹Ÿæœºå®ç°éƒ½å¿…é¡»åœ¨å¯¹è±¡æ•°æ®ä¸Šä¿ç•™ç±»å‹æŒ‡é’ˆï¼Œä¹Ÿå°±æ˜¯æŸ¥æ‰¾å¯¹è±¡çš„å…ƒæ•°æ®ä¿¡æ¯ä¸ä¸€å®šé€šè¿‡å¯¹è±¡æœ¬èº«ã€‚åœ¨å¼€å¯æŒ‡é’ˆå‹ç¼©çš„æƒ…å†µä¸‹å 4ä¸ªå­—èŠ‚ï¼Œå¦åˆ™å 8ä¸ªå­—èŠ‚ã€‚java -XX:+PrintFlagsFinal -version | grep UseCompressedOops å‘½ä»¤æ¥æŸ¥çœ‹å½“å‰ JVM æ˜¯å¦å¼€å¯äº†å‹ç¼©æŒ‡é’ˆã€‚jdk8é»˜è®¤å¼€å¯</li>\n<li>Length fieldå¦‚æœå¯¹è±¡æ˜¯javaæ•°ç»„ï¼Œå¯¹è±¡å¤´ä¸­è¿˜å¿…é¡»æœ‰ä¸€å—ç”¨äºè®°å½•æ•°ç»„é•¿åº¦çš„æ•°æ®ï¼Œå› ä¸ºè™šæ‹Ÿæœºå¯ä»¥é€šè¿‡æ™®é€šjavaå¯¹è±¡çš„å…ƒæ•°æ®ä¿¡æ¯ç¡®å®šjavaå¯¹è±¡çš„å¤§å°ï¼Œä½†æ˜¯ä»æ•°ç»„çš„å…ƒæ•°æ®ä¸­æ— æ³•ç¡®å®šæ•°ç»„çš„å¤§å°ã€‚å 4ä¸ªå­—èŠ‚ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e58f17fe68f0ddc72c4e1.jpg\" alt=\"objectheader.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b0a1f7d7ac59d447ff05f.png\" alt=\"64bithotSpotmarkword.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>11. ä¸€ä¸ªjavaå¯¹è±¡å ç”¨å¤šå¤§å†…å­˜</h1>\n<p>åœ¨æ“ä½œç³»ç»Ÿæ˜¯64ä½çš„ï¼Œå¹¶ä¸”JDK8ä¸­çš„å‹ç¼©æŒ‡é’ˆæ˜¯é»˜è®¤å¼€å¯çš„ï¼Œå› æ­¤new Object()çš„å¤§å°æ˜¯ 16 å­—èŠ‚ï¼ˆ12 å­—èŠ‚çš„å¯¹è±¡å¤´ï¼ˆ8å­—èŠ‚markword+4å­—èŠ‚ç±»å‹æŒ‡é’ˆï¼‰ + 4 å­—èŠ‚çš„å¯¹é½å¡«å……ï¼‰ã€‚</p>\n<ul>\n<li>ä½¿ç”¨ JOL å·¥å…·æ¥æŸ¥çœ‹å¯¹è±¡çš„å†…å­˜å¸ƒå±€</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.openjdk.jol&lt;/groupId&gt;\n    &lt;artifactId&gt;jol-core&lt;/artifactId&gt;\n    &lt;version&gt;0.9&lt;/version&gt;\n&lt;/dependency&gt;\npublic class JOLSample {\n    public static void main(String[] args) {\n        // æ‰“å°JVMè¯¦ç»†ä¿¡æ¯ï¼ˆå¯é€‰ï¼‰\n        System.out.println(VM.current().details());\n\n        // åˆ›å»ºObjectå®ä¾‹\n        Object obj = new Object();\n\n        // æ‰“å°Objectå®ä¾‹çš„å†…å­˜å¸ƒå±€\n        String layout = ClassLayout.parseInstance(obj).toPrintable();\n        System.out.println(layout);\n    }\n}\n\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/cf23960d893800508fdad.png\" alt=\"javaobjectsize.png\" tabindex=\"0\"><figcaption>javaobjectsize.png</figcaption></figure>\n<ul>\n<li>OFFSETï¼šåç§»åœ°å€ï¼Œå•ä½å­—èŠ‚ï¼›</li>\n<li>SIZEï¼šå ç”¨çš„å†…å­˜å¤§å°ï¼Œå•ä½å­—èŠ‚ï¼›</li>\n<li>TYPE DESCRIPTIONï¼šç±»å‹æè¿°ï¼Œå…¶ä¸­ object header ä¸ºå¯¹è±¡å¤´ï¼›</li>\n<li>VALUEï¼šå¯¹åº”å†…å­˜ä¸­å½“å‰å­˜å‚¨çš„å€¼ï¼ŒäºŒè¿›åˆ¶ 32 ä½ï¼›</li>\n<li>å¯¹è±¡å¤´æ˜¯ 12 ä¸ªå­—èŠ‚ï¼Œè¿˜æœ‰ 4 ä¸ªå­—èŠ‚çš„ paddingï¼Œä¸€å…± 16 ä¸ªå­—èŠ‚ã€‚</li>\n</ul>\n<h1>12. å¯¹è±¡å¼•ç”¨å å¤šå°‘å¤§å°ï¼Ÿ</h1>\n<ul>\n<li>HotSpot JVM é»˜è®¤å¼€å¯äº†å‹ç¼©æŒ‡é’ˆï¼Œåœ¨ 64 ä½JVM ä¸Šï¼Œå¯¹è±¡å¼•ç”¨å ç”¨ 4 å­—èŠ‚ã€‚å…³é—­åˆ™æ˜¯8å­—èŠ‚</li>\n<li>ReferenceHolder.referenceå­—æ®µä½äºåç§»é‡12ï¼Œä¸º4å­—èŠ‚ã€‚è¿™è¡¨æ˜åœ¨64ä½JVMä¸‹ä¸”å‹ç¼©æŒ‡é’ˆå¼€å¯ï¼Œå¯¹è±¡å¼•ç”¨å ç”¨çš„å†…å­˜å¤§å°ä¸º4å­—èŠ‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>class ReferenceSizeExample {\n    private static class ReferenceHolder {\n        Object reference;\n    }\n\n    public static void main(String[] args) {\n        System.out.println(VM.current().details());\n        System.out.println(ClassLayout.parseClass(ReferenceHolder.class).toPrintable());\n    }\n}\n\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/915406ceed01532cc31a6.png\" alt=\"javaobjectreferencesize.png\" tabindex=\"0\"><figcaption>javaobjectreferencesize.png</figcaption></figure>\n<h1>13. å¯¹è±¡æ€ä¹ˆè®¿é—®å®šä½ï¼Ÿ</h1>\n<ul>\n<li>Java ç¨‹åºä¼šé€šè¿‡æ ˆä¸Šçš„ reference æ•°æ®æ¥è®¿é—®å †ä¸Šçš„å…·ä½“å¯¹è±¡ã€‚reference ç±»å‹æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡çš„å¼•ç”¨ï¼Œæ˜¯ç”±è™šæ‹Ÿæœºå®ç°è€Œå®šçš„ï¼Œä¸»æµçš„è®¿é—®æ–¹å¼ä¸»è¦æœ‰ä½¿ç”¨å¥æŸ„å’Œç›´æ¥æŒ‡é’ˆä¸¤ç§ï¼š\n<ul>\n<li>å¦‚æœä½¿ç”¨å¥æŸ„è®¿é—®çš„è¯ï¼ŒJava å †ä¸­å°†å¯èƒ½ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜æ¥ä½œä¸ºå¥æŸ„æ± ï¼Œreference ä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªå…·ä½“çš„åœ°å€ä¿¡æ¯ï¼Œæœ€å¤§å¥½å¤„å°±æ˜¯ reference ä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šå¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨ï¼ˆåƒåœ¾æ”¶é›†æ—¶ç§»åŠ¨å¯¹è±¡æ˜¯éå¸¸æ™®éçš„è¡Œä¸ºï¼‰æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œ reference æœ¬èº«ä¸éœ€è¦è¢«ä¿®æ”¹ã€‚</li>\n<li>å¦‚æœä½¿ç”¨ç›´æ¥æŒ‡é’ˆè®¿é—®çš„è¯ï¼ŒJava å †ä¸­å¯¹è±¡çš„å†…å­˜å¸ƒå±€å°±å¿…é¡»è€ƒè™‘å¦‚ä½•æ”¾ç½®è®¿é—®ç±»å‹æ•°æ®çš„ç›¸å…³ä¿¡æ¯ï¼Œreference ä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡åœ°å€ï¼Œå¦‚æœåªæ˜¯è®¿é—®å¯¹è±¡æœ¬èº«çš„è¯ï¼Œå°±ä¸éœ€è¦å¤šä¸€æ¬¡é—´æ¥è®¿é—®çš„å¼€é”€ï¼Œæœ€å¤§çš„å¥½å¤„å°±æ˜¯é€Ÿåº¦æ›´å¿«ï¼Œå®ƒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ï¼Œç”±äºå¯¹è±¡è®¿é—®åœ¨ Java ä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤è¿™ç±»å¼€é”€ç§¯å°‘æˆå¤šä¹Ÿæ˜¯ä¸€é¡¹æä¸ºå¯è§‚çš„æ‰§è¡Œæˆæœ¬ã€‚</li>\n</ul>\n</li>\n<li>HotSpot è™šæ‹Ÿæœºä¸»è¦ä½¿ç”¨ç›´æ¥æŒ‡é’ˆæ¥è¿›è¡Œå¯¹è±¡è®¿é—®ã€‚</li>\n</ul>\n<h1>14. å†…å­˜æº¢å‡ºå’Œå†…å­˜æ³„æ¼æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</h1>\n<ul>\n<li>å†…å­˜æº¢å‡ºï¼šæŒ‡å½“ç¨‹åºè¯·æ±‚åˆ†é…å†…å­˜æ—¶ï¼Œç”±äºæ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´æ»¡è¶³å…¶éœ€æ±‚ï¼Œä¼šæŠ›å‡º OutOfMemoryErrorã€‚å†…å­˜æº¢å‡ºå¯èƒ½æ˜¯ç”±äºå†…å­˜æ³„æ¼æˆ–è€…ç¨‹åºä¸€æ¬¡æ€§å°è¯•åˆ†é…å¤§é‡å†…å­˜ï¼Œå†…å­˜ç›´æ¥å°±å¹²å´©æºƒäº†å¯¼è‡´çš„</li>\n<li>å†…å­˜æ³„æ¼ï¼šæ˜¯æŒ‡ç¨‹åºåœ¨ä½¿ç”¨å®Œå†…å­˜åï¼Œæœªèƒ½é‡Šæ”¾å·²åˆ†é…çš„å†…å­˜ç©ºé—´ï¼Œå¯¼è‡´è¿™éƒ¨åˆ†å†…å­˜æ— æ³•å†è¢«ä½¿ç”¨ã€‚éšç€æ—¶é—´çš„æ¨ç§»ï¼Œå†…å­˜æ³„æ¼ä¼šå¯¼è‡´å¯ç”¨å†…å­˜é€æ¸å‡å°‘ï¼Œæœ€ç»ˆå¯èƒ½å¯¼è‡´å†…å­˜æº¢å‡ºã€‚</li>\n<li>å†…å­˜æ³„æ¼é€šå¸¸å‘ç”Ÿåœ¨é•¿æœŸå­˜æ´»çš„å¯¹è±¡æŒæœ‰çŸ­æœŸå­˜æ´»å¯¹è±¡çš„å¼•ç”¨ï¼Œè€Œé•¿æœŸå­˜æ´»çš„å¯¹è±¡åˆæ²¡æœ‰åŠæ—¶é‡Šæ”¾å¯¹çŸ­æœŸå­˜æ´»å¯¹è±¡çš„å¼•ç”¨ï¼Œä»è€Œå¯¼è‡´çŸ­æœŸå­˜æ´»å¯¹è±¡æ— æ³•è¢«å›æ”¶ã€‚</li>\n</ul>\n<h1>15. ä¸¾å‡ ä¸ªå¯èƒ½å‘ç”Ÿå†…å­˜æ³„æ¼çš„æƒ…å†µï¼Ÿjavaå†…å­˜æ³„æ¼çš„ä¾‹å­æœ‰å“ªäº›ï¼Ÿä¸¾ä¾‹å¹¶ä¸”è¯´æ˜è§£å†³æ–¹æ³•</h1>\n<ul>\n<li>é™æ€é›†åˆç±»ï¼šé™æ€é›†åˆçš„ç”Ÿå‘½å‘¨æœŸå’ŒJVMä¸€è‡´ï¼Œæ‰€ä»¥é™æ€é›†åˆå¼•ç”¨çš„å¯¹è±¡ä¸èƒ½è¢«é‡Šæ”¾ã€‚å°½é‡ä¸è¦ä½¿ç”¨staticæˆå‘˜å˜é‡ï¼Œå‡å°‘ç”Ÿå‘½å‘¨æœŸ</li>\n<li>å•ä¾‹æ¨¡å¼ï¼šå•ä¾‹å¯¹è±¡åœ¨åˆå§‹åŒ–åå°†åœ¨JVMçš„æ•´ä¸ªç”Ÿå‘½å‘¨æœŸä¸­å­˜åœ¨ï¼ˆä»¥é™æ€å˜é‡çš„æ–¹å¼ï¼‰ï¼Œå¦‚æœå•ä¾‹å¯¹è±¡æŒæœ‰å¤–éƒ¨çš„å¼•ç”¨ï¼Œé‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°†ä¸èƒ½è¢«JVMæ­£å¸¸å›æ”¶ï¼Œå¯¼è‡´å†…å­˜æ³„æ¼ã€‚</li>\n<li>å„ç§è¿æ¥ï¼šæ¯”å¦‚æ•°æ®åº“è¿æ¥ï¼Œç½‘ç»œè¿æ¥(socket) å’ŒIOè¿æ¥ï¼Œé™¤éè°ƒç”¨close()æ–¹æ³•å°†å…¶è¿æ¥å…³é—­ï¼Œå¦åˆ™æ˜¯ä¸ä¼šè‡ªåŠ¨è¢«GCå›æ”¶ï¼›åŠæ—¶å…³é—­èµ„æº</li>\n<li>å˜é‡ä¸åˆç†çš„ä½œç”¨åŸŸï¼šå˜é‡çš„å®šä¹‰ä½œç”¨åŸŸå¤§äºå…¶ä½¿ç”¨èŒƒå›´æˆ–ä¸å†ä½¿ç”¨å¯¹è±¡æ²¡æœ‰åŠæ—¶å°†å¯¹è±¡è®¾ç½®ä¸º nullï¼Œå¾ˆå¯èƒ½å¯¼è‡´å†…å­˜æ³„æ¼çš„å‘ç”Ÿã€‚ä¸ç”¨çš„å¯¹è±¡ï¼Œæ‰‹åŠ¨è®¾ç½®ä¸ºnull</li>\n<li>hashå€¼å‘ç”Ÿå˜åŒ–ï¼šå¯¹è±¡ä¿®æ”¹åçš„Hashå€¼å’Œå­˜å‚¨è¿›å®¹å™¨æ—¶çš„Hashå€¼ä¸åŒï¼Œæ‰€ä»¥æ— æ³•æ‰¾åˆ°å­˜å…¥çš„å¯¹è±¡ï¼Œæ— æ³•å•ç‹¬åˆ é™¤</li>\n<li>ThreadLocal ä½¿ç”¨ä¸å½“ã€‚ä½¿ç”¨å®Œ ThreadLocal ä¸€å®šè¦è®°å¾—ä½¿ç”¨ remove æ–¹æ³•æ¥è¿›è¡Œæ¸…é™¤ã€‚</li>\n<li>ç›‘å¬å™¨ï¼šé‡Šæ”¾å¯¹è±¡çš„æ—¶å€™æ²¡æœ‰åˆ é™¤ç›‘å¬å™¨ï¼›</li>\n<li>å†…éƒ¨ç±»ï¼šå†…éƒ¨ç±»çš„å¼•ç”¨æ˜¯æ¯”è¾ƒå®¹æ˜“é—å¿˜çš„ä¸€ç§ï¼Œè€Œä¸”ä¸€æ—¦æ²¡é‡Šæ”¾å¯èƒ½å¯¼è‡´ä¸€ç³»åˆ—çš„åç»§ç±»å¯¹è±¡æ²¡æœ‰é‡Šæ”¾ï¼›</li>\n</ul>\n<h1>16. jvmåƒåœ¾å›æ”¶æœºåˆ¶åŠåƒåœ¾åˆ¤æ–­ç®—æ³•</h1>\n<ul>\n<li>\n<p>åƒåœ¾å›æ”¶ï¼ˆGarbage Collectionï¼ŒGCï¼‰ï¼Œå°±æ˜¯é‡Šæ”¾åƒåœ¾å ç”¨çš„ç©ºé—´ï¼Œé˜²æ­¢å†…å­˜çˆ†æ‰ã€‚æœ‰æ•ˆçš„ä½¿ç”¨å¯ä»¥ä½¿ç”¨çš„å†…å­˜ï¼Œå¯¹å†…å­˜å †ä¸­å·²ç»æ­»äº¡çš„æˆ–è€…é•¿æ—¶é—´æ²¡æœ‰ä½¿ç”¨çš„å¯¹è±¡è¿›è¡Œæ¸…é™¤å’Œå›æ”¶ã€‚</p>\n</li>\n<li>\n<p>åƒåœ¾æ”¶é›†å™¨åœ¨å¯¹å †åŒºå’Œæ–¹æ³•åŒºè¿›è¡Œå›æ”¶å‰ï¼Œé¦–å…ˆè¦ç¡®å®šè¿™äº›åŒºåŸŸçš„å¯¹è±¡å“ªäº›å¯ä»¥è¢«å›æ”¶ï¼Œå“ªäº›æš‚æ—¶è¿˜ä¸èƒ½å›æ”¶ï¼Œå°±è¦ç”¨åˆ°åˆ¤æ–­å¯¹è±¡æ˜¯å¦å­˜æ´»çš„ç®—æ³•ã€‚</p>\n</li>\n<li>\n<p>å¼•ç”¨è®¡æ•°ç®—æ³•(Reference Counting)ç»™å¯¹è±¡ä¸­æ·»åŠ ä¸€ä¸ªå¼•ç”¨è®¡æ•°å™¨ï¼Œåˆå§‹å€¼ä¸º1ï¼Œæ¯å½“ä¸€ä¸ªåœ°æ–¹å¼•ç”¨å®ƒæ—¶ï¼Œè®¡æ•°å™¨å€¼+1.å¼•ç”¨å¤±æ•ˆæ—¶ï¼ˆä¸€ä¸ªå¯¹è±¡å®ä¾‹çš„æŸä¸ªå¼•ç”¨è¶…è¿‡äº†ç”Ÿå‘½å‘¨æœŸæˆ–è€…è¢«è®¾ç½®ä¸ºä¸€ä¸ªæ–°å€¼æ—¶ï¼‰ï¼Œè®¡æ•°å™¨å€¼-1ï¼›å½“è®¡æ•°å™¨ä¸º0åˆ™ç›´æ¥å›æ”¶ã€‚ç®€å•ï¼Œåˆ¤å®šæ•ˆç‡é«˜ï¼Œå®æ—¶æ€§è¾ƒé«˜ï¼Œæ— éœ€ç­‰åˆ°å†…å­˜ä¸å¤Ÿçš„æ—¶å€™ï¼Œæ‰å¼€å§‹å›æ”¶ï¼Œä½†ä¸èƒ½è§£å†³å¯¹è±¡é—´ç›¸äº’å¾ªç¯å¼•ç”¨é—®é¢˜ã€‚</p>\n</li>\n<li>\n<p>å¯è¾¾æ€§åˆ†æç®—æ³•(Reachability Analysis)é€šè¿‡ä¸€ç³»åˆ—ç§°ä¸ºGC Rootsçš„å¯¹è±¡ä¸ºèµ·å§‹ç‚¹ï¼Œä»è¿™äº›èŠ‚ç‚¹å‘ä¸‹æœç´¢ï¼Œæœç´¢æ‰€èµ°è¿‡çš„è·¯å¾„ç§°ä¸ºå¼•ç”¨è¿ï¼ˆReference Chainï¼‰,å½“ä¸€ä¸ªå¯¹è±¡åˆ°GC Rootsæ²¡æœ‰ä»»ä½•å¼•ç”¨é“¾ç›¸è¿ï¼ˆä»GC Rootsåˆ°è¿™ä¸ªå¯¹è±¡ä¸å¯è¾¾ï¼‰æ—¶ï¼Œè¯æ˜æ­¤å¯¹è±¡æ˜¯ä¸å¯ç”¨çš„ã€‚</p>\n</li>\n<li>\n<p>GC Rootsçš„å¯¹è±¡åŒ…æ‹¬ï¼š</p>\n<ul>\n<li>javaè™šæ‹Ÿæœºæ ˆï¼ˆæ ˆä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­å¼•ç”¨çš„å¯¹è±¡ï¼ˆæ–¹æ³•çš„å‚æ•°ã€å±€éƒ¨å˜é‡ç­‰ï¼‰ï¼Œ</li>\n<li>æœ¬åœ°æ–¹æ³•æ ˆä¸­JNIï¼ˆnativeæ–¹æ³•ï¼‰å¼•ç”¨çš„å¯¹è±¡ï¼Œ</li>\n<li>ç±»é™æ€å˜é‡ï¼Œ</li>\n<li>è¿è¡Œæ—¶å¸¸é‡æ± ä¸­çš„å¸¸é‡ï¼ˆString æˆ– Class ç±»å‹ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>17. å¼ºè½¯å¼±è™šå¼•ç”¨</h1>\n<ul>\n<li>å¼ºå¼•ç”¨(Strong Reference) Object obj = new Object()ï¼Œåƒåœ¾å›æ”¶å™¨æ°¸è¿œä¸ä¼šå›æ”¶æ‰è¢«å¼ºå¼•ç”¨çš„å¯¹è±¡ï¼Œå³ä½¿æŠ›å‡ºOutOfMemoryError</li>\n<li>è½¯å¼•ç”¨(Soft Reference)æè¿°ä¸€äº›è¿˜æœ‰ç”¨ä½†éå¿…é¡»çš„å¯¹è±¡ï¼Œåœ¨ç³»ç»Ÿå°†è¦å‘ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ä¹‹å‰ï¼Œå°†ä¼šå¯¹å¼±å¼•ç”¨å¯¹è±¡è¿›è¡ŒäºŒæ¬¡å›æ”¶ï¼Œå¦‚æœè¿™æ¬¡å›æ”¶è¿˜æ²¡æœ‰è¶³å¤Ÿå†…å­˜ï¼Œæ‰ä¼šæŠ›å‡ºå†…å­˜å¼‚å¸¸ã€‚SoftReferenceç±»å®ç°è½¯å¼•ç”¨ã€‚å¯ç”¨æ¥å®ç°å†…å­˜æ•æ„Ÿçš„é«˜é€Ÿç¼“å­˜ã€‚å¯ä»¥å’Œä¸€ä¸ªå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœè½¯å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ŒJVMå°±ä¼šæŠŠè¿™ä¸ªè½¯å¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­</li>\n<li>å¼±å¼•ç”¨(Weak Reference)æè¿°éå¿…é¡»å¯¹è±¡ï¼Œå½“åƒåœ¾å›æ”¶æ—¶éƒ½ä¼šå›æ”¶æ‰åªè¢«å¼±å¼•ç”¨å…³è”çš„å¯¹è±¡ã€‚Weakreferenceç±»å®ç°å¼±å¼•ç”¨ã€å¯ä»¥å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ï¼Œå¦‚æœå¼±å¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ŒJavaè™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªå¼±å¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­</li>\n<li>è™šå¼•ç”¨(Phantom reference) ä¸»è¦ç”¨æ¥è·Ÿè¸ªå¯¹è±¡è¢«åƒåœ¾å›æ”¶çš„æ´»åŠ¨ã€‚è™šå¼•ç”¨ä¸å½±å“å¯¹è±¡å­˜æ´»ï¼Œä¹Ÿä¸èƒ½é€šè¿‡è™šå¼•ç”¨è·å¾—å¯¹è±¡å®ä¾‹ã€‚PhantomReferenceç±»å®ç°è™šå¼•ç”¨ã€è™šå¼•ç”¨<strong>å¿…é¡»</strong>å’Œå¼•ç”¨é˜Ÿåˆ—ï¼ˆReferenceQueueï¼‰è”åˆä½¿ç”¨ã€‚å¦‚æœè™šå¼•ç”¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«åƒåœ¾å›æ”¶ï¼ŒJAVAè™šæ‹Ÿæœºå°±ä¼šæŠŠè¿™ä¸ªè™šå¼•ç”¨åŠ å…¥åˆ°ä¸ä¹‹å…³è”çš„å¼•ç”¨é˜Ÿåˆ—ä¸­ã€‚ç¨‹åºå¦‚æœå‘ç°è™šå¼•ç”¨å·²ç»è¢«åŠ å…¥åˆ°å¼•ç”¨é˜Ÿåˆ—ï¼Œå°±å¯ä»¥åœ¨æ‰€å¼•ç”¨çš„å¯¹è±¡è¢«å›æ”¶å‰é‡‡å–è¡ŒåŠ¨</li>\n</ul>\n<h1>18. è¢«æ ‡è®°ä¸ºåƒåœ¾çš„å¯¹è±¡ä¸€å®šä¼šè¢«å›æ”¶å—ï¼Ÿfinalize()æ–¹æ³•ä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>åœ¨å¯è¾¾æ€§åˆ†æç®—æ³•ä¸­ä¸å¯è¾¾çš„å¯¹è±¡.è‡³å°‘è¦ç»å†ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ã€‚</li>\n<li>ç¬¬ä¸€æ¬¡æ ‡è®°ï¼šå¦‚æœå¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾ï¼Œå°†ä¼šè¢«ç¬¬ä¸€æ¬¡æ ‡è®°ï¼›</li>\n<li>ç¬¬äºŒæ¬¡æ ‡è®°ï¼šç¬¬ä¸€æ¬¡æ ‡è®°åæ¥ç€ä¼šè¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰çš„æ¡ä»¶æ˜¯æ­¤å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œ finalize() æ–¹æ³•ã€‚åœ¨finalize()æ–¹æ³•ä¸­æ²¡æœ‰é‡æ–°ä¸å¼•ç”¨é“¾å»ºç«‹å…³è”å…³ç³»çš„ï¼Œå°†è¢«è¿›è¡Œç¬¬äºŒæ¬¡æ ‡è®°ã€‚ç¬¬äºŒæ¬¡æ ‡è®°æˆåŠŸçš„å¯¹è±¡å°†çœŸçš„ä¼šè¢«å›æ”¶ï¼Œå¦‚æœå¯¹è±¡åœ¨ finalize() æ–¹æ³•ä¸­é‡æ–°ä¸å¼•ç”¨é“¾å»ºç«‹äº†å…³è”å…³ç³»ï¼Œé‚£ä¹ˆå°†ä¼šå­˜æ´»ã€‚å»ºè®®åœ¨è¿™ä¸ªæ–¹æ³•ä¸­é‡Šæ”¾è¯¥å¯¹è±¡æŒæœ‰çš„èµ„æºï¼Œä¸å»ºè®®é‡å†™è¯¥æ–¹æ³•ã€‚è¯¥æ–¹æ³•æœ‰ä¸”ä»…ä¼šè¢«è°ƒç”¨ä¸€æ¬¡</li>\n</ul>\n<h1>19. Java å †çš„å†…å­˜åˆ†åŒº</h1>\n<p>Javaå †æ ¹æ®å¯¹è±¡å­˜æ´»å‘¨æœŸçš„ä¸åŒå°†å†…å­˜åˆ’åˆ†ä¸º</p>\n<ul>\n<li>æ–°ç”Ÿä»£ï¼ˆYoung Generationï¼‰åŒ…æ‹¬ä¸€å—è¾ƒå¤§çš„Edenç©ºé—´å’Œä¸¤å—è¾ƒå°çš„Survivorç©ºé—´,å¤§å°æ¯”ä¾‹æ˜¯8:1:1 (å‚æ•°â€“XX:SurvivorRatioè®¾å®š),æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†ä¸»è¦é‡‡ç”¨æ ‡è®°-å¤åˆ¶ç®—æ³•ï¼Œå› ä¸ºæ–°ç”Ÿä»£çš„å­˜æ´»å¯¹è±¡æ¯”è¾ƒå°‘ï¼Œæ¯æ¬¡å¤åˆ¶å°‘é‡çš„å­˜æ´»å¯¹è±¡æ•ˆç‡æ¯”è¾ƒé«˜ã€‚æ¯æ¬¡åˆ†é…å†…å­˜åªä½¿ç”¨ Eden å’Œå…¶ä¸­ä¸€å— Survivorã€‚å‘ç”Ÿåƒåœ¾æ”¶é›†æ—¶ï¼Œå°† Eden å’Œ Survivor ä¸­ä»ç„¶å­˜æ´»çš„å¯¹è±¡ä¸€æ¬¡æ€§å¤åˆ¶åˆ°å¦å¤–ä¸€å— Survivor ç©ºé—´ä¸Šï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ Eden å’Œå·²ç”¨è¿‡çš„é‚£å— Survivor ç©ºé—´ã€‚</li>\n<li>è€å¹´ä»£ï¼ˆTenured Generationï¼‰å› ä¸ºå¯¹è±¡å­˜æ´»ç‡é«˜ã€æ²¡æœ‰é¢å¤–ç©ºé—´å¯¹å®ƒè¿›è¡Œåˆ†é…æ‹…ä¿ï¼Œä½¿ç”¨â€œæ ‡è®°â€”æ¸…ç†â€æˆ–è€…â€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•æ¥è¿›è¡Œå›æ”¶ã€‚é»˜è®¤æ–°ç”Ÿä»£ä¸è€å¹´ä»£çš„æ¯”ä¾‹çš„å€¼ä¸º 1:2 (å‚æ•°â€“XX:NewRatioæŒ‡å®š)</li>\n<li>æ°¸ä¹…ä»£ï¼ˆPermanet Generationï¼‰å­˜å‚¨class,method,filedå¯¹è±¡ï¼Œä¸€èˆ¬ä¸ä¼šå†…å­˜æº¢å‡ºï¼Œjdk1.8æ›¿æ¢ä¸ºMetaspaceï¼ˆå…ƒæ•°æ®ç©ºé—´ï¼‰ã€‚æ‰€å ç”¨çš„å†…å­˜ç©ºé—´ä¸åœ¨è™šæ‹Ÿæœºå†…éƒ¨ï¼Œè€Œæ˜¯åœ¨æœ¬åœ°å†…å­˜ç©ºé—´ä¸­ã€‚ä¿®æ”¹åŸå› ï¼šç”±äºæ°¸ä¹…ä»£å†…å­˜ç»å¸¸ä¸å¤Ÿç”¨æˆ–å‘ç”Ÿå†…å­˜æ³„éœ²ï¼Œçˆ†å‡ºå¼‚å¸¸java.lang.OutOfMemoryError: PermGen</li>\n<li>VirtualåŒºï¼šæœ€å¤§å†…å­˜å’Œåˆå§‹å†…å­˜çš„å·®å€¼ï¼Œå°±æ˜¯VirtualåŒº</li>\n</ul>\n<h1>20. å¸¸ç”¨çš„åƒåœ¾å›æ”¶ç®—æ³•ï¼ŒJVMä¸­çš„åƒåœ¾å›æ”¶äº†è§£å—ï¼Ÿä¸ºä»€ä¹ˆæ–°ç”Ÿä»£ä¸ç”¨æ ‡è®°æ•´ç†ï¼Ÿâˆš</h1>\n<ul>\n<li>\n<p>æ ‡è®°-å¤åˆ¶ç®—æ³•(Copying)ï¼šå°†å¯ç”¨å†…å­˜æŒ‰å®¹é‡åˆ’åˆ†ä¸ºå¤§å°ç›¸ç­‰çš„ä¸¤å—ï¼Œæ¯æ¬¡åªä½¿ç”¨å…¶ä¸­çš„ä¸€å—ã€‚å½“è¿™ä¸€å—çš„å†…å­˜ç”¨å®Œäº†ï¼Œå°±å°†è¿˜å­˜æ´»ç€çš„å¯¹è±¡å¤åˆ¶åˆ°å¦å¤–ä¸€å—ä¸Šé¢ï¼Œç„¶åå¯¹è¿™ä¸€å—å†…å­˜ç©ºé—´è¿›è¡Œå›æ”¶ï¼Œ</p>\n</li>\n<li>\n<p>ä¸ä¼šäº§ç”Ÿè¿ç»­å†…å­˜ç¢ç‰‡ï¼Œå†…å­˜åˆ†é…æ—¶åªè¦ç§»åŠ¨å †é¡¶æŒ‡é’ˆï¼ŒæŒ‰é¡ºåºåˆ†é…å†…å­˜å³å¯ï¼Œæ•ˆç‡é«˜ï¼›ä½†å†…å­˜å‡åŠï¼Œç©ºé—´åˆ©ç”¨ç‡ä½ã€‚é€‚åˆåªæœ‰å°‘é‡å¯¹è±¡å­˜æ´»çš„åœºæ™¯ï¼Œé€‚åˆæ–°ç”Ÿä»£</p>\n</li>\n<li>\n<p>æ ‡è®°-æ¸…é™¤ç®—æ³•(Mark-Sweep)ï¼šæ ‡è®°æ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåç»Ÿä¸€å›æ”¶æ‰€æœ‰æ ‡è®°çš„å¯¹è±¡</p>\n</li>\n<li>\n<p>ä¼šäº§ç”Ÿä¸è¿ç»­çš„å†…å­˜ç¢ç‰‡ï¼Œä¸åˆ©äºåˆ†é…å¤§å¯¹è±¡ã€‚é€‚åˆå¯¹è±¡ä¸å¤šçš„æƒ…å†µã€‚æ ‡è®°å’Œæ¸…é™¤ä¸¤ä¸ªè¿‡ç¨‹çš„æ•ˆç‡éƒ½ä¸é«˜.é€‚åˆè€å¹´ä»£</p>\n</li>\n<li>\n<p>æ ‡è®°-æ•´ç†ç®—æ³•(Mark-Compact)æ ‡è®°æ‰€æœ‰éœ€è¦å›æ”¶çš„å¯¹è±¡ï¼Œåœ¨æ ‡è®°å®Œæˆåè®©æ‰€æœ‰å­˜æ´»çš„å¯¹è±¡éƒ½å‘ä¸€ç«¯ç§»åŠ¨ï¼Œç„¶åç›´æ¥æ¸…ç†æ‰ç«¯è¾¹ç•Œä»¥å¤–çš„å†…å­˜</p>\n</li>\n<li>\n<p>ä¸ä¼šäº§ç”Ÿå†…å­˜ç¢ç‰‡ï¼Œç¼ºç‚¹æ˜¯éœ€è¦ç§»åŠ¨å¯¹è±¡ï¼Œæ¸…é™¤æ•ˆç‡æ¯”æ ‡è®°æ¸…é™¤ä½ï¼Œé€‚åˆè€å¹´ä»£</p>\n</li>\n</ul>\n<h1>21. Minor GC/Young GCã€Major GC/Old GCã€Mixed GCã€Full GCéƒ½æ˜¯ä»€ä¹ˆæ„æ€ï¼Ÿ</h1>\n<ul>\n<li>æ–°ç”Ÿä»£æ”¶é›†ï¼ˆMinor GC/Young GCï¼‰ï¼šæŒ‡æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†ã€‚</li>\n<li>è€å¹´ä»£æ”¶é›†ï¼ˆMajor GC/Old GCï¼‰ï¼šæŒ‡è€å¹´ä»£çš„åƒåœ¾æ”¶é›†ã€‚CMS æ”¶é›†å™¨çš„ç‰¹æœ‰è¡Œä¸ºã€‚</li>\n<li>æ··åˆæ”¶é›†ï¼ˆMixed GCï¼‰ï¼šæŒ‡G1 åƒåœ¾æ”¶é›†å™¨ç‰¹æœ‰çš„ä¸€ç§ GC ç±»å‹ï¼Œå®ƒåœ¨ä¸€æ¬¡ GC ä¸­åŒæ—¶æ¸…ç†å¹´è½»ä»£å’Œéƒ¨åˆ†è€å¹´ä»£</li>\n<li>æ•´å †æ”¶é›†ï¼ˆFull GCï¼‰ï¼šæ”¶é›†æ•´ä¸ª Java å †å’Œæ–¹æ³•åŒºçš„åƒåœ¾æ”¶é›†ã€‚ä¼šSTOP THE WORD</li>\n</ul>\n<h1>22. Minor GC/Young GC ä»€ä¹ˆæ—¶å€™è§¦å‘ï¼Ÿ</h1>\n<ul>\n<li>æ–°åˆ›å»ºçš„å¯¹è±¡ä¼˜å…ˆåœ¨æ–°ç”Ÿä»£ Eden åŒºè¿›è¡Œåˆ†é…ï¼Œå¦‚æœ Eden åŒºæ²¡æœ‰è¶³å¤Ÿçš„ç©ºé—´æ—¶ï¼Œå°±ä¼šè§¦å‘ Young GC æ¥æ¸…ç†æ–°ç”Ÿä»£ã€‚</li>\n</ul>\n<h1>23. ä»€ä¹ˆæ—¶å€™ä¼šè§¦å‘ Full GCï¼Ÿ</h1>\n<ul>\n<li>Young GC ä¹‹å‰æ£€æŸ¥è€å¹´ä»£ï¼šYoung GCæ—¶å‘ç°è€å¹´ä»£å¯ç”¨çš„è¿ç»­å†…å­˜ç©ºé—´ &lt; æ–°ç”Ÿä»£å†æ¬¡Young GCåå‡å…¥è€å¹´ä»£çš„å¯¹è±¡æ€»å’Œçš„å¹³å‡å¤§å°ï¼Œè¯´æ˜æœ¬æ¬¡ Young GC åå¯èƒ½å‡å…¥è€å¹´ä»£çš„å¯¹è±¡å¤§å°ï¼Œå¯èƒ½è¶…è¿‡äº†è€å¹´ä»£å½“å‰å¯ç”¨å†…å­˜ç©ºé—´,é‚£å°±ä¼šè§¦å‘ Full GCã€‚</li>\n<li>Young GC ä¹‹åè€å¹´ä»£ç©ºé—´ä¸è¶³ï¼šæ‰§è¡Œ Young GC ä¹‹åæœ‰ä¸€æ‰¹å¯¹è±¡éœ€è¦æ”¾å…¥è€å¹´ä»£ï¼Œè€å¹´ä»£æ²¡æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´å­˜æ”¾è¿™äº›å¯¹è±¡ï¼Œå°±ä¼šè§¦å‘ Full GCã€‚</li>\n<li>è€å¹´ä»£ç©ºé—´ä¸è¶³ï¼Œè€å¹´ä»£å†…å­˜ä½¿ç”¨ç‡è¿‡é«˜ï¼Œè¾¾åˆ°ä¸€å®šæ¯”ä¾‹ï¼Œä¹Ÿä¼šè§¦å‘ Full GCã€‚</li>\n<li>ç©ºé—´åˆ†é…æ‹…ä¿å¤±è´¥ï¼ˆ Promotion Failureï¼‰ï¼Œæ–°ç”Ÿä»£çš„ To åŒºæ”¾ä¸ä¸‹ä» Eden å’Œ From æ‹·è´è¿‡æ¥å¯¹è±¡ï¼Œæˆ–è€…æ–°ç”Ÿä»£å¯¹è±¡ GC å¹´é¾„åˆ°è¾¾é˜ˆå€¼éœ€è¦æ™‹å‡è¿™ä¸¤ç§æƒ…å†µï¼Œè€å¹´ä»£å¦‚æœæ”¾ä¸ä¸‹çš„è¯éƒ½ä¼šè§¦å‘ Full GCã€‚</li>\n<li>æ–¹æ³•åŒºå†…å­˜ç©ºé—´ä¸è¶³ï¼šå¦‚æœæ–¹æ³•åŒºç”±æ°¸ä¹…ä»£å®ç°ï¼Œæ°¸ä¹…ä»£ç©ºé—´ä¸è¶³ Full GCã€‚</li>\n<li>System.gc()ç­‰å‘½ä»¤è§¦å‘ï¼šSystem.gc()ã€jmap -dump ç­‰å‘½ä»¤ä¼šè§¦å‘ full gcã€‚</li>\n</ul>\n<h1>24. å¯¹è±¡ä»€ä¹ˆæ—¶å€™ä¼šè¿›å…¥è€å¹´ä»£ï¼Ÿ</h1>\n<ul>\n<li>é•¿æœŸå­˜æ´»çš„å¯¹è±¡è¿›å…¥è€å¹´ä»£ã€‚åœ¨å¯¹è±¡çš„å¯¹è±¡å¤´ä¿¡æ¯ä¸­å­˜å‚¨ç€å¯¹è±¡çš„è¿­ä»£å¹´é¾„,è¿­ä»£å¹´é¾„ä¼šåœ¨æ¯æ¬¡ YoungGC ä¹‹åå¯¹è±¡çš„ç§»åŒºæ“ä½œä¸­å¢åŠ ,æ¯ä¸€æ¬¡ç§»åŒºå¹´é¾„åŠ ä¸€.å½“è¿™ä¸ªå¹´é¾„è¾¾åˆ° 15(é»˜è®¤)ä¹‹å,è¿™ä¸ªå¯¹è±¡å°†ä¼šè¢«ç§»å…¥è€å¹´ä»£ã€‚- XX:MaxTenuringThresholdè®¾ç½®</li>\n<li>å¤§å¯¹è±¡ç›´æ¥åˆ†é…åˆ°è€å¹´ä»£ã€‚é¿å…åœ¨EdenåŒºå’Œä¸¤ä¸ªSurvivoråŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜æ‹·è´-XXï¼šPretenureSizeThresholdè®¾ç½®</li>\n<li>åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®šã€‚å¦‚æœåœ¨survivoråŒºä¸­ç›¸åŒå¹´é¾„çš„æ‰€æœ‰å¯¹è±¡å¤§å°å¤§äºsurvivorç©ºé—´çš„ä¸€åŠï¼Œåˆ™å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡ï¼Œå¯è¿›å…¥è€å¹´åŒº</li>\n<li>ç©ºé—´åˆ†é…æ‹…ä¿ã€‚Young GCåæ–°ç”Ÿä»£ä»ç„¶æœ‰å¤§é‡å¯¹è±¡å­˜æ´»ï¼Œå°±éœ€è¦è€å¹´ä»£è¿›è¡Œåˆ†é…æ‹…ä¿ï¼ŒæŠŠSurvivoræ— æ³•å®¹çº³çš„å¯¹è±¡ç›´æ¥é€å…¥è€å¹´ä»£</li>\n</ul>\n<h1>25. åˆ†ä»£æ”¶é›†ç®—æ³•(Generational Collection)</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e84e053a2828ccee7473c.png\" alt=\"heapmemoryallocation.png\" tabindex=\"0\"><figcaption>heapmemoryallocation.png</figcaption></figure>\n<ul>\n<li>JVMåƒåœ¾å›æ”¶æœºåˆ¶é‡‡ç”¨çš„åˆ†ä»£å›æ”¶\n<ul>\n<li>å¯¹è±¡ä¼˜å…ˆåœ¨æ–°ç”Ÿä»£EdenåŒºä¸Šè¿›è¡Œåˆ†é…ï¼Œæ¯æ¬¡ä½¿ç”¨Edenå’Œå…¶ä¸­ä¸€å—Survivorã€‚\n<ul>\n<li>å¦‚æœEdenåŒºç©ºé—´ä¸å¤Ÿæ—¶ï¼Œå°è¯•æ”¾å…¥åˆ°Survivor0ï¼Œå‘èµ·Minor GCï¼Œ\n<ul>\n<li>å¦‚æœSurvivor0å¯ä»¥æ”¾å…¥ï¼Œé‚£ä¹ˆæ”¾å…¥ä¹‹åæ¸…é™¤EdenåŒºã€‚</li>\n<li>å¦‚æœSurvivor0ä¸å¯ä»¥æ”¾å…¥ï¼Œé‚£ä¹ˆå°è¯•æŠŠEdenå’ŒSurvivor0çš„å­˜æ´»å¯¹è±¡æ”¾åˆ°Survivor1ä¸­ã€‚å¹´é¾„+1ï¼Œå¢åŠ åˆ°ä¸€å®šå¹´é¾„åˆ™ç§»åŠ¨åˆ°è€å¹´ä»£ä¸­\n<ul>\n<li>å¦‚æœSurvivor1å¯ä»¥æ”¾å…¥ï¼Œé‚£ä¹ˆæ”¾å…¥Survivor1ä¹‹åæ¸…é™¤Edenå’ŒSurvivor0 ï¼Œä¹‹åå†æŠŠSurvivor1ä¸­çš„å¯¹è±¡å¤åˆ¶åˆ°Survivor0ä¸­ï¼Œä¿æŒSurvivor1ä¸€ç›´ä¸ºç©ºã€‚</li>\n<li>å¦‚æœSurvivor1ä¸å¯ä»¥æ”¾å…¥ï¼Œé‚£ä¹ˆç›´æ¥æŠŠå®ƒä»¬æ”¾å…¥åˆ°è€å¹´ä»£ä¸­ï¼Œå¹¶æ¸…é™¤Edenå’ŒSurvivor0ï¼Œè¿™ä¸ªè¿‡ç¨‹ä¹Ÿç§°ä¸ºåˆ†é…æ‹…ä¿</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>26. jvmåƒåœ¾å›æ”¶å™¨æœ‰å“ªäº›ï¼Ÿä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>\n<p>è‡ªåŠ¨ç®¡ç† Java åº”ç”¨ç¨‹åºçš„è¿è¡Œæ—¶å†…å­˜ã€‚å®ƒè´Ÿè´£è¯†åˆ«å“ªäº›å†…å­˜æ˜¯ä¸å†è¢«åº”ç”¨ç¨‹åºä½¿ç”¨ï¼Œå¹¶é‡Šæ”¾è¿™äº›å†…å­˜ä»¥ä¾¿é‡æ–°ä½¿ç”¨ã€‚å‡å°‘äº†ç¨‹åºå‘˜æ‰‹åŠ¨ç®¡ç†å†…å­˜çš„è´Ÿæ‹…ï¼Œé™ä½äº†å†…å­˜æ³„æ¼å’Œæº¢å‡ºé”™è¯¯çš„é£é™©ã€‚</p>\n</li>\n<li>\n<p>STWï¼ˆstop the worldï¼‰ï¼šæ‰€æœ‰å·¥ä½œçº¿ç¨‹æš‚åœ</p>\n</li>\n<li>\n<p>JVM çš„åƒåœ¾æ”¶é›†å™¨ä¸»è¦åˆ†ä¸ºä¸¤å¤§ç±»ï¼šåˆ†ä»£æ”¶é›†å™¨å’Œåˆ†åŒºæ”¶é›†å™¨ã€‚åˆ†ä»£æ”¶é›†å™¨çš„ä»£è¡¨æ˜¯ CMSï¼Œåˆ†åŒºæ”¶é›†å™¨çš„ä»£è¡¨æ˜¯ G1 å’Œ ZGCã€‚</p>\n</li>\n<li>\n<p>Serial/Serial Oldæ”¶é›†å™¨ï¼Œå•çº¿ç¨‹ï¼Œè¿›æ”¶é›†æ—¶ä¼šSTWã€‚-XX:+UseSerialGCï¼šserialæ–°ç”Ÿä»£ä½¿ç”¨æ ‡è®°å¤åˆ¶ï¼ŒSerial Oldè€å¹´ä»£æ ‡è®°æ•´ç†</p>\n</li>\n<li>\n<p>ParNew/Serial Oldæ”¶é›†å™¨ï¼ŒSerialå¤šçº¿ç¨‹ç‰ˆï¼Œ-XX:+UseParNewGCï¼šParNewæ–°ç”Ÿä»£ä½¿ç”¨æ ‡è®°å¤åˆ¶ï¼ŒSerial Oldè€å¹´ä»£æ ‡è®°æ•´ç†ã€‚</p>\n</li>\n<li>\n<p>Parallel Scavenge/Parallel Oldæ”¶é›†å™¨ï¼Œå¤šçº¿ç¨‹.å¯è®¾ç½®ååé‡å‚æ•° ååé‡=è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´/ï¼ˆè¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´+åƒåœ¾æ”¶é›†æ—¶é—´ï¼‰</p>\n<ul>\n<li>-XX:+UseParallelGCå¹´è½»ä»£ä½¿ç”¨ParallelGCåƒåœ¾å›æ”¶å™¨æ ‡è®°å¤åˆ¶ï¼Œè€å¹´ä»£ä½¿ç”¨ä¸²è¡Œå›æ”¶å™¨</li>\n<li>-XX:+UseParalledlOldGCå¹´è½»ä»£ä½¿ç”¨ParallelGCåƒåœ¾å›æ”¶å™¨æ ‡è®°å¤åˆ¶ï¼Œè€å¹´ä»£ä½¿ç”¨ParallelOldGCåƒåœ¾å›æ”¶å™¨æ ‡è®°-æ•´ç†</li>\n<li>-XX:MaxGCPauseMillis=nï¼šè®¾ç½®å¹¶è¡Œæ”¶é›†æœ€å¤§æš‚åœæ¯«ç§’æ•°</li>\n<li>-XX:GCTimeRatio=nï¼šè®¾ç½®åƒåœ¾å›æ”¶æ—¶é—´å ç¨‹åºè¿è¡Œæ—¶é—´çš„ç™¾åˆ†æ¯”0~100ï¼Œé»˜è®¤å€¼ä¸º99ï¼Œä¹Ÿå°±æ˜¯åƒåœ¾å›æ”¶æ—¶é—´ä¸èƒ½è¶…è¿‡1%</li>\n<li>-XX:UseAdaptiveSizePolicyè‡ªé€‚åº”GCæ¨¡å¼ï¼Œåƒåœ¾å›æ”¶å™¨å°†è‡ªåŠ¨è°ƒæ•´å¹´è½»ä»£ã€è€å¹´ä»£ç­‰å‚æ•°ï¼Œè¾¾åˆ°ååé‡ã€å †å¤§å°ã€åœé¡¿æ—¶é—´ä¹‹é—´çš„å¹³è¡¡</li>\n</ul>\n</li>\n<li>\n<p>CMS ï¼ˆConcurrent Mark Sweepï¼‰å¤šçº¿ç¨‹ï¼Œå›æ”¶æ—¶é—´çŸ­ï¼Œæ ‡è®°â€”æ¸…é™¤,-XX:+UseConcMarkSweepGCè¿›è¡Œè®¾ç½®</p>\n</li>\n<li>\n<p>G1 æ”¶é›†å™¨ï¼ˆGarbage-First Garbage Collectorï¼‰ å¹´è½»ä»£æ ‡è®°å¤åˆ¶ï¼Œè€å¹´ä»£æ ‡è®°æ•´ç†ã€‚jdk9åé»˜è®¤ã€‚G1 æœ‰äº”ä¸ªå±æ€§ï¼šåˆ†ä»£ã€å¢é‡ã€å¹¶è¡Œã€æ ‡è®°æ•´ç†ã€STWã€‚</p>\n</li>\n<li>\n<p>G1 åƒåœ¾å›æ”¶æ¨¡å¼</p>\n<ul>\n<li>Edenç©ºé—´è€—å°½æ—¶ä¼šè§¦å‘Young GCã€‚Edenç©ºé—´çš„æ•°æ®ç§»åŠ¨åˆ°Survivorç©ºé—´ä¸­ï¼Œå¦‚æœSurvivorç©ºé—´ä¸å¤Ÿï¼ŒEdenç©ºé—´çš„éƒ¨åˆ†æ•°æ®ä¼šç›´æ¥æ™‹å‡åˆ°å¹´è€ä»£ç©ºé—´ã€‚SurvivoråŒºçš„æ•°æ®ç§»åŠ¨åˆ°æ–°çš„SurvivoråŒºä¸­ï¼Œä¹Ÿæœ‰éƒ¨åˆ†æ•°æ®æ™‹å‡åˆ°è€å¹´ä»£ç©ºé—´ä¸­ã€‚æœ€ç»ˆEdenç©ºé—´çš„æ•°æ®ä¸ºç©ºï¼ŒGCåœæ­¢å·¥ä½œï¼Œåº”ç”¨çº¿ç¨‹ç»§ç»­æ‰§è¡Œã€‚</li>\n<li>å½“å¤§é‡å¯¹è±¡æ™‹å‡åˆ°è€å¹´ä»£old regionæ—¶ï¼Œä¸ºäº†é¿å…å †å†…å­˜è¢«è€—å°½ï¼Œè™šæ‹Ÿæœºä¼šè§¦å‘Mixed GCï¼Œå›æ”¶æ•´ä¸ªYoung Regionå’Œä¸€éƒ¨åˆ†çš„Old Regionï¼Œå¯ä»¥é€‰æ‹©å“ªäº›old regionè¿›è¡Œæ”¶é›†ï¼Œä»è€Œå¯ä»¥å¯¹åƒåœ¾å›æ”¶çš„è€—æ—¶æ—¶é—´è¿›è¡Œæ§åˆ¶ã€‚å½“è€å¹´ä»£å¤§å°å æ•´ä¸ªå †å¤§å°ç™¾åˆ†æ¯”è¾¾åˆ°è¯¥-XX:InitiatingHeapOccupancyPercent=næ—¶è§¦å‘ã€‚é»˜è®¤45%.å®ƒçš„GCæ­¥éª¤å¦‚ä¸‹\n<ul>\n<li>1.å…¨å±€å¹¶å‘æ ‡è®°ï¼ˆglobal concurrent markingï¼‰ï¼Œæ‰§è¡Œè¿‡ç¨‹åˆ†ä¸ºäº”ä¸ªæ­¥éª¤ï¼š\n<ul>\n<li>åˆå§‹æ ‡è®°ï¼ˆinitial markï¼ŒSTWï¼‰æ ‡è®°ä»æ ¹èŠ‚ç‚¹ç›´æ¥å¯è¾¾çš„å¯¹è±¡ï¼Œè¿™ä¸ªé˜¶æ®µä¼šæ‰§è¡Œä¸€æ¬¡å¹´è½»ä»£GCï¼Œä¼šäº§ç”Ÿå…¨å±€åœé¡¿</li>\n<li>æ ¹åŒºåŸŸæ‰«æï¼ˆroot region scanï¼‰G1 GC åœ¨åˆå§‹æ ‡è®°çš„å­˜æ´»åŒºæ‰«æå¯¹è€å¹´ä»£çš„å¼•ç”¨ï¼Œå¹¶æ ‡è®°è¢«å¼•ç”¨çš„å¯¹è±¡ã€‚è¯¥é˜¶æ®µä¸åº”ç”¨ç¨‹åºï¼ˆé STWï¼‰åŒæ—¶è¿è¡Œï¼Œå¹¶ä¸”åªæœ‰å®Œæˆè¯¥é˜¶æ®µåï¼Œæ‰å¼€å§‹ä¸‹ä¸€æ¬¡STWå¹´è½»ä»£åƒåœ¾å›æ”¶</li>\n<li>å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰G1 GC åœ¨æ•´ä¸ªå †ä¸­æŸ¥æ‰¾å¯è®¿é—®çš„ï¼ˆå­˜æ´»çš„ï¼‰å¯¹è±¡ã€‚è¯¥é˜¶æ®µä¸åº”ç”¨ç¨‹åºåŒæ—¶è¿è¡Œï¼Œå¯ä»¥è¢« STW å¹´è½»ä»£åƒåœ¾å›æ”¶ä¸­æ–­ã€‚</li>\n<li>é‡æ–°æ ‡è®°ï¼ˆRemarkï¼ŒSTWï¼‰è¯¥é˜¶æ®µæ˜¯ STW å›æ”¶ï¼Œå› ä¸ºç¨‹åºåœ¨è¿è¡Œï¼Œé’ˆå¯¹ä¸Šä¸€æ¬¡çš„æ ‡è®°è¿›è¡Œä¿®æ­£ã€‚</li>\n<li>æ¸…é™¤åƒåœ¾ï¼ˆCleanupï¼ŒSTWï¼‰æ¸…ç‚¹å’Œé‡ç½®æ ‡è®°çŠ¶æ€ï¼Œè¯¥é˜¶æ®µä¼šSTWï¼Œè¿™ä¸ªé˜¶æ®µå¹¶ä¸ä¼šå®é™…ä¸Šå»åšåƒåœ¾çš„æ”¶é›†ï¼Œç­‰å¾…evacuationé˜¶æ®µæ¥å›æ”¶ã€‚</li>\n</ul>\n</li>\n<li>2.æ‹·è´å­˜æ´»å¯¹è±¡ï¼ˆevacuationï¼‰:è¯¥é˜¶æ®µæ˜¯å…¨æš‚åœçš„ã€‚æŠŠä¸€éƒ¨åˆ†Regioné‡Œçš„æ´»å¯¹è±¡æ‹·è´åˆ°å¦ä¸€éƒ¨åˆ†Regionä¸­ï¼Œä»è€Œå®ç°åƒåœ¾çš„å›æ”¶æ¸…ç†</li>\n</ul>\n</li>\n<li>Full GC</li>\n<li>Remembered Setï¼ˆå·²è®°å¿†é›†åˆï¼‰å…¶ä½œç”¨æ˜¯è·Ÿè¸ªæŒ‡å‘æŸä¸ªå †å†…çš„å¯¹è±¡å¼•ç”¨ã€‚æ¯ä¸ªRegionåˆå§‹åŒ–æ—¶ï¼Œä¼šåˆå§‹åŒ–ä¸€ä¸ªRSetï¼Œè¯¥é›†åˆç”¨æ¥è®°å½•å¹¶è·Ÿè¸ªå…¶å®ƒRegionæŒ‡å‘è¯¥Regionä¸­å¯¹è±¡çš„å¼•ç”¨ï¼Œæ¯ä¸ªRegioné»˜è®¤æŒ‰ç…§512Kbåˆ’åˆ†æˆå¤šä¸ªCardï¼Œæ‰€ä»¥RSetéœ€è¦è®°å½•çš„ä¸œè¥¿åº”è¯¥æ˜¯ xx Regionçš„ xx Cardã€‚</li>\n</ul>\n</li>\n<li>\n<p>G1å‚æ•°è®¾ç½® G1 GC çš„ååé‡ç›®æ ‡æ˜¯ 90% çš„åº”ç”¨ç¨‹åºæ—¶é—´å’Œ 10%çš„åƒåœ¾å›æ”¶æ—¶é—´ï¼ŒMaxGCPauseMillisä¸è¦è®¾ç½®å¤ªå°</p>\n<ul>\n<li>-XX:+UseG1GCä½¿ç”¨G1åƒåœ¾æ”¶é›†å™¨</li>\n<li>-XX:MaxGCPauseMillisè®¾ç½®æœŸæœ›è¾¾åˆ°çš„æœ€å¤§GCåœé¡¿æ—¶é—´æ¯«ç§’ï¼ˆå°½åŠ›ä¿è¯ï¼‰ï¼Œé»˜è®¤200</li>\n<li>-XX:G1HeapRegionSize=nè®¾ç½®G1åŒºåŸŸçš„å¤§å°ã€‚å€¼æ˜¯2çš„å¹‚ï¼Œ1-32MBã€‚ç›®æ ‡æ˜¯æ ¹æ®æœ€å°çš„Javaå †å¤§å°åˆ’åˆ†å‡ºçº¦2048ä¸ªåŒºåŸŸã€‚é»˜è®¤æ˜¯å †å†…å­˜çš„1/2000</li>\n<li>-XX:ParallelGCThreads=nè®¾ç½®STWå·¥ä½œçº¿ç¨‹æ•°çš„å€¼ã€‚nçš„å€¼ä¸é€»è¾‘å¤„ç†å™¨çš„æ•°é‡ç›¸åŒï¼Œæœ€å¤š8</li>\n<li>-XX:ConcGCThreads=nè®¾ç½®å¹¶è¡Œæ ‡è®°çš„çº¿ç¨‹æ•°ã€‚å°†nè®¾ç½®ä¸ºå¹¶è¡Œåƒåœ¾å›æ”¶çº¿ç¨‹æ•° (ParallelGCThreads)çš„ 1/4 å·¦å³</li>\n<li>-XX:InitiatingHeapOccupancyPercent=nè®¾ç½®è§¦å‘æ ‡è®°å‘¨æœŸçš„Javaå †å ç”¨ç‡é˜ˆå€¼ã€‚é»˜è®¤45%</li>\n</ul>\n</li>\n<li>\n<p>ZGCæ”¶é›†å™¨ ä½å»¶è¿Ÿåƒåœ¾æ”¶é›†å™¨ï¼Œé€‚ç”¨äºå¤§å†…å­˜ä½å»¶è¿ŸæœåŠ¡çš„å†…å­˜ç®¡ç†å’Œå›æ”¶ã€‚ZGC çš„ä¸¤ä¸ªå…³é”®æŠ€æœ¯ï¼šæŒ‡é’ˆæŸ“è‰²å’Œè¯»å±éšœï¼Œä¸ä»…åº”ç”¨åœ¨å¹¶å‘è½¬ç§»é˜¶æ®µï¼Œè¿˜åº”ç”¨åœ¨å¹¶å‘æ ‡è®°é˜¶æ®µï¼šå°†å¯¹è±¡è®¾ç½®ä¸ºå·²æ ‡è®°ï¼Œä¼ ç»Ÿçš„åƒåœ¾å›æ”¶å™¨éœ€è¦è¿›è¡Œä¸€æ¬¡å†…å­˜è®¿é—®ï¼Œå¹¶å°†å¯¹è±¡å­˜æ´»ä¿¡æ¯æ”¾åœ¨å¯¹è±¡å¤´ä¸­ï¼›è€Œåœ¨ ZGC ä¸­ï¼Œåªéœ€è¦è®¾ç½®æŒ‡é’ˆåœ°å€çš„ç¬¬ 42-45 ä½å³å¯ï¼Œå¹¶ä¸”å› ä¸ºæ˜¯å¯„å­˜å™¨è®¿é—®ï¼Œæ‰€ä»¥é€Ÿåº¦æ¯”è®¿é—®å†…å­˜æ›´å¿«ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/54ef59c1775c762f596ea.png\" alt=\"jvmzgc.png\"></p>\n</li>\n</ul>\n<h1>27. ä»€ä¹ˆæ˜¯ OopMap ï¼Ÿ</h1>\n<ul>\n<li>åœ¨ HotSpot ä¸­ï¼Œæœ‰ä¸ªæ•°æ®ç»“æ„ï¼ˆæ˜ å°„è¡¨ï¼‰ç§°ä¸ºOopMapã€‚ä¸€æ—¦ç±»åŠ è½½åŠ¨ä½œå®Œæˆçš„æ—¶å€™ï¼ŒHotSpot å°±ä¼šæŠŠå¯¹è±¡å†…ä»€ä¹ˆåç§»é‡ä¸Šæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®è®¡ç®—å‡ºæ¥ï¼Œè®°å½•åˆ° OopMapã€‚åœ¨å³æ—¶ç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šåœ¨å®‰å…¨ç‚¹ç”Ÿæˆ OopMapï¼Œè®°å½•ä¸‹æ ˆä¸Šå’Œå¯„å­˜å™¨é‡Œå“ªäº›ä½ç½®æ˜¯å¼•ç”¨ã€‚</li>\n</ul>\n<h1>28. ä»€ä¹ˆæ˜¯å®‰å…¨ç‚¹ï¼Ÿ</h1>\n<ul>\n<li>Safe PointæŒ‡Javaçº¿ç¨‹æ‰§è¡Œåˆ°æŸä¸ªä½ç½®æ—¶JVMèƒ½å¤Ÿå®‰å…¨ã€å¯æ§çš„å›æ”¶å¯¹è±¡ã€‚å¦‚æœä¸€ä¸ªJavaçº¿ç¨‹åˆ†é…ä¸€ä¸ªå¯¹è±¡ï¼Œæ­¤æ—¶å¯¹è±¡çš„åœ°å€è¿˜åœ¨å¯„å­˜å™¨ä¸­ï¼Œè¿™æ—¶å€™è¿™ä¸ªçº¿ç¨‹å¤±å»äº†CPUæ—¶é—´ç‰‡ï¼Œè€Œæ­¤æ—¶STW GCå‘ç°æ²¡æœ‰ä»»ä½•GC ROOTS ä¸è¯¥å¯¹è±¡å…³è”èµ·æ¥ï¼Œè¢«è®¤ä¸ºæ˜¯åƒåœ¾å¹¶è¢«å›æ”¶äº†ï¼Œä¹‹åCPUé‡æ–°è·å¾—æ—¶é—´ç‰‡åå‘ç°æ­¤æ—¶å¯¹è±¡å·²ç»ä¸å­˜åœ¨äº†ï¼Œç¨‹åºå‡ºé”™</li>\n<li>SafePoint æŒ‡çš„ç‰¹å®šä½ç½®ä¸»è¦æœ‰ï¼š\n<ul>\n<li>å¾ªç¯çš„æœ«å°¾ (é˜²æ­¢å¤§å¾ªç¯çš„æ—¶å€™ä¸€ç›´ä¸è¿›å…¥ Safepoint ï¼Œè€Œå…¶ä»–çº¿ç¨‹åœ¨ç­‰å¾…å®ƒè¿›å…¥ Safepoint )ã€‚</li>\n<li>æ–¹æ³•è¿”å›å‰ã€‚</li>\n<li>è°ƒç”¨æ–¹æ³•çš„ Call ä¹‹åã€‚</li>\n<li>æŠ›å‡ºå¼‚å¸¸çš„ä½ç½®</li>\n</ul>\n</li>\n</ul>\n<h1>29. cmsæ‰§è¡Œè¿‡ç¨‹ï¼Ÿ</h1>\n<ul>\n<li>åˆå§‹æ ‡è®°ï¼ˆInitial Markï¼‰ï¼šæ ‡è®°æ‰€æœ‰ä» GC Roots ç›´æ¥å¯è¾¾çš„å¯¹è±¡ï¼Œè¿™ä¸ªé˜¶æ®µéœ€è¦ STWï¼Œä½†é€Ÿåº¦å¾ˆå¿«ã€‚</li>\n<li>å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markï¼‰ï¼šä»åˆå§‹æ ‡è®°çš„å¯¹è±¡å‡ºå‘ï¼Œéå†æ‰€æœ‰å¯¹è±¡ï¼Œæ ‡è®°æ‰€æœ‰å¯è¾¾çš„å¯¹è±¡ã€‚è¿™ä¸ªé˜¶æ®µæ˜¯å¹¶å‘è¿›è¡Œçš„ï¼ŒSTWã€‚</li>\n<li>é‡æ–°æ ‡è®°ï¼ˆRemarkï¼‰ï¼šå®Œæˆå‰©ä½™çš„æ ‡è®°å·¥ä½œï¼ŒåŒ…æ‹¬å¤„ç†å¹¶å‘é˜¶æ®µé—ç•™ä¸‹æ¥çš„å°‘é‡å˜åŠ¨ï¼Œè¿™ä¸ªé˜¶æ®µé€šå¸¸éœ€è¦çŸ­æš‚çš„ STW åœé¡¿ã€‚</li>\n<li>å¹¶å‘æ¸…é™¤ï¼ˆConcurrent Sweepï¼‰ï¼šæ¸…é™¤æœªè¢«æ ‡è®°çš„å¯¹è±¡ï¼Œå›æ”¶å®ƒä»¬å ç”¨çš„å†…å­˜ç©ºé—´ã€‚</li>\n</ul>\n<h1>30. G1æ”¶é›†å™¨ï¼Ÿ</h1>\n<ul>\n<li>å¤šçº¿ç¨‹ï¼Œç¼©çŸ­STWæ—¶é—´ã€‚</li>\n<li>G1 æŠŠ Java å †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œæ¯ä¸ªåŒºåŸŸéƒ½å¯ä»¥æ‰®æ¼”Edenã€survivorã€è€å¹´ä»£è§’è‰²ï¼Œå¦å¤–HumongousåŒºå­˜æ”¾å·¨å‹å¯¹è±¡ï¼ˆè¶…è¿‡åˆ†åŒºå®¹é‡50%ï¼‰å¦‚æœä¸€ä¸ªå¤§å¯¹è±¡è¶…è¿‡äº†ä¸€ä¸ª Region å¤§å°çš„ 50%ï¼Œå°±ä¼šè¢«æ”¾å…¥ Humongous ä¸­ã€‚åŒºåŸŸåŒ–ç®¡ç†ä½¿å¾— G1 å¯ä»¥æ›´çµæ´»åœ°è¿›è¡Œåƒåœ¾æ”¶é›†ï¼Œåªå›æ”¶éƒ¨åˆ†åŒºåŸŸè€Œä¸æ˜¯æ•´ä¸ªæ–°ç”Ÿä»£æˆ–è€å¹´ä»£ã€‚</li>\n<li>G1 æ”¶é›†å™¨çš„è¿è¡Œè¿‡ç¨‹ï¼š\n<ul>\n<li>å¹¶å‘æ ‡è®°ï¼Œé€šè¿‡å¹¶å‘æ ‡è®°çš„æ–¹å¼æ‰¾å‡ºå †ä¸­çš„åƒåœ¾å¯¹è±¡ã€‚å¹¶å‘æ ‡è®°é˜¶æ®µä¸åº”ç”¨çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼Œä¸ä¼šå¯¼è‡´åº”ç”¨çº¿ç¨‹æš‚åœã€‚</li>\n<li>æ··åˆæ”¶é›†ï¼Œåœ¨å¹¶å‘æ ‡è®°å®Œæˆåï¼ŒG1 ä¼šè®¡ç®—å‡ºå“ªäº›åŒºåŸŸçš„å›æ”¶ä»·å€¼æœ€é«˜ï¼ˆä¹Ÿå°±æ˜¯åŒ…å«æœ€å¤šåƒåœ¾çš„åŒºåŸŸï¼‰ï¼Œç„¶åä¼˜å…ˆå›æ”¶è¿™äº›åŒºåŸŸã€‚è¿™ç§å›æ”¶æ–¹å¼åŒ…æ‹¬äº†éƒ¨åˆ†æ–°ç”Ÿä»£åŒºåŸŸå’Œè€å¹´ä»£åŒºåŸŸã€‚é€‰æ‹©å›æ”¶æˆæœ¬ä½è€Œæ”¶ç›Šé«˜çš„åŒºåŸŸè¿›è¡Œå›æ”¶ï¼Œå¯ä»¥æé«˜å›æ”¶æ•ˆç‡å’Œå‡å°‘åœé¡¿æ—¶é—´ã€‚</li>\n<li>å¯é¢„æµ‹çš„åœé¡¿ï¼ŒG1 åœ¨åƒåœ¾å›æ”¶æœŸé—´ä»ç„¶éœ€è¦ã€ŒStop the Worldã€ã€‚ä¸è¿‡ï¼ŒG1 åœ¨åœé¡¿æ—¶é—´ä¸Šæ·»åŠ äº†é¢„æµ‹æœºåˆ¶ï¼Œç”¨æˆ·å¯ä»¥ JVM å¯åŠ¨æ—¶æŒ‡å®šæœŸæœ›åœé¡¿æ—¶é—´ï¼ŒG1 ä¼šå°½å¯èƒ½åœ°åœ¨è¿™ä¸ªæ—¶é—´å†…å®Œæˆåƒåœ¾å›æ”¶ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>31. æœ‰äº† CMSï¼Œä¸ºä»€ä¹ˆè¿˜è¦å¼•å…¥ G1ï¼Ÿ</h1>\n<ul>\n<li>CMSæœ€ä¸»è¦çš„ä¼˜ç‚¹æ˜¯å¹¶å‘æ”¶é›†ã€ä½åœé¡¿ã€‚</li>\n<li>CMSç¼ºç‚¹ã€‚\n<ul>\n<li>Mark Sweep ç®—æ³•ä¼šå¯¼è‡´å†…å­˜ç¢ç‰‡æ¯”è¾ƒå¤š</li>\n<li>CMS çš„å¹¶å‘èƒ½åŠ›æ¯”è¾ƒä¾èµ–äº CPU èµ„æºï¼Œå¹¶å‘å›æ”¶æ—¶åƒåœ¾æ”¶é›†çº¿ç¨‹å¯èƒ½ä¼šæŠ¢å ç”¨æˆ·çº¿ç¨‹çš„èµ„æºï¼Œå¯¼è‡´ç”¨æˆ·ç¨‹åºæ€§èƒ½ä¸‹é™ã€‚</li>\n<li>å¹¶å‘æ¸…é™¤é˜¶æ®µï¼Œç”¨æˆ·çº¿ç¨‹ä¾ç„¶åœ¨è¿è¡Œï¼Œä¼šäº§ç”Ÿæ‰€è°“çš„ç†â€œæµ®åŠ¨åƒåœ¾â€ï¼ˆFloating Garbageï¼‰ï¼Œæœ¬æ¬¡åƒåœ¾æ”¶é›†æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼Œå¿…é¡»åˆ°ä¸‹ä¸€æ¬¡åƒåœ¾æ”¶é›†æ‰èƒ½å¤„ç†ã€‚å¦‚æœæµ®åŠ¨åƒåœ¾å¤ªå¤šï¼Œä¼šè§¦å‘æ–°çš„åƒåœ¾å›æ”¶ï¼Œå¯¼è‡´æ€§èƒ½é™ä½ã€‚</li>\n</ul>\n</li>\n<li>G1 ä¸»è¦è§£å†³äº†å†…å­˜ç¢ç‰‡è¿‡å¤šçš„é—®é¢˜ã€‚</li>\n</ul>\n<h1>32. G1 å’Œ CMS çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>CMSä¸»è¦æ­¥éª¤ï¼šåˆå§‹æ”¶é›†ï¼Œå¹¶å‘æ ‡è®°ï¼Œé‡æ–°æ ‡è®°ï¼Œå¹¶å‘æ¸…é™¤ï¼ˆåˆ é™¤ï¼‰ã€é‡ç½®ã€‚</li>\n<li>G1ä¸»è¦æ­¥éª¤ï¼šåˆå§‹æ ‡è®°ï¼Œå¹¶å‘æ ‡è®°ï¼Œé‡æ–°æ ‡è®°ï¼Œå¤åˆ¶æ¸…é™¤ï¼ˆæ•´ç†ï¼‰</li>\n<li>CMSç¼ºç‚¹æ˜¯å¯¹CPUè¦æ±‚é«˜ã€‚G1å°†å†…å­˜åŒ–æˆäº†å¤šå—ï¼Œæ‰€æœ‰å¯¹å†…å­˜è¦æ±‚é«˜</li>\n<li>CMSæ˜¯æ¸…é™¤ï¼Œå­˜åœ¨å†…å­˜ç¢ç‰‡ã€‚G1æ˜¯æ•´ç†ï¼Œç¢ç‰‡ç©ºé—´è¾ƒå°ã€‚</li>\n<li>G1å’ŒCMSéƒ½æ˜¯å“åº”æ—¶é—´ä¼˜å…ˆï¼Œéƒ½æ˜¯å°½é‡æ§åˆ¶ STW æ—¶é—´ã€‚</li>\n</ul>\n<h1>33. çº¿ä¸Šç”¨çš„ä»€ä¹ˆåƒåœ¾æ”¶é›†å™¨ï¼Ÿä¸ºä»€ä¹ˆè¦ç”¨å®ƒï¼Ÿ</h1>\n<ul>\n<li>jdk8é»˜è®¤æ”¶é›†å™¨java -XX:+PrintCommandLineFlags -versionæŸ¥çœ‹-&gt;-XX:+UseParallelGCè¡¨ç¤ºçš„æ˜¯æ–°ç”Ÿä»£ç”¨çš„Parallel Scavengeæ”¶é›†å™¨ï¼Œè€å¹´ä»£ç”¨çš„æ˜¯Parallel Old æ”¶é›†å™¨ã€‚</li>\n<li><strong>é‡‡ç”¨Parallel Scavenge + Parallel Oldçš„ç»„åˆã€‚ç³»ç»Ÿä¸šåŠ¡ç›¸å¯¹å¤æ‚ï¼Œä½†å¹¶å‘å¹¶ä¸æ˜¯éå¸¸é«˜ï¼Œå¸Œæœ›å°½å¯èƒ½åˆ©ç”¨å¤„ç†å™¨èµ„æºï¼Œå‡ºäºæé«˜ååé‡çš„è€ƒè™‘</strong></li>\n<li>é‡‡ç”¨Parallel New+CMSçš„ç»„åˆï¼Œæˆ‘ä»¬æ¯”è¾ƒå…³æ³¨æœåŠ¡çš„å“åº”é€Ÿåº¦ï¼Œæ‰€ä»¥é‡‡ç”¨äº† CMS æ¥é™ä½åœé¡¿æ—¶é—´ã€‚</li>\n<li>é‡‡ç”¨ G1 åƒåœ¾æ”¶é›†å™¨ï¼Œå› ä¸ºå®ƒä¸ä»…æ»¡è¶³æˆ‘ä»¬ä½åœé¡¿çš„è¦æ±‚ï¼Œè€Œä¸”è§£å†³äº† CMS çš„æµ®åŠ¨åƒåœ¾é—®é¢˜ã€å†…å­˜ç¢ç‰‡é—®é¢˜</li>\n</ul>\n<h1>34. åƒåœ¾æ”¶é›†å™¨åº”è¯¥å¦‚ä½•é€‰æ‹©ï¼Ÿ</h1>\n<ul>\n<li>Serial ï¼šå¦‚æœåº”ç”¨ç¨‹åºæœ‰ä¸€ä¸ªå¾ˆå°çš„å†…å­˜ç©ºé—´ï¼ˆå¤§çº¦ 100 MBï¼‰äº¦æˆ–å®ƒåœ¨æ²¡æœ‰åœé¡¿æ—¶é—´è¦æ±‚çš„å•çº¿ç¨‹å¤„ç†å™¨ä¸Šè¿è¡Œã€‚</li>\n<li>Parallelï¼šå¦‚æœä¼˜å…ˆè€ƒè™‘åº”ç”¨ç¨‹åºçš„å³°å€¼æ€§èƒ½ï¼Œå¹¶ä¸”æ²¡æœ‰æ—¶é—´è¦æ±‚è¦æ±‚ï¼Œæˆ–è€…å¯ä»¥æ¥å— 1 ç§’æˆ–æ›´é•¿çš„åœé¡¿æ—¶é—´ã€‚</li>\n<li>CMS/G1ï¼šå¦‚æœå“åº”æ—¶é—´æ¯”ååé‡ä¼˜å…ˆçº§é«˜ï¼Œæˆ–è€…åƒåœ¾æ”¶é›†æš‚åœå¿…é¡»ä¿æŒåœ¨å¤§çº¦ 1 ç§’ä»¥å†…ã€‚</li>\n<li>ZGCï¼šå¦‚æœå“åº”æ—¶é—´æ˜¯é«˜ä¼˜å…ˆçº§çš„ï¼Œæˆ–è€…å †ç©ºé—´æ¯”è¾ƒå¤§</li>\n</ul>\n<h1>35. å¯¹è±¡ä¸€å®šåˆ†é…åœ¨å †ä¸­å—ï¼Ÿæœ‰æ²¡æœ‰äº†è§£é€ƒé€¸åˆ†ææŠ€æœ¯ï¼Ÿå¥½å¤„ï¼Ÿ</h1>\n<ul>\n<li>\n<p>å¯¹è±¡ä¸ä¸€å®šåˆ†é…åœ¨å †ä¸­ã€‚åœ¨ç¼–è¯‘æœŸé—´ï¼ŒJIT ä¼šå¯¹ä»£ç åšå¾ˆå¤šä¼˜åŒ–ã€‚å…¶ä¸­æœ‰ä¸€éƒ¨åˆ†ä¼˜åŒ–çš„ç›®çš„å°±æ˜¯å‡å°‘å†…å­˜å †åˆ†é…å‹åŠ›ï¼Œå…¶ä¸­ä¸€ç§æŠ€æœ¯å«åšé€ƒé€¸åˆ†æã€‚</p>\n</li>\n<li>\n<p>é€ƒé€¸åˆ†ææ˜¯æŒ‡åˆ†ææŒ‡é’ˆåŠ¨æ€èŒƒå›´çš„æ–¹æ³•ï¼Œå®ƒåŒç¼–è¯‘å™¨ä¼˜åŒ–åŸç†çš„æŒ‡é’ˆåˆ†æå’Œå¤–å½¢åˆ†æç›¸å…³è”ã€‚å½“å˜é‡ï¼ˆæˆ–è€…å¯¹è±¡ï¼‰åœ¨æ–¹æ³•ä¸­åˆ†é…åï¼Œå…¶æŒ‡é’ˆæœ‰å¯èƒ½è¢«è¿”å›æˆ–è€…è¢«å…¨å±€å¼•ç”¨ï¼Œè¿™æ ·å°±ä¼šè¢«å…¶ä»–æ–¹æ³•æˆ–è€…çº¿ç¨‹æ‰€å¼•ç”¨ï¼Œè¿™ç§ç°è±¡ç§°ä½œæŒ‡é’ˆï¼ˆæˆ–è€…å¼•ç”¨ï¼‰çš„é€ƒé€¸(Escape)ã€‚é€šä¿—ç‚¹è®²ï¼Œå½“ä¸€ä¸ªå¯¹è±¡è¢« new å‡ºæ¥ä¹‹åï¼Œå®ƒå¯èƒ½è¢«å¤–éƒ¨æ‰€è°ƒç”¨ï¼Œå¦‚æœæ˜¯ä½œä¸ºå‚æ•°ä¼ é€’åˆ°å¤–éƒ¨äº†ï¼Œå°±ç§°ä¹‹ä¸ºæ–¹æ³•é€ƒé€¸ã€‚å¦‚æœå¯¹è±¡è¿˜æœ‰å¯èƒ½è¢«å¤–éƒ¨çº¿ç¨‹è®¿é—®åˆ°ï¼Œä¾‹å¦‚èµ‹å€¼ç»™å¯ä»¥åœ¨å…¶å®ƒçº¿ç¨‹ä¸­è®¿é—®çš„å®ä¾‹å˜é‡ï¼Œè¿™ç§å°±è¢«ç§°ä¸ºçº¿ç¨‹é€ƒé€¸ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/49635d303930f7f90c7a7.png\" alt=\"jvmescape.png\"></p>\n</li>\n<li>\n<p>é€ƒé€¸åˆ†æçš„å¥½å¤„</p>\n<ul>\n<li>æ ˆä¸Šåˆ†é…:å¦‚æœç¡®å®šä¸€ä¸ªå¯¹è±¡ä¸ä¼šé€ƒé€¸åˆ°çº¿ç¨‹ä¹‹å¤–ï¼Œé‚£ä¹ˆä¹…å¯ä»¥è€ƒè™‘å°†è¿™ä¸ªå¯¹è±¡åœ¨æ ˆä¸Šåˆ†é…ï¼Œå¯¹è±¡å ç”¨çš„å†…å­˜éšç€æ ˆå¸§å‡ºæ ˆè€Œé”€æ¯ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåƒåœ¾æ”¶é›†çš„å‹åŠ›å°±é™ä½å¾ˆå¤šã€‚</li>\n<li>åŒæ­¥æ¶ˆé™¤:çº¿ç¨‹åŒæ­¥æœ¬èº«æ˜¯ä¸€ä¸ªç›¸å¯¹è€—æ—¶çš„è¿‡ç¨‹ï¼Œå¦‚æœé€ƒé€¸åˆ†æèƒ½å¤Ÿç¡®å®šä¸€ä¸ªå˜é‡ä¸ä¼šé€ƒé€¸å‡ºçº¿ç¨‹ï¼Œæ— æ³•è¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œé‚£ä¹ˆè¿™ä¸ªå˜é‡çš„è¯»å†™è‚¯å®šå°±ä¸ä¼šæœ‰ç«äº‰ï¼Œ å¯¹è¿™ä¸ªå˜é‡å®æ–½çš„åŒæ­¥æªæ–½ä¹Ÿå°±å¯ä»¥å®‰å…¨åœ°æ¶ˆé™¤æ‰ã€‚</li>\n<li>æ ‡é‡æ›¿æ¢:å¦‚æœä¸€ä¸ªæ•°æ®æ˜¯åŸºæœ¬æ•°æ®ç±»å‹ï¼Œä¸å¯æ‹†åˆ†ï¼Œå®ƒå°±è¢«ç§°ä¹‹ä¸ºæ ‡é‡ã€‚æŠŠä¸€ä¸ª Java å¯¹è±¡æ‹†æ•£ï¼Œå°†å…¶ç”¨åˆ°çš„æˆå‘˜å˜é‡æ¢å¤ä¸ºåŸå§‹ç±»å‹æ¥è®¿é—®ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±ç§°ä¸ºæ ‡é‡æ›¿æ¢ã€‚å‡å¦‚é€ƒé€¸åˆ†æèƒ½å¤Ÿè¯æ˜ä¸€ä¸ªå¯¹è±¡ä¸ä¼šè¢«æ–¹æ³•å¤–éƒ¨è®¿é—®ï¼Œå¹¶ä¸”è¿™ä¸ªå¯¹è±¡å¯ä»¥è¢«æ‹†æ•£ï¼Œé‚£ä¹ˆå¯ä»¥ä¸åˆ›å»ºå¯¹è±¡ï¼Œç›´æ¥ç”¨åˆ›å»ºè‹¥å¹²ä¸ªæˆå‘˜å˜é‡ä»£æ›¿ï¼Œå¯ä»¥è®©å¯¹è±¡çš„æˆå‘˜å˜é‡åœ¨æ ˆä¸Šåˆ†é…å’Œè¯»å†™ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>36. æœ‰å“ªäº›å¸¸ç”¨çš„å‘½ä»¤è¡Œæ€§èƒ½ç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·ï¼Ÿ</h1>\n<ul>\n<li>æ“ä½œç³»ç»Ÿå·¥å…·\n<ul>\n<li>topï¼šæ˜¾ç¤ºç³»ç»Ÿæ•´ä½“èµ„æºä½¿ç”¨æƒ…å†µ</li>\n<li>vmstatï¼šç›‘æ§å†…å­˜å’Œ CPU</li>\n<li>iostatï¼šç›‘æ§ IO ä½¿ç”¨</li>\n<li>netstatï¼šç›‘æ§ç½‘ç»œä½¿ç”¨</li>\n</ul>\n</li>\n<li>JDK æ€§èƒ½ç›‘æ§å·¥å…·\n<ul>\n<li>jpsï¼šè™šæ‹Ÿæœºè¿›ç¨‹æŸ¥çœ‹</li>\n<li>jstatï¼šè™šæ‹Ÿæœºè¿è¡Œæ—¶ä¿¡æ¯æŸ¥çœ‹</li>\n<li>jinfoï¼šè™šæ‹Ÿæœºé…ç½®æŸ¥çœ‹</li>\n<li>jmapï¼šå†…å­˜æ˜ åƒï¼ˆå¯¼å‡ºï¼‰</li>\n<li>jhatï¼šå †è½¬å‚¨å¿«ç…§åˆ†æ</li>\n<li>jstackï¼šJava å †æ ˆè·Ÿè¸ª</li>\n<li>jcmdï¼šå®ç°ä¸Šé¢é™¤äº† jstat å¤–æ‰€æœ‰å‘½ä»¤çš„åŠŸèƒ½</li>\n</ul>\n</li>\n</ul>\n<h1>37. äº†è§£å“ªäº›å¯è§†åŒ–çš„æ€§èƒ½ç›‘æ§å’Œæ•…éšœå¤„ç†å·¥å…·ï¼Ÿ</h1>\n<ul>\n<li>JConsole</li>\n<li>VisualVM</li>\n<li>Java Mission Control</li>\n<li>MAT Java å †å†…å­˜åˆ†æå·¥å…·ã€‚</li>\n<li>GChisto GC æ—¥å¿—åˆ†æå·¥å…·ã€‚</li>\n<li>GCViewer GC æ—¥å¿—åˆ†æå·¥å…·ã€‚</li>\n<li>JProfiler å•†ç”¨çš„æ€§èƒ½åˆ†æåˆ©å™¨ã€‚</li>\n<li>arthas é˜¿é‡Œå¼€æºè¯Šæ–­å·¥å…·ã€‚</li>\n<li>async-profiler Java åº”ç”¨æ€§èƒ½åˆ†æå·¥å…·ï¼Œå¼€æºã€ç«ç„°å›¾ã€è·¨å¹³å°ã€‚</li>\n</ul>\n<h1>38. å¸¸ä½¿ç”¨çš„jvm -XXå‚æ•° âˆš</h1>\n<ul>\n<li>\n<ol>\n<li>å †è®¾ç½®</li>\n</ol>\n<ul>\n<li>-Xmsï¼šåˆå§‹å †å¤§å° -Xms512mï¼šç­‰ä»·äº-XX:InitialHeapSizeï¼Œè®¾ç½®JVMåˆå§‹å †å†…å­˜ä¸º512Mã€‚</li>\n<li>-Xmxï¼šæœ€å¤§å †å¤§å° -Xmx2048mï¼šç­‰ä»·äº-XX:MaxHeapSizeï¼Œè®¾ç½®JVMæœ€å¤§å †å†…å­˜ä¸º2048Mã€‚</li>\n<li>-Xmn\tæ–°ç”Ÿä»£å¤§å°</li>\n<li>-XX:NewSize=nï¼šè®¾ç½®å¹´è½»ä»£å¤§å°</li>\n<li>-XX:PermSize\tåˆå§‹åŒ–æ°¸ä¹…ä»£å¤§å°</li>\n<li>-XX:MaxPermSize=nï¼šè®¾ç½®æŒä¹…ä»£å¤§å°</li>\n<li>-XX:NewRatio=nï¼šå¹´è½»ä»£å’Œå¹´è€ä»£çš„æ¯”å€¼ã€‚ä¸º3ï¼Œè¡¨ç¤ºå¹´è½»ä»£ä¸å¹´è€ä»£æ¯”å€¼ä¸º1ï¼š3ï¼Œå¹´è½»ä»£å æ•´ä¸ªå¹´è½»ä»£å¹´è€ä»£å’Œçš„ 1/4</li>\n<li>-XX:SurvivorRatio=nï¼šå¹´è½»ä»£ä¸­ Eden åŒºä¸ä¸¤ä¸ª Survivor åŒºçš„æ¯”å€¼ã€‚æ³¨æ„ Survivor åŒºæœ‰ä¸¤ä¸ªã€‚å¦‚ï¼š3ï¼Œè¡¨ç¤º Edenï¼šSurvivor=3ï¼š2ï¼Œä¸€ä¸ªSurvivoråŒºå æ•´ä¸ªå¹´è½»ä»£çš„ 1/5</li>\n<li>-XX:Xmn\tè®¾ç½®å¹´è½»ä»£å¤§å°</li>\n</ul>\n</li>\n<li>\n<ol start=\"2\">\n<li>æ”¶é›†å™¨è®¾ç½®</li>\n</ol>\n<ul>\n<li>-XX:+UserSerialGC\tä¸²è¡Œåƒåœ¾æ”¶é›†å™¨</li>\n<li>-XX:+UserParrallelGC\tå¹¶è¡Œåƒåœ¾æ”¶é›†å™¨</li>\n<li>-XX:+UseParalledlOldGC:è®¾ç½®å¹¶è¡Œå¹´è€ä»£æ”¶é›†å™¨</li>\n<li>-XX:+UseConcMarkSweepGC\tå¹¶å‘æ ‡è®°æ‰«æåƒåœ¾å›æ”¶å™¨</li>\n<li>-XX:+UseG1GC\tG1åƒåœ¾å›æ”¶å™¨</li>\n</ul>\n</li>\n<li>å¹¶è¡Œæ”¶é›†å™¨å‚æ•°è®¾ç½®\n<ul>\n<li>-XX:ParallelCMSThreads=n\tè®¾ç½®å¹¶è¡Œæ”¶é›†å™¨æ”¶é›†æ—¶ä½¿ç”¨çš„ CPU æ•°ã€‚å¹¶è¡Œæ”¶é›†çº¿ç¨‹æ•°</li>\n<li>-XX:MaxGCPauseMillis=n:è®¾ç½®å¹¶è¡Œæ”¶é›†æœ€å¤§çš„æš‚åœæ—¶é—´ï¼ˆå¦‚æœåˆ°è¿™ä¸ªæ—¶é—´äº†ï¼Œåƒåœ¾å›æ”¶å™¨ä¾ç„¶æ²¡æœ‰å›æ”¶å®Œï¼Œä¹Ÿä¼šåœæ­¢å›æ”¶ï¼‰</li>\n<li>-XX:GCTimeRatio=n:è®¾ç½®åƒåœ¾å›æ”¶æ—¶é—´å ç¨‹åºè¿è¡Œæ—¶é—´çš„ç™¾åˆ†æ¯”ã€‚å…¬å¼ä¸ºï¼š1/(1+n)</li>\n<li>-XX:+CMSIncrementalMode:è®¾ç½®ä¸ºå¢é‡æ¨¡å¼ã€‚é€‚ç”¨äºå• CPU æƒ…å†µ</li>\n<li>-XX:ParallelGCThreads=n:è®¾ç½®å¹¶å‘æ”¶é›†å™¨å¹´è½»ä»£æ‰‹æœºæ–¹å¼ä¸ºå¹¶è¡Œæ”¶é›†æ—¶ï¼Œä½¿ç”¨çš„ CPU æ•°ã€‚å¹¶è¡Œæ”¶é›†çº¿ç¨‹æ•°</li>\n</ul>\n</li>\n<li>\n<ol start=\"3\">\n<li>åƒåœ¾å›æ”¶ç»Ÿè®¡ä¿¡æ¯ ï¼ˆ<a href=\"https://gceasy.io\" target=\"_blank\" rel=\"noopener noreferrer\">https://gceasy.io</a>ï¼‰</li>\n</ol>\n<ul>\n<li>-XX:+PrintGCï¼šå¼€å¯æ‰“å°gcä¿¡æ¯</li>\n<li>-XX:+PrintGCDetailsï¼šæ‰“å° gc è¯¦ç»†ä¿¡æ¯<br>\nâ€ -XX:+PrintGCTimeStamps è¾“å‡ºGCçš„æ—¶é—´æˆ³ï¼ˆä»¥åŸºå‡†æ—¶é—´çš„å½¢å¼ï¼‰<br>\nâ€ -XX:+PrintGCDateStamps è¾“å‡ºGCçš„æ—¶é—´æˆ³ï¼ˆä»¥æ—¥æœŸçš„å½¢å¼ï¼Œå¦‚ 2013â€05â€04T21:53:59.234+0800ï¼‰</li>\n<li>-Xloggc:filename ../logs/gc.log æ—¥å¿—æ–‡ä»¶çš„è¾“å‡ºè·¯å¾„ï¼ˆGC Easyå·¥å…·å¯ä»¥ç›´æ¥é€‰æ‹©æ—¥å¿—æ–‡ä»¶æŸ¥çœ‹ï¼‰</li>\n<li>â€XX:+PrintHeapAtGC åœ¨è¿›è¡ŒGCçš„å‰åæ‰“å°å‡ºå †çš„ä¿¡æ¯</li>\n</ul>\n</li>\n<li>\n<ol start=\"6\">\n<li>è®¾ç½®ç³»ç»Ÿå±æ€§å‚æ•°</li>\n</ol>\n<ul>\n<li>-D&lt;åç§°&gt;=&lt;å€¼&gt; å¯é€šè¿‡System.getProperty(\"åç§°\");è·å¾—</li>\n<li>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„javaè¿›ç¨‹æ‰€æœ‰å‚æ•°jinfo â€flags pid</li>\n<li>æŸ¥çœ‹æ­£åœ¨è¿è¡Œçš„javaè¿›ç¨‹å…·ä½“å‚æ•°jinfo â€flag MaxHeapSize pid</li>\n<li>å®Œæ•´å‘½ä»¤ps -ef |grep java |grep -w x.jar|grep -v 'grep'|awk '{print $2}'| xargs -i{}  jinfo â€flags {}</li>\n</ul>\n</li>\n</ul>\n<h1>45. æœ‰æ²¡æœ‰å¤„ç†è¿‡å†…å­˜æº¢å‡ºé—®é¢˜ï¼Ÿ</h1>\n<ul>\n<li>å†…å­˜æ³„æ¼å’Œå†…å­˜æº¢å‡ºäºŒè€…å…³ç³»éå¸¸å¯†åˆ‡ï¼Œå†…å­˜æº¢å‡ºå¯èƒ½ä¼šæœ‰å¾ˆå¤šåŸå› å¯¼è‡´ï¼Œå†…å­˜æ³„æ¼æœ€å¯èƒ½çš„ç½ªé­ç¥¸é¦–ä¹‹ä¸€ã€‚</li>\n<li>æ’æŸ¥è¿‡ç¨‹å’Œæ’æŸ¥å†…å­˜æ³„æ¼è¿‡ç¨‹ç±»ä¼¼ã€‚</li>\n</ul>\n<h1>46. è§£é‡Šæ‰§è¡Œå’Œç¼–è¯‘æ‰§è§£é‡Šå’Œç¼–è¯‘çš„åŒºåˆ«ï¼š</h1>\n<ul>\n<li>è§£é‡Šï¼šå°†æºä»£ç é€è¡Œè½¬æ¢ä¸ºæœºå™¨ç ã€‚</li>\n<li>ç¼–è¯‘ï¼šå°†æºä»£ç ä¸€æ¬¡æ€§è½¬æ¢ä¸ºæœºå™¨ç ã€‚</li>\n<li>è§£é‡Šæ‰§è¡Œï¼šç¨‹åºè¿è¡Œæ—¶ï¼Œå°†æºä»£ç é€è¡Œè½¬æ¢ä¸ºæœºå™¨ç ï¼Œç„¶åæ‰§è¡Œã€‚</li>\n<li>ç¼–è¯‘æ‰§è¡Œï¼šç¨‹åºè¿è¡Œå‰ï¼Œå°†æºä»£ç ä¸€æ¬¡æ€§è½¬æ¢ä¸ºæœºå™¨ç ï¼Œç„¶åæ‰§è¡Œã€‚</li>\n<li>Javaè¢«ç§°ä¸ºâ€œè§£é‡Šå‹è¯­è¨€â€ï¼Œå› ä¸ºJavaä»£ç æ‰§è¡Œå‰ï¼Œéœ€è¦å…ˆå°†æºä»£ç ç¼–è¯‘æˆå­—èŠ‚ç ï¼Œç„¶ååœ¨è¿è¡Œæ—¶ï¼Œå†ç”± JVM çš„è§£é‡Šå™¨â€œé€è¡Œâ€å°†å­—èŠ‚ç è½¬æ¢ä¸ºæœºå™¨ç ï¼Œç„¶åæ‰§è¡Œã€‚è¿™ä¹Ÿæ˜¯ Java è¢«è¯Ÿç—…â€œæ…¢â€çš„ä¸»è¦åŸå› ã€‚</li>\n<li>JIT çš„å‡ºç°æ‰“ç ´äº†è¿™ç§åˆ»æ¿å°è±¡ï¼ŒJVM ä¼šå°†çƒ­ç‚¹ä»£ç ï¼ˆå³è¿è¡Œé¢‘ç‡é«˜çš„ä»£ç ï¼‰ç¼–è¯‘åæ”¾å…¥ CodeCacheï¼Œå½“ä¸‹æ¬¡æ‰§è¡Œå†é‡åˆ°è¿™æ®µä»£ç æ—¶ï¼Œä¼šä» CodeCache ä¸­ç›´æ¥è¯»å–æœºå™¨ç ï¼Œç„¶åæ‰§è¡Œã€‚è¿™å¤§å¤§æå‡äº† Java çš„æ‰§è¡Œæ•ˆç‡ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d38fbe4b99861fd6dfa24.png\" alt=\"jvmexplain.png\"></li>\n</ul>\n<h1>47. ç±»çš„åŠ è½½æœºåˆ¶ï¼Ÿ</h1>\n<ul>\n<li>JVM çš„æ“ä½œå¯¹è±¡æ˜¯ Class æ–‡ä»¶ï¼ŒJVM æŠŠ Class æ–‡ä»¶ä¸­æè¿°ç±»çš„æ•°æ®ç»“æ„åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œæ ¡éªŒã€è§£æå’Œåˆå§‹åŒ–ï¼Œæœ€ç»ˆå½¢æˆå¯ä»¥è¢« JVM ç›´æ¥ä½¿ç”¨çš„ç±»å‹ï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºç±»åŠ è½½æœºåˆ¶ã€‚</li>\n</ul>\n<h1>48. ç±»çš„ç”Ÿå‘½å‘¨æœŸå—ï¼Ÿ</h1>\n<ul>\n<li>ä¸€ä¸ªç±»ä»è¢«åŠ è½½åˆ°è™šæ‹Ÿæœºå†…å­˜ä¸­å¼€å§‹ï¼Œåˆ°ä»å†…å­˜ä¸­å¸è½½ï¼Œæ•´ä¸ªç”Ÿå‘½å‘¨æœŸéœ€è¦ç»è¿‡ä¸ƒä¸ªé˜¶æ®µï¼šåŠ è½½ ï¼ˆLoadingï¼‰ã€éªŒè¯ï¼ˆVerificationï¼‰ã€å‡†å¤‡ï¼ˆPreparationï¼‰ã€è§£æï¼ˆResolutionï¼‰ã€åˆå§‹åŒ– ï¼ˆInitializationï¼‰ã€ä½¿ç”¨ï¼ˆUsingï¼‰å’Œå¸è½½ï¼ˆUnloadingï¼‰ï¼Œå…¶ä¸­éªŒè¯ã€å‡†å¤‡ã€è§£æä¸‰ä¸ªéƒ¨åˆ†ç»Ÿç§°ä¸ºè¿æ¥ï¼ˆLinkingï¼‰ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/63d05f55215bb01703097.png\" alt=\"classlife.png\"></li>\n</ul>\n<h1>49. ç±»åŠ è½½å™¨æ˜¯å¦‚ä½•åŠ è½½Classæ–‡ä»¶ï¼Ÿ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6db427fa24fe468568e6b.png\" alt=\"processofloadingclass.png\" tabindex=\"0\"><figcaption>processofloadingclass.png</figcaption></figure>\n<ul>\n<li>ç±»åŠ è½½è¿‡ç¨‹æœ‰ï¼šè½½å…¥ã€éªŒè¯ã€å‡†å¤‡ã€è§£æã€åˆå§‹åŒ–ã€‚è¿™ 5 ä¸ªé˜¶æ®µä¸€èˆ¬æ˜¯é¡ºåºå‘ç”Ÿçš„ï¼Œä½†åœ¨åŠ¨æ€ç»‘å®šçš„æƒ…å†µä¸‹ï¼Œè§£æé˜¶æ®µä¼šå‘ç”Ÿåœ¨åˆå§‹åŒ–é˜¶æ®µä¹‹åã€‚</li>\n<li>åŠ è½½(Loading)ï¼Œæ‰¾åˆ°.classæ–‡ä»¶å¹¶æŠŠæ–‡ä»¶åŒ…å«çš„å­—èŠ‚ç åŠ è½½åˆ°å†…å­˜ä¸­ã€‚ä½¿ç”¨ç³»ç»Ÿæä¾›æˆ–è€…çš„ç±»åŠ è½½å™¨æ¥å®ŒæˆåŠ è½½ã€‚åŠ è½½é˜¶æ®µå®Œæˆåï¼Œè™šæ‹Ÿæœºå¤–éƒ¨çš„äºŒè¿›åˆ¶å­—èŠ‚æµå°±æŒ‰ç…§è™šæ‹Ÿæœºæ‰€éœ€çš„æ ¼å¼å­˜å‚¨åœ¨æ–¹æ³•åŒºä¹‹ä¸­ï¼Œè€Œä¸”åœ¨Javaå †ä¸­ä¹Ÿåˆ›å»ºä¸€ä¸ª java.lang.Class ç±»çš„å¯¹è±¡ï¼Œè¿™æ ·ä¾¿å¯ä»¥é€šè¿‡è¯¥å¯¹è±¡è®¿é—®æ–¹æ³•åŒºä¸­çš„è¿™äº›æ•°æ®ã€‚åœ¨åŠ è½½é˜¶æ®µï¼Œè™šæ‹Ÿæœºéœ€è¦å®Œæˆä»¥ä¸‹ä¸‰ä»¶äº‹æƒ…ï¼š\n<ul>\n<li>é€šè¿‡ä¸€ä¸ªç±»çš„å…¨é™å®šåæ¥è·å–å…¶å®šä¹‰çš„äºŒè¿›åˆ¶å­—èŠ‚æµã€‚</li>\n<li>å°†è¿™ä¸ªå­—èŠ‚æµæ‰€ä»£è¡¨çš„é™æ€å­˜å‚¨ç»“æ„è½¬åŒ–ä¸ºæ–¹æ³•åŒºçš„è¿è¡Œæ—¶æ•°æ®ç»“æ„ã€‚</li>\n<li>åœ¨Javaå †ä¸­ç”Ÿæˆä¸€ä¸ªä»£è¡¨è¿™ä¸ªç±»çš„ java.lang.Class å¯¹è±¡ï¼Œä½œä¸ºå¯¹æ–¹æ³•åŒºä¸­è¿™äº›æ•°æ®çš„è®¿é—®å…¥å£ã€‚</li>\n</ul>\n</li>\n<li>éªŒè¯ï¼šå¯¹äºŒè¿›åˆ¶å­—èŠ‚æµè¿›è¡Œæ ¡éªŒï¼Œåªæœ‰ç¬¦åˆ JVM å­—èŠ‚ç è§„èŒƒçš„æ‰èƒ½è¢« JVM æ­£ç¡®æ‰§è¡Œã€‚</li>\n<li>å‡†å¤‡ï¼šå¯¹ç±»å˜é‡ï¼ˆä¹Ÿç§°ä¸ºé™æ€å˜é‡ï¼Œstatic å…³é”®å­—ä¿®é¥°çš„å˜é‡ï¼‰åˆ†é…å†…å­˜å¹¶åˆå§‹åŒ–ï¼Œåˆå§‹åŒ–ä¸ºæ•°æ®ç±»å‹çš„é»˜è®¤å€¼ï¼Œå¦‚ 0ã€0Lã€nullã€false ç­‰ã€‚</li>\n<li>è§£æï¼šæ˜¯è™šæ‹Ÿæœºå°†å¸¸é‡æ± å†…çš„ç¬¦å·å¼•ç”¨æ›¿æ¢ä¸ºç›´æ¥å¼•ç”¨çš„è¿‡ç¨‹ã€‚è§£æåŠ¨ä½œä¸»è¦é’ˆå¯¹ç±»æˆ–æ¥å£ã€å­—æ®µã€ç±»æ–¹æ³•ã€æ¥å£æ–¹æ³•ã€æˆå‘˜æ–¹æ³•ç­‰ã€‚</li>\n<li>åˆå§‹åŒ–ï¼šç±»å˜é‡å°†è¢«èµ‹å€¼ä¸ºä»£ç æœŸæœ›èµ‹çš„å€¼ã€‚æ˜¯æ‰§è¡Œç±»çš„æ„é€ æ–¹æ³•ï¼ˆjavap ä¸­çœ‹åˆ°çš„ <code>&lt;clinit&gt;</code>() æ–¹æ³•ï¼‰çš„è¿‡ç¨‹ã€‚</li>\n</ul>\n<h1>50. jvmç±»åŠ è½½å™¨?</h1>\n<ul>\n<li>ç±»åŠ è½½å™¨(ClassLoader)ï¼Œè´Ÿè´£åŠ è½½ç±»æ–‡ä»¶ï¼Œå°†ç±»æ–‡ä»¶åŠ è½½åˆ°å†…å­˜ä¸­ï¼Œç”Ÿæˆ Class å¯¹è±¡ã€‚</li>\n<li>BootstrapLoaderï¼šå¯åŠ¨ç±»åŠ è½½å™¨ï¼Œè´Ÿè´£åŠ è½½ JVM çš„æ ¸å¿ƒç±»åº“ï¼Œå¦‚ rt.jarå’Œä½äºJAVA_HOME/jre/libç›®å½•ä¸‹çš„ç±»ã€‚å…¶æ— æ³•è¢«Javaç¨‹åºç›´æ¥å¼•ç”¨ã€‚</li>\n<li>ExtClassLoaderï¼šæ‰©å±•ç±»åŠ è½½å™¨ åŠ è½½æ‰©å±•ç±»(å°±æ˜¯ç»§æ‰¿ç±»å’Œå®ç°ç±»)ï¼ŒåŠ è½½\\lib\\extç›®å½•æˆ–è€…è¢« java.ext.dirsç³»ç»Ÿå˜é‡æŒ‡å®šçš„è·¯å¾„ä¸­çš„æ‰€æœ‰ç±»åº“</li>\n<li>AppClassLoaderï¼šåŠ è½½æ¥è‡ªJavaå‘½ä»¤çš„-classpathé€‰é¡¹ã€java.class.pathç³»ç»Ÿå±æ€§æˆ–CLASSPATHç¯å¢ƒå˜é‡æ‰€æŒ‡å®šçš„jaråŒ…å’Œç±»è·¯å¾„ã€‚ç¼–å†™çš„ä»»ä½•ç±»éƒ½æ˜¯ç”±åº”ç”¨ç¨‹åºç±»åŠ è½½å™¨åŠ è½½çš„ï¼Œé™¤éæ˜¾å¼ä½¿ç”¨è‡ªå®šä¹‰ç±»åŠ è½½å™¨ã€‚</li>\n<li>ç”¨æˆ·è‡ªå®šä¹‰ç±»åŠ è½½å™¨ (User-Defined ClassLoader)ï¼Œé€šè¿‡ç»§æ‰¿java.lang.ClassLoaderç±»æ¥åˆ›å»ºè‡ªå·±çš„ç±»åŠ è½½å™¨ã€‚é€šå¸¸ç”¨äºåŠ è½½ç½‘ç»œä¸Šçš„ç±»ã€æ‰§è¡Œçƒ­éƒ¨ç½²ï¼ˆåŠ¨æ€åŠ è½½å’Œæ›¿æ¢åº”ç”¨ç¨‹åºçš„ç»„ä»¶ï¼‰æˆ–ä¸ºäº†å®‰å…¨ç›®çš„è‡ªå®šä¹‰ç±»çš„åŠ è½½æ–¹å¼ã€‚</li>\n</ul>\n<h1>51. ä»€ä¹ˆæ˜¯åŒäº²å§”æ´¾æ¨¡å‹ï¼ˆParent Delegation Modeï¼‰ï¼Ÿ</h1>\n<ul>\n<li>å·¥ä½œè¿‡ç¨‹ï¼šClassLoaderå…ˆä»è‡ªå·±å·²ç»åŠ è½½çš„ç±»ç¼“å­˜ä¸­ï¼ŒæŸ¥è¯¢æ˜¯å¦æ­¤ç±»å·²ç»åŠ è½½ï¼Œå¦‚æœå·²ç»åŠ è½½åˆ™ç›´æ¥è¿”å›åŸæ¥å·²ç»åŠ è½½çš„ç±»ã€‚å¦‚æœæ²¡æœ‰åˆ™å§”æ‰˜çˆ¶ç±»åŠ è½½å™¨å»åŠ è½½ï¼Œçˆ¶ç±»åŠ è½½å™¨é‡‡ç”¨åŒæ ·çš„ç­–ç•¥ï¼Œä¸€ç›´åˆ°bootstrap ClassLoaderã€‚å½“æ‰€æœ‰çš„çˆ¶ç±»åŠ è½½å™¨éƒ½æ²¡æœ‰åŠ è½½çš„æ—¶å€™ï¼Œå†ç”±å½“å‰çš„ç±»åŠ è½½å™¨åŠ è½½ï¼Œå¹¶å°†å…¶æ”¾å…¥å®ƒè‡ªå·±çš„ç¼“å­˜ä¸­ï¼Œä»¥ä¾¿ä¸‹æ¬¡æœ‰åŠ è½½è¯·æ±‚çš„æ—¶å€™ç›´æ¥è¿”å›ã€‚</li>\n<li>ä¿è¯Javaç¨‹åºçš„ç¨³å®šè¿è¡Œï¼Œé¿å…ç±»é‡å¤åŠ è½½ï¼ˆJVM åŒºåˆ†ä¸åŒç±»çš„æ–¹å¼ä¸ä»…ä»…æ ¹æ®ç±»åï¼Œç›¸åŒçš„ç±»æ–‡ä»¶è¢«ä¸åŒçš„ç±»åŠ è½½å™¨åŠ è½½äº§ç”Ÿçš„æ˜¯ä¸¤ä¸ªä¸åŒçš„ç±»ï¼‰ï¼Œ</li>\n<li>ä¿è¯Javaçš„æ ¸å¿ƒAPIä¸è¢«ç¯¡æ”¹ã€‚ å‡è®¾é€šè¿‡ç½‘ç»œä¼ é€’ä¸€ä¸ªåä¸ºjava.lang.Integerçš„ç±»ï¼Œé€šè¿‡åŒäº²å§”æ‰˜æ¨¡å¼ä¼ é€’åˆ°å¯åŠ¨ç±»åŠ è½½å™¨ï¼Œè€Œå¯åŠ¨ç±»åŠ è½½å™¨åœ¨æ ¸å¿ƒJava APIå‘ç°è¿™ä¸ªåå­—çš„ç±»ï¼Œå‘ç°è¯¥ç±»å·²è¢«åŠ è½½ï¼Œå¹¶ä¸ä¼šé‡æ–°åŠ è½½ç½‘ç»œä¼ é€’çš„è¿‡æ¥çš„java.lang.Integerï¼Œè€Œç›´æ¥è¿”å›å·²åŠ è½½è¿‡çš„Integer.class</li>\n<li>åŒäº²å§”æ´¾æ¨¡å‹çš„ä¸»è¦ä»£ç å®ç°ï¼šåœ¨ClassLoaderçš„loadClass()æ–¹æ³•ä¸­ï¼Œå…ˆæ£€æŸ¥æ˜¯å¦å·²ç»è¢«åŠ è½½è¿‡ï¼Œè‹¥æ²¡æœ‰åŠ è½½åˆ™è°ƒç”¨çˆ¶åŠ è½½å™¨çš„loadClass()æ–¹æ³•ï¼Œè‹¥çˆ¶åŠ è½½å™¨ä¸ºç©ºåˆ™é»˜è®¤ä½¿ç”¨å¯åŠ¨ç±»åŠ è½½å™¨ä½œä¸ºçˆ¶ç±»åŠ è½½å™¨ã€‚å¦‚æœçˆ¶ç±»åŠ è½½å¤±è´¥ï¼ŒæŠ›å‡ºClassNotFoundExceptionå¼‚å¸¸åï¼Œå†è°ƒç”¨è‡ªå·±çš„findClass()æ–¹æ³•è¿›è¡ŒåŠ è½½ã€‚</li>\n<li>è‡ªå®šä¹‰ç±»åŠ è½½å™¨ç»§æ‰¿ClassLoaderç±»å¹¶é‡å†™loadClass()ã€findClass()æ–¹æ³•ï¼›æœ€ä¸»è¦çš„æ˜¯é‡å†™loadClassæ–¹æ³•ï¼Œå› ä¸ºåŒäº²å§”æ´¾æœºåˆ¶çš„å®ç°éƒ½æ˜¯é€šè¿‡è¿™ä¸ªæ–¹æ³•å®ç°çš„ï¼Œæºç é‡Œä¼šç›´æ¥æ‰¾åˆ°æ ¹åŠ è½½å™¨ï¼Œé‡å†™äº†è¿™ä¸ªæ–¹æ³•ä»¥åå°±èƒ½è‡ªå·±å®šä¹‰åŠ è½½çš„æ–¹å¼äº†</li>\n</ul>\n<h1>52. ä½ è§‰å¾—åº”è¯¥æ€ä¹ˆå®ç°ä¸€ä¸ªçƒ­éƒ¨ç½²åŠŸèƒ½ï¼Ÿ</h1>\n<ul>\n<li>å®ç°ä¸€ä¸ªçƒ­éƒ¨ç½²ï¼ˆHot Deploymentï¼‰åŠŸèƒ½é€šå¸¸æ¶‰åŠåˆ°ç±»çš„åŠ è½½å’Œå¸è½½æœºåˆ¶ï¼Œä½¿å¾—åœ¨ä¸é‡å¯åº”ç”¨ç¨‹åºçš„æƒ…å†µä¸‹ï¼Œèƒ½å¤ŸåŠ¨æ€æ›¿æ¢æˆ–æ›´æ–°åº”ç”¨ç¨‹åºçš„ç»„ä»¶ã€‚<br>\n-ç¬¬ä¸€æ­¥ï¼Œä½¿ç”¨æ–‡ä»¶ç›‘æ§æœºåˆ¶ï¼ˆå¦‚ Java NIO çš„ WatchServiceï¼‰æ¥ç›‘æ§ç±»æ–‡ä»¶æˆ–é…ç½®æ–‡ä»¶çš„å˜æ›´ã€‚å½“ç›‘æ§åˆ°æ–‡ä»¶å˜æ›´æ—¶ï¼Œè§¦å‘çƒ­éƒ¨ç½²æµç¨‹ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>class FileWatcher {\n    public static void watchDirectoryPath(Path path) {\n        // æ£€æŸ¥è·¯å¾„æ˜¯å¦æ˜¯æ–‡ä»¶å¤¹\n        try {\n            Boolean isFolder = (Boolean) Files.getAttribute(path, \"basic:isDirectory\", LinkOption.NOFOLLOW_LINKS);\n            if (!isFolder) {\n                throw new IllegalArgumentException(\"Path: \" + path + \" is not a folder\");\n            }\n        } catch (IOException ioe) {\n            // æ–‡ä»¶ I/O é”™è¯¯\n            ioe.printStackTrace();\n        }\n\n        System.out.println(\"Watching path: \" + path);\n\n        // æˆ‘ä»¬è·å¾—æ–‡ä»¶ç³»ç»Ÿçš„WatchServiceå¯¹è±¡\n        FileSystem fs = path.getFileSystem();\n\n        try (WatchService service = fs.newWatchService()) {\n            // æ³¨å†Œè·¯å¾„åˆ°ç›‘å¬æœåŠ¡\n            // ç›‘å¬ç›®å½•å†…æ–‡ä»¶çš„åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤äº‹ä»¶\n            path.register(service, ENTRY_CREATE, ENTRY_MODIFY, ENTRY_DELETE);\n\n            // å¼€å§‹æ— é™å¾ªç¯ï¼Œç­‰å¾…äº‹ä»¶å‘ç”Ÿ\n            WatchKey key = null;\n            while (true) {\n                key = service.take(); // ä¼šé˜»å¡ç›´åˆ°æœ‰äº‹ä»¶å‘ç”Ÿ\n\n                // å¯¹äºæ¯ä¸ªå‘ç”Ÿçš„äº‹ä»¶\n                for (WatchEvent&lt;?&gt; watchEvent : key.pollEvents()) {\n                    WatchEvent.Kind&lt;?&gt; kind = watchEvent.kind();\n\n                    // è·å–æ–‡ä»¶è·¯å¾„\n                    @SuppressWarnings(\"unchecked\")\n                    WatchEvent&lt;Path&gt; ev = (WatchEvent&lt;Path&gt;) watchEvent;\n                    Path fileName = ev.context();\n\n                    System.out.println(kind.name() + \": \" + fileName);\n                }\n\n                // é‡ç½®watchKey\n                boolean valid = key.reset();\n                // é€€å‡ºå¾ªç¯å¦‚æœwatchKeyæ— æ•ˆ\n                if (!valid) {\n                    break;\n                }\n            }\n        } catch (Exception e) {\n            e.printStackTrace();\n        }\n    }\n\n    public static void main(String[] args) {\n        // ç›‘æ§å½“å‰ç›®å½•\n        Path pathToWatch = Paths.get(\".\");\n        watchDirectoryPath(pathToWatch);\n    }\n}\n</code></pre></div><ul>\n<li>ç¬¬äºŒæ­¥ï¼Œåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ç±»åŠ è½½å™¨ï¼Œç»§æ‰¿è‡ªjava.lang.ClassLoaderï¼Œé‡å†™findClass()æ–¹æ³•ï¼Œå®ç°ç±»çš„åŠ è½½ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class HotSwapClassLoader extends ClassLoader {\n    public HotSwapClassLoader() {\n        super(ClassLoader.getSystemClassLoader());\n    }\n\n    @Override\n    protected Class&lt;?&gt; findClass(String name) throws ClassNotFoundException {\n        // åŠ è½½æŒ‡å®šè·¯å¾„ä¸‹çš„ç±»æ–‡ä»¶å­—èŠ‚ç \n        byte[] classBytes = loadClassData(name);\n        if (classBytes == null) {\n            throw new ClassNotFoundException(name);\n        }\n        // è°ƒç”¨defineClasså°†å­—èŠ‚ç è½¬æ¢ä¸ºClasså¯¹è±¡\n        return defineClass(name, classBytes, 0, classBytes.length);\n    }\n\n    private byte[] loadClassData(String name) {\n        // å®ç°ä»æ–‡ä»¶ç³»ç»Ÿæˆ–å…¶ä»–æ¥æºåŠ è½½ç±»æ–‡ä»¶çš„å­—èŠ‚ç \n        // ...\n        return null;\n    }\n}\n</code></pre></div><h1>53. Tomcat çš„ç±»åŠ è½½æœºåˆ¶äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>Tomcat å®é™…ä¸Šä¹Ÿæ˜¯ç ´åäº†åŒäº²å§”æ´¾æ¨¡å‹çš„ã€‚Tomact æ˜¯ web å®¹å™¨ï¼Œå¯èƒ½éœ€è¦éƒ¨ç½²å¤šä¸ªåº”ç”¨ç¨‹åºã€‚ä¸åŒçš„åº”ç”¨ç¨‹åºå¯èƒ½ä¼šä¾èµ–åŒä¸€ä¸ªç¬¬ä¸‰æ–¹ç±»åº“çš„ä¸åŒç‰ˆæœ¬ï¼Œä½†æ˜¯ä¸åŒç‰ˆæœ¬çš„ç±»åº“ä¸­æŸä¸€ä¸ªç±»çš„å…¨è·¯å¾„åå¯èƒ½æ˜¯ä¸€æ ·çš„ã€‚å¦‚å¤šä¸ªåº”ç”¨éƒ½è¦ä¾èµ– hollis.jarï¼Œä½†æ˜¯ A åº”ç”¨éœ€è¦ä¾èµ– 1.0.0 ç‰ˆæœ¬ï¼Œä½†æ˜¯ B åº”ç”¨éœ€è¦ä¾èµ– 1.0.1 ç‰ˆæœ¬ã€‚è¿™ä¸¤ä¸ªç‰ˆæœ¬ä¸­éƒ½æœ‰ä¸€ä¸ªç±»æ˜¯ com.hollis.Test.classã€‚å¦‚æœé‡‡ç”¨é»˜è®¤çš„åŒäº²å§”æ´¾ç±»åŠ è½½æœºåˆ¶ï¼Œé‚£ä¹ˆæ— æ³•åŠ è½½å¤šä¸ªç›¸åŒçš„ç±»ã€‚</li>\n<li>æ‰€ä»¥ï¼ŒTomcat ç ´åäº†åŒäº²å§”æ´¾åŸåˆ™ï¼Œæä¾›éš”ç¦»çš„æœºåˆ¶ï¼Œä¸ºæ¯ä¸ª web å®¹å™¨å•ç‹¬æä¾›ä¸€ä¸ª WebAppClassLoader åŠ è½½å™¨ã€‚æ¯ä¸€ä¸ª WebAppClassLoader è´Ÿè´£åŠ è½½æœ¬èº«çš„ç›®å½•ä¸‹çš„ class æ–‡ä»¶ï¼ŒåŠ è½½ä¸åˆ°æ—¶å†äº¤ CommonClassLoader åŠ è½½ï¼Œè¿™å’ŒåŒäº²å§”æ´¾åˆšå¥½ç›¸åã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/751b7a8d517c94a20de68.png\" alt=\"tomcatclassloader.png\"></li>\n</ul>\n<p>==================================================================================================</p>\n<h1>54. ç±»åŠ è½½å‘ç”Ÿçš„æ—¶æœºï¼Ÿ</h1>\n<ul>\n<li>é‡åˆ°newã€getstaticã€putstaticã€invokestatic è¿™å››æ¡å­—èŠ‚ç æŒ‡ä»¤æ—¶ï¼Œå¦‚æœç±»è¿˜æ²¡è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚</li>\n<li>ä½¿ç”¨ java.lang.reflect åŒ…çš„æ–¹æ³•å¯¹ç±»è¿›è¡Œåå°„è°ƒç”¨çš„æ—¶å€™ï¼Œå¦‚æœç±»è¿˜æ²¡è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–ã€‚</li>\n<li>å½“åˆå§‹åŒ–äº†ä¸€ä¸ªç±»çš„æ—¶å€™ï¼Œå¦‚æœå‘ç°å…¶çˆ¶ç±»è¿˜æ²¡è¿›è¡Œåˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶çˆ¶ç±»çš„åˆå§‹åŒ–ã€‚</li>\n<li>å½“è™šæ‹Ÿæœºå¯åŠ¨æ—¶çš„ä¸»ç±»ï¼Œå³è°ƒç”¨å…¶ #main(String[] args) æ–¹æ³•ï¼Œè™šæ‹Ÿæœºåˆ™ä¼šå…ˆåˆå§‹åŒ–è¯¥ä¸»ç±»ã€‚</li>\n<li>å½“ä½¿ç”¨JDK7çš„åŠ¨æ€è¯­è¨€æ”¯æŒæ—¶ï¼Œå¦‚æœä¸€ä¸ªjava.lang.invoke.MethodHandleå®ä¾‹æœ€åçš„è§£æç»“æœä¸ºREF_getStaticã€REF_putStaticã€REF_invokeStaticæ–¹æ³•å¥æŸ„ï¼Œå¹¶ä¸”è¿™ä¸ªæ–¹æ³•å¥æŸ„æ‰€å¯¹åº”çš„ç±»æ²¡æœ‰è¿›è¡Œè¿‡åˆå§‹åŒ–ï¼Œåˆ™éœ€è¦å…ˆè§¦å‘å…¶åˆå§‹åŒ–</li>\n</ul>\n<h1>55. ä¸ºä»€ä¹ˆè¦æœ‰ä¸åŒçš„å¼•ç”¨ç±»å‹ï¼Ÿ</h1>\n<ul>\n<li>ä¸ºäº†æ§åˆ¶å¯¹è±¡è¢«å›æ”¶çš„æ—¶æœºï¼Œ</li>\n<li>åˆ©ç”¨è½¯å¼•ç”¨å’Œå¼±å¼•ç”¨è§£å†³OOMé—®é¢˜ã€‚é€šè¿‡è½¯å¼•ç”¨å’ŒhashMapå®ç°Javaå¯¹è±¡çš„é«˜é€Ÿç¼“å­˜ã€‚å¦‚ç”¨HashMapä¿å­˜å›¾ç‰‡çš„è·¯å¾„å’Œç›¸åº”å›¾ç‰‡å¯¹è±¡å…³è”çš„è½¯å¼•ç”¨ä¹‹é—´çš„æ˜ å°„å…³ç³»ï¼Œåœ¨å†…å­˜ä¸è¶³æ—¶ï¼ŒJVMä¼šè‡ªåŠ¨å›æ”¶ç¼“å­˜å›¾ç‰‡å¯¹è±¡æ‰€å ç”¨çš„ç©ºé—´ï¼Œæœ‰æ•ˆé¿å…OOMé—®é¢˜</li>\n</ul>\n<h1>56. OOMæœ‰å“ªäº›å¼‚å¸¸ç±»å‹ï¼Ÿâˆš</h1>\n<ul>\n<li>\n<p>Java heap spaceå †ç©ºé—´æº¢å‡ºï¼Œæœ€å¸¸è§çš„ï¼ˆå¯¹è±¡åˆ›å»ºå¤ªå¤šï¼‰</p>\n</li>\n<li>\n<p>java.lang.StackOverflowErroræ ˆç©ºé—´æº¢å‡ºï¼Œæ ˆç®¡è¿è¡Œï¼Œæ¯ä¸ªæ–¹æ³•å°±æ˜¯ä¸€ä¸ªæ ˆå¸§ï¼Œå¾ªç¯è°ƒç”¨æ–¹æ³•ï¼Œä¼šå‡ºç°è¿™ç§é—®é¢˜</p>\n</li>\n<li>\n<p>Direct buffer memory ç”±äºByteBuffer. allocteDirect(capability)åˆ†é…æ“ä½œç³»ç»Ÿæœ¬åœ°å†…å­˜ï¼Œä¸å±äºGC ç®¡è¾–èŒƒå›´ã€‚ä¸éœ€è¦å†…å­˜æ‹·è´æ‰€ä»¥é€Ÿåº¦ç›¸å¯¹è¾ƒå¿«ã€‚åˆ†é…å¤ªå¤šå†…å­˜ä¸å¤Ÿ</p>\n</li>\n<li>\n<p>GC overhead limit exceeded GCè¿ç»­å¤šæ¬¡GCéƒ½åªå›æ”¶äº†ä¸åˆ°2%çš„æç«¯æƒ…å†µä¸‹ä¼šæŠ›å‡ºã€‚</p>\n</li>\n<li>\n<p>unable to create new native threadï¼›å¤šçº¿ç¨‹linuxç³»ç»Ÿé»˜è®¤å…è®¸å•ä¸ªè¿›ç¨‹å¯ä»¥åˆ›å»ºçš„çº¿ç¨‹æ•°æ˜¯1024ä¸ª,åº”ç”¨åˆ›å»ºè¶…è¿‡è¿™ä¸ªæ•°é‡ï¼Œå°±ä¼šæŠ¥</p>\n</li>\n<li>\n<p>æ§åˆ¶å°æŸ¥çœ‹é”™è¯¯æ—¥å¿—ã€‚</p>\n</li>\n<li>\n<p>ä½¿ç”¨JDKè‡ªå¸¦çš„jvisualvmå·¥å…·æŸ¥çœ‹ç³»ç»Ÿçš„å †æ ˆæ—¥å¿—ã€‚<br>\nå®šä½å‡ºå†…å­˜æº¢å‡ºçš„ç©ºé—´ï¼šå †ï¼Œæ ˆè¿˜æ˜¯æ°¸ä¹…ä»£ï¼ˆJDK8 ä»¥åä¸ä¼šå‡ºç°æ°¸ä¹…ä»£çš„å†…å­˜æº¢å‡ºï¼‰ã€‚</p>\n<ul>\n<li>å¦‚æœæ˜¯å †å†…å­˜æº¢å‡ºï¼Œçœ‹æ˜¯å¦åˆ›å»ºäº†è¶…å¤§çš„å¯¹è±¡ã€‚</li>\n<li>å¦‚æœæ˜¯æ ˆå†…å­˜æº¢å‡ºï¼Œçœ‹æ˜¯å¦åˆ›å»ºäº†è¶…å¤§çš„å¯¹è±¡ï¼Œæˆ–è€…äº§ç”Ÿäº†æ­»å¾ªç¯ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>57. ä»£ç ä¼˜åŒ–</h1>\n<ul>\n<li>å°½å¯èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡</li>\n<li>å°½é‡å‡å°‘å¯¹å˜é‡çš„é‡å¤è®¡ç®— å¦‚éå†æ—¶iå°äºlist.size()å¯ä»¥æ”¹ä¸ºiå°äºlength</li>\n<li>å¼‚å¸¸ä¸åº”è¯¥ç”¨æ¥æ§åˆ¶ç¨‹åºæµç¨‹.å¼‚å¸¸å¯¹æ€§èƒ½ä¸åˆ©ã€‚æŠ›å‡ºå¼‚å¸¸é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒThrowableæ¥å£çš„æ„é€ å‡½æ•°è°ƒç”¨åä¸ºfillInStackTrace()çš„æœ¬åœ°åŒæ­¥æ–¹æ³•ï¼ŒfillInStackTrace()æ–¹æ³•æ£€æŸ¥å †æ ˆï¼Œæ”¶é›†è°ƒç”¨è·Ÿè¸ªä¿¡æ¯ã€‚åªè¦æœ‰å¼‚å¸¸è¢«æŠ›å‡ºï¼ŒJavaè™šæ‹Ÿæœºå°±å¿…é¡»è°ƒæ•´è°ƒç”¨å †æ ˆï¼Œå› ä¸ºåœ¨å¤„ç†è¿‡ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å¼‚å¸¸åªèƒ½ç”¨äºé”™è¯¯å¤„ç†ï¼Œä¸åº”è¯¥ç”¨æ¥æ§åˆ¶ç¨‹åºæµç¨‹ã€‚</li>\n<li>å°½é‡é‡‡ç”¨æ‡’åŠ è½½çš„ç­–ç•¥ï¼Œå³åœ¨éœ€è¦çš„æ—¶å€™æ‰åˆ›å»º</li>\n<li>ä¸è¦å°†æ•°ç»„å£°æ˜ä¸ºpublic static final å› ä¸ºè¿™æ¯«æ— æ„ä¹‰ï¼Œæ•°ç»„çš„å†…å®¹è¿˜æ˜¯å¯ä»¥éšæ„æ”¹å˜çš„ï¼Œ</li>\n<li>ä¸è¦åˆ›å»ºä¸€äº›ä¸ä½¿ç”¨çš„å¯¹è±¡ï¼Œä¸è¦å¯¼å…¥ä¸€äº›ä¸ä½¿ç”¨çš„ç±»</li>\n<li>ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­é¿å…ä½¿ç”¨åå°„</li>\n<li>ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± å’Œçº¿ç¨‹æ± .é‡ç”¨å¯¹è±¡ï¼Œå‰è€…å¯ä»¥é¿å…é¢‘ç¹åœ°æ‰“å¼€å’Œå…³é—­è¿æ¥ï¼Œåè€…å¯ä»¥é¿å…é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€‚</li>\n<li>å®¹å™¨åˆå§‹åŒ–æ—¶å°½å¯èƒ½æŒ‡å®šé•¿åº¦ã€‚é¿å…å®¹å™¨é•¿åº¦ä¸è¶³æ—¶ï¼Œæ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</li>\n<li>ArrayListéšæœºéå†å¿«ï¼ŒLinkedListæ·»åŠ åˆ é™¤å¿«</li>\n<li>ä½¿ç”¨Entryéå†Map</li>\n<li>ä¸è¦æ‰‹åŠ¨è°ƒç”¨System.gc();</li>\n<li>Stringå°½é‡å°‘ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚å…¶æ•ˆç‡è¾ƒä½ï¼Œreplace() ä¸æ”¯æŒæ­£åˆ™ã€‚replaceAll() æ”¯æŒæ­£åˆ™ã€‚å¦‚æœä»…ä»…æ˜¯å­—ç¬¦çš„æ›¿æ¢å»ºè®®ä½¿ç”¨replace()ã€‚</li>\n<li>æ—¥å¿—çš„è¾“å‡ºè¦æ³¨æ„çº§åˆ«</li>\n<li>å¯¹èµ„æºçš„close()å»ºè®®åˆ†å¼€æ“ä½œ</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/70d43d52d3b9c5460213d.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "linux",
      "url": "https://javaguide.cn/interview/linux.html",
      "id": "https://javaguide.cn/interview/linux.html",
      "summary": "1. linuxæ¦‚è¿° åŸºäºUnixçš„å¼€æºå…è´¹çš„æ“ä½œç³»ç»Ÿï¼Œç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§æˆä¸ºç¨‹åºä»£ç è¿è¡Œçš„æœ€ä½³ç³»ç»Ÿç¯å¢ƒ Linuxæ˜¯ç”±Linus Torvaldsï¼ˆæ—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼‰èµ·åˆå¼€å‘çš„ Linuxç³»ç»Ÿçš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒAndroidç¨‹åºæœ€åº•å±‚å°±æ˜¯è¿è¡Œåœ¨linuxç³»ç»Ÿä¸Šçš„ linux.pnglinux.png 2. linuxç›®å½•ç»“æ„ linuxcatalogu...",
      "content_html": "<!-- TOC -->\n<!-- /TOC -->\n<h1>1. linuxæ¦‚è¿°</h1>\n<ul>\n<li>åŸºäºUnixçš„å¼€æºå…è´¹çš„æ“ä½œç³»ç»Ÿï¼Œç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå®‰å…¨æ€§æˆä¸ºç¨‹åºä»£ç è¿è¡Œçš„æœ€ä½³ç³»ç»Ÿç¯å¢ƒ</li>\n<li>Linuxæ˜¯ç”±Linus Torvaldsï¼ˆæ—çº³æ–¯Â·æ‰˜ç“¦å…¹ï¼‰èµ·åˆå¼€å‘çš„</li>\n<li>Linuxç³»ç»Ÿçš„åº”ç”¨éå¸¸å¹¿æ³›ï¼ŒAndroidç¨‹åºæœ€åº•å±‚å°±æ˜¯è¿è¡Œåœ¨linuxç³»ç»Ÿä¸Šçš„</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4e7826159216b69203d4a.png\" alt=\"linux.png\" tabindex=\"0\"><figcaption>linux.png</figcaption></figure>\n<h1>2. linuxç›®å½•ç»“æ„</h1>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/282413c2d3f968819010f.png\" alt=\"linuxcatalogue.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4993b2fb295f0f768bd84.png\" alt=\"linuxcataloguedesc.png\"></p>\n<h1>3. linuxæ–‡ä»¶ç±»å‹</h1>\n<ul>\n<li>æ™®é€šæ–‡ä»¶(-)</li>\n<li>å¥—æ¥å­—(s)</li>\n<li>ç›®å½•æ–‡ä»¶(d)</li>\n<li>ç¬¦å·é“¾æ¥(l)ï¼ˆå¯ä»¥è®¤ä¸ºæ˜¯windowä¸­çš„å¿«æ·æ–¹å¼ï¼‰</li>\n<li>è®¾å¤‡æ–‡ä»¶(bã€c)</li>\n<li>FIFO(p)</li>\n</ul>\n<h1>4. ç›®å½•æ“ä½œ</h1>\n<ul>\n<li>æŸ¥çœ‹ç›®å½•\n<ul>\n<li>ls çœ‹åˆ°è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰çš„ç›®å½•å’Œæ–‡ä»¶\t-a çœ‹åˆ°è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰æ–‡ä»¶å’Œç›®å½•ï¼ŒåŒ…æ‹¬éšè—çš„ï¼ˆä¸€èˆ¬ä¸º.å¼€å¤´ï¼‰ -lï¼ˆç¼©å†™ä¸ºllï¼‰çœ‹åˆ°è¯¥ç›®å½•ä¸‹çš„æ‰€æœ‰ç›®å½•å’Œæ–‡ä»¶çš„è¯¦ç»†ä¿¡æ¯</li>\n<li>pwdï¼šæŸ¥çœ‹å½“å‰å·¥ä½œç›®å½•çš„å®Œæ•´è·¯å¾„</li>\n</ul>\n</li>\n<li>æŸ¥æ‰¾ç›®å½•/æ–‡ä»¶ï¼š\n<ul>\n<li>find ç›®å½• å‚æ•° æŸ¥æ‰¾è¯¥ç›®å½•åŠå­ç›®å½•ä¸‹æ‰€æœ‰åå­—ç›¸åŒçš„æ–‡ä»¶ï¼ˆå¯ä»¥ç”¨*ï¼‰æŸ¥æ‰¾/rootä¸‹çš„ä¸testç›¸å…³çš„ç›®å½•(æ–‡ä»¶)  find /root -name 'test*'</li>\n</ul>\n</li>\n<li>ç›®å½•åˆ‡æ¢å‘½ä»¤\n<ul>\n<li>cd usråˆ‡æ¢åˆ°è¯¥ç›®å½•ä¸‹usrç›®å½•</li>\n<li>cd ../åˆ‡æ¢åˆ°ä¸Šä¸€å±‚ç›®å½•</li>\n<li>cd /åˆ‡æ¢åˆ°ç³»ç»Ÿæ ¹ç›®å½•</li>\n<li>cd ~åˆ‡æ¢åˆ°ç”¨æˆ·ä¸»ç›®å½•</li>\n<li>cd -åˆ‡æ¢åˆ°ä¸Šä¸€ä¸ªæ‰€åœ¨ç›®å½•(ç›¸å½“äºæ’¤é”€)</li>\n<li>cd ç»å¯¹è·¯å¾„</li>\n</ul>\n</li>\n<li>å¢åŠ ç›®å½•æ“ä½œ\n<ul>\n<li>mkdir ç›®å½•åç§° -p çˆ¶ç›®å½•ä¸å­˜åœ¨çš„æƒ…å†µä¸‹ç”Ÿæˆçˆ¶ç›®å½•(parents) -v æ˜¾ç¤ºå‘½ä»¤æ‰§è¡Œè¿‡ç¨‹ä¸­çš„è¯¦ç»†ä¿¡æ¯</li>\n<li>mkdir -pv ./abc/123ï¼Œåœ¨ç›®å½•çš„ç›®å½•ä¸‹é¢å»ºæ–‡ä»¶</li>\n<li>mkdir ç›®å½•/ç›®å½•åç§°</li>\n</ul>\n</li>\n<li>ä¿®æ”¹ç›®å½•\\æ–‡ä»¶\\å‹ç¼©åŒ…çš„åç§°\n<ul>\n<li>mv ç›®å½•åç§° æ–°ç›®å½•åç§° ï¼ˆç›®å½•ã€æ–‡ä»¶ã€å‹ç¼©åŒ…ï¼‰</li>\n</ul>\n</li>\n<li>ç§»åŠ¨ç›®å½•\\æ–‡ä»¶\\å‹ç¼©åŒ…çš„ä½ç½®</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/4e7826159216b69203d4a.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "æ•°å­¦",
      "url": "https://javaguide.cn/interview/math.html",
      "id": "https://javaguide.cn/interview/math.html",
      "summary": "æ’åˆ— ä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡º(m<=n)ä¸ªå…ƒç´ æ‰€æœ‰æ’åˆ—çš„ä¸ªæ•°ï¼ŒæŒ‰ç…§ä¸€å®šé¡ºåºæ’åˆ—æˆä¸€åˆ—ï¼Œå«åšä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡ºm(m<=n)ä¸ªå…ƒç´ çš„æ’åˆ—æ•°ï¼ˆnumber of arrangementï¼‰ï¼Œç”¨ç¬¦å·è¡¨ç¤ºã€‚ æ ¹æ®åˆ†å¸ƒä¹˜æ³•è®¡æ•°åŸç†å¯å¾—æ’åˆ—æ•°å…¬å¼ è¯æ˜ï¼šæ±‚æ’åˆ—æ•°å¯ä»¥æŒ‰ä¾æ¬¡å¡«mä¸ªç©ºä½æ¥è€ƒè™‘ï¼šå‡å®šæœ‰æ’å¥½é¡ºåºçš„mä¸ªç©ºä½,ä»nä¸ªä¸åŒå…ƒç´ a1,a2,a3,â€¦,anä¸­ä»»æ„å–mä¸ª...",
      "content_html": "<!-- TOC -->\n<h1>æ’åˆ—</h1>\n<ul>\n<li>ä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡º(m&lt;=n)ä¸ªå…ƒç´ æ‰€æœ‰æ’åˆ—çš„ä¸ªæ•°ï¼ŒæŒ‰ç…§ä¸€å®šé¡ºåºæ’åˆ—æˆä¸€åˆ—ï¼Œå«åšä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡ºm(m&lt;=n)ä¸ªå…ƒç´ çš„æ’åˆ—æ•°ï¼ˆnumber of arrangementï¼‰ï¼Œç”¨ç¬¦å·è¡¨ç¤ºã€‚</li>\n<li>æ ¹æ®åˆ†å¸ƒä¹˜æ³•è®¡æ•°åŸç†å¯å¾—æ’åˆ—æ•°å…¬å¼</li>\n</ul>\n<ul>\n<li>è¯æ˜ï¼šæ±‚æ’åˆ—æ•°å¯ä»¥æŒ‰ä¾æ¬¡å¡«mä¸ªç©ºä½æ¥è€ƒè™‘ï¼šå‡å®šæœ‰æ’å¥½é¡ºåºçš„mä¸ªç©ºä½,ä»nä¸ªä¸åŒå…ƒç´ a1,a2,a3,â€¦,anä¸­ä»»æ„å–mä¸ªå»å¡«ç©º,ä¸€ä¸ªç©ºä½å¡«1ä¸ªå…ƒç´ ï¼Œæ¯ä¸€ç§å¡«æ³•å°±å¯¹åº”1ä¸ªæ’åˆ—ï¼Œå› æ­¤ï¼Œæ‰€æœ‰ä¸åŒå¡«æ³•çš„ç§æ•°å°±æ˜¯æ’åˆ—æ•°ã€‚å¡«ç©ºå¯åˆ†ä¸ºmä¸ªæ­¥éª¤ï¼š\n<ul>\n<li>ç¬¬1æ­¥ï¼Œç¬¬1ä½å¯ä»¥ä»nä¸ªå…ƒç´ ä¸­ä»»é€‰ä¸€ä¸ªå¡«ä¸Šï¼Œå…±æœ‰nç§å¡«æ³•ï¼›</li>\n<li>ç¬¬2æ­¥ï¼Œç¬¬2ä½åªèƒ½ä»ä½™ä¸‹çš„n-1ä¸ªå…ƒç´ ä¸­ä»»é€‰ä¸€ä¸ªå¡«ä¸Šï¼Œå…±æœ‰n-1ç§å¡«æ³•ï¼›</li>\n<li>ç¬¬3æ­¥ï¼Œç¬¬3ä½åªèƒ½ä»ä½™ä¸‹çš„n-2ä¸ªå…ƒç´ ä¸­ä»»é€‰ä¸€ä¸ªå¡«ä¸Šï¼Œå…±æœ‰n-2ç§å¡«æ³•ï¼›</li>\n<li>â€¦â€¦</li>\n<li>ç¬¬mæ­¥ï¼Œå½“å‰é¢çš„m-1ä¸ªç©ºä½éƒ½å¡«ä¸Šåï¼Œç¬¬mä½åªèƒ½ä»ä½™ä¸‹çš„n-(m-1)ä¸ªå…ƒç´ ä¸­ä»»é€‰ä¸€ä¸ªå¡«ä¸Šï¼Œå…±æœ‰n-m+1ç§å¡«æ³•ã€‚</li>\n<li>æ ¹æ®åˆ†æ­¥è®¡æ•°åŸç†ï¼Œå…¨éƒ¨å¡«æ»¡mä¸ªç©ºä½å…±æœ‰n(n-1)(n-2)â€¦(n-m+1)ç§å¡«æ³•</li>\n</ul>\n</li>\n</ul>\n<h1>ç»„åˆ</h1>\n<ul>\n<li>ç»„åˆå…¬å¼çš„æ¨å¯¼æ˜¯ç”±æ’åˆ—å…¬å¼å»æ‰é‡å¤çš„éƒ¨åˆ†è€Œæ¥çš„,ç»„åˆæ— åºï¼Œæ’åˆ—æœ‰åº</li>\n<li>ä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡º(m&lt;=n)ä¸ªå…ƒç´ æ‰€æœ‰ç»„åˆçš„ä¸ªæ•°ï¼Œå«åšä»nä¸ªä¸åŒå…ƒç´ ä¸­å–å‡ºm(m&lt;=n)ä¸ªå…ƒç´ çš„ç»„åˆæ•°ï¼ˆnumber of combinationï¼‰ï¼Œç”¨ç¬¦å·è¡¨ç¤ºã€‚æˆ–è€…æ¬§ç¾è®°ä¸º</li>\n</ul>\n<ul>\n<li>æ¨å¯¼ï¼šåˆ©ç”¨æ’åˆ—ç»„åˆå…³ç³»æ¨å¯¼,å°†æ’åˆ—é—®é¢˜åˆ†ä¸º2æ­¥ï¼šç¬¬1æ­¥ï¼Œä»nä¸ªå…ƒç´ ä¸­æŠ½å–mä¸ªï¼Œæ— åºï¼Œå°±æ˜¯ç»„åˆé—®é¢˜;ç¬¬2æ­¥ï¼Œå¯¹mæ’åºï¼Œæ ¹æ®ä¹˜æ³•åŸç†å¾—åˆ°</li>\n</ul>\n<ul>\n<li>mç”¨n-(n-m)ä»£æ›¿å¾—åˆ°æ€§è´¨1-äº’è¡¥</li>\n</ul>\n<ul>\n<li>å½“æ€»å…ƒç´ ä¸ªæ•°ä»nå˜ä¸ºn+1æ—¶ï¼Œå¯åˆ†ä¸ºä¸åŒ…å«æ–°å…ƒç´ çš„ç»„åˆå’ŒåŒ…å«æ–°å…ƒç´ çš„ç»„åˆï¼Œç”±åˆ†ç±»åŠ æ³•è®¡æ•°åŸç†ï¼Œå¯å¾—ç»„åˆçš„æ€§è´¨2-ç»„åˆæ’ç­‰å¼</li>\n</ul>\n<ul>\n<li>è¯æ˜</li>\n</ul>\n<h1>äºŒé¡¹å¼å®šç†</h1>\n<ul>\n<li>äºŒé¡¹å¼å±•å¼€å…¬å¼ä¸º</li>\n</ul>\n<ul>\n<li>å…¶ä¸­ç»„åˆå®šä¹‰ä¸º</li>\n</ul>\n<ul>\n<li>è¯æ˜ï¼šè‹¥å±•å¼€å¤šé¡¹å¼çš„æ—¶å€™å…ˆä¸åˆå¹¶åŒç±»é¡¹ï¼ˆæ¯é¡¹å‰é¢çš„ç³»æ•°éƒ½æ˜¯ 1ï¼‰åˆ™è‹¥ä¸åˆå¹¶ç›¸åŒé¡¹<br>\n æœ‰1é¡¹<br>\n æœ‰2é¡¹<br>\n æœ‰4é¡¹<br>\næœ‰8é¡¹<br>\n$(a+b)^n $æœ‰é¡¹</li>\n<li>ç›¸å½“äºç”¨aå’Œbå¡«æ»¡nä¸ªæœ‰åºçš„ä½ç½®ï¼Œæ¯ä¸ªä½ç½®éƒ½å¯ä»¥å–aæˆ–bï¼Œå…±æœ‰ç§æ’åˆ—ï¼Œæ¯ç§æ’åˆ—å°±æ˜¯ä¸€é¡¹ï¼Œæ‰€ä»¥å…±æœ‰é¡¹ï¼ˆä¸åˆå¹¶ç›¸åŒé¡¹ï¼‰ã€‚æŠŠé¡¹ä¸­ç›¸åŒé¡¹è¿›è¡Œåˆå¹¶ï¼ŒæŠŠå…¶ä¸­å‡ºç°äº†iä¸ªaåŠn-iä¸ªbçš„é¡¹éƒ½è®°ä¸ºï¼Œé‚£ä¹ˆå…±æœ‰ä¸ªè¿™æ ·çš„é¡¹ã€‚æŠŠå®ƒä»¬ç›¸åŠ å¾— ã€‚æ‰€ä»¥</li>\n</ul>\n<h1>ä¼¯åŠªåˆ©å®éªŒ</h1>\n<ul>\n<li>è‹¥éšæœºè¯•éªŒEåªæœ‰2ä¸ªå¯èƒ½çš„ç»“æœï¼šAä¸ åˆ™ç§°Eä¸ºä¼¯åŠªåˆ©è¯•éªŒï¼ˆBernoulli trialï¼‰ã€‚è‹¥å°†Eç‹¬ç«‹é‡å¤è¿›è¡Œnæ¬¡ï¼Œåˆ™ç§°né‡ä¼¯åŠªåˆ©è¯•éªŒã€‚</li>\n<li>ä¼¯åŠªåˆ©è¯•éªŒä¸­çš„2ä¸ªç»“æœAä¸ ä¹Ÿè¢«ç§°ä¸º â€œæˆåŠŸâ€ ä¸ â€œå¤±è´¥â€ã€‚æ‰€ä»¥å½“ç”¨æ•°å­—1å’Œ0æ¥è¡¨ç¤ºçš„æ—¶å€™ï¼Œè¿™ä¸ªæ•°å­—è¢«ç§°ä¸ºç¬¬nä¸ªè¯•éªŒçš„æˆåŠŸæ¬¡æ•°ã€‚å³å¯¹né‡ä¼¯åŠªåˆ©è¯•éªŒï¼Œå…¶æˆåŠŸæ¬¡æ•°Xç­‰äºæ¯ä¸ªè¯•éªŒçš„æˆåŠŸæ¬¡æ•°ä¹‹å’Œ,å…¶ä¸­ï¼Œä¸ºç¬¬<br>\næ¬¡è¯•éªŒçš„æˆåŠŸæ¬¡æ•°ã€‚</li>\n</ul>\n<h1>äºŒé¡¹åˆ†å¸ƒ</h1>\n<ul>\n<li>å¦‚æœè®°Xä¸ºné‡ä¼¯åŠªåˆ©è¯•éªŒä¸­æˆåŠŸï¼ˆè®°ä¸ºäº‹ä»¶Aï¼‰çš„æ¬¡æ•°ï¼Œåˆ™Xçš„å¯èƒ½å–å€¼ä¸º0,1..,nã€‚è®°pä¸ºæ¯æ¬¡è¯•éªŒä¸­Aå‘ç”Ÿçš„æ¦‚ç‡ï¼Œå³P(A)=pï¼Œåˆ™P() =1-p,né‡ä¼¯åŠªåˆ©è¯•éªŒçš„åŸºæœ¬ç»“æœå¯ä»¥è®°ä½œ å…¶ä¸­ä¸ºAæˆ–è€…ä¸º,è¿™æ ·çš„ å…±æœ‰ä¸ªï¼Œç»„æˆäº†æ ·æœ¬ç©ºé—´</li>\n<li>ä¸‹é¢æ±‚äº‹ä»¶Xçš„åˆ†å¸ƒåˆ—ï¼Œå³{X=k}çš„æ¦‚ç‡ã€‚è‹¥æŸä¸ªæ ·æœ¬ç‚¹æ„å‘³ç€ä¸­æœ‰kä¸ªA,n-kä¸ª,ç”±äº‹ä»¶çš„ç‹¬ç«‹æ€§çŸ¥ï¼š</li>\n</ul>\n<ul>\n<li>è€Œäº‹ä»¶{X=k}ä¸­è¿™æ ·çš„å…±æœ‰ä¸ªï¼Œæ‰€ä»¥Xçš„åˆ†å¸ƒåˆ—ä¸ºï¼š</li>\n</ul>\n<ul>\n<li>è¿™ä¸ªåˆ†å¸ƒç§°ä¸ºäºŒé¡¹åˆ†å¸ƒï¼ˆbinomial distributionï¼‰ï¼Œè®°ä¸º X~b(n,p)</li>\n<li>æ ¹æ®äºŒé¡¹å¼å®šç†æœ‰</li>\n</ul>\n<ul>\n<li>å¹¶ä¸”ä»ä¸Šå¼å¯ä»¥çœ‹å‡ºï¼ŒäºŒé¡¹æ¦‚ç‡æ°å¥½æ˜¯äºŒé¡¹å¼çš„å±•å¼€å¼ä¸­çš„ç¬¬k+1é¡¹ï¼Œè¿™æ­£æ˜¯å…¶åç§°çš„ç”±æ¥ã€‚äºŒé¡¹æ¦‚ç‡æ˜¯ä¸€ç§ç¦»æ•£åˆ†å¸ƒ</li>\n</ul>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "æ¶ˆæ¯é˜Ÿåˆ—",
      "url": "https://javaguide.cn/interview/messagequeue.html",
      "id": "https://javaguide.cn/interview/messagequeue.html",
      "summary": "1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ mqï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„. 2. ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿæ¶ˆæ¯é˜Ÿåˆ—ä¼˜ç¼ºç‚¹ï¼Ÿ è§£è€¦ï¼šå‡è®¾Aç³»ç»Ÿè¦å‘é€æ•°æ®åˆ°B,C,Dç³»ç»Ÿï¼Œå¦‚æœEç³»ç»Ÿéœ€è¦æ•°æ®ç„¶åï¼ŒDç³»ç»Ÿä¸éœ€è¦äº†ï¼Œæ­¤æ—¶Aç³»ç»Ÿéœ€è¦ç»´æŠ¤ä¸‹æ¸¸ç³»ç»Ÿçš„è°ƒç”¨ï¼Œè€¦åˆæ€§å¤ªé«˜ï¼Œå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—åå¯ä»¥å‡å°‘Aç³»ç»Ÿç»´æŠ¤æˆæœ¬ å¼‚æ­¥ï¼šåŒæ­¥å¾ˆèŠ±è´¹å¹¶ä¸”ä¸šåŠ¡æ—¶æ•ˆæ€§ä¸å¤§çš„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å¼‚æ­¥æ¥æå‡æ•ˆæœï¼Œæ¯”å¦‚å‘é€å¾®...",
      "content_html": "<!-- TOC -->\n<!-- /TOC -->\n<h1>1. ä»€ä¹ˆæ˜¯æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿ</h1>\n<ul>\n<li>mqï¼šæ¶ˆæ¯é˜Ÿåˆ—æ˜¯ä¸€ç§å…ˆè¿›å…ˆå‡ºçš„æ•°æ®ç»“æ„.</li>\n</ul>\n<h1>2. ä¸ºä»€ä¹ˆä½¿ç”¨æ¶ˆæ¯é˜Ÿåˆ—ï¼Ÿæ¶ˆæ¯é˜Ÿåˆ—ä¼˜ç¼ºç‚¹ï¼Ÿ</h1>\n<ul>\n<li>è§£è€¦ï¼šå‡è®¾Aç³»ç»Ÿè¦å‘é€æ•°æ®åˆ°B,C,Dç³»ç»Ÿï¼Œå¦‚æœEç³»ç»Ÿéœ€è¦æ•°æ®ç„¶åï¼ŒDç³»ç»Ÿä¸éœ€è¦äº†ï¼Œæ­¤æ—¶Aç³»ç»Ÿéœ€è¦ç»´æŠ¤ä¸‹æ¸¸ç³»ç»Ÿçš„è°ƒç”¨ï¼Œè€¦åˆæ€§å¤ªé«˜ï¼Œå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—åå¯ä»¥å‡å°‘Aç³»ç»Ÿç»´æŠ¤æˆæœ¬</li>\n<li>å¼‚æ­¥ï¼šåŒæ­¥å¾ˆèŠ±è´¹å¹¶ä¸”ä¸šåŠ¡æ—¶æ•ˆæ€§ä¸å¤§çš„æ“ä½œï¼Œå¯ä»¥ä½¿ç”¨å¼‚æ­¥æ¥æå‡æ•ˆæœï¼Œæ¯”å¦‚å‘é€å¾®ä¿¡é€šçŸ¥</li>\n<li>å‰Šå³°ã€é™æµï¼šè§£å†³é«˜å¹¶å‘æƒ…å†µ</li>\n<li>ç³»ç»Ÿå¯ç”¨æ€§é™ä½</li>\n<li>ç³»ç»Ÿå¤æ‚åº¦æé«˜</li>\n<li>ä¸€è‡´æ€§é—®é¢˜</li>\n</ul>\n<h1>3. æ¶ˆæ¯é˜Ÿåˆ—åè®®</h1>\n<ul>\n<li>AMQPã€MQTTã€STOMPã€XMPPåè®®</li>\n</ul>\n<h1>4. æ¶ˆæ¯é˜Ÿåˆ—æœ‰å‡ ç§æ¶ˆè´¹è¯­ä¹‰ï¼Ÿ</h1>\n<ul>\n<li>æ¶ˆæ¯è‡³å¤šè¢«æ¶ˆè´¹ä¸€æ¬¡ï¼ˆAt most onceï¼‰ï¼šæ¶ˆæ¯å¯èƒ½ä¼šä¸¢å¤±ï¼Œä½†ç»ä¸é‡ä¼ ã€‚</li>\n<li>æ¶ˆæ¯è‡³å°‘è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼ˆAt least onceï¼‰ï¼šæ¶ˆæ¯å¯ä»¥é‡ä¼ ï¼Œä½†ç»ä¸ä¸¢å¤±ã€‚</li>\n<li>æ¶ˆæ¯ä»…è¢«æ¶ˆè´¹ä¸€æ¬¡ï¼ˆExactly onceï¼‰ï¼šæ¯ä¸€æ¡æ¶ˆæ¯åªè¢«ä¼ é€’ä¸€æ¬¡ã€‚</li>\n</ul>\n<h1>5. Kafkaã€ActiveMQã€RabbitMQã€RocketMQ æœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/523ea7439c3ef3a12016b.png\" alt=\"mq.png\" tabindex=\"0\"><figcaption>mq.png</figcaption></figure>\n<ul>\n<li>ä¸­å°å‹å…¬å¸ï¼ŒæŠ€æœ¯å®åŠ›è¾ƒä¸ºä¸€èˆ¬ï¼ŒæŠ€æœ¯æŒ‘æˆ˜ä¸æ˜¯ç‰¹åˆ«é«˜ï¼Œç”¨ RabbitMQ æ˜¯ä¸é”™çš„é€‰æ‹©ï¼›å¤§å‹å…¬å¸ï¼ŒåŸºç¡€æ¶æ„ç ”å‘å®åŠ›è¾ƒå¼ºï¼Œç”¨ RocketMQ æ˜¯å¾ˆå¥½çš„é€‰æ‹©ã€‚</li>\n<li>å¦‚æœæ˜¯å¤§æ•°æ®é¢†åŸŸçš„å®æ—¶è®¡ç®—ã€æ—¥å¿—é‡‡é›†ç­‰åœºæ™¯ï¼Œç”¨ Kafka æ˜¯ä¸šå†…æ ‡å‡†çš„ï¼Œç»å¯¹æ²¡é—®é¢˜ï¼Œç¤¾åŒºæ´»è·ƒåº¦å¾ˆé«˜ï¼Œç»å¯¹ä¸ä¼šé»„ï¼Œä½•å†µå‡ ä¹æ˜¯å…¨ä¸–ç•Œè¿™ä¸ªé¢†åŸŸçš„äº‹å®æ€§è§„èŒƒã€‚</li>\n<li>RabbitMQå»¶æ—¶æœ€ä½ï¼Œæ¶ˆæ¯å¯é æ€§é«˜ï¼Œé«˜å¯ç”¨ï¼Œä½†æ‰©å±•æ€§è¾ƒå·®ã€‚</li>\n</ul>\n<h1>6. å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„ä¸è¢«é‡å¤æ¶ˆè´¹/å¹‚ç­‰æ€§ï¼Ÿ</h1>\n<ul>\n<li>æ¡†æ¶å±‚ç»Ÿä¸€å°è£…ï¼šç”± Producer ç”Ÿæˆå”¯ä¸€æ ‡è¯†ã€‚ä½¿ç”¨å…³ç³»å‹æ•°æ®åº“ï¼Œå¢åŠ ä¸€ä¸ªæ’é‡è¡¨ï¼Œä½¿ç”¨æ¶ˆæ¯ç¼–å·ä½œä¸ºå”¯ä¸€ä¸»é”®ã€‚éœ€è¦è®©æ’å…¥è®°å½•å’Œä¸šåŠ¡é€»è¾‘åœ¨åŒä¸€ä¸ªäº‹åŠ¡</li>\n<li>ä¸šåŠ¡å±‚å®ç°ï¼šå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œåˆ¤æ–­æ•°æ®æ˜¯å¦å·²ç»è¢«æ›´æ–°è¿‡ã€‚å¦‚æœæ˜¯ï¼Œåˆ™ç›´æ¥è¿”å›æ¶ˆè´¹å®Œæˆï¼Œå¦åˆ™æ‰§è¡Œæ¶ˆè´¹ã€‚</li>\n</ul>\n<h1>7. å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±/å¯é æ€§ä¼ è¾“</h1>\n<p><a href=\"/interview/rabbitmq.md/#2-%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E6%B6%88%E6%81%AF%E4%B8%A2%E5%A4%B1%EF%BC%9F%E5%8F%AF%E9%9D%A0%E6%80%A7%E4%BC%A0%E8%BE%93%EF%BC%9F\" target=\"_blank\">rabbitmqå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿå¯é æ€§ä¼ è¾“ï¼Ÿ</a>âˆš</p>\n<p><a href=\"/interview/rocketmq.md/#9-%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E6%B6%88%E6%81%AF%E4%B8%A2%E5%A4%B1%EF%BC%9F%E5%8F%AF%E9%9D%A0%E6%80%A7%E4%BC%A0%E8%BE%93%EF%BC%9F\" target=\"_blank\">rocketmqå¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿå¯é æ€§ä¼ è¾“ï¼Ÿ</a></p>\n<h1>8. å¦‚ä½•ä¿è¯æ¶ˆæ¯çš„é¡ºåºæ€§ï¼Ÿ</h1>\n<p><a href=\"/interview/rabbitmq.md/#3-%E9%A1%BA%E5%BA%8F%E6%B6%88%E6%81%AF\" target=\"_blank\">rabbitmqé¡ºåºæ¶ˆæ¯</a>âˆš</p>\n<p><a href=\"/interview/rocketmq.md/#8-%E9%A1%BA%E5%BA%8F%E6%B6%88%E6%81%AF\" target=\"_blank\">rocketmqé¡ºåºæ¶ˆæ¯</a></p>\n<h1>9. å¦‚ä½•ä¿è¯æ¶ˆæ¯é˜Ÿåˆ—çš„é«˜å¯ç”¨ï¼Ÿ</h1>\n<p><a href=\"/interview/rabbitmq.md/#4-%E9%AB%98%E5%8F%AF%E7%94%A8\" target=\"_blank\">rabbitmqé«˜å¯ç”¨</a>âˆš</p>\n<p><a href=\"/interview/rocketmq.md/#10-%E9%AB%98%E5%8F%AF%E7%94%A8\" target=\"_blank\">rocketmqé«˜å¯ç”¨</a></p>\n<h1>10. æ¶ˆæ¯ç§¯å‹å¦‚ä½•è§£å†³</h1>\n<ul>\n<li>ä¸´æ—¶ç´§æ€¥æ‰©å®¹ï¼Œå…·ä½“æ“ä½œæ­¥éª¤å’Œæ€è·¯å¦‚ä¸‹ï¼š\n<ul>\n<li>å…ˆä¿®å¤consumerçš„é—®é¢˜ï¼Œç¡®ä¿å…¶æ¢å¤æ¶ˆè´¹é€Ÿåº¦</li>\n<li>æ–°å»ºä¸€ä¸ªtopicï¼Œpartitionæ˜¯åŸæ¥çš„10å€ï¼Œä¸´æ—¶å»ºç«‹å¥½åŸå…ˆ10å€æˆ–è€…20å€çš„queueæ•°é‡</li>\n<li>ç„¶åå†™ä¸€ä¸ªä¸´æ—¶çš„åˆ†å‘æ•°æ®çš„consumerç¨‹åºï¼Œè¿™ä¸ªç¨‹åºéƒ¨ç½²ä¸Šå»æ¶ˆè´¹ç§¯å‹çš„æ•°æ®ï¼Œæ¶ˆè´¹ä¹‹åä¸åšè€—æ—¶çš„å¤„ç†ï¼Œç›´æ¥å‡åŒ€è½®è¯¢å†™å…¥ä¸´æ—¶å»ºç«‹å¥½çš„10å€æ•°é‡çš„queue</li>\n<li>æ¥ç€ä¸´æ—¶å¾ç”¨10å€çš„æœºå™¨æ¥éƒ¨ç½²consumerï¼Œæ¯ä¸€æ‰¹consumeræ¶ˆè´¹ä¸€ä¸ªä¸´æ—¶queueçš„æ•°æ®</li>\n<li>è¿™ç§åšæ³•ç›¸å½“äºæ˜¯ä¸´æ—¶å°†queueèµ„æºå’Œconsumerèµ„æºæ‰©å¤§10å€ï¼Œä»¥æ­£å¸¸çš„10å€é€Ÿåº¦æ¥æ¶ˆè´¹æ•°æ®</li>\n<li>ç­‰å¿«é€Ÿæ¶ˆè´¹å®Œç§¯å‹æ•°æ®ä¹‹åï¼Œå¾—æ¢å¤åŸå…ˆéƒ¨ç½²æ¶æ„ï¼Œé‡æ–°ç”¨åŸå…ˆçš„consumeræœºå™¨æ¥æ¶ˆè´¹æ¶ˆæ¯</li>\n</ul>\n</li>\n</ul>\n<h1>11. ä¸ºä»€ä¹ˆkafkaæœ€é«˜ååé‡</h1>\n<ul>\n<li>kafkaé‡‡ç”¨é¡ºåºè¯»å†™ç£ç›˜ï¼Œå†™æ—¶åˆ†æ–‡ä»¶é¡ºåºå†™ï¼Œè¯»æ—¶æŒ‰offseté¡ºåºè¯»</li>\n<li>Kafkaåˆ©ç”¨äº†æ“ä½œç³»ç»Ÿæœ¬èº«çš„Page Cacheè€Œä¸æ˜¯JVMç©ºé—´å†…å­˜</li>\n<li>Kafka çš„ç”Ÿäº§å’Œæ¶ˆè´¹ä¸¤ä¸ªè¿‡ç¨‹éƒ½ä½¿ç”¨äº†é›¶æ‹·è´ï¼ˆzero copyï¼‰ï¼š\n<ul>\n<li>ç½‘ç»œæ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜(Producer åˆ° Brokerä½¿ç”¨äº†mmap)</li>\n<li>ç£ç›˜æ–‡ä»¶é€šè¿‡ç½‘ç»œå‘é€(Broker åˆ° Consumerä½¿ç”¨äº†sendfile+DMAé‡‡é›†)</li>\n</ul>\n</li>\n<li>æ•°æ®å‹ç¼©\n<ul>\n<li>Kafkaä½¿ç”¨äº†æ‰¹é‡å‹ç¼©ï¼Œå³å°†å¤šä¸ªæ¶ˆæ¯ä¸€èµ·å‹ç¼©è€Œä¸æ˜¯å•ä¸ªæ¶ˆæ¯å‹ç¼©ã€‚ï¼ˆå¦‚æœæ¯ä¸ªæ¶ˆæ¯éƒ½å‹ç¼©ï¼Œå‹ç¼©ç‡ç›¸å¯¹è¾ƒä½ã€‚ï¼‰</li>\n<li>Kafkaå…è®¸ä½¿ç”¨é€’å½’çš„æ¶ˆæ¯é›†åˆï¼Œæ‰¹é‡çš„æ¶ˆæ¯å¯é€šè¿‡å‹ç¼©çš„å½¢å¼ä¼ è¾“å¹¶ä¸”åœ¨æ—¥å¿—ä¸­ä¹Ÿå¯ä¿æŒå‹ç¼©æ ¼å¼ï¼Œç›´åˆ°è¢«æ¶ˆè´¹è€…è§£å‹ç¼©</li>\n<li>Kafkaæ”¯æŒå¤šç§å‹ç¼©åè®®ï¼ŒåŒ…æ‹¬Gzipã€Snappyã€LZ4</li>\n</ul>\n</li>\n<li>æ‰¹é‡ä¼ è¾“\n<ul>\n<li>åœ¨å‘Kafkaå‘é€æ•°æ®æ—¶ï¼Œå¯ä»¥å¯ç”¨æ‰¹æ¬¡å‘é€ï¼Œè¿™æ ·å¯ä»¥é¿å…åœ¨ç½‘ç»œä¸Šé¢‘ç¹ä¼ è¾“å•ä¸ªæ¶ˆæ¯å¸¦æ¥çš„å»¶è¿Ÿå’Œå¸¦å®½å¼€é”€ã€‚å‡è®¾ç½‘ç»œå¸¦å®½ä¸º10MB/Sï¼Œä¸€æ¬¡æ€§ä¼ è¾“10MBçš„æ¶ˆæ¯æ¯”ä¼ è¾“1KBçš„æ¶ˆæ¯10000ä¸‡æ¬¡æ˜¾ç„¶è¦å¿«å¾—å¤šã€‚</li>\n</ul>\n</li>\n<li>å¹¶è¡Œ\n<ul>\n<li>ç”±äºä¸åŒ Partition å¯ä½äºä¸åŒæœºå™¨ï¼Œå› æ­¤å¯ä»¥å……åˆ†åˆ©ç”¨é›†ç¾¤ä¼˜åŠ¿ï¼Œå®ç°æœºå™¨é—´çš„å¹¶è¡Œå¤„ç†ã€‚</li>\n<li>ç”±äº Partition åœ¨ç‰©ç†ä¸Šå¯¹åº”ä¸€ä¸ªæ–‡ä»¶å¤¹ï¼Œå³ä½¿å¤šä¸ª Partition ä½äºåŒä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå¯é€šè¿‡é…ç½®è®©åŒä¸€èŠ‚ç‚¹ä¸Šçš„ä¸åŒ Partition ç½®äºä¸åŒçš„ç£ç›˜ä¸Šï¼Œä»è€Œå®ç°ç£ç›˜é—´çš„å¹¶è¡Œå¤„ç†ï¼Œå……åˆ†å‘æŒ¥å¤šç£ç›˜çš„ä¼˜åŠ¿ã€‚</li>\n</ul>\n</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/523ea7439c3ef3a12016b.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "MyBatis",
      "url": "https://javaguide.cn/interview/mybatis.html",
      "id": "https://javaguide.cn/interview/mybatis.html",
      "summary": "1. MyBatis Mybatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨ SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»º statement ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚ç¨‹åºå‘˜ç›´æ¥ç¼–å†™åŸç”Ÿæ€ sqlï¼Œå¯ä»¥ä¸¥æ ¼æ§åˆ¶ sql æ‰§è¡Œæ€§èƒ½ï¼Œçµæ´»åº¦é«˜ã€‚ MyBatis å¯ä»¥ä½¿ç”¨ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°†...",
      "content_html": "\n<ul>\n<li>Mybatis æ˜¯ä¸€ä¸ªåŠ ORMï¼ˆå¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶ï¼Œå®ƒå†…éƒ¨å°è£…äº† JDBCï¼Œå¼€å‘æ—¶åªéœ€è¦å…³æ³¨ SQL è¯­å¥æœ¬èº«ï¼Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†åŠ è½½é©±åŠ¨ã€åˆ›å»ºè¿æ¥ã€åˆ›å»º statement ç­‰ç¹æ‚çš„è¿‡ç¨‹ã€‚ç¨‹åºå‘˜ç›´æ¥ç¼–å†™åŸç”Ÿæ€ sqlï¼Œå¯ä»¥ä¸¥æ ¼æ§åˆ¶ sql æ‰§è¡Œæ€§èƒ½ï¼Œçµæ´»åº¦é«˜ã€‚</li>\n<li>MyBatis å¯ä»¥ä½¿ç”¨ XML æˆ–æ³¨è§£æ¥é…ç½®å’Œæ˜ å°„åŸç”Ÿä¿¡æ¯ï¼Œå°† POJO æ˜ å°„æˆæ•°æ®åº“ä¸­çš„è®°å½•ï¼Œé¿å…äº†å‡ ä¹æ‰€æœ‰çš„ JDBC ä»£ç å’Œæ‰‹åŠ¨è®¾ç½®å‚æ•°ä»¥åŠè·å–ç»“æœé›†ã€‚</li>\n<li>ç¼ºç‚¹:sqlè¯­å¥ç¼–å†™å·¥ä½œé‡å¤§ï¼Œè¦æ±‚é«˜ï¼Œæ®åº“ç§»æ¤æ€§å·®</li>\n</ul>\n<h1>2. JDBC</h1>\n<ul>\n<li>JDBCï¼ˆJava Data Base Connectivity,javaæ•°æ®åº“è¿æ¥ï¼‰æ˜¯ä¸€ç§ç”¨äºæ‰§è¡ŒSQLè¯­å¥çš„Java APIæ¥å£</li>\n<li>å¯ä»¥ä¸ºå¤šç§å…³ç³»æ•°æ®åº“æä¾›ç»Ÿä¸€è®¿é—®ï¼Œå®ƒç”±ä¸€ç»„ç”¨Javaè¯­è¨€ç¼–å†™çš„ç±»å’Œæ¥å£ç»„æˆã€‚æ˜¯Javaè®¿é—®æ•°æ®åº“çš„æ ‡å‡†è§„èŒƒ</li>\n<li>è€ŒJDBCé©±åŠ¨æ˜¯æ•°æ®åº“å‚å•†å¯¹æ¥å£çš„å®ç°ï¼Œç”¨æ¥è¿æ¥è‡ªå·±çš„æ•°æ®åº“</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Class.forName(â€œcom.mysql.jdbc.Driverâ€);//1.æ³¨å†Œé©±åŠ¨\nconnection conn= DirverManger.getConnection\t(jdbc:mysql://ip:port/æ•°æ®åº“åï¼Œç”¨æˆ·åï¼Œå¯†ç );//2.è·å¾—é“¾æ¥\nString sql = \"select \\* from user where name = ?\";\nPreparedStatement psmt = conn.prepareStatement(sql);//3.è·å¾—é¢„å¤„ç†å¯¹è±¡è¯­å¥æ‰§è¡Œå¹³å°\n//void setXxx(int index, Xxx xx); --è®¾ç½®å®é™…å‚æ•°\npsmt.setString(1,'å¼ ä¸‰');//4.è®¾ç½®å®é™…å‚æ•°\n//int executeUpdate(); --æ‰§è¡Œinsert update deleteè¯­å¥.\n//ResultSet executeQuery(); --æ‰§è¡Œselectè¯­å¥.\n//boolean execute(); --æ‰§è¡Œselectè¿”å›true æ‰§è¡Œå…¶ä»–çš„è¯­å¥è¿”å›false.\nResultSet rs = psmt.executeQuery();//5.æ‰§è¡Œsql\nwhile( rs.next() ){//6.å¤„ç†ç»“æœé›†\n\tObject getObject(int index) / Object getObject(String name) è·å¾—ä»»æ„å¯¹è±¡\n\tString getString(int index) / Object getObject(String name) è·å¾—å­—ç¬¦ä¸²\n\tint getInt(int index) / Object getObject(String name) è·å¾—æ•´å½¢\n\tdouble getDouble(int index) / Object getObject(String name) è·å¾—åŒç²¾åº¦æµ®ç‚¹å‹\n}\nrs.close();//7.é‡Šæ”¾æ‰€æœ‰èµ„æº\nstmt.close();\ncon.close();\n</code></pre></div><h1>3. Statementä¸PreparedStatementçš„åŒºåˆ«</h1>\n<ul>\n<li>é¢„ç¼–è¯‘ï¼š\n<ul>\n<li>Statementæ¯æ¬¡æ‰§è¡ŒStatementå¯¹è±¡çš„executeQueryæˆ–executeUpdateæ–¹æ³•æ—¶ï¼ŒSQL è¯­å¥åœ¨æ•°æ®åº“ç«¯éƒ½éœ€è¦é‡æ–°ç¼–è¯‘å’Œæ‰§è¡Œã€‚è¿™é€‚ç”¨äºä¸€æ¬¡æ€§æ‰§è¡Œçš„ SQL è¯­å¥</li>\n<li>PreparedStatementï¼šSQLè¯­å¥åœ¨PreparedStatementå¯¹è±¡åˆ›å»ºæ—¶å°±è¢«å‘é€åˆ°æ•°æ®åº“è¿›è¡Œé¢„ç¼–è¯‘ã€‚ä¹‹åå¯ä»¥é€šè¿‡è®¾ç½®å‚æ•°å€¼æ¥å¤šæ¬¡é«˜æ•ˆåœ°æ‰§è¡Œè¿™ä¸ª SQL è¯­å¥ã€‚è¿™ä¸ä»…å‡å°‘äº†æ•°æ®åº“ç¼–è¯‘ SQL è¯­å¥çš„å¼€é”€ï¼Œä¹Ÿæé«˜äº†æ€§èƒ½ï¼Œå°¤å…¶æ˜¯å¯¹äºé‡å¤æ‰§è¡Œçš„ SQL æ“ä½œã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>4. mybatisä»€ä¹ˆæ—¶å€™ç”¨çš„#{}ã€ä»€ä¹ˆæ—¶å€™${} âˆš</h1>\n<ul>\n<li>#{}æ˜¯å ä½ç¬¦ï¼Œé¢„ç¼–è¯‘å¤„ç†ï¼›${}æ˜¯æ‹¼æ¥ç¬¦ï¼Œå­—ç¬¦ä¸²æ›¿æ¢ï¼Œæ²¡æœ‰é¢„ç¼–è¯‘å¤„ç†ã€‚<br>\nMybatis åœ¨å¤„ç†#{}æ—¶ï¼Œ#{}ä¼ å…¥å‚æ•°æ˜¯ä»¥å­—ç¬¦ä¸²ä¼ å…¥ï¼Œä¼šå°† SQL ä¸­çš„#{}æ›¿æ¢ä¸º?å·ï¼Œè°ƒç”¨ PreparedStatement çš„ set æ–¹æ³•æ¥èµ‹å€¼ã€‚</li>\n<li>#{} å¯ä»¥æœ‰æ•ˆçš„é˜²æ­¢ SQL æ³¨å…¥ï¼Œæé«˜ç³»ç»Ÿå®‰å…¨æ€§ï¼›${} ä¸èƒ½é˜²æ­¢ SQL æ³¨å…¥</li>\n<li>#{} çš„å˜é‡æ›¿æ¢æ˜¯åœ¨ DBMS ä¸­ï¼›${} çš„å˜é‡æ›¿æ¢æ˜¯åœ¨ DBMS å¤–</li>\n<li>#{}å¯å®ç°preparedStatementå‘å ä½ç¬¦ä¸­è®¾ç½®å€¼ï¼Œè‡ªåŠ¨è¿›è¡Œjavaç±»å‹å’Œjdbcç±»å‹è½¬æ¢ã€‚è‡ªåŠ¨åŠ ä¸Š''.</li>\n<li>${}ä¸è¿›è¡Œjavaç±»å‹å’Œjdbcç±»å‹è½¬æ¢ï¼Œ ä¸åŠ '' å•æ¡SQLä¸è¶…è¿‡è¯­å¥çš„æœ€å¤§é™åˆ¶max_allowed_packetï¼ˆ1mï¼‰</li>\n</ul>\n<h1>5. æ¨¡ç³ŠæŸ¥è¯¢ like è¯­å¥è¯¥æ€ä¹ˆå†™?</h1>\n<ul>\n<li>CONCAT('%',#{question},'%')æˆ–è€…\"%\"#{question}\"%\"</li>\n</ul>\n<h1>6. Mybatis èƒ½æ‰§è¡Œä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šçš„å…³è”æŸ¥è¯¢å—</h1>\n<ul>\n<li>ä¸€å¯¹ä¸€<code>&lt;association&gt;</code>ã€ä¸€å¯¹å¤š<code>&lt;collection&gt;</code></li>\n</ul>\n<h1>7. Mybatis æ˜¯å¦æ”¯æŒå»¶è¿ŸåŠ è½½ï¼ŸåŸç†ï¼Ÿ</h1>\n<ul>\n<li>Mybatis æ”¯æŒ association å…³è”å¯¹è±¡å’Œ collection å…³è”é›†åˆå¯¹è±¡çš„å»¶è¿ŸåŠ è½½ï¼Œassociation æŒ‡çš„å°±æ˜¯ä¸€å¯¹ä¸€ï¼Œcollection æŒ‡çš„å°±æ˜¯ä¸€å¯¹å¤šæŸ¥è¯¢ã€‚åœ¨ Mybatis é…ç½®æ–‡ä»¶ä¸­ï¼Œå¯ä»¥é…ç½®æ˜¯å¦å¯ç”¨å»¶è¿ŸåŠ è½½ lazyLoadingEnabled=true|falseã€‚</li>\n<li>åŸç†æ˜¯ï¼Œä½¿ç”¨ CGLIB åˆ›å»ºç›®æ ‡å¯¹è±¡çš„ä»£ç†å¯¹è±¡ï¼Œå½“è°ƒç”¨ç›®æ ‡æ–¹æ³•æ—¶ï¼Œè¿›å…¥æ‹¦æˆªå™¨æ–¹æ³•ï¼Œæ¯”å¦‚è°ƒç”¨ a.getB().getName()ï¼Œæ‹¦æˆªå™¨ invoke()æ–¹æ³•å‘ç° a.getB()æ˜¯ null å€¼ï¼Œé‚£ä¹ˆå°±ä¼šå•ç‹¬å‘é€äº‹å…ˆä¿å­˜å¥½çš„æŸ¥è¯¢å…³è” B å¯¹è±¡çš„ sqlï¼ŒæŠŠ B æŸ¥è¯¢ä¸Šæ¥ï¼Œç„¶åè°ƒç”¨ a.setB(b)ï¼Œäºæ˜¯ a çš„å¯¹è±¡ b å±æ€§å°±æœ‰å€¼äº†ï¼Œæ¥ç€å®Œæˆ a.getB().getName()æ–¹æ³•çš„è°ƒç”¨ã€‚è¿™å°±æ˜¯å»¶è¿ŸåŠ è½½çš„åŸºæœ¬åŸç†ã€‚<br>\nå½“ç„¶äº†ï¼Œä¸å…‰æ˜¯ Mybatisï¼Œå‡ ä¹æ‰€æœ‰çš„åŒ…æ‹¬ Hibernateï¼Œæ”¯æŒå»¶è¿ŸåŠ è½½çš„åŸç†éƒ½æ˜¯ä¸€æ ·çš„ã€‚</li>\n</ul>\n<h1>8. MyBatisäº‹åŠ¡ç®¡ç†å½¢å¼</h1>\n<ul>\n<li>ä½¿ç”¨JDBCçš„äº‹åŠ¡ç®¡ç†æœºåˆ¶ã€‚åˆ©ç”¨java.sql.Connectionå¯¹è±¡å®Œæˆå¯¹äº‹åŠ¡çš„æäº¤commitã€å›æ»šrollbackã€å…³é—­closeç­‰æ“ä½œã€‚</li>\n<li>ä½¿ç”¨MANAGEDçš„äº‹åŠ¡ç®¡ç†æœºåˆ¶ã€‚MyBatisè‡ªèº«ä¸ä¼šå»å®ç°äº‹åŠ¡ç®¡ç†ï¼Œè€Œæ˜¯è®©å®¹å™¨å¦‚WebLogicã€JBOSSç­‰å®ç°å¯¹äº‹ç‰©çš„ç®¡ç†ã€‚</li>\n</ul>\n<h1>9. mybatisä¸€çº§ç¼“å­˜å’ŒäºŒçº§ç¼“å­˜ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ä¸æ¨èï¼Œå› ä¸ºåˆ†å¸ƒå¼ç¯å¢ƒä¸‹ç¼“å­˜åŸºäºæœ¬åœ°ï¼Œä¼šæœ‰è„æ•°æ®ï¼Œä¸å¦‚ç›´æ¥ä½¿ç”¨Redisã€Memcachedç­‰åˆ†å¸ƒå¼ç¼“</p>\n</li>\n<li>\n<p>ä¸€çº§ç¼“å­˜ï¼ˆé»˜è®¤æ‰“å¼€ï¼‰ï¼šåŸºäºPerpetualCacheæ²¡æœ‰å®¹é‡é™å®šçš„HashMapç¼“å­˜ï¼Œä½œç”¨åŸŸä¸ºsqlSessionæˆ–è€…statementï¼Œæœ‰å¤šä¸ªSqlSessionæˆ–è€…åˆ†å¸ƒå¼çš„ç¯å¢ƒä¸‹ï¼Œæ•°æ®åº“å†™æ“ä½œä¼šå¼•èµ·è„æ•°æ®ï¼Œå»ºè®®è®¾ä¸ºStatementã€‚é…ç½®ï¼š</p>\n</li>\n<li>\n<p>äºŒçº§ç¼“å­˜ï¼šåŸºäºPerpetualCacheæ²¡æœ‰å®¹é‡é™å®šçš„HashMapç¼“å­˜ï¼Œå…¶å­˜å‚¨ä½œç”¨åŸŸä¸ºMapper(Namespace)ï¼Œå¯è‡ªå®šä¹‰å­˜å‚¨æºå¦‚Ehcacheã€‚é…ç½®ï¼š</p>\n</li>\n<li>\n<p>å¯¹äºç¼“å­˜æ•°æ®æ›´æ–°æœºåˆ¶ï¼Œå½“æŸä¸€ä¸ªä½œç”¨åŸŸ(ä¸€çº§ç¼“å­˜Session/äºŒçº§ç¼“å­˜Namespaces)è¿›è¡Œäº†C/U/Dæ“ä½œåï¼Œé»˜è®¤è¯¥ä½œç”¨åŸŸä¸‹æ‰€æœ‰selectçš„ç¼“å­˜å°†è¢«clear</p>\n</li>\n</ul>\n<h1>10. mybatisæ‰§è¡Œé¡ºåº</h1>\n<ul>\n<li>è¯»å– MyBatis é…ç½®æ–‡ä»¶â€”â€”mybatis-config.xml ã€åŠ è½½SQLæ˜ å°„æ–‡ä»¶Mapper.xmlã€‚æœ€åç”Ÿæˆä¸€ä¸ªé…ç½®å¯¹è±¡</li>\n<li>æ„é€ ä¼šè¯å·¥å‚ï¼šé€šè¿‡ MyBatis çš„ç¯å¢ƒç­‰é…ç½®ä¿¡æ¯æ„å»ºä¼šè¯å·¥å‚ SqlSessionFactoryã€‚</li>\n<li>åˆ›å»ºä¼šè¯å¯¹è±¡ï¼šç”±ä¼šè¯å·¥å‚åˆ›å»º SqlSession å¯¹è±¡ï¼Œè¯¥å¯¹è±¡ä¸­åŒ…å«äº†æ‰§è¡Œ SQL è¯­å¥çš„æ‰€æœ‰æ–¹æ³•ã€‚</li>\n<li>Executor æ‰§è¡Œå™¨ï¼šMyBatis åº•å±‚å®šä¹‰äº†ä¸€ä¸ª Executor æ¥å£æ¥æ“ä½œæ•°æ®åº“ï¼Œå®ƒå°†æ ¹æ® SqlSession ä¼ é€’çš„å‚æ•°åŠ¨æ€åœ°ç”Ÿæˆéœ€è¦æ‰§è¡Œçš„ SQL è¯­å¥ï¼ŒåŒæ—¶è´Ÿè´£æŸ¥è¯¢ç¼“å­˜çš„ç»´æŠ¤ã€‚</li>\n<li>StatementHandlerï¼šæ•°æ®åº“ä¼šè¯å™¨ï¼Œä¸²è”èµ·å‚æ•°æ˜ å°„çš„å¤„ç†å’Œè¿è¡Œç»“æœæ˜ å°„çš„å¤„ç†ã€‚</li>\n<li>ParameterHandlerå‚æ•°å¤„ç†ï¼šå¯¹è¾“å…¥å‚æ•°çš„ç±»å‹è¿›è¡Œå¤„ç†ï¼Œå¹¶é¢„ç¼–è¯‘ã€‚</li>\n<li>ResultSetHandlerç»“æœå¤„ç†ï¼šå¯¹è¿”å›ç»“æœçš„ç±»å‹è¿›è¡Œå¤„ç†ï¼Œæ ¹æ®å¯¹è±¡æ˜ å°„è§„åˆ™ï¼Œè¿”å›ç›¸åº”çš„å¯¹è±¡ã€‚</li>\n</ul>\n<h1>11. åŠ¨æ€SQLæ¦‚å¿µï¼Œä½œç”¨ï¼Œæ‰§è¡ŒåŸç†å—ï¼Ÿ</h1>\n<ul>\n<li>ä»¥XMLæ ‡ç­¾çš„å½¢å¼ç¼–å†™åŠ¨æ€SQL ï¼Œå®Œæˆé€»è¾‘åˆ¤æ–­å’ŒåŠ¨æ€æ‹¼æ¥SQLçš„åŠŸèƒ½ã€‚</li>\n<li>åŠ¨æ€SQLæ ‡ç­¾ï¼š<code>&lt;if /&gt;ã€&lt;choose /&gt;ã€&lt;when /&gt;ã€&lt;otherwise /&gt;ã€&lt;trim /&gt;ã€&lt;where /&gt;ã€&lt;set /&gt;ã€&lt;foreach /&gt;ã€&lt;bind /&gt;</code> ã€‚</li>\n<li>æ‰§è¡ŒåŸç†ä¸ºä½¿ç”¨OGNLçš„è¡¨è¾¾å¼ï¼Œä»SQLå‚æ•°å¯¹è±¡ä¸­è®¡ç®—è¡¨è¾¾å¼çš„å€¼ï¼Œæ ¹æ®è¡¨è¾¾å¼çš„å€¼åŠ¨æ€æ‹¼æ¥SQLï¼Œä»¥æ­¤æ¥å®ŒæˆåŠ¨æ€SQLåŠŸèƒ½ã€‚</li>\n</ul>\n<h1>12. Mapperæ¥å£ä¸XMLå¯¹åº”å…³ç³»çš„åŸç†ï¼ŸMapper æ¥å£é‡Œçš„æ–¹æ³•ï¼Œå‚æ•°ä¸åŒæ—¶ï¼Œæ–¹æ³•èƒ½é‡è½½å—ï¼Ÿ</h1>\n<ul>\n<li>Mapperæ¥å£XMLå¯¹åº”çš„å…³ç³»å¦‚ä¸‹\n<ul>\n<li>æ¥å£çš„å…¨é™åæ˜ å°„æ–‡ä»¶namespaceå€¼</li>\n<li>æ¥å£çš„æ–¹æ³•åæ˜ å°„æ–‡ä»¶MappedStatementçš„idå€¼</li>\n<li>æ¥å£æ–¹æ³•å†…çš„å‚æ•°æ˜¯ä¼ é€’ç»™SQLçš„å‚æ•°</li>\n</ul>\n</li>\n<li>Mapperæ¥å£é‡Œçš„æ–¹æ³•ä¸èƒ½é‡è½½ï¼Œå› ä¸ºæ˜¯å…¨é™å+æ–¹æ³•åçš„ä¿å­˜å’Œå¯»æ‰¾ç­–ç•¥ã€‚</li>\n<li>åŸç†ï¼šæ¯ä¸€ä¸ªselectã€insertã€updateã€deleteæ ‡ç­¾ï¼Œéƒ½ä¼šè¢«è§£æä¸ºä¸€ä¸ªMappedStatementå¯¹è±¡ã€‚Mapperæ¥å£çš„å®ç°ç±»é€šè¿‡ä½¿ç”¨JDKåŠ¨æ€ä»£ç†è‡ªåŠ¨ç”Ÿæˆä»£ç†å¯¹è±¡Proxyæ—¶ä¼šæ‹¦æˆªæ¥å£æ–¹æ³•ï¼Œæ ¹æ®æ¥å£å…¨é™å+æ–¹æ³•åæ‹¼æ¥å­—ç¬¦ä¸²ä½œä¸ºkeyå€¼ï¼Œå”¯ä¸€å®šä½ä¸€ä¸ªå¯¹åº”çš„MappedStatementæ‰§è¡ŒSQL<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/de704e9bac809e0be3798.jpg\" alt=\"sqlexecutionprocedure.png\"></li>\n</ul>\n<h1>13. Mybatisæ˜¯å¦å¯ä»¥æ˜ å°„Enumæšä¸¾ç±»ï¼Ÿ</h1>\n<ul>\n<li>EnumTypeHandleråŸºäºEnum.nameå±æ€§(String)ã€‚é»˜è®¤ã€‚</li>\n<li>EnumOrdinalTypeHandleråŸºäºEnum.ordinalå±æ€§(int)ã€‚å¯é€šè¿‡ </li>\n<li>Mybatiså¯ä»¥æ˜ å°„ä»»ä½•å¯¹è±¡åˆ°è¡¨çš„ä¸€åˆ—ä¸Šã€‚é€šè¿‡è‡ªå®šä¹‰ä¸€ä¸ªTypeHandlerç±»å®ç°TypeHandlerçš„#setParameter()å’ŒgetResult() æ¥å£å®Œæˆä» javaType è‡³ jdbcType çš„åŒå‘è½¬æ¢ã€‚</li>\n</ul>\n<h1>14. Mybatiséƒ½æœ‰å“ªäº›Executoræ‰§è¡Œå™¨ï¼Ÿå®ƒä»¬ä¹‹é—´çš„åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>SimpleExecutorï¼šæ¯æ‰§è¡Œä¸€æ¬¡updateæˆ–selectæ“ä½œå°±åˆ›å»ºä¸€ä¸ªStatementå¯¹è±¡ï¼Œç”¨å®Œç«‹åˆ»å…³é—­Statementå¯¹è±¡</li>\n<li>ReuseExecutorï¼šæ‰§è¡Œupdateæˆ–selectæ“ä½œï¼Œä»¥SQLä½œä¸ºkeyæŸ¥æ‰¾ç¼“å­˜çš„Statementå¯¹è±¡ï¼Œå­˜åœ¨å°±ä½¿ç”¨ï¼Œä¸å­˜åœ¨å°±åˆ›å»ºï¼›ç”¨å®Œåæ”¾ç½®äºç¼“å­˜Map&lt;String, Statement&gt;å†…</li>\n<li>BatchExecutorï¼šæ‰§è¡Œupdateæ“ä½œï¼ˆä¸æ”¯æŒselectï¼‰ï¼Œå°†æ‰€æœ‰SQLéƒ½æ·»åŠ åˆ°æ‰¹å¤„ç†ä¸­ï¼ˆé€šè¿‡addBatchæ–¹æ³•ï¼‰ï¼Œç­‰å¾…ç»Ÿä¸€æ‰§è¡Œï¼ˆä½¿ç”¨executeBatchæ–¹æ³•ï¼‰ã€‚å®ƒç¼“å­˜äº†å¤šä¸ªStatementå¯¹è±¡ï¼Œéƒ½æ˜¯è°ƒç”¨addBatchæ–¹æ³•åï¼Œç­‰å¾…ä¸€æ¬¡æ‰§è¡Œ executeBatch æ‰¹å¤„ç†ã€‚è¿‡ç¨‹ä¸JDBCæ‰¹å¤„ç†æ˜¯ç›¸åŒã€‚</li>\n<li>CachingExecutor ï¼šåœ¨ä¸Šè¿°çš„ä¸‰ä¸ªæ‰§è¡Œå™¨ä¹‹ä¸Šï¼Œå¢åŠ äºŒçº§ç¼“å­˜çš„åŠŸèƒ½ã€‚</li>\n<li><code>&lt;setting name=\"defaultExecutorType\" value=\"\"&gt;</code> value=SIMPLEã€REUSEã€BATCH ä¸‰ä¸ªå€¼ï¼Œåˆ†åˆ«ä½¿ç”¨SimpleExecutorã€ReuseExecutorã€BatchExecutoræ‰§è¡Œå™¨</li>\n<li><code>&lt;setting name=\"cacheEnabled\" value=\"\"&gt;</code> value=trueæ—¶åˆ›å»º CachingExecutor æ‰§è¡Œå™¨ã€‚</li>\n</ul>\n<h1>15. MyBatis å¦‚ä½•æ‰§è¡Œæ‰¹é‡æ“ä½œï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨ foreach æ ‡ç­¾ï¼šforeach æ ‡ç­¾çš„å±æ€§ä¸»è¦æœ‰ itemï¼Œindexï¼Œcollectionï¼Œopenï¼Œseparatorï¼Œcloseã€‚</li>\n<li>ä½¿ç”¨ ExecutorType.BATCH</li>\n</ul>\n<h1>16. ç®€è¿° Mybatis çš„æ’ä»¶è¿è¡ŒåŸç†ï¼Ÿä»¥åŠå¦‚ä½•ç¼–å†™ä¸€ä¸ªæ’ä»¶ï¼Ÿ</h1>\n<ul>\n<li>æ’ä»¶çš„åŸç†å°±æ˜¯åœ¨è¿™å››å¤§å¯¹è±¡è°ƒåº¦çš„æ—¶å€™ï¼Œä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œæ’å…¥ä¸€äº›æˆ‘æˆ‘ä»¬è‡ªå·±çš„ä»£ç ã€‚</li>\n<li>ä»…å¯ä»¥è‡ªå®šä¹‰ParameterHandlerã€ResultSetHandlerã€StatementHandlerã€Executorçš„æ’ä»¶</li>\n<li>ä¸ºéœ€è¦æ‹¦æˆªçš„æ¥å£ç”Ÿæˆä»£ç†å¯¹è±¡ä»¥å®ç°æ¥å£æ–¹æ³•æ‹¦æˆªåŠŸèƒ½ï¼Œæ¯å½“æ‰§è¡Œè¿™4ç§æ¥å£å¯¹è±¡çš„æ–¹æ³•æ—¶ï¼Œå°±ä¼šè¿›å…¥æ‹¦æˆªæ–¹æ³•ï¼Œå…·ä½“å°±æ˜¯ InvocationHandler çš„ #invoke(...)æ–¹æ³•ã€‚</li>\n<li>1.å®ç°Interceptoræ¥å£å®ç°intercept(...) æ–¹æ³•ã€‚</li>\n<li>2.åœ¨ç»™æ’ä»¶ç¼–å†™æ³¨è§£ï¼ŒæŒ‡å®šè¦æ‹¦æˆªå“ªä¸€ä¸ªæ¥å£çš„å“ªäº›æ–¹æ³•å³å¯</li>\n<li>3.åœ¨é…ç½®æ–‡ä»¶ä¸­é…ç½®ä½ ç¼–å†™çš„æ’ä»¶ã€‚</li>\n</ul>\n<h1>17. Mybatisæ˜¯å¦‚ä½•è¿›è¡Œåˆ†é¡µçš„ï¼Ÿåˆ†é¡µæ’ä»¶çš„åŸç†ï¼Ÿ</h1>\n<ul>\n<li>ä¸æ¨èï¼šä½¿ç”¨RowBoundså¯¹è±¡é’ˆå¯¹ResultSetç»“æœé›†æ‰§è¡Œçš„å†…å­˜åˆ†é¡µï¼Œè€Œéæ•°æ®åº“åˆ†é¡µ</li>\n<li>æ¨èï¼šåœ¨SQLè¾“å…¥åˆ†é¡µå‚æ•°ï¼›ä½¿ç”¨åˆ†é¡µæ’ä»¶è‡ªåŠ¨æ·»åŠ åˆ†é¡µæ¡ä»¶æ¥å®Œæˆæ•°æ®åº“åˆ†é¡µ</li>\n<li>åŸç†æ˜¯ä½¿ç”¨æ’ä»¶æ¥å£ï¼Œå®ç°è‡ªå®šä¹‰åˆ†é¡µæ’ä»¶ã€‚æ‹¦æˆªExecutorçš„queryæ–¹æ³•ï¼Œé‡å†™SQLï¼Œæ ¹æ®dialectæ–¹è¨€ï¼Œæ·»åŠ å¯¹åº”çš„ç‰©ç†åˆ†é¡µè¯­å¥å’Œç‰©ç†åˆ†é¡µå‚æ•°ã€‚</li>\n<li>å¸¸ç”¨åˆ†é¡µæ’ä»¶ï¼šMybatis-PageHelper MyBatis-Plus</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/de704e9bac809e0be3798.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "mysql",
      "url": "https://javaguide.cn/interview/mysql.html",
      "id": "https://javaguide.cn/interview/mysql.html",
      "summary": "1. ä»€ä¹ˆæ˜¯MySQLï¼Ÿ å¼€æºçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œéš¶å±Oracle 2. MySQL çš„å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥ã€äº¤å‰è¿æ¥ã€ç¬›å¡å°”ç§¯æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ inner joinå†…è¿æ¥ï¼Œå–å¾—ä¸¤å¼ è¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚åªæœ‰å½“ä¸¤ä¸ªè¡¨ä¸­éƒ½æœ‰åŒ¹é…çš„è®°å½•æ—¶ï¼Œè¿™äº›è®°å½•æ‰ä¼šå‡ºç°åœ¨æŸ¥è¯¢ç»“æœä¸­ã€‚å¦‚æœæŸä¸€æ–¹æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼Œåˆ™è¯¥è®°å½•ä¸ä¼šå‡ºç°åœ¨ç»“æœé›†ä¸­ã€‚ç›¸å½“äºä¸¤ä¸ªæ•°æ®é›†çš„äº¤é›†ã€‚ å¤–è¿...",
      "content_html": "\n<ul>\n<li>å¼€æºçš„å…³ç³»å‹æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼Œéš¶å±Oracle</li>\n</ul>\n<h1>2. MySQL çš„å†…è¿æ¥ã€å·¦è¿æ¥ã€å³è¿æ¥ã€äº¤å‰è¿æ¥ã€ç¬›å¡å°”ç§¯æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>inner joinå†…è¿æ¥ï¼Œå–å¾—ä¸¤å¼ è¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚åªæœ‰å½“ä¸¤ä¸ªè¡¨ä¸­éƒ½æœ‰åŒ¹é…çš„è®°å½•æ—¶ï¼Œè¿™äº›è®°å½•æ‰ä¼šå‡ºç°åœ¨æŸ¥è¯¢ç»“æœä¸­ã€‚å¦‚æœæŸä¸€æ–¹æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼Œåˆ™è¯¥è®°å½•ä¸ä¼šå‡ºç°åœ¨ç»“æœé›†ä¸­ã€‚ç›¸å½“äºä¸¤ä¸ªæ•°æ®é›†çš„äº¤é›†ã€‚</li>\n<li>å¤–è¿æ¥ï¼ˆouter joinï¼‰ï¼šä¸åªå–å¾—ä¸¤å¼ è¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ï¼Œè¿˜åŒ…æ‹¬æŸå¼ è¡¨ï¼ˆæˆ–ä¸¤å¼ è¡¨ï¼‰ä¸­ä¸æ»¡è¶³åŒ¹é…å…³ç³»çš„è®°å½•ã€‚åˆ†ä¸ºå·¦é“¾æ¥å’Œå³è¿æ¥</li>\n<li>left joinè¿”å›å·¦è¡¨ï¼ˆFROMå­å¥ä¸­æŒ‡å®šè¡¨ï¼‰æ‰€æœ‰è®°å½•ï¼Œä»¥åŠå³è¡¨æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚å¦‚æœå³è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼Œåˆ™ç»“æœä¸­å³è¡¨çš„éƒ¨åˆ†ä¼šä»¥NULLå¡«å……</li>\n<li>right joinè¿”å›å³è¡¨ï¼ˆFROMå­å¥ä¸­æŒ‡å®šè¡¨ï¼‰æ‰€æœ‰è®°å½•ï¼Œä»¥åŠå·¦è¡¨ä¸­æ»¡è¶³è¿æ¥æ¡ä»¶çš„è®°å½•ã€‚å¦‚æœå·¦è¡¨ä¸­æ²¡æœ‰åŒ¹é…çš„è®°å½•ï¼Œåˆ™ç»“æœä¸­å·¦è¡¨çš„éƒ¨åˆ†ä¼šä»¥NULLå¡«å……</li>\n<li>äº¤å‰è¿æ¥ï¼ˆcrossjoinï¼‰ï¼šæ˜¾ç¤ºä¸¤å¼ è¡¨æ‰€æœ‰è®°å½•ä¸€ä¸€å¯¹åº”ï¼Œæ²¡æœ‰åŒ¹é…å…³ç³»è¿›è¡Œç­›é€‰ï¼Œå®ƒæ˜¯ç¬›å¡å°”ç§¯åœ¨SQLä¸­çš„å®ç°ï¼Œå¦‚æœAè¡¨æœ‰mè¡Œï¼ŒBè¡¨æœ‰nè¡Œï¼Œé‚£ä¹ˆAå’ŒBäº¤å‰è¿æ¥çš„ç»“æœå°±æœ‰m*nè¡Œã€‚</li>\n<li>ç¬›å¡å°”ç§¯ï¼šä¾‹å¦‚é›†åˆA={a,b}ï¼Œé›†åˆB={0,1,2}ï¼Œé‚£ä¹ˆAâœ–ï¸B={&lt;a,o&gt;,&lt;a,1&gt;,&lt;a,2&gt;,&lt;b,0&gt;,&lt;b,1&gt;,&lt;b,2&gt;,}ã€‚</li>\n</ul>\n<h1>3. æ•°æ®åº“ä¸‰å¤§èŒƒå¼ï¼Ÿ</h1>\n<ul>\n<li>ç¬¬ä¸€èŒƒå¼(1NF)ï¼šå­—æ®µå€¼å…·æœ‰åŸå­æ€§,ä¸èƒ½å†åˆ†;ä¾‹å¦‚ï¼šå§“åå­—æ®µ,å…¶ä¸­å§“å’Œåæ˜¯ä¸€ä¸ªæ•´ä½“,å¦‚æœåŒºåˆ†å§“å’Œåé‚£ä¹ˆå¿…é¡»è®¾ç«‹ä¸¤ä¸ªç‹¬ç«‹å­—æ®µ</li>\n<li>ç¬¬äºŒèŒƒå¼(2NF)ï¼šæ»¡è¶³ç¬¬ä¸€èŒƒå¼åŸºç¡€ä¸Šï¼Œè¦æ±‚æ•°æ®åº“è¡¨ä¸­æ¯ä¸€åˆ—éƒ½å’Œä¸»é”®ç›¸å…³ï¼Œè€Œä¸èƒ½åªä¸ä¸»é”®çš„æŸä¸€éƒ¨åˆ†ç›¸å…³ï¼ˆä¸»è¦é’ˆå¯¹è”åˆä¸»é”®è€Œè¨€ï¼‰ã€‚ä¾‹å¦‚è®¢å•è¡¨é‡Œï¼Œå­˜å‚¨äº†å•†å“ä¿¡æ¯ï¼ˆå•†å“ä»·æ ¼ã€å•†å“ç±»å‹ï¼‰ï¼Œé‚£å°±éœ€è¦æŠŠå•†å“ ID å’Œè®¢å• ID ä½œä¸ºè”åˆä¸»é”®ï¼Œæ‰æ»¡è¶³ç¬¬äºŒèŒƒå¼ã€‚</li>\n<li>ç¬¬ä¸‰èŒƒå¼(3NF)ï¼šåœ¨æ»¡è¶³ç¬¬äºŒèŒƒå¼åŸºç¡€ä¸Šï¼Œä¸€ä¸ªè¡¨ä¸­ä¸èƒ½åŒ…æ¶µå…¶ä»–ç›¸å…³è¡¨ä¸­éå…³é”®å­—æ®µçš„ä¿¡æ¯,å³æ•°æ®è¡¨ä¸èƒ½æœ‰å†—ä½™å­—æ®µã€‚è®¢å•è¡¨ä¸­åŒ…å«è®¢å•ç¼–å·å’Œå•†å“ç¼–å·ï¼Œå­˜åœ¨å†—ä½™æ•°æ®ï¼Œæ¯”å¦‚è¯´å•†å“åç§°ã€å•ä½ã€å•†å“ä»·æ ¼ç­‰ï¼Œåº”è¯¥å°†å…¶æ‹†åˆ†ä¸ºè®¢å•è¡¨ã€è®¢å•å•†å“å…³è”è¡¨ã€å•†å“è¡¨ã€‚</li>\n<li>ä¸‰å¤§èŒƒå¼çš„ä½œç”¨æ˜¯ä¸ºäº†æ§åˆ¶æ•°æ®åº“çš„å†—ä½™ï¼ŒèŠ‚çœç©ºé—´ï¼Œå®é™…ä¸Šå¯ä»¥é€šè¿‡å†—ä½™ä¸€äº›æ•°æ®ï¼Œé¿å…è·¨è¡¨è·¨åº“ï¼Œåˆ©ç”¨ç©ºé—´æ¢æ—¶é—´ï¼Œæé«˜æ€§èƒ½,å‡å°‘joinçš„æŸ¥è¯¢;ä¾‹å¦‚ï¼šç›¸å†Œè¡¨ä¸­ä¼šæ·»åŠ å›¾ç‰‡çš„ç‚¹å‡»æ•°å­—æ®µ,åœ¨ç›¸å†Œå›¾ç‰‡è¡¨ä¸­ä¹Ÿä¼šæ·»åŠ å›¾ç‰‡çš„ç‚¹å‡»æ•°å­—æ®µ;</li>\n</ul>\n<h1>4. varcharä¸charåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>\n<p>charè¡¨ç¤ºå®šé•¿å­—ç¬¦ä¸²ï¼Œé•¿åº¦å›ºå®š</p>\n</li>\n<li>\n<p>å¦‚æœæ’å…¥æ•°æ®çš„é•¿åº¦å°äºcharçš„å›ºå®šé•¿åº¦æ—¶ï¼Œåˆ™ç”¨ç©ºæ ¼å¡«å……ï¼›CHARä¼šè‡ªåŠ¨åˆ é™¤æ’å…¥æ•°æ®çš„å°¾éƒ¨ç©ºæ ¼</p>\n</li>\n<li>\n<p>å› ä¸ºé•¿åº¦å›ºå®šï¼Œæ‰€ä»¥å­˜å–é€Ÿåº¦è¦æ¯”varcharå¿«ï¼Œä½†å¯èƒ½ä¼šå æ®å¤šä½™çš„ç©ºé—´ï¼Œæ˜¯ç©ºé—´æ¢æ—¶é—´çš„åšæ³•</p>\n</li>\n<li>\n<p>charæœ€å¤šèƒ½å­˜æ”¾çš„å­—ç¬¦ä¸ªæ•°ä¸º255ï¼Œå’Œç¼–ç æ— å…³</p>\n</li>\n<li>\n<p>varchar(50)ä¸­50çš„æ¶µä¹‰æœ€å¤šå­˜æ”¾50ä¸ªå­—ç¬¦ã€‚varchar(50)å’Œ(200)å­˜å‚¨æ‰€å ç©ºé—´ä¸€æ ·ï¼Œä½†åè€…åœ¨æ’åºæ—¶ä¼šæ¶ˆè€—æ›´å¤šå†…å­˜ï¼Œå› ä¸º ORDER BY col é‡‡ç”¨ fixed_length è®¡ç®— col é•¿åº¦(memoryå¼•æ“ä¹Ÿä¸€æ ·)</p>\n</li>\n<li>\n<p>varcharè¡¨ç¤ºå¯å˜é•¿å­—ç¬¦ä¸²ï¼Œé•¿åº¦ä¸å›ºå®š</p>\n</li>\n<li>\n<p>æŒ‰ç…§æ’å…¥çš„æ•°æ®é•¿åº¦æ¥å­˜å‚¨ï¼›VARCHARä¸ä¼šåˆ é™¤å°¾éƒ¨ç©ºæ ¼</p>\n</li>\n<li>\n<p>å› ä¸ºé•¿åº¦ä¸å›ºå®šï¼Œvarcharæ¯”charå­˜å–æ…¢ï¼Œä¸å æ®å¤šä½™çš„ç©ºé—´ï¼Œæ˜¯æ—¶é—´æ¢ç©ºé—´çš„åšæ³•</p>\n</li>\n<li>\n<p>varcharæœ€å¤šèƒ½å­˜æ”¾çš„å­—ç¬¦ä¸ªæ•°ä¸º65532</p>\n</li>\n<li>\n<p>å¯¹äºé•¿åº¦ç›¸å¯¹å›ºå®šçš„å­—ç¬¦ä¸²ï¼Œå¯ä»¥ä½¿ç”¨charï¼Œå¯¹äºé•¿åº¦ä¸ç¡®å®šçš„ï¼Œä½¿ç”¨varcharæ›´åˆé€‚ä¸€äº›ã€‚</p>\n</li>\n</ul>\n<h1>5. blobå’Œtextæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>éƒ½åœ¨ä¿å­˜è¾ƒå¤§æ–‡æœ¬æ—¶ä½¿ç”¨</li>\n<li>blobç”¨äºå­˜å‚¨äºŒè¿›åˆ¶æ•°æ®ï¼Œæ¯”å¦‚ç…§ç‰‡ï¼›è€Œtextç”¨äºå­˜å‚¨å¤§å­—ç¬¦ä¸²ã€‚æ¯”å¦‚ä¸€ç¯‡æ–‡ç« æˆ–è€…æ—¥è®°</li>\n<li>blobæ²¡æœ‰å­—ç¬¦é›†ï¼Œtextæœ‰å­—ç¬¦é›†ï¼Œå¹¶ä¸”æ ¹æ®å­—ç¬¦é›†çš„æ ¡å¯¹è§„åˆ™å¯¹å€¼è¿›è¡Œæ’åºå’Œæ¯”è¾ƒ</li>\n</ul>\n<h1>6. DATETIMEå’ŒTIMESTAMPçš„å¼‚åŒï¼Ÿ</h1>\n<ul>\n<li>ç›¸åŒç‚¹\n<ul>\n<li>å­˜å‚¨æ—¶é—´çš„è¡¨ç°æ ¼å¼ä¸€è‡´YYYY-MM-DD HH:MM:SS</li>\n<li>éƒ½åŒ…å«ã€Œæ—¥æœŸã€å’Œã€Œæ—¶é—´ã€éƒ¨åˆ†ã€‚</li>\n<li>éƒ½å¯ä»¥å­˜å‚¨å¾®ç§’çš„å°æ•°ç§’ï¼ˆç§’å6ä½å°æ•°ç§’ï¼‰</li>\n</ul>\n</li>\n<li>åŒºåˆ«\n<ul>\n<li>æ—¥æœŸèŒƒå›´ï¼šDATETIMEçš„æ—¥æœŸèŒƒå›´æ˜¯1000-01-0100:00:00.000000åˆ°9999-12-31 23:59:59.999999ï¼›èŒƒå›´å¤§ã€‚TIMESTAMPçš„æ—¶é—´èŒƒå›´æ˜¯1970-01-0100:00:01.000000UTCåˆ°2038-01-0903:14:07.999999UTCï¼ŒèŒƒå›´å°ã€‚</li>\n<li>å­˜å‚¨ç©ºé—´ï¼šDATETIMEçš„å­˜å‚¨ç©ºé—´ä¸º8å­—èŠ‚ï¼›TIMESTAMPçš„å­˜å‚¨ç©ºé—´ä¸º4å­—èŠ‚</li>\n<li>æ—¶åŒºç›¸å…³ï¼šDATETIMEå­˜å‚¨æ—¶é—´ä¸æ—¶åŒºæ— å…³ï¼›TIMESTAMPå­˜å‚¨æ—¶é—´ä¸æ—¶åŒºæœ‰å…³</li>\n<li>é»˜è®¤å€¼ï¼šDATETIMEçš„é»˜è®¤å€¼ä¸ºnullï¼›TIMESTAMPå­—æ®µä¸ä¸ºç©º(notnull)ï¼Œé»˜è®¤å€¼ä¸ºå½“å‰æ—¶é—´(CURRENT_TIMESTAMP)</li>\n</ul>\n</li>\n</ul>\n<h1>7. inå’Œexistsçš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>inè¯­å¥æ˜¯æŠŠå¤–è¡¨ï¼ˆinæ‰€åœ¨çš„å­æŸ¥è¯¢çš„è¡¨ï¼‰å’Œå†…è¡¨ï¼ˆfromå­å¥ä¸­çš„è¡¨ï¼‰ä½œhashè¿æ¥ï¼Œè€Œexistsè¯­å¥æ˜¯å¯¹å¤–è¡¨ä½œloopå¾ªç¯ï¼Œæ¯æ¬¡loopå¾ªç¯å†å¯¹å†…è¡¨è¿›è¡ŒæŸ¥è¯¢</li>\n<li>å¦‚æœæŸ¥è¯¢çš„ä¸¤ä¸ªè¡¨å¤§å°ç›¸å½“ï¼Œé‚£ä¹ˆç”¨inå’Œexistså·®åˆ«ä¸å¤§ã€‚</li>\n<li>å¦‚æœä¸¤ä¸ªè¡¨ä¸­ä¸€ä¸ªè¾ƒå°ï¼Œä¸€ä¸ªæ˜¯å¤§è¡¨ï¼Œåˆ™å­æŸ¥è¯¢è¡¨å¤§çš„ç”¨existsï¼Œå­æŸ¥è¯¢è¡¨å°çš„ç”¨inã€‚</li>\n<li>å¦‚æœæŸ¥è¯¢è¯­å¥ä½¿ç”¨äº†not inï¼Œé‚£ä¹ˆå†…å¤–è¡¨éƒ½è¿›è¡Œå…¨è¡¨æ‰«æï¼Œæ²¡æœ‰ç”¨åˆ°ç´¢å¼•ï¼›è€Œnot extstsçš„å­æŸ¥è¯¢ä¾ç„¶èƒ½ç”¨åˆ°è¡¨ä¸Šçš„ç´¢å¼•ã€‚æ‰€ä»¥æ— è®ºé‚£ä¸ªè¡¨å¤§ï¼Œç”¨not existséƒ½æ¯”not inè¦å¿«ã€‚</li>\n</ul>\n<h1>8. MySQLé‡Œè®°å½•è´§å¸ç”¨ä»€ä¹ˆå­—æ®µç±»å‹ï¼Ÿipå‘¢ï¼Ÿ</h1>\n<ul>\n<li>å¸¸ç”¨Decimalå’ŒNumricç±»å‹è¡¨ç¤ºï¼Œä¾‹å¦‚salary DECIMAL(9,2)ï¼Œ9(precision)ä»£è¡¨å°†è¢«ç”¨äºå­˜å‚¨å€¼çš„æ€»çš„å°æ•°ä½æ•°ï¼Œè€Œ2(scale)ä»£è¡¨å°†è¢«ç”¨äºå­˜å‚¨å°æ•°ç‚¹åçš„ä½æ•°ã€‚å­˜å‚¨åœ¨salaryåˆ—ä¸­çš„å€¼çš„èŒƒå›´æ˜¯ä»-9999999.99åˆ°9999999.99ã€‚</li>\n<li>DECIMALå’ŒNUMERICå€¼ä½œä¸ºå­—ç¬¦ä¸²å­˜å‚¨ï¼Œè€Œä¸æ˜¯ä½œä¸ºäºŒè¿›åˆ¶æµ®ç‚¹æ•°ï¼Œä»¥ä¾¿ä¿å­˜é‚£äº›å€¼çš„å°æ•°ç²¾åº¦ã€‚</li>\n<li>floatå’Œdoubleæ˜¯ä»¥äºŒè¿›åˆ¶å­˜å‚¨çš„ï¼Œå­˜åœ¨è¯¯å·®ï¼Œä¸ä½¿ç”¨ã€‚</li>\n<li>ipåœ°å€çš„å­˜å‚¨ bigint insert into sessions (ipaddress)values (inet_aton('192.168.0.1')); select inet_ntoa(ipaddress) from sessions;</li>\n<li>èŒƒå›´æŸ¥è¯¢IP select * from t where inet_aton(ip)&gt;=inet_aton('192.168.1.3') and inet_aton(ip)&lt;=inet_aton('192.168.1.20')</li>\n</ul>\n<h2>8.1. MySQLæ€ä¹ˆå­˜å‚¨emojiğŸ˜Š?</h2>\n<ul>\n<li>ä½¿ç”¨å­—ç¬¦ä¸²å­˜å‚¨emojiã€‚åŒæ—¶ä½¿ç”¨4å­—èŠ‚çš„utf8mb4ç¼–ç ã€‚</li>\n<li>alter table blogs modify content text CHARACTER SET utf8mb4 COLLATE utf8mb4_unicode_ci not null;</li>\n</ul>\n<h2>8.2. dropã€delete ä¸ truncate çš„åŒºåˆ«ï¼Ÿ</h2>\n<ul>\n<li>åœ¨ä¸å†éœ€è¦ä¸€å¼ è¡¨çš„æ—¶å€™ï¼Œç”¨dropï¼›åœ¨æƒ³åˆ é™¤éƒ¨åˆ†æ•°æ®è¡Œæ—¶å€™ï¼Œç”¨deleteï¼›åœ¨ä¿ç•™è¡¨è€Œåˆ é™¤æ‰€æœ‰æ•°æ®çš„æ—¶å€™ç”¨truncateã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\"></th>\n<th>delete</th>\n<th>truncate</th>\n<th>drop</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ç±»å‹</td>\n<td>å±äºDML</td>\n<td>å±äºDDL</td>\n<td>å±äºDDL</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å›æ»š</td>\n<td>å¯å›æ»š</td>\n<td>ä¸å¯å›æ»š</td>\n<td>ä¸å¯å›æ»š</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">åˆ é™¤å†…å®¹</td>\n<td>è¡¨ç»“æ„è¿˜åœ¨ï¼Œåˆ é™¤è¡¨çš„å…¨éƒ¨æˆ–è€…ä¸€éƒ¨åˆ†æ•°æ®è¡Œä¸é‡Šæ”¾ç©ºé—´</td>\n<td>è¡¨ç»“æ„è¿˜åœ¨ï¼Œåˆ é™¤è¡¨ä¸­çš„æ‰€æœ‰æ•°æ®é‡Šæ”¾ç©ºé—´åˆ é™¤æ•°æ®åé‡æ–°å†™æ•°æ®ä¼šä»1å¼€å§‹</td>\n<td>ä»æ•°æ®åº“ä¸­åˆ é™¤è¡¨ï¼Œæ‰€æœ‰æ•°æ®è¡Œï¼Œç´¢å¼•å’Œæƒé™ä¹Ÿä¼šè¢«åˆ é™¤</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">åˆ é™¤é€Ÿåº¦</td>\n<td>é€Ÿåº¦æ…¢ï¼Œéœ€è¦é€è¡Œåˆ é™¤</td>\n<td>é€Ÿåº¦å¿«</td>\n<td>é€Ÿåº¦æœ€å¿«</td>\n</tr>\n</tbody>\n</table>\n<h1>9. UNION ä¸ UNION ALL çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>Unionï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼Œä¸åŒ…æ‹¬é‡å¤è¡Œï¼ŒåŒæ—¶è¿›è¡Œé»˜è®¤è§„åˆ™çš„æ’åºï¼›</li>\n<li>Union Allï¼šå¯¹ä¸¤ä¸ªç»“æœé›†è¿›è¡Œå¹¶é›†æ“ä½œï¼ŒåŒ…æ‹¬é‡å¤è¡Œï¼Œä¸è¿›è¡Œæ’åºï¼›é€Ÿåº¦è¾ƒå¿«</li>\n</ul>\n<h1>10. count(1)ã€count(*)ã€count(ä¸»é”®|åˆ—å)çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>\n<p>MyISAMæ‰§è¡Œcount(*)ä¼šç›´æ¥è¿”å›å­˜å‚¨åœ¨ç£ç›˜ä¸Šçš„è¡¨çš„æ€»è¡Œæ•°ï¼Œæ•ˆç‡é«˜ï¼›</p>\n</li>\n<li>\n<p>InnoDBæ‰§è¡Œcount(*)éœ€è¦æŠŠæ•°æ®ä¸€è¡Œä¸€è¡Œåœ°ä»å¼•æ“é‡Œé¢è¯»å‡ºæ¥ï¼Œç„¶åç´¯ç§¯è®¡æ•°ï¼›å› ä¸ºinnodbæ”¯æŒäº‹åŠ¡ï¼Œæ¯ä¸ªäº‹åŠ¡æŸ¥è¯¢ç»“æœæœ‰å·®å¼‚ï¼Œæ•…ä¸å­˜å‚¨è¡¨çš„æ€»è¡Œæ•°</p>\n</li>\n<li>\n<p>count(*) ç»Ÿè®¡æ‰€æœ‰è¡Œï¼ˆå…è®¸nullï¼‰ã€‚ä¸ºäº†å‡å°‘æ‰«ææ•°æ®é‡ï¼Œè‡ªåŠ¨æ‰«æç´¢å¼•æ ‘å°çš„ã€‚ä¸å–å€¼ï¼ŒæŒ‰è¡Œç´¯åŠ </p>\n</li>\n<li>\n<p>count(1)ç»Ÿè®¡æ‰€æœ‰è¡Œï¼ˆå…è®¸nullï¼‰ï¼Œä¸å–å€¼ï¼ŒæŒ‰è¡Œç´¯åŠ ã€‚ç”¨1ä»£è¡¨ä»£ç è¡Œï¼Œé€Ÿåº¦æ¯”count(ä¸»é”®id)å¿«ã€‚å› ä¸ºä»å¼•æ“è¿”å›idä¼šæ¶‰åŠåˆ°è§£ææ•°æ®è¡Œï¼Œä»¥åŠæ‹·è´å­—æ®µå€¼çš„æ“ä½œ</p>\n</li>\n<li>\n<p>count(ä¸»é”®id) ç»Ÿè®¡ä¸ä¸ºnullçš„è¡Œã€‚éå†æ•´å¼ è¡¨æŠŠæ¯ä¸€è¡Œçš„idå€¼éƒ½å–å‡ºæ¥è¿”å›ç»™serverå±‚</p>\n</li>\n<li>\n<p>count(åˆ—å)ç»Ÿè®¡ä¸ä¸ºnullçš„è¡Œã€‚åªåŒ…æ‹¬åˆ—åé‚£ä¸€åˆ—</p>\n</li>\n<li>\n<p>æŒ‰ç…§æ•ˆç‡æ’åºçš„è¯ï¼Œcount(å­—æ®µ)&lt;count(ä¸»é”®id)&lt;count(1)â‰ˆcount(<em>)ï¼Œå»ºè®®å°½é‡ä½¿ç”¨count(</em>)ã€‚</p>\n</li>\n</ul>\n<h1>11. ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥çš„æ‰§è¡Œé¡ºåºï¼Ÿâˆš</h1>\n<ul>\n<li>FROMï¼šå¯¹FROMå­å¥ä¸­çš„å·¦è¡¨&lt;left_table&gt;å’Œå³è¡¨&lt;right_table&gt;æ‰§è¡Œç¬›å¡å„¿ç§¯ï¼ˆCartesianproductï¼‰ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT1</li>\n<li>ONï¼šå¯¹è™šæ‹Ÿè¡¨VT1åº”ç”¨ONç­›é€‰ï¼Œåªæœ‰é‚£äº›ç¬¦åˆ&lt;join_condition&gt;çš„è¡Œæ‰è¢«æ’å…¥è™šæ‹Ÿè¡¨VT2ä¸­</li>\n<li>JOINï¼šå¦‚æœæŒ‡å®šäº†OUTERJOINï¼ˆå¦‚LEFTOUTERJOINã€RIGHTOUTERJOINï¼‰ï¼Œé‚£ä¹ˆä¿ç•™è¡¨ä¸­æœªåŒ¹é…çš„è¡Œä½œä¸ºå¤–éƒ¨è¡Œæ·»åŠ åˆ°è™šæ‹Ÿè¡¨VT2ä¸­ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT3ã€‚å¦‚æœFROMå­å¥åŒ…å«ä¸¤ä¸ªä»¥ä¸Šè¡¨ï¼Œåˆ™å¯¹ä¸Šä¸€ä¸ªè¿æ¥ç”Ÿæˆçš„ç»“æœè¡¨VT3å’Œä¸‹ä¸€ä¸ªè¡¨é‡å¤æ‰§è¡Œæ­¥éª¤1ï¼‰ï½æ­¥éª¤3ï¼‰ï¼Œç›´åˆ°å¤„ç†å®Œæ‰€æœ‰çš„è¡¨ä¸ºæ­¢</li>\n<li>WHEREï¼šå¯¹è™šæ‹Ÿè¡¨VT3åº”ç”¨WHEREè¿‡æ»¤æ¡ä»¶ï¼Œåªæœ‰ç¬¦åˆ&lt;where_condition&gt;çš„è®°å½•æ‰è¢«æ’å…¥è™šæ‹Ÿè¡¨VT4ä¸­</li>\n<li>GROUP BYï¼šæ ¹æ®GROUP BYå­å¥ä¸­çš„åˆ—ï¼Œå¯¹VT4ä¸­çš„è®°å½•è¿›è¡Œåˆ†ç»„æ“ä½œï¼Œäº§ç”ŸVT5</li>\n<li>ACG_FUNCèšåˆå‡½æ•°</li>\n<li>CUBE|ROLLUPï¼šå¯¹è¡¨VT5è¿›è¡ŒCUBEæˆ–ROLLUPæ“ä½œï¼Œäº§ç”Ÿè¡¨VT6</li>\n<li>HAVINGæ¡ä»¶è¿‡æ»¤ï¼šå¯¹è™šæ‹Ÿè¡¨VT6åº”ç”¨HAVINGè¿‡æ»¤å™¨ï¼Œåªæœ‰ç¬¦åˆ&lt;having_condition&gt;çš„è®°å½•æ‰è¢«æ’å…¥è™šæ‹Ÿè¡¨VT7ä¸­ã€‚</li>\n<li>SELECTæŠ•å½±åˆ—ï¼šç¬¬äºŒæ¬¡æ‰§è¡ŒSELECTæ“ä½œï¼Œé€‰æ‹©æŒ‡å®šçš„åˆ—ï¼Œæ’å…¥åˆ°è™šæ‹Ÿè¡¨VT8ä¸­</li>\n<li>DISTINCTï¼šå»é™¤é‡å¤æ•°æ®ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT9</li>\n<li>ORDER BYï¼šå°†è™šæ‹Ÿè¡¨VT9ä¸­çš„è®°å½•æŒ‰ç…§&lt;order_by_list&gt;è¿›è¡Œæ’åºæ“ä½œï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT10ã€‚11ï¼‰</li>\n<li>LIMITï¼šå–å‡ºæŒ‡å®šè¡Œçš„è®°å½•ï¼Œäº§ç”Ÿè™šæ‹Ÿè¡¨VT11ï¼Œå¹¶è¿”å›ç»™æŸ¥è¯¢ç”¨æˆ·</li>\n<li>èšåˆå‡½æ•°åœ¨WHEREä¹‹åæ‰§è¡Œ åœ¨WHEREåˆ¤æ–­æ¡ä»¶é‡ŒåŠ å…¥èšåˆå‡½æ•°æ˜¯åšä¸åˆ°çš„</li>\n</ul>\n<h1>12. SQLåˆ†ç±»</h1>\n<p>SQL(Structure Query Language)ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œå…³ç³»å‹æ•°æ®åº“åº”ç”¨è¯­éŸ³</p>\n<ul>\n<li>DDL(Data Definition Languagesæ•°æ®åº“å®šä¹‰è¯­è¨€) å®šä¹‰ä¸åŒçš„æ•°æ®æ®µã€æ•°æ®åº“ã€è¡¨ã€åˆ—ã€ç´¢å¼•ç­‰æ•°æ®åº“å¯¹è±¡(createã€alterã€dropç­‰)</li>\n<li>DML(Data Manipulation Languageæ•°æ®åº“æ“ä½œè¯­è¨€) ç”¨äºæ·»åŠ ã€åˆ é™¤ã€æ›´æ–°å’ŒæŸ¥è¯¢æ•°æ®åº“è®°å½•ï¼Œå¹¶æ£€æŸ¥æ•°æ®å®Œæ•´æ€§(insertã€deleteã€update)</li>\n<li>DQL(Data Query Languageæ•°æ®åº“æŸ¥è¯¢è¯­è¨€)æŸ¥è¯¢æ•°æ®åº“ä¸­è¡¨çš„è®°å½•(select)</li>\n<li>DCL(Data Control Languageæ•°æ®åº“æ§åˆ¶è¯­è¨€) ç”¨äºæ§åˆ¶ä¸åŒæ•°æ®æ®µç›´æ¥çš„è®¸å¯å’Œè®¿é—®çº§åˆ«çš„è¯­å¥ã€‚å®šä¹‰äº†æ•°æ®åº“ã€è¡¨ã€å­—æ®µã€ç”¨æˆ·çš„è®¿é—®æƒé™å’Œå®‰å…¨çº§åˆ«(grant,revokeç­‰)</li>\n</ul>\n<h2>12.1. DDLè¯­å¥</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºæ•°æ®åº“\nmysql&gt; CREATE DATABASE æ•°æ®åº“å [charset å­—ç¬¦é›†] [collate æ ¡å¯¹è§„åˆ™];\n\n# æŸ¥çœ‹æ‰€æœ‰æ•°æ®åº“\n# information_schemaï¼šå­˜å‚¨äº†ç³»ç»Ÿä¸­çš„ä¸€äº›æ•°æ®åº“å¯¹è±¡ä¿¡æ¯ã€‚æ¯”å¦‚ç”¨æˆ·è¡¨ä¿¡æ¯ã€åˆ—ä¿¡æ¯ã€æƒé™ä¿¡æ¯ã€åˆ†åŒºä¿¡æ¯ç­‰\n# clusterï¼šå­˜å‚¨äº†ç³»ç»Ÿçš„é›†ç¾¤ä¿¡æ¯\n# mysqlï¼šå­˜å‚¨äº†ç³»ç»Ÿçš„ç”¨æˆ·æƒé™ä¿¡æ¯\nmysql&gt; SHOW DATABASES;\n\n# æŸ¥çœ‹æ•°æ®åº“è¯¦ç»†è¯´æ˜(ç¼–ç )\nmysql&gt; SHOW CREATE DATABASE æ•°æ®åº“å;\n\n# é€‰æ‹©æ“ä½œçš„æ•°æ®åº“\nmysql&gt; USE æ•°æ®åº“å;\n\n# æŸ¥çœ‹å½“å‰æ“ä½œçš„æ•°æ®åº“\nmysql&gt; SELECT DATABASE();\n\n# æŸ¥çœ‹æ•°æ®åº“çš„è¡¨\nmysql&gt; SHOW TABLES;\n\n# æ”¹å˜æ•°æ®åº“çš„å…¨å±€ç‰¹æ€§\nmysql&gt; ALTER DATABASE [db_name] [CHARACTER SET charset] [COLLATE collation];\n\n# åˆ é™¤æ•°æ®åº“\nmysql&gt; DROP DATABASE æ•°æ®åº“å;\n\n# åˆ›å»ºè¡¨\nmysql&gt; CREATE TABLE è¡¨å(åˆ—å æ•°æ®ç±»å‹(é•¿åº¦)[çº¦æŸ] (s) )[NGINE=å­˜å‚¨å¼•æ“][CHARSET å­—ç¬¦é›† collate æ ¡å¯¹è§„åˆ™]\n\n# åˆ›å»ºMEMORYè¡¨\nmysql&gt; CREATE TABLE è¡¨å ENGINE=MEMORY selectå­å¥\n\n# åˆ›å»ºMERGEè¡¨\nmysql&gt; CREATE TABLE è¡¨å(åˆ—å ç±»å‹(é•¿åº¦)[çº¦æŸ] (s)) engine=merge union=(è¡¨å(s)) [INSERT_METHOD=LAST|FIRST|NO]\n\n# æŸ¥çœ‹è¡¨å®šä¹‰/å»ºè¡¨sql\nmysql&gt; DES è¡¨å;\nmysql&gt; show create table è¡¨å;\n\n# åˆ é™¤è¡¨\nmysql&gt; DROP TABLE è¡¨å;\nmysql&gt; truncate table è¡¨å;åˆ è¡¨é‡å»ºï¼Œauto_incrementé‡æ–°è®°å½•,åˆ é™¤çš„æ•°æ®æ‰¾ä¸å›\n\n# å¢åŠ è¡¨å­—æ®µ\nmysql&gt; ALTER TABLE è¡¨å ADD åˆ—å ç±»å‹ï¼ˆé•¿åº¦ï¼‰[çº¦æŸ][FIRST | AFTER åˆ—å];\n\n# ä¿®æ”¹è¡¨å­—æ®µç±»å‹(é•¿åº¦)[çº¦æŸ]\nmysql&gt; ALTER TABLE è¡¨å MODIFY åˆ—å ç±»å‹(é•¿åº¦)[çº¦æŸ][FIRST | AFTER åˆ—å]\n\n# æ”¹æ•´ä¸ªå­—æ®µ\nmysql&gt; ALTER TABLE è¡¨å CHANGE  æ—§åˆ—å æ–°åˆ—å ç±»å‹(é•¿åº¦)[çº¦æŸ] [FIRST | AFTER åˆ—å]\n\n# åˆ é™¤å­—æ®µ\nmysql&gt; ALTER TABLE è¡¨å DROP åˆ—å;\n\n# æ”¹è¡¨å\nmysql&gt; ALTER TABLE æ—§è¡¨å RENAME  æ–°è¡¨å\n\n# æ”¹è¡¨å­—ç¬¦é›†\nmysql&gt; ALTER TABLE è¡¨å character set å­—ç¬¦é›†;\n\n# ä¿®æ”¹å­˜å‚¨å¼•æ“\nmysql&gt; ALTER TABLE è¡¨å engine = innodb;\n\n# å¢åŠ å¤–é”®\n# RESTRICTå’ŒNO ACTIONæ˜¯æŒ‡é™åˆ¶åœ¨å­è¡¨æœ‰å…³è”è®°å½•çš„æƒ…å†µä¸‹ä¸»è¡¨ä¸èƒ½æ›´æ–°ï¼›CASCADE è¡¨ç¤ºä¸»è¡¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤æ—¶ï¼Œæ›´æ–°æˆ–è€…åˆ é™¤å­è¡¨å¯¹åº”è®°å½•ï¼›SET NULLè¡¨ç¤ºä¸»è¡¨åœ¨æ›´æ–°æˆ–è€…åˆ é™¤çš„æ—¶å€™ï¼Œå­è¡¨çš„å¯¹åº”å­—æ®µè¢« SET NULL\nmysql&gt; ALTER TABLE å­è¡¨ add [constraint å¤–é”®å(ä»¥_fkç»“å°¾)] foreign key (ä»è¡¨å¤–é”®åˆ—å) references ä¸»è¡¨ (ä¸»è¡¨ä¸»é”®)[ON DELETE/UPDATE RESTRICT/CASCADE/SET NULL/NO ACTION(s)];\n\n# æ·»åŠ ä¸»é”®çº¦æŸ\nmysql&gt; ALTER TABLE table_name ADD PRIMARY KEY (column_name);\n\n# åˆ å¤–é”®\nmysql&gt; alter table ä»è¡¨ drop foreign key å¤–é”®åç§°;\n\n# æŸ¥å­—ç¬¦é›†å¯¹åº”çš„æ ¡å¯¹è§„åˆ™\nmysql&gt; show character set;\n\n# æŸ¥çœ‹MySQLç¼–ç \nmysql&gt; SHOW VARIABLES LIKE 'char%';\n\n# ä¿®æ”¹mysqlçš„éš”ç¦»çº§åˆ«\nmysql&gt; set session transaction isolation level\n\n# åˆ›å»ºç´¢å¼•\nmysql&gt; CREATE [UNIQUE|FULLTEXT|SPATIAL] INDEX ç´¢å¼•åç§° [USING ç´¢å¼•ç±»å‹] ON è¡¨å (åˆ—å)[(é•¿åº¦)(s)],...\n\n# åˆ é™¤ç´¢å¼•\nmysql&gt; DROP INDEX ç´¢å¼•åç§° ON è¡¨å\n</code></pre></div><h2>12.2. DMLè¯­å¥</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># æ·»åŠ è®°å½•\nmysql&gt; INSERT INTO è¡¨å [(åˆ—å1ï¼Œåˆ—å2ï¼Œåˆ—å3...)] VALUES (å€¼1ï¼Œå€¼2ï¼Œå€¼3)[,(å€¼3, å€¼3, å€¼5)...]\n\n# ä¿®æ”¹(å¤šè¡¨)è®°å½•\nmysql&gt; UPDATE è¡¨å(s) SET åˆ—å=å€¼[,åˆ—å=å€¼(s)] [where æ¡ä»¶];\nmysql&gt; UPDATE t1[,t2â€¦tn] SET t1.field1=expr1[,tn.fieldn=exprn] [where æ¡ä»¶]\n\n# åˆ é™¤(å¤šè¡¨)è®°å½•\nmysql&gt; DELETE FROM è¡¨å [where æ¡ä»¶] auto_incrementè®°å½•ä¸æ¸…ç©ºï¼ŒåŒä¸€ä¸ªäº‹åŠ¡å¯ä»¥æ‰¾å›æ•°æ®\nmysql&gt; DELETE t1,t2â€¦tn FROM t1,t2â€¦tn [where æ¡ä»¶]\n\n# å¼€å§‹äº‹åŠ¡\nmysql&gt; START TRANSACTION;\n# æäº¤äº‹åŠ¡\nmysql&gt; COMMIT;\n# å›æ»šäº‹åŠ¡\nmysql&gt; ROLLBACK;\n</code></pre></div><h2>12.3. DQLè¯­å¥</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># æŸ¥è¯¢è®°å½•\nmysql&gt; SELECT [distinctå…¨éƒ¨åˆ—,éç¬¬ä¸€åˆ—] */åˆ—å [as `åˆ«å`](s) FROM è¡¨å [inner/left/right join è¡¨å on æ¡ä»¶] [where æ¡ä»¶] [group by æ¡ä»¶ [WITH ROLLUP å¯¹åˆ†ç±»èšåˆåçš„ç»“æœè¿›è¡Œå†æ±‡æ€» å’ŒORDER BYæ˜¯äº’ç›¸æ’æ–¥] [having æ¡ä»¶ å¯¹åˆ†ç±»åçš„ç»“æœå†è¿›è¡Œæ¡ä»¶çš„è¿‡æ»¤]]  [order by æ¡ä»¶ asc/desc(s)å¤šä¸ªå­—æ®µæ—¶ï¼Œç›¸åŒçš„æŒ‰ç¬¬äºŒä¸ªå­—æ®µæ’ï¼Œä¾æ¬¡ç±»æ¨ï¼Œé»˜è®¤å‡åº] [limit offset_start[,row_count] offset_start=(ç¬¬å‡ é¡µ-1)*row_count row_countæ¯é¡µæ•°é‡]\n\n# éšå¼å†…è¿æ¥\nmysql&gt; select *from A,B where æ¡ä»¶\n# æ˜¾ç¤ºå†…è¿æ¥\nmysql&gt; select * from A [inner] join B on æ¡ä»¶\n# å·¦å¤–è¿æ¥: åŒ…å«æ‰€æœ‰çš„å·¦è¾¹è¡¨ä¸­çš„è®°å½•ç”šè‡³æ˜¯å³è¾¹è¡¨ä¸­æ²¡æœ‰å’Œå®ƒåŒ¹é…çš„è®°å½•\nmysql&gt; select * from A left outer join B on æ¡ä»¶\n# å³å¤–è¿æ¥: åŒ…å«æ‰€æœ‰çš„å³è¾¹è¡¨ä¸­çš„è®°å½•ç”šè‡³æ˜¯å·¦è¾¹è¡¨ä¸­æ²¡æœ‰å’Œå®ƒåŒ¹é…çš„è®°å½•\nmysql&gt; select * from B right outer join A on æ¡ä»¶ å·¦è¿æ¥ï¼š\n# å­æŸ¥è¯¢(inã€not inã€=ã€!=ã€existsã€not existsã€ALLã€ANYã€SOME),è¡¨è¿æ¥åœ¨å¾ˆå¤šæƒ…å†µä¸‹ç”¨äºä¼˜åŒ–å­æŸ¥è¯¢\nmysql&gt; select * from è¡¨å where åˆ—å=ï¼ˆselect where åˆ—å=å€¼ï¼‰;\n\n\n- è¡¨ä¸è¡¨çš„å…³ç³»\n  - ä¸€å¯¹ä¸€ï¼šå¯ä»¥åˆ›å»ºæˆä¸€å¼ è¡¨\n  - ä¸€å¯¹å¤šï¼šéƒ¨é—¨ä¸å‘˜å·¥ã€å®¢æˆ·å’Œè®¢å•ã€åˆ†ç±»å’Œå•†å“\n  - ä»è¡¨ï¼ˆå¤šï¼‰åˆ›å»ºå­—æ®µå¹¶æ·»åŠ å¤–é”®æŒ‡å‘ä¸»è¡¨ï¼ˆä¸€ï¼‰çš„ä¸»é”®\n  - å¤šå¯¹å¤šï¼šå­¦ç”Ÿå’Œè¯¾ç¨‹ã€å•†å“å’Œè®¢å•ã€äººå’Œè§’è‰²\n  - å»ºç«‹ä¸­é—´è¡¨ï¼Œè‡³å°‘ä¸¤å­—æ®µã€‚ä½œä¸ºä»è¡¨ï¼ŒæŒ‡å‘å„æ–¹ï¼ˆå¤šï¼‰çš„ä¸»é”®ï¼ˆæ‹†æˆä¸¤ä¸ªä¸€å¯¹å¤šï¼‰\n- å¤–é”®æ“ä½œ\n  - ä»è¡¨å¤–é”®æ˜¯å¯¹ä¸»è¡¨ä¸»é”®çš„å¼•ç”¨ã€ä»è¡¨å¤–é”®ç±»å‹å¿…é¡»ä¸ä¸»è¡¨ä¸»é”®ç±»å‹ä¸€æ ·\n  - ä»è¡¨ä¸èƒ½æ·»åŠ (æ›´æ–°)ï¼Œä¸»è¡¨ä¸­ä¸å­˜åœ¨çš„æ•°æ®ã€‚ä¸»è¡¨ä¸èƒ½åˆ é™¤ï¼ˆæ›´æ–°ï¼‰ï¼Œä»è¡¨ä¸­å·²ç»ä½¿ç”¨çš„æ•°æ®\n  - å¤–é”®çš„ç›®çš„æ˜¯ä¿è¯æ•°æ®å®Œæ•´æ€§\n  - åˆ é™¤ä¸»è¡¨ä¸­ä¸ä»è¡¨æœ‰å…³è”å…³ç³»çš„æ•°æ®\n  - â‘ è§£é™¤ä¸»ä»è¡¨çš„çº¦æŸå…³ç³»\n  - â‘¡å…ˆåˆ é™¤ä»è¡¨ä¸­ä¸ä¸»è¡¨æœ‰å…³ç³»çš„æ•°æ®ï¼Œå†åˆ é™¤ä¸»è¡¨ä¸­çš„æ•°æ®\n</code></pre></div><h2>12.4. DCLè¯­å¥</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºç”¨æˆ·\nmysql&gt; CREATE USER 'username'@'host' IDENTIFIED BY 'password';\n# æˆæƒ\nmysql&gt; GRANT ALL[PRIVILEGES]/SELECT/INSERT ON database_name.table_name TO 'username'@'localhost' IDENTIFIED BY 'ermazi'\n# å›æ”¶\nmysql&gt; REVOKE ALL[PRIVILEGES]/SELECT/INSERT ON database_name.table_name FROM 'username'@'localhost'\n# åˆ é™¤ç”¨æˆ·\nmysql&gt; DROP USER 'username'@'host';\n</code></pre></div><h1>13. ä»‹ç»ä¸€ä¸‹MySQL binç›®å½•ä¸‹çš„å¯æ‰§è¡Œæ–‡ä»¶</h1>\n<ul>\n<li>mysqlï¼šå®¢æˆ·ç«¯ç¨‹åºï¼Œç”¨äºè¿æ¥MySQLæœåŠ¡å™¨</li>\n<li>mysqldumpï¼šæ•°æ®åº“å¤‡ä»½å·¥å…·ï¼Œç”¨äºåˆ›å»ºä¸€ä¸ªæˆ–å¤šä¸ªMySQLæ•°æ®åº“çº§åˆ«çš„SQLè½¬å‚¨æ–‡ä»¶ï¼ŒåŒ…æ‹¬æ•°æ®åº“çš„è¡¨ç»“æ„å’Œæ•°æ®ã€‚ç”¨äºæ•°æ®å¤‡ä»½ã€è¿ç§»æˆ–æ¢å¤ã€‚</li>\n<li>mysqladminï¼šç®¡ç†å·¥å…·ï¼Œç”¨æ¥æ‰§è¡Œä¸€äº›ç®¡ç†æ“ä½œï¼Œæ¯”å¦‚è¯´åˆ›å»ºæ•°æ®åº“ã€åˆ é™¤æ•°æ®åº“ã€æŸ¥çœ‹MySQLæœåŠ¡å™¨çš„çŠ¶æ€ç­‰ã€‚</li>\n<li>mysqlcheckï¼šå‘½ä»¤è¡Œå·¥å…·ï¼Œç”¨äºæ£€æŸ¥ã€ä¿®å¤ã€åˆ†æå’Œä¼˜åŒ–æ•°æ®åº“è¡¨ï¼Œå¯¹æ•°æ®åº“çš„ç»´æŠ¤å’Œæ€§èƒ½ä¼˜åŒ–éå¸¸æœ‰ç”¨ã€‚</li>\n<li>mysqlimportï¼šç”¨äºä»æ–‡æœ¬æ–‡ä»¶ä¸­å¯¼å…¥æ•°æ®åˆ°æ•°æ®åº“è¡¨ä¸­ï¼Œéå¸¸é€‚åˆç”¨äºæ‰¹é‡å¯¼å…¥æ•°æ®ã€‚</li>\n<li>mysqlshowï¼šç”¨äºæ˜¾ç¤ºMySQLæ•°æ®åº“æœåŠ¡å™¨ä¸­çš„æ•°æ®åº“ã€è¡¨ã€åˆ—ç­‰ä¿¡æ¯ã€‚</li>\n<li>mysqlbinlogï¼šç”¨äºæŸ¥çœ‹MySQLäºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶çš„å†…å®¹ï¼Œå¯ä»¥ç”¨äºæ¢å¤æ•°æ®ã€æŸ¥çœ‹æ•°æ®å˜æ›´ç­‰ã€‚</li>\n</ul>\n<h1>14. ç¬¬ 3-10 æ¡è®°å½•æ€ä¹ˆæŸ¥</h1>\n<ul>\n<li>limit è¯­å¥ç”¨äºé™åˆ¶æŸ¥è¯¢ç»“æœçš„æ•°é‡ï¼Œåç§»é‡è¡¨ç¤ºä»å“ªæ¡è®°å½•å¼€å§‹ï¼Œè¡Œæ•°è¡¨ç¤ºè¿”å›çš„è®°å½•æ•°é‡ã€‚</li>\n<li>SELECT * FROM table_name LIMIT 2, 8;</li>\n</ul>\n<h1>15. mysqlå‡½æ•°</h1>\n<p>å­—ç¬¦ä¸²å‡½æ•°</p>\n<ul>\n<li>\n<p>CANCAT(S1,S2,â€¦Sn) è¿æ¥ S1,S2,â€¦Sn ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œä»»ä½•å­—ç¬¦ä¸²ä¸NULLè¿æ¥çš„ç»“æœéƒ½æ˜¯NULL</p>\n</li>\n<li>\n<p>LENGTH(): è¿”å›å­—ç¬¦ä¸²çš„é•¿åº¦ã€‚</p>\n</li>\n<li>\n<p>SUBSTRING(str,x,y) è¿”å›ä»å­—ç¬¦ä¸² str x ä½ç½®èµ· y ä¸ªå­—ç¬¦é•¿åº¦çš„å­—ä¸²</p>\n</li>\n<li>\n<p>REPLACE(str,a,b) ç”¨å­—ç¬¦ä¸² b æ›¿æ¢å­—ç¬¦ä¸² str ä¸­æ‰€æœ‰å‡ºç°çš„å­—ç¬¦ä¸² a</p>\n</li>\n<li>\n<p>LOWER(str)ã€UPPER(str) å°†å­—ç¬¦ä¸² str ä¸­æ‰€æœ‰å­—ç¬¦å˜ä¸ºå°ã€å¤§å†™</p>\n</li>\n<li>\n<p>TRIM(str) å»æ‰å­—ç¬¦ä¸²è¡Œå°¾å’Œè¡Œå¤´çš„ç©ºæ ¼</p>\n</li>\n<li>\n<p>INSERT(str,x,y,instr) å°†å­—ç¬¦ä¸² str ä»ç¬¬ x ä½ç½®å¼€å§‹ï¼Œy ä¸ªå­—ç¬¦é•¿çš„å­ä¸²æ›¿æ¢ä¸ºå­—ç¬¦ä¸² instr</p>\n</li>\n<li>\n<p>LEFT(str ,x) è¿”å›å­—ç¬¦ä¸² str æœ€å·¦è¾¹çš„ x ä¸ªå­—ç¬¦ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ NULLï¼Œé‚£ä¹ˆå°†ä¸è¿”å›ä»»ä½•å­—ç¬¦ä¸²</p>\n</li>\n<li>\n<p>RIGHT(str,x) è¿”å›å­—ç¬¦ä¸² str æœ€å³è¾¹çš„ x ä¸ªå­—ç¬¦ï¼Œå¦‚æœç¬¬äºŒä¸ªå‚æ•°æ˜¯ NULLï¼Œé‚£ä¹ˆå°†ä¸è¿”å›ä»»ä½•å­—ç¬¦ä¸²</p>\n</li>\n<li>\n<p>LPAD(str,n,pad) ç”¨å­—ç¬¦ä¸² pad å¯¹ str æœ€å·¦è¾¹è¿›è¡Œå¡«å……ï¼Œç›´åˆ°é•¿åº¦ä¸º n ä¸ªå­—ç¬¦é•¿åº¦</p>\n</li>\n<li>\n<p>RPAD(str,n,pad) ç”¨å­—ç¬¦ä¸² pad å¯¹ str æœ€å³è¾¹è¿›è¡Œå¡«å……ï¼Œç›´åˆ°é•¿åº¦ä¸º n ä¸ªå­—ç¬¦é•¿åº¦</p>\n</li>\n<li>\n<p>REPEAT(str,x) è¿”å› str é‡å¤ x æ¬¡çš„ç»“æœ</p>\n</li>\n<li>\n<p>STRCMP(s1,s2)å‡½æ•°ï¼šæ¯”è¾ƒå­—ç¬¦ä¸² s1 å’Œ s2 çš„ ASCII ç å€¼çš„å¤§å°</p>\n</li>\n</ul>\n<p>æ•°å€¼å‡½æ•°</p>\n<ul>\n<li>\n<p>ABS(x) è¿”å›xç»å¯¹å€¼</p>\n</li>\n<li>\n<p>CEIL(x) è¿”å›å¤§äºæˆ–ç­‰äºç»™å®šæ•°å€¼çš„æœ€å°æ•´æ•°ã€‚</p>\n</li>\n<li>\n<p>FLOOR(x) è¿”å›å°äºæˆ–ç­‰äºç»™å®šæ•°å€¼çš„æœ€å¤§æ•´æ•°ã€‚</p>\n</li>\n<li>\n<p>ROUND(x,y) è¿”å›xå››èˆäº”å…¥æœ‰yä½å°æ•°çš„å€¼ã€‚å¦‚æœæ˜¯æ•´æ•°ï¼Œå°†ä¼šä¿ç•™yä½æ•°é‡çš„0ï¼›å¦‚æœä¸å†™yï¼Œåˆ™é»˜è®¤yä¸º0ï¼Œå³å°†xå››èˆäº”å…¥åå–æ•´ã€‚é€‚åˆäºå°†æ‰€æœ‰æ•°å­—ä¿ç•™åŒæ ·å°æ•°ä½çš„æƒ…å†µ</p>\n</li>\n<li>\n<p>MOD(xï¼Œy) è¿”å›x/yçš„æ¨¡</p>\n</li>\n<li>\n<p>RAND() è¿”å›0åˆ°1å†…éšæœºå€¼ äº§ç”Ÿ0ï½100éšæœºæ•´æ•° ceil(100*rand())</p>\n</li>\n<li>\n<p>TRUNCATE(x,y) è¿”å›æ•°å­—xæˆªæ–­ä¸ºyä½å°æ•°çš„ç»“æœï¼Œä¸è¿›è¡Œå››èˆäº”å…¥</p>\n</li>\n<li>\n<p>BIT_OR()ã€BIT_AND()é…åˆGROUP BYé™ä½å­˜å‚¨é‡ï¼Œæé«˜ç»Ÿè®¡æŸ¥è¯¢æ•ˆç‡ã€‚ç»Ÿè®¡æ•°å­—å­—æ®µçš„æƒ…å†µï¼Œæ¯”å¦‚ä½¿ç”¨åè¿›åˆ¶æ•°å­—å­˜å‚¨æŸä¸ªäººè´­ä¹°è¿‡çš„å•†å“ï¼Œæ¯ä¸€ä½çš„1è¡¨ç¤ºè´­ä¹°äº†æŸç§å•†å“ï¼Œ0è¡¨ç¤ºæ²¡è´­ä¹°ï¼Œåˆ™å¯ä»¥ä½¿ç”¨BIT_ORè¡¨ç¤ºå®¢æˆ·è´­ä¹°è¿‡å“ªäº›å•†å“ï¼ŒBIT_ANDè¡¨ç¤ºå®¢æˆ·æ¯æ¬¡éƒ½æ¥ä¹°çš„å•†å“</p>\n</li>\n</ul>\n<p>æ—¥æœŸå’Œæ—¶é—´å‡½æ•°</p>\n<ul>\n<li>\n<p>NOW() è¿”å›å½“å‰æ—¥æœŸå’Œæ—¶é—´ï¼Œå¹´æœˆæ—¥æ—¶åˆ†ç§’</p>\n</li>\n<li>\n<p>CURDATE() è¿”å›å½“å‰æ—¥æœŸï¼Œå¹´æœˆæ—¥</p>\n</li>\n<li>\n<p>CURTIME() è¿”å›å½“å‰æ—¶é—´ï¼Œæ—¶åˆ†ç§’</p>\n</li>\n<li>\n<p>DATE_ADD(date,INTERVAL expr type) å’Œ DATE_SUB()è¿”å›ä¸€ä¸ªæ—¥æœŸæˆ–æ—¶é—´å€¼åŠ ä¸Šã€å‡å»ä¸€ä¸ªæ—¶é—´é—´éš”çš„æ—¶é—´å€¼</p>\n<ul>\n<li>HOUR å°æ—¶ hh</li>\n<li>MINUTE åˆ† mm</li>\n<li>SECOND ç§’ ss</li>\n<li>YEAR å¹´ YY</li>\n<li>MONTH æœˆ MM</li>\n<li>DAY æ—¥ DD</li>\n<li>YEAR_MONTH å¹´å’Œæœˆ YY-MM</li>\n<li>DAY_HOUR æ—¥å’Œå°æ—¶ DD hh</li>\n<li>DAY_MINUTE æ—¥å’Œåˆ†é’Ÿ DD hh:mm</li>\n<li>DAY_ SECOND æ—¥å’Œç§’ DD hh:mm:ss</li>\n<li>HOUR_MINUTE å°æ—¶å’Œåˆ† hh:mm</li>\n<li>HOUR_SECOND å°æ—¶å’Œç§’ hh:ss</li>\n<li>MINUTE_SECOND åˆ†é’Ÿå’Œç§’ mm:ss</li>\n</ul>\n</li>\n<li>\n<p>DATEDIFF(expr,expr2) è¿”å›èµ·å§‹æ—¶é—´ expr å’Œç»“æŸæ—¶é—´ expr2 ä¹‹é—´çš„å¤©æ•°</p>\n</li>\n<li>\n<p>UNIX_TIMESTAMP(date) è¿”å›æ—¥æœŸdateçš„UNIXæ—¶é—´æˆ³</p>\n</li>\n<li>\n<p>FROM_UNIXTIME è¿”å› UNIX æ—¶é—´æˆ³çš„æ—¥æœŸå€¼</p>\n</li>\n<li>\n<p>WEEK(date) è¿”å›æ—¥æœŸ date ä¸ºä¸€å¹´ä¸­çš„ç¬¬å‡ å‘¨</p>\n</li>\n<li>\n<p>YEAR(date) è¿”å›æ—¥æœŸ date çš„å¹´ä»½</p>\n</li>\n<li>\n<p>HOUR(time) è¿”å› time çš„å°æ—¶å€¼</p>\n</li>\n<li>\n<p>MINUTE(time) è¿”å› time çš„åˆ†é’Ÿå€¼</p>\n</li>\n<li>\n<p>DATE_FORMAT(date,fmt) è¿”å›æŒ‰å­—ç¬¦ä¸² fmt æ ¼å¼åŒ–æ—¥æœŸ date å€¼</p>\n<ul>\n<li>%S,%s ä¸¤ä½æ•°å­—å½¢å¼çš„ç§’ï¼ˆ00,01,...,59ï¼‰</li>\n<li>%i ä¸¤ä½æ•°å­—å½¢å¼çš„åˆ†ï¼ˆ00,01,...,59ï¼‰</li>\n<li>%H ä¸¤ä½æ•°å­—å½¢å¼çš„å°æ—¶ï¼Œ24 å°æ—¶ï¼ˆ00,01,...,23ï¼‰</li>\n<li>%h,%I ä¸¤ä½æ•°å­—å½¢å¼çš„å°æ—¶ï¼Œ12 å°æ—¶ï¼ˆ01,02,...,12ï¼‰</li>\n<li>%k æ•°å­—å½¢å¼çš„å°æ—¶ï¼Œ24 å°æ—¶ï¼ˆ0,1,...,23ï¼‰</li>\n<li>%l æ•°å­—å½¢å¼çš„å°æ—¶ï¼Œ12 å°æ—¶ï¼ˆ1,2,...,12ï¼‰</li>\n<li>%T 24 å°æ—¶çš„æ—¶é—´å½¢å¼ï¼ˆhh:mm:ssï¼‰</li>\n<li>%r 12 å°æ—¶çš„æ—¶é—´å½¢å¼ï¼ˆhh:mm:ssAM æˆ– hh:mm:ssPMï¼‰</li>\n<li>%p AM æˆ– PM</li>\n<li>%W ä¸€å‘¨ä¸­æ¯ä¸€å¤©çš„åç§°ï¼ˆSunday,Monday,...,Saturdayï¼‰</li>\n<li>%a ä¸€å‘¨ä¸­æ¯ä¸€å¤©åç§°çš„ç¼©å†™ï¼ˆSun,Mon,...,Satï¼‰</li>\n<li>%d ä¸¤ä½æ•°å­—è¡¨ç¤ºæœˆä¸­çš„å¤©æ•°ï¼ˆ00,01,...,31ï¼‰</li>\n<li>%e æ•°å­—å½¢å¼è¡¨ç¤ºæœˆä¸­çš„å¤©æ•°ï¼ˆ1,2ï¼Œ...,31ï¼‰</li>\n<li>%D è‹±æ–‡åç¼€è¡¨ç¤ºæœˆä¸­çš„å¤©æ•°ï¼ˆ1st,2nd,3rd,...ï¼‰</li>\n<li>%w ä»¥æ•°å­—å½¢å¼è¡¨ç¤ºå‘¨ä¸­çš„å¤©æ•°ï¼ˆ0=Sunday,1=Monday,...,6=Saturdayï¼‰</li>\n<li>%j ä»¥ 3 ä½æ•°å­—è¡¨ç¤ºå¹´ä¸­çš„å¤©æ•°ï¼ˆ001,002,...,366ï¼‰</li>\n<li>%U å‘¨ï¼ˆ0,1,52ï¼‰ï¼Œå…¶ä¸­ Sunday ä¸ºå‘¨ä¸­çš„ç¬¬ä¸€å¤©</li>\n<li>%u å‘¨ï¼ˆ0,1,52ï¼‰ï¼Œå…¶ä¸­ Monday ä¸ºå‘¨ä¸­çš„ç¬¬ä¸€å¤©</li>\n<li>%M æœˆåï¼ˆJanuary,February,...,Decemberï¼‰</li>\n<li>%b ç¼©å†™çš„æœˆåï¼ˆJanuary,February,...,Decemberï¼‰</li>\n<li>%m ä¸¤ä½æ•°å­—è¡¨ç¤ºçš„æœˆä»½ï¼ˆ01,02,...,12ï¼‰</li>\n<li>%c æ•°å­—è¡¨ç¤ºçš„æœˆä»½ï¼ˆ1,2,...,12ï¼‰</li>\n<li>%Y 4 ä½æ•°å­—è¡¨ç¤ºçš„å¹´ä»½</li>\n<li>%y ä¸¤ä½æ•°å­—è¡¨ç¤ºçš„å¹´ä»½</li>\n<li>%% ç›´æ¥å€¼â€œ%â€</li>\n</ul>\n</li>\n</ul>\n<p>èšåˆå‡½æ•°</p>\n<ul>\n<li>SUM(): è®¡ç®—æ•°å€¼åˆ—çš„æ€»å’Œã€‚</li>\n<li>AVG(): è®¡ç®—æ•°å€¼åˆ—çš„å¹³å‡å€¼ã€‚</li>\n<li>COUNT(): è®¡ç®—æŸåˆ—çš„è¡Œæ•°ã€‚</li>\n<li>MAX() å’Œ MIN(): åˆ†åˆ«è¿”å›åˆ—ä¸­çš„æœ€å¤§å€¼å’Œæœ€å°å€¼ã€‚</li>\n<li>GROUP_CONCAT(): å°†å¤šä¸ªè¡Œå€¼è¿æ¥ä¸ºä¸€ä¸ªå­—ç¬¦ä¸²ã€‚</li>\n</ul>\n<p>æµç¨‹å‡½æ•°</p>\n<ul>\n<li>IF(value,t f)å¦‚æœvalueæ˜¯çœŸï¼Œè¿”å›tï¼›å¦åˆ™è¿”å›f</li>\n<li>IFNULL(value1,value2) å¦‚æœvalue1ä¸ä¸ºç©ºè¿”å›value1ï¼Œå¦åˆ™è¿”å›value2</li>\n<li>CASE WHEN [value1] THEN[result1]â€¦ELSE[default]END å¦‚æœvalue1æ˜¯çœŸï¼Œè¿”å› result1ï¼Œå¦åˆ™è¿”å› default</li>\n<li>CASE [expr] WHEN [value1] THEN[result1]â€¦ELSE[default]END å¦‚æœexprç­‰äºvalue1ï¼Œè¿”å›result1ï¼Œå¦åˆ™è¿”å›default</li>\n<li>COALESCE(): è¿”å›å‚æ•°åˆ—è¡¨ä¸­çš„ç¬¬ä¸€ä¸ªé NULL å€¼ã€‚</li>\n</ul>\n<p>æ ¼å¼åŒ–å‡½æ•°</p>\n<ul>\n<li>FORMAT(): æ ¼å¼åŒ–æ•°å­—ä¸ºæ ¼å¼åŒ–çš„å­—ç¬¦ä¸²ï¼Œé€šå¸¸ç”¨äºè´§å¸æ˜¾ç¤ºã€‚SELECT FORMAT(1234567.8945, 2) AS formatted_number;</li>\n</ul>\n<p>ç±»å‹è½¬æ¢å‡½æ•°</p>\n<ul>\n<li>CAST(): å°†ä¸€ä¸ªå€¼è½¬æ¢ä¸ºæŒ‡å®šçš„æ•°æ®ç±»å‹ã€‚SELECT CAST('2024-01-01' AS DATE) AS casted_date;</li>\n<li>CONVERT(): ç±»ä¼¼äºCAST()ï¼Œç”¨äºç±»å‹è½¬æ¢ã€‚SELECT CONVERT('123', SIGNED INTEGER) AS converted_number;</li>\n</ul>\n<h1>16. SQL çš„éšå¼æ•°æ®ç±»å‹è½¬æ¢ï¼Ÿ</h1>\n<ul>\n<li>å½“ä¸åŒæ•°æ®ç±»å‹çš„å€¼è¿›è¡Œè¿ç®—æˆ–æ¯”è¾ƒæ—¶ï¼Œä¼šå‘ç”Ÿéšå¼æ•°æ®ç±»å‹è½¬æ¢ã€‚</li>\n</ul>\n<h1>17. MySQLçš„åŸºç¡€æ¶æ„</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ffe5c6730d04f821f724c.png\" alt=\"mysqlinfrastructure.png\" tabindex=\"0\"><figcaption>mysqlinfrastructure.png</figcaption></figure>\n<ul>\n<li>å®¢æˆ·ç«¯ï¼šæœ€ä¸Šå±‚çš„æœåŠ¡å¹¶ä¸æ˜¯MySQLæ‰€ç‹¬æœ‰çš„ï¼Œå¤§å¤šæ•°åŸºäºç½‘ç»œçš„å®¢æˆ·ç«¯/æœåŠ¡å™¨çš„å·¥å…·æˆ–è€…æœåŠ¡éƒ½æœ‰ç±»ä¼¼çš„æ¶æ„ã€‚æ¯”å¦‚è¿æ¥å¤„ç†ã€æˆæƒè®¤è¯ã€å®‰å…¨ç­‰ç­‰</li>\n<li>Serverå±‚ï¼šæ‰€æœ‰è·¨å­˜å‚¨å¼•æ“çš„åŠŸèƒ½éƒ½åœ¨è¿™ä¸€å±‚å®ç°ï¼Œæ¯”å¦‚å‡½æ•°ã€å­˜å‚¨è¿‡ç¨‹ã€è§¦å‘å™¨ç­‰ã€‚ä¸åŒçš„å­˜å‚¨å¼•æ“å…±ç”¨ä¸€ä¸ªServerå±‚\n<ul>\n<li>è¿æ¥å™¨ï¼šè¿æ¥å™¨è´Ÿè´£è·Ÿå®¢æˆ·ç«¯å»ºç«‹è¿æ¥ã€è·å–æƒé™ã€ç»´æŒå’Œç®¡ç†è¿æ¥ã€‚</li>\n<li>æŸ¥è¯¢ç¼“å­˜(MySQL 8.0åç§»é™¤ï¼Œå› ä¸ºè¡¨æ›´æ–°åç¼“å­˜éšæ—¶å¤±æ•ˆ) å¦‚æœä½ çš„æŸ¥è¯¢èƒ½å¤Ÿç›´æ¥åœ¨è¿™ä¸ªç¼“å­˜ä¸­æ‰¾åˆ°key(æŸ¥è¯¢çš„è¯­å¥)ï¼Œé‚£ä¹ˆè¿™ä¸ªvalue(æŸ¥è¯¢ç»“æœ)å°±ä¼šè¢«ç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ã€‚å¦‚æœè¯­å¥ä¸åœ¨æŸ¥è¯¢ç¼“å­˜ä¸­ï¼Œå°±ä¼šç»§ç»­åé¢çš„æ‰§è¡Œé˜¶æ®µã€‚æ‰§è¡Œå®Œæˆåï¼Œæ‰§è¡Œç»“æœä¼šè¢«å­˜å…¥æŸ¥è¯¢ç¼“å­˜ä¸­ã€‚</li>\n<li>åˆ†æå™¨ï¼šå…ˆä¼šåšâ€œè¯æ³•åˆ†æâ€ã€‚è¯†åˆ«å‡ºé‡Œé¢çš„å­—ç¬¦ä¸²åˆ†åˆ«æ˜¯ä»€ä¹ˆï¼Œä»£è¡¨ä»€ä¹ˆã€‚ç„¶ååšâ€œè¯­æ³•åˆ†æâ€ï¼Œåˆ¤æ–­ä½ è¾“å…¥çš„è¿™ä¸ªSQLè¯­å¥æ˜¯å¦æ»¡è¶³MySQLè¯­æ³•ã€‚</li>\n<li>ä¼˜åŒ–å™¨ï¼šåœ¨è¡¨é‡Œé¢æœ‰å¤šä¸ªç´¢å¼•çš„æ—¶å€™ï¼Œå†³å®šä½¿ç”¨å“ªä¸ªç´¢å¼•ï¼›æˆ–è€…åœ¨ä¸€ä¸ªè¯­å¥æœ‰å¤šè¡¨å…³è”ï¼ˆjoinï¼‰çš„æ—¶å€™ï¼Œå†³å®šå„ä¸ªè¡¨çš„è¿æ¥é¡ºåº</li>\n<li>æ‰§è¡Œå™¨ï¼šæ‰§è¡Œè¯­å¥ï¼Œç„¶åä»å­˜å‚¨å¼•æ“è¿”å›æ•°æ®ã€‚</li>\n</ul>\n</li>\n<li>å­˜å‚¨å¼•æ“å±‚ï¼šè´Ÿè´£æ•°æ®å­˜å‚¨å’Œæå–ã€‚æ”¯æŒInnoDB(é»˜è®¤)ã€MyISAMã€Memoryç­‰å¤šä¸ªå­˜å‚¨å¼•æ“ã€‚å¯åœ¨create tableè¯­å¥ä¸­ä½¿ç”¨engine = MyISAMæŒ‡å®šå¼•æ“.Serverå±‚é€šè¿‡APIä¸å­˜å‚¨å¼•æ“è¿›è¡Œé€šä¿¡ã€‚è¿™äº›æ¥å£å±è”½äº†ä¸åŒå­˜å‚¨å¼•æ“ä¹‹é—´çš„å·®å¼‚ï¼Œä½¿å¾—è¿™äº›å·®å¼‚å¯¹ä¸Šå±‚çš„æŸ¥è¯¢è¿‡ç¨‹é€æ˜ã€‚</li>\n</ul>\n<h1>18. ä¸€æ¡SQLæŸ¥è¯¢è¯­å¥åœ¨MySQLä¸­å¦‚ä½•æ‰§è¡Œçš„ï¼Ÿ</h1>\n<ul>\n<li>å®¢æˆ·ç«¯å‘é€ SQL æŸ¥è¯¢è¯­å¥åˆ° MySQL æœåŠ¡å™¨ã€‚</li>\n<li>è¿æ¥å™¨æ£€æŸ¥å®¢æˆ·ç«¯å¯¹è¡¨æœ‰æ²¡æœ‰æ‰§è¡ŒæŸ¥è¯¢çš„æƒé™ï¼Œæ²¡æœ‰åˆ™è¿”å›æ²¡æœ‰æƒé™çš„é”™è¯¯ï¼Œ</li>\n<li>æŸ¥è¯¢ç¼“å­˜ï¼Œå¦‚æœæœ‰ï¼Œç›´æ¥è¿”å›ç»™å®¢æˆ·ç«¯ï¼›(MySQL8.0ç‰ˆæœ¬ä»¥å‰)ã€‚</li>\n<li>åˆ†æå™¨è¿›è¡Œè¯­æ³•åˆ†æï¼Œæå–sqlè¯­å¥ä¸­selectç­‰å…³é”®å…ƒç´ ï¼Œç„¶ååˆ¤æ–­sqlè¯­å¥æ˜¯å¦æœ‰è¯­æ³•é”™è¯¯ï¼Œæ¯”å¦‚å…³é”®è¯æ˜¯å¦æ­£ç¡®ç­‰ç­‰ã€‚</li>\n<li>ä¼˜åŒ–å™¨å¯¹æŸ¥è¯¢çš„è¯­å¥è¿›è¡Œä¼˜åŒ–ï¼Œç¡®å®š SQL è¯­å¥çš„æ‰§è¡Œè®¡åˆ’ã€‚ç¡®å®šä½¿ç”¨çš„ç´¢å¼•ç­‰</li>\n<li>æ‰§è¡Œå™¨æŒ‰ç…§ç”Ÿæˆçš„æ‰§è¡Œè®¡åˆ’è°ƒç”¨æ•°æ®åº“å¼•æ“æ¥å£ï¼Œå–è¿™ä¸ªè¡¨çš„æ¯ä¸€è¡Œï¼Œåˆ¤æ–­IDå€¼æ˜¯ä¸æ˜¯10ï¼Œå¦‚æœä¸æ˜¯åˆ™è·³è¿‡ï¼Œå¦‚æœæ˜¯åˆ™å°†è¿™è¡Œå­˜åœ¨ç»“æœé›†ä¸­ï¼Œç›´åˆ°å–åˆ°è¿™ä¸ªè¡¨çš„æœ€åä¸€è¡Œï¼Œè¿”å›æ‰§è¡Œç»“æœã€‚</li>\n</ul>\n<h1>19. MySQLæœ‰å“ªäº›å¸¸è§å­˜å‚¨å¼•æ“ï¼Ÿ</h1>\n<ul>\n<li>mysql5.5åé»˜è®¤å­˜å‚¨å¼•æ“æ”¹ä¸ºinnodbï¼Œ5.6InnoDBæ”¯æŒå…¨æ–‡ç´¢å¼•ã€‚</li>\n<li>InnoDBæ”¯æŒäº‹åŠ¡ã€å…¨æ–‡ç´¢å¼•ã€B+æ ‘ç´¢å¼•ã€å“ˆå¸Œç´¢å¼•ï¼ˆè‡ªé€‚åº”ï¼Œä¸èƒ½äººä¸ºå¹²é¢„ï¼‰ã€å¤–é”®</li>\n<li>MyISAMæ”¯æŒå…¨æ–‡ç´¢å¼•ã€B+æ ‘ç´¢å¼•</li>\n<li>MEMORYæ”¯æŒB+æ ‘ç´¢å¼•ã€å“ˆå¸Œç´¢å¼•</li>\n</ul>\n<h1>20. å­˜å‚¨å¼•æ“åº”è¯¥æ€ä¹ˆé€‰æ‹©ï¼Ÿ</h1>\n<ul>\n<li>é¦–é€‰InnoDBï¼šéœ€è¦æ”¯æŒäº‹åŠ¡ï¼Œå¹¶å‘æ§åˆ¶(åœ¨å¹¶å‘æ¡ä»¶ä¸‹è¦æ±‚æ•°æ®çš„ä¸€è‡´æ€§)ï¼Œå¤–é”®ï¼Œå´©æºƒæ¢å¤ï¼Œæ•°æ®æ“ä½œé™¤äº†æ’å…¥å’ŒæŸ¥è¯¢ä»¥å¤–ï¼Œè¿˜åŒ…æ‹¬å¾ˆå¤šçš„æ›´æ–°ã€åˆ é™¤æ“ä½œã€‚é€‚åˆç±»ä¼¼è®¡è´¹ç³»ç»Ÿæˆ–è€…è´¢åŠ¡ç³»ç»Ÿç­‰å¯¹æ•°æ®å‡†ç¡®æ€§è¦æ±‚æ¯”è¾ƒé«˜çš„ç³»ç»Ÿ</li>\n<li>é€‰æ‹©MyISAMï¼šå¦‚æœæ•°æ®è¡¨ä¸»è¦ç”¨æ¥æ’å…¥å’ŒæŸ¥è¯¢è®°å½•ï¼Œåªæœ‰å¾ˆå°‘çš„æ›´æ–°å’Œåˆ é™¤æ“ä½œï¼Œå¹¶ä¸”å¯¹äº‹åŠ¡çš„å®Œæ•´æ€§ã€å¹¶å‘æ€§è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œåœ¨Webã€æ•°æ®ä»“å‚¨å’Œå…¶ä»–åº”ç”¨ç¯å¢ƒä¸‹æœ€å¸¸ä½¿ç”¨çš„å­˜å‚¨å¼•æ“ä¹‹ä¸€ã€‚</li>\n<li>é€‰æ‹©MEMORYï¼šå¦‚æœåªæ˜¯ä¸´æ—¶å­˜æ”¾æ•°æ®ï¼Œéœ€è¦å¿«é€Ÿè®¿é—®ï¼Œæ•°æ®é‡ä¸å¤§ï¼Œå†…å®¹å˜åŒ–ä¸é¢‘ç¹(ä»£ç è¡¨)å¹¶ä¸”ä¸éœ€è¦è¾ƒé«˜çš„æ•°æ®å®‰å…¨æ€§ï¼Œå¯ä»¥ä½œä¸ºä¸´æ—¶è¡¨ï¼Œå­˜æ”¾æŸ¥è¯¢çš„ä¸­é—´ç»“æœã€‚éœ€è¦ä¿è¯æ•°æ®åº“å¼‚å¸¸åèƒ½æ¢å¤ã€‚ä¸”è¡¨å¤§å°æœ‰é™åˆ¶</li>\n<li>MERGEï¼šç”¨äºå°†ä¸€ç³»åˆ—ç­‰åŒçš„ MyISAM è¡¨ä»¥é€»è¾‘æ–¹å¼ç»„åˆåœ¨ä¸€èµ·ï¼Œå¹¶ä½œä¸ºä¸€ä¸ªå¯¹è±¡å¼•ç”¨å®ƒä»¬ã€‚ä¼˜ç‚¹åœ¨äºå¯ä»¥çªç ´å¯¹å•ä¸ªMyISAMè¡¨å¤§å°çš„é™åˆ¶ï¼Œå¹¶ä¸”é€šè¿‡å°†ä¸åŒçš„è¡¨åˆ†å¸ƒåœ¨å¤šä¸ªç£ç›˜ä¸Šï¼Œå¯æœ‰æ•ˆåœ°æ”¹å–„MERGEè¡¨çš„è®¿é—®æ•ˆç‡ã€‚ä¸»è¦ç”¨äºè¯¸å¦‚æ•°æ®ä»“å‚¨ç­‰VLDBç¯å¢ƒ</li>\n<li>ä½¿ç”¨å“ªä¸€ç§å¼•æ“å¯ä»¥æ ¹æ®éœ€è¦çµæ´»é€‰æ‹©ï¼Œå› ä¸ºå­˜å‚¨å¼•æ“æ˜¯åŸºäºè¡¨çš„ï¼Œæ‰€ä»¥ä¸€ä¸ªæ•°æ®åº“ä¸­å¤šä¸ªè¡¨å¯ä»¥ä½¿ç”¨ä¸åŒçš„å¼•æ“ä»¥æ»¡è¶³å„ç§æ€§èƒ½å’Œå®é™…éœ€æ±‚ã€‚ä½¿ç”¨åˆé€‚çš„å­˜å‚¨å¼•æ“å°†ä¼šæé«˜æ•´ä¸ªæ•°æ®åº“çš„æ€§èƒ½ã€‚</li>\n</ul>\n<h1>21. InnoDBå’ŒMylSAMä¸»è¦åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>å­˜å‚¨ç»“æ„\n<ul>\n<li>MyISAMï¼šç”¨ä¸‰ç§æ ¼å¼çš„æ–‡ä»¶æ¥å­˜å‚¨ï¼Œ.frm æ–‡ä»¶å­˜å‚¨è¡¨çš„å®šä¹‰ï¼›.MYD å­˜å‚¨æ•°æ®ï¼›.MYI å­˜å‚¨ç´¢å¼•ã€‚</li>\n<li>InnoDBï¼šç”¨ä¸¤ç§æ ¼å¼çš„æ–‡ä»¶æ¥å­˜å‚¨ï¼Œ.frm æ–‡ä»¶å­˜å‚¨è¡¨çš„å®šä¹‰ï¼›.ibd å­˜å‚¨æ•°æ®å’Œç´¢å¼•ã€‚</li>\n</ul>\n</li>\n<li>äº‹åŠ¡æ”¯æŒï¼šMyISAMä¸æ”¯æŒäº‹åŠ¡ï¼›InnoDBæ”¯æŒäº‹åŠ¡</li>\n<li>æœ€å°é”ç²’åº¦ï¼šMyISAMåªæ”¯æŒè¡¨çº§é”ï¼Œé«˜å¹¶å‘ä¸­å†™æ“ä½œå­˜åœ¨æ€§èƒ½ç“¶é¢ˆï¼›InnoDBæ”¯æŒè¡Œçº§é”ã€‚å¹¶å‘å†™å…¥æ€§èƒ½é«˜ï¼ˆå‘½ä¸­ç´¢å¼•æ—¶ï¼‰</li>\n<li>ç´¢å¼•ç±»å‹ï¼š\n<ul>\n<li>MyISAMçš„ç´¢å¼•ä¸ºéèšç°‡ç´¢å¼•ï¼Œæ•°æ®ç»“æ„æ˜¯Bæ ‘ï¼Œç´¢å¼•å’Œæ•°æ®åˆ†å¼€å­˜å‚¨ï¼Œç´¢å¼•ä¿å­˜çš„æ˜¯æ•°æ®æ–‡ä»¶çš„æŒ‡é’ˆï¼›</li>\n<li>InnoDBçš„ç´¢å¼•æ˜¯èšç°‡ç´¢å¼•ï¼Œç´¢å¼•å’Œæ•°æ®ä¸åˆ†å¼€ã€‚æ•°æ®ç»“æ„æ˜¯B+æ ‘ã€‚</li>\n</ul>\n</li>\n<li>ä¸»é”®å¿…éœ€ï¼šMyISAMè¡¨å¯ä»¥æ²¡æœ‰ä¸»é”®ï¼›InnoDBå¦‚æœæ²¡æœ‰è®¾å®šä¸»é”®æˆ–è€…éç©ºå”¯ä¸€ç´¢å¼•ï¼Œ<strong>å°±ä¼šè‡ªåŠ¨ç”Ÿæˆä¸€ä¸ª6å­—èŠ‚çš„ä¸»é”®(ç”¨æˆ·ä¸å¯è§)</strong>ï¼Œæ•°æ®æ˜¯ä¸»ç´¢å¼•çš„ä¸€éƒ¨åˆ†ï¼Œé™„åŠ ç´¢å¼•ä¿å­˜çš„æ˜¯ä¸»ç´¢å¼•çš„å€¼ã€‚</li>\n<li>è¡¨çš„å…·ä½“è¡Œæ•°ï¼šMyISAMä¿å­˜äº†è¡¨çš„æ€»è¡Œæ•°;InnoDBæ²¡æœ‰ä¿å­˜è¡¨çš„æ€»è¡Œæ•°</li>\n<li>å¤–é”®æ”¯æŒï¼šMyISAMä¸æ”¯æŒå¤–é”®ï¼›InnoDBæ”¯æŒå¤–é”®ã€‚å¤–é”®å¯¹äºç»´æŠ¤æ•°æ®ä¸€è‡´æ€§éå¸¸æœ‰å¸®åŠ©ï¼Œä½†æ˜¯å¯¹æ€§èƒ½æœ‰ä¸€å®šçš„æŸè€—ã€‚å› æ­¤ï¼Œé€šå¸¸æƒ…å†µä¸‹ï¼Œä¸å»ºè®®åœ¨å®é™…ç”Ÿäº§é¡¹ç›®ä¸­ä½¿ç”¨å¤–é”®ï¼Œåœ¨ä¸šåŠ¡ä»£ç ä¸­è¿›è¡Œçº¦æŸå³å¯ï¼</li>\n<li>MyISAM ä¸æ”¯æŒæ•°æ®åº“å¼‚å¸¸å´©æºƒåçš„å®‰å…¨æ¢å¤ï¼ŒInnoDBæ”¯æŒã€‚ä¾èµ–äº redo log</li>\n<li>MyISAM ä¸æ”¯æŒMVCCï¼ŒInnoDBæ”¯æŒMVCCï¼ŒMVCCå¯ä»¥çœ‹ä½œæ˜¯è¡Œçº§é”çš„ä¸€ä¸ªå‡çº§ï¼Œå¯ä»¥æœ‰æ•ˆå‡å°‘åŠ é”æ“ä½œï¼Œæé«˜æ€§èƒ½ã€‚</li>\n</ul>\n<h1>22. MySQLæ—¥å¿—æ–‡ä»¶åŠä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>\n<p>é”™è¯¯æ—¥å¿—ï¼ˆerrorlogï¼‰ï¼šè®°å½•äº†å½“mysqlå¯åŠ¨ã€åœæ­¢ã€è¿è¡Œè¿‡ç¨‹ä¸­å‘ç”Ÿä»»ä½•ä¸¥é‡é”™è¯¯æ—¶çš„ä¿¡æ¯</p>\n</li>\n<li>\n<p>æ…¢æŸ¥è¯¢æ—¥å¿—ï¼ˆslowquerylogï¼‰ï¼šè®°å½•æ‰§è¡Œæ—¶é—´è¶…è¿‡long_query_timeå€¼çš„æŸ¥è¯¢è¯­å¥</p>\n</li>\n<li>\n<p>ä¸€èˆ¬æŸ¥è¯¢æ—¥å¿—ï¼ˆgenerallogï¼‰è®°å½•äº†æ‰€æœ‰å¯¹MySQLæ•°æ®åº“è¯·æ±‚çš„ä¿¡æ¯ï¼Œå¯¹äºè®¿é—®é¢‘ç¹çš„ç³»ç»Ÿï¼Œä¸å»ºè®®å¼€å¯</p>\n</li>\n<li>\n<p>äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆbinlogï¼‰ï¼šè®°å½•äº†æ•°æ®åº“æ‰€æœ‰æ‰§è¡Œçš„DDLå’ŒDMLè¯­å¥ï¼ˆé™¤äº†æ•°æ®æŸ¥è¯¢è¯­å¥selectã€showç­‰ï¼‰ï¼Œç”¨äºæ•°æ®æ¢å¤</p>\n</li>\n<li>\n<p>é‡åšæ—¥å¿—ï¼ˆredologï¼‰ï¼šè®°å½•å¯¹äºInnoDBè¡¨çš„æ¯ä¸ªå†™æ“ä½œï¼Œæ˜¯ç‰©ç†çº§åˆ«çš„ï¼Œä¸»è¦ç”¨äºå´©æºƒæ¢å¤(InnoDBç‹¬æœ‰)</p>\n</li>\n<li>\n<p>å›æ»šæ—¥å¿—ï¼ˆundologï¼‰ï¼šè®°å½•æ•°æ®è¢«ä¿®æ”¹å‰çš„å€¼ï¼Œç”¨äºäº‹åŠ¡çš„å›æ»š(InnoDBç‹¬æœ‰)</p>\n</li>\n<li>\n<p>binlog æ˜¯ä¸€ç§ç‰©ç†æ—¥å¿—ï¼Œä¼šåœ¨ç£ç›˜ä¸Šè®°å½•ä¸‹æ•°æ®åº“çš„æ‰€æœ‰ä¿®æ”¹æ“ä½œï¼Œä»¥ä¾¿è¿›è¡Œæ•°æ®æ¢å¤å’Œä¸»ä»å¤åˆ¶ã€‚</p>\n<ul>\n<li>å½“å‘ç”Ÿæ•°æ®ä¸¢å¤±æ—¶ï¼Œbinlog å¯ä»¥å°†æ•°æ®åº“æ¢å¤åˆ°ç‰¹å®šçš„æ—¶é—´ç‚¹ã€‚</li>\n<li>ä¸»æœåŠ¡å™¨ï¼ˆmasterï¼‰ä¸Šçš„äºŒè¿›åˆ¶æ—¥å¿—å¯ä»¥è¢«ä»æœåŠ¡å™¨ï¼ˆslaveï¼‰è¯»å–ï¼Œä»è€Œå®ç°æ•°æ®åŒæ­¥ã€‚</li>\n</ul>\n</li>\n<li>\n<p>binlog åŒ…æ‹¬ä¸¤ç±»æ–‡ä»¶ï¼šäºŒè¿›åˆ¶ç´¢å¼•æ–‡ä»¶ï¼ˆ.indexï¼‰ã€äºŒè¿›åˆ¶æ—¥å¿—æ–‡ä»¶ï¼ˆ.00000*ï¼‰</p>\n</li>\n<li>\n<p>binlog é»˜è®¤ä¸å¯ç”¨ã€‚éœ€è¦åœ¨é…ç½®æ–‡ä»¶ï¼ˆmy.cnf æˆ– my.iniï¼‰ä¸­è®¾ç½® log_bin å‚æ•°ã€‚show variables like '%log_bin%'; æŸ¥çœ‹ binlog æ˜¯å¦å¼€å¯ã€‚</p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>log_bin = mysql-bin #å¼€å¯binlog MySQLæ•°æ®ç›®å½•ç”Ÿæˆ db-bin.000001ã€db-bin.000002 ç­‰æ—¥å¿—æ–‡ä»¶ã€‚\n\n#mysql-bin.*æ—¥å¿—æ–‡ä»¶æœ€å¤§å­—èŠ‚ï¼ˆå•ä½ï¼šå­—èŠ‚ï¼‰\n#è®¾ç½®æœ€å¤§100MB å½“ binlog æ–‡ä»¶è¾¾åˆ°è¿™ä¸ªå¤§å°æ—¶ï¼ŒMySQL ä¼šå…³é—­å½“å‰æ–‡ä»¶å¹¶åˆ›å»ºä¸€ä¸ªæ–°çš„ binlog æ–‡ä»¶ã€‚\nmax_binlog_size=104857600\n\n#è®¾ç½®äº†åªä¿ç•™7å¤©BINLOGï¼ˆå•ä½ï¼šå¤©ï¼‰è¿‡æœŸçš„ binlog æ–‡ä»¶å°†è¢«è‡ªåŠ¨åˆ é™¤ã€‚é˜²æ­¢é•¿æ—¶é—´ç´¯ç§¯çš„binlogæ–‡ä»¶å ç”¨è¿‡å¤šå­˜å‚¨ç©ºé—´\nexpire_logs_days = 7\n\n#binlogæ—¥å¿—åªè®°å½•æŒ‡å®šåº“çš„æ›´æ–°\n#binlog-do-db=db_name\n\n#binlogæ—¥å¿—ä¸è®°å½•æŒ‡å®šåº“çš„æ›´æ–°\n#binlog-ignore-db=db_name\n\n#å†™ç¼“å†²å¤šå°‘æ¬¡ï¼Œåˆ·ä¸€æ¬¡ç£ç›˜ï¼Œé»˜è®¤0 è¡¨ç¤º MySQL ä¸ä¼šä¸»åŠ¨è§¦å‘åŒæ­¥æ“ä½œï¼Œè€Œæ˜¯ä¾èµ–æ“ä½œç³»ç»Ÿçš„ç£ç›˜ç¼“å­˜ç­–ç•¥ã€‚å³å½“æ‰§è¡Œå†™æ“ä½œæ—¶ï¼Œæ•°æ®ä¼šå…ˆå†™å…¥æ“ä½œç³»ç»Ÿçš„ç¼“å­˜ï¼Œå½“ç¼“å­˜åŒºæ»¡äº†å†ç”±æ“ä½œç³»ç»Ÿå°†æ•°æ®å†™å…¥ç£ç›˜ã€‚è®¾ç½®ä¸º 1 æ¯æ¬¡ binlog å†™æ“ä½œåéƒ½ä¼šåŒæ­¥åˆ°ç£ç›˜ï¼Œè¿™å¯ä»¥æé«˜æ•°æ®å®‰å…¨æ€§ï¼Œä½†å¯èƒ½ä¼šå¯¹æ€§èƒ½äº§ç”Ÿå½±å“ã€‚\n\nsync_binlog=0\n</code></pre></div><h1>23. binlogå’Œredologæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>binlogä¼šè®°å½•æ‰€æœ‰ä¸æ•°æ®åº“æœ‰å…³çš„æ—¥å¿—è®°å½•ï¼ŒåŒ…æ‹¬InnoDBã€MyISAMç­‰å­˜å‚¨å¼•æ“çš„æ—¥å¿—ï¼Œè€Œredologåªè®°InnoDBå­˜å‚¨å¼•æ“çš„æ—¥å¿—</li>\n<li>è®°å½•çš„å†…å®¹ä¸åŒï¼Œbinlogè®°å½•äº‹åŠ¡çš„å…·ä½“æ“ä½œå†…å®¹ï¼Œæ˜¯é€»è¾‘æ—¥å¿—ã€‚redologè®°å½•æ¯ä¸ªé¡µï¼ˆPageï¼‰çš„æ›´æ”¹çš„ç‰©ç†æƒ…å†µ</li>\n<li>å†™å…¥çš„æ—¶é—´ä¸åŒï¼Œbinlogä»…åœ¨äº‹åŠ¡æäº¤å‰è¿›è¡Œæäº¤ï¼Œä¹Ÿå°±æ˜¯åªå†™ç£ç›˜ä¸€æ¬¡ã€‚è€Œåœ¨äº‹åŠ¡è¿›è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œå´ä¸æ–­æœ‰redoertryè¢«å†™å…¥redologä¸­</li>\n<li>å†™å…¥çš„æ–¹å¼ä¹Ÿä¸ç›¸åŒï¼Œbinlogæ˜¯è¿½åŠ å†™å…¥ï¼Œä¸ä¼šè¦†ç›–å·²ç»å†™çš„æ–‡ä»¶ã€‚redologæ˜¯å¾ªç¯å†™å…¥å’Œæ“¦é™¤ï¼Œ</li>\n</ul>\n<h1>24. ä¸€æ¡æ›´æ–°è¯­å¥æ€ä¹ˆæ‰§è¡Œçš„äº†è§£å—ï¼Ÿ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6bea766b8e9e8609d05ff.png\" alt=\"mysqlexecuteupdate.jpg\" tabindex=\"0\"><figcaption>mysqlexecuteupdate.jpg</figcaption></figure>\n<ul>\n<li>æ‰§è¡Œå™¨å…ˆæ‰¾å¼•æ“è·å–ID=2è¿™ä¸€è¡Œã€‚IDæ˜¯ä¸»é”®ï¼Œå­˜å‚¨å¼•æ“æ£€ç´¢æ•°æ®ï¼Œæ‰¾åˆ°è¿™ä¸€è¡Œã€‚å¦‚æœID=2è¿™ä¸€è¡Œæ‰€åœ¨çš„æ•°æ®é¡µæœ¬æ¥å°±åœ¨å†…å­˜ä¸­ï¼Œå°±ç›´æ¥è¿”å›ç»™æ‰§è¡Œå™¨ï¼›å¦åˆ™ï¼Œéœ€è¦å…ˆä»ç£ç›˜è¯»å…¥å†…å­˜ï¼Œç„¶åå†è¿”å›ã€‚</li>\n<li>æ‰§è¡Œå™¨æ‹¿åˆ°å¼•æ“ç»™çš„è¡Œæ•°æ®ï¼ŒæŠŠè¿™ä¸ªå€¼åŠ ä¸Š1ï¼Œæ¯”å¦‚åŸæ¥æ˜¯Nï¼Œç°åœ¨å°±æ˜¯N+1ï¼Œå¾—åˆ°æ–°çš„ä¸€è¡Œæ•°æ®ï¼Œå†è°ƒç”¨å¼•æ“æ¥å£å†™å…¥è¿™è¡Œæ–°æ•°æ®ã€‚- å¼•æ“å°†è¿™è¡Œæ–°æ•°æ®æ›´æ–°åˆ°å†…å­˜ä¸­ï¼ŒåŒæ—¶å°†è¿™ä¸ªæ›´æ–°æ“ä½œè®°å½•åˆ°redologé‡Œé¢ï¼Œæ­¤æ—¶redologå¤„äºprepareçŠ¶æ€ã€‚ç„¶åå‘ŠçŸ¥æ‰§è¡Œå™¨æ‰§è¡Œå®Œæˆäº†ï¼Œéšæ—¶å¯ä»¥æäº¤äº‹åŠ¡ã€‚</li>\n<li>æ‰§è¡Œå™¨ç”Ÿæˆè¿™ä¸ªæ“ä½œçš„binlogï¼Œå¹¶æŠŠbinlogå†™å…¥ç£ç›˜ã€‚</li>\n<li>æ‰§è¡Œå™¨è°ƒç”¨å¼•æ“çš„æäº¤äº‹åŠ¡æ¥å£ï¼Œå¼•æ“æŠŠåˆšåˆšå†™å…¥çš„redologæ”¹æˆæäº¤ï¼ˆcommitï¼‰çŠ¶æ€ï¼Œæ›´æ–°å®Œæˆã€‚</li>\n<li>MySQLåœ¨æ‰§è¡Œæ›´æ–°è¯­å¥çš„æ—¶å€™ï¼Œåœ¨æœåŠ¡å±‚è¿›è¡Œè¯­å¥çš„è§£æå’Œæ‰§è¡Œï¼Œåœ¨å¼•æ“å±‚è¿›è¡Œæ•°æ®çš„æå–å’Œå­˜å‚¨ï¼›åŒæ—¶åœ¨æœåŠ¡å±‚å¯¹binlogè¿›è¡Œå†™å…¥ï¼Œåœ¨InnoDBå†…è¿›è¡Œredologçš„å†™å…¥ã€‚</li>\n<li>åœ¨å¯¹redologå†™å…¥æ—¶æœ‰ä¸¤ä¸ªé˜¶æ®µçš„æäº¤ï¼Œä¸€æ˜¯binlogå†™å…¥ä¹‹å‰prepareçŠ¶æ€çš„å†™å…¥ï¼ŒäºŒæ˜¯binlogå†™å…¥ä¹‹åcommitçŠ¶æ€çš„å†™å…¥</li>\n</ul>\n<h1>25. ä¸ºä»€ä¹ˆè¦ä¸¤é˜¶æ®µæäº¤å‘¢ï¼Ÿ</h1>\n<ul>\n<li>å‡è®¾ä¸é‡‡ç”¨ä¸¤é˜¶æ®µæäº¤çš„æ–¹å¼ï¼Œè€Œæ˜¯é‡‡ç”¨â€œå•é˜¶æ®µâ€è¿›è¡Œæäº¤ï¼Œå³è¦ä¹ˆå…ˆå†™å…¥redologï¼Œåå†™å…¥binlogï¼›è¦ä¹ˆå…ˆå†™å…¥binlogï¼Œåå†™å…¥redologã€‚è¿™ä¸¤ç§æ–¹å¼çš„æäº¤éƒ½ä¼šå¯¼è‡´åŸå…ˆæ•°æ®åº“çš„çŠ¶æ€å’Œè¢«æ¢å¤åçš„æ•°æ®åº“çš„çŠ¶æ€ä¸ä¸€è‡´ã€‚</li>\n<li>å‡è®¾ID=2çš„è¡Œå­—æ®µcçš„å€¼æ˜¯0ï¼Œå†å‡è®¾æ‰§è¡Œupdate T set c=c+1 where ID=2;è¯­å¥è¿‡ç¨‹ä¸­åœ¨å†™å®Œç¬¬ä¸€ä¸ªæ—¥å¿—åï¼Œç¬¬äºŒä¸ªæ—¥å¿—è¿˜æ²¡æœ‰å†™å®ŒæœŸé—´å‘ç”Ÿäº†crashï¼Œä¼šå‡ºç°ä»€ä¹ˆæƒ…å†µå‘¢ï¼Ÿ\n<ul>\n<li>å…ˆå†™redo logåå†™binlogã€‚å‡è®¾åœ¨redo logå†™å®Œï¼ŒMySQLè¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚redo logå·²å†™ï¼Œå´©æºƒæ¢å¤ä»¥åäº‹åŠ¡ç”Ÿæ•ˆï¼Œè¿™ä¸€è¡Œcçš„å€¼æ˜¯1ã€‚è€Œç”¨è¿™ä¸ªbinlogæ¥æ¢å¤ä¸´æ—¶åº“çš„è¯ï¼Œç”±äºè¿™ä¸ªè¯­å¥çš„binlogä¸¢å¤±ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œcçš„å€¼å°±æ˜¯0ï¼Œä¸æ•°æ®åº“çš„å€¼ä¸åŒ</li>\n<li>å…ˆå†™binlogåå†™redo logã€‚å‡è®¾binlogå†™å®Œï¼ŒMySQLè¿›ç¨‹å¼‚å¸¸é‡å¯ã€‚redo logæœªå†™ï¼Œå´©æºƒæ¢å¤ä»¥åäº‹åŠ¡æ— æ•ˆï¼Œè¿™ä¸€è¡Œcçš„å€¼æ˜¯0ã€‚è€Œç”¨binlogæ¥æ¢å¤çš„æ—¶å€™å°±å¤šäº†â€œæŠŠcä»0æ”¹æˆ1â€è¿™ä¸ªæ—¥å¿—ï¼Œæ¢å¤å‡ºæ¥çš„è¿™ä¸€è¡Œcçš„å€¼å°±æ˜¯1ï¼Œä¸æ•°æ®åº“çš„å€¼ä¸ä¸€æ ·</li>\n</ul>\n</li>\n<li>ç®€å•è¯´ï¼Œredologå’Œbinlogéƒ½å¯ä»¥ç”¨äºè¡¨ç¤ºäº‹åŠ¡çš„æäº¤çŠ¶æ€ï¼Œè€Œä¸¤é˜¶æ®µæäº¤å°±æ˜¯è®©è¿™ä¸¤ä¸ªçŠ¶æ€ä¿æŒé€»è¾‘ä¸Šçš„ä¸€è‡´ã€‚</li>\n</ul>\n<h1>26. redo logæ€ä¹ˆåˆ·å…¥ç£ç›˜çš„çŸ¥é“å—ï¼Ÿ</h1>\n<ul>\n<li>redo logæ˜¯å›ºå®šå¤§å°çš„ã€‚redo logå¯ä»¥çœ‹ä½œæ˜¯ä¸€ä¸ªé€»è¾‘ä¸Šçš„loggroupï¼Œç”±ä¸€å®šæ•°é‡çš„redologblockç»„æˆã€‚å—çš„å¤§å°æ˜¯å›ºå®šçš„512å­—èŠ‚ã€‚å®ƒçš„å†™å…¥æ–¹å¼æ˜¯ä»å¤´åˆ°å°¾å¼€å§‹å†™ï¼Œå†™åˆ°æœ«å°¾åˆå›åˆ°å¼€å¤´å¾ªç¯å†™ã€‚ å…¶ä¸­æœ‰ä¸¤ä¸ªæ ‡è®°ä½ç½®ï¼šwriteposæ˜¯å½“å‰è®°å½•çš„ä½ç½®ï¼Œä¸€è¾¹å†™ä¸€è¾¹åç§»ï¼Œå†™åˆ°ç¬¬3å·æ–‡ä»¶æœ«å°¾åå°±å›åˆ°0å·æ–‡ä»¶å¼€å¤´ã€‚checkpointæ˜¯å½“å‰è¦æ“¦é™¤çš„ä½ç½®ï¼Œä¹Ÿæ˜¯å¾€åæ¨ç§»å¹¶ä¸”å¾ªç¯çš„ï¼Œæ“¦é™¤è®°å½•å‰è¦æŠŠè®°å½•æ›´æ–°åˆ°ç£ç›˜ã€‚write poså’Œcheckpoint(cp)ä¹‹é—´çš„æ˜¯ç©ºé—²éƒ¨åˆ†ï¼Œå¯ä»¥ç”¨æ¥è®°å½•æ–°çš„æ“ä½œã€‚å½“write_posè¿½ä¸Šcheckpointæ—¶ï¼Œè¡¨ç¤ºredologæ—¥å¿—å·²ç»å†™æ»¡ã€‚è¿™æ—¶å€™å°±ä¸èƒ½æ¥ç€å¾€é‡Œå†™æ•°æ®äº†ï¼Œéœ€è¦æ‰§è¡Œcheckpointè§„åˆ™è…¾å‡ºå¯å†™ç©ºé—´ã€‚æ‰€è°“çš„checkpointè§„åˆ™ï¼Œå°±æ˜¯checkpointè§¦å‘åï¼Œå°†bufferä¸­æ—¥å¿—é¡µéƒ½åˆ·åˆ°ç£ç›˜ã€‚</li>\n<li>redo logçš„å†™å…¥æœºåˆ¶ï¼šäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…ˆæŠŠæ—¥å¿—å†™åˆ°redo log bufferã€‚ ç„¶åå†™åˆ° redo log çš„æ–‡ä»¶ç³»ç»Ÿç¼“å­˜é‡Œé¢(fwrite)ï¼Œç„¶åå†åŒæ­¥åˆ°ç£ç›˜æ–‡ä»¶ï¼ˆfsyncï¼‰</li>\n<li>åœ¨å¦‚ä¸‹çš„ä¸€äº›æƒ…å†µä¸­ï¼Œredo log bufferçš„æ•°æ®ä¼šåˆ·å…¥ç£ç›˜ï¼š</li>\n<li>log bufferç©ºé—´ä¸è¶³æ—¶ï¼šå¦‚æœå½“å‰å†™å…¥redo log bufferçš„æ—¥å¿—é‡è¶…è¿‡logbufferæ€»å®¹é‡innodb_log_buffer_sizeçš„ä¸€åŠï¼Œåå°çº¿ç¨‹ä¼šä¸»åŠ¨å†™ç›˜fwriteï¼Œä¿å­˜åœ¨æ–‡ä»¶ç³»ç»Ÿçš„page cacheï¼Œä½†æ²¡æœ‰è°ƒç”¨fsync</li>\n<li>å¹¶è¡Œçš„äº‹åŠ¡æäº¤æ—¶ï¼Œé¡ºå¸¦å°†è¿™ä¸ªäº‹åŠ¡çš„redo log bufferæŒä¹…åŒ–åˆ°ç£ç›˜ã€‚å½“innodb_flush_log_at_trx_commit=1ï¼Œå‡è®¾ä¸€ä¸ªäº‹åŠ¡Aæ‰§è¡Œåˆ°ä¸€åŠï¼Œå·²ç»å†™äº†ä¸€äº›redo logåˆ°bufferä¸­ï¼Œè¿™æ—¶å€™æœ‰å¦å¤–ä¸€ä¸ªçº¿ç¨‹çš„äº‹åŠ¡Bæäº¤ï¼Œäº‹åŠ¡Bè¦æŠŠredo log bufferé‡Œçš„æ—¥å¿—å…¨éƒ¨æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚è¿™æ—¶å€™ä¼šå¸¦ä¸Šäº‹åŠ¡Aåœ¨redo log bufferé‡Œçš„æ—¥å¿—ä¸€èµ·æŒä¹…åŒ–åˆ°ç£ç›˜ã€‚</li>\n<li>åå°çº¿ç¨‹è¾“å…¥ï¼šinnodb_flush_log_at_trx_commit=2æ—¶ï¼Œæœ‰ä¸€ä¸ªåå°çº¿ç¨‹ï¼Œå¤§çº¦æ¯ç§’éƒ½ä¼šåˆ·æ–°ä¸€æ¬¡redo log bufferä¸­çš„redo logåˆ°ç£ç›˜ã€‚</li>\n<li>æ­£å¸¸å…³é—­æœåŠ¡å™¨æ—¶</li>\n<li>è§¦å‘checkpointè§„åˆ™ï¼š</li>\n</ul>\n<h1>31. ç´¢å¼•çš„åˆ†ç±»</h1>\n<ul>\n<li>åŠŸèƒ½åˆ†ç±»</li>\n<li>ä¸»é”®ç´¢å¼•: è¡¨ä¸­æ¯è¡Œæ•°æ®å”¯ä¸€æ ‡è¯†çš„ç´¢å¼•ï¼Œå¼ºè°ƒåˆ—å€¼çš„å”¯ä¸€æ€§å’Œéç©ºæ€§ã€‚ä¸€å¼ æ•°æ®è¡¨æœ‰åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®</li>\n<li>å”¯ä¸€ç´¢å¼•: ä¿è¯æ•°æ®åˆ—ä¸­æ¯è¡Œæ•°æ®çš„å”¯ä¸€æ€§ï¼Œå…è®¸æœ‰ç©ºå€¼ã€‚</li>\n<li>æ™®é€šç´¢å¼•: åŸºæœ¬çš„ç´¢å¼•ç±»å‹ï¼Œç”¨äºåŠ é€ŸæŸ¥è¯¢ã€‚å…è®¸æ•°æ®é‡å¤å’ŒNULL</li>\n<li>å…¨æ–‡ç´¢å¼•ï¼šç”¨äºæ£€ç´¢å¤§æ–‡æœ¬æ•°æ®ä¸­çš„å…³é”®å­—çš„ä¿¡æ¯ï¼Œè€Œä¸ç”¨ä½¿ç”¨ like â€˜%â€¦%â€™</li>\n<li>å¤–é”®ç´¢å¼•ï¼šåªæœ‰InnoDBç±»å‹çš„è¡¨æ‰å¯ä»¥ä½¿ç”¨å¤–é”®ç´¢å¼•ï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ã€å®Œæ•´æ€§å’Œå®ç°çº§è”æ“ä½œã€‚</li>\n<li>ä»æ•°æ®ç»“æ„ä¸Šåˆ†ç±»\n<ul>\n<li>B+æ ‘ç´¢å¼•ï¼šä¸€ç§å°†ç´¢å¼•å€¼æŒ‰ç…§ä¸€å®šçš„ç®—æ³•ï¼Œå­˜å…¥ä¸€ä¸ªæ ‘å½¢çš„æ•°æ®ç»“æ„ä¸­ï¼ˆäºŒå‰æ ‘ï¼‰ï¼Œæ¯æ¬¡æŸ¥è¯¢éƒ½ä»æ ‘çš„æ ¹èŠ‚ç‚¹å¼€å§‹ï¼Œä¸€æ¬¡éå†å¶å­èŠ‚ç‚¹ï¼Œæ‰¾åˆ°å¯¹åº”çš„å€¼ã€‚æŸ¥è¯¢æ•ˆç‡æ˜¯O(logN)ã€‚</li>\n<li>Hashç´¢å¼•ï¼šåŸºäºå“ˆå¸Œè¡¨çš„ç´¢å¼•ï¼ŒæŸ¥è¯¢æ•ˆç‡å¯ä»¥è¾¾åˆ°O(1)ï¼Œä½†æ˜¯åªé€‚åˆ=å’ŒinæŸ¥è¯¢ï¼Œä¸é€‚åˆèŒƒå›´æŸ¥è¯¢å’Œæ’åºã€‚å½“å‘ç”Ÿå“ˆå¸Œå†²çªçš„æ—¶å€™ä¹Ÿæ˜¯é€šè¿‡æ‹‰é“¾æ³•æ¥è§£å†³ã€‚InnoDBå¹¶ä¸æä¾›ç›´æ¥åˆ›å»ºå“ˆå¸Œç´¢å¼•çš„é€‰é¡¹ã€‚ä½†InnoDBä½¿ç”¨äº†ä¸€ç§åä¸ºâ€œè‡ªé€‚åº”å“ˆå¸Œç´¢å¼•â€ï¼ˆAdaptive Hash Index, AHIï¼‰çš„æŠ€æœ¯ï¼Œå¯é€šè¿‡SHOW VARIABLES LIKE 'innodb_adaptive_hash_index';æŸ¥çœ‹</li>\n</ul>\n</li>\n<li>ä»å­˜å‚¨ä½ç½®ä¸Šåˆ†ç±»ï¼š\n<ul>\n<li>èšç°‡ç´¢å¼•ï¼šèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¿å­˜äº†ä¸€è¡Œè®°å½•çš„æ‰€æœ‰åˆ—ä¿¡æ¯ã€‚èšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸­ï¼ŒåŒ…å«äº†ä¸€ä¸ªå®Œæ•´çš„è®°å½•è¡Œã€‚</li>\n<li>éèšç°‡ç´¢å¼•ï¼šå¶å­èŠ‚ç‚¹åªåŒ…å«ä¸€ä¸ªä¸»é”®å€¼ï¼Œé€šè¿‡éèšç°‡ç´¢å¼•æŸ¥æ‰¾è®°å½•è¦å…ˆæ‰¾åˆ°ä¸»é”®ï¼Œç„¶åé€šè¿‡ä¸»é”®å†åˆ°èšç°‡ç´¢å¼•ä¸­æ‰¾åˆ°å¯¹åº”çš„è®°å½•è¡Œï¼Œè¿™ä¸ªè¿‡ç¨‹è¢«ç§°ä¸ºå›è¡¨ã€‚</li>\n</ul>\n</li>\n<li>InnoDBå­˜å‚¨å¼•æ“çš„ä¸»é”®ä½¿ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ï¼ŒMyISAMå­˜å‚¨å¼•æ“ä¸ç®¡æ˜¯ä¸»é”®ç´¢å¼•ï¼Œè¿˜æ˜¯äºŒçº§ç´¢å¼•ä½¿ç”¨çš„éƒ½æ˜¯éèšç°‡ç´¢å¼•ã€‚</li>\n</ul>\n<h1>37. ä¸ºä»€ä¹ˆ InnoDB è¦ä½¿ç”¨ B+æ ‘ä½œä¸ºç´¢å¼•ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½ï¼šB+æ ‘çš„å†…éƒ¨èŠ‚ç‚¹å¹¶æ²¡æœ‰æŒ‡å‘å…³é”®å­—å…·ä½“ä¿¡æ¯çš„æŒ‡é’ˆï¼Œå› æ­¤å…¶å†…éƒ¨èŠ‚ç‚¹ç›¸å¯¹Bæ ‘æ›´å°ã€‚å¦‚æœæŠŠæ‰€æœ‰åŒä¸€å†…éƒ¨èŠ‚ç‚¹çš„å…³é”®å­—å­˜æ”¾åœ¨åŒä¸€ç›˜å—ä¸­ï¼Œé‚£ä¹ˆç›˜å—æ‰€èƒ½å®¹çº³çš„å…³é”®å­—æ•°é‡ä¹Ÿè¶Šå¤šï¼Œä¸€æ¬¡æ€§è¯»å…¥å†…å­˜çš„éœ€è¦æŸ¥æ‰¾çš„å…³é”®å­—ä¹Ÿå°±è¶Šå¤šï¼Œç›¸å¯¹IOè¯»å†™æ¬¡æ•°å°±é™ä½äº†ã€‚</p>\n</li>\n<li>\n<p>æŸ¥è¯¢æ€§èƒ½æ›´åŠ ç¨³å®šï¼šç”±äºéç»ˆç»“ç‚¹å¹¶ä¸æ˜¯æœ€ç»ˆæŒ‡å‘æ–‡ä»¶å†…å®¹çš„ç»“ç‚¹ï¼Œè€Œåªæ˜¯å¶å­ç»“ç‚¹ä¸­å…³é”®å­—çš„ç´¢å¼•ã€‚æ‰€ä»¥ä»»ä½•å…³é”®å­—çš„æŸ¥æ‰¾å¿…é¡»èµ°ä¸€æ¡ä»æ ¹ç»“ç‚¹åˆ°å¶å­ç»“ç‚¹çš„è·¯ã€‚è¿™ç§ç‰¹æ€§ä½¿å¾—æ‰€æœ‰å…³é”®å­—æŸ¥è¯¢çš„è·¯å¾„é•¿åº¦ç›¸åŒï¼Œå¯¼è‡´æ¯ä¸€ä¸ªæ•°æ®çš„æŸ¥è¯¢æ•ˆç‡ç›¸å½“ã€‚</p>\n</li>\n<li>\n<p>æ”¯æŒé«˜æ•ˆçš„èŒƒå›´æŸ¥è¯¢ï¼šB+æ ‘çš„å¶å­èŠ‚ç‚¹å­˜å‚¨äº†æ‰€æœ‰æ•°æ®è®°å½•çš„æŒ‡é’ˆï¼Œå¹¶ä¸”å½¢æˆäº†ä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼Œè¿™ä½¿å¾—èŒƒå›´æŸ¥è¯¢å˜å¾—éå¸¸é«˜æ•ˆã€‚æ•°æ®åº“ç»å¸¸éœ€è¦æŸ¥è¯¢æŸä¸ªèŒƒå›´å†…çš„æ•°æ®ï¼ŒB+æ ‘çš„ç»“æ„èƒ½å¤Ÿå¾ˆå¥½åœ°æ»¡è¶³è¿™ä¸€éœ€æ±‚ã€‚</p>\n</li>\n<li>\n<p>å‡å°‘å›è¡¨æ“ä½œï¼šB+æ ‘çš„å†…éƒ¨èŠ‚ç‚¹åªå­˜å‚¨ç´¢å¼•ä¿¡æ¯ï¼Œä¸å­˜å‚¨æ•°æ®è®°å½•çš„å…·ä½“ä¿¡æ¯ã€‚å½“æŸ¥è¯¢æ¡ä»¶èƒ½å¤Ÿå‘½ä¸­ç´¢å¼•æ—¶ï¼Œå¯ä»¥å…ˆé€šè¿‡ç´¢å¼•æ‰¾åˆ°æ•°æ®è®°å½•çš„æŒ‡é’ˆï¼Œç„¶åå†æ ¹æ®æŒ‡é’ˆåˆ°æ•°æ®é¡µä¸­æŸ¥æ‰¾å…·ä½“çš„æ•°æ®è®°å½•ã€‚è¿™ç§æ–¹å¼å¯ä»¥å‡å°‘å›è¡¨æ“ä½œï¼Œæé«˜æŸ¥è¯¢æ•ˆç‡ã€‚</p>\n</li>\n<li>\n<p>æ”¯æŒå¹¶å‘è®¿é—®ï¼šInnoDB å­˜å‚¨å¼•æ“æ”¯æŒè¡Œçº§é”å®šï¼Œè€Œ B+æ ‘çš„ç»“æ„å¯ä»¥å¾ˆæ–¹ä¾¿åœ°æ”¯æŒè¿™ç§é”å®šæ–¹å¼ã€‚å½“å¯¹æŸä¸ªæ•°æ®è®°å½•è¿›è¡Œé”å®šæ—¶ï¼Œåªéœ€è¦é”å®šè¯¥æ•°æ®è®°å½•æ‰€åœ¨çš„å¶å­èŠ‚ç‚¹å³å¯ï¼Œè¿™æ ·å¯ä»¥å‡å°‘é”å®šçš„èŒƒå›´ï¼Œæé«˜å¹¶å‘è®¿é—®çš„æ€§èƒ½ã€‚</p>\n</li>\n<li>\n<p>åœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼Œé»˜è®¤çš„é¡µå¤§å°æ˜¯16KBã€‚å¯ä»¥é€šè¿‡showvariableslike'innodb_page_size';æŸ¥çœ‹ã€‚</p>\n</li>\n<li>\n<p>Bæ ‘æ˜¯ä¸€ç§è‡ªå¹³è¡¡çš„å¤šè·¯æŸ¥æ‰¾æ ‘ï¼Œå’Œçº¢é»‘æ ‘ã€äºŒå‰å¹³è¡¡æ ‘ä¸åŒï¼ŒBæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹å¯ä»¥æœ‰mä¸ªå­èŠ‚ç‚¹ï¼Œè€Œçº¢é»‘æ ‘å’ŒäºŒå‰å¹³è¡¡æ ‘éƒ½åªæœ‰2ä¸ª</p>\n</li>\n<li>\n<p>å†…å­˜å’Œç£ç›˜åœ¨è¿›è¡ŒIOè¯»å†™çš„æ—¶å€™ï¼Œæœ‰ä¸€ä¸ªæœ€å°çš„é€»è¾‘å•å…ƒï¼Œå«åšé¡µï¼ˆPageï¼‰ï¼Œé¡µçš„å¤§å°ä¸€èˆ¬æ˜¯4KB</p>\n</li>\n<li>\n<p>ä¸ºäº†æé«˜è¯»å†™æ•ˆç‡ï¼Œä»ç£ç›˜å¾€å†…å­˜ä¸­è¯»æ•°æ®çš„æ—¶å€™ï¼Œä¸€æ¬¡ä¼šè¯»å–è‡³å°‘ä¸€é¡µçš„æ•°æ®ï¼Œæ¯”å¦‚è¯´è¯»å–2KBçš„æ•°æ®ï¼Œå®é™…ä¸Šä¼šè¯»å–4KBçš„æ•°æ®ï¼›è¯»å–5KBçš„æ•°æ®ï¼Œå®é™…ä¸Šä¼šè¯»å–8KBçš„æ•°æ®ã€‚æˆ‘ä»¬è¦å°½é‡å‡å°‘è¯»å†™çš„æ¬¡æ•°ã€‚å› ä¸ºè¯»çš„æ¬¡æ•°è¶Šå¤šï¼Œæ•ˆç‡å°±è¶Šä½ã€‚</p>\n</li>\n<li>\n<p>æ ‘è¶Šé«˜ï¼Œæ„å‘³ç€æŸ¥æ‰¾æ•°æ®æ—¶å°±éœ€è¦æ›´å¤šçš„ç£ç›˜IOï¼Œå› ä¸ºæ¯ä¸€å±‚éƒ½å¯èƒ½éœ€è¦ä»ç£ç›˜åŠ è½½æ–°çš„èŠ‚ç‚¹ã€‚Bæ ‘çš„èŠ‚ç‚¹å¤§å°é€šå¸¸ä¸é¡µçš„å¤§å°å¯¹é½ï¼Œè¿™æ ·æ¯æ¬¡ä»ç£ç›˜åŠ è½½ä¸€ä¸ªèŠ‚ç‚¹æ—¶ï¼Œå¯ä»¥æ­£å¥½æ˜¯ä¸€ä¸ªé¡µçš„å¤§å°ã€‚å› ä¸ºBæ ‘çš„èŠ‚ç‚¹å¯ä»¥æœ‰å¤šä¸ªå­èŠ‚ç‚¹ï¼Œå¯ä»¥å¡«å……æ›´å¤šçš„ä¿¡æ¯ä»¥è¾¾åˆ°ä¸€é¡µçš„å¤§å°ã€‚</p>\n</li>\n<li>\n<p>Bæ ‘çš„ä¸€ä¸ªèŠ‚ç‚¹é€šå¸¸åŒ…æ‹¬ä¸‰ä¸ªéƒ¨åˆ†ï¼šé”®å€¼ï¼šå³è¡¨ä¸­çš„ä¸»é”®ï¼›æŒ‡é’ˆï¼šå­˜å‚¨å­èŠ‚ç‚¹çš„ä¿¡æ¯ï¼›æ•°æ®ï¼šè¡¨è®°å½•ä¸­é™¤ä¸»é”®å¤–çš„æ•°æ®ã€‚æ­£æ˜¯å› ä¸ºBæ ‘çš„æ¯ä¸ªèŠ‚ç‚¹ä¸Šéƒ½å­˜äº†æ•°æ®ï¼Œå°±å¯¼è‡´æ¯ä¸ªèŠ‚ç‚¹èƒ½å­˜å‚¨çš„é”®å€¼å’ŒæŒ‡é’ˆå˜å°‘äº†ï¼Œå› ä¸ºæ¯ä¸€é¡µçš„å¤§å°æ˜¯å›ºå®šçš„ï¼Œäºæ˜¯B+æ ‘å°±æ¥äº†ï¼ŒB+æ ‘çš„éå¶å­èŠ‚ç‚¹åªå­˜å‚¨é”®å€¼ï¼Œä¸å­˜å‚¨æ•°æ®ï¼Œè€Œå¶å­èŠ‚ç‚¹å­˜å‚¨äº†æ‰€æœ‰çš„æ•°æ®ï¼Œå¹¶ä¸”æ„æˆäº†ä¸€ä¸ªæœ‰åºé“¾è¡¨ã€‚è¿™æ ·åšçš„å¥½å¤„æ˜¯ï¼Œéå¶å­èŠ‚ç‚¹ä¸Šç”±äºæ²¡æœ‰å­˜å‚¨æ•°æ®ï¼Œå°±å¯ä»¥å­˜å‚¨æ›´å¤šçš„é”®å€¼å¯¹ï¼Œæ ‘å°±å˜å¾—æ›´åŠ çŸ®ã€‚ç”±æ­¤ä¸€æ¥ï¼ŒæŸ¥æ‰¾æ•°æ®è¿›è¡Œçš„ç£ç›˜IOå°±æ›´å°‘äº†ï¼ŒæŸ¥è¯¢çš„æ•ˆç‡ä¹Ÿå°±æ›´é«˜äº†ã€‚</p>\n</li>\n<li>\n<p>å†åŠ ä¸Šå¶å­èŠ‚ç‚¹æ„æˆäº†ä¸€ä¸ªæœ‰åºé“¾è¡¨ï¼ŒèŒƒå›´æŸ¥è¯¢æ—¶å°±å¯ä»¥ç›´æ¥é€šè¿‡å¶å­èŠ‚ç‚¹é—´çš„æŒ‡é’ˆé¡ºåºè®¿é—®æ•´ä¸ªæŸ¥è¯¢èŒƒå›´å†…çš„æ‰€æœ‰è®°å½•ï¼Œè€Œæ— éœ€å¯¹æ ‘è¿›è¡Œå¤šæ¬¡éå†ã€‚</p>\n</li>\n</ul>\n<h1>38. é‚£ä¸€æ£µB+æ ‘èƒ½å­˜å‚¨å¤šå°‘æ¡æ•°æ®å‘¢ï¼Ÿ</h1>\n<ul>\n<li>InnoDB å­˜å‚¨å¼•æ“çš„æœ€å°å­˜å‚¨å•å…ƒæ˜¯é¡µï¼Œé»˜è®¤å¤§å°æ˜¯ 16kã€‚å‡è®¾ä¸»é”®IDæ˜¯bigintç±»å‹ï¼Œé•¿åº¦ä¸º8ä¸ªå­—èŠ‚ã€‚æŒ‡é’ˆå¤§å°ä¸º6å­—èŠ‚ï¼Œè¿™æ ·ä¸€å…±14å­—èŠ‚ã€‚æ‰€ä»¥éå¶å­èŠ‚ç‚¹(ä¸€é¡µ)å¯ä»¥å­˜å‚¨16384/14=1170ä¸ªè¿™æ ·çš„å•å…ƒ(é”®å€¼+æŒ‡é’ˆ)ã€‚</li>\n<li>ä¸€ä¸ªæŒ‡é’ˆæŒ‡å‘ä¸€ä¸ªå­˜æ”¾è®°å½•çš„é¡µï¼Œä¸€é¡µå¯ä»¥æ”¾16æ¡æ•°æ®ï¼Œæ ‘æ·±åº¦ä¸º2çš„æ—¶å€™ï¼Œå¯ä»¥å­˜æ”¾1170*16=18720æ¡æ•°æ®ã€‚</li>\n<li>æ ‘æ·±åº¦ä¸º3çš„æ—¶å€™ï¼Œå¯ä»¥å­˜å‚¨çš„æ•°æ®ä¸º1170<em>1170</em>16=21902400æ¡è®°å½•ã€‚</li>\n<li>ç†è®ºä¸Šï¼Œåœ¨InnoDBå­˜å‚¨å¼•æ“ä¸­ï¼ŒB+æ ‘çš„é«˜åº¦ä¸€èˆ¬ä¸º2-4å±‚ï¼Œå°±å¯ä»¥æ»¡è¶³åƒä¸‡çº§æ•°æ®çš„å­˜å‚¨ã€‚æŸ¥æ‰¾æ•°æ®çš„æ—¶å€™ï¼Œä¸€æ¬¡é¡µçš„æŸ¥æ‰¾ä»£è¡¨ä¸€æ¬¡IOï¼Œå½“æˆ‘ä»¬é€šè¿‡ä¸»é”®ç´¢å¼•æŸ¥è¯¢çš„æ—¶å€™ï¼Œæœ€å¤šåªéœ€è¦2-4æ¬¡IOå°±å¯ä»¥äº†ã€‚</li>\n</ul>\n<h1>39. ä¸ºä»€ä¹ˆè¦ç”¨B+æ ‘ï¼Œè€Œä¸ç”¨æ™®é€šäºŒå‰æ ‘ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ä¸ºä»€ä¹ˆä¸ç”¨æ™®é€šäºŒå‰æ ‘ï¼Ÿæ™®é€šäºŒå‰æ ‘å­˜åœ¨é€€åŒ–çš„æƒ…å†µï¼Œå¦‚æœå®ƒé€€åŒ–æˆé“¾è¡¨ï¼Œç›¸å½“äºå…¨è¡¨æ‰«æã€‚å¹³è¡¡äºŒå‰æ ‘ç›¸æ¯”äºäºŒå‰æŸ¥æ‰¾æ ‘æ¥è¯´ï¼ŒæŸ¥æ‰¾æ•ˆç‡æ›´ç¨³å®šï¼Œæ€»ä½“çš„æŸ¥æ‰¾é€Ÿåº¦ä¹Ÿæ›´å¿«ã€‚</p>\n</li>\n<li>\n<p>ä¸ºä»€ä¹ˆä¸ç”¨å¹³è¡¡äºŒå‰æ ‘å‘¢ï¼Ÿè¯»å–æ•°æ®çš„æ—¶å€™ï¼Œæ˜¯ä»ç£ç›˜è¯»åˆ°å†…å­˜ã€‚å¦‚æœæ ‘è¿™ç§æ•°æ®ç»“æ„ä½œä¸ºç´¢å¼•ï¼Œé‚£æ¯æŸ¥æ‰¾ä¸€æ¬¡æ•°æ®å°±éœ€è¦ä»ç£ç›˜ä¸­è¯»å–ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªç£ç›˜å—ï¼Œä½†æ˜¯å¹³è¡¡äºŒå‰æ ‘å¯æ˜¯æ¯ä¸ªèŠ‚ç‚¹åªå­˜å‚¨ä¸€ä¸ªé”®å€¼å’Œæ•°æ®çš„ï¼Œå¦‚æœæ˜¯B+æ ‘ï¼Œå¯ä»¥å­˜å‚¨æ›´å¤šçš„èŠ‚ç‚¹æ•°æ®ï¼Œæ ‘çš„é«˜åº¦ä¹Ÿä¼šé™ä½ï¼Œå› æ­¤è¯»å–ç£ç›˜çš„æ¬¡æ•°å°±é™ä¸‹æ¥å•¦ï¼ŒæŸ¥è¯¢æ•ˆç‡å°±å¿«ã€‚</p>\n</li>\n</ul>\n<h1>40. ä¸ºä»€ä¹ˆç”¨B+æ ‘è€Œä¸ç”¨Bæ ‘å‘¢ï¼Ÿâˆš</h1>\n<ul>\n<li>æ›´é«˜çš„æŸ¥è¯¢æ•ˆç‡ï¼šB+æ ‘çš„æ‰€æœ‰å€¼ï¼ˆæ•°æ®è®°å½•æˆ–æŒ‡å‘æ•°æ®è®°å½•çš„æŒ‡é’ˆï¼‰éƒ½å­˜åœ¨äºå¶å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”å¶å­èŠ‚ç‚¹ä¹‹é—´é€šè¿‡æŒ‡é’ˆè¿æ¥ï¼Œå½¢æˆä¸€ä¸ªæœ‰åºé“¾è¡¨ã€‚ä½¿å¾— B+æ ‘éå¸¸é€‚åˆè¿›è¡ŒèŒƒå›´æŸ¥è¯¢ã€‚ä¸€æ—¦åˆ°è¾¾äº†èŒƒå›´çš„å¼€å§‹ä½ç½®ï¼Œæ¥ä¸‹æ¥çš„å…ƒç´ å¯ä»¥é€šè¿‡éå†å¶å­èŠ‚ç‚¹çš„é“¾è¡¨é¡ºåºè®¿é—®ï¼Œè€Œä¸éœ€è¦å›åˆ°æ ‘çš„ä¸Šå±‚ã€‚è€Œ B æ ‘çš„æ•°æ®åˆ†å¸ƒåœ¨æ•´ä¸ªæ ‘ä¸­ï¼Œè¿›è¡ŒèŒƒå›´æŸ¥è¯¢æ—¶å¯èƒ½éœ€è¦éå†æ ‘çš„å¤šä¸ªå±‚çº§ã€‚</li>\n<li>æ›´é«˜çš„ç©ºé—´åˆ©ç”¨ç‡ï¼šåœ¨ B+æ ‘ä¸­ï¼Œéå¶å­èŠ‚ç‚¹ä¸å­˜å‚¨æ•°æ®ï¼Œåªå­˜å‚¨é”®å€¼ï¼Œè¿™æ„å‘³ç€éå¶å­èŠ‚ç‚¹å¯ä»¥æ‹¥æœ‰æ›´å¤šçš„é”®ï¼Œä»è€Œæœ‰æ›´å¤šçš„åˆ†å‰ã€‚è¿™å¯¼è‡´æ ‘çš„é«˜åº¦æ›´ä½ï¼Œè¿›ä¸€æ­¥é™ä½äº†æŸ¥è¯¢æ—¶ç£ç›˜ I/O çš„æ¬¡æ•°ï¼Œå› ä¸ºæ¯ä¸€æ¬¡ä»ä¸€ä¸ªèŠ‚ç‚¹åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹çš„è·³è½¬éƒ½å¯èƒ½æ¶‰åŠåˆ°ç£ç›˜ I/O æ“ä½œã€‚</li>\n<li>B+æ ‘çš„ç£ç›˜è¯»å†™ä»£ä»·æ›´ä½ï¼šæ ¹èŠ‚ç‚¹å’ŒæèŠ‚ç‚¹ä¸ä¿å­˜æ•°æ®åŒºï¼Œæ‰€ä»¥ä¸€ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜æ›´å¤šçš„å…³é”®å­—ï¼Œä¸€æ¬¡ç£ç›˜åŠ è½½çš„å…³é”®å­—æ›´å¤šï¼ŒIOæ¬¡æ•°æ›´å°‘ã€‚</li>\n<li>æ’åºèƒ½åŠ›æ›´å¼ºï¼šå› ä¸ºå¶å­èŠ‚ç‚¹ä¸Šæœ‰ä¸‹ä¸€ä¸ªæ•°æ®åŒºçš„æŒ‡é’ˆï¼Œæ•°æ®å½¢æˆäº†é“¾è¡¨ã€‚</li>\n<li>æŸ¥è¯¢æ•ˆç‡æ›´ç¨³å®šï¼šB+æ ‘ä¸­æ‰€æœ‰å¶å­èŠ‚ç‚¹æ·±åº¦ç›¸åŒï¼Œæ‰€æœ‰æ•°æ®æŸ¥è¯¢è·¯å¾„é•¿åº¦ç›¸ç­‰ï¼Œä¿è¯äº†æ¯æ¬¡æœç´¢çš„æ€§èƒ½ç¨³å®šæ€§ã€‚è€Œåœ¨ B æ ‘ä¸­ï¼Œæ•°æ®å¯ä»¥å­˜å‚¨åœ¨å†…éƒ¨èŠ‚ç‚¹ï¼Œä¸åŒçš„æŸ¥è¯¢å¯èƒ½éœ€è¦ä¸åŒæ·±åº¦çš„æœç´¢ã€‚</li>\n</ul>\n<h1>41. Hashç´¢å¼•å’ŒB+æ ‘ç´¢å¼•åŒºåˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>B+æ ‘å¯ä»¥è¿›è¡ŒèŒƒå›´æŸ¥è¯¢ï¼ŒHashç´¢å¼•ä¸èƒ½ã€‚</li>\n<li>B+æ ‘æ”¯æŒè”åˆç´¢å¼•çš„æœ€å·¦ä¾§åŸåˆ™ï¼ŒHashç´¢å¼•ä¸æ”¯æŒã€‚</li>\n<li>B+æ ‘æ”¯æŒorderbyæ’åºï¼ŒHashç´¢å¼•ä¸æ”¯æŒã€‚</li>\n<li>Hashç´¢å¼•åœ¨ç­‰å€¼æŸ¥è¯¢ä¸Šæ¯”B+æ ‘æ•ˆç‡æ›´é«˜ã€‚</li>\n<li>B+æ ‘ä½¿ç”¨likeè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢çš„æ—¶å€™ï¼Œlikeåé¢ï¼ˆæ¯”å¦‚%å¼€å¤´ï¼‰çš„è¯å¯ä»¥èµ·åˆ°ä¼˜åŒ–çš„ä½œç”¨ï¼ŒHashç´¢å¼•æ ¹æœ¬æ— æ³•è¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ã€‚</li>\n</ul>\n<h1>42. èšç°‡ç´¢å¼•ä¸éèšç°‡ç´¢å¼•çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>åœ¨èšç°‡ç´¢å¼•ä¸­ï¼Œç´¢å¼•ç»“æ„å’Œæ•°æ®ä¸€èµ·å­˜æ”¾ã€‚ä¸»é”®ç´¢å¼•å±äºèšé›†ç´¢å¼•ã€‚è¡¨çš„.ibdæ–‡ä»¶å°±åŒ…å«äº†è¯¥è¡¨çš„ç´¢å¼•å’Œæ•°æ®ï¼Œè¯¥è¡¨çš„ç´¢å¼•(B+æ ‘)çš„æ¯ä¸ªéå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•ï¼Œå¶å­èŠ‚ç‚¹å­˜å‚¨ç´¢å¼•å’Œç´¢å¼•å¯¹åº”çš„æ•°æ®ã€‚</li>\n<li>åœ¨éèšç°‡ç´¢å¼•ä¸­ï¼Œç´¢å¼•ç»“æ„å’Œæ•°æ®åˆ†å¼€å­˜æ”¾çš„ç´¢å¼•ã€‚éèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸ç›´æ¥åŒ…å«æ•°æ®è®°å½•ï¼Œè€Œæ˜¯åŒ…å«äº†æŒ‡å‘æ•°æ®è¡Œçš„æŒ‡é’ˆ</li>\n<li>åœ¨éèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹ä¸Šå­˜å‚¨çš„å¹¶ä¸æ˜¯çœŸæ­£çš„è¡Œæ•°æ®ï¼Œè€Œæ˜¯ä¸»é”®IDï¼Œæ‰€ä»¥å½“æˆ‘ä»¬ä½¿ç”¨éèšç°‡ç´¢å¼•è¿›è¡ŒæŸ¥è¯¢æ—¶ï¼Œé¦–å…ˆä¼šå¾—åˆ°ä¸€ä¸ªä¸»é”®IDï¼Œç„¶åå†ä½¿ç”¨ä¸»é”®IDå»èšç°‡ç´¢å¼•ä¸Šæ‰¾åˆ°çœŸæ­£çš„è¡Œæ•°æ®ï¼Œæˆ‘ä»¬æŠŠè¿™ä¸ªè¿‡ç¨‹ç§°ä¹‹ä¸ºå›è¡¨æŸ¥è¯¢ã€‚</li>\n<li>MyISAMé‡‡ç”¨çš„æ˜¯éèšç°‡ç´¢å¼•ï¼ŒInnoDBé‡‡ç”¨çš„æ˜¯èšç°‡ç´¢å¼•ã€‚</li>\n<li>èšç°‡ç´¢å¼•ç›´æ¥å°†æ•°æ®å­˜å‚¨åœ¨B+æ ‘çš„å¶å­èŠ‚ç‚¹ä¸­ï¼Œè€Œéèšç°‡ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ˜¯æŒ‡å‘æ•°æ®è¡Œçš„æŒ‡é’ˆã€‚</li>\n<li>ä¸€ä¸ªè¡¨åªèƒ½æœ‰ä¸€ä¸ªèšç°‡ç´¢å¼•ï¼Œä½†å¯ä»¥æœ‰å¤šä¸ªéèšç°‡ç´¢å¼•ã€‚</li>\n<li>èšç°‡ç´¢å¼•æ”¹å–„äº†é¡ºåºè®¿é—®çš„æ€§èƒ½ï¼Œä½†æ›´æ–°ä¸»é”®çš„æˆæœ¬è¾ƒé«˜ï¼›éèšç°‡ç´¢å¼•é€‚åˆå¿«é€Ÿæ’å…¥å’Œæ›´æ–°æ“ä½œï¼Œä½†æ£€ç´¢æ•°æ®å¯èƒ½éœ€è¦æ›´å¤šçš„ç£ç›˜I/Oã€‚</li>\n</ul>\n<h1>43. å›è¡¨äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>åœ¨InnoDBå­˜å‚¨å¼•æ“é‡Œï¼Œåˆ©ç”¨è¾…åŠ©ç´¢å¼•æŸ¥è¯¢ï¼Œå…ˆé€šè¿‡è¾…åŠ©ç´¢å¼•æ‰¾åˆ°ä¸»é”®ç´¢å¼•çš„é”®å€¼ï¼Œå†é€šè¿‡ä¸»é”®å€¼æŸ¥å‡ºä¸»é”®ç´¢å¼•é‡Œé¢æ²¡æœ‰ç¬¦åˆè¦æ±‚çš„æ•°æ®ï¼Œå®ƒæ¯”åŸºäºä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢å¤šæ‰«æäº†ä¸€æ£µç´¢å¼•æ ‘ï¼Œè¿™ä¸ªè¿‡ç¨‹å°±å«å›è¡¨ã€‚</li>\n</ul>\n<h1>44. è¦†ç›–ç´¢å¼•äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>æŸ¥è¯¢æ—¶å·²ç»åœ¨ç´¢å¼•æ ‘ä¸Šè·å¾—è¦è¿”å›çš„æ•°æ®ï¼Œæ— éœ€å›è¡¨çš„æŸ¥è¯¢ï¼Œå¯ä»¥é€šè¿‡å»ºç«‹è”åˆç´¢å¼•æ”¯æŒè¦†ç›–ç´¢å¼•ï¼Œç‰ºç‰²ç©ºé—´</li>\n</ul>\n<h1>45. ä»€ä¹ˆæ˜¯æœ€å·¦å‰ç¼€åŸåˆ™/æœ€å·¦åŒ¹é…åŸåˆ™ï¼Ÿ</h1>\n<ul>\n<li>åœ¨InnoDBçš„è”åˆç´¢å¼•ä¸­ï¼ŒæŸ¥è¯¢çš„æ—¶å€™åªæœ‰åŒ¹é…äº†å‰ä¸€ä¸ª/å·¦è¾¹çš„å€¼ä¹‹åï¼Œæ‰èƒ½åŒ¹é…ä¸‹ä¸€ä¸ªã€‚æ ¹æ®æœ€å·¦åŒ¹é…åŸåˆ™ï¼Œæœ€å·¦å‰ç¼€å¯ä»¥æ˜¯è”åˆç´¢å¼•çš„æœ€å·¦Nä¸ªå­—æ®µï¼Œä¹Ÿå¯ä»¥æ˜¯å­—ç¬¦ä¸²ç´¢å¼•çš„æœ€å·¦Mä¸ªå­—ç¬¦ã€‚ä¾‹å¦‚ï¼šç”¨ï¼ˆnameï¼Œageï¼‰è¿™ä¸ªè”åˆç´¢å¼•ï¼Œwhere name = 'å¼ ä¸‰'æˆ–è€…where name like 'å¼ %'ï¼Œ</li>\n</ul>\n<h1>46. ä»€ä¹ˆæ˜¯ç´¢å¼•ä¸‹æ¨ä¼˜åŒ–ï¼Ÿ</h1>\n<ul>\n<li>ç´¢å¼•æ¡ä»¶ä¸‹æ¨ä¼˜åŒ–ï¼ˆIndex Condition Pushdown(ICP)ï¼‰æ˜¯MySQL5.6æ·»åŠ çš„ï¼Œç”¨äºä¼˜åŒ–æ•°æ®æŸ¥è¯¢ã€‚</li>\n<li>ä¸ä½¿ç”¨ç´¢å¼•æ¡ä»¶ä¸‹æ¨ä¼˜åŒ–æ—¶å­˜å‚¨å¼•æ“é€šè¿‡ç´¢å¼•æ£€ç´¢åˆ°æ•°æ®ï¼Œç„¶åè¿”å›ç»™MySQLServerï¼ŒMySQLServerè¿›è¡Œè¿‡æ»¤æ¡ä»¶çš„åˆ¤æ–­ã€‚</li>\n<li>å½“ä½¿ç”¨ç´¢å¼•æ¡ä»¶ä¸‹æ¨ä¼˜åŒ–æ—¶ï¼Œå¦‚æœå­˜åœ¨æŸäº›è¢«ç´¢å¼•çš„åˆ—çš„åˆ¤æ–­æ¡ä»¶æ—¶ï¼ŒMySQLServerå°†è¿™ä¸€éƒ¨åˆ†åˆ¤æ–­æ¡ä»¶ä¸‹æ¨ç»™å­˜å‚¨å¼•æ“ï¼Œç„¶åç”±å­˜å‚¨å¼•æ“é€šè¿‡åˆ¤æ–­ç´¢å¼•æ˜¯å¦ç¬¦åˆMySQLServerä¼ é€’çš„æ¡ä»¶ï¼Œåªæœ‰å½“ç´¢å¼•ç¬¦åˆæ¡ä»¶æ—¶æ‰ä¼šå°†æ•°æ®æ£€ç´¢å‡ºæ¥è¿”å›ç»™MySQLæœåŠ¡å™¨</li>\n<li>ç´¢å¼•æ¡ä»¶ä¸‹æ¨ä¼˜åŒ–å¯ä»¥å‡å°‘å­˜å‚¨å¼•æ“æŸ¥è¯¢åŸºç¡€è¡¨çš„æ¬¡æ•°ï¼Œä¹Ÿå¯ä»¥å‡å°‘MySQLæœåŠ¡å™¨ä»å­˜å‚¨å¼•æ“æ¥æ”¶æ•°æ®çš„æ¬¡æ•°ã€‚</li>\n</ul>\n<h1>47. MySQLä¸­æœ‰å“ªå‡ ç§é”</h1>\n<ul>\n<li>æŒ‰é”ç²’åº¦åˆ’åˆ†\n<ul>\n<li>è¡¨é”ï¼šå¼€é”€å°ï¼ŒåŠ é”å¿«ï¼›é”å®šç²’åº¦å¤§ï¼Œå‘ç”Ÿé”å†²çªæ¦‚ç‡é«˜ï¼Œå¹¶å‘åº¦æœ€ä½;ä¸ä¼šå‡ºç°æ­»é”ã€‚</li>\n<li>è¡Œé”ï¼šå¼€é”€å¤§ï¼ŒåŠ é”æ…¢ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦å°ï¼Œå‘ç”Ÿé”å†²çªçš„æ¦‚ç‡ä½ï¼Œå¹¶å‘åº¦é«˜ã€‚</li>\n<li>é¡µé”ï¼šå¼€é”€å’ŒåŠ é”é€Ÿåº¦ä»‹äºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼›ä¼šå‡ºç°æ­»é”ï¼›é”å®šç²’åº¦ä»‹äºè¡¨é”å’Œè¡Œé”ä¹‹é—´ï¼Œå¹¶å‘åº¦ä¸€èˆ¬</li>\n</ul>\n</li>\n<li>æŒ‰ç…§å…¼å®¹æ€§\n<ul>\n<li>å…±äº«é”ï¼ˆSLockï¼‰,ä¹Ÿå«è¯»é”ï¼ˆreadlockï¼‰ï¼Œç›¸äº’ä¸é˜»å¡ã€‚</li>\n<li>æ’ä»–é”ï¼ˆXLockï¼‰ï¼Œä¹Ÿå«å†™é”ï¼ˆwritelockï¼‰ï¼Œæ’å®ƒé”æ˜¯é˜»å¡çš„ï¼Œåœ¨ä¸€å®šæ—¶é—´å†…ï¼Œåªæœ‰ä¸€ä¸ªè¯·æ±‚èƒ½æ‰§è¡Œå†™å…¥ï¼Œå¹¶é˜»æ­¢å…¶å®ƒé”è¯»å–æ­£åœ¨å†™å…¥çš„æ•°æ®ã€‚</li>\n</ul>\n</li>\n<li>æŒ‰åŠ é”æœºåˆ¶\n<ul>\n<li>ä¹è§‚é”ï¼šå‡è®¾å†²çªåœ¨ç³»ç»Ÿä¸­å‡ºç°çš„é¢‘ç‡è¾ƒä½ï¼Œå› æ­¤åœ¨æ•°æ®åº“äº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œä¸ä¼šé¢‘ç¹åœ°å»é”å®šèµ„æºã€‚ç›¸åï¼Œå®ƒåœ¨æäº¤æ›´æ–°çš„æ—¶å€™æ‰æ£€æŸ¥æ˜¯å¦æœ‰å…¶ä»–äº‹åŠ¡å·²ç»ä¿®æ”¹äº†æ•°æ®ã€‚å¯ä»¥é€šè¿‡åœ¨æ•°æ®è¡¨ä¸­ä½¿ç”¨ç‰ˆæœ¬å·ï¼ˆVersionï¼‰æˆ–æ—¶é—´æˆ³ï¼ˆTimestampï¼‰æ¥å®ç°ï¼Œæ¯æ¬¡è¯»å–è®°å½•æ—¶ï¼ŒåŒæ—¶è·å–ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³ï¼Œæ›´æ–°æ—¶æ£€æŸ¥ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³æ˜¯å¦å‘ç”Ÿå˜åŒ–ã€‚å¦‚æœæ²¡æœ‰å˜åŒ–ï¼Œåˆ™æ‰§è¡Œæ›´æ–°å¹¶å¢åŠ ç‰ˆæœ¬å·æˆ–æ›´æ–°æ—¶é—´æˆ³ï¼›å¦‚æœæ£€æµ‹åˆ°å†²çªï¼ˆå³ç‰ˆæœ¬å·æˆ–æ—¶é—´æˆ³ä¸ä¹‹å‰è¯»å–çš„ä¸åŒï¼‰ï¼Œåˆ™æ‹’ç»æ›´æ–°ã€‚</li>\n<li>æ‚²è§‚é”ï¼šå‡è®¾å†²çªæ˜¯å¸¸è§çš„ï¼Œå› æ­¤åœ¨æ•°æ®å¤„ç†è¿‡ç¨‹ä¸­ï¼Œå®ƒä¼šä¸»åŠ¨é”å®šæ•°æ®ï¼Œé˜²æ­¢å…¶ä»–äº‹åŠ¡è¿›è¡Œä¿®æ”¹ã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨æ•°æ®åº“çš„é”æœºåˆ¶ï¼Œå¦‚è¡Œé”æˆ–è¡¨é”ï¼Œæ¥é”å®šè¢«è®¿é—®çš„æ•°æ®ã€‚å¸¸è§çš„å®ç°æ˜¯ SELECT FOR UPDATE è¯­å¥ï¼Œå®ƒåœ¨è¯»å–æ•°æ®æ—¶å°±åŠ ä¸Šäº†é”ï¼Œç›´åˆ°å½“å‰äº‹åŠ¡æäº¤æˆ–å›æ»šåæ‰é‡Šæ”¾ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>48. å¦‚ä½•è§£å†³åº“å­˜è¶…å–é—®é¢˜ï¼Ÿ</h1>\n<ul>\n<li>æŒ‰ç…§ä¹è§‚é”çš„æ–¹å¼ï¼š</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>UPDATE inventory SET count = count - 1, version = version + 1 WHERE product_id = 1 AND version = current_version;\n</code></pre></div><ul>\n<li>æŒ‰ç…§æ‚²è§‚é”çš„æ–¹å¼ï¼š</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>START TRANSACTION;\nSELECT * FROM inventory WHERE product_id = 1 FOR UPDATE;\nUPDATE inventory SET count = count - 1 WHERE product_id = 1;\nCOMMIT;\n</code></pre></div><h1>49. è¯´è¯´InnoDBé‡Œçš„è¡Œé”å®ç°?</h1>\n<ul>\n<li>\n<p>RecordLockè®°å½•é”ï¼šè®°å½•é”å°±æ˜¯ç›´æ¥é”å®šæŸè¡Œè®°å½•ã€‚å½“ä½¿ç”¨å”¯ä¸€æ€§çš„ç´¢å¼•(åŒ…æ‹¬å”¯ä¸€ç´¢å¼•å’Œèšç°‡ç´¢å¼•)è¿›è¡Œç­‰å€¼æŸ¥è¯¢ä¸”ç²¾å‡†åŒ¹é…åˆ°ä¸€æ¡è®°å½•æ—¶ï¼Œæ­¤æ—¶å°±ä¼šç›´æ¥å°†è¿™æ¡è®°å½•é”å®šã€‚ä¾‹å¦‚select * from t where id = 6 for update;å°±ä¼šå°†id=6çš„è®°å½•é”å®š</p>\n</li>\n<li>\n<p>GapLocké—´éš™é”ï¼šé—´éš™æŒ‡çš„æ˜¯ä¸¤ä¸ªè®°å½•ä¹‹é—´é€»è¾‘ä¸Šå°šæœªå¡«å…¥æ•°æ®çš„éƒ¨åˆ†,æ˜¯ä¸€ä¸ªå·¦å¼€å³å¼€ç©ºé—´ã€‚é—´éš™é”å°±æ˜¯é”å®šæŸäº›é—´éš™åŒºé—´çš„ã€‚å½“ä½¿ç”¨ç­‰å€¼æŸ¥è¯¢æˆ–è€…èŒƒå›´æŸ¥è¯¢ï¼Œå¹¶ä¸”æ²¡æœ‰å‘½ä¸­ä»»ä½•ä¸€ä¸ªrecordï¼Œæ­¤æ—¶å°±ä¼šå°†å¯¹åº”çš„é—´éš™åŒºé—´é”å®šã€‚ä¾‹å¦‚select * from t where id = 3 for update;æˆ–è€…select * from t where id&gt;1 and id&lt;6 for update;å°±ä¼šå°†(1,6)åŒºé—´é”å®šã€‚</p>\n</li>\n<li>\n<p>Next-keyLockä¸´é”®é”ï¼šé—´éš™åŠ ä¸Šå®ƒå³è¾¹çš„è®°å½•ç»„æˆçš„å·¦å¼€å³é—­åŒºé—´ã€‚æ¯”å¦‚ä¸Šè¿°çš„(1,6]ã€(6,8]ç­‰ã€‚ä¸´é”®é”å°±æ˜¯è®°å½•é”(RecordLocks)å’Œé—´éš™é”(GapLocks)çš„ç»“åˆï¼Œå³é™¤äº†é”ä½è®°å½•æœ¬èº«ï¼Œè¿˜è¦å†é”ä½ç´¢å¼•ä¹‹é—´çš„é—´éš™ã€‚å½“æˆ‘ä»¬ä½¿ç”¨èŒƒå›´æŸ¥è¯¢ï¼Œå¹¶ä¸”å‘½ä¸­äº†éƒ¨åˆ†recordè®°å½•ï¼Œæ­¤æ—¶é”ä½çš„å°±æ˜¯ä¸´é”®åŒºé—´ã€‚æ³¨æ„ï¼Œä¸´é”®é”é”ä½çš„åŒºé—´ä¼šåŒ…å«æœ€åä¸€ä¸ªrecordçš„å³è¾¹çš„ä¸´é”®åŒºé—´ã€‚ä¾‹å¦‚select*fromtwhereid&gt;5andid&lt;=7forupdate;ä¼šé”ä½(4,7]ã€(7,+âˆ)ã€‚mysqlé»˜è®¤è¡Œé”ç±»å‹å°±æ˜¯ä¸´é”®é”(Next-KeyLocks)ã€‚å½“ä½¿ç”¨å”¯ä¸€æ€§ç´¢å¼•ï¼Œç­‰å€¼æŸ¥è¯¢åŒ¹é…åˆ°ä¸€æ¡è®°å½•çš„æ—¶å€™ï¼Œä¸´é”®é”(Next-KeyLocks)ä¼šé€€åŒ–æˆè®°å½•é”ï¼›æ²¡æœ‰åŒ¹é…åˆ°ä»»ä½•è®°å½•çš„æ—¶å€™ï¼Œé€€åŒ–æˆé—´éš™é”ã€‚</p>\n</li>\n<li>\n<p>é—´éš™é”(GapLocks)å’Œä¸´é”®é”(Next-KeyLocks)éƒ½æ˜¯ç”¨æ¥è§£å†³å¹»è¯»é—®é¢˜çš„ï¼Œåœ¨å·²æäº¤è¯»ï¼ˆREADCOMMITTEDï¼‰éš”ç¦»çº§åˆ«ä¸‹ï¼Œé—´éš™é”(GapLocks)å’Œä¸´é”®é”(Next-KeyLocks)éƒ½ä¼šå¤±æ•ˆï¼</p>\n</li>\n<li>\n<p>Insert Intention Lockæ’å…¥æ„å‘é”</p>\n</li>\n<li>\n<p>ä¸€ä¸ªäº‹åŠ¡åœ¨æ’å…¥ä¸€æ¡è®°å½•æ—¶éœ€è¦åˆ¤æ–­ä¸€ä¸‹æ’å…¥ä½ç½®æ˜¯ä¸æ˜¯è¢«åˆ«çš„äº‹åŠ¡åŠ äº†æ„å‘é”ï¼Œå¦‚æœæœ‰çš„è¯ï¼Œæ’å…¥æ“ä½œéœ€è¦ç­‰å¾…ï¼Œç›´åˆ°æ‹¥æœ‰gapé”çš„é‚£ä¸ªäº‹åŠ¡æäº¤ã€‚ä½†æ˜¯äº‹åŠ¡åœ¨ç­‰å¾…çš„æ—¶å€™ä¹Ÿéœ€è¦åœ¨å†…å­˜ä¸­ç”Ÿæˆä¸€ä¸ªé”ç»“æ„ï¼Œè¡¨æ˜æœ‰äº‹åŠ¡æƒ³åœ¨æŸä¸ªé—´éš™ä¸­æ’å…¥æ–°è®°å½•ï¼Œä½†æ˜¯ç°åœ¨åœ¨ç­‰å¾…ã€‚è¿™ç§ç±»å‹çš„é”å‘½åä¸ºInsert Intention Locksï¼Œä¹Ÿå°±æ˜¯æ’å…¥æ„å‘é”ã€‚</p>\n</li>\n<li>\n<p>å‡å¦‚æˆ‘ä»¬æœ‰ä¸ªT1äº‹åŠ¡ï¼Œç»™(1,6)åŒºé—´åŠ ä¸Šäº†æ„å‘é”ï¼Œç°åœ¨æœ‰ä¸ªT2äº‹åŠ¡ï¼Œè¦æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œidä¸º4ï¼Œå®ƒä¼šè·å–ä¸€ä¸ªï¼ˆ1,6ï¼‰åŒºé—´çš„æ’å…¥æ„å‘é”ï¼Œåˆæœ‰æœ‰ä¸ªT3äº‹åŠ¡ï¼Œæƒ³è¦æ’å…¥ä¸€ä¸ªæ•°æ®ï¼Œidä¸º3ï¼Œå®ƒä¹Ÿä¼šè·å–ä¸€ä¸ªï¼ˆ1,6ï¼‰åŒºé—´çš„æ’å…¥æ„å‘é”ï¼Œä½†æ˜¯ï¼Œè¿™ä¸¤ä¸ªæ’å…¥æ„å‘é”é”ä¸ä¼šäº’æ–¥ã€‚</p>\n</li>\n</ul>\n<h1>50. æ„å‘é”æ˜¯ä»€ä¹ˆçŸ¥é“å—ï¼Ÿ</h1>\n<ul>\n<li>æ„å‘é”æ˜¯ä¸€ä¸ªè¡¨çº§é”ï¼Œä¸è¦å’Œæ’å…¥æ„å‘é”ææ··ã€‚</li>\n<li>æ„å‘é”çš„å‡ºç°æ˜¯ä¸ºäº†æ”¯æŒInnoDBçš„å¤šç²’åº¦é”ï¼Œå®ƒè§£å†³çš„æ˜¯è¡¨é”å’Œè¡Œé”å…±å­˜çš„é—®é¢˜ã€‚</li>\n<li>å½“ç»™ä¸€ä¸ªè¡¨åŠ è¡¨é”çš„æ—¶å€™ï¼Œéœ€è¦æ ¹æ®è¡¨ä¸­æœ‰æ²¡æœ‰æ•°æ®è¡Œè¢«é”å®šï¼Œä»¥ç¡®å®šæ˜¯å¦èƒ½åŠ æˆåŠŸã€‚</li>\n<li>å‡å¦‚æ²¡æœ‰æ„å‘é”ï¼Œé‚£ä¹ˆéå†è¡¨ä¸­æ‰€æœ‰æ•°æ®è¡Œæ¥åˆ¤æ–­æœ‰æ²¡æœ‰è¡Œé”ï¼›</li>\n<li>æœ‰äº†æ„å‘é”è¿™ä¸ªè¡¨çº§é”ä¹‹åï¼Œåˆ™æˆ‘ä»¬ç›´æ¥åˆ¤æ–­ä¸€æ¬¡å°±çŸ¥é“è¡¨ä¸­æ˜¯å¦æœ‰æ•°æ®è¡Œè¢«é”å®šäº†ã€‚</li>\n<li>æœ‰äº†æ„å‘é”ä¹‹åï¼Œè¦æ‰§è¡Œçš„äº‹åŠ¡Aåœ¨ç”³è¯·è¡Œé”ï¼ˆå†™é”ï¼‰ä¹‹å‰ï¼Œæ•°æ®åº“ä¼šè‡ªåŠ¨å…ˆç»™äº‹åŠ¡Aç”³è¯·è¡¨çš„æ„å‘æ’ä»–é”ã€‚å½“äº‹åŠ¡Bå»ç”³è¯·è¡¨çš„äº’æ–¥é”æ—¶å°±ä¼šå¤±è´¥ï¼Œå› ä¸ºè¡¨ä¸Šæœ‰æ„å‘æ’ä»–é”ä¹‹åäº‹åŠ¡Bç”³è¯·è¡¨çš„äº’æ–¥é”æ—¶ä¼šè¢«é˜»å¡ã€‚</li>\n</ul>\n<h1>51. MySQLçš„ä¹è§‚é”å’Œæ‚²è§‚é”äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>æ‚²è§‚é”ï¼ˆPessimisticConcurrencyControlï¼‰ï¼šè®¤ä¸ºè¢«å®ƒä¿æŠ¤çš„æ•°æ®æ˜¯æå…¶ä¸å®‰å…¨çš„ï¼Œæ¯æ—¶æ¯åˆ»éƒ½æœ‰å¯èƒ½è¢«æ”¹åŠ¨ï¼Œä¸€ä¸ªäº‹åŠ¡æ‹¿åˆ°æ‚²è§‚é”åï¼Œå…¶ä»–ä»»ä½•äº‹åŠ¡éƒ½ä¸èƒ½å¯¹è¯¥æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œåªèƒ½ç­‰å¾…é”è¢«é‡Šæ”¾æ‰å¯ä»¥æ‰§è¡Œã€‚è¡Œé”ï¼Œè¡¨é”ï¼Œè¯»é”ï¼Œå†™é”å‡ä¸ºæ‚²è§‚é”ã€‚</li>\n<li>ä¹è§‚é”ï¼ˆOptimisticConcurrencyControlï¼‰è®¤ä¸ºæ•°æ®çš„å˜åŠ¨ä¸ä¼šå¤ªé¢‘ç¹ã€‚é€šå¸¸æ˜¯é€šè¿‡åœ¨è¡¨ä¸­å¢åŠ ä¸€ä¸ªç‰ˆæœ¬(version)æˆ–æ—¶é—´æˆ³(timestamp)æ¥å®ç°ï¼Œå…¶ä¸­ï¼Œç‰ˆæœ¬æœ€ä¸ºå¸¸ç”¨ã€‚</li>\n<li>äº‹åŠ¡åœ¨ä»æ•°æ®åº“ä¸­å–æ•°æ®æ—¶ï¼Œä¼šå°†è¯¥æ•°æ®çš„ç‰ˆæœ¬ä¹Ÿå–å‡ºæ¥(v1)ï¼Œå½“äº‹åŠ¡å¯¹æ•°æ®å˜åŠ¨å®Œæ¯•æƒ³è¦å°†å…¶æ›´æ–°åˆ°è¡¨ä¸­æ—¶ï¼Œä¼šå°†ä¹‹å‰å–å‡ºçš„ç‰ˆæœ¬v1ä¸æ•°æ®ä¸­æœ€æ–°çš„ç‰ˆæœ¬v2ç›¸å¯¹æ¯”ï¼Œå¦‚æœv1=v2ï¼Œé‚£ä¹ˆè¯´æ˜åœ¨æ•°æ®å˜åŠ¨æœŸé—´ï¼Œæ²¡æœ‰å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œæ­¤æ—¶ï¼Œå°±å…è®¸äº‹åŠ¡å¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œä¿®æ”¹ï¼Œå¹¶ä¸”ä¿®æ”¹æ—¶versionä¼šåŠ 1ï¼Œä»¥æ­¤æ¥è¡¨æ˜æ•°æ®å·²è¢«å˜åŠ¨ã€‚å¦‚æœï¼Œv1ä¸ç­‰äºv2ï¼Œé‚£ä¹ˆè¯´æ˜æ•°æ®å˜åŠ¨æœŸé—´ï¼Œæ•°æ®è¢«å…¶ä»–äº‹åŠ¡æ”¹åŠ¨äº†ï¼Œæ­¤æ—¶ä¸å…è®¸æ•°æ®æ›´æ–°åˆ°è¡¨ä¸­ï¼Œä¸€èˆ¬çš„å¤„ç†åŠæ³•æ˜¯é€šçŸ¥ç”¨æˆ·è®©å…¶é‡æ–°æ“ä½œã€‚ä¸åŒäºæ‚²è§‚é”ï¼Œä¹è§‚é”é€šå¸¸æ˜¯ç”±å¼€å‘è€…å®ç°çš„ã€‚</li>\n</ul>\n<h1>53. MySQLäº‹åŠ¡ç‰¹æ€§ï¼Ÿ</h1>\n<ul>\n<li>åŸå­æ€§ï¼šäº‹åŠ¡çš„æ‰€æœ‰æ“ä½œè¦ä¹ˆå…¨éƒ¨æäº¤æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥å›æ»šï¼Œå¯¹äºä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ“ä½œä¸èƒ½åªæ‰§è¡Œå…¶ä¸­ä¸€éƒ¨åˆ†ã€‚</li>\n<li>ä¸€è‡´æ€§ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œäº‹åŠ¡å‰åæ•°æ®çš„å®Œæ•´æ€§å¿…é¡»ä¿æŒä¸€è‡´ã€‚ä¸€è‡´æ€§ç¡®ä¿äº‹åŠ¡ä»ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€è½¬æ¢åˆ°å¦ä¸€ä¸ªä¸€è‡´çš„çŠ¶æ€ã€‚æ¯”å¦‚åœ¨é“¶è¡Œè½¬è´¦äº‹åŠ¡ä¸­ï¼Œæ— è®ºå‘ç”Ÿä»€ä¹ˆï¼Œè½¬è´¦å‰åä¸¤ä¸ªè´¦æˆ·çš„æ€»é‡‘é¢åº”ä¿æŒä¸å˜ã€‚å‡å¦‚Aè´¦æˆ·ï¼ˆ100å—ï¼‰ç»™Bè´¦æˆ·ï¼ˆ10å—ï¼‰è½¬äº†10å—é’±ï¼Œä¸ç®¡æˆåŠŸä¸å¦ï¼ŒAå’ŒBçš„æ€»é‡‘é¢éƒ½æ˜¯110å—ã€‚</li>\n<li>éš”ç¦»æ€§ï¼šå¤šä¸ªå¹¶å‘äº‹åŠ¡ä¹‹é—´éœ€è¦ç›¸äº’éš”ç¦»ï¼Œå³ä¸€ä¸ªäº‹åŠ¡çš„æ‰§è¡Œä¸èƒ½è¢«å…¶ä»–äº‹åŠ¡å¹²æ‰°ã€‚ä¸»è¦æ˜¯ä¸ºäº†è§£å†³äº‹åŠ¡å¹¶å‘æ‰§è¡Œæ—¶å¯èƒ½å‡ºç°çš„é—®é¢˜ï¼Œå¦‚è„è¯»ã€ä¸å¯é‡å¤è¯»ã€å¹»è¯»ç­‰ã€‚æ•°æ®åº“ç³»ç»Ÿé€šè¿‡äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼ˆå¦‚è¯»æœªæäº¤ã€è¯»å·²æäº¤ã€å¯é‡å¤è¯»ã€ä¸²è¡ŒåŒ–ï¼‰æ¥å®ç°äº‹åŠ¡çš„éš”ç¦»æ€§ã€‚</li>\n<li>æŒä¹…æ€§ï¼šäº‹åŠ¡ä¸€æ—¦æäº¤ï¼Œå®ƒå¯¹æ•°æ®åº“æ‰€åšçš„æ›´æ”¹å°±æ˜¯æ°¸ä¹…æ€§çš„ï¼Œå³ä½¿å‘ç”Ÿç³»ç»Ÿå´©æºƒï¼Œä¿®æ”¹çš„æ•°æ®ä¹Ÿä¸ä¼šä¸¢å¤±</li>\n</ul>\n<h1>54. ACIDæ€ä¹ˆä¿è¯ï¼Ÿ</h1>\n<ul>\n<li>\n<p>åŸå­æ€§ï¼ˆAtomicityï¼‰ï¼Œundologè®°å½•äº†äº‹åŠ¡å‘ç”Ÿä¹‹å‰çš„æ•°æ®ï¼Œå¦‚æœäº‹åŠ¡å¤±è´¥ï¼ŒInnoDBä¼šæ ¹æ®undologå›æ»šæ•°æ®ã€‚å½“äº‹åŠ¡å¼€å§‹ä¿®æ”¹æ•°æ®æ—¶ï¼ŒInnoDBé¦–å…ˆä¼šåœ¨undologä¸­è®°å½•æ—§å€¼ï¼ˆå³ä¿®æ”¹å‰çš„å€¼ï¼‰ã€‚å¦‚æœäº‹åŠ¡é¡ºåˆ©è¿›è¡Œå¹¶æœ€ç»ˆæäº¤ï¼Œundologä¼šåœ¨æŸä¸ªæ—¶é—´ç‚¹è¢«æ¸…é™¤ã€‚å¦‚æœäº‹åŠ¡ä¸­çš„æŸä¸ªæ“ä½œå¤±è´¥æˆ–è€…äº‹åŠ¡è¢«æ˜ç¡®åœ°å›æ»šï¼ŒInnoDBä¼šä½¿ç”¨undologä¸­çš„ä¿¡æ¯æ¥æ’¤é”€æ‰€æœ‰æ›´æ”¹ï¼Œç¡®ä¿æ•°æ®çš„åŸå­æ€§</p>\n</li>\n<li>\n<p>ä¸€è‡´æ€§ï¼ˆConsistencyï¼‰ï¼Œåªè¦ä¿è¯åŸå­æ€§ã€éš”ç¦»æ€§ã€æŒä¹…æ€§ï¼Œè‡ªç„¶ä¹Ÿå°±ä¿è¯äº†æ•°æ®çš„ä¸€è‡´æ€§ã€‚è¿˜æœ‰ä¸šåŠ¡ä»£ç </p>\n</li>\n<li>\n<p>éš”ç¦»æ€§(Isolation)ï¼ŒMySQLä½¿ç”¨å¤šç§éš”ç¦»çº§åˆ«æ¥æ§åˆ¶äº‹åŠ¡å¦‚ä½•ä¸å…¶ä»–å¹¶å‘äº‹åŠ¡éš”ç¦»ã€‚InnoDBå­˜å‚¨å¼•æ“ä½¿ç”¨MVCC(å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶)æœºåˆ¶æ¥å¤„ç†å¹¶å‘äº‹åŠ¡ï¼Œç¡®ä¿æ¯ä¸ªäº‹åŠ¡éƒ½æœ‰è‡ªå·±çš„æ•°æ®ç‰ˆæœ¬ï¼Œæ¯æ¬¡æ›´æ–°è®°å½•æ—¶ï¼Œéƒ½ä¼šç”Ÿæˆè®°å½•çš„ä¸€ä¸ªæ–°ç‰ˆæœ¬ï¼Œè€Œä¸æ˜¯è¦†ç›–è€ç‰ˆæœ¬ã€‚æ¯ä¸ªç‰ˆæœ¬éƒ½ä¼šæœ‰ä¸¤ä¸ªé¢å¤–çš„å±æ€§ï¼šä¸€ä¸ªè¡¨ç¤ºç‰ˆæœ¬çš„åˆ›å»ºæ—¶é—´ï¼ˆæˆ–äº‹åŠ¡IDï¼‰ï¼Œå¦ä¸€ä¸ªè¡¨ç¤ºç‰ˆæœ¬çš„è¿‡æœŸæ—¶é—´ï¼ˆæˆ–ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„äº‹åŠ¡IDï¼‰ã€‚å½“äº‹åŠ¡å°è¯•è¯»å–è®°å½•æ—¶ï¼Œå®ƒä¼šçœ‹åˆ°è¯¥äº‹åŠ¡å¼€å§‹æ—¶æœ‰æ•ˆçš„é‚£ä¸ªç‰ˆæœ¬ã€‚ä¸åŒçš„äº‹åŠ¡ä¼šçœ‹åˆ°ä¸åŒç‰ˆæœ¬çš„æ•°æ®è¡Œï¼Œè¿™å–å†³äºäº‹åŠ¡çš„å¼€å§‹æ—¶é—´å’Œå®ƒçš„éš”ç¦»çº§åˆ«ã€‚å¯¹äºå¦‚\"è¯»æœªæäº¤\"ï¼ˆREADUNCOMMITTEDï¼‰è¿™æ ·çš„è¾ƒä½éš”ç¦»çº§åˆ«ï¼Œäº‹åŠ¡å¯èƒ½ä¼šçœ‹åˆ°å…¶ä»–æœªæäº¤äº‹åŠ¡æ‰€åšçš„æ›´æ”¹ã€‚ä½†åœ¨æ›´é«˜çš„éš”ç¦»çº§åˆ«ï¼Œå¦‚\"å¯é‡å¤è¯»\"ï¼ˆREPEATABLEREADï¼‰æˆ–\"ä¸²è¡ŒåŒ–\"ï¼ˆSERIALIZABLEï¼‰ï¼Œäº‹åŠ¡ä¸ä¼šçœ‹åˆ°å…¶ä»–äº‹åŠ¡æ‰€åšçš„æ›´æ”¹ï¼Œç›´åˆ°å®ƒä»¬è¢«æäº¤ã€‚</p>\n</li>\n<li>\n<p>æŒä¹…æ€§(Durability)ï¼Œå­˜å‚¨å¼•æ“ï¼ˆå¦‚InnoDBï¼‰é€šè¿‡å†™å…¥ç£ç›˜æ¥ç¡®ä¿ã€‚å³ä½¿åœ¨ç³»ç»Ÿå´©æºƒä¹‹åï¼Œå·²æäº¤äº‹åŠ¡çš„æ›´æ”¹ä¹Ÿä¸ä¼šä¸¢å¤±</p>\n</li>\n<li>\n<p>InnoDBä½¿ç”¨â€œredologâ€æ¥è®°å½•æ•°æ®çš„æ›´æ”¹ï¼Œåœ¨ç³»ç»Ÿå´©æºƒåï¼Œredologå¯ç”¨äºæ¢å¤æ•°æ®ã€‚ä¿è¯æ•°æ®æ°¸ä¸ä¸¢å¤±</p>\n</li>\n<li>\n<p>redologæ˜¯ä¸€ç§ç‰©ç†æ—¥å¿—ï¼Œè®°å½•äº†å¯¹æ•°æ®é¡µçš„ç‰©ç†æ›´æ”¹ã€‚å½“äº‹åŠ¡è¿›è¡Œå†™æ“ä½œæ—¶ï¼ŒInnoDBé¦–å…ˆä¼šå†™å…¥redologï¼Œå¹¶ä¸ä¼šç«‹å³ä¿®æ”¹æ•°æ®æ–‡ä»¶ã€‚è¿™ç§å†™å…¥æ–¹å¼è¢«ç§°ä¸ºâ€œwrite-aheadloggingâ€ï¼ˆå…ˆå†™æ—¥å¿—ï¼‰ã€‚</p>\n</li>\n<li>\n<p>å½“redologå¡«æ»¡æˆ–åœ¨æŸäº›å…¶ä»–æƒ…å†µä¸‹ï¼ŒInnoDBä¼šå¼‚æ­¥å°†è¿™äº›æ›´æ”¹åˆ·æ–°åˆ°æ•°æ®æ–‡ä»¶ä¸­ã€‚</p>\n</li>\n<li>\n<p>ç³»ç»Ÿå´©æºƒæ—¶ï¼Œç”±äºæ•°æ®å¯èƒ½è¿˜æ²¡æœ‰è¢«çœŸæ­£å†™å…¥æ•°æ®æ–‡ä»¶ï¼Œä½†å·²ç»åœ¨redologä¸­ï¼Œå› æ­¤ç³»ç»Ÿå¯ä»¥åœ¨å¯åŠ¨æ—¶ä½¿ç”¨è¿™äº›æ—¥å¿—æ¥é‡æ–°æ‰§è¡Œæˆ–â€œé‡åšâ€è¿™äº›æ›´æ”¹ï¼Œç¡®ä¿æ•°æ®çš„æŒä¹…æ€§ã€‚</p>\n</li>\n<li>\n<p>å³ä½¿æ•°æ®åº“åœ¨äº‹åŠ¡æäº¤åç«‹å³å´©æºƒï¼Œç”±äºäº‹åŠ¡çš„æ›´æ”¹å·²ç»è®°å½•åœ¨redologä¸­ï¼Œè¿™äº›æ›´æ”¹åœ¨æ•°æ®åº“æ¢å¤æ—¶ä»ç„¶æ˜¯å®‰å…¨çš„ã€‚</p>\n</li>\n</ul>\n<h1>55. äº‹åŠ¡çš„éš”ç¦»çº§åˆ«ï¼Ÿé»˜è®¤éš”ç¦»çº§åˆ«æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>è¯»æœªæäº¤ï¼ˆReadUncommittedï¼‰è¯»å–å°šæœªæäº¤çš„æ•°æ® ï¼šå“ªä¸ªé—®é¢˜éƒ½ä¸èƒ½è§£å†³</li>\n<li>è¯»å·²æäº¤ï¼ˆReadCommittedï¼‰è¯»å–å·²ç»æäº¤çš„æ•°æ® ï¼šå¯è§£å†³è„è¯»ï¼ˆoracleé»˜è®¤ï¼‰</li>\n<li>å¯é‡å¤è¯»ï¼ˆRepeatableReadï¼‰å¯é‡å¤è¯»ï¼šæŒ‡ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­çœ‹åˆ°çš„æ•°æ®ï¼Œæ€»æ˜¯è·Ÿè¿™ä¸ªäº‹åŠ¡åœ¨å¯åŠ¨æ—¶çœ‹åˆ°çš„æ•°æ®æ˜¯ä¸€è‡´çš„.é™¤éæ˜¯è‡ªå·±ä¿®æ”¹çš„æ•°æ®ã€‚å¯è§£å†³è„è¯»å’Œä¸å¯é‡å¤è¯»ï¼Œï¼ˆmysqlé»˜è®¤ï¼‰</li>\n<li>ä¸²è¡ŒåŒ–ï¼ˆSerializableï¼‰å¯¹äºåŒä¸€è¡Œè®°å½•ï¼Œâ€œå†™â€ä¼šåŠ â€œå†™é”â€ï¼Œâ€œè¯»â€ä¼šåŠ â€œè¯»é”â€ã€‚å½“å‡ºç°è¯»å†™é”å†²çªçš„æ—¶å€™ï¼Œåè®¿é—®çš„äº‹åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚å¯è§£å†³ è„è¯» ä¸å¯é‡å¤è¯» å’Œ å¹»è¯»</li>\n<li>æ€§èƒ½read uncommitted&gt;read committed&gt;repeatable read&gt;serialazable</li>\n<li>å®‰å…¨æ€§read uncommitted&lt;read committed&lt;repeatable read&lt;serialazable</li>\n</ul>\n<h1>56. ä»€ä¹ˆæ˜¯å¹»è¯»ï¼Œè„è¯»ï¼Œä¸å¯é‡å¤è¯»å‘¢ï¼Ÿ</h1>\n<ul>\n<li>è„è¯»ï¼ˆdirty readï¼‰ : ä¸€ä¸ªäº‹åŠ¡è¯»å–åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡å°šæœªæäº¤çš„æ•°æ®</li>\n<li>ä¸å¯é‡å¤è¯»ï¼ˆnon-repeatable readï¼‰: ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„updateæ•°æ® ä¸¤æ¬¡è¯»å–çš„æ•°æ®çš„å†…å®¹ä¸ä¸€è‡´</li>\n<li>å¹»è¯»/è™šè¯»ï¼ˆphantom readï¼‰ : ä¸€ä¸ªäº‹åŠ¡è¯»åˆ°äº†å¦ä¸€ä¸ªäº‹åŠ¡å·²ç»æäº¤çš„insertã€deleteæ•°æ® ä¸¤æ¬¡è¯»å–çš„æ•°æ®çš„æ•°é‡ä¸ä¸€è‡´</li>\n</ul>\n<h1>57. äº‹åŠ¡çš„å„ä¸ªéš”ç¦»çº§åˆ«éƒ½æ˜¯å¦‚ä½•å®ç°çš„ï¼Ÿ</h1>\n<ul>\n<li>è¯»æœªæäº¤\n<ul>\n<li>è¯»ä¸åŠ é”ã€‚ä¸é˜»å¡å…¶ä»–äº‹åŠ¡çš„è¯»å’Œå†™</li>\n<li>äº‹åŠ¡å†™é˜»å¡å…¶ä»–äº‹åŠ¡å†™ï¼Œä½†ä¸é˜»å¡å…¶ä»–äº‹åŠ¡è¯»ï¼›</li>\n</ul>\n</li>\n<li>è¯»å–å·²æäº¤&amp;å¯é‡å¤è¯»\n<ul>\n<li>åˆ©ç”¨äº†ReadViewå’ŒMVCCï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªäº‹åŠ¡åªèƒ½è¯»å–å®ƒèƒ½çœ‹åˆ°çš„ç‰ˆæœ¬ï¼ˆReadViewï¼‰ã€‚</li>\n<li>READCOMMITTEDï¼šæ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ªReadView</li>\n<li>REPEATABLEREADï¼šåœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”Ÿæˆä¸€ä¸ªReadView</li>\n</ul>\n</li>\n<li>ä¸²è¡ŒåŒ–ï¼šå¯¹äºåŒä¸€è¡Œäº‹åŠ¡ï¼Œå†™ä¼šåŠ å†™é”ï¼Œè¯»ä¼šåŠ è¯»é”ã€‚å½“å‡ºç°è¯»å†™é”å†²çªçš„æ—¶å€™ï¼Œåè®¿é—®çš„äº‹åŠ¡å¿…é¡»ç­‰å‰ä¸€ä¸ªäº‹åŠ¡æ‰§è¡Œå®Œæˆï¼Œæ‰èƒ½ç»§ç»­æ‰§è¡Œã€‚</li>\n</ul>\n<h1>58. MVCCå®ç°åŸç†ï¼Ÿ</h1>\n<ul>\n<li>MVCC(MultiVersionConcurrencyControl)ï¼Œå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼Œä¸»è¦ç”¨æ¥è§£å†³æ•°æ®åº“å¹¶å‘é—®é¢˜ã€‚MVCCæ˜¯é€šè¿‡ç‰ˆæœ¬é“¾å’Œ ReadView æœºåˆ¶æ¥å®ç°çš„</li>\n<li>ç‰ˆæœ¬é“¾ï¼šå¯¹äºInnoDBå­˜å‚¨å¼•æ“ï¼Œæ¯ä¸€è¡Œè®°å½•éƒ½æœ‰ä¸¤ä¸ªéšè—åˆ—DB_TRX_IDã€DB_ROLL_PTR\n<ul>\n<li>DB_TRX_IDï¼Œä¿å­˜åˆ›å»ºè¿™ä¸ªç‰ˆæœ¬çš„äº‹åŠ¡ IDã€‚</li>\n<li>DB_ROLL_PTRï¼ŒæŒ‡å‘ undo æ—¥å¿—è®°å½•çš„æŒ‡é’ˆï¼Œè¿™ä¸ªè®°å½•åŒ…å«äº†è¯¥è¡Œçš„å‰ä¸€ä¸ªç‰ˆæœ¬çš„ä¿¡æ¯ã€‚é€šè¿‡è¿™ä¸ªæŒ‡é’ˆï¼Œå¯ä»¥è®¿é—®åˆ°è¯¥è¡Œæ•°æ®çš„å†å²ç‰ˆæœ¬ã€‚</li>\n<li>æ¯æ¬¡å˜åŠ¨éƒ½ä¼šå…ˆæŠŠundoæ—¥å¿—è®°å½•ä¸‹æ¥ï¼Œå¹¶ç”¨DB_ROLL_PTRæŒ‡å‘undoæ—¥å¿—åœ°å€ã€‚å› æ­¤å¯ä»¥è®¤ä¸ºï¼Œå¯¹è¯¥æ¡è®°å½•çš„ä¿®æ”¹æ—¥å¿—ä¸²è”èµ·æ¥å°±å½¢æˆäº†ä¸€ä¸ªç‰ˆæœ¬é“¾ï¼Œç‰ˆæœ¬é“¾çš„å¤´èŠ‚ç‚¹å°±æ˜¯å½“å‰è®°å½•æœ€æ–°çš„å€¼ã€‚</li>\n</ul>\n</li>\n<li>ReadViewï¼šå¯¹äºReadCommittedå’ŒRepeatableReadéš”ç¦»çº§åˆ«æ¥è¯´ï¼Œéƒ½éœ€è¦è¯»å–å·²ç»æäº¤çš„äº‹åŠ¡æ‰€ä¿®æ”¹çš„è®°å½•ï¼Œä¹Ÿå°±æ˜¯è¯´å¦‚æœç‰ˆæœ¬é“¾ä¸­æŸä¸ªç‰ˆæœ¬çš„ä¿®æ”¹æ²¡æœ‰æäº¤ï¼Œé‚£ä¹ˆè¯¥ç‰ˆæœ¬çš„è®°å½•æ—¶ä¸èƒ½è¢«è¯»å–çš„ã€‚æ‰€ä»¥éœ€è¦ç¡®å®šåœ¨ReadCommittedå’ŒRepeatableReadéš”ç¦»çº§åˆ«ä¸‹ï¼Œç‰ˆæœ¬é“¾ä¸­å“ªä¸ªç‰ˆæœ¬æ˜¯èƒ½è¢«å½“å‰äº‹åŠ¡è¯»å–çš„ã€‚äºæ˜¯å°±å¼•å…¥äº†ReadViewè¿™ä¸ªæ¦‚å¿µæ¥è§£å†³è¿™ä¸ªé—®é¢˜ã€‚</li>\n<li>ReadViewå°±æ˜¯äº‹åŠ¡æ‰§è¡Œå¿«ç…§è¯»æ—¶ï¼Œäº§ç”Ÿçš„è¯»è§†å›¾ï¼Œç›¸å½“äºæŸæ—¶åˆ»è¡¨è®°å½•çš„ä¸€ä¸ªå¿«ç…§ï¼Œé€šè¿‡è¿™ä¸ªå¿«ç…§ï¼Œæˆ‘ä»¬å¯ä»¥è·å–ï¼š\n<ul>\n<li>m_idsï¼šè¡¨ç¤ºåœ¨ç”ŸæˆReadViewæ—¶å½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡çš„äº‹åŠ¡idåˆ—è¡¨ã€‚</li>\n<li>min_trx_idï¼šè¡¨ç¤ºåœ¨ç”ŸæˆReadViewæ—¶å½“å‰ç³»ç»Ÿä¸­æ´»è·ƒçš„è¯»å†™äº‹åŠ¡ä¸­æœ€å°çš„äº‹åŠ¡idï¼Œä¹Ÿå°±æ˜¯m_idsä¸­çš„æœ€å°å€¼ã€‚</li>\n<li>max_trx_idï¼šè¡¨ç¤ºç”ŸæˆReadViewæ—¶ç³»ç»Ÿä¸­åº”è¯¥åˆ†é…ç»™ä¸‹ä¸€ä¸ªäº‹åŠ¡çš„idå€¼ã€‚</li>\n<li>creator_trx_idï¼šè¡¨ç¤ºç”Ÿæˆè¯¥ReadViewçš„äº‹åŠ¡çš„äº‹åŠ¡id</li>\n</ul>\n</li>\n<li>æœ‰äº†è¿™ä¸ªReadViewï¼Œè¿™æ ·åœ¨è®¿é—®æŸæ¡è®°å½•æ—¶ï¼Œåªéœ€è¦æŒ‰ç…§ä¸‹è¾¹çš„æ­¥éª¤åˆ¤æ–­è®°å½•çš„æŸä¸ªç‰ˆæœ¬æ˜¯å¦å¯è§ï¼š\n<ul>\n<li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„DB_TRX_IDå±æ€§å€¼ä¸ReadViewä¸­çš„creator_trx_idå€¼ç›¸åŒï¼Œæ„å‘³ç€å½“å‰äº‹åŠ¡åœ¨è®¿é—®å®ƒè‡ªå·±ä¿®æ”¹è¿‡çš„è®°å½•ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„DB_TRX_IDå±æ€§å€¼å°äºReadViewä¸­çš„min_trx_idå€¼ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”ŸæˆReadViewå‰å·²ç»æäº¤ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„DB_TRX_IDå±æ€§å€¼å¤§äºReadViewä¸­çš„max_trx_idå€¼ï¼Œè¡¨æ˜ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡åœ¨å½“å‰äº‹åŠ¡ç”ŸæˆReadViewåæ‰å¼€å¯ï¼Œæ‰€ä»¥è¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«å½“å‰äº‹åŠ¡è®¿é—®ã€‚</li>\n<li>å¦‚æœè¢«è®¿é—®ç‰ˆæœ¬çš„DB_TRX_IDå±æ€§å€¼åœ¨ReadViewçš„min_trx_idå’Œmax_trx_idä¹‹é—´ï¼Œé‚£å°±éœ€è¦åˆ¤æ–­ä¸€ä¸‹trx_idå±æ€§å€¼æ˜¯ä¸æ˜¯åœ¨m_idsåˆ—è¡¨ä¸­ï¼Œå¦‚æœåœ¨ï¼Œè¯´æ˜åˆ›å»ºReadViewæ—¶ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡è¿˜æ˜¯æ´»è·ƒçš„ï¼Œè¯¥ç‰ˆæœ¬ä¸å¯ä»¥è¢«è®¿é—®ï¼›å¦‚æœä¸åœ¨ï¼Œè¯´æ˜åˆ›å»ºReadViewæ—¶ç”Ÿæˆè¯¥ç‰ˆæœ¬çš„äº‹åŠ¡å·²ç»è¢«æäº¤ï¼Œè¯¥ç‰ˆæœ¬å¯ä»¥è¢«è®¿é—®ã€‚</li>\n<li>å¦‚æœæŸä¸ªç‰ˆæœ¬çš„æ•°æ®å¯¹å½“å‰äº‹åŠ¡ä¸å¯è§çš„è¯ï¼Œé‚£å°±é¡ºç€ç‰ˆæœ¬é“¾æ‰¾åˆ°ä¸‹ä¸€ä¸ªç‰ˆæœ¬çš„æ•°æ®ï¼Œç»§ç»­æŒ‰ç…§ä¸Šè¾¹çš„æ­¥éª¤åˆ¤æ–­å¯è§æ€§ï¼Œä¾æ­¤ç±»æ¨ï¼Œç›´åˆ°ç‰ˆæœ¬é“¾ä¸­çš„æœ€åä¸€ä¸ªç‰ˆæœ¬ã€‚å¦‚æœæœ€åä¸€ä¸ªç‰ˆæœ¬ä¹Ÿä¸å¯è§çš„è¯ï¼Œé‚£ä¹ˆå°±æ„å‘³ç€è¯¥æ¡è®°å½•å¯¹è¯¥äº‹åŠ¡å®Œå…¨ä¸å¯è§ï¼ŒæŸ¥è¯¢ç»“æœå°±ä¸åŒ…å«è¯¥è®°å½•ã€‚</li>\n</ul>\n</li>\n<li>READCOMMITTEDæ˜¯æ¯æ¬¡è¯»å–æ•°æ®å‰éƒ½ç”Ÿæˆä¸€ä¸ªReadViewï¼Œè¿™æ ·å°±èƒ½ä¿è¯è‡ªå·±æ¯æ¬¡éƒ½èƒ½è¯»åˆ°å…¶å®ƒäº‹åŠ¡æäº¤çš„æ•°æ®ï¼›</li>\n<li>REPEATABLEREADæ˜¯åœ¨ç¬¬ä¸€æ¬¡è¯»å–æ•°æ®æ—¶ç”Ÿæˆä¸€ä¸ªReadViewï¼Œè¿™æ ·å°±èƒ½ä¿è¯åç»­è¯»å–çš„ç»“æœå®Œå…¨ä¸€è‡´ã€‚</li>\n</ul>\n<h1>59. æ•°æ®åº“è¯»å†™åˆ†ç¦»äº†è§£å—ï¼Ÿ</h1>\n<p>è¯»å†™åˆ†ç¦»çš„åŸºæœ¬åŸç†æ˜¯å°†æ•°æ®åº“è¯»å†™æ“ä½œåˆ†æ•£åˆ°ä¸åŒçš„èŠ‚ç‚¹ä¸Šã€‚è¯»å†™åˆ†ç¦»çš„åŸºæœ¬å®ç°æ˜¯:</p>\n<ul>\n<li>æ•°æ®åº“æœåŠ¡å™¨æ­å»ºä¸»ä»é›†ç¾¤ï¼Œä¸€ä¸»ä¸€ä»ã€ä¸€ä¸»å¤šä»éƒ½å¯ä»¥ã€‚</li>\n<li>æ•°æ®åº“ä¸»æœºè´Ÿè´£å†™æ“ä½œï¼Œä»æœºåªè´Ÿè´£è¯»æ“ä½œã€‚</li>\n<li>æ•°æ®åº“ä¸»æœºé€šè¿‡å¤åˆ¶å°†æ•°æ®åŒæ­¥åˆ°ä»æœºï¼Œæ¯å°æ•°æ®åº“æœåŠ¡å™¨éƒ½å­˜å‚¨äº†æ‰€æœ‰çš„ä¸šåŠ¡æ•°æ®ã€‚</li>\n</ul>\n<h1>60. è¯»å†™åˆ†ç¦»çš„åˆ†é…æ€ä¹ˆå®ç°å‘¢ï¼Ÿ</h1>\n<ul>\n<li>ç¨‹åºä»£ç å°è£…ï¼šåœ¨ä»£ç ä¸­æŠ½è±¡ä¸€ä¸ªæ•°æ®è®¿é—®å±‚ï¼ˆæ‰€ä»¥æœ‰çš„æ–‡ç« ä¹Ÿç§°è¿™ç§æ–¹å¼ä¸º\"ä¸­é—´å±‚å°è£…\"ï¼‰ï¼Œå®ç°è¯»å†™æ“ä½œåˆ†ç¦»å’Œæ•°æ®åº“æœåŠ¡å™¨è¿æ¥çš„ç®¡ç†ã€‚ä¾‹å¦‚ï¼ŒåŸºäºHibernateè¿›è¡Œç®€å•å°è£…ï¼Œå°±å¯ä»¥å®ç°è¯»å†™åˆ†ç¦»ï¼šæ·˜å®çš„ TDDL ï¼ˆTaobao Distributed Data Layer</li>\n<li>ä¸­é—´ä»¶å°è£…ï¼šç‹¬ç«‹ä¸€å¥—ç³»ç»Ÿå‡ºæ¥ï¼Œå®ç°è¯»å†™æ“ä½œåˆ†ç¦»å’Œæ•°æ®åº“æœåŠ¡å™¨è¿æ¥çš„ç®¡ç†ã€‚ä¸­é—´ä»¶å¯¹ä¸šåŠ¡æœåŠ¡å™¨æä¾›SQLå…¼å®¹çš„åè®®ï¼Œä¸šåŠ¡æœåŠ¡å™¨æ— é¡»è‡ªå·±è¿›è¡Œè¯»å†™åˆ†ç¦»ã€‚å¯¹äºä¸šåŠ¡æœåŠ¡å™¨æ¥è¯´ï¼Œè®¿é—®ä¸­é—´ä»¶å’Œè®¿é—®æ•°æ®åº“æ²¡æœ‰åŒºåˆ«ï¼Œäº‹å®ä¸Šåœ¨ä¸šåŠ¡æœåŠ¡å™¨çœ‹æ¥ï¼Œä¸­é—´ä»¶å°±æ˜¯ä¸€ä¸ªæ•°æ®åº“æœåŠ¡å™¨ã€‚</li>\n</ul>\n<h1>61. ä¸»ä»å¤åˆ¶åŸç†äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>MySQL çš„ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave Replicationï¼‰æ˜¯ä¸€ç§æ•°æ®åŒæ­¥æœºåˆ¶ï¼Œç”¨äºå°†æ•°æ®ä»ä¸€ä¸ªä¸»æ•°æ®åº“ï¼ˆmasterï¼‰å¤åˆ¶åˆ°ä¸€ä¸ªæˆ–å¤šä¸ªä»æ•°æ®åº“ï¼ˆslaveï¼‰ã€‚ç”¨äºæ•°æ®å¤‡ä»½ã€ç¾éš¾æ¢å¤å’Œæ•°æ®åˆ†æç­‰åœºæ™¯ã€‚</li>\n<li>åœ¨ä¸»æœåŠ¡å™¨ä¸Šï¼Œæ‰€æœ‰ä¿®æ”¹æ•°æ®çš„è¯­å¥ï¼ˆå¦‚ INSERTã€UPDATEã€DELETEï¼‰ä¼šè¢«è®°å½•åˆ°binlogæ—¥å¿—ä¸­ã€‚</li>\n<li>ä¸»æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªçº¿ç¨‹ï¼ˆäºŒè¿›åˆ¶æ—¥å¿—è½¬å‚¨çº¿ç¨‹ï¼‰è´Ÿè´£è¯»å–binlogæ—¥å¿—çš„å†…å®¹å¹¶å‘é€ç»™ä»æœåŠ¡å™¨ã€‚</li>\n<li>ä»æœåŠ¡å™¨æ¥æ”¶åˆ°äºŒè¿›åˆ¶æ—¥å¿—æ•°æ®åï¼Œä¼šå°†è¿™äº›æ•°æ®å†™å…¥è‡ªå·±çš„ä¸­ç»§æ—¥å¿—ï¼ˆRelay Logï¼‰ã€‚ä¸­ç»§æ—¥å¿—æ˜¯ä»æœåŠ¡å™¨ä¸Šçš„ä¸€ä¸ªæœ¬åœ°å­˜å‚¨</li>\n<li>ä»æœåŠ¡å™¨ä¸Šæœ‰ä¸€ä¸ª SQL çº¿ç¨‹ä¼šè¯»å–ä¸­ç»§æ—¥å¿—ï¼Œå¹¶åœ¨æœ¬åœ°æ•°æ®åº“ä¸Šæ‰§è¡Œï¼Œä»è€Œå°†æ›´æ”¹åº”ç”¨åˆ°ä»æ•°æ®åº“ä¸­ï¼Œå®ŒæˆåŒæ­¥ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/eb5eaa6b07dd6988b2e6e.png\" alt=\"mysqlslave.jpg\"></li>\n</ul>\n<h1>62. ä¸»ä»åŒæ­¥å»¶è¿Ÿæ€ä¹ˆå¤„ç†ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ä¸»ä»åŒæ­¥å»¶è¿Ÿçš„åŸå› :ä¸€ä¸ªæœåŠ¡å™¨å¼€æ”¾ï¼®ä¸ªé“¾æ¥ç»™å®¢æˆ·ç«¯æ¥è¿æ¥çš„ï¼Œè¿™æ ·æœ‰ä¼šæœ‰å¤§å¹¶å‘çš„æ›´æ–°æ“ä½œ,ä½†æ˜¯ä»æœåŠ¡å™¨çš„é‡Œé¢è¯»å–binlogçš„çº¿ç¨‹ä»…æœ‰ä¸€ä¸ªï¼Œå½“æŸä¸ªSQLåœ¨ä»æœåŠ¡å™¨ä¸Šæ‰§è¡Œçš„æ—¶é—´ç¨é•¿æˆ–è€…ç”±äºæŸä¸ªSQLè¦è¿›è¡Œé”è¡¨å°±ä¼šå¯¼è‡´ï¼Œä¸»æœåŠ¡å™¨çš„SQLå¤§é‡ç§¯å‹ï¼Œæœªè¢«åŒæ­¥åˆ°ä»æœåŠ¡å™¨é‡Œã€‚è¿™å°±å¯¼è‡´äº†ä¸»ä»ä¸ä¸€è‡´ï¼Œä¹Ÿå°±æ˜¯ä¸»ä»å»¶è¿Ÿã€‚</p>\n</li>\n<li>\n<p>å†™æ“ä½œåçš„è¯»æ“ä½œæŒ‡å®šå‘ç»™æ•°æ®åº“ä¸»æœåŠ¡å™¨.ä¾‹å¦‚ï¼Œæ³¨å†Œè´¦å·å®Œæˆåï¼Œç™»å½•æ—¶è¯»å–è´¦å·çš„è¯»æ“ä½œä¹Ÿå‘ç»™æ•°æ®åº“ä¸»æœåŠ¡å™¨ã€‚è¿™ç§æ–¹å¼å’Œä¸šåŠ¡å¼ºç»‘å®šï¼Œå¯¹ä¸šåŠ¡çš„ä¾µå…¥å’Œå½±å“è¾ƒå¤§ï¼Œå¦‚æœå“ªä¸ªæ–°æ¥çš„ç¨‹åºå‘˜ä¸çŸ¥é“è¿™æ ·å†™ä»£ç ï¼Œå°±ä¼šå¯¼è‡´ä¸€ä¸ªbugã€‚</p>\n</li>\n<li>\n<p>è¯»ä»æœºå¤±è´¥åå†è¯»ä¸€æ¬¡ä¸»æœºã€‚å³\"äºŒæ¬¡è¯»å–\"ï¼ŒäºŒæ¬¡è¯»å–å’Œä¸šåŠ¡æ— ç»‘å®šï¼Œåªéœ€è¦å¯¹åº•å±‚æ•°æ®åº“è®¿é—®çš„APIè¿›è¡Œå°è£…å³å¯ï¼Œå®ç°ä»£ä»·è¾ƒå°ï¼Œä¸è¶³ä¹‹å¤„åœ¨äºå¦‚æœæœ‰å¾ˆå¤šäºŒæ¬¡è¯»å–ï¼Œå°†å¤§å¤§å¢åŠ ä¸»æœºçš„è¯»æ“ä½œå‹åŠ›ã€‚ä¾‹å¦‚ï¼Œé»‘å®¢æš´åŠ›ç ´è§£è´¦å·ï¼Œä¼šå¯¼è‡´å¤§é‡çš„äºŒæ¬¡è¯»å–æ“ä½œï¼Œä¸»æœºå¯èƒ½é¡¶ä¸ä½è¯»æ“ä½œçš„å‹åŠ›ä»è€Œå´©æºƒã€‚</p>\n</li>\n<li>\n<p>å…³é”®ä¸šåŠ¡è¯»å†™æ“ä½œå…¨éƒ¨æŒ‡å‘ä¸»æœºï¼Œéå…³é”®ä¸šåŠ¡é‡‡ç”¨è¯»å†™åˆ†ç¦»ã€‚ä¾‹å¦‚ï¼Œå¯¹äºä¸€ä¸ªç”¨æˆ·ç®¡ç†ç³»ç»Ÿæ¥è¯´ï¼Œæ³¨å†Œ+ç™»å½•çš„ä¸šåŠ¡è¯»å†™æ“ä½œå…¨éƒ¨è®¿é—®ä¸»æœºï¼Œç”¨æˆ·çš„ä»‹ç»ã€çˆ°å¥½ã€ç­‰çº§ç­‰ä¸šåŠ¡ï¼Œå¯ä»¥é‡‡ç”¨è¯»å†™åˆ†ç¦»ï¼Œå› ä¸ºå³ä½¿ç”¨æˆ·æ”¹äº†è‡ªå·±çš„è‡ªæˆ‘ä»‹ç»ï¼Œåœ¨æŸ¥è¯¢æ—¶å´çœ‹åˆ°äº†è‡ªæˆ‘ä»‹ç»è¿˜æ˜¯æ—§çš„ï¼Œä¸šåŠ¡å½±å“ä¸ä¸èƒ½ç™»å½•ç›¸æ¯”å°±å°å¾ˆå¤šï¼Œè¿˜å¯ä»¥å¿å—ã€‚</p>\n</li>\n</ul>\n<h1>63. ç™¾ä¸‡çº§åˆ«ä»¥ä¸Šçš„æ•°æ®å¦‚ä½•åˆ é™¤ï¼Ÿ</h1>\n<ul>\n<li>ç”±äºç´¢å¼•éœ€è¦é¢å¤–çš„ç»´æŠ¤æˆæœ¬ï¼Œå› ä¸ºç´¢å¼•æ–‡ä»¶æ˜¯å•ç‹¬å­˜åœ¨çš„æ–‡ä»¶,æ‰€ä»¥å½“æˆ‘ä»¬å¯¹æ•°æ®çš„å¢åŠ ,ä¿®æ”¹,åˆ é™¤,éƒ½ä¼šäº§ç”Ÿé¢å¤–çš„å¯¹ç´¢å¼•æ–‡ä»¶çš„æ“ä½œ,è¿™äº›æ“ä½œéœ€è¦æ¶ˆè€—é¢å¤–çš„IO,ä¼šé™ä½å¢/æ”¹/åˆ çš„æ‰§è¡Œæ•ˆç‡ã€‚åœ¨åˆ é™¤æ•°æ®åº“ç™¾ä¸‡çº§åˆ«æ•°æ®çš„æ—¶å€™åˆ é™¤æ•°æ®çš„é€Ÿåº¦å’Œåˆ›å»ºçš„ç´¢å¼•æ•°é‡æ˜¯æˆæ­£æ¯”çš„ã€‚</li>\n<li>åˆ é™¤ç´¢å¼•</li>\n<li>åˆ é™¤å…¶ä¸­æ— ç”¨æ•°æ®</li>\n<li>é‡æ–°åˆ›å»ºç´¢å¼•</li>\n</ul>\n<h1>64. ç™¾ä¸‡åƒä¸‡çº§å¤§è¡¨å¦‚ä½•æ·»åŠ å­—æ®µï¼Ÿ</h1>\n<ul>\n<li>é€šè¿‡ä¸­é—´è¡¨è½¬æ¢è¿‡å»ï¼Œåˆ›å»ºä¸€ä¸ªä¸´æ—¶çš„æ–°è¡¨ï¼ŒæŠŠæ—§è¡¨çš„ç»“æ„å®Œå…¨å¤åˆ¶è¿‡å»ï¼Œæ·»åŠ å­—æ®µï¼Œå†æŠŠæ—§è¡¨æ•°æ®å¤åˆ¶è¿‡å»ï¼Œåˆ é™¤æ—§è¡¨ï¼Œæ–°è¡¨å‘½åä¸ºæ—§è¡¨çš„åç§°ï¼Œè¿™ç§æ–¹å¼å¯èƒ½å›ä¸¢æ‰ä¸€äº›æ•°æ®ã€‚</li>\n<li>ç”¨pt-online-schema-changeæ˜¯perconaå…¬å¸å¼€å‘çš„ä¸€ä¸ªå·¥å…·ï¼Œå®ƒå¯ä»¥åœ¨çº¿ä¿®æ”¹è¡¨ç»“æ„ï¼Œå®ƒçš„åŸç†ä¹Ÿæ˜¯é€šè¿‡ä¸­é—´è¡¨ã€‚</li>\n<li>å…ˆåœ¨ä»åº“æ·»åŠ å†è¿›è¡Œä¸»ä»åˆ‡æ¢ï¼šå¦‚æœä¸€å¼ è¡¨æ•°æ®é‡å¤§ä¸”æ˜¯çƒ­è¡¨ï¼ˆè¯»å†™ç‰¹åˆ«é¢‘ç¹ï¼‰ï¼Œåˆ™å¯ä»¥è€ƒè™‘å…ˆåœ¨ä»åº“æ·»åŠ ï¼Œå†è¿›è¡Œä¸»ä»åˆ‡æ¢ï¼Œåˆ‡æ¢åå†å°†å…¶ä»–å‡ ä¸ªèŠ‚ç‚¹ä¸Šæ·»åŠ å­—æ®µã€‚</li>\n</ul>\n<h1>66. mysqlè‡ªå¢idç”¨å®Œæ€ä¹ˆåŠ?</h1>\n<ul>\n<li>è¡¨å®šä¹‰çš„è‡ªå¢å€¼è¾¾åˆ°ä¸Šé™åï¼Œå†ç”³è¯·æ—¶å€¼ä¿æŒä¸å˜ã€‚å¯¼è‡´ç»§ç»­æ’å…¥æ•°æ®æ—¶æŠ¥ä¸»é”®å†²çªçš„é”™è¯¯</li>\n<li>æ— ä¸»é”®è‡ªå¢row_id 6å­—èŠ‚(0åˆ°2^48-1)è¾¾åˆ°ä¸Šé™åä¼šå½’0é‡æ–°é€’å¢ã€‚å¦‚æœå‡ºç°ç›¸åŒçš„row_idåˆ™è¦†ç›–åŸæœ‰çš„æ•°æ®ã€‚InnoDBç»´æŠ¤äº†ä¸€ä¸ªå…¨å±€çš„dict_sys.row_idå€¼ï¼Œæ‰€æœ‰æ— ä¸»é”®çš„InnoDBè¡¨ï¼Œæ¯æ’å…¥ä¸€è¡Œæ•°æ®ï¼Œéƒ½å°†å½“å‰çš„dict_sys.row_idå€¼ä½œä¸ºè¦æ’å…¥æ•°æ®çš„row_idï¼Œç„¶åæŠŠdict_sys.row_idçš„å€¼åŠ 1</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/ffe5c6730d04f821f724c.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "é—®é¢˜è§£å†³",
      "url": "https://javaguide.cn/interview/problemsolve.html",
      "id": "https://javaguide.cn/interview/problemsolve.html",
      "summary": "é—®é¢˜æ’æŸ¥ æ‰¾å‡ºé‚£ä¸ªè¿›ç¨‹å‡ºé—®é¢˜ï¼Œæ‰§è¡Œtopåˆ—å‡ºç³»ç»Ÿå„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨æƒ…å†µã€‚ top.pngtop.png æ‰¾åˆ°CPUæˆ–è€…å†…å­˜é«˜çš„è¿›ç¨‹ï¼Œæ‰§è¡Œtop -Hp ã€pidã€‘åˆ—å‡ºå¯¹åº”è¿›ç¨‹é‡Œé¢çš„çº¿ç¨‹å ç”¨èµ„æºæƒ…å†µ tophp.pngtophp.png javaè¿›ç¨‹CPU 100% æ‰“å°å †æ ˆä¿¡æ¯jstack [pid] | grep -A 10 [tidçš„åå…­è¿›åˆ¶ pr...",
      "content_html": "<!--more-->\n<h1>é—®é¢˜æ’æŸ¥</h1>\n<ul>\n<li>æ‰¾å‡ºé‚£ä¸ªè¿›ç¨‹å‡ºé—®é¢˜ï¼Œæ‰§è¡Œtopåˆ—å‡ºç³»ç»Ÿå„ä¸ªè¿›ç¨‹çš„èµ„æºå ç”¨æƒ…å†µã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0dcfd52cf39085f7207e5.jpg\" alt=\"top.png\" tabindex=\"0\"><figcaption>top.png</figcaption></figure>\n<ul>\n<li>æ‰¾åˆ°CPUæˆ–è€…å†…å­˜é«˜çš„è¿›ç¨‹ï¼Œæ‰§è¡Œtop -Hp ã€pidã€‘åˆ—å‡ºå¯¹åº”è¿›ç¨‹é‡Œé¢çš„çº¿ç¨‹å ç”¨èµ„æºæƒ…å†µ</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/544496f7094b3e0bf4356.jpg\" alt=\"tophp.png\" tabindex=\"0\"><figcaption>tophp.png</figcaption></figure>\n<h2>javaè¿›ç¨‹CPU 100%</h2>\n<ul>\n<li>æ‰“å°å †æ ˆä¿¡æ¯jstack [pid] | grep -A 10 [tidçš„åå…­è¿›åˆ¶ printf \"%x\" çº¿ç¨‹id]</li>\n<li>å¯¼å‡ºè¯¥çº¿ç¨‹çš„å †æ ˆä¿¡æ¯ï¼ˆjstack pidï¼‰&gt; log.txtï¼Œçº¿ç¨‹æ ˆåˆ†æå¯ä½¿ç”¨ VisualVM æ’ä»¶ TDAã€‚</li>\n<li>é‡ç‚¹å…³æ³¨ï¼šWAITING/BLOCKED</li>\n<li>æ‰¾åˆ°çº¿ç¨‹ä¸­waiting on <code>&lt;xx&gt;</code>æˆ– blockedçš„éƒ½æœ‰å“ªäº›ï¼Œæ ¹æ®é”çš„åœ°å€æ‰¾åˆ°æ˜¯å“ªä¸ªçº¿ç¨‹æŒæœ‰<code>&lt;xx&gt;</code>è¿™æŠŠé”ï¼Œé‡Œé¢æœ‰ä»£ç è¡Œæ•°</li>\n</ul>\n<h2>mysqlæ­»é”ï¼Ÿ</h2>\n<ul>\n<li>ä½¿ç”¨JDKè‡ªå¸¦çš„ä¸€äº›æ€§èƒ½ç›‘æ§å·¥å…·è¿›è¡Œæ’æŸ¥ï¼Œæ¯”å¦‚è¯´jpsã€jstatã€jinfoã€jmapã€jstackã€jcmdç­‰ç­‰ã€‚</li>\n<li>ä½¿ç”¨jstackè¿›ç¨‹å·æŸ¥çœ‹å½“å‰Javaè¿›ç¨‹çš„çº¿ç¨‹å †æ ˆä¿¡æ¯ï¼Œçœ‹çœ‹æ˜¯å¦æœ‰çº¿ç¨‹åœ¨ç­‰å¾…é”èµ„æº<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8c55500fa63a5b8c34e0f.png\" alt=\"javadeadlockjps.png\"></li>\n</ul>\n<p>æ’æŸ¥æ­»é”æ­¥éª¤ï¼š</p>\n<ul>\n<li>æŸ¥çœ‹æ­»é”æ—¥å¿—show engine innodb status;LATESTDETECTED DEADLOCKè®°å½•æœ€åçš„æ­»é”ä¿¡æ¯ï¼ŒTRANSACTIONæ˜¯äº‹åŠ¡ä¿¡æ¯</li>\n<li>æ‰¾å‡ºæ­»é”sql</li>\n<li>åˆ†æsqlåŠ é”æƒ…å†µ</li>\n<li>æ¨¡æ‹Ÿæ­»é”æ¡ˆå‘</li>\n<li>åˆ†ææ­»é”æ—¥å¿—</li>\n<li>åˆ†ææ­»é”ç»“æœ</li>\n</ul>\n<h2>javaè¿›ç¨‹å†…å­˜Mem 100%</h2>\n<ul>\n<li>ä¸€èˆ¬æ˜¯å› ä¸ºåˆ›å»ºäº†å¤§é‡å¯¹è±¡æ‰€å¯¼è‡´ï¼ŒæŒç»­é£šé«˜è¯´æ˜åƒåœ¾å›æ”¶è·Ÿä¸ä¸Šå¯¹è±¡åˆ›å»ºçš„é€Ÿåº¦ï¼Œæˆ–è€…å†…å­˜æ³„éœ²å¯¼è‡´å¯¹è±¡æ— æ³•å›æ”¶ã€‚</li>\n<li>å…ˆè§‚å¯Ÿåƒåœ¾å›æ”¶çš„æƒ…å†µï¼Œçœ‹çœ‹æ˜¯ä¸æ˜¯å› ä¸ºæŒä¹…ä»£æˆ–å¹´è€ä»£æ»¡äº†ï¼Œäº§ç”ŸFull GCï¼Œå¯¼è‡´CPUåˆ©ç”¨ç‡å’Œå†…å­˜æŒç»­é£™é«˜\n<ul>\n<li>ç›‘æ§ç³»ç»Ÿï¼šå¤§éƒ¨åˆ†å…¬å¸éƒ½ä¼šæœ‰ï¼Œå¯å…¨æ–¹ä½ç›‘æ§ JVM çš„å„é¡¹æŒ‡æ ‡ã€‚</li>\n<li>æŸ¥çœ‹æ¦‚å†µjstat -gcutil PID 1000 5ç›‘æ§gcï¼Œæ¯1s è¾“å‡ºä¸€æ¬¡ï¼Œä¸€å…± 5 æ¬¡ã€‚\n<ul>\n<li>S0ã€S1ï¼šSurvivorç©ºé—´0å’Œ1çš„ä½¿ç”¨ç‡ï¼ˆä»¥ç™¾åˆ†æ¯”è¡¨ç¤ºï¼‰ã€‚</li>\n<li>Eï¼šEdenåŒºçš„ä½¿ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰ã€‚</li>\n<li>Oï¼šè€å¹´ä»£çš„ä½¿ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼‰ã€‚</li>\n<li>Mï¼šMetaspaceçš„ä½¿ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼ŒJava 8åŠä»¥åç‰ˆæœ¬ï¼‰ã€‚</li>\n<li>CCSï¼šå‹ç¼©ç±»ç©ºé—´çš„ä½¿ç”¨ç‡ï¼ˆç™¾åˆ†æ¯”ï¼Œå¦‚æœå­˜åœ¨ï¼‰ã€‚</li>\n<li>YGCï¼šMinor GCæ¬¡æ•°ã€‚</li>\n<li>YGCTï¼šMinor GCè€—æ—¶ï¼ˆç§’ï¼‰ã€‚</li>\n<li>FGCï¼šFull GCæ¬¡æ•°ã€‚</li>\n<li>FGCTï¼šFull GCè€—æ—¶ï¼ˆç§’ï¼‰ã€‚</li>\n<li>GCTï¼šGCæ€»è€—æ—¶ï¼ˆç§’ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f2a965b44585b2777b677.jpg\" alt=\"jstatgcutil.png\" tabindex=\"0\"><figcaption>jstatgcutil.png</figcaption></figure>\n<ul>\n<li>æŸ¥è¯¢è¯¦ç»†jstat -gc -h3 PID 250 10ç›‘æ§gcï¼Œæ¯ä¸‰è¡Œè¾“å‡ºä¸€æ¬¡è¡¨å¤´ ï¼Œæ¯250ms è¾“å‡ºä¸€æ¬¡ï¼Œä¸€å…± 10 æ¬¡ã€‚\n<ul>\n<li>S0Cã€S1Cã€S0Uã€S1Uï¼šSurvivorç©ºé—´0å’Œ1çš„å®¹é‡ï¼ˆCapacityï¼‰å’Œä½¿ç”¨é‡ï¼ˆUsageï¼‰ã€‚</li>\n<li>ECã€EUï¼šEdenåŒºçš„å®¹é‡å’Œä½¿ç”¨é‡KBã€‚</li>\n<li>OCã€OUï¼šè€å¹´ä»£çš„å®¹é‡å’Œä½¿ç”¨é‡ã€‚</li>\n<li>MCã€MUï¼šMetaspaceå…ƒæ•°æ®åŒºçš„å®¹é‡å’Œä½¿ç”¨é‡ï¼ˆåœ¨Java 8åŠä»¥åç‰ˆæœ¬ï¼‰ã€‚</li>\n<li>CCSCã€CCSUï¼šå‹ç¼©ç±»ç©ºé—´çš„å®¹é‡å’Œä½¿ç”¨é‡ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ã€‚</li>\n<li>YGCã€YGCTï¼šMinor GCï¼ˆæ–°ç”Ÿä»£GCï¼‰çš„æ¬¡æ•°å’Œæ€»è€—æ—¶ã€‚</li>\n<li>FGCã€FGCTï¼šFull GCçš„æ¬¡æ•°å’Œæ€»è€—æ—¶ã€‚</li>\n<li>GCTï¼šGCçš„æ€»è€—æ—¶ï¼ˆMinor GCå’ŒFull GCçš„æ€»å’Œï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/bc00ae1d99e53ed81ef0a.jpg\" alt=\"jstatgc.png\" tabindex=\"0\"><figcaption>jstatgc.png</figcaption></figure>\n<ul>\n<li>jmap -histo PID | head -20 æŸ¥çœ‹å †å†…å­˜å ç”¨ç©ºé—´æœ€å¤§çš„å‰ 20 ä¸ªå¯¹è±¡ç±»å‹,å¯åˆæ­¥æŸ¥çœ‹æ˜¯å“ªä¸ªå¯¹è±¡å ç”¨äº†å†…å­˜ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/007d82138398ee26a1dd7.jpg\" alt=\"jmaphisto.png\" tabindex=\"0\"><figcaption>jmaphisto.png</figcaption></figure>\n<ul>\n<li>å¦‚æœæ¯æ¬¡ GC æ¬¡æ•°é¢‘ç¹ï¼Œè€Œä¸”æ¯æ¬¡å›æ”¶çš„å†…å­˜ç©ºé—´ä¹Ÿæ­£å¸¸ï¼Œé‚£è¯´æ˜æ˜¯å› ä¸ºå¯¹è±¡åˆ›å»ºé€Ÿåº¦å¿«å¯¼è‡´å†…å­˜ä¸€ç›´å ç”¨å¾ˆé«˜ï¼›</li>\n<li>å¦‚æœæ¯æ¬¡å›æ”¶çš„å†…å­˜éå¸¸å°‘ï¼Œé‚£ä¹ˆå¾ˆå¯èƒ½æ˜¯å› ä¸ºå†…å­˜æ³„éœ²å¯¼è‡´å†…å­˜ä¸€ç›´æ— æ³•è¢«å›æ”¶ã€‚</li>\n<li>å¯¼å‡ºå †å†…å­˜å¤šæ¬¡\n<ul>\n<li>(æ¨è)jmap â€dump:format=b,file=/tmp/dump.hprof pid</li>\n<li>å¼€å¯HeapDumpOnOutOfMemoryErrorä¼šstoptheworld(åˆ†å¸ƒå¼) â€Xms8m â€Xmx8m â€XX:+HeapDumpOnOutOfMemoryError -XX:HeapDumpPath=./heapdump.hprofæº¢å‡ºæ—¶è‡ªåŠ¨ç”Ÿæˆ java_pidxxxx.hprof</li>\n</ul>\n</li>\n<li>ç¦»çº¿åˆ†æ\n<ul>\n<li>ä½¿ç”¨jhatå·¥å…·ï¼šjhat â€port 9999 /tmp/dump.dat ï¼Œè®¿é—®<a href=\"http://ip:9999\" target=\"_blank\" rel=\"noopener noreferrer\">http://ip:9999</a> é€šè¿‡OQLæŸ¥è¯¢</li>\n<li>(æ¨è)ä¸‹è½½jvisualvmå·¥å…·ï¼Œé«˜ç‰ˆæœ¬ä¸è‡ªå¸¦ï¼Œéœ€è¦é…ç½®æœ¬åœ°etc/visualvm_jdkhomeï¼šèœå• &gt; æ–‡ä»¶ &gt; è£…å…¥ dump æ–‡ä»¶ã€‚ï¼Œé€šè¿‡summaryæŸ¥è¯¢ï¼›æˆ–è€…è¿œç¨‹è¿æ¥åˆ«çš„jvm<br>\nâ€ Dcom.sun.management.jmxremote #å…è®¸ä½¿ç”¨JMXè¿œç¨‹ç®¡ç†<br>\nâ€ Dcom.sun.management.jmxremote.port=9999 #JMXè¿œç¨‹è¿æ¥ç«¯å£\n<ul>\n<li>Dcom.sun.management.jmxremote.authenticate=false #ä¸è¿›è¡Œèº«ä»½è®¤è¯ï¼Œä»»ä½•ç”¨</li>\n<li>Dcom.sun.management.jmxremote.ssl=false #ä¸ä½¿ç”¨ssl</li>\n</ul>\n</li>\n<li>jprofilerå•†ä¸šè½¯ä»¶,GCViewer å·¥å…·ã€‚</li>\n<li>åœ¨çº¿åˆ†æå¹³å° GCEasyã€‚</li>\n<li>ä½¿ç”¨MATå·¥å…·(åŸºäºEclipseå…è´¹)åˆ†æå†…å­˜æº¢å‡ºï¼ŒæŸ¥çœ‹Leak Suspects</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b2f191c4405c1d75c38d4.png\" alt=\"matanalyze.png\" tabindex=\"0\"><figcaption>matanalyze.png</figcaption></figure>\n<ul>\n<li>\n<p>é—®é¢˜è§£å†³</p>\n<ul>\n<li>é¢‘ç¹ minor gc æ€ä¹ˆåŠï¼Ÿé€šå¸¸æƒ…å†µä¸‹ï¼Œç”±äºæ–°ç”Ÿä»£ç©ºé—´è¾ƒå°ï¼ŒEden åŒºå¾ˆå¿«è¢«å¡«æ»¡ï¼Œå°±ä¼šå¯¼è‡´é¢‘ç¹Minor GCï¼Œå¯é€šè¿‡å¢å¤§æ–°ç”Ÿä»£ç©ºé—´-Xmnæ¥é™ä½ Minor GCé¢‘ç‡</li>\n<li>é¢‘ç¹ Full GC /å†…å­˜æ³„æ¼é—®é¢˜æ€ä¹ˆåŠï¼Ÿ\n<ul>\n<li>ç¨‹åºå¯¼è‡´ FGCåŸå› \n<ul>\n<li>å¤§å¯¹è±¡ï¼šç³»ç»Ÿä¸€æ¬¡æ€§åŠ è½½äº†è¿‡å¤šæ•°æ®åˆ°å†…å­˜ä¸­ï¼ˆæ¯”å¦‚ SQL æŸ¥è¯¢æœªåšåˆ†é¡µï¼‰ï¼Œå¯¼è‡´å¤§å¯¹è±¡è¿›å…¥äº†è€å¹´ä»£ã€‚</li>\n<li>å†…å­˜æ³„æ¼ï¼šé¢‘ç¹åˆ›å»ºäº†å¤§é‡å¯¹è±¡ï¼Œä½†æ˜¯æ— æ³•è¢«å›æ”¶ï¼ˆæ¯”å¦‚ IO å¯¹è±¡ä½¿ç”¨å®Œåæœªè°ƒç”¨ close æ–¹æ³•é‡Šæ”¾èµ„æºï¼‰</li>\n<li>ç¨‹åºé¢‘ç¹ç”Ÿæˆä¸€äº›é•¿ç”Ÿå‘½å‘¨æœŸçš„å¯¹è±¡ï¼Œå½“è¿™äº›å¯¹è±¡çš„å­˜æ´»å¹´é¾„è¶…è¿‡åˆ†ä»£å¹´é¾„æ—¶ä¾¿ä¼šè¿›å…¥è€å¹´ä»£ï¼Œ</li>\n<li>ç¨‹åº BUG</li>\n<li>ä»£ç ä¸­æ˜¾å¼è°ƒç”¨äº† gcæ–¹æ³•ï¼ŒåŒ…æ‹¬è‡ªå·±çš„ä»£ç ç”šè‡³æ¡†æ¶ä¸­çš„ä»£ç ã€‚</li>\n<li>JVM å‚æ•°è®¾ç½®é—®é¢˜ï¼šåŒ…æ‹¬æ€»å†…å­˜å¤§å°ã€æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„å¤§å°ã€EdenåŒºå’ŒSåŒºçš„å¤§å°ã€å…ƒç©ºé—´å¤§å°ã€åƒåœ¾å›æ”¶ç®—æ³•ç­‰ç­‰</li>\n</ul>\n</li>\n<li>æŸ¥çœ‹ç›‘æ§ï¼Œäº†è§£å‡ºç°é—®é¢˜çš„æ—¶é—´ç‚¹ä»¥åŠå½“å‰ FGC çš„é¢‘ç‡ï¼ˆå¯å¯¹æ¯”æ­£å¸¸æƒ…å†µçœ‹é¢‘ç‡æ˜¯å¦æ­£å¸¸ï¼‰</li>\n<li>äº†è§£è¯¥æ—¶é—´ç‚¹ä¹‹å‰æœ‰æ²¡æœ‰ç¨‹åºä¸Šçº¿ã€åŸºç¡€ç»„ä»¶å‡çº§ç­‰æƒ…å†µã€‚</li>\n<li>å†å¯¹æ­¥éª¤ 1 ä¸­åˆ—å‡ºçš„å¯èƒ½åŸå› åšæ’é™¤æ³•ï¼Œå…¶ä¸­å…ƒç©ºé—´è¢«æ‰“æ»¡ã€å†…å­˜æ³„æ¼ã€ä»£ç æ˜¾å¼è°ƒç”¨ gc æ–¹æ³•æ¯”è¾ƒå®¹æ˜“æ’æŸ¥ã€‚</li>\n<li>é’ˆå¯¹å¤§å¯¹è±¡æˆ–è€…é•¿ç”Ÿå‘½å‘¨æœŸå¯¹è±¡å¯¼è‡´çš„ FGCï¼Œå¯é€šè¿‡ jmap -histo å‘½ä»¤å¹¶ç»“åˆ dump å †å†…å­˜æ–‡ä»¶ä½œè¿›ä¸€æ­¥åˆ†æï¼Œéœ€è¦å…ˆå®šä½åˆ°å¯ç–‘å¯¹è±¡ã€‚</li>\n<li>é€šè¿‡å¯ç–‘å¯¹è±¡å®šä½åˆ°å…·ä½“ä»£ç å†æ¬¡åˆ†æï¼Œè¿™æ—¶å€™è¦ç»“åˆ GC åŸç†å’Œ JVM å‚æ•°è®¾ç½®ï¼Œå¼„æ¸…æ¥šå¯ç–‘å¯¹è±¡æ˜¯å¦æ»¡è¶³äº†è¿›å…¥åˆ°è€å¹´ä»£çš„æ¡ä»¶æ‰èƒ½ä¸‹ç»“è®ºã€‚</li>\n<li>äº†è§£ JVM çš„å‚æ•°è®¾ç½®ï¼ŒåŒ…æ‹¬ï¼šå †ç©ºé—´å„ä¸ªåŒºåŸŸçš„å¤§å°è®¾ç½®ï¼Œæ–°ç”Ÿä»£å’Œè€å¹´ä»£åˆ†åˆ«é‡‡ç”¨äº†å“ªäº›åƒåœ¾æ”¶é›†å™¨ï¼Œç„¶ååˆ†æ JVM å‚æ•°è®¾ç½®æ˜¯å¦åˆç†ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>æŸ¥è¯¢æœ‰å¤šå°‘å°æœºå™¨è¿æ¥åˆ°è¿™ä¸ªç«¯å£netstat -nat | grep 12200 â€“c</p>\n</li>\n<li>\n<p>æŸ¥çœ‹ç½‘ç»œæµé‡ã€‚cat /proc/net/dev</p>\n</li>\n<li>\n<p>æŸ¥çœ‹ç³»ç»Ÿå¹³å‡è´Ÿè½½ã€‚cat /proc/loadavg</p>\n</li>\n<li>\n<p>æŸ¥çœ‹ç³»ç»Ÿå†…å­˜æƒ…å†µã€‚cat /proc/meminfo</p>\n</li>\n<li>\n<p>æŸ¥çœ‹CPUçš„åˆ©ç”¨ç‡ã€‚cat /proc/stat</p>\n</li>\n</ul>\n<h2>1.3. mysqlCPU100%/å†…å­˜100%</h2>\n<ul>\n<li>showprocesslistï¼ŒæŸ¥çœ‹sessionæƒ…å†µï¼Œç¡®å®šæ˜¯ä¸æ˜¯æœ‰æ¶ˆè€—èµ„æºçš„sqlåœ¨è¿è¡Œã€‚</li>\n<li>æ‰¾å‡ºæ¶ˆè€—é«˜çš„sqlï¼Œçœ‹çœ‹æ‰§è¡Œè®¡åˆ’æ˜¯å¦å‡†ç¡®ï¼Œç´¢å¼•æ˜¯å¦ç¼ºå¤±ï¼Œæ•°æ®é‡æ˜¯å¦å¤ªå¤§ã€‚</li>\n<li>æŸ¥çœ‹ MySQL æ…¢æŸ¥è¯¢æ—¥å¿—ï¼Œçœ‹æ˜¯å¦æœ‰æ…¢ SQL ã€‚</li>\n<li>å¤„ç†ï¼š\n<ul>\n<li>killæ‰è¿™äº›çº¿ç¨‹(åŒæ—¶è§‚å¯Ÿcpuä½¿ç”¨ç‡æ˜¯å¦ä¸‹é™)ï¼Œ</li>\n<li>è¿›è¡Œç›¸åº”çš„è°ƒæ•´(æ¯”å¦‚è¯´åŠ ç´¢å¼•ã€æ”¹sqlã€æ”¹å†…å­˜å‚æ•°)</li>\n<li>é‡æ–°è·‘è¿™äº›SQLã€‚</li>\n<li>ä¼˜åŒ–æˆ–è€…æ·»åŠ ç´¢å¼•</li>\n</ul>\n</li>\n</ul>\n<h1>2. å¾®æœåŠ¡é«˜å¯ç”¨é…ç½®</h1>\n<ul>\n<li>nacos + MySQL 4C 8G 3èŠ‚ç‚¹ 4000TPS</li>\n<li>gateway 4C 8G 3èŠ‚ç‚¹ å¯ç”¨HTTPS+GZIP 1wQPS</li>\n<li>zookeeper 4C 8G 3èŠ‚ç‚¹ 4000TPS</li>\n<li>alibaba Sentinel + nacos + MySQL 3èŠ‚ç‚¹</li>\n<li>rabbitmq 3èŠ‚ç‚¹ é•œåƒé›†ç¾¤æ¨¡å¼</li>\n<li>Elasticsearch 3èŠ‚ç‚¹</li>\n<li>mysql MGR 1ä¸»2ä» 3èŠ‚ç‚¹</li>\n<li>skywalking + nacos 2èŠ‚ç‚¹</li>\n<li>XXL-JOB 2èŠ‚ç‚¹</li>\n<li>RocketMQ 1ä¸»2ä»</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/94a93ae3261174a41f896.jpg\" alt=\"nacos.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/caab71e44ec86eb81791c.jpg\" alt=\"gateway.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e9ad99261d364d09b1e32.jpg\" alt=\"zookeeper.png\"></p>\n<h1>3. é¡¹ç›®éš¾ç‚¹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4c4b49aab79ea76a06c7b.png\" alt=\"jvmadjust.png\" tabindex=\"0\"><figcaption>jvmadjust.png</figcaption></figure>\n<ul>\n<li>æ¡ˆä¾‹ï¼šç”µå•†å…¬å¸çš„è¿è¥åå°ç³»ç»Ÿï¼Œå¶å‘æ€§çš„å¼•å‘ OOM å¼‚å¸¸ï¼Œå †å†…å­˜æº¢å‡ºã€‚\n<ul>\n<li>1ï¼‰å› ä¸ºæ˜¯å¶å‘æ€§çš„ï¼Œæ‰€ä»¥ç¬¬ä¸€æ¬¡ç®€å•çš„è®¤ä¸ºå°±æ˜¯å †å†…å­˜ä¸è¶³å¯¼è‡´ï¼Œå•æ–¹é¢çš„åŠ å¤§äº†å †å†…å­˜ä» 4G è°ƒæ•´åˆ° 8G -Xms8gã€‚</li>\n<li>2ï¼‰é—®é¢˜ä¾ç„¶æ²¡æœ‰è§£å†³ï¼Œåªèƒ½ä»å †å†…å­˜ä¿¡æ¯ä¸‹æ‰‹ï¼Œé€šè¿‡å¼€å¯äº†-XX:+HeapDumpOnOutOfMemoryErrorå‚æ•° è·å¾—å †å†…å­˜çš„ dump æ–‡ä»¶</li>\n<li>3ï¼‰ç”¨ JProfiler å¯¹ å † dump æ–‡ä»¶è¿›è¡Œåˆ†æï¼Œé€šè¿‡ JProfiler æŸ¥çœ‹åˆ°å ç”¨å†…å­˜æœ€å¤§çš„å¯¹è±¡æ˜¯ String å¯¹è±¡ï¼Œæœ¬æ¥æƒ³è·Ÿè¸ªç€ String å¯¹è±¡æ‰¾åˆ°å…¶å¼•ç”¨çš„åœ°æ–¹ï¼Œä½† dump æ–‡ä»¶å¤ªå¤§ï¼Œè·Ÿè¸ªè¿›å»çš„æ—¶å€™æ€»æ˜¯å¡æ­»ï¼Œè€Œ String å¯¹è±¡å ç”¨æ¯”è¾ƒå¤šä¹Ÿæ¯”è¾ƒæ­£å¸¸ï¼Œæœ€å¼€å§‹ä¹Ÿæ²¡æœ‰è®¤å®šå°±æ˜¯è¿™é‡Œçš„é—®é¢˜ï¼Œäºæ˜¯å°±ä»çº¿ç¨‹ä¿¡æ¯é‡Œé¢æ‰¾çªç ´ç‚¹ã€‚</li>\n<li>4ï¼‰é€šè¿‡çº¿ç¨‹è¿›è¡Œåˆ†æï¼Œå…ˆæ‰¾åˆ°äº†å‡ ä¸ªæ­£åœ¨è¿è¡Œçš„ä¸šåŠ¡çº¿ç¨‹ï¼Œç„¶åé€ä¸€è·Ÿè¿›ä¸šåŠ¡çº¿ç¨‹çœ‹äº†ä¸‹ä»£ç ï¼Œæœ‰ä¸ªæ–¹æ³•å¼•èµ·äº†æˆ‘çš„æ³¨æ„ï¼Œå¯¼å‡ºè®¢å•ä¿¡æ¯</li>\n<li>5ï¼‰å› ä¸ºè®¢å•ä¿¡æ¯å¯¼å‡ºè¿™ä¸ªæ–¹æ³•å¯èƒ½ä¼šæœ‰å‡ ä¸‡çš„æ•°æ®é‡ï¼Œé¦–å…ˆè¦ä»æ•°æ®åº“é‡Œé¢æŸ¥è¯¢å‡ºæ¥è®¢å•ä¿¡æ¯ï¼Œç„¶åæŠŠè®¢å•ä¿¡æ¯ç”Ÿæˆ excelï¼Œè¿™ä¸ªè¿‡ç¨‹ä¼šäº§ç”Ÿå¤§é‡çš„ String å¯¹è±¡ã€‚</li>\n<li>6ï¼‰ä¸ºäº†éªŒè¯è‡ªå·±çš„çŒœæƒ³ï¼Œäºæ˜¯å‡†å¤‡ç™»å½•åå°å»æµ‹è¯•ä¸‹ï¼Œç»“æœåœ¨æµ‹è¯•çš„è¿‡ç¨‹ä¸­å‘ç°å¯¼å‡ºè®¢å•çš„æŒ‰é’®å‰ç«¯å±…ç„¶æ²¡æœ‰åšç‚¹å‡»åæŒ‰é’®ç½®ç°äº¤äº’äº‹ä»¶ï¼Œåç«¯ä¹Ÿæ²¡æœ‰åšé˜²æ­¢é‡å¤æäº¤ï¼Œå› ä¸ºå¯¼å‡ºè®¢å•æ•°æ®æœ¬æ¥å°±éå¸¸æ…¢ï¼Œä½¿ç”¨çš„äººå‘˜å¯èƒ½å‘ç°ç‚¹å‡»åå¾ˆä¹…åé¡µé¢éƒ½æ²¡ååº”ï¼Œç„¶åå°±ä¸€ç›´ç‚¹ï¼Œç»“æœå°±å¤§é‡çš„è¯·æ±‚è¿›å…¥åˆ°åå°ï¼Œå †å†…å­˜äº§ç”Ÿäº†å¤§é‡çš„è®¢å•å¯¹è±¡å’Œ EXCEL å¯¹è±¡ï¼Œè€Œä¸”æ–¹æ³•æ‰§è¡Œéå¸¸æ…¢ï¼Œå¯¼è‡´è¿™ä¸€æ®µæ—¶é—´å†…è¿™äº›å¯¹è±¡éƒ½æ— æ³•è¢«å›æ”¶ï¼Œæ‰€ä»¥æœ€ç»ˆå¯¼è‡´å†…å­˜æº¢å‡ºã€‚</li>\n<li>7ï¼‰çŸ¥é“äº†é—®é¢˜å°±å®¹æ˜“è§£å†³äº†ï¼Œæœ€ç»ˆæ²¡æœ‰è°ƒæ•´ä»»ä½• JVM å‚æ•°ï¼Œåªæ˜¯åšäº†ä¸¤ä¸ªå¤„ç†ï¼š\n<ul>\n<li>åœ¨å‰ç«¯çš„å¯¼å‡ºè®¢å•æŒ‰é’®ä¸ŠåŠ ä¸Šäº†ç½®ç°çŠ¶æ€ï¼Œç­‰åç«¯å“åº”ä¹‹åæŒ‰é’®æ‰å¯ä»¥è¿›è¡Œç‚¹å‡»</li>\n<li>åç«¯ä»£ç åŠ åˆ†å¸ƒå¼é”ï¼Œåšé˜²é‡å¤„ç†</li>\n<li>è¿™æ ·åŒç®¡é½ä¸‹ï¼Œä¿è¯å¯¼å‡ºçš„è¯·æ±‚ä¸ä¼šä¸€ç›´æ‰“åˆ°æœåŠ¡ç«¯ï¼Œé—®é¢˜è§£å†³ï¼</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>4. sqlä¼˜åŒ–</h1>\n<h2>4.1. å¼€å¯æ…¢æŸ¥è¯¢æ—¥å¿—</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>my.cnfé…ç½®æˆ–è€…--log-slow-queries[=file_name]é€‰é¡¹å¯åŠ¨\nslow_query_log = ON\nslow_query_log_file = /usr/local/mysql/data/slowselect.log\nlong_query_time = 1 #è¶…è¿‡1ç§’åˆ™ä¸ºæ…¢æŸ¥è¯¢\n\n# æ£€æŸ¥æ…¢æŸ¥æ—¥å¿—æ˜¯å¦å¼€å¯/é˜ˆå€¼ï¼ˆé»˜è®¤10sï¼‰/ä½ç½®\nmysql&gt; show variables like 'slow_query_log'\nmysql&gt; show VARIABLES like 'long_query_time';\nmysql&gt; show variables like 'slow_query_log_file';\n\n\n# æ£€æŸ¥æ…¢æŸ¥æ—¥å¿—å¼€å¯/ä½ç½®/é˜ˆå€¼\nmysql&gt; set slow_query_log='ON';\nmysql&gt; set long_query_time = 2;\nmysql&gt; set slow_query_log_file=' /usr/share/mysql/sql_log/mysql-slow.log' \n\n# æŸ¥çœ‹æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚\nshell&gt; more localhost-slow.log\n\n# æ…¢æŸ¥è¯¢æ—¥å¿—å­˜å‚¨æ ¼å¼\n  # Time: 180526  1:06:54 æŸ¥è¯¢çš„æ‰§è¡Œæ—¶é—´\n  # User@Host: root[root] @ localhost []  Id:4  æ‰§è¡Œsqlçš„ä¸»æœºä¿¡æ¯\n  # Query_timeï¼š0.000401 SQLçš„æŸ¥è¯¢æ—¶é—´\n  # Lock_timeï¼š0.000105 é”å®šæ—¶é—´\n  # Rows_sentï¼š2 æ‰€å‘é€çš„è¡Œæ•°\n  # Rows_examinedï¼š2 æ‰«æäº†å¤šå°‘è¡Œã€‚æ‰§è¡Œå™¨æ¯æ¬¡è°ƒç”¨å¼•æ“è·å–æ•°æ®è¡Œéƒ½ä¼šç´¯åŠ ã€‚è¡Œæ•°è¶Šå°‘ï¼Œè®¿é—®ç£ç›˜æ•°æ®çš„æ¬¡æ•°è¶Šå°‘ï¼Œæ¶ˆè€—çš„CPUèµ„æºè¶Šå°‘ã€‚ä½†å¼•æ“æ‰«æè¡Œæ•°è·Ÿrows_examinedå¹¶ä¸æ˜¯å®Œå…¨ç›¸åŒçš„ã€‚\n  # SET timestamp=1527268014; SQLæ‰§è¡Œæ—¶é—´\n  # select * from staff; SQLçš„æ‰§è¡Œå†…å®¹\n</code></pre></div><h2>4.2. æ…¢SQLå¦‚ä½•å®šä½</h2>\n<ul>\n<li>é€šè¿‡å·¥å…·æ¯”å¦‚mysqldumpslowå»åˆ†æå¯¹åº”çš„æ…¢æŸ¥è¯¢æ—¥å¿—ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>shell&gt;mysqldumpslow --help\nUsage: mysqldumpslow [ OPTS... ] [ LOGS... ]\n\nParse and summarize the MySQL slow query log. Options are\n\n  --verbose    verbose\n  --debug      debug\n  --help       write this text to standard output\n\n  -v           verbose\n  -d           debug\n  -s ORDER     what to sort by (al, at, ar, c, l, r, t), 'at' is default\n                al: average lock time\n                ar: average rows sent\n                at: average query time\n                 c: count\n                 l: lock time\n                 r: rows sent\n                 t: query time\n  -r           reverse the sort order (largest last instead of first)\n  -t NUM       just show the top n queries\n  -a           don't abstract all numbers to N and strings to 'S'\n  -n NUM       abstract numbers with at least n digits within names\n  -g PATTERN   grep: only consider stmts that include this string\n  -h HOSTNAME  hostname of db server for *-slow.log filename (can be wildcard),\n               default is '*', i.e. match all\n  -i NAME      name of server instance (if using mysql.server startup script)\n  -l           don't subtract lock time from total time\n\né”å®šæ—¶é—´æœ€é•¿çš„å‰10æ¡\nshell&gt;mysqldumpslow -s l -t 10 /var/lib/mysql/mysql-slow.log\n\nè¿”å›è®°å½•é›†æœ€å¤šçš„10ä¸ªSQL\nshell&gt;mysqldumpslow -s r -t 10 mysql_slow.log\n\nè®¿é—®æ¬¡æ•°æœ€å¤šçš„10ä¸ªSQL\nshell&gt;mysqldumpslow -s c -t 10 mysql_slow.log\n\næŒ‰ç…§æ—¶é—´æ’åºçš„å‰10æ¡é‡Œé¢å«æœ‰å·¦è¿æ¥çš„æŸ¥è¯¢è¯­å¥\nshell&gt;mysqldumpslow -s t -t 10 -g â€œleft joinâ€ mysql_slow.log\n</code></pre></div><ul>\n<li>ä½¿ç”¨show processlistå‘½ä»¤æŸ¥çœ‹å½“å‰MySQLåœ¨è¿›è¡Œçš„çº¿ç¨‹ï¼ŒstateåŒ…æ‹¬çº¿ç¨‹çš„çŠ¶æ€ã€æ˜¯å¦é”è¡¨ã€SQLçš„æ‰§è¡Œæƒ…å†µ</li>\n<li>æœåŠ¡ç›‘æ§ï¼šå¯ä»¥åœ¨ä¸šåŠ¡çš„åŸºå»ºä¸­åŠ å…¥å¯¹æ…¢SQLçš„ç›‘æ§ï¼Œå¸¸è§çš„æ–¹æ¡ˆæœ‰å­—èŠ‚ç æ’æ¡©ã€è¿æ¥æ± æ‰©å±•ã€ORMæ¡†æ¶è¿‡ç¨‹ï¼Œå¯¹æœåŠ¡è¿è¡Œä¸­çš„æ…¢SQLè¿›è¡Œç›‘æ§å’Œå‘Šè­¦</li>\n<li>ä½¿ç”¨ EXPLAIN å‘½ä»¤æŸ¥çœ‹ MySQL æ˜¯å¦‚ä½•æ‰§è¡Œ SQL è¯­å¥</li>\n</ul>\n<h2>4.3. æ€ä¹ˆçœ‹explainæ‰§è¡Œè®¡åˆ’ï¼Ÿ</h2>\n<p>æŸ¥çœ‹æ‰§è¡Œè®¡åˆ’explain xxx</p>\n<ul>\n<li>\n<p>idï¼šæŸ¥è¯¢çš„åºåˆ—å·,è¡¨ç¤ºæŸ¥è¯¢ä¸­æ‰§è¡ŒSelectå­å¥æˆ–æ“ä½œè¡¨çš„é¡ºåºã€‚idå€¼ç›¸åŒ,æ‰§è¡Œé¡ºåºç”±ä¸Šè€Œä¸‹ã€‚idå€¼è¶Šå¤§è¶Šå…ˆè¢«æ‰§è¡Œ.idåˆ—ä¸ºnullçš„å°±è¡¨æ˜¯è¿™æ˜¯ä¸€ä¸ªç»“æœé›†ï¼Œä¸éœ€è¦ä½¿ç”¨å®ƒæ¥è¿›è¡ŒæŸ¥è¯¢ã€‚</p>\n</li>\n<li>\n<p>select_typeï¼ŒæŸ¥è¯¢çš„ç±»å‹</p>\n<ul>\n<li>SIMPLE : æŸ¥è¯¢ä¸­ä¸åŒ…å«å­æŸ¥è¯¢æˆ–è€…UNIONæˆ–è€…è¡¨è¿æ¥</li>\n<li>PRIMARY: æŸ¥è¯¢ä¸­è‹¥åŒ…å«å¤æ‚çš„å­æŸ¥è¯¢æˆ–è€…union,æœ€å¤–å±‚çš„æŸ¥è¯¢åˆ™æ ‡è®°ä¸ºPRIMARY</li>\n<li>SUBQUERY : åœ¨SELECTæˆ–è€…WHEREåˆ—è¡¨ä¸­åŒ…å«å­æŸ¥è¯¢</li>\n<li>DERIVED : åœ¨fromåˆ—è¡¨ä¸­åŒ…å«å­æŸ¥è¯¢è¢«æ ‡è®°ä¸ºDRIVEDè¡ç”Ÿ,MYSQLä¼šé€’å½’æ‰§è¡Œè¿™äº›å­æŸ¥è¯¢,æŠŠç»“æœæ”¾åˆ°ä¸´æ—¶è¡¨ä¸­</li>\n<li>UNION: UNION ä¸­çš„ç¬¬äºŒä¸ªæˆ–è€…åé¢çš„æŸ¥è¯¢è¯­å¥, è‹¥unionåŒ…å«åœ¨fromå­å¥çš„å­æŸ¥è¯¢ä¸­,å¤–å±‚ selectè¢«æ ‡è®°ä¸º:derived</li>\n<li>dependent unionï¼šä¸unionä¸€æ ·ï¼Œå‡ºç°åœ¨union æˆ–union allè¯­å¥ä¸­ï¼Œä½†æ˜¯è¿™ä¸ªæŸ¥è¯¢è¦å—åˆ°å¤–éƒ¨æŸ¥è¯¢çš„å½±å“</li>\n<li>dependent subqueryï¼šä¸dependent unionç±»ä¼¼ï¼Œè¡¨ç¤ºè¿™ä¸ªsubqueryçš„æŸ¥è¯¢è¦å—åˆ°å¤–éƒ¨è¡¨æŸ¥è¯¢çš„å½±å“</li>\n<li>union resultï¼šåŒ…å«unionçš„ç»“æœé›†ï¼Œåœ¨unionå’Œunion allè¯­å¥ä¸­,å› ä¸ºå®ƒä¸éœ€è¦å‚ä¸æŸ¥è¯¢ï¼Œæ‰€ä»¥idå­—æ®µä¸ºnull</li>\n<li>UNION RESULT: ä»unionè¡¨è·å–ç»“æœçš„select</li>\n</ul>\n</li>\n<li>\n<p>tableï¼šæ­£åœ¨è®¿é—®çš„è¡¨ã€‚nullè¡¨ç¤ºä¸æ¶‰åŠå¯¹æ•°æ®è¡¨çš„æ“ä½œï¼Œ<code>&lt;derived N&gt;</code>è¡¨ç¤ºä¸´æ—¶è¡¨ï¼Œç»“æœæ¥è‡ªäºæŸ¥è¯¢idä¸ºNçš„ç»“æœé›†ã€‚å¦‚æœæ˜¯&lt;union M,N&gt;ï¼Œè¡¨ç¤ºç»“æœæ¥è‡ªäºunionæŸ¥è¯¢idä¸ºM,Nçš„ç»“æœé›†ã€‚</p>\n</li>\n<li>\n<p>typeåˆ—ï¼šè¡¨ç¤ºå…³è”ç±»å‹æˆ–è®¿é—®ç±»å‹ï¼Œé€Ÿåº¦system&gt;const&gt;eq_ref&gt;ref&gt;fulltext&gt;ref_or_null&gt;index_merge&gt;unique_subquery&gt;index_subquery&gt;range&gt;index&gt;ALLæœ€å¥½èƒ½ä¼˜åŒ–åˆ°rangeçº§åˆ«æˆ–åˆ™refçº§åˆ«</p>\n<ul>\n<li>systemï¼šè¡¨ä»…æœ‰ä¸€è¡Œè®°å½•(ç³»ç»Ÿè¡¨)ï¼Œå¾€å¾€ä¸éœ€è¦è¿›è¡Œç£ç›˜IOï¼Œé€Ÿåº¦éå¸¸å¿«</li>\n<li>constï¼šè¡¨ç¤ºæŸ¥è¯¢æ—¶å‘½ä¸­primarykeyä¸»é”®æˆ–è€…uniqueå”¯ä¸€ç´¢å¼•ï¼Œæˆ–è€…è¢«è¿æ¥çš„éƒ¨åˆ†æ˜¯ä¸€ä¸ªå¸¸é‡(const)å€¼ã€‚è¿™ç±»æ‰«ææ•ˆç‡æé«˜ï¼Œè¿”å›æ•°æ®é‡å°‘ï¼Œé€Ÿåº¦å¿«</li>\n<li>eq_refï¼šå¤šè¡¨è¿æ¥æ—¶å‘½ä¸­ä¸»é”®primarykeyæˆ–è€…uniquekeyç´¢å¼•</li>\n<li>ref : å¤šè¡¨è¿æ¥ä¸­ä½¿ç”¨æ™®é€šç´¢å¼•</li>\n<li>ref_or_nullï¼šä¸refæ–¹æ³•ç±»ä¼¼ï¼Œåªæ˜¯å¢åŠ äº†nullå€¼çš„æ¯”è¾ƒ</li>\n<li>fulltextï¼šå…¨æ–‡ç´¢å¼•æ£€ç´¢ï¼Œè‹¥å…¨æ–‡ç´¢å¼•å’Œæ™®é€šç´¢å¼•åŒæ—¶å­˜åœ¨æ—¶ä¼˜å…ˆé€‰æ‹©ä½¿ç”¨å…¨æ–‡ç´¢å¼•</li>\n<li>index_mergeï¼šä½¿ç”¨äº†ç´¢å¼•åˆå¹¶ä¼˜åŒ–æ–¹æ³•ï¼ŒæŸ¥è¯¢ä½¿ç”¨äº†ä¸¤ä¸ªä»¥ä¸Šçš„ç´¢å¼•ã€‚æœ€åå–äº¤é›†æˆ–è€…å¹¶é›†ï¼Œå¸¸è§and ï¼Œorçš„æ¡ä»¶ä½¿ç”¨äº†ä¸åŒçš„ç´¢å¼•ï¼Œå®˜æ–¹æ’åºè¿™ä¸ªåœ¨ref_or_nullä¹‹åï¼Œä½†æ˜¯å®é™…ä¸Šç”±äºè¦è¯»å–æ‰€ä¸ªç´¢å¼•ï¼Œæ€§èƒ½å¯èƒ½å¤§éƒ¨åˆ†æ—¶é—´éƒ½ä¸å¦‚range</li>\n<li>unique_subqueryï¼šç”¨äºwhereä¸­çš„inå½¢å¼å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢è¿”å›ä¸é‡å¤å€¼å”¯ä¸€å€¼</li>\n<li>index_subqueryï¼šç”¨äºwhereä¸­çš„inå½¢å¼å­æŸ¥è¯¢ï¼Œå­æŸ¥è¯¢å¯èƒ½è¿”å›é‡å¤å€¼</li>\n<li>rangeï¼šä½¿ç”¨ç´¢å¼•é€‰æ‹©è¡Œï¼Œä»…æ£€ç´¢ç»™å®šèŒƒå›´å†…çš„è¡Œã€‚ç®€å•ç‚¹è¯´å°±æ˜¯é’ˆå¯¹ä¸€ä¸ªæœ‰ç´¢å¼•çš„å­—æ®µï¼Œç»™å®šèŒƒå›´æ£€ç´¢æ•°æ®ã€‚åœ¨whereè¯­å¥ä¸­ä½¿ç”¨bettween...andã€&lt;ã€&gt;ã€&lt;=ã€inç­‰æ¡ä»¶æŸ¥è¯¢typeéƒ½æ˜¯rangeã€‚</li>\n<li>indexï¼šæ‰«ææ•´ä¸ªç´¢å¼•è¡¨, éå†ç´¢å¼•ç´¢å¼•æ–‡ä»¶,ä»ç´¢å¼•ä¸­è¯»å–æ•°æ®</li>\n<li>ALL:å…¨è¡¨æ‰«æ</li>\n</ul>\n</li>\n<li>\n<p>possible_keysï¼šå¯èƒ½ä½¿ç”¨å“ªäº›ç´¢å¼•æ¥æŸ¥æ‰¾ï¼Œ</p>\n</li>\n<li>\n<p>keyï¼šçœŸæ­£ä½¿ç”¨çš„ç´¢å¼•,å¦‚æœä¸ºnull,åˆ™è¡¨ç¤ºæ²¡æœ‰ä½¿ç”¨ç´¢å¼•ï¼Œ</p>\n</li>\n<li>\n<p>key_lenï¼šä½¿ç”¨çš„ç´¢å¼•çš„æœ€å¤§å¯èƒ½é•¿åº¦,åœ¨ä¸æŸå¤±ç²¾ç¡®åº¦çš„æƒ…å†µä¸‹,é•¿åº¦è¶ŠçŸ­è¶Šå¥½</p>\n</li>\n<li>\n<p>refï¼šæ˜¾ç¤ºç´¢å¼•çš„å“ªä¸€åˆ—è¢«ä½¿ç”¨äº†,constä½¿ç”¨çš„å¸¸æ•°ç­‰å€¼æŸ¥è¯¢ï¼Œï¼Œå¦‚æœæ˜¯è¿æ¥æŸ¥è¯¢ï¼Œè¢«é©±åŠ¨è¡¨çš„æ‰§è¡Œè®¡åˆ’è¿™é‡Œä¼šæ˜¾ç¤ºé©±åŠ¨è¡¨çš„å…³è”å­—æ®µï¼Œå¦‚æœæ˜¯æ¡ä»¶ä½¿ç”¨äº†è¡¨è¾¾å¼æˆ–è€…å‡½æ•°ï¼Œæˆ–è€…æ¡ä»¶åˆ—å‘ç”Ÿäº†å†…éƒ¨éšå¼è½¬æ¢ï¼Œè¿™é‡Œå¯èƒ½æ˜¾ç¤ºä¸ºfunc,NULLï¼Œè¡¨ç¤ºæ²¡æœ‰ä½¿ç”¨ç´¢å¼•</p>\n</li>\n<li>\n<p>rowsï¼šä¼°ç®—æ‰¾å‡ºæ‰€éœ€è®°å½•è¦è¯»å–çš„è¡Œæ•° (æœ‰å¤šå°‘è¡Œè®°å½•è¢«ä¼˜åŒ–å™¨è¯»å–) ,è¶Šå°‘è¶Šå¥½</p>\n</li>\n<li>\n<p>Extraï¼šé¢å¤–ä¿¡æ¯</p>\n<ul>\n<li>distinctï¼šåœ¨selectéƒ¨åˆ†ä½¿ç”¨äº†distincå…³é”®å­—</li>\n<li>no tables usedï¼šä¸å¸¦fromå­—å¥çš„æŸ¥è¯¢æˆ–è€…From dualæŸ¥è¯¢ã€ä½¿ç”¨not in()å½¢å¼å­æŸ¥è¯¢æˆ–not existsè¿ç®—ç¬¦çš„è¿æ¥æŸ¥è¯¢ï¼Œè¿™ç§å«åšåè¿æ¥ã€‚å³ï¼Œä¸€èˆ¬è¿æ¥æŸ¥è¯¢æ˜¯å…ˆæŸ¥è¯¢å†…è¡¨ï¼Œå†æŸ¥è¯¢å¤–è¡¨ï¼Œåè¿æ¥å°±æ˜¯å…ˆæŸ¥è¯¢å¤–è¡¨ï¼Œå†æŸ¥è¯¢å†…è¡¨</li>\n<li>Using filesort:è¯´æ˜mysqlä¼šå¯¹æ•°æ®ä½¿ç”¨ä¸€ä¸ªå¤–éƒ¨çš„ç´¢å¼•æ’åº,è€Œä¸æ˜¯æŒ‰ç…§è¡¨å†…çš„ç´¢å¼•é¡ºåºè¿›è¡Œè¯»å–,Mysqlä¸­æ— æ³•åˆ©ç”¨ç´¢å¼•å®Œæˆçš„æ’åºæ“ä½œç§°ä¸ºæ–‡ä»¶æ’åº</li>\n<li>Using temporary:ä½¿ç”¨äº†ä¸´æ—¶è¡¨ä¿å­˜ä¸­é—´ç»“æœ,å¸¸è§äºorder by å’Œåˆ† ç»„æŸ¥è¯¢group by</li>\n<li>Using indexï¼šä½¿ç”¨äº†è¦†ç›–ç´¢å¼•ï¼Œä»¥é¿å…å›è¡¨ã€‚å¦‚æœåŒæ—¶å‡ºç°äº†using where, è¡¨æ˜ç´¢å¼•è¢«ç”¨æ¥æ‰§è¡Œç´¢å¼•é”®å€¼çš„æŸ¥æ‰¾ã€‚æ²¡æœ‰åˆ™è¡¨æ˜ç´¢å¼•ç”¨æ¥è¯»å–æ•°æ®è€Œéæ‰§è¡ŒæŸ¥æ‰¾åŠ¨ä½œ</li>\n<li>using where : ä½¿ç”¨äº†whereæ¡ä»¶è¿‡æ»¤ã€‚æ²¡æœ‰ä½¿ç”¨ç´¢å¼•è¦†ç›–ï¼Œéœ€è¦å›è¡¨</li>\n<li>using join buffer : è¡¨æ˜ä½¿ç”¨äº†è¿æ¥ç¼“å­˜, joinæ¬¡æ•°å¤ªå¤šäº†å¯èƒ½ä¼šå‡ºç°</li>\n<li>impossible where : whereå­å¥ä¸­çš„å€¼æ€»æ˜¯false,ä¸èƒ½ç”¨æ¥è·å–ä»»ä½•æ•°æ®</li>\n<li>using intersectï¼šè¡¨ç¤ºä½¿ç”¨andçš„å„ä¸ªç´¢å¼•çš„æ¡ä»¶æ—¶ï¼Œè¯¥ä¿¡æ¯è¡¨ç¤ºæ˜¯ä»å¤„ç†ç»“æœè·å–äº¤é›†</li>\n<li>using unionï¼šè¡¨ç¤ºä½¿ç”¨orè¿æ¥å„ä¸ªä½¿ç”¨ç´¢å¼•çš„æ¡ä»¶æ—¶ï¼Œè¯¥ä¿¡æ¯è¡¨ç¤ºä»å¤„ç†ç»“æœè·å–å¹¶é›†</li>\n<li>using sort_unionå’Œusing sort_intersectionï¼šä¸å‰é¢ä¸¤ä¸ªå¯¹åº”çš„ç±»ä¼¼ï¼Œåªæ˜¯ä»–ä»¬æ˜¯å‡ºç°åœ¨ç”¨andå’ŒoræŸ¥è¯¢ä¿¡æ¯é‡å¤§æ—¶ï¼Œå…ˆæŸ¥è¯¢ä¸»é”®ï¼Œç„¶åè¿›è¡Œæ’åºåˆå¹¶åï¼Œæ‰èƒ½è¯»å–è®°å½•å¹¶è¿”å›ã€‚</li>\n<li>firstmatch(tb_name)ï¼šå¸¸è§äºwhereå­—å¥å«æœ‰in()ç±»å‹çš„å­æŸ¥è¯¢ã€‚å¦‚æœå†…è¡¨çš„æ•°æ®é‡æ¯”è¾ƒå¤§ï¼Œå°±å¯èƒ½å‡ºç°è¿™ä¸ª</li>\n<li>loosescan(m..n)ï¼š5.6.xä¹‹åå¼•å…¥çš„ä¼˜åŒ–å­æŸ¥è¯¢çš„æ–°ç‰¹æ€§ä¹‹ä¸€ï¼Œåœ¨in()ç±»å‹çš„å­æŸ¥è¯¢ä¸­ï¼Œå­æŸ¥è¯¢è¿”å›çš„å¯èƒ½æœ‰é‡å¤è®°å½•æ—¶ï¼Œå°±å¯èƒ½å‡ºç°è¿™ä¸ª</li>\n</ul>\n</li>\n<li>\n<p>filteredï¼šè¡¨ç¤ºå­˜å‚¨å¼•æ“è¿”å›çš„æ•°æ®åœ¨serverå±‚è¿‡æ»¤åï¼Œå‰©ä¸‹å¤šå°‘æ»¡è¶³æŸ¥è¯¢çš„è®°å½•æ•°é‡çš„æ¯”ä¾‹ï¼Œæ³¨æ„æ˜¯ç™¾åˆ†æ¯”ï¼Œä¸æ˜¯å…·ä½“è®°å½•æ•°</p>\n</li>\n</ul>\n<h2>4.4. æœ‰å“ªäº›æ–¹å¼ä¼˜åŒ–æ…¢SQLï¼Ÿ</h2>\n<ul>\n<li>å‡å°‘è¯·æ±‚åˆ—(select *)ã€è¯·æ±‚è¡Œ(limit,where)</li>\n<li>åˆ é™¤æ•°æ®æ—¶ï¼Œåˆ‡åˆ†åˆ é™¤ï¼šå¦‚æœä¸€ä¸ªå¤§çš„è¯­å¥ä¸€æ¬¡æ€§å®Œæˆçš„è¯ï¼Œå¯èƒ½éœ€è¦ä¸€æ¬¡æ€§é”ä½å¾ˆå¤šæ•°æ®ã€å æ»¡æ•´ä¸ªäº‹åŠ¡æ—¥å¿—ï¼Œè€—å°½ç³»ç»Ÿèµ„æºã€é˜»å¡å…¶ä»–æŸ¥è¯¢</li>\n<li>whereé«˜äºhavingï¼Œèƒ½å†™åœ¨whereé™å®šçš„æ¡ä»¶å°±ä¸è¦å»havingé™å®šäº†</li>\n<li>åˆ†é¡µä¼˜åŒ–(æ•°æ®é‡å¤§ä¼˜åŒ–)</li>\n<li>å»¶è¿Ÿå…³è”ï¼šå…ˆé€šè¿‡whereæ¡ä»¶æå–å‡ºä¸»é”®ï¼Œåœ¨å°†è¯¥è¡¨ä¸åŸæ•°æ®è¡¨å…³è”ï¼Œ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>select a.* from table a, \n (select id from table where type = 2 and level = 9 order by id asc limit 190289,10 ) b\n where a.id = b.id\n</code></pre></div><ul>\n<li>ä¹¦ç­¾æ–¹å¼:è®°ä½ä¸Šä¸€æ¬¡æŸ¥è¯¢è¿”å›çš„æœ€åä¸€è¡Œçš„æŸä¸ªå€¼ï¼Œç„¶åä¸‹ä¸€æ¬¡æŸ¥è¯¢ä»è¿™ä¸ªå€¼å¼€å§‹ï¼Œé¿å…äº†æ‰«æå¤§é‡ä¸éœ€è¦çš„è¡Œã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>SELECT id, name\nFROM users\nWHERE id &gt; last_max_id  -- å‡è®¾last_max_idæ˜¯ä¸Šä¸€é¡µæœ€åä¸€è¡Œçš„ID\nORDER BY id\nLIMIT 20;\n</code></pre></div><ul>\n<li>ç´¢å¼•ä¼˜åŒ–:åˆç†åœ°è®¾è®¡å’Œé¿å…ç´¢å¼•å¤±æ•ˆåœºæ™¯\n<ul>\n<li>ä¸´æ—¶æ·»åŠ /ä¿®æ”¹/åˆ é™¤ç´¢å¼•ï¼Œ\n<ul>\n<li>å‡è®¾ä¸€ä¸»ä¸€å¤‡ï¼Œä¸»åº“Aã€å¤‡åº“Bï¼Œ\n<ul>\n<li>å¤‡åº“å…³é—­binlogï¼šset sql_log_bin=offï¼Œç„¶åæ‰§è¡Œalter table è¯­å¥åŠ ä¸Šç´¢å¼•</li>\n<li>ä¸»å¤‡åˆ‡æ¢ï¼›</li>\n<li>åœ¨åŸæ¥ä¸»åº“å…³é—­binlogï¼šset sql_log_bin=offï¼Œç„¶åæ‰§è¡Œalter table è¯­å¥åŠ ä¸Šç´¢å¼•</li>\n</ul>\n</li>\n<li>gh-ostæ–¹æ¡ˆ</li>\n</ul>\n</li>\n<li>ä¿®æ”¹SQLï¼šMySQL 5.7æä¾›äº†query_rewriteæŠŠè¾“å…¥çš„ä¸€ç§è¯­å¥æ”¹å†™æˆå¦å¤–ä¸€ç§æ¨¡å¼ã€‚<br>\nmysql&gt; insert into query_rewrite.rewrite_rules(pattern, replacement, pattern_database) values (\"select * from t where id + 1 = ?\", \"select * from t where id = ? - 1\", \"db1\");<br>\nmysql&gt; call query_rewrite.flush_rewrite_rules();</li>\n<li>å¼ºåˆ¶ç´¢å¼• select * from t force index(a) where a=xxx;</li>\n</ul>\n</li>\n<li>JOINä¼˜åŒ–\n<ul>\n<li>ä¼˜åŒ–å­æŸ¥è¯¢ï¼šå°½é‡ä½¿ç”¨Joinè¯­å¥æ¥æ›¿ä»£å­æŸ¥è¯¢ï¼Œå› ä¸ºå­æŸ¥è¯¢æ˜¯åµŒå¥—æŸ¥è¯¢ï¼Œè€ŒåµŒå¥—æŸ¥è¯¢ä¼šæ–°åˆ›å»ºä¸€å¼ ä¸´æ—¶è¡¨ï¼Œè€Œä¸´æ—¶è¡¨çš„åˆ›å»ºä¸é”€æ¯ä¼šå ç”¨ä¸€å®šçš„ç³»ç»Ÿèµ„æºä»¥åŠèŠ±è´¹ä¸€å®šçš„æ—¶é—´ï¼ŒåŒæ—¶å¯¹äºè¿”å›ç»“æœé›†æ¯”è¾ƒå¤§çš„å­æŸ¥è¯¢ï¼Œå…¶å¯¹æŸ¥è¯¢æ€§èƒ½çš„å½±å“æ›´å¤§</li>\n<li>å°è¡¨é©±åŠ¨å¤§è¡¨ï¼šå…³è”æŸ¥è¯¢çš„æ—¶å€™è¦æ‹¿å°è¡¨å»é©±åŠ¨å¤§è¡¨ï¼Œå› ä¸ºå…³è”çš„æ—¶å€™ï¼ŒMySQLå†…éƒ¨ä¼šéå†é©±åŠ¨è¡¨ï¼Œå†å»è¿æ¥è¢«é©±åŠ¨è¡¨ã€‚</li>\n<li>å­æŸ¥è¯¢å°½é‡ä¸è¦æ”¾åœ¨è¢«é©±åŠ¨è¡¨ï¼Œæœ‰å¯èƒ½ä½¿ç”¨ä¸åˆ°ç´¢å¼•</li>\n<li>è‹¥å¿…é¡»ç”¨åˆ°å­æŸ¥è¯¢ï¼Œå¯å°†å­æŸ¥è¯¢è®¾ç½®ä¸ºé©±åŠ¨è¡¨ï¼Œå› ä¸ºé©±åŠ¨è¡¨çš„type è‚¯å®šæ˜¯ allï¼Œè€Œå­æŸ¥è¯¢è¿”å›çš„ç»“æœè¡¨æ²¡æœ‰ç´¢å¼•ï¼Œå¿…å®šä¹Ÿæ˜¯all</li>\n<li>ç¡®å®šonæˆ–è€…usingå­å¥çš„åˆ—ä¸Šæœ‰ç´¢å¼•</li>\n<li>é€‚å½“å¢åŠ å†—ä½™å­—æ®µï¼›å¯ä»¥å‡å°‘å¤§é‡çš„è¿è¡¨æŸ¥è¯¢ï¼Œç©ºé—´æ¢æ—¶é—´çš„ä¼˜åŒ–ç­–ç•¥.å› ä¸ºå¤šå¼ è¡¨çš„è¿è¡¨æŸ¥è¯¢æ€§èƒ½å¾ˆä½ï¼Œ</li>\n<li>é¿å…ä½¿ç”¨JOINå…³è”å¤ªå¤šçš„è¡¨ï¼šã€Šé˜¿é‡Œå·´å·´Javaå¼€å‘æ‰‹å†Œã€‹è§„å®šä¸è¦joinè¶…è¿‡ä¸‰å¼ è¡¨ï¼Œç¬¬ä¸€joinå¤ªå¤šé™ä½æŸ¥è¯¢çš„é€Ÿåº¦ï¼Œç¬¬äºŒjoinçš„bufferä¼šå ç”¨æ›´å¤šçš„å†…å­˜ã€‚å¦‚æœä¸å¯é¿å…è¦joinå¤šå¼ è¡¨ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨æ•°æ®å¼‚æ„çš„æ–¹å¼å¼‚æ„åˆ°ESä¸­æŸ¥è¯¢ã€‚</li>\n</ul>\n</li>\n<li>æ’åºä¼˜åŒ–</li>\n<li>åˆ©ç”¨ç´¢å¼•æ‰«æåšæ’åºï¼šMySQLæœ‰ä¸¤ç§æ–¹å¼ç”Ÿæˆæœ‰åºç»“æœï¼šå…¶ä¸€æ˜¯å¯¹ç»“æœé›†è¿›è¡Œæ’åºçš„æ“ä½œï¼Œå…¶äºŒæ˜¯æŒ‰ç…§ç´¢å¼•é¡ºåºæ‰«æå¾—å‡ºçš„ç»“æœè‡ªç„¶æ˜¯æœ‰åºçš„ã€‚ä½†æ˜¯å¦‚æœç´¢å¼•ä¸èƒ½è¦†ç›–æŸ¥è¯¢æ‰€éœ€åˆ—ï¼Œå°±ä¸å¾—ä¸æ¯æ‰«æä¸€æ¡è®°å½•å›è¡¨æŸ¥è¯¢ä¸€æ¬¡ï¼Œè¿™ä¸ªè¯»æ“ä½œæ˜¯éšæœºIOï¼Œé€šå¸¸ä¼šæ¯”é¡ºåºå…¨è¡¨æ‰«æè¿˜æ…¢ã€‚å› æ­¤ï¼Œåœ¨è®¾è®¡ç´¢å¼•æ—¶ï¼Œå°½å¯èƒ½ä½¿ç”¨åŒä¸€ä¸ªç´¢å¼•æ—¢æ»¡è¶³æ’åºåˆç”¨äºæŸ¥æ‰¾è¡Œã€‚åªæœ‰å½“ç´¢å¼•çš„åˆ—é¡ºåºå’ŒORDERBYå­å¥çš„é¡ºåºå®Œå…¨ä¸€è‡´ï¼Œå¹¶ä¸”æ‰€æœ‰åˆ—çš„æ’åºæ–¹å‘éƒ½ä¸€æ ·æ—¶ï¼Œæ‰èƒ½å¤Ÿä½¿ç”¨ç´¢å¼•æ¥å¯¹ç»“æœåšæ’åº</li>\n<li>UNIONä¼˜åŒ–\n<ul>\n<li>æ¡ä»¶ä¸‹æ¨ï¼šMySQLå¤„ç†unionçš„ç­–ç•¥æ˜¯å…ˆåˆ›å»ºä¸´æ—¶è¡¨ï¼Œç„¶åå°†å„ä¸ªæŸ¥è¯¢ç»“æœå¡«å……åˆ°ä¸´æ—¶è¡¨ä¸­æœ€åå†æ¥åšæŸ¥è¯¢ï¼Œå¾ˆå¤šä¼˜åŒ–ç­–ç•¥åœ¨unionæŸ¥è¯¢ä¸­éƒ½ä¼šå¤±æ•ˆï¼Œå› ä¸ºå®ƒæ— æ³•åˆ©ç”¨ç´¢å¼•ï¼šæœ€å¥½æ‰‹å·¥å°†whereã€limitç­‰å­å¥ä¸‹æ¨åˆ°unionçš„å„ä¸ªå­æŸ¥è¯¢ä¸­ï¼Œä»¥ä¾¿ä¼˜åŒ–å™¨å¯ä»¥å……åˆ†åˆ©ç”¨è¿™äº›æ¡ä»¶è¿›è¡Œä¼˜åŒ–</li>\n<li>é™¤éç¡®å®éœ€è¦æœåŠ¡å™¨å»é‡ï¼Œä¸€å®šè¦ä½¿ç”¨unionallï¼Œå¦‚æœä¸åŠ allå…³é”®å­—ï¼ŒMySQLä¼šç»™ä¸´æ—¶è¡¨åŠ ä¸Šdistincté€‰é¡¹ï¼Œè¿™ä¼šå¯¼è‡´å¯¹æ•´ä¸ªä¸´æ—¶è¡¨åšå”¯ä¸€æ€§æ£€æŸ¥ï¼Œä»£ä»·å¾ˆé«˜ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>4.5. sqlå·²ç»èµ°ç´¢å¼•äº†è¿˜æ˜¯å¾ˆæ…¢ï¼Œä¸ºä»€ä¹ˆï¼Œæ€ä¹ˆä¼˜åŒ–ï¼Ÿâˆš</h2>\n<ul>\n<li>å‘½ä¸­ç´¢å¼•è¿˜å¾—ç»“åˆexplainä¸­çš„rowsæ‰«æè¡Œæ•°</li>\n<li>æ‰«æè¡Œæ•°è¿‡å¤šå¯èƒ½æ˜¯èµ°äº†å…¨è¡¨æ‰«æï¼Œå¦‚æœåˆ é™¤æ•°æ®é€ æˆç©ºæ´å¤ªå¤šå¯ä»¥å®šæœŸç”¨ANALYZEåˆ†æè¡¨å‡å°‘ç©ºæ´</li>\n</ul>\n<h2>4.6. ä¸ºä»€ä¹ˆä½¿ç”¨ç´¢å¼•ä¼šåŠ å¿«æŸ¥è¯¢ï¼Ÿ</h2>\n<ul>\n<li>\n<p>å‡å°‘ç£ç›˜I/Oæ“ä½œï¼šæ•°æ®åº“é€šå¸¸å­˜å‚¨åœ¨ç£ç›˜ä¸Šï¼Œè€Œç£ç›˜I/Oæ“ä½œæ˜¯æ•°æ®åº“æ“ä½œä¸­è€—æ—¶è¾ƒå¤šçš„éƒ¨åˆ†ã€‚æ²¡æœ‰ç´¢å¼•æ—¶ï¼Œæ•°æ®åº“ä¸ºäº†æ‰¾åˆ°åŒ¹é…çš„è¡Œï¼Œéœ€è¦è¿›è¡Œå…¨è¡¨æ‰«æï¼Œå³è¯»å–è¡¨ä¸­çš„æ¯ä¸€è¡Œæ•°æ®ï¼Œè¿™ä¼šå¯¼è‡´å¤§é‡çš„ç£ç›˜I/Oæ“ä½œã€‚è€Œä½¿ç”¨ç´¢å¼•åï¼Œæ•°æ®åº“å¯ä»¥ç›´æ¥å®šä½åˆ°ç´¢å¼•æŒ‡ç¤ºçš„æ•°æ®ä½ç½®ï¼Œä»è€Œå‡å°‘äº†ç£ç›˜I/Oæ“ä½œçš„æ¬¡æ•°ã€‚</p>\n</li>\n<li>\n<p>ä¼˜åŒ–æŸ¥è¯¢æ—¶é—´å¤æ‚åº¦ï¼šå…¨è¡¨æ‰«æçš„æ—¶é—´å¤æ‚åº¦æ˜¯O(n)ï¼Œæ„å‘³ç€éšç€æ•°æ®é‡çš„å¢åŠ ï¼ŒæŸ¥è¯¢æ—¶é—´å‘ˆçº¿æ€§å¢é•¿ã€‚è€Œä½¿ç”¨ç´¢å¼•åï¼Œæ•°æ®åº“å¯ä»¥åˆ©ç”¨ç´¢å¼•çš„æ•°æ®ç»“æ„ï¼ˆå¦‚MySQLçš„InnoDBå­˜å‚¨å¼•æ“é»˜è®¤çš„B+æ ‘ï¼‰æ¥å¿«é€Ÿå®šä½æ•°æ®ï¼ŒB+æ ‘çš„æŸ¥è¯¢æ•ˆç‡éå¸¸é«˜ï¼Œæ—¶é—´å¤æ‚åº¦ä¸ºO(logN)ï¼Œå› æ­¤å¯ä»¥æ˜¾è‘—åŠ å¿«æŸ¥è¯¢é€Ÿåº¦ã€‚</p>\n</li>\n<li>\n<p>ç´¢å¼•æ–‡ä»¶ä½“ç§¯å°ï¼šç´¢å¼•æ–‡ä»¶ç›¸è¾ƒäºæ•°æ®åº“æ–‡ä»¶ï¼Œå…¶ä½“ç§¯è¦å°å¾—å¤šã€‚å› æ­¤ï¼ŒæŸ¥è¯¢ç´¢å¼•æ–‡ä»¶æ‰€éœ€çš„ç£ç›˜I/Oæ“ä½œä¹Ÿä¼šç›¸åº”å‡å°‘ã€‚å½“åœ¨ç´¢å¼•ä¸­æ‰¾åˆ°åŒ¹é…é¡¹åï¼Œå†æ˜ å°„åˆ°å®é™…çš„æ•°æ®åº“è®°å½•ï¼Œæ•´ä½“æŸ¥è¯¢æ•ˆç‡ä¼šæ˜¾è‘—æé«˜ã€‚</p>\n</li>\n</ul>\n<h2>4.7. å¦‚ä½•è®¾è®¡ç´¢å¼•ï¼Ÿ</h2>\n<ul>\n<li>é€‰æ‹©åˆé€‚çš„åˆ—ä½œä¸ºç´¢å¼•ï¼šç»å¸¸ä½œä¸ºè¿æ¥ï¼ˆJOINï¼‰åˆ—ã€æŸ¥è¯¢æ¡ä»¶ï¼ˆWHEREå­å¥ï¼‰ã€åˆ†ç»„æ¡ä»¶ï¼ˆGROUPBYå­å¥ï¼‰ã€æ’åºæ¡ä»¶ï¼ˆORDERBYå­å¥ï¼‰</li>\n<li>é¿å…è¿‡å¤šçš„ç´¢å¼•ï¼ˆç´¢å¼•çš„åŠŸèƒ½ç›¸åŒï¼‰</li>\n<li>åˆ©ç”¨è¦†ç›–ç´¢å¼•:InnoDBä½¿ç”¨éä¸»é”®ç´¢å¼•æŸ¥è¯¢æ•°æ®æ—¶ä¼šå›è¡¨ï¼Œä½†æ˜¯å¦‚æœç´¢å¼•çš„å¶èŠ‚ç‚¹ä¸­å·²ç»åŒ…å«è¦æŸ¥è¯¢çš„å­—æ®µï¼Œé‚£å®ƒæ²¡æœ‰å¿…è¦å†å›è¡¨æŸ¥è¯¢äº†ï¼Œè¿™å°±å«è¦†ç›–ç´¢å¼•</li>\n<li>é€‚å½“ä½¿ç”¨å‰ç¼€ç´¢å¼•ï¼Œé™ä½ç´¢å¼•çš„ç©ºé—´å ç”¨ï¼Œæé«˜ç´¢å¼•æŸ¥è¯¢æ•ˆç‡ã€‚ä½†æ— æ³•åšorder byå’Œgroup byæ“ä½œï¼Œä¹Ÿæ— æ³•ä½œä¸ºè¦†ç›–ç´¢å¼•</li>\n<li>æ­£ç¡®ä½¿ç”¨è”åˆç´¢å¼•ï¼Œæ³¨æ„æœ€å·¦åŒ¹é…åŸåˆ™ã€‚ç´¢å¼•çš„é¡ºåºåº”æ ¹æ®åˆ—åœ¨æŸ¥è¯¢ä¸­çš„ä½¿ç”¨é¢‘ç‡å’Œé‡è¦æ€§æ¥å®‰æ’ã€‚</li>\n</ul>\n<h2>4.9. ç´¢å¼•ä¸é€‚åˆå“ªäº›åœºæ™¯å‘¢ï¼Ÿ</h2>\n<ul>\n<li>æ•°æ®é‡æ¯”è¾ƒå°‘çš„è¡¨ä¸é€‚åˆåŠ ç´¢å¼•</li>\n<li>æ›´æ–°æ¯”è¾ƒé¢‘ç¹çš„å­—æ®µ</li>\n<li>åŒºåˆ†åº¦ä½çš„å­—æ®µä¸é€‚åˆåŠ ç´¢å¼•ï¼ˆå¦‚æ€§åˆ«ï¼‰</li>\n<li>ä¸å»ºè®®ç”¨æ— åºçš„å€¼(èº«ä»½è¯ã€UUID)ä½œä¸ºç´¢å¼•ï¼Œå½“ä¸»é”®å…·æœ‰ä¸ç¡®å®šæ€§ï¼Œä¼šé€ æˆå¶å­èŠ‚ç‚¹é¢‘ç¹åˆ†è£‚ï¼Œå‡ºç°ç£ç›˜å­˜å‚¨çš„ç¢ç‰‡åŒ–</li>\n</ul>\n<h2>4.8. ç´¢å¼•å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆå‘¢ï¼Ÿâˆš</h2>\n<ul>\n<li>\n<p>åœ¨ç´¢å¼•åˆ—ä¸Šä½¿ç”¨å†…ç½®å‡½æ•°æˆ–è€…è¡¨è¾¾å¼</p>\n</li>\n<li>\n<p>å¯¹ç´¢å¼•åˆ—è¿ç®—ï¼ˆå¦‚ï¼Œ+ã€-ã€*ã€/ï¼‰ï¼Œ</p>\n</li>\n<li>\n<p>ç´¢å¼•å­—æ®µä¸Šä½¿ç”¨ï¼ˆ!=æˆ–è€…&lt;&gt;ï¼Œnotinï¼‰æ—¶ï¼Œå¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚!=ã€&lt;&gt;åœ¨ä¸»é”®å­—æ®µå’Œå”¯ä¸€ç´¢å¼•å­—æ®µä¸­ä¼šèµ°ç´¢å¼•ï¼Œåœ¨æ™®é€šç´¢å¼•çš„å­—æ®µä¸Šä¸ä¼šèµ°ç´¢å¼•ã€‚è§£å†³æ–¹æ³•ï¼šé€šè¿‡æŠŠä¸ç­‰äºæ“ä½œç¬¦æ”¹æˆorï¼Œå¯ä»¥ä½¿ç”¨ç´¢å¼•ï¼Œé¿å…å…¨è¡¨æ‰«æ</p>\n</li>\n<li>\n<p>likeé€šé…ç¬¦(%xxxæˆ–è€…_xx)ã€‚</p>\n</li>\n<li>\n<p>æŸ¥è¯¢æ¡ä»¶åŒ…å«orï¼Œå¯èƒ½ä¼šå¯¼è‡´ç´¢å¼•å¤±æ•ˆ orä¸­æœ‰ä¸€ä¸ªä¸ç”¨ç´¢å¼•å°±ä¼šç´¢å¼•å¤±æ•ˆ,å°½é‡ä½¿ç”¨union allä»£æ›¿</p>\n</li>\n<li>\n<p>MySQLä¼˜åŒ–å™¨ä¼°è®¡ä½¿ç”¨å…¨è¡¨æ‰«æè¦æ¯”ä½¿ç”¨ç´¢å¼•å¿«ï¼Œåˆ™ä¸ä½¿ç”¨ç´¢å¼•ã€‚</p>\n</li>\n<li>\n<p>è”åˆç´¢å¼•ä¸æ»¡è¶³æœ€å·¦å‰ç¼€åŸåˆ™æ—¶ï¼Œç´¢å¼•ä¼šå¤±æ•ˆã€‚</p>\n</li>\n<li>\n<p>å¦‚æœå­—æ®µç±»å‹æ˜¯å­—ç¬¦ä¸²ï¼Œwhereæ—¶ä¸€å®šè¦ç”¨å¼•å·æ‹¬èµ·æ¥ï¼Œå¦åˆ™ä¼šå› ä¸ºéšå¼ç±»å‹è½¬æ¢ï¼Œç´¢å¼•å¤±æ•ˆã€‚ç›¸å½“äºå‡½æ•°è¿ç®—ã€‚æŸ¥çœ‹æ•°æ®ç±»å‹è½¬æ¢ç³»ç»Ÿé»˜è®¤è§„åˆ™ï¼šselect â€œ10â€ &gt; 9 =&gt;1è¡¨ç¤ºâ€œå°†å­—ç¬¦ä¸²è½¬æˆæ•°å­—â€ï¼Œ0è¡¨ç¤ºâ€œå°†æ•°å­—è½¬æˆå­—ç¬¦ä¸²â€</p>\n</li>\n<li>\n<p>ç´¢å¼•å­—æ®µä¸Šä½¿ç”¨isnullï¼Œisnotnullï¼Œå¯èƒ½å¯¼è‡´ç´¢å¼•å¤±æ•ˆã€‚</p>\n</li>\n<li>\n<p>å·¦è¿æ¥æŸ¥è¯¢æˆ–è€…å³è¿æ¥æŸ¥è¯¢å…³è”çš„å­—æ®µç¼–ç æ ¼å¼ä¸ä¸€æ ·ï¼Œå¯èƒ½å¯¼è‡´ç´¢å¼•å¤±æ•ˆ(Concat\\CAST\\CONVERT)ã€‚</p>\n</li>\n<li>\n<p>å¯¹äºè¿ç»­çš„æ•°å€¼ï¼Œèƒ½ç”¨ between å°±ä¸è¦ç”¨ in äº†ã€‚å¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œå¯ä»¥ç”¨existsä»£æ›¿inï¼Œå¦‚æœæ˜¯å­æŸ¥è¯¢ï¼Œå¯ä»¥ç”¨existsä»£æ›¿in</p>\n</li>\n<li>\n<p>order byç´¢å¼•å¤±æ•ˆï¼šwhereå­å¥å‡ºç°ç´¢å¼•çš„èŒƒå›´æŸ¥è¯¢,å¤åˆæ¡ä»¶æ’åºç±»åˆ«descã€ascä¸ä¸€è‡´</p>\n</li>\n</ul>\n<h2>4.10. ç´¢å¼•æ˜¯ä¸æ˜¯å»ºçš„è¶Šå¤šè¶Šå¥½å‘¢ï¼Ÿ</h2>\n<ul>\n<li>å½“ç„¶ä¸æ˜¯ã€‚</li>\n<li>ç´¢å¼•ä¼šå æ®ç£ç›˜ç©ºé—´</li>\n<li>é™ä½æ›´æ–°è¡¨çš„é€Ÿåº¦ï¼šæ›´æ–°è¡¨ï¼ˆINSERTã€UPDATEã€DELETEæ“ä½œï¼‰æ—¶ï¼Œæ‰€æœ‰çš„ç´¢å¼•éƒ½éœ€è¦è¢«æ›´æ–°ã€‚</li>\n<li>ç»´æŠ¤ç´¢å¼•æ–‡ä»¶éœ€è¦æˆæœ¬ï¼›è¿˜ä¼šå¯¼è‡´é¡µåˆ†è£‚ï¼ŒIOæ¬¡æ•°å¢å¤šã€‚</li>\n<li>å•è¡¨ç´¢å¼•ä¸è¶…è¿‡5ä¸ª</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/0dcfd52cf39085f7207e5.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "redis",
      "url": "https://javaguide.cn/interview/redis.html",
      "id": "https://javaguide.cn/interview/redis.html",
      "summary": "1. ä»€ä¹ˆæ˜¯ Redis? Redisï¼šRemote Dictionary Service åŸºäºé”®å€¼å¯¹ï¼ˆkey-valueï¼‰çš„ NoSQL æ•°æ®åº“ã€‚ Redis ä¸­çš„ value æ”¯æŒ stringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€hashï¼ˆå“ˆå¸Œï¼‰ã€ listï¼ˆåˆ—è¡¨ï¼‰ã€setï¼ˆé›†åˆï¼‰ã€zsetï¼ˆæœ‰åºé›†åˆï¼‰ã€Bitmapsï¼ˆä½å›¾ï¼‰ã€HyperLogLogï¼ˆåŸºæ•°ä¼°ç®—ï¼‰ã€GEOï¼ˆ...",
      "content_html": "\n<ul>\n<li>Redisï¼šRemote Dictionary Service åŸºäºé”®å€¼å¯¹ï¼ˆkey-valueï¼‰çš„ NoSQL æ•°æ®åº“ã€‚</li>\n<li>Redis ä¸­çš„ value æ”¯æŒ stringï¼ˆå­—ç¬¦ä¸²ï¼‰ã€hashï¼ˆå“ˆå¸Œï¼‰ã€ listï¼ˆåˆ—è¡¨ï¼‰ã€setï¼ˆé›†åˆï¼‰ã€zsetï¼ˆæœ‰åºé›†åˆï¼‰ã€Bitmapsï¼ˆä½å›¾ï¼‰ã€HyperLogLogï¼ˆåŸºæ•°ä¼°ç®—ï¼‰ã€GEOï¼ˆåœ°ç†ä¿¡æ¯å®šä½ï¼‰ç­‰å¤šç§æ•°æ®ç»“æ„ã€‚</li>\n<li>å› ä¸º Redis çš„æ‰€æœ‰æ•°æ®éƒ½å­˜æ”¾åœ¨å†…å­˜å½“ä¸­ï¼Œæ‰€ä»¥å®ƒçš„è¯»å†™æ€§èƒ½éå¸¸å‡ºè‰²ã€‚</li>\n<li>Redis è¿˜å¯ä»¥å°†å†…å­˜æ•°æ®æŒä¹…åŒ–åˆ°ç¡¬ç›˜ä¸Šï¼Œè¿™æ ·åœ¨å‘ç”Ÿç±»ä¼¼æ–­ç”µæˆ–è€…æœºå™¨æ•…éšœçš„æ—¶å€™ï¼Œå†…å­˜ä¸­çš„æ•°æ®å¹¶ä¸ä¼šâ€œä¸¢å¤±â€ã€‚</li>\n<li>Redis è¿˜æä¾›äº†é”®è¿‡æœŸã€å‘å¸ƒè®¢é˜…ã€äº‹åŠ¡ã€æµæ°´çº¿ã€Lua è„šæœ¬ç­‰é™„åŠ åŠŸèƒ½ï¼Œæ˜¯äº’è”ç½‘æŠ€æœ¯é¢†åŸŸä¸­ä½¿ç”¨æœ€å¹¿æ³›çš„ç¼“å­˜ä¸­é—´ä»¶ã€‚</li>\n</ul>\n<h1>Redis å’Œ MySQL çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>Redisï¼šæ•°æ®å­˜å‚¨åœ¨å†…å­˜ä¸­çš„ NoSQL æ•°æ®åº“ï¼Œè¯»å†™æ€§èƒ½éå¸¸å¥½ã€‚</li>\n<li>MySQLï¼šæ•°æ®å­˜å‚¨åœ¨ç¡¬ç›˜ä¸­çš„å…³ç³»å‹æ•°æ®åº“ï¼Œé€‚ç”¨äºéœ€è¦äº‹åŠ¡æ”¯æŒå’Œå¤æ‚æŸ¥è¯¢çš„åœºæ™¯</li>\n</ul>\n<h1>2. å•çº¿ç¨‹ Redis çš„ QPS æ˜¯å¤šå°‘ï¼Ÿ</h1>\n<ul>\n<li>Redisçš„QPSï¼ˆQueries Per Secondæ¯ç§’æŸ¥è¯¢ç‡ï¼‰å—å¤šç§å› ç´ å½±å“ï¼ŒåŒ…æ‹¬ç¡¬ä»¶é…ç½®ï¼ˆå¦‚ CPUã€å†…å­˜ã€ç½‘ç»œå¸¦å®½ï¼‰ã€æ•°æ®æ¨¡å‹ã€å‘½ä»¤ç±»å‹ã€ç½‘ç»œå»¶è¿Ÿç­‰<br>\nã€‚ä¸€ä¸ªæ™®é€šæœåŠ¡å™¨çš„ Redis å®ä¾‹é€šå¸¸å¯ä»¥è¾¾åˆ°æ¯ç§’æ•°ä¸‡åˆ°å‡ åä¸‡çš„ QPSã€‚</li>\n<li>åŸºå‡†æµ‹è¯•å‘½ä»¤ï¼šredis-benchmark -h 127.0.0.1 -p 6379 -c 50 -n 10000ï¼ˆ-cï¼šå¹¶å‘è¿æ¥æ•°ï¼Œ-nï¼šè¯·æ±‚æ€»æ•°ï¼‰</li>\n</ul>\n<h1>3. redisä½¿ç”¨åœºæ™¯ï¼Ÿ</h1>\n<ul>\n<li>ç¼“å­˜ï¼šå‡è½»æ•°æ®åº“æŸ¥è¯¢å‹åŠ›ï¼Œæé«˜åº”ç”¨çš„å“åº”é€Ÿåº¦å’Œååé‡</li>\n<li>åˆ†å¸ƒå¼é”ï¼šæ§åˆ¶è·¨å¤šä¸ªè¿›ç¨‹æˆ–æœåŠ¡å™¨çš„èµ„æºè®¿é—®ã€‚</li>\n<li>çƒ­é—¨åˆ—è¡¨ä¸æ’è¡Œæ¦œï¼šåˆ©ç”¨ zSetï¼ˆæœ‰åºé›†åˆï¼‰æ ¹æ®scoreå®ç°</li>\n<li>Sessionå…±äº«ï¼šé›†ç¾¤æœåŠ¡çš„åŒä¸€ä¸ªç”¨æˆ·sessionå¯èƒ½è½åœ¨ä¸åŒæœºå™¨ä¸Šï¼Œè¿™ä¼šå¯¼è‡´ç”¨æˆ·é¢‘ç¹ç™»é™†ï¼›é‡‡ç”¨Redisä¿å­˜Sessionåï¼Œæ— è®ºç”¨æˆ·è½åœ¨é‚£å°æœºå™¨ä¸Šéƒ½èƒ½å¤Ÿè·å–åˆ°å¯¹åº”çš„Session</li>\n<li>è®¡æ•°å™¨/é™é€Ÿå™¨ï¼šåˆ©ç”¨Redisä¸­åŸå­æ€§çš„è‡ªå¢æ“ä½œï¼Œç»Ÿè®¡ç±»ä¼¼ç”¨æˆ·ç‚¹èµæ•°ã€ç”¨æˆ·è®¿é—®æ•°ç­‰ã€‚é™é€Ÿå™¨æ¯”è¾ƒå…¸å‹çš„ä½¿ç”¨åœºæ™¯æ˜¯é™åˆ¶æŸä¸ªç”¨æˆ·è®¿é—®æŸä¸ªAPIçš„é¢‘ç‡</li>\n<li>å¥½å‹å…³ç³»ï¼šåˆ©ç”¨é›†åˆçš„ä¸€äº›å‘½ä»¤ï¼Œæ¯”å¦‚æ±‚äº¤é›†ã€å¹¶é›†ã€å·®é›†ç­‰ã€‚å¯ä»¥æ–¹ä¾¿è§£å†³ä¸€äº›å…±åŒå¥½å‹ã€å…±åŒçˆ±å¥½ä¹‹ç±»çš„åŠŸèƒ½ï¼›</li>\n<li>æ¶ˆæ¯é˜Ÿåˆ—ï¼šåˆ©ç”¨Listæ¥å®ç°ä¸€ä¸ªé˜Ÿåˆ—æœºåˆ¶ï¼Œå¼‚æ­¥è§£è€¦ï¼Œæ¯”å¦‚ï¼šåˆ°è´§é€šçŸ¥ã€é‚®ä»¶å‘é€ä¹‹ç±»çš„éœ€æ±‚ï¼Œä¸éœ€è¦é«˜å¯é ï¼Œä½†æ˜¯ä¼šå¸¦æ¥éå¸¸å¤§çš„DBå‹åŠ›ï¼›</li>\n<li>æ•°æ®è¿‡æœŸå¤„ç†: è®¢å•30åˆ†é’Ÿè‡ªåŠ¨å–æ¶ˆ</li>\n<li>äº¤é›†ã€å¹¶é›†å’Œå·®é›†</li>\n<li>å‘å¸ƒ/è®¢é˜…</li>\n<li>æ•°æ®æŒä¹…åŒ–</li>\n<li>äº‹åŠ¡</li>\n</ul>\n<h1>4. Redis æ”¯æŒçš„æ•°æ®ç±»å‹æœ‰å“ªäº›ï¼Ÿä»€ä¹ˆåœºæ™¯ï¼Ÿç›¸å…³æŒ‡ä»¤ï¼Ÿ</h1>\n<ul>\n<li>String:å­˜å‚¨å­—ç¬¦ä¸²ï¼ˆJSONã€XMLã€tokenï¼‰ã€æ•°å­—ã€äºŒè¿›åˆ¶ï¼ˆå›¾ç‰‡ã€éŸ³é¢‘ã€è§†é¢‘ï¼‰ï¼Œä½†æœ€å¤§ä¸èƒ½è¶…è¿‡512MBã€‚ç”¨äºç¼“å­˜ã€è®¡æ•°ã€å…±äº«Sessionã€é™é€Ÿ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># è®¾ç½®keyçš„valueå¹¶åˆ™è¦†ç›–\nset key value \n# è·å¾—keyçš„Stringå€¼\nget key\n# å°†æŒ‡å®šçš„keyçš„valueåŸå­æ€§çš„é€’å¢/å‡1\nincr/decr key\n# å°†æŒ‡å®šçš„keyçš„valueåŸå­æ€§çš„é€’å¢/å‡crement\nincrby/decrby key increment/decrement\n</code></pre></div><ul>\n<li>list:å­—ç¬¦ä¸²æœ‰åºé›†åˆï¼Œå¯é‡å¤,åœ¨é“¾è¡¨çš„ä¸¤å¤´æ’å…¥æˆ–åˆ é™¤å…ƒç´ (é«˜æ•ˆ),æ¨¡æ‹Ÿé˜Ÿåˆ—,å †,æ ˆ ,å…³æ³¨åˆ—è¡¨ï¼Œç²‰ä¸åˆ—è¡¨ï¼Œæ¶ˆæ¯é˜Ÿåˆ—</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åœ¨listå¤´/å°¾éƒ¨æ·»åŠ å¤šä¸ªvaluesï¼Œkeyä¸å­˜åœ¨å°±åˆ›å»ºï¼ŒæˆåŠŸè¿”å›ä¸ªæ•°ï¼Œç§»é™¤æ—¶è¿”å›ä¸ªæ•°ä¸º0åˆ™é”®åˆ é™¤\nlpush/rpush key value1 value2.. \n# è·å–é“¾è¡¨ä¸­ä»startåˆ°endçš„å…ƒç´ çš„å€¼lrange key 0 -1 æŸ¥å…¨éƒ¨\nlrange key start end \n# è¿”å›å¹¶å¼¹å‡ºé“¾è¡¨ä¸­çš„å¤´/å°¾éƒ¨valueã€‚åˆ é™¤äº†\nlpop/rpop key\n# è¿”å›æŒ‡å®šé“¾è¡¨ä¸­çš„valueæ•°é‡ \nllen key \n</code></pre></div><ul>\n<li>set:å­—ç¬¦ä¸²æ— åºé›†åˆã€ä¸é‡å¤ï¼Œå¤šä¸ªSetsä¹‹é—´çš„èšåˆè®¡ç®—æ“ä½œæ•ˆç‡é«˜ã€‚ç‚¹èµåŠŸèƒ½ã€‚å…±åŒå…³æ³¨ã€äºŒåº¦å¥½å‹ã€æ ‡ç­¾</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å‘setä¸­æ·»åŠ æ•°æ®ï¼Œå¦‚æœè¯¥keyçš„å€¼å·²æœ‰åˆ™ä¸ä¼šé‡å¤æ·»åŠ ï¼Œç‚¹èµ(/æ”¶è—)\nsadd key value1ã€value2â€¦\n# åˆ é™¤setä¸­æŒ‡å®šçš„æˆå‘˜ å–æ¶ˆç‚¹èµï¼ˆ/æ”¶è—ï¼‰\nsrem key member1ã€member2â€¦\n# è·å–setä¸­æ‰€æœ‰çš„æˆå‘˜ è·å–æ‰€æœ‰ç‚¹èµ(/æ”¶è—)ç”¨æˆ·  \nsmembers key\n# è·å–setä¸­æˆå‘˜çš„æ•°é‡ è·å–ç‚¹èµç”¨æˆ·æ•°é‡\nscard key\n# åˆ¤æ–­å‚æ•°ä¸­æŒ‡å®šçš„æˆå‘˜æ˜¯å¦åœ¨è¯¥setä¸­ï¼Œ1å­˜åœ¨ï¼Œ0ä¸åœ¨æˆ–è€…keyæœ¬èº«å°±ä¸åœ¨ åˆ¤æ–­æ˜¯å¦ç‚¹èµ(/æ”¶è—) \nsismember key member\n# éšæœºè¿”å›setä¸­çš„ä¸€ä¸ªæˆå‘˜\nsrandmember key\n# ä¸keyçš„é¡ºåºæœ‰å…³ã€‚è¿”å›å·®é›†â€ç›¸å‡â€œ\nsdiff key1 key2\n# å°†key1ã€key2ç›¸å·®çš„æˆå‘˜å­˜å‚¨åœ¨destinationä¸Š\nsdiffstore destination key1 key2\n# è¿”å›äº¤é›†\nsinter key key1,key2â€¦\n# å°†è¿”å›çš„äº¤é›†å­˜å‚¨åœ¨destinationä¸Š\nsinterstore destination key1 key2\n# è¿”å›å¹¶é›†\nsunion key1ã€key2\n# å°†è¿”å›çš„å¹¶é›†å­˜å‚¨åœ¨destinationä¸Š\nsunionstore destination key1 key2\n</code></pre></div><ul>\n<li>sorted set:æœ‰åºé›†åˆã€‚å…ƒç´ å”¯ä¸€ï¼Œé€šè¿‡åˆ†æ•°è¿›è¡Œä»å°åˆ°å¤§çš„æ’åºã€‚æ·»åŠ ã€åˆ é™¤æˆ–æ›´æ–°ä¸€ä¸ªæˆå‘˜çš„æ—¶é—´å¤æ‚åº¦ä¸ºé›†åˆä¸­æˆå‘˜æ•°é‡çš„å¯¹æ•°ã€‚æ•ˆç‡é«˜ã€‚(top-n)æ’åï¼šæ’å/æ’è¡Œæ¦œã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å°†æ‰€æœ‰æˆå‘˜ä»¥åŠè¯¥æˆå‘˜çš„åˆ†æ•°å­˜æ”¾åˆ°sorted-setä¸­\nzadd key score member score2 member2 â€¦\n# ç§»é™¤é›†åˆä¸­æŒ‡å®šçš„æˆå‘˜ï¼Œå¯ä»¥æŒ‡å®šå¤šä¸ªæˆå‘˜ã€‚è¿”å›åˆ é™¤çš„æ•°é‡\nzrem key member[memberâ€¦]\n# è®¾ç½®æŒ‡å®šæˆå‘˜çš„å¢åŠ çš„åˆ†æ•°incrementã€‚å¹¶è¿”å›è¯¥æˆå‘˜æ›´æ–°åçš„åˆ†æ•°ï¼ˆåˆ†æ•°æ”¹å˜åç›¸åº”å®ƒçš„indexä¹Ÿä¼šæ”¹å˜ï¼‰\nzincrby key increment member\n# è·å–é›†åˆä¸­çš„æˆå‘˜æ•°é‡\nzcard key\n# è·å–åˆ†æ•°åœ¨[min,max]ä¹‹é—´çš„æˆå‘˜æ•°é‡\nzcount key min max\n# è·å–é›†åˆä¸­è„šæ ‡ä¸ºstart-endçš„æˆå‘˜åŠåˆ†æ•°/å€’åº ã€0-1ã€‘è¡¨ç¤ºè¿”å›æ‰€æœ‰æˆå‘˜\nzrange/zrerange key start end [withscores]\n# è·å–é›†åˆä¸­åˆ†æ•°ä¸ºmin maxçš„æˆå‘˜åŠåˆ†æ•°ï¼Œå¹¶ä½åˆ°é«˜æ’åº\nzrangebyscore key min max [withscores] [limit offset count]\n# è¿”å›æˆå‘˜åœ¨é›†åˆä¸­çš„ä½ç½®æ’åï¼Œä»å°åˆ°å¤§\nzrank key member\n# è¿”å›æˆå‘˜åœ¨é›†åˆä¸­çš„ä½ç½®æ’åï¼Œä»å¤§åˆ°å°\nzrevrank key member\n# è¿”å›æŒ‡å®šæˆå‘˜çš„åˆ†æ•°\nzscore key member\n</code></pre></div><ul>\n<li>hash:é”®å€¼å¯¹é›†åˆï¼Œç”¨äºä¿å­˜å¯¹è±¡ï¼ˆç”¨æˆ·ä¿¡æ¯ï¼‰ã€åˆ†ç»„ï¼Œç¼“å­˜è´­ç‰©è½¦å¯¹è±¡</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># ä¸ºæŒ‡å®šçš„keyè®¾å®šfield/valueå¯¹ï¼ˆé”®å€¼å¯¹ï¼‰\nhset key field value\n# è¿”å›æŒ‡å®šçš„keyä¸­çš„fieldçš„å€¼\nhget key field\n# è·å–keyä¸­çš„æ‰€æœ‰filed-vaule \nhgetall key\n# åˆ é™¤é”®ä¸º key çš„å“ˆå¸Œè¡¨ä¸­çš„ä¸€ä¸ªæˆ–å¤šä¸ªå­—æ®µ\nHDEL key field\n# åˆ¤æ–­æŒ‡å®šçš„keyä¸­çš„filedæ˜¯å¦å­˜åœ¨\nhexists key field value\n# è·å–keyæ‰€åŒ…å«çš„fieldçš„æ•°é‡\nhlen key\n# è®¾ç½®keyä¸­filedçš„å€¼å¢åŠ increment\nhincrby key field increment\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># è·å–æ‰€æœ‰ä¸patternåŒ¹é…çš„ï¼Œkey * è¡¨ç¤ºå¤šä¸ªå­—ç¬¦ï¼Œï¼Ÿè¡¨ç¤ºä»»æ„ä¸€ä¸ªå­—ç¬¦\nkey keys pattern\n# å–å‡ºæ‰€æœ‰çš„key\nKey *\n# åˆ é™¤æŒ‡å®škey\ndel kye1  key2\n# åˆ¤æ–­keyæ˜¯å¦å­˜åœ¨ï¼Œ1åœ¨ï¼Œ0ä¸åœ¨\nexists key\n# ä¸ºå½“å‰çš„keyé‡å‘½å\nrename key newkey \n# è®¾ç½®è¿‡æœŸæ—¶é—´\nexpire key second\n# è·å–è¯¥keyæ‰€å‰©è¶…æ—¶æ—¶é—´ï¼Œæ²¡è¶…æ—¶åˆ™-1\nttl key\n# è¿”å›key çš„ç±»å‹ï¼Œä¸å­˜åœ¨è¿”å›none\ntype key\n# æ¸…é™¤keyçš„è¿‡æœŸæ—¶é—´ã€‚KeyæŒä¹…åŒ–ã€‚-1æ˜¯æ°¸ä¹…ä¿å­˜ -2\npersist key\n</code></pre></div><ul>\n<li>Bitmapï¼šé€šè¿‡ä¸€ä¸ªbit æ•°ç»„æ¥å­˜å‚¨ç‰¹å®šæ•°æ®çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ¯ä¸€ä¸ªbitä½éƒ½èƒ½ç‹¬ç«‹åŒ…å«ä¿¡æ¯ï¼Œå¤§é‡èŠ‚çœç©ºé—´ã€‚</li>\n<li>åº”ç”¨åœºæ™¯ï¼šåˆ¤æ–­æµ·é‡ç”¨æˆ·ä¸­æŸä¸ªç”¨æˆ·æ˜¯å¦åœ¨çº¿ï¼Œç”¨æˆ·æ¯ä¸ªæœˆçš„ç­¾åˆ°æƒ…å†µï¼Œè¿ç»­ç­¾åˆ°ç”¨æˆ·æ€»æ•°</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ¤æ–­ç”¨æˆ·æ˜¯å¦åœ¨çº¿ key=login_statusè¡¨ç¤ºå­˜å‚¨ç”¨æˆ·ç™»é™†çŠ¶æ€é›†åˆæ•°æ®ï¼Œå°†ç”¨æˆ·IDä½œä¸ºoffsetï¼Œåœ¨çº¿å°±è®¾ç½®ä¸º1ï¼Œä¸‹çº¿è®¾ç½®0\nSETBIT &lt;key&gt; &lt;offset&gt; &lt;value&gt; // è®¾ç½®ç”¨æˆ·æ˜¯å¦å·²ç™»é™†\nGETBIT &lt;key&gt; &lt;offset&gt;       // è·å–ç”¨æˆ·æ˜¯å¦åœ¨çº¿\n\n# ç»Ÿè®¡ç”¨æˆ·æ¯ä¸ªæœˆæ‰“å¼€æƒ…å†µ key = uid:sign:{userId}:{yyyyMM}ï¼Œæœˆä»½çš„æ¯ä¸€å¤©çš„å€¼-1ä½œä¸º offsetï¼ˆå› ä¸ºoffsetä»0å¼€å§‹ï¼‰\nSETBIT uid:sign:89757:202105 15 1  // è¡¨ç¤ºè®°å½•ç”¨æˆ·åœ¨ 2021 å¹´ 5 æœˆ 16 å·æ‰“å¡\nGETBIT uid:sign:89757:202105 15    // ç¼–å· 89757 ç”¨æˆ·åœ¨ 2021 å¹´ 5 æœˆ 16 å·æ˜¯å¦æ‰“å¡ã€‚\nBITCOUNT uid:sign:89757:202105     // ç»Ÿè®¡è¯¥ç”¨æˆ·åœ¨ 5 æœˆä»½çš„æ‰“å¡æ¬¡æ•°ï¼Œä½¿ç”¨ BITCOUNT æŒ‡ä»¤\nBITPOS uid:sign:89757:202105 1     // è·å– userID = 89757 åœ¨ 2021 å¹´ 5 æœˆä»½é¦–æ¬¡æ‰“å¡æ—¥æœŸ\n\n# ç»Ÿè®¡è¿ç»­ç­¾åˆ°ç”¨æˆ·æ€»æ•°(è¿ç»­7å¤©) key = {yyyyMMdd}ï¼Œ offset=userId æ‰“å¡åˆ™è®¾ç½®æˆ1ã€‚keyå¯¹åº”çš„é›†åˆçš„æ¯ä¸ªbitä½çš„æ•°æ®åˆ™æ˜¯ä¸€ä¸ªç”¨æˆ·åœ¨è¯¥æ—¥æœŸçš„æ‰“å¡è®°å½•ã€‚å¯¹è¿™7ä¸ªBitmapçš„å¯¹åº”çš„bitä½åšä¸è¿ç®—ã€‚\n# ä¸€ä¸ªä¸€äº¿ä¸ªä½çš„Bitmapå¤§çº¦å 12MBçš„å†…å­˜ï¼ˆ10^8/8/1024/1024ï¼‰ï¼Œ7å¤©çš„Bitmapå ç”¨84 MBã€‚åŒæ—¶æœ€å¥½ç»™Bitmapè®¾ç½®è¿‡æœŸæ—¶é—´ï¼Œè®©Redisåˆ é™¤è¿‡æœŸçš„æ‰“å¡æ•°æ®ï¼ŒèŠ‚çœå†…å­˜\nSETBIT 20210500 userId 1                //è®°å½•ç”¨æˆ·åœ¨2021å¹´5æœˆ1æ—¥æ‰“å¡\nBITOP AND[ORã€NOTã€XOR] destinationmap 20210500 20210501...  //è®°å½•ç”¨æˆ·åœ¨2021å¹´5æœˆ1-7æ—¥è¿ç»­æ‰“å¡çš„userIdå’ŒçŠ¶æ€åˆ°destinationmap\nBITCOUNT destinationmap               //æŸ¥è¯¢destinationmapè¿ç»­æ‰“å¡æ€»äººæ•°\n\n- HyperLogLogã€Geoã€Bitmapã€BloomFilterã€RedisSearchã€Redis-MLã€JSON\n</code></pre></div><h1>5. Redisä¸ºä»€ä¹ˆå•çº¿ç¨‹é‚£ä¹ˆå¿«ï¼Ÿ</h1>\n<ul>\n<li>åŸºäºå†…å­˜çš„æ•°æ®å­˜å‚¨ï¼Œå†…å­˜çš„è®¿é—®é€Ÿåº¦è¿œè¶…ç¡¬ç›˜ï¼Œ</li>\n<li>å•çº¿ç¨‹æ¨¡å‹ï¼Œé¿å…äº†çº¿ç¨‹åˆ‡æ¢å’Œé”ç«äº‰å¸¦æ¥çš„æ¶ˆè€—ã€‚</li>\n<li>IO å¤šè·¯å¤â½¤ï¼ŒåŸºäº Linux çš„ select/epoll æœºåˆ¶ã€‚è¯¥æœºåˆ¶å…è®¸å†…æ ¸ä¸­åŒæ—¶å­˜åœ¨å¤šä¸ªç›‘å¬å¥—æ¥å­—å’Œå·²è¿æ¥å¥—æ¥å­—ï¼Œå†…æ ¸ä¼šä¸€ç›´ç›‘å¬è¿™äº›å¥—æ¥å­—ä¸Šçš„è¿æ¥è¯·æ±‚æˆ–è€…æ•°æ®è¯·æ±‚ï¼Œä¸€æ—¦æœ‰è¯·æ±‚åˆ°è¾¾ï¼Œå°±ä¼šäº¤ç»™ Redis å¤„ç†ï¼Œå°±å®ç°äº†æ‰€è°“çš„ Redis å•ä¸ªçº¿ç¨‹å¤„ç†å¤šä¸ª IO è¯»å†™çš„è¯·æ±‚ã€‚</li>\n<li>é«˜æ•ˆçš„æ•°æ®ç»“æ„ã€‚å¦‚å­—ç¬¦ä¸²ï¼ˆStringï¼‰ã€åˆ—è¡¨ï¼ˆListï¼‰ã€é›†åˆï¼ˆSetï¼‰ã€æœ‰åºé›†åˆï¼ˆSorted Setï¼‰ç­‰</li>\n</ul>\n<h1>6. I/O å¤šè·¯å¤ç”¨ï¼Ÿ</h1>\n<ul>\n<li>I/Oå¤šè·¯å¤ç”¨å…è®¸å•ä¸ªçº¿ç¨‹æˆ–è¿›ç¨‹åŒæ—¶ç›‘æ§å¤šä¸ªI/Oæµï¼ˆå¦‚æ–‡ä»¶æˆ–ç½‘ç»œè¿æ¥ï¼‰ï¼Œå¹¶åœ¨æœ‰æ•°æ®å¯è¯»æˆ–å¯å†™æ—¶è¿›è¡Œç›¸åº”çš„å¤„ç†ï¼Œä»è€Œé«˜æ•ˆåœ°åˆ©ç”¨ç³»ç»Ÿèµ„æºã€‚</li>\n<li>Linux ç³»ç»Ÿæœ‰ä¸‰ç§æ–¹å¼å®ç° IO å¤šè·¯å¤ç”¨ï¼šselectã€poll å’Œ epollã€‚</li>\n<li>epoll æ–¹å¼æ˜¯å°†ç”¨æˆ· socket å¯¹åº”çš„ fd æ³¨å†Œè¿› epollï¼Œç„¶å epoll å¸®ä½ ç›‘å¬å“ªäº› socket ä¸Šæœ‰æ¶ˆæ¯åˆ°è¾¾ï¼Œè¿™æ ·å°±é¿å…äº†å¤§é‡çš„æ— ç”¨æ“ä½œã€‚æ­¤æ—¶çš„ socket åº”è¯¥é‡‡ç”¨éé˜»å¡æ¨¡å¼ã€‚è¿™æ ·ï¼Œæ•´ä¸ªè¿‡ç¨‹åªåœ¨è¿›è¡Œ selectã€pollã€epoll è¿™äº›è°ƒç”¨çš„æ—¶å€™æ‰ä¼šé˜»å¡ï¼Œæ”¶å‘å®¢æˆ·æ¶ˆæ¯æ˜¯ä¸ä¼šé˜»å¡çš„ï¼Œæ•´ä¸ªè¿›ç¨‹æˆ–è€…çº¿ç¨‹å°±è¢«å……åˆ†åˆ©ç”¨èµ·æ¥ï¼Œè¿™å°±æ˜¯äº‹ä»¶é©±åŠ¨ï¼Œæ‰€è°“çš„ reactor æ¨¡å¼ã€‚</li>\n</ul>\n<h1>7. Redis æ˜¯å•çº¿ç¨‹çš„å—ï¼Ÿ</h1>\n<ul>\n<li>Rediså•çº¿ç¨‹æŒ‡çš„æ˜¯ç½‘ç»œI/Oçº¿ç¨‹ä»¥åŠSetå’ŒGetæ“ä½œæ˜¯å•çº¿ç¨‹çš„ã€‚ä½†æ˜¯Redisçš„æŒä¹…åŒ–ã€é›†ç¾¤åŒæ­¥è¿˜æ˜¯ä½¿ç”¨å…¶ä»–çº¿ç¨‹æ¥å®Œæˆ</li>\n<li>Redis 4.0 ä¹‹åå¤šçº¿ç¨‹æ˜¯ç”¨æ¥å¤„ç†æ•°æ®çš„è¯»å†™å’Œåè®®è§£æï¼Œä½†æ˜¯ Redisæ‰§è¡Œå‘½ä»¤è¿˜æ˜¯å•çº¿ç¨‹çš„ã€‚è¿™æ ·åšçš„â½¬çš„æ˜¯å› ä¸º Redis çš„æ€§èƒ½ç“¶é¢ˆåœ¨äºâ½¹ç»œ IO â½½â¾® CPUï¼Œä½¿â½¤å¤šçº¿ç¨‹èƒ½æå‡ IO è¯»å†™çš„æ•ˆç‡ï¼Œä»â½½æ•´ä½“æâ¾¼ Redis çš„æ€§èƒ½ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1e419b34a2ddcd1e552d4.png\" alt=\"redismultiplethread.png\"></li>\n</ul>\n<h1>9. Redisæœ‰å“ªå‡ ç§æŒä¹…åŒ–æ–¹å¼ï¼Ÿæœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ã€å…¨é‡ã€‘RdbæŒä¹…åŒ–(é»˜è®¤)ï¼šé€šè¿‡åˆ›å»ºæ•°æ®çš„å¿«ç…§æ¥ä¿å­˜æ•°æ®ã€‚å®šæœŸæŠŠå†…å­˜ä¸­å½“å‰æ—¶åˆ»å†…å­˜ä¸­çš„æ•°æ®ä»¥äºŒè¿›åˆ¶çš„æ–¹å¼ä¿å­˜åˆ°ç£ç›˜ã€‚äº§ç”Ÿçš„æ•°æ®æ–‡ä»¶ä¸ºdump.rdbã€‚æ•°æ®æ¢å¤æ—¶ç›´æ¥å°†RDBæ–‡ä»¶è¯»å…¥å†…å­˜å®Œæˆæ¢å¤ã€‚å®é™…æ“ä½œè¿‡ç¨‹æ˜¯forkä¸€ä¸ªå­è¿›ç¨‹ï¼Œå…ˆå°†æ•°æ®é›†å†™å…¥ä¸´æ—¶æ–‡ä»¶ï¼Œå†™å…¥æˆåŠŸåï¼Œå†æ›¿æ¢ä¹‹å‰çš„æ–‡ä»¶ï¼Œç”¨äºŒè¿›åˆ¶å‹ç¼©å­˜å‚¨.å¯é€šè¿‡ save å’Œ bgsave å‘½ä»¤ä¸¤ä¸ªå‘½ä»¤æ¥æ‰‹åŠ¨è§¦å‘ RDB æŒä¹…åŒ–æ“ä½œ</p>\n<ul>\n<li>saveå‘½ä»¤ä¼šåŒæ­¥åœ°å°†Redisçš„æ‰€æœ‰æ•°æ®ä¿å­˜åˆ°ç£ç›˜ä¸Šçš„ä¸€ä¸ªRDBæ–‡ä»¶ä¸­ã€‚ä¼šé˜»å¡æ‰€æœ‰å®¢æˆ·ç«¯è¯·æ±‚ã€‚ä¸æ¨èåœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨</li>\n<li>bgsaveå‘½ä»¤ï¼šforkå‡ºä¸€ä¸ªå­è¿›ç¨‹ï¼Œåœ¨åå°å¼‚æ­¥åœ°åˆ›å»º Redis çš„æ•°æ®å¿«ç…§ï¼Œå¹¶å°†å¿«ç…§ä¿å­˜åˆ°ç£ç›˜ä¸Šçš„ RDB æ–‡ä»¶ä¸­ã€‚è¿™ä¸ªå‘½ä»¤ä¼šç«‹å³è¿”å›ï¼Œä¸é˜»å¡å®¢æˆ·ç«¯è¯·æ±‚ã€‚åœ¨ç”Ÿäº§ç¯å¢ƒä¸­æ‰§è¡Œ RDB æŒä¹…åŒ–çš„æ¨èæ–¹å¼ã€‚</li>\n</ul>\n</li>\n<li>\n<p>ã€å¢é‡ã€‘AOFæŒä¹…åŒ–ï¼šé€šè¿‡è®°å½•æ¯ä¸ªå†™å…¥å‘½ä»¤æ¥ä¿å­˜æ•°æ®ã€‚æ‰§è¡Œå‘½ä»¤å¹¶å°†å†™æ“ä½œè®°å½•æ—¥å¿—åˆ°è¿½åŠ åˆ°aofæ–‡ä»¶ä¸­ï¼Œæ•°æ®æ¢å¤æ—¶åˆ™éœ€è¦å°†å…¨é‡AOFæ—¥å¿—éƒ½æ‰§è¡Œä¸€éã€‚å·¥ä½œæµç¨‹</p>\n<ul>\n<li>å‘½ä»¤å†™å…¥ï¼ˆappendï¼‰ï¼šå½“AOFåŠŸèƒ½å¼€å¯ï¼ŒRedisä¼šå°†æ¥æ”¶åˆ°çš„æ‰€æœ‰å†™å‘½ä»¤è¿½åŠ åˆ° AOF ç¼“å†²åŒºï¼ˆbufferï¼‰çš„æœ«å°¾ã€‚</li>\n<li>æ–‡ä»¶åŒæ­¥ï¼ˆsyncï¼‰ï¼šå°†ç¼“å†²åŒºä¸­çš„å‘½ä»¤æŒä¹…åŒ–åˆ°ç£ç›˜ä¸­çš„ AOF æ–‡ä»¶ï¼ŒåŒæ­¥ç­–ç•¥åŒ…æ‹¬ï¼š\n<ul>\n<li>alwaysï¼šæ¯æ¬¡å†™å‘½ä»¤éƒ½ä¼šåŒæ­¥åˆ°AOFæ–‡ä»¶ï¼Œå®‰å…¨æ€§æï¼Œä½†å¯èƒ½å› ä¸ºç£ç›˜ I/O çš„å»¶è¿Ÿè€Œå½±å“æ€§èƒ½ã€‚</li>\n<li>everysecï¼ˆé»˜è®¤ï¼‰ï¼šæ¯ç§’åŒæ­¥ä¸€æ¬¡ï¼Œæä¾›äº†è¾ƒå¥½çš„æ€§èƒ½å’Œæ•°æ®å®‰å…¨æ€§ã€‚å¦‚æœç³»ç»Ÿå´©æºƒï¼Œæœ€å¤šå¯èƒ½ä¸¢å¤±æœ€åä¸€ç§’çš„æ•°æ®ã€‚</li>\n<li>noï¼šåªä¼šåœ¨AOFå…³é—­ã€Rediså…³é—­æˆ–ç”±æ“ä½œç³»ç»Ÿå†…æ ¸è§¦å‘ã€‚å¦‚æœå®•æœºï¼Œé‚£ä¹ˆä¸¢å¤±çš„æ•°æ®é‡ç”±æ“ä½œç³»ç»Ÿå†…æ ¸çš„ç¼“å­˜å†²æ´—ç­–ç•¥å†³å®š</li>\n</ul>\n</li>\n<li>æ–‡ä»¶é‡å†™ï¼ˆrewriteï¼‰ï¼šéšç€æ“ä½œçš„ä¸æ–­æ‰§è¡Œï¼ŒAOF æ–‡ä»¶ä¼šä¸æ–­å¢é•¿ï¼Œä¸ºäº†å‡å° AOF æ–‡ä»¶å¤§å°ï¼ŒRedisé‡å†™AOFæ–‡ä»¶ï¼š\n<ul>\n<li>é‡å†™è¿‡ç¨‹å°†å½“å‰å†…å­˜ä¸­çš„æ•°æ®åº“çŠ¶æ€è½¬æ¢ä¸ºä¸€ç³»åˆ—å†™å‘½ä»¤ï¼Œç„¶åä¿å­˜åˆ°æ–°çš„AOFæ–‡ä»¶.ç”± BGREWRITEAOF å‘½ä»¤è§¦å‘ï¼Œå®ƒä¼šåˆ›å»ºä¸€ä¸ªå­è¿›ç¨‹æ¥æ‰§è¡Œé‡å†™æ“ä½œï¼Œå› æ­¤ä¸ä¼šé˜»å¡ä¸»è¿›ç¨‹ã€‚é‡å†™è¿‡ç¨‹ä¸­ï¼Œæ–°çš„å†™å‘½ä»¤ä¼šç»§ç»­è¿½åŠ åˆ°æ—§çš„ AOF æ–‡ä»¶ä¸­ï¼ŒåŒæ—¶ä¹Ÿä¼šè¢«è®°å½•åˆ°ä¸€ä¸ªç¼“å†²åŒºä¸­ã€‚ä¸€æ—¦é‡å†™å®Œæˆï¼ŒRedis ä¼šå°†è¿™ä¸ªç¼“å†²åŒºä¸­çš„å‘½ä»¤è¿½åŠ åˆ°æ–°çš„ AOF æ–‡ä»¶ä¸­ï¼Œç„¶ååˆ‡æ¢åˆ°æ–°çš„ AOF æ–‡ä»¶ä¸Šï¼Œä»¥ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§ã€‚</li>\n</ul>\n</li>\n<li>é‡å¯åŠ è½½ï¼ˆloadï¼‰ï¼šå½“RedisæœåŠ¡å™¨å¯åŠ¨æ—¶ï¼Œå¦‚æœé…ç½®ä¸ºä½¿ç”¨AOFæŒä¹…åŒ–æ–¹å¼ï¼Œå®ƒä¼šè¯»å– AOF æ–‡ä»¶ä¸­çš„æ‰€æœ‰å‘½ä»¤å¹¶é‡æ–°æ‰§è¡Œå®ƒä»¬ï¼Œä»¥æ¢å¤æ•°æ®åº“çš„çŠ¶æ€</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># aof\nappendonly no //è¡¨ç¤ºæ˜¯å¦å¼€å¯AOFæŒä¹…åŒ–ç­–ç•¥(é»˜è®¤noï¼Œå…³é—­)\nappendfilename \"appendonly.aof\"//æŒä¹…åŒ–æ–‡ä»¶åç§°\n</code></pre></div><h1>10. rdbæŒä¹…åŒ–è§¦å‘æ¡ä»¶</h1>\n<ul>\n<li>åœ¨ Redis é…ç½®æ–‡ä»¶ï¼ˆé€šå¸¸æ˜¯ redis.confï¼‰ä¸­ï¼Œå¯ä»¥é€šè¿‡save <code>&lt;seconds&gt;</code> <code>&lt;changes&gt;</code>æŒ‡ä»¤é…ç½®è‡ªåŠ¨è§¦å‘ RDB æŒä¹…åŒ–çš„æ¡ä»¶ã€‚è¿™ä¸ªæŒ‡ä»¤å¯ä»¥è®¾ç½®å¤šæ¬¡ï¼Œæ¯ä¸ªè®¾ç½®å®šä¹‰äº†ä¸€ä¸ªæ—¶é—´é—´éš”ï¼ˆç§’ï¼‰å’Œè¯¥æ—¶é—´å†…å‘ç”Ÿçš„å˜æ›´æ¬¡æ•°é˜ˆå€¼ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>save 900 1 å¦‚æœè‡³å°‘æœ‰ 1 ä¸ªé”®è¢«ä¿®æ”¹ï¼Œ900 ç§’åè‡ªåŠ¨è§¦å‘ä¸€æ¬¡ RDB æŒä¹…åŒ–ã€‚\nsave 300 10 å¦‚æœè‡³å°‘æœ‰ 10 ä¸ªé”®è¢«ä¿®æ”¹ï¼Œ300 ç§’åè‡ªåŠ¨è§¦å‘ä¸€æ¬¡ RDB æŒä¹…åŒ–ã€‚\nsave 60 10000 å¦‚æœè‡³å°‘æœ‰ 10000 ä¸ªé”®è¢«ä¿®æ”¹ï¼Œ60 ç§’åè‡ªåŠ¨è§¦å‘ä¸€æ¬¡ RDB æŒä¹…åŒ–ã€‚\n</code></pre></div><ul>\n<li>é€šè¿‡ SHUTDOWN å‘½ä»¤æ­£å¸¸å…³é—­æ—¶æ‰§è¡Œ ä¸€æ¬¡RDB æŒä¹…åŒ–ï¼Œä»¥ç¡®ä¿æ•°æ®åœ¨ä¸‹æ¬¡å¯åŠ¨æ—¶èƒ½å¤Ÿæ¢å¤ã€‚</li>\n<li>åœ¨ Redis å¤åˆ¶åœºæ™¯ä¸­ï¼Œå½“ä¸€ä¸ª Redis å®ä¾‹è¢«é…ç½®ä¸ºä»èŠ‚ç‚¹å¹¶ä¸”ä¸ä¸»èŠ‚ç‚¹å»ºç«‹è¿æ¥æ—¶ï¼Œå®ƒå¯èƒ½ä¼šæ ¹æ®é…ç½®æ¥æ”¶ä¸»èŠ‚ç‚¹çš„ RDB æ–‡ä»¶æ¥åˆå§‹åŒ–æ•°æ®é›†ã€‚è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œä¸»èŠ‚ç‚¹ä¼šåœ¨åå°è‡ªåŠ¨è§¦å‘ RDB æŒä¹…åŒ–ï¼Œç„¶åå°†ç”Ÿæˆçš„ RDB æ–‡ä»¶å‘é€ç»™ä»èŠ‚ç‚¹ã€‚</li>\n</ul>\n<h1>11. RDB å’Œ AOF å„è‡ªæœ‰ä»€ä¹ˆä¼˜ç¼ºç‚¹ï¼Ÿ</h1>\n<ul>\n<li>RDBæ–‡ä»¶ç›¸å¯¹å°ï¼Œæ¢å¤é€Ÿåº¦å¿«ï¼Œä½†å®æ—¶æ€§å·®ï¼Œæ•°æ®å®¹æ˜“ä¸¢å¤±ï¼Œå¤‡ä»½æ—¶é—´é•¿ã€‚é€‚åˆå…¨é‡å¤‡ä»½</li>\n<li>AOFæ–‡ä»¶ç›¸å¯¹å¤§ï¼Œæ¢å¤é€Ÿåº¦æ…¢ï¼Œä½†å®æ—¶æ€§å¥½ï¼Œæ•°æ®ä¸æ˜“ä¸¢å¤±ï¼Œæ•°æ®å†™å…¥æ€§èƒ½é«˜ï¼Œé€‚åˆå¢é‡å¤‡ä»½</li>\n</ul>\n<h1>12. å¦‚ä½•é€‰æ‹©åˆé€‚çš„æŒä¹…åŒ–æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>ç”¨AOFåšå¢é‡æŒä¹…åŒ–,ä¿è¯æ•°æ®ä¸ä¸¢å¤±; ç”¨RDBå…¨é‡æŒä¹…åŒ–,åšä¸åŒç¨‹åº¦çš„å†·å¤‡;å› ä¸ºRDBè€—æ—¶é•¿ï¼Œåœ¨åœæœºçš„æ—¶å€™ä¼šå¯¼è‡´å¤§é‡ä¸¢å¤±æ•°æ®ï¼Œæ‰€ä»¥éœ€è¦AOFæ¥é…åˆä½¿ç”¨ã€‚</li>\n</ul>\n<h1>13. Redis çš„æ•°æ®æ¢å¤ï¼Ÿ</h1>\n<ul>\n<li>æŠŠRDBæˆ–è€…AOFæ–‡ä»¶æ‹·è´åˆ° Redis çš„æ•°æ®ç›®å½•ä¸‹ï¼Œå¦‚æœä½¿ç”¨ AOF æ¢å¤ï¼Œé…ç½®æ–‡ä»¶å¼€å¯ AOFï¼Œç„¶åå¯åŠ¨ redis-server å³å¯</li>\n<li>Redis å¯åŠ¨æ—¶åŠ è½½æ•°æ®çš„æµç¨‹ï¼š\n<ul>\n<li>AOF æŒä¹…åŒ–å¼€å¯ä¸”å­˜åœ¨ AOF æ–‡ä»¶æ—¶ï¼Œä¼˜å…ˆåŠ è½½ AOF æ–‡ä»¶ã€‚</li>\n<li>AOF å…³é—­æˆ–è€… AOF æ–‡ä»¶ä¸å­˜åœ¨æ—¶ï¼ŒåŠ è½½ RDB æ–‡ä»¶ã€‚</li>\n<li>åŠ è½½ AOF/RDB æ–‡ä»¶æˆåŠŸåï¼ŒRedis å¯åŠ¨æˆåŠŸã€‚</li>\n<li>AOF/RDB æ–‡ä»¶å­˜åœ¨é”™è¯¯æ—¶ï¼ŒRedis å¯åŠ¨å¤±è´¥å¹¶æ‰“å°é”™è¯¯ä¿¡æ¯</li>\n</ul>\n</li>\n</ul>\n<h1>14. Redis 4.0 çš„æ··åˆæŒä¹…åŒ–äº†è§£å—ï¼Ÿâˆš</h1>\n<ul>\n<li>åœ¨ Redis 4.0 ç‰ˆæœ¬ä¸­ï¼Œæ··åˆæŒä¹…åŒ–æ¨¡å¼ä¼šåœ¨ AOF é‡å†™çš„æ—¶å€™åŒæ—¶ç”Ÿæˆä¸€ä»½ RDB å¿«ç…§ï¼Œç„¶åå°†è¿™ä»½å¿«ç…§ä½œä¸º AOF æ–‡ä»¶çš„ä¸€éƒ¨åˆ†ï¼Œæœ€åå†é™„åŠ æ–°çš„å†™å…¥å‘½ä»¤ã€‚å½“éœ€è¦æ¢å¤æ•°æ®æ—¶ï¼ŒRedis å…ˆåŠ è½½ RDB æ–‡ä»¶æ¥æ¢å¤åˆ°å¿«ç…§æ—¶åˆ»çš„çŠ¶æ€ï¼Œç„¶ååº”ç”¨ RDB ä¹‹åè®°å½•çš„ AOF å‘½ä»¤æ¥æ¢å¤ä¹‹åçš„æ•°æ®æ›´æ”¹ï¼Œæ—¢å¿«åˆå¯é ã€‚</li>\n</ul>\n<h1>15. rediså¦‚ä½•å®ç°é«˜å¯ç”¨ï¼Ÿ</h1>\n<ul>\n<li>ä¸»ä»å¤åˆ¶ï¼ˆMaster-Slave Replicationï¼‰ï¼šå…è®¸ä¸€ä¸ª Redis æœåŠ¡å™¨ï¼ˆä¸»èŠ‚ç‚¹ï¼‰å°†æ•°æ®å¤åˆ¶åˆ°ä¸€ä¸ªæˆ–å¤šä¸ª Redis æœåŠ¡å™¨ï¼ˆä»èŠ‚ç‚¹ï¼‰ã€‚å¯ä»¥å®ç°è¯»å†™åˆ†ç¦»ï¼Œé€‚åˆè¯»å¤šå†™å°‘çš„åœºæ™¯ã€‚</li>\n<li>å“¨å…µæ¨¡å¼ï¼ˆSentinelï¼‰ï¼šç”¨äºç›‘æ§ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹çš„çŠ¶æ€ï¼Œå®ç°è‡ªåŠ¨æ•…éšœè½¬ç§»å’Œç³»ç»Ÿæ¶ˆæ¯é€šçŸ¥ã€‚å¦‚æœä¸»èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œå“¨å…µå¯ä»¥è‡ªåŠ¨å°†ä¸€ä¸ªä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li>\n<li>é›†ç¾¤æ¨¡å¼ï¼ˆClusterï¼‰ï¼šRedis é›†ç¾¤é€šè¿‡åˆ†ç‰‡çš„æ–¹å¼å­˜å‚¨æ•°æ®ï¼Œæ¯ä¸ªèŠ‚ç‚¹å­˜å‚¨æ•°æ®çš„ä¸€éƒ¨åˆ†ï¼Œç”¨æˆ·è¯·æ±‚å¯ä»¥å¹¶è¡Œå¤„ç†ã€‚é›†ç¾¤æ¨¡å¼æ”¯æŒè‡ªåŠ¨åˆ†åŒºã€æ•…éšœè½¬ç§»ï¼Œå¹¶ä¸”å¯ä»¥åœ¨ä¸åœæœºçš„æƒ…å†µä¸‹è¿›è¡ŒèŠ‚ç‚¹å¢åŠ æˆ–åˆ é™¤ã€‚</li>\n</ul>\n<h1>16. ä»€ä¹ˆæ˜¯ä¸»ä»å¤åˆ¶ï¼Ÿ</h1>\n<ul>\n<li>æŒ‡å°†ä¸€å° Redis æœåŠ¡å™¨çš„æ•°æ®ï¼Œå¤åˆ¶åˆ°å…¶ä»–çš„ Redis æœåŠ¡å™¨ã€‚å‰è€…ç§°ä¸ºä¸»èŠ‚ç‚¹(master)ï¼Œåè€…ç§°ä¸ºä»èŠ‚ç‚¹(slave)ã€‚ä¸”æ•°æ®çš„å¤åˆ¶æ˜¯å•å‘çš„ï¼Œåªèƒ½ç”±ä¸»èŠ‚ç‚¹åˆ°ä»èŠ‚ç‚¹ã€‚Redis ä¸»ä»å¤åˆ¶æ”¯æŒ ä¸»ä»åŒæ­¥ å’Œ ä»ä»åŒæ­¥ ä¸¤ç§</li>\n</ul>\n<h1>17. ä¸»ä»å¤åˆ¶ä¸»è¦çš„ä½œç”¨?</h1>\n<ul>\n<li>æ•°æ®å¤‡ä»½ï¼šå®ç°æ•°æ®çš„çƒ­å¤‡ä»½ï¼Œæ˜¯æŒä¹…åŒ–ä¹‹å¤–çš„ä¸€ç§æ•°æ®å†—ä½™æ–¹å¼ã€‚</li>\n<li>æ•…éšœæ¢å¤ï¼šå½“ä¸»èŠ‚ç‚¹å‡ºç°é—®é¢˜æ—¶ï¼Œå¯ä»¥ç”±ä»èŠ‚ç‚¹æä¾›æœåŠ¡ï¼Œå®ç°å¿«é€Ÿçš„æ•…éšœæ¢å¤ (æœåŠ¡å†—ä½™)ã€‚</li>\n<li>è´Ÿè½½å‡è¡¡ï¼šåœ¨ä¸»ä»å¤åˆ¶çš„åŸºç¡€ä¸Šï¼Œé…åˆè¯»å†™åˆ†ç¦»ï¼Œå¯ä»¥ç”±ä¸»èŠ‚ç‚¹æä¾›å†™æœåŠ¡ï¼Œç”±ä»èŠ‚ç‚¹æä¾›è¯»æœåŠ¡ï¼Œåˆ†æ‹…æœåŠ¡å™¨è´Ÿè½½ã€‚å°¤å…¶æ˜¯åœ¨å†™å°‘è¯»å¤šçš„åœºæ™¯ä¸‹ï¼Œé€šè¿‡å¤šä¸ªä»èŠ‚ç‚¹åˆ†æ‹…è¯»è´Ÿè½½ï¼Œå¯ä»¥å¤§å¤§æé«˜ Redis æœåŠ¡å™¨çš„å¹¶å‘é‡ã€‚</li>\n<li>ä¸æ¨èåœ¨Redisä¸­ä½¿ç”¨è¯»å†™åˆ†ç¦»ã€‚ä¸»è¦æœ‰ä¸¤ä¸ªåŸå› ï¼š\n<ul>\n<li>Redis Sentinelåªä¿è¯ä¸»èŠ‚ç‚¹çš„æ•…éšœçš„å¤±æ•ˆè½¬ç§»ï¼Œå¦‚Jedisåªç›‘å¬äº†ä¸»èŠ‚ç‚¹çš„å˜åŒ–ï¼Œä½†æ˜¯ä»èŠ‚ç‚¹æ•…éšœæ—¶æ˜¯ä¸è¿›è¡Œå¤„ç†çš„ã€‚å¯¼è‡´Jedisè¯»ä¼šè®¿é—®åˆ°ä»èŠ‚ç‚¹ã€‚Redissonåº“åŠŸèƒ½å¼ºå¤§ï¼Œå·²ç»æ”¯æŒä»èŠ‚ç‚¹çš„æ•…éšœç›‘å¬</li>\n<li>å¦‚æœåˆ°è¾¾éœ€è¦è¯»å†™åˆ†ç¦»çš„ä½“é‡ï¼Œå¤§é‡å†™æ“ä½œè€ƒè™‘Redis Clusteræ–¹æ¡ˆæ›´å¯é </li>\n</ul>\n</li>\n</ul>\n<h1>18. Redis ä¸»ä»æœ‰å‡ ç§å¸¸è§çš„æ‹“æ‰‘ç»“æ„ï¼Ÿ</h1>\n<ul>\n<li>Redisçš„å¤åˆ¶æ‹“æ‰‘ç»“æ„å¯ä»¥æ”¯æŒå•å±‚æˆ–å¤šå±‚å¤åˆ¶å…³ç³»ï¼Œæ ¹æ®æ‹“æ‰‘å¤æ‚æ€§å¯ä»¥åˆ†ä¸º</li>\n<li>ä¸€ä¸»ä¸€ä»ç»“æ„ï¼šç”¨äºä¸»èŠ‚ç‚¹å‡ºç°å®•æœºæ—¶ä»èŠ‚ç‚¹æä¾›æ•…éšœè½¬ç§»æ”¯æŒã€‚</li>\n<li>ä¸€ä¸»å¤šä»ç»“æ„ï¼šï¼ˆæ˜Ÿå½¢æ‹“æ‰‘ç»“æ„ï¼‰ä½¿å¾—åº”ç”¨ç«¯å¯ä»¥åˆ©ç”¨å¤šä¸ªä»èŠ‚ç‚¹å®ç°è¯»å†™åˆ†ç¦»ã€‚å¯¹äºè¯»å æ¯”è¾ƒå¤§çš„åœºæ™¯ï¼Œå¯ä»¥æŠŠè¯»å‘½ä»¤å‘é€åˆ°ä»èŠ‚ç‚¹æ¥åˆ†æ‹…ä¸»èŠ‚ç‚¹å‹åŠ›ã€‚</li>\n<li>æ ‘çŠ¶ä¸»ä»ç»“æ„ï¼ˆæ ‘çŠ¶æ‹“æ‰‘ç»“æ„ï¼‰ä½¿å¾—ä»èŠ‚ç‚¹ä¸ä½†å¯ä»¥å¤åˆ¶ä¸»èŠ‚ç‚¹æ•°æ®ï¼ŒåŒæ—¶å¯ä»¥ä½œä¸ºå…¶ä»–ä»èŠ‚ç‚¹çš„ä¸»èŠ‚ç‚¹ç»§ç»­å‘ä¸‹å±‚å¤åˆ¶ã€‚é€šè¿‡å¼•å…¥å¤åˆ¶ä¸­é—´å±‚ï¼Œå¯ä»¥æœ‰æ•ˆé™ä½ä¸»èŠ‚ç‚¹è´Ÿè½½å’Œéœ€è¦ä¼ é€ç»™ä»èŠ‚ç‚¹çš„æ•°æ®é‡ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8d36eea3d0eb3f10097b0.png\" alt=\"redismasterslavestructure.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e666f55d51dd82b781e4f.png\" alt=\"redismasterslavestructure2.png\"></li>\n</ul>\n<h1>19. Redis çš„ä¸»ä»å¤åˆ¶åŸç†</h1>\n<ul>\n<li>ä¿å­˜ä¸»èŠ‚ç‚¹ï¼ˆmasterï¼‰ä¿¡æ¯:åªæ˜¯ä¿å­˜ä¸»èŠ‚ç‚¹ä¿¡æ¯ï¼Œip å’Œ portã€‚</li>\n<li>ä¸»ä»å»ºç«‹è¿æ¥:ä»èŠ‚ç‚¹ï¼ˆslaveï¼‰å‘ç°æ–°çš„ä¸»èŠ‚ç‚¹åï¼Œä¼šå°è¯•å’Œä¸»èŠ‚ç‚¹å»ºç«‹ç½‘ç»œè¿æ¥ã€‚</li>\n<li>å‘é€ ping å‘½ä»¤:ä»èŠ‚ç‚¹å‘é€ ping è¯·æ±‚è¿›è¡Œé¦–æ¬¡é€šä¿¡ï¼Œä¸»è¦æ˜¯æ£€æµ‹ä¸»ä»ä¹‹é—´ç½‘ç»œå¥—æ¥å­—æ˜¯å¦å¯ç”¨ã€ä¸»èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯æ¥å—å¤„ç†å‘½ä»¤ã€‚</li>\n<li>æƒé™éªŒè¯:å¦‚æœä¸»èŠ‚ç‚¹è¦æ±‚å¯†ç éªŒè¯ï¼Œä»èŠ‚ç‚¹å¿…é¡»æ­£ç¡®çš„å¯†ç æ‰èƒ½é€šè¿‡éªŒè¯ã€‚</li>\n<li>åŒæ­¥æ•°æ®é›†:ä¸»ä»å¤åˆ¶è¿æ¥æ­£å¸¸é€šä¿¡åï¼Œä¸»èŠ‚ç‚¹ä¼šæŠŠæŒæœ‰çš„æ•°æ®å…¨éƒ¨å‘é€ç»™ä»èŠ‚ç‚¹ã€‚</li>\n<li>å‘½ä»¤æŒç»­å¤åˆ¶:æ¥ä¸‹æ¥ä¸»èŠ‚ç‚¹ä¼šæŒç»­åœ°æŠŠå†™å‘½ä»¤å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¿è¯ä¸»ä»æ•°æ®ä¸€è‡´æ€§<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2ae083f185ce950c4ca66.png\" alt=\"redismasterslaveprinciple.png\"></li>\n</ul>\n<h1>20. è¯´è¯´ä¸»ä»æ•°æ®åŒæ­¥çš„æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>Redis åœ¨ 2.8 åŠä»¥ä¸Šç‰ˆæœ¬ä½¿ç”¨ psync å‘½ä»¤å®Œæˆä¸»ä»æ•°æ®åŒæ­¥ï¼ŒåŒæ­¥è¿‡ç¨‹åˆ†ä¸ºï¼šå…¨é‡å¤åˆ¶å’Œéƒ¨åˆ†å¤åˆ¶ã€‚</li>\n<li>å…¨é‡å¤åˆ¶:ç”¨äºåˆæ¬¡å¤åˆ¶åœºæ™¯ï¼ŒæŠŠä¸»èŠ‚ç‚¹å…¨éƒ¨æ•°æ®ä¸€æ¬¡æ€§å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œå½“æ•°æ®é‡è¾ƒå¤§æ—¶ï¼Œä¼šå¯¹ä¸»ä»èŠ‚ç‚¹å’Œç½‘ç»œé€ æˆå¾ˆå¤§çš„å¼€é”€<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ffedbc5a058de697f61a5.png\" alt=\"fullreplication.png\">\n<ul>\n<li>å»ºç«‹è¿æ¥ï¼šä»æœåŠ¡å™¨å’Œä¸»æœåŠ¡å™¨å»ºç«‹è¿æ¥ï¼Œä»æœåŠ¡å™¨æ‰§è¡Œreplicaofå‘½ä»¤å¹¶å‘é€ psync å‘½ä»¤è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œç”±äºæ˜¯ç¬¬ä¸€æ¬¡è¿›è¡Œå¤åˆ¶ï¼Œä»èŠ‚ç‚¹æ²¡æœ‰å¤åˆ¶åç§»é‡å’Œä¸»èŠ‚ç‚¹çš„è¿è¡Œ IDï¼Œæ‰€ä»¥å‘é€ psync ? -1ã€‚</li>\n<li>ä¸»èŠ‚ç‚¹æ ¹æ® psync ? -1 è§£æå‡ºå½“å‰ä¸ºå…¨é‡å¤åˆ¶ï¼Œå›å¤+FULLRESYNC å“åº”ã€‚</li>\n<li>ä»èŠ‚ç‚¹æ¥æ”¶ä¸»èŠ‚ç‚¹çš„å“åº”æ•°æ®ä¿å­˜è¿è¡Œ ID å’Œåç§»é‡ offset</li>\n<li>ä¸»èŠ‚ç‚¹æ‰§è¡Œ bgsave ä¿å­˜ RDB æ–‡ä»¶åˆ°æœ¬åœ°</li>\n<li>ä¸»èŠ‚ç‚¹å‘é€ RDB æ–‡ä»¶ç»™ä»èŠ‚ç‚¹ï¼Œä»èŠ‚ç‚¹æŠŠæ¥æ”¶çš„ RDB æ–‡ä»¶ä¿å­˜åœ¨æœ¬åœ°å¹¶ç›´æ¥ä½œä¸ºä»èŠ‚ç‚¹çš„æ•°æ®æ–‡ä»¶</li>\n<li>å¯¹äºä»èŠ‚ç‚¹å¼€å§‹æ¥æ”¶ RDB å¿«ç…§åˆ°æ¥æ”¶å®ŒæˆæœŸé—´ï¼Œä¸»èŠ‚ç‚¹ä»ç„¶å“åº”è¯»å†™å‘½ä»¤ï¼Œå› æ­¤ä¸»èŠ‚ç‚¹ä¼šæŠŠè¿™æœŸé—´å†™å‘½ä»¤æ•°æ®ä¿å­˜åœ¨å¤åˆ¶å®¢æˆ·ç«¯ç¼“å†²åŒºå†…ï¼Œå½“ä»èŠ‚ç‚¹åŠ è½½å®ŒRDBæ–‡ä»¶åï¼Œä¸»èŠ‚ç‚¹å†æŠŠç¼“å†²åŒºå†…çš„æ•°æ®å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¿è¯ä¸»ä»ä¹‹é—´æ•°æ®ä¸€è‡´æ€§</li>\n<li>ä»èŠ‚ç‚¹æ¥æ”¶å®Œä¸»èŠ‚ç‚¹ä¼ é€æ¥çš„å…¨éƒ¨æ•°æ®åä¼šæ¸…ç©ºè‡ªèº«æ—§æ•°æ®å¹¶å¼€å§‹åŠ è½½ RDB æ–‡ä»¶</li>\n<li>ä»èŠ‚ç‚¹æˆåŠŸåŠ è½½å®Œ RDB åï¼Œå¦‚æœå½“å‰èŠ‚ç‚¹å¼€å¯äº† AOF æŒä¹…åŒ–åŠŸèƒ½ï¼Œ å®ƒä¼šç«‹åˆ»åš bgrewriteaof æ“ä½œï¼Œä¸ºäº†ä¿è¯å…¨é‡å¤åˆ¶å AOF æŒä¹…åŒ–æ–‡ä»¶ç«‹åˆ»å¯ç”¨ã€‚</li>\n</ul>\n</li>\n<li>éƒ¨åˆ†å¤åˆ¶:ä½¿ç”¨ psync{runId}{offset}å‘½ä»¤å®ç°ã€‚å½“ä»èŠ‚ç‚¹ï¼ˆslaveï¼‰æ­£åœ¨å¤åˆ¶ä¸»èŠ‚ç‚¹ ï¼ˆmasterï¼‰æ—¶ï¼Œå¦‚æœå‡ºç°ç½‘ç»œé—ªæ–­æˆ–è€…å‘½ä»¤ä¸¢å¤±ç­‰å¼‚å¸¸æƒ…å†µæ—¶ï¼Œä»èŠ‚ç‚¹ä¼šå‘ ä¸»èŠ‚ç‚¹è¦æ±‚è¡¥å‘ä¸¢å¤±çš„å‘½ä»¤æ•°æ®ï¼Œå¦‚æœä¸»èŠ‚ç‚¹çš„å¤åˆ¶ç§¯å‹ç¼“å†²åŒºå†…å­˜åœ¨è¿™éƒ¨åˆ†æ•°æ®åˆ™ç›´æ¥å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œè¿™æ ·å°±å¯ä»¥ä¿æŒä¸»ä»èŠ‚ç‚¹å¤åˆ¶çš„ä¸€è‡´æ€§ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/eaeefc5f1f4452d5b8dc8.png\" alt=\"partialreplication.png\">\n<ul>\n<li>å½“ä¸»ä»èŠ‚ç‚¹ä¹‹é—´ç½‘ç»œå‡ºç°ä¸­æ–­æ—¶ï¼Œå¦‚æœè¶…è¿‡ repl-timeout æ—¶é—´ï¼Œä¸»èŠ‚ç‚¹ä¼šè®¤ä¸ºä»èŠ‚ç‚¹æ•…éšœå¹¶ä¸­æ–­å¤åˆ¶è¿æ¥</li>\n<li>ä¸»ä»è¿æ¥ä¸­æ–­æœŸé—´ä¸»èŠ‚ç‚¹ä¾ç„¶å“åº”å‘½ä»¤ï¼Œä½†å› å¤åˆ¶è¿æ¥ä¸­æ–­å‘½ä»¤æ— æ³•å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¸è¿‡ä¸»èŠ‚ç‚¹å†…éƒ¨å­˜åœ¨çš„ç¯å½¢å¤åˆ¶ç§¯å‹ç¼“å†²åŒºrepl_backlog_bufferï¼Œä¾ç„¶å¯ä»¥ä¿å­˜æœ€è¿‘ä¸€æ®µæ—¶é—´çš„å†™å‘½ä»¤æ•°æ®ï¼Œé»˜è®¤æœ€å¤§ç¼“å­˜ 1MBã€‚æ‰€ä»¥å½“ç¼“å†²åŒºå†™æ»¡åï¼Œä¸»æœåŠ¡å™¨ç»§ç»­å†™å…¥çš„è¯ï¼Œå°±ä¼šè¦†ç›–ä¹‹å‰çš„æ•°æ®ã€‚ç”¨äºä¸»ä»æœåŠ¡å™¨æ–­è¿åï¼Œä»ä¸­æ‰¾åˆ°å·®å¼‚çš„æ•°æ®ï¼›ä¸»æœåŠ¡å™¨ä½¿ç”¨ master_repl_offset æ¥è®°å½•è‡ªå·±å†™åˆ°çš„ä½ç½®ï¼Œä»æœåŠ¡å™¨ä½¿ç”¨ slave_repl_offset æ¥è®°å½•è‡ªå·±è¯»åˆ°çš„ä½ç½®</li>\n<li>å½“ä¸»ä»èŠ‚ç‚¹ç½‘ç»œæ¢å¤åï¼Œä»èŠ‚ç‚¹ä¼šå†æ¬¡è¿ä¸Šä¸»èŠ‚ç‚¹</li>\n<li>å½“ä¸»ä»è¿æ¥æ¢å¤åï¼Œç”±äºä»èŠ‚ç‚¹ä¹‹å‰ä¿å­˜äº†è‡ªèº«å·²å¤åˆ¶çš„åç§»é‡å’Œä¸»èŠ‚ç‚¹çš„è¿è¡Œ IDã€‚å› æ­¤ä¼šæŠŠå®ƒä»¬å½“ä½œ psync å‚æ•°å‘é€ç»™ä¸»èŠ‚ç‚¹ï¼Œè¦æ±‚è¿›è¡Œéƒ¨åˆ†å¤åˆ¶æ“ä½œã€‚</li>\n<li>ä¸»èŠ‚ç‚¹æ¥åˆ° psync å‘½ä»¤åé¦–å…ˆæ ¸å¯¹å‚æ•° runId æ˜¯å¦ä¸è‡ªèº«ä¸€è‡´ï¼Œå¦‚æœä¸€ è‡´ï¼Œè¯´æ˜ä¹‹å‰å¤åˆ¶çš„æ˜¯å½“å‰ä¸»èŠ‚ç‚¹ï¼›ä¹‹åæ ¹æ®å‚æ•° slave_repl_offset å’Œslave_repl_offsetåœ¨è‡ªèº«å¤åˆ¶ç§¯å‹ç¼“å†²åŒºæŸ¥æ‰¾ï¼Œå¦‚æœåç§»é‡ä¹‹åçš„æ•°æ®å­˜åœ¨ç¼“å†²åŒºä¸­ï¼Œåˆ™å¯¹ä»èŠ‚ç‚¹å‘é€+CONTINUE å“åº”ï¼Œè¡¨ç¤ºå¯ä»¥è¿›è¡Œéƒ¨åˆ†å¤åˆ¶ã€‚å¦åˆ™å…¨é‡å¤åˆ¶</li>\n<li>ä¸»èŠ‚ç‚¹æ ¹æ®åç§»é‡æŠŠå¤åˆ¶ç§¯å‹ç¼“å†²åŒºé‡Œçš„æ•°æ®å‘é€ç»™ä»èŠ‚ç‚¹ï¼Œä¿è¯ä¸»ä»å¤åˆ¶è¿›å…¥æ­£å¸¸çŠ¶æ€ã€‚</li>\n</ul>\n</li>\n<li>repl_backlog_bufferç¼“å†²åŒºå°½å¯èƒ½çš„å¤§ä¸€äº›ï¼Œå‡å°‘å‡ºç°ä»æœåŠ¡å™¨è¦è¯»å–çš„æ•°æ®è¢«è¦†ç›–çš„æ¦‚ç‡ï¼Œå¯ä»¥æ ¹æ®å…¬å¼ä¼°ç®—second ï¼ˆä»æœåŠ¡å™¨æ–­çº¿åé‡æ–°è¿æ¥ä¸Šä¸»æœåŠ¡å™¨æ‰€éœ€çš„å¹³å‡æ—¶é—´(ç§’)ï¼‰* write_size_per_secondï¼ˆä¸»æœåŠ¡å™¨å¹³å‡æ¯ç§’äº§ç”Ÿçš„å†™å‘½ä»¤æ•°æ®é‡å¤§å°ï¼‰ä¿®æ”¹redis.confçš„repl-backlog-size 1mb å³å¯</li>\n</ul>\n<h1>21. ä¸»ä»å¤åˆ¶å­˜åœ¨å“ªäº›é—®é¢˜å‘¢ï¼Ÿ</h1>\n<ul>\n<li>æ²¡æ³•å®Œæˆè‡ªåŠ¨æ•…éšœè½¬ç§»ï¼šä¸€æ—¦ä¸»èŠ‚ç‚¹å‡ºç°æ•…éšœï¼Œéœ€è¦æ‰‹åŠ¨å°†ä¸€ä¸ªä»èŠ‚ç‚¹æ™‹å‡ä¸ºä¸»èŠ‚ç‚¹ï¼ŒåŒæ—¶éœ€è¦ä¿®æ”¹åº”ç”¨æ–¹çš„ä¸»èŠ‚ç‚¹åœ°å€ï¼Œè¿˜éœ€è¦å‘½ä»¤å…¶ä»–ä»èŠ‚ç‚¹å»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ï¼Œæ•´ä¸ªè¿‡ç¨‹éƒ½éœ€è¦äººå·¥å¹²é¢„ã€‚(é«˜å¯ç”¨)</li>\n<li>ä¸»èŠ‚ç‚¹çš„å†™å’Œå­˜å‚¨èƒ½åŠ›å—åˆ°å•æœºçš„é™åˆ¶ã€‚(åˆ†å¸ƒå¼)</li>\n</ul>\n<h1>22. Redis Sentinelï¼ˆå“¨å…µï¼‰äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>è§£å†³äº†ä¸»ä»å¤åˆ¶çš„æ²¡æ³•è‡ªåŠ¨æ•…éšœè½¬ç§»é—®é¢˜.ç”±ä¸¤éƒ¨åˆ†ç»„æˆï¼Œå“¨å…µèŠ‚ç‚¹å’Œæ•°æ®èŠ‚ç‚¹\n<ul>\n<li>å“¨å…µèŠ‚ç‚¹ï¼š å“¨å…µç³»ç»Ÿç”±ä¸€ä¸ªæˆ–å¤šä¸ªå“¨å…µèŠ‚ç‚¹ç»„æˆï¼Œä¸å­˜å‚¨æ•°æ®ï¼Œå¯¹æ•°æ®èŠ‚ç‚¹è¿›è¡Œç›‘æ§ã€‚</li>\n<li>æ•°æ®èŠ‚ç‚¹ï¼š ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹éƒ½æ˜¯æ•°æ®èŠ‚ç‚¹ï¼›</li>\n</ul>\n</li>\n<li>å“¨å…µåŠŸèƒ½çš„æè¿°ï¼š\n<ul>\n<li>ç›‘æ§ï¼ˆMonitoringï¼‰ï¼š å“¨å…µä¼šä¸æ–­åœ°æ£€æŸ¥ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹æ˜¯å¦è¿ä½œæ­£å¸¸ã€‚</li>\n<li>è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆAutomatic failoverï¼‰ï¼š å½“ ä¸»èŠ‚ç‚¹ ä¸èƒ½æ­£å¸¸å·¥ä½œæ—¶ï¼Œå“¨å…µä¼šå¼€å§‹ è‡ªåŠ¨æ•…éšœè½¬ç§»æ“ä½œï¼Œå®ƒä¼šå°†å¤±æ•ˆä¸»èŠ‚ç‚¹çš„å…¶ä¸­ä¸€ä¸ª ä»èŠ‚ç‚¹å‡çº§ä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œå¹¶è®©å…¶ä»–ä»èŠ‚ç‚¹æ”¹ä¸ºå¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹ã€‚ä½¿å¾—å“¨å…µå¯ä»¥åŠæ—¶å‘ç°ä¸»èŠ‚ç‚¹æ•…éšœå¹¶å®Œæˆè½¬ç§»ã€‚è€Œé…ç½®æä¾›è€…å’Œé€šçŸ¥åŠŸèƒ½ï¼Œåˆ™éœ€è¦åœ¨ä¸å®¢æˆ·ç«¯çš„äº¤äº’ä¸­æ‰èƒ½ä½“ç°</li>\n<li>é…ç½®æä¾›è€…ï¼ˆConfiguration providerï¼‰ï¼š å®¢æˆ·ç«¯åœ¨åˆå§‹åŒ–æ—¶ï¼Œé€šè¿‡è¿æ¥å“¨å…µæ¥è·å¾—å½“å‰RedisæœåŠ¡çš„ä¸»èŠ‚ç‚¹åœ°å€ã€‚</li>\n<li>é€šçŸ¥ï¼ˆNotificationï¼‰ï¼š å“¨å…µå¯ä»¥å°†æ•…éšœè½¬ç§»çš„ç»“æœå‘é€ç»™å®¢æˆ·ç«¯ã€‚å¹¶ä¸”é€šçŸ¥å®¢æˆ·ç«¯ä¸æ–° master å»ºç«‹è¿æ¥ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f59a33b39eaf18665a5d2.png\" alt=\"redissentinel.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>23. Redis Sentinelï¼ˆå“¨å…µï¼‰å®ç°åŸç†</h1>\n<ul>\n<li>\n<p>ç»„æˆå‘½ä»¤sentinel monitor <code>&lt;master-name&gt;</code> <code>&lt;ip&gt;</code> <code>&lt;redis-port&gt;</code> <code>&lt;quorum&gt;</code></p>\n</li>\n<li>\n<p>å“¨å…µèŠ‚ç‚¹ä¹‹é—´æ˜¯é€šè¿‡ Redis çš„å‘å¸ƒè€…/è®¢é˜…è€…æœºåˆ¶æ¥ç›¸äº’å‘ç°çš„ã€‚åœ¨ä¸»ä»é›†ç¾¤ä¸­ï¼Œä¸»èŠ‚ç‚¹ä¸Šæœ‰ä¸€ä¸ªåä¸º__sentinel__:helloçš„é¢‘é“ï¼Œä¸åŒå“¨å…µå°±æ˜¯é€šè¿‡å®ƒæ¥ç›¸äº’å‘ç°ï¼Œå®ç°äº’ç›¸é€šä¿¡çš„</p>\n</li>\n<li>\n<p>å“¨å…µæ¨¡å¼æ˜¯é€šè¿‡å“¨å…µèŠ‚ç‚¹å®Œæˆå¯¹æ•°æ®èŠ‚ç‚¹çš„ç›‘æ§ã€ä¸‹çº¿(ä¸»å®¢è§‚ä¸‹çº¿)ã€é¢†å¯¼è€…sentinelé€‰ä¸¾ã€æ•…éšœè½¬ç§»ã€‚</p>\n</li>\n<li>\n<p>å®šæ—¶ç›‘æ§</p>\n<ul>\n<li>ä¸»ä»ä¿¡æ¯è·å–ï¼šæ¯éš”10ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå‘ä¸»èŠ‚ç‚¹å’Œä»èŠ‚ç‚¹å‘é€ info å‘½ä»¤è·å–æœ€æ–°çš„æ‹“æ‰‘ç»“æ„</li>\n<li>å“¨å…µä¿¡æ¯å‘å¸ƒï¼šæ¯éš”2ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå‘ Redis æ•°æ®èŠ‚ç‚¹çš„sentinelï¼šhello é¢‘é“ä¸Šå‘é€è¯¥ Sentinel èŠ‚ç‚¹å¯¹äºä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ä»¥åŠå½“å‰ Sentinel èŠ‚ç‚¹çš„ä¿¡æ¯</li>\n<li>èŠ‚ç‚¹å¿ƒè·³æ£€æµ‹ï¼šæ¯éš” 1 ç§’ï¼Œæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šå‘ä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹ã€å…¶ä½™ Sentinel èŠ‚ç‚¹å‘é€ä¸€æ¡ ping å‘½ä»¤åšä¸€æ¬¡å¿ƒè·³æ£€æµ‹ï¼Œæ¥ç¡®è®¤è¿™äº›èŠ‚ç‚¹å½“å‰æ˜¯å¦å¯è¾¾</li>\n</ul>\n</li>\n<li>\n<p>ä¸»è§‚ä¸‹çº¿å’Œå®¢è§‚ä¸‹çº¿ï¼š</p>\n<ul>\n<li>ä¸»è§‚ä¸‹çº¿ï¼šæ¯ä¸ª Sentinel èŠ‚ç‚¹ä¼šæ¯éš” 1 ç§’å¯¹ä¸»èŠ‚ç‚¹ã€ä»èŠ‚ç‚¹ã€å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ ping å‘½ä»¤åšå¿ƒè·³æ£€æµ‹ï¼Œå½“è¿™äº›èŠ‚ç‚¹è¶…è¿‡ down-after-milliseconds æ²¡æœ‰è¿›è¡Œæœ‰æ•ˆå›å¤ï¼ŒSentinel èŠ‚ç‚¹å°†è¯¥èŠ‚ç‚¹æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ã€‚</li>\n<li>å®¢è§‚ä¸‹çº¿ï¼šå½“ Sentinel æ ‡è®°ä¸»è§‚ä¸‹çº¿çš„èŠ‚ç‚¹æ˜¯ä¸»èŠ‚ç‚¹æ—¶ï¼Œè¯¥ Sentinel èŠ‚ç‚¹ä¼šé€šè¿‡ is- master-down-by-addr å‘½ä»¤å‘å…¶ä»– Sentinel èŠ‚ç‚¹è¯¢é—®å¯¹ä¸»èŠ‚ç‚¹çš„åˆ¤æ–­ï¼Œå½“è¶…è¿‡ <code>&lt;quorum&gt;</code>ï¼ˆä¸€èˆ¬ä¸ºå“¨å…µä¸ªæ•°çš„äºŒåˆ†ä¹‹ä¸€åŠ 1ï¼‰ä¸ªæ•°ï¼ŒSentinel èŠ‚ç‚¹è®¤ä¸ºä¸»èŠ‚ç‚¹ç¡®å®æœ‰é—®é¢˜ï¼Œè¿™æ—¶è¯¥ Sentinel èŠ‚ç‚¹ä¼šæ ‡è®°ä¸»èŠ‚ç‚¹å®¢è§‚ä¸‹çº¿</li>\n</ul>\n</li>\n<li>\n<p>é¢†å¯¼è€… Sentinel èŠ‚ç‚¹é€‰ä¸¾ï¼šSentinel èŠ‚ç‚¹ä¹‹é—´ä¼šé€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºé¢†å¯¼è€…è¿›è¡Œæ•…éšœè½¬ç§»çš„å·¥ä½œã€‚ä½¿ç”¨Raftç®—æ³•å®ç°</p>\n</li>\n<li>\n<p>æ•…éšœè½¬ç§»ï¼šé¢†å¯¼è€…é€‰ä¸¾å‡ºçš„ Sentinel èŠ‚ç‚¹è´Ÿè´£æ•…éšœè½¬ç§»ï¼Œè¿‡ç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>é€‰å‡ºä¸»èŠ‚ç‚¹ï¼šåœ¨ä»èŠ‚ç‚¹åˆ—è¡¨ä¸­é€‰å‡ºä¸€ä¸ªèŠ‚ç‚¹ä½œä¸ºæ–°çš„ä¸»èŠ‚ç‚¹ï¼Œ</li>\n<li>è®¾ç½®ä¸»èŠ‚ç‚¹ï¼šSentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå¯¹ç¬¬ä¸€æ­¥é€‰å‡ºæ¥çš„ä»èŠ‚ç‚¹æ‰§è¡Œ slaveof no one å‘½ä»¤è®©å…¶æˆä¸ºä¸»èŠ‚ç‚¹</li>\n<li>ä»èŠ‚ç‚¹åŒæ­¥ï¼šSentinel é¢†å¯¼è€…èŠ‚ç‚¹ä¼šå‘å‰©ä½™çš„ä»èŠ‚ç‚¹å‘é€SLAVEOF ip portå‘½ä»¤ï¼Œè®©å®ƒä»¬æˆä¸ºæ–°ä¸»èŠ‚ç‚¹çš„ä»èŠ‚ç‚¹</li>\n<li>é€šçŸ¥å®¢æˆ·ç«¯ï¼šå“¨å…µå°±ä¼šå‘ +switch-master é¢‘é“å°†æ–°ä¸»èŠ‚ç‚¹çš„IPåœ°å€å’Œä¿¡æ¯ï¼Œé€šè¿‡å‘å¸ƒè€…/è®¢é˜…è€…æœºåˆ¶é€šçŸ¥ç»™å®¢æˆ·ç«¯ï¼›</li>\n<li>åŸèŠ‚ç‚¹è½¬ä»ï¼šSentinel èŠ‚ç‚¹é›†åˆç»§ç»­ç›‘è§†åŸæ¥çš„ä¸»èŠ‚ç‚¹ï¼Œå½“å…¶æ¢å¤åå‘é€ SLAVEOF IP portå‘½ä»¤å®ƒå»å¤åˆ¶æ–°çš„ä¸»èŠ‚ç‚¹</li>\n</ul>\n</li>\n</ul>\n<h1>24. é¢†å¯¼è€… Sentinel èŠ‚ç‚¹é€‰ä¸¾äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ä½¿ç”¨äº† Raft ç®—æ³•å® ç°é¢†å¯¼è€…é€‰ä¸¾ï¼Œå¤§è‡´æµç¨‹å¦‚ä¸‹ï¼š</p>\n</li>\n<li>\n<p>æ¯ä¸ªåœ¨çº¿çš„ Sentinel èŠ‚ç‚¹éƒ½æœ‰èµ„æ ¼æˆä¸ºé¢†å¯¼è€…ï¼Œå½“å®ƒç¡®è®¤ä¸»èŠ‚ç‚¹ä¸»è§‚ ä¸‹çº¿æ—¶å€™ï¼Œä¼šå‘å…¶ä»– Sentinel èŠ‚ç‚¹å‘é€ is-master-down-by-addr å‘½ä»¤ï¼Œ è¦æ±‚å°†è‡ªå·±è®¾ç½®ä¸ºé¢†å¯¼è€…ã€‚</p>\n</li>\n<li>\n<p>æ”¶åˆ°å‘½ä»¤çš„ Sentinel èŠ‚ç‚¹ï¼Œå¦‚æœæ²¡æœ‰åŒæ„è¿‡å…¶ä»– Sentinel èŠ‚ç‚¹çš„ is-master-down-by-addr å‘½ä»¤ï¼Œå°†åŒæ„è¯¥è¯·æ±‚ï¼Œå¦åˆ™æ‹’ç»ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœè¯¥ Sentinel èŠ‚ç‚¹å‘ç°è‡ªå·±çš„ç¥¨æ•°å·²ç»å¤§äºç­‰äº maxï¼ˆquorumï¼Œ numï¼ˆsentinelsï¼‰/2+1ï¼‰ï¼Œé‚£ä¹ˆå®ƒå°†æˆä¸ºé¢†å¯¼è€…</p>\n</li>\n<li>\n<p>å¦‚æœæ­¤è¿‡ç¨‹æ²¡æœ‰é€‰ä¸¾å‡ºé¢†å¯¼è€…ï¼Œå°†è¿›å…¥ä¸‹ä¸€æ¬¡é€‰ä¸¾</p>\n</li>\n<li>\n<p>ä¸ºä»€ä¹ˆå“¨å…µèŠ‚ç‚¹è‡³å°‘è¦æœ‰3ä¸ªï¼Ÿå¦‚æœå“¨å…µé›†ç¾¤ä¸­åªæœ‰2ä¸ªå“¨å…µèŠ‚ç‚¹ï¼Œæ­¤æ—¶å¦‚æœä¸€ä¸ªå“¨å…µæƒ³è¦æˆåŠŸæˆä¸ºLeaderï¼Œå¿…é¡»è·å¾—2ç¥¨ï¼Œè€Œä¸æ˜¯1ç¥¨ã€‚å¦‚æœæœ‰ä¸ªå“¨å…µæŒ‚æ‰äº†ï¼Œå‰©ä¸‹çš„å“¨å…µæƒ³è¦æˆä¸ºLeaderï¼Œç¥¨æ•°å°±æ²¡æ³•è¾¾åˆ°2ç¥¨ï¼Œå°±æ— æ³•æˆåŠŸæˆä¸ºLeaderï¼Œæ— æ³•è¿›è¡Œä¸»ä»èŠ‚ç‚¹åˆ‡æ¢çš„ã€‚å› æ­¤ï¼Œé€šå¸¸é…ç½®3ä¸ªå“¨å…µèŠ‚ç‚¹ã€‚å¦‚æœ3ä¸ªå“¨å…µèŠ‚ç‚¹æŒ‚äº†2ä¸ªæ€ä¹ˆåŠï¼Ÿäººä¸ºä»‹å…¥ï¼Œæˆ–è€…å¢åŠ å¤šä¸€ç‚¹å“¨å…µèŠ‚ç‚¹</p>\n</li>\n</ul>\n<h1>25. æ–°çš„ä¸»èŠ‚ç‚¹æ˜¯æ€æ ·è¢«æŒ‘é€‰å‡ºæ¥çš„</h1>\n<ul>\n<li>è¿‡æ»¤ï¼šâ€œä¸å¥åº·â€ï¼ˆä¸»è§‚ä¸‹çº¿ã€æ–­çº¿ï¼‰ã€5 ç§’å†…æ²¡æœ‰å›å¤è¿‡ Sentinel èŠ‚ ç‚¹ ping å“åº”ã€ä¸ä¸»èŠ‚ç‚¹å¤±è”è¶…è¿‡ down-after-milliseconds*10ç§’</li>\n<li>é€‰æ‹© slave-priorityï¼ˆä»èŠ‚ç‚¹ä¼˜å…ˆçº§ï¼‰æœ€é«˜çš„ä»èŠ‚ç‚¹åˆ—è¡¨ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿”å›ï¼Œä¸å­˜åœ¨åˆ™ç»§ç»­ã€‚</li>\n<li>é€‰æ‹©å¤åˆ¶åç§»é‡æœ€å¤§çš„ä»èŠ‚ç‚¹ï¼ˆå¤åˆ¶çš„æœ€å®Œæ•´ï¼‰ï¼Œå“ªä¸ªä»ã€Œä¸»èŠ‚ç‚¹ã€æ¥æ”¶çš„å¤åˆ¶æ•°æ®å¤š(å¦‚æœæŸä¸ªä»èŠ‚ç‚¹çš„ slave_repl_offset æœ€æ¥è¿‘ master_repl_offset)ï¼Œå¦‚æœå­˜åœ¨åˆ™è¿” å›ï¼Œä¸å­˜åœ¨åˆ™ç»§ç»­ã€‚</li>\n<li>é€‰æ‹©èŠ‚ç‚¹id runid æœ€å°çš„ä»èŠ‚ç‚¹ã€‚</li>\n</ul>\n<h1>26. Redis é›†ç¾¤äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>ä¸»ä»å­˜åœ¨é«˜å¯ç”¨å’Œåˆ†å¸ƒå¼çš„é—®é¢˜ï¼Œå“¨å…µè§£å†³äº†é«˜å¯ç”¨çš„é—®é¢˜ï¼Œè€Œé›†ç¾¤è§£å†³é«˜å¯ç”¨å’Œåˆ†å¸ƒå¼é—®é¢˜ã€‚</li>\n<li>æ•°æ®åˆ†åŒºï¼šå°†æ•°æ®åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œçªç ´äº† Redis å•æœºå†…å­˜å¤§å°çš„é™åˆ¶ï¼Œå­˜å‚¨å®¹é‡å¤§å¤§å¢åŠ ï¼›æ¯ä¸ªä¸»èŠ‚ç‚¹éƒ½å¯ä»¥å¯¹å¤–æä¾›è¯»æœåŠ¡å’Œå†™æœåŠ¡ï¼Œå¤§å¤§æé«˜äº†é›†ç¾¤çš„å“åº”èƒ½åŠ›ã€‚</li>\n<li>é«˜å¯ç”¨ï¼šé›†ç¾¤æ”¯æŒä¸»ä»å¤åˆ¶å’Œä¸»èŠ‚ç‚¹çš„è‡ªåŠ¨æ•…éšœè½¬ç§»ï¼ˆä¸å“¨å…µç±»ä¼¼ï¼‰ï¼Œå½“ä»»ä¸€èŠ‚ç‚¹å‘ç”Ÿæ•…éšœæ—¶ï¼Œé›†ç¾¤ä»ç„¶å¯ä»¥å¯¹å¤–æä¾›æœåŠ¡</li>\n</ul>\n<h1>27. åˆ‡ç‰‡é›†ç¾¤äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>åˆ‡ç‰‡é›†ç¾¤æ˜¯ä¸€ç§å°†æ•°æ®åˆ†ç‰‡å­˜å‚¨åœ¨å¤šä¸ª Redis å®ä¾‹ä¸Šçš„é›†ç¾¤æ¶æ„ï¼Œæ¯ä¸ª Redis å®ä¾‹è´Ÿè´£å­˜å‚¨éƒ¨åˆ†æ•°æ®ã€‚æ¯”å¦‚è¯´æŠŠ 25G çš„æ•°æ®å¹³å‡åˆ†ä¸º 5 ä»½ï¼Œæ¯ä»½ 5Gï¼Œç„¶åå¯åŠ¨ 5 ä¸ª Redis å®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹ä¿å­˜ä¸€ä»½æ•°æ®ã€‚</li>\n<li>æ•°æ®å’Œå®ä¾‹ä¹‹é—´å¦‚ä½•æ˜ å°„å‘¢ï¼ŸRedis Clusteræ˜¯é’ˆå¯¹åˆ‡ç‰‡é›†ç¾¤æä¾›çš„è§£å†³æ–¹æ¡ˆï¼›åœ¨ Redis Cluster ä¸­ï¼Œæ•°æ®å’Œå®ä¾‹ä¹‹é—´çš„æ˜ å°„æ˜¯é€šè¿‡å“ˆå¸Œæ§½ï¼ˆhash slotï¼‰æ¥å®ç°çš„ã€‚Redis Cluster æœ‰ 16384 ä¸ªå“ˆå¸Œæ§½ï¼Œæ¯ä¸ªé”®æ ¹æ®å…¶åå­—çš„ CRC16 å€¼è¢«æ˜ å°„åˆ°è¿™äº›å“ˆå¸Œæ§½ä¸Šã€‚ç„¶åï¼Œè¿™äº›å“ˆå¸Œæ§½ä¼šè¢«å‡åŒ€åœ°åˆ†é…åˆ°æ‰€æœ‰çš„ Redis å®ä¾‹ä¸Šã€‚CRC16 æ˜¯ä¸€ç§å“ˆå¸Œç®—æ³•ï¼Œå®ƒå¯ä»¥å°†ä»»æ„é•¿åº¦çš„è¾“å…¥æ•°æ®æ˜ å°„ä¸ºä¸€ä¸ª 16 ä½çš„å“ˆå¸Œå€¼ã€‚éœ€è¦å­˜å‚¨æˆ–æ£€ç´¢ä¸€ä¸ªé”®å€¼å¯¹æ—¶ï¼ŒRedis Cluster ä¼šå…ˆè®¡ç®—è¿™ä¸ªé”®çš„å“ˆå¸Œæ§½ï¼Œç„¶åæ‰¾åˆ°è´Ÿè´£è¿™ä¸ªå“ˆå¸Œæ§½çš„ Redis å®ä¾‹ï¼Œæœ€ååœ¨è¿™ä¸ªå®ä¾‹ä¸Šè¿›è¡Œæ“ä½œã€‚å³crc16ï¼ˆkeyï¼‰&amp; 16384</li>\n</ul>\n<h1>28. é›†ç¾¤ä¸­æ•°æ®å¦‚ä½•åˆ†åŒºï¼Ÿ</h1>\n<p>åœ¨ Redis é›†ç¾¤ä¸­ï¼Œæ•°æ®åˆ†åŒºæ˜¯é€šè¿‡å°†æ•°æ®åˆ†æ•£åˆ°ä¸åŒçš„èŠ‚ç‚¹æ¥å®ç°çš„ï¼Œå¸¸è§çš„æ•°æ®åˆ†åŒºè§„åˆ™æœ‰ä¸‰ç§ï¼šèŠ‚ç‚¹å–ä½™åˆ†åŒºã€ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒºã€è™šæ‹Ÿæ§½åˆ†åŒºã€‚</p>\n<ul>\n<li>èŠ‚ç‚¹å–ä½™åˆ†åŒºï¼šæ•°æ®é¡¹çš„é”®ç»è¿‡å“ˆå¸Œå‡½æ•°è®¡ç®—åï¼Œå¯¹èŠ‚ç‚¹æ•°é‡å–ä½™ï¼Œç„¶åå°†æ•°æ®é¡¹åˆ†é…åˆ°ä½™æ•°å¯¹åº”çš„èŠ‚ç‚¹ä¸Šã€‚ç¼ºç‚¹æ˜¯æ‰©ç¼©å®¹æ—¶ï¼Œå¤§å¤šæ•°æ•°æ®éœ€è¦é‡æ–°åˆ†é…ï¼Œå› ä¸ºèŠ‚ç‚¹æ€»æ•°çš„æ”¹å˜ä¼šå½±å“å–ä½™ç»“æœï¼Œè¿™å¯èƒ½å¯¼è‡´å¤§é‡æ•°æ®è¿ç§»ã€‚</li>\n<li>ä¸€è‡´æ€§å“ˆå¸Œåˆ†åŒºï¼šå°†å“ˆå¸Œå€¼ç©ºé—´ç»„ç»‡æˆä¸€ä¸ªç¯ï¼Œæ•°æ®é¡¹å’ŒèŠ‚ç‚¹éƒ½æ˜ å°„åˆ°è¿™ä¸ªç¯ä¸Šã€‚æ•°æ®é¡¹ç”±å…¶å“ˆå¸Œå€¼ç›´æ¥æ˜ å°„åˆ°ç¯ä¸Šï¼Œç„¶åé¡ºæ—¶é’ˆåˆ†é…åˆ°é‡åˆ°çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ã€‚ä»è€Œæ¥å‡å°‘èŠ‚ç‚¹å˜åŠ¨æ—¶æ•°æ®è¿ç§»çš„é‡ã€‚ç›¸æ¯”èŠ‚ç‚¹å–ä½™æœ€å¤§çš„å¥½å¤„åœ¨äºåŠ å…¥å’Œåˆ é™¤èŠ‚ç‚¹åªå½±å“å“ˆå¸Œç¯ä¸­ç›¸é‚»çš„èŠ‚ç‚¹ï¼Œå¯¹å…¶ä»–èŠ‚ç‚¹æ— å½±å“ã€‚èŠ‚ç‚¹åœ¨åœ†ç¯ä¸Šåˆ†å¸ƒä¸å¹³å‡ï¼Œä¼šé€ æˆéƒ¨åˆ†ç¼“å­˜èŠ‚ç‚¹çš„å‹åŠ›è¾ƒå¤§ï¼›å½“æŸä¸ªèŠ‚ç‚¹æ•…éšœæ—¶ï¼Œè¿™ä¸ªèŠ‚ç‚¹æ‰€è¦æ‰¿æ‹…çš„æ‰€æœ‰è®¿é—®éƒ½ä¼šè¢«é¡ºç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œä¼šå¯¹åé¢è¿™ä¸ªèŠ‚ç‚¹é€ æˆå‹åŠ›ã€‚</li>\n<li>è™šæ‹Ÿæ§½ï¼ˆå“ˆå¸Œæ§½ï¼‰åˆ†åŒºä¸­ï¼Œå­˜åœ¨å›ºå®šæ•°é‡çš„æ§½ä½ï¼ˆä¾‹å¦‚ Redis Cluster æœ‰ 16384 ä¸ªæ§½ï¼‰ï¼Œæ¯ä¸ªé”®é€šè¿‡å“ˆå¸Œç®—æ³•ï¼ˆCRC16ï¼‰æ˜ å°„åˆ°è¿™äº›æ§½ä¸Šï¼Œæ¯ä¸ªé›†ç¾¤èŠ‚ç‚¹è´Ÿè´£ç®¡ç†ä¸€å®šèŒƒå›´å†…çš„æ§½ã€‚å¯ä»¥çµæ´»åœ°å°†æ§½ï¼ˆä»¥åŠæ§½ä¸­çš„æ•°æ®ï¼‰ä»ä¸€ä¸ªèŠ‚ç‚¹è¿ç§»åˆ°å¦ä¸€ä¸ªèŠ‚ç‚¹ï¼Œä»è€Œå®ç°å¹³æ»‘æ‰©å®¹å’Œç¼©å®¹ï¼›æ•°æ®åˆ†å¸ƒä¹Ÿæ›´åŠ å‡åŒ€ï¼ŒRedis Cluster é‡‡ç”¨çš„æ­£æ˜¯è¿™ç§åˆ†åŒºæ–¹å¼ã€‚\n<ul>\n<li>åœ¨è™šæ‹Ÿæ§½åˆ†åŒºä¸­ï¼Œæ§½æ˜¯æ•°æ®ç®¡ç†å’Œè¿ç§»çš„åŸºæœ¬å•ä½ã€‚å‡è®¾ç³»ç»Ÿä¸­æœ‰ 4 ä¸ªå®é™…èŠ‚ç‚¹ï¼Œå‡è®¾ä¸ºå…¶åˆ†é…äº† 16 ä¸ªæ§½(0-15)ï¼›æ§½ 0-3 ä½äºèŠ‚ç‚¹ node1ï¼›æ§½ 4-7 ä½äºèŠ‚ç‚¹ node2ï¼›æ§½ 8-11 ä½äºèŠ‚ç‚¹ node3ï¼›æ§½ 12-15 ä½äºèŠ‚ç‚¹ node4ã€‚å¦‚æœæ­¤æ—¶åˆ é™¤ node2ï¼Œåªéœ€è¦å°†æ§½ 4-7 é‡æ–°åˆ†é…å³å¯ï¼Œä¾‹å¦‚å°†æ§½ 4-5 åˆ†é…ç»™ node1ï¼Œæ§½ 6 åˆ†é…ç»™ node3ï¼Œæ§½ 7 åˆ†é…ç»™ node4ï¼Œæ•°æ®åœ¨èŠ‚ç‚¹ä¸Šçš„åˆ†å¸ƒä»ç„¶è¾ƒä¸ºå‡è¡¡ã€‚å¦‚æœæ­¤æ—¶å¢åŠ  node5ï¼Œä¹Ÿåªéœ€è¦å°†ä¸€éƒ¨åˆ†æ§½åˆ†é…ç»™ node5 å³å¯ï¼Œæ¯”å¦‚è¯´å°†æ§½ 3ã€æ§½ 7ã€æ§½ 11ã€æ§½ 15 è¿ç§»ç»™ node5ï¼ŒèŠ‚ç‚¹ä¸Šçš„å…¶ä»–æ§½ä½ä¿ç•™ã€‚å½“ç„¶äº†ï¼Œè¿™å–å†³äº CRC16(key) % æ§½çš„ä¸ªæ•° çš„å…·ä½“ç»“æœã€‚å› ä¸ºåœ¨ Redis Cluster ä¸­ï¼Œæ§½çš„ä¸ªæ•°åˆšå¥½æ˜¯ 2 çš„ 14 æ¬¡æ–¹ï¼Œè¿™å’Œ HashMap ä¸­æ•°ç»„çš„é•¿åº¦å¿…é¡»æ˜¯ 2 çš„å¹‚æ¬¡æ–¹æœ‰ç€å¼‚æ›²åŒå·¥ä¹‹å¦™ã€‚å®ƒèƒ½ä¿è¯æ‰©å®¹åï¼Œå¤§éƒ¨åˆ†æ•°æ®åœç•™åœ¨æ‰©å®¹å‰çš„ä½ç½®ï¼Œåªæœ‰å°‘éƒ¨åˆ†æ•°æ®éœ€è¦è¿ç§»åˆ°æ–°çš„æ§½ä¸Šã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>29. Redis é›†ç¾¤çš„åŸç†å—ï¼Ÿ</h1>\n<ul>\n<li>Redis é›†ç¾¤é€šè¿‡æ•°æ®åˆ†åŒºæ¥å®ç°æ•°æ®çš„åˆ†å¸ƒå¼å­˜å‚¨ï¼Œé€šè¿‡è‡ªåŠ¨æ•…éšœè½¬ç§»å®ç°é«˜å¯ç”¨ã€‚</li>\n<li>é›†ç¾¤åˆ›å»ºï¼šæ•°æ®åˆ†åŒºæ˜¯åœ¨é›†ç¾¤åˆ›å»ºçš„æ—¶å€™å®Œæˆçš„ã€‚\n<ul>\n<li>è®¾ç½®èŠ‚ç‚¹ï¼šRedis é›†ç¾¤ä¸€èˆ¬ç”±å¤šä¸ªèŠ‚ç‚¹ç»„æˆï¼ŒèŠ‚ç‚¹æ•°é‡è‡³å°‘ä¸º 6 ä¸ªæ‰èƒ½ä¿è¯ç»„æˆå®Œæ•´é«˜å¯ç”¨çš„é›†ç¾¤ã€‚æ¯ä¸ªèŠ‚ç‚¹éœ€è¦å¼€å¯é…ç½® cluster-enabled yesï¼Œè®© Redis è¿è¡Œåœ¨é›†ç¾¤æ¨¡å¼ä¸‹ã€‚</li>\n<li>èŠ‚ç‚¹æ¡æ‰‹ï¼šæŒ‡ä¸€æ‰¹è¿è¡Œåœ¨é›†ç¾¤æ¨¡å¼ä¸‹çš„èŠ‚ç‚¹é€šè¿‡ Gossip åè®®å½¼æ­¤é€šä¿¡ï¼Œ è¾¾åˆ°æ„ŸçŸ¥å¯¹æ–¹çš„è¿‡ç¨‹ã€‚èŠ‚ç‚¹æ¡æ‰‹æ˜¯é›†ç¾¤å½¼æ­¤é€šä¿¡çš„ç¬¬ä¸€æ­¥ï¼Œç”±å®¢æˆ·ç«¯å‘èµ·å‘½ä»¤ï¼šcluster meet{ip}{port}ã€‚å®ŒæˆèŠ‚ç‚¹æ¡æ‰‹ä¹‹åï¼Œä¸€ä¸ªä¸ªçš„ Redis èŠ‚ç‚¹å°±ç»„æˆäº†ä¸€ä¸ªå¤šèŠ‚ç‚¹çš„é›†ç¾¤</li>\n<li>åˆ†é…æ§½ï¼ˆslotï¼‰ï¼šRedis é›†ç¾¤æŠŠæ‰€æœ‰çš„æ•°æ®æ˜ å°„åˆ° 16384 ä¸ªæ§½ä¸­ã€‚æ¯ä¸ªèŠ‚ç‚¹å¯¹åº”è‹¥å¹²ä¸ªæ§½ï¼Œåªæœ‰å½“èŠ‚ç‚¹åˆ†é…äº†æ§½ï¼Œæ‰èƒ½å“åº”å’Œè¿™äº›æ§½å…³è”çš„é”®å‘½ä»¤ã€‚é€šè¿‡ cluster addslots å‘½ä»¤ä¸ºèŠ‚ç‚¹åˆ†é…æ§½ã€‚</li>\n<li>æ•…éšœè½¬ç§»ï¼šRedis é›†ç¾¤çš„æ•…éšœè½¬ç§»å’Œå“¨å…µçš„æ•…éšœè½¬ç§»ç±»ä¼¼ï¼Œä½†æ˜¯ Redis é›†ç¾¤ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½è¦æ‰¿æ‹…çŠ¶æ€ç»´æŠ¤çš„ä»»åŠ¡ã€‚</li>\n<li>æ•…éšœå‘ç°ï¼šRedis é›†ç¾¤å†…èŠ‚ç‚¹é€šè¿‡ ping/pong æ¶ˆæ¯å®ç°èŠ‚ç‚¹é€šä¿¡ï¼Œé›†ç¾¤ä¸­æ¯ä¸ªèŠ‚ç‚¹éƒ½ä¼šå®šæœŸå‘å…¶ä»–èŠ‚ç‚¹å‘é€ ping æ¶ˆæ¯ï¼Œæ¥æ”¶èŠ‚ç‚¹å›å¤ pong æ¶ˆæ¯ä½œä¸ºå“åº”ã€‚å¦‚æœåœ¨ cluster-node-timeout æ—¶é—´å†…é€šä¿¡ä¸€ç›´å¤±è´¥ï¼Œåˆ™å‘é€èŠ‚ ç‚¹ä¼šè®¤ä¸ºæ¥æ”¶èŠ‚ç‚¹å­˜åœ¨æ•…éšœï¼ŒæŠŠæ¥æ”¶èŠ‚ç‚¹æ ‡è®°ä¸ºä¸»è§‚ä¸‹çº¿ï¼ˆpfailï¼‰çŠ¶æ€ã€‚å½“æŸä¸ªèŠ‚ç‚¹åˆ¤æ–­å¦ä¸€ä¸ªèŠ‚ç‚¹ä¸»è§‚ä¸‹çº¿åï¼Œç›¸åº”çš„èŠ‚ç‚¹çŠ¶æ€ä¼šè·Ÿéšæ¶ˆæ¯åœ¨é›†ç¾¤å†…ä¼ æ’­ã€‚é€šè¿‡ Gossip æ¶ˆæ¯ä¼ æ’­ï¼Œé›†ç¾¤å†…èŠ‚ç‚¹ä¸æ–­æ”¶é›†åˆ°æ•…éšœèŠ‚ç‚¹çš„ä¸‹çº¿æŠ¥å‘Šã€‚å½“ åŠæ•°ä»¥ä¸ŠæŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹éƒ½æ ‡è®°æŸä¸ªèŠ‚ç‚¹æ˜¯ä¸»è§‚ä¸‹çº¿æ—¶ã€‚è§¦å‘å®¢è§‚ä¸‹çº¿æµç¨‹ã€‚</li>\n<li>æ•…éšœæ¢å¤ï¼šæ•…éšœèŠ‚ç‚¹å˜ä¸ºå®¢è§‚ä¸‹çº¿åï¼Œå¦‚æœä¸‹çº¿èŠ‚ç‚¹æ˜¯æŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹åˆ™éœ€è¦åœ¨å®ƒ çš„ä»èŠ‚ç‚¹ä¸­é€‰å‡ºä¸€ä¸ªæ›¿æ¢å®ƒï¼Œä»è€Œä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ã€‚æµç¨‹å¦‚ä¸‹\n<ul>\n<li>èµ„æ ¼æ£€æŸ¥ï¼šæ¯ä¸ªä»èŠ‚ç‚¹éƒ½è¦æ£€æŸ¥æœ€åä¸ä¸»èŠ‚ç‚¹æ–­çº¿æ—¶é—´ï¼Œåˆ¤æ–­æ˜¯å¦æœ‰èµ„æ ¼æ›¿æ¢æ•…éšœ çš„ä¸»èŠ‚ç‚¹ã€‚</li>\n<li>å‡†å¤‡é€‰ä¸¾æ—¶é—´ï¼šå½“ä»èŠ‚ç‚¹ç¬¦åˆæ•…éšœè½¬ç§»èµ„æ ¼åï¼Œæ›´æ–°è§¦å‘æ•…éšœé€‰ä¸¾çš„æ—¶é—´ï¼Œåªæœ‰åˆ°è¾¾è¯¥ æ—¶é—´åæ‰èƒ½æ‰§è¡Œåç»­æµç¨‹ã€‚</li>\n<li>å‘èµ·é€‰ä¸¾ï¼šå½“ä»èŠ‚ç‚¹å®šæ—¶ä»»åŠ¡æ£€æµ‹åˆ°è¾¾æ•…éšœé€‰ä¸¾æ—¶é—´ï¼ˆfailover_auth_timeï¼‰åˆ°è¾¾åï¼Œå‘èµ·é€‰ä¸¾æµç¨‹ã€‚</li>\n<li>é€‰ä¸¾æŠ•ç¥¨ï¼šæŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹å¤„ç†æ•…éšœé€‰ä¸¾æ¶ˆæ¯ã€‚æŠ•ç¥¨è¿‡ç¨‹å…¶å®æ˜¯ä¸€ä¸ªé¢†å¯¼è€…é€‰ä¸¾çš„è¿‡ç¨‹ï¼Œå¦‚é›†ç¾¤å†…æœ‰ N ä¸ªæŒæœ‰æ§½çš„ä¸»èŠ‚ ç‚¹ä»£è¡¨æœ‰ N å¼ é€‰ç¥¨ã€‚ç”±äºåœ¨æ¯ä¸ªé…ç½®çºªå…ƒå†…æŒæœ‰æ§½çš„ä¸»èŠ‚ç‚¹åªèƒ½æŠ•ç¥¨ç»™ä¸€ä¸ª ä»èŠ‚ç‚¹ï¼Œå› æ­¤åªèƒ½æœ‰ä¸€ä¸ªä»èŠ‚ç‚¹è·å¾— N/2+1 çš„é€‰ç¥¨ï¼Œä¿è¯èƒ½å¤Ÿæ‰¾å‡ºå”¯ä¸€çš„ä»èŠ‚ç‚¹ã€‚</li>\n<li>æ›¿æ¢ä¸»èŠ‚ç‚¹ï¼šå½“ä»èŠ‚ç‚¹æ”¶é›†åˆ°è¶³å¤Ÿçš„é€‰ç¥¨ä¹‹åï¼Œè§¦å‘æ›¿æ¢ä¸»èŠ‚ç‚¹æ“ä½œã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>éƒ¨ç½² Redis é›†ç¾¤è‡³å°‘éœ€è¦å‡ ä¸ªç‰©ç†èŠ‚ç‚¹ï¼Ÿ åœ¨æŠ•ç¥¨é€‰ä¸¾çš„ç¯èŠ‚ï¼Œæ•…éšœä¸»èŠ‚ç‚¹ä¹Ÿç®—åœ¨æŠ•ç¥¨æ•°å†…ï¼Œå‡è®¾é›†ç¾¤å†…èŠ‚ç‚¹è§„æ¨¡æ˜¯ 3 ä¸» 3 ä»ï¼Œå…¶ä¸­æœ‰ 2 ä¸ªä¸»èŠ‚ç‚¹éƒ¨ç½²åœ¨ä¸€å°æœºå™¨ä¸Šï¼Œå½“è¿™å°æœºå™¨å®•æœºæ—¶ï¼Œç”±äºä»èŠ‚ç‚¹æ— æ³•æ”¶é›†åˆ° 3/2+1 ä¸ªä¸»èŠ‚ç‚¹é€‰ç¥¨å°†å¯¼è‡´æ•…éšœè½¬ç§»å¤±è´¥ã€‚è¿™ä¸ªé—®é¢˜ä¹Ÿé€‚ç”¨äºæ•…éšœå‘ç°ç¯èŠ‚ã€‚å› æ­¤éƒ¨ç½²é›†ç¾¤æ—¶æ‰€æœ‰ä¸»èŠ‚ç‚¹æœ€å°‘éœ€è¦éƒ¨ç½²åœ¨ 3 å°ç‰©ç†æœºä¸Šæ‰èƒ½é¿å…å•ç‚¹é—®é¢˜ã€‚</li>\n</ul>\n<h1>30. è¯´è¯´é›†ç¾¤çš„ä¼¸ç¼©ï¼Ÿ</h1>\n<ul>\n<li>Redis é›†ç¾¤æä¾›äº†çµæ´»çš„èŠ‚ç‚¹æ‰©å®¹å’Œæ”¶ç¼©æ–¹æ¡ˆï¼Œå¯ä»¥åœ¨ä¸å½±å“é›†ç¾¤å¯¹å¤–æœåŠ¡çš„æƒ…å†µä¸‹ï¼Œä¸ºé›†ç¾¤æ·»åŠ èŠ‚ç‚¹è¿›è¡Œæ‰©å®¹ä¹Ÿå¯ä»¥ä¸‹çº¿éƒ¨åˆ†èŠ‚ç‚¹è¿›è¡Œç¼©å®¹ã€‚é›†ç¾¤æ‰©å®¹å’Œç¼©å®¹çš„å…³é”®ç‚¹ï¼Œå°±åœ¨äºæ§½å’ŒèŠ‚ç‚¹çš„å¯¹åº”å…³ç³»ï¼Œæ‰©å®¹å’Œç¼©å®¹å°±æ˜¯å°†ä¸€éƒ¨åˆ†æ§½å’Œæ•°æ®è¿ç§»ç»™æ–°èŠ‚ç‚¹ã€‚æ‰©å®¹å®ä¾‹ç¼©å®¹ä¹Ÿæ˜¯ç±»ä¼¼ï¼Œå…ˆæŠŠæ§½å’Œæ•°æ®è¿ç§»åˆ°å…¶å®ƒèŠ‚ç‚¹ï¼Œå†æŠŠå¯¹åº”çš„èŠ‚ç‚¹ä¸‹çº¿ã€‚</li>\n</ul>\n<h1>31. redisç¼“å­˜ç©¿é€ï¼Œç¼“å­˜å‡»ç©¿ï¼Œç¼“å­˜é›ªå´©åŠå…¶è§£å†³æ–¹æ¡ˆâˆš</h1>\n<ul>\n<li>\n<p>ç¼“å­˜ç©¿é€:æŒ‡æŸ¥è¯¢ä¸å­˜åœ¨çš„æ•°æ®ï¼Œç”±äºç¼“å­˜æ²¡æœ‰å‘½ä¸­ï¼ˆå› ä¸ºæ•°æ®æ ¹æœ¬å°±ä¸å­˜åœ¨ï¼‰ï¼Œè¯·æ±‚æ¯æ¬¡éƒ½ä¼šç©¿è¿‡ç¼“å­˜å»æŸ¥è¯¢æ•°æ®åº“ã€‚å¦‚æœè¿™ç§æŸ¥è¯¢éå¸¸é¢‘ç¹ï¼Œå°±ä¼šç»™æ•°æ®åº“é€ æˆå¾ˆå¤§çš„å‹åŠ›ï¼Œå¯èƒ½ç”±è‡ªèº«ä¸šåŠ¡ä»£ç æˆ–è€…çˆ¬è™«æ¶æ„æ”»å‡»é€ æˆ</p>\n</li>\n<li>\n<p>ç¼“å­˜å‡»ç©¿:æŒ‡æŸä¸€ä¸ªæˆ–å°‘æ•°å‡ ä¸ªæ•°æ®è¢«é«˜é¢‘è®¿é—®ï¼Œå½“è¿™äº›æ•°æ®åœ¨ç¼“å­˜ä¸­è¿‡æœŸçš„é‚£ä¸€åˆ»ï¼Œå¤§é‡è¯·æ±‚å°±ä¼šç›´æ¥åˆ°è¾¾æ•°æ®åº“ï¼Œå¯¼è‡´æ•°æ®åº“ç¬é—´å‹åŠ›è¿‡å¤§ã€‚</p>\n</li>\n<li>\n<p>ç¼“å­˜é›ªå´©:æŸä¸€ä¸ªæ—¶é—´ç‚¹ï¼Œç”±äºå¤§é‡çš„ç¼“å­˜æ•°æ®åŒæ—¶è¿‡æœŸæˆ–ç¼“å­˜æœåŠ¡å™¨çªç„¶å®•æœºäº†ï¼Œå¯¼è‡´æ‰€æœ‰çš„è¯·æ±‚éƒ½è½åˆ°äº†æ•°æ®åº“ä¸Šï¼Œå¯¹æ•°æ®åº“é€ æˆå·¨å¤§å‹åŠ›ï¼Œç”šè‡³å¯¼è‡´æ•°æ®åº“å´©æºƒçš„ç°è±¡ã€‚</p>\n</li>\n<li>\n<p>ç¼“å­˜ç©¿é€:</p>\n<ul>\n<li>ç¼“å­˜ç©ºå¯¹è±¡ï¼šä¸ç®¡æ˜¯æ•°æ®ä¸å­˜åœ¨ï¼Œè¿˜æ˜¯ç³»ç»Ÿæ•…éšœéƒ½ç¼“å­˜è¿‡æœŸæ—¶é—´å¾ˆçŸ­çš„ç©ºç»“æœï¼Œæœ€é•¿ä¸è¶…è¿‡äº”åˆ†é’Ÿï¼ˆé˜²æ­¢æµªè´¹å†…å­˜ï¼‰(å¸¦æ¥çš„é—®é¢˜ï¼šéœ€è¦æ›´å¤šçš„å†…å­˜ç©ºé—´ï¼Œæ¨èè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œè®©å…¶è‡ªåŠ¨å‰”é™¤ï¼›ç¼“å­˜å±‚å’Œå­˜å‚¨å±‚çš„æ•°æ®ä¼šæœ‰ä¸€æ®µæ—¶é—´çª—å£çš„ä¸ä¸€è‡´ï¼Œå¯èƒ½å½±å“ä¸šåŠ¡ã€‚å¯ä»¥åˆ©ç”¨æ¶ˆæ¯ç³»ç»Ÿæˆ–è€…å…¶ä»–å¼‚æ­¥æ–¹å¼æ¸…é™¤æ‰ç¼“å­˜å±‚ä¸­çš„ç©ºå¯¹è±¡)ï¼Œé€‚ç”¨äºæ•°æ®å‘½ä¸­ä¸é«˜ï¼Œæ•°æ®é¢‘ç¹å®æ—¶æ€§é«˜ï¼Œä»£ç ç»´æŠ¤ç®€å•ï¼Œéœ€è¦æ›´å¤šç¼“å­˜ç©ºé—´ï¼Œæ•°æ®ä¸ä¸€è‡´</li>\n<li>å¸ƒéš†è¿‡æ»¤å™¨æ‹¦æˆªï¼šå½“æ”¶åˆ°ä¸€ä¸ªå¯¹keyè¯·æ±‚æ—¶å…ˆç”¨å¸ƒéš†è¿‡æ»¤å™¨éªŒè¯æ˜¯keyå¦å­˜åœ¨ï¼Œå¦‚æœå­˜åœ¨åœ¨è¿›å…¥ç¼“å­˜å±‚ã€å­˜å‚¨å±‚ã€‚å¯ä»¥ä½¿ç”¨bitmapå½“ä½œå¸ƒéš†è¿‡æ»¤å™¨ï¼Œé€‚ç”¨äºæ•°æ®å‘½ä¸­ä¸é«˜ã€æ•°æ®ç›¸å¯¹å›ºå®šã€å®æ—¶æ€§ä½çš„åœºæ™¯ï¼Œä»£ç å¤æ‚ï¼Œä½†ç¼“å­˜ç©ºé—´å ç”¨å°‘</li>\n</ul>\n</li>\n<li>\n<p>ç¼“å­˜å‡»ç©¿:ï¼ˆçƒ­ç‚¹æ•°æ®ï¼Œé‡å»ºç¼“å­˜ï¼‰</p>\n<ul>\n<li>åŠ é”æ›´æ–°ï¼Œâ½å¦‚è¯·æ±‚æŸ¥è¯¢ Aï¼Œå‘ç°ç¼“å­˜ä¸­æ²¡æœ‰ï¼Œå¯¹ A è¿™ä¸ª key åŠ é”ï¼ŒåŒæ—¶å»æ•°æ®åº“æŸ¥è¯¢æ•°æ®ï¼Œå†™â¼Šç¼“å­˜ï¼Œå†è¿”å›ç»™â½¤æˆ·ï¼Œè¿™æ ·åâ¾¯çš„è¯·æ±‚å°±å¯ä»¥ä»ç¼“å­˜ä¸­æ‹¿åˆ°æ•°æ®äº†ã€‚å¦‚æœåœ¨æŸ¥è¯¢æ•°æ®åº“å’Œé‡å»ºç¼“å­˜ï¼ˆkeyå¤±æ•ˆåè¿›è¡Œäº†å¤§é‡çš„è®¡ç®—ï¼‰æ—¶é—´è¿‡é•¿ï¼Œå¯èƒ½å¯¼è‡´æ­»é”å’Œçº¿ç¨‹æ± é˜»å¡ï¼Œé«˜å¹¶å‘æƒ…æ™¯ä¸‹ååé‡ä¼šå¤§å¤§é™ä½ï¼ä½†æ˜¯è¿™ç§æ–¹æ³•èƒ½é™ä½åç«¯å­˜å‚¨è´Ÿè½½ï¼Œæ•°æ®ä¸€è‡´æ€§å¥½</li>\n<li>æ‰‹åŠ¨è¿‡æœŸï¼šç¼“å­˜ä¸Šä¸è®¾ç½®è¿‡æœŸæ—¶é—´å¹¶å°†è¿‡æœŸæ—¶é—´å­˜åœ¨KEYå¯¹åº”çš„VALUEé‡Œã€‚è·å–ç¼“å­˜å¹¶é€šè¿‡VALUEçš„è¿‡æœŸæ—¶é—´åˆ¤æ–­æ˜¯å¦è¿‡æœŸã€‚å¦‚æœæœªè¿‡æœŸï¼Œåˆ™ç›´æ¥è¿”å›ï¼›å¦‚æœå·²è¿‡æœŸï¼Œåˆ™é€šè¿‡ä¸€ä¸ªåå°çš„å¼‚æ­¥çº¿ç¨‹è¿›è¡Œç¼“å­˜çš„æ„å»ºï¼Œå³â€œæ‰‹åŠ¨â€è¿‡æœŸã€‚é€šè¿‡åå°çš„å¼‚æ­¥çº¿ç¨‹ï¼Œä¿è¯æœ‰ä¸”åªæœ‰ä¸€ä¸ªçº¿ç¨‹å»æŸ¥è¯¢DBã€‚ç„¶åè¿”å›ã€‚ä¿è¯æœåŠ¡çš„å¯ç”¨æ€§ï¼Œè™½ç„¶æŸå¤±äº†ä¸€å®šçš„æ—¶æ•ˆæ€§ã€‚</li>\n</ul>\n</li>\n<li>\n<p>ç¼“å­˜é›ªå´©</p>\n<ul>\n<li>æé«˜ç¼“å­˜å¯ç”¨æ€§ï¼Œ\n<ul>\n<li>é›†ç¾¤éƒ¨ç½²ï¼šé™ä½å•ç‚¹æ•…éšœçš„é£é™©ã€‚å³ä½¿æŸä¸ªç¼“å­˜èŠ‚ç‚¹å‘ç”Ÿæ•…éšœï¼Œå…¶ä»–èŠ‚ç‚¹ä»ç„¶å¯ä»¥æä¾›æœåŠ¡ï¼Œä»è€Œé¿å…å¯¹æ•°æ®åº“çš„å¤§é‡ç›´æ¥è®¿é—®ã€‚åˆ©ç”¨ Redis Clusteræˆ–è€…ç¬¬ä¸‰æ–¹é›†ç¾¤æ–¹æ¡ˆ Codisã€‚</li>\n<li>é‡‡ç”¨å¤šçº§ç¼“å­˜ï¼Œæœ¬åœ°è¿›ç¨‹ä¸€çº§ç¼“å­˜ï¼ŒredisäºŒçº§ç¼“å­˜ï¼Œä¸åŒçº§åˆ«çš„ç¼“å­˜è®¾ç½®çš„è¶…æ—¶æ—¶é—´ä¸åŒ\n<ul>\n<li>æœ¬åœ°ç¼“å­˜çš„å®æ—¶æ€§æ€ä¹ˆä¿è¯ï¼Ÿ\n<ul>\n<li>æ–¹æ¡ˆä¸€ï¼Œå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ã€‚åœ¨æ•°æ®æ›´æ–°æ—¶ï¼Œå‘å¸ƒæ•°æ®æ›´æ–°çš„æ¶ˆæ¯ï¼›è€Œè¿›ç¨‹ä¸­ç›¸åº”çš„æ¶ˆè´¹è€…æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ›´æ–°æœ¬åœ°ç¼“å­˜</li>\n<li>æ–¹æ¡ˆäºŒï¼Œè®¾ç½®è¾ƒçŸ­çš„è¿‡æœŸæ—¶é—´ï¼Œè¯·æ±‚æ—¶ä»DBé‡æ–°æ‹‰å–</li>\n<li>æ–¹æ¡ˆä¸‰ï¼Œä½¿ç”¨ ã€Œå¦‚æœé¿å…ç¼“å­˜\"å‡»ç©¿\"çš„é—®é¢˜ï¼Ÿã€ é—®é¢˜çš„ã€æ–¹æ¡ˆäºŒã€‘ï¼Œæ‰‹åŠ¨è¿‡æœŸã€‚</li>\n</ul>\n</li>\n<li>æ¯ä¸ªè¿›ç¨‹å¯èƒ½ä¼šæœ¬åœ°ç¼“å­˜ç›¸åŒçš„æ•°æ®ï¼Œå¯¼è‡´å†…å­˜æµªè´¹ï¼Ÿ\n<ul>\n<li>æ–¹æ¡ˆä¸€ï¼Œé…ç½®æœ¬åœ°ç¼“å­˜çš„è¿‡æœŸç­–ç•¥å’Œç¼“å­˜æ•°é‡ä¸Šé™ã€‚</li>\n<li>æ–¹æ¡ˆäºŒï¼šä½¿ç”¨Ehcacheã€Guava Cache å®ç°æœ¬åœ°ç¼“å­˜çš„åŠŸèƒ½ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ç¼“å­˜çš„è¿‡æœŸæ—¶é—´åŠ ä¸Šéšæœºå€¼ï¼Œå°½é‡è®©ä¸åŒçš„keyè¿‡æœŸæ—¶é—´ä¸åŒ</li>\n<li>é™æµå’Œé™çº§ï¼šé€šè¿‡è®¾ç½®åˆç†çš„ç³»ç»Ÿé™æµç­–ç•¥ï¼Œå¦‚ä»¤ç‰Œæ¡¶æˆ–æ¼æ–—ç®—æ³•ï¼Œæ¥æ§åˆ¶è®¿é—®æµé‡ï¼Œé˜²æ­¢åœ¨ç¼“å­˜å¤±æ•ˆæ—¶æ•°æ®åº“è¢«æ‰“å®ã€‚æ­¤å¤–ï¼Œç³»ç»Ÿå¯ä»¥å®ç°é™çº§ç­–ç•¥ï¼Œåœ¨ç¼“å­˜é›ªå´©æˆ–ç³»ç»Ÿå‹åŠ›è¿‡å¤§æ—¶ï¼Œæš‚æ—¶å…³é—­ä¸€äº›éæ ¸å¿ƒæœåŠ¡ï¼Œç¡®ä¿æ ¸å¿ƒæœåŠ¡çš„æ­£å¸¸è¿è¡Œ</li>\n</ul>\n</li>\n</ul>\n<h1>32. èƒ½è¯´è¯´å¸ƒéš†è¿‡æ»¤å™¨å—ï¼Ÿ</h1>\n<ul>\n<li>å¸ƒéš†è¿‡æ»¤å™¨ç”±ä¸€ä¸ªé•¿åº¦ä¸º m çš„ä½æ•°ç»„å’Œ k ä¸ªå“ˆå¸Œå‡½æ•°ç»„æˆã€‚å½“ä¸€ä¸ªå…ƒç´ è¢«æ·»åŠ åˆ°è¿‡æ»¤å™¨ä¸­æ—¶ï¼Œå®ƒä¼šè¢« k ä¸ªå“ˆå¸Œå‡½æ•°åˆ†åˆ«è®¡ç®—å¾—åˆ° k ä¸ªä½ç½®ï¼Œç„¶åå°†ä½æ•°ç»„ä¸­å¯¹åº”çš„ä½è®¾ç½®ä¸º 1ã€‚å½“æ£€æŸ¥ä¸€ä¸ªå…ƒç´ æ˜¯å¦å­˜åœ¨äºè¿‡æ»¤å™¨ä¸­æ—¶ï¼ŒåŒæ ·ä½¿ç”¨ k ä¸ªå“ˆå¸Œå‡½æ•°è®¡ç®—ä½ç½®ï¼Œå¦‚æœä»»ä¸€ä½ç½®çš„ä½ä¸º 0ï¼Œåˆ™è¯¥å…ƒç´ è‚¯å®šä¸åœ¨è¿‡æ»¤å™¨ä¸­ï¼›å¦‚æœæ‰€æœ‰ä½ç½®çš„ä½éƒ½ä¸º 1ï¼Œåˆ™è¯¥å…ƒç´ å¯èƒ½åœ¨è¿‡æ»¤å™¨ä¸­ã€‚</li>\n<li>å› ä¸ºå¸ƒéš†è¿‡æ»¤å™¨å ç”¨çš„å†…å­˜ç©ºé—´éå¸¸å°ï¼Œæ‰€ä»¥æŸ¥è¯¢æ•ˆç‡ä¹Ÿéå¸¸é«˜ï¼Œæ‰€ä»¥åœ¨ Redis ç¼“å­˜ä¸­ï¼Œä½¿ç”¨å¸ƒéš†è¿‡æ»¤å™¨å¯ä»¥å¿«é€Ÿåˆ¤æ–­è¯·æ±‚çš„æ•°æ®æ˜¯å¦åœ¨ç¼“å­˜ä¸­ã€‚å› ä¸ºå“ˆå¸Œç®—æ³•æœ‰ä¸€å®šçš„ç¢°æ’çš„æ¦‚ç‡ã€‚æ•…å­˜åœ¨è¯¯åˆ¤ã€‚è€Œä¸”ä¸æ”¯æŒåˆ é™¤å…ƒç´ </li>\n</ul>\n<h1>33. å¦‚ä½•ä¿è¯ç¼“å­˜å’Œæ•°æ®åº“æ•°æ®çš„ä¸€è‡´æ€§ï¼Ÿ</h1>\n<ul>\n<li>æ›´æ–°ç¼“å­˜è¿˜æ˜¯åˆ é™¤ç¼“å­˜ï¼Ÿåˆ é™¤ç¼“å­˜é€Ÿåº¦å¿«ï¼Œå› ä¸ºæ›´æ–°ç¼“å­˜çš„å€¼å¯èƒ½æ¥è‡ªä¸åŒçš„è¡¨ï¼Œéœ€è¦ç»è¿‡å¤æ‚è®¡ç®—å‡ºæ¥ï¼Œä»£ä»·å¤§</li>\n<li>äº§ç”ŸåŸå› \n<ul>\n<li>å¹¶å‘çš„åœºæ™¯ä¸‹ï¼Œå¯¼è‡´è¯»å–è€çš„DBæ•°æ®ï¼Œæ›´æ–°åˆ°ç¼“å­˜ä¸­ã€‚</li>\n<li>ç¼“å­˜å’ŒDBçš„æ“ä½œï¼Œä¸åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå¯èƒ½åªæœ‰ä¸€ä¸ªDBæ“ä½œæˆåŠŸï¼Œè€Œå¦ä¸€ä¸ªCacheæ“ä½œå¤±è´¥ï¼Œå¯¼è‡´æ•°æ®ä¸ä¸€è‡´ã€‚</li>\n</ul>\n</li>\n<li>ç¼“å­˜å’ŒDBçš„ä¸€è‡´æ€§ï¼ŒæŒ‡çš„æ˜¯æœ€ç»ˆä¸€è‡´æ€§ã€‚ä½¿ç”¨ç¼“å­˜åªè¦æ˜¯æé«˜è¯»æ“ä½œçš„æ€§èƒ½ï¼ŒçœŸæ­£åœ¨å†™æ“ä½œçš„ä¸šåŠ¡é€»è¾‘ï¼Œè¿˜æ˜¯ä»¥æ•°æ®åº“ä¸ºå‡†</li>\n<li>éƒ½æ˜¯2æ­¥ä¸­é—´è¢«å…¶ä»–çº¿ç¨‹è¿ç»­å®Œæˆ2æ­¥</li>\n<li>å…ˆåˆ é™¤ç¼“å­˜ï¼Œåæ›´æ–°æ•°æ®åº“\n<ul>\n<li>è¯·æ±‚Aå…ˆåˆ é™¤ç¼“å­˜1ï¼Œè¯·æ±‚Bè¯»ç¼“å­˜å‘ç°æ²¡æœ‰ï¼Œè¯»å–åˆ°æ—§å€¼1ï¼Œè¯·æ±‚Bå­˜å…¥ç¼“å­˜1ï¼Œè¯·æ±‚Aå†™æ•°æ®åº“2ï¼Œæ•°æ®ä¸ä¸€è‡´ã€‚</li>\n<li>è§£å†³æ–¹æ¡ˆï¼šä¸²è¡Œå†™ã€‚åœ¨å†™è¯·æ±‚æ—¶ï¼Œå…ˆæ·˜æ±°ç¼“å­˜ä¹‹å‰ï¼Œå…ˆè·å–è¯¥åˆ†å¸ƒå¼é”ã€‚åœ¨è¯»è¯·æ±‚æ—¶ï¼Œå‘ç°ç¼“å­˜ä¸å­˜åœ¨æ—¶ï¼Œå…ˆè·å–åˆ†å¸ƒå¼é”</li>\n</ul>\n</li>\n<li>å…ˆæ›´æ–°æ•°æ®åº“ï¼Œååˆ é™¤ç¼“å­˜\n<ul>\n<li>è¯·æ±‚Aè¯»ç¼“å­˜å‘ç°ä¸å­˜åœ¨ï¼Œè¯»æ—§å€¼1ï¼›è¯·æ±‚Båˆ·æ–°æ•°æ®åº“2ï¼›å¹¶åˆ é™¤ç¼“å­˜ï¼Œè¯·æ±‚Aå°†æ—§å€¼x=1å†™å…¥ç¼“å­˜ï¼Œæ•°æ®ä¸ä¸€è‡´</li>\n<li>ç¼“å­˜åˆ é™¤å¤±è´¥ï¼Œå¹¶å‘å¯¼è‡´å†™å…¥äº†è„æ•°æ®</li>\n<li>é—®é¢˜1ï¼šæ¦‚ç‡ä½ï¼Œå¿…é¡»æ»¡è¶³3ä¸ªæ¡ä»¶\n<ul>\n<li>ç¼“å­˜åˆšå¥½å·²å¤±æ•ˆ</li>\n<li>è¯»è¯·æ±‚ + å†™è¯·æ±‚å¹¶å‘</li>\n<li>è¯·æ±‚Bæ›´æ–°æ•°æ®åº“+åˆ é™¤ç¼“å­˜çš„æ—¶é—´ï¼Œè¦æ¯”è¯·æ±‚Aè¯»æ•°æ®åº“+å†™ç¼“å­˜æ—¶é—´çŸ­ï¼ˆæ¦‚ç‡ä½,å› ä¸ºå†™æ•°æ®åº“ä¸€èˆ¬ä¼šåŠ é”ï¼Œé€šå¸¸æ˜¯è¦æ¯”è¯»æ•°æ®åº“çš„æ—¶é—´æ›´é•¿ï¼‰</li>\n</ul>\n</li>\n<li>é—®é¢˜2ï¼š\n<ul>\n<li>å¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯ç¼“å­˜è¢«åˆ é™¤ã€‚å½“æ•°æ®åº“æ›´æ–°å®Œæˆåï¼Œå°†æ›´æ–°äº‹ä»¶å‘é€åˆ°æ¶ˆæ¯é˜Ÿåˆ—ã€‚æœ‰ä¸“é—¨çš„æœåŠ¡ç›‘å¬è¿™äº›äº‹ä»¶å¹¶è´Ÿè´£æ›´æ–°æˆ–åˆ é™¤ç¼“å­˜ã€‚ç¼ºç‚¹æ˜¯å¯¹ä¸šåŠ¡ä»£ç æœ‰ä¸€å®šçš„ä¾µå…¥</li>\n<li>æ•°æ®åº“è®¢é˜…+æ¶ˆæ¯é˜Ÿåˆ—ä¿è¯ç¼“å­˜è¢«åˆ é™¤ã€‚ä¸“é—¨èµ·ä¸€ä¸ªæœåŠ¡ï¼ˆæ¯”å¦‚ Canalï¼Œé˜¿é‡Œå·´å·´ MySQL binlog å¢é‡è®¢é˜…&amp;æ¶ˆè´¹ç»„ä»¶ï¼‰å»ç›‘å¬ MySQL çš„ binlogï¼Œè·å–éœ€è¦æ“ä½œçš„æ•°æ®ã€‚ç„¶åç”¨ä¸€ä¸ªå…¬å…±çš„æœåŠ¡è·å–è®¢é˜…ç¨‹åºä¼ æ¥çš„ä¿¡æ¯ï¼Œè¿›è¡Œç¼“å­˜åˆ é™¤ã€‚é™ä½äº†å¯¹ä¸šåŠ¡çš„ä¾µå…¥ï¼Œä½†å¢åŠ äº†æ•´ä¸ªç³»ç»Ÿçš„å¤æ‚åº¦ï¼Œé€‚åˆåŸºå»ºå®Œå–„çš„å¤§å‚ã€‚</li>\n<li>å»¶æ—¶åŒåˆ é˜²æ­¢è„æ•°æ®ã€‚åœ¨ç¬¬ä¸€æ¬¡åˆ é™¤ç¼“å­˜ä¹‹åï¼Œè¿‡ä¸€æ®µæ—¶é—´ä¹‹åï¼Œå†æ¬¡åˆ é™¤ç¼“å­˜ã€‚ä¸»è¦é’ˆå¯¹ç¼“å­˜ä¸å­˜åœ¨ï¼Œä½†å†™å…¥äº†è„æ•°æ®çš„æƒ…å†µã€‚åœ¨å…ˆåˆ ç¼“å­˜ï¼Œå†å†™æ•°æ®åº“çš„æ›´æ–°ç­–ç•¥ä¸‹å‘ç”Ÿçš„æ¯”è¾ƒå¤šã€‚å»¶æ—¶æ—¶é—´éœ€è¦ä»”ç»†è€ƒé‡å’Œæµ‹è¯•ã€‚</li>\n<li>è®¾ç½®ç¼“å­˜è¿‡æœŸæ—¶é—´å…œåº•ï¼šå…œåº•ç­–ç•¥ï¼Œç»™ç¼“å­˜è®¾ç½®ä¸€ä¸ªåˆç†çš„è¿‡æœŸæ—¶é—´ï¼Œå³ä½¿å‘ç”Ÿäº†ç¼“å­˜å’Œæ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´é—®é¢˜ï¼Œä¹Ÿä¸ä¼šæ°¸è¿œä¸ä¸€è‡´ä¸‹å»ï¼Œç¼“å­˜è¿‡æœŸåï¼Œè‡ªç„¶å°±ä¸€è‡´äº†ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>34. å¦‚ä½•ä¿è¯æœ¬åœ°ç¼“å­˜å’Œåˆ†å¸ƒå¼ç¼“å­˜çš„ä¸€è‡´</h1>\n<ul>\n<li>æœ¬åœ°ç¼“å­˜å¯¹åº”æœåŠ¡å™¨çš„å†…å­˜ç¼“å­˜æ¯”å¦‚Caffeineï¼Œåˆ†å¸ƒå¼ç¼“å­˜åŸºæœ¬å°±æ˜¯é‡‡ç”¨ Redis</li>\n<li>è®¾ç½®æœ¬åœ°ç¼“å­˜çš„è¿‡æœŸæ—¶é—´ï¼Œå½“æœ¬åœ°ç¼“å­˜è¿‡æœŸæ—¶ï¼Œå°±ä» Redis ç¼“å­˜ä¸­å»åŒæ­¥ã€‚</li>\n<li>ä½¿ç”¨Redisçš„ Pub/Sub æœºåˆ¶ï¼Œå½“ Redis ç¼“å­˜å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå‘å¸ƒä¸€ä¸ªæ¶ˆæ¯ï¼Œæœ¬åœ°ç¼“å­˜è®¢é˜…è¿™ä¸ªæ¶ˆæ¯ï¼Œç„¶ååˆ é™¤å¯¹åº”çš„æœ¬åœ°ç¼“å­˜</li>\n<li>Redis ç¼“å­˜å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¼•å…¥æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæ¯”å¦‚ RocketMQã€RabbitMQ å»æ›´æ–°æœ¬åœ°ç¼“å­˜ã€‚</li>\n</ul>\n<h1>35. æ€ä¹ˆå¤„ç†çƒ­ keyï¼Ÿ</h1>\n<ul>\n<li>çƒ­ keyæŒ‡åœ¨å¾ˆçŸ­æ—¶é—´å†…è¢«é¢‘ç¹è®¿é—®çš„é”®ã€‚ Redis æ˜¯é›†ç¾¤éƒ¨ç½²ï¼Œçƒ­ key å¯èƒ½ä¼šé€ æˆæ•´ä½“æµé‡çš„ä¸å‡è¡¡ï¼ˆç½‘ç»œå¸¦å®½ã€CPU å’Œå†…å­˜èµ„æºï¼‰ï¼Œä¸ªåˆ«èŠ‚ç‚¹å‡ºç° OPS è¿‡å¤§çš„æƒ…å†µï¼Œæç«¯æƒ…å†µä¸‹çƒ­ç‚¹ key ç”šè‡³ä¼šè¶…è¿‡ Redis æœ¬èº«èƒ½å¤Ÿæ‰¿å—çš„ OPSã€‚è¡¨ç¤º Redis æ¯ç§’é’Ÿèƒ½å¤Ÿå¤„ç†çš„å‘½ä»¤æ•°ã€‚</li>\n<li>é€šå¸¸ä»¥ Key è¢«è¯·æ±‚çš„é¢‘ç‡æ¥åˆ¤å®š\n<ul>\n<li>QPS é›†ä¸­åœ¨ç‰¹å®šçš„ Keyï¼šæ€»çš„ QPSï¼ˆæ¯ç§’æŸ¥è¯¢ç‡ï¼‰ä¸º 10000ï¼Œå…¶ä¸­ä¸€ä¸ª Key çš„ QPS é£™åˆ°äº† 8000ã€‚</li>\n<li>å¸¦å®½ä½¿ç”¨ç‡é›†ä¸­åœ¨ç‰¹å®šçš„ Keyï¼šä¸€ä¸ªæ‹¥æœ‰ä¸Šåƒæˆå‘˜ä¸”æ€»å¤§å°ä¸º 1M çš„å“ˆå¸Œ Keyï¼Œæ¯ç§’å‘é€å¤§é‡çš„ HGETALL è¯·æ±‚</li>\n<li>CPU ä½¿ç”¨ç‡é›†ä¸­åœ¨ç‰¹å®šçš„ Keyï¼šä¸€ä¸ªæ‹¥æœ‰æ•°ä¸‡ä¸ªæˆå‘˜çš„ ZSET Keyï¼Œæ¯ç§’å‘é€å¤§é‡çš„ ZRANGE è¯·æ±‚ã€‚</li>\n</ul>\n</li>\n<li>å¯¹çƒ­ key çš„å¤„ç†\n<ul>\n<li>ç›‘æ§çƒ­key\n<ul>\n<li>å®¢æˆ·ç«¯ï¼šåœ¨å®¢æˆ·ç«¯è®¾ç½®å…¨å±€å­—å…¸ï¼ˆkey å’Œè°ƒç”¨æ¬¡æ•°ï¼‰ï¼Œæ¯æ¬¡è°ƒç”¨ Redis å‘½ä»¤æ—¶ï¼Œä½¿ç”¨è¿™ä¸ªå­—å…¸è¿›è¡Œè®°å½•ã€‚</li>\n<li>ä»£ç†ç«¯ï¼šåƒ Twemproxyã€Codis è¿™äº›åŸºäºä»£ç†çš„ Redis åˆ†å¸ƒå¼æ¶æ„ï¼Œæ‰€æœ‰å®¢æˆ·ç«¯çš„è¯·æ±‚éƒ½æ˜¯é€šè¿‡ä»£ç†ç«¯å®Œæˆçš„ï¼Œå¯ä»¥åœ¨ä»£ç†ç«¯è¿›è¡Œç›‘æ§ã€‚</li>\n<li>Redis æœåŠ¡ç«¯ï¼šä½¿ç”¨ monitor å‘½ä»¤ç»Ÿè®¡çƒ­ç‚¹ keyï¼šredis-cli monitorï¼›åˆ†æçƒ­ Keyã€‚redis-cli --bigkeys</li>\n</ul>\n</li>\n<li>å¤„ç†çƒ­key\n<ul>\n<li>çƒ­ key æ‰“æ•£åˆ°ä¸åŒçš„æœåŠ¡å™¨ï¼Œé™ä½å‹â¼’ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>// N ä¸º Redis å®ä¾‹ä¸ªæ•°ï¼ŒM ä¸º N çš„ 2å€\nconst M = N * 2\n//ç”Ÿæˆéšæœºæ•°\nrandom = GenRandom(0, M)\n//æ„é€ å¤‡ä»½æ–° Key\nbakHotKey = hotKey + \"_\" + random\ndata = redis.GET(bakHotKey)\nif data == NULL {\n    data = redis.GET(hotKey)\n    if data == NULL {\n        data = GetFromDB()\n        // å¯ä»¥åˆ©ç”¨åŸå­é”æ¥å†™å…¥æ•°æ®ä¿è¯æ•°æ®ä¸€è‡´æ€§\n        redis.SET(hotKey, data, expireTime)\n        redis.SET(bakHotKey, data, expireTime + GenRandom(0, 5))\n    } else {\n        redis.SET(bakHotKey, data, expireTime + GenRandom(0, 5))\n    }\n}\n\n</code></pre></div><ul>\n<li>åŠ â¼Šâ¼†çº§ç¼“å­˜ï¼Œå½“å‡ºç°çƒ­ Key åï¼ŒæŠŠçƒ­ Key åŠ è½½åˆ° JVM ä¸­ï¼Œåç»­é’ˆå¯¹è¿™äº›çƒ­ Key çš„è¯·æ±‚ï¼Œç›´æ¥ä» JVM ä¸­è¯»å–ã€‚æ¯”å¦‚ Caffeineã€Guava ç­‰ï¼Œæˆ–è€…ç›´æ¥ä½¿ç”¨ HashMap ä½œä¸ºæœ¬åœ°ç¼“å­˜éƒ½æ˜¯å¯ä»¥çš„ã€‚éœ€è¦é˜²æ­¢æœ¬åœ°ç¼“å­˜è¿‡å¤§ã€‚</li>\n</ul>\n<h1>36. ç¼“å­˜é¢„çƒ­æ€ä¹ˆåšå‘¢ï¼Ÿ</h1>\n<ul>\n<li>ç¼“å­˜é¢„çƒ­æ˜¯æå‰å°†ç›¸å…³çš„ç¼“å­˜æ•°æ®åŠ è½½åˆ°ç¼“å­˜ç³»ç»Ÿï¼Œé¿å…åœ¨ç”¨æˆ·è¯·æ±‚çš„æ—¶å€™ï¼Œå…ˆæŸ¥è¯¢æ•°æ®åº“ï¼Œç„¶åå†å°†æ•°æ®ç¼“å­˜é€ æˆæ•°æ®åº“å‹åŠ›è¿‡å¤§çš„é—®é¢˜ï¼Œç”¨æˆ·ç›´æ¥æŸ¥è¯¢äº‹å…ˆè¢«é¢„çƒ­çš„ç¼“å­˜æ•°æ®ã€‚</li>\n<li>ç¼“å­˜é¢„çƒ­æ–¹æ¡ˆ\n<ul>\n<li>æ•°æ®é‡ä¸å¤§çš„æ—¶å€™ï¼Œé¡¹ç›®å¯åŠ¨æ—¶åˆå§‹åŒ–ã€‚</li>\n<li>æ•°æ®é‡å¤§çš„æ—¶å€™ï¼Œå®šæ—¶ä»»åŠ¡åˆ·æ–°ç¼“å­˜</li>\n<li>ç›´æ¥å†™ä¸ªç•Œé¢ã€æ¥å£ã€è„šæœ¬ï¼Œä¸Šçº¿æ—¶æ‰‹åŠ¨æ“ä½œ</li>\n</ul>\n</li>\n<li>ç¼“å­˜æ•°æ®çš„æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ\n<ul>\n<li>ç¼“å­˜æœåŠ¡å™¨è‡ªå¸¦çš„ç¼“å­˜è‡ªåŠ¨å¤±æ•ˆç­–ç•¥</li>\n<li>å®šæ—¶å»æ¸…ç†è¿‡æœŸçš„ç¼“å­˜ã€‚ç»´æŠ¤å¤§é‡ç¼“å­˜çš„ key æ˜¯æ¯”è¾ƒéº»çƒ¦</li>\n<li>å½“æœ‰ç”¨æˆ·è¯·æ±‚è¿‡æ¥æ—¶ï¼Œå†åˆ¤æ–­è¿™ä¸ªè¯·æ±‚æ‰€ç”¨åˆ°çš„ç¼“å­˜æ˜¯å¦è¿‡æœŸï¼Œè¿‡æœŸçš„è¯å°±å»åº•å±‚ç³»ç»Ÿå¾—åˆ°æ–°æ•°æ®å¹¶æ›´æ–°ç¼“å­˜ã€‚æ¯æ¬¡ç”¨æˆ·è¯·æ±‚è¿‡æ¥éƒ½è¦åˆ¤æ–­ç¼“å­˜å¤±æ•ˆï¼Œé€»è¾‘ç›¸å¯¹æ¯”è¾ƒå¤æ‚ï¼</li>\n</ul>\n</li>\n</ul>\n<h1>37. çƒ­ç‚¹ key é‡å»ºï¼Ÿé—®é¢˜ï¼Ÿè§£å†³ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨â€œç¼“å­˜+è¿‡æœŸæ—¶é—´â€çš„ç­–ç•¥ï¼Œæ—¢å¯ä»¥åŠ é€Ÿæ•°æ®è¯»å†™ï¼Œåˆä¿è¯æ•°æ®çš„å®šæœŸæ›´æ–°ï¼ŒåŸºæœ¬èƒ½å¤Ÿæ»¡è¶³ç»å¤§éƒ¨åˆ†éœ€æ±‚ã€‚</li>\n<li>ä½†æ˜¯å½“ key æ˜¯ä¸€ä¸ªçƒ­ç‚¹ keyï¼Œå¹¶å‘é‡å¤§ã€‚ä¸”é‡å»ºç¼“å­˜æ—¶é—´é•¿ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªå¤æ‚è®¡ç®—ï¼Œä¾‹å¦‚å¤æ‚çš„ SQLã€å¤šæ¬¡ IOã€å¤šä¸ªä¾èµ–ç­‰ã€‚åœ¨ç¼“å­˜å¤±æ•ˆçš„ç¬é—´ï¼Œæœ‰å¤§é‡çº¿ç¨‹æ¥é‡å»ºç¼“å­˜ï¼Œé€ æˆåç«¯è´Ÿè½½åŠ å¤§ï¼Œç”šè‡³å¯èƒ½ä¼šè®©åº”ç”¨å´©æºƒã€‚</li>\n<li>è§£å†³æ–¹æ¡ˆ\n<ul>\n<li>äº’æ–¥é”ï¼ˆmutex keyï¼‰ï¼šåªå…è®¸ä¸€ä¸ªçº¿ç¨‹é‡å»ºç¼“å­˜ï¼Œå…¶ä»–çº¿ç¨‹ç­‰å¾…é‡å»ºç¼“å­˜çš„çº¿ç¨‹æ‰§è¡Œå®Œï¼Œé‡æ–°ä»ç¼“å­˜è·å–æ•°æ®å³å¯ã€‚</li>\n<li>æ°¸è¿œä¸è¿‡æœŸï¼šä¸ºæ¯ä¸ª value è®¾ç½®ä¸€ä¸ªé€»è¾‘è¿‡æœŸæ—¶é—´ï¼Œå½“å‘ç°è¶…è¿‡é€»è¾‘è¿‡æœŸæ—¶é—´åï¼Œä¼šä½¿ç”¨å•ç‹¬çš„çº¿ç¨‹å»æ„å»ºç¼“å­˜ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>38. æ— åº•æ´é—®é¢˜å—ï¼Ÿå¦‚ä½•è§£å†³ï¼Ÿ</h1>\n<ul>\n<li>æ·»åŠ  Memcache èŠ‚ç‚¹ï¼Œä½†æ˜¯å‘ç°æ€§èƒ½ä¸ä½†æ²¡æœ‰å¥½è½¬åè€Œä¸‹é™äº†ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºç¼“å­˜çš„â€œæ— åº•æ´â€ç°è±¡ã€‚</li>\n<li>ä¸ºä»€ä¹ˆ?é”®å€¼æ•°æ®åº“ç”±äºé€šå¸¸é‡‡ç”¨å“ˆå¸Œå‡½æ•°å°† key æ˜ å°„åˆ°å„ä¸ªèŠ‚ç‚¹ä¸Šï¼Œé€ æˆ key çš„åˆ†å¸ƒä¸ä¸šåŠ¡æ— å…³ï¼Œä½†æ˜¯ç”±äºæ•°æ®é‡å’Œè®¿é—®é‡çš„æŒç»­å¢é•¿ï¼Œé€ æˆéœ€è¦æ·»åŠ å¤§é‡èŠ‚ç‚¹åšæ°´å¹³æ‰©å®¹ï¼Œå¯¼è‡´é”®å€¼åˆ†å¸ƒåˆ°æ›´å¤šçš„ èŠ‚ç‚¹ä¸Šï¼Œæ‰€ä»¥æ— è®ºæ˜¯ Memcache è¿˜æ˜¯ Redis çš„åˆ†å¸ƒå¼ï¼Œæ‰¹é‡æ“ä½œé€šå¸¸éœ€è¦ä»ä¸åŒèŠ‚ç‚¹ä¸Šè·å–ï¼Œç›¸æ¯”äºå•æœºæ‰¹é‡æ“ä½œåªæ¶‰åŠä¸€æ¬¡ç½‘ç»œæ“ä½œï¼Œåˆ†å¸ƒå¼æ‰¹é‡æ“ä½œä¼šæ¶‰åŠå¤šæ¬¡ç½‘ç»œæ—¶é—´ã€‚</li>\n<li>æ— åº•æ´é—®é¢˜å¦‚ä½•ä¼˜åŒ–å‘¢ï¼Ÿ\n<ul>\n<li>å®¢æˆ·ç«¯ä¸€æ¬¡æ‰¹é‡æ“ä½œä¼šæ¶‰åŠå¤šæ¬¡ç½‘ç»œæ“ä½œï¼Œä¹Ÿå°±æ„å‘³ç€æ‰¹é‡æ“ä½œä¼šéšç€èŠ‚ç‚¹çš„å¢å¤šï¼Œè€—æ—¶ä¼šä¸æ–­å¢å¤§ã€‚</li>\n<li>ç½‘ç»œè¿æ¥æ•°å˜å¤šï¼Œå¯¹èŠ‚ç‚¹çš„æ€§èƒ½ä¹Ÿæœ‰ä¸€å®šå½±å“ã€‚</li>\n</ul>\n</li>\n<li>ä¼˜åŒ–æ€è·¯\n<ul>\n<li>å‘½ä»¤æœ¬èº«çš„ä¼˜åŒ–ï¼Œä¾‹å¦‚ä¼˜åŒ–æ“ä½œè¯­å¥ç­‰ã€‚</li>\n<li>å‡å°‘ç½‘ç»œé€šä¿¡æ¬¡æ•°ã€‚</li>\n<li>é™ä½æ¥å…¥æˆæœ¬ï¼Œä¾‹å¦‚å®¢æˆ·ç«¯ä½¿ç”¨é•¿è¿/è¿æ¥æ± ã€NIO ç­‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>39. Redis æŠ¥å†…å­˜ä¸è¶³æ€ä¹ˆå¤„ç†ï¼Ÿ</h1>\n<ul>\n<li>redis.confé…ç½®maxmemory 100mb</li>\n<li>config set maxmemory å‘½ä»¤åŠ¨æ€è®¾ç½®å†…å­˜ä¸Šé™</li>\n<li>ä¿®æ”¹å†…å­˜æ·˜æ±°ç­–ç•¥ï¼ŒåŠæ—¶é‡Šæ”¾å†…å­˜ç©ºé—´</li>\n<li>ä½¿ç”¨ Redis é›†ç¾¤æ¨¡å¼ï¼Œè¿›è¡Œæ¨ªå‘æ‰©å®¹ã€‚</li>\n</ul>\n<h1>40. Redisçš„è¿‡æœŸé”®çš„åˆ é™¤ç­–ç•¥</h1>\n<ul>\n<li>æƒ°æ€§è¿‡æœŸï¼šåªæœ‰å½“è®¿é—®keyå·²è¿‡æœŸæ—¶æ‰æ¸…é™¤ã€‚å¯ä»¥èŠ‚çœCPUèµ„æºï¼Œå†…å­˜å ç”¨å¤§ã€‚</li>\n<li>å®šæœŸæ¸…é™¤ï¼šæ¯éš”ä¸€å®šçš„æ—¶é—´æ‰«æä¸€å®šæ•°é‡çš„æ•°æ®åº“çš„expireså­—å…¸ä¸­ä¸€å®šæ•°é‡çš„keyï¼Œå¹¶æ¸…é™¤å…¶ä¸­å·²è¿‡æœŸçš„keyã€‚é€šè¿‡è°ƒæ•´å®šæ—¶æ‰«æçš„æ—¶é—´é—´éš”å’Œæ¯æ¬¡æ‰«æçš„é™å®šè€—æ—¶ï¼Œä½¿å¾—CPUå’Œå†…å­˜èµ„æºè¾¾åˆ°æœ€ä¼˜çš„å¹³è¡¡æ•ˆæœã€‚(expireså­—å…¸ä¼šä¿å­˜æ‰€æœ‰è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„keyçš„è¿‡æœŸæ—¶é—´æ•°æ®ï¼Œå…¶ä¸­ï¼Œkeyæ˜¯æŒ‡å‘é”®ç©ºé—´ä¸­çš„æŸä¸ªé”®çš„æŒ‡é’ˆï¼Œvalueæ˜¯è¯¥é”®çš„æ¯«ç§’ç²¾åº¦çš„UNIXæ—¶é—´æˆ³è¡¨ç¤ºçš„è¿‡æœŸæ—¶é—´ã€‚é”®ç©ºé—´æ˜¯æŒ‡è¯¥Redisé›†ç¾¤ä¸­ä¿å­˜çš„æ‰€æœ‰é”®ã€‚)</li>\n<li>config get hzæ¯ç§’æ‰§è¡Œå…¶å†…éƒ¨å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚è¿‡æœŸé”®çš„æ¸…ç†ï¼‰çš„é¢‘ç‡å‡ æ¬¡ã€‚CONFIG SET hz 20 è¿›è¡Œè°ƒæ•´ï¼Œæˆ–è€…ç›´æ¥é€šè¿‡é…ç½®æ–‡ä»¶ä¸­çš„ hz è®¾ç½®ã€‚</li>\n</ul>\n<h1>41. Rediså†…å­˜æ·˜æ±°ç­–ç•¥æœ‰å“ªäº›ï¼Ÿ</h1>\n<ul>\n<li>\n<p>Redisçš„å†…å­˜æ·˜æ±°ç­–ç•¥æ˜¯æŒ‡åœ¨Redisçš„ç”¨äºç¼“å­˜çš„å†…å­˜ä¸è¶³æ—¶ï¼Œæ€ä¹ˆå¤„ç†éœ€è¦æ–°å†™å…¥ä¸”éœ€è¦ç”³è¯·é¢å¤–ç©ºé—´çš„æ•°æ®ã€‚</p>\n</li>\n<li>\n<p>no-eviction(é»˜è®¤)ï¼šå½“å†…å­˜ä¸è¶³ä»¥å®¹çº³æ–°å†™å…¥æ•°æ®æ—¶ï¼Œæ–°å†™å…¥æ“ä½œä¼šæŠ¥é”™ã€‚</p>\n</li>\n<li>\n<p>allkeys-lruï¼šä»æ•°æ®é›†ï¼ˆserver. db[i]. dictï¼‰ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨ï¼ˆè®¿é—®æ—¶é—´å°ï¼‰çš„keyã€‚</p>\n</li>\n<li>\n<p>allkeys-randomï¼šä»æ•°æ®é›†ï¼ˆserver. db[i]. dictï¼‰ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚</p>\n</li>\n<li>\n<p>allkeys-lfu ä»æ•°æ®é›†ï¼ˆserver. db[i]. dictï¼‰ï¼Œç§»é™¤æœ€è¿‘è®¿é—®çš„é¢‘ç‡/æ¬¡æ•°æœ€å°‘çš„key</p>\n</li>\n<li>\n<p>volatile-lruï¼šä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ï¼ˆserver. db[i]. expiresï¼‰ä¸­ï¼Œç§»é™¤æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚</p>\n</li>\n<li>\n<p>volatile-randomï¼šä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ï¼ˆserver. db[i]. expiresï¼‰ä¸­ï¼Œéšæœºç§»é™¤æŸä¸ªkeyã€‚</p>\n</li>\n<li>\n<p>volatile-lfu ä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ï¼ˆserver. db[i]. expiresï¼‰ä¸­ï¼Œç§»é™¤æœ€è¿‘è®¿é—®çš„é¢‘ç‡æœ€å°‘çš„key</p>\n</li>\n<li>\n<p>volatile-ttlï¼šä»è®¾ç½®äº†è¿‡æœŸæ—¶é—´çš„é”®ç©ºé—´ï¼ˆserver. db[i]. expiresï¼‰ä¸­ï¼Œç§»é™¤å°†è¦è¿‡æœŸçš„keyã€‚</p>\n</li>\n<li>\n<p>Redisä½¿ç”¨è¿‘ä¼¼çš„LRUç®—æ³•ï¼Œé€šè¿‡éšæœºé‡‡æ ·æ³•æ·˜æ±°æ•°æ®ï¼Œæ¯æ¬¡éšæœºå‡ºmaxmenory-samplesï¼ˆé»˜è®¤5ï¼‰ä¸ªkeyï¼Œä»é‡Œé¢æ·˜æ±°æ‰æœ€è¿‘æœ€å°‘ä½¿ç”¨çš„keyã€‚maxmenory-samplesè¶Šå¤§ï¼Œæ·˜æ±°ç»“æœè¶Šæ¥è¿‘äºä¸¥æ ¼çš„LRUç®—æ³•ï¼Œæ¯ä¸ªkeyé¢å¤–å¢åŠ äº†ä¸€ä¸ª24bitçš„å­—æ®µï¼Œç”¨æ¥å­˜å‚¨è¯¥keyæœ€åä¸€æ¬¡è¢«è®¿é—®çš„æ—¶é—´ã€‚Redisä¸å®ç°ä¸¥æ ¼çš„LRUç®—æ˜¯çš„åŸå› æ˜¯ï¼Œå› ä¸ºæ¶ˆè€—æ›´å¤šçš„å†…å­˜ã€‚</p>\n</li>\n<li>\n<p>Redis3.0æ–°ç®—æ³•ä¼šç»´æŠ¤ä¸€ä¸ªå€™é€‰æ± ï¼ˆå¤§å°ä¸º16ï¼‰ï¼Œæ± ä¸­çš„æ•°æ®æ ¹æ®è®¿é—®æ—¶é—´è¿›è¡Œæ’åºï¼Œç¬¬ä¸€æ¬¡éšæœºé€‰å–çš„keyéƒ½ä¼šæ”¾å…¥æ± ä¸­ï¼Œéšåæ¯æ¬¡éšæœºé€‰å–çš„keyåªæœ‰åœ¨è®¿é—®æ—¶é—´å°äºæ± ä¸­æœ€å°çš„æ—¶é—´æ‰ä¼šæ”¾å…¥æ± ä¸­ï¼Œç›´åˆ°å€™é€‰æ± è¢«æ”¾æ»¡ã€‚å½“æ”¾æ»¡åï¼Œå¦‚æœæœ‰æ–°çš„keyéœ€è¦æ”¾å…¥ï¼Œåˆ™å°†æ± ä¸­æœ€åè®¿é—®æ—¶é—´æœ€å¤§ï¼ˆæœ€è¿‘è¢«è®¿é—®ï¼‰çš„ç§»é™¤ã€‚å½“éœ€è¦æ·˜æ±°çš„æ—¶å€™ï¼Œåˆ™ç›´æ¥ä»æ± ä¸­é€‰å–æœ€è¿‘è®¿é—®æ—¶é—´æœ€å°ï¼ˆæœ€ä¹…æ²¡è¢«è®¿é—®ï¼‰çš„keyæ·˜æ±°æ‰å°±è¡Œã€‚</p>\n</li>\n<li>\n<p>è·å–å½“å‰å†…å­˜æ·˜æ±°ç­–ç•¥ï¼šconfig get maxmemory-policy</p>\n</li>\n<li>\n<p>ä¿®æ”¹æ·˜æ±°ç­–ç•¥ï¼šconfig set maxmemory-policy allkeys-lru</p>\n</li>\n<li>\n<p>redis.confæ–‡ä»¶ï¼šmaxmemory-policy allkeys-lru</p>\n</li>\n</ul>\n<h1>42. Redis é˜»å¡ï¼Ÿæ€ä¹ˆè§£å†³ï¼Ÿ</h1>\n<ul>\n<li>API æˆ–æ•°æ®ç»“æ„ä½¿ç”¨ä¸åˆç†ï¼šå¯¹äºé«˜å¹¶å‘çš„åœºæ™¯ï¼Œåº”è¯¥å°½é‡é¿å…åœ¨å¤§å¯¹è±¡ä¸Šæ‰§è¡Œç®—æ³•å¤æ‚ åº¦è¶…è¿‡ Oï¼ˆnï¼‰çš„å‘½ä»¤ã€‚å¯¹æ…¢æŸ¥è¯¢çš„å¤„ç†åˆ†ä¸ºä¸¤æ­¥ï¼š\n<ul>\n<li>å‘ç°æ…¢æŸ¥è¯¢ï¼š slowlog get{n}å‘½ä»¤å¯ä»¥è·å–æœ€è¿‘ çš„ n æ¡æ…¢æŸ¥è¯¢å‘½ä»¤ï¼›</li>\n<li>ä¼˜åŒ–æ…¢æŸ¥è¯¢ï¼š\n<ul>\n<li>ä¿®æ”¹ä¸ºä½ç®—æ³•å¤æ‚åº¦çš„å‘½ä»¤ï¼Œå¦‚ hgetall æ”¹ä¸º hmget ç­‰ï¼Œç¦ç”¨ keysã€sort ç­‰å‘½ ä»¤</li>\n<li>è°ƒæ•´å¤§å¯¹è±¡ï¼šç¼©å‡å¤§å¯¹è±¡æ•°æ®æˆ–æŠŠå¤§å¯¹è±¡æ‹†åˆ†ä¸ºå¤šä¸ªå°å¯¹è±¡ï¼Œé˜²æ­¢ä¸€æ¬¡å‘½ä»¤æ“ä½œè¿‡å¤šçš„æ•°æ®ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>CPUé¥±å’Œçš„é—®é¢˜ Redis å•æ ¸ CPU ä½¿ç”¨ç‡è·‘åˆ°æ¥è¿‘ 100%ã€‚\n<ul>\n<li>åˆ¤æ–­å½“å‰ Redis å¹¶å‘é‡æ˜¯å¦å·²ç»è¾¾åˆ°æé™ï¼Œå¯ä»¥ä½¿ç”¨ç»Ÿè®¡å‘½ä»¤ redis-cli-h{ip}-p{port}--stat è·å–å½“å‰ Redis ä½¿ç”¨æƒ…å†µå¦‚æœ Redis çš„è¯·æ±‚å‡ ä¸‡+ï¼Œé‚£ä¹ˆå¤§æ¦‚å°±æ˜¯ Redis çš„ OPS å·²ç»åˆ°äº†æé™ï¼Œåº”è¯¥åšé›†ç¾¤åŒ–æ°´å“æ‰©å±•æ¥åˆ†æ‘Š OPS å‹åŠ›å¦‚æœåªæœ‰å‡ ç™¾å‡ åƒï¼Œé‚£ä¹ˆå°±å¾—æ’æŸ¥å‘½ä»¤å’Œå†…å­˜çš„ä½¿ç”¨</li>\n</ul>\n</li>\n<li>æŒä¹…åŒ–ç›¸å…³çš„é˜»å¡\n<ul>\n<li>fork é˜»å¡ï¼šfork æ“ä½œå‘ç”Ÿåœ¨ RDB å’Œ AOF é‡å†™æ—¶ï¼ŒRedis ä¸»çº¿ç¨‹è°ƒç”¨ fork æ“ä½œäº§ç”Ÿå…±äº« å†…å­˜çš„å­è¿›ç¨‹ï¼Œç”±å­è¿›ç¨‹å®ŒæˆæŒä¹…åŒ–æ–‡ä»¶é‡å†™å·¥ä½œã€‚å¦‚æœ fork æ“ä½œæœ¬èº«è€—æ—¶è¿‡é•¿ï¼Œå¿…ç„¶ä¼šå¯¼è‡´ä¸»çº¿ç¨‹çš„é˜»å¡ã€‚</li>\n<li>AOF åˆ·ç›˜é˜»å¡ï¼šå½“å¼€å¯ AOF æŒä¹…åŒ–åŠŸèƒ½æ—¶ï¼Œæ–‡ä»¶åˆ·ç›˜çš„æ–¹å¼ä¸€èˆ¬é‡‡ç”¨æ¯ç§’ä¸€æ¬¡ï¼Œåå°çº¿ç¨‹æ¯ç§’å¯¹ AOF æ–‡ä»¶åš fsync æ“ä½œã€‚å½“ç¡¬ç›˜å‹åŠ›è¿‡å¤§æ—¶ï¼Œfsync æ“ä½œéœ€è¦ç­‰ å¾…ï¼Œç›´åˆ°å†™å…¥å®Œæˆã€‚å¦‚æœä¸»çº¿ç¨‹å‘ç°è·ç¦»ä¸Šä¸€æ¬¡çš„ fsync æˆåŠŸè¶…è¿‡ 2 ç§’ï¼Œä¸ºäº† æ•°æ®å®‰å…¨æ€§å®ƒä¼šé˜»å¡ç›´åˆ°åå°çº¿ç¨‹æ‰§è¡Œ fsync æ“ä½œå®Œæˆã€‚</li>\n<li>HugePage å†™æ“ä½œé˜»å¡ï¼šå¯¹äºå¼€å¯ Transparent HugePages çš„ æ“ä½œç³»ç»Ÿï¼Œæ¯æ¬¡å†™å‘½ä»¤å¼•èµ·çš„å¤åˆ¶å†…å­˜é¡µå•ä½ç”± 4K å˜ä¸º 2MBï¼Œæ”¾å¤§äº† 512 å€ï¼Œä¼šæ‹–æ…¢å†™æ“ä½œçš„æ‰§è¡Œæ—¶é—´ï¼Œå¯¼è‡´å¤§é‡å†™æ“ä½œæ…¢æŸ¥è¯¢ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>43. å¤§ key é—®é¢˜äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>å¤§ key æŒ‡çš„æ˜¯å­˜å‚¨äº†å¤§é‡æ•°æ®çš„é”®ï¼Œæ¯”å¦‚ï¼šå•ä¸ªç®€å•çš„ key å­˜å‚¨çš„ value å¾ˆå¤§ï¼Œsize è¶…è¿‡ 10KBã€‚hashï¼Œsetï¼Œzsetï¼Œlist ä¸­å­˜å‚¨è¿‡å¤šçš„å…ƒç´ ï¼ˆä»¥ä¸‡ä¸ºå•ä½ï¼‰</li>\n<li>å¤§ key ä¼šé€ æˆçš„é—®é¢˜å‘¢ï¼Ÿ\n<ul>\n<li>å®¢æˆ·ç«¯è¶…æ—¶</li>\n<li>å¯¹å¤§ key è¿›è¡Œ IO æ“ä½œæ—¶ï¼Œä¼šä¸¥é‡å ç”¨å¸¦å®½å’Œ CPU</li>\n<li>é€ æˆ Redis é›†ç¾¤ä¸­æ•°æ®å€¾æ–œ</li>\n<li>ä¸»åŠ¨åˆ é™¤ã€è¢«åŠ¨åˆ ç­‰ï¼Œå¯èƒ½ä¼šå¯¼è‡´é˜»å¡</li>\n</ul>\n</li>\n<li>å¦‚ä½•æ‰¾åˆ°å¤§ key?\n<ul>\n<li>bigkeys å‚æ•°ï¼šä½¿ç”¨ bigkeys å‘½ä»¤ä»¥éå†çš„æ–¹å¼åˆ†æ Redis å®ä¾‹ä¸­çš„æ‰€æœ‰ Keyï¼Œå¹¶è¿”å›æ•´ä½“ç»Ÿè®¡ä¿¡æ¯ä¸æ¯ä¸ªæ•°æ®ç±»å‹ä¸­ Top1 çš„å¤§ Keyã€‚redis-cli --bigkeys</li>\n<li>redis-rdb-toolsï¼šredis-rdb-tools æ˜¯ç”± Python è¯­è¨€ç¼–å†™çš„ç”¨æ¥åˆ†æ Redis ä¸­ rdb å¿«ç…§æ–‡ä»¶çš„å·¥å…·ã€‚</li>\n</ul>\n</li>\n<li>å¦‚ä½•å¤„ç†å¤§ key?\n<ul>\n<li>åˆ é™¤å¤§ key\n<ul>\n<li>å½“Redisç‰ˆæœ¬å¤§äº4.0 æ—¶ï¼Œå¯ä½¿ç”¨ UNLINK å‘½ä»¤å®‰å…¨åœ°åˆ é™¤å¤§ Keyï¼Œè¯¥å‘½ä»¤èƒ½å¤Ÿä»¥éé˜»å¡çš„æ–¹å¼ï¼Œé€æ­¥åœ°æ¸…ç†ä¼ å…¥çš„å¤§ Keyã€‚</li>\n<li>å½“Redisç‰ˆæœ¬å°äº 4.0 æ—¶ï¼Œå»ºè®®é€šè¿‡ SCAN å‘½ä»¤æ‰§è¡Œå¢é‡è¿­ä»£æ‰«æ keyï¼Œç„¶ååˆ¤æ–­è¿›è¡Œåˆ é™¤ã€‚</li>\n</ul>\n</li>\n<li>å‹ç¼©å’Œæ‹†åˆ† key\n<ul>\n<li>å½“vauleæ˜¯stringæ—¶ï¼Œä½¿ç”¨åºåˆ—åŒ–ã€å‹ç¼©ç®—æ³•å°†keyçš„å¤§å°æ§åˆ¶åœ¨åˆç†èŒƒå›´å†…ï¼Œä½†æ˜¯åºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½ä¼šå¸¦æ¥é¢å¤–çš„æ€§èƒ½æ¶ˆè€—</li>\n<li>å½“ value æ˜¯ stringï¼Œå‹ç¼©ä¹‹åä»ç„¶æ˜¯å¤§ key æ—¶ï¼Œåˆ™éœ€è¦è¿›è¡Œæ‹†åˆ†ï¼Œå°†ä¸€ä¸ªå¤§ key åˆ†ä¸ºä¸åŒçš„éƒ¨åˆ†ï¼Œè®°å½•æ¯ä¸ªéƒ¨åˆ†çš„ keyï¼Œä½¿ç”¨ multiget ç­‰æ“ä½œå®ç°äº‹åŠ¡è¯»å–ã€‚</li>\n<li>å½“ value æ˜¯ list/set ç­‰é›†åˆç±»å‹æ—¶ï¼Œæ ¹æ®é¢„ä¼°çš„æ•°æ®è§„æ¨¡æ¥è¿›è¡Œåˆ†ç‰‡ï¼Œä¸åŒçš„å…ƒç´ è®¡ç®—ååˆ†åˆ°ä¸åŒçš„ç‰‡ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>44. Redis å¸¸è§æ€§èƒ½é—®é¢˜å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ</h1>\n<ul>\n<li>Master æœ€å¥½ä¸è¦åšä»»ä½•æŒä¹…åŒ–å·¥ä½œï¼ŒåŒ…æ‹¬å†…å­˜å¿«ç…§å’Œ AOF æ—¥å¿—æ–‡ä»¶ï¼Œç‰¹åˆ«æ˜¯ä¸è¦å¯ç”¨å†…å­˜å¿«ç…§åšæŒä¹…åŒ–ã€‚å› ä¸ºMasterå†™å†…å­˜å¿«ç…§ï¼Œsaveå‘½ä»¤è°ƒåº¦rdbSaveå‡½æ•°ï¼Œä¼šé˜»å¡ä¸»çº¿ç¨‹çš„å·¥ä½œï¼Œå½“å¿«ç…§æ¯”è¾ƒå¤§æ—¶å¯¹æ€§èƒ½å½±å“æ˜¯éå¸¸å¤§çš„ï¼Œä¼šé—´æ–­æ€§æš‚åœæœåŠ¡ï¼Œè€ŒMaster AOFæŒä¹…åŒ–ï¼Œå¦‚æœä¸é‡å†™AOFæ–‡ä»¶ï¼ŒAOF æ–‡ä»¶è¿‡å¤§ä¼šå½±å“ Master é‡å¯çš„æ¢å¤é€Ÿåº¦ã€‚</li>\n<li>å¦‚æœæ•°æ®æ¯”è¾ƒå…³é”®ï¼ŒæŸä¸ª Slave å¼€å¯ AOF å¤‡ä»½æ•°æ®ï¼Œç­–ç•¥ä¸ºæ¯ç§’åŒæ­¥ä¸€æ¬¡ã€‚</li>\n<li>ä¸ºäº†ä¸»ä»å¤åˆ¶çš„é€Ÿåº¦å’Œè¿æ¥çš„ç¨³å®šæ€§ï¼ŒSlave å’Œ Master æœ€å¥½åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘å†…ã€‚</li>\n<li>å°½é‡é¿å…åœ¨å‹åŠ›è¾ƒå¤§çš„ä¸»åº“ä¸Šå¢åŠ ä»åº“ã€‚å¯ä»¥è€ƒè™‘åœ¨ä»ä¸ŠæŒ‚è½½å…¶å®ƒçš„ä»ã€‚</li>\n<li>Master è°ƒç”¨ BGREWRITEAOF é‡å†™ AOF æ–‡ä»¶ä¼šå å¤§é‡çš„ CPU å’Œå†…å­˜èµ„æºï¼Œå¯¼è‡´æœåŠ¡ load è¿‡é«˜ï¼Œå‡ºç°çŸ­æš‚æœåŠ¡æš‚åœç°è±¡ã€‚</li>\n<li>ä¸ºäº† Master çš„ç¨³å®šæ€§ï¼Œä¸»ä»å¤åˆ¶ä¸è¦ç”¨å›¾çŠ¶ç»“æ„ï¼Œç”¨å•å‘é“¾è¡¨ç»“æ„æ›´ç¨³å®šï¼Œå³ä¸»ä»å…³ä¸ºï¼šMaster&lt;â€“Slave1&lt;â€“Slave2&lt;â€“Slave3â€¦ï¼Œè¿™æ ·çš„ç»“æ„ä¹Ÿæ–¹ä¾¿è§£å†³å•ç‚¹æ•…éšœé—®é¢˜ï¼Œå®ç° Slave å¯¹ Master çš„æ›¿æ¢ï¼Œä¹Ÿå³ï¼Œå¦‚æœ Master æŒ‚äº†ï¼Œå¯ä»¥ç«‹é©¬å¯ç”¨ Slave1 åš Masterï¼Œå…¶ä»–ä¸å˜ã€‚ä»èŠ‚ç‚¹åœ¨åˆ‡æ¢ä¸»èŠ‚ç‚¹ä½œä¸ºå¤åˆ¶æºçš„æ—¶å€™ï¼Œä¼šé‡æ–°å‘èµ·å…¨é‡å¤åˆ¶ã€‚æ‰€ä»¥æ­¤å¤„é€šè¿‡ Slave1 æŒ‚åœ¨ Slave ä¸‹ï¼Œå¯ä»¥è§„é¿è¿™ä¸ªé—®é¢˜ã€‚åŒæ—¶ï¼Œä¹Ÿå‡å°‘äº† Master çš„å¤åˆ¶å‹åŠ›ã€‚åå¤„æ˜¯ Slave1 çš„å»¶è¿Ÿå¯èƒ½ä¼šé«˜ä¸€äº›äº›ï¼Œæ‰€ä»¥éœ€è¦å–èˆã€‚</li>\n</ul>\n<h1>45. ä½¿ç”¨ Redis å¦‚ä½•å®ç°å¼‚æ­¥é˜Ÿåˆ—ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨ list ä½œä¸ºé˜Ÿåˆ—ï¼Œlpush ç”Ÿäº§æ¶ˆæ¯ï¼Œrpop æ¶ˆè´¹æ¶ˆæ¯ï¼Œ æ¶ˆè´¹è€…æ­»å¾ªç¯ rpop ä»é˜Ÿåˆ—ä¸­æ¶ˆè´¹æ¶ˆæ¯ã€‚ä½†æ˜¯è¿™æ ·ï¼Œå³ä½¿é˜Ÿåˆ—é‡Œæ²¡æœ‰æ¶ˆæ¯ï¼Œä¹Ÿä¼šè¿›è¡Œ rpopï¼Œä¼šå¯¼è‡´ Redis CPU çš„æ¶ˆè€—ã€‚å¯ä»¥é€šè¿‡è®©æ¶ˆè´¹è€…ä¼‘çœ çš„æ–¹å¼çš„æ–¹å¼æ¥å¤„ç†ï¼Œä½†æ˜¯è¿™æ ·åˆä¼šåˆæ¶ˆæ¯çš„å»¶è¿Ÿé—®é¢˜ã€‚</li>\n<li>ä½¿ç”¨ list ä½œä¸ºé˜Ÿåˆ—ï¼Œlpush ç”Ÿäº§æ¶ˆæ¯ï¼Œbrpop æ¶ˆè´¹æ¶ˆæ¯ brpop æ˜¯ rpop çš„é˜»å¡ç‰ˆæœ¬ï¼Œlist ä¸ºç©ºçš„æ—¶å€™ï¼Œå®ƒä¼šä¸€ç›´é˜»å¡ï¼Œç›´åˆ° list ä¸­æœ‰å€¼æˆ–è€…è¶…æ—¶ã€‚åªèƒ½å®ç°ä¸€å¯¹ä¸€çš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li>\n<li>ä½¿ç”¨ Redis çš„ pub/sub æ¥è¿›è¡Œæ¶ˆæ¯çš„å‘å¸ƒ/è®¢é˜…ï¼šå¯ä»¥ 1ï¼šN çš„æ¶ˆæ¯å‘å¸ƒ/è®¢é˜…ã€‚å‘å¸ƒè€…å°†æ¶ˆæ¯å‘å¸ƒåˆ°æŒ‡å®šçš„é¢‘é“é¢‘é“ï¼ˆchannelï¼‰ï¼Œè®¢é˜…ç›¸åº”é¢‘é“çš„å®¢æˆ·ç«¯éƒ½èƒ½æ”¶åˆ°æ¶ˆæ¯ã€‚ä½†æ˜¯è¿™ç§æ–¹å¼ä¸æ˜¯å¯é çš„ï¼Œåœ¨æ¶ˆè´¹è€…ä¸‹çº¿çš„æƒ…å†µä¸‹ï¼Œç”Ÿäº§çš„æ¶ˆæ¯ä¼šä¸¢å¤±ï¼Œ</li>\n<li>æ‰€ä»¥ï¼Œä¸€èˆ¬çš„å¼‚æ­¥é˜Ÿåˆ—çš„å®ç°è¿˜æ˜¯äº¤ç»™ä¸“ä¸šçš„æ¶ˆæ¯é˜Ÿåˆ—ã€‚</li>\n</ul>\n<h1>46. Redis å¦‚ä½•å®ç°å»¶æ—¶é˜Ÿåˆ—?</h1>\n<p>ä½¿ç”¨ Redis çš„ zsetï¼ˆæœ‰åºé›†åˆï¼‰æ¥å®ç°å»¶æ—¶é˜Ÿåˆ—ã€‚</p>\n<ul>\n<li>ç¬¬ä¸€æ­¥ï¼Œå°†ä»»åŠ¡æ·»åŠ åˆ° zset ä¸­ï¼Œscore ä¸ºä»»åŠ¡çš„æ‰§è¡Œæ—¶é—´æˆ³ï¼Œvalue ä¸ºä»»åŠ¡çš„å†…å®¹ã€‚ZADD delay_queue 1617024000 task1</li>\n<li>ç¬¬äºŒæ­¥ï¼Œå®šæœŸï¼ˆä¾‹å¦‚æ¯ç§’ï¼‰ä» zset ä¸­è·å– score å°äºå½“å‰æ—¶é—´æˆ³çš„ä»»åŠ¡ï¼Œç„¶åæ‰§è¡Œä»»åŠ¡ã€‚ZREMRANGEBYSCORE delay_queue -inf 1617024000</li>\n<li>ç¬¬ä¸‰æ­¥ï¼Œä» zset ä¸­åˆ é™¤ä»»åŠ¡ã€‚ZREM delay_queue task1</li>\n<li>Redis çœŸçš„çœŸçš„çœŸçš„ä¸æ¨èä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ä½¿ç”¨ï¼Œå®ƒæœ€å¤šåªæ˜¯æ¶ˆæ¯é˜Ÿåˆ—çš„å­˜å‚¨å±‚ï¼Œä¸Šå±‚çš„é€»è¾‘ï¼Œè¿˜éœ€è¦åšå¤§é‡çš„å°è£…å’Œæ”¯æŒã€‚</li>\n<li>åœ¨ Redis 5.0 å¢åŠ äº† Stream åŠŸèƒ½ï¼Œä¸€ä¸ªæ–°çš„å¼ºå¤§çš„æ”¯æŒå¤šæ’­çš„å¯æŒä¹…åŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæä¾›ç±»ä¼¼ Kafka çš„åŠŸèƒ½ã€‚</li>\n</ul>\n<h1>47. Redis æ”¯æŒäº‹åŠ¡å—ï¼Ÿ</h1>\n<ul>\n<li>Redisæ”¯æŒäº‹åŠ¡ï¼Œå¯å°†å¤šä¸ªå‘½ä»¤æ‰“åŒ…ï¼Œç„¶åä¸€æ¬¡æ€§æŒ‰ç…§é¡ºåºæ‰§è¡Œã€‚ä¸»è¦é€šè¿‡ multiã€execã€discardã€watch ç­‰å‘½ä»¤æ¥å®ç°ï¼š\n<ul>\n<li>multiï¼šæ ‡è®°ä¸€ä¸ªäº‹åŠ¡å—çš„å¼€å§‹</li>\n<li>execï¼šæ‰§è¡Œæ‰€æœ‰äº‹åŠ¡å—å†…çš„å‘½ä»¤</li>\n<li>discardï¼šå–æ¶ˆäº‹åŠ¡ï¼Œæ”¾å¼ƒæ‰§è¡Œäº‹åŠ¡å—å†…çš„æ‰€æœ‰å‘½ä»¤</li>\n<li>watchï¼šç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ª keyï¼Œå¦‚æœåœ¨äº‹åŠ¡æ‰§è¡Œä¹‹å‰è¿™ä¸ª key è¢«å…¶ä»–å‘½ä»¤æ‰€æ”¹åŠ¨ï¼Œé‚£ä¹ˆäº‹åŠ¡å°†è¢«æ‰“æ–­</li>\n</ul>\n</li>\n<li>Redis äº‹åŠ¡çš„åŸç†ï¼š\n<ul>\n<li>ä½¿ç”¨ MULTI å‘½ä»¤å¼€å§‹ä¸€ä¸ªäº‹åŠ¡ã€‚ä»è¿™ä¸ªå‘½ä»¤æ‰§è¡Œä¹‹åå¼€å§‹ï¼Œæ‰€æœ‰çš„åç»­å‘½ä»¤éƒ½ä¸ä¼šç«‹å³æ‰§è¡Œï¼Œè€Œæ˜¯è¢«æ”¾å…¥ä¸€ä¸ªé˜Ÿåˆ—ä¸­ã€‚åœ¨è¿™ä¸ªé˜¶æ®µï¼ŒRedis åªæ˜¯è®°å½•ä¸‹äº†è¿™äº›å‘½ä»¤ã€‚</li>\n<li>åœ¨äº‹åŠ¡å¼€å¯ä¹‹å‰ï¼Œå¦‚æœå®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ä¹‹é—´å‡ºç°é€šè®¯æ•…éšœå¹¶å¯¼è‡´ç½‘ç»œæ–­å¼€ï¼Œå…¶åæ‰€æœ‰å¾…æ‰§è¡Œçš„è¯­å¥éƒ½å°†ä¸ä¼šè¢«æœåŠ¡å™¨æ‰§è¡Œã€‚ä½¿ç”¨ EXEC å‘½ä»¤è§¦å‘äº‹åŠ¡çš„æ‰§è¡Œã€‚ä¸€æ—¦æ‰§è¡Œäº† EXECï¼Œä¹‹å‰ MULTI åé˜Ÿåˆ—ä¸­çš„æ‰€æœ‰å‘½ä»¤ä¼šè¢«åŸå­åœ°ï¼ˆatomicï¼‰æ‰§è¡Œã€‚æ„å‘³ç€è¿™äº›å‘½ä»¤è¦ä¹ˆå…¨éƒ¨æ‰§è¡Œï¼Œè¦ä¹ˆï¼ˆåœ¨å‡ºç°é”™è¯¯æ—¶ï¼‰å…¨éƒ¨ä¸æ‰§è¡Œã€‚Lua è„šæœ¬ä¹Ÿèƒ½å®ç°åŸå­æ“ä½œã€‚</li>\n<li>å¦‚æœåœ¨æ‰§è¡Œ EXEC ä¹‹å‰å†³å®šä¸æ‰§è¡Œäº‹åŠ¡ï¼Œå¯ä»¥ä½¿ç”¨ DISCARD å‘½ä»¤æ¥å–æ¶ˆäº‹åŠ¡ã€‚è¿™ä¼šæ¸…ç©ºäº‹åŠ¡é˜Ÿåˆ—å¹¶é€€å‡ºäº‹åŠ¡çŠ¶æ€ã€‚</li>\n<li>WATCH å‘½ä»¤ç”¨äºå®ç°ä¹è§‚é”ã€‚WATCH å‘½ä»¤å¯ä»¥ç›‘è§†ä¸€ä¸ªæˆ–å¤šä¸ªé”®ï¼Œå¦‚æœåœ¨æ‰§è¡Œäº‹åŠ¡çš„è¿‡ç¨‹ä¸­ï¼ˆå³åœ¨æ‰§è¡Œ MULTI ä¹‹åï¼Œæ‰§è¡Œ EXEC ä¹‹å‰ï¼‰ï¼Œè¢«ç›‘è§†çš„é”®è¢«å…¶ä»–å‘½ä»¤æ”¹å˜äº†ï¼Œé‚£ä¹ˆå½“æ‰§è¡Œ EXEC æ—¶ï¼Œäº‹åŠ¡å°†è¢«å–æ¶ˆï¼Œå¹¶ä¸”è¿”å›ä¸€ä¸ªé”™è¯¯ã€‚</li>\n<li>Redisäº‹åŠ¡ä¸­å¦‚æœæœ‰æŸä¸€æ¡å‘½ä»¤æ‰§è¡Œå¤±è´¥ï¼Œå…¶åçš„å‘½ä»¤ä»ç„¶ä¼šè¢«ç»§ç»­æ‰§è¡Œã€‚Luaè„šæœ¬ä¸å…·å¤‡ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f34f8d376ea048a0b46b7.png\" alt=\"redistransaction.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>48. Redis äº‹åŠ¡çš„æ³¨æ„ç‚¹æœ‰å“ªäº›ï¼Ÿ</h1>\n<ul>\n<li>Redis äº‹åŠ¡æ˜¯ä¸æ”¯æŒå›æ»šçš„ï¼Œä¸€æ—¦ EXEC å‘½ä»¤è¢«è°ƒç”¨ï¼Œæ‰€æœ‰å‘½ä»¤éƒ½ä¼šè¢«æ‰§è¡Œï¼Œå³ä½¿æœ‰äº›å‘½ä»¤å¯èƒ½æ‰§è¡Œå¤±è´¥ã€‚å¤±è´¥çš„å‘½ä»¤ä¸ä¼šå½±å“åˆ°å…¶ä»–å‘½ä»¤çš„æ‰§è¡Œã€‚</li>\n</ul>\n<h1>49. Redis äº‹åŠ¡ä¸ºä»€ä¹ˆä¸æ”¯æŒå›æ»šï¼Ÿ</h1>\n<ul>\n<li>å¼•å…¥äº‹åŠ¡å›æ»šæœºåˆ¶ä¼šå¤§å¤§å¢åŠ  Redis çš„å¤æ‚æ€§ï¼Œå› ä¸ºéœ€è¦è·Ÿè¸ªäº‹åŠ¡ä¸­æ¯ä¸ªå‘½ä»¤çš„çŠ¶æ€ï¼Œå¹¶åœ¨å‘ç”Ÿé”™è¯¯æ—¶é€†å‘æ‰§è¡Œå‘½ä»¤ä»¥æ¢å¤åŸå§‹çŠ¶æ€ã€‚</li>\n<li>Redis æ˜¯ä¸€ä¸ªåŸºäºå†…å­˜çš„æ•°æ®å­˜å‚¨ç³»ç»Ÿï¼Œå…¶è®¾è®¡é‡ç‚¹æ˜¯å®ç°é«˜æ€§èƒ½ã€‚äº‹åŠ¡å›æ»šéœ€è¦é¢å¤–çš„èµ„æºå’Œæ—¶é—´æ¥ç®¡ç†å’Œæ‰§è¡Œï¼Œè¿™ä¸ Redis çš„è®¾è®¡ç›®æ ‡ç›¸è¿èƒŒã€‚å› æ­¤ï¼ŒRedis é€‰æ‹©ä¸æ”¯æŒäº‹åŠ¡å›æ»šã€‚</li>\n</ul>\n<h1>50. Redis å’Œ Lua è„šæœ¬çš„ä½¿ç”¨äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>Lua è„šæœ¬åœ¨ Redis ä¸­æ˜¯åŸå­æ‰§è¡Œçš„ï¼Œæ‰§è¡Œè¿‡ç¨‹ä¸­é—´ä¸ä¼šæ’å…¥å…¶ä»–å‘½ä»¤ã€‚</li>\n<li>Lua è„šæœ¬å¯ä»¥å¸®åŠ©å¼€å‘å’Œè¿ç»´äººå‘˜åˆ›é€ å‡ºè‡ªå·±å®šåˆ¶çš„å‘½ä»¤ï¼Œå¹¶å¯ä»¥å°†è¿™ äº›å‘½ä»¤å¸¸é©»åœ¨ Redis å†…å­˜ä¸­ï¼Œå®ç°å¤ç”¨çš„æ•ˆæœã€‚</li>\n<li>Lua è„šæœ¬å¯ä»¥å°†å¤šæ¡å‘½ä»¤ä¸€æ¬¡æ€§æ‰“åŒ…ï¼Œæœ‰æ•ˆåœ°å‡å°‘ç½‘ç»œå¼€é”€ã€‚</li>\n<li>æ¯”å¦‚è¿™ä¸€æ®µå¾ˆï¼ˆçƒ‚ï¼‰ç»ï¼ˆå¤§ï¼‰å…¸ï¼ˆè¡—ï¼‰çš„ç§’æ€ç³»ç»Ÿåˆ©ç”¨ lua æ‰£å‡ Redis åº“å­˜çš„è„šæœ¬ï¼š</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>  -- åº“å­˜æœªé¢„çƒ­\n  if (redis.call('exists', KEYS[2]) == 1) then\n      return -9;\n  end;\n  -- ç§’æ€å•†å“åº“å­˜å­˜åœ¨\n  if (redis.call('exists', KEYS[1]) == 1) then\n      local stock = tonumber(redis.call('get', KEYS[1]));\n      local num = tonumber(ARGV[1]);\n      -- å‰©ä½™åº“å­˜å°‘äºè¯·æ±‚æ•°é‡\n      if (stock &lt; num) then\n          return -3\n      end;\n      -- æ‰£å‡åº“å­˜\n      if (stock &gt;= num) then\n          redis.call('incrby', KEYS[1], 0 - num);\n          -- æ‰£å‡æˆåŠŸ\n          return 1\n      end;\n      return -2;\n  end;\n  -- ç§’æ€å•†å“åº“å­˜ä¸å­˜åœ¨\n  return -1;\n</code></pre></div><h1>51. Redis çš„ç®¡é“Pipeliningäº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>Redisæä¾›ä¸‰ç§å°†å®¢æˆ·ç«¯å¤šæ¡å‘½ä»¤æ‰“åŒ…å‘é€ç»™æœåŠ¡ç«¯æ‰§è¡Œçš„æ–¹å¼ï¼šPipelining(ç®¡é“) ã€ Transactions(äº‹åŠ¡) å’Œ Lua Scripts(Lua è„šæœ¬) ã€‚</li>\n<li>Pipeliningï¼ˆç®¡é“ï¼‰:å½“å®¢æˆ·ç«¯éœ€è¦æ‰§è¡Œå¤šæ¡ redis å‘½ä»¤æ—¶ï¼Œå¯ä»¥é€šè¿‡ç®¡é“ä¸€æ¬¡æ€§å°†è¦æ‰§è¡Œçš„å¤šæ¡å‘½ä»¤å‘é€ç»™æœåŠ¡ç«¯ï¼Œä½¿ç”¨ nc å‘½ä»¤å°†ä¸¤æ¡æŒ‡ä»¤å‘é€ç»™ redis æœåŠ¡ç«¯ã€‚Redis æœåŠ¡ç«¯æ¥æ”¶åˆ°ç®¡é“å‘é€è¿‡æ¥çš„å¤šæ¡å‘½ä»¤åï¼Œä¼šä¸€ç›´æ‰§å‘½ä»¤ï¼Œå¹¶å°†å‘½ä»¤çš„æ‰§è¡Œç»“æœè¿›è¡Œç¼“å­˜ï¼Œç›´åˆ°æœ€åä¸€æ¡å‘½ä»¤æ‰§è¡Œå®Œæˆï¼Œå†æ‰€æœ‰å‘½ä»¤çš„æ‰§è¡Œç»“æœä¸€æ¬¡æ€§è¿”å›ç»™å®¢æˆ·ç«¯ ã€‚</li>\n<li>Pipelining çš„ä¼˜åŠ¿\n<ul>\n<li>èŠ‚çœäº† RTTï¼šå°†å¤šæ¡å‘½ä»¤æ‰“åŒ…ä¸€æ¬¡æ€§å‘é€ç»™æœåŠ¡ç«¯ï¼Œå‡å°‘äº†å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯ä¹‹é—´çš„ç½‘ç»œè°ƒç”¨æ¬¡æ•°</li>\n<li>å‡å°‘äº†ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼šå½“å®¢æˆ·ç«¯/æœåŠ¡ç«¯éœ€è¦ä»ç½‘ç»œä¸­è¯»å†™æ•°æ®æ—¶ï¼Œéƒ½ä¼šäº§ç”Ÿä¸€æ¬¡ç³»ç»Ÿè°ƒç”¨ï¼Œç³»ç»Ÿè°ƒç”¨æ˜¯éå¸¸è€—æ—¶çš„æ“ä½œï¼Œå…¶ä¸­è®¾è®¡åˆ°ç¨‹åºç”±ç”¨æˆ·æ€åˆ‡æ¢åˆ°å†…æ ¸æ€ï¼Œå†ä»å†…æ ¸æ€åˆ‡æ¢å›ç”¨æˆ·æ€çš„è¿‡ç¨‹ã€‚åªä¼šäº§ç”Ÿä¸€æ¬¡ä¸Šä¸‹æ–‡åˆ‡æ¢ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>52. Redis å®ç°åˆ†å¸ƒå¼é”äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>\n<p>åˆ†å¸ƒå¼é”è€ƒè™‘è¦ç‚¹</p>\n<ul>\n<li>1.æ­£ç¡®çš„è·å¾—é”(ä¿è¯æœ‰ä¸”åªæœ‰ä¸€ä¸ªè¿›ç¨‹è·å¾—åˆ°) set æŒ‡ä»¤é™„å¸¦ nx å‚æ•°</li>\n<li>2.æ­£ç¡®çš„é‡Šæ”¾é”:ä½¿ç”¨ Lua è„šæœ¬ï¼Œæ¯”å¯¹é”æŒæœ‰çš„æ˜¯ä¸æ˜¯è‡ªå·±ã€‚å¦‚æœæ˜¯ï¼Œåˆ™è¿›è¡ŒdelæŒ‡ä»¤åˆ é™¤æ¥é‡Šæ”¾ã€‚</li>\n<li>3.è¶…æ—¶çš„è‡ªåŠ¨é‡Šæ”¾é”set æŒ‡ä»¤é™„å¸¦ expireå‚æ•°ï¼Œé€šè¿‡è¿‡æœŸæœºåˆ¶æ¥å®ç°è¶…æ—¶é‡Šæ”¾ã€‚</li>\n<li>4.æœªè·å¾—åˆ°é”çš„ç­‰å¾…æœºåˆ¶:sleepæˆ–è€…åŸºäºRedisè®¢é˜… Pub/Sub æœºåˆ¶ã€‚ä¸€äº›ä¸šåŠ¡åœºæ™¯ï¼Œå¯èƒ½éœ€è¦æ”¯æŒè·å¾—ä¸åˆ°é”ï¼Œç›´æ¥è¿”å›false ï¼Œä¸ç­‰å¾…</li>\n<li>5.é‡å…¥æ€§(å¯é€‰):é€šè¿‡<code>ThreadLocal&lt;Integer&gt;</code>è®°å½•æ˜¯ç¬¬å‡ æ¬¡è·å¾—ç›¸åŒçš„é”ã€‚æœ‰ä¸”ç¬¬ä¸€æ¬¡è®¡æ•°ä¸º1&amp;&amp;è·å¾—é”æ—¶ï¼Œæ‰å‘ Redis å‘èµ·è·å¾—é”çš„æ“ä½œ;æœ‰ä¸”è®¡æ•°ä¸º 0 &amp;&amp; é‡Šæ”¾é”æ—¶ï¼Œæ‰å‘ Redis å‘èµ·é‡Šæ”¾é”çš„æ“ä½œã€‚</li>\n<li>6ã€é”è¶…æ—¶çš„å¤„ç†ï¼šå¯ä»¥è€ƒè™‘å‘Šè­¦ + åå°çº¿ç¨‹è‡ªåŠ¨ç»­é”çš„è¶…æ—¶æ—¶é—´ã€‚é€šè¿‡è¿™æ ·çš„æœºåˆ¶ï¼Œä¿è¯æœ‰ä¸”ä»…æœ‰ä¸€ä¸ªçº¿ç¨‹ï¼Œæ­£åœ¨æŒæœ‰é”ã€‚</li>\n<li>7ã€Redis åˆ†å¸ƒå¼é”ä¸¢å¤±é—®é¢˜ çœ‹æ–¹æ¡ˆ2 Redlock</li>\n</ul>\n</li>\n<li>\n<p>æ–¹æ¡ˆ1ã€‚ä½¿ç”¨setæŒ‡ä»¤SET key_name my_random_value NX PX 30000</p>\n<ul>\n<li>NXè¡¨ç¤ºif not exist å°±è®¾ç½®å¹¶è¿”å›Trueï¼Œå¦åˆ™ä¸è®¾ç½®å¹¶è¿”å›False</li>\n<li>PXè¡¨ç¤ºè¿‡æœŸæ—¶é—´ç”¨æ¯«ç§’çº§ï¼Œ 30000è¡¨ç¤ºè¿™äº›æ¯«ç§’æ—¶é—´åæ­¤keyè¿‡æœŸ</li>\n<li>delé‡Šæ”¾é”</li>\n<li>ç¼ºç‚¹æ˜¯åŠ é”æ—¶åªä½œç”¨åœ¨ä¸€ä¸ªRedisèŠ‚ç‚¹ä¸Šï¼Œå³ä½¿Redisé€šè¿‡sentinelä¿è¯é«˜å¯ç”¨ï¼Œå¦‚æœè¿™ä¸ªmasterèŠ‚ç‚¹ç”±äºæŸäº›åŸå› å‘ç”Ÿäº†ä¸»ä»åˆ‡æ¢ï¼Œåœ¨Redisçš„masterèŠ‚ç‚¹ä¸Šæ‹¿åˆ°äº†é”ï¼›ä½†æ˜¯è¿™ä¸ªåŠ é”çš„keyè¿˜æ²¡æœ‰åŒæ­¥åˆ°slaveèŠ‚ç‚¹ï¼›masteræ•…éšœï¼Œå‘ç”Ÿæ•…éšœè½¬ç§»ï¼ŒslaveèŠ‚ç‚¹å‡çº§ä¸ºmasterèŠ‚ç‚¹ï¼›å¯¼è‡´é”ä¸¢å¤±ã€‚</li>\n</ul>\n</li>\n<li>\n<p>æ–¹æ¡ˆ2:ä½¿ç”¨Redlockï¼Œå¤šRedisèŠ‚ç‚¹çš„åœºæ™¯ä¸‹ï¼Œä¼šå­˜åœ¨åˆ†å¸ƒå¼é”ä¸¢å¤±çš„é—®é¢˜ã€‚</p>\n<ul>\n<li>å®¢æˆ·ç«¯ä¸šåŠ¡é€»è¾‘</li>\n<li>è·å–å½“å‰Unixæ—¶é—´ï¼Œä»¥æ¯«ç§’ä¸ºå•ä½ã€‚</li>\n<li>ä¾æ¬¡å°è¯•ä»5ä¸ªå®ä¾‹ï¼Œä½¿ç”¨ç›¸åŒçš„keyå’Œå…·æœ‰å”¯ä¸€æ€§çš„valueï¼ˆä¾‹å¦‚UUIDï¼‰è·å–é”ã€‚å½“å‘Redisè¯·æ±‚è·å–é”æ—¶ï¼Œå®¢æˆ·ç«¯åº”è¯¥è®¾ç½®ä¸€ä¸ªç½‘ç»œè¿æ¥å’Œå“åº”è¶…æ—¶æ—¶é—´ï¼Œè¿™ä¸ªè¶…æ—¶æ—¶é—´åº”è¯¥å°äºé”çš„å¤±æ•ˆæ—¶é—´ã€‚ä¾‹å¦‚ä½ çš„é”è‡ªåŠ¨å¤±æ•ˆæ—¶é—´ä¸º10ç§’ï¼Œåˆ™è¶…æ—¶æ—¶é—´åº”è¯¥åœ¨5-50æ¯«ç§’ä¹‹é—´ã€‚è¿™æ ·å¯ä»¥é¿å…æœåŠ¡å™¨ç«¯Rediså·²ç»æŒ‚æ‰çš„æƒ…å†µä¸‹ï¼Œå®¢æˆ·ç«¯è¿˜åœ¨æ­»æ­»åœ°ç­‰å¾…å“åº”ç»“æœã€‚å¦‚æœæœåŠ¡å™¨ç«¯æ²¡æœ‰åœ¨è§„å®šæ—¶é—´å†…å“åº”ï¼Œå®¢æˆ·ç«¯åº”è¯¥å°½å¿«å°è¯•å»å¦å¤–ä¸€ä¸ªRediså®ä¾‹è¯·æ±‚è·å–é”ã€‚</li>\n<li>å®¢æˆ·ç«¯ä½¿ç”¨å½“å‰æ—¶é—´å‡å»å¼€å§‹è·å–é”æ—¶é—´ï¼ˆæ­¥éª¤1è®°å½•çš„æ—¶é—´ï¼‰å°±å¾—åˆ°è·å–é”ä½¿ç”¨çš„æ—¶é—´ã€‚å½“ä¸”ä»…å½“ä»å¤§å¤šæ•°ï¼ˆN/2+1ï¼Œè¿™é‡Œæ˜¯3ä¸ªèŠ‚ç‚¹ï¼‰çš„RedisèŠ‚ç‚¹éƒ½å–åˆ°é”ï¼Œå¹¶ä¸”ä½¿ç”¨çš„æ—¶é—´å°äºé”å¤±æ•ˆæ—¶é—´æ—¶ï¼Œé”æ‰ç®—è·å–æˆåŠŸ</li>\n<li>å¦‚æœå–åˆ°äº†é”ï¼Œkeyçš„çœŸæ­£æœ‰æ•ˆæ—¶é—´ç­‰äºæœ‰æ•ˆæ—¶é—´å‡å»è·å–é”æ‰€ä½¿ç”¨çš„æ—¶é—´ï¼ˆæ­¥éª¤3è®¡ç®—çš„ç»“æœï¼‰ã€‚</li>\n<li>å¦‚æœå› ä¸ºæŸäº›åŸå› ï¼Œè·å–é”å¤±è´¥ï¼ˆæ²¡æœ‰åœ¨è‡³å°‘N/2+1ä¸ªRediså®ä¾‹å–åˆ°é”æˆ–è€…å–é”æ—¶é—´å·²ç»è¶…è¿‡äº†æœ‰æ•ˆæ—¶é—´ï¼‰ï¼Œå®¢æˆ·ç«¯åº”è¯¥åœ¨æ‰€æœ‰çš„Rediså®ä¾‹ä¸Šè¿›è¡Œè§£é”ï¼ˆå³ä¾¿æŸäº›Rediså®ä¾‹æ ¹æœ¬å°±æ²¡æœ‰åŠ é”æˆåŠŸï¼Œé˜²æ­¢æŸäº›èŠ‚ç‚¹è·å–åˆ°é”ä½†æ˜¯å®¢æˆ·ç«¯æ²¡æœ‰å¾—åˆ°å“åº”è€Œå¯¼è‡´æ¥ä¸‹æ¥çš„ä¸€æ®µæ—¶é—´ä¸èƒ½è¢«é‡æ–°è·å–é”ï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>53. è¯´è¯´ Redis åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h1>\n<ul>\n<li>Redis çš„åº•å±‚æ•°æ®ç»“æ„æœ‰åŠ¨æ€å­—ç¬¦ä¸²(sds)ã€é“¾è¡¨(list)ã€å­—å…¸(ht)ã€è·³è·ƒè¡¨(skiplist)ã€æ•´æ•°é›†åˆ(intset)ã€å‹ç¼©åˆ—è¡¨(ziplist) ç­‰ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/286143af1a640cebce01b.png\" alt=\"redisobject.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8a6db82c6dc41e933a53c.png\" alt=\"redistype.png\"></li>\n<li>list æ˜¯é€šè¿‡é“¾è¡¨å®ç°çš„ï¼Œhash æ˜¯é€šè¿‡å­—å…¸å®ç°çš„ï¼Œset æ˜¯é€šè¿‡å­—å…¸å®ç°çš„ï¼Œzset æ˜¯é€šè¿‡è·³è·ƒè¡¨å®ç°çš„ã€‚</li>\n</ul>\n<h1>54. ç®€å•ä»‹ç»ä¸‹ SDS</h1>\n<ul>\n<li>string æ˜¯é€šè¿‡ SDS(simple dynamic String) å®ç°çš„.Redis æ˜¯é€šè¿‡ C è¯­è¨€å®ç°çš„ï¼Œä½† Redis å®ç°äº†ä¸€ç§å«åšåŠ¨æ€å­—ç¬¦ä¸² SDS çš„ç±»å‹ã€‚SDS ä¿å­˜äº†â»“åº¦ä¿¡æ¯å°†è·å–å­—ç¬¦ä¸²â»“åº¦çš„æ—¶é—´ç”± O(N) é™ä½åˆ°äº† O(1)ã€‚</li>\n<li>é’ˆå¯¹ç¼“å­˜é¢‘ç¹ä¿®æ”¹çš„æƒ…å†µï¼šSDSåˆ†é…å†…å­˜ä¸ä»…ä¼šåˆ†é…éœ€è¦çš„ç©ºé—´ï¼Œè¿˜ä¼šåˆ†é…é¢å¤–çš„ç©ºé—´ã€‚å°äº1MBçš„SDSæ¯æ¬¡åˆ†é…ä¸lenå±æ€§åŒæ ·å¤§å°çš„ç©ºé—´å¤§äº1MBçš„æ¯æ¬¡åˆ†é…1MB</li>\n<li>ä¸¤ç§ç¼–ç æ–¹å¼ï¼šobject encoding [key]æŸ¥çœ‹\n<ul>\n<li>embstrç¼–ç ï¼šä¿å­˜é•¿åº¦&lt;=39å­—ç¬¦ä¸²å€¼</li>\n<li>rawç¼–ç ï¼š å¯¹embstrå­—ç¬¦ä¸²æ‰§è¡Œä»»ä½•ä¿®æ”¹å‘½ä»¤æ—¶ï¼Œç¨‹åºä¼šè½¬æ¢ç¼–ç ä¸ºrawã€‚</li>\n<li>ä¸­æ–‡é»˜è®¤å ä¸‰ä¸ªå­—ç¬¦ã€‚</li>\n</ul>\n</li>\n<li>ä¼˜å…ˆä½¿ç”¨embstrç¼–ç çš„åŸå› ï¼šembstråªä¼šåˆ†é…ä¸€å—è¿ç»­å†…å­˜ï¼Œè¯»å–å¿«ï¼Œåªç”¨é‡Šæ”¾1å—å†…å­˜ï¼›è€Œrawåˆ†é…2å—ä¸è¿ç»­å†…å­˜ï¼Œè¯»å–è¾ƒæ…¢ï¼Œéœ€è¦é‡Šæ”¾2å—å†…å­˜</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>struct sdshdr {\n    int len; // buf ä¸­å·²ä½¿ç”¨çš„é•¿åº¦ è®°å½•SDSæ‰€ä¿å­˜çš„å­—ç¬¦ä¸²é•¿åº¦,ä¿è¯äº†O(1) æ—¶é—´å¤æ‚åº¦æŸ¥è¯¢å­—ç¬¦ä¸²é•¿åº¦ä¿¡æ¯ã€‚\n    int free; // buf ä¸­æœªä½¿ç”¨çš„é•¿åº¦ æƒ°æ€§é‡Šæ”¾ç­–ç•¥ï¼šä¸ç«‹å³ä½¿ç”¨å†…å­˜é‡åˆ†é…æ¥å›æ”¶ç¼©çŸ­åå¤šå‡ºæ¥çš„å­—èŠ‚ï¼Œè€Œæ˜¯ä½¿ç”¨freeå±æ€§ï¼Œè®°å½•bufæ•°ç»„ä¸­æœªä½¿ç”¨å­—èŠ‚çš„æ•°é‡ã€‚ç©ºé—²å‡ºæ¥çš„ç©ºé—´ï¼Œå¯ä»¥è®©stråœ¨è¿›è¡Œappendçš„æ—¶å€™é‡æ–°ä½¿ç”¨\n    char buf[]; // å­—èŠ‚æ•°ç»„ï¼Œç”¨äºä¿å­˜å­—ç¬¦ä¸²\n};\n</code></pre></div><h1>55. ç®€å•ä»‹ç»ä¸‹é“¾è¡¨ linkedlist</h1>\n<ul>\n<li>Redis çš„é“¾è¡¨æ˜¯â¼€ä¸ªåŒå‘â½†ç¯é“¾è¡¨ç»“æ„ï¼Œé“¾è¡¨çš„èŠ‚ç‚¹ç”±â¼€ä¸ªå«åš listNode çš„ç»“æ„æ¥è¡¨ç¤ºï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰æŒ‡å‘å…¶å‰ç½®èŠ‚ç‚¹å’Œåç½®èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ŒåŒæ—¶å¤´èŠ‚ç‚¹çš„å‰ç½®å’Œå°¾èŠ‚ç‚¹çš„åç½®å‡æŒ‡å‘ nullã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/08b7a2d79fab187c13b68.png\" alt=\"redislinkedlist.png\"></li>\n</ul>\n<h1>56. ç®€å•ä»‹ç»ä¸‹å­—å…¸ dict</h1>\n<ul>\n<li>â½¤äºä¿å­˜é”®å€¼å¯¹çš„æŠ½è±¡æ•°æ®ç»“æ„ã€‚Redis ä½¿â½¤ hash è¡¨ä½œä¸ºåº•å±‚å®ç°ï¼Œä¸€ä¸ªå“ˆå¸Œè¡¨é‡Œå¯ä»¥æœ‰å¤šä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹ï¼Œè€Œæ¯ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹å°±ä¿å­˜äº†å­—å…¸é‡Œä¸­çš„ä¸€ä¸ªé”®å€¼å¯¹ã€‚</li>\n<li>æ¯ä¸ªå­—å…¸å¸¦æœ‰ä¸¤ä¸ª hash è¡¨ï¼Œä¾›å¹³æ—¶ä½¿â½¤å’Œ rehash æ—¶ä½¿â½¤ï¼Œhash è¡¨ä½¿â½¤é“¾åœ°å€æ³•æ¥è§£å†³é”®å†²çªï¼Œè¢«åˆ†é…åˆ°åŒâ¼€ä¸ªç´¢å¼•ä½ç½®çš„å¤šä¸ªé”®å€¼å¯¹ä¼šå½¢æˆâ¼€ä¸ªå•å‘é“¾è¡¨ï¼Œåœ¨å¯¹ hash è¡¨è¿›â¾æ‰©å®¹æˆ–è€…ç¼©å®¹çš„æ—¶å€™ï¼Œä¸ºäº†æœåŠ¡çš„å¯â½¤æ€§ï¼Œrehash çš„è¿‡ç¨‹ä¸æ˜¯â¼€æ¬¡æ€§å®Œæˆçš„ï¼Œâ½½æ˜¯æ¸è¿›å¼çš„ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5b18144627f882d3c2c70.png\" alt=\"redisdict.png\"></li>\n</ul>\n<h1>57. ç®€å•ä»‹ç»ä¸‹è·³è·ƒè¡¨ skiplist</h1>\n<ul>\n<li>è·³è·ƒè¡¨ï¼ˆä¹Ÿç§°è·³è¡¨ï¼‰æ˜¯æœ‰åºé›†åˆ Zset çš„åº•å±‚å®ç°ä¹‹â¼€ã€‚åœ¨ Redis 7.0 ä¹‹å‰ï¼Œå¦‚æœæœ‰åºé›†åˆçš„å…ƒç´ ä¸ªæ•°å°äº 128 ä¸ªï¼Œå¹¶ä¸”æ¯ä¸ªå…ƒç´ çš„å€¼å°äº 64 å­—èŠ‚æ—¶ï¼ŒRedis ä¼šä½¿ç”¨å‹ç¼©åˆ—è¡¨ä½œä¸º Zset çš„åº•å±‚å®ç°ï¼Œå¦åˆ™ä¼šä½¿ç”¨è·³è¡¨ï¼›åœ¨ Redis 7.0 ä¹‹åï¼Œå‹ç¼©åˆ—è¡¨å·²ç»åºŸå¼ƒï¼Œäº¤ç”± listpack æ¥æ›¿ä»£ã€‚</li>\n<li>è·³è¡¨ç”± zskiplist å’Œ zskiplistNode ç»„æˆï¼Œzskiplist â½¤äºä¿å­˜è·³è¡¨çš„åŸºæœ¬ä¿¡æ¯ï¼ˆè¡¨å¤´ã€è¡¨å°¾ã€â»“åº¦ã€å±‚é«˜ç­‰ï¼‰ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>typedef struct zskiplist {\n    struct zskiplistNode *header, *tail;\n    unsigned long length;\n    int level;\n} zskiplist;\n</code></pre></div><p>zskiplistNode â½¤äºè¡¨ç¤ºè·³è¡¨èŠ‚ç‚¹ï¼Œæ¯ä¸ªè·³è¡¨èŠ‚ç‚¹çš„å±‚â¾¼æ˜¯ä¸å›ºå®šçš„ï¼Œæ¯ä¸ªèŠ‚ç‚¹éƒ½æœ‰â¼€ä¸ªæŒ‡å‘ä¿å­˜äº†å½“å‰èŠ‚ç‚¹çš„åˆ†å€¼å’Œæˆå‘˜å¯¹è±¡çš„æŒ‡é’ˆ</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>typedef struct zskiplistNode {\n    sds ele;\n    double score;\n    struct zskiplistNode *backward;\n    struct zskiplistLevel {\n        struct zskiplistNode *forward;\n        unsigned int span;\n    } level[];\n} zskiplistNode;\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/32d61a5bdb21dda3126a4.png\" alt=\"redisskiplist.png\" tabindex=\"0\"><figcaption>redisskiplist.png</figcaption></figure>\n<h1>58. ç®€å•ä»‹ç»ä¸‹æ•´æ•°é›†åˆ intset</h1>\n<ul>\n<li>â½¤äºä¿å­˜æ•´æ•°å€¼çš„é›†åˆæŠ½è±¡æ•°æ®ç»“æ„ï¼Œä¸ä¼šå‡ºç°é‡å¤å…ƒç´ ï¼Œåº•å±‚å®ç°ä¸ºæ•°ç»„ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2189558ff281b5d485a73.png\" alt=\"redisintset.png\"></li>\n</ul>\n<h1>59. ç®€å•ä»‹ç»ä¸‹å‹ç¼©åˆ—è¡¨ ziplist</h1>\n<ul>\n<li>å‹ç¼©åˆ—è¡¨æ˜¯ä¸ºèŠ‚çº¦å†…å­˜â½½å¼€å‘çš„é¡ºåºæ€§æ•°æ®ç»“æ„ï¼Œå®ƒå¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜â¼€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…æ•´æ•°å€¼ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6b67240f69c591b8c961e.png\" alt=\"redisintset.png\"></li>\n</ul>\n<h1>60. ç®€å•ä»‹ç»ä¸‹ç´§å‡‘åˆ—è¡¨ listpack</h1>\n<ul>\n<li>listpack æ˜¯ Redis ç”¨æ¥æ›¿ä»£å‹ç¼©åˆ—è¡¨ï¼ˆziplistï¼‰çš„ä¸€ç§å†…å­˜æ›´åŠ ç´§å‡‘çš„æ•°æ®ç»“æ„ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1a8fd93a9d6d25ebab65e.png\" alt=\"redislistpack1.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1495870c3cce2463435cd.png\" alt=\"redislistpack2.png\"></li>\n<li>ä¸ºäº†é¿å… ziplist å¼•èµ·çš„è¿é”æ›´æ–°é—®é¢˜ï¼Œlistpack ä¸­çš„å…ƒç´ ä¸å†åƒ ziplist é‚£æ ·ï¼Œä¿å­˜å…¶å‰ä¸€ä¸ªå…ƒç´ çš„é•¿åº¦ï¼Œè€Œæ˜¯ä¿å­˜å½“å‰å…ƒç´ çš„ç¼–ç ç±»å‹ã€æ•°æ®ï¼Œä»¥åŠç¼–ç ç±»å‹å’Œæ•°æ®çš„é•¿åº¦ã€‚</li>\n<li>listpack æ¯ä¸ªå…ƒç´ é¡¹ä¸å†ä¿å­˜ä¸Šä¸€ä¸ªå…ƒç´ çš„é•¿åº¦ï¼Œè€Œæ˜¯ä¼˜åŒ–å…ƒç´ å†…å­—æ®µçš„é¡ºåºï¼Œæ¥ä¿è¯æ—¢å¯ä»¥ä»å‰ä¹Ÿå¯ä»¥å‘åéå†ã€‚ä½†å› ä¸º List/Hash/Set/ZSet éƒ½ä¸¥é‡ä¾èµ– ziplistï¼Œæ‰€ä»¥è¿™ä¸ªæ›¿æ¢ä¹‹è·¯å¾ˆæ¼«é•¿ã€‚</li>\n</ul>\n<h1>61. Redis çš„ SDS å’Œ C ä¸­å­—ç¬¦ä¸²ç›¸æ¯”æœ‰ä»€ä¹ˆä¼˜åŠ¿ï¼Ÿ</h1>\n<ul>\n<li>C è¯­è¨€ä½¿ç”¨äº†ä¸€ä¸ªé•¿åº¦ä¸º N+1 çš„å­—ç¬¦æ•°ç»„æ¥è¡¨ç¤ºé•¿åº¦ä¸º N çš„å­—ç¬¦ä¸²ï¼Œå¹¶ä¸”å­—ç¬¦æ•°ç»„æœ€åä¸€ä¸ªå…ƒç´ æ€»æ˜¯ \\0ï¼Œè¿™ç§ç®€å•çš„å­—ç¬¦ä¸²è¡¨ç¤ºæ–¹å¼ ä¸ç¬¦åˆ Redis å¯¹å­—ç¬¦ä¸²åœ¨å®‰å…¨æ€§ã€æ•ˆç‡ä»¥åŠåŠŸèƒ½æ–¹é¢çš„è¦æ±‚ã€‚</li>\n<li>C è¯­è¨€çš„å­—ç¬¦ä¸²å¯èƒ½æœ‰ä»€ä¹ˆé—®é¢˜ï¼Ÿ\n<ul>\n<li>è·å–å­—ç¬¦ä¸²é•¿åº¦å¤æ‚åº¦é«˜ ï¼šå› ä¸º C ä¸ä¿å­˜æ•°ç»„çš„é•¿åº¦ï¼Œæ¯æ¬¡éƒ½éœ€è¦éå†ä¸€éæ•´ä¸ªæ•°ç»„ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ï¼›</li>\n<li>ä¸èƒ½æœç» ç¼“å†²åŒºæº¢å‡º/å†…å­˜æ³„æ¼ çš„é—®é¢˜ : C å­—ç¬¦ä¸²ä¸è®°å½•è‡ªèº«é•¿åº¦å¸¦æ¥çš„å¦å¤–ä¸€ä¸ªé—®é¢˜æ˜¯å®¹æ˜“é€ æˆç¼“å­˜åŒºæº¢å‡ºï¼ˆbuffer overflowï¼‰ï¼Œä¾‹å¦‚åœ¨å­—ç¬¦ä¸²æ‹¼æ¥çš„æ—¶å€™ï¼Œæ–°çš„ C å­—ç¬¦ä¸² åªèƒ½ä¿å­˜æ–‡æœ¬æ•°æ® â†’ å› ä¸º C è¯­è¨€ä¸­çš„å­—ç¬¦ä¸²å¿…é¡»ç¬¦åˆæŸç§ç¼–ç ï¼ˆæ¯”å¦‚ ASCIIï¼‰ï¼Œä¾‹å¦‚ä¸­é—´å‡ºç°çš„ '\\0' å¯èƒ½ä¼šè¢«åˆ¤å®šä¸ºæå‰ç»“æŸçš„å­—ç¬¦ä¸²è€Œè¯†åˆ«ä¸äº†ï¼›</li>\n</ul>\n</li>\n<li>Redis å¦‚ä½•è§£å†³ï¼Ÿä¼˜åŠ¿ï¼Ÿ\n<ul>\n<li>å¤šå¢åŠ  len è¡¨ç¤ºå½“å‰å­—ç¬¦ä¸²çš„é•¿åº¦ï¼šè¿™æ ·å°±å¯ä»¥ç›´æ¥è·å–é•¿åº¦äº†ï¼Œå¤æ‚åº¦ O(1)ï¼›</li>\n<li>è‡ªåŠ¨æ‰©å±•ç©ºé—´ï¼šå½“ SDS éœ€è¦å¯¹å­—ç¬¦ä¸²è¿›è¡Œä¿®æ”¹æ—¶ï¼Œé¦–å…ˆå€ŸåŠ©äº len å’Œ alloc æ£€æŸ¥ç©ºé—´æ˜¯å¦æ»¡è¶³ä¿®æ”¹æ‰€éœ€çš„è¦æ±‚ï¼Œå¦‚æœç©ºé—´ä¸å¤Ÿçš„è¯ï¼ŒSDS ä¼šè‡ªåŠ¨æ‰©å±•ç©ºé—´ï¼Œé¿å…äº†åƒ C å­—ç¬¦ä¸²æ“ä½œä¸­çš„æº¢å‡ºæƒ…å†µï¼›</li>\n<li>æœ‰æ•ˆé™ä½å†…å­˜åˆ†é…æ¬¡æ•°ï¼šC å­—ç¬¦ä¸²åœ¨æ¶‰åŠå¢åŠ æˆ–è€…æ¸…é™¤æ“ä½œæ—¶ä¼šæ”¹å˜åº•å±‚æ•°ç»„çš„å¤§å°é€ æˆé‡æ–°åˆ†é…ï¼ŒSDS ä½¿ç”¨äº† ç©ºé—´é¢„åˆ†é… å’Œ æƒ°æ€§ç©ºé—´é‡Šæ”¾ æœºåˆ¶ï¼Œç®€å•ç†è§£å°±æ˜¯æ¯æ¬¡åœ¨æ‰©å±•æ—¶æ˜¯æˆå€çš„å¤šåˆ†é…çš„ï¼Œåœ¨ç¼©å®¹æ˜¯ä¹Ÿæ˜¯å…ˆç•™ç€å¹¶ä¸æ­£å¼å½’è¿˜ç»™ OSï¼›</li>\n<li>äºŒè¿›åˆ¶å®‰å…¨ï¼šC è¯­è¨€å­—ç¬¦ä¸²åªèƒ½ä¿å­˜ ascii ç ï¼Œå¯¹äºå›¾ç‰‡ã€éŸ³é¢‘ç­‰ä¿¡æ¯æ— æ³•ä¿å­˜ï¼ŒSDS æ˜¯äºŒè¿›åˆ¶å®‰å…¨çš„ï¼Œå†™å…¥ä»€ä¹ˆè¯»å–å°±æ˜¯ä»€ä¹ˆï¼Œä¸åšä»»ä½•è¿‡æ»¤å’Œé™åˆ¶ï¼›</li>\n</ul>\n</li>\n</ul>\n<h1>62. å­—å…¸æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸRehash äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>å­—å…¸æ˜¯ Redisä¸­çš„å¤åˆå‹æ•°æ®ç»“æ„ã€‚é™¤äº† hash ç»“æ„çš„æ•°æ®ä¼šç”¨åˆ°å­—å…¸å¤–ï¼Œæ•´ä¸ª Redis æ•°æ®åº“çš„æ‰€æœ‰ key å’Œ value ä¹Ÿç»„æˆäº†ä¸€ä¸ª å…¨å±€å­—å…¸ï¼Œè¿˜æœ‰å¸¦è¿‡æœŸæ—¶é—´çš„ key ä¹Ÿæ˜¯ä¸€ä¸ªå­—å…¸ã€‚(å­˜å‚¨åœ¨ RedisDb æ•°æ®ç»“æ„ä¸­)</li>\n<li>å­—å…¸ç»“æ„æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ\n<ul>\n<li>Redis ä¸­çš„å­—å…¸ç›¸å½“äº HashMapï¼Œå†…éƒ¨å®ç°ä¹Ÿå·®ä¸å¤šç±»ä¼¼ï¼Œé‡‡ç”¨å“ˆå¸Œä¸è¿ç®—è®¡ç®—ä¸‹æ ‡ä½ç½®ï¼›é€šè¿‡ \"æ•°ç»„ + é“¾è¡¨\" çš„é“¾åœ°å€æ³• æ¥è§£å†³å“ˆå¸Œå†²çªï¼ŒåŒæ—¶è¿™æ ·çš„ç»“æ„ä¹Ÿå¸æ”¶äº†ä¸¤ç§ä¸åŒæ•°æ®ç»“æ„çš„ä¼˜ç‚¹ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6a33584914c5e7460bb24.png\" alt=\"redisdictstructure.png\"></li>\n</ul>\n</li>\n<li>å­—å…¸æ˜¯æ€ä¹ˆæ‰©å®¹çš„ï¼Ÿå­—å…¸ç»“æ„å†…éƒ¨åŒ…å« ä¸¤ä¸ª hashtableï¼Œé€šå¸¸æƒ…å†µä¸‹åªæœ‰ä¸€ä¸ªå“ˆå¸Œè¡¨ ht[0] æœ‰å€¼ï¼Œåœ¨æ‰©å®¹çš„æ—¶å€™ï¼ŒæŠŠ ht[0]é‡Œçš„å€¼ rehash åˆ° ht[1]ï¼Œç„¶åè¿›è¡Œ æ¸è¿›å¼ rehash â€”â€”æŒ‡çš„æ˜¯è¿™ä¸ª rehash çš„åŠ¨ä½œå¹¶ä¸æ˜¯ä¸€æ¬¡æ€§ã€é›†ä¸­å¼åœ°å®Œæˆçš„ï¼Œè€Œæ˜¯åˆ†å¤šæ¬¡ã€æ¸è¿›å¼åœ°å®Œæˆçš„ã€‚å¾…æ¬è¿ç»“æŸåï¼Œh[1]å°±å–ä»£ h[0]å­˜å‚¨å­—å…¸çš„å…ƒç´ ã€‚</li>\n</ul>\n<h1>63. è·³è¡¨æ˜¯å¦‚ä½•å®ç°çš„ï¼ŸåŸç†ï¼Ÿ</h1>\n<ul>\n<li>\n<p>è·³è¡¨ï¼ˆskiplistï¼‰æ˜¯ä¸€ç§æœ‰åºçš„æ•°æ®ç»“æ„ï¼Œå®ƒé€šè¿‡åœ¨æ¯ä¸ªèŠ‚ç‚¹ä¸­ç»´æŒå¤šä¸ªæŒ‡å‘å…¶å®ƒèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œä»è€Œè¾¾åˆ°å¿«é€Ÿè®¿é—®èŠ‚ç‚¹çš„ç›®çš„ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a7951d9857a4280688544.png\" alt=\"redisskipliststructure.png\"></p>\n</li>\n<li>\n<p>ä¸ºä»€ä¹ˆä½¿ç”¨è·³è¡¨ï¼Ÿ</p>\n<ul>\n<li>é¦–å…ˆï¼Œå› ä¸º zset è¦æ”¯æŒéšæœºçš„æ’å…¥å’Œåˆ é™¤ï¼Œæ‰€ä»¥ä¸å®œä½¿ç”¨æ•°ç»„æ¥å®ç°ï¼Œå…³äºæ’åºé—®é¢˜ï¼Œä¸ºä»€ä¹ˆ Redis ä¸ä½¿ç”¨ çº¢é»‘æ ‘/ å¹³è¡¡æ ‘ è¿™æ ·çš„æ ‘å½¢ç»“æ„å‘¢ï¼Ÿ\n<ul>\n<li>æ€§èƒ½è€ƒè™‘ï¼š åœ¨é«˜å¹¶å‘çš„æƒ…å†µä¸‹ï¼Œæ ‘å½¢ç»“æ„éœ€è¦æ‰§è¡Œä¸€äº›ç±»ä¼¼äº rebalance è¿™æ ·çš„å¯èƒ½æ¶‰åŠæ•´æ£µæ ‘çš„æ“ä½œï¼Œç›¸å¯¹æ¥è¯´è·³è·ƒè¡¨çš„å˜åŒ–åªæ¶‰åŠå±€éƒ¨ï¼›</li>\n<li>å®ç°è€ƒè™‘ï¼š åœ¨å¤æ‚åº¦ä¸çº¢é»‘æ ‘ç›¸åŒçš„æƒ…å†µä¸‹ï¼Œè·³è·ƒè¡¨å®ç°èµ·æ¥æ›´ç®€å•ï¼Œçœ‹èµ·æ¥ä¹Ÿæ›´åŠ ç›´è§‚ï¼›</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>åŸºäºä»¥ä¸Šçš„ä¸€äº›è€ƒè™‘ï¼ŒRedis åŸºäº William Pugh çš„è®ºæ–‡åšå‡ºä¸€äº›æ”¹è¿›åé‡‡ç”¨äº† è·³è·ƒè¡¨ è¿™æ ·çš„ç»“æ„ã€‚æœ¬è´¨æ˜¯è§£å†³æŸ¥æ‰¾é—®é¢˜ã€‚</p>\n</li>\n<li>\n<p>è·³è·ƒè¡¨æ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</p>\n<ul>\n<li>å±‚:è·³è·ƒè¡¨èŠ‚ç‚¹çš„ level æ•°ç»„å¯ä»¥åŒ…å«å¤šä¸ªå…ƒç´ ï¼Œæ¯ä¸ªå…ƒç´ éƒ½åŒ…å«ä¸€ä¸ªæŒ‡å‘å…¶å®ƒèŠ‚ç‚¹çš„æŒ‡é’ˆï¼Œç¨‹åºå¯ä»¥é€šè¿‡è¿™äº›å±‚æ¥åŠ å¿«è®¿é—®å…¶å®ƒèŠ‚ç‚¹çš„é€Ÿåº¦ï¼Œä¸€èˆ¬æ¥è¯´ï¼Œå±‚çš„æ•°é‡æœˆå¤šï¼Œè®¿é—®å…¶å®ƒèŠ‚ç‚¹çš„é€Ÿåº¦å°±è¶Šå¿«ã€‚æ¯æ¬¡åˆ›å»ºä¸€ä¸ªæ–°çš„è·³è·ƒè¡¨èŠ‚ç‚¹çš„æ—¶å€™ï¼Œç¨‹åºéƒ½æ ¹æ®å¹‚æ¬¡å®šå¾‹ï¼Œéšæœºç”Ÿæˆä¸€ä¸ªä»‹äº 1 å’Œ 32 ä¹‹é—´çš„å€¼ä½œä¸º level æ•°ç»„çš„å¤§å°ï¼Œè¿™ä¸ªå¤§å°å°±æ˜¯å±‚çš„â€œé«˜åº¦â€</li>\n<li>å‰è¿›æŒ‡é’ˆ:æ¯ä¸ªå±‚éƒ½æœ‰ä¸€ä¸ªæŒ‡å‘è¡¨å°¾çš„å‰è¿›æŒ‡é’ˆï¼ˆlevel[i].forward å±æ€§ï¼‰ï¼Œç”¨äºä»è¡¨å¤´å‘è¡¨å°¾æ–¹å‘è®¿é—®èŠ‚ç‚¹ã€‚è·³è·ƒè¡¨ä»è¡¨å¤´åˆ°è¡¨å°¾ï¼Œéå†æ‰€æœ‰èŠ‚ç‚¹çš„è·¯å¾„ï¼š<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3136d8d54c55cc6c2f03e.png\" alt=\"redisskiplist2.png\"></li>\n<li>è·¨åº¦:å±‚çš„è·¨åº¦ç”¨äºè®°å½•ä¸¤ä¸ªèŠ‚ç‚¹ä¹‹é—´çš„è·ç¦»ã€‚è·¨åº¦æ˜¯ç”¨æ¥è®¡ç®—æ’ä½ï¼ˆrankï¼‰çš„ï¼šåœ¨æŸ¥æ‰¾æŸä¸ªèŠ‚ç‚¹çš„è¿‡ç¨‹ä¸­ï¼Œå°†æ²¿é€”è®¿é—®è¿‡çš„æ‰€æœ‰å±‚çš„è·¨åº¦ç´¯è®¡èµ·æ¥ï¼Œå¾—åˆ°çš„ç»“æœå°±æ˜¯ç›®æ ‡èŠ‚ç‚¹åœ¨è·³è·ƒè¡¨ä¸­çš„æ’ä½ã€‚ä¾‹å¦‚æŸ¥æ‰¾ï¼Œåˆ†å€¼ä¸º 3.0ã€æˆå‘˜å¯¹è±¡ä¸º o3 çš„èŠ‚ç‚¹æ—¶ï¼Œæ²¿é€”ç»å†çš„å±‚ï¼šæŸ¥æ‰¾çš„è¿‡ç¨‹åªç»è¿‡äº†ä¸€ä¸ªå±‚ï¼Œå¹¶ä¸”å±‚çš„è·¨åº¦ä¸º 3ï¼Œæ‰€ä»¥ç›®æ ‡èŠ‚ç‚¹åœ¨è·³è·ƒè¡¨ä¸­çš„æ’ä½ä¸º 3ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/98080a9ce2004af2da6e2.png\" alt=\"redisskiplist3.png\"></li>\n<li>åˆ†å€¼å’Œæˆå‘˜\n<ul>\n<li>èŠ‚ç‚¹çš„åˆ†å€¼ï¼ˆscore å±æ€§ï¼‰æ˜¯ä¸€ä¸ª double ç±»å‹çš„æµ®ç‚¹æ•°ï¼Œè·³è·ƒè¡¨ä¸­æ‰€æœ‰çš„èŠ‚ç‚¹éƒ½æŒ‰åˆ†å€¼ä»å°åˆ°å¤§æ¥æ’åºã€‚</li>\n<li>èŠ‚ç‚¹çš„æˆå‘˜å¯¹è±¡ï¼ˆobj å±æ€§ï¼‰æ˜¯ä¸€ä¸ªæŒ‡é’ˆï¼Œå®ƒæŒ‡å‘ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œè€Œå­—ç¬¦ä¸²å¯¹è±¡åˆ™ä¿å­˜è¿™ä¸€ä¸ª SDS å€¼ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>ä¸ºä»€ä¹ˆ hash è¡¨èŒƒå›´æŸ¥è¯¢æ•ˆç‡æ¯”è·³è¡¨ä½ï¼Ÿ</p>\n<ul>\n<li>å“ˆå¸Œè¡¨æ˜¯ä¸€ç§åŸºäºé”®å€¼å¯¹çš„æ•°æ®ç»“æ„ï¼Œä¸»è¦ç”¨äºå¿«é€ŸæŸ¥æ‰¾ã€æ’å…¥å’Œåˆ é™¤æ“ä½œã€‚å“ˆå¸Œè¡¨é€šè¿‡è®¡ç®—é”®çš„å“ˆå¸Œå€¼æ¥ç¡®å®šå€¼çš„å­˜å‚¨ä½ç½®ï¼Œè¿™ä½¿å¾—å®ƒåœ¨å•ä¸ªå…ƒç´ çš„è®¿é—®ä¸Šéå¸¸é«˜æ•ˆï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(1)ã€‚ç„¶è€Œï¼Œå“ˆå¸Œè¡¨å†…çš„å…ƒç´ æ˜¯æ— åºçš„ã€‚å› æ­¤ï¼Œå¯¹äºèŒƒå›´æŸ¥è¯¢ï¼ˆå¦‚æŸ¥æ‰¾æ‰€æœ‰åœ¨æŸä¸ªèŒƒå›´å†…çš„å…ƒç´ ï¼‰ï¼Œå“ˆå¸Œè¡¨æ— æ³•ç›´æ¥æ”¯æŒï¼Œå¿…é¡»éå†æ•´ä¸ªè¡¨æ¥æ£€æŸ¥å“ªäº›å…ƒç´ æ»¡è¶³æ¡ä»¶ï¼Œè¿™ä½¿å¾—å…¶åœ¨èŒƒå›´æŸ¥è¯¢ä¸Šçš„æ•ˆç‡ä½ä¸‹ï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(n)ã€‚</li>\n<li>è·³è¡¨æ˜¯ä¸€ç§æœ‰åºçš„æ•°æ®ç»“æ„ï¼Œèƒ½å¤Ÿä¿æŒå…ƒç´ çš„æ’åºé¡ºåºã€‚å®ƒé€šè¿‡å¤šå±‚çš„é“¾è¡¨ç»“æ„å®ç°å¿«é€Ÿçš„æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œï¼Œå…¶ä¸­æ¯ä¸€å±‚éƒ½æ˜¯ä¸‹ä¸€å±‚çš„ä¸€ä¸ªå­é›†ï¼Œå¹¶ä¸”å…ƒç´ åœ¨æ¯ä¸€å±‚éƒ½æ˜¯æœ‰åºçš„ã€‚å½“è¿›è¡ŒèŒƒå›´æŸ¥è¯¢æ—¶ï¼Œè·³è¡¨å¯ä»¥ä»æœ€é«˜å±‚å¼€å§‹ï¼Œå¿«é€Ÿå®šä½åˆ°èŒƒå›´çš„èµ·å§‹ç‚¹ï¼Œç„¶åæ²¿ç€ä¸‹ä¸€å±‚ç»§ç»­ç›´åˆ°æ‰¾åˆ°èŒƒå›´çš„ç»“æŸç‚¹ã€‚è¿™ç§åˆ†å±‚çš„ç»“æ„ä½¿å¾—è·³è¡¨åœ¨è¿›è¡ŒèŒƒå›´æŸ¥è¯¢æ—¶éå¸¸é«˜æ•ˆï¼Œæ—¶é—´å¤æ‚åº¦ä¸º O(log n) åŠ ä¸ŠèŒƒå›´å†…å…ƒç´ çš„æ•°é‡ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>64. å‹ç¼©åˆ—è¡¨äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>å‹ç¼©åˆ—è¡¨æ˜¯ Redis ä¸ºäº†èŠ‚çº¦å†…å­˜ è€Œä½¿ç”¨çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œæ˜¯ç”±ä¸€ç³»åˆ—ç‰¹æ®Šç¼–ç çš„è¿ç»­å†…å­˜å¿«ç»„æˆçš„é¡ºåºå‹æ•°æ®ç»“æ„ã€‚</li>\n<li>ä¸€ä¸ªå‹ç¼©åˆ—è¡¨å¯ä»¥åŒ…å«ä»»æ„å¤šä¸ªèŠ‚ç‚¹ï¼ˆentryï¼‰ï¼Œæ¯ä¸ªèŠ‚ç‚¹å¯ä»¥ä¿å­˜ä¸€ä¸ªå­—èŠ‚æ•°ç»„æˆ–è€…ä¸€ä¸ªæ•´æ•°å€¼ã€‚</li>\n<li>å‹ç¼©åˆ—è¡¨ç”±è¿™ä¹ˆå‡ éƒ¨åˆ†ç»„æˆï¼š\n<ul>\n<li>zlbyttes:è®°å½•æ•´ä¸ªå‹ç¼©åˆ—è¡¨å ç”¨çš„å†…å­˜å­—èŠ‚æ•°</li>\n<li>zltail:è®°å½•å‹ç¼©åˆ—è¡¨è¡¨å°¾èŠ‚ç‚¹è·ç¦»å‹ç¼©åˆ—è¡¨çš„èµ·å§‹åœ°å€æœ‰å¤šå°‘å­—èŠ‚</li>\n<li>zllen:è®°å½•å‹ç¼©åˆ—è¡¨åŒ…å«çš„èŠ‚ç‚¹æ•°é‡</li>\n<li>entryX:åˆ—è¡¨èŠ‚ç‚¹</li>\n<li>zlend:ç”¨äºæ ‡è®°å‹ç¼©åˆ—è¡¨çš„æœ«ç«¯</li>\n</ul>\n</li>\n</ul>\n<h1>65. å¿«é€Ÿåˆ—è¡¨ quicklist äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>Redis æ—©æœŸç‰ˆæœ¬å­˜å‚¨ list åˆ—è¡¨æ•°æ®ç»“æ„ä½¿ç”¨çš„æ˜¯å‹ç¼©åˆ—è¡¨ ziplist å’Œæ™®é€šçš„åŒå‘é“¾è¡¨ linkedlistï¼Œä¹Ÿå°±æ˜¯è¯´å½“å…ƒç´ å°‘æ—¶ä½¿ç”¨ ziplistï¼Œå½“å…ƒç´ å¤šæ—¶ç”¨ linkedlistã€‚ä½†è€ƒè™‘åˆ°é“¾è¡¨çš„é™„åŠ ç©ºé—´ç›¸å¯¹è¾ƒé«˜ï¼Œprev å’Œ next æŒ‡é’ˆå°±è¦å å» 16 ä¸ªå­—èŠ‚ï¼ˆ64 ä½æ“ä½œç³»ç»Ÿå ç”¨ 8 ä¸ªå­—èŠ‚ï¼‰ï¼Œå¦å¤–æ¯ä¸ªèŠ‚ç‚¹çš„å†…å­˜éƒ½æ˜¯å•ç‹¬åˆ†é…ï¼Œä¼šå®¶å…·å†…å­˜çš„ç¢ç‰‡åŒ–ï¼Œå½±å“å†…å­˜ç®¡ç†æ•ˆç‡ã€‚</li>\n<li>åæ¥ Redis æ–°ç‰ˆæœ¬ï¼ˆ3.2ï¼‰å¯¹åˆ—è¡¨æ•°æ®ç»“æ„è¿›è¡Œäº†æ”¹é€ ï¼Œä½¿ç”¨ quicklist ä»£æ›¿äº† ziplist å’Œ linkedlistï¼Œquicklist æ˜¯ç»¼åˆè€ƒè™‘äº†æ—¶é—´æ•ˆç‡ä¸ç©ºé—´æ•ˆç‡å¼•å…¥çš„æ–°å‹æ•°æ®ç»“æ„ã€‚</li>\n<li>quicklist ç”± list å’Œ ziplist ç»“åˆè€Œæˆï¼Œå®ƒæ˜¯ä¸€ä¸ªç”± ziplist å……å½“èŠ‚ç‚¹çš„åŒå‘é“¾è¡¨ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e75ae267da34aae84f393.png\" alt=\"redisquicklist.png\"></li>\n</ul>\n<h1>66. å‡å¦‚ Redis é‡Œé¢æœ‰ 1 äº¿ä¸ª keyï¼Œå…¶ä¸­æœ‰ 10w ä¸ª key æ˜¯ä»¥æŸä¸ªå›ºå®šçš„å·²çŸ¥çš„å‰ç¼€å¼€å¤´çš„ï¼Œå¦‚ä½•å°†å®ƒä»¬å…¨éƒ¨æ‰¾å‡ºæ¥ï¼Ÿ</h1>\n<ul>\n<li>keysæŒ‡ä»¤å¯ä»¥æ‰«å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ï¼ˆkeys xxx*ï¼‰ä½†ä¼šå¯¼è‡´çº¿ç¨‹é˜»å¡ï¼Œçº¿ä¸ŠæœåŠ¡ä¼šåœé¡¿ï¼Œç›´åˆ°æŒ‡ä»¤æ‰§è¡Œå®Œæ¯•ï¼ŒæœåŠ¡æ‰æ¢å¤ã€‚</li>\n<li>ä½¿ç”¨scanæŒ‡ä»¤æ— é˜»å¡çš„æå–å‡ºæŒ‡å®šæ¨¡å¼çš„keyåˆ—è¡¨ï¼Œä½†å¯èƒ½é‡å¤ï¼Œåœ¨å®¢æˆ·ç«¯åšå»é‡å°±å¯ä»¥äº†ï¼Œä½†æ˜¯æ•´ä½“æ‰€èŠ±è´¹çš„æ—¶é—´ä¼šæ¯”ç›´æ¥ç”¨ keysæŒ‡ä»¤é•¿ã€‚(scan 0 match \"api_<em>\"...-&gt;scan 100 match \"api_</em>\")ä¸€ç›´åˆ°cursorä¸º0</li>\n</ul>\n<p>==========================================================================================================</p>\n<h1>67. AOFå®ç°åŸç†ï¼Ÿæ··åˆæ¨¡å¼ä¸‹ä»€ä¹ˆæ—¶å€™aofï¼Œä»€ä¹ˆæ—¶å€™rdbâˆš?</h1>\n<ul>\n<li>\n<p>AOFä»¥åè®®æ–‡æœ¬çš„æ–¹å¼ï¼Œå°†æ‰€æœ‰å¯¹æ•°æ®åº“è¿›è¡Œè¿‡å†™å…¥çš„å‘½ä»¤ï¼ˆåŠå…¶å‚æ•°ï¼‰è®°å½•åˆ°AOFæ–‡ä»¶</p>\n</li>\n<li>\n<p>aofè¿‡ç¨‹ï¼šå°†å†™æ“ä½œå‘½ä»¤ä¿å­˜åˆ°AOFæ–‡ä»¶çš„è¿‡ç¨‹ç§°ä¸ºåŒæ­¥ï¼Œåˆ™åŒ…æ‹¬ä¸‹é¢ä¸‰ä¸ªæ­¥éª¤</p>\n<ul>\n<li>å‘½ä»¤ä¼ æ’­ï¼šæœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æœç«¯å‘é€çš„åè®®æ–‡æœ¬ï¼Œè½¬æ¢æˆæ‰§è¡Œå‘½ä»¤æ•°æ®ï¼ŒRediså°†æ‰§è¡Œå®Œçš„å‘½ä»¤ã€å‘½ä»¤çš„å‚æ•°ã€å‘½ä»¤çš„å‚æ•°ä¸ªæ•°ç­‰ä¿¡æ¯å‘é€åˆ°AOFç¨‹åºä¸­ã€‚</li>\n<li>ç¼“å­˜è¿½åŠ ï¼šAOFç¨‹åºæ ¹æ®æ¥æ”¶åˆ°çš„å‘½ä»¤æ•°æ®ï¼Œå°†å‘½ä»¤è½¬æ¢ä¸ºç½‘ç»œé€šè®¯åè®®çš„æ ¼å¼ï¼Œç„¶åå°†åè®®å†…å®¹è¿½åŠ åˆ°æœåŠ¡å™¨çš„AOFç¼“å­˜ï¼ˆredis.h/redisServerç»“æ„çš„aof_bufï¼‰ä¸­ã€‚</li>\n<li>æ–‡ä»¶å†™å…¥å’Œä¿å­˜ï¼šè°ƒç”¨aof.c/flushAppendOnlyFileå‡½æ•°ï¼Œåˆ©ç”¨SAVEæ–¹æ³•å°†AOFç¼“å­˜ä¸­çš„å†…å®¹å†™å…¥åˆ°AOFæ–‡ä»¶æœ«å°¾ï¼›å¦‚æœæ»¡è¶³ä¿å­˜æ¡ä»¶ï¼Œè°ƒç”¨fsyncæˆ–fdatasyncå‡½æ•°ï¼Œå°†å†™å…¥çš„å†…å®¹çœŸæ­£åœ°ä¿å­˜Såˆ°ç£ç›˜ä¸­</li>\n</ul>\n</li>\n<li>\n<p>aofä¿å­˜æ¨¡å¼ï¼šå†³å®šflushAppendOnlyFileå‡½æ•°çš„WRITEå’ŒSAVEçš„è°ƒç”¨æ¡ä»¶</p>\n<ul>\n<li>AOF_FSYNC_NOï¼šä¸ä¿å­˜ã€‚WRITEç”±ä¸»çº¿ç¨‹æ‰§è¡Œï¼Œé˜»å¡ä¸»è¿›ç¨‹ï¼Œä¸æ‰§è¡ŒSAVEï¼›SAVEåªä¼šåœ¨Redisè¢«å…³é—­ã€AOFåŠŸèƒ½è¢«å…³é—­ã€ç³»ç»Ÿçš„å†™ç¼“å­˜è¢«åˆ·æ–°ï¼ˆå¯èƒ½æ˜¯ç¼“å­˜å·²ç»è¢«å†™æ»¡ï¼Œæˆ–è€…å®šæœŸä¿å­˜æ“ä½œè¢«æ‰§è¡Œï¼‰æ‰§è¡Œ</li>\n<li>AOF_FSYNC_ALWAYSï¼šæ¯æ¬¡æ‰§è¡Œå®Œå‘½ä»¤ï¼ŒSAVEå’ŒWRITEéƒ½ç”±ä¸»è¿›ç¨‹æ‰§è¡Œï¼Œé˜»å¡ä¸»è¿›ç¨‹ã€‚æ•ˆç‡æœ€ä½</li>\n<li>AOF_FSYNC_EVERYSECï¼šæ¯ç§’é’Ÿä¿å­˜ä¸€æ¬¡ã€‚WRITEç”±ä¸»è¿›ç¨‹æ‰§è¡Œï¼Œé˜»å¡ä¸»è¿›ç¨‹ã€‚SAVEç”±å­çº¿ç¨‹æ‰§è¡Œï¼Œä¸é˜»å¡ä¸»è¿›ç¨‹ï¼Œä½†ä¿å­˜æ“ä½œå®Œæˆçš„å¿«æ…¢ä¼šå½±å“å†™å…¥æ“ä½œçš„é˜»å¡æ—¶é•¿ã€‚æ³¨æ„ï¼Œå®é™…ç¨‹åºåœ¨è¿™ç§æ¨¡å¼ä¸‹å¯¹fsyncæˆ–fdatasyncçš„è°ƒç”¨å¹¶ä¸æ˜¯æ¯ç§’ä¸€æ¬¡ï¼Œå®ƒå’Œè°ƒç”¨flushAppendOnlyFileå‡½æ•°æ—¶Redisæ‰€å¤„çš„çŠ¶æ€æœ‰å…³ã€‚å¯èƒ½ä¼šå‡ºç°ä»¥ä¸‹å››ç§æƒ…å†µï¼šå¦‚æœåœ¨æƒ…å†µ1ä¸­å‘ç”Ÿæ•…éšœåœæœºï¼Œ ç”¨æˆ·æŸå¤±å°äº2ç§’å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æ•°æ®ã€‚å¦‚æœåœ¨æƒ…å†µ2å‘ç”Ÿæ•…éšœåœæœºï¼Œ é‚£ä¹ˆç”¨æˆ·æŸå¤±çš„æ•°æ®æ˜¯å¯ä»¥è¶…è¿‡2ç§’çš„ã€‚AOFåœ¨å®˜ç½‘â€œæ¯ä¸€ç§’é’Ÿä¿å­˜ä¸€æ¬¡â€æ—¶å‘ç”Ÿæ•…éšœï¼Œ åªä¸¢å¤±1ç§’é’Ÿæ•°æ®çš„è¯´æ³•ï¼Œ å®é™…ä¸Šå¹¶ä¸å‡†ç¡®<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d2657edd4a6537c3fa680.png\" alt=\"aofsavemodel.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/aec14a48266b109e90cbd.png\" alt=\"aofsavemodelcompare.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>68. redisä¼˜ç¼ºç‚¹ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ä¼˜ç‚¹</p>\n<ul>\n<li>é€Ÿåº¦å¿«ï¼šå› ä¸ºæ•°æ®å­˜åœ¨å†…å­˜ä¸­</li>\n<li>æ”¯æŒä¸°å¯Œæ•°æ®ç±»å‹Stringï¼ŒListï¼ŒSetï¼ŒSorted Setï¼ŒHash äº”ç§åŸºç¡€çš„æ•°æ®ç»“æ„ã€‚å•ä¸ªValueæœ€å¤§é™åˆ¶æ˜¯1GBï¼Œè¿˜æä¾›Bitmapã€HyperLogLogã€GEO ç­‰é«˜çº§çš„æ•°æ®ç»“æ„</li>\n<li>ä¸°å¯Œçš„ç‰¹æ€§ï¼šè®¢é˜…å‘å¸ƒPub/SubåŠŸèƒ½ï¼›Keyè¿‡æœŸç­–ç•¥ï¼›äº‹åŠ¡ï¼›æ”¯æŒå¤šä¸ªDBï¼›è®¡æ•°ï¼›StreamåŠŸèƒ½ï¼Œæ”¯æŒå¤šæ’­çš„å¯æŒä¹…åŒ–çš„æ¶ˆæ¯é˜Ÿåˆ—ï¼Œæä¾›ç±»ä¼¼Kafkaçš„åŠŸèƒ½</li>\n<li>æŒä¹…åŒ–å­˜å‚¨ï¼šæä¾›RDBå’ŒAOFä¸¤ç§æ•°æ®çš„æŒä¹…åŒ–å­˜å‚¨æ–¹æ¡ˆï¼Œè§£å†³å†…å­˜æ•°æ®åº“æ•°æ®ä¸¢å¤±é—®é¢˜</li>\n<li>é«˜å¯ç”¨ï¼šå†…ç½®Redis Sentinelæä¾›é«˜å¯ç”¨æ–¹æ¡ˆï¼Œå®ç°ä¸»ä»æ•…éšœè‡ªåŠ¨è½¬ç§»ã€‚å†…ç½®Redis Clusteræä¾›é›†ç¾¤æ–¹æ¡ˆï¼Œå®ç°åŸºäºæ§½çš„åˆ†ç‰‡æ–¹æ¡ˆï¼Œä»è€Œæ”¯æŒæ›´å¤§çš„Redisè§„æ¨¡</li>\n</ul>\n</li>\n<li>\n<p>ç¼ºç‚¹</p>\n<ul>\n<li>Rediså•å°æœºå™¨å­˜å‚¨çš„æ•°æ®é‡ï¼Œå—é™äºæœºå™¨æœ¬èº«çš„å†…å­˜å¤§å°ã€‚è™½ç„¶æœ‰Keyè¿‡æœŸç­–ç•¥ï¼Œä½†æ˜¯è¿˜æ˜¯è¦é¢„ä¼°å’ŒèŠ‚çº¦å†…å­˜ã€‚å¦‚æœå†…å­˜å¢é•¿è¿‡å¿«ï¼Œéœ€è¦å®šæœŸåˆ é™¤æ•°æ®ã€‚å¯ç”¨Redis Clusterã€Codisç­‰æ–¹æ¡ˆè¿›è¡Œåˆ†åŒºï¼Œä»å•æœºRediså˜æˆé›†ç¾¤Redis</li>\n<li>å¦‚æœè¿›è¡Œå®Œæ•´é‡åŒæ­¥ï¼Œéœ€è¦ç”ŸæˆRDBæ–‡ä»¶å’Œä¼ è¾“ï¼Œä¼šå ç”¨ä¸»æœºçš„ CPU ï¼Œå¹¶ä¼šæ¶ˆè€—ç°ç½‘çš„å¸¦å®½ã€‚</li>\n<li>ä¿®æ”¹é…ç½®æ–‡ä»¶é‡å¯ï¼Œæ—¶é—´æ¯”è¾ƒä¹…ã€‚åœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼ŒRedis ä¸èƒ½æä¾›æœåŠ¡ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>69. Redis ä¸é€‚åˆçš„åœºæ™¯ï¼Ÿ</h1>\n<ul>\n<li>æ•°æ®é‡å¤ªå¤§ã€æ•°æ®è®¿é—®é¢‘ç‡éå¸¸ä½çš„ä¸šåŠ¡ï¼Œæ•°æ®å¤ªå¤§ä¼šå¢åŠ æˆæœ¬ï¼Œè®¿é—®é¢‘ç‡å¤ªä½ï¼Œä¿å­˜åœ¨å†…å­˜ä¸­çº¯å±æµªè´¹èµ„æºã€‚</li>\n</ul>\n<h1>73. listç±»å‹åº•å±‚æ•°æ®ç»“æ„ï¼Ÿ</h1>\n<ul>\n<li>\n<p>åº•å±‚ç»“æ„ï¼šquickListåŒé“¾è¡¨ç»“æ„ï¼Œæ¯ä¸ªåŒé“¾è¡¨èŠ‚ç‚¹ä¸­ä¿å­˜ä¸€ä¸ªziplistï¼Œæ¯ä¸ªziplistä¸­å­˜ä¸€æ‰¹listä¸­çš„æ•°æ®ï¼Œæ—¢é¿å…å¤§é‡é“¾è¡¨æŒ‡é’ˆå¸¦æ¥çš„å†…å­˜æ¶ˆè€—ï¼Œä¹Ÿå¯é¿å…ziplistæ›´æ–°å¯¼è‡´çš„å¤§é‡æ€§èƒ½æŸè€—<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/71b6924cc20e198b2aebc.png\" alt=\"quicklist.png\"></p>\n</li>\n<li>\n<p>ziplistä¸linkedlistä¼˜ç¼ºç‚¹å¯¹æ¯”ï¼š</p>\n<ul>\n<li>ä¸¤ç«¯è¿›è¡Œpushå’Œpopæ“ä½œæ—¶é—´å¤æ‚åº¦éƒ½æ˜¯O(1)</li>\n<li>åŒå‘é“¾è¡¨linkedlistå†…å­˜å¼€é”€æ¯”è¾ƒå¤§ã€‚æ¯ä¸ªèŠ‚ç‚¹ä¸Šé™¤äº†è¦ä¿å­˜æ•°æ®ä¹‹å¤–ï¼Œè¿˜è¦é¢å¤–ä¿å­˜ä¸¤ä¸ªæŒ‡é’ˆï¼›å…¶æ¬¡ï¼ŒåŒå‘é“¾è¡¨çš„å„ä¸ªèŠ‚ç‚¹æ˜¯å•ç‹¬çš„å†…å­˜å—ï¼Œåœ°å€ä¸è¿ç»­ï¼ŒèŠ‚ç‚¹å¤šäº†å®¹æ˜“äº§ç”Ÿå†…å­˜ç¢ç‰‡ã€‚</li>\n<li>ziplistå­˜å‚¨ä¸Šä¸€ä¸ªentryçš„é•¿åº¦å’Œå½“å‰entryçš„é•¿åº¦ï¼Œé€šè¿‡é•¿åº¦æ¨ç®—ä¸‹ä¸€ä¸ªå…ƒç´ åœ¨ä»€ä¹ˆåœ°æ–¹ï¼Œä½¿ç”¨è¿ç»­çš„å†…å­˜å—ï¼Œå­˜å‚¨æ•ˆç‡å¾ˆé«˜ã€‚ä½†æ˜¯æ’å…¥å’Œåˆ é™¤æ“ä½œéœ€è¦ç”³è¯·å’Œé‡Šæ”¾å†…å­˜(é‡æ–°ç”Ÿæˆä¸€ä¸ªæ–°çš„ziplistæ¥ä½œä¸ºæ›´æ–°åçš„list)ã€‚å¯èƒ½ä¼šå¯¼è‡´å¤§æ‰¹é‡çš„æ•°æ®æ‹·è´ã€‚é€‚åˆæ¯ä¸ªåˆ—è¡¨é¡¹è¦ä¹ˆå°±æ˜¯å°æ•´æ•°å€¼ï¼Œè¦ä¹ˆå°±æ˜¯é•¿åº¦æ¯”è¾ƒçŸ­çš„å­—ç¬¦ä¸²çš„åœºæ™¯</li>\n</ul>\n</li>\n<li>\n<p>å½“åˆ—è¡¨å¯¹è±¡ä¿å­˜çš„æ‰€æœ‰å­—ç¬¦ä¸²å…ƒç´ çš„é•¿åº¦éƒ½å°äº64å­—èŠ‚ä¸”å…ƒç´ æ•°é‡å°äº512ä¸ªæ—¶ä½¿ç”¨ziplistï¼Œå¦åˆ™ä½¿ç”¨linkedlist</p>\n</li>\n<li>\n<p>ziplistç»“æ„åŠéå†è¿‡ç¨‹<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7a043efdfeb556b9b5ce0.png\" alt=\"ziplist.jpg\"></p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>- ä»å‰å‘åéå†æ—¶ï¼Œç¨‹åºä»æŒ‡å‘èŠ‚ç‚¹e1çš„æŒ‡é’ˆpå¼€å§‹ï¼Œè®¡ç®—èŠ‚ç‚¹e1çš„é•¿åº¦ï¼ˆe1-sizeï¼‰ï¼Œ ç„¶åå°†påŠ ä¸Š e1-size ï¼Œå°±å°†æŒ‡é’ˆåç§»åˆ°äº†ä¸‹ä¸€ä¸ªèŠ‚ç‚¹e2 ...å¦‚æ­¤åå¤ï¼Œç›´åˆ°pé‡åˆ°ZIPLIST_ENTRY_ENDä¸ºæ­¢\n                              p + e1-size + e2-size\n                 p + e1-size     |\n           p          |          |\n           |          |          |\n           V          V          V\n+</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/1e419b34a2ddcd1e552d4.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "åœºæ™¯è®¾è®¡",
      "url": "https://javaguide.cn/interview/scenedesign.html",
      "id": "https://javaguide.cn/interview/scenedesign.html",
      "summary": "1. æ”¯ä»˜ç³»ç»Ÿè®¾è®¡ 1.1. æ”¯ä»˜ç³»ç»Ÿæ¶æ„å›¾ payprocess.pngpayprocess.png 1.2. å•†æˆ·ç³»ç»Ÿè®¾è®¡ ä¸‹å•æ—¶éœ€è¦åŒæ—¶æ’å…¥éœ€è¦åšçš„è®°å½•å’ŒçŠ¶æ€ï¼Œæ¯”å¦‚æŠ¥åæ´»åŠ¨ä¸‹å•æ—¶æ˜¯delete=1ï¼Œå›è°ƒæˆåŠŸåˆ™å˜æˆdelete=1ï¼Œè€Œä¸æ˜¯æˆåŠŸå›è°ƒæ‰æ’å…¥ ä¸‹å•æ—¶æäº¤é¢å¤–å‚æ•°æœ€å¥½æ˜¯idï¼Œå›è°ƒçš„æ—¶å€™æ ¹æ®idä¿®æ”¹è®¢å•å’Œè®°å½•çš„çŠ¶æ€delete=0 æ”¯ä»˜åæœ€å…ˆ...",
      "content_html": "<!-- more -->\n<!-- TOC -->\n<!-- TOC -->\n<h1>1. æ”¯ä»˜ç³»ç»Ÿè®¾è®¡</h1>\n<h2>1.1. æ”¯ä»˜ç³»ç»Ÿæ¶æ„å›¾</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d4a02ad890b4cf42ab109.png\" alt=\"payprocess.png\" tabindex=\"0\"><figcaption>payprocess.png</figcaption></figure>\n<h2>1.2. å•†æˆ·ç³»ç»Ÿè®¾è®¡</h2>\n<ul>\n<li>ä¸‹å•æ—¶éœ€è¦åŒæ—¶æ’å…¥éœ€è¦åšçš„è®°å½•å’ŒçŠ¶æ€ï¼Œæ¯”å¦‚æŠ¥åæ´»åŠ¨ä¸‹å•æ—¶æ˜¯delete=1ï¼Œå›è°ƒæˆåŠŸåˆ™å˜æˆdelete=1ï¼Œè€Œä¸æ˜¯æˆåŠŸå›è°ƒæ‰æ’å…¥</li>\n<li>ä¸‹å•æ—¶æäº¤é¢å¤–å‚æ•°æœ€å¥½æ˜¯idï¼Œå›è°ƒçš„æ—¶å€™æ ¹æ®idä¿®æ”¹è®¢å•å’Œè®°å½•çš„çŠ¶æ€delete=0</li>\n<li>æ”¯ä»˜åæœ€å…ˆåˆ¤æ–­è®¢å•æ˜¯å¦å·²ç»å¤„ç†ï¼Œä¿æŒå¹‚ç­‰æ€§</li>\n<li>æ”¶å…¥è®¢å•å’Œæ”¯å‡ºè®¢å•å‰ç¼€ä¸è¦ä¸€æ ·</li>\n<li>æ¶‰åŠæ”¯ä»˜å›è°ƒæˆ–è€…é˜»å¡éƒ½æ˜¯å…ˆè®¾ç½®statusä¸º0çš„çŠ¶æ€çš„è®°å½•å¹¶æäº¤äº‹åŠ¡ï¼Œç„¶åè°ƒç”¨ä»–ä»¬çš„æ¥å£å›å¡«statusçš„çŠ¶æ€</li>\n</ul>\n<h2>1.3. å‘èµ·ä¸‹å•ç½‘ç»œè°ƒç”¨è¶…æ—¶è®¢å•è¡¨ä¼šä¿å­˜ä¹ˆï¼Ÿ</h2>\n<ul>\n<li>åˆ†åœºæ™¯</li>\n<li>å¦‚æœæ˜¯æ²¡æœ‰é¢å¤–æˆæœ¬ï¼Œæ¯”å¦‚ç”¨æˆ·æ”¯ä»˜åˆ°ä¼ä¸šä¸”ä»·æ ¼ä¸ä¼šå˜ï¼Œåˆ™ä¸éœ€è¦è®°å½•ï¼Œç„¶åç›´æ¥æé†’å¤±è´¥äº‹åŠ¡å›æ»šæç¤ºå‰ç«¯ï¼Œè®©ç”¨æˆ·å†æ¬¡å‘èµ·</li>\n<li>å¦‚æœæœ‰é¢å¤–æˆæœ¬ï¼Œæ¯”å¦‚ä¼ä¸šæ”¯ä»˜åˆ°ç”¨æˆ·ï¼Œé‚£ä¹ˆéœ€è¦è®°å½•ï¼Œå¹¶ä¸”éœ€è¦å»¶æ—¶æ¶ˆæ¯å»è¡¥å¿å’Œé‡è¯•ï¼Œæœ€åå°†ç»“æœé€šçŸ¥ç”¨æˆ·</li>\n</ul>\n<h2>1.4. å…ˆå‘èµ·ä¸‹å•å†ä¿å­˜æ•°æ®åº“è¿˜æ˜¯ç›¸åï¼Ÿ</h2>\n<ul>\n<li>å‰è€…å¯ä»¥å†å¼‚å¸¸çŠ¶å†µä¸‹æ¯”å¦‚è¶…æ—¶ä¸ç”¨å†ä¿®æ”¹ä¸€æ¬¡è®¢å•çŠ¶æ€ï¼Œä½†å¯èƒ½äº‹åŠ¡æ¯”è¾ƒé•¿ï¼Œåè€…äº‹åŠ¡çŸ­ä½†æ˜¯å¼‚å¸¸éœ€è¦ä¿®æ”¹è®¢å•çŠ¶æ€</li>\n</ul>\n<h2>1.5. å¦‚ä½•é˜²æ­¢é‡å¤æ”¯ä»˜ï¼Ÿ</h2>\n<ul>\n<li>ä½¿ç”¨åˆ†å¸ƒå¼é”ä¿è¯ï¼ŒæŸ¥è¯¢æ˜¯å¦å·²ç»æŠ¥åï¼ŒæŸ¥è¯¢æ˜¯å¦æ­£åœ¨æ”¯ä»˜</li>\n</ul>\n<h2>1.6. è°ƒç”¨ç¬¬ä¸‰æ–¹é“¶è¡Œæ¥å£æ€ä¹ˆä¿è¯ä¸è¶…è¿‡é“¶è¡Œçš„qpsï¼Ÿ</h2>\n<ul>\n<li>ç§¯å‹åˆ°rocketmqæµé‡å‰Šå³°</li>\n<li>é™æµ</li>\n</ul>\n<h2>1.7. å›è°ƒæ²¡æ”¶åˆ°æ€ä¹ˆåŠï¼Ÿæ‰å•</h2>\n<ul>\n<li>é‡‡ç”¨å¼‚æ­¥è¡¥å¿æ–¹æ¡ˆ\n<ul>\n<li>å®šæ—¶è½®è¯¢:\n<ul>\n<li>ç¬¬ä¸‰æ­¥è°ƒç”¨æ”¯ä»˜é€šé“ä¹‹åï¼Œå¦‚æœæ”¯ä»˜é€šé“ç«¯è¿”å›æ”¯ä»˜å—ç†æˆåŠŸæˆ–è€…æ”¯ä»˜å¤„ç†ä¸­ï¼Œå°†è°ƒç”¨ç¬¬å››æ­¥ã€‚å°†è¿™ç±»è®¢å•æ’å…¥æ‰å•è¡¨ã€‚</li>\n<li>ç¬¬äº”æ­¥ï¼Œè¡¥å•åº”ç”¨å°†ä¼šå®šæ—¶æŸ¥è¯¢æ•°æ®åº“ï¼Œæ‰¹é‡æŸ¥è¯¢æ‰å•è®°å½•ã€‚</li>\n<li>ç¬¬å…­æ­¥ï¼Œè¡¥å•åº”ç”¨ä½¿ç”¨çº¿ç¨‹æ± ï¼Œå¤šçº¿ç¨‹å¼‚æ­¥çš„æ–¹å¼å‘èµ·æ‰å•æŸ¥è¯¢</li>\n<li>ç¬¬ä¸ƒæ­¥ï¼Œè°ƒç”¨æ”¯ä»˜é€šé“æ”¯ä»˜æŸ¥è¯¢æ¥å£ã€‚</li>\n<li>å¦‚æœç¬¬ä¸ƒæ­¥æ”¯ä»˜ç»“æœæŸ¥è¯¢ä¸ºä»¥ä¸‹çŠ¶æ€:æ”¯ä»˜ç»“æœä¸ºæ‰£æ¬¾æˆåŠŸã€æ˜ç¡®å¤±è´¥ã€æ‰å•è®°å½•æŸ¥è¯¢è¾¾åˆ°æœ€å¤§æ¬¡æ•°ï¼Œç¬¬å…«æ­¥å°±ä¼šåˆ é™¤æ‰å•è®°å½•ã€‚</li>\n<li>æœ€åï¼Œå¦‚æœæ‰å•æŸ¥è¯¢ä¾æ—§è¿˜æ˜¯å¤„ç†ä¸­ï¼Œé‚£ä¹ˆç»è¿‡ä¸€å®šçš„å»¶æ—¶ä¹‹åï¼Œé‡å¤ç¬¬äº”æ­¥ï¼Œå†æ¬¡é‡æ–°æ‰å•è¡¥å¿ï¼Œç›´åˆ°æˆåŠŸæˆ–è€…æŸ¥è¯¢åˆ°è¾¾æœ€å¤§æ¬¡æ•°ã€‚</li>\n</ul>\n</li>\n<li>é—®é¢˜ï¼šä¸ºä»€ä¹ˆéœ€è¦æ–°å»ºä¸€å¼ æ‰å•è¡¨?ä¸èƒ½ç›´æ¥ä½¿ç”¨æ”¯ä»˜è®¢å•è¡¨ï¼ŒæŸ¥è¯¢æœªæˆåŠŸçš„è®¢å•å—?ç¡®å®å¯ä»¥ç›´æ¥ä½¿ç”¨çš„æ”¯ä»˜è®¢å•è¡¨ï¼Œç„¶åæ‰¹é‡æŸ¥è¯¢å½“å¤©æœªæˆåŠŸçš„è®¢å•ï¼Œè¡¥å•ç¨‹åºå‘èµ·æ”¯ä»˜æŸ¥è¯¢ã€‚ä¸»è¦æ˜¯å› ä¸ºæ•°æ®åº“æŸ¥è¯¢æ•ˆç‡é—®é¢˜ï¼Œå› ä¸ºæ”¯ä»˜è®¢å•è¡¨æ¯å¤©éƒ½ä¼šå¤§é‡è®°å½•æ–°å¢ï¼Œéšç€æ—¶é—´ï¼Œè¿™å¼ è¡¨è®°å½•å°†ä¼šè¶Šæ¥è¶Šå¤šè¶Šæ¥è¶Šå¤§ã€‚æ”¯ä»˜è®°å½•è¶Šå¤šï¼Œæ‰¹é‡èŒƒå›´æŸ¥è¯¢æ•ˆç‡å°±ä¼šå˜ä½ï¼ŒæŸ¥è¯¢é€Ÿåº¦å°†ä¼šå˜æ…¢ã€‚æ‰€ä»¥ä¸ºäº†æŸ¥è¯¢æ•ˆç‡ï¼Œæ–°å»ºä¸€å¼ æ‰å•è¡¨ã€‚è¿™å¼ è¡¨é‡Œä»…è®°å½•æ”¯ä»˜æœªæˆåŠŸçš„è®¢å•ï¼Œæ‰€ä»¥æ•°æ®é‡å°±ä¼šå¾ˆå°ï¼Œé‚£ä¹ˆæŸ¥è¯¢æ•ˆç‡å°±ä¼šå¾ˆé«˜ã€‚å¦å¤–ï¼Œæ‰å•è¡¨é‡Œçš„è®°å½•ï¼Œä¸ä¼šè¢«æ°¸ä¹…ä¿å­˜ï¼Œåªæ˜¯ä¸´æ—¶æ€§ã€‚å½“æ”¯ä»˜ç»“æœæŸ¥è¯¢æˆåŠŸï¼Œæˆ–è€…æ”¯ä»˜ç»“æœæ˜ç¡®å¤±è´¥ï¼Œå†æˆ–è€…æŸ¥è¯¢æ¬¡æ•°åˆ°è¾¾è§„å®šæœ€å¤§æ¬¡æ•°ï¼Œå°±ä¼šåˆ é™¤æ‰å•è®°å½•ã€‚è¿™å°±æ˜¯ç¬¬å…«æ­¥ä¸ºä»€ä¹ˆéœ€è¦åˆ é™¤æ‰å•è¡¨çš„åŸå› ã€‚å¦‚æœéœ€è¦ä¿å­˜æ¯æ¬¡æ‰å•è¡¨æŸ¥è¯¢è¯¦æƒ…ï¼Œé‚£ä¹ˆè¿™é‡Œå»ºè®®å†æ–°å¢ä¸€å¼ æ‰å•æŸ¥è¯¢è®°å½•è¡¨ï¼Œä¿å­˜æ¯ä¸€æ¬¡çš„æŸ¥è¯¢è®°å½•,</li>\n<li>æ–¹æ¡ˆä¼˜ç¼ºç‚¹\n<ul>\n<li>ä¼˜ç‚¹æ˜¯ç³»ç»Ÿæ¶æ„æ–¹æ¡ˆæ¯”è¾ƒç®€å•ï¼Œæ¯”è¾ƒå®¹æ˜“å®æ–½ã€‚</li>\n<li>ç¼ºç‚¹ä¸»è¦åœ¨äºå®šæ—¶ä»»åŠ¡ä¸Šã€‚\n<ul>\n<li>1.è½®è¯¢æ•ˆç‡ç¨ä½</li>\n<li>2.æ¯æ¬¡æŸ¥è¯¢æ•°æ®åº“ï¼Œå·²ç»è¢«æ‰§è¡Œè¿‡è®°å½•ï¼Œä»ç„¶ä¼šè¢«æ‰«æ(è¡¥å•ç¨‹åºå°†ä¼šæ ¹æ®ä¸€å®šç­–ç•¥å†³å®šæ˜¯å¦å‘èµ·æ”¯ä»˜é€šé“æŸ¥è¯¢)ï¼Œæœ‰é‡å¤è®¡ç®—çš„å«Œç–‘</li>\n<li>3.æ—¶æ•ˆæ€§ä¸å¤Ÿå¥½ï¼Œå¦‚æœæ¯å°æ—¶è½®è¯¢ä¸€æ¬¡ï¼Œæœ€å·®çš„æƒ…å†µä¸‹ï¼Œæ—¶é—´è¯¯å·®ä¼šè¾¾åˆ°1å°æ—¶</li>\n<li>4.å¦‚æœä¸ºäº†è§£å†³æ—¶æ•ˆæ€§é—®é¢˜ï¼Œå¢åŠ å®šæ—¶ä»»åŠ¡æŸ¥è¯¢æ•ˆç‡ï¼Œé‚£ä¹ˆ1ä¸­æŸ¥è¯¢æ•ˆç‡è·Ÿ2 çš„é‡å¤è®¡ç®—é—®é¢˜å°†ä¼šæ›´åŠ æ˜æ˜¾<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4021f4a12d493c1a96e79.jpg\" alt=\"å®šæ—¶è½®è¯¢æ–¹æ¡ˆ.png\"></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å»¶è¿Ÿæ¶ˆæ¯\n<ul>\n<li>ç¬¬å››æ­¥çš„æµç¨‹ä»æ’å…¥æ‰å•è¡¨å˜æ›´ä¸ºå¾€å»¶è¿Ÿé˜Ÿåˆ—å‘é€æ‰å•æ¶ˆæ¯ã€‚</li>\n<li>ç¬¬äº”æ­¥ï¼Œè¡¥å•ç¨‹åºæ¥æ”¶æ‰å•æ¶ˆæ¯ï¼Œç„¶åè§¦å‘æ”¯ä»˜æ‰å•æŸ¥è¯¢</li>\n<li>ç¬¬å…«æ­¥ï¼Œå¦‚æœç¬¬ä¸ƒæ­¥æ”¯ä»˜ç»“æœæŸ¥è¯¢ä¸ºä»¥ä¸‹çŠ¶æ€:æ”¯ä»˜ç»“æœä¸ºæ‰£æ¬¾æˆåŠŸã€æ˜ç¡®å¤±è´¥ã€æ‰å•è®°å½•æŸ¥è¯¢è¾¾åˆ°æœ€å¤§æ¬¡æ•°ã€‚è¡¥å•ç¨‹åºå°†ä¼šå‘ŠçŸ¥å»¶è¿Ÿé˜Ÿåˆ—æ¶ˆè´¹æˆåŠŸï¼Œå»¶è¿Ÿé˜Ÿåˆ—å°†ä¼šåˆ é™¤è¿™æ¡æ‰å•æ¶ˆæ¯ã€‚å…¶ä»–çŠ¶æ€å°†ä¼šå‘ŠçŸ¥æ¶ˆè´¹å¤±æ•ˆï¼Œå»¶è¿Ÿé˜Ÿåˆ—å°†ä¼šåœ¨ä¸€å®šå»¶æ—¶ä¹‹åï¼Œå†æ¬¡å‘é€æ‰å•æ¶ˆæ¯ï¼Œç„¶åç»§ç»­é‡å¤ç¬¬äº”æ­¥</li>\n<li>å»¶æ—¶æ¶ˆæ¯å‚è€ƒä¸‹é¢30åˆ†é’Ÿå…³é—­è®¢å•<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f718d072b6567151798eb.jpg\" alt=\"å»¶è¿Ÿæ¶ˆæ¯æ–¹æ¡ˆ.png\"></li>\n</ul>\n</li>\n<li>å»¶è¿Ÿæ¶ˆæ¯çš„æ–¹æ¡ˆç›¸å¯¹äºå®šæ—¶è½®è¯¢æ–¹æ¡ˆæ¥è®²:\n<ul>\n<li>æ— éœ€å†æŸ¥è¯¢å…¨éƒ¨è®¢å•ï¼Œæ•ˆç‡é«˜</li>\n<li>æ—¶æ•ˆæ€§è¾ƒå¥½</li>\n<li>ä¸è¿‡å»¶è¿Ÿæ¶ˆæ¯è¿™ç§æ–¹æ¡ˆï¼Œéœ€è¦åŸºäºå»¶è¿Ÿé˜Ÿåˆ—ï¼Œå®ç°å¤æ‚ï¼Œ</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>1.8. è¶…æ—¶30åˆ†é’Ÿæ€ä¹ˆè‡ªåŠ¨å…³é—­è®¢å•</h2>\n<ul>\n<li>æ•°æ®åº“å®šæ—¶ä»»åŠ¡ï¼ˆå¦‚Quartzï¼‰quartz-scheduler æ”¯æŒé›†ç¾¤æ“ä½œï¼›å¯¹æœåŠ¡å™¨å†…å­˜æ¶ˆè€—å¤§ï¼Œæ•°æ®åº“å‹åŠ›å¤§ï¼Œå­˜åœ¨å»¶æ—¶ï¼Œæœ€åå»¶æ—¶ä¸ºå®šæ—¶æ—¶é—´</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt;\n    &lt;artifactId&gt;quartz&lt;/artifactId&gt;\n    &lt;version&gt;2.2.2&lt;/version&gt;\n&lt;/dependency&gt;\npublic class MyJob implements Job {\n    public void execute(JobExecutionContext context) throws JobExecutionException {\n        System.out.println(\"è¦å»æ•°æ®åº“æ‰«æå•¦ã€‚ã€‚ã€‚\");\n    }\n    public static void main(String[] args) throws Exception {\n        // åˆ›å»ºä»»åŠ¡\n        JobDetail jobDetail = JobBuilder.newJob(MyJob.class)\n                .withIdentity(\"job1\", \"group1\").build();\n        // åˆ›å»ºè§¦å‘å™¨ æ¯3ç§’é’Ÿæ‰§è¡Œä¸€æ¬¡\n        Trigger trigger = TriggerBuilder\n                .newTrigger()\n                .withIdentity(\"trigger1\", \"group3\")\n                .withSchedule(\n                        SimpleScheduleBuilder\n                                .simpleSchedule()\n                                .withIntervalInSeconds(3).\n                                repeatForever())\n                .build();\n        Scheduler scheduler = new StdSchedulerFactory().getScheduler();\n        // å°†ä»»åŠ¡åŠå…¶è§¦å‘å™¨æ”¾å…¥è°ƒåº¦å™¨\n        scheduler.scheduleJob(jobDetail, trigger);\n        // è°ƒåº¦å™¨å¼€å§‹è°ƒåº¦ä»»åŠ¡\n        scheduler.start();\n    }\n}\n</code></pre></div><ul>\n<li>JDKçš„DelayQueueå»¶è¿Ÿé˜Ÿåˆ—(æ— ç•Œé˜»å¡é˜Ÿåˆ—)åªæœ‰åœ¨å»¶è¿ŸæœŸæ»¡çš„æ—¶å€™æ‰èƒ½ä»ä¸­è·å–å…ƒç´ ã€‚ å»¶è¿Ÿä½ï¼›æœåŠ¡å™¨é‡å¯åï¼Œæ•°æ®å…¨éƒ¨æ¶ˆå¤±ï¼Œæ€•å®•æœº é›†ç¾¤æ‰©å±•ç›¸å½“éº»çƒ¦ å®¹æ˜“å°±å‡ºç°OOMå¼‚å¸¸</li>\n<li>Poll():è·å–å¹¶ç§»é™¤é˜Ÿåˆ—çš„è¶…æ—¶å…ƒç´ ï¼Œæ²¡æœ‰åˆ™è¿”å›ç©º.take():è·å–å¹¶ç§»é™¤é˜Ÿåˆ—çš„è¶…æ—¶å…ƒç´ ï¼Œå¦‚æœæ²¡æœ‰åˆ™ wait å½“å‰çº¿ç¨‹ï¼Œç›´åˆ°æœ‰å…ƒç´ æ»¡è¶³è¶…æ—¶æ¡ä»¶ï¼Œè¿”å›ç»“æœã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class OrderDelay implements Delayed {\n    private String orderId;\n    private long timeout;\n    OrderDelay(String orderId, long timeout) {\n        this.orderId = orderId;\n        this.timeout = timeout + System.nanoTime();\n    }\n\n    public int compareTo(Delayed other) {\n        if (other == this) {\n            return 0;\n        }\n        OrderDelay t = (OrderDelay) other;\n        long d = (getDelay(TimeUnit.NANOSECONDS) - t.getDelay(TimeUnit.NANOSECONDS));\n        return (d == 0) ? 0 : ((d &lt; 0) ? -1 : 1);\n    }\n\n    // è¿”å›è·ç¦»ä½ è‡ªå®šä¹‰çš„è¶…æ—¶æ—¶é—´è¿˜æœ‰å¤šå°‘\n    public long getDelay(TimeUnit unit) {\n        return unit.convert(timeout - System.nanoTime(), TimeUnit.NANOSECONDS);\n    }\n\n    void print() {\n        System.out.println(orderId + \"ç¼–å·çš„è®¢å•è¦åˆ é™¤å•¦ã€‚ã€‚ã€‚ã€‚\");\n    }\n\n    public static void main(String[] args) {\n        DelayQueue&lt;OrderDelayed&gt; delayQueue = new DelayQueue&lt;&gt;();\n        delayQueue.put(new OrderDelayed(\"220101001\", 8, TimeUnit.SECONDS));\n        delayQueue.put(new OrderDelayed(\"220101002\", 4, TimeUnit.SECONDS));  \n        while (true) {\n            // å–é˜Ÿåˆ—å¤´éƒ¨å…ƒç´ æ˜¯å¦è¿‡æœŸ\n            OrderDelayed task = delayQueue.poll();\n            if (task != null) {\n                System.out.println(\"è®¢å• </code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/d4a02ad890b4cf42ab109.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "spring",
      "url": "https://javaguide.cn/interview/spring.html",
      "id": "https://javaguide.cn/interview/spring.html",
      "summary": "1. Springæ˜¯ä»€ä¹ˆï¼Ÿç‰¹æ€§ï¼Ÿ Springæ˜¯ä¸€ä¸ªè½»é‡çº§ã€éå…¥ä¾µå¼çš„æ§åˆ¶åè½¬(IoC)å’Œé¢å‘åˆ‡é¢(AOP)çš„æ¡†æ¶ã€‚ IoCå’ŒDIçš„æ”¯æŒ:ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’Œä¾èµ–å…³ç³» AOPç¼–ç¨‹çš„æ”¯æŒï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹å¯ä»¥å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åˆ‡é¢åŠŸèƒ½ã€‚ å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒï¼šæ”¯æŒé€šè¿‡é…ç½®å°±æ¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œä¸éœ€è¦é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼ã€‚ å¿«æ·æµ‹è¯•çš„æ”¯æŒï¼šæ”¯æŒJuni...",
      "content_html": "\n<ul>\n<li>Springæ˜¯ä¸€ä¸ªè½»é‡çº§ã€éå…¥ä¾µå¼çš„æ§åˆ¶åè½¬(IoC)å’Œé¢å‘åˆ‡é¢(AOP)çš„æ¡†æ¶ã€‚</li>\n<li>IoCå’ŒDIçš„æ”¯æŒ:ç®¡ç†å¯¹è±¡ç”Ÿå‘½å‘¨æœŸå’Œä¾èµ–å…³ç³»</li>\n<li>AOPç¼–ç¨‹çš„æ”¯æŒï¼šé¢å‘åˆ‡é¢ç¼–ç¨‹å¯ä»¥å®ç°å¯¹ç¨‹åºè¿›è¡Œæƒé™æ‹¦æˆªã€è¿è¡Œç›‘æ§ç­‰åˆ‡é¢åŠŸèƒ½ã€‚</li>\n<li>å£°æ˜å¼äº‹åŠ¡çš„æ”¯æŒï¼šæ”¯æŒé€šè¿‡é…ç½®å°±æ¥å®Œæˆå¯¹äº‹åŠ¡çš„ç®¡ç†ï¼Œè€Œä¸éœ€è¦é€šè¿‡ç¡¬ç¼–ç çš„æ–¹å¼ã€‚</li>\n<li>å¿«æ·æµ‹è¯•çš„æ”¯æŒï¼šæ”¯æŒJunitæ³¨è§£æµ‹è¯•Springç¨‹åºã€‚</li>\n<li>å¿«é€Ÿé›†æˆåŠŸèƒ½ï¼šæ–¹ä¾¿é›†æˆå„ç§ä¼˜ç§€æ¡†æ¶</li>\n<li>å¤æ‚APIæ¨¡æ¿å°è£…ï¼šå¯¹JDBCã€JavaMailç­‰æä¾›äº†æ¨¡æ¿åŒ–çš„å°è£…ï¼Œé™ä½åº”ç”¨éš¾åº¦</li>\n</ul>\n<h1>2. Springæœ‰å“ªäº›æ¨¡å—ï¼Ÿ</h1>\n<ul>\n<li>Spring Coreï¼šSpring æ ¸å¿ƒï¼Œå®ƒæ˜¯æ¡†æ¶æœ€åŸºç¡€çš„éƒ¨åˆ†ï¼Œæä¾› IoC å’Œä¾èµ–æ³¨å…¥ DI ç‰¹æ€§ã€‚</li>\n<li>Spring Contextï¼šSpring ä¸Šä¸‹æ–‡å®¹å™¨ï¼Œå®ƒæ˜¯ BeanFactory åŠŸèƒ½åŠ å¼ºçš„ä¸€ä¸ªå­æ¥å£ã€‚</li>\n<li>Spring Webï¼šå®ƒæä¾› Web åº”ç”¨å¼€å‘çš„æ”¯æŒã€‚</li>\n<li>Spring MVCï¼šå®ƒé’ˆå¯¹ Web åº”ç”¨ä¸­ MVC æ€æƒ³çš„å®ç°ã€‚</li>\n<li>Spring DAOï¼šæä¾›å¯¹ JDBC æŠ½è±¡å±‚ï¼Œç®€åŒ–äº† JDBC ç¼–ç ï¼ŒåŒæ—¶ï¼Œç¼–ç æ›´å…·æœ‰å¥å£®æ€§ã€‚</li>\n<li>Spring ORMï¼šå®ƒæ”¯æŒç”¨äºæµè¡Œçš„ ORM æ¡†æ¶çš„æ•´åˆï¼Œæ¯”å¦‚ï¼šSpring + Hibernateã€Spring + iBatisã€Spring + JDO çš„æ•´åˆç­‰</li>\n<li>Spring AOPï¼šå³é¢å‘åˆ‡é¢ç¼–ç¨‹ï¼Œå®ƒæä¾›äº†ä¸ AOP è”ç›Ÿå…¼å®¹çš„ç¼–ç¨‹å®ç°ã€‚</li>\n</ul>\n<h1>3. Springå¸¸ç”¨æ³¨è§£ï¼Ÿ</h1>\n<ul>\n<li>Web:\n<ul>\n<li>@Controllerï¼šç»„åˆæ³¨è§£ï¼ˆç»„åˆäº†@Componentæ³¨è§£ï¼‰ï¼Œåº”ç”¨åœ¨MVCå±‚ï¼ˆæ§åˆ¶å±‚ï¼‰ã€‚</li>\n<li>@RestControllerï¼š@Controllerå’Œ@ResponseBodyçš„ç»„åˆæ³¨è§£ï¼Œæ³¨è§£åœ¨ç±»ä¸Šåˆ™è¯¥Controllerçš„æ‰€æœ‰æ–¹æ³•éƒ½é»˜è®¤åŠ ä¸Šäº†@ResponseBodyã€‚</li>\n<li>@RequestMappingï¼šç”¨äºæ˜ å°„Webè¯·æ±‚ï¼ŒåŒ…æ‹¬è®¿é—®è·¯å¾„å’Œå‚æ•°ã€‚Restfulæ¥å£æ ¹æ®è¯·æ±‚ç±»å‹ä½¿ç”¨ä¸åŒçš„æ³¨è§£ï¼š@GetMappingã€@PostMappingã€@PutMappingã€@DeleteMapping</li>\n<li>@ResponseBodyï¼šå°†è¿”å›å€¼æ”¾åœ¨responseå†…ï¼Œé€šå¸¸è¿”å›jsonæ•°æ®ã€‚</li>\n<li>@RequestBodyï¼šå°†requestçš„å‚æ•°æ”¾åœ¨requestä½“ä¸­</li>\n<li>@PathVariableï¼šç”¨äºæ¥æ”¶è·¯å¾„å‚æ•°ï¼Œæ¯”å¦‚@RequestMapping(â€œ/hello/{name}â€)ç”³æ˜çš„è·¯å¾„ï¼Œå°†æ³¨è§£æ”¾åœ¨å‚æ•°ä¸­å‰ï¼Œå³å¯è·å–è¯¥å€¼ï¼Œé€šå¸¸ä½œä¸ºRestfulçš„æ¥å£å®ç°æ–¹æ³•ã€‚</li>\n</ul>\n</li>\n<li>å®¹å™¨:\n<ul>\n<li>@Componentï¼šå°†ç±»å˜ä¸ºSpringç®¡ç†çš„Beanã€‚</li>\n<li>@Serviceï¼šç»„åˆæ³¨è§£ï¼ˆç»„åˆäº†@Componentæ³¨è§£ï¼‰ï¼Œåº”ç”¨åœ¨serviceå±‚ï¼ˆä¸šåŠ¡é€»è¾‘å±‚ï¼‰ã€‚</li>\n<li>@Repositoryï¼šç»„åˆæ³¨è§£ï¼ˆç»„åˆäº†@Componentæ³¨è§£ï¼‰ï¼Œåº”ç”¨åœ¨daoå±‚ï¼ˆæ•°æ®è®¿é—®å±‚ï¼‰ã€‚</li>\n<li>@Autowiredï¼šSpringæä¾›çš„å·¥å…·ï¼ˆç”±Springçš„ä¾èµ–æ³¨å…¥å·¥å…·ï¼ˆBeanPostProcessorã€BeanFactoryPostProcessorï¼‰è‡ªåŠ¨æ³¨å…¥ï¼‰ã€‚</li>\n<li>@Qualifierï¼šç”¨äºåŒºåˆ†ä¸¤ä¸ªä»¥ä¸Šç›¸åŒç±»å‹çš„Bean</li>\n<li>@Configurationï¼šå£°æ˜å½“å‰ç±»æ˜¯ä¸€ä¸ªé…ç½®ç±»ï¼ˆç›¸å½“äºä¸€ä¸ªSpringé…ç½®çš„xmlæ–‡ä»¶ï¼‰</li>\n<li>@Valueï¼šå¯ç”¨åœ¨å­—æ®µï¼Œæ„é€ å™¨å‚æ•°è·Ÿæ–¹æ³•å‚æ•°æŒ‡å®šé»˜è®¤å€¼ï¼Œæ”¯æŒ#{}è·Ÿ${}æ–¹å¼ã€‚ä¸€èˆ¬å°†SpringbBootä¸­çš„application.propertiesé…ç½®çš„å±æ€§å€¼èµ‹å€¼ç»™å˜é‡ã€‚</li>\n<li>@Beanï¼šæ³¨è§£åœ¨æ–¹æ³•ä¸Šï¼Œå£°æ˜å½“å‰æ–¹æ³•çš„è¿”å›å€¼ä¸ºä¸€ä¸ªBeanã€‚è¿”å›çš„Beanå¯¹åº”çš„ç±»ä¸­å¯ä»¥å®šä¹‰init()æ–¹æ³•å’Œdestroy()æ–¹æ³•ï¼Œç„¶ååœ¨@Bean(initMethod=â€initâ€,destroyMethod=â€destroyâ€)å®šä¹‰ï¼Œåœ¨æ„é€ ä¹‹åæ‰§è¡Œinitï¼Œåœ¨é”€æ¯ä¹‹å‰æ‰§è¡Œdestroyã€‚</li>\n<li>@Scope:å®šä¹‰é‡‡ç”¨ä»€ä¹ˆæ¨¡å¼åˆ›å»ºBeanï¼ˆæ–¹æ³•ä¸Šï¼Œå¾—æœ‰@Beanï¼‰åŒ…æ‹¬ï¼šSingletonã€Prototypeã€Requestã€Sessionã€GlobalSessionã€‚</li>\n</ul>\n</li>\n<li>AOP:\n<ul>\n<li>@Aspect:å£°æ˜ä¸€ä¸ªåˆ‡é¢ï¼ˆç±»ä¸Šï¼‰ä½¿ç”¨@Afterã€@Beforeã€@Aroundå®šä¹‰å»ºè¨€ï¼ˆadviceï¼‰ï¼Œå¯ç›´æ¥å°†æ‹¦æˆªè§„åˆ™ï¼ˆåˆ‡ç‚¹ï¼‰ä½œä¸ºå‚æ•°ã€‚\n<ul>\n<li>@Afterï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹åæ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰ã€‚</li>\n<li>@Beforeï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰æ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰ã€‚</li>\n<li>@Aroundï¼šåœ¨æ–¹æ³•æ‰§è¡Œä¹‹å‰ä¸ä¹‹åæ‰§è¡Œï¼ˆæ–¹æ³•ä¸Šï¼‰ã€‚</li>\n<li>@PointCutï¼šå£°æ˜åˆ‡ç‚¹åœ¨javaé…ç½®ç±»ä¸­ä½¿ç”¨@EnableAspectJAutoProxyæ³¨è§£å¼€å¯Springå¯¹AspectJä»£ç†çš„æ”¯æŒï¼ˆç±»ä¸Šï¼‰ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>äº‹åŠ¡ï¼š@Transactionalï¼šåœ¨è¦å¼€å¯äº‹åŠ¡çš„æ–¹æ³•ä¸Šä½¿ç”¨ï¼Œå³å¯å£°æ˜å¼å¼€å¯äº‹åŠ¡ã€‚</li>\n</ul>\n<h1>5. Springä¸­éƒ½ç”¨åˆ°äº†å“ªäº›è®¾è®¡æ¨¡å¼ï¼Ÿ</h1>\n<ul>\n<li>å·¥å‚æ¨¡å¼â€”ä½¿ç”¨å·¥å‚æ¨¡å¼é€šè¿‡BeanFactoryã€ApplicationContextåˆ›å»ºbeanå¯¹è±¡ã€‚</li>\n<li>ä»£ç†æ¨¡å¼â€”SpringAOPåŠŸèƒ½åŠŸèƒ½å°±æ˜¯é€šè¿‡ä»£ç†æ¨¡å¼æ¥å®ç°çš„ï¼Œåˆ†ä¸ºåŠ¨æ€ä»£ç†å’Œé™æ€ä»£ç†ã€‚</li>\n<li>å•ä¾‹æ¨¡å¼â€”Springä¸­å®šä¹‰çš„Beané»˜è®¤ä¸ºå•ä¾‹æ¨¡å¼ã€‚</li>\n<li>æ¨¡æ¿æ–¹æ³•â€”è§£å†³ä»£ç é‡å¤çš„é—®é¢˜ã€‚æ¯”å¦‚RestTemplateã€JmsTemplateã€JdbcTemplateã€‚</li>\n<li>è§‚å¯Ÿè€…æ¨¡å¼:Springäº‹ä»¶é©±åŠ¨æ¨¡å‹å°±æ˜¯è§‚å¯Ÿè€…æ¨¡å¼å¾ˆç»å…¸çš„ä¸€ä¸ªåº”ç”¨ã€‚</li>\n<li>é€‚é…å™¨æ¨¡å¼:SpringAOPçš„å¢å¼ºæˆ–é€šçŸ¥(Advice)ä½¿ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼ã€SpringMVCä¸­ä¹Ÿæ˜¯ç”¨åˆ°äº†é€‚é…å™¨æ¨¡å¼é€‚é…Controllerã€‚</li>\n<li>ç­–ç•¥æ¨¡å¼ï¼šSpringä¸­æœ‰ä¸€ä¸ªResourceæ¥å£ï¼Œå®ƒçš„ä¸åŒå®ç°ç±»ï¼Œä¼šæ ¹æ®ä¸åŒçš„ç­–ç•¥å»è®¿é—®èµ„æºã€‚</li>\n<li>å‰ç«¯æ§åˆ¶å™¨â€”Springæä¾›äº†DispatcherServletæ¥å¯¹è¯·æ±‚è¿›è¡Œåˆ†å‘ã€‚</li>\n<li>è§†å›¾å¸®åŠ©(ViewHelper)â€”Springæä¾›äº†ä¸€ç³»åˆ—çš„JSPæ ‡ç­¾ï¼Œé«˜æ•ˆå®æ¥è¾…åŠ©å°†åˆ†æ•£çš„ä»£ç æ•´åˆåœ¨è§†å›¾é‡Œã€‚</li>\n<li>ä¾èµ–æ³¨å…¥â€”è´¯ç©¿äºBeanFactory/ApplicationContextæ¥å£çš„æ ¸å¿ƒç†å¿µã€‚</li>\n</ul>\n<h1>12. ä»€ä¹ˆæ˜¯iocæ§åˆ¶åè½¬?å¥½å¤„ï¼Ÿ</h1>\n<ul>\n<li>Inverse Of Controlåè½¬æ§åˆ¶ï¼šå°†å¯¹è±¡çš„ç”Ÿå‘½å‘¨æœŸäº¤ç»™springå®¹å™¨ç®¡ç†</li>\n<li>å®ƒå°†æœ€å°åŒ–åº”ç”¨ç¨‹åºä¸­çš„ä»£ç é‡</li>\n<li>å®ƒä»¥æœ€å°çš„å½±å“å’Œæœ€å°‘çš„ä¾µå…¥æœºåˆ¶ä¿ƒè¿›æ¾è€¦åˆ</li>\n<li>æ”¯æŒå³æ—¶çš„å®ä¾‹åŒ–å’Œå»¶è¿ŸåŠ è½½Beanå¯¹è±¡</li>\n<li>æ˜“äºæµ‹è¯•ï¼Œå› ä¸ºä¸éœ€è¦å•å…ƒæµ‹è¯•ç”¨ä¾‹ä¸­çš„ä»»ä½•å•ä¾‹æˆ–JNDIæŸ¥æ‰¾æœºåˆ¶ã€‚</li>\n</ul>\n<h1>16. springçš„di</h1>\n<ul>\n<li>dependency Injectionä¾èµ–æ³¨å…¥,æ˜¯iocçš„å®ç°æ–¹å¼\n<ul>\n<li>æ³¨å…¥æ–¹å¼ï¼šset/å±æ€§æ–¹æ³•æ³¨å…¥ã€æ„é€ æ–¹æ³•æ³¨å…¥ã€å­—æ®µæ³¨å…¥</li>\n<li>æ³¨å…¥ç±»å‹ï¼šå€¼ç±»å‹æ³¨å…¥ï¼ˆ8å¤§åŸºæœ¬æ•°æ®ç±»å‹ï¼‰ã€å¼•ç”¨ç±»å‹æ³¨å…¥ å°†ä¾èµ–å¯¹è±¡æ³¨å…¥</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>setæ–¹æ³•æ³¨å…¥\n&lt;bean  name=\"user\" class=\"cn.itcast.bean.User\" &gt;\n\t&lt;!--å€¼ç±»å‹æ³¨å…¥: ä¸ºUserå¯¹è±¡ä¸­åä¸ºnameçš„å±æ€§æ³¨å…¥tomä½œä¸ºå€¼ --&gt;\n\t&lt;property name=\"name\" value=\"tom\" &gt;&lt;/property&gt;\n\t&lt;!-- å¼•ç”¨ç±»å‹æ³¨å…¥: ä¸ºcarå±æ€§æ³¨å…¥ä¸‹æ–¹é…ç½®çš„carå¯¹è±¡ --&gt;\n\t&lt;property name=\"car\"  ref=\"car\" &gt;&lt;/property&gt;\n\t&lt;!--æ•°ç»„ç±»å‹æ³¨å…¥: å¦‚æœæ•°ç»„ä¸­åªå‡†å¤‡ç±»ä¸€ä¸ªå€¼ï¼ˆå¯¹è±¡ï¼‰ï¼Œç›´æ¥ä½¿ç”¨value|ref--&gt;\n\t&lt;property name=\"arr\" value=\"tom\"&gt;&lt;/property&gt;\n\t&lt;property name=\"arr\"&gt;\n\t\t&lt;array&gt;\n\t\t\t&lt;value&gt;tom&lt;/value&gt;\n\t\t\t&lt;ref bean=\"user\"/&gt;\n\t\t&lt;array&gt;\n\t&lt;/property&gt;\n\t&lt;!-- Listç±»å‹æ³¨å…¥ï¼šå¦‚æœlistä¸­åªå‡†å¤‡ç±»ä¸€ä¸ªå€¼ï¼ˆå¯¹è±¡ï¼‰ï¼Œç›´æ¥ä½¿ç”¨value|ref--&gt;\n\t&lt;property name=\"list\" value=\"jack\"&gt;&lt;/property&gt;\n\t&lt;property name=\"list\"&gt;\n\t\t&lt;list&gt;\n\t\t\t&lt;value&gt;jack&lt;/value&gt;\n\t\t\t&lt;ref bean=\"user\"/&gt;\n\t\t&lt;list&gt;\n\t&lt;/property&gt;\n\t&lt;!-- Propertiesç±»å‹æ³¨å…¥ --&gt;\n\t&lt;property name=\"prop\"&gt;\n\t\t&lt;props&gt;\n\t\t\t&lt;prop key=\"driverClass\"&gt;com.jdbc.mysql.Driver&lt;/prop&gt;\n\t\t&lt;props&gt;\n\t&lt;/property&gt;\n\t&lt;!-- Mapç±»å‹æ³¨å…¥ --&gt;\n\t&lt;property name=\"map\"&gt;\n\t\t&lt;map&gt;\n\t\t\t&lt;entry key=\"url\" value=\"jdbc:mysql:///crm\"&gt;&lt;/entry&gt;\n\t\t&lt;map&gt;\n\t&lt;/property&gt;\n&lt;/bean&gt;\n&lt;!-- å°†carå¯¹è±¡é…ç½®åˆ°å®¹å™¨ä¸­ --&gt;\n&lt;bean name=\"car\" class=\"cn.itcast.bean.Car\" &gt;\n\t&lt;property name=\"name\" value=\"å…°åšåŸºå°¼\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n\næ„é€ å‡½æ•°æ³¨å…¥\n&lt;bean name=\"user2\" class=\"cn.itcast.bean.User\" &gt;\n\t&lt;!-- nameå±æ€§: æ„é€ å‡½æ•°çš„å‚æ•°å  indexå±æ€§: \n\tæ„é€ å‡½æ•°çš„å‚æ•°ç´¢å¼• typeå±æ€§: æ„é€ å‡½æ•°çš„å‚æ•°ç±»å‹--&gt;\n\t&lt;constructor-arg name=\"name\" index=\"0\" type=\"java.lang.Integer\" value=\"999\"&gt;&lt;/constructor-arg&gt;\n\t&lt;constructor-arg name=\"car\" index=\"1\" ref=\"car\"&gt;&lt;/constructor-arg&gt;\n&lt;/bean&gt;\n</code></pre></div><h1>14. ç®€è¿°Spring IoCçš„å®ç°æœºåˆ¶ï¼Ÿ</h1>\n<ul>\n<li>åŸç†ï¼šå·¥å‚æ¨¡å¼åŠ åå°„æœºåˆ¶</li>\n<li>a. åŠ è½½é…ç½®æ–‡ä»¶ï¼Œè§£ææˆBeanDefinitionæ”¾åœ¨Mapé‡Œ</li>\n<li>b. BeanFactoryè°ƒç”¨getBeançš„æ—¶å€™ï¼Œä»BeanDefinitionæ‰€å±çš„Mapé‡Œï¼Œæ‹¿å‡ºClasså¯¹è±¡è¿›è¡Œå®ä¾‹åŒ–ï¼Œå¦‚æœæœ‰ä¾èµ–å…³ç³»ï¼Œå°†é€’å½’è°ƒç”¨getBeanæ–¹æ³• â€”â€” å®Œæˆä¾èµ–æ³¨å…¥ã€‚</li>\n</ul>\n<h1>13. è¯´è¯´applicationContext&amp;BeanFactory</h1>\n<ul>\n<li>BeanFactoryæ¥å£ï¼šåˆ›å»ºå¹¶ç®¡ç†å„ç§ç±»çš„å¯¹è±¡ã€‚æ¯æ¬¡åœ¨è·å¾—å¯¹è±¡æ—¶æ‰ä¼šåˆ›å»ºå¯¹è±¡.æœ€å¸¸ç”¨çš„æ˜¯XmlBeanFactoryï¼Œæ ¹æ®XMLæ–‡ä»¶ä¸­å†…å®¹åˆ›å»ºç›¸åº”Bean</li>\n<li>ApplicationContextå»ºç«‹åœ¨BeanFactotyåŸºç¡€ä¸Šã€‚æ¯æ¬¡å®¹å™¨å¯åŠ¨æ—¶å°±ä¼šåˆ›å»ºå®¹å™¨ä¸­é…ç½®çš„æ‰€æœ‰å¯¹è±¡.å¹¶æä¾›æ›´å¤šåŠŸèƒ½\n<ul>\n<li>1ã€ClassPathXmlApplicationContext ï¼šä» ClassPath çš„ XML é…ç½®æ–‡ä»¶ä¸­è¯»å–ä¸Šä¸‹æ–‡ï¼Œå¹¶ç”Ÿæˆä¸Šä¸‹æ–‡å®šä¹‰ã€‚åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡ä»ç¨‹åºç¯å¢ƒå˜é‡ä¸­å–å¾—ã€‚</li>\n<li>2ã€FileSystemXmlApplicationContext ï¼šç”±æ–‡ä»¶ç³»ç»Ÿä¸­çš„XMLé…ç½®æ–‡ä»¶è¯»å–ä¸Šä¸‹æ–‡</li>\n<li>3ã€XmlWebApplicationContext ï¼šç”±Webåº”ç”¨çš„XMLæ–‡ä»¶è¯»å–ä¸Šä¸‹æ–‡ã€‚åœ¨ Spring MVC ä½¿ç”¨</li>\n<li>4ã€Spring Boot çš„ConfigServletWebServerApplicationContext</li>\n</ul>\n</li>\n</ul>\n<h1>17. Springå®¹å™¨å¯åŠ¨é˜¶æ®µä¼šå¹²ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>IoCå®¹å™¨å·¥ä½œçš„è¿‡ç¨‹å¯ä»¥åˆ’åˆ†ä¸¤ä¸ªé˜¶æ®µ</li>\n<li>å®¹å™¨å¯åŠ¨é˜¶æ®µï¼šåŠ è½½é…ç½®ï¼Œåˆ†æé…ç½®ä¿¡æ¯ï¼Œè£…é…åˆ°BeanDefinitionï¼Œå…¶ä»–åå¤„ç†</li>\n<li>Beanå®ä¾‹åŒ–é˜¶æ®µï¼šå®ä¾‹åŒ–å¯¹è±¡ï¼Œè£…é…ä¾èµ–ï¼Œ ç”Ÿå‘½å‘¨æœŸå›è°ƒï¼Œ å¯¹è±¡å…¶ä»–å¤„ç†ï¼Œ æ³¨å†Œå›è°ƒæ¥å£</li>\n</ul>\n<h1>18. Spring Beanåœ¨å®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h1>\n<ul>\n<li>å®ä¾‹åŒ–Beanå¯¹è±¡:\n<ul>\n<li>æ ¹æ®é…ç½®ä¸­Bean Definitionä¸­å®ä¾‹åŒ–Beanå¯¹è±¡ï¼ˆé€šè¿‡XMLï¼ŒJavaæ³¨è§£æˆ–Java Configä»£ç æä¾›ï¼‰</li>\n</ul>\n</li>\n<li>å±æ€§èµ‹å€¼ï¼šAwareç›¸å…³çš„å±æ€§ï¼Œæ³¨å…¥åˆ°Beanå¯¹è±¡\n<ul>\n<li>å¦‚æœBeanå®ç°BeanNameAwareæ¥å£ï¼Œåˆ™å·¥å‚é€šè¿‡ä¼ é€’Beançš„beanNameè°ƒç”¨setBeanName(String name)æ–¹æ³•</li>\n<li>å¦‚æœBeanå®ç°BeanFactoryAwareæ¥å£ï¼Œå·¥å‚é€šè¿‡ä¼ é€’è‡ªèº«çš„å®ä¾‹æ¥è°ƒç”¨setBeanFactory(BeanFactory beanFactory)æ–¹æ³•</li>\n</ul>\n</li>\n<li>åˆå§‹åŒ–\n<ul>\n<li>@PostConstruct</li>\n<li>å¦‚æœå­˜åœ¨ä¸Beanå…³è”çš„ä»»ä½•BeanPostProcessorï¼Œåˆ™è°ƒç”¨#preProcessBeforeInitialization(Object bean, String beanName) æ–¹æ³•ã€‚</li>\n<li>å¦‚æœBeanå®ç°InitializingBeanæ¥å£ï¼Œåˆ™ä¼šè°ƒç”¨#afterPropertiesSet() æ–¹æ³•ã€‚</li>\n<li>å¦‚æœBeanæŒ‡å®šinitæ–¹æ³•ï¼ˆä¾‹å¦‚ </li>\n<li>å¦‚æœå­˜åœ¨ä¸Beanå…³è”çš„ä»»ä½• BeanPostProcessorï¼Œåˆ™è°ƒç”¨#postProcessAfterInitialization(Object bean, String beanName) æ–¹æ³•ã€‚</li>\n</ul>\n</li>\n<li>é”€æ¯ï¼š\n<ul>\n<li>@PreDestroy</li>\n<li>å¦‚æœBeanå®ç°DisposableBeanæ¥å£ï¼Œå½“ spring å®¹å™¨å…³é—­æ—¶ï¼Œä¼šè°ƒç”¨ #destroy() æ–¹æ³•ã€‚</li>\n<li>å¦‚æœbeanæŒ‡å®šdestroyæ–¹æ³•ï¼ˆä¾‹å¦‚ </li>\n</ul>\n</li>\n</ul>\n<h1>15. Springæœ‰å“ªäº›è‡ªåŠ¨è£…é…çš„æ–¹å¼?</h1>\n<ul>\n<li>byNameæ ¹æ®åç§°è¿›è¡Œè‡ªåŠ¨åŒ¹é…</li>\n<li>byTypeæ ¹æ®ç±»å‹è¿›è¡Œè‡ªåŠ¨åŒ¹é…</li>\n<li>constructor springæ ¹æ®beanæ„é€ å‡½æ•°å…¥å‚ç±»å‹è‡ªåŠ¨è£…é…</li>\n<li>autodetect å¦‚æœBeanæä¾›äº†é»˜è®¤çš„æ„é€ å‡½æ•°ï¼Œåˆ™é‡‡ç”¨byTypeï¼Œå¦åˆ™é‡‡ç”¨constructorã€‚</li>\n</ul>\n<h1>4. springä¸­çš„beanä½œç”¨åŸŸscopeç±»å‹âˆš</h1>\n<ul>\n<li>singleton(é»˜è®¤):è¢«æ ‡è¯†ä¸ºå•ä¾‹çš„å¯¹è±¡ï¼Œåœ¨springå®¹å™¨ä¸­åªå­˜åœ¨ä¸€ä¸ªå®ä¾‹</li>\n<li>prototype:è¢«æ ‡è¯†ä¸ºå¤šä¾‹çš„å¯¹è±¡,æ¯æ¬¡è·å–éƒ½ä¼šåˆ›å»ºæ–°å¯¹è±¡</li>\n<li>request:webç¯å¢ƒä¸‹.å¯¹è±¡ä¸requestç”Ÿå‘½å‘¨æœŸä¸€è‡´.</li>\n<li>session:webç¯å¢ƒä¸‹,å¯¹è±¡ä¸sessionç”Ÿå‘½å‘¨æœŸä¸€è‡´.</li>\n<li>Application:å¯¹è±¡ä¸Web Applicationç”Ÿå‘½å‘¨æœŸä¸€è‡´ï¼Œåªèƒ½åœ¨åŒä¸€ä¸ªwebapplicationä¸­è·å–</li>\n</ul>\n<h1>8. springæ¡†æ¶ä¸­çš„å•ä¾‹beanæ˜¯çº¿ç¨‹å®‰å…¨çš„å—ï¼Ÿâˆš</h1>\n<ul>\n<li>å¦‚æœå•ä¾‹Beanæ˜¯æ— çŠ¶æ€çš„ï¼Œä¹Ÿå°±æ˜¯çº¿ç¨‹ä¸­çš„æ“ä½œä¸ä¼šå¯¹Beançš„æˆå‘˜æ‰§è¡ŒæŸ¥è¯¢ä»¥å¤–çš„æ“ä½œï¼Œé‚£ä¹ˆè¿™ä¸ªå•ä¾‹Beanæ˜¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>\n<li>å¦‚æœbeanæœ‰å¤šç§çŠ¶æ€çš„è¯ï¼ˆæ¯”å¦‚ View Model å¯¹è±¡ï¼‰ï¼Œå°±éœ€è¦è‡ªè¡Œä¿è¯çº¿ç¨‹å®‰å…¨ã€‚è§£å†³åŠæ³•å°±æ˜¯å°†å¤šæ€beançš„ä½œç”¨åŸŸç”±â€œsingletonâ€å˜æ›´ä¸ºâ€œprototypeâ€æˆ–è€…å°†å˜é‡æ”¾å…¥ThreadLocalä¸­</li>\n</ul>\n<h1>6. å¦‚ä½•è§£å†³spring beanä¸­çš„å¾ªç¯ä¾èµ–ï¼Ÿâˆšä¸ºä½•ä½¿ç”¨ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–è€Œä¸æ˜¯äºŒçº§ç¼“å­˜?</h1>\n<ul>\n<li>å•ä¾‹æ¨¡å¼ä¸‹Springå¯ä»¥è§£å†³å“ªäº›æƒ…å†µçš„å¾ªç¯ä¾èµ–\n<ul>\n<li>å¤šä¾‹æ¨¡å¼ä¸æ”¯æŒï¼Œæ— é™åˆ›å»ºå¯¹è±¡</li>\n<li>ABå‡é‡‡ç”¨æ„é€ å™¨æ³¨å…¥ï¼Œä¸æ”¯æŒã€‚ç›´æ¥æŠ›å‡ºBeanCurrentlylnCreationExceptionå¼‚å¸¸ã€‚</li>\n<li>ABå‡é‡‡ç”¨setteræ³¨å…¥ï¼Œæ”¯æŒ</li>\n<li>ABå‡é‡‡ç”¨å±æ€§è‡ªåŠ¨æ³¨å…¥ï¼Œæ”¯æŒ</li>\n<li>Aä¸­æ³¨å…¥çš„Bä¸ºsetteræ³¨å…¥ï¼ŒBä¸­æ³¨å…¥çš„Aä¸ºæ„é€ å™¨æ³¨å…¥ï¼Œæ”¯æŒ</li>\n<li>Bä¸­æ³¨å…¥çš„Aä¸ºsetteræ³¨å…¥ï¼ŒAä¸­æ³¨å…¥çš„Bä¸ºæ„é€ å™¨æ³¨å…¥ï¼Œä¸æ”¯æŒ</li>\n<li>ç¬¬å››ç§å¯ä»¥ï¼Œç¬¬äº”ç§ä¸å¯ä»¥çš„åŸå› æ˜¯Springåœ¨åˆ›å»ºBeanæ—¶é»˜è®¤ä¼šæ ¹æ®è‡ªç„¶æ’åºè¿›è¡Œåˆ›å»ºï¼Œæ‰€ä»¥Aä¼šå…ˆäºBè¿›è¡Œåˆ›å»ºã€‚</li>\n</ul>\n</li>\n<li>springé€šè¿‡ä¸‰çº§ç¼“å­˜è§£å†³å¾ªç¯ä¾èµ–ï¼Œ\n<ul>\n<li>singletonObjects ä¸€çº§ç¼“å­˜ã€‚ä¿å­˜å®ä¾‹åŒ–ã€å±æ€§èµ‹å€¼ã€åˆå§‹åŒ–å®Œæˆçš„beanå®ä¾‹</li>\n<li>earlySingletonObjects äºŒçº§ç¼“å­˜ ã€‚ä¿å­˜å®ä¾‹åŒ–å®Œæˆçš„beanå®ä¾‹</li>\n<li>singletonFactories ä¸‰çº§ç¼“å­˜ï¼Œç”¨äºä¿å­˜beanåˆ›å»ºå·¥å‚ï¼Œä»¥ä¾¿åé¢æœ‰æœºä¼šåˆ›å»ºä»£ç†å¯¹è±¡</li>\n</ul>\n</li>\n<li>å®ä¾‹åŒ–è¿‡ç¨‹\n<ul>\n<li>Aå®ä¾‹åŒ–å¹¶æŠŠAçš„ObjectFactoryåŠ å…¥ç¬¬ä¸‰çº§ç¼“å­˜\n<ul>\n<li>Aå¡«å……å±æ€§éœ€è¦æ³¨å…¥B -&gt; Bå®ä¾‹åŒ–å¹¶æŠŠBçš„ObjectFactoryåŠ å…¥ç¬¬ä¸‰çº§ç¼“å­˜</li>\n<li>Bå¡«å……å±æ€§éœ€è¦æ³¨å…¥A -&gt; ä»ç¬¬ä¸‰çº§ç¼“å­˜ç§»é™¤Aå¯¹è±¡ï¼ŒAä»£ç†å¯¹è±¡åŠ å…¥ç¬¬äºŒçº§ç¼“å­˜ï¼ˆæ­¤æ—¶Aè¿˜æ˜¯åŠæˆå“ï¼ŒBæ³¨å…¥çš„æ˜¯Aä»£ç†å¯¹è±¡ï¼‰</li>\n<li>Bå±æ€§æ³¨å…¥å®Œæˆï¼Œåˆ›å»ºBä»£ç†å¯¹è±¡ï¼ˆæ­¤æ—¶Bæ˜¯å®Œæˆå“ï¼‰ -&gt; ä»ç¬¬ä¸‰çº§ç¼“å­˜ç§»é™¤Bå¯¹è±¡ï¼ŒBä»£ç†å¯¹è±¡åŠ å…¥ç¬¬ä¸€çº§ç¼“å­˜</li>\n<li>Aå¡«å……å±æ€§æ³¨å…¥Bä»£ç†å¯¹è±¡ï¼Œä»ç¬¬äºŒçº§ç¼“å­˜ç§»é™¤Aä»£ç†å¯¹è±¡ï¼ŒAä»£ç†å¯¹è±¡åŠ å…¥ç¬¬ä¸€çº§ç¼“å­˜</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å¦‚æœæ²¡æœ‰AOPçš„è¯ç¡®å®å¯ä»¥ä¸¤çº§ç¼“å­˜å°±å¯ä»¥è§£å†³å¾ªç¯ä¾èµ–çš„é—®é¢˜ï¼Œå¦‚æœåŠ ä¸ŠAOPï¼Œä¸¤çº§ç¼“å­˜æ˜¯æ— æ³•è§£å†³çš„ï¼Œä¸å¯èƒ½æ¯æ¬¡æ‰§è¡ŒsingleFactory.getObject()æ–¹æ³•éƒ½ç»™æˆ‘äº§ç”Ÿä¸€ä¸ªæ–°çš„ä»£ç†å¯¹è±¡ï¼Œæ‰€ä»¥è¿˜è¦å€ŸåŠ©å¦å¤–ä¸€ä¸ªç¼“å­˜æ¥ä¿å­˜äº§ç”Ÿçš„ä»£ç†å¯¹è±¡</li>\n</ul>\n<h1>7. @Autowired çš„å®ç°åŸç†ï¼Ÿ</h1>\n<ul>\n<li>åœ¨Beançš„åˆå§‹åŒ–é˜¶æ®µï¼Œä¼šé€šè¿‡Beanåç½®å¤„ç†å™¨æ¥è¿›è¡Œå‰ç½®å’Œåç½®çš„å¤„ç†ã€‚@AutowiredåŠŸèƒ½æ˜¯é€šè¿‡åç½®å¤„ç†å™¨<br>\nAutowiredAnnotationBeanPostProcessoræ¥å®Œæˆçš„</li>\n<li>Springåœ¨åˆ›å»ºbeançš„è¿‡ç¨‹ä¸­ï¼Œæœ€ç»ˆä¼šè°ƒç”¨åˆ°doCreateBean()æ–¹æ³•ï¼Œåœ¨doCreateBean()æ–¹æ³•ä¸­ä¼šè°ƒç”¨populateBean()æ–¹æ³•ï¼Œæ¥ä¸ºbeanè¿›è¡Œå±æ€§å¡«å……ï¼Œå®Œæˆè‡ªåŠ¨è£…é…ç­‰å·¥ä½œã€‚</li>\n<li>åœ¨populateBean()æ–¹æ³•ä¸­ä¸€å…±è°ƒç”¨äº†ä¸¤æ¬¡åç½®å¤„ç†å™¨ï¼Œç¬¬ä¸€æ¬¡æ˜¯ä¸ºäº†åˆ¤æ–­æ˜¯å¦éœ€è¦å±æ€§å¡«å……ï¼Œå¦‚æœä¸éœ€è¦è¿›è¡Œå±æ€§å¡«å……ï¼Œé‚£ä¹ˆå°±ä¼šç›´æ¥è¿›è¡Œreturnï¼Œå¦‚æœéœ€è¦è¿›è¡Œå±æ€§å¡«å……ï¼Œé‚£ä¹ˆæ–¹æ³•å°±ä¼šç»§ç»­å‘ä¸‹æ‰§è¡Œï¼Œåé¢ä¼šè¿›è¡Œç¬¬äºŒæ¬¡åç½®å¤„ç†å™¨çš„è°ƒç”¨ï¼Œè¿™ä¸ªæ—¶å€™ï¼Œå°±ä¼šè°ƒç”¨åˆ°AutowiredAnnotationBeanPostProcessorçš„postProcessPropertyValues()æ–¹æ³•ï¼Œåœ¨è¯¥æ–¹æ³•ä¸­å°±ä¼šè¿›è¡Œ@Autowiredæ³¨è§£çš„è§£æï¼Œç„¶åå®ç°è‡ªåŠ¨è£…é…</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å±æ€§èµ‹å€¼\nprotected void populateBean(String beanName, RootBeanDefinition mbd, @Nullable BeanWrapper bw) {\n          //â€¦â€¦â€¦â€¦\n          if (hasInstAwareBpps) {\n              if (pvs == null) {\n                  pvs = mbd.getPropertyValues();\n              }\n\n              PropertyValues pvsToUse;\n              for(Iterator var9 = this.getBeanPostProcessorCache().instantiationAware.iterator(); var9.hasNext(); pvs = pvsToUse) {\n                  InstantiationAwareBeanPostProcessor bp = (InstantiationAwareBeanPostProcessor)var9.next();\n                  pvsToUse = bp.postProcessProperties((PropertyValues)pvs, bw.getWrappedInstance(), beanName);\n                  if (pvsToUse == null) {\n                      if (filteredPds == null) {\n                          filteredPds = this.filterPropertyDescriptorsForDependencyCheck(bw, mbd.allowCaching);\n                      }\n                      //æ‰§è¡Œåå¤„ç†å™¨ï¼Œå¡«å……å±æ€§ï¼Œå®Œæˆè‡ªåŠ¨è£…é…\n                      //è°ƒç”¨InstantiationAwareBeanPostProcessorçš„postProcessPropertyValues()æ–¹æ³•\n                      pvsToUse = bp.postProcessPropertyValues((PropertyValues)pvs, filteredPds, bw.getWrappedInstance(), beanName);\n                      if (pvsToUse == null) {\n                          return;\n                      }\n                  }\n              }\n          }\n         //â€¦â€¦â€¦â€¦\n  }\n\n//å…ˆè°ƒç”¨ findAutowiringMetadata()æ–¹æ³•è§£æå‡º bean ä¸­å¸¦æœ‰@Autowired æ³¨è§£ã€@Inject å’Œ@Value æ³¨è§£çš„å±æ€§å’Œæ–¹æ³•ã€‚ç„¶åè°ƒç”¨ metadata.inject()æ–¹æ³•ï¼Œè¿›è¡Œå±æ€§å¡«å……ã€‚\n  public PropertyValues postProcessProperties(PropertyValues pvs, Object bean, String beanName) {\n      //@Autowiredæ³¨è§£ã€@Injectå’Œ@Valueæ³¨è§£çš„å±æ€§å’Œæ–¹æ³•\n      InjectionMetadata metadata = this.findAutowiringMetadata(beanName, bean.getClass(), pvs);\n\n      try {\n          //å±æ€§å¡«å……\n          metadata.inject(bean, beanName, pvs);\n          return pvs;\n      } catch (BeanCreationException var6) {\n          throw var6;\n      } catch (Throwable var7) {\n          throw new BeanCreationException(beanName, \"Injection of autowired dependencies failed\", var7);\n      }\n  }\n</code></pre></div><h1>19. springçš„AOPä»¥åŠå®ç°æ–¹å¼,é€šçŸ¥ç±»å‹</h1>\n<ul>\n<li>AOP(Aspect-Oriented Programming)ï¼Œé¢å‘åˆ‡é¢ç¼–ç¨‹:é€šè¿‡åŠ¨æ€ä»£ç†å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡.æŠŠä¸€äº›ä¸šåŠ¡é€»è¾‘ä¸­çš„ç›¸åŒä»£ç æŠ½å–åˆ°ä¸€ä¸ªç‹¬ç«‹çš„æ¨¡å—ä¸­ï¼Œæé«˜ä»£ç çš„å¯é‡ç”¨æ€§ã€‚</li>\n<li>å®ç°æ–¹å¼\n<ul>\n<li>åŠ¨æ€ä»£ç†(ä¼˜å…ˆ):åŸºäºæ¥å£ï¼Œè¢«ä»£ç†å¯¹è±¡å¿…é¡»è¦å®ç°æ¥å£,æ‰èƒ½äº§ç”Ÿä»£ç†å¯¹è±¡.</li>\n<li>cglibä»£ç†ï¼šåŸºäºç»§æ‰¿ï¼Œå¯¹ç›®æ ‡å¯¹è±¡è¿›è¡Œç»§æ‰¿ä»£ç†.ç›®æ ‡å¯¹è±¡ä¸è¢«finalä¿®é¥°ã€‚é€šè¿‡ASMè¯»å–ç›®æ ‡ç±»çš„å­—èŠ‚ç ï¼Œç„¶åä¿®æ”¹å­—èŠ‚ç ç”Ÿæˆæ–°çš„ç±»</li>\n</ul>\n</li>\n<li>åº”ç”¨ï¼šç”¨äºå¢å¼ºæ–¹æ³•ï¼Œæƒé™è®¤è¯ã€æ—¥å¿—ã€äº‹åŠ¡ã€å‚æ•°æ ¡éªŒ</li>\n<li>å¸¸ç”¨æœ¯è¯­\n<ul>\n<li>Joinpoint(è¿æ¥ç‚¹)ï¼šç›®æ ‡å¯¹è±¡ä¸­ï¼Œè¢«æ‹¦æˆªåˆ°çš„æ–¹æ³•</li>\n<li>Poincut(åˆ‡å…¥ç‚¹)ï¼šç›®æ ‡å¯¹è±¡ï¼Œå·²ç»å¢å¼ºçš„æ–¹æ³•ã€‚pointcut çš„ä½œç”¨å°±æ˜¯æä¾›ä¸€ç»„è§„åˆ™(ä½¿ç”¨ AspectJ pointcut expression language æ¥æè¿°) æ¥åŒ¹é…joinpoint, ç»™æ»¡è¶³è§„åˆ™çš„ joinpoint æ·»åŠ  Advice</li>\n<li>Advice(é€šçŸ¥/å¢å¼º)ï¼šæŒ‡æ‹¦æˆªåˆ°è¿æ¥ç‚¹ä¹‹åè¦æ‰§è¡Œçš„å¢å¼ºä»£ç \n<ul>\n<li>å‰ç½®é€šçŸ¥ï¼ˆBefore adviceï¼‰ï¼šåœ¨æŸè¿æ¥ç‚¹ï¼ˆJoinPointï¼‰ä¹‹å‰æ‰§è¡Œçš„é€šçŸ¥ï¼Œä½†è¿™ä¸ªé€šçŸ¥ä¸èƒ½é˜»æ­¢è¿æ¥ç‚¹å‰çš„æ‰§è¡Œã€‚ApplicationContext ä¸­åœ¨ &lt; aop:aspect &gt; é‡Œé¢ä½¿ç”¨ &lt; aop:before &gt; å…ƒç´ è¿›è¡Œå£°æ˜ï¼›</li>\n<li>åç½®é€šçŸ¥ï¼ˆAfter adviceï¼‰ï¼šå½“æŸè¿æ¥ç‚¹é€€å‡ºçš„æ—¶å€™æ‰§è¡Œçš„é€šçŸ¥ï¼ˆä¸è®ºæ˜¯æ­£å¸¸è¿”å›è¿˜æ˜¯å¼‚å¸¸é€€å‡ºï¼‰ã€‚ApplicationContext ä¸­åœ¨ &lt; aop:aspect &gt; é‡Œé¢ä½¿ç”¨ &lt; aop:after &gt; å…ƒç´ è¿›è¡Œå£°æ˜ã€‚</li>\n<li>è¿”å›åé€šçŸ¥ï¼ˆAfter return advice ï¼šåœ¨æŸè¿æ¥ç‚¹æ­£å¸¸å®Œæˆåæ‰§è¡Œçš„é€šçŸ¥ï¼Œä¸åŒ…æ‹¬æŠ›å‡ºå¼‚å¸¸çš„æƒ…å†µã€‚ApplicationContext ä¸­åœ¨ &lt; aop:aspect &gt; é‡Œé¢ä½¿ç”¨ &lt;&lt; after-returning &gt;&gt; å…ƒç´ è¿›è¡Œå£°æ˜ã€‚</li>\n<li>ç¯ç»•é€šçŸ¥ï¼ˆAround adviceï¼‰ï¼šåœ¨ join point å‰å’Œ joint point é€€å‡ºåéƒ½æ‰§è¡Œçš„ adviceã€‚ApplicationContext ä¸­åœ¨ &lt; aop:aspect &gt; é‡Œé¢ä½¿ç”¨ &lt; aop:around &gt; å…ƒç´ è¿›è¡Œå£°æ˜ã€‚</li>\n<li>æŠ›å‡ºå¼‚å¸¸åé€šçŸ¥ï¼ˆAfter throwing adviceï¼‰ï¼šåœ¨æ–¹æ³•æŠ›å‡ºå¼‚å¸¸é€€å‡ºæ—¶æ‰§è¡Œçš„é€šçŸ¥ã€‚ApplicationContext ä¸­åœ¨ &lt; aop:aspect &gt; é‡Œé¢ä½¿ç”¨ &lt; aop:after-throwing &gt; å…ƒç´ è¿›è¡Œå£°æ˜ã€‚</li>\n</ul>\n</li>\n<li>Target(ç›®æ ‡å¯¹è±¡)ï¼šè¢«ä»£ç†çš„å¯¹è±¡</li>\n<li>Weaving(ç»‡å…¥)ï¼šå°† aspect å’Œå…¶ä»–å¯¹è±¡è¿æ¥èµ·æ¥, å¹¶åˆ›å»º adviced object çš„è¿‡ç¨‹.</li>\n<li>Proxy(ä»£ç†)ï¼šå°†é€šçŸ¥ç»‡å…¥åˆ°ç›®æ ‡å¯¹è±¡ä¹‹åï¼Œå½¢æˆä»£ç†å¯¹è±¡ Advice + Target Object = Advised Object = Proxy ã€‚</li>\n<li>aspect(åˆ‡é¢)ï¼šåˆ‡å…¥ç‚¹+é€šçŸ¥ å¯ä»¥ç®€å•åœ°è®¤ä¸º, ä½¿ç”¨ @Aspect æ³¨è§£çš„ç±»å°±æ˜¯åˆ‡é¢ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>22. springäº‹åŠ¡é…ç½®ï¼Œå¤„ç†æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>å£°æ˜å¼äº‹åŠ¡ï¼šåŸºäºAOPï¼Œé€šè¿‡ä½¿ç”¨æ³¨è§£@Transactionalæˆ–åŸºäºXMLçš„é…ç½®äº‹åŠ¡ï¼Œä»è€Œäº‹åŠ¡ç®¡ç†ä¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ã€‚ä½†æ— æ³•ç”¨åˆ°ä»£ç å—çº§åˆ«</li>\n<li>ç¼–ç¨‹å¼äº‹åŠ¡ï¼šé€šè¿‡TransactionTemplateå’ŒPlatformTransactionManagerç¼–ç çš„æ–¹å¼å®ç°äº‹åŠ¡ç®¡ç†ï¼Œéœ€è¦åœ¨ä»£ç ä¸­æ˜¾å¼çš„è°ƒç”¨äº‹åŠ¡çš„è·å¾—ã€æäº¤ã€å›æ»šã€‚çµæ´»æ€§é«˜ï¼Œä½†ç»´æŠ¤å›°éš¾</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class AccountService {\n    private TransactionTemplate transactionTemplate;\n\n    public void setTransactionTemplate(TransactionTemplate transactionTemplate) {\n        this.transactionTemplate = transactionTemplate;\n    }\n\n    public void transfer(final String out, final String in, final Double money) {\n        transactionTemplate.execute(new TransactionCallbackWithoutResult() {\n            @Override\n            protected void doInTransactionWithoutResult(TransactionStatus status) {\n                // è½¬å‡º\n                accountDao.outMoney(out, money);\n                // è½¬å…¥\n                accountDao.inMoney(in, money);\n            }\n        });\n    }\n}\n\n</code></pre></div><h1>24. Spring çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼Ÿ</h1>\n<ul>\n<li>Springçš„æ¥å£TransactionDefinitionä¸­å®šä¹‰äº†è¡¨ç¤ºéš”ç¦»çº§åˆ«çš„å¸¸é‡ï¼Œå½“ç„¶å…¶å®ä¸»è¦è¿˜æ˜¯å¯¹åº”æ•°æ®åº“çš„äº‹åŠ¡éš”ç¦»çº§åˆ«ï¼š</li>\n<li>ISOLATION_DEFAULTï¼šä½¿ç”¨åç«¯æ•°æ®åº“é»˜è®¤çš„éš”ç¦»ç•Œåˆ«ï¼ŒMySQL é»˜è®¤å¯é‡å¤è¯»ï¼ŒOracle é»˜è®¤è¯»å·²æäº¤ã€‚</li>\n<li>ISOLATION_READ_UNCOMMITTEDï¼šè¯»æœªæäº¤</li>\n<li>ISOLATION_READ_COMMITTEDï¼šè¯»å·²æäº¤</li>\n<li>ISOLATION_REPEATABLE_READï¼šå¯é‡å¤è¯»</li>\n<li>ISOLATION_SERIALIZABLEï¼šä¸²è¡ŒåŒ–</li>\n</ul>\n<h1>27. äº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Ÿæœ‰ä»€ä¹ˆç”¨ï¼Ÿâˆš</h1>\n<ul>\n<li>äº‹åŠ¡çš„ä¼ æ’­è¡Œä¸ºpropagationï¼ˆserviceæ–¹æ³•è°ƒç”¨å¦å¤–ä¸€ä¸ªserviceæ–¹æ³•çš„æ—¶å€™ï¼Œä»…é™äºä¸åŒç±»æ–¹æ³•é—´ç›¸äº’è°ƒç”¨ï¼‰</li>\n<li>äº‹åŠ¡çš„ä¼ æ’­æœºåˆ¶æ˜¯æŒ‡åœ¨ä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œå¯¹äºå¤šä¸ªäº‹åŠ¡æ€§æ“ä½œä¹‹é—´çš„å…³ç³»å’Œåè°ƒçš„å¤„ç†æ–¹å¼ã€‚å®ƒå†³å®šäº†åœ¨ä¸€ä¸ªäº‹åŠ¡æ–¹æ³•ä¸­è°ƒç”¨å…¶ä»–äº‹åŠ¡æ–¹æ³•æ—¶ï¼Œäº‹åŠ¡çš„èŒƒå›´å’Œå±æ€§ç­‰ã€‚</li>\n<li>æ”¯æŒå½“å‰äº‹åŠ¡\n<ul>\n<li>PROPAGATION_REQUIREDå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±æ–°å»ºä¸€ä¸ª(é»˜è®¤)ï¼ï¼ï¼</li>\n<li>PROPAGATION_SUPPORTSå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œå°±ä¸ä½¿ç”¨äº‹åŠ¡</li>\n<li>PROPAGATION_MANDATORYå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™ä½¿ç”¨è¯¥äº‹åŠ¡ã€‚å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼ŒæŠ›å‡ºå¼‚å¸¸</li>\n</ul>\n</li>\n<li>ä¸æ”¯æŒå½“å‰äº‹åŠ¡çš„æƒ…å†µ\n<ul>\n<li>PROPAGATION_REQUIRES_NEWåˆ›å»ºä¸€ä¸ªæ–°çš„äº‹åŠ¡ï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡ï¼Œ</li>\n<li>PROPAGATION_NOT_SUPPORTEDä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŒ‚èµ·å½“å‰äº‹åŠ¡</li>\n<li>PROPAGATION_NEVER ä»¥éäº‹åŠ¡æ–¹å¼è¿è¡Œï¼Œå¦‚æœæœ‰äº‹åŠ¡å­˜åœ¨ï¼ŒæŠ›å‡ºå¼‚å¸¸</li>\n<li>PROPAGATION_NESTEDå¦‚æœå½“å‰äº‹åŠ¡å­˜åœ¨ï¼Œåˆ™åˆ›å»ºä¸€ä¸ªäº‹åŠ¡ä½œä¸ºå½“å‰äº‹åŠ¡çš„åµŒå¥—äº‹åŠ¡æ¥è¿è¡Œï¼Œå¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ç­‰ä»·PROPAGATION_REQUIRED</li>\n<li>ä»¥ PROPAGATION_NESTED å¯åŠ¨çš„äº‹åŠ¡å†…åµŒäºå¤–éƒ¨äº‹åŠ¡ä¸­ï¼ˆå¦‚æœå­˜åœ¨å¤–éƒ¨äº‹åŠ¡çš„è¯ï¼‰ï¼Œæ­¤æ—¶ï¼Œå†…åµŒäº‹åŠ¡å¹¶ä¸æ˜¯ä¸€ä¸ªç‹¬ç«‹çš„äº‹åŠ¡ï¼Œå®ƒä¾èµ–äºå¤–éƒ¨äº‹åŠ¡çš„å­˜åœ¨ï¼Œåªæœ‰é€šè¿‡å¤–éƒ¨çš„äº‹åŠ¡æäº¤ï¼Œæ‰èƒ½å¼•èµ·å†…éƒ¨äº‹åŠ¡çš„æäº¤ï¼ŒåµŒå¥—çš„å­äº‹åŠ¡ä¸èƒ½å•ç‹¬æäº¤ã€‚å…¶å®åµŒå¥—çš„å­äº‹åŠ¡å°±æ˜¯ä¿å­˜ç‚¹çš„ä¸€ä¸ªåº”ç”¨ï¼Œä¸€ä¸ªäº‹åŠ¡ä¸­å¯ä»¥åŒ…æ‹¬å¤šä¸ªä¿å­˜ç‚¹ï¼Œæ¯ä¸€ä¸ªåµŒå¥—å­äº‹åŠ¡ã€‚å¦å¤–ï¼Œå¤–éƒ¨äº‹åŠ¡çš„å›æ»šä¹Ÿä¼šå¯¼è‡´åµŒå¥—å­äº‹åŠ¡çš„å›æ»šã€‚</li>\n</ul>\n</li>\n<li>äº‹åŠ¡ä¼ æ’­æœºåˆ¶æ˜¯ä½¿ç”¨ ThreadLocal å®ç°çš„ï¼Œæ‰€ä»¥ï¼Œå¦‚æœè°ƒç”¨çš„æ–¹æ³•æ˜¯åœ¨æ–°çº¿ç¨‹ä¸­çš„ï¼Œäº‹åŠ¡ä¼ æ’­ä¼šå¤±æ•ˆã€‚</li>\n<li>åœ¨ Spring ä¸­ï¼Œåªæœ‰é€šè¿‡ Spring å®¹å™¨çš„ AOP ä»£ç†è°ƒç”¨çš„å…¬å¼€æ–¹æ³•ï¼ˆpublic methodï¼‰ä¸Šçš„@Transactionalæ³¨è§£æ‰ä¼šç”Ÿæ•ˆã€‚Spring é»˜è®¤ä½¿ç”¨åŸºäº JDK çš„åŠ¨æ€ä»£ç†ï¼ˆå½“æ¥å£å­˜åœ¨æ—¶ï¼‰æˆ–åŸºäº CGLIB çš„ä»£ç†ï¼ˆå½“åªæœ‰ç±»æ—¶ï¼‰æ¥å®ç°äº‹åŠ¡ã€‚è¿™ä¸¤ç§ä»£ç†æœºåˆ¶éƒ½åªèƒ½ä»£ç†å…¬å¼€çš„æ–¹æ³•ã€‚</li>\n</ul>\n<h1>28. å£°æ˜å¼äº‹åŠ¡å®ç°åŸç†äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>Springçš„å£°æ˜å¼äº‹åŠ¡ç®¡ç†æ˜¯é€šè¿‡AOPï¼ˆé¢å‘åˆ‡é¢ç¼–ç¨‹ï¼‰å’Œä»£ç†æœºåˆ¶å®ç°çš„ã€‚</li>\n<li>ç¬¬ä¸€æ­¥ï¼Œåœ¨Beanåˆå§‹åŒ–é˜¶æ®µåˆ›å»ºä»£ç†å¯¹è±¡ï¼š\n<ul>\n<li>Springå®¹å™¨åœ¨åˆå§‹åŒ–å•ä¾‹Beançš„æ—¶å€™ï¼Œä¼šéå†æ‰€æœ‰çš„BeanPostProcessorå®ç°ç±»ï¼Œå¹¶æ‰§è¡Œå…¶postProcessAfterInitializationæ–¹æ³•ã€‚</li>\n<li>åœ¨æ‰§è¡ŒpostProcessAfterInitializationæ–¹æ³•æ—¶ä¼šéå†å®¹å™¨ä¸­æ‰€æœ‰çš„åˆ‡é¢ï¼ŒæŸ¥æ‰¾ä¸å½“å‰BeanåŒ¹é…çš„åˆ‡é¢ï¼Œè¿™é‡Œä¼šè·å–äº‹åŠ¡çš„å±æ€§åˆ‡é¢ï¼Œä¹Ÿå°±æ˜¯@Transactionalæ³¨è§£åŠå…¶å±æ€§å€¼ã€‚</li>\n<li>ç„¶åæ ¹æ®å¾—åˆ°çš„åˆ‡é¢åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡ï¼Œé»˜è®¤ä½¿ç”¨JDKåŠ¨æ€ä»£ç†åˆ›å»ºä»£ç†ï¼Œå¦‚æœç›®æ ‡ç±»æ˜¯æ¥å£ï¼Œåˆ™ä½¿ç”¨JDKåŠ¨æ€ä»£ç†ï¼Œå¦åˆ™ä½¿ç”¨Cglibã€‚</li>\n</ul>\n</li>\n<li>ç¬¬äºŒæ­¥ï¼Œåœ¨æ‰§è¡Œç›®æ ‡æ–¹æ³•æ—¶è¿›è¡Œäº‹åŠ¡å¢å¼ºæ“ä½œï¼š\n<ul>\n<li>å½“é€šè¿‡ä»£ç†å¯¹è±¡è°ƒç”¨Beanæ–¹æ³•çš„æ—¶å€™ï¼Œä¼šè§¦å‘å¯¹åº”çš„AOPå¢å¼ºæ‹¦æˆªå™¨ï¼Œå£°æ˜å¼äº‹åŠ¡æ˜¯ä¸€ç§ç¯ç»•å¢å¼ºï¼Œå¯¹åº”æ¥å£ä¸ºMethodInterceptorï¼Œäº‹åŠ¡å¢å¼ºå¯¹è¯¥æ¥å£çš„å®ç°ä¸ºTransactionInterceptor</li>\n<li>äº‹åŠ¡æ‹¦æˆªå™¨TransactionInterceptoråœ¨invokeæ–¹æ³•ä¸­ï¼Œé€šè¿‡è°ƒç”¨çˆ¶ç±»TransactionAspectSupportçš„invokeWithinTransactionæ–¹æ³•è¿›è¡Œäº‹åŠ¡å¤„ç†ï¼ŒåŒ…æ‹¬å¼€å¯äº‹åŠ¡ã€äº‹åŠ¡æäº¤ã€å¼‚å¸¸å›æ»šç­‰ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>29. å£°æ˜å¼äº‹åŠ¡åœ¨å“ªäº›æƒ…å†µä¸‹ä¼šå¤±æ•ˆï¼Ÿ</h1>\n<ul>\n<li>@Transactionalåº”ç”¨åœ¨épublicä¿®é¥°çš„æ–¹æ³•ä¸Šã€‚å› ä¸ºåœ¨SpringAOPä»£ç†æ—¶ï¼ŒTransactionInterceptorï¼ˆäº‹åŠ¡æ‹¦æˆªå™¨ï¼‰åœ¨ç›®æ ‡æ–¹æ³•æ‰§è¡Œå‰åè¿›è¡Œæ‹¦æˆªï¼ŒDynamicAdvisedInterceptorï¼ˆCglibAopProxyçš„å†…éƒ¨ç±»ï¼‰çš„interceptæ–¹æ³•æˆ–JdkDynamicAopProxyçš„invokeæ–¹æ³•ä¼šé—´æ¥è°ƒç”¨AbstractFallbackTransactionAttributeSourceçš„computeTransactionAttributeæ–¹æ³•ï¼Œè·å–Transactionalæ³¨è§£çš„äº‹åŠ¡é…ç½®ä¿¡æ¯ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>protectedTransactionAttributecomputeTransactionAttribute(Methodmethod,Class&lt;?&gt;targetClass){\n  //Don'tallowno-publicmethodsasrequired.\n  if(allowPublicMethodsOnly()&amp;&amp;!Modifier.isPublic(method.getModifiers())){\n    return null;\n  }\n}\n</code></pre></div><ul>\n<li>@Transactionalæ³¨è§£å±æ€§propagationè®¾ç½®é”™è¯¯\n<ul>\n<li>TransactionDefinition.PROPAGATION_SUPPORTSï¼šå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™åŠ å…¥è¯¥äº‹åŠ¡ï¼›å¦‚æœå½“å‰æ²¡æœ‰äº‹åŠ¡ï¼Œåˆ™ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼›é”™è¯¯ä½¿ç”¨åœºæ™¯ï¼šåœ¨ä¸šåŠ¡é€»è¾‘å¿…é¡»è¿è¡Œåœ¨äº‹åŠ¡ç¯å¢ƒä¸‹ä»¥ç¡®ä¿æ•°æ®ä¸€è‡´æ€§çš„æƒ…å†µä¸‹ä½¿ç”¨SUPPORTSã€‚</li>\n<li>TransactionDefinition.PROPAGATION_NOT_SUPPORTEDï¼šæ€»æ˜¯ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŒ‚èµ·è¯¥äº‹åŠ¡ã€‚é”™è¯¯ä½¿ç”¨åœºæ™¯ï¼šåœ¨éœ€è¦äº‹åŠ¡æ”¯æŒçš„æ“ä½œä¸­ä½¿ç”¨NOT_SUPPORTEDã€‚</li>\n<li>TransactionDefinition.PROPAGATION_NEVERï¼šæ€»æ˜¯ä»¥éäº‹åŠ¡æ–¹å¼æ‰§è¡Œï¼Œå¦‚æœå½“å‰å­˜åœ¨äº‹åŠ¡ï¼Œåˆ™æŠ›å‡ºå¼‚å¸¸ã€‚é”™è¯¯ä½¿ç”¨åœºæ™¯ï¼šåœ¨åº”è¯¥åœ¨äº‹åŠ¡ç¯å¢ƒä¸‹æ‰§è¡Œçš„æ“ä½œä¸­ä½¿ç”¨NEVERã€‚</li>\n</ul>\n</li>\n<li>@Transactionalæ³¨è§£å±æ€§rollbackForè®¾ç½®é”™è¯¯\n<ul>\n<li>rollbackForç”¨æ¥æŒ‡å®šèƒ½å¤Ÿè§¦å‘äº‹åŠ¡å›æ»šçš„å¼‚å¸¸ç±»å‹ã€‚Springé»˜è®¤æŠ›å‡ºæœªæ£€æŸ¥uncheckedå¼‚å¸¸ï¼ˆç»§æ‰¿è‡ªRuntimeExceptionçš„å¼‚å¸¸ï¼‰æˆ–è€…Erroræ‰å›æ»šäº‹åŠ¡ï¼Œå…¶ä»–å¼‚å¸¸ä¸ä¼šè§¦å‘å›æ»šäº‹åŠ¡ã€‚</li>\n</ul>\n</li>\n<li>åŒä¸€ä¸ªç±»ä¸­æ–¹æ³•è°ƒç”¨ï¼Œå¯¼è‡´@Transactionalå¤±æ•ˆ\n<ul>\n<li>ç”±SpringAOPä»£ç†é€ æˆçš„ï¼Œå› ä¸ºåªæœ‰äº‹åŠ¡æ–¹æ³•è¢«å½“å‰ç±»ä»¥å¤–çš„ä»£ç è°ƒç”¨æ—¶ï¼Œæ‰ä¼šç”±Springç”Ÿæˆçš„ä»£ç†å¯¹è±¡æ¥ç®¡ç†ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>9. springæ³¨å†Œbeançš„å‡ ç§æ–¹å¼</h1>\n<ul>\n<li>ç›´æ¥ç¼–ç </li>\n<li>é…ç½®æ–‡ä»¶ xmlçš„beanæ ‡ç­¾</li>\n<li>æ³¨è§£\n<ul>\n<li>@Componentã€@Serviceã€@Controller</li>\n<li>@Bean</li>\n</ul>\n</li>\n<li>java config</li>\n</ul>\n<h1>10. springä¸­çš„@Requiredã€@Autowiredã€@Qualifieræ³¨è§£çš„ä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>@Requiredæ³¨è§£ï¼Œåº”ç”¨äºBeanå±æ€§setteræ–¹æ³•ã€‚è¡¨ç¤ºå±æ€§å¿…é¡»æ³¨å…¥å¦åˆ™æŠ›å‡º BeanInitializationException å¼‚å¸¸ã€‚</li>\n<li>@Autowiredç”¨äºåœ¨setteræ–¹æ³•ï¼Œæ„é€ å‡½æ•°ï¼Œå…·æœ‰ä»»æ„åç§°æˆ–å¤šä¸ªå‚æ•°çš„å±æ€§æˆ–æ–¹æ³•ä¸Šè‡ªåŠ¨è£…é… Bean</li>\n<li>@QualifieræŒ‡å®šidè‡ªåŠ¨è£…é…å“ªä¸ªbean</li>\n</ul>\n<h1>11. è§£é‡Šä»€ä¹ˆå«å»¶è¿ŸåŠ è½½ï¼Ÿ</h1>\n<ul>\n<li>å®¹å™¨å¯åŠ¨ä¹‹åé»˜è®¤ä¼šåˆ›å»ºæ‰€æœ‰ä½œç”¨åŸŸä¸ºå•ä¾‹çš„Beanï¼Œä½†æ˜¯æœ‰çš„ä¸šåŠ¡åœºæ™¯ä¸éœ€è¦æå‰åˆ›å»ºã€‚æ­¤æ—¶è®¾ç½®lazy-init=\"true\"ã€‚å®¹å™¨å¯åŠ¨ä¹‹åä¸ä¼šé»˜è®¤åˆ›å»ºä½œç”¨åŸŸä¸ºå•ä¾‹çš„Beanï¼Œè€Œæ˜¯åœ¨è·å¾—è¯¥Beanæ—¶æ‰åˆ›å»º</li>\n</ul>\n<h1>20. javaçƒ­éƒ¨ç½²</h1>\n<ul>\n<li>spring-boot-devtoolsã€Spring Loadedå®ç°åŸç†ï¼Œnioçš„WatchServiceç›‘å¬æ–‡ä»¶å¤¹å˜åŒ–ï¼ŒåŒæ—¶å®ç°classLoaderçš„findclassæ–¹æ³•é‡æ–°å°†classåŠ è½½è¿›å†…å­˜</li>\n</ul>\n<h1>21. Springå®¹å™¨åˆ›å»ºè¿‡ç¨‹</h1>\n<p>AbstractApplicationContextè°ƒç”¨refresh()æ–¹æ³•é€šè¿‡è°ƒç”¨obtainFreshBeanFactory()æ–¹æ³•åˆ›å»ºBeanå·¥å‚AnnotatedBeanDefinitionReaderæ‰«ææ³¨è§£doScanæ–¹æ³•å’ŒXmlBeanDefinitionReaderçš„doLoadBeanDefinitionsæ–¹æ³•saxæ–¹å¼è§£æxmlå°†å…¶å°è£…æˆdocumentå¯¹è±¡ï¼Œä½¿ç”¨BeanDefinitionReaderUtils.registerBeanDefinitionå¹¶æ³¨å†Œåˆ°BeanDefinitionRegistryç¼“å­˜ä¸­<br>\nç„¶åè°ƒç”¨postProcessBeanFactoryè°ƒç”¨å­ç±»çš„BeanFactoryçš„åç½®å¤„ç†å™¨ï¼Œç„¶åè°ƒç”¨invokeBeanFactoryPostProcessors()æ‰§è¡Œåç½®å¤„ç†å™¨<br>\nç¬¬ä¸‰æ³¨å†ŒBeanPostProcessors()åˆ°BeanFactoryä¸­<br>\nç¬¬å››æ³¨å†Œç›‘å¬å™¨<br>\nç¬¬äº”å®ä¾‹åŒ–æ‰€æœ‰çš„Beanæ”¾åˆ°singletonObjectså•ä¾‹æ± é‡Œé¢</p>\n<h1>23. @Transactional æ³¨è§£æœ‰å“ªäº›å±æ€§ï¼Ÿå¦‚ä½•ä½¿ç”¨ï¼Ÿ</h1>\n<ul>\n<li>å±æ€§ï¼špropagationäº‹åŠ¡ä¼ æ’­è¡Œä¸ºï¼Œisolationäº‹åŠ¡éš”ç¦»çº§åˆ«ã€rollbackForå¯¼è‡´äº‹åŠ¡å›æ»šçš„å¼‚å¸¸ç±»æ•°ç»„ã€timeoutäº‹åŠ¡è¶…æ—¶å›æ»šã€readonlyè¯»å†™æˆ–åªè¯»äº‹åŠ¡</li>\n<li>@Transactional å¯ç”¨åœ¨æ¥å£ã€æ¥å£æ–¹æ³•ã€ç±»ã€ç±»æ–¹æ³•ä¸Šã€‚åªè¢«åº”ç”¨åˆ° public æ–¹æ³•ä¸Šï¼Œæ–¹æ³•çº§åˆ«æ³¨è§£è¦†ç›–ç±»çº§åˆ«çš„æ³¨è§£ã€‚</li>\n</ul>\n<h1>25. Spring äº‹åŠ¡å¦‚ä½•å’Œä¸åŒçš„æ•°æ®æŒä¹…å±‚æ¡†æ¶(Spring JDBCã€Hibernateã€Spring JPAã€MyBatis)åšé›†æˆï¼Ÿ</h1>\n<ul>\n<li>Springé€šè¿‡org.springframework.transaction.PlatformTransactionManagerè¿›è¡Œäº‹åŠ¡ç®¡ç†ç®¡ç†</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface PlatformTransactionManager {\n  // æ ¹æ®äº‹åŠ¡å®šä¹‰ TransactionDefinition ï¼Œè·å¾— TransactionStatus ã€‚ \n  //ä¸ºä»€ä¹ˆä¸æ˜¯åˆ›å»ºäº‹åŠ¡å‘¢ï¼Ÿå› ä¸ºå¦‚æœå½“å‰å¦‚æœå·²ç»æœ‰äº‹åŠ¡ï¼Œåˆ™ä¸ä¼šè¿›è¡Œåˆ›å»ºï¼Œä¸€èˆ¬æ¥è¯´ä¼šè·Ÿå½“å‰çº¿ç¨‹è¿›è¡Œç»‘å®šã€‚\n  //ä¸ºä»€ä¹ˆè¿”å›TransactionStatuså¯¹è±¡ï¼Ÿå› ä¸ºTransactionStatus ä¸­åŒ…å«äº‹åŠ¡å±æ€§å’Œäº‹åŠ¡çš„å…¶å®ƒä¿¡æ¯ï¼Œä¾‹å¦‚æ˜¯å¦åªè¯»ã€æ˜¯å¦ä¸ºæ–°åˆ›å»ºçš„äº‹åŠ¡ç­‰ç­‰\n  TransactionStatus getTransaction(@Nullable TransactionDefinition definition) throws TransactionException;\n  //ä¸ºä»€ä¹ˆæ ¹æ® TransactionStatus æƒ…å†µï¼Œè¿›è¡Œæäº¤ï¼Ÿä¾‹å¦‚è¯´ï¼Œå¸¦@Transactionalæ³¨è§£çš„Aæ–¹æ³•ï¼Œä¼šè°ƒç”¨ @Transactional æ³¨è§£çš„Bæ–¹æ³•\n  //åœ¨Bæ–¹æ³•ç»“æŸè°ƒç”¨åï¼Œä¼šæ‰§è¡ŒPlatformTransactionManager#commit(TransactionStatus status) æ–¹æ³•ï¼Œæ­¤å¤„äº‹åŠ¡æ˜¯ä¸èƒ½ã€ä¹Ÿä¸ä¼šæäº¤çš„\n  //è€Œæ˜¯åœ¨Aæ–¹æ³•ç»“æŸè°ƒç”¨åï¼Œæ‰§è¡ŒPlatformTransactionManager#commit(TransactionStatus status) æ–¹æ³•ï¼Œæäº¤äº‹åŠ¡\n  void commit(TransactionStatus status) throws TransactionException;\n  // ä¸ºä»€ä¹ˆæ ¹æ® TransactionStatus æƒ…å†µï¼Œè¿›è¡Œå›æ»šï¼ŸåŸå› åŒä¸Š\n  void rollback(TransactionStatus status) throws TransactionException;\n}\n</code></pre></div><ul>\n<li>ä¸åŒçš„æ•°æ®æŒä¹…å±‚æ¡†æ¶ï¼Œä¼šæœ‰å…¶å¯¹åº”çš„PlatformTransactionManagerå®ç°ç±»ï¼Œéƒ½åŸºäºAbstractPlatformTransactionManagerè¿™ä¸ªéª¨æ¶ç±»ã€‚\n<ul>\n<li>HibernateTransactionManagerï¼Œå’ŒHibernate5äº‹åŠ¡ç®¡ç†åšé›†æˆã€‚</li>\n<li>DataSourceTransactionManagerï¼Œå’ŒJDBCäº‹åŠ¡ç®¡ç†åšé›†æˆã€‚ä¹Ÿé€‚ç”¨äºMyBatisã€Spring JDBCç­‰ç­‰</li>\n<li>JpaTransactionManagerï¼Œå’ŒJPAäº‹åŠ¡ç®¡ç†åšé›†æˆã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>26. ä¸ºä»€ä¹ˆåœ¨Springäº‹åŠ¡ä¸­ä¸èƒ½åˆ‡æ¢æ•°æ®æºï¼Ÿ</h1>\n<ul>\n<li>åœ¨Springçš„äº‹åŠ¡ç®¡ç†ä¸­ï¼Œæ•°æ®åº“è¿æ¥ä¼šå’Œå½“å‰çº¿ç¨‹æ‰€ç»‘å®šï¼Œå³ä½¿è®¾ç½®äº†å¦å¤–ä¸€ä¸ªæ•°æ®æºï¼Œä½¿ç”¨çš„è¿˜æ˜¯å½“å‰çš„æ•°æ®æºè¿æ¥ã€‚</li>\n<li>è€Œä¸”å¤šä¸ªæ•°æ®æºä¸”éœ€è¦äº‹åŠ¡çš„åœºæ™¯ä¼šå¸¦æ¥å¤šäº‹åŠ¡ä¸€è‡´æ€§çš„é—®é¢˜</li>\n<li>æ¨èé™¤éäº†è¯»å†™åˆ†ç¦»æ‰€å¸¦æ¥çš„å¤šæ•°æ®æºï¼Œå…¶å®ƒæƒ…å†µä¸‹ï¼Œå»ºè®®åªæœ‰ä¸€ä¸ªæ•°æ®æº</li>\n</ul>\n<h1>30. æ‹¦æˆªå™¨ä¸è¿‡æ»¤å™¨åŒºåˆ«âˆš</h1>\n<ul>\n<li>æ‹¦æˆªå™¨æ˜¯åŸºäºjavaçš„åå°„æœºåˆ¶çš„ï¼Œè€Œè¿‡æ»¤å™¨æ˜¯åŸºäºå‡½æ•°å›è°ƒã€‚</li>\n<li>æ‹¦æˆªå™¨ä¸ä¾èµ–ä¸servletå®¹å™¨ï¼Œè¿‡æ»¤å™¨ä¾èµ–servletå®¹å™¨ã€‚</li>\n<li>æ‹¦æˆªå™¨åªèƒ½å¯¹actionè¯·æ±‚èµ·ä½œç”¨ï¼Œè€Œè¿‡æ»¤å™¨åˆ™å¯ä»¥å¯¹å‡ ä¹æ‰€æœ‰çš„è¯·æ±‚èµ·ä½œç”¨ã€‚</li>\n<li>æ‹¦æˆªå™¨å¯ä»¥è®¿é—®actionä¸Šä¸‹æ–‡ã€å€¼æ ˆé‡Œçš„å¯¹è±¡ï¼Œè€Œè¿‡æ»¤å™¨ä¸èƒ½è®¿é—®ã€‚</li>\n<li>åœ¨actionçš„ç”Ÿå‘½å‘¨æœŸä¸­ï¼Œæ‹¦æˆªå™¨å¯ä»¥å¤šæ¬¡è¢«è°ƒç”¨ï¼Œè€Œè¿‡æ»¤å™¨åªèƒ½åœ¨å®¹å™¨åˆå§‹åŒ–æ—¶è¢«è°ƒç”¨ä¸€æ¬¡ã€‚</li>\n<li>æ‹¦æˆªå™¨å¯ä»¥è·å–IOCå®¹å™¨ä¸­çš„å„ä¸ªbeanï¼Œè€Œè¿‡æ»¤å™¨å°±ä¸è¡Œï¼Œè¿™ç‚¹å¾ˆé‡è¦ï¼Œåœ¨æ‹¦æˆªå™¨é‡Œæ³¨å…¥ä¸€ä¸ªserviceï¼Œå¯ä»¥è°ƒç”¨ä¸šåŠ¡é€»è¾‘ã€‚</li>\n</ul>\n<h1>31. springåŒºåˆ†ç¯å¢ƒ</h1>\n<ul>\n<li>spring.profiles.active=dev</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/9d7d1e010e6a298683def.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "springboot",
      "url": "https://javaguide.cn/interview/springboot.html",
      "id": "https://javaguide.cn/interview/springboot.html",
      "summary": "1. springbootä¼˜ç¼ºç‚¹ï¼Ÿ âˆšå¿«é€Ÿæ„å»ºé¡¹ç›®ï¼Œé€šè¿‡ Intellij IDEA æˆ–è€…å®˜æ–¹çš„ Spring Initializr å°±å¯ä»¥å¿«é€Ÿåˆ›å»ºæ–°é¡¹ç›® âˆšè‡ªåŠ¨é…ç½®:æä¾›äº†ä¸€ç³»åˆ—çš„ Starter,å¯¹ä¸»æµæ¡†æ¶çš„æ— é…ç½®é›†æˆ âˆšé¡¹ç›®ç‹¬ç«‹è¿è¡Œï¼Œå†…åµŒservletå®¹å™¨Tomcatã€Jetty æˆ–è€… Undertow æä¾›è¿è¡Œæ—¶åº”ç”¨ç›‘æ§ã€‚Spring Boot...",
      "content_html": "<!-- TOC -->\n<!-- /TOC -->\n<h1>1. springbootä¼˜ç¼ºç‚¹ï¼Ÿ</h1>\n<ul>\n<li>\n<p>âˆšå¿«é€Ÿæ„å»ºé¡¹ç›®ï¼Œé€šè¿‡ Intellij IDEA æˆ–è€…å®˜æ–¹çš„ Spring Initializr å°±å¯ä»¥å¿«é€Ÿåˆ›å»ºæ–°é¡¹ç›®</p>\n</li>\n<li>\n<p>âˆšè‡ªåŠ¨é…ç½®:æä¾›äº†ä¸€ç³»åˆ—çš„ Starter,å¯¹ä¸»æµæ¡†æ¶çš„æ— é…ç½®é›†æˆ</p>\n</li>\n<li>\n<p>âˆšé¡¹ç›®ç‹¬ç«‹è¿è¡Œï¼Œå†…åµŒservletå®¹å™¨Tomcatã€Jetty æˆ–è€… Undertow</p>\n</li>\n<li>\n<p>æä¾›è¿è¡Œæ—¶åº”ç”¨ç›‘æ§ã€‚Spring Boot æä¾›åŸºäº HTTPã€JMXã€SSH å¯¹è¿è¡Œæ—¶çš„é¡¹ç›®è¿›è¡Œç›‘æ§ã€‚</p>\n</li>\n<li>\n<p>æå¤§åœ°æé«˜äº†å¼€å‘ã€éƒ¨ç½²æ•ˆç‡</p>\n</li>\n<li>\n<p>å› ä¸ºè‡ªåŠ¨é…ç½® Spring Bean çš„åŠŸèƒ½ï¼Œæˆ‘ä»¬å¯èƒ½æ— æ³•çŸ¥é“ï¼Œå“ªäº› Bean è¢«è¿›è¡Œåˆ›å»ºäº†ã€‚è¿™ä¸ªæ—¶å€™ï¼Œå¦‚æœæˆ‘ä»¬æƒ³è¦è‡ªå®šä¹‰ä¸€äº› Bean ï¼Œå¯èƒ½å­˜åœ¨å†²çªï¼Œæˆ–è€…ä¸çŸ¥é“å®é™…æ³¨å…¥çš„æƒ…å†µã€‚</p>\n</li>\n</ul>\n<h1>2. å¦‚ä½•ç»Ÿä¸€å¼•å…¥Spring Bootç‰ˆæœ¬ï¼Ÿ</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ–¹å¼1.ç»§æ‰¿ spring-boot-starter-parent é¡¹ç›®ï¼Œå®¹æ˜“ä¸åˆ«çš„é¡¹ç›®å†²çª\n&lt;parent&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n    &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;\n&lt;/parent&gt;\næ–¹å¼2.å¯¼å…¥ spring-boot-dependencies é¡¹ç›®ä¾èµ–ï¼Œæ¯”è¾ƒè‡ªç”±\n&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-boot-dependencies&lt;/artifactId&gt;\n            &lt;version&gt;1.5.1.RELEASE&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n</code></pre></div><h1>3. Spring Boot æœ‰å“ªäº›é…ç½®æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>XML é…ç½®æ–‡ä»¶ã€‚<code>&lt;bean&gt;</code></li>\n<li>æ³¨è§£é…ç½®ã€‚@Component</li>\n<li>Java Config é…ç½®ã€‚ä½¿ç”¨ @Bean å’Œ @Configuration</li>\n</ul>\n<h1>4. Spring Boot æœ‰å“ªå‡ ç§è¯»å–é…ç½®çš„æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>@Valueæ³¨è§£ï¼Œè¯»å–é…ç½®åˆ°å±æ€§ã€‚æ”¯æŒå’Œ @PropertySourceæ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼ŒæŒ‡å®šä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚</li>\n<li>@ConfigurationPropertiesæ³¨è§£ï¼Œè¯»å–é…ç½®åˆ°ç±»ä¸Šã€‚æ”¯æŒå’Œ@PropertySourceæ³¨è§£ä¸€èµ·ä½¿ç”¨ï¼ŒæŒ‡å®šä½¿ç”¨çš„é…ç½®æ–‡ä»¶ã€‚</li>\n</ul>\n<h1>5. bootstrap.propertieså’Œapplication.propertiesæœ‰ä½•åŒºåˆ«?</h1>\n<ul>\n<li>bootstrap(.yml/.properties)ï¼šç”±çˆ¶ApplicationContextåŠ è½½ï¼Œæ¯”applicatonä¼˜å…ˆåŠ è½½ï¼Œé…ç½®åœ¨åº”ç”¨ç¨‹åºä¸Šä¸‹æ–‡çš„å¼•å¯¼é˜¶æ®µç”Ÿæ•ˆã€‚åœ¨SpringCloud Configæˆ–è€…Nacosä¸­ä¼šç”¨åˆ°ã€‚ä¸”å±æ€§ä¸èƒ½è¢«è¦†ç›–ï¼›</li>\n<li>application(.yml/.properties)ï¼šç”±ApplicatonContextåŠ è½½ï¼Œç”¨äºé¡¹ç›®çš„è‡ªåŠ¨åŒ–é…ç½®ã€‚</li>\n</ul>\n<h1>6. SpringBootä¸­å¦‚ä½•è§£å†³è·¨åŸŸé—®é¢˜ ?</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Configuration\npublic class CorsConfig implements WebMvcConfigurer {\n    @Override\n    public void addCorsMappings(CorsRegistry registry) {\n        registry.addMapping(\"/**\")\n                .allowedOrigins(\"*\")\n                .allowCredentials(true)\n                .allowedMethods(\"GET\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\")\n                .maxAge(3600);\n    }\n}\n</code></pre></div><h1>7. springbooté…ç½®æ–‡ä»¶è¯»å–é¡ºåºï¼Ÿâˆš</h1>\n<ul>\n<li>\n<p>config/application.properties|ymlï¼ˆé¡¹ç›®æ ¹ç›®å½•ä¸­configç›®å½•ä¸‹ï¼‰</p>\n</li>\n<li>\n<p>application.properties|ymlï¼ˆé¡¹ç›®æ ¹ç›®å½•ä¸‹ï¼‰</p>\n</li>\n<li>\n<p>resources/config/application.properties|ymlï¼ˆé¡¹ç›®resourcesç›®å½•ä¸­configç›®å½•ä¸‹ï¼‰</p>\n</li>\n<li>\n<p>resources/application.properties|ymlï¼ˆé¡¹ç›®çš„resourcesç›®å½•ä¸‹ï¼‰</p>\n</li>\n<li>\n<p>å¦‚æœåŒä¸€ä¸ªç›®å½•ä¸‹ï¼Œé»˜è®¤å…ˆè¯»å–application.propertiesã€‚ç„¶åapplication.yml</p>\n</li>\n<li>\n<p>å¦‚æœåŒä¸€ä¸ªé…ç½®å±æ€§ï¼Œé»˜è®¤ä½¿ç”¨ç¬¬1ä¸ªè¯»å–åˆ°çš„</p>\n</li>\n<li>\n<p>é…ç½®æ–‡ä»¶æ”¾ç½®åœ¨é¡¹ç›®çš„resourcesç›®å½•ä¸‹ï¼Œå› ä¸ºé…ç½®æ–‡ä»¶çš„ä¿®æ”¹ï¼Œé€šè¿‡çƒ­éƒ¨ç½²ä¸ç”¨é‡æ–°å¯åŠ¨é¡¹ç›®ï¼Œçƒ­éƒ¨ç½²ä½œç”¨èŒƒå›´æ˜¯classpathä¸‹</p>\n</li>\n</ul>\n<h1>8. springbootå®ç°å°†é…ç½®æ–‡ä»¶æ”¾åˆ°classpathï¼Œé‚£ä¹ˆæ‰€æœ‰çš„æ–‡ä»¶å°†ä¸å—æ‰€æ”¾ä½ç½®çš„å½±å“</h1>\n<ul>\n<li>Xbootclasspath/a:ä¸è·¯å¾„æ— ç©ºæ ¼ è·¯å¾„ä¸ºåŒjarè·¯å¾„ä¸‹çš„configæ–‡ä»¶ï¼Œæ­¤æ—¶æ‰€æœ‰çš„é…ç½®æ–‡ä»¶éƒ½ä¼šåƒclasspathä¸€æ ·åŠ è½½</li>\n<li>java -Xbootclasspath/a:/config/ -jar testspringbootMybaits-0.0.1-SNAPSHOT.jaræ³¨æ„æ­¤æ—¶çš„é…ç½®æ–‡ä»¶ä¼šè¦†ç›–åŸæ¥çš„é…ç½®ï¼ï¼ï¼ï¼ï¼ï¼</li>\n<li>/config/æ ¹ç›®å½•ï¼Œconfig/ç›¸å¯¹å½“å‰ç›®å½•</li>\n<li>jaråŒ…æŒ‡å®šç¼–ç å¯åŠ¨ java -Dfile.encoding=utf-8 -jar test.jar</li>\n</ul>\n<h1>9. SpringBoot è‡ªåŠ¨é…ç½®åŸç†ã€@EnableAutoConfigurationå®ç°åŸç†</h1>\n<ul>\n<li>@SpringBootApplicationæ³¨è§£åŒ…å«äº†@EnableAutoConfigurationï¼Œ@Configurationï¼ˆæŒ‡å®šç±»æ˜¯ Bean å®šä¹‰çš„é…ç½®ç±»ï¼‰ï¼Œ@ComponentScan(æ‰«ææŒ‡å®šåŒ…ä¸‹çš„ Bean),è€Œ@EnableAutoConfiguration(æ‰“å¼€è‡ªåŠ¨é…ç½®åŠŸèƒ½)ä½¿ç”¨äº†@Import({AutoConfigurationImportSelector.class}) è€ŒAutoConfigurationImportSelectorï¼Œä½¿ç”¨ImportSelectoræ¥å£çš„selectImportsæ–¹æ³•åŠ è½½META-INF/spring.factoriesæ–‡ä»¶çš„ä¿¡æ¯org.springframework.boot.autoconfigure.EnableAutoConfiguration=ï¼Œå°è£…æˆbeanNameï¼ŒåŠ è½½åˆ°IOCå®¹å™¨ä¸­ï¼Œå®ç°è‡ªåŠ¨é…ç½®åŠŸèƒ½</li>\n<li>SpringBootåœ¨å¯åŠ¨æ—¶æ‰«æé¡¹ç›®æ‰€ä¾èµ–çš„jaråŒ…ï¼Œå¯»æ‰¾åŒ…å«spring.factoriesæ–‡ä»¶çš„jar</li>\n<li>æ ¹æ®spring.factoriesé…ç½®åŠ è½½AutoConfigureç±»</li>\n<li>æ ¹æ®[@Conditional ç­‰æ¡ä»¶æ³¨è§£](Spring Boot æ¡ä»¶æ³¨è§£) çš„æ¡ä»¶ï¼Œè¿›è¡Œè‡ªåŠ¨é…ç½®å¹¶å°†Beanæ³¨å…¥Spring IoCä¸­</li>\n</ul>\n<h1>å¦‚ä½•è‡ªå®šä¹‰ä¸€ä¸ªSpringBoot Srarter?</h1>\n<ul>\n<li>å¼•å…¥ SpringBoot ç›¸å…³ä¾èµ–</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-configuration-processor&lt;/artifactId&gt;\n    &lt;optional&gt;true&lt;/optional&gt;\n&lt;/dependency&gt;\n\n</code></pre></div><ul>\n<li>ç¼–å†™é…ç½®æ–‡ä»¶:å®šä¹‰äº†å±æ€§é…ç½®çš„å‰ç¼€</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@ConfigurationProperties(prefix = \"hello\")\npublic class HelloProperties {\n    private String name;\n    //çœç•¥getterã€setter\n}\n\n</code></pre></div><ul>\n<li>è‡ªåŠ¨è£…é…</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Configuration\n@EnableConfigurationProperties(HelloProperties.class)\npublic class HelloPropertiesConfigure {\n}\n</code></pre></div><ul>\n<li>é…ç½®è‡ªåŠ¨ç±»:åœ¨/resources/META-INF/spring.factoriesæ–‡ä»¶ä¸­æ·»åŠ è‡ªåŠ¨é…ç½®ç±»è·¯å¾„</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>org.springframework.boot.autoconfigure.EnableAutoConfiguration=\\\n    cn.fighter3.demo.starter.configure.HelloPropertiesConfigure\n\n</code></pre></div><h1>Springboot å¯åŠ¨åŸç†ï¼Ÿ</h1>\n<ul>\n<li>SpringApplicationè¿™ä¸ªç±»ä¸»è¦åšäº†ä»¥ä¸‹å››ä»¶äº‹æƒ…ï¼š\n<ul>\n<li>æ¨æ–­åº”ç”¨çš„ç±»å‹æ˜¯æ™®é€šçš„é¡¹ç›®è¿˜æ˜¯ Web é¡¹ç›®</li>\n<li>æŸ¥æ‰¾å¹¶åŠ è½½æ‰€æœ‰å¯ç”¨åˆå§‹åŒ–å™¨ ï¼Œ è®¾ç½®åˆ° initializers å±æ€§ä¸­</li>\n<li>æ‰¾å‡ºæ‰€æœ‰çš„åº”ç”¨ç¨‹åºç›‘å¬å™¨ï¼Œè®¾ç½®åˆ° listeners å±æ€§ä¸­</li>\n<li>æ¨æ–­å¹¶è®¾ç½® main æ–¹æ³•çš„å®šä¹‰ç±»ï¼Œæ‰¾åˆ°è¿è¡Œçš„ä¸»ç±»<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4c9e3994321ee4a06a9e5.png\" alt=\"springbootstart.png\"></li>\n</ul>\n</li>\n<li>ä¸ºä»€ä¹ˆSpringBootåœ¨å¯åŠ¨çš„æ—¶å€™èƒ½å¤Ÿæ‰¾åˆ°mainæ–¹æ³•ä¸Šçš„@SpringBootApplicationæ³¨è§£ï¼Ÿ</li>\n<li>å› ä¸ºå®ƒåˆ©ç”¨äº†Javaçš„åå°„æœºåˆ¶å’Œç±»åŠ è½½æœºåˆ¶ï¼ŒSpringApplication.run(Class&lt;?&gt;primarySource,String...args)æ–¹æ³•æ¥æ”¶ä¸¤ä¸ªå‚æ•°ï¼šç¬¬ä¸€ä¸ªæ˜¯ä¸»åº”ç”¨ç±»ï¼ˆå³åŒ…å«mainæ–¹æ³•çš„ç±»ï¼‰ï¼Œç¬¬äºŒä¸ªæ˜¯å‘½ä»¤è¡Œå‚æ•°ã€‚primarySourceå‚æ•°æä¾›äº†ä¸€ä¸ªèµ·ç‚¹ï¼ŒSpringBooté€šè¿‡å®ƒæ¥åŠ è½½åº”ç”¨ä¸Šä¸‹æ–‡ã€‚</li>\n<li>SpringBootåˆ©ç”¨Javaåå°„æœºåˆ¶æ¥è¯»å–ä¼ é€’ç»™runæ–¹æ³•çš„ç±»ï¼ˆMyApplication.classï¼‰ã€‚å®ƒä¼šæ£€æŸ¥è¿™ä¸ªç±»ä¸Šçš„æ³¨è§£ï¼ŒåŒ…æ‹¬@SpringBootApplicationã€‚</li>\n</ul>\n<h1>Spring Boot é»˜è®¤çš„åŒ…æ‰«æè·¯å¾„æ˜¯ä»€ä¹ˆï¼Ÿ</h1>\n<ul>\n<li>ä»¥å¯åŠ¨ç±» @SpringBootApplication æ³¨è§£æ‰€åœ¨çš„åŒ…ä¸ºæ ¹ç›®å½•çš„ï¼Œé»˜è®¤æƒ…å†µä¼šæ‰«æå¯åŠ¨ç±»æ‰€åœ¨åŒ…åŠå…¶å­åŒ…ä¸‹çš„æ‰€æœ‰ç»„ä»¶ã€‚</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/4c9e3994321ee4a06a9e5.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "springcloud",
      "url": "https://javaguide.cn/interview/springcloud.html",
      "id": "https://javaguide.cn/interview/springcloud.html",
      "summary": "ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ å¾®æœåŠ¡ï¼ˆMicroservicesï¼‰æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œå°†ä¸€ä¸ªå¤§å‹åº”ç”¨ç¨‹åºåˆ’åˆ†ä¸ºä¸€ç»„å°å‹ã€è‡ªæ²»ä¸”æ¾è€¦åˆçš„æœåŠ¡ã€‚æ¯ä¸ªå¾®æœåŠ¡è´Ÿè´£æ‰§è¡Œç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œå¹¶é€šè¿‡è½»é‡çº§é€šä¿¡æœºåˆ¶ï¼ˆå¦‚HTTPï¼‰ç›¸äº’åä½œã€‚æ¯ä¸ªå¾®æœåŠ¡å¯ä»¥ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²å’Œæ‰©å±•ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´åŠ çµæ´»ã€å¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤ã€‚ åœ¨å¾®æœåŠ¡çš„æ¶æ„æ¼”è¿›æ–¹å‘ï¼šå•ä½“å¼-->æœåŠ¡åŒ–SOAï¼ˆService-Orie...",
      "content_html": "<!-- TOC -->\n<!-- /TOC -->\n<h1>ä»€ä¹ˆæ˜¯å¾®æœåŠ¡ï¼Ÿ</h1>\n<ul>\n<li>å¾®æœåŠ¡ï¼ˆMicroservicesï¼‰æ˜¯ä¸€ç§è½¯ä»¶æ¶æ„é£æ ¼ï¼Œå°†ä¸€ä¸ªå¤§å‹åº”ç”¨ç¨‹åºåˆ’åˆ†ä¸ºä¸€ç»„å°å‹ã€è‡ªæ²»ä¸”æ¾è€¦åˆçš„æœåŠ¡ã€‚æ¯ä¸ªå¾®æœåŠ¡è´Ÿè´£æ‰§è¡Œç‰¹å®šçš„ä¸šåŠ¡åŠŸèƒ½ï¼Œå¹¶é€šè¿‡è½»é‡çº§é€šä¿¡æœºåˆ¶ï¼ˆå¦‚HTTPï¼‰ç›¸äº’åä½œã€‚æ¯ä¸ªå¾®æœåŠ¡å¯ä»¥ç‹¬ç«‹å¼€å‘ã€éƒ¨ç½²å’Œæ‰©å±•ï¼Œä½¿å¾—åº”ç”¨ç¨‹åºæ›´åŠ çµæ´»ã€å¯ä¼¸ç¼©å’Œå¯ç»´æŠ¤ã€‚</li>\n<li>åœ¨å¾®æœåŠ¡çš„æ¶æ„æ¼”è¿›æ–¹å‘ï¼šå•ä½“å¼--&gt;æœåŠ¡åŒ–SOAï¼ˆService-Oriented Architectureï¼Œé¢å‘æœåŠ¡çš„æ¶æ„ï¼‰--&gt;å¾®æœåŠ¡ã€‚</li>\n<li>å¾®æœåŠ¡æ˜¯ä¸€ç§ç‰¹å®šçš„æ¶æ„é£æ ¼ï¼Œè€ŒSOAæ˜¯ä¸€ç§è®¾è®¡åŸåˆ™ã€‚å¾®æœåŠ¡å¯ä»¥çœ‹ä½œæ˜¯å¯¹SOAæ€æƒ³çš„ä¸€ç§å…·ä½“å®è·µæ–¹å¼ï¼Œä½†å¹¶ä¸ç­‰åŒäºSOAã€‚</li>\n<li>SOAå…³æ³¨äºæœåŠ¡çš„é‡ç”¨æ€§å’Œç»„åˆæ€§ï¼Œä½†å¹¶æ²¡æœ‰å…·ä½“è§„å®šæœåŠ¡çš„å¤§å°</li>\n</ul>\n<h1>å¾®æœåŠ¡ç»„ä»¶ï¼Ÿ</h1>\n<ul>\n<li>æ³¨å†Œä¸­å¿ƒï¼šç”¨äºæœåŠ¡çš„æ³¨å†Œä¸å‘ç°ï¼Œç®¡ç†å¾®æœåŠ¡çš„åœ°å€ä¿¡æ¯ã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Netflixï¼šEurekaã€Consul</li>\n<li>Spring Cloud Alibabaï¼šNacos</li>\n</ul>\n</li>\n<li>é…ç½®ä¸­å¿ƒï¼šç”¨äºé›†ä¸­ç®¡ç†å¾®æœåŠ¡çš„é…ç½®ä¿¡æ¯ï¼Œå¯ä»¥åŠ¨æ€ä¿®æ”¹é…ç½®è€Œä¸éœ€è¦é‡å¯æœåŠ¡ã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Netflixï¼šSpring Cloud Config</li>\n<li>Spring Cloud Alibabaï¼šNacos Config</li>\n</ul>\n</li>\n<li>è¿œç¨‹è°ƒç”¨ï¼šç”¨äºåœ¨ä¸åŒçš„å¾®æœåŠ¡ä¹‹é—´è¿›è¡Œé€šä¿¡å’Œåä½œã€‚å¸¸è§çš„å®ç°ä¿åŒ…æ‹¬ï¼š\n<ul>\n<li>RESTful APIï¼šå¦‚RestTemplateã€Feign</li>\n<li>RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰ï¼šå¦‚Dubboã€gRPC</li>\n</ul>\n</li>\n<li>APIç½‘å…³ï¼šä½œä¸ºå¾®æœåŠ¡æ¶æ„çš„å…¥å£ï¼Œç»Ÿä¸€æš´éœ²æœåŠ¡ï¼Œå¹¶æä¾›è·¯ç”±ã€è´Ÿè½½å‡è¡¡ã€å®‰å…¨è®¤è¯ç­‰åŠŸèƒ½ã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Netflixï¼šZuulã€Gateway</li>\n<li>Spring Cloud Alibabaï¼šGatewayã€Apisixç­‰</li>\n</ul>\n</li>\n<li>åˆ†å¸ƒå¼äº‹åŠ¡ï¼šä¿è¯è·¨å¤šä¸ªå¾®æœåŠ¡çš„ä¸€è‡´æ€§å’ŒåŸå­æ€§æ“ä½œã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Alibabaï¼šSeata</li>\n</ul>\n</li>\n<li>ç†”æ–­å™¨ï¼šç”¨äºé˜²æ­¢å¾®æœåŠ¡ä¹‹é—´çš„æ•…éšœæ‰©æ•£ï¼Œæé«˜ç³»ç»Ÿçš„å®¹é”™èƒ½åŠ›ã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Netflixï¼šHystrix</li>\n<li>Spring Cloud Alibabaï¼šSentinelã€Resilience4j</li>\n</ul>\n</li>\n<li>é™æµå’Œé™çº§ï¼šç”¨äºé˜²æ­¢å¾®æœåŠ¡è¿‡è½½ï¼Œå¯¹è¯·æ±‚è¿›è¡Œé™åˆ¶å’Œé™çº§å¤„ç†ã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Netflixï¼šHystrix</li>\n<li>Spring Cloud Alibabaï¼šSentinel</li>\n</ul>\n</li>\n<li>åˆ†å¸ƒå¼è¿½è¸ªå’Œç›‘æ§ï¼šç”¨äºè·Ÿè¸ªå’Œç›‘æ§å¾®æœåŠ¡çš„è¯·æ±‚æµç¨‹å’Œæ€§èƒ½æŒ‡æ ‡ã€‚å¸¸è§çš„å®ç°åŒ…æ‹¬ï¼š\n<ul>\n<li>Spring Cloud Netflixï¼šSpring Cloud Sleuth + Zipkin</li>\n<li>Spring Cloud Alibabaï¼šSkyWalkingã€Sentinel Dashboard</li>\n</ul>\n</li>\n</ul>\n<h1>æ³¨å†Œä¸­å¿ƒæ˜¯ç”¨æ¥å¹²ä»€ä¹ˆçš„ï¼Ÿ</h1>\n<ul>\n<li>æ³¨å†Œä¸­å¿ƒæ˜¯ç”¨æ¥ç®¡ç†å’Œç»´æŠ¤åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å„ä¸ªæœåŠ¡çš„åœ°å€å’Œå…ƒæ•°æ®çš„ç»„ä»¶ã€‚å®ƒä¸»è¦ç”¨äºå®ç°æœåŠ¡å‘ç°å’ŒæœåŠ¡æ³¨å†ŒåŠŸèƒ½ã€‚\n<ul>\n<li>æœåŠ¡æ³¨å†Œï¼šå„ä¸ªæœåŠ¡åœ¨å¯åŠ¨æ—¶å‘æ³¨å†Œä¸­å¿ƒæ³¨å†Œè‡ªå·±çš„ç½‘ç»œåœ°å€ã€æœåŠ¡å®ä¾‹ä¿¡æ¯å’Œå…¶ä»–ç›¸å…³å…ƒæ•°æ®ã€‚è¿™æ ·ï¼Œå…¶ä»–æœåŠ¡å°±å¯ä»¥é€šè¿‡æ³¨å†Œä¸­å¿ƒè·å–åˆ°å½“å‰å¯ç”¨çš„æœåŠ¡åˆ—è¡¨ã€‚</li>\n<li>æœåŠ¡å‘ç°ï¼šå®¢æˆ·ç«¯é€šè¿‡å‘æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢ç‰¹å®šæœåŠ¡çš„æ³¨å†Œä¿¡æ¯ï¼Œè·å¾—å¯ç”¨çš„æœåŠ¡å®ä¾‹åˆ—è¡¨ã€‚è¿™æ ·å®¢æˆ·ç«¯å°±å¯ä»¥æ ¹æ®éœ€è¦é€‰æ‹©åˆé€‚çš„æœåŠ¡è¿›è¡Œè°ƒç”¨ï¼Œå®ç°äº†æœåŠ¡é—´çš„è§£è€¦ã€‚</li>\n<li>è´Ÿè½½å‡è¡¡ï¼šå¯¹åŒä¸€æœåŠ¡çš„å¤šä¸ªå®ä¾‹è¿›è¡Œè´Ÿè½½å‡è¡¡ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°ä¸åŒçš„å®ä¾‹ä¸Šï¼Œæé«˜æ•´ä½“çš„ç³»ç»Ÿæ€§èƒ½å’Œå¯ç”¨æ€§ã€‚</li>\n<li>æ•…éšœæ¢å¤ï¼šç›‘æµ‹å’Œæ£€æµ‹æœåŠ¡çš„çŠ¶æ€ï¼Œå½“æœåŠ¡å®ä¾‹å‘ç”Ÿæ•…éšœæˆ–ä¸‹çº¿æ—¶ï¼Œå¯ä»¥åŠæ—¶æ›´æ–°æ³¨å†Œä¿¡æ¯ï¼Œä»è€Œä¿è¯æœåŠ¡èƒ½å¤Ÿæ­£å¸¸å·¥ä½œã€‚</li>\n<li>æœåŠ¡æ²»ç†ï¼šè¿›è¡ŒæœåŠ¡çš„é…ç½®ç®¡ç†ã€åŠ¨æ€æ‰©ç¼©å®¹ã€æœåŠ¡è·¯ç”±ã€ç°åº¦å‘å¸ƒç­‰æ“ä½œï¼Œå®ç°å¯¹æœåŠ¡çš„åŠ¨æ€ç®¡ç†å’Œæ§åˆ¶</li>\n</ul>\n</li>\n</ul>\n<h1>è¯´ä¸‹Eurekaã€ZooKeeperã€Nacosçš„åŒºåˆ«ï¼Ÿâˆš</h1>\n<table>\n<thead>\n<tr>\n<th>ç‰¹æ€§</th>\n<th>Eureka</th>\n<th>ZooKeeper</th>\n<th>Nacos</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å¼€å‘å…¬å¸</td>\n<td>Netflix</td>\n<td>Apache åŸºé‡‘ä¼š</td>\n<td>é˜¿é‡Œå·´å·´</td>\n</tr>\n<tr>\n<td>CAP</td>\n<td>APï¼ˆå¯ç”¨æ€§å’Œåˆ†åŒºå®¹å¿æ€§ï¼‰</td>\n<td>CPï¼ˆä¸€è‡´æ€§å’Œåˆ†åŒºå®¹å¿æ€§ï¼‰</td>\n<td>æ—¢æ”¯æŒAPï¼Œä¹Ÿæ”¯æŒCP</td>\n</tr>\n<tr>\n<td>åŠŸèƒ½</td>\n<td>æœåŠ¡æ³¨å†Œä¸å‘ç°</td>\n<td>åˆ†å¸ƒå¼åè°ƒã€é…ç½®ç®¡ç†ã€åˆ†å¸ƒå¼é”</td>\n<td>æœåŠ¡æ³¨å†Œä¸å‘ç°ã€é…ç½®ç®¡ç†ã€æœåŠ¡ç®¡ç†</td>\n</tr>\n<tr>\n<td>å®šä½</td>\n<td>é€‚ç”¨äºæ„å»ºåŸºäº HTTP çš„å¾®æœåŠ¡æ¶æ„</td>\n<td>é€šç”¨çš„åˆ†å¸ƒå¼åè°ƒæœåŠ¡æ¡†æ¶</td>\n<td>é€‚ç”¨äºå¾®æœåŠ¡å’Œäº‘åŸç”Ÿåº”ç”¨</td>\n</tr>\n<tr>\n<td>è®¿é—®åè®®</td>\n<td>HTTP</td>\n<td>TCP</td>\n<td>HTTP/DNS</td>\n</tr>\n<tr>\n<td>è‡ªæˆ‘ä¿æŠ¤</td>\n<td>æ”¯æŒ</td>\n<td>-</td>\n<td>æ”¯æŒ</td>\n</tr>\n<tr>\n<td>æ•°æ®å­˜å‚¨</td>\n<td>å†…åµŒæ•°æ®åº“ã€å¤šä¸ªå®ä¾‹å½¢æˆé›†ç¾¤</td>\n<td>ACID ç‰¹æ€§çš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿ ZAB åè®®</td>\n<td>å†…åµŒæ•°æ®åº“ã€MySQL ç­‰</td>\n</tr>\n<tr>\n<td>å¥åº·æ£€æŸ¥</td>\n<td>Client Beat</td>\n<td>Keep Alive</td>\n<td>TCP/HTTP/MYSQL/Client Beat</td>\n</tr>\n<tr>\n<td>ç‰¹ç‚¹</td>\n<td>ç®€å•æ˜“ç”¨ã€è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶</td>\n<td>é«˜æ€§èƒ½ã€å¼ºä¸€è‡´æ€§</td>\n<td>åŠ¨æ€é…ç½®ç®¡ç†ã€æµé‡ç®¡ç†ã€ç°åº¦å‘å¸ƒç­‰</td>\n</tr>\n<tr>\n<td>å¯ä»¥çœ‹åˆ°Eurekaå’ŒZooKeeperçš„æœ€å¤§åŒºåˆ«æ˜¯ä¸€ä¸ªæ”¯æŒAPï¼Œä¸€ä¸ªæ”¯æŒCPï¼ŒNacosæ—¢æ”¯æŒæ—¢æ”¯æŒAPï¼Œä¹Ÿæ”¯æŒCPã€‚</td>\n<td></td>\n<td></td>\n<td></td>\n</tr>\n</tbody>\n</table>\n<h1>Eurekaå®ç°åŸç†äº†è§£å—ï¼Ÿ</h1>\n<ul>\n<li>æœåŠ¡æ³¨å†Œä¸å‘ç°: å½“ä¸€ä¸ªæœåŠ¡å®ä¾‹å¯åŠ¨æ—¶ï¼Œå®ƒä¼šå‘Eureka Serverå‘é€æ³¨å†Œè¯·æ±‚ï¼Œå°†è‡ªå·±çš„ä¿¡æ¯æ³¨å†Œåˆ°æ³¨å†Œä¸­å¿ƒã€‚Eureka Serverä¼šå°†è¿™äº›ä¿¡æ¯ä¿å­˜åœ¨å†…å­˜ä¸­ï¼Œå¹¶æä¾›RESTæ¥å£ä¾›å…¶ä»–æœåŠ¡æŸ¥è¯¢ã€‚æœåŠ¡æ¶ˆè´¹è€…å¯ä»¥é€šè¿‡æŸ¥è¯¢æœåŠ¡å®ä¾‹åˆ—è¡¨æ¥è·å–å¯ç”¨çš„æœåŠ¡æä¾›è€…å®ä¾‹ï¼Œä»è€Œå®ç°æœåŠ¡çš„å‘ç°ã€‚</li>\n<li>æœåŠ¡å¥åº·æ£€æŸ¥: Eurekaé€šè¿‡å¿ƒè·³æœºåˆ¶æ¥æ£€æµ‹æœåŠ¡å®ä¾‹çš„å¥åº·çŠ¶æ€ã€‚æœåŠ¡å®ä¾‹ä¼šå®šæœŸå‘Eureka Serverå‘é€å¿ƒè·³ï¼Œä¹Ÿå°±æ˜¯ç»­çº¦ï¼Œä»¥è¡¨æ˜è‡ªå·±çš„å­˜æ´»çŠ¶æ€ã€‚å¦‚æœEureka Serveråœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°æŸä¸ªæœåŠ¡å®ä¾‹çš„å¿ƒè·³ï¼Œåˆ™ä¼šå°†å…¶æ ‡è®°ä¸ºä¸å¯ç”¨ï¼Œå¹¶ä»æœåŠ¡åˆ—è¡¨ä¸­ç§»é™¤ï¼Œä¸‹çº¿å®ä¾‹ã€‚</li>\n<li>æœåŠ¡è´Ÿè½½å‡è¡¡: Eurekaå®¢æˆ·ç«¯åœ¨è°ƒç”¨å…¶ä»–æœåŠ¡æ—¶ï¼Œä¼šä»æœ¬åœ°ç¼“å­˜ä¸­è·å–æœåŠ¡çš„æ³¨å†Œä¿¡æ¯ã€‚å¦‚æœç¼“å­˜ä¸­æ²¡æœ‰å¯¹åº”çš„ä¿¡æ¯ï¼Œåˆ™ä¼šå‘Eureka Serverå‘é€æŸ¥è¯¢è¯·æ±‚ã€‚Eureka Serverä¼šè¿”å›ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡å®ä¾‹åˆ—è¡¨ç»™å®¢æˆ·ç«¯ï¼Œå®¢æˆ·ç«¯å¯ä»¥ä½¿ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›è¡Œè°ƒç”¨ã€‚</li>\n</ul>\n<h1>Eureka Serveræ€ä¹ˆä¿è¯é«˜å¯ç”¨ï¼Ÿ</h1>\n<ul>\n<li>å¤šå®ä¾‹éƒ¨ç½²: é€šè¿‡å°†å¤šä¸ªEureka Serverå®ä¾‹éƒ¨ç½²åœ¨ä¸åŒçš„èŠ‚ç‚¹ä¸Šï¼Œå¯ä»¥å®ç°é«˜å¯ç”¨æ€§ã€‚å½“å…¶ä¸­ä¸€ä¸ªå®ä¾‹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå…¶ä»–å®ä¾‹ä»ç„¶å¯ä»¥æä¾›æœåŠ¡ï¼Œå¹¶ä¿æŒæ³¨å†Œä¿¡æ¯çš„ä¸€è‡´æ€§ã€‚</li>\n<li>æœåŠ¡æ³¨å†Œä¿¡æ¯çš„å¤åˆ¶: å½“ä¸€ä¸ªæœåŠ¡å®ä¾‹å‘Eureka Serveræ³¨å†Œæ—¶ï¼Œæ¯ä¸ªEureka Serverå®ä¾‹éƒ½ä¼šå¤åˆ¶å…¶ä»–å®ä¾‹çš„æ³¨å†Œä¿¡æ¯ï¼Œä»¥ä¿æŒæ•°æ®çš„ä¸€è‡´æ€§ã€‚å½“æŸä¸ªEureka Serverå®ä¾‹å‘ç”Ÿæ•…éšœæ—¶ï¼Œå…¶ä»–å®ä¾‹å¯ä»¥æ¥ç®¡å…¶å·¥ä½œï¼Œä¿è¯æ•´ä¸ªç³»ç»Ÿçš„æ­£å¸¸è¿è¡Œã€‚</li>\n<li>è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶: Eurekaè¿˜å…·æœ‰è‡ªæˆ‘ä¿æŠ¤æœºåˆ¶ã€‚å½“Eureka ServerèŠ‚ç‚¹åœ¨ä¸€å®šæ—¶é—´å†…æ²¡æœ‰æ¥æ”¶åˆ°å¿ƒè·³æ—¶ï¼Œå®ƒä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚åœ¨è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ä¸‹ï¼ŒEureka Serverä¸å†å‰”é™¤æ³¨å†Œè¡¨ä¸­çš„æœåŠ¡å®ä¾‹ï¼Œä»¥ä¿æŠ¤ç°æœ‰çš„æ³¨å†Œä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥é˜²æ­¢ç”±äºç½‘ç»œæŠ–åŠ¨æˆ–å…¶ä»–åŸå› å¯¼è‡´çš„è¯¯å‰”é™¤ï¼Œè¿›ä¸€æ­¥æé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§ã€‚</li>\n</ul>\n<h1>ä¸ºä»€ä¹ˆå¾®æœåŠ¡éœ€è¦é…ç½®ä¸­å¿ƒï¼Ÿ</h1>\n<ul>\n<li>å¾®æœåŠ¡æ¶æ„ä¸­çš„æ¯ä¸ªæœåŠ¡é€šå¸¸éƒ½éœ€è¦ä¸€äº›é…ç½®ä¿¡æ¯ï¼Œä¾‹å¦‚æ•°æ®åº“è¿æ¥åœ°å€ã€æœåŠ¡ç«¯å£ã€æ—¥å¿—çº§åˆ«ç­‰ã€‚è¿™äº›é…ç½®å¯èƒ½å› ä¸ºä¸åŒç¯å¢ƒã€ä¸åŒéƒ¨ç½²å®ä¾‹æˆ–è€…åŠ¨æ€è¿è¡Œæ—¶éœ€è¦è¿›è¡Œè°ƒæ•´å’Œç®¡ç†ã€‚</li>\n<li>å¾®æœåŠ¡çš„å®ä¾‹ä¸€èˆ¬éå¸¸å¤šï¼Œå¦‚æœæ¯ä¸ªå®ä¾‹éƒ½éœ€è¦ä¸€ä¸ªä¸ªåœ°å»åšè¿™äº›é…ç½®ï¼Œé‚£ä¹ˆè¿ç»´æˆæœ¬å°†ä¼šéå¸¸å¤§ï¼Œè¿™æ—¶å€™å°±éœ€è¦ä¸€ä¸ªé›†ä¸­åŒ–çš„é…ç½®ä¸­å¿ƒï¼Œå»ç®¡ç†è¿™äº›é…ç½®ã€‚</li>\n</ul>\n<h1>Nacosé…ç½®ä¸­å¿ƒçš„åŸç†</h1>\n<ul>\n<li>é…ç½®ä¿¡æ¯å­˜å‚¨ï¼šNacosé»˜è®¤ä½¿ç”¨å†…åµŒæ•°æ®åº“Derbyæ¥å­˜å‚¨é…ç½®ä¿¡æ¯ï¼Œè¿˜å¯ä»¥é‡‡ç”¨MySQLç­‰å…³ç³»å‹æ•°æ®åº“ã€‚</li>\n<li>æ³¨å†Œé…ç½®ä¿¡æ¯ï¼šæœåŠ¡å¯åŠ¨æ—¶ï¼ŒNacos Clientä¼šå‘Nacos Serveræ³¨å†Œè‡ªå·±çš„é…ç½®ä¿¡æ¯ï¼Œè¿™ä¸ªæ³¨å†Œè¿‡ç¨‹å°±æ˜¯æŠŠé…ç½®ä¿¡æ¯å†™å…¥å­˜å‚¨ï¼Œå¹¶ç”Ÿæˆç‰ˆæœ¬å·ã€‚</li>\n<li>è·å–é…ç½®ä¿¡æ¯ï¼šæœåŠ¡è¿è¡ŒæœŸé—´ï¼ŒNacos Clienté€šè¿‡APIä»Nacos Serverè·å–é…ç½®ä¿¡æ¯ã€‚Serveræ ¹æ®é”®æŸ¥æ‰¾å¯¹åº”çš„é…ç½®ä¿¡æ¯ï¼Œå¹¶è¿”å›ç»™Clientã€‚</li>\n<li>ç›‘å¬é…ç½®å˜åŒ–ï¼šNacos Clientå¯ä»¥é€šè¿‡æ³¨å†Œç›‘å¬å™¨çš„æ–¹å¼ï¼Œå®ç°å¯¹é…ç½®ä¿¡æ¯çš„ç›‘å¬ã€‚å½“é…ç½®ä¿¡æ¯å‘ç”Ÿå˜åŒ–æ—¶ï¼ŒNacos Serverä¼šé€šçŸ¥å·²æ³¨å†Œçš„ç›‘å¬å™¨ï¼Œå¹¶è§¦å‘ç›¸åº”çš„å›è°ƒæ–¹æ³•ã€‚</li>\n</ul>\n<h1>Nacosé…ç½®ä¸­å¿ƒé•¿è½®è¯¢æœºåˆ¶ï¼Ÿ</h1>\n<ul>\n<li>ä¸€èˆ¬æ¥è¯´å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯çš„äº¤äº’åˆ†ä¸ºä¸¤ç§ï¼šæ¨ï¼ˆPushï¼‰å’Œæ‹‰ï¼ˆPullï¼‰ï¼ŒNacosåœ¨Pullçš„åŸºç¡€ä¸Šï¼Œé‡‡ç”¨äº†é•¿è½®è¯¢æ¥è¿›è¡Œé…ç½®çš„åŠ¨æ€åˆ·æ–°ã€‚</li>\n<li>å®¢æˆ·ç«¯å‘èµ·Pullè¯·æ±‚ï¼ŒæœåŠ¡ç«¯æ£€æŸ¥é…ç½®æ˜¯å¦æœ‰å˜æ›´ã€‚å¦‚æœæ²¡æœ‰å˜æ›´ï¼Œåˆ™è®¾ç½®ä¸€ä¸ªå®šæ—¶ä»»åŠ¡ï¼Œåœ¨ä¸€æ®µæ—¶é—´åæ‰§è¡Œï¼Œå¹¶å°†å½“å‰çš„å®¢æˆ·ç«¯è¿æ¥åŠ å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li>\n<li>åœ¨ç­‰å¾…æœŸé—´ï¼Œå¦‚æœé…ç½®å‘ç”Ÿå˜æ›´ï¼ŒæœåŠ¡ç«¯ä¼šç«‹å³è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ï¼Œå®Œæˆä¸€æ¬¡\"æ¨é€\"æ“ä½œã€‚<br>\nå¦‚æœåœ¨ç­‰å¾…æœŸé—´æ²¡æœ‰é…ç½®å˜æ›´ï¼Œç­‰å¾…æ—¶é—´è¾¾åˆ°é¢„è®¾çš„è¶…æ—¶æ—¶é—´åï¼ŒæœåŠ¡ç«¯ä¼šè‡ªåŠ¨è¿”å›ç»“æœç»™å®¢æˆ·ç«¯ï¼Œå³ä½¿é…ç½®æ²¡æœ‰å˜æ›´ã€‚</li>\n<li>å¦‚æœåœ¨ç­‰å¾…æœŸé—´ï¼Œé€šè¿‡Nacos Dashboardæˆ–APIå¯¹é…ç½®è¿›è¡Œäº†ä¿®æ”¹ï¼Œä¼šè§¦å‘ä¸€ä¸ªäº‹ä»¶æœºåˆ¶ï¼ŒæœåŠ¡ç«¯ä¼šéå†ç­‰å¾…é˜Ÿåˆ—ï¼Œæ‰¾åˆ°å‘ç”Ÿå˜æ›´çš„é…ç½®é¡¹å¯¹åº”çš„å®¢æˆ·ç«¯è¿æ¥ï¼Œå¹¶å°†å˜æ›´çš„æ•°æ®é€šè¿‡è¿æ¥è¿”å›ï¼Œå®Œæˆä¸€æ¬¡\"æ¨é€\"æ“ä½œã€‚</li>\n<li>é€šè¿‡é•¿è½®è¯¢çš„æ–¹å¼ï¼ŒNacoså®¢æˆ·ç«¯èƒ½å¤Ÿå®æ—¶æ„ŸçŸ¥é…ç½®çš„å˜åŒ–ï¼Œå¹¶åŠæ—¶è·å–æœ€æ–°çš„é…ç½®ä¿¡æ¯ã€‚åŒæ—¶ï¼Œè¿™ç§æ–¹å¼ä¹Ÿé™ä½äº†æœåŠ¡ç«¯çš„å‹åŠ›ï¼Œé¿å…äº†å¤§é‡çš„é•¿è¿æ¥å ç”¨å†…å­˜èµ„æºã€‚</li>\n</ul>\n<h1>èƒ½è¯´ä¸‹HTTPå’ŒRPCçš„åŒºåˆ«å—ï¼Ÿ</h1>\n<ul>\n<li>HTTPï¼ˆHypertext Transfer Protocolï¼‰æ˜¯ä¸€ç§åº”ç”¨å±‚åè®®ï¼Œä¸»è¦å¼ºè°ƒçš„æ˜¯ç½‘ç»œé€šä¿¡ï¼›</li>\n<li>RPCï¼ˆRemote Procedure Callï¼Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ˜¯ä¸€ç§ç”¨äºåˆ†å¸ƒå¼ç³»ç»Ÿä¹‹é—´é€šä¿¡çš„åè®®ï¼Œå¼ºè°ƒçš„æ˜¯æœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨ã€‚</li>\n<li>åœ¨å¾®æœåŠ¡ä½“ç³»é‡Œï¼ŒåŸºäºHTTPé£æ ¼çš„è¿œç¨‹è°ƒç”¨é€šå¸¸ä½¿ç”¨æ¡†æ¶å¦‚Feignæ¥å®ç°ï¼ŒåŸºäºRPCçš„è¿œç¨‹è°ƒç”¨é€šå¸¸ä½¿ç”¨æ¡†æ¶å¦‚Dubboæ¥å®ç°ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th>-</th>\n<th>HTTP</th>\n<th>RPC</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å®šä¹‰</td>\n<td>HTTPï¼ˆè¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼‰æ˜¯ä¸€ç§ç”¨äºä¼ è¾“è¶…æ–‡æœ¬çš„åè®®ã€‚</td>\n<td>RPCï¼ˆè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ï¼‰æ˜¯ä¸€ç§ç”¨äºå®ç°åˆ†å¸ƒå¼ç³»ç»Ÿä¸­ä¸åŒèŠ‚ç‚¹ä¹‹é—´é€šä¿¡çš„åè®®ã€‚</td>\n</tr>\n<tr>\n<td>é€šä¿¡æ–¹å¼</td>\n<td>åŸºäºè¯·æ±‚-å“åº”æ¨¡å‹ï¼Œå®¢æˆ·ç«¯å‘é€è¯·æ±‚ï¼ŒæœåŠ¡å™¨è¿”å›å“åº”ã€‚</td>\n<td>åŸºäºæ–¹æ³•è°ƒç”¨æ¨¡å‹ï¼Œå®¢æˆ·ç«¯è°ƒç”¨è¿œç¨‹æ–¹æ³•å¹¶ç­‰å¾…ç»“æœã€‚</td>\n</tr>\n<tr>\n<td>ä¼ è¾“åè®®</td>\n<td>åŸºäºTCPåè®®ï¼Œå¯ä½¿ç”¨å…¶ä»–ä¼ è¾“å±‚åè®®å¦‚TLS/SSLè¿›è¡Œå®‰å…¨åŠ å¯†ã€‚</td>\n<td>å¯ä»¥ä½¿ç”¨å¤šç§ä¼ è¾“åè®®ï¼Œå¦‚TCPã€UDPç­‰ã€‚</td>\n</tr>\n<tr>\n<td>æ•°æ®æ ¼å¼</td>\n<td>åŸºäºæ–‡æœ¬ï¼Œå¸¸ç”¨çš„æ•°æ®æ ¼å¼æœ‰JSONã€XMLç­‰ã€‚</td>\n<td>å¯ä»¥ä½¿ç”¨å„ç§æ•°æ®æ ¼å¼ï¼Œå¦‚äºŒè¿›åˆ¶ã€JSONã€Protocol Buffersç­‰ã€‚</td>\n</tr>\n<tr>\n<td>æ¥å£å®šä¹‰</td>\n<td>ä½¿ç”¨RESTfulé£æ ¼çš„æ¥å£è¿›è¡Œå®šä¹‰ï¼Œå¸¸ç”¨çš„æ–¹æ³•æœ‰GETã€POSTã€PUTã€DELETEç­‰ã€‚</td>\n<td>ä½¿ç”¨IDLï¼ˆæ¥å£å®šä¹‰è¯­è¨€ï¼‰è¿›è¡Œæ¥å£å®šä¹‰ï¼Œå¦‚Protocol Buffersã€Thriftç­‰ã€‚</td>\n</tr>\n<tr>\n<td>è·¨è¯­è¨€æ€§</td>\n<td>æ”¯æŒè·¨è¯­è¨€é€šä¿¡ï¼Œå¯ä»¥ä½¿ç”¨HTTPä½œä¸ºé€šä¿¡åè®®å®ç°ä¸åŒè¯­è¨€ä¹‹é—´çš„é€šä¿¡ã€‚</td>\n<td>æ”¯æŒè·¨è¯­è¨€é€šä¿¡ï¼Œå¯ä»¥ä½¿ç”¨IDLç”Ÿæˆä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä»£ç ã€‚</td>\n</tr>\n<tr>\n<td>çµæ´»æ€§</td>\n<td>æ›´åŠ çµæ´»ï¼Œé€‚ç”¨äºä¸åŒç±»å‹çš„åº”ç”¨åœºæ™¯ï¼Œå¦‚Webå¼€å‘ã€APIè°ƒç”¨ç­‰ã€‚</td>\n<td>æ›´åŠ é«˜æ•ˆï¼Œé€‚ç”¨äºéœ€è¦é«˜æ€§èƒ½å’Œä½å»¶è¿Ÿçš„åˆ†å¸ƒå¼ç³»ç»Ÿã€‚</td>\n</tr>\n</tbody>\n</table>\n<h1>Feignå’ŒDubboçš„åŒºåˆ«ï¼Ÿ</h1>\n<table>\n<thead>\n<tr>\n<th>-</th>\n<th>Feign</th>\n<th>Dubbo</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å®šä¹‰</td>\n<td>Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼Œç”¨äºç®€åŒ–HTTP APIçš„è°ƒç”¨ã€‚</td>\n<td>Dubboæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœåŠ¡æ¡†æ¶ï¼Œç”¨äºæ„å»ºé¢å‘æœåŠ¡çš„å¾®æœåŠ¡æ¶æ„ã€‚</td>\n</tr>\n<tr>\n<td>é€šä¿¡æ–¹å¼</td>\n<td>åŸºäºHTTPåè®®ï¼Œä½¿ç”¨RESTfulé£æ ¼çš„æ¥å£è¿›è¡Œå®šä¹‰å’Œè°ƒç”¨ã€‚</td>\n<td>åŸºäºRPCåè®®ï¼Œæ”¯æŒå¤šç§åºåˆ—åŒ–åè®®å¦‚gRPCã€Hessianç­‰ã€‚</td>\n</tr>\n<tr>\n<td>æœåŠ¡å‘ç°</td>\n<td>é€šå¸¸ç»“åˆæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼ˆå¦‚Eurekaã€Consulï¼‰è¿›è¡ŒæœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡ã€‚</td>\n<td>é€šè¿‡ZooKeeperã€Nacosç­‰è¿›è¡ŒæœåŠ¡æ³¨å†Œå’Œå‘ç°ï¼Œå¹¶æä¾›è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</td>\n</tr>\n<tr>\n<td>æœåŠ¡æ²»ç†</td>\n<td>ä¸ç›´æ¥æä¾›æœåŠ¡æ²»ç†åŠŸèƒ½ï¼Œéœ€è¦ç»“åˆå…¶ä»–ç»„ä»¶æˆ–æ¡†æ¶è¿›è¡ŒæœåŠ¡æ²»ç†ã€‚</td>\n<td>æä¾›æœåŠ¡æ³¨å†Œä¸å‘ç°ã€è´Ÿè½½å‡è¡¡ã€å®¹é”™æœºåˆ¶ã€æœåŠ¡é™çº§ç­‰æœåŠ¡æ²»ç†åŠŸèƒ½ã€‚</td>\n</tr>\n<tr>\n<td>è·¨è¯­è¨€æ€§</td>\n<td>æ”¯æŒè·¨è¯­è¨€é€šä¿¡ï¼Œå¯ä»¥ä½¿ç”¨HTTPä½œä¸ºé€šä¿¡åè®®å®ç°ä¸åŒè¯­è¨€ä¹‹é—´çš„é€šä¿¡ã€‚</td>\n<td>æ”¯æŒè·¨è¯­è¨€é€šä¿¡ï¼Œé€šè¿‡Dubboçš„IDLç”Ÿæˆä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä»£ç ã€‚</td>\n</tr>\n<tr>\n<td>ç”Ÿæ€ç³»ç»Ÿ</td>\n<td>é›†æˆäº†Spring Cloudç”Ÿæ€ç³»ç»Ÿï¼Œä¸Spring Bootæ— ç¼é›†æˆã€‚</td>\n<td>æ‹¥æœ‰å®Œæ•´çš„ç”Ÿæ€ç³»ç»Ÿï¼ŒåŒ…æ‹¬æ³¨å†Œä¸­å¿ƒã€é…ç½®ä¸­å¿ƒã€ç›‘æ§ä¸­å¿ƒç­‰ç»„ä»¶ã€‚</td>\n</tr>\n<tr>\n<td>é€‚ç”¨åœºæ™¯</td>\n<td>é€‚ç”¨äºæ„å»ºRESTfulé£æ ¼çš„å¾®æœåŠ¡æ¶æ„ï¼Œç‰¹åˆ«é€‚åˆåŸºäºHTTPçš„å¾®æœåŠ¡è°ƒç”¨ã€‚</td>\n<td>é€‚ç”¨äºæ„å»ºé¢å‘æœåŠ¡çš„å¾®æœåŠ¡æ¶æ„ï¼Œæä¾›æ›´å…¨é¢çš„æœåŠ¡æ²»ç†å’Œå®¹é”™æœºåˆ¶ã€‚</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>Dubboå¯ä»¥ä½¿ç”¨HTTPåè®®ä½œä¸ºé€šä¿¡æ–¹å¼ï¼Œè€ŒFeignä¹Ÿå¯ä»¥é›†æˆRPCåè®®è¿›è¡Œè¿œç¨‹è°ƒç”¨ã€‚é€‰æ‹©ä½¿ç”¨å“ªç§è¿œç¨‹è°ƒç”¨æ–¹å¼å–å†³äºå…·ä½“çš„ä¸šåŠ¡éœ€æ±‚å’ŒæŠ€æœ¯æ ˆçš„é€‰æ‹©</li>\n</ul>\n<h1>è¯´ä¸€ä¸‹Fegin?</h1>\n<ul>\n<li>Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼çš„WebæœåŠ¡å®¢æˆ·ç«¯ï¼Œå®ƒç®€åŒ–äº†ä½¿ç”¨åŸºäºHTTPçš„è¿œç¨‹æœåŠ¡çš„å¼€å‘ã€‚Feignä½¿ç”¨RestTemplateå®ç°Httpè°ƒç”¨ï¼Œä½¿ç”¨Ribbonå®ç°è´Ÿè½½å‡è¡¡ã€‚</li>\n<li>Feignçš„ä¸»è¦ç‰¹ç‚¹å’ŒåŠŸèƒ½åŒ…æ‹¬ï¼š\n<ul>\n<li>å£°æ˜å¼APIï¼šFeignå…è®¸å¼€å‘è€…ä½¿ç”¨ç®€å•çš„æ³¨è§£æ¥å®šä¹‰å’Œæè¿°å¯¹è¿œç¨‹æœåŠ¡çš„è®¿é—®ã€‚é€šè¿‡ä½¿ç”¨æ³¨è§£ï¼Œå¼€å‘è€…å¯ä»¥è½»æ¾åœ°æŒ‡å®šURLã€HTTPæ–¹æ³•ã€è¯·æ±‚å‚æ•°ã€è¯·æ±‚å¤´ç­‰ä¿¡æ¯ï¼Œä½¿å¾—è¿œç¨‹è°ƒç”¨å˜å¾—éå¸¸ç›´è§‚å’Œæ˜“äºç†è§£ã€‚</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@FeignClient(name = \"example\", url = \"https://api.example.com\") \n public interface ExampleService { \n     @GetMapping(\"/endpoint\") \n     String getEndpointData(); \n }\n</code></pre></div><ul>\n<li>é›†æˆè´Ÿè½½å‡è¡¡ï¼šFeigné›†æˆäº†Ribbonè´Ÿè½½å‡è¡¡å™¨ï¼Œå¯ä»¥è‡ªåŠ¨å®ç°å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ã€‚å®ƒå¯ä»¥æ ¹æ®æœåŠ¡åå’Œå¯ç”¨å®ä¾‹è¿›è¡ŒåŠ¨æ€è·¯ç”±ï¼Œå¹¶åˆ†å‘è¯·æ±‚åˆ°ä¸åŒçš„æœåŠ¡å®ä¾‹ä¸Šï¼Œæé«˜ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œå¯ä¼¸ç¼©æ€§ã€‚</li>\n<li>å®¹é”™æœºåˆ¶ï¼šFeignæ”¯æŒé›†æˆHystrixå®¹é”™æ¡†æ¶ï¼Œå¯ä»¥åœ¨è°ƒç”¨è¿œç¨‹æœåŠ¡æ—¶æä¾›å®¹é”™å’Œæ–­è·¯å™¨åŠŸèƒ½ã€‚å½“è¿œç¨‹æœåŠ¡ä¸å¯ç”¨æˆ–å“åº”æ—¶é—´è¿‡é•¿æ—¶ï¼ŒFeignå¯ä»¥å¿«é€Ÿå¤±è´¥å¹¶è¿”å›é¢„è®¾çš„å“åº”ç»“æœï¼Œé¿å…å¯¹æ•´ä¸ªç³»ç»Ÿé€ æˆçº§è”æ•…éšœã€‚</li>\n</ul>\n<h1>ä¸ºä»€ä¹ˆFeignç¬¬ä¸€æ¬¡è°ƒç”¨è€—æ—¶å¾ˆé•¿ï¼Ÿ</h1>\n<ul>\n<li>ä¸»è¦åŸå› æ˜¯ç”±äºRibbonçš„æ‡’åŠ è½½æœºåˆ¶ï¼Œå½“ç¬¬ä¸€æ¬¡è°ƒç”¨å‘ç”Ÿæ—¶ï¼ŒFeignä¼šè§¦å‘Ribbonçš„åŠ è½½è¿‡ç¨‹ï¼ŒåŒ…æ‹¬ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–æœåŠ¡åˆ—è¡¨ã€å»ºç«‹è¿æ¥æ± ç­‰æ“ä½œï¼Œè¿™ä¸ªåŠ è½½è¿‡ç¨‹ä¼šå¢åŠ é¦–æ¬¡è°ƒç”¨çš„è€—æ—¶ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ribbon: \n   eager-load: \n     enabled: true \n       clients: service-1\n</code></pre></div><ul>\n<li>è§£å†³æ–¹æ³•ï¼šåœ¨åº”ç”¨å¯åŠ¨æ—¶é¢„çƒ­Feignå®¢æˆ·ç«¯ï¼Œè‡ªåŠ¨è§¦å‘ä¸€æ¬¡æ— å…³ç´§è¦çš„è°ƒç”¨ï¼Œæ¥æå‰åŠ è½½Ribbonå’Œå…¶ä»–ç›¸å…³ç»„ä»¶ã€‚ç›¸å½“äºæå‰è¿›è¡Œäº†ç¬¬ä¸€æ¬¡è°ƒç”¨ã€‚</li>\n</ul>\n<h1>Feignæ€ä¹ˆå®ç°è®¤è¯ä¼ é€’ï¼Ÿ</h1>\n<ul>\n<li>ä½¿ç”¨æ‹¦æˆªå™¨ä¼ é€’è®¤è¯ä¿¡æ¯ã€‚å¯ä»¥é€šè¿‡å®ç°RequestInterceptoræ¥å£æ¥å®šä¹‰æ‹¦æˆªå™¨ï¼Œåœ¨æ‹¦æˆªå™¨é‡Œï¼ŒæŠŠè®¤è¯ä¿¡æ¯æ·»åŠ åˆ°è¯·æ±‚å¤´ä¸­ï¼Œç„¶åå°†å…¶æ³¨å†Œåˆ°Feignçš„é…ç½®ä¸­ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Configuration \n public class FeignClientConfig { \n  \n     @Bean \n     public RequestInterceptor requestInterceptor() { \n         return new RequestInterceptor() { \n             @Override \n             public void apply(RequestTemplate template) { \n                 // æ·»åŠ è®¤è¯ä¿¡æ¯åˆ°è¯·æ±‚å¤´ä¸­ \n                 template.header(\"Authorization\", \"Bearer \" + getToken()); \n             } \n         }; \n     } \n  \n     private String getToken() { \n         // è·å–è®¤è¯ä¿¡æ¯çš„é€»è¾‘ï¼Œå¯ä»¥ä»SecurityContextæˆ–å…¶ä»–åœ°æ–¹è·å– \n         // è¿”å›è®¤è¯ä¿¡æ¯çš„å­—ç¬¦ä¸²å½¢å¼ \n         return \"your_token\"; \n     } \n }\n</code></pre></div><h1>Feginæ€ä¹ˆåšè´Ÿè½½å‡è¡¡ï¼ŸRibbon?</h1>\n<ul>\n<li>åœ¨Feignä¸­ï¼Œè´Ÿè½½å‡è¡¡æ˜¯é€šè¿‡é›†æˆRibbonæ¥å®ç°çš„ã€‚Ribbonæ˜¯Netflixå¼€æºçš„ä¸€ä¸ªå®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨.Ribboné€šè¿‡ä»æœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–å¯ç”¨æœåŠ¡åˆ—è¡¨ï¼Œå¹¶é€šè¿‡è´Ÿè½½å‡è¡¡ç®—æ³•é€‰æ‹©åˆé€‚çš„æœåŠ¡å®ä¾‹è¿›è¡Œè¯·æ±‚è½¬å‘ï¼Œå®ç°å®¢æˆ·ç«¯çš„è´Ÿè½½å‡è¡¡ã€‚</li>\n</ul>\n<h1>è´Ÿè½½å‡è¡¡ç®—æ³•ï¼Ÿ</h1>\n<h1>1. springcloudç»„ä»¶æœ‰å“ªäº›ï¼Ÿ âˆš</h1>\n<ul>\n<li>æœåŠ¡å‘ç°ä¸æ³¨å†ŒZooKeeperã€Eurekaã€consoulã€Nacos</li>\n<li>æœåŠ¡é—´è°ƒç”¨Feign</li>\n<li>æ–­è·¯å™¨Hystrixã€Sentinel</li>\n<li>ç½‘å…³Zuulã€gatyway</li>\n<li>åˆ†å¸ƒå¼é…ç½®consul</li>\n<li>è´Ÿè½½å‡è¡¡Ribbonã€spring-cloud-loadbalancer</li>\n</ul>\n<h1>2. å¾®æœåŠ¡çš„ä¼˜ç¼ºç‚¹ï¼Ÿ</h1>\n<ul>\n<li>ä¼˜ç‚¹\n<ul>\n<li>æ¯ä¸€ä¸ªæœåŠ¡è¶³å¤Ÿå†…èš,ä»£ç å®¹æ˜“ç†è§£</li>\n<li>å¼€å‘æ•ˆç‡æé«˜ï¼Œä¸€ä¸ªæœåŠ¡åªåšä¸€ä»¶äº‹</li>\n<li>å¾®æœåŠ¡èƒ½å¤Ÿè¢«å°å›¢é˜Ÿå•ç‹¬å¼€å‘</li>\n<li>å¾®æœåŠ¡æ˜¯æ¾è€¦åˆçš„ï¼Œæ˜¯æœ‰åŠŸèƒ½æ„ä¹‰çš„æœåŠ¡</li>\n<li>å¯ä»¥ç”¨ä¸åŒçš„è¯­è¨€å¼€å‘,é¢å‘æ¥å£ç¼–ç¨‹</li>\n<li>æ˜“äºä¸ç¬¬ä¸‰æ–¹é›†æˆ</li>\n<li>å¾®æœåŠ¡åªæ˜¯ä¸šåŠ¡é€»è¾‘çš„ä»£ç ï¼Œä¸ä¼šå’Œ HTMLã€CSS æˆ–è€…å…¶ä»–ç•Œé¢ç»„åˆ</li>\n</ul>\n</li>\n<li>ç¼ºç‚¹\n<ul>\n<li>åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¤æ‚æ€§</li>\n<li>å¤šæœåŠ¡è¿ç»´éš¾åº¦ï¼Œéšç€æœåŠ¡çš„å¢åŠ ï¼Œè¿ç»´çš„å‹åŠ›ä¹Ÿåœ¨å¢å¤§</li>\n<li>ç³»ç»Ÿéƒ¨ç½²ä¾èµ–</li>\n<li>æœåŠ¡é—´é€šä¿¡æˆæœ¬</li>\n<li>æ•°æ®ä¸€è‡´æ€§å’Œäº‹åŠ¡ç®¡ç†</li>\n<li>ç³»ç»Ÿé›†æˆæµ‹è¯•</li>\n<li>æ€§èƒ½ç›‘æ§</li>\n<li>å›¢é˜Ÿæ²Ÿé€šå’Œåä½œæˆæœ¬</li>\n</ul>\n</li>\n</ul>\n<h1>æµè¡Œçš„å¾®æœåŠ¡è§£å†³æ–¹æ¡ˆåŠåŒºåˆ«</h1>\n<table>\n<thead>\n<tr>\n<th>ç‰¹ç‚¹</th>\n<th>Dubbo</th>\n<th>Spring Cloud Netflix</th>\n<th>Spring Cloud Alibaba</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>å¼€å‘è¯­è¨€</td>\n<td>Java</td>\n<td>Java</td>\n<td>Java</td>\n</tr>\n<tr>\n<td>æœåŠ¡æ²»ç†</td>\n<td>æä¾›å®Œæ•´çš„æœåŠ¡æ²»ç†åŠŸèƒ½</td>\n<td>æä¾›éƒ¨åˆ†æœåŠ¡æ²»ç†åŠŸèƒ½</td>\n<td>æä¾›å®Œæ•´çš„æœåŠ¡æ²»ç†åŠŸèƒ½</td>\n</tr>\n<tr>\n<td>æœåŠ¡æ³¨å†Œä¸å‘ç°</td>\n<td>ZooKeeper/Nacos</td>\n<td>Eureka/Consul</td>\n<td>Nacos</td>\n</tr>\n<tr>\n<td>è´Ÿè½½å‡è¡¡</td>\n<td>è‡ªå¸¦è´Ÿè½½å‡è¡¡ç­–ç•¥</td>\n<td>Ribbon</td>\n<td>Ribbon\\Dubboè´Ÿè½½å‡è¡¡ç­–ç•¥</td>\n</tr>\n<tr>\n<td>æœåŠ¡è°ƒç”¨</td>\n<td>RPCæ–¹å¼</td>\n<td>RestTemplate/Feign</td>\n<td>Feign/RestTemplate/Dubbo</td>\n</tr>\n<tr>\n<td>ç†”æ–­å™¨</td>\n<td>Sentinel</td>\n<td>Hystrix</td>\n<td>Sentinel/Resilience4j</td>\n</tr>\n<tr>\n<td>é…ç½®ä¸­å¿ƒ</td>\n<td>Apollo</td>\n<td>Spring Cloud Config</td>\n<td>Nacos Config</td>\n</tr>\n<tr>\n<td>APIç½‘å…³</td>\n<td>Higress/APISIX</td>\n<td>Zuul/Gateway</td>\n<td>Spring Cloud Gateway</td>\n</tr>\n<tr>\n<td>åˆ†å¸ƒå¼äº‹åŠ¡</td>\n<td>Seata</td>\n<td>ä¸æ”¯æŒåˆ†å¸ƒå¼äº‹åŠ¡</td>\n<td>Seata</td>\n</tr>\n<tr>\n<td>é™æµå’Œé™çº§</td>\n<td>Sentinel</td>\n<td>Hystrix</td>\n<td>Sentinel</td>\n</tr>\n<tr>\n<td>åˆ†å¸ƒå¼è¿½è¸ªå’Œç›‘æ§</td>\n<td>Skywalking</td>\n<td>Spring Cloud Sleuth + Zipkin</td>\n<td>SkyWalkingæˆ–Sentinel Dashboard</td>\n</tr>\n<tr>\n<td>å¾®æœåŠ¡ç½‘æ ¼</td>\n<td>Dubbo Mesh</td>\n<td>ä¸æ”¯æŒå¾®æœåŠ¡ç½‘æ ¼</td>\n<td>Service Meshï¼ˆNacos+Dubbo Meshï¼‰</td>\n</tr>\n<tr>\n<td>ç¤¾åŒºæ´»è·ƒåº¦</td>\n<td>ç›¸å¯¹è¾ƒé«˜</td>\n<td>ç›®å‰è¾ƒä½</td>\n<td>ç›¸å¯¹è¾ƒé«˜</td>\n</tr>\n<tr>\n<td>å­µåŒ–å’Œæˆç†Ÿåº¦</td>\n<td>å­µåŒ–è¾ƒæ—©ï¼Œæˆç†Ÿåº¦è¾ƒé«˜</td>\n<td>æˆç†Ÿåº¦è¾ƒé«˜</td>\n<td>å­µåŒ–è¾ƒæ–°ï¼Œä½†è¿…é€Ÿå‘å±•</td>\n</tr>\n</tbody>\n</table>\n<h1>3. æœåŠ¡æ³¨å†Œä¸å‘ç°</h1>\n<ul>\n<li>åŸºäºspring-cloud-commonsçš„discoveryçš„DiscoveryClientæ¥å£ï¼Œå®ç°ç»Ÿä¸€çš„å®¢æˆ·ç«¯çš„æ³¨å†Œå‘ç°ã€‚</li>\n<li>spring-cloud-netflix-eureka-serverå’Œspring-cloud-netflix-eureka-client ï¼ŒåŸºäºEurekaå®ç°ã€‚</li>\n<li>spring-cloud-alibaba-nacos-discoveryï¼ŒåŸºäºNacoså®ç°ã€‚</li>\n<li>spring-cloud-zookeeper-discoveryï¼ŒåŸºäºZookeeperå®ç°ã€‚</li>\n</ul>\n<h2>3.1. ä¸ºä»€ä¹ˆè¦æœ‰æœåŠ¡æ³¨å†Œä¸å‘ç°ï¼Ÿ</h2>\n<ul>\n<li>å±è”½ã€è§£è€¦æœåŠ¡ä¹‹é—´ç›¸äº’ä¾èµ–çš„ç»†èŠ‚ã€‚æœåŠ¡ä¹‹é—´çš„è¿œç¨‹è°ƒç”¨å¿…é¡»è¦çŸ¥é“IPã€ç«¯å£ä¿¡æ¯ã€‚è°ƒç”¨æ–¹ç›´æ¥é…ç½®è¢«è°ƒç”¨æ–¹çš„IPã€ç«¯å£ï¼Œè¿™ç§è°ƒç”¨ç›´æ¥ä¾èµ–IPã€ç«¯å£çš„æ–¹å¼å­˜åœ¨ä¾èµ–ï¼Œå¦‚è¢«è°ƒç”¨çš„IPã€ç«¯å£å˜åŒ–åï¼Œè°ƒç”¨æ–¹ä¹Ÿè¦åŒæ­¥ä¿®æ”¹ã€‚é€šè¿‡æœåŠ¡å‘ç°ï¼Œå°†æœåŠ¡çš„IPã€ç«¯å£è½¬åŒ–æˆæœåŠ¡åæ¥è°ƒç”¨ã€‚</li>\n<li>å¯¹å¾®æœåŠ¡è¿›è¡ŒåŠ¨æ€é…ç½®ã€‚å¾®æœåŠ¡æ¶æ„ä¸­ï¼ŒæœåŠ¡ä¼—å¤šã€æœåŠ¡ä¹‹é—´çš„ç›¸äº’ä¾èµ–é”™ç»¼å¤æ‚ï¼Œæ— è®ºæ˜¯æœåŠ¡ä¸»åŠ¨åœæ­¢ã€æ„å¤–æŒ‚æ‰ï¼Œè¿˜æ˜¯å› ä¸ºæµé‡å¢åŠ å¯¹æœåŠ¡å®ç°æ‰©å®¹ï¼Œè¿™äº›æœåŠ¡æˆ–çŠ¶æ€ä¸Šçš„åŠ¨æ€å˜åŒ–ï¼Œéƒ½éœ€è¦å°½å¿«çš„é€šçŸ¥åˆ°è¢«è°ƒç”¨æ–¹ï¼Œè¢«è°ƒç”¨æ–¹é‡‡å–ç›¸åº”çš„ç­–ç•¥ã€‚å¯¹äºæœåŠ¡æ³¨å†Œä¸å‘ç°è¦å®æ—¶ç®¡ç†è€…æœåŠ¡çš„æ•°æ®å’ŒçŠ¶æ€ï¼ŒåŒ…æ‹¬æœåŠ¡çš„æ³¨å†Œä¸Šçº¿ã€æœåŠ¡ä¸»åŠ¨ä¸‹çº¿ï¼Œå¼‚å¸¸æœåŠ¡çš„è¸¢å‡ºã€‚æœåŠ¡å‘ç°å°†æœåŠ¡IPã€ç«¯å£ç­‰ç»†èŠ‚é€šè¿‡ä¸€ä¸ªæœåŠ¡åæŠ½è±¡ç»™è°ƒç”¨è€…ï¼Œå¹¶åŠ¨æ€ç®¡ç†è€…å„ä¸ªå¾®æœåŠ¡çš„çŠ¶æ€æ£€æµ‹ã€çŠ¶æ€æ›´æ–°ï¼ŒæœåŠ¡ä¸Šçº¿ï¼Œä¸‹çº¿ç­‰ï¼Œè¿™äº›éƒ½æ˜¯å¾®æœåŠ¡æ²»ç†çš„åŸºç¡€ï¼ŒåŒ…æ‹¬ï¼Œè´Ÿè½½å‡è¡¡ï¼Œé“¾è·¯è·Ÿè¸ªã€‚</li>\n<li>æœåŠ¡å‘ç°æœ‰ä¸¤å¤§æ¨¡å¼ï¼š\n<ul>\n<li>å®¢æˆ·ç«¯å‘ç°æ¨¡å¼ï¼šå®¢æˆ·ç«¯å†³å®šç›¸åº”æœåŠ¡å®ä¾‹çš„ç½‘ç»œä½ç½®ï¼Œå¹¶ä¸”å¯¹è¯·æ±‚å®ç°è´Ÿè½½å‡è¡¡ã€‚å®¢æˆ·ç«¯æŸ¥è¯¢æœåŠ¡æ³¨å†Œè¡¨ï¼Œåè€…æ˜¯ä¸€ä¸ªå¯ç”¨æœåŠ¡å®ä¾‹çš„æ•°æ®åº“ï¼›ç„¶åä½¿ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•ä»ä¸­é€‰æ‹©ä¸€ä¸ªå®ä¾‹ï¼Œå¹¶å‘å‡ºè¯·æ±‚</li>\n<li>æœåŠ¡ç«¯å‘ç°æ¨¡å¼ï¼šå®¢æˆ·ç«¯é€šè¿‡è´Ÿè½½å‡è¡¡å™¨å‘æŸä¸ªæœåŠ¡æå‡ºè¯·æ±‚ï¼Œè´Ÿè½½å‡è¡¡å™¨æŸ¥è¯¢æœåŠ¡æ³¨å†Œè¡¨ï¼Œå¹¶å°†è¯·æ±‚è½¬å‘åˆ°å¯ç”¨çš„æœåŠ¡å®ä¾‹ã€‚å¦‚åŒå®¢æˆ·ç«¯å‘ç°ï¼ŒæœåŠ¡å®ä¾‹åœ¨æœåŠ¡æ³¨å†Œè¡¨ä¸­æ³¨å†Œæˆ–æ³¨é”€ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>3.2. Eurekaä»‹ç»</h2>\n<ul>\n<li>ç”±ä¸¤ä¸ªç»„ä»¶ç»„æˆï¼šEurekaæœåŠ¡ç«¯ï¼ŒæœåŠ¡æ³¨å†Œä¸­å¿ƒï¼Œæ”¯æŒé›†ç¾¤éƒ¨ç½²ï¼›Eureka å®¢æˆ·ç«¯ï¼ŒJavaå®¢æˆ·ç«¯ï¼Œç”¨æ¥å¤„ç†æœåŠ¡æ³¨å†Œä¸å‘ç°ã€‚</li>\n<li>åœ¨åº”ç”¨å¯åŠ¨æ—¶ï¼ŒEurekaå®¢æˆ·ç«¯å‘æœåŠ¡ç«¯æ³¨å†Œè‡ªå·±çš„æœåŠ¡ä¿¡æ¯ï¼ŒåŒæ—¶å°†æœåŠ¡ç«¯çš„æœåŠ¡ä¿¡æ¯ç¼“å­˜åˆ°æœ¬åœ°ã€‚å®¢æˆ·ç«¯ä¼šå’ŒæœåŠ¡ç«¯å‘¨æœŸæ€§çš„è¿›è¡Œå¿ƒè·³äº¤äº’ï¼Œä»¥æ›´æ–°æœåŠ¡ç§Ÿçº¦å’ŒæœåŠ¡ä¿¡æ¯ã€‚</li>\n</ul>\n<h2>3.3. Eurekaç¼“å­˜æœºåˆ¶ï¼Ÿ</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d8e1d1b5769a399ef1bb8.png\" alt=\"eurekacache.png\" tabindex=\"0\"><figcaption>eurekacache.png</figcaption></figure>\n<h2>3.4. Eurekaè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Ÿè§£å†³æ–¹æ³•</h2>\n<ul>\n<li>å½“Eureka ServerèŠ‚ç‚¹åœ¨çŸ­æ—¶é—´å†…ä¸¢å¤±äº†è¿‡å¤šå®ä¾‹çš„è¿æ¥æ—¶ï¼ˆæ¯”å¦‚ç½‘ç»œæ•…éšœæˆ–é¢‘ç¹çš„å¯åŠ¨å…³é—­å®¢æˆ·ç«¯ï¼‰å°±ä¼šè¿›å…¥è‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ï¼Œä¿æŠ¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„ä¿¡æ¯ï¼Œä¸å†åˆ é™¤æœåŠ¡æ³¨å†Œè¡¨ä¸­çš„æ•°æ®ï¼ˆå³ä¸ä¼šæ³¨é”€ä»»ä½•å¾®æœåŠ¡ï¼‰ï¼Œå½“ç½‘ç»œæ•…éšœæ¢å¤åï¼Œå°±ä¼šè‡ªåŠ¨é€€å‡ºè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼</li>\n<li>è§£å†³æ–¹æ³•\n<ul>\n<li>ç­‰å¾…Eureka Serverè‡ªåŠ¨æ¢å¤ç­‰å¾…ç½‘ç»œæ¢å¤ï¼ˆæˆ–è€…æ²¡æœ‰é¢‘ç¹çš„å¯åŠ¨ä¸å…³é—­å®ä¾‹ï¼‰</li>\n<li>é‡å¯Eureka Serverç”Ÿäº§ç¯å¢ƒå»ºè®®å¯¹Eureka Serveråšè´Ÿè½½å‡è¡¡ï¼Œè¿™æ ·åœ¨ä¾æ¬¡é‡å¯Eureka Serveråï¼Œæ— æ•ˆçš„å®ä¾‹ä¼šè¢«æ¸…é™¤ã€‚</li>\n<li>å…³é—­Eurekaè‡ªæˆ‘ä¿æŠ¤æ¨¡å¼ã€‚ymlé…ç½®æ–‡ä»¶ï¼š</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>eureka:\n  server:\n    enable-self-preservation: false\n    eviction-interval-timer-in-ms: 4000 # This is not required\n</code></pre></div><h2>3.5. eurekaçš„æ³¨å†Œä¸­å¿ƒæ€ä¹ˆçŸ¥é“æœ€è¿‘çš„æœåŠ¡ï¼Œå°±è¿‘æœºæˆ¿ï¼Ÿ</h2>\n<ul>\n<li>é€šè¿‡å±æ€§prefer-same-zone-eureka\n<ul>\n<li>å¦‚æœfalseåˆ™æŒ‰ç…§service-urlçš„ç¬¬ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒæ¥æ³¨å†Œï¼Œå¹¶å’Œå…¶ç»´æŒå¿ƒè·³æ£€æµ‹ï¼Œä¸å†å‘å…¶å®ƒæ³¨å†Œä¸­å¿ƒæ³¨å†Œå’Œç»´æŒå¿ƒè·³ã€‚åªæœ‰åœ¨ç¬¬ä¸€ä¸ªæ³¨å†Œå¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šä¾æ¬¡å‘å…¶å®ƒçš„æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œæ€»å…±é‡è¯•3æ¬¡ï¼Œæ³¨å†Œå¤±è´¥åæ¯éš”ä¸€ä¸ªå¿ƒè·³æ—¶é—´ï¼Œä¼šå†æ¬¡å°è¯•ã€‚</li>\n<li>å¦‚æœtrueï¼Œå…ˆé€šè¿‡regionå–availability-zoneså†…çš„ç¬¬ä¸€ä¸ªzoneçš„service-urlä¸‹çš„ç¬¬ä¸€ä¸ªæ³¨å†Œä¸­å¿ƒè¿›è¡Œæ³¨å†Œå’Œç»´æŒå¿ƒè·³ï¼Œä¸å†å‘å…¶å®ƒçš„æ³¨å†Œä¸­å¿ƒæ³¨å†Œå’Œç»´æŒå¿ƒè·³ã€‚åªæœ‰åœ¨ç¬¬ä¸€ä¸ªæ³¨å†Œå¤±è´¥çš„æƒ…å†µä¸‹ï¼Œæ‰ä¼šä¾æ¬¡å‘å…¶å®ƒçš„æ³¨å†Œä¸­å¿ƒæ³¨å†Œï¼Œæ€»å…±é‡è¯•3æ¬¡ï¼Œæ³¨å†Œå¤±è´¥åæ¯éš”ä¸€ä¸ªå¿ƒè·³æ—¶é—´ï¼Œä¼šå†æ¬¡å°è¯•ã€‚ä¸ºäº†ä¿è¯æœåŠ¡æ³¨å†Œåˆ°åŒä¸€ä¸ª zone çš„æ³¨å†Œä¸­å¿ƒï¼Œä¸€å®šè¦æ³¨æ„ availability-zones çš„é¡ºåºï¼Œå¿…é¡»æŠŠåŒä¸€zoneå†™åœ¨æœ€å‰é¢</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>eureka:\n  client:\n    # å°½é‡å‘åŒä¸€åŒºåŸŸçš„ eureka æ³¨å†Œ,é»˜è®¤ä¸ºtrue\n    prefer-same-zone-eureka: true\n    #åœ°åŒº\n    region: tianjin\n    availability-zones:\n      tianjin: zone-1,zone-2\n    service-url:\n      zone-1: http://IP1:port/eureka/,http://IP2:port/eureka/,http://IP3:port/eureka/\n      zone-2: http://IP1:port/eureka/,http://IP2:port/eureka/,http://IP3:port/eureka/\n</code></pre></div><h2>3.6. ZooKeeperï¼Œeurekaï¼ŒnacosåŸç†ï¼Ÿ</h2>\n<ul>\n<li>åŸºäºspring-cloud-commonsçš„discoveryçš„DiscoveryClientæ¥å£ï¼Œå®ç°ç»Ÿä¸€çš„å®¢æˆ·ç«¯çš„æ³¨å†Œå‘ç°ã€‚</li>\n<li>ZooKeeper(CP)ï¼šleader+followerï¼Œleaderå†™ï¼ŒåŒæ­¥åˆ°followerï¼Œfollowerè¯»ï¼Œä¿è¯é¡ºåºä¸€è‡´æ€§ï¼Œä¸»åŠ¨æ¨é€ï¼Œleaderå´©æºƒçš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ•°æ®ä¸€è‡´æ€§ï¼Œå°½é‡ä¸è¦è¯»åˆ°ä¸ä¸€è‡´çš„æ•°æ®ï¼Œæ­¤æ—¶è¦é‡æ–°é€‰ä¸¾leaderä»¥åŠåšæ•°æ®åŒæ­¥ï¼Œæ­¤æ—¶é›†ç¾¤ä¼šçŸ­æš‚çš„ä¸å¯ç”¨</li>\n<li>Eureka(AP)ï¼špeer-to-peerï¼Œå„èŠ‚ç‚¹éƒ½èƒ½å†™ä¹Ÿéƒ½èƒ½è¯»ï¼Œæ¯ä¸ªèŠ‚ç‚¹é€šè¿‡å¼‚æ­¥å¤åŒæ­¥ç»™å…¶ä»–èŠ‚ç‚¹ï¼Œæ‰€ä»¥å¯èƒ½æ•°æ®ä¸ä¸€è‡´ï¼Œä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹å®•æœºï¼Œå…¶ä»–èŠ‚ç‚¹æ­£å¸¸å·¥ä½œï¼Œå¯ç”¨æ€§é«˜</li>\n<li>Nacos(CP/AP)ï¼šåŸºäºraftç®—æ³•ã€‚è¿˜æä¾›äº†é…ç½®ç®¡ç†ã€å…ƒæ•°æ®ç®¡ç†å’Œæµé‡ç®¡ç†ç­‰åŠŸèƒ½ï¼Œå¹¶ä¸”æä¾›äº†ä¸€ä¸ªå¯è§†åŒ–çš„æ§åˆ¶å°ç®¡ç†ç•Œé¢ã€‚</li>\n</ul>\n<h1>4. åœ¨ Spring Cloud ä¸­çš„è´Ÿè½½å‡è¡¡</h1>\n<ul>\n<li>åŸºäºspring-cloud-commonsçš„loadbalancerçš„ServiceInstanceChooseræ¥å£å®ç°ç»Ÿä¸€çš„æœåŠ¡çš„é€‰æ‹©ã€‚å¹¶ä¸”ï¼Œè´Ÿè½½å‡è¡¡ç»„ä»¶åœ¨é€‰æ‹©éœ€è¦è°ƒç”¨çš„æœåŠ¡ä¹‹åï¼Œè¿˜æä¾›è°ƒç”¨è¯¥æœåŠ¡çš„åŠŸèƒ½ï¼Œå…·ä½“æ–¹æ³•è§LoadBalancerClientæ¥å£çš„executeæ–¹æ³•ã€‚\n<ul>\n<li>spring-cloud-netflix-ribbonï¼ŒåŸºäºRibbonå®ç°ã€‚</li>\n<li>spring-cloud-loadbalancerï¼Œæä¾›ç®€å•çš„è´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>4.1. è´Ÿè½½å‡è¡¡çš„ä¸¤ç§æ¨¡å¼</h2>\n<ul>\n<li>å®¢æˆ·ç«¯æ¨¡å¼ï¼šå®¢æˆ·ç«¯èŠ‚ç‚¹æœ‰ä¸€ä»½æœåŠ¡ç«¯æ¸…å•ï¼Œä»EurekaæœåŠ¡æ³¨å†Œä¸­å¿ƒè·å–ã€‚åœ¨Spring Cloudä¸­ä½¿ç”¨@LoadBalancedæ³¨è§£å¼€å¯å®¢æˆ·ç«¯æ¨¡å¼</li>\n<li>æœåŠ¡ç«¯æ¨¡å¼ï¼ˆnginxï¼‰ï¼šç»´æŠ¤ä¸€ä¸ªå¯ç”¨çš„æœåŠ¡ç«¯æ¸…å•ï¼Œç„¶åé€šè¿‡å¿ƒè·³æœºåˆ¶æ¥åˆ é™¤æ•…éšœçš„æœåŠ¡ç«¯èŠ‚ç‚¹ä»¥ä¿è¯æ¸…å•ä¸­éƒ½æ˜¯å¯ä»¥æ­£å¸¸è®¿é—®çš„æœåŠ¡ç«¯èŠ‚ç‚¹ã€‚è´Ÿè½½å‡è¡¡æœåŠ¡å™¨æŒ‰ç…§æŸç§é…ç½®å¥½çš„è§„åˆ™ä»å¯ç”¨æœåŠ¡ç«¯æ¸…å•ä¸­é€‰å‡ºä¸€å°æœåŠ¡å™¨å»å¤„ç†å®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚</li>\n</ul>\n<h2>4.2. è´Ÿè½½å‡è¡¡ä½œç”¨</h2>\n<ul>\n<li>ä¼˜åŒ–èµ„æºä½¿ç”¨ï¼Œæœ€å¤§åŒ–ååé‡ï¼Œæœ€å°åŒ–å“åº”æ—¶é—´å¹¶é¿å…ä»»ä½•å•ä¸€èµ„æºçš„è¿‡è½½ã€‚ä½¿ç”¨å¤šä¸ªç»„ä»¶è¿›è¡Œè´Ÿè½½å¹³è¡¡è€Œä¸æ˜¯å•ä¸ªç»„ä»¶å¯èƒ½ä¼šé€šè¿‡å†—ä½™æ¥æé«˜å¯é æ€§å’Œå¯ç”¨æ€§ã€‚è´Ÿè½½å¹³è¡¡é€šå¸¸æ¶‰åŠä¸“ç”¨è½¯ä»¶æˆ–ç¡¬ä»¶ï¼Œä¾‹å¦‚å¤šå±‚äº¤æ¢æœºæˆ–åŸŸåç³»ç»ŸæœåŠ¡å™¨è¿›ç¨‹ã€‚</li>\n</ul>\n<h2>4.3. ribbonä»‹ç»ï¼Ÿæ ¸å¿ƒç»„ä»¶ï¼Ÿ</h2>\n<ul>\n<li>ä½œç”¨ï¼šä¸»è¦æä¾›å®¢æˆ·ç«¯çš„è½¯ä»¶è´Ÿè½½å‡è¡¡ç®—æ³•ã€‚</li>\n<li>æ ¸å¿ƒç»„ä»¶\n<ul>\n<li>Serverå°è£…äº†æœåŠ¡å®ä¾‹çš„ipå’Œç«¯å£ä¹‹ç±»</li>\n<li>ServerListè·å–æœåŠ¡å®ä¾‹åˆ—è¡¨çš„</li>\n<li>ServerListUpdateræ˜¯ç”¨æ¥æ›´æ–°æœåŠ¡æ³¨å†Œè¡¨çš„æ•°æ®</li>\n<li>IRuleè´Ÿè´£è´Ÿè½½å‡è¡¡çš„ç®—æ³•çš„</li>\n<li>IClientConfigè·å–åˆ°ä¸€äº›é…ç½®Ribbonçš„ä¸€äº›é…ç½®</li>\n<li>ILoadBalancerä¸»è¦æ˜¯ç”¨æ¥åè°ƒä¸Šé¢æåˆ°çš„å„ä¸ªæ ¸å¿ƒç»„ä»¶çš„ï¼Œä½¿å¾—ä»–ä»¬èƒ½å¤Ÿåè°ƒå·¥ä½œ</li>\n</ul>\n</li>\n</ul>\n<h2>4.4. ribbonå®ç°åŸç†ï¼Ÿ</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7324515938c59a3c405b2.jpg\" alt=\"ribbonprinciple.png\" tabindex=\"0\"><figcaption>ribbonprinciple.png</figcaption></figure>\n<h2>4.5. ribbonè´Ÿè½½å‡è¡¡ç®—æ³•ï¼Ÿâˆš</h2>\n<ul>\n<li>Round Robinè½®è¯¢</li>\n<li>Random éšæœº</li>\n<li>AvailabilityFilteringRuleä¼šä¼˜å…ˆè¿‡æ»¤æ‰ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€è¢«æ ‡è®°ä¸ºcircuit trippedçš„æœåŠ¡ï¼Œè¿˜æœ‰å¹¶å‘çš„è¿æ¥æ•°ï¼ˆactive connections è¶…è¿‡é…ç½®çš„é˜ˆå€¼ï¼‰è¶…è¿‡ä¸´ç•Œå€¼çš„æœåŠ¡ï¼Œç„¶åå¯¹å‰©ä½™çš„æœåŠ¡åˆ—è¡¨æŒ‰ç…§è½®è®­ç­–ç•¥è¿›è¡Œè®¿é—®</li>\n<li>WeightedResponseTimeRuleæ ¹æ®å¹³å‡å“åº”æ—¶é—´è®¡ç®—æ‰€æœ‰æœåŠ¡çš„æƒé‡ï¼Œå“åº”æ—¶é—´è¶Šå¿«æœåŠ¡æƒé‡è¶Šå¤§è¢«é€‰ä¸­çš„æœºç‡è¶Šå¤§ï¼Œåˆšå¯åŠ¨æ—¶å¦‚æœç»Ÿè®¡ä¿¡æ¯ä¸è¶³ï¼Œåˆ™ä½¿ç”¨RoundRobinRule ç­–ç•¥ï¼Œç­‰ç»Ÿè®¡ä¿¡æ¯è¶³ï¼Œä¼šåˆ‡æ¢åˆ°WeightedResponseTimeRule</li>\n<li>RetryRuleå…ˆæŒ‰ç…§RoundRobinRuleç­–ç•¥è·å–æœåŠ¡ï¼Œå¦‚æœè·å–æœåŠ¡å¤±è´¥åˆ™åœ¨åˆ¶å®šæ—¶é—´å†…è¿›è¡Œé‡è¯•</li>\n<li>BestAvailableRuleä¼šä¼˜å…ˆè¿‡æ»¤æ‰ç”±äºå¤šæ¬¡è®¿é—®æ•…éšœè€Œå¤„äºæ–­è·¯å™¨è·³é—¸çŠ¶æ€çš„æœåŠ¡ï¼Œé€‰æ‹©ä¸€ä¸ªæœ€å°çš„å¹¶å‘è¯·æ±‚çš„server.é€ä¸ªè€ƒå¯ŸServerï¼Œå¦‚æœServerè¢«trippedåˆ™å¿½ç•¥ï¼Œåœ¨é€‰æ‹©ActiveRequestsCountæœ€å°çš„server</li>\n<li>ZoneAvoidanceRuleå¤åˆåˆ¤æ–­serveræ‰€åœ¨åŒºåŸŸçš„æ€§èƒ½å’Œserverçš„å¯ç”¨æ€§é€‰æ‹©æœåŠ¡å™¨</li>\n</ul>\n<h2>4.6. Ribbon ç¼“å­˜æœºåˆ¶ï¼Ÿ</h2>\n<h2>4.7. Ribbon é‡è¯•æœºåˆ¶ï¼Ÿ</h2>\n<h2>4.8. Ribbon æ˜¯æ€ä¹ˆå’Œ Eureka æ•´åˆçš„ï¼Ÿ</h2>\n<ul>\n<li>é¦–å…ˆï¼ŒRibbon ä¼šä» Eureka Client é‡Œè·å–åˆ°å¯¹åº”çš„æœåŠ¡åˆ—è¡¨ã€‚</li>\n<li>ç„¶åï¼ŒRibbon ä½¿ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•è·å¾—ä½¿ç”¨çš„æœåŠ¡ã€‚</li>\n<li>æœ€åï¼ŒRibbon è°ƒç”¨å¯¹åº”çš„æœåŠ¡ã€‚</li>\n</ul>\n<h1>5. å£°æ˜å¼è°ƒç”¨feginï¼Ÿå®ç°åŸç†ï¼Ÿ</h1>\n<ul>\n<li>spring-cloud-openfeign ï¼ŒåŸºäº Feign å®ç°ã€‚</li>\n<li>Feign å®ç°åŸç†\n<ul>\n<li>å¦‚æœæ¥å£å®šä¹‰äº†@FeignClientæ³¨è§£ï¼ŒFeignä¼šå¯¹è¿™ä¸ªæ¥å£åˆ›å»ºä¸€ä¸ªåŠ¨æ€ä»£ç†ã€‚ç”¨é‚£ä¸ªæ¥å£æœ¬è´¨å°±æ˜¯ä¼šè°ƒç”¨ Feign åˆ›å»ºçš„åŠ¨æ€ä»£ç†ï¼Œ</li>\n<li>Feignçš„åŠ¨æ€ä»£ç†ä¼šæ ¹æ®æ¥å£ä¸Š@RequestMapping ç­‰æ³¨è§£ï¼Œæ¥åŠ¨æ€æ„é€ å‡ºä½ è¦è¯·æ±‚çš„æœåŠ¡çš„åœ°å€ã€‚</li>\n<li>æœ€åé’ˆå¯¹è¿™ä¸ªåœ°å€ï¼Œå‘èµ·è¯·æ±‚ã€è§£æå“åº”ã€‚</li>\n<li>é€šè¿‡@EnableFeignClientså’ŒFeignClientæ³¨è§£ é€šè¿‡åŠ¨æ€ä»£ç†åœ¨æœ¬åœ°å®ä¾‹åŒ–è¿œç¨‹æ¥å£-&gt;å°è£…Requestå¯¹è±¡å¹¶è¿›è¡Œç¼–ç -&gt;ä½¿ç”¨restTemplateå‘èµ·httpè¯·æ±‚å¹¶å¯¹è·å–ç»“æœè¿›è¡Œè§£ç ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0895bad5dd977f581dd19.jpg\" alt=\"feginprinciple.png\"></li>\n</ul>\n</li>\n</ul>\n<h2>5.1. Feign å’Œ Ribbon çš„åŒºåˆ«ï¼Ÿ</h2>\n<ul>\n<li>Ribbonå’ŒFeignéƒ½æ˜¯ä½¿ç”¨äºè°ƒç”¨ç”¨å…¶ä½™æœåŠ¡çš„ï¼Œä¸è¿‡æ–¹å¼ä¸åŒã€‚\n<ul>\n<li>å¯åŠ¨ç±»ç”¨çš„æ³¨è§£ä¸åŒã€‚Ribbonä½¿ç”¨çš„æ˜¯@RibbonClient ï¼›Feign ä½¿ç”¨çš„æ˜¯ @EnableFeignClients ã€‚</li>\n<li>æœåŠ¡çš„æŒ‡å®šä½ç½®ä¸åŒã€‚Ribbonæ˜¯åœ¨@RibbonClientæ³¨è§£ä¸Šè®¾ç½®ï¼›Feignåˆ™æ˜¯åœ¨å®šä¹‰å£°æ˜æ–¹æ³•çš„æ¥å£ä¸­ç”¨@FeignClientæ³¨è§£ä¸Šè®¾ç½®</li>\n</ul>\n</li>\n<li>è°ƒä½¿ç”¨æ–¹å¼ä¸åŒ\n<ul>\n<li>Ribbonéœ€è¦æ„å»ºHttpè¯·æ±‚ï¼Œæ¨¡æ‹ŸHttpè¯·æ±‚è€Œåç”¨RestTemplateå‘é€ç»™å…¶ä½™æœåŠ¡ï¼Œæ­¥éª¤ç›¸å½“ç¹çã€‚</li>\n<li>Feigné‡‡ä½¿ç”¨æ¥å£çš„æ–¹å¼ï¼Œå°†éœ€è¦è°ƒä½¿ç”¨çš„å…¶ä½™æœåŠ¡çš„æ–¹æ³•å®šä¹‰æˆå£°æ˜æ–¹æ³•å°±å¯ï¼Œä¸éœ€è¦æ„å»ºHttpè¯·æ±‚ã€‚ä¸è¿‡è¦æ³¨æ„çš„æ˜¯å£°æ˜æ–¹æ³•çš„æ³¨è§£ã€æ–¹æ³•ç­¾åè¦å’Œæä¾›æœåŠ¡çš„æ–¹æ³•å®Œå…¨ä¸€è‡´ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>5.2. Feign æ˜¯æ€ä¹ˆå’Œ Ribbonã€Eureka æ•´åˆçš„?</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0520ffe60397bffac0eb3.jpg\" alt=\"feginribboneureka.png\" tabindex=\"0\"><figcaption>feginribboneureka.png</figcaption></figure>\n<ul>\n<li>é¦–å…ˆï¼Œç”¨æˆ·è°ƒç”¨ Feign åˆ›å»ºçš„åŠ¨æ€ä»£ç†ã€‚</li>\n<li>ç„¶åï¼ŒFeign è°ƒç”¨ Ribbon å‘èµ·è°ƒç”¨æµç¨‹ã€‚\n<ul>\n<li>é¦–å…ˆï¼ŒRibbon ä¼šä» Eureka Client é‡Œè·å–åˆ°å¯¹åº”çš„æœåŠ¡åˆ—è¡¨ã€‚</li>\n<li>ç„¶åï¼ŒRibbon ä½¿ç”¨è´Ÿè½½å‡è¡¡ç®—æ³•è·å¾—ä½¿ç”¨çš„æœåŠ¡ã€‚</li>\n<li>ribbonè°ƒç”¨å¯¹åº”çš„æœåŠ¡ï¼Œè°ƒç”¨ Feign ï¼Œè€Œ Feign è°ƒç”¨ HTTP åº“æœ€ç»ˆè°ƒç”¨ä½¿ç”¨çš„æœåŠ¡ã€‚</li>\n<li>å› ä¸º Feign å’Œ Ribbon éƒ½å­˜åœ¨ä½¿ç”¨ HTTP åº“è°ƒç”¨æŒ‡å®šçš„æœåŠ¡ï¼Œä¸¤è€…é›†æˆåä¿ç•™Feignçš„è°ƒç”¨ï¼Œè€ŒRibbonåªè´Ÿè´£è´Ÿè½½å‡è¡¡åŠŸèƒ½</li>\n</ul>\n</li>\n</ul>\n<h2>5.3. Feign é‡è¯•æœºåˆ¶ï¼Ÿ</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//Ribbon+RestTemplateçš„é‡è¯•\n@Bean\n@LoadBalanced\npublic RestTemplate restTemplate() {\n  SimpleClientHttpRequestFactory simpleClientHttpRequestFactory = new   SimpleClientHttpRequestFactory();\n  simpleClientHttpRequestFactory.setConnectTimeout(1000);\n  simpleClientHttpRequestFactory.setReadTimeout(1000);\n  return new RestTemplate(simpleClientHttpRequestFactory);\n}\nåœ¨æ­¤åŸºç¡€ä¸Šï¼Œä½¿ç”¨å¦‚ä¸‹é…ç½®ï¼Œå³å¯å®ç°é‡è¯•ï¼š\nspring.cloud.loadbalancer.retry.enabled=true\nribbon:\n  # åŒä¸€å®ä¾‹æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬é¦–æ¬¡è°ƒç”¨\n  MaxAutoRetries: 1\n  # é‡è¯•å…¶ä»–å®ä¾‹çš„æœ€å¤§é‡è¯•æ¬¡æ•°ï¼Œä¸åŒ…æ‹¬é¦–æ¬¡æ‰€é€‰çš„server\n  MaxAutoRetriesNextServer: 2\n  # æ˜¯å¦æ‰€æœ‰æ“ä½œéƒ½è¿›è¡Œé‡è¯•\n  OkToRetryOnAllOperations: false\n\nå› ä¸º Ribbon å’Œ Feign éƒ½æœ‰é‡è¯•æœºåˆ¶ï¼Œåœ¨æ•´åˆ Ribbon çš„æƒ…å†µä¸‹ï¼Œä¸ä½¿ç”¨ Feign é‡è¯•ï¼Œè€Œæ˜¯ä½¿ç”¨ Ribbon çš„é‡è¯•ã€‚\nribbon:\n  MaxAutoRetries: 1\n  MaxAutoRetriesNextServer: 2\n  OkToRetryOnAllOperations: false\nç›¸å…³Issueå¯å‚è€ƒï¼šhttps://github.com/spring-cloud/spring-cloud-netflix/issues/467\n\nZuulçš„é‡è¯•\n# å¼€å¯äº†é‡è¯•\nzuul.retryable: true\nribbon:\n  MaxAutoRetries: 1\n  MaxAutoRetriesNextServer: 2\n  OkToRetryOnAllOperations: false\n# æŒ‡å®šå±€éƒ¨è·¯ç”±å¼€å¯é‡è¯•ï¼Œå±€éƒ¨é…ç½®ä¼˜å…ˆçº§æ›´é«˜ã€‚\nzuul.routes.&lt;routename&gt;.retryable=true\n\nåŸºäºHTTPå“åº”ç é‡è¯•\nclientName.ribbon.retryableStatusCodes: 404,502\nHystrixçš„è¶…æ—¶æ—¶é—´å¿…é¡»å¤§äºè¶…æ—¶çš„æ—¶é—´ï¼Œå¦åˆ™ï¼Œä¸€æ—¦Hystrixè¶…æ—¶ï¼Œå°±æ²¡åŠæ³•ç»§ç»­é‡è¯•äº†ã€‚\nä¸å»ºè®®å°†ribbon.OkToRetryOnAllOperations è®¾ä¸ºtrueã€‚å› ä¸ºä¸€æ—¦å¯ç”¨è¯¥é…ç½®ï¼Œåˆ™è¡¨ç¤ºé‡è¯•ä»»ä½•æ“ä½œï¼ŒåŒ…æ‹¬POSTè¯·æ±‚ï¼Œè€Œç”±äºç¼“å­˜äº†è¯·æ±‚ä½“ï¼Œæ­¤æ—¶å¯èƒ½ä¼šå½±å“æœåŠ¡å™¨çš„èµ„æºã€‚\n</code></pre></div><h1>6. æœåŠ¡ä¿éšœï¼Ÿ</h1>\n<ul>\n<li>spring-cloud-netflix-hystrixåŸºäº Hystrix å®ç°ã€‚</li>\n<li>spring-cloud-alibaba-sentinelåŸºäº Sentinel å®ç°ã€‚</li>\n</ul>\n<h2>ä»€ä¹ˆæ˜¯æœåŠ¡é›ªå´©ï¼Ÿ</h2>\n<ul>\n<li>åœ¨å¾®æœåŠ¡ä¸­ï¼Œå‡å¦‚ä¸€ä¸ªæˆ–è€…å¤šä¸ªæœåŠ¡å‡ºç°æ•…éšœï¼Œå¦‚æœè¿™æ—¶å€™ï¼Œä¾èµ–çš„æœåŠ¡è¿˜åœ¨ä¸æ–­å‘èµ·è¯·æ±‚ï¼Œæˆ–è€…é‡è¯•ï¼Œé‚£ä¹ˆè¿™äº›è¯·æ±‚çš„å‹åŠ›ä¼šä¸æ–­åœ¨ä¸‹æ¸¸å †ç§¯ï¼Œå¯¼è‡´ä¸‹æ¸¸æœåŠ¡çš„è´Ÿè½½æ€¥å‰§å¢åŠ ã€‚ä¸æ–­ç´¯è®¡ä¹‹ä¸‹ï¼Œå¯èƒ½ä¼šå¯¼è‡´æ•…éšœçš„è¿›ä¸€æ­¥åŠ å‰§ï¼Œå¯èƒ½ä¼šå¯¼è‡´çº§è”å¼çš„å¤±è´¥ï¼Œç”šè‡³å¯¼è‡´æ•´ä¸ªç³»ç»Ÿå´©æºƒï¼Œè¿™å°±å«æœåŠ¡é›ªå´©ã€‚</li>\n<li>é˜²æ­¢æ–¹æ³•\n<ul>\n<li>æœåŠ¡é«˜å¯ç”¨éƒ¨ç½²ï¼šç¡®ä¿å„ä¸ªæœåŠ¡éƒ½å…·å¤‡é«˜å¯ç”¨æ€§ï¼Œé€šè¿‡å†—ä½™éƒ¨ç½²ã€æ•…éšœè½¬ç§»ç­‰æ–¹å¼æ¥å‡å°‘å•ç‚¹æ•…éšœçš„å½±å“ã€‚</li>\n<li>é™æµå’Œç†”æ–­ï¼šå¯¹æœåŠ¡ä¹‹é—´çš„è¯·æ±‚è¿›è¡Œé™æµå’Œç†”æ–­ï¼Œä»¥é˜²æ­¢è¿‡å¤šçš„è¯·æ±‚æ¶Œå…¥å¯¼è‡´åç«¯æœåŠ¡ä¸å¯ç”¨ã€‚</li>\n<li>ç¼“å­˜å’Œé™çº§ï¼šåˆç†ä½¿ç”¨ç¼“å­˜æ¥å‡è½»åç«¯æœåŠ¡çš„è´Ÿè½½å‹åŠ›ï¼Œå¹¶åœ¨å¿…è¦æ—¶è¿›è¡ŒæœåŠ¡é™çº§ï¼Œä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„å¯ç”¨æ€§ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>6.1. ä¸ºä»€ä¹ˆè¦ä½¿ç”¨æœåŠ¡ä¿éšœï¼Ÿ</h2>\n<ul>\n<li>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œæˆ‘ä»¬å°†ä¸šåŠ¡æ‹†åˆ†æˆä¸€ä¸ªä¸ªçš„æœåŠ¡ï¼ŒæœåŠ¡ä¸æœåŠ¡ä¹‹é—´å¯ä»¥ç›¸äº’è°ƒç”¨ï¼ˆRPCï¼‰ã€‚ä¸ºäº†ä¿è¯å…¶é«˜å¯ç”¨ï¼Œå•ä¸ªæœåŠ¡åˆå¿…é¡»é›†ç¾¤éƒ¨ç½²ã€‚ç”±äºç½‘ç»œåŸå› æˆ–è€…è‡ªèº«çš„åŸå› ï¼ŒæœåŠ¡å¹¶ä¸èƒ½ä¿è¯æœåŠ¡çš„ 100% å¯ç”¨ï¼Œå¦‚æœå•ä¸ªæœåŠ¡å‡ºç°é—®é¢˜ï¼Œè°ƒç”¨è¿™ä¸ªæœåŠ¡å°±ä¼šå‡ºç°ç½‘ç»œå»¶è¿Ÿï¼Œæ­¤æ—¶è‹¥æœ‰å¤§é‡çš„ç½‘ç»œæ¶Œå…¥ï¼Œä¼šå½¢æˆä»»åŠ¡ç´¯ç§¯ï¼Œå¯¼è‡´æœåŠ¡ç˜«ç—ªï¼Œç”šè‡³å¯¼è‡´æœåŠ¡â€œé›ªå´©â€ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå°±å‡ºç°æ–­è·¯å™¨æ¨¡å‹ã€‚</li>\n</ul>\n<h2>6.2. hystrixä½œç”¨ï¼ŒåŸç†âˆš</h2>\n<ul>\n<li>æ–­è·¯å™¨ï¼Œä¿æŠ¤ç³»ç»Ÿï¼Œæ§åˆ¶æ•…éšœèŒƒå›´ã€‚</li>\n<li>ç®€ä»‹ï¼šHystrix æ˜¯ä¸€ä¸ªå»¶è¿Ÿå’Œå®¹é”™åº“ï¼Œæ—¨åœ¨éš”ç¦»è¿œç¨‹ç³»ç»Ÿï¼ŒæœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„è®¿é—®ç‚¹ï¼Œå½“å‡ºç°æ•…éšœæ˜¯ä¸å¯é¿å…çš„æ•…éšœæ—¶ï¼Œåœæ­¢çº§è”æ•…éšœå¹¶åœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°å¼¹æ€§ã€‚</li>\n<li>æ—¨åœ¨é€šè¿‡æ·»åŠ å»¶è¿Ÿå®¹é”™å’Œå®¹é”™é€»è¾‘æ¥æé«˜åˆ†å¸ƒå¼ç³»ç»Ÿçš„å¼¹æ€§ï¼Œé˜²æ­¢é›ªå´©æ•ˆåº”çš„å‘ç”Ÿã€‚å®ƒé€šè¿‡éš”ç¦»æœåŠ¡ä¹‹é—´çš„ä¾èµ–å…³ç³»ã€é™åˆ¶å¹¶å‘çº¿ç¨‹æ± çš„å¤§å°ã€å®ç°ç†”æ–­æœºåˆ¶ç­‰æ–¹å¼æ¥å®ç°å®¹é”™ã€‚</li>\n<li>æ—¨åœ¨éš”ç¦»è¿œç¨‹ç³»ç»Ÿï¼ŒæœåŠ¡å’Œç¬¬ä¸‰æ–¹åº“çš„è®¿é—®ç‚¹ï¼Œå½“å‡ºç°æ•…éšœæ˜¯ä¸å¯é¿å…çš„æ•…éšœæ—¶ï¼Œåœæ­¢çº§è”æ•…éšœå¹¶åœ¨å¤æ‚çš„åˆ†å¸ƒå¼ç³»ç»Ÿä¸­å®ç°å¼¹æ€§ã€‚</li>\n</ul>\n<h2>6.3. Hystrixéš”ç¦»ç­–ç•¥</h2>\n<ul>\n<li>çº¿ç¨‹æ± éš”ç¦»(æ”¯æŒè¶…æ—¶)ã€‚tomcatçº¿ç¨‹ä¼šå°†è¯·æ±‚ä»»åŠ¡äº¤ç»™æœåŠ¡å†…éƒ¨çº¿ç¨‹æ± çš„çº¿ç¨‹å¤„ç†ï¼Œçº¿ç¨‹å®Œæˆåå°†è°ƒç”¨ç»“æœè¿”å›ç»™tomcatã€‚ä»è€Œå®ç°èµ„æºéš”ç¦»ï¼ŒæœåŠ¡å†…éƒ¨çš„çº¿ç¨‹æ± çš„æ•°é‡å°±å†³å®šäº†æ•´ä¸ªæœåŠ¡å¹¶å‘åº¦ï¼›å½“è¯·æ±‚çš„æœåŠ¡ç½‘ç»œå¼€é”€æ¯”è¾ƒå¤§çš„æ—¶å€™ï¼Œæˆ–è€…æ˜¯è¯·æ±‚æ¯”è¾ƒè€—æ—¶çš„æ—¶å€™ä½¿ç”¨ï¼Œå› ä¸ºï¼Œå¯ä»¥ä¿è¯å¤§é‡çš„å®¹å™¨(tomcat)çº¿ç¨‹å¯ç”¨ï¼Œä¸ä¼šç”±äºæœåŠ¡åŸå› ï¼Œä¸€ç›´å¤„äºé˜»å¡æˆ–ç­‰å¾…çŠ¶æ€ï¼Œå¿«é€Ÿå¤±è´¥è¿”å›</li>\n<li>ä¿¡å·é‡éš”ç¦»ã€‚é™åˆ¶tomcatè®¿é—®æœåŠ¡çš„çº¿ç¨‹æ•°è¾¾åˆ°é™æµç›®çš„ã€‚è¯·æ±‚ç¼“å­˜æœåŠ¡æ—¶ä½¿ç”¨ï¼Œå› ä¸ºè¿™ç±»æœåŠ¡çš„è¿”å›é€šå¸¸ä¼šéå¸¸çš„å¿«ï¼Œä¸ä¼šå ç”¨å®¹å™¨çº¿ç¨‹å¤ªé•¿æ—¶é—´ï¼Œè€Œä¸”ä¹Ÿå‡å°‘äº†çº¿ç¨‹åˆ‡æ¢çš„ä¸€äº›å¼€é”€ï¼Œæé«˜äº†ç¼“å­˜æœåŠ¡çš„æ•ˆç‡<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/62d5d0137dc8127da398a.jpg\" alt=\"hystrixprinciple.png\"></li>\n</ul>\n<h2>6.4. Hystrix ç¼“å­˜æœºåˆ¶ï¼Ÿä½œç”¨ï¼Ÿ</h2>\n<ul>\n<li>å‡å°‘é‡å¤çš„è¯·æ±‚æ•°ã€‚é™ä½ä¾èµ–æœåŠ¡çš„è¿”å›æ•°æ®å§‹ç»ˆä¿æŒä¸€è‡´ã€‚</li>\n<li>åœ¨åŒä¸€ä¸ªç”¨æˆ·è¯·æ±‚çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œç›¸åŒä¾èµ–æœåŠ¡çš„è¿”å›æ•°æ®å§‹ç»ˆä¿æŒä¸€è‡´ã€‚</li>\n<li>è¯·æ±‚ç¼“å­˜åœ¨run()å’Œconstruct()æ‰§è¡Œä¹‹å‰ç”Ÿæ•ˆï¼Œæ‰€ä»¥å¯ä»¥æœ‰æ•ˆå‡å°‘ä¸å¿…è¦çš„çº¿ç¨‹å¼€é”€</li>\n</ul>\n<h2>7. ä»€ä¹ˆæ˜¯æœåŠ¡ç†”æ–­ï¼Ÿ</h2>\n<ul>\n<li>æœåŠ¡ç†”æ–­æ˜¯å¾®æœåŠ¡æ¶æ„ä¸­çš„å®¹é”™æœºåˆ¶ï¼Œç”¨äºä¿æŠ¤ç³»ç»Ÿå…å—æœåŠ¡æ•…éšœæˆ–å¼‚å¸¸çš„å½±å“ã€‚å½“æŸä¸ªæœåŠ¡å‡ºç°æ•…éšœæˆ–å¼‚å¸¸æ—¶ï¼ŒæœåŠ¡ç†”æ–­å¯ä»¥å¿«é€Ÿéš”ç¦»è¯¥æœåŠ¡ï¼Œç¡®ä¿ç³»ç»Ÿç¨³å®šå¯ç”¨ã€‚</li>\n<li>å®ƒé€šè¿‡ç›‘æ§æœåŠ¡çš„è°ƒç”¨æƒ…å†µï¼Œå½“é”™è¯¯ç‡æˆ–å“åº”æ—¶é—´è¶…è¿‡é˜ˆå€¼æ—¶ï¼Œè§¦å‘ç†”æ–­æœºåˆ¶ï¼Œåç»­è¯·æ±‚å°†è¿”å›é»˜è®¤å€¼æˆ–é”™è¯¯ä¿¡æ¯ï¼Œé¿å…èµ„æºæµªè´¹å’Œç³»ç»Ÿå´©æºƒã€‚</li>\n<li>æœåŠ¡ç†”æ–­è¿˜æ”¯æŒè‡ªåŠ¨æ¢å¤ï¼Œé‡æ–°å°è¯•å¯¹æ•…éšœæœåŠ¡çš„è¯·æ±‚ï¼Œç¡®ä¿æœåŠ¡æ¢å¤æ­£å¸¸åç»§ç»­ä½¿ç”¨ã€‚</li>\n</ul>\n<h2>ä»€ä¹ˆæ˜¯æœåŠ¡é™çº§ï¼Ÿ</h2>\n<ul>\n<li>æœåŠ¡é™çº§æ˜¯ä¸€ç§å¾®æœåŠ¡æ¶æ„ä¸­çš„å®¹é”™æœºåˆ¶ï¼Œç”¨äºåœ¨ç³»ç»Ÿèµ„æºç´§å¼ æˆ–æœåŠ¡æ•…éšœæ—¶ä¿è¯æ ¸å¿ƒåŠŸèƒ½çš„å¯ç”¨æ€§ã€‚</li>\n<li>å½“ç³»ç»Ÿå‡ºç°å¼‚å¸¸æƒ…å†µæ—¶ï¼ŒæœåŠ¡é™çº§ä¼šä¸»åŠ¨å±è”½ä¸€äº›éæ ¸å¿ƒæˆ–å¯é€‰çš„åŠŸèƒ½ï¼Œè€Œåªæä¾›æœ€åŸºæœ¬çš„åŠŸèƒ½ï¼Œä»¥ç¡®ä¿ç³»ç»Ÿçš„ç¨³å®šè¿è¡Œã€‚é€šè¿‡å‡å°‘å¯¹èµ„æºçš„ä¾èµ–ï¼ŒæœåŠ¡é™çº§å¯ä»¥ä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§å’Œæ€§èƒ½ã€‚</li>\n<li>å®ƒå¯ä»¥æ ¹æ®ä¸šåŠ¡éœ€æ±‚å’Œç³»ç»ŸçŠ¶å†µæ¥åˆ¶å®šç­–ç•¥ï¼Œä¾‹å¦‚æ›¿æ¢è€—æ—¶æ“ä½œã€è¿”å›é»˜è®¤å“åº”ã€è¿”å›é™æ€é”™è¯¯é¡µé¢ç­‰ã€‚</li>\n</ul>\n<h2>ç†”æ–­é™çº§æ–¹æ¡ˆå®ç°ï¼Ÿ</h2>\n<table>\n<thead>\n<tr>\n<th>æ¡†æ¶</th>\n<th>å®ç°æ–¹æ¡ˆ</th>\n<th>ç‰¹ç‚¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>Spring Cloud\tNetflix</td>\n<td>Hystrix</td>\n<td>æä¾›çº¿ç¨‹éš”ç¦»ã€æœåŠ¡é™çº§ã€è¯·æ±‚ç¼“å­˜ã€è¯·æ±‚åˆå¹¶ç­‰åŠŸèƒ½å¯ä¸Spring Cloudå…¶ä»–ç»„ä»¶æ— ç¼é›†æˆ.å®˜æ–¹å·²å®£å¸ƒåœæ­¢ç»´æŠ¤ï¼Œæ¨èä½¿ç”¨Resilience4jä»£æ›¿</td>\n</tr>\n<tr>\n<td>Spring Cloud</td>\n<td>Resilience4j</td>\n<td>è½»é‡çº§æœåŠ¡ç†”æ–­åº“ æä¾›ç±»ä¼¼äºHystrixçš„åŠŸèƒ½ å…·æœ‰æ›´å¥½çš„æ€§èƒ½å’Œæ›´ç®€æ´çš„API å¯ä¸Spring Cloudå…¶ä»–ç»„ä»¶æ— ç¼é›†æˆ</td>\n</tr>\n<tr>\n<td>Spring Cloud Alibaba</td>\n<td>Sentinel</td>\n<td>é˜¿é‡Œå·´å·´å¼€æºçš„æµé‡æ§åˆ¶å’Œç†”æ–­é™çº§ç»„ä»¶æä¾›å®æ—¶ç›‘æ§ã€æµé‡æ§åˆ¶ã€ç†”æ–­é™çº§ç­‰åŠŸèƒ½ä¸Spring Cloud Alibabaç”Ÿæ€ç³»ç»Ÿç´§å¯†é›†æˆ</td>\n</tr>\n<tr>\n<td>Dubbo</td>\n<td>Dubboè‡ªå¸¦ç†”æ–­é™çº§æœºåˆ¶</td>\n<td>Dubboæ¡†æ¶æœ¬èº«æä¾›çš„ç†”æ–­é™çº§æœºåˆ¶å¯é€šè¿‡é…ç½®å®ç°æœåŠ¡ç†”æ–­å’Œé™çº§ä¸Dubboçš„RPCæ¡†æ¶ç´§å¯†é›†æˆ</td>\n</tr>\n</tbody>\n</table>\n<h1>Hystrixæ€ä¹ˆå®ç°æœåŠ¡å®¹é”™ï¼Ÿ</h1>\n<ul>\n<li>æœåŠ¡ç†”æ–­ï¼ˆCircuit Breakerï¼‰ï¼šHystrixé€šè¿‡è®¾ç½®é˜ˆå€¼æ¥ç›‘æ§æœåŠ¡çš„é”™è¯¯ç‡æˆ–å“åº”æ—¶é—´ã€‚å½“é”™è¯¯ç‡æˆ–å“åº”æ—¶é—´è¶…è¿‡é¢„è®¾çš„é˜ˆå€¼æ—¶ï¼Œç†”æ–­å™¨å°†ä¼šæ‰“å¼€ï¼Œåç»­çš„è¯·æ±‚å°†ä¸å†å‘é€åˆ°å®é™…çš„æœåŠ¡æä¾›æ–¹ï¼Œè€Œæ˜¯è¿”å›é¢„è®¾çš„é»˜è®¤å€¼æˆ–é”™è¯¯ä¿¡æ¯ã€‚è¿™æ ·å¯ä»¥å¿«é€Ÿéš”ç¦»æ•…éšœæœåŠ¡ï¼Œé˜²æ­¢æ•…éšœæ‰©æ•£ï¼Œæé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚</li>\n<li>æœåŠ¡é™çº§ï¼ˆFallbackï¼‰ï¼šå½“æœåŠ¡ç†”æ–­æ‰“å¼€æ—¶ï¼ŒHystrixå¯ä»¥æä¾›ä¸€ä¸ªå¤‡ç”¨çš„é™çº§æ–¹æ³•æˆ–è¿”å›é»˜è®¤å€¼ï¼Œä»¥ä¿è¯ç³»ç»Ÿç»§ç»­æ­£å¸¸è¿è¡Œã€‚å¼€å‘è€…å¯ä»¥å®šä¹‰é™çº§é€»è¾‘ï¼Œä¾‹å¦‚è¿”å›ç¼“å­˜æ•°æ®ã€æ‰§è¡Œç®€åŒ–çš„é€»è¾‘æˆ–è°ƒç”¨å…¶ä»–å¯é çš„æœåŠ¡ï¼Œä»¥æä¾›æœ‰é™ä½†å¯ç”¨çš„åŠŸèƒ½ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>import com.netflix.hystrix.contrib.javanica.annotation.HystrixCommand; \n  \n /** \n * æœåŠ¡é™çº§ç¤ºä¾‹ \n **/ \n @Service \n public class MyService { \n  \n     @HystrixCommand(fallbackMethod = \"fallbackMethod\") \n     public String myServiceMethod() { \n         // å®é™…çš„æœåŠ¡è°ƒç”¨é€»è¾‘ \n         // ... \n     } \n  \n     public String fallbackMethod() { \n         // é™çº§æ–¹æ³•çš„é€»è¾‘ï¼Œå½“æœåŠ¡è°ƒç”¨å¤±è´¥æ—¶ä¼šæ‰§è¡Œæ­¤æ–¹æ³• \n         // å¯ä»¥è¿”å›é»˜è®¤å€¼æˆ–æ‰§è¡Œå…¶ä»–å¤‡ç”¨é€»è¾‘ \n         // ... \n     } \n }\n</code></pre></div><ul>\n<li>è¯·æ±‚ç¼“å­˜ï¼ˆRequest Cachingï¼‰ï¼šHystrixå¯ä»¥ç¼“å­˜å¯¹åŒä¸€è¯·æ±‚çš„å“åº”ç»“æœï¼Œå½“ä¸‹æ¬¡è¯·æ±‚ç›¸åŒçš„æ•°æ®æ—¶ï¼Œç›´æ¥ä»ç¼“å­˜ä¸­è·å–ï¼Œé¿å…é‡å¤çš„ç½‘ç»œè¯·æ±‚ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½å’Œå“åº”é€Ÿåº¦ã€‚</li>\n<li>è¯·æ±‚åˆå¹¶ï¼ˆRequest Collapsingï¼‰ï¼šHystrixå¯ä»¥å°†å¤šä¸ªå¹¶å‘çš„è¯·æ±‚åˆå¹¶ä¸ºä¸€ä¸ªæ‰¹é‡è¯·æ±‚ï¼Œå‡å°‘ç½‘ç»œå¼€é”€å’Œèµ„æºå ç”¨ã€‚è¿™å¯¹äºä¸€äº›é«˜å¹¶å‘çš„åœºæ™¯å¯ä»¥æœ‰æ•ˆåœ°å‡å°‘è¯·æ±‚æ¬¡æ•°ï¼Œæé«˜ç³»ç»Ÿçš„æ€§èƒ½ã€‚</li>\n<li>å®æ—¶ç›‘æ§å’Œåº¦é‡ï¼ˆReal-time Monitoring and Metricsï¼‰ï¼šHystrixæä¾›äº†å®æ—¶ç›‘æ§å’Œåº¦é‡åŠŸèƒ½ï¼Œå¯ä»¥å¯¹æœåŠ¡çš„æ‰§è¡Œæƒ…å†µè¿›è¡Œç›‘æ§å’Œç»Ÿè®¡ï¼ŒåŒ…æ‹¬é”™è¯¯ç‡ã€å“åº”æ—¶é—´ã€å¹¶å‘é‡ç­‰æŒ‡æ ‡ã€‚é€šè¿‡ç›‘æ§æ•°æ®ï¼Œå¯ä»¥åŠæ—¶å‘ç°å’Œè§£å†³æœåŠ¡æ•…éšœæˆ–æ€§èƒ½é—®é¢˜ã€‚</li>\n<li>çº¿ç¨‹æ± éš”ç¦»ï¼ˆThread Pool Isolationï¼‰ï¼šHystrixå°†æ¯ä¸ªä¾èµ–æœåŠ¡çš„è¯·æ±‚éƒ½æ”¾åœ¨ç‹¬ç«‹çš„çº¿ç¨‹æ± ä¸­æ‰§è¡Œï¼Œé¿å…å› æŸä¸ªæœåŠ¡çš„æ•…éšœå¯¼è‡´æ•´ä¸ªç³»ç»Ÿçš„çº¿ç¨‹èµ„æºè€—å°½ã€‚é€šè¿‡çº¿ç¨‹æ± éš”ç¦»ï¼Œå¯ä»¥æé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯ç”¨æ€§ã€‚</li>\n</ul>\n<h2>6.5. Hystrix ç†”æ–­æœºåˆ¶ï¼Ÿå®ç°ï¼Ÿ</h2>\n<ul>\n<li>Hystrixçš„ç†”æ–­æœºåˆ¶é€šè¿‡ç›‘æ§æœåŠ¡è°ƒç”¨çš„çŠ¶æ€æ¥å®ç°ã€‚å½“æœåŠ¡è°ƒç”¨å¤±è´¥ç‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼ŒHystrixä¼šè‡ªåŠ¨å¼€å¯ç†”æ–­å™¨ï¼Œå°†åç»­çš„è¯·æ±‚å¿«é€Ÿå¤±è´¥ï¼Œé¿å…å¯¹æœåŠ¡çš„è¿›ä¸€æ­¥å‹åŠ›ã€‚</li>\n<li>Hystrixçš„ç†”æ–­æ–¹å¼æœ‰ä»¥ä¸‹å‡ ç§ï¼š\n<ul>\n<li>å¼ºåˆ¶ç†”æ–­ï¼šåœ¨æŸäº›æƒ…å†µä¸‹ï¼Œæ¯”å¦‚æœåŠ¡æä¾›æ–¹å®•æœºç­‰æƒ…å†µä¸‹ï¼Œç›´æ¥å¼ºåˆ¶ç†”æ–­ï¼Œä¸å†è¿›è¡ŒæœåŠ¡è°ƒç”¨ã€‚</li>\n<li>æ ¹æ®é˜ˆå€¼ç†”æ–­ï¼šå½“æœåŠ¡è°ƒç”¨å¤±è´¥ç‡è¾¾åˆ°ä¸€å®šé˜ˆå€¼æ—¶ï¼Œè‡ªåŠ¨å¼€å¯ç†”æ–­å™¨ï¼Œå°†åç»­è¯·æ±‚å¿«é€Ÿå¤±è´¥ã€‚</li>\n<li>åŠå¼€çŠ¶æ€ç†”æ–­ï¼šåœ¨ç†”æ–­å™¨å¼€å¯ä¸€æ®µæ—¶é—´åï¼Œå°è¯•å‘é€ä¸€ä¸ªæµ‹è¯•è¯·æ±‚åˆ°æœåŠ¡æä¾›æ–¹ï¼Œå¦‚æœè¯·æ±‚æˆåŠŸï¼Œåˆ™ç†”æ–­å™¨è¿›å…¥åŠå¼€çŠ¶æ€ï¼Œå¦åˆ™ç»§ç»­ä¿æŒå¼€å¯çŠ¶æ€ã€‚</li>\n<li>é™çº§ï¼šå½“æœåŠ¡è°ƒç”¨å¤±è´¥æˆ–è¶…æ—¶æ—¶ï¼Œå¯ä»¥é€šè¿‡è¿”å›é»˜è®¤å€¼æˆ–è€…è°ƒç”¨å¤‡ç”¨æœåŠ¡çš„æ–¹å¼è¿›è¡Œé™çº§ï¼Œä¿è¯ç³»ç»Ÿçš„å¯ç”¨æ€§ã€‚</li>\n</ul>\n</li>\n<li>Hystrixæ–­è·¯å™¨é€šè¿‡HystrixCircuitBreakerå®ç°ã€‚æœ‰ä¸‰ç§çŠ¶æ€:CLOSED-å…³é—­ï¼›OPEN-æ‰“å¼€ï¼›HALF_OPEN-åŠå¼€\n<ul>\n<li>æ–­è·¯å™¨å¤„äºOPENçŠ¶æ€æ—¶ï¼Œé“¾è·¯å¤„äºéå¥åº·çŠ¶æ€ï¼Œå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œç›´æ¥è°ƒç”¨å›é€€é€»è¾‘ï¼Œè·³è¿‡æ­£å¸¸é€»è¾‘ã€‚</li>\n<li>çº¢çº¿:åˆå§‹æ—¶æ–­è·¯å™¨å¤„äºCLOSEDçŠ¶æ€ï¼Œé“¾è·¯å¤„äºå¥åº·çŠ¶æ€ã€‚å½“æ»¡è¶³å¦‚ä¸‹æ¡ä»¶ï¼Œæ–­è·¯å™¨ä»CLOSEDå˜æˆOPENçŠ¶æ€\n<ul>\n<li>å‘¨æœŸ(å¯é…ï¼ŒHystrixCommandProperties.default_metricsRollingStatisticalWindow = 10000 ms)å†…ï¼Œæ€»è¯·æ±‚æ•°è¶…è¿‡ä¸€å®šé‡(å¯é…ï¼ŒHystrixCommandProperties.circuitBreakerRequestVolumeThreshold = 20 ) ã€‚é”™è¯¯è¯·æ±‚å æ€»è¯·æ±‚æ•°è¶…è¿‡ä¸€å®šæ¯”ä¾‹( å¯é…ï¼ŒHystrixCommandProperties.circuitBreakerErrorThresholdPercentage = 50% ) ã€‚</li>\n</ul>\n</li>\n<li>ç»¿çº¿:æ–­è·¯å™¨å¤„äºOPENçŠ¶æ€ï¼Œå‘½ä»¤æ‰§è¡Œæ—¶ï¼Œè‹¥å½“å‰æ—¶é—´è¶…è¿‡æ–­è·¯å™¨å¼€å¯æ—¶é—´ä¸€å®šæ—¶é—´(HystrixCommandProperties.circuitBreakerSleepWindowInMilliseconds = 5000ms)ï¼Œæ–­è·¯å™¨å˜æˆHALF_OPENçŠ¶æ€ï¼Œå°è¯•è°ƒç”¨æ­£å¸¸é€»è¾‘ï¼Œæ ¹æ®æ‰§è¡Œæ˜¯å¦æˆåŠŸï¼Œæ‰“å¼€æˆ–å…³é—­ç†”æ–­å™¨ã€è“çº¿ã€‘ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7aa4fa0667258f4190419.jpg\" alt=\"hystrixcircuitbreakerstatuschange.png\"></li>\n</ul>\n</li>\n</ul>\n<h2>6.6. ä»€ä¹ˆæ˜¯ HystrixæœåŠ¡é™çº§ï¼Ÿ</h2>\n<ul>\n<li>åœ¨ Hystrix æ–­è·¯å™¨ç†”æ–­æ—¶ï¼Œå¯ä»¥è°ƒç”¨ä¸€ä¸ªé™çº§æ–¹æ³•(éœ€è¦é…ç½®å’Œç¼–ç ï¼Œä¹Ÿå¯ä»¥ä¸å†™ï¼Œä¹Ÿå°±æ˜¯ä¸ä¼šæœ‰æœåŠ¡é™çº§çš„åŠŸèƒ½)ï¼Œè¿”å›ç›¸åº”çš„ç»“æœã€‚</li>\n</ul>\n<h2>8. æœåŠ¡ç†”æ–­å’ŒæœåŠ¡é™çº§çš„åŒºåˆ«</h2>\n<ul>\n<li>æœåŠ¡ç†”æ–­ä¸€èˆ¬æ˜¯æŸä¸ªæœåŠ¡ï¼ˆä¸‹æ¸¸æœåŠ¡ï¼‰æ•…éšœå¼•èµ·ï¼Œè€ŒæœåŠ¡é™çº§ä¸€èˆ¬æ˜¯ä»æ•´ä½“è´Ÿè·è€ƒè™‘ï¼›ç†”æ–­å…¶å®æ˜¯ä¸€ä¸ªæ¡†æ¶çº§çš„å¤„ç†ï¼Œæ¯ä¸ªå¾®æœåŠ¡éƒ½éœ€è¦ï¼ˆæ— å±‚çº§ä¹‹åˆ†ï¼‰ï¼Œè€Œé™çº§ä¸€èˆ¬éœ€è¦å¯¹ä¸šåŠ¡æœ‰å±‚çº§ä¹‹åˆ†ï¼ˆæ¯”å¦‚é™çº§ä¸€èˆ¬æ˜¯ä»æœ€å¤–å›´æœåŠ¡å¼€å§‹ï¼‰å®ç°æ–¹å¼ä¸å¤ªä¸€æ ·ï¼›æœåŠ¡é™çº§å…·æœ‰ä»£ç ä¾µå…¥æ€§(ç”±æ§åˆ¶å™¨å®Œæˆ/æˆ–è‡ªåŠ¨é™çº§)ï¼Œç†”æ–­ä¸€èˆ¬ç§°ä¸ºè‡ªæˆ‘ç†”æ–­ã€‚</li>\n</ul>\n<h2>9. æœåŠ¡é™æµ</h2>\n<ul>\n<li>é™æµçš„ç›®çš„æ˜¯é€šè¿‡å¯¹å¹¶å‘è®¿é—®/è¯·æ±‚è¿›è¡Œé™é€Ÿæˆ–è€…ä¸€ä¸ªæ—¶é—´çª—å£å†…çš„çš„è¯·æ±‚è¿›è¡Œé™é€Ÿæ¥ä¿æŠ¤ç³»ç»Ÿï¼Œä¸€æ—¦è¾¾åˆ°é™åˆ¶é€Ÿç‡åˆ™å¯ä»¥æ‹’ç»æœåŠ¡ï¼ˆå®šå‘åˆ°é”™è¯¯é¡µæˆ–å‘ŠçŸ¥èµ„æºæ²¡æœ‰äº†ï¼‰ã€æ’é˜Ÿæˆ–ç­‰å¾…ï¼ˆæ¯”å¦‚ç§’æ€ã€è¯„è®ºã€ä¸‹å•ï¼‰ã€é™çº§ï¼ˆè¿”å›å…œåº•æ•°æ®æˆ–é»˜è®¤æ•°æ®ï¼Œå¦‚å•†å“è¯¦æƒ…é¡µåº“å­˜é»˜è®¤æœ‰è´§ï¼‰ã€‚</li>\n</ul>\n<h2>Sentinelæ€ä¹ˆå®ç°é™æµçš„ï¼Ÿ</h2>\n<ul>\n<li>Sentinelé€šè¿‡åŠ¨æ€ç®¡ç†é™æµè§„åˆ™ï¼Œæ ¹æ®å®šä¹‰çš„è§„åˆ™å¯¹è¯·æ±‚è¿›è¡Œé™æµæ§åˆ¶ã€‚å…·ä½“å®ç°æ­¥éª¤å¦‚ä¸‹ï¼š</li>\n<li>å®šä¹‰èµ„æºï¼šåœ¨Sentinelä¸­ï¼Œèµ„æºå¯ä»¥æ˜¯URLã€æ–¹æ³•ç­‰ï¼Œç”¨äºæ ‡è¯†éœ€è¦è¿›è¡Œé™æµçš„è¯·æ±‚ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>// åŸæœ¬çš„ä¸šåŠ¡æ–¹æ³•. \n @SentinelResource(blockHandler = \"blockHandlerForGetUser\") \n public User getUserById(String id) { \n     throw new RuntimeException(\"getUserById command failed\"); \n } \n  \n // blockHandler å‡½æ•°ï¼ŒåŸæ–¹æ³•è°ƒç”¨è¢«é™æµ/é™çº§/ç³»ç»Ÿä¿æŠ¤çš„æ—¶å€™è°ƒç”¨ \n public User blockHandlerForGetUser(String id, BlockException ex) { \n     return new User(\"admin\"); \n }\n</code></pre></div><ul>\n<li>é…ç½®é™æµè§„åˆ™ï¼šåœ¨Sentinelçš„é…ç½®æ–‡ä»¶ä¸­å®šä¹‰èµ„æºçš„é™æµè§„åˆ™ã€‚è§„åˆ™å¯ä»¥åŒ…æ‹¬èµ„æºåç§°ã€é™æµé˜ˆå€¼ã€é™æµæ¨¡å¼ï¼ˆä»¤ç‰Œæ¡¶æˆ–æ¼æ¡¶ï¼‰ç­‰ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static void initFlowQpsRule() { \n     List&lt;FlowRule&gt; rules = new ArrayList&lt;&gt;(); \n     FlowRule rule1 = new FlowRule(); \n     rule1.setResource(resource); \n     // Set max qps to 20 \n     rule1.setCount(20); \n     rule1.setGrade(RuleConstant.FLOW_GRADE_QPS); \n     rule1.setLimitApp(\"default\"); \n     rules.add(rule1); \n     FlowRuleManager.loadRules(rules); \n }\n</code></pre></div><ul>\n<li>ç›‘æ§æµé‡ï¼šSentinelä¼šç›‘æ§æ¯ä¸ªèµ„æºçš„æµé‡æƒ…å†µï¼ŒåŒ…æ‹¬è¯·æ±‚çš„QPSï¼ˆæ¯ç§’è¯·æ±‚æ•°ï¼‰ã€çº¿ç¨‹æ•°ã€å“åº”æ—¶é—´ç­‰ã€‚</li>\n<li>é™æµæ§åˆ¶ï¼šå½“è¯·æ±‚åˆ°è¾¾æ—¶ï¼ŒSentinelä¼šæ ¹æ®èµ„æºçš„é™æµè§„åˆ™åˆ¤æ–­æ˜¯å¦éœ€è¦è¿›è¡Œé™æµæ§åˆ¶ã€‚å¦‚æœè¯·æ±‚è¶…è¿‡äº†é™æµé˜ˆå€¼ï¼Œåˆ™å¯ä»¥è¿›è¡Œé™åˆ¶ã€æ‹’ç»æˆ–è¿›è¡Œå…¶ä»–é™çº§å¤„ç†ã€‚</li>\n</ul>\n<h1>Sentinelé‡‡ç”¨çš„ä»€ä¹ˆé™æµç®—æ³•ï¼Ÿ</h1>\n<ul>\n<li>Sentinelä½¿ç”¨æ»‘åŠ¨çª—å£é™æµç®—æ³•æ¥å®ç°é™æµã€‚æ»‘åŠ¨çª—å£é™æµç®—æ³•æ˜¯ä¸€ç§åŸºäºæ—¶é—´çª—å£çš„é™æµç®—æ³•ã€‚å®ƒå°†ä¸€æ®µæ—¶é—´åˆ’åˆ†ä¸ºå¤šä¸ªæ—¶é—´çª—å£ï¼Œå¹¶åœ¨æ¯ä¸ªæ—¶é—´çª—å£å†…ç»Ÿè®¡è¯·æ±‚çš„æ•°é‡ã€‚é€šè¿‡åŠ¨æ€åœ°è°ƒæ•´æ—¶é—´çª—å£çš„å¤§å°å’Œæ»‘åŠ¨æ­¥é•¿ï¼Œå¯ä»¥æ›´ç²¾ç¡®åœ°æ§åˆ¶è¯·æ±‚çš„é€šè¿‡é€Ÿç‡ã€‚</li>\n</ul>\n<h2>6.7. Sentinelæœ‰å“ªäº›æµç¨‹æ§åˆ¶è§„åˆ™ï¼Ÿâˆš</h2>\n<ul>\n<li>æµé‡æ§åˆ¶ï¼Œå…¶åŸç†æ˜¯ç›‘æ§åº”ç”¨æµé‡çš„QPSæˆ–å¹¶å‘çº¿ç¨‹æ•°ç­‰æŒ‡æ ‡ï¼Œå½“è¾¾åˆ°æŒ‡å®šçš„é˜ˆå€¼æ—¶å¯¹æµé‡è¿›è¡Œæ§åˆ¶ï¼Œä»¥é¿å…è¢«ç¬æ—¶çš„æµé‡é«˜å³°å†²å®ï¼Œä»è€Œä¿éšœåº”ç”¨çš„é«˜å¯ç”¨æ€§</li>\n<li>1.QPS(Queries Per Second)ï¼šå½“è°ƒç”¨ç›¸å…³urlå¯¹åº”çš„èµ„æºæ—¶ï¼ŒQPSè¾¾åˆ°å•æœºé˜ˆå€¼æ—¶ï¼Œå°±ä¼šé™æµã€‚</li>\n<li>2.çº¿ç¨‹æ•°ï¼šå½“è°ƒç”¨ç›¸å…³urlå¯¹åº”çš„èµ„æºæ—¶ï¼Œçº¿ç¨‹æ•°è¾¾åˆ°å•æœºé˜ˆå€¼æ—¶ï¼Œå°±ä¼šé™æµã€‚</li>\n<li>è®¾ç½®é™æµæ¨¡å¼\n<ul>\n<li>ç›´è¿æ¨¡å¼ sentinelé»˜è®¤çš„æµæ§å¤„ç†å°±æ˜¯(ç›´è¿--&gt;å¿«é€Ÿå¤±è´¥);</li>\n<li>å…³è”æ¨¡å¼ å½“å…³è”çš„èµ„æºè¾¾åˆ°é˜ˆå€¼ï¼Œå°±é™æµè‡ªå·±ã€‚</li>\n<li>é“¾è·¯æ¨¡å¼ åªé’ˆå¯¹ä»æŒ‡å®šé“¾è·¯è®¿é—®åˆ°æœ¬èµ„æºçš„è¯·æ±‚åšç»Ÿè®¡ï¼Œåˆ¤æ–­æ˜¯å¦è¶…è¿‡é˜ˆå€¼ã€‚ç›´æ¥æ‹’ç»ç›´æ¥æ‹’ç»ï¼ˆRuleConstant.CONTROL_BEHAVIOR_DEFAULTï¼‰æ–¹å¼æ˜¯é»˜è®¤çš„æµé‡æ§åˆ¶æ–¹å¼ï¼Œå½“QPSè¶…è¿‡ä»»æ„è§„åˆ™çš„é˜ˆå€¼åï¼Œæ–°çš„è¯·æ±‚å°±ä¼šè¢«ç«‹å³æ‹’ç»ï¼Œæ‹’ç»æ–¹å¼ä¸ºæŠ›å‡ºFlowExceptionã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>Sentinelæ€ä¹ˆå®ç°é›†ç¾¤é™æµï¼Ÿ</h1>\n<p>Sentinelåˆ©ç”¨äº†Token Serverå’ŒToken Clientçš„æœºåˆ¶æ¥å®ç°é›†ç¾¤é™æµã€‚å¼€å¯é›†ç¾¤é™æµåï¼ŒClientå‘Token Serverå‘é€è¯·æ±‚ï¼ŒToken Serveræ ¹æ®é…ç½®çš„è§„åˆ™å†³å®šæ˜¯å¦é™æµã€‚</p>\n<h1>10. ç½‘å…³æœåŠ¡</h1>\n<ul>\n<li>spring-cloud-netflix-zuulï¼ŒåŸºäºZuul1å®ç°ã€‚Netflixæœ€æ–°å¼€æºçš„ç½‘å…³æœåŠ¡æ˜¯Zuul2 ï¼ŒåŸºäºå“åº”å¼çš„ç½‘å…³æœåŠ¡ã€‚</li>\n<li>spring-cloud-gateway ï¼ŒåŸºäºSpring Webfluxå®ç°</li>\n</ul>\n<h2>10.1. ä¸ºä»€ä¹ˆè¦æœ‰ç½‘å…³ï¼Ÿ</h2>\n<ul>\n<li>\n<p>åŠ¨æ€è·¯ç”±ï¼šåå‘ä»£ç†</p>\n</li>\n<li>\n<p>å®‰å…¨æ§åˆ¶ï¼šç»Ÿä¸€è®¤è¯ï¼ˆæ”¯æŒ HMAC, JWT, Basic, OAuth 2.0ç­‰å¸¸ç”¨åè®®ï¼‰å’Œé‰´æƒï¼ˆæƒé™æ§åˆ¶ã€IP é»‘ç™½åå•ï¼‰</p>\n</li>\n<li>\n<p>åè®®è½¬æ¢</p>\n</li>\n<li>\n<p>ç†”æ–­ã€é™æµ</p>\n</li>\n<li>\n<p>ç°åº¦å‘å¸ƒ</p>\n</li>\n<li>\n<p>apiç»„åˆï¼šå¯ä»¥è°ƒç”¨ä¸€æ¬¡ç½‘å…³å®ç°è°ƒç”¨ä¸¤æ¬¡å¾®æœåŠ¡çš„åŠŸèƒ½</p>\n</li>\n<li>\n<p>è¯·æ±‚åˆ†æï¼Œè®°å½•æ—¥å¿—</p>\n</li>\n<li>\n<p>ç¼“å­˜</p>\n</li>\n<li>\n<p>å¥åº·æ£€æŸ¥</p>\n</li>\n<li>\n<p>å¯ç”¨æ€§</p>\n</li>\n<li>\n<p>é«˜æ€§èƒ½</p>\n</li>\n<li>\n<p>APIç‰ˆæœ¬ç®¡ç†</p>\n</li>\n</ul>\n<h2>10.2. zuulåŸç†ï¼Ÿ</h2>\n<ul>\n<li>ä½œç”¨ï¼šAPI ç½‘å…³ï¼Œè·¯ç”±ï¼Œè´Ÿè½½å‡è¡¡ç­‰å¤šç§ä½œç”¨ã€‚</li>\n<li>ç®€ä»‹ï¼šç±»ä¼¼Nginxåå‘ä»£ç†çš„åŠŸèƒ½</li>\n<li>åœ¨å¾®æœåŠ¡æ¶æ„ä¸­ï¼Œåç«¯æœåŠ¡å¾€å¾€ä¸ç›´æ¥å¼€æ”¾ç»™è°ƒç”¨ç«¯ï¼Œè€Œæ˜¯é€šè¿‡ä¸€ä¸ª APIç½‘å…³æ ¹æ®è¯·æ±‚çš„ url ï¼Œè·¯ç”±åˆ°ç›¸åº”çš„æœåŠ¡ã€‚å½“æ·»åŠ APIç½‘å…³åï¼Œåœ¨ç¬¬ä¸‰æ–¹è°ƒç”¨ç«¯å’ŒæœåŠ¡æä¾›æ–¹ä¹‹é—´å°±åˆ›å»ºäº†ä¸€é¢å¢™ï¼Œè¿™é¢å¢™ç›´æ¥ä¸è°ƒç”¨æ–¹é€šä¿¡è¿›è¡Œæƒé™æ§åˆ¶ï¼Œåå°†è¯·æ±‚å‡è¡¡åˆ†å‘ç»™åå°æœåŠ¡ç«¯ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c5e5a6603d8d79d4509d3.jpg\" alt=\"zuulprinciple.png\"></li>\n</ul>\n<h2>10.3. Spring Cloud Gateway</h2>\n<ul>\n<li>Routeï¼ˆè·¯ç”±ï¼‰ï¼šè·¯ç”±æ˜¯Spring Cloud Gatewayçš„åŸºæœ¬æ„å»ºå—ï¼Œå®ƒå®šä¹‰äº†è¯·æ±‚çš„åŒ¹é…è§„åˆ™å’Œè½¬å‘ç›®æ ‡ã€‚é€šè¿‡é…ç½®è·¯ç”±ï¼Œå¯ä»¥å°†è¯·æ±‚æ˜ å°„åˆ°åç«¯çš„æœåŠ¡å®ä¾‹æˆ–URLä¸Šã€‚è·¯ç”±è§„åˆ™å¯ä»¥æ ¹æ®è¯·æ±‚çš„è·¯å¾„ã€æ–¹æ³•ã€è¯·æ±‚å¤´ç­‰æ¡ä»¶è¿›è¡ŒåŒ¹é…ï¼Œå¹¶æŒ‡å®šè½¬å‘çš„ç›®æ ‡URIã€‚</li>\n<li>Predicateï¼ˆæ–­è¨€ï¼‰ï¼šæ–­è¨€ç”¨äºåŒ¹é…è¯·æ±‚çš„æ¡ä»¶ï¼Œå¦‚æœè¯·æ±‚æ»¡è¶³æ–­è¨€çš„æ¡ä»¶ï¼Œåˆ™ä¼šåº”ç”¨æ‰€é…ç½®çš„è¿‡æ»¤å™¨ã€‚Spring Cloud Gatewayæä¾›äº†å¤šç§å†…ç½®çš„æ–­è¨€ï¼Œå¦‚Pathï¼ˆè·¯å¾„åŒ¹é…ï¼‰ã€Methodï¼ˆè¯·æ±‚æ–¹æ³•åŒ¹é…ï¼‰ã€Headerï¼ˆè¯·æ±‚å¤´åŒ¹é…ï¼‰ç­‰ï¼ŒåŒæ—¶ä¹Ÿæ”¯æŒè‡ªå®šä¹‰æ–­è¨€ã€‚</li>\n<li>Filterï¼ˆè¿‡æ»¤å™¨ï¼‰ï¼šè¿‡æ»¤å™¨ç”¨äºå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†å’Œè½¬æ¢ï¼Œå¯ä»¥ä¿®æ”¹è¯·æ±‚ã€å“åº”ä»¥åŠæ‰§è¡Œå…¶ä»–è‡ªå®šä¹‰é€»è¾‘ã€‚Spring Cloud Gatewayæä¾›äº†å¤šä¸ªå†…ç½®çš„è¿‡æ»¤å™¨ï¼Œå¦‚è¯·æ±‚è½¬å‘ã€è¯·æ±‚é‡è¯•ã€è¯·æ±‚é™æµç­‰ã€‚åŒæ—¶ä¹Ÿæ”¯æŒè‡ªå®šä¹‰è¿‡æ»¤å™¨ï¼Œå¯ä»¥æ ¹æ®éœ€æ±‚ç¼–å†™è‡ªå·±çš„è¿‡æ»¤å™¨é€»è¾‘ã€‚</li>\n</ul>\n<h2>Spring Cloud Gatewayçš„å…·ä½“å·¥ä½œæµç¨‹</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/eff7e956169c3396d6691.png\" alt=\"springcloudgateway.png\" tabindex=\"0\"><figcaption>springcloudgateway.png</figcaption></figure>\n<ul>\n<li>Gateway Handlerï¼ˆç½‘å…³å¤„ç†å™¨ï¼‰ï¼šç½‘å…³å¤„ç†å™¨æ˜¯Spring Cloud Gatewayçš„æ ¸å¿ƒç»„ä»¶ï¼Œè´Ÿè´£å°†è¯·æ±‚è½¬å‘åˆ°åŒ¹é…çš„è·¯ç”±ä¸Šã€‚å®ƒæ ¹æ®è·¯ç”±é…ç½®å’Œæ–­è¨€æ¡ä»¶è¿›è¡Œè·¯ç”±åŒ¹é…ï¼Œé€‰æ‹©åˆé€‚çš„è·¯ç”±è¿›è¡Œè¯·æ±‚è½¬å‘ã€‚ç½‘å…³å¤„ç†å™¨è¿˜ä¼šä¾æ¬¡åº”ç”¨é…ç½®çš„è¿‡æ»¤å™¨é“¾ï¼Œå¯¹è¯·æ±‚è¿›è¡Œå¤„ç†å’Œè½¬æ¢ã€‚</li>\n<li>Gateway Filter Chainï¼ˆç½‘å…³è¿‡æ»¤å™¨é“¾ï¼‰ï¼šç½‘å…³è¿‡æ»¤å™¨é“¾ç”±ä¸€ç³»åˆ—è¿‡æ»¤å™¨ç»„æˆï¼ŒæŒ‰ç…§é…ç½®çš„é¡ºåºä¾æ¬¡æ‰§è¡Œã€‚æ¯ä¸ªè¿‡æ»¤å™¨å¯ä»¥åœ¨è¯·æ±‚å‰ã€è¯·æ±‚åæˆ–è¯·æ±‚å‘ç”Ÿé”™è¯¯æ—¶è¿›è¡Œå¤„ç†ã€‚è¿‡æ»¤å™¨é“¾çš„æ‰§è¡Œè¿‡ç¨‹å¯ä»¥ä¿®æ”¹è¯·æ±‚ã€å“åº”ä»¥åŠæ‰§è¡Œå…¶ä»–è‡ªå®šä¹‰é€»è¾‘ã€‚</li>\n</ul>\n<h1>11. é…ç½®ä¸­å¿ƒ</h1>\n<ul>\n<li>spring-cloud-configåŸºäºGitã€SVNä½œä¸ºå­˜å‚¨ã€‚</li>\n<li>spring-cloud-alibaba-nacos-configåŸºäºNacoså®ç°ã€‚</li>\n<li>Apolloæºç¨‹å¼€æºçš„é…ç½®ä¸­å¿ƒã€‚Spring Cloudæœ€æˆç†Ÿçš„é…ç½®ä¸­å¿ƒçš„é€‰æ‹©ã€‚</li>\n</ul>\n<h2>11.1. Spring Cloud Config</h2>\n<ul>\n<li>ä½œç”¨ï¼šé…ç½®ç®¡ç†</li>\n<li>ç®€ä»‹ï¼šSpring Cloud Config æä¾›æœåŠ¡å™¨ç«¯å’Œå®¢æˆ·ç«¯ã€‚æœåŠ¡å™¨å­˜å‚¨åç«¯çš„é»˜è®¤å®ç°ä½¿ç”¨ Git ï¼Œå› æ­¤å®ƒè½»æ¾æ”¯æŒæ ‡ç­¾ç‰ˆæœ¬çš„é…ç½®ç¯å¢ƒï¼Œä»¥åŠå¯ä»¥è®¿é—®ç”¨äºç®¡ç†å†…å®¹çš„å„ç§å·¥å…·ã€‚</li>\n<li>è¿™ä¸ªè¿˜æ˜¯é™æ€çš„ï¼Œå¾—é…åˆ Spring Cloud Bus å®ç°åŠ¨æ€çš„é…ç½®æ›´æ–°ã€‚</li>\n</ul>\n<h2>Apollo</h2>\n<h1>12. é“¾è·¯è¿½è¸ª</h1>\n<ul>\n<li>skywalkingå·²ç»è¿›å…¥Apacheç›‘æ§é“¾è·¯å’ŒJVMç­‰</li>\n<li>spring-cloud-sleuthåŸºäºZipkinå®ç°</li>\n</ul>\n<h2>ä¸ºä»€ä¹ˆè¦é“¾è·¯è¿½è¸ª</h2>\n<ul>\n<li>é“¾è·¯è¿½è¸ªï¼Œå¯ä»¥å¯è§†åŒ–åœ°è¿½è¸ªè¯·æ±‚ä»ä¸€ä¸ªå¾®æœåŠ¡åˆ°å¦ä¸€ä¸ªå¾®æœåŠ¡çš„è°ƒç”¨æƒ…å†µã€‚é™¤äº†æ’æŸ¥é—®é¢˜ï¼Œé“¾è·¯è¿½è¸ªé»‘è¿˜å¯ä»¥å¸®åŠ©ä¼˜åŒ–æ€§èƒ½ï¼Œå¯è§†åŒ–ä¾èµ–å…³ç³»ã€æœåŠ¡ç›‘æ§å’Œå‘Šè­¦</li>\n</ul>\n<h2>SkyWalking</h2>\n<h2>12.1. Spring Cloud SleuthåŸç†</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/bc82ce3be04420eac161e.jpg\" alt=\"sleuthprinciple.png\" tabindex=\"0\"><figcaption>sleuthprinciple.png</figcaption></figure>\n<h1>13. springcloudæ•´åˆå›¾</h1>\n<ul>\n<li>Eureka + Ribbon + Feign + Hystrix + Zuul<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b39958ef6196ab3a7d5c3.jpg\" alt=\"springcloud.png\"></li>\n</ul>\n<h1>å¦‚ä½•å®ç°ç°åº¦å‘å¸ƒï¼Ÿ</h1>\n<ul>\n<li>ç°åº¦å‘å¸ƒï¼ˆGray Releaseï¼Œä¹Ÿç§°ä¸ºé‡‘ä¸é›€å‘å¸ƒï¼‰æ˜¯æŒ‡åœ¨è½¯ä»¶æˆ–æœåŠ¡å‘å¸ƒè¿‡ç¨‹ä¸­ï¼Œå°†æ–°ç‰ˆæœ¬çš„åŠŸèƒ½æˆ–æœåŠ¡ä»¥è¾ƒå°çš„æ¯”ä¾‹å¼•å…¥åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä»…å‘éƒ¨åˆ†ç”¨æˆ·æˆ–èŠ‚ç‚¹æä¾›æ–°åŠŸèƒ½çš„ä¸€ç§å‘å¸ƒç­–ç•¥ã€‚</li>\n</ul>\n<h2>ä¸ºä»€ä¹ˆè¦ä½¿ç”¨ç°åº¦å‘å¸ƒï¼Ÿ</h2>\n<ul>\n<li>åœ¨ä¼ ç»Ÿçš„å…¨é‡å‘å¸ƒä¸­ï¼Œæ–°ç‰ˆæœ¬çš„åŠŸèƒ½ä¼šä¸€æ¬¡æ€§å…¨éƒ¨éƒ¨ç½²åˆ°æ‰€æœ‰çš„ç”¨æˆ·æˆ–èŠ‚ç‚¹ä¸Šã€‚å¦‚æœæ–°ç‰ˆæœ¬å­˜åœ¨ç¼ºé™·æˆ–é—®é¢˜ï¼Œå¯èƒ½ä¼šå¯¹æ‰€æœ‰ç”¨æˆ·æˆ–èŠ‚ç‚¹äº§ç”Ÿä¸¥é‡çš„å½±å“ï¼Œå¯¼è‡´ç³»ç»Ÿå´©æºƒæˆ–æœåŠ¡ä¸å¯ç”¨ã€‚ç°åº¦å‘å¸ƒé‡‡ç”¨è¾ƒå°çš„è§„æ¨¡ï¼Œå¹¶é€æ­¥å°†æ–°ç‰ˆæœ¬çš„åŠŸèƒ½å¼•å…¥åˆ°ç”Ÿäº§ç¯å¢ƒä¸­ï¼Œä»…å‘ä¸€å°éƒ¨åˆ†ç”¨æˆ·æˆ–èŠ‚ç‚¹æä¾›æ–°åŠŸèƒ½ã€‚é€šè¿‡æŒç»­ç›‘æµ‹å’Œè¯„ä¼°ï¼Œå¯ä»¥åœ¨å‘ç°é—®é¢˜æ—¶åŠæ—¶å›æ»šæˆ–ä¿®å¤ã€‚è¿™ç§é€æ­¥å¼•å…¥æ–°ç‰ˆæœ¬çš„æ–¹å¼å¯ä»¥é™ä½é£é™©ï¼Œå¹¶æé«˜ç³»ç»Ÿçš„ç¨³å®šæ€§å’Œå¯é æ€§ã€‚</li>\n</ul>\n<h2>ç°åº¦å®ç°æ–¹æ³•ï¼Ÿ</h2>\n<ul>\n<li>æ ¹æ®ç”¨æˆ·åˆ’åˆ†ï¼šæ ¹æ®ç”¨æˆ·æ ‡è¯†æˆ–ç”¨æˆ·ç»„è¿›è¡Œåˆ’åˆ†ï¼Œåœ¨æ•´ä¸ªç”¨æˆ·ç¾¤ä½“ä¸­åªé€‰æ‹©ä¸€å°éƒ¨åˆ†ç”¨æˆ·è·å¾—æ–°åŠŸèƒ½ã€‚ï¼ˆå¸¸ç”¨ï¼‰</li>\n<li>æ ¹æ®åœ°åŸŸåˆ’åˆ†ï¼šåœ¨ä¸åŒåœ°åŒºæˆ–ä¸åŒèŠ‚ç‚¹ä¸Šè¿›è¡Œåˆ’åˆ†ï¼Œåœ¨å…¶ä¸­çš„ä¸€å°éƒ¨åˆ†åœ°åŒºæˆ–èŠ‚ç‚¹è¿›è¡Œæ–°åŠŸèƒ½çš„å‘å¸ƒã€‚</li>\n<li>æ ¹æ®æµé‡åˆ’åˆ†ï¼šæ ¹æ®æµé‡çš„ç™¾åˆ†æ¯”æˆ–è¯·æ±‚æ¬¡æ•°è¿›è¡Œåˆ’åˆ†ï¼Œåªå°†ä¸€éƒ¨åˆ†è¯·æ±‚æµé‡å¼•å¯¼åˆ°æ–°åŠŸèƒ½ä¸Šã€‚</li>\n</ul>\n<h2>Spring Cloud å…¨é“¾è·¯ç°è‰²å‘å¸ƒå…·ä½“å®ç°</h2>\n<ul>\n<li>å‰ç«¯ç¨‹åºåœ¨ç°åº¦æµ‹è¯•çš„ç”¨æˆ· Header å¤´ä¸­æ‰“ä¸Šæ ‡ç­¾ï¼Œä¾‹å¦‚åœ¨ Header ä¸­æ·»åŠ â€œgrap-tag: trueâ€ï¼Œå…¶è¡¨ç¤ºè¦è¿›è¡Œç°å¸¸æµ‹è¯•ï¼ˆè®¿é—®ç°åº¦æœåŠ¡ï¼‰ï¼Œè€Œå…¶ä»–åˆ™ä¸ºè®¿é—®æ­£å¼æœåŠ¡ã€‚</li>\n<li>åœ¨è´Ÿè½½å‡è¡¡å™¨ Spring Cloud LoadBalancer ä¸­ï¼Œæ‹¿åˆ° Header ä¸­çš„â€œgrap-tagâ€è¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ­¤æ ‡ç­¾ä¸ä¸ºç©ºï¼Œå¹¶ç­‰äºâ€œtrueâ€çš„è¯ï¼Œè¡¨ç¤ºè¦è®¿é—®ç°åº¦å‘å¸ƒçš„æœåŠ¡ï¼Œå¦åˆ™åªè®¿é—®æ­£å¼çš„æœåŠ¡ã€‚</li>\n<li>åœ¨ç½‘å…³ Spring Cloud Gateway ä¸­ï¼Œå°† Header æ ‡ç­¾â€œgrap-tag: trueâ€ç»§ç»­å¾€ä¸‹ä¸€ä¸ªè°ƒç”¨æœåŠ¡ä¸­ä¼ é€’ã€‚</li>\n<li>åœ¨åç»­çš„è°ƒç”¨æœåŠ¡ä¸­ï¼Œéœ€è¦å®ç°ä»¥ä¸‹ä¸¤ä¸ªå…³é”®åŠŸèƒ½ï¼š\n<ul>\n<li>åœ¨è´Ÿè½½å‡è¡¡å™¨ Spring Cloud LoadBalancer ä¸­ï¼Œåˆ¤æ–­ç°åº¦å‘å¸ƒæ ‡ç­¾ï¼Œå°†è¯·æ±‚åˆ†å‘åˆ°å¯¹åº”æœåŠ¡ã€‚</li>\n<li>å°†ç°åº¦å‘å¸ƒæ ‡ç­¾ï¼ˆå¦‚æœå­˜åœ¨ï¼‰ï¼Œç»§ç»­ä¼ é€’ç»™ä¸‹ä¸€ä¸ªè°ƒç”¨çš„æœåŠ¡ã€‚</li>\n</ul>\n</li>\n<li>ç»è¿‡ç¬¬å››æ­¥çš„åå¤ä¼ é€’ä¹‹åï¼Œæ•´ä¸ª Spring Cloud å…¨é“¾è·¯çš„ç°åº¦å‘å¸ƒå°±å®Œæˆäº†ã€‚</li>\n<li>å…³é”®æ€è·¯\n<ul>\n<li>1ã€æ³¨å†Œä¸­å¿ƒåŒºåˆ†æ­£å¸¸æœåŠ¡å’Œç°åº¦æœåŠ¡ï¼›</li>\n<li>2ã€è´Ÿè½½å‡è¡¡æ­£ç¡®è½¬å‘æ­£å¸¸æœåŠ¡å’Œç°åº¦æœåŠ¡ï¼›</li>\n<li>3ã€ç½‘å…³å’Œ HTTP å·¥å…·ä¼ é€’ç°åº¦æ ‡ç­¾ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>æ ¸å¿ƒå®ç°æ€è·¯å’Œä»£ç </h2>\n<h3>3.1 åŒºåˆ†æ­£å¼æœåŠ¡å’Œç°åº¦æœåŠ¡</h3>\n<ul>\n<li>åœ¨ç°åº¦æœåŠ¡æ—¢æ³¨å†Œä¸­å¿ƒçš„MetaDataï¼ˆå…ƒæ•°æ®ï¼‰ä¸­æ ‡è¯†ä¸ºç°åº¦æœåŠ¡ï¼Œè€Œå…ƒæ•°æ®ä¸­æ²¡æœ‰æ ‡è¯†ï¼ˆç°åº¦æœåŠ¡ï¼‰çš„åˆ™ä¸ºæ­£å¼æœåŠ¡ï¼Œä»¥Nacosä¸ºä¾‹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>spring:\n  application:\n    name: canary-user-service\n  cloud:\n    nacos:\n      discovery:\n        username: nacos\n        password: nacos\n        server-addr: localhost:8848\n        namespace: public\n        register-enabled: true \n        metadata: { \"grap-tag\":\"true\" } # æ ‡è¯†è‡ªå·±ä¸ºç°åº¦æœåŠ¡\n</code></pre></div><h3>3.2 è´Ÿè½½å‡è¡¡è°ƒç”¨ç°åº¦æœåŠ¡</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>// Spring Cloud LoadBalancer åˆ¤æ–­å¹¶è°ƒç”¨ç°åº¦æœåŠ¡ï¼š\n//è‡ªå®šä¹‰è´Ÿè½½å‡è¡¡å™¨ï¼Œå¹¶ä½¿ç”¨äº†è½®è¯¢ç®—æ³•ã€‚å¦‚æœ Header ä¸­æœ‰ç°åº¦æ ‡ç­¾ï¼Œåˆ™åªæŸ¥è¯¢ç°åº¦æœåŠ¡çš„èŠ‚ç‚¹å®ä¾‹ï¼Œå¦åˆ™åˆ™æŸ¥è¯¢å‡ºæ‰€æœ‰çš„æ­£å¼èŠ‚ç‚¹å®ä¾‹ï¼ˆä»¥ä¾›æœåŠ¡è°ƒç”¨æˆ–æœåŠ¡è½¬å‘ï¼‰\nprivate Response&lt;ServiceInstance&gt; getInstanceResponse(List&lt;ServiceInstance&gt; instances,Request request) {\n    // å®ä¾‹ä¸ºç©º\n    if (instances.isEmpty()) {\n        if (log.isWarnEnabled()) {\n            log.warn(\"No servers available for service: \" + this.serviceId);\n        }\n        return new EmptyResponse();\n    } else { // æœåŠ¡ä¸ä¸ºç©º\n        RequestDataContext dataContext = (RequestDataContext) request.getContext();\n        HttpHeaders headers = dataContext.getClientRequest().getHeaders();\n        // åˆ¤æ–­æ˜¯å¦ä¸ºç°åº¦å‘å¸ƒï¼ˆè¯·æ±‚ï¼‰\n        if (headers.get(GlobalVariables.GRAY_KEY) != null &amp;&amp;\n                headers.get(GlobalVariables.GRAY_KEY).get(0).equals(\"true\")) {\n            // ç°åº¦å‘å¸ƒè¯·æ±‚ï¼Œå¾—åˆ°æ–°æœåŠ¡å®ä¾‹åˆ—è¡¨\n            List&lt;ServiceInstance&gt; findInstances = instances.stream().\n                    filter(s -&gt; s.getMetadata().get(GlobalVariables.GRAY_KEY) != null &amp;&amp;\n                            s.getMetadata().get(GlobalVariables.GRAY_KEY).equals(\"true\"))\n                    .toList();\n            if (findInstances.size() &gt; 0) { // å­˜åœ¨ç°åº¦å‘å¸ƒèŠ‚ç‚¹\n                instances = findInstances;\n            }\n        } else { // æŸ¥è¯¢éç°åº¦å‘å¸ƒèŠ‚ç‚¹\n            // ç°åº¦å‘å¸ƒæµ‹è¯•è¯·æ±‚ï¼Œå¾—åˆ°æ–°æœåŠ¡å®ä¾‹åˆ—è¡¨\n            instances = instances.stream().\n                    filter(s -&gt; s.getMetadata().get(GlobalVariables.GRAY_KEY) == null ||\n                            !s.getMetadata().get(GlobalVariables.GRAY_KEY).equals(\"true\"))\n                    .toList();\n        }\n        // éšæœºæ­£æ•°å€¼ ++iï¼ˆ &amp; å»è´Ÿæ•°ï¼‰\n        int pos = this.position.incrementAndGet() &amp; Integer.MAX_VALUE;\n        // ++i æ•°å€¼ % å®ä¾‹æ•° å–æ¨¡ -&gt; è½®è¯¢ç®—æ³•\n        int index = pos % instances.size();\n        // å¾—åˆ°æœåŠ¡å®ä¾‹æ–¹æ³•\n        ServiceInstance instance = (ServiceInstance) instances.get(index);\n        return new DefaultResponse(instance);\n    }\n}\n</code></pre></div><h3>3.3 ç½‘å…³ä¼ é€’ç°åº¦æ ‡è¯†</h3>\n<ul>\n<li>è¦åœ¨ç½‘å…³ Spring Cloud Gateway ä¸­ä¼ é€’ç°åº¦æ ‡è¯†ï¼Œåªéœ€è¦åœ¨ Gateway çš„å…¨å±€è‡ªå®šä¹‰è¿‡æ»¤å™¨ä¸­è®¾ç½® Response çš„ Header å³å¯ï¼Œå…·ä½“å®ç°ä»£ç å¦‚ä¸‹ï¼špackage com.example.gateway.config;</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>import com.loadbalancer.canary.common.GlobalVariables;\nimport org.springframework.cloud.gateway.filter.GatewayFilterChain;\nimport org.springframework.cloud.gateway.filter.GlobalFilter;\nimport org.springframework.core.Ordered;\nimport org.springframework.http.HttpStatus;\nimport org.springframework.http.server.reactive.ServerHttpRequest;\nimport org.springframework.http.server.reactive.ServerHttpResponse;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.server.ServerWebExchange;\nimport reactor.core.publisher.Mono;\n\n@Component\npublic class LoadBalancerFilter implements GlobalFilter {\n    @Override\n    public Mono&lt;Void&gt; filter(ServerWebExchange exchange, GatewayFilterChain chain) {\n        // å¾—åˆ° requestã€response å¯¹è±¡\n        ServerHttpRequest request = exchange.getRequest();\n        ServerHttpResponse response = exchange.getResponse();\n        if (request.getQueryParams().getFirst(GlobalVariables.GRAY_KEY) != null) {\n            // è®¾ç½®é‡‘ä¸é›€æ ‡è¯†\n            response.getHeaders().set(GlobalVariables.GRAY_KEY,\n                    \"true\");\n        }\n        // æ­¤æ­¥éª¤æ­£å¸¸ï¼Œæ‰§è¡Œä¸‹ä¸€æ­¥\n        return chain.filter(exchange);\n    }\n}\n</code></pre></div><h1>3.4 Openfeign ä¼ é€’ç°åº¦æ ‡ç­¾HTTP</h1>\n<ul>\n<li>è°ƒç”¨å·¥å…· Openfeign ä¼ é€’ç°åº¦æ ‡ç­¾çš„å®ç°ä»£ç å¦‚ä¸‹ï¼š</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>import feign.RequestInterceptor;\nimport feign.RequestTemplate;\nimport jakarta.servlet.http.HttpServletRequest;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.context.request.RequestContextHolder;\nimport org.springframework.web.context.request.ServletRequestAttributes;\n\nimport java.util.Enumeration;\nimport java.util.LinkedHashMap;\nimport java.util.Map;\n\n@Component\npublic class FeignRequestInterceptor implements RequestInterceptor {\n    @Override\n    public void apply(RequestTemplate template) {\n        // ä» RequestContextHolder ä¸­è·å– HttpServletRequest\n        ServletRequestAttributes attributes = (ServletRequestAttributes)\n                RequestContextHolder.getRequestAttributes();\n        // è·å– RequestContextHolder ä¸­çš„ä¿¡æ¯\n        Map&lt;String, String&gt; headers = getHeaders(attributes.getRequest());\n        // æ”¾å…¥ openfeign çš„ RequestTemplate ä¸­\n        for (Map.Entry&lt;String, String&gt; entry : headers.entrySet()) {\n            template.header(entry.getKey(), entry.getValue());\n        }\n    }\n\n    /**\n     * è·å–åŸè¯·æ±‚å¤´\n     */\n    private Map&lt;String, String&gt; getHeaders(HttpServletRequest request) {\n        Map&lt;String, String&gt; map = new LinkedHashMap&lt;&gt;();\n        Enumeration&lt;String&gt; enumeration = request.getHeaderNames();\n        if (enumeration != null) {\n            while (enumeration.hasMoreElements()) {\n                String key = enumeration.nextElement();\n                String value = request.getHeader(key);\n                map.put(key, value);\n            }\n        }\n        return map;\n    }\n}\n</code></pre></div><h1>Seataæ”¯æŒå“ªäº›æ¨¡å¼çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼Ÿ</h1>\n<ul>\n<li>Seataä»¥ä¸‹å‡ ç§æ¨¡å¼çš„åˆ†å¸ƒå¼äº‹åŠ¡ï¼š\n<ul>\n<li>ATï¼ˆAtomikosï¼‰æ¨¡å¼ï¼šSeataé»˜è®¤æ”¯æŒçš„æ¨¡å¼ï¼Œæœ€å¸¸ç”¨çš„ã€‚åœ¨ATæ¨¡å¼ä¸‹ï¼ŒSeataé€šè¿‡åœ¨ä¸šåŠ¡ä»£ç ä¸­åµŒå…¥äº‹åŠ¡ä¸Šä¸‹æ–‡ï¼Œå®ç°å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„ç®¡ç†ã€‚Seataä¼šæ‹¦æˆªå¹¶è§£æä¸šåŠ¡ä»£ç ä¸­çš„SQLè¯­å¥ï¼Œé€šè¿‡å¯¹æ•°æ®åº“è¿æ¥è¿›è¡Œæ‹¦æˆªå’Œä»£ç†ï¼Œå®ç°äº‹åŠ¡çš„ç®¡ç†å’Œåè°ƒã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e0a2b3f17439791ef0e97.png\" alt=\"seataat1.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f1c2597a611a4bcf6a468.png\" alt=\"seataat2.png\"></li>\n<li>TCCï¼ˆTry-Confirm-Cancelï¼‰æ¨¡å¼ï¼šTCCæ¨¡å¼æ˜¯ä¸€ç§åŸºäºè¡¥å¿æœºåˆ¶çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼ã€‚åœ¨TCCæ¨¡å¼ä¸­ï¼Œä¸šåŠ¡é€»è¾‘éœ€è¦å®ç°Tryã€Confirmå’ŒCancelä¸‰ä¸ªé˜¶æ®µçš„æ“ä½œã€‚Seataé€šè¿‡è°ƒç”¨ä¸šåŠ¡ä»£ç ä¸­çš„Tryã€Confirmå’ŒCancelæ–¹æ³•ï¼Œå¹¶åœ¨æ¯ä¸ªé˜¶æ®µè®°å½•ç›¸å…³çš„æ“ä½œæ—¥å¿—ï¼Œæ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e3a492135cfb1b9a68369.png\" alt=\"seatatcc.png\"></li>\n<li>SAGAæ¨¡å¼ï¼šSAGAæ¨¡å¼æ˜¯ä¸€ç§åŸºäºäº‹ä»¶é©±åŠ¨çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼ã€‚åœ¨SAGAæ¨¡å¼ä¸­ï¼Œæ¯ä¸ªæœåŠ¡éƒ½å¯ä»¥å‘å¸ƒå’Œè®¢é˜…äº‹ä»¶ï¼Œé€šè¿‡äº‹ä»¶çš„ä¼ é€’å’Œå¤„ç†æ¥å®ç°åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸€è‡´æ€§ã€‚Seataæä¾›äº†ä¸SAGAæ¨¡å¼å…¼å®¹çš„Sagaæ¡†æ¶ï¼Œç”¨äºç®¡ç†å’Œåè°ƒåˆ†å¸ƒå¼äº‹åŠ¡çš„å„ä¸ªé˜¶æ®µã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/264d940d050468301c1fa.png\" alt=\"seatasaga.png\"></li>\n<li>XAæ¨¡å¼ï¼šXAæ¨¡å¼æ˜¯ä¸€ç§åŸºäºä¸¤é˜¶æ®µæäº¤ï¼ˆTwo-Phase Commitï¼‰åè®®çš„åˆ†å¸ƒå¼äº‹åŠ¡æ¨¡å¼ã€‚åœ¨XAæ¨¡å¼ä¸­ï¼ŒSeataé€šè¿‡ä¸æ•°æ®åº“çš„XAäº‹åŠ¡åè®®è¿›è¡Œäº¤äº’ï¼Œå®ç°å¯¹åˆ†å¸ƒå¼äº‹åŠ¡çš„ç®¡ç†å’Œåè°ƒã€‚XAæ¨¡å¼éœ€è¦æ•°æ®åº“æœ¬èº«æ”¯æŒXAäº‹åŠ¡ï¼Œå¹¶ä¸”éœ€è¦åœ¨åº”ç”¨ç¨‹åºä¸­é…ç½®ç›¸åº”çš„XAæ•°æ®æºã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/dbae39b1c21075990c42e.png\" alt=\"seataxa.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>äº†è§£Seataçš„å®ç°åŸç†å—ï¼Ÿ</h1>\n<ul>\n<li>Seataçš„å®ç°åŸç†ä¸»è¦åŒ…æ‹¬ä¸‰ä¸ªæ ¸å¿ƒç»„ä»¶ï¼šäº‹åŠ¡åè°ƒå™¨ï¼ˆTransaction Coordinatorï¼‰ã€äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransaction Managerï¼‰å’Œèµ„æºç®¡ç†å™¨ï¼ˆResource Managerï¼‰ã€‚\n<ul>\n<li>äº‹åŠ¡åè°ƒå™¨ï¼ˆTransaction Coordinatorï¼‰ï¼šäº‹åŠ¡åè°ƒå™¨è´Ÿè´£åè°ƒå’Œç®¡ç†åˆ†å¸ƒå¼äº‹åŠ¡çš„æ•´ä¸ªè¿‡ç¨‹ã€‚å®ƒæ¥æ”¶äº‹åŠ¡çš„å¼€å§‹å’Œç»“æŸè¯·æ±‚ï¼Œå¹¶æ ¹æ®äº‹åŠ¡çš„çŠ¶æ€è¿›è¡Œåè°ƒå’Œå¤„ç†ã€‚äº‹åŠ¡åè°ƒå™¨è¿˜è´Ÿè´£è®°å½•å’Œç®¡ç†äº‹åŠ¡çš„å…¨å±€äº‹åŠ¡ IDï¼ˆGlobal Transaction IDï¼‰å’Œåˆ†æ”¯äº‹åŠ¡ IDï¼ˆBranch Transaction IDï¼‰ã€‚</li>\n<li>äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTransaction Managerï¼‰ï¼šäº‹åŠ¡ç®¡ç†å™¨è´Ÿè´£å…¨å±€äº‹åŠ¡çš„ç®¡ç†å’Œæ§åˆ¶ã€‚å®ƒåè°ƒå„ä¸ªåˆ†æ”¯äº‹åŠ¡çš„æäº¤æˆ–å›æ»šï¼Œå¹¶ä¿è¯åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚äº‹åŠ¡ç®¡ç†å™¨è¿˜è´Ÿè´£ä¸äº‹åŠ¡åè°ƒå™¨è¿›è¡Œé€šä¿¡ï¼Œå¹¶å°†äº‹åŠ¡çš„çŠ¶æ€å˜æ›´è¿›è¡ŒæŒä¹…åŒ–ã€‚</li>\n<li>èµ„æºç®¡ç†å™¨ï¼ˆResource Managerï¼‰ï¼šèµ„æºç®¡ç†å™¨è´Ÿè´£ç®¡ç†å’Œæ§åˆ¶å„ä¸ªå‚ä¸è€…ï¼ˆParticipantï¼‰çš„äº‹åŠ¡æ“ä½œã€‚å®ƒä¸äº‹åŠ¡ç®¡ç†å™¨è¿›è¡Œé€šä¿¡ï¼Œå¹¶æ ¹æ®äº‹åŠ¡ç®¡ç†å™¨çš„æŒ‡ä»¤æ‰§è¡Œç›¸åº”çš„äº‹åŠ¡æ“ä½œï¼ŒåŒ…æ‹¬æäº¤å’Œå›æ»šã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0456accaa69ce5192fac9.png\" alt=\"seatamodel.png\"></li>\n</ul>\n</li>\n<li>Seataçš„å®ç°åŸç†åŸºäºä¸¤é˜¶æ®µæäº¤ï¼ˆTwo-Phase Commitï¼‰åè®®ï¼Œå…·ä½“çš„æœºåˆ¶å¦‚ä¸‹ï¼š\n<ul>\n<li>ä¸€é˜¶æ®µï¼šåœ¨äº‹åŠ¡æäº¤çš„è¿‡ç¨‹ä¸­ï¼Œé¦–å…ˆè¿›è¡Œé¢„æäº¤é˜¶æ®µã€‚äº‹åŠ¡åè°ƒå™¨å‘å„ä¸ªèµ„æºç®¡ç†å™¨å‘é€é¢„æäº¤è¯·æ±‚ï¼Œèµ„æºç®¡ç†å™¨æ‰§è¡Œç›¸åº”çš„äº‹åŠ¡æ“ä½œå¹¶è¿”å›æ‰§è¡Œç»“æœã€‚åœ¨æ­¤é˜¶æ®µï¼Œä¸šåŠ¡æ•°æ®å’Œå›æ»šæ—¥å¿—è®°å½•åœ¨åŒä¸€ä¸ªæœ¬åœ°äº‹åŠ¡ä¸­æäº¤ï¼Œå¹¶é‡Šæ”¾æœ¬åœ°é”å’Œè¿æ¥èµ„æºã€‚</li>\n<li>äºŒé˜¶æ®µï¼šåœ¨é¢„æäº¤é˜¶æ®µæˆåŠŸåï¼Œè¿›å…¥çœŸæ­£çš„æäº¤é˜¶æ®µã€‚æ­¤é˜¶æ®µä¸»è¦åŒ…æ‹¬æäº¤å¼‚æ­¥åŒ–å’Œå›æ»šåå‘è¡¥å¿ä¸¤ä¸ªæ­¥éª¤ï¼š</li>\n<li>æäº¤å¼‚æ­¥åŒ–ï¼šäº‹åŠ¡åè°ƒå™¨å‘å‡ºçœŸæ­£çš„æäº¤è¯·æ±‚ï¼Œå„ä¸ªèµ„æºç®¡ç†å™¨æ‰§è¡Œæœ€ç»ˆçš„æäº¤æ“ä½œã€‚è¿™ä¸ªé˜¶æ®µçš„æ“ä½œæ˜¯éå¸¸å¿«é€Ÿçš„ï¼Œä»¥ç¡®ä¿äº‹åŠ¡çš„æäº¤æ•ˆç‡ã€‚</li>\n<li>å›æ»šåå‘è¡¥å¿ï¼šå¦‚æœåœ¨é¢„æäº¤é˜¶æ®µä¸­æœ‰ä»»ä½•ä¸€ä¸ªèµ„æºç®¡ç†å™¨è¿”å›å¤±è´¥ç»“æœï¼Œäº‹åŠ¡åè°ƒå™¨å‘å‡ºå›æ»šè¯·æ±‚ï¼Œå„ä¸ªèµ„æºç®¡ç†å™¨æ‰§è¡Œå›æ»šæ“ä½œï¼Œåˆ©ç”¨ä¸€é˜¶æ®µçš„å›æ»šæ—¥å¿—è¿›è¡Œåå‘è¡¥å¿ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>Seataçš„äº‹åŠ¡æ‰§è¡Œæµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„ï¼Ÿ</h1>\n<ul>\n<li>äº‹åŠ¡å‘èµ·æ–¹ï¼ˆTransaction Starterï¼‰å‘èµ·å…¨å±€äº‹åŠ¡ï¼šäº‹åŠ¡å‘èµ·æ–¹æ˜¯æŒ‡å‘èµ·åˆ†å¸ƒå¼äº‹åŠ¡çš„åº”ç”¨ç¨‹åºæˆ–æœåŠ¡ã€‚å®ƒå‘Seataçš„äº‹åŠ¡åè°ƒå™¨å‘é€å…¨å±€äº‹åŠ¡çš„å¼€å§‹è¯·æ±‚ï¼Œç”Ÿæˆå…¨å±€äº‹åŠ¡IDï¼ˆGlobal Transaction IDï¼‰ã€‚</li>\n<li>äº‹åŠ¡åè°ƒå™¨åˆ›å»ºå…¨å±€äº‹åŠ¡è®°å½•ï¼šäº‹åŠ¡åè°ƒå™¨æ¥æ”¶åˆ°å…¨å±€äº‹åŠ¡çš„å¼€å§‹è¯·æ±‚åï¼Œä¼šä¸ºè¯¥äº‹åŠ¡åˆ›å»ºç›¸åº”çš„å…¨å±€äº‹åŠ¡è®°å½•ï¼Œå¹¶ç”Ÿæˆåˆ†æ”¯äº‹åŠ¡IDï¼ˆBranch Transaction IDï¼‰ã€‚</li>\n<li>åˆ†æ”¯äº‹åŠ¡æ³¨å†Œï¼šäº‹åŠ¡å‘èµ·æ–¹å°†å…¨å±€äº‹åŠ¡IDå’Œåˆ†æ”¯äº‹åŠ¡IDå‘é€ç»™å„ä¸ªå‚ä¸è€…ï¼ˆParticipantï¼‰ï¼Œå³èµ„æºç®¡ç†å™¨ã€‚å‚ä¸è€…å°†åˆ†æ”¯äº‹åŠ¡IDæ³¨å†Œåˆ°æœ¬åœ°äº‹åŠ¡ç®¡ç†å™¨ï¼Œå¹¶å°†äº‹åŠ¡çš„æ‰§è¡Œç»“æœåé¦ˆç»™äº‹åŠ¡åè°ƒå™¨ã€‚</li>\n<li>æ‰§è¡Œä¸šåŠ¡é€»è¾‘ï¼šåœ¨åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸Šä¸‹æ–‡ä¸­ï¼Œå„ä¸ªå‚ä¸è€…æ‰§è¡Œå„è‡ªçš„æœ¬åœ°äº‹åŠ¡ï¼Œå³æ‰§è¡Œä¸šåŠ¡é€»è¾‘å’Œæ•°æ®åº“æ“ä½œã€‚</li>\n<li>é¢„æäº¤é˜¶æ®µï¼šäº‹åŠ¡å‘èµ·æ–¹å‘äº‹åŠ¡åè°ƒå™¨å‘é€é¢„æäº¤è¯·æ±‚ï¼Œäº‹åŠ¡åè°ƒå™¨å°†é¢„æäº¤è¯·æ±‚å‘é€ç»™å„ä¸ªå‚ä¸è€…ã€‚</li>\n<li>æ‰§è¡Œæœ¬åœ°äº‹åŠ¡ç¡®è®¤ï¼šå‚ä¸è€…æ¥æ”¶åˆ°é¢„æäº¤è¯·æ±‚åï¼Œæ‰§è¡Œæœ¬åœ°äº‹åŠ¡çš„ç¡®è®¤æ“ä½œï¼Œå¹¶å°†æœ¬åœ°äº‹åŠ¡çš„æ‰§è¡Œç»“æœåé¦ˆç»™äº‹åŠ¡åè°ƒå™¨ã€‚</li>\n<li>å…¨å±€äº‹åŠ¡æäº¤æˆ–å›æ»šï¼šäº‹åŠ¡åè°ƒå™¨æ ¹æ®å‚ä¸è€…åé¦ˆçš„ç»“æœè¿›è¡Œåˆ¤æ–­ï¼Œå¦‚æœæ‰€æœ‰å‚ä¸è€…çš„æœ¬åœ°äº‹åŠ¡éƒ½æ‰§è¡ŒæˆåŠŸï¼Œäº‹åŠ¡åè°ƒå™¨å‘é€çœŸæ­£çš„æäº¤è¯·æ±‚ç»™å‚ä¸è€…ï¼Œå‚ä¸è€…æ‰§è¡Œæœ€ç»ˆçš„æäº¤æ“ä½œï¼›å¦‚æœæœ‰ä»»ä½•ä¸€ä¸ªå‚ä¸è€…çš„æœ¬åœ°äº‹åŠ¡æ‰§è¡Œå¤±è´¥ï¼Œäº‹åŠ¡åè°ƒå™¨å‘é€å›æ»šè¯·æ±‚ç»™å‚ä¸è€…ï¼Œå‚ä¸è€…æ‰§è¡Œå›æ»šæ“ä½œã€‚</li>\n<li>å®Œæˆå…¨å±€äº‹åŠ¡ï¼šäº‹åŠ¡åè°ƒå™¨æ¥æ”¶åˆ°å‚ä¸è€…çš„æäº¤æˆ–å›æ»šç»“æœåï¼Œæ ¹æ®ç»“æœæ›´æ–°å…¨å±€äº‹åŠ¡çš„çŠ¶æ€ï¼Œå¹¶é€šçŸ¥äº‹åŠ¡å‘èµ·æ–¹å…¨å±€äº‹åŠ¡çš„æœ€ç»ˆç»“æœã€‚</li>\n</ul>\n<h1>å…¨å±€äº‹åŠ¡IDå’Œåˆ†æ”¯äº‹åŠ¡IDæ˜¯æ€ä¹ˆä¼ é€’çš„ï¼Ÿ</h1>\n<ul>\n<li>å…¨å±€äº‹åŠ¡IDå’Œåˆ†æ”¯äº‹åŠ¡IDåœ¨åˆ†å¸ƒå¼äº‹åŠ¡ä¸­é€šè¿‡ä¸Šä¸‹æ–‡ä¼ é€’çš„æ–¹å¼è¿›è¡Œä¼ é€’ã€‚å¸¸è§çš„ä¼ é€’æ–¹å¼åŒ…æ‹¬å‚æ•°ä¼ é€’ã€çº¿ç¨‹ä¸Šä¸‹æ–‡ä¼ é€’å’Œæ¶ˆæ¯ä¸­é—´ä»¶ä¼ é€’ã€‚å…·ä½“çš„ä¼ é€’æ–¹å¼å¯ä»¥æ ¹æ®ä¸šåŠ¡åœºæ™¯å’ŒæŠ€æœ¯é€‰å‹è¿›è¡Œé€‰æ‹©å’Œè°ƒæ•´ã€‚</li>\n</ul>\n<h1>Seataçš„äº‹åŠ¡å›æ»šæ˜¯æ€ä¹ˆå®ç°çš„ï¼Ÿ</h1>\n<ul>\n<li>Seataçš„äº‹åŠ¡å›æ»šæ˜¯é€šè¿‡å›æ»šæ—¥å¿—å®ç°çš„ã€‚æ¯ä¸ªå‚ä¸è€…åœ¨æ‰§è¡Œæœ¬åœ°äº‹åŠ¡æœŸé—´ç”Ÿæˆå›æ»šæ—¥å¿—ï¼Œè®°å½•äº†å¯¹æ•°æ®çš„ä¿®æ”¹æ“ä½œã€‚</li>\n<li>å½“éœ€è¦å›æ»šäº‹åŠ¡æ—¶ï¼Œäº‹åŠ¡åè°ƒå™¨å‘å‚ä¸è€…å‘é€å›æ»šè¯·æ±‚ï¼Œå‚ä¸è€…æ ¹æ®å›æ»šæ—¥å¿—ä¸­çš„ä¿¡æ¯æ‰§è¡Œæ’¤é”€æ“ä½œï¼Œå°†æ•°æ®æ¢å¤åˆ°äº‹åŠ¡å¼€å§‹å‰çš„çŠ¶æ€ã€‚</li>\n<li>å›æ»šæ—¥å¿—çš„ç®¡ç†å’Œå­˜å‚¨æ˜¯Seataçš„æ ¸å¿ƒæœºåˆ¶ï¼Œå¯ä»¥é€‰æ‹©å°†æ—¥å¿—å­˜å‚¨åœ¨ä¸åŒçš„ä»‹è´¨ä¸­ã€‚é€šè¿‡å›æ»šæ—¥å¿—çš„æŒä¹…åŒ–å’Œæ¢å¤ï¼ŒSeataç¡®ä¿äº†äº‹åŠ¡çš„ä¸€è‡´æ€§å’Œæ¢å¤æ€§ã€‚</li>\n</ul>\n<h1>æœåŠ¡ç›‘æ§</h1>\n<h2>32.ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšç›‘æ§å’Œå‘Šè­¦ï¼Ÿ</h2>\n<ul>\n<li>Prometheusï¼šPrometheus æ˜¯ä¸€ä¸ªå¼€æºçš„ç›‘æ§ç³»ç»Ÿï¼Œå…·æœ‰çµæ´»çš„æ•°æ®æ¨¡å‹å’Œå¼ºå¤§çš„æŸ¥è¯¢è¯­è¨€ï¼Œèƒ½å¤Ÿæ”¶é›†å’Œå­˜å‚¨æ—¶é—´åºåˆ—æ•°æ®ã€‚å®ƒå¯ä»¥é€šè¿‡HTTPåè®®å®šæœŸæ‹‰å–å¾®æœåŠ¡çš„æŒ‡æ ‡æ•°æ®ï¼Œå¹¶æä¾›å¯æ‰©å±•çš„å­˜å‚¨å’ŒæŸ¥è¯¢åŠŸèƒ½ã€‚</li>\n<li>Grafanaï¼šGrafana æ˜¯ä¸€ä¸ªå¼€æºçš„å¯è§†åŒ–ä»ªè¡¨æ¿å·¥å…·ï¼Œä¸ Prometheus ç»“åˆä½¿ç”¨ï¼Œåˆ›å»ºå®æ—¶å’Œå†å²æ•°æ®çš„ä»ªè¡¨æ¿ã€‚Grafana æä¾›äº†ä¸°å¯Œçš„å›¾è¡¨å’Œå¯è§†åŒ–é€‰é¡¹ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·æ›´å¥½åœ°ç†è§£å’Œåˆ†æå¾®æœåŠ¡çš„æ€§èƒ½å’ŒçŠ¶æ€ã€‚</li>\n</ul>\n<h2>33.ä½ ä»¬çš„æœåŠ¡æ€ä¹ˆåšæ—¥å¿—æ”¶é›†ï¼Ÿ</h2>\n<ul>\n<li>ELKï¼š\n<ul>\n<li>Elasticsearchï¼šElasticsearchæ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼æœç´¢å’Œåˆ†æå¼•æ“ï¼Œç”¨äºå­˜å‚¨å’Œç´¢å¼•å¤§é‡çš„æ—¥å¿—æ•°æ®ã€‚å®ƒæä¾›äº†å¿«é€Ÿçš„æœç´¢å’ŒèšåˆåŠŸèƒ½ï¼Œå¯ä»¥é«˜æ•ˆåœ°å¤„ç†å¤§è§„æ¨¡çš„æ—¥å¿—æ•°æ®ã€‚</li>\n<li>Logstashï¼šLogstashæ˜¯ä¸€ä¸ªç”¨äºæ”¶é›†ã€è¿‡æ»¤å’Œè½¬å‘æ—¥å¿—æ•°æ®çš„å·¥å…·ã€‚å®ƒå¯ä»¥ä»å„ç§æ¥æºï¼ˆå¦‚æ–‡ä»¶ã€ç½‘ç»œã€æ¶ˆæ¯é˜Ÿåˆ—ç­‰ï¼‰æ”¶é›†æ—¥å¿—æ•°æ®ï¼Œå¹¶å¯¹æ•°æ®è¿›è¡Œå¤„ç†å’Œè½¬æ¢ï¼Œç„¶åå°†å…¶å‘é€åˆ°Elasticsearchè¿›è¡Œå­˜å‚¨å’Œç´¢å¼•ã€‚</li>\n<li>Kibanaï¼šKibanaæ˜¯ä¸€ä¸ªç”¨äºæ—¥å¿—æ•°æ®å¯è§†åŒ–å’Œåˆ†æçš„å·¥å…·ã€‚å®ƒæä¾›äº†ä¸°å¯Œçš„å›¾è¡¨ã€ä»ªè¡¨ç›˜å’Œæœç´¢åŠŸèƒ½ï¼Œå¯ä»¥å¸®åŠ©ç”¨æˆ·å®æ—¶ç›‘æ§å’Œåˆ†ææ—¥å¿—æ•°æ®ï¼Œå‘ç°æ½œåœ¨çš„é—®é¢˜å’Œè¶‹åŠ¿ã€‚</li>\n</ul>\n</li>\n<li>è¿™ä¸‰è€…é‡ŒElasticsearchæä¾›æ•°æ®å­˜å‚¨å’Œæ£€ç´¢èƒ½åŠ›ï¼ŒLogstashè´Ÿè´£å°†æ—¥å¿—æ”¶é›†åˆ°ESï¼ŒKibanaè´Ÿè´£æ—¥å¿—æ•°æ®çš„å¯è§†åŒ–åˆ†æã€‚</li>\n<li>ä½¿ç”¨ELKè¿›è¡Œå¾®æœåŠ¡æ—¥å¿—æ”¶é›†çš„ä¸€èˆ¬æµç¨‹å¦‚ä¸‹ï¼š</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3f959676d10750e5c8902.png\" alt=\"elk.png\" tabindex=\"0\"><figcaption>elk.png</figcaption></figure>\n<ul>\n<li>åœ¨æ¯ä¸ªå¾®æœåŠ¡ä¸­é…ç½®æ—¥å¿—è¾“å‡ºï¼šå°†å¾®æœåŠ¡çš„æ—¥å¿—è¾“å‡ºåˆ°æ ‡å‡†è¾“å‡ºï¼ˆstdoutï¼‰æˆ–æ—¥å¿—æ–‡ä»¶ã€‚</li>\n<li>ä½¿ç”¨Logstashæ”¶é›†æ—¥å¿—ï¼šé…ç½®Logstashæ”¶é›†å™¨ï¼Œé€šè¿‡é…ç½®è¾“å…¥æ’ä»¶ï¼ˆå¦‚æ–‡ä»¶è¾“å…¥ã€ç½‘ç»œè¾“å…¥ç­‰ï¼‰ç›‘å¬å¾®æœåŠ¡çš„æ—¥å¿—è¾“å‡ºï¼Œå¹¶è¿›è¡Œè¿‡æ»¤å’Œå¤„ç†ã€‚</li>\n<li>å°†æ—¥å¿—æ•°æ®å‘é€åˆ°Elasticsearchï¼šé…ç½®Logstashçš„è¾“å‡ºæ’ä»¶ï¼Œå°†ç»è¿‡å¤„ç†çš„æ—¥å¿—æ•°æ®å‘é€åˆ°Elasticsearchè¿›è¡Œå­˜å‚¨å’Œç´¢å¼•ã€‚</li>\n<li>ä½¿ç”¨Kibanaè¿›è¡Œå¯è§†åŒ–å’Œåˆ†æï¼šé€šè¿‡Kibanaè¿æ¥åˆ°Elasticsearchï¼Œåˆ›å»ºä»ªè¡¨ç›˜ã€å›¾è¡¨å’Œæœç´¢æŸ¥è¯¢ï¼Œå®æ—¶ç›‘æ§å’Œåˆ†æå¾®æœåŠ¡çš„æ—¥å¿—æ•°æ®ã€‚</li>\n<li>é™¤äº†åº”ç”¨æœ€å¹¿æ³›çš„ELKï¼Œè¿˜æœ‰ä¸€äº›å…¶å®ƒçš„æ–¹æ¡ˆæ¯”å¦‚Fluentdã€Graylogã€Lokiã€Filebeatï¼Œä¸€äº›äº‘å‚å•†ä¹Ÿæä¾›äº†ä»˜è´¹æ–¹æ¡ˆï¼Œæ¯”å¦‚é˜¿é‡Œäº‘çš„slsã€‚</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/d8e1d1b5769a399ef1bb8.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "springmvc",
      "url": "https://javaguide.cn/interview/springmvc.html",
      "id": "https://javaguide.cn/interview/springmvc.html",
      "summary": "1. è°ˆè°ˆä½ å¯¹ MVC æ¨¡å¼çš„ç†è§£ï¼Ÿâˆš MVCæ˜¯Modelâ€”Viewâ€”Controllerç®€ç§°ï¼Œå®ƒæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼Œå®ƒåˆ†ç¦»äº†è¡¨ç°ä¸äº¤äº’ã€‚å®ƒè¢«åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒéƒ¨ä»¶ï¼šæ¨¡å‹ã€è§†å›¾ã€æ§åˆ¶å™¨ Modelï¼ˆæ¨¡å‹ï¼‰ï¼šæŒ‡javaBean æ˜¯ç¨‹åºçš„ä¸»ä½“éƒ¨åˆ†ï¼Œä¸»è¦åŒ…å«ä¸šåŠ¡æ•°æ®å’Œé€»è¾‘ã€‚åœ¨æ¨¡å‹å±‚ï¼Œè¿˜ä¼šæ¶‰åŠåˆ°ç”¨æˆ·å‘å¸ƒçš„æœåŠ¡ï¼Œåœ¨æœåŠ¡ä¸­ä¼šæ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ›´æ–°ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ã€‚ Vie...",
      "content_html": "<!-- TOC -->\n<!-- /TOC -->\n<h1>1. è°ˆè°ˆä½ å¯¹ MVC æ¨¡å¼çš„ç†è§£ï¼Ÿâˆš</h1>\n<ul>\n<li>MVCæ˜¯Modelâ€”Viewâ€”Controllerç®€ç§°ï¼Œå®ƒæ˜¯ä¸€ç§æ¶æ„æ¨¡å¼ï¼Œå®ƒåˆ†ç¦»äº†è¡¨ç°ä¸äº¤äº’ã€‚å®ƒè¢«åˆ†ä¸ºä¸‰ä¸ªæ ¸å¿ƒéƒ¨ä»¶ï¼šæ¨¡å‹ã€è§†å›¾ã€æ§åˆ¶å™¨</li>\n<li>Modelï¼ˆæ¨¡å‹ï¼‰ï¼šæŒ‡javaBean æ˜¯ç¨‹åºçš„ä¸»ä½“éƒ¨åˆ†ï¼Œä¸»è¦åŒ…å«ä¸šåŠ¡æ•°æ®å’Œé€»è¾‘ã€‚åœ¨æ¨¡å‹å±‚ï¼Œè¿˜ä¼šæ¶‰åŠåˆ°ç”¨æˆ·å‘å¸ƒçš„æœåŠ¡ï¼Œåœ¨æœåŠ¡ä¸­ä¼šæ ¹æ®ä¸åŒçš„ä¸šåŠ¡éœ€æ±‚ï¼Œæ›´æ–°ä¸šåŠ¡æ¨¡å‹ä¸­çš„æ•°æ®ã€‚</li>\n<li>Viewï¼ˆè§†å›¾ï¼‰ï¼šæŒ‡JSPæˆ–è€…HTML æ˜¯ç¨‹åºå‘ˆç°ç»™ç”¨æˆ·çš„éƒ¨åˆ†ï¼Œæ˜¯ç”¨æˆ·å’Œç¨‹åºäº¤äº’çš„æ¥å£ï¼Œç”¨æˆ·ä¼šæ ¹æ®å…·ä½“çš„ä¸šåŠ¡éœ€æ±‚ï¼Œåœ¨Viewè§†å›¾å±‚è¾“å…¥è‡ªå·±ç‰¹å®šçš„ä¸šåŠ¡æ•°æ®ï¼Œå¹¶é€šè¿‡ç•Œé¢çš„äº‹ä»¶äº¤äº’ï¼Œå°†å¯¹åº”çš„è¾“å…¥å‚æ•°æäº¤ç»™åå°æ§åˆ¶å™¨è¿›è¡Œå¤„ç†</li>\n<li>Controllerï¼ˆæ§åˆ¶å™¨ï¼‰ï¼šæŒ‡servletæˆ–è€…Filter Controllerç”¨æ¥å¤„ç†ç”¨æˆ·è¾“å…¥æ•°æ®ï¼Œä»¥åŠæ›´æ–°ä¸šåŠ¡æ¨¡å‹çš„éƒ¨åˆ†ã€‚æ§åˆ¶å™¨ä¸­æ¥æ”¶äº†ç”¨æˆ·ä¸ç•Œé¢äº¤äº’æ—¶ä¼ é€’è¿‡æ¥çš„æ•°æ®ï¼Œå¹¶æ ¹æ®æ•°æ®ä¸šåŠ¡é€»è¾‘æ¥æ‰§è¡ŒæœåŠ¡çš„è°ƒç”¨å’Œæ›´æ–°ä¸šåŠ¡æ¨¡å‹çš„æ•°æ®å’ŒçŠ¶æ€</li>\n</ul>\n<h1>3. springMVCæ‰§è¡Œæµç¨‹ï¼ŸâˆšSpringMVC çš„æ ¸å¿ƒç»„ä»¶æœ‰å“ªäº›ï¼ŸHandlerAdapterä½œç”¨ï¼Ÿâˆš</h1>\n<ul>\n<li>æ¶æ„æµç¨‹\n<ul>\n<li>ç”¨æˆ·å‘é€è¯·æ±‚è‡³å‰ç«¯æ§åˆ¶å™¨DispatcherServlet</li>\n<li>DispatcherServletæ”¶åˆ°è¯·æ±‚è°ƒç”¨HandlerMappingå¤„ç†å™¨æ˜ å°„å™¨ã€‚å¤„ç†å™¨æ˜ å°„å™¨æ ¹æ®è¯·æ±‚urlæ‰¾åˆ°å…·ä½“çš„å¤„ç†å™¨ï¼Œç”Ÿæˆå¤„ç†å™¨å¯¹è±¡åŠå¤„ç†å™¨æ‹¦æˆªå™¨(å¦‚æœæœ‰åˆ™ç”Ÿæˆ)ä»¥ HandlerExecutionChain å¯¹è±¡çš„å½¢å¼è¿”å›ç»™DispatcherServlet</li>\n<li>DispatcherServletè°ƒç”¨HandlerAdapterå¤„ç†å™¨é€‚é…å™¨è°ƒç”¨å¤„ç†å™¨ã€‚ä¸­é€”è°ƒç”¨æ‹¦æˆªå™¨çš„preHandleå’ŒpostHandleæ–¹æ³•ï¼ŒHandlerAdapterå°†controlleræ‰§è¡Œç»“æœModelAndViewè¿”å›ç»™DispatcherServlet</li>\n<li>DispatcherServletå°†ModelAndViewä¼ ç»™ViewResloverè§†å›¾è§£æå™¨ViewResloverè§£æåè¿”å›å…·ä½“View</li>\n<li>DispatcherServletå¯¹Viewè¿›è¡Œæ¸²æŸ“è§†å›¾ï¼ˆå³å°†æ¨¡å‹æ•°æ®å¡«å……è‡³è§†å›¾ä¸­ï¼‰</li>\n<li>DispatcherServletå“åº”ç”¨æˆ·</li>\n</ul>\n</li>\n<li>ç»„ä»¶è¯´æ˜\n<ul>\n<li>DispatcherServletï¼šå‰ç«¯æ§åˆ¶å™¨ï¼Œç›¸å½“äºmvcæ¨¡å¼ä¸­çš„cï¼Œæµç¨‹æ§åˆ¶ä¸­å¿ƒï¼Œç”±å®ƒè°ƒç”¨å…¶å®ƒç»„ä»¶å¤„ç†ç”¨æˆ·çš„è¯·æ±‚ï¼Œé™ä½äº†ç»„ä»¶ä¹‹é—´çš„è€¦åˆæ€§ã€‚</li>\n<li>HandlerMappingï¼šå¤„ç†å™¨æ˜ å°„å™¨ã€‚è´Ÿè´£æ ¹æ®ç”¨æˆ·è¯·æ±‚urlæ‰¾åˆ°Handlerå³å¤„ç†å™¨ï¼Œæä¾›é…ç½®æ–‡ä»¶æ–¹å¼ï¼Œå®ç°æ¥å£æ–¹å¼ï¼Œæ³¨è§£æ–¹å¼ç­‰æ˜ å°„æ–¹å¼</li>\n<li>Handlerï¼šå¤„ç†å™¨ï¼Œåç«¯æ§åˆ¶å™¨ï¼Œå…·ä½“çš„ç”¨æˆ·è¯·æ±‚è¿›è¡Œå¤„ç†ã€‚æ¶‰åŠåˆ°å…·ä½“çš„ç”¨æˆ·ä¸šåŠ¡è¯·æ±‚ï¼Œéœ€è¦ç¨‹åºå‘˜æ ¹æ®ä¸šåŠ¡éœ€æ±‚å¼€å‘Handler</li>\n<li>HandlAdapterï¼šå¤„ç†å™¨é€‚é…å™¨ï¼Œé€‚é…å™¨æ¨¡å¼çš„åº”ç”¨ï¼Œé€šè¿‡æ‰©å±•é€‚é…å™¨å¯ä»¥å¯¹æ›´å¤šç±»å‹çš„å¤„ç†å™¨è¿›è¡Œæ‰§è¡Œã€‚DispatcherServletä¼šæ ¹æ®controllerå¯¹åº”çš„controllerç±»å‹æ¥è°ƒç”¨ç›¸åº”çš„HandlerAdapteræ¥è¿›è¡Œå¤„ç†ï¼Œè´Ÿè´£è¡¨å•æ•°æ®çš„éªŒè¯ã€æ•°æ®ç±»å‹çš„è½¬æ¢ã€å°†è¡¨å•æ•°æ®å°è£…åˆ° JavaBean ç­‰</li>\n<li>ViewResolverï¼šè§†å›¾è§£æå™¨ã€‚é¦–å…ˆæ ¹æ®é€»è¾‘è§†å›¾åè§£ææˆç‰©ç†è§†å›¾åå³å…·ä½“çš„é¡µé¢åœ°å€ï¼Œå†ç”ŸæˆViewè§†å›¾å¯¹è±¡ï¼Œæœ€åå¯¹Viewè¿›è¡Œæ¸²æŸ“å°†å¤„ç†ç»“æœé€šè¿‡é¡µé¢å±•ç¤ºç»™ç”¨æˆ·</li>\n<li>ModelAndViewï¼šè£…è½½äº†æ¨¡å‹æ•°æ®å’Œè§†å›¾ä¿¡æ¯ï¼Œä½œä¸ºHandlerå¤„ç†ç»“æœè¿”å›ç»™DispatcherServletã€‚</li>\n<li>Viewï¼šæ”¯æŒViewè§†å›¾ç±»å‹ï¼šjstlViewã€freemarkerViewã€pdfViewç­‰</li>\n<li>HandlerInterceptorï¼šå¤„ç†å™¨æ‹¦æˆªå™¨ï¼Œæ˜¯ä¸€ä¸ªæ¥å£ï¼Œå¦‚æœéœ€è¦å®Œæˆä¸€äº›æ‹¦æˆªå¤„ç†ï¼Œå¯ä»¥å®ç°è¯¥æ¥å£ã€‚</li>\n<li>HandlerExecutionChainï¼šå¤„ç†å™¨æ‰§è¡Œé“¾ï¼ŒåŒ…æ‹¬ä¸¤éƒ¨åˆ†å†…å®¹ï¼šHandler å’Œ HandlerInterceptorï¼ˆç³»ç»Ÿä¼šæœ‰ä¸€ä¸ªé»˜è®¤çš„ HandlerInterceptorï¼Œå¦‚æœéœ€è¦é¢å¤–è®¾ç½®æ‹¦æˆªï¼Œå¯ä»¥æ·»åŠ æ‹¦æˆªå™¨ï¼‰ã€‚</li>\n</ul>\n</li>\n<li>ä¸‰å¤§ç»„ä»¶ï¼šå¤„ç†å™¨æ˜ å°„å™¨ã€å¤„ç†å™¨é€‚é…å™¨ã€è§†å›¾è§£æå™¨ç§°ä¸ºspringmvcçš„ä¸‰å¤§ç»„ä»¶ã€‚éœ€è¦ç”¨æˆ·å¼€å‘çš„ç»„ä»¶æœ‰handlerã€view<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4e64fa261b3306be5d57d.png\" alt=\"springmvcexecutionflow.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a4dbc7ba97069479b942b.jpg\" alt=\"springmvcexecutionflow2.png\"></li>\n</ul>\n<h1>SpringMVC Restfulé£æ ¼çš„æ¥å£çš„æµç¨‹æ˜¯ä»€ä¹ˆæ ·çš„å‘¢ï¼Ÿ</h1>\n<ul>\n<li>å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘é€ä¸€æ¬¡è¯·æ±‚ï¼Œè¿™ä¸ªè¯·æ±‚ä¼šå…ˆåˆ°å‰ç«¯æ§åˆ¶å™¨DispatcherServlet</li>\n<li>DispatcherServletæ¥æ”¶åˆ°è¯·æ±‚åä¼šè°ƒç”¨HandlerMappingå¤„ç†å™¨æ˜ å°„å™¨ã€‚ç”±æ­¤å¾—çŸ¥ï¼Œè¯¥è¯·æ±‚è¯¥ç”±å“ªä¸ªControlleræ¥å¤„ç†</li>\n<li>DispatcherServletè°ƒç”¨HandlerAdapterå¤„ç†å™¨é€‚é…å™¨ï¼Œå‘Šè¯‰å¤„ç†å™¨é€‚é…å™¨åº”è¯¥è¦å»æ‰§è¡Œå“ªä¸ªController</li>\n<li>Controllerè¢«å°è£…æˆäº†ServletInvocableHandlerMethodï¼ŒHandlerAdapterå¤„ç†å™¨é€‚é…å™¨å»æ‰§è¡ŒinvokeAndHandleæ–¹æ³•ï¼Œå®Œæˆå¯¹Controllerçš„è¯·æ±‚å¤„ç†</li>\n<li>HandlerAdapteræ‰§è¡Œå®Œå¯¹Controllerçš„è¯·æ±‚ï¼Œä¼šè°ƒç”¨HandlerMethodReturnValueHandlerå»å¤„ç†è¿”å›å€¼ï¼Œä¸»è¦çš„è¿‡ç¨‹ï¼š\n<ul>\n<li>è°ƒç”¨RequestResponseBodyMethodProcessorï¼Œåˆ›å»ºServletServerHttpResponseï¼ˆSpringå¯¹åŸç”ŸServerHttpResponseçš„å°è£…ï¼‰å®ä¾‹</li>\n<li>ä½¿ç”¨HttpMessageConverterçš„writeæ–¹æ³•ï¼Œå°†è¿”å›å€¼å†™å…¥ServletServerHttpResponseçš„OutputStreamè¾“å‡ºæµä¸­</li>\n<li>åœ¨å†™å…¥çš„è¿‡ç¨‹ä¸­ï¼Œä¼šä½¿ç”¨JsonGeneratorï¼ˆé»˜è®¤ä½¿ç”¨Jacksonæ¡†æ¶ï¼‰å¯¹è¿”å›å€¼è¿›è¡ŒJsonåºåˆ—åŒ–</li>\n</ul>\n</li>\n<li>æ‰§è¡Œå®Œè¯·æ±‚åï¼Œè¿”å›çš„ModealAndViewä¸ºnullï¼ŒServletServerHttpResponseé‡Œä¹Ÿå·²ç»å†™å…¥äº†å“åº”ï¼Œæ‰€ä»¥ä¸ç”¨å…³å¿ƒViewçš„å¤„ç†<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0630239e8e2b0b062ba02.png\" alt=\"springmvcrestful.png\"></li>\n</ul>\n<h1>4. ç®€è¿°SpringMVCä¸­ä½¿ç”¨çš„è®¾è®¡æ¨¡å¼ä»¥åŠåœ¨SpringMVCä¸­çš„åº”ç”¨åœºæ™¯(1-2ä¸ª)</h1>\n<ul>\n<li>å•ä¾‹æ¨¡å¼ï¼šspringmvcçš„controlleré»˜è®¤æ˜¯å•ä¾‹çš„</li>\n<li>ä»£ç†æ¨¡å¼ï¼šspringmvcçš„controlleræ˜¯é€šè¿‡ä»£ç†äº§ç”Ÿçš„</li>\n</ul>\n<h1>5. SpringMVC å¸¸ç”¨çš„æ³¨è§£æœ‰å“ªäº›ï¼Ÿ</h1>\n<ul>\n<li>@RequestMappingï¼šç”¨äºå¤„ç†è¯·æ±‚urlæ˜ å°„çš„æ³¨è§£ï¼Œå¯ç”¨äºç±»æˆ–æ–¹æ³•ä¸Šã€‚ç”¨äºç±»ä¸Šï¼Œåˆ™è¡¨ç¤ºç±»ä¸­çš„æ‰€æœ‰å“åº”è¯·æ±‚çš„æ–¹æ³•éƒ½æ˜¯ä»¥è¯¥åœ°å€ä½œä¸ºçˆ¶è·¯å¾„ï¼›æ–¹æ³•ä¸Šåˆ™æ˜ å°„urlå’Œhttpè¯·æ±‚æ–¹æ³•</li>\n<li>@RequestBodyï¼šæ³¨è§£å®ç°æ¥æ”¶ HTTP è¯·æ±‚çš„ json æ•°æ®ï¼Œå°† json è½¬æ¢ä¸º Java å¯¹è±¡ï¼›</li>\n<li>@ResponseBodyï¼šæ³¨è§£å®ç°å°† Controller æ–¹æ³•è¿”å›å¯¹è±¡è½¬åŒ–ä¸º json å¯¹è±¡å“åº”ç»™å®¢æˆ·ã€‚éœ€è¦é…åˆç›¸åº”çš„æ”¯æŒ JSON æ ¼å¼åŒ–çš„ HttpMessageConverter å®ç°ç±»</li>\n<li>@Controllerï¼Œå®ƒå°†ä¸€ä¸ªç±»æ ‡è®°ä¸º Spring Web MVC æ§åˆ¶å™¨ Controller</li>\n<li>@RestControllerï¼Œåœ¨ @Controller åŸºç¡€ä¸Šï¼Œå¢åŠ äº† @ResponseBodyï¼Œæä¾›Restful API ï¼Œè¿”å›ä¾‹å¦‚ JSON æ•°æ®æ ¼å¼ã€‚å½“ç„¶ï¼Œè¿”å›ä»€ä¹ˆæ ·çš„æ•°æ®æ ¼å¼ï¼Œæ ¹æ®å®¢æˆ·ç«¯çš„ \"ACCEPT\" è¯·æ±‚å¤´å†³å®šã€‚</li>\n<li>@PathVariableä» URI è¯»å–å€¼ï¼Œæ¯”å¦‚æŸ¥è¯¢å‚æ•°</li>\n</ul>\n<h1>6. @RequestMapping å’Œ @GetMapping æ³¨è§£çš„ä¸åŒä¹‹å¤„åœ¨å“ªé‡Œï¼Ÿ</h1>\n<ul>\n<li>@RequestMappingå¯æ³¨è§£åœ¨ç±»å’Œæ–¹æ³•ä¸Šï¼›@GetMapping ä»…å¯æ³¨å†Œåœ¨æ–¹æ³•ä¸Š</li>\n<li>@RequestMappingå¯è¿›è¡ŒGETã€POSTã€PUTã€DELETEç­‰è¯·æ±‚æ–¹æ³•ï¼›@GetMappingæ˜¯@RequestMappingçš„GETè¯·æ±‚æ–¹æ³•çš„ç‰¹ä¾‹</li>\n</ul>\n<h1>7. å¦‚ä½•è§£å†³POSTã€GETè¯·æ±‚ä¸­æ–‡ä¹±ç é—®é¢˜ï¼Ÿ</h1>\n<ul>\n<li>POSTï¼šweb.xmlä¸­é…ç½®ä¸€ä¸ª CharacterEncodingFilter è¿‡æ»¤å™¨ï¼Œè®¾ç½®æˆ utf-8ï¼›</li>\n<li>GETï¼š\n<ul>\n<li>æ–¹æ³•1ï¼šä¿®æ”¹tomcaté…ç½®æ–‡ä»¶æ·»åŠ ç¼–ç ä¸å·¥ç¨‹ç¼–ç ä¸€è‡´ï¼Œ&lt;ConnectorURIEncoding=\"utf-8\" connectionTimeout=\"20000\" port=\"8080\" protocol=\"HTTP/1.1\" redirectPort&gt;</li>\n<li>æ–¹æ³•2ï¼šå¯¹å‚æ•°è¿›è¡Œé‡æ–°ç¼–ç ï¼šString userName = new String(request.getParamter(\"userName\").getBytes(\"ISO8859-1\"),\"utf-8\")</li>\n</ul>\n</li>\n</ul>\n<h1>8. springmvcå¼‚å¸¸å¤„ç†</h1>\n<ul>\n<li>Spring MVCæä¾›äº†å¼‚å¸¸è§£æå™¨HandlerExceptionResolveræ¥å£ï¼Œå°†å¤„ç†å™¨(handler)æ‰§è¡Œæ—¶å‘ç”Ÿçš„å¼‚å¸¸ï¼Œè§£æ(è½¬æ¢)æˆå¯¹åº”çš„ModelAndViewç»“æœ</li>\n</ul>\n<h1>9. Spring MVC æ‹¦æˆªå™¨æœ‰å“ªäº›æ–¹æ³•ï¼Ÿä½œç”¨ï¼Ÿ</h1>\n<ul>\n<li>preHandleæ–¹æ³•ï¼Œè°ƒç”¨Controlleræ–¹æ³•å‰æ‰§è¡Œã€‚æŒ‰æ‹¦æˆªå™¨å®šä¹‰é¡ºåºè°ƒç”¨ã€‚è‹¥ä»»ä¸€æ‹¦æˆªå™¨è¿”å›false ï¼Œåˆ™Controlleræ–¹æ³•ä¸å†è°ƒç”¨ã€‚</li>\n<li>postHandleæ–¹æ³•ï¼Œè°ƒç”¨Controlleræ–¹æ³•åæ‰§è¡Œã€‚æŒ‰æ‹¦æˆªå™¨å®šä¹‰é€†åºè°ƒç”¨</li>\n<li>afterCompletionæ–¹æ³•ï¼Œå¤„ç†å®ŒControlleræ–¹æ³•è¿”å›ç»“æœåæ‰§è¡Œ.æŒ‰æ‹¦æˆªå™¨å®šä¹‰é€†åºè°ƒç”¨.åªè¦preHandleæ–¹æ³•è¿”å›trueæ—¶å°±ä¼šæ‰§è¡Œ.æ— è§†å¼‚å¸¸</li>\n<li>è®°å½•è®¿é—®æ—¥å¿—ã€‚è®°å½•å¼‚å¸¸æ—¥å¿—ã€‚éœ€è¦ç™»é™†çš„è¯·æ±‚æ“ä½œï¼Œæ‹¦æˆªæœªç™»é™†çš„ç”¨æˆ·ã€‚</li>\n</ul>\n<h1>10. Spring MVC çš„æ‹¦æˆªå™¨å’Œ Filter è¿‡æ»¤å™¨æœ‰ä»€ä¹ˆå·®åˆ«ï¼Ÿ</h1>\n<ul>\n<li>åŠŸèƒ½ç›¸åŒï¼šæ‹¦æˆªå™¨å’Œ Filteréƒ½èƒ½å®ç°ç›¸åº”çš„åŠŸèƒ½ï¼Œè°ä¹Ÿä¸æ¯”è°å¼ºã€‚</li>\n<li>å®¹å™¨ä¸åŒï¼šæ‹¦æˆªå™¨æ„å»ºåœ¨ Spring MVC ä½“ç³»ä¸­ï¼›Filter æ„å»ºåœ¨ Servlet å®¹å™¨ä¹‹ä¸Šã€‚</li>\n<li>ä½¿ç”¨ä¾¿åˆ©æ€§ä¸åŒï¼šæ‹¦æˆªå™¨æä¾›äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œåˆ†åˆ«åœ¨ä¸åŒçš„æ—¶æœºæ‰§è¡Œï¼›è¿‡æ»¤å™¨ä»…æä¾›ä¸€ä¸ªæ–¹æ³•ï¼Œå½“ç„¶ä¹Ÿèƒ½å®ç°æ‹¦æˆªå™¨çš„æ‰§è¡Œæ—¶æœºçš„æ•ˆæœï¼Œå°±æ˜¯éº»çƒ¦ä¸€äº›ã€‚</li>\n</ul>\n<h1>11. ä»€ä¹ˆæ˜¯å®‰å…¨çš„RESTæ“ä½œ?</h1>\n<ul>\n<li>RESTæ¥å£æ˜¯å¦å®‰å…¨çš„ç•Œé™ï¼Œåœ¨äºæ˜¯å¦ä¿®æ”¹æœåŠ¡ç«¯çš„èµ„æºã€‚å› æ­¤GETå’ŒHEADæ˜¯å®‰å…¨çš„ï¼ŒPUT,POST å’Œ DELETEæ˜¯ä¸å®‰å…¨çš„</li>\n</ul>\n<h1>12. ä»€ä¹ˆæ˜¯å¹‚ç­‰æ“ä½œ? ä¸ºä»€ä¹ˆå¹‚ç­‰æ“ä½œå¦‚æ­¤é‡è¦?</h1>\n<ul>\n<li>ç”¨æˆ·å¯¹äºåŒä¸€æ“ä½œå‘èµ·çš„ä¸€æ¬¡è¯·æ±‚æˆ–è€…å¤šæ¬¡è¯·æ±‚çš„ç»“æœæ˜¯ä¸€è‡´çš„ï¼Œä¸ä¼šå› ä¸ºå¤šæ¬¡ç‚¹å‡»è€Œäº§ç”Ÿäº†å‰¯ä½œç”¨ã€‚</li>\n<li>POSTæ–¹æ³•ä¸æ˜¯å¹‚ç­‰æ“ä½œ ï¼Œå› ä¸ºå¦‚æœå‘é€å¤šä¸ª POST è¯·æ±‚ï¼Œå®ƒå°†åœ¨æœåŠ¡ç«¯åˆ›å»ºä¸åŒçš„èµ„æºã€‚ä½†æ˜¯PUTæ›´æ–°èµ„æºæ˜¯å¹‚ç­‰æ“ä½œã€‚ç”šè‡³å¤šä¸ªPUTè¯·æ±‚è¢«ç”¨æ¥æ›´æ–°æœåŠ¡ç«¯èµ„æºï¼Œå°†å¾—åˆ°ç›¸åŒçš„ç»“æœã€‚</li>\n</ul>\n<h1>13. REST ç”¨å“ªç§ HTTP æ–¹æ³•å‘¢?</h1>\n<ul>\n<li>GETæ£€ç´¢æœåŠ¡ç«¯èµ„æº</li>\n<li>POSTåˆ›å»ºæœåŠ¡ç«¯èµ„æº</li>\n<li>PUTæ›´æ–°æœåŠ¡ç«¯èµ„æº</li>\n<li>DELETEåˆ é™¤æœåŠ¡ç«¯èµ„æº</li>\n</ul>\n<h1>14. REST APIæ˜¯æ— çŠ¶æ€çš„å—?</h1>\n<ul>\n<li>REST APIæ˜¯æ— çŠ¶æ€çš„ï¼Œå› ä¸ºåŸºäºHTTPä¹Ÿæ˜¯æ— çŠ¶æ€ã€‚</li>\n<li>REST APIè¯·æ±‚åº”è¯¥åŒ…å«å¤„ç†å®ƒæ‰€éœ€çš„æ‰€æœ‰ç»†èŠ‚ã€‚å®ƒä¸åº”è¯¥ä¾èµ–äºä»¥å‰æˆ–ä¸‹ä¸€ä¸ªè¯·æ±‚æˆ–æœåŠ¡å™¨ç«¯ç»´æŠ¤çš„ä¸€äº›æ•°æ®ï¼Œä¾‹å¦‚ä¼šè¯ã€‚</li>\n</ul>\n<h1>15. å¦‚ä½•åˆ›å»º HttpMessageConverter çš„è‡ªå®šä¹‰å®ç°æ¥æ”¯æŒä¸€ç§æ–°çš„è¯·æ±‚/å“åº”ï¼Ÿ</h1>\n<ul>\n<li>è‡ªå®šä¹‰çš„AbstractHttpMessageConverterå®ç°ï¼Œå¹¶ä½¿ç”¨WebMvcConfigurerAdapterçš„#extendMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) æ–¹æ³•æ³¨å†Œ</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/4e64fa261b3306be5d57d.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "sqlå®å…¸",
      "url": "https://javaguide.cn/interview/sql.html",
      "id": "https://javaguide.cn/interview/sql.html",
      "summary": "t_gradeæˆç»©è¡¨ 1. case whenä½¿ç”¨ åˆ†æ•°ç­‰çº§ï¼šæ¯é—¨è¯¾æˆç»©çš„ç­‰çº§åˆ’åˆ†ä¸ºä¸‰ä¸ªï¼Œåˆ†æ•°å°äº80ä¸ºåŠæ ¼ï¼Œå¤§äºç­‰äº80ä½äº90åˆ†ä¸ºä¸­ç­‰ï¼›å¤§äºç­‰äº90åˆ†ä¸ºä¼˜ç§€ï¼Œç»“æœå¦‚ä¸‹ 2. åˆ†ç»„åŠå…¶ç»„å†…æ¯”è¾ƒ å¦‚ï¼šæŸ¥å‡ºæ¯ä¸ªå­¦ç§‘ä½äºå…¶å¹³å‡åˆ†çš„å­¦ç”Ÿç­‰ã€‚é¦–å…ˆæŸ¥è¯¢å‡ºæ¯æ¡è®°å½•å¯¹åº”çš„åˆ†ç»„å‡½æ•°å€¼select * from table t1 left join (select åˆ†ç»„...",
      "content_html": "<!-- TOC -->\n<!-- /TOC -->\n<ul>\n<li>t_gradeæˆç»©è¡¨</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:center\">kemu</th>\n<th style=\"text-align:center\">fenshu</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å¼ ä¸‰</td>\n<td style=\"text-align:center\">è¯­æ–‡</td>\n<td style=\"text-align:center\">81</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¼ ä¸‰</td>\n<td style=\"text-align:center\">æ•°å­¦</td>\n<td style=\"text-align:center\">72</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æå››</td>\n<td style=\"text-align:center\">è¯­æ–‡</td>\n<td style=\"text-align:center\">76</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æå››</td>\n<td style=\"text-align:center\">æ•°å­¦</td>\n<td style=\"text-align:center\">90</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç‹äº”</td>\n<td style=\"text-align:center\">è¯­æ–‡</td>\n<td style=\"text-align:center\">81</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç‹äº”</td>\n<td style=\"text-align:center\">æ•°å­¦</td>\n<td style=\"text-align:center\">100</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">...</td>\n<td style=\"text-align:center\">...</td>\n<td style=\"text-align:center\">...</td>\n</tr>\n</tbody>\n</table>\n<h1>1. case whenä½¿ç”¨</h1>\n<ul>\n<li>åˆ†æ•°ç­‰çº§ï¼šæ¯é—¨è¯¾æˆç»©çš„ç­‰çº§åˆ’åˆ†ä¸ºä¸‰ä¸ªï¼Œåˆ†æ•°å°äº80ä¸ºåŠæ ¼ï¼Œå¤§äºç­‰äº80ä½äº90åˆ†ä¸ºä¸­ç­‰ï¼›å¤§äºç­‰äº90åˆ†ä¸ºä¼˜ç§€ï¼Œç»“æœå¦‚ä¸‹</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">name</th>\n<th style=\"text-align:center\">kemu</th>\n<th style=\"text-align:center\">fenshu</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å¼ ä¸‰</td>\n<td style=\"text-align:center\">è¯­æ–‡</td>\n<td style=\"text-align:center\">ä¸­ç­‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¼ ä¸‰</td>\n<td style=\"text-align:center\">æ•°å­¦</td>\n<td style=\"text-align:center\">åˆæ ¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æå››</td>\n<td style=\"text-align:center\">è¯­æ–‡</td>\n<td style=\"text-align:center\">åˆæ ¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æå››</td>\n<td style=\"text-align:center\">æ•°å­¦</td>\n<td style=\"text-align:center\">ä¼˜ç§€</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç‹äº”</td>\n<td style=\"text-align:center\">è¯­æ–‡</td>\n<td style=\"text-align:center\">ä¸­ç­‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç‹äº”</td>\n<td style=\"text-align:center\">æ•°å­¦</td>\n<td style=\"text-align:center\">ä¼˜ç§€</td>\n</tr>\n</tbody>\n</table>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>select name,kemu,case when fenshu&gt;=90 then  'ä¼˜ç§€' when  fenshu&lt;90 and fenshu&gt;=80 then 'ä¸­ç­‰'when  fenshu&lt;80 then 'åˆæ ¼' end  as fenshu from t_grade\n</code></pre></div><h1>2. åˆ†ç»„åŠå…¶ç»„å†…æ¯”è¾ƒ</h1>\n<ul>\n<li>å¦‚ï¼šæŸ¥å‡ºæ¯ä¸ªå­¦ç§‘ä½äºå…¶å¹³å‡åˆ†çš„å­¦ç”Ÿç­‰ã€‚é¦–å…ˆæŸ¥è¯¢å‡ºæ¯æ¡è®°å½•å¯¹åº”çš„åˆ†ç»„å‡½æ•°å€¼select * from table t1 left join (select åˆ†ç»„å‡½æ•°(ç»Ÿè®¡å­—æ®µ) as æ¯”è¾ƒå­—æ®µ from table group by åˆ†ç»„å­—æ®µ) t2 on å”¯ä¸€æ¡ä»¶ where æ¯”è¾ƒæ¡ä»¶</li>\n<li>ç”¨ä¸€æ¡sqlè¯­å¥æŸ¥è¯¢å‡ºæ¯ä¸ªå­¦ç§‘ä½äºå…¶å¹³å‡åˆ†çš„å­¦ç”Ÿ/å¹³å‡åˆ†ä½äº60çš„å­¦ç”Ÿ(æŸ¥è¯¢ç»“æœè¡¨å¤´åä¸ºï¼šå§“åã€å­¦ç§‘ã€åˆ†æ•°ã€å­¦ç§‘å¹³å‡åˆ†)</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Select \n\ta.name,a.kemu,a.fenshu,(Select avg(b.fenshu) From score b where a.kemu=b.kemu GROUP BY b.kemu )\nFrom \n\tscore a Where a.fenshu&lt;(Select avg(b.fenshu) From score b where a.kemu=b.kemu GROUP BY b.kemu ) \nGROUP BY \n\ta.kemu\n\nSELECT \n\ta.name,a.kemu,a.fenshu,b.aa\nFROM \n\ttest a,(SELECT kemu,AVG(fenshu) aa FROM test GROUP BY kemu) b\nWHERE a.kemu=b.kemu AND a.fenshu&lt;b.aa\n</code></pre></div><h1>3. éƒ½å¤§äºé—®é¢˜</h1>\n<ul>\n<li>æŸ¥å‡ºæŸæ¡ä»¶ä¸‹éƒ½å¤§äºéƒ½å°äºçš„æ•°æ®ï¼ˆnot inï¼‰</li>\n<li>ç”¨ä¸€æ¡sqlè¯­å¥æŸ¥è¯¢å‡ºæ¯é—¨è¯¾éƒ½å¤§äº80åˆ†çš„å­¦ç”Ÿå§“å</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>SELECT \n\tname,kemu,fenshu \nfrom \n\tt_grade \nwhere name not in(select name from t_grade where fenshu&lt;=80)\n</code></pre></div><h1>4. è¡Œè½¬åˆ—</h1>\n<ul>\n<li>å¦‚ï¼šæŠŠè¡¨ä¸­ç‰¹å®šè¡Œçš„æ•°æ®å»é‡ååšä¸ºåˆ—å;å°†åŒä¸€ä¸ªäººçš„ç§‘ç›®æ˜¾ç¤ºå‡ºæ¥</li>\n<li>åˆ©ç”¨max(case when then)æˆ–è€…sum(case when then)æˆ–è€…sum(IF()) æˆ–è€…max(IF())ï¼šå…ˆå°†æ•°æ®æŒ‰æŸä¸ªæ¡ä»¶åˆ†ç»„ï¼Œç„¶åé€šè¿‡sumæˆ–è€…maxå°†è¡Œè½¬åˆ—ï¼Œä½†æ˜¯é—®é¢˜æ˜¯ï¼Œè¡Œè½¬åˆ—æœ‰é™åˆ¶</li>\n<li>ç”¨ä¸€æ¡sqlè¯­å¥å†™å‡ºå¦‚ä¸‹çš„æŸ¥è¯¢ç»“æœ</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å§“å</th>\n<th style=\"text-align:center\">è¯­æ–‡</th>\n<th style=\"text-align:center\">æ•°å­¦</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å¼ ä¸‰</td>\n<td style=\"text-align:center\">81</td>\n<td style=\"text-align:center\">72</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æå››</td>\n<td style=\"text-align:center\">76</td>\n<td style=\"text-align:center\">90</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç‹äº”</td>\n<td style=\"text-align:center\">81</td>\n<td style=\"text-align:center\">100</td>\n</tr>\n</tbody>\n</table>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>SELECT \n\ta.name 'åˆ†æ•°',a.fenshu 'è¯­æ–‡',b.fenshu 'æ•°å­¦'\nFROM \n\t(SELECT NAME,fenshu FROM test WHERE kemu='è¯­æ–‡') a,\n\t(SELECT NAME,fenshu FROM test WHERE kemu='æ•°å­¦') b\nWHERE \n\ta.name=b.name;\n\nSELECT\n\tname as å§“å,\n\tMAX(\n\t\tCASE \n\t\tWHEN  kemu='è¯­æ–‡' THEN\n\t\t\tfenshu\n\t\tEND\n\t) AS è¯­æ–‡,\n\tMAX(\n\t\tCASE \n\t\tWHEN kemu='æ•°å­¦' THEN\n\t\t\tfenshu\n\t\tEND\n\t) AS æ•°å­¦ \nFROM\n\tt_grade\nGROUP BY name\n</code></pre></div><h1>5. åˆ—è½¬è¡Œ</h1>\n<ul>\n<li>å¦‚ï¼šæŠŠè¡¨ä¸­ç‰¹å®šåˆ—åšä¸ºæ¯ä¸€è¡Œæ•°æ®å¯¹åº”è¡Œçš„å€¼ï¼ˆunionï¼‰</li>\n<li>å°†ä¸Šé¢çš„ç»“æœå˜å›ä¾‹å­çš„æ ·å­</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>select name, 'è¯­æ–‡' kemu , è¯­æ–‡ as SCORE from t_grade\nunion select name, 'æ•°å­¦' kemu, æ•°å­¦ as SCORE from t_grade\nunion select name, 'è‹±è¯­' kemu, è‹±è¯­ as SCORE from t_grade\norder by name,kemu;\n</code></pre></div><h1>6. top-né—®é¢˜</h1>\n<ul>\n<li>\n<p>å¦‚ï¼šæ±‚å‡ºç¬¬äºŒ(n)é«˜/ä½çš„è–ªæ°´</p>\n</li>\n<li>\n<p>å¦‚æœæ˜¯æ‰¾ç¬¬äºŒé«˜ä¹‹ç±»çš„é—®é¢˜ï¼šselect max(distinct å­—æ®µ) from table where å­—æ®µ&lt; (select max(distinct å­—æ®µ) from table group by åˆ†ç»„å­—æ®µ) where æ¡ä»¶</p>\n</li>\n<li>\n<p>å¦‚æœæ˜¯æ‰¾ç¬¬né«˜çš„é—®é¢˜ï¼šselect distinct å­—æ®µ FROM table t1 where (SELECT count(distinct å­—æ®µ) from table t2 WHERE t2.å­—æ®µ &gt; t1.å­—æ®µ) = n-1</p>\n</li>\n<li>\n<p>å¦‚æœæ˜¯æ‰¾å‰né«˜çš„é—®é¢˜ï¼šselect distinct å­—æ®µ from table t1 where (select count(distinct å­—æ®µ) from table t2 where t2.å­—æ®µ &gt; t1.å­—æ®µ)&lt; n</p>\n</li>\n<li>\n<p>å¦‚æœæ˜¯æ‰¾å½“å‰è®°å½•å¤„äºç¬¬å‡ çš„é—®é¢˜ï¼šselect å­—æ®µ,(select count(distinct å­—æ®µ) from table t2 where t2.å­—æ®µ &gt;= t1.å­—æ®µ) from Scores t1 order by å­—æ®µ DESC</p>\n</li>\n<li>\n<p>Employee è¡¨åŒ…å«æ‰€æœ‰å‘˜å·¥ä¿¡æ¯ï¼Œæ¯ä¸ªå‘˜å·¥æœ‰å…¶å¯¹åº”çš„å·¥å· Idï¼Œå§“å Nameï¼Œå·¥èµ„ Salary å’Œéƒ¨é—¨ç¼–å· DepartmentId</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Id</th>\n<th style=\"text-align:center\">Name</th>\n<th style=\"text-align:center\">Salary</th>\n<th style=\"text-align:center\">DepartmentId</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">Joe</td>\n<td style=\"text-align:center\">85000</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">Henry</td>\n<td style=\"text-align:center\">80000</td>\n<td style=\"text-align:center\">2</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">Sam</td>\n<td style=\"text-align:center\">60000</td>\n<td style=\"text-align:center\">2</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">Max</td>\n<td style=\"text-align:center\">90000</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">Janet</td>\n<td style=\"text-align:center\">69000</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">6</td>\n<td style=\"text-align:center\">Randy</td>\n<td style=\"text-align:center\">85000</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">Will</td>\n<td style=\"text-align:center\">70000</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>Department è¡¨åŒ…å«å…¬å¸æ‰€æœ‰éƒ¨é—¨çš„ä¿¡æ¯ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">Id</th>\n<th style=\"text-align:center\">Name</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">IT</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">Sales</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œæ‰¾å‡ºæ¯ä¸ªéƒ¨é—¨è·å¾—å‰ä¸‰é«˜å·¥èµ„çš„æ‰€æœ‰å‘˜å·¥</li>\n</ul>\n<p>|Department|Employee|Salary|<br>\n|:-ğŸ˜:-ğŸ˜:-ğŸ˜:-ğŸ˜<br>\n|IT|Max|90000|<br>\n|IT|Randy|85000|<br>\n|IT|Joe|85000|<br>\n|IT|Will|70000|<br>\n|Sales|Henry|80000|<br>\n|Sales|Sam| 60000|</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>SELECT\n\td.NAME AS Department,\n\te.NAME AS Employee,\n\te.Salary AS Salary \nFROM\n\temployee e\n\tLEFT JOIN Department d ON d.id = e.DepartmentId \nWHERE\n\te.id IN (\n\tSELECT\n\t\te1.id \n\tFROM\n\t\tEmployee e1\n\t\tLEFT JOIN Employee e2 ON e2.DepartmentId = e1.DepartmentId \n\t\tAND e2.Salary &gt; e1.Salary \n\tGROUP BY\n\t\te1.Id \n\tHAVING\n\t\tcount( DISTINCT e2.Salary ) &lt;= 2 --é€‰å–topå‡ \n\t) \nand e.DepartmentId in (select Id from Department) è¡¥å…¨æ•°æ®ï¼Œä¸ç”¨è¡¥å…¨çš„è¯ä¸ç”¨åŠ ä¸Šè¿™å¥\nORDER BY\n\td.Id ASC,\n\te.Salary DESC\n</code></pre></div><ul>\n<li>ç¼–å†™ä¸€ä¸ª SQL æŸ¥è¯¢ï¼Œè·å– Employee è¡¨ä¸­ç¬¬äºŒé«˜çš„è–ªæ°´ï¼ˆSalaryï¼‰</li>\n<li>ä¾‹å¦‚ä¸Šè¿° Employee è¡¨ï¼ŒSQLæŸ¥è¯¢åº”è¯¥è¿”å› 200 ä½œä¸ºç¬¬äºŒé«˜çš„è–ªæ°´ã€‚å¦‚æœä¸å­˜åœ¨ç¬¬äºŒé«˜çš„è–ªæ°´ï¼Œé‚£ä¹ˆæŸ¥è¯¢åº”è¿”å› null</li>\n</ul>\n<h1>7. åˆ é™¤é‡å¤æ•°æ®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>-- åˆ é™¤å¤šä½™çš„é‡å¤è®°å½•(å¤šä¸ªå­—æ®µ)ï¼Œåªä¿ç•™æœ€å°idçš„è®°å½•\nDELETE FROM student WHERE id IN (\n    SELECT * FROM (\n        SELECT id FROM student WHERE (stuno,stuname) -- æ³¨æ„ï¼šæ­¤å¤„ä¸€å®šè¦åŠ æ‹¬å·ï¼Œå½“æˆè”åˆå­—æ®µæ¥å¤„ç†\n        IN (\n            -- æŸ¥æ‰¾å­¦å·å’Œå§“åå‡é‡å¤çš„å­¦ç”Ÿä¿¡æ¯\n            SELECT stuno,stuname FROM student GROUP BY stuno,stuname HAVING COUNT(1) &gt; 1\n        ) AND id NOT IN (\n            -- æŸ¥è¯¢æœ€å°idçš„è®°å½•\n            SELECT MIN(id) FROM student GROUP BY stuno,stuname HAVING COUNT(1) &gt; 1\n        )\n    ) AS stu_repeat_copy\n\n);\n</code></pre></div><h1>8. æŸ¥æ‰¾æ¯ä¸ªå­¦ç§‘åˆ†æ•°ä½äº60çš„äººæ•°</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>CREATE TABLE `xueke`  (\n  `id` int(11) NOT NULL AUTO_INCREMENT,\n  `tid` int(11) NULL DEFAULT NULL,\n  `sid` int(11) NULL DEFAULT NULL,\n  `name` varchar(255) CHARACTER SET utf8mb4 COLLATE utf8mb4_general_ci NULL DEFAULT NULL,\n  `score` int(11) NULL DEFAULT NULL,\n  PRIMARY KEY (`id`) USING BTREE\n) ENGINE = InnoDB AUTO_INCREMENT = 8 CHARACTER SET = latin1 COLLATE = latin1_swedish_ci ROW_FORMAT = Compact;\n\n-- </code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "é¢è¯•"
      ]
    },
    {
      "title": "ç½‘å€æ”¶è—",
      "url": "https://javaguide.cn/resource/%E7%BD%91%E5%9D%80%E6%94%B6%E8%97%8F.html",
      "id": "https://javaguide.cn/resource/%E7%BD%91%E5%9D%80%E6%94%B6%E8%97%8F.html",
      "summary": "ç½‘å€æ”¶è— ç½‘å€æ”¶è—",
      "content_html": "<p>ç½‘å€æ”¶è—</p>\n<!--more-->\n<h1>ç½‘å€æ”¶è—</h1>\n<pre><code>å‰ç«¯æŠ€æœ¯:\njqueryå®˜ç½‘:https://jquery.com/\nboostrapå®˜ç½‘:http://v3.bootcss.com/\nboostrapæ•™ç¨‹:https://www.runoob.com/bootstrap/bootstrap-grid-system.html\njqueryçš„ztreeä¸‹è½½:http://www.treejs.cn/v3/main.php#_zTreeInfo\njqueryçš„ztreeæ–‡æ¡£:http://www.treejs.cn/v3/api.php\nvue.jsçš„å®˜ç½‘:https://cn.vuejs.org/\nvuexçš„å®˜ç½‘:https://vuex.vuejs.org/zh/guide/\nnode.jså®˜ç½‘:https://nodejs.org/en/\nknockout.jså®˜ç½‘:http://knockoutjs.com/\nes5å®˜æ–¹æ–‡æ¡£:http://lzw.me/pages/ecmascript/#356\nwebpack(å‰ç«¯è‡ªåŠ¨åŒ–æ„å»ºçš„å·¥å…·)å®˜ç½‘:https://webpack.github.io/\nVue-Routerå®˜ç½‘:https://router.vuejs.org/\nanimate.csså®˜ç½‘:https://daneden.github.io/animate.css/\nnpmå®˜ç½‘:https://www.npmjs.com/\ncnpmï¼ˆæ·˜å®é•œåƒï¼‰å®˜ç½‘:http://npm.taobao.org/\nMintUIå®˜ç½‘:http://mint-ui.github.io/#!/zh-cn\nMUIå®˜ç½‘:http://www.dcloud.io/mui.html\nhighchartså®˜ç½‘:http://www.hcharts.cn/\neasy-ui(ç®€æ˜“uiå®ç°)å®˜ç½‘:http://www.jeasyui.com/\neasy-uiæ•™ç¨‹:http://www.jeasyui.net/tutorial/\nelectronå®˜ç½‘:https://electronjs.org/docs\njqueryæ¨¡æ¿:http://www.17sucai.com/\næ¨¡æ¿å¼•æ“art-templateå®˜ç½‘:http://aui.github.io/art-template/\nexpressï¼ˆnode.jsçš„webæ¡†æ¶ï¼‰å®˜ç½‘:http://expressjs.com/å’Œhttp://www.expressjs.com.cn/\n\nå¯Œæ–‡æœ¬ç¼–è¾‘å™¨KindEditor:http://kindeditor.net\nCKEditor:http://ckeditor.com/\nç™¾åº¦ç¼–è¾‘å™¨UEditor:http://ueditor.baidu.com/website/\n\nant-desgin: https://ant.design/index-cn\nå›¾ç‰‡æœåŠ¡å™¨:\næ¨¡æ¿å¼•æ“:https://freemarker.apache.org/\n\n\næŠ€æœ¯ç¤¾åŒº:\nCSDNå®˜ç½‘:https://www.csdn.net/\næ…•è¯¾ç½‘:https://www.imooc.com/\nç‰›å®¢ç½‘:https://www.nowcoder.com/\njavaå¼€æºè½¯ä»¶:http://www.oschina.net/project/lang/19/java/\nité¢è¯•ç½‘:http://www.itmian4.com/\nLeetCode:https://leetcode.com/\n\nJava\njdk1.8ä¸‹è½½:http://www.oracle.com/technetwork/java/javase/downloads/jdk8-downloads-2133151.html\ntomcatå®˜ç½‘:http://tomcat.apache.org/\nmavenå®˜ç½‘:http://maven.apache.org/\nspringå®˜ç½‘:https://spring.io/\nswaggerå®˜ç½‘:https://swagger.io/\ncommons-ioæ“ä½œæ–‡ä»¶:http://commons.apache.org/proper/commons-io/\nC3p0å®˜ç½‘:https://www.mchange.com/projects/c3p0/\nDBCPå®˜ç½‘:http://commons.apache.org/proper/commons-dbcp/index.html\nDBUtils:https://commons.apache.org/proper/commons-dbutils/examples.html\ndom4jå®˜ç½‘(è§£æxml):https://dom4j.github.io/\nssmså®˜ç½‘:https://download.microsoft.com/download/C/3/D/C3DBFF11-C72E-429A-A861-4C316524368F/SSMS-Setup-CHS.exe\nshiroå®˜ç½‘:http://shiro.apache.org/\njFinalå®˜ç½‘:https://www.jfinal.com/doc\n\npinyin4jå®˜ç½‘:http://pinyin4j.sourceforge.net/\nluceneå®˜ç½‘:https://lucene.apache.org/\nehcacheç¼“å­˜å®˜ç½‘:http://www.ehcache.org/\nPOI(officeæ–‡ä»¶è¯»å†™)å®˜ç½‘:http://poi.apache.org/\nquartzå®˜ç½‘:http://www.quartz-scheduler.org/\njd-guiå®˜ç½‘:http://jd.benow.ca/\napache cxfï¼šhttp://cxf.apache.org/\nwebserviceå®˜ç½‘:http://ws.apache.org/\nhibernateå®˜ç½‘:http://hibernate.org/\nzookeeperå®˜ç½‘:https://zookeeper.apache.org/\n\n\næ•°æ®åº“:\nmysqlä¸‹è½½:https://www.mysql.com/downloads/\noracleä¸‹è½½:https://www.oracle.com/index.html\nsql serverå®˜ç½‘:https://www.microsoft.com/en-us/sql-server/sql-server-downloads-free-trial\nmongodbå®˜ç½‘:https://www.mongodb.com/\nmonggooseå®˜ç½‘:http://mongoosejs.com/\nmycatå®˜ç½‘:http://www.mycat.io/\noracleå®˜ç½‘:https://www.oracle.com/index.html\n\nä¸­é—´ä»¶:\nactivemqå®˜ç½‘:http://activemq.apache.org/\nemqå®˜ç½‘:https://www.emqx.com/zh\nNginxå®˜ç½‘:http://nginx.org/\ndubboå®˜ç½‘:http://dubbo.apache.org\n\nç‰ˆæœ¬ç®¡ç†:\nGitå®˜ç½‘:https://git-scm.com/\nmavenç§æœæ­å»º:https://www.cnblogs.com/likehua/p/4552620.html\n\nlinux:\ncentoså®˜ç½‘:https://www.centos.org\njavaçš„jschè¿æ¥linuxå·¥å…·:http://www.jcraft.com/jsch/\n\nå¸®åŠ©æ–‡æ¡£:\nèœé¸Ÿæ•™ç¨‹:http://www.runoob.com\nåœ¨çº¿apiæ–‡æ¡£:http://tool.oschina.net/apidocs/\nspringbootå®˜ç½‘:https://spring.io/projects/spring-boot\nåœ¨çº¿httpæ¥å£æµ‹è¯•å·¥å…·http://www.atool.org/httptest.php\njdkçš„ç‰ˆæœ¬åŒºåˆ«æ–‡æ¡£:https://docs.oracle.com/javase/specs/\nhtmlè½¬ä¹‰å­—ç¬¦å¯¹ç…§è¡¨:https://tool.oschina.net/commons?type=2\njavaseå®˜ç½‘:https://docs.oracle.com/javase/specs/\n\nå·¥å…·:\nwinscpå®˜ç½‘:https://winscp.net/eng/docs/lang:chs\nputtyå®˜ç½‘:https://www.chiark.greenend.org.uk/~sgtatham/putty/\nç™¾åº¦ç½‘ç›˜æ— é™åˆ¶ä¸‹è½½:http://pandownload.com/\neverythingä¸‹è½½:http://www.voidtools.com/\neclipseå®˜ç½‘:https://www.eclipse.org/\n\nSpringæ–‡æ¡£\næ•´åˆStruts2.x:https://struts.apache.org/plugins/spring/\næ•´åˆhibernateä»¥åŠSpring4.0æ–‡æ¡£:https://docs.spring.io/autorepo/docs/spring-framework/4.1.8.RELEASE/spring-framework-reference/pdf/spring-framework-reference.pdf\næ•´åˆmybatis:http://www.mybatis.org/spring/zh/getting-started.html\nspringbootæ•´åˆmybatis:http://www.mybatis.org/spring-boot-starter/mybatis-spring-boot-autoconfigure/(ä¸¤ä¸ªmybatisæ•´åˆåŒ…ä¸èƒ½åŒæ—¶ä½¿ç”¨!)\n\nä¹¦ç±æŸ¥è¯¢\nç å†œç½‘:http://www.codeceo.com/\n</code></pre>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç½‘å€æ”¶è—"
      ]
    },
    {
      "title": "Swagger",
      "url": "https://javaguide.cn/backend/apidocumentation/swagger.html",
      "id": "https://javaguide.cn/backend/apidocumentation/swagger.html",
      "summary": "æœ€å¥½çš„APIä½¿ç”¨Swaggerå·¥å…·æ„å»º 1. springbootæ•´åˆswagger2 2. swaggerä¸»è¦æ³¨è§£çš„è¯´æ˜",
      "content_html": "<p>æœ€å¥½çš„APIä½¿ç”¨Swaggerå·¥å…·æ„å»º</p>\n<!--more-->\n<h1>1. springbootæ•´åˆswagger2</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼å…¥swaggerä¾èµ–ï¼ˆåœ¨mavené¡¹ç›®pom.xmlä¸­æ·»åŠ ä»¥ä¸‹ä¾èµ–ï¼‰\n&lt;dependency&gt;\n    &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n    &lt;artifactId&gt;springfox-swagger2&lt;/artifactId&gt;\n    &lt;version&gt;2.9.2&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;io.springfox&lt;/groupId&gt;\n    &lt;artifactId&gt;springfox-swagger-ui&lt;/artifactId&gt;\n    &lt;version&gt;2.9.2&lt;/version&gt;\n&lt;/dependency&gt;\nåœ¨ä¸»ç¨‹åºä¸­æ·»åŠ @EnableSwagger2\n@SpringBootApplication\n@EnableSwagger2\npublic class MainApplication {\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(MainApplication.class, args);\n\t}\n}\n\nåœ¨éœ€è¦apiçš„ç±»ä¸Šé¢æ·»åŠ æ³¨è§£\n@RestController\n@Api(tags = \"UserinfoCtrl\", description = \"ç”¨æˆ·ä¿¡æ¯ç›¸å…³\")  \npublic class testswaggercontroller {\n\t@RequestMapping(\"/testswagger\")\n\t@ApiOperation(value = \"è·å–ç”¨æˆ·ä¿¡æ¯\", httpMethod = \"GET\", notes = \"æ˜¾ç¤ºç”¨æˆ·ä¿¡æ¯\")  \n\tpublic Map&lt;String, Object&gt; fun() {\n\t\tMap&lt;String , Object&gt; result=new HashMap&lt;String,Object&gt;();\n\t\tresult.put(\"test\", \"test\");\n\t\tDemo demo=new Demo(\"junye\", \"1\");\n\t\tresult.put(\"Demo\", demo);\n\t\tSystem.out.println(\"chenggong\");\n\t\treturn result;\n\t}\n}\næµ‹è¯•æ˜¯å¦ç”Ÿæˆäº†apiï¼šæµè§ˆå™¨è®¿é—®ï¼šlocalhost:8080/swagger-ui.html#\n</code></pre></div><h1>2. swaggerä¸»è¦æ³¨è§£çš„è¯´æ˜</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Apiç”¨åœ¨ç±»ä¸Šï¼Œè¯´æ˜è¯¥ç±»çš„ä½œç”¨ã€‚å¯ä»¥æ ‡è®°ä¸€ä¸ªControllerç±»åšä¸ºswaggeræ–‡æ¡£èµ„æº\n@Api(value = \"/user\", description = \"Operations about user\")\nvalue:urlçš„è·¯å¾„å€¼\ntags:å¦‚æœè®¾ç½®è¿™ä¸ªå€¼ã€valueçš„å€¼ä¼šè¢«è¦†ç›–\ndescription:å¯¹apièµ„æºçš„æè¿°\nbasePath:åŸºæœ¬è·¯å¾„å¯ä»¥ä¸é…ç½®\nposition:å¦‚æœé…ç½®å¤šä¸ªApi æƒ³æ”¹å˜æ˜¾ç¤ºçš„é¡ºåºä½ç½®\nproduces:For example, \"application/json, application/xml\"\nconsumes:For example, \"application/json, application/xml\"\nauthorizations:é«˜çº§ç‰¹æ€§è®¤è¯æ—¶é…ç½®\nhidden:é…ç½®ä¸ºtrue å°†åœ¨æ–‡æ¡£ä¸­éšè—\n\nApiOperationï¼šç”¨åœ¨æ–¹æ³•ä¸Šï¼Œè¯´æ˜æ–¹æ³•çš„ä½œç”¨ï¼Œæ¯ä¸€ä¸ªurlèµ„æºçš„å®šä¹‰,ä¸Controllerä¸­çš„æ–¹æ³•å¹¶åˆ—ä½¿ç”¨ã€‚\n@ApiOperation(\nvalue = \"Find purchase order by ID\",\nnotes = \"\",\nresponse = Order,\ntags = {\"Pet Store\"})\nvalue:urlçš„è·¯å¾„å€¼\ntags:å¦‚æœè®¾ç½®è¿™ä¸ªå€¼ã€valueçš„å€¼ä¼šè¢«è¦†ç›–\ndescription:å¯¹apièµ„æºçš„æè¿°\nposition:å¦‚æœé…ç½®å¤šä¸ªApi æƒ³æ”¹å˜æ˜¾ç¤ºçš„é¡ºåºä½ç½®\nproduces:For example, \"application/json, application/xml\"\nconsumes:For example, \"application/json, application/xml\"\nprotocols:Possible values: http, https, ws, wss.\nauthorizations:é«˜çº§ç‰¹æ€§è®¤è¯æ—¶é…ç½®\nhidden:é…ç½®ä¸ºtrue å°†åœ¨æ–‡æ¡£ä¸­éšè—\nresponse:è¿”å›çš„å¯¹è±¡\nresponseContainer:è¿™äº›å¯¹è±¡æ˜¯æœ‰æ•ˆçš„ \"List\", \"Set\" or \"Map\".ï¼Œå…¶ä»–æ— æ•ˆ\nhttpMethod:\"GET\", \"HEAD\", \"POST\", \"PUT\", \"DELETE\", \"OPTIONS\" and \"PATCH\"\ncode:httpçš„çŠ¶æ€ç  é»˜è®¤ 200\nextensions:æ‰©å±•å±æ€§\n\nApiParamè¯·æ±‚å±æ€§,ä¸Controllerä¸­çš„æ–¹æ³•å¹¶åˆ—ä½¿ç”¨ã€‚\npublic ResponseEntity&lt;User&gt; createUser(@RequestBody @ApiParam(value = \"Created user object\")\nname:å±æ€§åç§°\nvalue:å±æ€§å€¼\ndefaultValue:é»˜è®¤å±æ€§å€¼\nallowableValues:å¯ä»¥ä¸é…ç½®\nrequired:æ˜¯å¦å±æ€§å¿…å¡«\naccess\t:ä¸è¿‡å¤šæè¿°\nallowMultiple:\té»˜è®¤ä¸ºfalse\nhidden:éšè—è¯¥å±æ€§\nexample:ä¸¾ä¾‹å­\n\nApiResponseï¼šå“åº”é…ç½®ï¼Œä¸Controllerä¸­çš„æ–¹æ³•å¹¶åˆ—ä½¿ç”¨\n@ApiResponse(code = 400, message = \"Invalid user supplied\")\ncode:httpçš„çŠ¶æ€ç \nmessage:æè¿°\nresponse:é»˜è®¤å“åº”ç±» Void\nreference:å‚è€ƒApiOperationä¸­é…ç½®\nresponseHeaders:å‚è€ƒ ResponseHeader å±æ€§é…ç½®è¯´æ˜\nresponseContainer:å‚è€ƒApiOperationä¸­é…ç½®\n\nApiResponses ä¸Controllerä¸­çš„æ–¹æ³•å¹¶åˆ—ä½¿ç”¨ApiResponsesï¼šå“åº”é›†é…ç½®ï¼Œä½¿ç”¨æ–¹å¼ï¼šåªæœ‰valueå±æ€§\n@ApiResponses({ @ApiResponse(code = 400, message = \"Invalid Order\") })\n\nResponseHeader ä¸Controllerä¸­çš„æ–¹æ³•å¹¶åˆ—ä½¿ç”¨å“åº”å¤´è®¾ç½®\n@ResponseHeader(name=\"head1\",description=\"response head conf\")\nname:å“åº”å¤´åç§°\ndescription:å¤´æè¿°\nresponse:é»˜è®¤å“åº”ç±» Void\nresponseContainer:å‚è€ƒApiOperationä¸­é…ç½®\n\nå…¶ä»–\n@ApiImplicitParamsï¼šç”¨åœ¨æ–¹æ³•ä¸ŠåŒ…å«ä¸€ç»„å‚æ•°è¯´æ˜ï¼›\n@ApiImplicitParamï¼šç”¨åœ¨@ApiImplicitParamsæ³¨è§£ä¸­ï¼ŒæŒ‡å®šä¸€ä¸ªè¯·æ±‚å‚æ•°çš„å„ä¸ªæ–¹é¢\nparamTypeï¼šå‚æ•°æ”¾åœ¨å“ªä¸ªåœ°æ–¹\nnameï¼šå‚æ•°ä»£è¡¨çš„å«ä¹‰\nvalueï¼šå‚æ•°åç§°\ndataTypeï¼š å‚æ•°ç±»å‹ï¼Œæœ‰String/intï¼Œæ— ç”¨\nrequired ï¼š æ˜¯å¦å¿…è¦\ndefaultValueï¼šå‚æ•°çš„é»˜è®¤å€¼\n@ApiResponsesï¼šç”¨äºè¡¨ç¤ºä¸€ç»„å“åº”ï¼›\n@ApiResponseï¼šç”¨åœ¨@ApiResponsesä¸­ï¼Œä¸€èˆ¬ç”¨äºè¡¨è¾¾ä¸€ä¸ªé”™è¯¯çš„å“åº”ä¿¡æ¯ï¼›\ncodeï¼š å“åº”ç (intå‹)ï¼Œå¯è‡ªå®šä¹‰\nmessageï¼šçŠ¶æ€ç å¯¹åº”çš„å“åº”ä¿¡æ¯\n@ApiModelï¼šæè¿°ä¸€ä¸ªModelçš„ä¿¡æ¯ï¼ˆè¿™ç§ä¸€èˆ¬ç”¨åœ¨poståˆ›å»ºçš„æ—¶å€™ï¼Œ\nä½¿ç”¨@RequestBodyè¿™æ ·çš„åœºæ™¯ï¼Œè¯·æ±‚å‚æ•°æ— æ³•ä½¿ç”¨@ApiImplicitParamæ³¨è§£è¿›è¡Œæè¿°çš„æ—¶å€™ï¼›\n@ApiModelPropertyï¼šæè¿°ä¸€ä¸ªmodelçš„å±æ€§ã€‚\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "nginx",
      "url": "https://javaguide.cn/backend/apigateway/nginx.html",
      "id": "https://javaguide.cn/backend/apigateway/nginx.html",
      "summary": "1. ä»€ä¹ˆæ˜¯nginx? Nginxæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„http æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ã€‚ ç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆIgor Sysoevæ‰€å¼€å‘ï¼Œå®˜æ–¹æµ‹è¯•nginxèƒ½å¤Ÿæ”¯æ”¯æ’‘5ä¸‡å¹¶å‘é“¾æ¥ï¼Œå¹¶ä¸”cpuã€å†…å­˜ç­‰èµ„æºæ¶ˆè€—å´éå¸¸ä½ï¼Œè¿è¡Œéå¸¸ç¨³å®šã€‚è€Œä¸”å¯ä»¥è´Ÿè½½å‡è¡¡ 2. åº”ç”¨åœºæ™¯ httpæœåŠ¡å™¨ã€‚Nginxæ˜¯ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥ç‹¬...",
      "content_html": "\n<ul>\n<li>Nginxæ˜¯ä¸€æ¬¾é«˜æ€§èƒ½çš„http æœåŠ¡å™¨/åå‘ä»£ç†æœåŠ¡å™¨åŠç”µå­é‚®ä»¶ï¼ˆIMAP/POP3ï¼‰ä»£ç†æœåŠ¡å™¨ã€‚</li>\n<li>ç”±ä¿„ç½—æ–¯çš„ç¨‹åºè®¾è®¡å¸ˆIgor Sysoevæ‰€å¼€å‘ï¼Œå®˜æ–¹æµ‹è¯•nginxèƒ½å¤Ÿæ”¯æ”¯æ’‘5ä¸‡å¹¶å‘é“¾æ¥ï¼Œå¹¶ä¸”cpuã€å†…å­˜ç­‰èµ„æºæ¶ˆè€—å´éå¸¸ä½ï¼Œè¿è¡Œéå¸¸ç¨³å®šã€‚è€Œä¸”å¯ä»¥è´Ÿè½½å‡è¡¡</li>\n</ul>\n<h1>2. åº”ç”¨åœºæ™¯</h1>\n<ul>\n<li>httpæœåŠ¡å™¨ã€‚Nginxæ˜¯ä¸€ä¸ªhttpæœåŠ¡å¯ä»¥ç‹¬ç«‹æä¾›httpæœåŠ¡ã€‚å¯ä»¥åšç½‘é¡µé™æ€æœåŠ¡å™¨ã€‚</li>\n<li>è™šæ‹Ÿä¸»æœºã€‚å¯ä»¥å®ç°åœ¨ä¸€å°æœåŠ¡å™¨è™šæ‹Ÿå‡ºå¤šä¸ªç½‘ç«™ã€‚ä¾‹å¦‚ä¸ªäººç½‘ç«™ä½¿ç”¨çš„è™šæ‹Ÿä¸»æœºã€‚</li>\n<li>åå‘ä»£ç†ï¼Œè´Ÿè½½å‡è¡¡ã€‚å½“ç½‘ç«™çš„è®¿é—®é‡è¾¾åˆ°ä¸€å®šç¨‹åº¦åï¼Œå•å°æœåŠ¡å™¨ä¸èƒ½æ»¡è¶³ç”¨æˆ·çš„è¯·æ±‚æ—¶ï¼Œéœ€è¦ç”¨å¤šå°æœåŠ¡å™¨é›†ç¾¤å¯ä»¥ä½¿ç”¨nginxåšåå‘ä»£ç†ã€‚å¹¶ä¸”å¤šå°æœåŠ¡å™¨å¯ä»¥å¹³å‡åˆ†æ‹…è´Ÿè½½ï¼Œä¸ä¼šå› ä¸ºæŸå°æœåŠ¡å™¨è´Ÿè½½é«˜å®•æœºè€ŒæŸå°æœåŠ¡å™¨é—²ç½®çš„æƒ…å†µã€‚</li>\n</ul>\n<h1>3. nginxå®‰è£…</h1>\n<ul>\n<li>ä¸‹è½½nginxï¼šå®˜æ–¹ç½‘ç«™ï¼š<a href=\"http://nginx.org/,1.8.0%E7%89%88%E6%9C%AC%E3%80%82Nginx%E6%8F%90%E4%BE%9B%E7%9A%84%E6%BA%90%E7%A0%81%E5%AE%89%E8%A3%85\" target=\"_blank\" rel=\"noopener noreferrer\">http://nginx.org/,1.8.0ç‰ˆæœ¬ã€‚Nginxæä¾›çš„æºç å®‰è£…</a></li>\n<li>ç¯å¢ƒå®‰è£…\n<ul>\n<li>gccç¯å¢ƒ:yum install gcc-c++</li>\n<li>PCRE(Perl Compatible Regular Expressions)æ˜¯ä¸€ä¸ªPerlåº“ï¼ŒåŒ…æ‹¬ perl å…¼å®¹çš„æ­£åˆ™è¡¨è¾¾å¼åº“ã€‚nginxçš„httpæ¨¡å—ä½¿ç”¨pcreæ¥è§£ææ­£åˆ™è¡¨è¾¾å¼ï¼Œæ‰€ä»¥éœ€è¦åœ¨linuxä¸Šå®‰è£…pcreåº“ã€‚pcre-develæ˜¯ä½¿ç”¨pcreå¼€å‘çš„ä¸€ä¸ªäºŒæ¬¡å¼€å‘åº“ã€‚nginxä¹Ÿéœ€è¦æ­¤åº“ã€‚yum install -y pcre pcre-devel</li>\n<li>zlibåº“:æä¾›äº†å¾ˆå¤šç§å‹ç¼©å’Œè§£å‹ç¼©çš„æ–¹å¼ï¼Œnginxä½¿ç”¨zlibå¯¹httpåŒ…çš„å†…å®¹è¿›è¡Œgzipï¼Œæ‰€ä»¥éœ€è¦åœ¨linuxä¸Šå®‰è£…zlibåº“ã€‚yum install -y zlib zlib-devel</li>\n<li>OpenSSL æ˜¯ä¸€ä¸ªå¼ºå¤§çš„å®‰å…¨å¥—æ¥å­—å±‚å¯†ç åº“ï¼Œå›Šæ‹¬ä¸»è¦çš„å¯†ç ç®—æ³•ã€å¸¸ç”¨çš„å¯†é’¥å’Œè¯ä¹¦å°è£…ç®¡ç†åŠŸèƒ½åŠSSLåè®®ï¼Œå¹¶æä¾›ä¸°å¯Œçš„åº”ç”¨ç¨‹åºä¾›æµ‹è¯•æˆ–å…¶å®ƒç›®çš„ä½¿ç”¨ã€‚nginxä¸ä»…æ”¯æŒhttpåè®®ï¼Œè¿˜æ”¯æŒhttpsï¼ˆå³åœ¨sslåè®®ä¸Šä¼ è¾“httpï¼‰ï¼Œæ‰€ä»¥éœ€è¦åœ¨linuxå®‰è£…opensslåº“ã€‚yum install -y openssl openssl-devel</li>\n</ul>\n</li>\n<li>æ­£å¼å®‰è£…\n<ul>\n<li>ç¬¬ä¸€æ­¥ï¼šæŠŠnginxçš„æºç åŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿ</li>\n<li>ç¬¬äºŒæ­¥ï¼šè§£å‹ç¼©[root@localhost ~]# tar zxf nginx-1.8.0.tar.gz</li>\n<li>ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨configureå‘½ä»¤åˆ›å»ºmakeFileæ–‡ä»¶ï¼Œæ‰§è¡Œä¸‹é¢ä¸€å¤§è¡Œ</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\t./configure \\\n\t--prefix=/usr/local/nginx \\\n\t--pid-path=/var/run/nginx/nginx.pid \\\n\t--lock-path=/var/lock/nginx.lock \\\n\t--error-log-path=/var/log/nginx/error.log \\\n\t--http-log-path=/var/log/nginx/access.log \\\n\t--with-http_gzip_static_module \\\n\t--http-client-body-temp-path=/var/temp/nginx/client \\\n\t--http-proxy-temp-path=/var/temp/nginx/proxy \\\n\t--http-fastcgi-temp-path=/var/temp/nginx/fastcgi \\\n\t--http-uwsgi-temp-path=/var/temp/nginx/uwsgi \\\n\t--http-scgi-temp-path=/var/temp/nginx/scgi\n\tæ³¨æ„ï¼šå¯åŠ¨nginxä¹‹å‰ï¼Œä¸Šè¾¹å°†ä¸´æ—¶æ–‡ä»¶ç›®å½•æŒ‡å®šä¸º/var/temp/nginxï¼Œéœ€è¦åœ¨/varä¸‹åˆ›å»ºtempåŠnginxç›®å½•\n\tmkdir /var/temp/nginx/client -p\n</code></pre></div><pre><code>- ç¬¬å››æ­¥ï¼šmake\n- ç¬¬äº”æ­¥ï¼šmake install\n- å¯åŠ¨nginx è¿›å…¥/usr/local/nginx/sbinç›®å½•[root@localhost sbin]# ./nginx -c /nginx.conf\n- æŒ‡å®šé…ç½®æ–‡ä»¶å¯åŠ¨:/usr/local/nginx/sbin/nginx -c /usr/local/nginx/conf/nginx.conf\n- æŸ¥æ‰¾nginxæ˜¯å¦å­˜åœ¨ps aux|grep nginx\n- å…³é—­nginxï¼š[root@localhost sbin]# ./nginx -s stop\n- æ¨èä½¿ç”¨ï¼š[root@localhost sbin]# ./nginx -s quit\n- é‡å¯nginxï¼š1ã€å…ˆå…³é—­åå¯åŠ¨ã€‚2ã€åˆ·æ–°é…ç½®æ–‡ä»¶ï¼š[root@localhost sbin]# ./nginx -s reload\n</code></pre>\n<ul>\n<li>è®¿é—®nginx:<a href=\"http://192.168.25.135:80/\" target=\"_blank\" rel=\"noopener noreferrer\">http://192.168.25.135:80/</a> é»˜è®¤æ˜¯80ç«¯å£ã€‚æ³¨æ„ï¼šæ˜¯å¦å…³é—­é˜²ç«å¢™ã€‚</li>\n<li>æŸ¥çœ‹nginxé…ç½®æ–‡ä»¶ï¼šnginx -t</li>\n</ul>\n<h1>4. nginx.confé…ç½®</h1>\n<h2>é…ç½®è™šæ‹Ÿä¸»æœº(serverèŠ‚ç‚¹)</h2>\n<ul>\n<li>åœ¨ä¸€å°æœåŠ¡å™¨å¯åŠ¨å¤šä¸ªç½‘ç«™ã€‚å¦‚ä½•åŒºåˆ†ä¸åŒçš„ç½‘ç«™?:1åŸŸåä¸åŒ2ç«¯å£ä¸åŒ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€šè¿‡ç«¯å£listenåŒºåˆ†ä¸åŒè™šæ‹Ÿæœº\nhttp {\t\n\tserver {//ä¸€ä¸ªserverèŠ‚ç‚¹å°±æ˜¯ä¸€ä¸ªè™šæ‹Ÿä¸»æœº\n\t\tlisten       \n\t\tserver_name  localhost;\n\t\tlocation / {\n\t\t\troot   html;//Htmlæ˜¯nginxå®‰è£…ç›®å½•ä¸‹çš„htmlç›®å½•\n\t\t\tindex  index.html index.htm;\n\t\t}\n\t}\n\t/*server {\n\t\tlisten       81;\n\t\tserver_name  localhost;\n\t\tlocation / {\n\t\t\troot   html-81;\n\t\t\tindex  index.html index.htm;\n\t\t}\n\t}*/\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€šè¿‡åŸŸåserver_nameåŒºåˆ†è™šæ‹Ÿä¸»æœº\nhttp {\n\tserver {\n\t\tlisten       80;\n\t\tserver_name  www.taobao.com;\n\t\tlocation / {\n\t\t\troot   html-taobao;\n\t\t\tindex  index.html index.htm;\n\t\t}\n\t}\n\t/*server {\n\t\tlisten       80;\n\t\tserver_name  www.baidu.com;\n\t\tlocation / {\n\t\t\troot   html-baidu;\n\t\t\tindex  index.html index.htm;\n\t\t}\n\t}*/\n}\n</code></pre></div><h2>5. nginxåå‘ä»£ç†é…ç½®</h2>\n<ul>\n<li>æ­£å‘ä»£ç†(å®¢æˆ·ç«¯è½¬å‘è¯·æ±‚å’Œå“åº”)</li>\n<li>åå‘ä»£ç†ï¼š(æœåŠ¡ç«¯è½¬å‘è¯·æ±‚å’Œå“åº”)</li>\n<li>åå‘ä»£ç†æœåŠ¡å™¨å†³å®šå“ªå°æœåŠ¡å™¨æä¾›æœåŠ¡ã€‚è¿”å›ä»£ç†æœåŠ¡å™¨ä¸æä¾›æœåŠ¡å™¨ã€‚ä¹Ÿæ˜¯è¯·æ±‚çš„è½¬å‘ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tupstream tomcat1 {\n\t\tserver 192.168.25.148:8080;\n\t}\n\tserver {\n\t\tlisten       80;\n\t\tserver_name  www.sina.com.cn;\n\t\tlocation / {\n\t\t\tproxy_pass   http://tomcat1;//ä»£ç†é…ç½®\n\t\t\tindex  index.html index.htm;\n\t\t}\n\t}\n\tupstream tomcat2 {\n\t\tserver 192.168.25.148:8081;\n\t}\n\tserver {\n\t\tlisten       80;\n\t\tserver_name  www.sohu.com;\n\t\tlocation / {\n\t\t\tproxy_pass   http://tomcat2;//ä»£ç†é…ç½®\n\t\t\tindex  index.html index.htm;\n\t\t}\n\t}\n</code></pre></div><h2>6. è´Ÿè½½å‡è¡¡/é›†ç¾¤é…ç½®</h2>\n<ul>\n<li>å¦‚æœä¸€ä¸ªæœåŠ¡ç”±å¤šæ¡æœåŠ¡å™¨æä¾›ï¼Œéœ€è¦æŠŠè´Ÿè½½åˆ†é…åˆ°ä¸åŒçš„æœåŠ¡å™¨å¤„ç†ï¼Œéœ€è¦è´Ÿè½½å‡è¡¡ã€‚</li>\n<li>å¯ä»¥æ ¹æ®æœåŠ¡å™¨çš„å®é™…æƒ…å†µè°ƒæ•´æœåŠ¡å™¨æƒé‡ã€‚æƒé‡è¶Šé«˜åˆ†é…çš„è¯·æ±‚è¶Šå¤šï¼Œæƒé‡è¶Šä½ï¼Œè¯·æ±‚è¶Šå°‘ã€‚é»˜è®¤æ˜¯éƒ½æ˜¯1</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tupstream tomcat2 {\n\t\tserver 192.168.25.148:8081;//é›†ç¾¤é…ç½®\n\t\tserver 192.168.25.148:8082 weight=2;\n\t\tserver 192.168.25.148:8083;\n\t}\n</code></pre></div><h2>6.1. Nginxçš„é«˜å¯ç”¨é…ç½®</h2>\n<ul>\n<li>è¦å®ç°nginxçš„é«˜å¯ç”¨ï¼Œéœ€è¦å®ç°å¤‡ä»½æœºã€‚ä¸»æœåŠ¡å™¨å’Œå¤‡ä»½æœºä¸Šéƒ½è¿è¡Œé«˜å¯ç”¨ï¼ˆHigh Availabilityï¼‰ç›‘æ§ç¨‹åºï¼Œé€šè¿‡ä¼ é€è¯¸å¦‚â€œI am aliveâ€è¿™æ ·çš„ä¿¡æ¯æ¥ç›‘æ§å¯¹æ–¹çš„è¿è¡ŒçŠ¶å†µã€‚å½“å¤‡ä»½æœºä¸èƒ½åœ¨ä¸€å®šçš„æ—¶é—´å†…æ”¶åˆ°è¿™æ ·çš„ä¿¡æ¯æ—¶ï¼Œå®ƒå°±æ¥ç®¡ä¸»æœåŠ¡å™¨çš„æœåŠ¡IPå¹¶ç»§ç»­æä¾›è´Ÿè½½å‡è¡¡æœåŠ¡ï¼›å½“å¤‡ä»½ç®¡ç†å™¨åˆä»ä¸»ç®¡ç†å™¨æ”¶åˆ°â€œI am aliveâ€è¿™æ ·çš„ä¿¡æ¯æ—¶ï¼Œå®ƒå°±é‡Šæ”¾æœåŠ¡IPåœ°å€ï¼Œè¿™æ ·çš„ä¸»æœåŠ¡å™¨å°±å¼€å§‹å†æ¬¡æä¾›è´Ÿè½½å‡è¡¡æœåŠ¡ã€‚</li>\n<li>keepalivedæ˜¯é›†ç¾¤ç®¡ç†ä¸­ä¿è¯é›†ç¾¤é«˜å¯ç”¨çš„ä¸€ä¸ªæœåŠ¡è½¯ä»¶ï¼Œç”¨æ¥é˜²æ­¢å•ç‚¹æ•…éšœã€‚Keepalivedçš„ä½œç”¨æ˜¯æ£€æµ‹webæœåŠ¡å™¨çš„çŠ¶æ€ï¼Œå¦‚æœæœ‰ä¸€å°webæœåŠ¡å™¨æ­»æœºï¼Œæˆ–å·¥ä½œå‡ºç°æ•…éšœï¼ŒKeepalivedå°†æ£€æµ‹åˆ°ï¼Œå¹¶å°†æœ‰æ•…éšœçš„webæœåŠ¡å™¨ä»ç³»ç»Ÿä¸­å‰”é™¤ï¼Œå½“webæœåŠ¡å™¨å·¥ä½œæ­£å¸¸åKeepalivedè‡ªåŠ¨å°†webæœåŠ¡å™¨åŠ å…¥åˆ°æœåŠ¡å™¨ç¾¤ä¸­ï¼Œè¿™äº›å·¥ä½œå…¨éƒ¨è‡ªåŠ¨å®Œæˆï¼Œä¸éœ€è¦äººå·¥å¹²æ¶‰ï¼Œéœ€è¦äººå·¥åšçš„åªæ˜¯ä¿®å¤æ•…éšœçš„webæœåŠ¡å™¨ã€‚<br>\n-keepalivedå·¥ä½œåŸç†ï¼škeepalivedæ˜¯ä»¥VRRPåè®®ä¸ºå®ç°åŸºç¡€çš„ï¼ŒVRRPå…¨ç§°Virtual Router Redundancy Protocolï¼Œå³è™šæ‹Ÿè·¯ç”±å†—ä½™åè®®ã€‚å¯ä»¥è®¤ä¸ºæ˜¯å®ç°è·¯ç”±å™¨é«˜å¯ç”¨çš„åè®®ï¼Œå³å°†Nå°æä¾›ç›¸åŒåŠŸèƒ½çš„è·¯ç”±å™¨ç»„æˆä¸€ä¸ªè·¯ç”±å™¨ç»„ï¼Œè¿™ä¸ªç»„é‡Œé¢æœ‰ä¸€ä¸ªmasterå’Œå¤šä¸ªbackupï¼Œmasterä¸Šé¢æœ‰ä¸€ä¸ªå¯¹å¤–æä¾›æœåŠ¡çš„vipï¼ˆVIP = Virtual IP Addressï¼Œè™šæ‹ŸIPåœ°å€ï¼Œè¯¥è·¯ç”±å™¨æ‰€åœ¨å±€åŸŸç½‘å†…å…¶ä»–æœºå™¨çš„é»˜è®¤è·¯ç”±ä¸ºè¯¥vipï¼‰ï¼Œmasterä¼šå‘ç»„æ’­ï¼Œå½“backupæ”¶ä¸åˆ°VRRPåŒ…æ—¶å°±è®¤ä¸ºmasterå®•æ‰äº†ï¼Œè¿™æ—¶å°±éœ€è¦æ ¹æ®VRRPçš„ä¼˜å…ˆçº§æ¥é€‰ä¸¾ä¸€ä¸ªbackupå½“masterã€‚è¿™æ ·çš„è¯å°±å¯ä»¥ä¿è¯è·¯ç”±å™¨çš„é«˜å¯ç”¨äº†ã€‚</li>\n<li>keepalivedä¸»è¦æœ‰ä¸‰ä¸ªæ¨¡å—ï¼Œåˆ†åˆ«æ˜¯coreã€checkå’ŒVRRPã€‚coreæ¨¡å—ä¸ºkeepalivedçš„æ ¸å¿ƒï¼Œè´Ÿè´£ä¸»è¿›ç¨‹çš„å¯åŠ¨ã€ç»´æŠ¤ä»¥åŠå…¨å±€é…ç½®æ–‡ä»¶çš„åŠ è½½å’Œè§£æã€‚checkè´Ÿè´£å¥åº·æ£€æŸ¥ï¼ŒåŒ…æ‹¬å¸¸è§çš„å„ç§æ£€æŸ¥æ–¹å¼ã€‚VRRPæ¨¡å—æ˜¯æ¥å®ç°VRRPåè®®çš„ã€‚</li>\n<li>keepalived+nginxå®ç°ä¸»å¤‡è¿‡ç¨‹<br>\nåˆå§‹çŠ¶æ€<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/68448aa3db9eda659080a.png\" alt=\"å›¾ç‰‡8.png\"><br>\nä¸»æœºå®•æœº<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2139793d9471132befa39.png\" alt=\"å›¾ç‰‡9.png\"><br>\nä¸»æœºæ¢å¤<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/cf3135d3956bb4bcab747.png\" alt=\"å›¾ç‰‡10.png\"></li>\n</ul>\n<h2>11. vueé¡µé¢éƒ¨ç½²åˆ°nginx</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tå¸¦å­è·¯ç”±\n\tserver{\n\t\tlocation /newmatch/ {           \n\t\t\tproxy_pass  http://localhost:11001/;\n\t\t\tproxy_redirect   off;\n\t\t\tproxy_set_header Host $host;\n\t\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\t\tproxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;\n\t\t}\n\t}\n\tserver {\n        listen       11001;\n        location / {\n            root   html\\test;\n            index  index.html index.htm;\n\t\t\texpires 1s;\n        }\n    }\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tæˆ–è€…ä¸å¸¦å­è·¯ç”±\n\tserver {\n        listen       9999;\n\t\tlocation / {\n\t\t\troot   html\\test;\n\t\t}\n\t\t#location = /index.html {\n        #    root   html;\n        #}\n\t}\n</code></pre></div><h2>12. nginxçš„websocketé…ç½®</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tserver {\n        listen       8083;\n\t\tlocation / {\n\t\t\tproxy_pass http://wx.bio-match.com:8083/;\n            proxy_http_version 1.1;\n            proxy_set_header Upgrade $http_upgrade;//websocketé…ç½®1\n            proxy_set_header Connection \"upgrade\";//websocketé…ç½®2\n\t\t}\n       error_page   500 502 503 504  /50x.html;\n        location = /50x.html {\n            root   html;\n        }\n    }\n</code></pre></div><h1>13. ä½¿ç”¨winws.exeæ³¨å†ŒæˆwindowsæœåŠ¡</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\twinws.xmlé…ç½®\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n\t&lt;service&gt;\n\t\t&lt;id&gt;nginx&lt;/id&gt;\n\t\t&lt;name&gt;nginx&lt;/name&gt;\n\t\t&lt;description&gt;nginx&lt;/description&gt;\n\t\t&lt;executable&gt;D:\\tools\\nginx-1.14.2\\nginx.exe&lt;/executable&gt;\n\t\t&lt;logpath&gt;D:\\tools\\nginx-1.14.2\\&lt;/logpath&gt;\n\t\t&lt;logmode&gt;roll&lt;/logmode&gt;\n\t\t&lt;depend&gt;&lt;/depend&gt;\n\t\t&lt;startargument&gt;-p D:\\tools\\nginx-1.14.2&lt;/startargument&gt;\n\t\t&lt;stopargument&gt;-p D:\\tools\\nginx-1.14.2 -s stop&lt;/stopargument&gt;\n\t&lt;/service&gt;\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/68448aa3db9eda659080a.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "DOS",
      "url": "https://javaguide.cn/backend/containerservice/DOS.html",
      "id": "https://javaguide.cn/backend/containerservice/DOS.html",
      "summary": "DOS 1. é…ç½®ç¯å¢ƒå˜é‡(å¿«é€Ÿè¿è¡Œexeç¨‹åº) 2. å¸¸ç”¨DOSå‘½ä»¤ 1. é…ç½®ç¯å¢ƒå˜é‡(å¿«é€Ÿè¿è¡Œexeç¨‹åº) å½“æˆ‘ä»¬åœ¨DOSæ§åˆ¶å°ä¸­ä½¿ç”¨çš„ç¨‹åºåªç»™å‡ºç¨‹åºåç§°ï¼Œè€Œæ²¡æœ‰ç»™å‡ºå®Œæ•´è·¯å¾„æ—¶ï¼Œé‚£ä¹ˆWindowsç³»ç»Ÿä¼šåˆ°Pathå˜é‡ä¿å­˜çš„è·¯å¾„ä¸­å»æŸ¥æ‰¾ç¨‹åºã€‚ é…ç½®æ­¥éª¤ï¼šé¼ æ ‡å³é”®ç‚¹å‡»è®¡ç®—æœºâ†’å±æ€§â†’é«˜çº§ç³»ç»Ÿè®¾ç½®â†’ç‚¹å‡»ç¯å¢ƒå˜é‡â†’æ‰¾åˆ°ç³»ç»Ÿå˜é‡ä¸­çš„PATHâ†’ç‚¹å‡»ç¼–è¾‘æŒ‰é’® 2...",
      "content_html": "<p>DOS</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E9%85%8D%E7%BD%AE%E7%8E%AF%E5%A2%83%E5%8F%98%E9%87%8F%E5%BF%AB%E9%80%9F%E8%BF%90%E8%A1%8Cexe%E7%A8%8B%E5%BA%8F\">1. é…ç½®ç¯å¢ƒå˜é‡(å¿«é€Ÿè¿è¡Œexeç¨‹åº)</a></li>\n<li><a href=\"#2-%E5%B8%B8%E7%94%A8dos%E5%91%BD%E4%BB%A4\">2. å¸¸ç”¨DOSå‘½ä»¤</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. é…ç½®ç¯å¢ƒå˜é‡(å¿«é€Ÿè¿è¡Œexeç¨‹åº)</h1>\n<ul>\n<li>å½“æˆ‘ä»¬åœ¨DOSæ§åˆ¶å°ä¸­ä½¿ç”¨çš„ç¨‹åºåªç»™å‡ºç¨‹åºåç§°ï¼Œè€Œæ²¡æœ‰ç»™å‡ºå®Œæ•´è·¯å¾„æ—¶ï¼Œé‚£ä¹ˆWindowsç³»ç»Ÿä¼šåˆ°Pathå˜é‡ä¿å­˜çš„è·¯å¾„ä¸­å»æŸ¥æ‰¾ç¨‹åºã€‚</li>\n<li>é…ç½®æ­¥éª¤ï¼šé¼ æ ‡å³é”®ç‚¹å‡»è®¡ç®—æœºâ†’å±æ€§â†’é«˜çº§ç³»ç»Ÿè®¾ç½®â†’ç‚¹å‡»ç¯å¢ƒå˜é‡â†’æ‰¾åˆ°ç³»ç»Ÿå˜é‡ä¸­çš„PATHâ†’ç‚¹å‡»ç¼–è¾‘æŒ‰é’®</li>\n</ul>\n<h1>2. å¸¸ç”¨DOSå‘½ä»¤</h1>\n<ul>\n<li>å¼¹å‡ºDOSæ§åˆ¶å°:win+Rï¼Œç„¶åè¾“å…¥cmd</li>\n</ul>\n<p>|æ“ä½œ|doså‘½ä»¤|æ“ä½œ|<br>\n|:-ğŸ˜:-ğŸ˜<br>\n|æ¸…å±|cls| C:\\ &gt;cls|<br>\n|åˆ‡æ¢ç›˜ç¬¦(å¿…é¡»åœ¨ç›˜ç¬¦æ ¹ç›®å½•ä½¿ç”¨)|:|C:\\ &gt;E:|<br>\n|è¿›å…¥æŒ‡å®šç›®å½•|cd|D:&gt;cd developæˆ–D:&gt;cd develop\\Java|<br>\n|è¿”å›ä¸Šä¸€çº§ç›®å½•|cd..|D:\\develop\\Java&gt;cd..|<br>\n|è¿”å›ç›˜ç¬¦æ ¹ç›®å½•|cd|D:\\develop\\Java&gt;cd|<br>\n|æ˜¾ç¤ºå½“å‰ç›®å½•ä¸‹çš„æ–‡ä»¶å’Œå­ç›®å½•ä¿¡æ¯|dir;||<br>\n|è¿è¡Œåº”ç”¨ç¨‹åº|ç¨‹åºå®Œæ•´åç§° å‚æ•°|D:&gt;C:\\windows\\notepad.exe D:&gt;C:\\windows\\notepad[.exe]|<br>\n|åˆ é™¤è¿›ç¨‹|taskkill /f /im è¿›ç¨‹å|taskkill /f /im \"chrome.exe\"|<br>\n|å¤åˆ¶æ–‡ä»¶å¤¹|xcopy /Y åŸå§‹ç›®å½•å ç›®æ ‡ç›®å½•å /e|xcopy /Y \"D:/Match\" \"D:/MatchBackup\" /e\"|<br>\n|winrarè§£å‹|unrar x -y å‹ç¼©æ–‡ä»¶ ç›®æ ‡ç›®å½•|unrar x -y \"D:/update/Match.rar\" \"D:/Match\"|<br>\n|åˆ©ç”¨puttyä¸Šä¼ æ–‡ä»¶|\"C:\\Program Files\\PuTTY\\pscp.exe\" -pw å¯†ç  æ–‡ä»¶å <a href=\"mailto:root@127.0.0.1\">root@127.0.0.1</a>:|\"C:\\Program Files\\PuTTY\\pscp.exe\" -pw å¯†ç  æ–‡ä»¶å <a href=\"mailto:root@127.0.0.1\">root@127.0.0.1</a>:|</p>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "è¿ç»´"
      ]
    },
    {
      "title": "CICD",
      "url": "https://javaguide.cn/backend/containerservice/cicd.html",
      "id": "https://javaguide.cn/backend/containerservice/cicd.html",
      "summary": "DevOps Developmentï¼ˆå¼€å‘ï¼‰å’Œ Operationsï¼ˆè¿ç»´ï¼‰çš„ç»„åˆï¼Œæ˜¯â¼€ç§â½…æ³•è®ºï¼Œæ˜¯â¼€ç»„è¿‡ç¨‹ã€â½…æ³•ä¸ç³»ç»Ÿçš„ç»Ÿç§°ï¼Œâ½¤äºä¿ƒè¿›åº”â½¤å¼€å‘DEVã€åº”â½¤è¿ç»´OPSå’Œè´¨é‡ä¿éšœï¼ˆQAï¼‰éƒ¨â»”ä¹‹é—´çš„æ²Ÿé€šã€åä½œä¸æ•´åˆï¼Œä»¥æœŸæ‰“ç ´ä¼ ç»Ÿå¼€å‘å’Œè¿è¥ä¹‹é—´çš„å£å’å’Œé¸¿æ²Ÿï¼› é€šè¿‡â¾ƒåŠ¨åŒ–è½¯ä»¶äº¤ä»˜å’Œæ¶æ„å˜æ›´çš„æµç¨‹ï¼Œæ¥ä½¿å¾—æ„å»ºã€æµ‹è¯•ã€å‘å¸ƒè½¯ä»¶èƒ½å¤Ÿæ›´åŠ åœ°å¿«æ·ã€é¢‘ç¹å’Œå¯é ï¼›å…·ä½“æ¥è¯´ï¼Œ...",
      "content_html": "<!--more-->\n<!-- TOC -->\n<h2>DevOps</h2>\n<p>Developmentï¼ˆå¼€å‘ï¼‰å’Œ Operationsï¼ˆè¿ç»´ï¼‰çš„ç»„åˆï¼Œæ˜¯â¼€ç§â½…æ³•è®ºï¼Œæ˜¯â¼€ç»„è¿‡ç¨‹ã€â½…æ³•ä¸ç³»ç»Ÿçš„ç»Ÿç§°ï¼Œâ½¤äºä¿ƒè¿›åº”â½¤å¼€å‘DEVã€åº”â½¤è¿ç»´OPSå’Œè´¨é‡ä¿éšœï¼ˆQAï¼‰éƒ¨â»”ä¹‹é—´çš„æ²Ÿé€šã€åä½œä¸æ•´åˆï¼Œä»¥æœŸæ‰“ç ´ä¼ ç»Ÿå¼€å‘å’Œè¿è¥ä¹‹é—´çš„å£å’å’Œé¸¿æ²Ÿï¼›<br>\né€šè¿‡â¾ƒåŠ¨åŒ–è½¯ä»¶äº¤ä»˜å’Œæ¶æ„å˜æ›´çš„æµç¨‹ï¼Œæ¥ä½¿å¾—æ„å»ºã€æµ‹è¯•ã€å‘å¸ƒè½¯ä»¶èƒ½å¤Ÿæ›´åŠ åœ°å¿«æ·ã€é¢‘ç¹å’Œå¯é ï¼›å…·ä½“æ¥è¯´ï¼Œå°±æ˜¯åœ¨è½¯ä»¶äº¤ä»˜å’Œéƒ¨ç½²è¿‡ç¨‹ä¸­æâ¾¼æ²Ÿé€šä¸åä½œçš„æ•ˆç‡ï¼Œæ—¨åœ¨æ›´å¿«ã€æ›´å¯é çš„çš„å‘å¸ƒæ›´â¾¼è´¨é‡çš„äº§å“ï¼›<br>\nDevOpså¹¶ä¸æŒ‡ä»£æŸâ¼€ç‰¹å®šçš„è½¯ä»¶â¼¯å…·æˆ–è½¯ä»¶â¼¯å…·ç»„åˆï¼›å„ç§â¼¯å…·è½¯ä»¶æˆ–è½¯ä»¶ç»„åˆå¯ä»¥å®ç° DevOps çš„æ¦‚å¿µâ½…æ³•ï¼Œä¸è½¯ä»¶å¼€å‘ä¸­è®¾è®¡åˆ°çš„ OOPã€AOPã€IOCï¼ˆæˆ–DIï¼‰ç­‰ç±»ä¼¼ï¼Œæ˜¯â¼€ç§ç†è®ºæˆ–è¿‡ç¨‹æˆ–â½…æ³•çš„æŠ½è±¡æˆ–ä»£ç§°ã€‚å½“ä¸‹å®¹å™¨åŒ–æŠ€æœ¯ä¸K8Sæ˜¯DevOpsçš„æ ¸â¼¼</p>\n<h2>CI/CD</h2>\n<p>é€šè¿‡å°†â¾ƒåŠ¨åŒ–å¼•â¼Šåº”â½¤ç¨‹åºå¼€å‘é˜¶æ®µæ¥é¢‘ç¹å‘å®¢æˆ·äº¤ä»˜åº”â½¤ç¨‹åºçš„â½…æ³•ã€‚ä¸»è¦æ¦‚å¿µæ˜¯æŒç»­é›†æˆã€æŒç»­äº¤ä»˜å’ŒæŒç»­éƒ¨ç½²ã€‚<br>\nè§£å†³é›†æˆæ–°ä»£ç å¯èƒ½ç»™å¼€å‘å’Œè¿è¥å›¢é˜Ÿå¸¦æ¥çš„é—®é¢˜ï¼ˆâ¼œåâ€œé›†æˆåœ°ç‹±â€ï¼‰çš„è§£å†³â½…æ¡ˆã€‚<br>\nCIæŒ‡æŒç»­é›†æˆï¼Œå¼€å‘â¼ˆå‘˜çš„â¾ƒåŠ¨åŒ–è¿‡ç¨‹ã€‚æˆåŠŸçš„CIæŒ‡å¯¹åº”â½¤ç¨‹åºçš„æ–°ä»£ç æ›´æ”¹ä¼šå®šæœŸæ„å»ºã€æµ‹è¯•å¹¶åˆå¹¶åˆ°å…±äº«å­˜å‚¨åº“ã€‚è§£å†³åŒæ—¶å¼€å‘çš„åº”â½¤ç¨‹åºæœ‰å¤ªå¤šåˆ†â½€å¯èƒ½ç›¸äº’å†²çªçš„é—®é¢˜çš„è§£å†³â½…æ¡ˆã€‚<br>\nCDæŒ‡æŒç»­äº¤ä»˜(Continuous Delivery)/æŒç»­éƒ¨ç½²(Continuous Deployment)ï¼Œä¸¤è€…éƒ½æ˜¯å…³äºâ¾ƒåŠ¨åŒ–æµâ½”çº¿çš„è¿›â¼€æ­¥é˜¶æ®µï¼Œä½†æœ‰æ—¶ä¼šå•ç‹¬ä½¿â½¤å®ƒä»¬æ¥è¯´æ˜æ­£åœ¨å‘â½£çš„â¾ƒåŠ¨åŒ–ç¨‹åº¦ã€‚æŒç»­äº¤ä»˜æ„å‘³ç€å¼€å‘â¼ˆå‘˜å¯¹åº”â½¤ç¨‹åºçš„æ›´æ”¹ä¼šâ¾ƒåŠ¨è¿›â¾é”™è¯¯æµ‹è¯•å¹¶ä¸Šä¼ åˆ°å­˜å‚¨åº“ï¼ˆå¦‚ GitHub æˆ–å®¹å™¨æ³¨å†Œè¡¨ï¼‰ï¼Œç„¶åè¿ç»´å›¢é˜Ÿå¯ä»¥å°†å®ƒä»¬éƒ¨ç½²åˆ°å®æ—¶â½£äº§ç¯å¢ƒä¸­ã€‚è¿™æ˜¯å¯¹å¼€å‘å›¢é˜Ÿå’Œä¸šåŠ¡å›¢é˜Ÿä¹‹é—´å¯â»…æ€§å’Œæ²Ÿé€šä¸ä½³é—®é¢˜çš„è§£å†³â½…æ¡ˆã€‚â½¬çš„æ˜¯ç¡®ä¿ä»¥æœ€å°‘çš„åŠªâ¼’éƒ¨ç½²<br>\næ–°ä»£ç ã€‚<br>\næŒç»­éƒ¨ç½²æŒ‡â¾ƒåŠ¨å°†å¼€å‘â¼ˆå‘˜çš„æ›´æ”¹ä»å­˜å‚¨åº“å‘å¸ƒåˆ°â½£äº§ç¯å¢ƒï¼Œä¾›å®¢æˆ·ä½¿â½¤ã€‚å‡å°‘â¼ˆâ¼¯éƒ¨ç½²ã€‚é€šè¿‡â¾ƒåŠ¨åŒ–ç®¡é“ä¸­çš„ä¸‹â¼€é˜¶æ®µæ¥æ„å»ºæŒç»­äº¤ä»˜çš„ä¼˜åŠ¿ã€‚</p>\n<p>æŒç»­é›†æˆ (CI) å¸®åŠ©å¼€å‘â¼ˆå‘˜æ›´é¢‘ç¹åœ°å°†ä»–ä»¬çš„ä»£ç æ›´æ”¹åˆå¹¶å›å…±äº«åˆ†â½€æˆ–â€œä¸»â¼²â€ã€‚åˆå¹¶å¼€å‘â¼ˆå‘˜å¯¹åº”â½¤ç¨‹åºçš„æ›´æ”¹åï¼Œå°†é€šè¿‡â¾ƒåŠ¨æ„å»ºåº”â½¤ç¨‹åºå¹¶è¿â¾ä¸åŒçº§åˆ«çš„â¾ƒåŠ¨åŒ–æµ‹è¯•ï¼ˆé€šå¸¸æ˜¯å•å…ƒæµ‹è¯•å’Œé›†æˆæµ‹è¯•ï¼‰æ¥éªŒè¯è¿™äº›æ›´æ”¹ï¼Œä»¥ç¡®ä¿æ›´æ”¹ä¸ä¼šç ´ååº”â½¤ç¨‹åºã€‚è¿™æ„å‘³ç€æµ‹è¯•ä»ç±»å’Œå‡½æ•°åˆ°æ„æˆæ•´ä¸ªåº”â½¤ç¨‹åºçš„ä¸åŒæ¨¡å—çš„æ‰€æœ‰å†…å®¹ã€‚å¦‚æœâ¾ƒåŠ¨åŒ–æµ‹è¯•å‘ç°æ–°ä»£ç å’Œç°æœ‰ä»£ç ä¹‹é—´å­˜åœ¨å†²çªï¼ŒCIå¯ä»¥æ›´è½»æ¾åœ°å¿«é€Ÿã€é¢‘ç¹åœ°ä¿®å¤è¿™äº›é”™è¯¯ã€‚</p>\n<p>æŒç»­äº¤ä»˜CDï¼šâ¾ƒåŠ¨å°†ç»è¿‡éªŒè¯çš„ä»£ç å‘å¸ƒåˆ°å­˜å‚¨åº“ã€‚â½¬æ ‡æ˜¯æ‹¥æœ‰â¼€ä¸ªå§‹ç»ˆå‡†å¤‡å¥½éƒ¨ç½²åˆ°â½£äº§ç¯å¢ƒçš„ä»£ç åº“ã€‚åœ¨æŒç»­äº¤ä»˜ä¸­ï¼Œä»åˆå¹¶ä»£ç æ›´æ”¹åˆ°äº¤ä»˜â½£äº§å°±ç»ªç‰ˆæœ¬çš„æ¯ä¸ªé˜¶æ®µéƒ½æ¶‰åŠæµ‹è¯•â¾ƒåŠ¨åŒ–å’Œä»£ç å‘å¸ƒâ¾ƒåŠ¨åŒ–ã€‚åœ¨è¯¥è¿‡ç¨‹ç»“æŸæ—¶ï¼Œè¿è¥å›¢é˜Ÿèƒ½å¤Ÿå¿«é€Ÿè½»æ¾åœ°å°†åº”â½¤ç¨‹åºéƒ¨ç½²åˆ°â½£äº§ç¯å¢ƒã€‚</p>\n<p>æŒç»­éƒ¨ç½²CDï¼šâ¾ƒåŠ¨å°†â½£äº§å°±ç»ªçš„æ„å»ºå‘å¸ƒåˆ°ä»£ç å­˜å‚¨åº“ï¼Œâ¾ƒåŠ¨å°†åº”â½¤ç¨‹åºå‘å¸ƒåˆ°â½£äº§ç¯å¢ƒã€‚å› ä¸ºåœ¨â½£äº§å‰çš„æµâ½”çº¿é˜¶æ®µæ²¡æœ‰â¼ˆâ¼¯â»”ï¼Œä¾èµ–äºç²¾â¼¼è®¾è®¡çš„æµ‹è¯•â¾ƒåŠ¨åŒ–ã€‚<br>\næŒç»­éƒ¨ç½²æ„å‘³ç€å¼€å‘â¼ˆå‘˜å¯¹äº‘åº”â½¤ç¨‹åºçš„æ›´æ”¹å¯ä»¥åœ¨ç¼–å†™åâ¼åˆ†é’Ÿå†…â½£æ•ˆï¼ˆå‡è®¾é€šè¿‡äº†â¾ƒåŠ¨åŒ–æµ‹è¯•ï¼‰ã€‚ä½¿å¾—æŒç»­æ¥æ”¶å’Œæ•´åˆâ½¤æˆ·åé¦ˆå˜å¾—æ›´å®¹æ˜“ã€‚é™ä½äº†åº”â½¤ç¨‹åºéƒ¨ç½²çš„â»›é™©ï¼Œä»â½½æ›´å®¹æ˜“ä»¥â¼©å—çš„å½¢å¼å‘å¸ƒå¯¹åº”â½¤ç¨‹åºçš„æ›´æ”¹ï¼Œâ½½ä¸æ˜¯â¼€æ¬¡å…¨éƒ¨å‘å¸ƒã€‚</p>\n<p>ä»£ç ä¸Šä¼ gitlab --&gt; è§¦å‘jenkinsæ„å»º--&gt; æ‹‰å–é¡¹ç›®ã€mavenæ„å»ºjaråŒ…ã€åŸºäºé¡¹ç›®å†…çš„dockerfileè¿›è¡Œdocker build</p>\n",
      "image": "https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMw6b453f16568a9dcfabe40633c508c6d0.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "è¿ç»´"
      ]
    },
    {
      "title": "Docker",
      "url": "https://javaguide.cn/backend/containerservice/docker.html",
      "id": "https://javaguide.cn/backend/containerservice/docker.html",
      "summary": "docker Dockeræ¦‚è¿°ï¼Ÿåœºæ™¯ï¼Ÿä¼˜ç‚¹ï¼Ÿ å¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€ é€šè¿‡å®¹å™¨å®ç°å¿«é€Ÿæ‰“åŒ…ï¼Œæµ‹è¯•å’Œéƒ¨ç½²ç¨‹åºã€ç®¡ç†åŸºç¡€æ¶æ„(å¿«é€Ÿäº¤ä»˜) å®¹å™¨å®‰å…¨ã€è½»é‡ã€å¯ç§»æ¤ã€æ¾è€¦åˆã€å¯æ‰©å±•ç›´æ¥åœ¨å†…æ ¸è¿è¡Œ(åŒä¸€ç¡¬ä»¶ä¸Šå¯è¿è¡Œå¤šä¸ªå®¹å™¨) Webåº”ç”¨çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å’Œå‘å¸ƒã€‚âˆš è‡ªåŠ¨åŒ–æµ‹è¯•å’ŒæŒç»­é›†æˆã€å‘å¸ƒã€‚âˆš åœ¨æœåŠ¡å‹ç¯å¢ƒä¸­éƒ¨ç½²å’Œè°ƒæ•´æ•°æ®åº“æˆ–å…¶ä»–çš„åå°åº”ç”¨ã€‚ å¿«é€Ÿï¼Œä¸€...",
      "content_html": "<p>docker</p>\n<!--more-->\n<h2>Dockeræ¦‚è¿°ï¼Ÿåœºæ™¯ï¼Ÿä¼˜ç‚¹ï¼Ÿ</h2>\n<p>å¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼ŒåŸºäº Go è¯­è¨€<br>\né€šè¿‡å®¹å™¨å®ç°å¿«é€Ÿæ‰“åŒ…ï¼Œæµ‹è¯•å’Œéƒ¨ç½²ç¨‹åºã€ç®¡ç†åŸºç¡€æ¶æ„(å¿«é€Ÿäº¤ä»˜)<br>\nå®¹å™¨å®‰å…¨ã€è½»é‡ã€å¯ç§»æ¤ã€æ¾è€¦åˆã€å¯æ‰©å±•ç›´æ¥åœ¨å†…æ ¸è¿è¡Œ(åŒä¸€ç¡¬ä»¶ä¸Šå¯è¿è¡Œå¤šä¸ªå®¹å™¨)</p>\n<p>Webåº”ç”¨çš„è‡ªåŠ¨åŒ–æ‰“åŒ…å’Œå‘å¸ƒã€‚âˆš<br>\nè‡ªåŠ¨åŒ–æµ‹è¯•å’ŒæŒç»­é›†æˆã€å‘å¸ƒã€‚âˆš<br>\nåœ¨æœåŠ¡å‹ç¯å¢ƒä¸­éƒ¨ç½²å’Œè°ƒæ•´æ•°æ®åº“æˆ–å…¶ä»–çš„åå°åº”ç”¨ã€‚</p>\n<p>å¿«é€Ÿï¼Œä¸€è‡´åœ°äº¤ä»˜æ‚¨çš„åº”ç”¨ç¨‹åº<br>\nå“åº”å¼éƒ¨ç½²å’Œæ‰©å±•<br>\nåœ¨åŒä¸€ç¡¬ä»¶ä¸Šè¿è¡Œæ›´å¤šå·¥ä½œè´Ÿè½½</p>\n<h2>Dockeræ¶æ„ï¼Ÿç»„ä»¶ï¼Ÿ</h2>\n<figure><img src=\"https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwfd2c5c7d4bb799eaeb7e9adbba3e3694.png\" alt=\"1.png\" tabindex=\"0\"><figcaption>1.png</figcaption></figure>\n<p>å·¥ä½œæµç¨‹<br>\næ„å»ºé•œåƒï¼šä½¿ç”¨ Dockerfile åˆ›å»ºé•œåƒã€‚<br>\næ¨é€é•œåƒåˆ°æ³¨å†Œè¡¨ï¼šå°†é•œåƒä¸Šä¼ åˆ° Docker Hub æˆ–ç§æœ‰æ³¨å†Œè¡¨ä¸­ã€‚<br>\næ‹‰å–é•œåƒï¼šé€šè¿‡ docker pull ä»æ³¨å†Œè¡¨ä¸­æ‹‰å–é•œåƒã€‚<br>\nè¿è¡Œå®¹å™¨ï¼šä½¿ç”¨é•œåƒåˆ›å»ºå¹¶å¯åŠ¨å®¹å™¨ã€‚<br>\nç®¡ç†å®¹å™¨ï¼šä½¿ç”¨ Docker å®¢æˆ·ç«¯å‘½ä»¤ç®¡ç†æ­£åœ¨è¿è¡Œçš„å®¹å™¨ï¼ˆä¾‹å¦‚æŸ¥çœ‹æ—¥å¿—ã€åœæ­¢å®¹å™¨ã€æŸ¥çœ‹èµ„æºä½¿ç”¨æƒ…å†µç­‰ï¼‰ã€‚<br>\nç½‘ç»œä¸å­˜å‚¨ï¼šå®¹å™¨ä¹‹é—´é€šè¿‡ Docker ç½‘ç»œè¿æ¥ï¼Œæ•°æ®é€šè¿‡ Docker å·æˆ–ç»‘å®šæŒ‚è½½è¿›è¡ŒæŒä¹…åŒ–ã€‚</p>\n<ul>\n<li>Dockerå®¢æˆ·ç«¯ï¼ˆDocker Clientï¼‰ï¼šç”¨æˆ·ä¸Dockerå®ˆæŠ¤è¿›ç¨‹äº¤äº’çš„å‘½ä»¤è¡Œç•Œé¢ï¼ˆCLIï¼‰ã€‚ç”¨æˆ·é€šè¿‡Docker CLIå‘é€å‘½ä»¤åˆ°Dockerå®ˆæŠ¤è¿›ç¨‹æ‰§è¡Œç›¸åº”çš„æ“ä½œã€‚<br>\nåŠŸèƒ½ï¼šå…è®¸ç”¨æˆ·ä½¿ç”¨å‘½ä»¤ä¸ Docker å®ˆæŠ¤è¿›ç¨‹é€šä¿¡ï¼Œå¦‚åˆ›å»ºå®¹å™¨ã€æ„å»ºé•œåƒã€æŸ¥çœ‹å®¹å™¨çŠ¶æ€ç­‰ã€‚<br>\näº¤äº’æ–¹å¼ï¼šDockerå®¢æˆ·ç«¯ä¸Dockerå®ˆæŠ¤è¿›ç¨‹é€šè¿‡REST APIæˆ–Unixå¥—æ¥å­—é€šä¿¡<br>\nå¸¸ç”¨å‘½ä»¤ï¼š<br>\ndocker runï¼šè¿è¡Œå®¹å™¨ã€‚<br>\ndocker psï¼šåˆ—å‡ºæ­£åœ¨è¿è¡Œçš„å®¹å™¨ã€‚<br>\ndocker buildï¼šæ„å»º Docker é•œåƒã€‚<br>\ndocker execï¼šåœ¨å®¹å™¨ä¸­æ‰§è¡Œå‘½ä»¤ã€‚</li>\n<li>Docker å®ˆæŠ¤è¿›ç¨‹ï¼ˆDocker Daemonï¼‰ï¼šè´Ÿè´£ç®¡ç†å®¹å™¨ç”Ÿå‘½å‘¨æœŸã€æ„å»ºé•œåƒã€åˆ†å‘é•œåƒç­‰ä»»åŠ¡ã€‚ç›‘å¬æ¥è‡ªDockerå®¢æˆ·ç«¯çš„è¯·æ±‚ï¼Œå¹¶ä¸”é€šè¿‡Docker APIæ‰§è¡Œè¯·æ±‚<br>\nå¯åŠ¨å’Œåœæ­¢å®¹å™¨ã€‚<br>\næ„å»ºã€æ‹‰å–å’Œæ¨é€é•œåƒã€‚<br>\nç®¡ç†å®¹å™¨çš„ç½‘ç»œå’Œå­˜å‚¨ã€‚<br>\nå¯åŠ¨ã€åœæ­¢ã€æŸ¥çœ‹å®¹å™¨æ—¥å¿—ç­‰ã€‚<br>\nä¸ Docker æ³¨å†Œè¡¨è¿›è¡Œé€šä¿¡ï¼Œç®¡ç†é•œåƒçš„å­˜å‚¨ä¸åˆ†å‘ã€‚<br>\nå¯åŠ¨ Docker å®ˆæŠ¤è¿›ç¨‹ï¼ˆé€šå¸¸æ˜¯è‡ªåŠ¨å¯åŠ¨çš„ï¼‰ï¼šsudo systemctl start docker</li>\n<li>Docker å¼•æ“ APIï¼ˆDocker Engine APIï¼‰ï¼šDockeræä¾›çš„RESTfulæ¥å£ï¼Œå…è®¸å®¢æˆ·ç«¯ä¸Dockerå®ˆæŠ¤è¿›ç¨‹é€šä¿¡ã€‚é€šè¿‡è¿™ä¸ªAPIï¼Œç”¨æˆ·å¯ä»¥æ‰§è¡Œå„ç§æ“ä½œï¼Œæ”¯æŒè·¨å¹³å°è°ƒç”¨ã€‚<br>\nåŠŸèƒ½ï¼šå‘ Docker å®ˆæŠ¤è¿›ç¨‹å‘é€ HTTP è¯·æ±‚ï¼Œå®ç°å®¹å™¨ã€é•œåƒçš„ç®¡ç†ã€‚<br>\næä¾› RESTful æ¥å£ï¼Œå…è®¸é€šè¿‡ç¼–ç¨‹ä¸ Docker è¿›è¡Œäº¤äº’ã€‚<br>\né€šè¿‡ curl æˆ–å…¶ä»– HTTP å®¢æˆ·ç«¯è®¿é—® Docker å¼•æ“ API<br>\næŸ¥è¯¢å½“å‰ Docker å®ˆæŠ¤è¿›ç¨‹çš„ç‰ˆæœ¬ï¼šcurl --unix-socket /var/run/docker.sock <a href=\"http://localhost/version\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost/version</a></li>\n<li>Docker å®¹å™¨ï¼ˆDocker Containersï¼‰<br>\næ‰§è¡Œç¯å¢ƒï¼Œè½»é‡çº§ã€ç‹¬ç«‹ä¸”å¯æ‰§è¡Œçš„è½¯ä»¶åŒ…ã€‚å®¹å™¨æ˜¯ä»Dockeré•œåƒå¯åŠ¨çš„ï¼ŒåŒ…å«äº†è¿è¡ŒæŸä¸ªåº”ç”¨ç¨‹åºæ‰€éœ€çš„ä¸€åˆ‡â€”â€”ä»æ“ä½œç³»ç»Ÿåº“åˆ°åº”ç”¨ç¨‹åºä»£ç ã€‚å®¹å™¨åœ¨è¿è¡Œæ—¶ä¸å…¶ä»–å®¹å™¨å’Œå®¿ä¸»æœºå…±äº«æ“ä½œç³»ç»Ÿå†…æ ¸ï¼Œä½†å®¹å™¨ä¹‹é—´çš„æ–‡ä»¶ç³»ç»Ÿå’Œè¿›ç¨‹æ˜¯éš”ç¦»çš„ã€‚<br>\nåŠŸèƒ½ï¼š<br>\næä¾›ç‹¬ç«‹çš„è¿è¡Œç¯å¢ƒï¼Œç¡®ä¿åº”ç”¨ç¨‹åºåœ¨ä¸åŒçš„ç¯å¢ƒä¸­å…·æœ‰ä¸€è‡´çš„è¡Œä¸ºã€‚<br>\nå®¹å™¨æ˜¯ä¸´æ—¶çš„ï¼Œé€šå¸¸åœ¨ä»»åŠ¡å®Œæˆåè¢«é”€æ¯ã€‚<br>\nå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸæ˜¯ç”± Docker å®ˆæŠ¤è¿›ç¨‹ç®¡ç†çš„ã€‚å®¹å™¨å¯ä»¥åœ¨ä»»ä½•åœ°æ–¹è¿è¡Œï¼Œå› ä¸ºå®ƒä»¬ä¸ä¾èµ–äºåº•å±‚æ“ä½œç³»ç»Ÿçš„é…ç½®ï¼Œæ‰€æœ‰çš„è¿è¡Œæ—¶ä¾èµ–å·²ç»å°è£…åœ¨é•œåƒä¸­ã€‚<br>\nå¯åŠ¨å®¹å™¨ï¼šdocker run -d ubuntu</li>\n<li>Docker é•œåƒï¼ˆDocker Imagesï¼‰ï¼šå®¹å™¨çš„åªè¯»æ¨¡æ¿ã€‚åŒ…å«äº†åº”ç”¨ç¨‹åºè¿è¡Œæ‰€éœ€çš„æ“ä½œç³»ç»Ÿã€è¿è¡Œæ—¶ã€åº“ã€ç¯å¢ƒå˜é‡å’Œåº”ç”¨ä»£ç ç­‰ã€‚é•œåƒæ˜¯é™æ€çš„ï¼Œç”¨æˆ·å¯ä»¥æ ¹æ®é•œåƒå¯åŠ¨å®¹å™¨ã€‚<br>\nåŠŸèƒ½ï¼š<br>\næ„å»ºå®¹å™¨<br>\né•œåƒæ˜¯åªè¯»çš„ï¼Œä¸åŒå®¹å™¨ä½¿ç”¨åŒä¸€ä¸ªé•œåƒæ—¶ï¼Œå®¹å™¨ä¸­çš„æ–‡ä»¶ç³»ç»Ÿå±‚æ˜¯ç‹¬ç«‹çš„ã€‚<br>\nDocker é•œåƒå¯ä»¥é€šè¿‡ docker pull ä» Docker Hub æˆ–ç§æœ‰æ³¨å†Œè¡¨æ‹‰å–ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ docker build ä» Dockerfile æ„å»ºã€‚<br>\næ‹‰å– Ubuntu é•œåƒï¼šdocker pull ubuntu</li>\n<li>Docker ä»“åº“ï¼ˆDocker Registriesï¼‰ï¼šå­˜å‚¨ Docker é•œåƒï¼Œå…¬å…±ä»“åº“Docker Hubã€‚Docker Hubä¸‹è½½ä¸Šä¼ é•œåƒä¹Ÿå¯ä»¥éƒ¨ç½²è‡ªå·±çš„ç§æœ‰ Docker ä»“åº“æ¥ç®¡ç†ä¼ä¸šå†…éƒ¨çš„é•œåƒã€‚<br>\nåŠŸèƒ½ï¼š<br>\nå­˜å‚¨ Docker é•œåƒã€‚<br>\næä¾›é•œåƒçš„ä¸Šä¼ å’Œä¸‹è½½åŠŸèƒ½ã€‚<br>\nDocker Hub æä¾›äº†å¤§é‡å®˜æ–¹å’Œç¤¾åŒºç»´æŠ¤çš„é•œåƒï¼Œå¦‚ Ubuntuã€Nginxã€MySQL ç­‰ã€‚<br>\næ¨é€é•œåƒåˆ° Docker Hubï¼šdocker push username/image_name</li>\n<li>Docker Composeï¼šå®šä¹‰å’Œè¿è¡Œå¤šå®¹å™¨Dockeråº”ç”¨çš„å·¥å…·ã€‚ç”¨ä¸€ä¸ª docker-compose.yml é…ç½®æ–‡ä»¶å®šä¹‰å¤šä¸ªå®¹å™¨ï¼ˆæœåŠ¡ï¼‰ï¼Œå¹¶å¯ä»¥é€šè¿‡ä¸€ä¸ªå‘½ä»¤å¯åŠ¨è¿™äº›å®¹å™¨ã€‚ç”¨äºå¼€å‘ã€æµ‹è¯•å’Œéƒ¨ç½²å¤šå®¹å™¨çš„åº”ç”¨ã€‚<br>\nåŠŸèƒ½ï¼š<br>\nå®šä¹‰å’Œè¿è¡Œå¤šä¸ªå®¹å™¨ç»„æˆçš„åº”ç”¨ã€‚<br>\né€šè¿‡ YAML æ–‡ä»¶æ¥é…ç½®åº”ç”¨çš„æœåŠ¡ã€ç½‘ç»œå’Œå·ç­‰ã€‚</li>\n<li>Docker Swarmï¼šé›†ç¾¤ç®¡ç†å’Œè°ƒåº¦å·¥å…·ã€‚å°†å¤šä¸ª Docker ä¸»æœºï¼ˆèŠ‚ç‚¹ï¼‰ç»„ç»‡æˆé›†ç¾¤ï¼Œå¹¶é€šè¿‡Swarm é›†ç¾¤ç®¡ç†å·¥å…·æ¥è°ƒåº¦å’Œç®¡ç†å®¹å™¨ã€‚å¯ä»¥å®ç°å®¹å™¨çš„è´Ÿè½½å‡è¡¡ã€é«˜å¯ç”¨æ€§å’Œè‡ªåŠ¨æ‰©å±•ç­‰åŠŸèƒ½ã€‚<br>\nåŠŸèƒ½ï¼š<br>\nç®¡ç†å¤šèŠ‚ç‚¹ Docker é›†ç¾¤ã€‚<br>\né€šè¿‡è°ƒåº¦å™¨ç®¡ç†å®¹å™¨çš„éƒ¨ç½²å’Œæ‰©å±•ã€‚</li>\n<li>Docker ç½‘ç»œï¼ˆDocker Networksï¼‰ï¼šå¹¶ä¸å¤–éƒ¨ä¸–ç•Œè¿›è¡Œè¿æ¥<br>\nåŠŸèƒ½ï¼š<br>\nç®¡ç†å®¹å™¨é—´çš„ç½‘ç»œé€šä¿¡ã€‚<br>\næ”¯æŒä¸åŒçš„ç½‘ç»œæ¨¡å¼ï¼Œä»¥é€‚åº”ä¸åŒåœºæ™¯ä¸‹çš„éœ€æ±‚ã€‚<br>\nåˆ›å»ºä¸€ä¸ªè‡ªå®šä¹‰ç½‘ç»œå¹¶å°†å®¹å™¨è¿æ¥åˆ°è¯¥ç½‘ç»œï¼š</li>\n<li>Docker å·ï¼ˆDocker Volumesï¼‰ï¼šæ•°æ®æŒä¹…åŒ–æœºåˆ¶ï¼Œé€‚ç”¨äºæ•°æ®åº“ç­‰éœ€è¦æŒä¹…å­˜å‚¨çš„åº”ç”¨ã€‚<br>\nåŠŸèƒ½ï¼š<br>\nå…è®¸å®¹å™¨é—´å…±äº«æ•°æ®ã€‚<br>\nä¿è¯æ•°æ®æŒä¹…åŒ–ï¼Œç‹¬ç«‹äºå®¹å™¨çš„ç”Ÿå‘½å‘¨æœŸã€‚ä¸å®¹å™¨æ–‡ä»¶ç³»ç»Ÿä¸åŒï¼Œå·çš„å†…å®¹ä¸ä¼šéšç€å®¹å™¨é”€æ¯è€Œä¸¢å¤±</li>\n</ul>\n<h2>Dockerå®‰è£…</h2>\n<ul>\n<li>æ‰‹åŠ¨å®‰è£…</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\n# æ›´æ”¹centosæº\ncurl -o /etc/yum.repos.d/CentOS-Base.repo http://mirrors.aliyun.com/repo/Centos-7.repo\nyum -y remove docker docker-client docker-client-latest docker-common docker-latest docker-latest-logrotate docker-logrotate docker-engine\n# æ›´æ–°yumã€‚é˜²æ­¢æ‰¾ä¸åˆ°docker\nyum update -y\n# yum clean all\n# yum makecache\n#å®‰è£…ä¸€äº›å¿…å¤‡å·¥å…· java-11-openjdk-headless java-11-openjdk java-11-openjdk-devel\nyum -y install lrzsz net-tools wget vim python3 keyutils unzip lvm2 yum-utils\n# å®‰è£…docker\nyum-config-manager --add-repo https://download.docker.com/linux/centos/docker-ce.repo\n#yum-config-manager --add-repo http://mirrors.aliyun.com/docker-ce/linux/centos/docker-ce.repo\nyum -y install docker-ce docker-ce-cli containerd.io docker-buildx-plugin docker-compose-plugin\n\nsystemctl start docker\nsystemctl enable docker\n</code></pre></div>",
      "image": "https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwfd2c5c7d4bb799eaeb7e9adbba3e3694.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "è¿ç»´"
      ]
    },
    {
      "title": "Kubernetes",
      "url": "https://javaguide.cn/backend/containerservice/kubernetes.html",
      "id": "https://javaguide.cn/backend/containerservice/kubernetes.html",
      "summary": "k8sä»‹ç» Kubernetesèˆµæ‰‹ã€‚8æ›¿ä»£Kå’Œsä¸­çš„8ä¸ªå­—æ¯ï¼ŒGoogleå¼€æºåŸºäºGo Kuberneteså’ŒDockerä¸¤ä¸ªäº’è¡¥ã€‚Dockerä¾§é‡äºå®¹å™¨åŒ–åº”ç”¨ï¼ŒKubernetesä¸“æ³¨äºå®¹å™¨ç¼–æ’ã€‚Dockerå¼€å‘åº”ç”¨ã€æ‰“åŒ…ã€æµ‹è¯•å’Œäº¤ä»˜ï¼ŒKubernetesåœ¨ç”Ÿäº§ã€æµ‹è¯•ç¯å¢ƒä¸­ç¼–æ’åº”ç”¨çš„è¿è¡Œ k8sç±»ä¼¼äº‘ä¸Šçš„æ“ä½œç³»ç»Ÿå¯¹èµ„æºè¿›è¡ŒæŠ½è±¡ï¼Œå¹¶å¯¹å¤šç§äº‘åŸç”Ÿå¾®æœåŠ¡...",
      "content_html": "<!--more-->\n<!-- TOC -->\n<h2>k8sä»‹ç»</h2>\n<ul>\n<li>Kubernetesèˆµæ‰‹ã€‚8æ›¿ä»£Kå’Œsä¸­çš„8ä¸ªå­—æ¯ï¼ŒGoogleå¼€æºåŸºäºGo</li>\n<li>Kuberneteså’ŒDockerä¸¤ä¸ªäº’è¡¥ã€‚Dockerä¾§é‡äºå®¹å™¨åŒ–åº”ç”¨ï¼ŒKubernetesä¸“æ³¨äºå®¹å™¨ç¼–æ’ã€‚Dockerå¼€å‘åº”ç”¨ã€æ‰“åŒ…ã€æµ‹è¯•å’Œäº¤ä»˜ï¼ŒKubernetesåœ¨ç”Ÿäº§ã€æµ‹è¯•ç¯å¢ƒä¸­ç¼–æ’åº”ç”¨çš„è¿è¡Œ</li>\n<li>k8sç±»ä¼¼äº‘ä¸Šçš„æ“ä½œç³»ç»Ÿå¯¹èµ„æºè¿›è¡ŒæŠ½è±¡ï¼Œå¹¶å¯¹å¤šç§äº‘åŸç”Ÿå¾®æœåŠ¡åº”ç”¨è¿›è¡Œè°ƒåº¦</li>\n</ul>\n<h2>k8sæ¶æ„</h2>\n<p>Kubernetesé›†ç¾¤ç”±ä¸»èŠ‚ç‚¹ï¼ˆmasterï¼‰ä¸å·¥ä½œèŠ‚ç‚¹ï¼ˆnodeï¼‰ç»„æˆã€‚è¿™äº›èŠ‚ç‚¹éƒ½æ˜¯Linuxä¸»æœº<br>\n<img src=\"https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwc1af6a79492ff1fec2341d5f59ee453a.png\" alt=\"k8s.png\"></p>\n<ul>\n<li>ä¸»èŠ‚ç‚¹ï¼ˆmasteræ§åˆ¶å¹³é¢ï¼‰ï¼šç»„æˆé›†ç¾¤çš„æ§åˆ¶å¹³é¢çš„ç³»ç»ŸæœåŠ¡çš„é›†åˆã€‚3-5ä¸ªå‰¯æœ¬ä¿è¯é«˜å¯ç”¨</li>\n<li>API Serverï¼ˆAPIæœåŠ¡ï¼‰ï¼šè´Ÿè´£æ‰€æœ‰ç»„ä»¶(ç³»ç»Ÿå†…ç½®ç»„ä»¶ä»¥åŠå¤–éƒ¨ç”¨æˆ·ç»„ä»¶)ä¹‹é—´çš„é€šä¿¡ã€‚å¯¹å¤–é€šè¿‡HTTPSçš„æ–¹å¼æä¾›äº†RESTfulé£æ ¼çš„APIæ¥å£ã€‚è®¿é—®API Serverçš„å…¨éƒ¨è¯·æ±‚éƒ½å¿…é¡»ç»è¿‡æˆæƒä¸è®¤è¯</li>\n<li>Controller Managerï¼šç®¡ç†å’Œæ‰§è¡Œå„ç§æ§åˆ¶å™¨(å¦‚ ReplicaSetã€Deploymentã€StatefulSetç­‰)ã€‚å®ç°äº†å…¨éƒ¨çš„åå°æ§åˆ¶å¾ªç¯ï¼Œå®Œæˆå¯¹é›†ç¾¤çš„ç›‘æ§å¹¶å¯¹äº‹ä»¶ä½œå‡ºå“åº”</li>\n<li>Controller(Deploymentã€DaemonSetä»¥åŠStatefulSet)ï¼šæ¯ä¸ªcontrolleréƒ½åœ¨åå°å¯åŠ¨äº†ç‹¬ç«‹çš„ç›‘æ§å¾ªç¯åŠŸèƒ½ï¼Œè´Ÿè´£ç›‘æ§API Serverçš„å˜æ›´ã€‚æ¯ä¸ªæ§åˆ¶å¾ªç¯éƒ½åªå…³å¿ƒä¸è‡ªå·±ç›¸å…³çš„é€»è¾‘ã€‚ä¿è¯é›†ç¾¤çš„å½“å‰çŠ¶æ€ï¼ˆcurrent stateï¼‰ä¸æœŸæœ›çŠ¶æ€ï¼ˆdesired stateï¼‰ç›¸åŒ¹é…ã€‚æ¯ä¸ªæ§åˆ¶å¾ªç¯çš„åŸºç¡€é€»è¾‘å¦‚ä¸‹ã€‚1è·å–æœŸæœ›çŠ¶æ€2è§‚å¯Ÿå½“å‰çŠ¶æ€3åˆ¤æ–­ä¸¤è€…é—´çš„å·®å¼‚ã€‚4å˜æ›´å½“å‰çŠ¶æ€æ¥æ¶ˆé™¤å·®å¼‚ç‚¹</li>\n<li>Schedulerï¼šé€šè¿‡ç›‘å¬API Serveræ¥å¯åŠ¨æ–°çš„å·¥ä½œä»»åŠ¡ï¼Œå¹¶å°†å…¶åˆ†é…åˆ°é€‚åˆçš„ä¸”å¤„äºæ­£å¸¸è¿è¡ŒçŠ¶æ€çš„èŠ‚ç‚¹ä¸­ã€‚è°ƒåº¦å™¨è¿‡æ»¤æ‰ä¸èƒ½è¿è¡ŒæŒ‡å®šä»»åŠ¡çš„å·¥ä½œèŠ‚ç‚¹å¹¶æ’åºã€‚é€‰æ‹©åˆ†æ•°æœ€é«˜çš„èŠ‚ç‚¹æ¥è¿è¡ŒæŒ‡å®šçš„ä»»åŠ¡ã€‚ç„¶åè¿›è¡Œå¤šç§å‰ç½®æ ¡éªŒåŒ…æ‹¬ï¼šèŠ‚ç‚¹æ˜¯å¦ä»ç„¶å­˜åœ¨ã€æ˜¯å¦æœ‰affinityæˆ–è€…anti-affinityè§„åˆ™ã€ä»»åŠ¡æ‰€ä¾èµ–çš„ç«¯å£åœ¨å½“å‰å·¥ä½œèŠ‚ç‚¹æ˜¯å¦å¯ä»¥è®¿é—®ã€å·¥ä½œèŠ‚ç‚¹æ˜¯å¦æœ‰è¶³å¤Ÿçš„èµ„æºç­‰ã€‚è¿‡æ»¤ä¸æ»¡è¶³ä»»åŠ¡æ‰§è¡Œæ¡ä»¶çš„å·¥ä½œèŠ‚ç‚¹ï¼Œæœ€åæ ¹æ®è§„åˆ™è®¡ç®—å¾—åˆ†å¹¶æ’åºï¼ŒåŒ…æ‹¬ï¼šå·¥ä½œèŠ‚ç‚¹ä¸Šæ˜¯å¦å·²ç»åŒ…å«ä»»åŠ¡æ‰€éœ€çš„é•œåƒã€å‰©ä½™èµ„æºæ˜¯å¦æ»¡è¶³ä»»åŠ¡æ‰§è¡Œæ¡ä»¶ï¼Œæ­£åœ¨æ‰§è¡Œå¤šå°‘ä»»åŠ¡ã€‚å¾—åˆ†æœ€é«˜çš„å·¥ä½œèŠ‚ç‚¹æ‰§è¡Œä»»åŠ¡ã€‚å¦‚æœè°ƒåº¦å™¨æ²¡æ‰¾åˆ°åˆé€‚çš„å·¥ä½œèŠ‚ç‚¹ï¼Œé‚£ä¹ˆä»»åŠ¡ä¼šè¢«æ ‡è®°ä¸ºæš‚åœçŠ¶æ€</li>\n<li>ETCDï¼šåœ¨æ•´ä¸ªæ§åˆ¶å±‚ä¸­ï¼Œåªæœ‰é›†ç¾¤å­˜å‚¨æ˜¯æœ‰çŠ¶æ€ï¼ˆstatefulï¼‰çš„éƒ¨åˆ†ï¼ŒæŒä¹…åŒ–åœ°å­˜å‚¨äº†æ•´ä¸ªé›†ç¾¤çš„é…ç½®ä¸çŠ¶æ€ã€‚åº•å±‚ç”¨åˆ†å¸ƒå¼æ•°æ®åº“etcdã€‚è¿è¡Œ3ï½5ä¸ªå‰¯æœ¬ä¿è¯é«˜å¯ç”¨ã€‚etcdè®¤ä¸ºä¸€è‡´æ€§æ¯”å¯ç”¨æ€§æ›´é‡è¦ã€‚åœ¨å‡ºç°è„‘è£‚æ—¶ä¼šåœæ­¢ä¸ºé›†ç¾¤æä¾›æ›´æ–°èƒ½åŠ›æ¥ä¿è¯å­˜å‚¨æ•°æ®çš„ä¸€è‡´æ€§ã€‚etcdä¸å¯ç”¨æ—¶åº”ç”¨ä»ç„¶å¯ä»¥åœ¨é›†ç¾¤æ€§æŒç»­è¿è¡Œï¼Œåªä¸è¿‡æ— æ³•æ›´æ–°ä»»ä½•å†…å®¹è€Œå·²ã€‚etcdç”¨RAFTä¸€è‡´æ€§ç®—æ³•</li>\n<li>å·¥ä½œèŠ‚ç‚¹ï¼šé›†ç¾¤çš„å·¥ä½œè€…ã€‚è´Ÿè´£1. ç›‘å¬API Serveråˆ†æ´¾çš„æ–°ä»»åŠ¡ã€‚2. æ‰§è¡Œæ–°åˆ†æ´¾çš„ä»»åŠ¡ã€‚3. é€šè¿‡API Serverå‘æ§åˆ¶å¹³é¢å›å¤ä»»åŠ¡æ‰§è¡Œçš„ç»“æœã€‚</li>\n<li>Kubeletï¼šå·¥ä½œèŠ‚ç‚¹æ ¸å¿ƒï¼Œæ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ä¸Šéƒ½æœ‰éƒ¨ç½²ã€‚è´Ÿè´£å°†å½“å‰å·¥ä½œèŠ‚ç‚¹æ³¨å†Œåˆ°é›†ç¾¤å½“ä¸­ï¼Œé›†ç¾¤çš„èµ„æºæ± å°±ä¼šè·å–åˆ°å½“å‰å·¥ä½œèŠ‚ç‚¹çš„CPUã€å†…å­˜ä»¥åŠå­˜å‚¨ä¿¡æ¯ï¼Œå¹¶å°†å·¥ä½œèŠ‚ç‚¹åŠ å…¥å½“å‰èµ„æºæ± ã€‚è´Ÿè´£ç›‘å¬API Serveræ–°åˆ†é…çš„ä»»åŠ¡å¹¶æ‰§è¡Œï¼Œç»´æŠ¤ä¸æ§åˆ¶å¹³é¢ä¹‹é—´çš„ä¸€ä¸ªé€šä¿¡é¢‘é“ï¼Œå‡†å¤‡å°†æ‰§è¡Œç»“æœåé¦ˆå›å»ã€‚å¦‚æœKuberletæ— æ³•è¿è¡ŒæŒ‡å®šä»»åŠ¡ï¼Œå°±ä¼šå°†è¿™ä¸ªä¿¡æ¯åé¦ˆç»™æ§åˆ¶å¹³é¢ï¼Œå¹¶ç”±æ§åˆ¶å¹³é¢å†³å®šæ¥ä¸‹æ¥è¦é‡‡å–ä»€ä¹ˆæªæ–½</li>\n<li>å®¹å™¨è¿è¡Œæ—¶ (Dockerã€Containerdã€...)ï¼šKubeletéœ€è¦å®¹å™¨è¿è¡Œæ—¶ï¼ˆcontainer runtimeï¼‰æ¥æ‰§è¡Œä¾èµ–å®¹å™¨æ‰èƒ½æ‰§è¡Œçš„ä»»åŠ¡ï¼Œä¾‹å¦‚æ‹‰å–é•œåƒå¹¶å¯åŠ¨æˆ–åœæ­¢å®¹å™¨ã€‚k8sé€šè¿‡è¿â¾æ—¶æ¥â¼ï¼ˆCRIï¼‰çš„æ¨¡å—æ”¯æŒä¸åŒçš„å®¹å™¨è¿è¡Œæ—¶</li>\n<li>Kube-proxyï¼šè¿è¡Œåœ¨æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹ï¼Œè´Ÿè´£æœ¬åœ°é›†ç¾¤ç½‘ç»œã€‚ä¾‹å¦‚ä¿è¯æ¯ä¸ªå·¥ä½œèŠ‚ç‚¹éƒ½å¯ä»¥è·å–åˆ°å”¯ä¸€çš„IPåœ°å€ï¼Œå¹¶ä¸”å®ç°äº†æœ¬åœ°IPTABLEä»¥åŠIPVSæ¥ä¿éšœPodé—´çš„ç½‘ç»œè·¯ç”±ä¸è´Ÿè½½å‡è¡¡</li>\n</ul>\n<h2>PODã€Pauseå®¹å™¨ã€yamlå®šä¹‰pod(äº†è§£)ï¼ŒPODç”Ÿå‘½å‘¨æœŸä¸é‡å¯ã€æ‹‰å–ç­–ç•¥ï¼Œåˆ©ç”¨æ¢é’ˆå®ç°PODå¥åº·æ£€æŸ¥ï¼Œå¯¹å¤–æš´éœ²ï¼ŒPodè°ƒåº¦ä¸èŠ‚ç‚¹äº²å’Œæ€§ï¼Œæ±¡ç‚¹ï¼ˆTaintï¼‰ä¸å®¹å¿åº¦ï¼ˆTolerationï¼‰.LimitRangeä¸ResourceQuota</h2>\n<ul>\n<li>Dockerä¸­è°ƒåº¦çš„åŸå­å•ä½æ˜¯å®¹å™¨ï¼›K8sä¸­æœ€å°è°ƒåº¦çš„åŸå­å•ä½æ˜¯Podã€‚æ¯ä¸ªPodä¸­è¿è¡Œä¸€ä¸ªæˆ–ä¸€ç»„å®¹å™¨ï¼Œç§°ä¸ºå¤šå®¹å™¨Podï¼ˆmulti-container Podï¼‰</li>\n<li>åŒä¸€ä¸ªPodä¸­è¿è¡Œå¤šä¸ªå®¹å™¨ä¼šå…±äº«ç›¸åŒçš„Podç¯å¢ƒã€‚åŒ…æ‹¬äº†IPCå‘½åç©ºé—´ï¼Œå†…å­˜ï¼Œç£ç›˜ã€ç½‘ç»œä»¥åŠå…¶ä»–èµ„æºï¼Œå¦‚IPåœ°å€ã€‚å®¹å™¨ä¹‹é—´å¯ä»¥ç”¨localhostæ¥å£é€šä¿¡ã€‚</li>\n<li>å¤šå®¹å™¨Podé€‚ç”¨äºå­˜åœ¨å¼ºç»‘å®šå…³ç³»çš„å¤šä¸ªå®¹å™¨ï¼Œæ¯”å¦‚éœ€è¦å…±äº«å†…å­˜ä¸å­˜å‚¨ã€‚å¦‚æœå®¹å™¨é—´å¹¶ä¸å­˜åœ¨å¦‚æ­¤ç´§å¯†çš„å…³ç³»ï¼Œæœ€å¥½å°†å®¹å™¨å°è£…åˆ°ä¸åŒçš„Podï¼Œé€šè¿‡ç½‘ç»œä»¥æ¾è€¦åˆçš„æ–¹å¼æ¥è¿è¡Œã€‚åœ¨ä»»åŠ¡çº§åˆ«å®ç°å®¹å™¨é—´çš„éš”ç¦»ï¼Œé™ä½ç›¸äº’ä¹‹é—´çš„å½±å“ã€‚ä½†ä¼šå¯¼è‡´å¤§é‡çš„æœªåŠ å¯†çš„ç½‘ç»œæµé‡äº§ç”Ÿã€‚</li>\n<li>Pauseå®¹å™¨ï¼šinfrastucture containerï¼ˆinfraï¼‰åŸºç¡€å®¹å™¨ï¼Œ</li>\n<li>æ¯ä¸ªPodè¿è¡Œä¸€ä¸ªPauseçš„å®¹å™¨ï¼Œå…¶ä»–å®¹å™¨ï¼ˆä¸šåŠ¡å®¹å™¨ï¼‰éƒ½ä»pauseå®¹å™¨ä¸­forkå‡ºæ¥ï¼Œå…±äº«Pauseå®¹å™¨çš„ç½‘ç»œæ ˆå’ŒVolumeæŒ‚è½½å·ã€‚å› æ­¤ä»–ä»¬ä¹‹é—´é€šä¿¡å’Œæ•°æ®äº¤æ¢æ›´ä¸ºé«˜æ•ˆ</li>\n<li>Pauseå®¹å™¨ä¸ºæ¯ä¸ªä¸šåŠ¡å®¹å™¨æä¾›ä»¥ä¸‹åŠŸèƒ½ï¼š<br>\nPIDå‘½åç©ºé—´ï¼šPodä¸­çš„ä¸åŒåº”ç”¨ç¨‹åºå¯ä»¥çœ‹åˆ°å…¶ä»–åº”ç”¨ç¨‹åºçš„è¿›ç¨‹IDã€‚<br>\nç½‘ç»œå‘½åç©ºé—´ï¼šPodä¸­çš„å¤šä¸ªå®¹å™¨èƒ½å¤Ÿè®¿é—®åŒä¸€ä¸ªIPå’Œç«¯å£èŒƒå›´ã€‚<br>\nIPCå‘½åç©ºé—´ï¼šPodä¸­çš„å¤šä¸ªå®¹å™¨èƒ½å¤Ÿä½¿ç”¨SystemV IPCæˆ–POSIXæ¶ˆæ¯é˜Ÿåˆ—è¿›è¡Œé€šä¿¡ã€‚<br>\nUTSå‘½åç©ºé—´ï¼šPodä¸­çš„å¤šä¸ªå®¹å™¨å…±äº«ä¸€ä¸ªä¸»æœºå<br>\nVolumesï¼ˆå…±äº«å­˜å‚¨å·ï¼‰ï¼šPodä¸­çš„å„ä¸ªå®¹å™¨å¯ä»¥è®¿é—®Podçº§åˆ«çš„Volumes</li>\n<li>æ‰©å®¹æˆ–ç¼©å®¹åº”ç”¨æ—¶é€šè¿‡æ·»åŠ æˆ–åˆ é™¤Podæ¥å®ç°ã€‚ä¸è¦å‘å·²ç»å­˜åœ¨çš„Podä¸­å¢åŠ å®¹å™¨æ¥æ‰©å®¹</li>\n<li>Podçš„éƒ¨ç½²æ˜¯ä¸€ä¸ªåŸå­æ“ä½œã€‚åªæœ‰å½“Podä¸­çš„<strong>æ‰€æœ‰å®¹å™¨éƒ½å¯åŠ¨æˆåŠŸä¸”å¤„äºè¿è¡ŒçŠ¶æ€</strong>æ—¶ï¼ŒPodæä¾›çš„æœåŠ¡æ‰æ˜¯å¯ç”¨çš„ï¼Œä¸€ä¸ªPodï¼ˆå³ä½¿åŒ…å«å¤šå®¹å™¨ï¼‰åªä¼šè¢«å”¯ä¸€çš„å·¥ä½œèŠ‚ç‚¹è°ƒåº¦</li>\n<li>å¦‚æœPodå‡ºç°é¢„æœŸå¤–çš„é”€æ¯æ—¶ä¼šå¯åŠ¨æ–°Podæ¥å–ä»£æœ‰é—®é¢˜çš„Podã€‚æœ‰å…¨æ–°çš„IDä¸IPåœ°å€ã€‚ä¸è¦åœ¨è®¾è®¡ç¨‹åºçš„æ—¶ä¾èµ–ç‰¹å®šçš„Pod</li>\n</ul>\n<details>\n<summary>yamlå®šä¹‰pod</summary>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token comment\"># ç¼–å†™yaml</span>\n<span class=\"token function\">mkdir</span> /etc/k8s\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> /etc/k8s/nginx-pod.yaml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\n# APIç‰ˆæœ¬å·ï¼Œå›ºå®šå†™v1å³å¯\napiVersion: v1 \n# åˆ›å»ºå¯¹è±¡ç±»å‹\nkind: Pod \n# å…ƒæ•°æ®ï¼Œæè¿°podçš„è¾…åŠ©ä¿¡æ¯\nmetadata: \n\t# podåç§°\n  name: pod-nginx\n# è®¾ç½®å®¹å™¨ã€é•œåƒç­‰å…³é”®é€‰é¡¹\nspec:\n  # é‡å¯ç­–ç•¥\n  restartPolicy: Never\n  containers: \n    # å®¹å™¨åç§°\n    - name: container-nginx\n    # é•œåƒåç§°\n      image: nginx:1.20.2-alpine\n      # é•œåƒæ‹‰å–ç­–ç•¥\n      imagePullPolicy: IfNotPresent\n      # å®¹å™¨å†…éƒ¨æš´éœ²çš„ç«¯å£å·ï¼Œå³expose\n      ports: \n      # nginxå®¹å™¨é»˜è®¤å¯¹å¤–æš´éœ²80ç«¯å£\n      - containerPort: 80 \n      # é…ç½®å­˜æ´»æ¢é’ˆ,æ¯äº”ç§’é’Ÿæ‰§â¾â¼€æ¬¡æ¢æµ‹å®¹å™¨80ç«¯â¼æ˜¯å¦å‡†å¤‡å°±ç»ª\n      # â½½ç¬¬â¼€æ¬¡æ¢æµ‹æ‰§â¾å‰å…ˆç­‰å¾…10ç§’ï¼Œç•™å‡ºå¿…è¦çš„åˆå§‹åŒ–æ—¶é—´\n      livenessProbe:\n        tcpSocket:\n          port: 80\n        initialDelaySeconds: 10\n        periodSeconds: 5\n      readinessProbe:\n        httpGet:\n          path: /abcde\n          port: 80\n          httpHeaders:\n            - name: Custom-Header\n              value: Awesome\n        initialDelaySeconds: 3\n        periodSeconds: 3\nEOF</span>\n\nkubectl apply <span class=\"token parameter variable\">-f</span> /etc/k8s/nginx-pod.yaml\n<span class=\"token comment\">#ç§»é™¤</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> /etc/k8s/nginx-pod.yaml\n\n<span class=\"token comment\"># æŸ¥çœ‹å·²éƒ¨ç½²çš„NginxèŠ‚ç‚¹</span>\nkubectl get pods <span class=\"token parameter variable\">-A</span> <span class=\"token parameter variable\">-o</span> wide\n\n<span class=\"token comment\"># æŸ¥çœ‹æŒ‡å®špodæ˜ç»†</span>\nkubectl describe pod pod-nginx\n<span class=\"token comment\"># æŸ¥çœ‹è¾“å‡ºçš„æ—¥å¿—</span>\nkubectl logs <span class=\"token parameter variable\">-f</span> pod-nginx\n<span class=\"token comment\"># æŸ¥çœ‹è¿è¡Œæ—¶å‘½ä»¤</span>\ncrictl <span class=\"token function\">ps</span>\n</code></pre></div></details>\n<p>Podç”Ÿå‘½å‘¨æœŸäº”ä¸ªé˜¶æ®µ</p>\n<ul>\n<li>è¿è¡Œä¸­ï¼ˆRunningï¼‰ï¼šPodå·²ç»ç»‘å®šåˆ°äº†ä¸€ä¸ªèŠ‚ç‚¹ä¸Šï¼Œæ‰€æœ‰çš„å®¹å™¨éƒ½å·²è¢«åˆ›å»ºã€‚è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨æ­£åœ¨è¿è¡Œï¼Œæˆ–è€…æ­£å¤„äºå¯åŠ¨æˆ–é‡å¯çŠ¶æ€ã€‚</li>\n<li>ç­‰å¾…ä¸­ï¼ˆPendingï¼‰: åˆ›å»ºPodè¯·æ±‚å·²è¢«æ¥å—ï¼Œä½†æœ‰ä¸€ä¸ªæˆ–è€…å¤šä¸ªå®¹å™¨é•œåƒå°šæœªåˆ›å»º</li>\n<li>æ­£å¸¸ç»ˆæ­¢ï¼ˆSucceededï¼‰ï¼špodä¸­çš„æ‰€æœ‰çš„å®¹å™¨å·²ç»æ­£å¸¸é€€å‡ºï¼Œå¹¶ä¸”æ°¸è¿œä¸ä¼šè‡ªåŠ¨é‡å¯è¿™äº›å®¹å™¨ï¼Œä¸€èˆ¬åœ¨éƒ¨ç½²jobæ—¶å‡ºç°</li>\n<li>å¼‚å¸¸åœæ­¢ï¼ˆFailedï¼‰ï¼šPodä¸­çš„æ‰€æœ‰å®¹å™¨éƒ½å·²ç»ˆæ­¢äº†ï¼Œå¹¶ä¸”è‡³å°‘æœ‰ä¸€ä¸ªå®¹å™¨æ˜¯å› ä¸ºå¤±è´¥ç»ˆæ­¢ã€‚å®¹å™¨ä»¥é0çŠ¶æ€é€€å‡ºæˆ–è€…è¢«ç³»ç»Ÿç»ˆæ­¢</li>\n<li>æœªçŸ¥çŠ¶æ€ï¼ˆPodUnkonwnï¼‰ï¼šå‡ºäºæŸç§åŸå› ï¼Œæ— æ³•è·å¾—Podçš„çŠ¶æ€ï¼Œé€šå¸¸æ˜¯ä¸Podä¸»æœºé€šä¿¡å‡ºé”™</li>\n</ul>\n<p>Podè¯¦ç»†çŠ¶æ€</p>\n<ul>\n<li>CrashLoopBackOffï¼šå®¹å™¨é€€å‡ºï¼Œæ­£åœ¨é‡å¯ï¼Œå»ºè®®å¢åŠ å†…å­˜ã€CPUç­‰èµ„æº</li>\n<li>InvalidImageNameï¼š æ— æ³•è§£æé•œåƒåç§°</li>\n<li>ImageInspectErrorï¼š æ— æ³•æ ¡éªŒé•œåƒ</li>\n<li>ErrImageNeverPullï¼š ç­–ç•¥ç¦æ­¢æ‹‰å–é•œåƒ</li>\n<li>ImagePullBackOffï¼š æ­£åœ¨é‡è¯•æ‹‰å–ï¼Œå»ºè®®æ›´æ¢é•œåƒä»“åº“</li>\n<li>RegistryUnavailableï¼š è¿æ¥ä¸åˆ°é•œåƒä¸­å¿ƒ</li>\n<li>ErrImagePullï¼š é€šç”¨çš„æ‹‰å–é•œåƒå‡ºé”™</li>\n<li>CreateContainerConfigErrorï¼š ä¸èƒ½åˆ›å»ºkubeletä½¿ç”¨çš„å®¹å™¨é…ç½®</li>\n<li>CreateContainerErrorï¼š åˆ›å»ºå®¹å™¨å¤±è´¥</li>\n<li>m.internalLifecycle.PreStartContainer  æ‰§è¡ŒhookæŠ¥é”™</li>\n<li>RunContainerErrorï¼š å¯åŠ¨å®¹å™¨å¤±è´¥</li>\n<li>PostStartHookErrorï¼š æ‰§è¡ŒhookæŠ¥é”™</li>\n<li>ContainersNotInitializedï¼š å®¹å™¨æ²¡æœ‰åˆå§‹åŒ–å®Œæ¯•</li>\n<li>ContainersNotReadyï¼š å®¹å™¨æ²¡æœ‰å‡†å¤‡å®Œæ¯•</li>\n<li>ContainerCreatingï¼šå®¹å™¨åˆ›å»ºä¸­ï¼Œé•¿æ—¶é—´å¡æ­»è¦decribeä¸logsæŸ¥çœ‹æ—¥å¿—åˆ†æå†…å®¹</li>\n<li>PodInitializingï¼špodåˆå§‹åŒ–ä¸­</li>\n<li>DockerDaemonNotReadyï¼šdockerè¿˜æ²¡æœ‰å®Œå…¨å¯åŠ¨</li>\n<li>NetworkPluginNotReadyï¼šç½‘ç»œæ’ä»¶è¿˜æ²¡æœ‰å®Œå…¨å¯åŠ¨</li>\n</ul>\n<p>PODé‡å¯ç­–ç•¥spec.restartPolicyï¼šé€‚ç”¨äºpodä¸­çš„æ‰€æœ‰é¦–æ¬¡éœ€è¦é‡å¯çš„å®¹å™¨ï¼Œéšåå†æ¬¡éœ€è¦é‡å¯å°†å»¶è¿Ÿä¸€æ®µæ—¶é—´åè¿›è¡Œï¼Œæ—¶é•¿ä¸º10ï¼Œ20ï¼Œ40ï¼Œ80ï¼Œ160ï¼Œ300s</p>\n<ul>\n<li>Always(é»˜è®¤)ï¼šå®¹å™¨å¤±æ•ˆæ—¶ï¼Œè‡ªåŠ¨é‡å¯è¯¥å®¹å™¨</li>\n<li>OnFailureï¼šå®¹å™¨åœæ­¢è¿è¡Œä¸”é€€å‡ºç ä¸ä¸º0æ—¶é‡å¯</li>\n<li>Neverï¼šä»»ä½•çŠ¶æ€éƒ½ä¸é‡å¯å®¹å™¨<br>\nPODé•œåƒæ‹‰å–ç­–ç•¥spec.containers[i].imagePullPolicy</li>\n<li>IfNotPresent(é»˜è®¤)ï¼Œé•œåƒä¸å­˜åœ¨æ—¶æ‹‰å–ï¼ˆé¢å¯¹ç¨³å®šç‰ˆæœ¬ï¼‰</li>\n<li>Alwaysï¼šæ¯æ¬¡åˆ›å»ºPodéƒ½é‡æ–°æ‹‰å–é•œåƒï¼ˆé¢å¯¹ä¸æ–­å˜æ›´ç‰ˆæœ¬ï¼‰</li>\n<li>Neverï¼šæ°¸è¿œä¸ä¼šæ‹‰å–é•œåƒ</li>\n</ul>\n<p>Podå®ç°å¥åº·æ£€æŸ¥ä¸‰ç§æ¢é’ˆç±»å‹spec.containers[i].StartupProbeï¼š</p>\n<ul>\n<li>StartupProbeï¼šç”¨äºåˆ¤æ–­å®¹å™¨å†…åº”ç”¨ç¨‹åºæ˜¯å¦å·²ç»å¯åŠ¨ã€‚ä¼šå…ˆç¦æ­¢å…¶ä»–çš„æ¢æµ‹ç›´åˆ°æˆåŠŸä¸ºæ­¢ï¼ŒæˆåŠŸåå°†ä¸å†è¿›è¡Œæ¢æµ‹ã€‚é€‚ç”¨äºå®¹å™¨å¯åŠ¨æ—¶é—´é•¿çš„åœºæ™¯</li>\n<li>LivenessProbeï¼ˆå­˜æ´»æ¢é’ˆï¼‰ï¼šç”¨äºæ¢æµ‹å®¹å™¨æ˜¯å¦è¿è¡Œï¼Œæ¢æµ‹å¤±è´¥ä¼šæ ¹æ®é…ç½®çš„é‡å¯ç­–ç•¥è¿›è¡Œå¤„ç†ã€‚æ²¡æœ‰é…ç½®åˆ™é»˜è®¤successã€‚</li>\n<li>ReadinessProbeï¼ˆå°±ç»ªæ¢é’ˆï¼‰ï¼šç”¨äºæ¢æµ‹å®¹å™¨å†…çš„ç¨‹åºæ˜¯å¦å¥åº·ï¼Œè¿”å›å€¼ä¸ºsuccessä»£è¡¨å®¹å™¨å®Œæˆå¯åŠ¨ï¼Œå¹¶ä¸”ç¨‹åºæ˜¯å¯ä»¥æ¥å—æµé‡çš„çŠ¶æ€<br>\nä¸‰è€…åŒºåˆ«</li>\n<li>å­˜æ´»æ¢é’ˆç”¨äºç¡®å®šé‡å¯å®¹å™¨æ—¶æœºã€‚ä¾‹å¦‚æ¢æµ‹åˆ°æ­»é”ã€‚æé«˜åº”ç”¨çš„å¯ç”¨æ€§ï¼Œå³ä½¿å…¶ä¸­å­˜åœ¨ç¼ºé™·</li>\n<li>å°±ç»ªæ¢é’ˆå¯ä»¥ç¡®å®šå®¹å™¨å‡†å¤‡å¥½æ¥å—è¯·æ±‚æµé‡æ—¶æœºï¼Œå½“æ‰€æœ‰å®¹å™¨éƒ½å°±ç»ªæ—¶ï¼Œæ‰èƒ½è®¤ä¸ºè¯¥Podå°±ç»ªã€‚ç”¨äºæ§åˆ¶Podä½œä¸ºServiceçš„åç«¯ã€‚Podå°šæœªå°±ç»ªä¼šè¢«ä»Serviceçš„è´Ÿè½½å‡è¡¡å™¨ä¸­å‰”é™¤</li>\n</ul>\n<p>Podæ¢é’ˆçš„å››ç§æ£€æµ‹æ–¹å¼spec.containers[i].StartupProbe.httpGetï¼š</p>\n<ul>\n<li>execï¼šåœ¨å®¹å™¨å†…æ‰§è¡Œå‘½ä»¤è¿”å›å€¼ä¸º0ï¼Œåˆ™è®¤ä¸ºå®¹å™¨å¥åº·ã€‚</li>\n<li>tcpSocketï¼šé€šè¿‡TCPè¿æ¥æ£€æŸ¥å®¹å™¨å†…çš„ç«¯å£æ˜¯å¦è¿é€šï¼Œè¿é€šåˆ™å®¹å™¨å¥åº·</li>\n<li>httpGetï¼ˆå¸¸ç”¨ï¼‰ï¼šé€šè¿‡ç¨‹åºæš´éœ²çš„APIåœ°å€æ£€æŸ¥ç¨‹åºæ˜¯å¦æ­£å¸¸ï¼Œå¦‚æœçŠ¶æ€ç ä¸º200~400ï¼Œåˆ™å®¹å™¨å¥åº·</li>\n<li>grpcï¼šç”¨gRPCæ‰§è¡Œè¿œç¨‹è¿‡ç¨‹è°ƒç”¨ã€‚å¦‚æœå“åº”çš„çŠ¶æ€æ˜¯\"SERVING\"ï¼Œåˆ™è®¤ä¸ºè¯Šæ–­æˆåŠŸã€‚<br>\næ¢æµ‹ç»“æœ</li>\n<li>Successï¼ˆæˆåŠŸï¼‰ï¼šå®¹å™¨é€šè¿‡äº†è¯Šæ–­ã€‚</li>\n<li>Failureï¼ˆå¤±è´¥ï¼‰ï¼šå®¹å™¨æœªé€šè¿‡è¯Šæ–­ã€‚</li>\n<li>Unknownï¼ˆæœªçŸ¥ï¼‰ï¼šè¯Šæ–­å¤±è´¥ï¼Œå› æ­¤ä¸ä¼šé‡‡å–ä»»ä½•è¡ŒåŠ¨ã€‚<br>\né…ç½®èŒƒæœ¬ï¼š</li>\n<li>å®¹å™¨å¯åŠ¨5ç§’åå‘é€ç¬¬ä¸€ä¸ªå­˜æ´»æ¢é’ˆã€‚å°è¯•è¿æ¥nginxå®¹å™¨çš„80ç«¯å£ã€‚å¦‚æœæ¢æµ‹æˆåŠŸï¼ŒPodä¼šè¢«æ ‡è®°ä¸ºå°±ç»ªçŠ¶æ€ï¼Œæ¯éš”10ç§’è¿è¡Œä¸€æ¬¡æ¢æµ‹</li>\n<li>å°±ç»ªæ¢é’ˆperiodSecondså­—æ®µæŒ‡å®šæ¯éš”3ç§’æ‰§è¡Œä¸€æ¬¡å­˜æ´»æ¢æµ‹</li>\n<li>initialDelaySeconds å­—æ®µåœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡æ¢æµ‹å‰ç­‰å¾…3ç§’ã€‚å‘å®¹å™¨å†…è¿è¡Œçš„æœåŠ¡ï¼ˆæœåŠ¡ç›‘å¬8080ç«¯å£ï¼‰å‘é€HTTP GETè¯·æ±‚æ¥æ¢æµ‹ã€‚å¦‚æœæœåŠ¡å™¨ä¸Š/healthzè·¯å¾„ä¸‹çš„å¤„ç†ç¨‹åºè¿”å›æˆåŠŸä»£ç ï¼Œåˆ™è®¤ä¸ºå®¹å™¨æ˜¯å¥åº·å­˜æ´»çš„ã€‚å¦‚æœè¿”å›å¤±è´¥ä»£ç ï¼Œåˆ™ä¼šæ€æ­»å®¹å™¨å¹¶é‡å¯ã€‚è¿”å›200-400çš„ä»»ä½•ä»£ç éƒ½è¡¨ç¤ºæˆåŠŸï¼Œå…¶å®ƒè¡¨ç¤ºå¤±è´¥</li>\n</ul>\n<p>å¯¹å¤–æš´éœ²ç«¯å£</p>\n<table>\n<thead>\n<tr>\n<th>æ–¹æ³•</th>\n<th>ä¼˜ç‚¹</th>\n<th>ç¼ºç‚¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td>NodePort</td>\n<td>ç®€å•ã€é€‚åˆæµ‹è¯•ç¯å¢ƒ</td>\n<td>ç«¯å£èŒƒå›´å—é™ï¼Œæš´éœ²åˆ°æ‰€æœ‰èŠ‚ç‚¹</td>\n</tr>\n<tr>\n<td>LoadBalancer</td>\n<td>äº‘ç¯å¢ƒåŸç”Ÿæ”¯æŒï¼Œå¤–éƒ¨è®¿é—®ç®€å•</td>\n<td>ä»…æ”¯æŒäº‘ç¯å¢ƒï¼Œå¯èƒ½æœ‰é¢å¤–æˆæœ¬</td>\n</tr>\n<tr>\n<td>Ingress</td>\n<td>å¼ºå¤§çš„è·¯ç”±å’ŒåŸŸåæ”¯æŒï¼Œç”Ÿäº§ç¯å¢ƒ</td>\n<td>è¦é¢å¤–éƒ¨ç½² Ingress Controller</td>\n</tr>\n<tr>\n<td>ç›´æ¥æš´éœ²(HostPort)</td>\n<td>é…ç½®ç®€å•</td>\n<td>ä¸æ¨èï¼Œç ´åæŠ½è±¡ï¼Œéš¾ä»¥æ‰©å±•å’Œç®¡ç†</td>\n</tr>\n</tbody>\n</table>\n<p>è°ƒåº¦æ˜¯æŒ‡å°†Podæ”¾ç½®åˆ°åˆé€‚çš„èŠ‚ç‚¹ä¸Šï¼Œä»¥ä¾¿å¯¹åº”èŠ‚ç‚¹ä¸Šè¿â¾Pod<br>\nè°ƒåº¦å™¨é€šè¿‡K8sçš„ç›‘æµ‹Watchæœºåˆ¶æ¥å‘ç°é›†ç¾¤ä¸­æ–°åˆ›å»ºä¸”å°šæœªè¢«è°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šçš„Podã€‚è°ƒåº¦å™¨ä¼šå°†å‘ç°çš„æ¯ä¸ªæœªè°ƒåº¦çš„Podè°ƒåº¦åˆ°åˆé€‚çš„èŠ‚ç‚¹ä¸Šè¿â¾</p>\n<p>kube-scheduleræ˜¯é»˜è®¤è°ƒåº¦å™¨ï¼Œåœ¨è®¾è®¡ä¸Šå…è®¸ä½ â¾ƒâ¼°ç¼–å†™â¼€ä¸ªè°ƒåº¦ç»„ä»¶å¹¶æ›¿æ¢åŸæœ‰çš„kube-scheduler<br>\nKube-scheduleré€‰æ‹©â¼€ä¸ªæœ€ä½³èŠ‚ç‚¹æ¥è¿â¾æ–°å»ºæˆ–å°šæœªè°ƒåº¦ï¼ˆunscheduledï¼‰çš„Podã€‚ç”±äºPodä¸­çš„å®¹å™¨å’ŒPodæœ¬èº«å¯èƒ½æœ‰ä¸åŒçš„è¦æ±‚ï¼Œè°ƒåº¦ç¨‹åºä¼šè¿‡æ»¤æ‰ä»»ä½•ä¸æ»¡â¾œPodç‰¹å®šè°ƒåº¦éœ€æ±‚çš„èŠ‚ç‚¹ã€‚APIå…è®¸åœ¨åˆ›å»ºPodæ—¶æŒ‡å®šèŠ‚ç‚¹<br>\næ»¡â¾œPodè°ƒåº¦è¯·æ±‚çš„æ‰€æœ‰èŠ‚ç‚¹ç§°ä¹‹ä¸ºå¯è°ƒåº¦èŠ‚ç‚¹ã€‚å¦‚æœæ²¡æœ‰èŠ‚ç‚¹èƒ½æ»¡â¾œPodçš„èµ„æºè¯·æ±‚ï¼Œé‚£ä¹ˆPodå°†â¼€ç›´åœç•™åœ¨æœªè°ƒåº¦çŠ¶æ€ç›´åˆ°è°ƒåº¦å™¨æ‰¾åˆ°åˆé€‚èŠ‚ç‚¹<br>\nè°ƒåº¦å™¨å…ˆæ‰¾åˆ°â¼€ä¸ªPodçš„æ‰€æœ‰å¯è°ƒåº¦èŠ‚ç‚¹ï¼Œç„¶åå¯¹å¯è°ƒåº¦èŠ‚ç‚¹æ‰“åˆ†ï¼Œé€‰å‡ºå…¶ä¸­å¾—åˆ†æœ€â¾¼çš„èŠ‚ç‚¹æ¥è¿â¾Podã€‚è°ƒåº¦å™¨å°†è°ƒåº¦å†³å®šé€šçŸ¥ç»™kube-apiserverï¼Œè¿™ä¸ªè¿‡ç¨‹å«åšç»‘å®š<br>\nåšè°ƒåº¦å†³å®šæ—¶è¦è€ƒè™‘çš„å› ç´ ï¼šå•ç‹¬å’Œæ•´ä½“çš„èµ„æºè¯·æ±‚ã€ç¡¬ä»¶/è½¯ä»¶/ç­–ç•¥é™åˆ¶ã€äº²å’Œä»¥åŠåäº²å’Œè¦æ±‚ã€æ•°æ®å±€éƒ¨æ€§ã€è´Ÿè½½é—´çš„â¼²æ‰°ç­‰ç­‰ã€‚</p>\n<p>kube-schedulerç»™Podåšè°ƒåº¦é€‰æ‹©æ—¶åŒ…å«ä¸¤ä¸ªæ­¥éª¤<br>\nè¿‡æ»¤é˜¶æ®µï¼šå°†æ‰€æœ‰æ»¡â¾œPodè°ƒåº¦éœ€æ±‚çš„èŠ‚ç‚¹é€‰å‡ºæ¥ã€‚ä¾‹å¦‚PodFitsResourcesè¿‡æ»¤å‡½æ•°ä¼šæ£€æŸ¥å€™é€‰èŠ‚ç‚¹çš„å¯â½¤èµ„æºèƒ½å¦æ»¡â¾œPodçš„èµ„æºè¯·æ±‚ã€‚è¿‡æ»¤åå¾—å‡ºæ‰€æœ‰å¯è°ƒåº¦èŠ‚ç‚¹çš„èŠ‚ç‚¹åˆ—è¡¨ï¼›é€šå¸¸åŒ…å«ä¸â½Œâ¼€ä¸ªèŠ‚ç‚¹ã€‚å¦‚æœè¿™ä¸ªåˆ—è¡¨æ˜¯ç©ºçš„ï¼Œä»£è¡¨Podä¸å¯è°ƒåº¦<br>\næ‰“åˆ†é˜¶æ®µï¼šä¸ºPodä»æ‰€æœ‰å¯è°ƒåº¦èŠ‚ç‚¹ä¸­é€‰å–æœ€åˆé€‚çš„èŠ‚ç‚¹ã€‚æ ¹æ®æ‰“åˆ†è§„åˆ™ç»™æ¯â¼€ä¸ªå¯è°ƒåº¦èŠ‚ç‚¹æ‰“åˆ†ã€‚æœ€åå°†Podè°ƒåº¦åˆ°å¾—åˆ†æœ€â¾¼çš„èŠ‚ç‚¹ä¸Šã€‚å¦‚æœå­˜åœ¨å¤šä¸ªå¾—åˆ†æœ€â¾¼çš„èŠ‚ç‚¹ï¼Œåˆ™ä»ä¸­éšæœºé€‰å–â¼€ä¸ª</p>\n<p>è¿‡æ»¤å’Œæ‰“åˆ†é…ç½®<br>\nè°ƒåº¦ç­–ç•¥ï¼šé…ç½®è¿‡æ»¤æ‰€â½¤çš„æ–­â¾”ï¼ˆPredicatesï¼‰å’Œæ‰“åˆ†ä¼˜å…ˆçº§ï¼ˆPrioritiesï¼‰<br>\nè°ƒåº¦é…ç½®ï¼šé…ç½®å®ç°ä¸åŒè°ƒåº¦é˜¶æ®µçš„æ’ä»¶ï¼ŒåŒ…æ‹¬QueueSortã€Filterã€Scoreã€Bindã€Reserveã€Permitç­‰</p>\n<p>Affinityäº²å’Œæ€§ï¼šå½“æ»¡â¾œäº†æŸäº›æ¡ä»¶å°±æŠŠPodè°ƒåº¦åˆ°é›†ç¾¤ä¸Šã€‚Anti-Affinityç›¸åï¼Œ~ä¸æŠŠPodè°ƒåº¦åˆ°é›†ç¾¤ä¸Š.<br>\nTaintæ±¡ç‚¹å’ŒTolerationå®¹å¿ï¼ŒTaintæä¾›Nodeçš„æ ‡è®°ï¼Œä½†æ ‡è®°ä¸æ˜¯Labelï¼Œå½“è®¾ç½®å¥½Taintåï¼Œæ»¡â¾œTolerationçš„Podå°†å¯ä»¥éƒ¨ç½²åˆ°è¯¥Nodeä¸Šã€‚</p>\n<p>Node Selectorå’ŒLabelå¯ä»¥å®ç°ç²¾ç¡®ç­›é€‰</p>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token comment\"># æ–°å¢æœ‰nodeSelectorçš„Pod</span>\nmkdir/etc/k8s\ncd/etc/k8s\ncat<span class=\"token operator\">&gt;</span> pod-nginx.yaml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-nginx\nspec:\n  containers:\n    - name: container-nginx\n      image: nginx:1.20.2-alpine\n      ports:\n        - containerPort: 80\n  nodeSelector:\n    disk: ssd # æ”¾ç½®åˆ°å…·æœ‰ \"disk=ssd\" æ ‡ç­¾çš„èŠ‚ç‚¹ä¸Š\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> pod-nginx.yaml\nkubectl apply <span class=\"token parameter variable\">-f</span> pod-nginx.yaml\n\n<span class=\"token comment\"># æ£€æŸ¥é›†ç¾¤çš„NodeçŠ¶æ€ï¼ŒåŒ…å«Labelsï¼Œå¤„äºPendingçŠ¶æ€ï¼Œdescribeä¹Ÿæç¤ºâ½†æ³•åŒ¹é…</span>\nkubectl get po\nNAME READY STATUS RESTARTS AGE\npod-nginx <span class=\"token number\">0</span>/1 Pending <span class=\"token number\">0</span> 24s\n\nkubectl get no --show-labels\nkubectl describe po pod-nginx\nWarning  FailedScheduling  6s    default-scheduler  <span class=\"token number\">0</span>/1 nodes are available: <span class=\"token number\">1</span> node<span class=\"token punctuation\">(</span>s<span class=\"token punctuation\">)</span> didn<span class=\"token string\">'t match Pod'</span>s <span class=\"token function\">node</span> affinity/selector. preemption: <span class=\"token number\">0</span>/1 nodes are available: <span class=\"token number\">1</span> Preemption is not helpful <span class=\"token keyword\">for</span> scheduling.\n<span class=\"token comment\"># æ–°å¢disk=ssdçš„Labelå¹¶æ£€æŸ¥</span>\nkubectl label nodes node1 <span class=\"token assign-left variable\">disk</span><span class=\"token operator\">=</span>ssd\nkubectl get no --show-labels\n\n<span class=\"token comment\"># â¼œå¼€å§‹è·‘äº†ï¼Œå¦‚æœå†åº¦æ£€æŸ¥describeçš„è®¯æ¯ä¸­çš„Eventä¼šå‘ç°ï¼š</span>\nkubectl describe po pod-nginx\n<span class=\"token comment\"># è¦åˆ é™¤æ ‡ç­¾ï¼Œéœ€è¦çš„keyåâ¾¯å¢åŠ å‡å·å³å¯</span>\nkubectl label <span class=\"token function\">node</span> node1 disk-\n</code></pre></div><p>Affinityåˆ†ç±»<br>\n1ã€Node Affinityï¼šå’ŒNode Selectorä¸åŒçš„æ˜¯ï¼Œå®ƒä¼šæœ‰æ›´å¤šç»†ç·»çš„æ“ä½œï¼ŒNodeSelectorçœ‹æˆæ˜¯ç®€æ˜“ç‰ˆçš„NodeAffinityï¼Œ<br>\nä¸¤ç§ç­–ç•¥ï¼š<br>\npreferredDuringSchedulingIgnoredDuringExecutionï¼šè½¯ç­–ç•¥ï¼Œå¯ä»¥ä¸æ»¡â¾œ<br>\nrequiredDuringSchedulingIgnoredDuringExecutionï¼šç¡¬ç­–ç•¥ï¼Œâ¼€å®šè¦æ»¡â¾œ</p>\n<p>matchExpressionsçš„key<br>\n<a href=\"http://kubernetes.io/hostname\" target=\"_blank\" rel=\"noopener noreferrer\">kubernetes.io/hostname</a><br>\n<a href=\"http://failure-domain.beta.kubernetes.io/zone\" target=\"_blank\" rel=\"noopener noreferrer\">failure-domain.beta.kubernetes.io/zone</a><br>\n<a href=\"http://failure-domain.beta.kubernetes.io/region\" target=\"_blank\" rel=\"noopener noreferrer\">failure-domain.beta.kubernetes.io/region</a><br>\n<a href=\"http://beta.kubernetes.io/instance-type\" target=\"_blank\" rel=\"noopener noreferrer\">beta.kubernetes.io/instance-type</a><br>\n<a href=\"http://beta.kubernetes.io/os\" target=\"_blank\" rel=\"noopener noreferrer\">beta.kubernetes.io/os</a><br>\n<a href=\"http://beta.kubernetes.io/arch\" target=\"_blank\" rel=\"noopener noreferrer\">beta.kubernetes.io/arch</a></p>\n<p>operatoræ“ä½œç¬¦<br>\nInï¼šLabelçš„å€¼åœ¨æŸä¸ªåˆ—è¡¨ä¸­<br>\nNotInï¼šLabelçš„å€¼ä¸åœ¨æŸä¸ªåˆ—è¡¨ä¸­<br>\nGtï¼šLabelçš„å€¼â¼¤äºæŸä¸ªå€¼<br>\nLtï¼šLabelçš„å€¼â¼©äºæŸä¸ªå€¼<br>\nExistsï¼šæŸä¸ªLabelå­˜åœ¨<br>\nDoesNotExistï¼šæŸä¸ªLabelä¸å­˜åœ¨</p>\n<p>weightæƒé‡1~100ï¼Œè¶Šâ¾¼è¶Šä¼˜å…ˆè€ƒè™‘</p>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token comment\"># æ–°çš„Podä¸å…è®¸éƒ¨ç½²åœ¨Node0ä¸Šï¼Œåœ¨å‰©ä½™èŠ‚ç‚¹ä¸­ä¼˜å…ˆéƒ¨ç½²åœ¨disk=ssdçš„Nodeä¸Š</span>\n<span class=\"token function\">mkdir</span> /etc/k8s\n<span class=\"token builtin class-name\">cd</span> /etc/k8s\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> pod-nginx.yaml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: Pod\nmetadata:\n  name: pod-nginx\nspec:\n  containers:\n    - name: container-nginx\n      image: nginx:1.20.2-alpine\n      ports:\n        - containerPort: 80\n  affinity:\n    nodeAffinity:\n      requiredDuringSchedulingIgnoredDuringExecution:\n        nodeSelectorTerms:\n          - matchExpressions:\n              - key: kubernetes.io/hostname\n                operator: NotIn\n                values:\n                  - node0\n      preferredDuringSchedulingIgnoredDuringExecution:\n        - weight: 1\n          preference:\n            matchExpressions:\n              - key: disk\n                operator: In\n                values:\n                  - ssd\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> pod-nginx.yaml\nkubectl apply <span class=\"token parameter variable\">-f</span> pod-nginx.yaml\n\nkubectl get po <span class=\"token parameter variable\">-o</span> wide\nNAME READY STATUS RESTARTS AGE IP NODE NOMI\npod-nginx <span class=\"token number\">1</span>/1 Running <span class=\"token number\">0</span> 6s <span class=\"token number\">10.244</span>.0.147 minikube <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">&gt;</span> <span class=\"token operator\">&lt;</span>none<span class=\"token operator\">&gt;</span>\n\n</code></pre></div><p>2ã€Pod Affinity<br>\nä¹Ÿæœ‰ä¸¤ç§ç±»å‹ï¼š<br>\nrequiredDuringSchedulingIgnoredDuringExecution<br>\npreferredDuringSchedulingIgnoredDuringExecution<br>\nPodé—´äº²å’Œæ€§ï¼Œâ½¤Podè§„çº¦ä¸­çš„.affinity.podAffinityå­—æ®µ<br>\nPodé—´åäº²å’Œæ€§ï¼Œâ½¤Podè§„çº¦ä¸­çš„.affinity.podAntiAffinityå­—æ®µ</p>\n<figure><img src=\"https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwe93f41f0fe17e1e3a3bf470704ee8ff5.png\" alt=\"affinity.png\" tabindex=\"0\"><figcaption>affinity.png</figcaption></figure>\n<p>äº²å’Œæ€§è§„åˆ™ï¼šä»…å½“èŠ‚ç‚¹å’Œâ¾„å°‘â¼€ä¸ªå·²è¿â¾ä¸”æœ‰security=S1çš„æ ‡ç­¾çš„Podå¤„äºåŒâ¼€åŒºåŸŸæ—¶ï¼Œæ‰å¯ä»¥å°†è¯¥Podè°ƒåº¦åˆ°èŠ‚ç‚¹ä¸Šã€‚æ›´ç¡®åˆ‡è¯´ï¼Œ<a href=\"http://xn--Podtopology-rb7re9edv2ddiictew32bed3lxr0b.kubernetes.io/zone=V%E6%A0%87%E7%AD%BE%E7%9A%84%E8%8A%82%E7%82%B9%E4%B8%8A%EF%BC%8C%E5%B9%B6%E4%B8%94%E9%9B%86%E7%BE%A4%E4%B8%AD%E2%BE%84%E5%B0%91%E6%9C%89%E2%BC%80%E4%B8%AA%E4%BD%8D%E4%BA%8E%E8%AF%A5%E5%8F%AF%E2%BD%A4%E5%8C%BA%E7%9A%84%E8%8A%82%E7%82%B9%E4%B8%8A%E8%BF%90%E2%BE%8F%E7%9D%80%E5%B8%A6%E6%9C%89security=S1%E6%A0%87%E7%AD%BE%E7%9A%84Pod%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">å¿…é¡»å°†Podè°ƒåº¦åˆ°å…·æœ‰topology.kubernetes.io/zone=Væ ‡ç­¾çš„èŠ‚ç‚¹ä¸Šï¼Œå¹¶ä¸”é›†ç¾¤ä¸­â¾„å°‘æœ‰â¼€ä¸ªä½äºè¯¥å¯â½¤åŒºçš„èŠ‚ç‚¹ä¸Šè¿â¾ç€å¸¦æœ‰security=S1æ ‡ç­¾çš„Podã€‚</a><br>\nåäº²å’Œæ€§è§„åˆ™ï¼šå¦‚æœèŠ‚ç‚¹å¤„äºPodæ‰€åœ¨çš„åŒâ¼€å¯â½¤åŒºä¸”â¾„å°‘â¼€ä¸ªPodå…·æœ‰security=S2æ ‡ç­¾ï¼Œåˆ™è¯¥Podä¸åº”è¢«è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ä¸Šã€‚æ›´ç¡®åˆ‡è¯´ï¼Œå¦‚æœåŒâ¼€å¯â½¤åŒºä¸­å­˜åœ¨å…¶ä»–è¿â¾ç€å¸¦æœ‰security=S2æ ‡ç­¾çš„PodèŠ‚ç‚¹ï¼Œ<a href=\"http://xn--topology-459lv3zuj1bwrvm4cl47bx07a5px.kubernetes.io/zone=R%EF%BC%8CPod%E4%B8%8D%E8%83%BD%E8%A2%AB%E8%B0%83%E5%BA%A6%E5%88%B0%E8%AF%A5%E8%8A%82%E7%82%B9%E4%B8%8A\" target=\"_blank\" rel=\"noopener noreferrer\">å¹¶ä¸”èŠ‚ç‚¹å…·æœ‰æ ‡ç­¾topology.kubernetes.io/zone=Rï¼ŒPodä¸èƒ½è¢«è°ƒåº¦åˆ°è¯¥èŠ‚ç‚¹ä¸Š</a></p>\n<div class=\"language-yaml\" data-ext=\"yml\" data-title=\"yml\"><pre class=\"language-yaml\"><code><span class=\"token key atrule\">apiVersion</span><span class=\"token punctuation\">:</span> v1\n<span class=\"token key atrule\">kind</span><span class=\"token punctuation\">:</span> Pod\n<span class=\"token key atrule\">metadata</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> with<span class=\"token punctuation\">-</span>pod<span class=\"token punctuation\">-</span>affinity\n<span class=\"token key atrule\">spec</span><span class=\"token punctuation\">:</span>\n  <span class=\"token key atrule\">affinity</span><span class=\"token punctuation\">:</span>\n    <span class=\"token key atrule\">podAffinity</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">requiredDuringSchedulingIgnoredDuringExecution</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">labelSelector</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n              <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> security\n                <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n                <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n                  <span class=\"token punctuation\">-</span> S1\n          <span class=\"token key atrule\">topologyKey</span><span class=\"token punctuation\">:</span> topology.kubernetes.io/zone\n    <span class=\"token key atrule\">podAntiAffinity</span><span class=\"token punctuation\">:</span>\n      <span class=\"token key atrule\">preferredDuringSchedulingIgnoredDuringExecution</span><span class=\"token punctuation\">:</span>\n        <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">weight</span><span class=\"token punctuation\">:</span> <span class=\"token number\">100</span>\n          <span class=\"token key atrule\">podAffinityTerm</span><span class=\"token punctuation\">:</span>\n            <span class=\"token key atrule\">labelSelector</span><span class=\"token punctuation\">:</span>\n              <span class=\"token key atrule\">matchExpressions</span><span class=\"token punctuation\">:</span>\n                <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">key</span><span class=\"token punctuation\">:</span> security\n                  <span class=\"token key atrule\">operator</span><span class=\"token punctuation\">:</span> In\n                  <span class=\"token key atrule\">values</span><span class=\"token punctuation\">:</span>\n                    <span class=\"token punctuation\">-</span> S2\n            <span class=\"token key atrule\">topologyKey</span><span class=\"token punctuation\">:</span> topology.kubernetes.io/zone\n  <span class=\"token key atrule\">containers</span><span class=\"token punctuation\">:</span>\n    <span class=\"token punctuation\">-</span> <span class=\"token key atrule\">name</span><span class=\"token punctuation\">:</span> with<span class=\"token punctuation\">-</span>pod<span class=\"token punctuation\">-</span>affinity\n      <span class=\"token key atrule\">image</span><span class=\"token punctuation\">:</span> registry.k8s.io/pause<span class=\"token punctuation\">:</span><span class=\"token number\">2.0</span>\n</code></pre></div><p>æ±¡ç‚¹ï¼ˆTaintï¼‰ä¸å®¹å¿åº¦ï¼ˆTolerationï¼‰<br>\nèŠ‚ç‚¹äº²å’Œæ€§æ˜¯Podçš„å±æ€§ï¼Œä½¿Podè¢«å¸å¼•åˆ°ç‰¹å®šçš„èŠ‚ç‚¹ï¼ˆå‡ºäºåå¥½æˆ–ç¡¬æ€§è¦æ±‚ï¼‰<br>\næ±¡ç‚¹ï¼ˆTaintï¼‰ç›¸åï¼Œä½¿èŠ‚ç‚¹æ’æ–¥ç‰¹å®šçš„Pod<br>\nå®¹å¿åº¦ï¼ˆTolerationï¼‰â½¤äºPodã€‚å…è®¸è°ƒåº¦å™¨è°ƒåº¦å¸¦æœ‰å¯¹åº”æ±¡ç‚¹çš„Podã€‚ä½†å¹¶ä¸ä¿è¯è°ƒåº¦<br>\næ±¡ç‚¹å’Œå®¹å¿åº¦é…åˆâ½¤æ¥é¿å…Podè¢«åˆ†é…åˆ°ä¸åˆé€‚çš„èŠ‚ç‚¹ä¸Š</p>\n<p>Taintçš„ç­–ç•¥ï¼š<br>\nNoScheduleï¼šPODä¸ä¼šè¢«è°ƒåº¦åˆ°æ ‡è®°ä¸ºtaintsèŠ‚ç‚¹ã€‚<br>\nPreferNoScheduleï¼šNoScheduleçš„è½¯ç­–ç•¥ç‰ˆæœ¬ã€‚<br>\nNoExecuteï¼šâ¼€æ—¦Taintâ½£æ•ˆï¼Œå¦‚è¯¥èŠ‚ç‚¹å†…æ­£åœ¨è¿â¾çš„PODæ²¡æœ‰å¯¹åº”Tolerateè®¾ç½®ä¼šè¢«é€å‡º</p>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token comment\"># è®¾ç½®æ±¡ç‚¹</span>\nkubectl taint nodes node0 <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>nginx:NoSchedule\n\n<span class=\"token comment\"># å»é™¤æ±¡ç‚¹</span>\nkubectl taint nodes node0 <span class=\"token assign-left variable\">app</span><span class=\"token operator\">=</span>nginx:NoSchedule-\n\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> deploy-nginx.yaml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  containers:\n    - name: nginx\n      image: nginx:1.20.2-alpine\n      imagePullPolicy: IfNotPresent\n      ports:\n        - containerPort: 80\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> deploy-nginx.yaml\nkubectl apply <span class=\"token parameter variable\">-f</span> deploy-nginx.yaml\n\n<span class=\"token comment\"># æ²¡æœ‰ä»»ä½•â¼€å°æœåŠ¡å™¨å¯ä»¥éƒ¨ç½²ï¼Œå› ä¸ºæ‰€æœ‰nodeè®¤ä¸ºapp=nginxæ˜¯æ±¡ç‚¹ï¼Œä¸äºˆéƒ¨ç½²</span>\nkubectl get po\nnginx <span class=\"token number\">0</span>/1 Pending <span class=\"token number\">0</span> 2m9s\n\n<span class=\"token comment\"># è®¾ç½®å®¹å¿åº¦ï¼Œå…è®¸app=nginxéƒ¨ç½²åœ¨app=nginx:NoScheduleçš„èŠ‚ç‚¹ä¸Š</span>\n\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> deploy-nginx.yaml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: Pod\nmetadata:\n  name: nginx\n  labels:\n    app: nginx\nspec:\n  containers:\n    - name: nginx\n      image: nginx:1.20.2-alpine\n      imagePullPolicy: IfNotPresent\n      ports:\n        - containerPort: 80\n  tolerations:\n    - key: \"app\"\n      operator: \"Equal\"\n      value: \"nginx\"\n      effect: \"NoSchedule\"\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> deploy-nginx.yaml\nkubectl apply <span class=\"token parameter variable\">-f</span> deploy-nginx.yaml\n\n<span class=\"token comment\"># æœ‰äº†</span>\nkubectl get po <span class=\"token parameter variable\">-o</span> wide\nnginx <span class=\"token number\">1</span>/1 Running <span class=\"token number\">0</span> 2m9s\n</code></pre></div><p>LimitRangeä¸ResourceQuota<br>\nLimitRangeï¼ˆé™åˆ¶èŒƒå›´ï¼‰<br>\né»˜è®¤æƒ…å†µä¸‹ï¼ŒK8sé›†ç¾¤ä¸Šçš„å®¹å™¨è¿â¾ä½¿â½¤çš„è®¡ç®—èµ„æºæ²¡æœ‰é™åˆ¶<br>\nä½¿â½¤èµ„æºé…é¢å¯ä»¥åœ¨â¼€ä¸ªæŒ‡å®šçš„å‘½åç©ºé—´å†…é™åˆ¶é›†ç¾¤èµ„æºçš„ä½¿â½¤ä¸åˆ›å»º<br>\nâ¼€ä¸ªPodæœ€å¤šèƒ½å¤Ÿä½¿â½¤å‘½åç©ºé—´çš„èµ„æºé…é¢æ‰€å®šä¹‰çš„CPUå’Œå†…å­˜â½¤é‡<br>\nLimitRangeæ˜¯é™åˆ¶å‘½åç©ºé—´å†…æ¯ä¸ªé€‚â½¤çš„å¯¹è±¡ç±»åˆ«ï¼ˆä¾‹å¦‚Podæˆ–PersistentVolumeClaimï¼‰æŒ‡å®šçš„èµ„æºåˆ†é…é‡ï¼ˆé™åˆ¶å’Œè¯·æ±‚ï¼‰çš„ç­–ç•¥å¯¹è±¡</p>\n<p>LimitRangeå¯¹è±¡èƒ½å¤Ÿé™åˆ¶åœ¨â¼€ä¸ªå‘½åç©ºé—´ä¸­å®æ–½ï¼š<br>\nå¯¹æ¯ä¸ªPodæˆ–Containeræœ€â¼©å’Œæœ€â¼¤çš„èµ„æºä½¿â½¤é‡çš„é™åˆ¶ã€‚<br>\nå¯¹æ¯ä¸ªPersistentVolumeClaimèƒ½ç”³è¯·çš„æœ€â¼©å’Œæœ€â¼¤çš„å­˜å‚¨ç©ºé—´â¼¤â¼©çš„é™åˆ¶ã€‚<br>\nå¯¹â¼€ç§èµ„æºçš„ç”³è¯·å€¼å’Œé™åˆ¶å€¼çš„â½å€¼çš„æ§åˆ¶ã€‚<br>\nå¯¹è®¡ç®—èµ„æºçš„é»˜è®¤ç”³è¯·/é™åˆ¶å€¼ï¼Œå¹¶ä¸”â¾ƒåŠ¨çš„åœ¨è¿â¾æ—¶æ³¨â¼Šåˆ°å¤šä¸ªContainerä¸­ã€‚</p>\n<p>LimitRangeé»˜è®¤å€¼å¯èƒ½â¼©äºå®¢æˆ·ç«¯æäº¤ç»™APIæœåŠ¡å™¨çš„è§„çº¦ä¸­ä¸ºå®¹å™¨æŒ‡å®šçš„requestå€¼å¯¼è‡´Podå°†â½†æ³•è°ƒåº¦</p>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> myRange.yml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: LimitRange\nmetadata:\n  name: cpu-resource-constraint\nspec:\n  limits:\n  - default: \n      cpu: \"500m\" # é»˜è®¤é™åˆ¶å€¼\n    defaultRequest: \n      cpu: \"500m\" # é»˜è®¤è¯·æ±‚å€¼\n    max: \n      cpu: \"1\" # æœ€å¤§å€¼\n    min: \n      cpu: \"100m\" # æœ€å°å€¼\n    type: Container # é™åˆ¶ç±»å‹ä¸ºå®¹å™¨\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> myRange.yml\nkubectl apply <span class=\"token parameter variable\">-f</span> myRange.yml\n\n<span class=\"token comment\"># K8så…è®¸å°†CPUçš„é™é¢è®¾ç½®ä¸ºåˆ†æ•°ï¼Œâ½å¦‚CPU.limits=500mï¼Œ500milliCPUï¼Œ0.5ä¸ªCPUï¼ŒPodå°±ä¼šè¢«åˆ†åˆ°â¼€ä¸ªCPUâ¼€åŠè®¡ç®—èƒ½â¼’ã€‚ç­‰ä»·äºcpu=0.5ï¼Œä¸è¿‡å®˜â½…æ¨è500m</span>\n<span class=\"token comment\"># å†…å­˜èµ„æºçš„å•ä½æ˜¯bytesï¼Œâ½€æŒä½¿â½¤Eiï¼ŒPiï¼ŒTiï¼ŒGiï¼ŒMiï¼ŒKiçš„â½…å¼ä½œä¸ºbytesçš„å€¼ï¼Œè¦æ³¨æ„Miå’ŒMçš„åŒºåˆ«ï¼ˆ1Mi=10241024ï¼Œ1M=10001000ï¼‰ã€‚</span>\n\n<span class=\"token comment\"># å£°æ˜CPUèµ„æºè¯·æ±‚ä¸º700mä½†æœªå£°æ˜limitçš„Podï¼šPodå°†ä¸ä¼šè¢«è°ƒåº¦ï¼Œå¤±è´¥å¹¶å‡ºç°ç±»ä¼¼ä»¥ä¸‹çš„é”™è¯¯ï¼š</span>\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> conflict.yml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example-conflict-with-limitrange-cpu\nspec:\n  containers:\n  - name: demo\n    image: registry.k8s.io/pause:2.0\n    resources:\n      requests:\n        cpu: \"700m\"\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> conflict.yml\nkubectl apply <span class=\"token parameter variable\">-f</span> conflict.yml\nPod <span class=\"token string\">\"example-conflict-with-limitrange-cpu\"</span> is invalid: spec.containers<span class=\"token punctuation\">[</span><span class=\"token number\">0</span><span class=\"token punctuation\">]</span>.resources.requests: Invalid value: <span class=\"token string\">\"700m\"</span><span class=\"token builtin class-name\">:</span> must be <span class=\"token function\">less</span> than or equal to cpu limit\n\n<span class=\"token comment\"># å¦‚æœä½ åŒæ—¶è®¾ç½®äº†requestå’Œlimitï¼Œå³ä½¿ç›¸åŒçš„LimitRangeï¼Œæ–°Podä¹Ÿä¼šè¢«æˆåŠŸè°ƒåº¦ï¼š</span>\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> conflict.yml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: v1\nkind: Pod\nmetadata:\n  name: example-no-conflict-with-limitrange-cpu\nspec:\n  containers:\n  - name: demo\n    image: registry.k8s.io/pause:2.0\n    resources:\n      requests:\n        cpu: \"700m\"\n      limits:\n        cpu: \"700m\"\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> conflict.yml\nkubectl apply <span class=\"token parameter variable\">-f</span> conflict.yml\n</code></pre></div><p>Resource Quotaï¼ˆèµ„æºé…é¢ï¼‰<br>\nèµ„æºé…é¢ï¼Œé€šè¿‡ResourceQuotaå¯¹è±¡æ¥å®šä¹‰ï¼Œå¯¹æ¯ä¸ªå‘½åç©ºé—´çš„èµ„æºæ¶ˆè€—æ€»é‡ã€æŸç§ç±»å‹çš„å¯¹è±¡çš„æ€»æ•°â½¬ã€Podå¯ä»¥ä½¿â½¤çš„è®¡ç®—èµ„æºæä¾›é™åˆ¶<br>\né…é¢æœºåˆ¶æ‰€â½€æŒçš„èµ„æºç±»å‹ï¼š</p>\n<figure><img src=\"https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwee6ca4ddffd533cb55dd4b91337023be.png\" alt=\"limits.png\" tabindex=\"0\"><figcaption>limits.png</figcaption></figure>\n<p>ä¸åŒçš„å›¢é˜Ÿå¯ä»¥åœ¨ä¸åŒçš„å‘½åç©ºé—´ä¸‹â¼¯ä½œã€‚é€šè¿‡RBACå¼ºåˆ¶æ‰§â¾ã€‚é›†ç¾¤ç®¡ç†å‘˜å¯ä¸ºæ¯ä¸ªå‘½åç©ºé—´åˆ›å»ºâ¼€ä¸ªæˆ–å¤šä¸ªResourceQuotaå¯¹è±¡ã€‚<br>\nå½“â½¤æˆ·åœ¨å‘½åç©ºé—´ä¸‹åˆ›å»ºèµ„æºï¼ˆå¦‚Podã€Serviceç­‰ï¼‰æ—¶ï¼Œé…é¢ç³»ç»Ÿä¼šè·Ÿè¸ªé›†ç¾¤çš„èµ„æºä½¿â½¤æƒ…å†µï¼Œç¡®ä¿ä½¿â½¤çš„èµ„æºâ½¤é‡ä¸è¶…è¿‡ResourceQuotaä¸­å®šä¹‰çš„ç¡¬æ€§èµ„æºé™é¢ã€‚<br>\nå¦‚æœèµ„æºåˆ›å»ºæˆ–è€…æ›´æ–°è¯·æ±‚è¿åäº†é…é¢çº¦æŸï¼Œé‚£ä¹ˆè¯¥è¯·æ±‚ä¼šæŠ¥é”™ï¼ˆHTTP403FORBIDDENï¼‰ï¼Œå¹¶åœ¨æ¶ˆæ¯ä¸­ç»™å‡ºæœ‰å¯èƒ½è¿åçš„çº¦æŸã€‚<br>\nå¦‚æœå‘½åç©ºé—´ä¸‹çš„è®¡ç®—èµ„æºcpuå’Œmemoryçš„é…é¢è¢«å¯â½¤ï¼Œåˆ™å¿…é¡»è®¾å®šè¯·æ±‚å€¼ï¼ˆrequestï¼‰å’Œçº¦æŸå€¼ï¼ˆlimitï¼‰ï¼Œå¦åˆ™é…é¢ç³»ç»Ÿå°†æ‹’ç»Podçš„åˆ›å»ºã€‚å¯â½¤LimitRangerå‡†â¼Šæ§åˆ¶å™¨æ¥ä¸ºæ²¡æœ‰è®¾ç½®è®¡ç®—èµ„æºéœ€æ±‚çš„Podè®¾ç½®é»˜è®¤å€¼<br>\nå¯¹äºå…¶ä»–èµ„æºï¼šâ½†éœ€ä¸ºè¯¥èµ„æºè®¾ç½®é™åˆ¶æˆ–è¯·æ±‚ã€‚å¦‚æœèµ„æºé…é¢é™åˆ¶äº†æ­¤å‘½åç©ºé—´çš„ä¸´æ—¶å­˜å‚¨ï¼Œåˆ™å¯ä»¥åˆ›å»ºæ²¡æœ‰é™åˆ¶/è¯·æ±‚ä¸´æ—¶å­˜å‚¨çš„æ–°Podã€‚å¯â½¤é™åˆ¶èŒƒå›´â¾ƒåŠ¨è®¾ç½®å¯¹è¿™äº›èµ„æºçš„é»˜è®¤è¯·æ±‚</p>\n<p>åœ¨å…·æœ‰32GiBå†…å­˜å’Œ16æ ¸CPUèµ„æºçš„é›†ç¾¤ä¸­ï¼Œå…è®¸Aå›¢é˜Ÿâ½¤20GiBå†…å­˜å’Œ10æ ¸çš„CPUèµ„æºï¼ŒBå›¢é˜Ÿâ½¤10GiBå†…å­˜å’Œ4æ ¸çš„CPUèµ„æºï¼Œé¢„ç•™2GiBå†…å­˜å’Œ2æ ¸çš„CPUèµ„æºä¾›å°†æ¥åˆ†é…ã€‚é™åˆ¶\"testing\"å‘½åç©ºé—´ä½¿â½¤1æ ¸CPUèµ„æºå’Œ1GiBå†…å­˜ã€‚å…è®¸\"production\"å‘½åç©ºé—´ä½¿â½¤ä»»æ„æ•°é‡</p>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token comment\"># æŸ¥çœ‹æ˜¯å¦æ”¯æŒ</span>\nkubectl api-resources <span class=\"token operator\">|</span> <span class=\"token function\">grep</span> resourcequota\nresourcequotas <span class=\"token function\">quota</span>  v1 <span class=\"token boolean\">true</span> ResourceQuota\n\n<span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> helloworld.yml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'\napiVersion: apps/v1\nkind: Deployment\nmetadata:\n  name: helloworld-deployment\n  namespace: myspace\nspec:\n  replicas: 3\n  selector:\n    matchLabels:\n      app: helloworld\n  template:\n    metadata:\n      labels:\n        app: helloworld\n    spec:\n      containers:\n      - name: k8s-demo\n        image: 105552010/k8s-demo\n        ports:\n        - name: nodejs-port\n          containerPort: 3000\n        resources:\n          requests:\n            cpu: \"200m\"\n            memory: \"512Mi\"\n          limits:\n            cpu: \"400m\"\n            memory: \"1Gi\"\nEOF</span>\nkubectl delete <span class=\"token parameter variable\">-f</span> helloworld.yml\nkubectl apply <span class=\"token parameter variable\">-f</span> helloworld.yml\n</code></pre></div><p>å­˜å‚¨èµ„æºé…é¢</p>\n<figure><img src=\"https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwe87568c263d25e19b2d136c7594e72c0.png\" alt=\"storagelimits.png\" tabindex=\"0\"><figcaption>storagelimits.png</figcaption></figure>\n<p>å¦‚æœé’ˆå¯¹\"gold\"storageclassä¸\"bronze\"storageclassè®¾ç½®é…é¢å¯ä»¥å®šä¹‰å¦‚ä¸‹é…é¢ï¼š<br>\n<a href=\"http://gold.storageclass.storage.k8s.io/requests.storage:500Gi\" target=\"_blank\" rel=\"noopener noreferrer\">gold.storageclass.storage.k8s.io/requests.storage:500Gi</a><br>\n<a href=\"http://bronze.storageclass.storage.k8s.io/requests.storage:100Gi\" target=\"_blank\" rel=\"noopener noreferrer\">bronze.storageclass.storage.k8s.io/requests.storage:100Gi</a></p>\n<p>å¯¹è±¡æ•°é‡é™å®š</p>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token function\">cat</span> <span class=\"token operator\">&gt;</span> namespace-quota.yml <span class=\"token operator\">&lt;&lt;-</span><span class=\"token string\">'EOF'</span>\napiVersion: v1\nkind: Namespace\nmetadata:\n  name: myspace\n</code></pre></div>",
      "image": "https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwc1af6a79492ff1fec2341d5f59ee453a.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "è¿ç»´"
      ]
    },
    {
      "title": "linuxæœåŠ¡å™¨æ­å»º",
      "url": "https://javaguide.cn/backend/containerservice/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html",
      "id": "https://javaguide.cn/backend/containerservice/linux%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%90%AD%E5%BB%BA.html",
      "summary": "è®°å½•linuxå®‰è£…å„ç§æœåŠ¡å™¨çš„æ–¹æ³• linux7çš„å®‰è£… 1.png 2.png 3.png 4.png 5.png 6.png 7.png 8.png 9.png 10.png 11.png 12.png 13.png 14.png centosæŸ¥çœ‹ip: ip addr jdk1.7å®‰è£… å®‰è£…JDK17 å®‰è£…tomcat yumå®‰è£…mysql å®‰è£…M...",
      "content_html": "<p>è®°å½•linuxå®‰è£…å„ç§æœåŠ¡å™¨çš„æ–¹æ³•</p>\n<!--more-->\n<h2>linux7çš„å®‰è£…</h2>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/71c1796efe37e96e0628b.png\" alt=\"1.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6e44053497d2ef56f4534.png\" alt=\"2.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1e0c79462792d22eacc18.png\" alt=\"3.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0e340472b9b2523467702.png\" alt=\"4.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4a8f5d63c6d02c4466d4c.png\" alt=\"5.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1e22b257b346f674fb850.png\" alt=\"6.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/986d71aa592cea3f3c998.png\" alt=\"7.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/12da83371510377bf3ba8.png\" alt=\"8.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c4b6234550cc8e1bd2268.png\" alt=\"9.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0d2a0b6967800c5f9be2a.png\" alt=\"10.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f5113dbb606a51484f5bb.png\" alt=\"11.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b18714b9fa515816e1433.png\" alt=\"12.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ce31ccbf61b3e9bd91be0.png\" alt=\"13.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e33b59a7d062218650ec8.png\" alt=\"14.png\"></p>\n<p>centosæŸ¥çœ‹ip: ip addr</p>\n<h2>jdk1.7å®‰è£…</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>jdkçš„è§£å‹\nåœ¨usrç›®å½•ä¸‹sudo mkdir javaæ–°å»º/usr/javaç›®å½•\nå°†jdk-7u55-linux-i586.tar.gzæ”¾åˆ°/usr/javaç›®å½•ä¸‹(puttyæŒ‰tabé”®èƒ½å¿«é€Ÿè¡¥å…¨)\ntar -zxvf jdk-7u55-linux-i586.tar.gz -C /usr/java/è§£å‹åˆ°/usr/java/ç›®å½•\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®jdkç¯å¢ƒå˜é‡\nvim /etc/profileå¦‚æœæ‰¾ä¸åˆ°vimå‘½ä»¤å°±yum install vim\nè¾“å…¥Gåˆ°æ–‡ä»¶æœ«å°¾ï¼Œè¾“å…¥iåœ¨æ–‡ä»¶å°¾éƒ¨æ·»åŠ ï¼š\nJAVA_HOME=/usr/java/jdk1.7.0_55/\nexport PATH=$JAVA_HOME/bin:$PATH\næŒ‰escé€€å‡ºç¼–è¾‘ï¼Œ:wqä¿å­˜å¹¶é€€å‡º\né‡æ–°åŠ è½½ä¸€ä¸‹æ–‡ä»¶:source /etc/profile\næŸ¥çœ‹jdkç‰ˆæœ¬ï¼šjava -version\næŠ¥é”™-bash: /usr/java/jdk1.7.0_55//bin/java: /lib/ld-linux.so.2: bad ELF interpreter: æ²¡æœ‰é‚£ä¸ªæ–‡ä»¶æˆ–ç›®å½•\nåˆ™sudo yum install glibc.i686\nå†æŸ¥çœ‹jdkç‰ˆæœ¬ï¼šjava -version\n</code></pre></div><h2>å®‰è£…JDK17</h2>\n<div class=\"language-bash\" data-ext=\"sh\" data-title=\"sh\"><pre class=\"language-bash\"><code><span class=\"token number\">1</span>. ä¸‹è½½å®‰è£…åŒ…\n<span class=\"token function\">mkdir</span> /home/jdk17\n<span class=\"token function\">wget</span> https://download.oracle.com/java/17/latest/jdk-17_linux-x64_bin.tar.gz <span class=\"token parameter variable\">-P</span> /home/jdk17/openjdk-17.0.0.1+2_linux-x64_bin.tar.gz\n<span class=\"token number\">2</span>. è§£å‹\n<span class=\"token function\">tar</span> xf /home/jdk17/openjdk-17.0.0.1+2_linux-x64_bin.tar.gz <span class=\"token parameter variable\">-C</span> /home/jdk17/\n \n<span class=\"token number\">3</span>. é…ç½®ç¯å¢ƒå˜é‡\n<span class=\"token function\">vim</span> /etc/profileã€€ã€€<span class=\"token comment\">#æœ«å°¾æ·»åŠ å¦‚ä¸‹ä½ç½®</span>\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">JAVA_HOME</span><span class=\"token operator\">=</span>/home/jdk17/jdk-17.0.0.1\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\">CLASSPATH</span><span class=\"token operator\">=</span>.:<span class=\"token variable\">$JAVA_HOME</span>/lib/tools.jar:<span class=\"token variable\">$JAVA_HOME</span>/lib/dt.jar\n<span class=\"token builtin class-name\">export</span> <span class=\"token assign-left variable\"><span class=\"token environment constant\">PATH</span></span><span class=\"token operator\">=</span><span class=\"token variable\">$JAVA_HOME</span>/bin:<span class=\"token environment constant\">$PATH</span>\n \n<span class=\"token number\">4</span>. ä½¿ç¯å¢ƒå˜é‡ç”Ÿæ•ˆ\n<span class=\"token builtin class-name\">source</span> /etc/profile\n \n<span class=\"token number\">5</span>. éªŒè¯\n<span class=\"token function\">java</span>\njavac\n<span class=\"token function\">java</span> <span class=\"token parameter variable\">-version</span>\n</code></pre></div><h2>å®‰è£…tomcat</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>tomcatçš„è§£å‹\nå°†apache-tomcat-7.0.47.tar.gzæ”¾åˆ°/usr/javaç›®å½•ä¸‹\ntar -zxvf apache-tomcat-7.0.47.tar.gz -C /usr/java/å°†tomcatè§£å‹åˆ°/usr/javaç›®å½•ä¸‹\nåˆ°tomcatçš„binç›®å½•ä¸‹æ‰§è¡Œï¼š ./startup.sh å¯åŠ¨tomcat\nåˆ°tomcatçš„logsæ–‡ä»¶å¤¹ä¸‹æ‰§è¡Œ cat catalina.outæŸ¥çœ‹æ‰§è¡Œæƒ…å†µ\nå…³é—­é˜²ç«å¢™:servive iptables stopï¼ˆcentos7ä»¥å‰ï¼‰\nå…³é—­é˜²ç«å¢™:sudo systemctl stop firewalld.service &amp;&amp; sudo systemctl disable firewalld.serviceï¼ˆcentos7ï¼‰\næŸ¥çœ‹æ˜¯å¦å¯åŠ¨æˆåŠŸï¼š æ‰§è¡Œjps è®¿é—®http://192.168.13.123:8080/\n</code></pre></div><h2>yumå®‰è£…mysql</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å®‰è£…å¸¦æœ‰å¯ç”¨çš„mysql5ç³»åˆ—ç¤¾åŒºç‰ˆèµ„æºçš„rpmåŒ…rpm -Uvh http://dev.mysql.com/get/mysql-community-release-el7-5.noarch.rpm\næŸ¥çœ‹å½“å‰å¯ç”¨çš„mysqlå®‰è£…èµ„æºï¼šyum repolist enabled | grep \"mysql.*-community.*\"\nyumçš„æ–¹å¼å®‰è£…MySQL:yum -y install mysql-community-server\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åŠ å…¥å¼€æœºå¯åŠ¨:systemctl enable mysqld\nå¯åŠ¨mysqlæœåŠ¡è¿›ç¨‹:systemctl start mysqld\né‡ç½®å¯†ç :mysql_secure_installation   ç„¶åæŒ‰å›è½¦å°±è¡Œï¼Œæ¥ç€åšæŒ‰æç¤ºåšä¸€ç³»åˆ—çš„äº‹æƒ…\n</code></pre></div><h2>å®‰è£…MySQL</h2>\n<p>1.åˆ›å»ºmysqlæ–‡ä»¶å¤¹å¹¶åˆ‡æ¢è·¯å¾„<br>\nlocalæ˜¯linuxä¸Šå®‰è£…æ–‡ä»¶çš„ç›®å½•<br>\ncd /usr/local<br>\nmkdir mysql<br>\ncd mysql<br>\n2.ä¸‹è½½mysql<br>\nwget <a href=\"https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.30-linux-glibc2.12-x86_64.tar.xz\" target=\"_blank\" rel=\"noopener noreferrer\">https://dev.mysql.com/get/Downloads/MySQL-8.0/mysql-8.0.30-linux-glibc2.12-x86_64.tar.xz</a><br>\n3.è§£å‹mysql<br>\ntar xvJf mysql-8.0.30-linux-glibc2.12-x86_64.tar.xz<br>\n4.é‡å‘½åæ–‡ä»¶å¤¹å¹¶åˆ é™¤å‹ç¼©åŒ…<br>\nmv mysql-8.0.30-linux-glibc2.12-x86_64 mysql-8.0<br>\nrm -rf mysql-8.0.30-linux-glibc2.12-x86_64<br>\n5.åˆ›å»ºç”¨æˆ·ç»„ä»¥åŠç”¨æˆ·å’Œå¯†ç <br>\ngroupadd mysql<br>\nuseradd -g mysql mysql<br>\nç¼–è¯‘å®‰è£…æ—¶å€™åˆ›å»ºmysqlç»„å’Œmysqlç”¨æˆ·ï¼Œå¹¶æŠŠdatadirå’Œå®‰è£…ç›®å½•å±ä¸»æ”¹ä¸ºmysqlï¼Œå¯åŠ¨æ—¶ï¼Œmysqldè¿›ç¨‹çš„å±ä¸»æ˜¯mysqlï¼Œå³ä¾¿mysqlæœåŠ¡è¢«é»‘æ‰ï¼Œå¾—åˆ°äº†mysqlç”¨æˆ·æƒé™ï¼Œä¹Ÿä¸ä¼šå½±å“ç³»ç»Ÿå®‰å…¨</p>\n<p>6.æˆæƒç”¨æˆ·<br>\nchown -R mysql.mysql /usr/local/mysql/mysql-8.0<br>\n7.åˆ‡æ¢åˆ°binç›®å½•ä¸‹ï¼Œåˆå§‹åŒ–åŸºç¡€ä¿¡æ¯å¾—åˆ°ä¸´æ—¶å¯†ç <br>\ncd bin<br>\n./mysqld --user=mysql --basedir=/usr/local/mysql/mysql-8.0 --datadir=/usr/local/mysql/mysql-8.0/data/ --initialize<br>\n8.ç¼–è¾‘é…ç½®æ–‡ä»¶my.cnf<br>\nå¦‚æœæ²¡æœ‰ my.cnf æ–‡ä»¶å°±é€šè¿‡å‘½ä»¤ touch /etc/my.cnf åˆ›å»ºä¸€ä¸ª</p>\n<p>vi /etc/my.cnf<br>\nå†…å®¹å¦‚ä¸‹ï¼š</p>\n<p>[mysql]<br>\n#MySQL æç¤ºç¬¦é…ç½®</p>\n<p>#ç”¨æˆ·å@ä¸»æœºå+æ•°æ®åº“å<br>\n#prompt=\"\\u@\\h [\\d]&gt;\"</p>\n<p>#ç”¨æˆ·å@ä¸»æœºå+mysqlç‰ˆæœ¬å·+æ•°æ®åº“å<br>\nprompt=\\u@\\h \\v [\\d]&gt;\\_</p>\n<p>#ç”¨æˆ·å@ä¸»æœºå+å½“å‰æ—¶é—´+mysqlç‰ˆæœ¬å·+æ•°æ®åº“å<br>\n#prompt=\"(\\u@\\h) \\R:\\m:\\s \\v [\\d] \\n&gt;\"</p>\n<p>[mysqld]<br>\n#mysqlå®‰è£…æ ¹ç›®å½•<br>\nbasedir = /usr/local/mysql/mysql-8.0/</p>\n<p>#mysqlæ•°æ®æ–‡ä»¶æ‰€åœ¨ä½ç½®<br>\ndatadir = /usr/local/mysql/mysql-8.0/data/</p>\n<p>#è®¾ç½®sockeæ–‡ä»¶æ‰€åœ¨ç›®å½•<br>\nsocket = /tmp/mysql.sock</p>\n<p>#æ•°æ®åº“é»˜è®¤å­—ç¬¦é›†, ä¸»æµå­—ç¬¦é›†æ”¯æŒä¸€äº›ç‰¹æ®Šè¡¨æƒ…ç¬¦å·ï¼ˆç‰¹æ®Šè¡¨æƒ…ç¬¦å ç”¨4ä¸ªå­—èŠ‚ï¼‰<br>\ncharacter-set-server = utf8mb4</p>\n<p>#æ•°æ®åº“å­—ç¬¦é›†å¯¹åº”ä¸€äº›æ’åºç­‰è§„åˆ™ï¼Œæ³¨æ„è¦å’Œcharacter-set-serverå¯¹åº”<br>\ncollation-server = utf8mb4_general_ci</p>\n<p>#è®¾ç½®clientè¿æ¥mysqlæ—¶çš„å­—ç¬¦é›†,é˜²æ­¢ä¹±ç <br>\ninit_connect='SET NAMES utf8mb4'<br>\n9.åˆ‡æ¢åˆ°mysql-8.0ç›®å½•ä¸‹ï¼Œæ·»åŠ mysqldæœåŠ¡åˆ°ç³»ç»Ÿ<br>\ncd /usr/local/mysql/mysql-8.0<br>\ncp -a ./support-files/mysql.server /etc/init.d/mysql<br>\n10.æˆæƒä»¥åŠæ·»åŠ æœåŠ¡<br>\nchmod +x /etc/init.d/mysql<br>\nchkconfig --add mysql<br>\n11.å¯åŠ¨mysql<br>\nservice mysql start<br>\n12.æŸ¥çœ‹å¯åŠ¨çŠ¶æ€<br>\nservice mysql status<br>\n13.å°†mysqlå‘½ä»¤æ·»åŠ åˆ°ç³»ç»ŸæŒ‡ä»¤<br>\nln -s /usr/local/mysql/mysql-8.0/bin/mysql /usr/bin</p>\n<p>ç°åœ¨ä»»ä½•ç›®å½•ä¸‹æ‰§è¡Œ mysql -uroot -p å°±å¯ä»¥è¿›è¡Œç™»å½•</p>\n<p>14.ç™»å½•mysqlï¼Œå¯†ç ä½¿ç”¨ä¹‹å‰éšæœºç”Ÿæˆçš„å¯†ç <br>\nmysql -uroot -p</p>\n<p>15.ä¿®æ”¹rootå¯†ç <br>\nALTER USER 'root'@'localhost' IDENTIFIED WITH mysql_native_password BY '123456';<br>\nä¿®æ”¹rootç”¨æˆ·å¯†ç ä¸º 123456 ï¼Œä¹Ÿå¯ä»¥æ¢æˆåˆ«çš„</p>\n<p>16.æ‰§è¡Œ flush privileges ä½¿å¯†ç ç”Ÿæ•ˆ<br>\nflush privileges;<br>\n17.é€‰æ‹©mysqlæ•°æ®åº“<br>\nuse mysql;<br>\n18.ä¿®æ”¹è¿œç¨‹è¿æ¥å¹¶ç”Ÿæ•ˆï¼Œ%è¡¨ç¤ºå¼€å¯è¿œç¨‹æƒé™<br>\nupdate user set host='%' where user='root';<br>\nflush privileges;<br>\n19.é€€å‡ºMySQLï¼š<br>\n\\q<br>\n20.æŸ¥çœ‹mysqlæ˜¯å¦å¼€æœºå¯åŠ¨<br>\nchkconfig --list<br>\nå¦‚æœ mysqlæœåŠ¡çš„ ç¬¬3ã€4ã€5é¡¹éƒ½æ˜¯å¼€ç€çš„ï¼Œåˆ™å·²ç»å¼€å¯äº†å¼€æœºå¯åŠ¨ï¼Œåä¹‹åˆ™æ²¡æœ‰ã€‚</p>\n<p>å¦‚æœæ²¡æœ‰ï¼Œå¯ä»¥ç”¨å‘½ä»¤è®¾ç½®å¼€æœºè‡ªå¯åŠ¨ï¼š</p>\n<p>systemctl enable mysqld.service<br>\nå†æ¬¡æŸ¥çœ‹mysqlæ˜¯å¦å¼€æœºå¯åŠ¨ï¼š</p>\n<p>chkconfig --list</p>\n<p>1.æŸ¥çœ‹3306ç«¯å£çŠ¶æ€<br>\nfirewall-cmd --zone=public --query-port=3306/tcp<br>\n2ã€å¦‚æœæ˜¯noï¼Œè¡¨ç¤ºå…³é—­ï¼Œæ‰“å¼€3306ç«¯å£<br>\nfirewall-cmd --zone=public --add-port=3306/tcp --permanent<br>\n3ã€é˜²ç«å¢™é‡è½½<br>\nfirewall-cmd --reload<br>\n4ã€å†æ¬¡æŸ¥çœ‹3306ç«¯å£çŠ¶æ€<br>\nfirewall-cmd --zone=public --query-port=3306/tcp<br>\nåº”è¯¥æ˜¯yesï¼Œè¯´æ˜ç«¯å£å·²ç»æ‰“å¼€ï¼Œå»navicatæµ‹è¯•è¿æ¥ï¼Œè¾“å…¥ipå’Œrootè´¦æˆ·å¯†ç ï¼Œå³å¯æˆåŠŸï¼<br>\næ‰§è¡Œä¸‹é¢å‘½ä»¤ä¸€é”®ç™»å½•ï¼š<br>\nmysql -uroot -hlocalhost -p123456</p>\n<h2>Dubboçš„æ³¨å†Œä¸­å¿ƒZookeeperçš„å®‰è£…</h2>\n<pre><code>Zookeeperæ˜¯javaå¼€å‘çš„å¯ä»¥è¿è¡Œåœ¨windowsã€linuxç¯å¢ƒã€‚éœ€è¦å…ˆå®‰è£…jdkã€‚\nå®‰è£…ç¯å¢ƒï¼šLinuxï¼šcentos6.4 Jdk:1.7ä»¥ä¸Šç‰ˆæœ¬\n\nå®‰è£…æ­¥éª¤ï¼š\nç¬¬ä¸€æ­¥ï¼šå®‰è£…jdk\nç¬¬äºŒæ­¥ï¼šæŠŠzookeeperçš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿï¼ˆç›®å½•éšæ„ï¼‰\nç¬¬ä¸‰æ­¥ï¼šè§£å‹ç¼©å‹ç¼©åŒ…tar -zxvf zookeeper-3.4.6.tar.gz\nç¬¬å››æ­¥ï¼šè¿›å…¥zookeeper-3.4.6ç›®å½•ï¼Œåˆ›å»ºdataæ–‡ä»¶å¤¹ã€‚\nç¬¬äº”æ­¥ï¼šæŠŠzookeeper-3.4.6ç›®å½•ä¸‹çš„confç›®å½•å°†zoo_sample.cfgæ”¹åä¸ºzoo.cfg ï¼šmv zoo_sample.cfg zoo.cfg\nç¬¬å…­æ­¥ï¼šä¿®æ”¹zoo.cfgçš„dataå±æ€§è®¾ç½®ä¸ºdataæ‰€åœ¨çš„ç›®å½•ï¼švim zoo.cfgç„¶åè¾“å…¥iç¼–è¾‘\ndataDir=/usr/zookeeper-3.4.6/data ç„¶åEscï¼Œç„¶å:wqä¿å­˜å¹¶é€€å‡º\nç¬¬ä¸ƒæ­¥ï¼šè¿›å…¥binç›®å½•å¯åŠ¨zookeeper ./zkServer.sh start\nå…³é—­ï¼š./zkServer.sh stop\næŸ¥çœ‹çŠ¶æ€ï¼š./zkServer.sh status\næ³¨æ„ï¼šéœ€è¦å…³é—­é˜²ç«å¢™ã€‚\nservice iptables stop\næ°¸ä¹…å…³é—­ä¿®æ”¹é…ç½®å¼€æœºä¸å¯åŠ¨é˜²ç«å¢™ï¼š\nchkconfig iptables off\nå¦‚æœä¸èƒ½æˆåŠŸå¯åŠ¨zookeeperï¼Œéœ€è¦åˆ é™¤dataç›®å½•ä¸‹çš„zookeeper_server.pidæ–‡ä»¶ã€‚\n</code></pre>\n<h2>Dubboç›‘æ§ä¸­å¿ƒçš„å®‰è£…</h2>\n<pre><code>éœ€è¦å®‰è£…tomcatï¼Œç„¶åéƒ¨ç½²ç›‘æ§ä¸­å¿ƒå³å¯ã€‚\n\néƒ¨ç½²ç›‘æ§ä¸­å¿ƒï¼š\ncp dubbo-admin-2.5.4.war apache-tomcat-7.0.47/webapps/dubbo-admin.war \nè¿›å…¥tomcatçš„binç›®å½•ä¸‹å¯åŠ¨tomcat\nè®¿é—®http://192.168.25.167:8080/dubbo-admin/\nç”¨æˆ·åï¼šrootå¯†ç ï¼šroot\n\nå¦‚æœç›‘æ§ä¸­å¿ƒå’Œæ³¨å†Œä¸­å¿ƒåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥ä¸éœ€è¦ä»»ä½•é…ç½®ã€‚\nå¦‚æœä¸åœ¨åŒä¸€å°æœåŠ¡å™¨ï¼Œéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶dubbo.propertiesï¼š\n/root/apache-tomcat-7.0.47/webapps/dubbo-admin/WEB-INF/dubbo.properties\ndubbo.registry.address=zookeeper://127.0.0.1:2181æ³¨å†Œä¸­å¿ƒåœ°å€\ndubbo.admin.root.password=root rootç”¨æˆ·çš„å¯†ç \ndubbo.admin.guest.password=guest\n</code></pre>\n<h2>rediså®‰è£…</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Redisæ˜¯cè¯­è¨€å¼€å‘çš„ã€‚\nè¾“å…¥gccï¼›å¦‚æœæ‰¾ä¸åˆ°å‘½ä»¤çš„è¯å°±è¦å®‰è£…\nå®‰è£…rediséœ€è¦cè¯­è¨€çš„ç¼–è¯‘ç¯å¢ƒã€‚å¦‚æœæ²¡æœ‰gccéœ€è¦åœ¨çº¿å®‰è£…ã€‚yum install gcc-c++\n\nå®‰è£…æ­¥éª¤ï¼š\nç¬¬ä¸€æ­¥ï¼šredisçš„æºç åŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿã€‚\nç¬¬äºŒæ­¥ï¼šè§£å‹ç¼©redisã€‚tar -zxvf redis-3.0.0.tar.gz\nç¬¬ä¸‰æ­¥ï¼šç¼–è¯‘ã€‚è¿›å…¥redisæºç ç›®å½•redis-3.0.0ã€‚make \nç¬¬å››æ­¥ï¼šå®‰è£…ã€‚make install PREFIX=/usr/java/redis installå‘½ä»¤å®‰è£…redisåˆ°/usr/local/redisä¸­\nPREFIXå‚æ•°æŒ‡å®šredisçš„å®‰è£…ç›®å½•ã€‚ä¸€èˆ¬è½¯ä»¶å®‰è£…åˆ°/usrç›®å½•ä¸‹\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>redisçš„å¯åŠ¨ï¼š\nå‰ç«¯å¯åŠ¨ï¼šåœ¨redisçš„å®‰è£…ç›®å½•binä¸‹ç›´æ¥å¯åŠ¨redis-server  ./redis-server \n\nåå°å¯åŠ¨ï¼š\næŠŠredis-3.0.0/redis.confå¤åˆ¶åˆ°/usr/java/redis/bin/ç›®å½•ä¸‹\ncp redis.conf /usr/java/redis/bin/\nä¿®æ”¹é…ç½®æ–‡ä»¶ï¼šdaemonize no ä¸ºyes\nåœ¨/usr/java/redis/bin/ä¸­æ‰§è¡Œ ./redis-server redis.conf\næŸ¥çœ‹redisè¿›ç¨‹ï¼šps aux|grep redis\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Redis-cli\nåœ¨redisçš„å®‰è£…ç›®å½•ä¸‹çš„bin\n[root@localhost bin]# ./redis-cli \né»˜è®¤è¿æ¥localhostè¿è¡Œåœ¨6379ç«¯å£çš„redisæœåŠ¡ã€‚\n[root@localhost bin]# ./redis-cli -h 192.168.25.153 -p 6379\n-hï¼šè¿æ¥çš„æœåŠ¡å™¨çš„åœ°å€\n-pï¼šæœåŠ¡çš„ç«¯å£å·\n\nå…³é—­redisï¼š[root@localhost bin]# ./redis-cli shutdown\n</code></pre></div><h2>solræœåŠ¡å™¨çš„å®‰è£…</h2>\n<h3>Solrçš„ç¯å¢ƒ</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Solræ˜¯javaå¼€å‘ã€‚\néœ€è¦å®‰è£…jdkã€‚å®‰è£…ç¯å¢ƒLinuxã€‚éœ€è¦å®‰è£…Tomcatã€‚\n</code></pre></div><h3>æ­å»ºæ­¥éª¤</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç¬¬ä¸€æ­¥ï¼šæŠŠsolr çš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°Linuxç³»ç»Ÿ\nç¬¬äºŒæ­¥ï¼šè§£å‹solrã€‚tar -zxvf solr-4.10.3.tgz.tgz\nç¬¬ä¸‰æ­¥ï¼šå®‰è£…Tomcatï¼Œè§£å‹ç¼©å³å¯ã€‚ tar -zxvf apache-tomcat-7.0.47.tar.gz\nç¬¬å››æ­¥ï¼šæŠŠsolrå¤åˆ¶åˆ°Tomcatä¸‹webapps \nç¬¬äº”æ­¥ï¼šè§£å‹ç¼©waråŒ…ã€‚è¿›å…¥binç›®å½•ä¸‹./startup.batå¯åŠ¨Tomcatè§£å‹ã€‚å…³é—­tomcat\nç¬¬å…­æ­¥ï¼šæŠŠ/root/solr-4.10.3/example/lib/extç›®å½•ä¸‹çš„æ‰€æœ‰çš„jaråŒ…ï¼Œæ·»åŠ åˆ°solrå·¥ç¨‹ä¸­ã€‚\ncp * /usr/java/solr/tomcat/webapps/solr/WEB-INF/lib/\nç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªsolrhomeã€‚/usr/java/solr-4.10.3/example/solrç›®å½•å°±æ˜¯ä¸€ä¸ªsolrhomeã€‚å¤åˆ¶æ­¤ç›®å½•åˆ°/usr/java/solr/solrhome\ncp -r solr /usr/java/solr/solrhome\nç¬¬å…«æ­¥ï¼šå…³è”solråŠsolrhomeã€‚éœ€è¦ä¿®æ”¹tomcatä¸‹çš„solrå·¥ç¨‹çš„web.xmlæ–‡ä»¶ã€‚\næŠŠè¿™ä¸ªæ³¨é‡Šæ‰“å¼€å¹¶é…ç½®å¥½solrhomeåœ°å€\n&lt;env-entry&gt;\n   &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt;\n   &lt;env-entry-value&gt;/usr/java/solr/solrhome/&lt;/env-entry-value&gt;\n   &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;\n&lt;/env-entry&gt;\nç¬¬ä¹æ­¥ï¼šå¯åŠ¨Tomcat\nhttp://192.168.25.154:8080/solr/\nå’Œwindowsä¸‹çš„é…ç½®å®Œå…¨ä¸€æ ·ã€‚\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®ä¸šåŠ¡åŸŸ\n1ã€æŠŠ/usr/java/IK Analyzer 2012FF_hf1/IKAnalyzer2012FF_u1.jaræ·»åŠ åˆ°tomcat/webappps/solr/libç›®å½•ä¸‹\n2ã€æŠŠ/usr/java/IK Analyzer 2012FF_hf1/ext_stopword.dicã€IKAnalyzer.cfg.xmlã€mydict.dicæ”¾åˆ°tomcat/webappps/solr/WEB-INF/classesç›®å½•ä¸‹ã€‚\né…ç½®ä¸€ä¸ªFieldTypeï¼Œåˆ¶å®šä½¿ç”¨IKAnalyzer\n3ã€ä¿®æ”¹/usr/java/solr/solrhome/collection1/conf/schema.xml,æ·»åŠ \n&lt;fieldType name=\"text_ik\" class=\"solr.TextField\"&gt;\n  &lt;analyzer class=\"org.wltea.analyzer.lucene.IKAnalyzer\"/&gt;\n&lt;/fieldType&gt;\né…ç½®ä¸šåŠ¡åŸŸï¼Œtypeåˆ¶å®šä½¿ç”¨è‡ªå®šä¹‰çš„FieldTypeã€‚è®¾ç½®ä¸šåŠ¡ç³»ç»ŸField,æ·»åŠ \n&lt;field name=\"item_title\" type=\"text_ik\" indexed=\"true\" stored=\"true\"/&gt;\n&lt;field name=\"item_sell_point\" type=\"text_ik\" indexed=\"true\" stored=\"true\"/&gt;\n&lt;field name=\"item_price\"  type=\"long\" indexed=\"true\" stored=\"true\"/&gt;\n&lt;field name=\"item_image\" type=\"string\" indexed=\"false\" stored=\"true\" /&gt;\n&lt;field name=\"item_category_name\" type=\"string\" indexed=\"true\" stored=\"true\" /&gt;\n\n&lt;field name=\"item_keywords\" type=\"text_ik\" indexed=\"true\" stored=\"false\" multiValued=\"true\"/&gt;\n&lt;copyField source=\"item_title\" dest=\"item_keywords\"/&gt;\n&lt;copyField source=\"item_sell_point\" dest=\"item_keywords\"/&gt;\n&lt;copyField source=\"item_category_name\" dest=\"item_keywords\"/&gt;\n4ã€é‡å¯tomcat\n</code></pre></div><h2>solr-cloudæ­å»º</h2>\n<h3>Zookeeperé›†ç¾¤æ­å»º</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç¬¬ä¸€æ­¥ï¼šéœ€è¦å®‰è£…jdkç¯å¢ƒã€‚\nç¬¬äºŒæ­¥ï¼šæŠŠzookeeperçš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨ã€‚\nç¬¬ä¸‰æ­¥ï¼šè§£å‹ç¼©ã€‚tar -zxvf zookeeper-3.4.6.tar.gz\nç¬¬å››æ­¥ï¼šæŠŠzookeeperå¤åˆ¶ä¸‰ä»½ã€‚\n[root@localhost ~]# mkdir /usr/java/solr-cloud\n[root@localhost ~]# cp -r zookeeper-3.4.6 /usr/java/solr-cloud/zookeeper01\n[root@localhost ~]# cp -r zookeeper-3.4.6 /usr/java/solr-cloud/zookeeper02\n[root@localhost ~]# cp -r zookeeper-3.4.6 /usr/java/solr-cloud/zookeeper03\nç¬¬äº”æ­¥ï¼šåœ¨æ¯ä¸ªzookeeperç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªdataç›®å½•ã€‚\nmkdir data\nç¬¬å…­æ­¥ï¼šåœ¨dataç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªmyidæ–‡ä»¶ï¼Œæ–‡ä»¶åå°±å«åšâ€œmyidâ€ã€‚å†…å®¹å°±æ˜¯æ¯ä¸ªå®ä¾‹çš„idã€‚ä¾‹å¦‚1ã€2ã€3\nvim data ç„¶åè¾“å…¥i è¾“å…¥1 è¾“å…¥esc è¾“å…¥ï¼šwq\ncat myid //æ£€æŸ¥myidçš„å†…å®¹1\nç¬¬ä¸ƒæ­¥ï¼šä¿®æ”¹é…ç½®æ–‡ä»¶ã€‚æŠŠconfç›®å½•ä¸‹çš„zoo_sample.cfgæ–‡ä»¶æ”¹åä¸ºzoo.cfg\næ¯ä¸ªä¸€æ ·é…ç½®ï¼\ncp zoo_sample.cfg zoo.cfg\nå°†datadir=æ”¹æˆdataæ–‡ä»¶å¤¹çš„åœ°å€\nä¿è¯clientPortä¸‰ä¸ªä¸å†²çª\nç„¶ååœ¨æœ€åä¸€è¡Œé…ç½®\nserver.1=192.168.25.135:2881:3881\nserver.2=192.168.25.135:2882:3882\nserver.3=192.168.25.135:2883:3883\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åˆ›å»ºå…¨éƒ¨å¯åŠ¨çš„è„šæœ¬ start-all.sh :vim start-all.sh\ncd zookeeper01/bin\n./zkServer.sh start\ncd ../../\ncd zookeeper02/bin\n./zkServer.sh start\ncd ../../\ncd zookeeper03/bin\n./zkServer.sh start\ncd ../../\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æˆæƒ\nchmod u+x start-all.sh \næŸ¥çœ‹zookeeperçš„çŠ¶æ€\nä¸€ä¸ªleaderå…¶ä»–éƒ½æ˜¯follower\nzookeeper01/bin/zkServer.sh status\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Using config: /usr/java/solr-cloud/zookeeper01/bin/../conf/zoo.cfg\nStopping zookeeper ... bin/zkServer.sh: ç¬¬ 143 è¡Œ:kill: (26838) - æ²¡æœ‰é‚£ä¸ªè¿›ç¨‹\nSTOPPED\nå¦‚æœå…³é—­zookeeperçš„æ—¶å€™æœ‰è¿™å¥è¯ è¯´æ˜ç«¯å£å ç”¨\n\næŸ¥çœ‹å ç”¨2181ç«¯å£çš„ç¨‹åºpidï¼š\n[root@localhost local]# lsof -i:5432\n\nkillæ‰è¯¥è¿›ç¨‹\n[root@localhost local]# kill -9 7035\né‡æ–°å¯åŠ¨å³å¯\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åˆ›å»ºå…¨éƒ¨å…³é—­çš„è„šæœ¬ start-all.sh :vim shutdown-all.sh\ncd zookeeper01/bin\n./zkServer.sh stop\ncd ../../\ncd zookeeper02/bin\n./zkServer.sh stop\ncd ../../\ncd zookeeper03/bin\n./zkServer.sh stop\ncd ../../\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æˆæƒ\nchmod u+x shutdown-all.sh \næŸ¥çœ‹zookeeperçš„çŠ¶æ€\nä¸€ä¸ªleaderå…¶ä»–éƒ½æ˜¯follower\nzookeeper01/bin/zkServer.sh status\n</code></pre></div><h3>Solré›†ç¾¤çš„æ­å»º</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºå››ä¸ªtomcatå®ä¾‹ã€‚æ¯ä¸ªtomcatè¿è¡Œåœ¨ä¸åŒçš„ç«¯å£ã€‚8180ã€8280ã€8380ã€8480\nåœ¨/usr/javaç›®å½•ä¸‹tar -zxvf apache-tomcat-7.0.47è§£å‹tomcat\nå¤åˆ¶å››ä¸ªtomcatåˆ°/usr/java/solr-cloudç›®å½•ä¸‹\ncp -r apache-tomcat-7.0.47 /usr/java/solr-cloud/tomcat04\nvim /usr/java/solr/tomcat/conf/server.xml å°†8080æ”¹æˆ8180ï¼Œå…¶ä»–ç«¯å£å·åŒæ—¶åŠ 1\nç¬¬äºŒæ­¥ï¼šéƒ¨ç½²solrçš„waråŒ…ã€‚æŠŠå•æœºç‰ˆçš„/usr/java/solr/tomcat/webapps/solrå¤åˆ¶åˆ°é›†ç¾¤ä¸­çš„tomcat01234ä¸­ã€‚\ncp -r /usr/java/solr/tomcat/webapps/solr /usr/java/solr-cloud/tomcat01/webapps/solr\nç¬¬ä¸‰æ­¥ï¼šä¸ºæ¯ä¸ªsolrå®ä¾‹åˆ›å»ºä¸€ä¸ªå¯¹åº”çš„solrhomeã€‚ä½¿ç”¨å•æœºç‰ˆçš„solrhomeå¤åˆ¶å››ä»½\ncp -r /usr/java/solr/solrhome /usr/java/solr-cloud/solrhome01\nç¬¬å››æ­¥ï¼šéœ€è¦ä¿®æ”¹solrçš„web.xmlæ–‡ä»¶ã€‚æŠŠsolrhomeå…³è”èµ·æ¥ã€‚\nvim /usr/java/solr/tomcat/webapps/solr/WEB-INF/web.xml\n&lt;env-entry&gt;\n   &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt;\n   &lt;env-entry-value&gt;/usr/java/solr-cloud/solrhome01/&lt;/env-entry-value&gt;\n   &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;\n&lt;/env-entry&gt;\n\nç¬¬äº”æ­¥ï¼šé…ç½®solrCloudç›¸å…³çš„é…ç½®ã€‚æ¯ä¸ªsolrhomeä¸‹éƒ½æœ‰ä¸€ä¸ªsolr.xmlï¼ŒæŠŠå…¶ä¸­çš„ipåŠç«¯å£å·é…ç½®å¥½ã€‚\nvim /usr/java/solr-cloud/solrhome01/solr.xml\n&lt;solrcloud&gt;\n\t&lt;str name=\"host\"&gt;192.168.25.135&lt;/str&gt;\n\t&lt;int name=\"hostPort\"&gt;8180&lt;/int&gt;\n\t&lt;str name=\"hostContext\"&gt;${hostContext:solr}&lt;/str&gt;\n\t&lt;int name=\"zkClientTimeout\"&gt;${zkClientTimeout:30000}&lt;/int&gt;\n\t&lt;bool name=\"genericCoreNodeNames\"&gt;${genericCoreNodeNames:true}&lt;/bool&gt;\n&lt;/solrcloud&gt;\nç¬¬å…­æ­¥ï¼šè®©zookeeperç»Ÿä¸€ç®¡ç†é…ç½®æ–‡ä»¶ã€‚éœ€è¦æŠŠsolrhome/collection1/confç›®å½•ä¸Šä¼ åˆ°zookeeperã€‚ä¸Šä¼ ä»»æ„solrhomeä¸­çš„é…ç½®æ–‡ä»¶å³å¯ã€‚\nä½¿ç”¨å·¥å…·ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼š/root/solr-4.10.3/example/scripts/cloud-scripts/zkcli.sh\n./zkcli.sh -zkhost 192.168.25.135:2181,192.168.25.135:2182,192.168.25.135:2183 -cmd upconfig -confdir /usr/local/solr-cloud/solrhome01/collection1/conf -confname myconf\nç¬¬ä¸ƒæ­¥ï¼šä¿®æ”¹tomcat/binç›®å½•ä¸‹çš„catalina.sh æ–‡ä»¶ï¼Œå…³è”solrå’Œzookeeperã€‚\næŠŠæ­¤é…ç½®æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼š\nJAVA_OPTS=\"-DzkHost=192.168.25.135:2181,192.168.25.135:2182,192.168.25.135:2183\"\nç¬¬å…«æ­¥ï¼šå¯åŠ¨æ¯ä¸ªtomcatå®ä¾‹ã€‚è¦åŒ…è£…zookeeperé›†ç¾¤æ˜¯å¯åŠ¨çŠ¶æ€ã€‚\nç¬¬ä¹æ­¥ï¼šè®¿é—®é›†ç¾¤\nç¬¬åæ­¥ï¼šåˆ›å»ºæ–°çš„Collectionè¿›è¡Œåˆ†ç‰‡å¤„ç†ã€‚\nhttp://192.168.25.135:8180/solr/admin/collections?action=CREATE&amp;name=collection2&amp;numShards=2&amp;replicationFactor=2\nç¬¬åä¸€æ­¥ï¼šåˆ é™¤ä¸ç”¨çš„Collectionã€‚\nhttp://192.168.25.135:8180/solr/admin/collections?action=DELETE&amp;name=collection1\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æŸ¥çœ‹ç¬¬å…­æ­¥çš„zookeeperä¸Šçš„é…ç½®æ–‡ä»¶ï¼š\nä½¿ç”¨zookeeperç›®å½•ä¸‹çš„bin/zkCli.shå‘½ä»¤æŸ¥çœ‹zookeeperä¸Šçš„é…ç½®æ–‡ä»¶ï¼š\n[root@localhost bin]# ./zkCli.sh \n[zk: localhost:2181(CONNECTED) 0] ls /\n[configs, zookeeper]\n[zk: localhost:2181(CONNECTED) 1] ls /configs\n[myconf]\n[zk: localhost:2181(CONNECTED) 2] ls /configs/myconf\n[admin-extra.menu-top.html, protwords.txt, mapping-FoldToASCIIenglish.enu-bottom.html, clustering, schema.xml..]\n[zk: localhost:2181(CONNECTED) 3] \né€€å‡ºï¼š\n[zk: localhost:2181(CONNECTED) 3] quit\nä½¿ç”¨ä»¥ä¸‹å‘½ä»¤è¿æ¥æŒ‡å®šçš„zookeeperæœåŠ¡ï¼š\n./zkCli.sh -server 192.168.25.154:2183\n</code></pre></div><h2>ActiveMQçš„å®‰è£…</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>è¿›å…¥http://activemq.apache.org/ä¸‹è½½ActiveMQ ä½¿ç”¨çš„ç‰ˆæœ¬æ˜¯5.12.0\nå®‰è£…ç¯å¢ƒï¼š\n1ã€éœ€è¦jdkã€Linuxç³»ç»Ÿã€‚ç”Ÿäº§ç¯å¢ƒéƒ½æ˜¯Linuxç³»ç»Ÿã€‚\nå®‰è£…æ­¥éª¤\nç¬¬ä¸€æ­¥ï¼š æŠŠActiveMQ çš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°Linuxç³»ç»Ÿã€‚\nç¬¬äºŒæ­¥ï¼šè§£å‹ç¼©ã€‚\nç¬¬ä¸‰æ­¥ï¼šå¯åŠ¨ã€‚\nä½¿ç”¨binç›®å½•ä¸‹çš„activemqå‘½ä»¤å¯åŠ¨ï¼š./activemq start \nå…³é—­ï¼š./activemq stop\næŸ¥çœ‹çŠ¶æ€ï¼š./activemq status\næ³¨æ„ï¼šå¦‚æœActiveMQæ•´åˆspringä½¿ç”¨ä¸è¦ä½¿ç”¨activemq-all-5.12.0.jaråŒ…ã€‚å»ºè®®ä½¿ç”¨5.11.2\nè¿›å…¥ç®¡ç†åå°ï¼šhttp://192.168.25.168:8161/adminç”¨æˆ·åï¼šadminå¯†ç ï¼šadmin\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>11.3.è§£å†³405é—®é¢˜ï¼š\nä¿®æ”¹hostsæ–‡ä»¶ï¼Œé…ç½®æœºå™¨åå’Œ127.0.0.1çš„æ˜ å°„å…³ç³»ã€‚\næœºå™¨åï¼š/etc/sysconfig/networkæ–‡ä»¶ä¸­å®šä¹‰äº†æœºå™¨åï¼š\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/bfd35cb9434cac5a500fe.png\" alt=\"15.png\" tabindex=\"0\"><figcaption>15.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Hostæ–‡ä»¶çš„é…ç½®ï¼š\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ca5682c10b4ee9f1c9a6f.png\" alt=\"16.png\" tabindex=\"0\"><figcaption>16.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é‡æ–°å¯åŠ¨Activemqçš„æœåŠ¡\n</code></pre></div><h2>mycatå®‰è£…</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç¬¬ä¸€æ­¥ï¼šæŠŠMyCatçš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°linuxæœåŠ¡å™¨\nç¬¬äºŒæ­¥ï¼šè§£å‹ç¼©ï¼Œå¾—åˆ°mycatç›®å½•\nç¬¬ä¸‰æ­¥ï¼šè¿›å…¥mycat/binï¼Œå¯åŠ¨MyCat\nå¯åŠ¨å‘½ä»¤ï¼š./mycat start\nåœæ­¢å‘½ä»¤ï¼š./mycat stop\né‡å¯å‘½ä»¤ï¼š./mycat restart\næ³¨æ„ï¼šå¯ä»¥ä½¿ç”¨mysqlçš„å®¢æˆ·ç«¯ç›´æ¥è¿æ¥mycatæœåŠ¡ã€‚é»˜è®¤æœåŠ¡ç«¯å£ä¸º8066\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®schema.xml\nSchema.xmlä½œä¸ºMyCatä¸­é‡è¦çš„é…ç½®æ–‡ä»¶ä¹‹ä¸€ï¼Œç®¡ç†ç€MyCatçš„é€»è¾‘åº“ã€è¡¨ã€åˆ†ç‰‡è§„åˆ™ã€DataNodeä»¥åŠDataSourceã€‚\n\nschema æ ‡ç­¾ç”¨äºå®šä¹‰MyCatå®ä¾‹ä¸­çš„é€»è¾‘åº“\nTable æ ‡ç­¾å®šä¹‰äº†MyCatä¸­çš„é€»è¾‘è¡¨\ndataNode æ ‡ç­¾å®šä¹‰äº†MyCatä¸­çš„æ•°æ®èŠ‚ç‚¹ï¼Œä¹Ÿå°±æ˜¯æˆ‘ä»¬é€šå¸¸è¯´æ‰€çš„æ•°æ®åˆ†ç‰‡ã€‚\ndataHostæ ‡ç­¾åœ¨mycaté€»è¾‘åº“ä¸­ä¹Ÿæ˜¯ä½œä¸ºæœ€åº•å±‚çš„æ ‡ç­¾å­˜åœ¨ï¼Œç›´æ¥å®šä¹‰äº†å…·ä½“çš„æ•°æ®åº“å®ä¾‹ã€è¯»å†™åˆ†ç¦»é…ç½®å’Œå¿ƒè·³è¯­å¥ã€‚\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨æ„ï¼šè‹¥æ˜¯LINUXç‰ˆæœ¬çš„MYSQLï¼Œåˆ™éœ€è¦è®¾ç½®ä¸ºMysqlå¤§å°å†™ä¸æ•æ„Ÿï¼Œå¦åˆ™å¯èƒ½ä¼šå‘ç”Ÿè¡¨æ‰¾ä¸åˆ°çš„é—®é¢˜ã€‚\nåœ¨MySQLçš„é…ç½®æ–‡ä»¶ä¸­my.ini [mysqld] ä¸­å¢åŠ ä¸€è¡Œ\nã€€ã€€lower_case_table_names = 1\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;?xml version=\"1.0\"?&gt;\n&lt;!DOCTYPE mycat:schema SYSTEM \"schema.dtd\"&gt;\n&lt;mycat:schema xmlns:mycat=\"http://org.opencloudb/\"&gt;\n\t&lt;!--TESTDBæ˜¯ç”¨ç¨‹åºè¿çš„æ•°æ®åº“åå­—--&gt;\n\t&lt;schema name=\"TESTDB\" checkSQLschema=\"false\" sqlMaxLimit=\"100\"&gt;\n\t\t&lt;!-- TB_ITEMæ˜¯TESTDBä¸­å«æœ‰çš„è¡¨ï¼ŒdataNodeæŒ‡å®šå­˜åˆ°é‚£å‡ ä¸ªçœŸæ­£çš„æ•°æ®åº“ä¸Š --&gt;\n\t\t&lt;!-- auto sharding by id (long) --&gt;\n\t\t&lt;table name=\"TB_ITEM\" dataNode=\"dn1,dn2,dn3\" rule=\"auto-sharding-long\" /&gt;\n\t\t&lt;table name=\"TB_USER\" dataNode=\"dn1,dn2\" primaryKey=\"ID\" type=\"global\"  /&gt;\n\t&lt;/schema&gt;\n\t&lt;!--é…ç½®èŠ‚ç‚¹çœŸæ­£çš„æ•°æ®åº“åœ°å€--&gt;\n\t&lt;dataNode name=\"dn1\" dataHost=\"localhost1\" database=\"db1\" /&gt;\n\t&lt;dataNode name=\"dn2\" dataHost=\"localhost2\" database=\"db2\" /&gt;\n\t&lt;dataNode name=\"dn3\" dataHost=\"localhost1\" database=\"db3\" /&gt;\n\t&lt;dataHost name=\"localhost1\" maxCon=\"1000\" minCon=\"10\" balance=\"0\"\n\t\twriteType=\"0\" dbType=\"mysql\" dbDriver=\"native\" switchType=\"1\"  slaveThreshold=\"100\"&gt;\n\t\t&lt;!--æ£€æŸ¥å¿ƒè·³åŒ…å¥åº·æ£€æŸ¥--&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t&lt;!-- can have multi write hosts --&gt;\n\t\t&lt;writeHost host=\"hostM1\" url=\"192.168.25.134:3306\" user=\"root\" password=\"root\"&gt;\n\t\t&lt;!-- can have multi read hosts --&gt;\n\t\t&lt;/writeHost&gt;\n\t&lt;/dataHost&gt;\n\t&lt;dataHost name=\"localhost2\" maxCon=\"1000\" minCon=\"10\" balance=\"0\"\n\t\twriteType=\"0\" dbType=\"mysql\" dbDriver=\"native\" switchType=\"1\"  slaveThreshold=\"100\"&gt;\n\t\t&lt;heartbeat&gt;select user()&lt;/heartbeat&gt;\n\t\t&lt;!-- can have multi write hosts --&gt;\n\t\t&lt;writeHost host=\"hostM1\" url=\"192.168.25.166:3306\" user=\"root\" password=\"root\"&gt;\n\t\t&lt;!-- can have multi read hosts --&gt;\n\t\t&lt;/writeHost&gt;\n\t&lt;/dataHost&gt;\n&lt;/mycat:schema&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®server.xml\nserver.xmlå‡ ä¹ä¿å­˜äº†æ‰€æœ‰mycatéœ€è¦çš„ç³»ç»Ÿé…ç½®ä¿¡æ¯ã€‚æœ€å¸¸ç”¨çš„æ˜¯åœ¨æ­¤é…ç½®ç”¨æˆ·åã€å¯†ç åŠæƒé™ã€‚\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;!--TESTDBæ˜¯ç”¨ç¨‹åºè¿çš„æ•°æ®åº“åå­—ï¼Œtestæ˜¯è´¦å·å’Œå¯†ç --&gt;\n&lt;user name=\"test\"&gt;\n    &lt;property name=\"password\"&gt;test&lt;/property&gt;\n    &lt;property name=\"schemas\"&gt;TESTDB&lt;/property&gt;\n    &lt;property name=\"readOnly\"&gt;true&lt;/property&gt;\n&lt;/user&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®rule.xml\nrule.xmlé‡Œé¢å°±å®šä¹‰äº†æˆ‘ä»¬å¯¹è¡¨è¿›è¡Œæ‹†åˆ†æ‰€æ¶‰åŠåˆ°çš„è§„åˆ™å®šä¹‰ã€‚æˆ‘ä»¬å¯ä»¥çµæ´»çš„å¯¹è¡¨ä½¿ç”¨ä¸åŒçš„åˆ†ç‰‡ç®—æ³•ï¼Œ\næˆ–è€…å¯¹è¡¨ä½¿ç”¨ç›¸åŒçš„ç®—æ³•ä½†å…·ä½“çš„å‚æ•°ä¸åŒã€‚è¿™ä¸ªæ–‡ä»¶é‡Œé¢ä¸»è¦æœ‰tableRuleå’Œfunctionè¿™ä¸¤ä¸ªæ ‡ç­¾ã€‚\nåœ¨å…·ä½“ä½¿ç”¨è¿‡ç¨‹ä¸­å¯ä»¥æŒ‰ç…§éœ€æ±‚æ·»åŠ tableRuleå’Œfunctionã€‚\næ­¤é…ç½®æ–‡ä»¶å¯ä»¥ä¸ç”¨ä¿®æ”¹ï¼Œä½¿ç”¨é»˜è®¤å³å¯ã€‚\n</code></pre></div><h2>åœ¨CentOS7ä¸Šå®‰è£…SQL Server 2017</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç³»ç»Ÿéœ€æ±‚ï¼š\nCentOS7.3ä»¥ä¸Šï¼Œæˆ‘ç›®å‰ç”¨çš„æ˜¯CenOS7.4\næœåŠ¡å™¨è‡³å°‘3.25GBå†…å­˜\nå¥½åƒå¯¹CPUæ²¡æœ‰ä»€ä¹ˆè¦æ±‚ï¼Œæˆ‘åœ¨è™šæ‹Ÿæœºä¸­é…ç½®çš„CPUä¸ºä¸€æ ¸\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å®‰è£… SQL Server\nä¸‹è½½ Microsoft SQL Server Red Hat å­˜å‚¨åº“é…ç½®æ–‡ä»¶ï¼š\n[root@CentOS7~]#curl -o /etc/yum.repos.d/mssql-server.repo https://packages.microsoft.com/config/rhel/7/mssql-server-2017.repo\nè¿è¡Œä»¥ä¸‹å‘½ä»¤ï¼Œå®‰è£… SQL Serverï¼š\n[root@CentOS7 ~]# yum update\n[root@CentOS7 ~]# yum install -y mssql-server\nè¿è¡ŒåŒ…å®‰è£…å®Œæˆåmssql-conf å®‰è£…å¹¶æŒ‰ç…§æç¤ºæ“ä½œä»¥è®¾ç½® SA å¯†ç ï¼Œå¹¶é€‰æ‹©ä½ çš„ç‰ˆæœ¬ã€è¯­è¨€ã€è®¾ç½®sqlå¯†ç \n[root@CentOS7 ~]# /opt/mssql/bin/mssql-conf setup\nç¡®è®¤ SQL Server ç³»ç»Ÿç®¡ç†å‘˜å¯†ç :\nåœ¨å®‰è£…çš„æœ€åï¼Œç³»ç»Ÿä¼šæç¤ºå¦‚ä¸‹ï¼š\næ­£åœ¨é…ç½® SQL Server...\nCreated symlink from \n/etc/systemd/system/multi-user.target.wants/mssql-server.service to /usr/lib/systemd/system/mssql-server.service.\nå®‰è£…ç¨‹åºå·²æˆåŠŸå®Œæˆã€‚SQL Server æ­£åœ¨å¯åŠ¨ã€‚\né…ç½®å®Œæˆåï¼Œè¯·éªŒè¯æœåŠ¡æ˜¯å¦æ­£åœ¨è¿è¡Œï¼š\n[root@CentOS7 ~]# systemctl status mssql-server\nâ— mssql-server.service - Microsoft SQL Server Database Engine\n   Loaded: loaded (/usr/lib/systemd/system/mssql-server.service; enabled; vendor preset: disabled)\n   Active: active (running) since å›› 2017-10-05 14:19:18 CST; 21s ago\n\t Docs: https://docs.microsoft.com/en-us/sql/linux\n Main PID: 1208 (sqlservr)\n   CGroup: /system.slice/mssql-server.service\n\t\t   â”œâ”€1208 /opt/mssql/bin/sqlservr\n\t\t   â””â”€1228 /opt/mssql/bin/sqlservr\n............\nï¼ˆä»¥ä¸‹è¿›è¡Œçœç•¥ï¼‰\nå¦‚æœè¿è¡Œç»“æœå¦‚ä¸Šï¼ˆâ—æ­£å¸¸æ˜¯ç»¿é¢œè‰²çš„ï¼‰å°±æ˜¯æœåŠ¡æ­£å¸¸è¿è¡Œäº†ã€‚\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>è‹¥è¦å…è®¸è¿œç¨‹è¿æ¥ï¼Œè¯·æ‰“å¼€é˜²ç«å¢™ä¸Šçš„ SQL Server ç«¯å£ã€‚\né»˜è®¤çš„ SQL Server ç«¯å£ä¸º TCP 1433ã€‚ å¦‚æœä½ ä½¿ç”¨FirewallDé˜²ç«å¢™ï¼Œå¯ä»¥ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ·»åŠ è§„åˆ™ï¼š\n[root@CentOS7 ~]# firewall-cmd --zone=public --add-port=1433/tcp --permanent\n[root@CentOS7 ~]# firewall-cmd --reload\n\nå½“ç„¶å¦‚æœä½ çš„æœåŠ¡å™¨å‰ç«¯æ˜¯æœ‰é˜²ç«å¢™è¿›è¡Œä¿æŠ¤çš„ï¼Œ\nä¹Ÿå¯ä»¥ä¸ç”¨è¿è¡Œä¸Šè¿°å‘½ä»¤ï¼Œè€Œæ˜¯ç›´æ¥å°†ç³»ç»Ÿçš„é˜²ç«å¢™å…³é—­ã€‚\nä½¿ç”¨å¦‚ä¸‹å‘½ä»¤å…³é—­firewallDé˜²ç«å¢™å¹¶è®¾ç½®ä¸ºå¼€æœºä¸è‡ªåŠ¨å¯åŠ¨ï¼š\n[root@CentOS7 ~]# systemctl stop firewalld\n[root@CentOS7 ~]# systemctl disable firewalld\nRemoved symlink /etc/systemd/system/dbus-org.fedoraproject.FirewallD1.service.\nRemoved symlink /etc/systemd/system/multi-user.target.wants/firewalld.service.\nä»¥ä¸Šå°±å®Œæˆäº†SQL Server 2017çš„å®‰è£…\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å®‰è£… SQL Server å‘½ä»¤è¡Œå·¥å…·ï¼ˆsqlcmdå’Œbcpï¼‰\nä¸‹è½½å®‰è£…æºã€‚[root@CentOS7 ~]# curl -o /etc/yum.repos.d/msprod.repo https://packages.microsoft.com/config/rhel/7/prod.repo\nå®‰è£…mssql å·¥å…·ä¸ unixODBC å¼€å‘äººå‘˜åŒ…ï¼Œå®‰è£…ä¹‹å‰ç³»ç»Ÿä¼šæç¤ºä½ å¿…é¡»åŒæ„ç›¸å…³è®¸å¯ï¼Œæ³¨æ„ï¼šéœ€è¦è¾“å…¥å¤§å†™çš„YES\n[root@CentOS7 ~]# yum update\n[root@CentOS7 ~]# yum install -y mssql-tools unixODBC-devel\næ·»åŠ /opt/mssql-tools/bin/åˆ°ç¯å¢ƒå˜é‡\n[root@CentOS7 ~]# echo 'export PATH=\"$PATH:/opt/mssql-tools/bin\"' &gt;&gt; ~/.bash_profile\n[root@CentOS7 ~]# echo 'export PATH=\"$PATH:/opt/mssql-tools/bin\"' &gt;&gt; ~/.bashrc\n[root@CentOS7 ~]# source ~/.bashrc\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä½¿ç”¨sqlcmdè¿›è¡Œæœ¬åœ°è¿æ¥\n[root@CentOS7 ~]# sqlcmd -S localhost -U SA\nPassword:\nè¿™æ—¶ç³»ç»Ÿä¼šæç¤ºä½ è¾“å…¥saå¯†ç ï¼Œè¾“å…¥åå›è½¦\nå¦‚æœæˆåŠŸï¼Œåº”ä¼šæ˜¾ç¤º sqlcmd å‘½ä»¤æç¤ºç¬¦ï¼š1&gt;\n\n</code></pre></div><h1>ä¸€é”®Trojanæ­å»º(CentOS 7)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\n\n# æŸ¥çœ‹æ—¥å¿—\njournalctl -u trojan -f\n\n# æŸ¥çœ‹ç«¯å£å ç”¨\nnetstat -tunlp | grep ç«¯å£å·\n\n# è¿æ¥ç«¯å£\ntelnet 38.47.108.105  81\n\njunye54231535@gmail.com\nhttps://www.namesilo.com/\njunye54231535@gmail.com Junye54231535@gmail.com\n\n\nadmin\n2fEfpDxB\n\n\n\n\n03äº‹åŠ¡éš”ç¦»çš„å®ç°ç»“åˆ08\n06 å’Œ05é—®é¢˜æ—¶é—´\n10 é—®é¢˜æ—¶é—´\n15 ask\n38.47.108.105\n\n\n\n\n</code></pre></div><h1>åœ¨Linuxä¸‹å¼€å¯æŒ‡å®šç«¯å£å·</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>1ã€æŸ¥çœ‹æŸä¸ªç«¯å£æ˜¯å¦å·²å¼€å¯ï¼Œå¦‚æœæç¤ºnoè¡¨ç¤ºæœªå¼€å¯\nfirewall-cmd --query-port=8888/tcp\n\n2ã€æ°¸ä¹…å¼€å¯ç«¯å£å·ï¼Œæç¤º success è¡¨ç¤ºæˆåŠŸ\nfirewall-cmd --add-port=8888/tcp --permanent\n\n3ã€å¼€å¯ç«¯å£åè¦é‡è½½é…ç½®\nfirewall-cmd --reload\n \n4ã€ç§»é™¤ç«¯å£\nfirewall-cmd --permanent --remove-port=8888/tcp\n</code></pre></div><h2>ä»£ç†</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç¼–è¾‘ /etc/profile æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹å†…å®¹ï¼š\nexport HTTP_PROXY=http://192.168.1.141:7890/\nexport HTTPS_PROXY=http://192.168.1.141:7890/\nexport NO_PROXY=localhost,127.0.0.1,10.0.0.0/8,172.16.0.0/12,192.168.0.0/16,169.254.0.0/16\n\nä¿å­˜åï¼Œæ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä½¿æ›´æ”¹ç”Ÿæ•ˆï¼š\nsource /etc/profile\næ£€æŸ¥\ncurl -I https://www.google.com\n</code></pre></div><h2>è™šæ‹Ÿæœºç£ç›˜æ‰©å®¹</h2>\n<p>ä½¿ç”¨ fdisk åˆ›å»ºæ–°åˆ†åŒº<br>\næ‰§è¡Œä»¥ä¸‹å‘½ä»¤ä¸ºæœªåˆ†é…çš„ç£ç›˜ç©ºé—´åˆ›å»ºæ–°åˆ†åŒºï¼š</p>\n<p>fdisk /dev/sda<br>\næŒ‰ä»¥ä¸‹æ­¥éª¤æ“ä½œï¼š</p>\n<p>è¾“å…¥ n åˆ›å»ºä¸€ä¸ªæ–°åˆ†åŒºã€‚<br>\né€‰æ‹©åˆ†åŒºç±»å‹ä¸º primaryï¼ˆä¸»åˆ†åŒºï¼‰ã€‚<br>\næä¾›èµ·å§‹å’Œç»“æŸä½ç½®ï¼ˆç›´æ¥æŒ‰å›è½¦é”®é»˜è®¤ä½¿ç”¨å‰©ä½™ç©ºé—´ï¼‰ã€‚<br>\nè¾“å…¥ t ä¿®æ”¹åˆ†åŒºç±»å‹ä¸º 8eï¼ˆLinux LVMï¼‰ã€‚<br>\nè¾“å…¥ w ä¿å­˜æ›´æ”¹å¹¶é€€å‡ºã€‚<br>\npartprobe /dev/sda<br>\nè¿è¡Œ fdisk -l å†æ¬¡æŸ¥çœ‹ï¼Œæ–°åˆ†åŒºåº”è¯¥æ˜¾ç¤ºä¸º /dev/sda3ã€‚</p>\n<ol start=\"3\">\n<li>å°†æ–°åˆ†åŒºæ·»åŠ ä¸ºç‰©ç†å·<br>\nå°†æ–°åˆ›å»ºçš„åˆ†åŒº /dev/sda3 åˆå§‹åŒ–ä¸º LVM çš„ç‰©ç†å·ï¼š<br>\npvcreate /dev/sda3<br>\nPhysical volume \"/dev/sda3\" successfully created</li>\n</ol>\n<p>æ‰©å±•å·ç»„<br>\nå°†æ–°åˆ›å»ºçš„ç‰©ç†å· /dev/sda3 æ·»åŠ åˆ°ç°æœ‰å·ç»„ centosï¼š<br>\nvgextend centos /dev/sda3<br>\néªŒè¯å·ç»„æ˜¯å¦æ‰©å±•æˆåŠŸï¼š<br>\nvgs<br>\næ­¤æ—¶åº”è¯¥èƒ½çœ‹åˆ° VFree æ˜¾ç¤ºæœ‰äº†æ–°çš„ç©ºé—²ç©ºé—´ã€‚<br>\nlvextend -l +100%FREE /dev/mapper/centos-root<br>\næŠ¥é”™lvextend -l +100%FREE /dev/mapper/centos-root<br>\nå°± rm -rf /etc/lvm/archive/*<br>\nrm -rf /tmp/*æ¸…é™¤åé‡æ–°æ‰§è¡Œ<br>\næ–‡ä»¶ç³»ç»Ÿæ‰©å®¹sudo xfs_growfs /dev/mapper/centos-root</p>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/71c1796efe37e96e0628b.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "è¿ç»´"
      ]
    },
    {
      "title": "UML",
      "url": "https://javaguide.cn/backend/cs/uml.html",
      "id": "https://javaguide.cn/backend/cs/uml.html",
      "summary": "uml 1. UMLâ€”â€”Unified modeling language UML (ç»Ÿä¸€å»ºæ¨¡è¯­è¨€) 2. UMLå›¾ä¾‹ 3. UMLå›¾åˆ†ç±» 4. ä¾èµ–å…³ç³» 1. UMLâ€”â€”Unified modeling language UML (ç»Ÿä¸€å»ºæ¨¡è¯­è¨€) UMLæ˜¯ä¸€ç§ç”¨äºè½¯ä»¶ç³»ç»Ÿåˆ†æå’Œè®¾è®¡çš„è¯­è¨€å·¥å…·ï¼Œå®ƒç”¨äºå¸®åŠ©è½¯ä»¶å¼€å‘äººå‘˜è¿›è¡Œæ€è€ƒå’Œè®°å½•æ€è·¯çš„ç»“æœ UMLæœ¬èº«...",
      "content_html": "<p>uml</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-umlunified-modeling-language-uml-%E7%BB%9F%E4%B8%80%E5%BB%BA%E6%A8%A1%E8%AF%AD%E8%A8%80\">1. UMLâ€”â€”Unified modeling language UML (ç»Ÿä¸€å»ºæ¨¡è¯­è¨€)</a></li>\n<li><a href=\"#2-uml%E5%9B%BE%E4%BE%8B\">2. UMLå›¾ä¾‹</a></li>\n<li><a href=\"#3-uml%E5%9B%BE%E5%88%86%E7%B1%BB\">3. UMLå›¾åˆ†ç±»</a></li>\n<li><a href=\"#4-%E4%BE%9D%E8%B5%96%E5%85%B3%E7%B3%BB\">4. ä¾èµ–å…³ç³»</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. UMLâ€”â€”Unified modeling language UML (ç»Ÿä¸€å»ºæ¨¡è¯­è¨€)</h1>\n<ul>\n<li>UMLæ˜¯ä¸€ç§ç”¨äºè½¯ä»¶ç³»ç»Ÿåˆ†æå’Œè®¾è®¡çš„è¯­è¨€å·¥å…·ï¼Œå®ƒç”¨äºå¸®åŠ©è½¯ä»¶å¼€å‘äººå‘˜è¿›è¡Œæ€è€ƒå’Œè®°å½•æ€è·¯çš„ç»“æœ</li>\n<li>UMLæœ¬èº«æ˜¯ä¸€å¥—ç¬¦å·çš„è§„å®šï¼Œç”¨äºæè¿°è½¯ä»¶æ¨¡å‹ä¸­çš„å„ä¸ªå…ƒç´ å’Œä»–ä»¬ä¹‹é—´çš„å…³ç³»ï¼Œæ¯”å¦‚ç±»ã€æ¥å£ã€å®ç°ã€æ³›åŒ–ã€ä¾èµ–ã€ç»„åˆã€èšåˆç­‰</li>\n<li>ä½¿ç”¨UMLæ¥å»ºæ¨¡ï¼Œå¸¸ç”¨çš„å·¥å…·æœ‰ Rational Rose , ä¹Ÿå¯ä»¥ä½¿ç”¨ä¸€äº›æ’ä»¶æ¥å»ºæ¨¡</li>\n<li>ç”¨äºæè¿°ç³»ç»Ÿä¸­çš„ç±»(å¯¹è±¡)æœ¬èº«çš„ç»„æˆå’Œç±»(å¯¹è±¡)ä¹‹é—´çš„å„ç§é™æ€å…³ç³»ã€‚</li>\n<li>ç±»ä¹‹é—´çš„å…³ç³»ï¼šä¾èµ–ã€æ³›åŒ–ï¼ˆç»§æ‰¿ï¼‰ã€å®ç°ã€å…³è”ã€èšåˆä¸ç»„åˆ</li>\n</ul>\n<h1>2. UMLå›¾ä¾‹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6195768fe18cf19f843db.png\" alt=\"1.png\" tabindex=\"0\"><figcaption>1.png</figcaption></figure>\n<h1>3. UMLå›¾åˆ†ç±»</h1>\n<ul>\n<li>ç”¨ä¾‹å›¾(use case)</li>\n<li>é™æ€ç»“æ„å›¾ï¼šç±»å›¾(ç±»å›¾æ˜¯æè¿°ç±»ä¸ç±»ä¹‹é—´çš„å…³ç³»çš„ï¼Œæ˜¯UMLå›¾ä¸­æœ€æ ¸å¿ƒçš„)ã€å¯¹è±¡å›¾ã€åŒ…å›¾ã€ç»„ä»¶å›¾ã€éƒ¨ç½²å›¾</li>\n<li>åŠ¨æ€è¡Œä¸ºå›¾ï¼šäº¤äº’å›¾ï¼ˆæ—¶åºå›¾ä¸åä½œå›¾ï¼‰ã€çŠ¶æ€å›¾ã€æ´»åŠ¨å›¾</li>\n</ul>\n<h1>4. ä¾èµ–å…³ç³»</h1>\n<ul>\n<li>\n<p>ç±»å›¾â€”ä¾èµ–å…³ç³»ï¼ˆDependenceï¼‰ ç±»ä¸­ç”¨åˆ°äº†å¯¹æ–¹\\ç±»çš„æˆå‘˜å±æ€§\\æ–¹æ³•çš„è¿”å›ç±»å‹\\æ–¹æ³•æ¥æ”¶çš„å‚æ•°ç±»å‹\\æ–¹æ³•ä¸­ä½¿ç”¨åˆ°</p>\n</li>\n<li>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7708aae05861181588a42.png\" alt=\"2.png\" tabindex=\"0\"><figcaption>2.png</figcaption></figure>\n</li>\n<li>\n<p>ç±»å›¾â€”æ³›åŒ–å…³ç³»(generalization) æ³›åŒ–å…³ç³»å®é™…ä¸Šå°±æ˜¯ç»§æ‰¿å…³ç³»ï¼Œä»–æ˜¯ä¾èµ–å…³ç³»çš„ç‰¹ä¾‹ å¦‚æœAç±»ç»§æ‰¿äº†Bç±»ï¼Œæˆ‘ä»¬å°±è¯´Aå’ŒBå­˜åœ¨æ³›åŒ–å…³ç³»</p>\n</li>\n<li>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ca768a81e42990feb878d.png\" alt=\"3.png\" tabindex=\"0\"><figcaption>3.png</figcaption></figure>\n</li>\n<li>\n<p>ç±»å›¾â€”å®ç°å…³ç³»ï¼ˆImplementationï¼‰ å®ç°å…³ç³»å®é™…ä¸Šå°±æ˜¯Aç±»å®ç°Bæ¥å£ï¼Œä»–æ˜¯ä¾èµ–å…³ç³»çš„ç‰¹ä¾‹<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a9fc5d4edbe85d76da51a.png\" alt=\"4.png\"></p>\n</li>\n<li>\n<p>ç±»å›¾â€”å…³è”å…³ç³»ï¼ˆAssociationï¼‰ ç±»ä¸ç±»ä¹‹é—´çš„è”ç³»ï¼Œä»–æ˜¯ä¾èµ–å…³ç³»çš„ç‰¹ä¾‹ã€å…³è”å…·æœ‰å¯¼èˆªæ€§ï¼šå³åŒå‘å…³ç³»æˆ–å•å‘å…³ç³»</p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    å•å‘ä¸€å¯¹ä¸€å…³ç³»\n    public class Person {\n        private IDCard card;\n    }\n    public class IDCard{}\n    \n    åŒå‘ä¸€å¯¹ä¸€å…³ç³»\n    public class Person {\n        private IDCard card;\n    }\n    public class IDCard{\n        private Person person\n    }\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6e369a8ab9c2ba242a992.png\" alt=\"5.png\" tabindex=\"0\"><figcaption>5.png</figcaption></figure>\n<ul>\n<li>ç±»å›¾â€”èšåˆå…³ç³»ï¼ˆAggregationï¼‰ è¡¨ç¤ºçš„æ˜¯æ•´ä½“å’Œéƒ¨åˆ†çš„å…³ç³»ï¼Œæ•´ä½“ä¸éƒ¨åˆ†å¯ä»¥åˆ†å¼€</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    public class Computer {\n        private Mouse mouse; //é¼ æ ‡å¯ä»¥å’Œcomputeråˆ†ç¦»\n        private Moniter moniter;//æ˜¾ç¤ºå™¨å¯ä»¥å’ŒComputeråˆ†ç¦»\n        public void setMouse(Mouse mouse) {\n            this.mouse = mouse;\n        }\n        public void setMoniter(Moniter moniter) {\n            this.moniter = moniter;\n        }\n        \n    }\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7a5b0e2215fb163368219.png\" alt=\"6.png\" tabindex=\"0\"><figcaption>6.png</figcaption></figure>\n<ul>\n<li>ç±»å›¾â€”ç»„åˆå…³ç³»ï¼ˆCompositionï¼‰ ä¹Ÿæ˜¯æ•´ä½“ä¸éƒ¨åˆ†çš„å…³ç³»ï¼Œä½†æ˜¯æ•´ä½“ä¸éƒ¨åˆ†ä¸å¯ä»¥åˆ†å¼€<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/22e5d55432836886fc309.png\" alt=\"1.png\"></li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    public class Person{\n    private IDCard card;\n    private Head head = new Head();\n    }\n    public class IDCard{}\n    public class Head{}\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/cdd20c73318764930990c.png\" alt=\"7.png\" tabindex=\"0\"><figcaption>7.png</figcaption></figure>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/6195768fe18cf19f843db.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "æ“ä½œç³»ç»Ÿ",
      "url": "https://javaguide.cn/backend/cs/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html",
      "id": "https://javaguide.cn/backend/cs/%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F.html",
      "summary": "æ“ä½œç³»ç»Ÿ 1. æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µå’Œä½œç”¨ 2. æ“ä½œç³»ç»Ÿçš„å‘å±•è¿‡ç¨‹ 3. æ“ä½œç³»ç»Ÿçš„åŸºæœ¬ç‰¹æ€§ 4. æ“ä½œç³»ç»Ÿä¸»è¦åŠŸèƒ½ 5. æ“ä½œç³»ç»Ÿçš„è¿è¡Œç¯å¢ƒ 6. è¿›ç¨‹æè¿°ä¸æ§åˆ¶ 6.1. å‰è¶‹å›¾(DAG Directed Acyclic Graph): 6.2. ç¨‹åºæ‰§è¡Œæ–¹å¼ 6.3. è¿›ç¨‹ 6.4. çº¿ç¨‹ 6.5. è¿›ç¨‹æ§åˆ¶ 6.6. è¿›ç¨‹åŒæ­¥ 6.7. è¿›ç¨‹é€šä¿¡ ...",
      "content_html": "<p>æ“ä½œç³»ç»Ÿ</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E6%A6%82%E5%BF%B5%E5%92%8C%E4%BD%9C%E7%94%A8\">1. æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µå’Œä½œç”¨</a></li>\n<li><a href=\"#2-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%8F%91%E5%B1%95%E8%BF%87%E7%A8%8B\">2. æ“ä½œç³»ç»Ÿçš„å‘å±•è¿‡ç¨‹</a></li>\n<li><a href=\"#3-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%9F%BA%E6%9C%AC%E7%89%B9%E6%80%A7\">3. æ“ä½œç³»ç»Ÿçš„åŸºæœ¬ç‰¹æ€§</a></li>\n<li><a href=\"#4-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E4%B8%BB%E8%A6%81%E5%8A%9F%E8%83%BD\">4. æ“ä½œç³»ç»Ÿä¸»è¦åŠŸèƒ½</a></li>\n<li><a href=\"#5-%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E7%9A%84%E8%BF%90%E8%A1%8C%E7%8E%AF%E5%A2%83\">5. æ“ä½œç³»ç»Ÿçš„è¿è¡Œç¯å¢ƒ</a></li>\n<li><a href=\"#6-%E8%BF%9B%E7%A8%8B%E6%8F%8F%E8%BF%B0%E4%B8%8E%E6%8E%A7%E5%88%B6\">6. è¿›ç¨‹æè¿°ä¸æ§åˆ¶</a>\n<ul>\n<li><a href=\"#61-%E5%89%8D%E8%B6%8B%E5%9B%BEdag-directed-acyclic-graph\">6.1. å‰è¶‹å›¾(DAG Directed Acyclic Graph):</a></li>\n<li><a href=\"#62-%E7%A8%8B%E5%BA%8F%E6%89%A7%E8%A1%8C%E6%96%B9%E5%BC%8F\">6.2. ç¨‹åºæ‰§è¡Œæ–¹å¼</a></li>\n<li><a href=\"#63-%E8%BF%9B%E7%A8%8B\">6.3. è¿›ç¨‹</a></li>\n<li><a href=\"#64-%E7%BA%BF%E7%A8%8B\">6.4. çº¿ç¨‹</a></li>\n<li><a href=\"#65-%E8%BF%9B%E7%A8%8B%E6%8E%A7%E5%88%B6\">6.5. è¿›ç¨‹æ§åˆ¶</a></li>\n<li><a href=\"#66-%E8%BF%9B%E7%A8%8B%E5%90%8C%E6%AD%A5\">6.6. è¿›ç¨‹åŒæ­¥</a></li>\n<li><a href=\"#67-%E8%BF%9B%E7%A8%8B%E9%80%9A%E4%BF%A1\">6.7. è¿›ç¨‹é€šä¿¡</a></li>\n<li><a href=\"#68-%E5%A4%84%E7%90%86%E5%99%A8%E8%B0%83%E5%BA%A6\">6.8. å¤„ç†å™¨è°ƒåº¦</a></li>\n<li><a href=\"#69-%E6%AD%BB%E9%94%81\">6.9. æ­»é”</a></li>\n</ul>\n</li>\n<li><a href=\"#7-linux%E8%BF%9B%E7%A8%8B%E7%AE%A1%E7%90%86\">7. linuxè¿›ç¨‹ç®¡ç†</a>\n<ul>\n<li><a href=\"#71-%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%B1%BB%E5%9E%8B\">7.1. è¿›ç¨‹çš„ç±»å‹</a></li>\n<li><a href=\"#72-%E8%BF%9B%E7%A8%8B%E7%9A%84%E6%A0%87%E8%AE%B0\">7.2. è¿›ç¨‹çš„æ ‡è®°</a></li>\n<li><a href=\"#73-%E6%93%8D%E4%BD%9Clinux%E8%BF%9B%E7%A8%8B%E7%9A%84%E7%9B%B8%E5%85%B3%E5%91%BD%E4%BB%A4\">7.3. æ“ä½œlinuxè¿›ç¨‹çš„ç›¸å…³å‘½ä»¤</a></li>\n</ul>\n</li>\n<li><a href=\"#8-%E5%86%85%E5%AD%98%E7%AE%A1%E7%90%86%E6%A6%82%E8%BF%B0\">8. å†…å­˜ç®¡ç†æ¦‚è¿°</a></li>\n<li><a href=\"#9-%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F\">9. å­˜å‚¨ç®¡ç†æ–¹å¼</a>\n<ul>\n<li><a href=\"#91-%E5%A4%9A%E9%81%93%E7%A8%8B%E5%BA%8F%E7%8E%AF%E5%A2%83%E4%B8%8B%E7%9A%84%E5%AF%B9%E6%8D%A2%E6%8A%80%E6%9C%AFswapping\">9.1. å¤šé“ç¨‹åºç¯å¢ƒä¸‹çš„å¯¹æ¢æŠ€æœ¯(Swapping)</a></li>\n</ul>\n</li>\n<li><a href=\"#10-linux%E7%9A%84%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86\">10. linuxçš„å­˜å‚¨ç®¡ç†</a></li>\n<li><a href=\"#11-%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E5%99%A8\">11. è™šæ‹Ÿå­˜å‚¨å™¨</a>\n<ul>\n<li><a href=\"#111-%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E5%99%A8%E6%A6%82%E8%BF%B0\">11.1. è™šæ‹Ÿå­˜å‚¨å™¨æ¦‚è¿°</a></li>\n<li><a href=\"#112-%E8%99%9A%E6%8B%9F%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F\">11.2. è™šæ‹Ÿå­˜å‚¨ç®¡ç†æ–¹å¼</a></li>\n<li><a href=\"#113-%E9%A1%B5%E9%9D%A2%E8%B0%83%E5%85%A5%E7%AD%96%E7%95%A5\">11.3. é¡µé¢è°ƒå…¥ç­–ç•¥</a></li>\n<li><a href=\"#%E7%89%A9%E7%90%86%E5%9D%97%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5\">ç‰©ç†å—åˆ†é…ç­–ç•¥</a></li>\n<li><a href=\"#114-%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5\">11.4. å†…å­˜åˆ†é…ç­–ç•¥</a></li>\n<li><a href=\"#115-%E9%A1%B5%E9%9D%A2%E7%BD%AE%E6%8D%A2%E7%AE%97%E6%B3%95page-replacement-algorithms\">11.5. é¡µé¢ç½®æ¢ç®—æ³•(Page-Replacement Algorithms)</a></li>\n<li><a href=\"#116-%E6%8A%96%E5%8A%A8%E4%B8%8E%E5%B7%A5%E4%BD%9C%E9%9B%86\">11.6. æŠ–åŠ¨ä¸å·¥ä½œé›†</a></li>\n<li><a href=\"#117-%E8%AF%B7%E6%B1%82%E5%88%86%E6%AE%B5%E5%AD%98%E5%82%A8%E7%AE%A1%E7%90%86%E6%96%B9%E5%BC%8F\">11.7. è¯·æ±‚åˆ†æ®µå­˜å‚¨ç®¡ç†æ–¹å¼</a></li>\n</ul>\n</li>\n<li><a href=\"#12-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F\">12. è¾“å…¥è¾“å‡ºç³»ç»Ÿ</a>\n<ul>\n<li><a href=\"#121-io%E8%AE%BE%E5%A4%87%E5%88%86%E7%B1%BB\">12.1. I/Oè®¾å¤‡åˆ†ç±»</a></li>\n<li><a href=\"#122-io%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD\">12.2. I/Oç³»ç»Ÿçš„åŸºæœ¬åŠŸèƒ½</a></li>\n<li><a href=\"#123-io%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84%E5%92%8C%E6%A8%A1%E5%9E%8B\">12.3. I/Oç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„å’Œæ¨¡å‹</a></li>\n</ul>\n</li>\n<li><a href=\"#13-io%E8%AE%BE%E5%A4%87%E5%92%8C%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E5%99%A8%E6%A6%82%E8%BF%B0\">13. I/Oè®¾å¤‡å’Œè®¾å¤‡æ§åˆ¶å™¨æ¦‚è¿°</a>\n<ul>\n<li><a href=\"#131-%E8%AE%BE%E5%A4%87%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F\">13.1. è®¾å¤‡å¯»å€æ–¹å¼</a></li>\n<li><a href=\"#132-%E8%AE%BE%E5%A4%87%E6%8E%A7%E5%88%B6%E5%99%A8%E5%88%86%E6%88%90%E6%8E%A7%E5%88%B6%E5%AD%97%E7%AC%A6%E8%AE%BE%E5%A4%87%E7%9A%84%E6%8E%A7%E5%88%B6%E5%99%A8%E5%92%8C%E6%8E%A7%E5%88%B6%E5%9D%97%E8%AE%BE%E5%A4%87%E7%9A%84%E6%8E%A7%E5%88%B6%E5%99%A8\">13.2. è®¾å¤‡æ§åˆ¶å™¨ï¼ˆåˆ†æˆæ§åˆ¶å­—ç¬¦è®¾å¤‡çš„æ§åˆ¶å™¨å’Œæ§åˆ¶å—è®¾å¤‡çš„æ§åˆ¶å™¨ï¼‰</a></li>\n<li><a href=\"#133-io%E9%80%9A%E9%81%93\">13.3. I/Oé€šé“</a></li>\n</ul>\n</li>\n<li><a href=\"#14-%E4%B8%AD%E6%96%AD%E6%9C%BA%E6%9E%84%E5%92%8C%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F\">14. ä¸­æ–­æœºæ„å’Œè®¾å¤‡é©±åŠ¨ç¨‹åº</a>\n<ul>\n<li><a href=\"#141-%E4%B8%AD%E6%96%AD%E6%9C%BA%E6%9E%84\">14.1. ä¸­æ–­æœºæ„</a></li>\n<li><a href=\"#142-%E8%AE%BE%E5%A4%87%E9%A9%B1%E5%8A%A8%E7%A8%8B%E5%BA%8F\">14.2. è®¾å¤‡é©±åŠ¨ç¨‹åº</a></li>\n<li><a href=\"#143-%E4%B8%8E%E8%AE%BE%E5%A4%87%E6%97%A0%E5%85%B3%E7%9A%84io%E8%BD%AF%E4%BB%B6\">14.3. ä¸è®¾å¤‡æ— å…³çš„I/Oè½¯ä»¶</a></li>\n<li><a href=\"#144-%E7%94%A8%E6%88%B7%E5%B1%82%E7%9A%84io%E8%BD%AF%E4%BB%B6\">14.4. ç”¨æˆ·å±‚çš„I/Oè½¯ä»¶</a></li>\n<li><a href=\"#145-%E5%81%87%E8%84%B1%E6%9C%BAspooling%E7%B3%BB%E7%BB%9F%E8%99%9A%E6%8B%9F%E8%AE%BE%E5%A4%87%E6%8A%80%E6%9C%AF%E5%B0%86%E7%8B%AC%E5%8D%A0%E8%AE%BE%E5%A4%87%E6%94%B9%E6%88%90%E5%85%B1%E4%BA%AB%E8%AE%BE%E5%A4%87%E7%9A%84%E6%8A%80%E6%9C%AF\">14.5. å‡è„±æœºï¼ˆSpoolingï¼‰ç³»ç»Ÿï¼ˆè™šæ‹Ÿè®¾å¤‡æŠ€æœ¯ï¼‰ï¼šå°†ç‹¬å è®¾å¤‡æ”¹æˆå…±äº«è®¾å¤‡çš„æŠ€æœ¯</a></li>\n<li><a href=\"#146-%E7%BC%93%E5%86%B2%E5%8C%BA%E7%AE%A1%E7%90%86\">14.6. ç¼“å†²åŒºç®¡ç†</a></li>\n</ul>\n</li>\n<li><a href=\"#15-%E6%96%87%E4%BB%B6%E5%92%8C%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F\">15. æ–‡ä»¶å’Œæ–‡ä»¶ç³»ç»Ÿ</a>\n<ul>\n<li><a href=\"#151-linux%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F\">15.1. linuxæ–‡ä»¶ç³»ç»Ÿ</a></li>\n</ul>\n</li>\n<li><a href=\"#16-%E6%96%87%E4%BB%B6%E7%9A%84%E9%80%BB%E8%BE%91%E7%BB%93%E6%9E%84\">16. æ–‡ä»¶çš„é€»è¾‘ç»“æ„</a></li>\n<li><a href=\"#17-%E6%96%87%E4%BB%B6%E7%9B%AE%E5%BD%95\">17. æ–‡ä»¶ç›®å½•</a></li>\n<li><a href=\"#18-%E6%96%87%E4%BB%B6%E5%85%B1%E4%BA%AB\">18. æ–‡ä»¶å…±äº«</a></li>\n<li><a href=\"#19-%E6%96%87%E4%BB%B6%E4%BF%9D%E6%8A%A4\">19. æ–‡ä»¶ä¿æŠ¤</a></li>\n<li><a href=\"#20-%E5%A4%96%E5%AD%98%E7%9A%84%E7%BB%84%E7%BB%87%E6%96%B9%E5%BC%8F%E8%BE%85%E5%AD%98%E7%9A%84%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E5%88%86%E9%85%8D\">20. å¤–å­˜çš„ç»„ç»‡æ–¹å¼(è¾…å­˜çš„å­˜å‚¨ç©ºé—´åˆ†é…)</a></li>\n<li><a href=\"#21-%E6%96%87%E4%BB%B6%E5%AD%98%E5%82%A8%E7%A9%BA%E9%97%B4%E7%9A%84%E7%AE%A1%E7%90%86\">21. æ–‡ä»¶å­˜å‚¨ç©ºé—´çš„ç®¡ç†</a></li>\n<li><a href=\"#22-%E6%8F%90%E9%AB%98%E7%A3%81%E7%9B%98io%E9%80%9F%E5%BA%A6%E7%9A%84%E9%80%94%E5%BE%84\">22. æé«˜ç£ç›˜I/Oé€Ÿåº¦çš„é€”å¾„</a></li>\n<li><a href=\"#23-%E6%8F%90%E9%AB%98%E7%A3%81%E7%9B%98%E5%8F%AF%E9%9D%A0%E6%80%A7%E7%9A%84%E6%8A%80%E6%9C%AF\">23. æé«˜ç£ç›˜å¯é æ€§çš„æŠ€æœ¯</a></li>\n<li><a href=\"#24-%E6%95%B0%E6%8D%AE%E4%B8%80%E8%87%B4%E6%80%A7%E6%8E%A7%E5%88%B6\">24. æ•°æ®ä¸€è‡´æ€§æ§åˆ¶</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. æ“ä½œç³»ç»Ÿçš„æ¦‚å¿µå’Œä½œç”¨</h1>\n<ul>\n<li>æ“ä½œç³»ç»Ÿæ¦‚å¿µï¼šä¸€ç»„èƒ½æœ‰æ•ˆç»„ç»‡å’Œç®¡ç†è®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶èµ„æºå¹¶å¯¹å„ç±»ä½œä¸šè¿›è¡Œè°ƒåº¦çš„ç¨‹åºçš„é›†åˆ/æ“ä½œç³»ç»Ÿæ˜¯æŒ‡ç®¡ç†è®¡ç®—æœºç¡¬ä»¶å’Œè½¯ä»¶èµ„æºçš„è®¡ç®—æœºç¨‹åºï¼ˆæ˜¯è½¯ä»¶ï¼‰</li>\n<li>åŸå­æ“ä½œ:ä¸€ä¸ªä¸å¯åˆ†å‰²çš„åŸºæœ¬å•ä½ï¼Œåœ¨æ‰§è¡Œè¿‡ç¨‹ä¸­ä¸å…è®¸è¢«ä¸­æ–­ã€‚åœ¨ç³»ç»Ÿæ€ä¸‹æ‰§è¡Œï¼Œå¸¸é©»å†…å­˜</li>\n<li>åŸè¯­æ“ä½œ:ç”±è‹¥å¹²æ¡æŒ‡ä»¤ç»„æˆçš„ï¼Œç”¨äºå®Œæˆä¸€å®šåŠŸèƒ½çš„è¿‡ç¨‹ï¼Œæ˜¯ä¸€ä¸ªåŸå­æ“ä½œ</li>\n<li>æ“ä½œç³»ç»Ÿä½œç”¨\n<ul>\n<li>æä¾›ç”¨æˆ·ä¸è®¡ç®—æœºç¡¬ä»¶ä¹‹é—´çš„æ¥å£ï¼ˆç”¨æˆ·é€šè¿‡å‘½ä»¤ã€ç³»ç»Ÿè°ƒç”¨ã€å’Œå›¾æ ‡ä¸€çª—å£æ–¹å¼ä¸ç³»ç»Ÿé€šä¿¡å¹¶å–å¾—å®ƒçš„æœåŠ¡ï¼‰</li>\n<li>ç®¡ç†ç³»ç»Ÿèµ„æºï¼ˆç®¡ç†å¤„ç†æœºã€å­˜å‚¨å™¨ã€I/Oè®¾å¤‡å’Œæ–‡ä»¶(æ•°æ®å’Œç¨‹åº)ç­‰èµ„æºã€åè°ƒç”¨æˆ·å¯¹å…±äº«èµ„æºçš„ä½¿ç”¨ï¼‰</li>\n<li>è®¡ç®—æœºèµ„æºçš„æŠ½è±¡ï¼ˆéšè—å¯¹ç¡¬ä»¶æ“ä½œçš„å…·ä½“ç»†èŠ‚ï¼Œå¢å¼ºç³»ç»ŸåŠŸèƒ½ï¼‰</li>\n</ul>\n</li>\n<li>æ“ä½œç³»ç»Ÿå†…æ ¸\n<ul>\n<li>æ”¯æ’‘åŠŸèƒ½ï¼šä¸­æ–­å¤„ç†ã€æ—¶é’Ÿç®¡ç†ã€åŸè¯­æ“ä½œ</li>\n<li>èµ„æºç®¡ç†åŠŸèƒ½ï¼šè¿›ç¨‹ç®¡ç†ã€å­˜å‚¨å™¨ç®¡ç†ã€è®¾å¤‡ç®¡ç†</li>\n</ul>\n</li>\n</ul>\n<h1>2. æ“ä½œç³»ç»Ÿçš„å‘å±•è¿‡ç¨‹</h1>\n<ul>\n<li>æ“ä½œç³»ç»Ÿå‘å±•å†ç¨‹\n<ul>\n<li>äººå·¥æ“ä½œæ–¹å¼</li>\n<li>è„±æœºè¾“å…¥/è¾“å‡º(Off-Line I/O)æ–¹å¼</li>\n<li>å•é“æ‰¹å¤„ç†ç³»ç»Ÿ(Simple Batch Processing System)</li>\n<li>å¤šé“æ‰¹å¤„ç†ç³»ç»Ÿ(Multiprogrammed Batch Processing System)</li>\n<li>åˆ†æ—¶ç³»ç»Ÿï¼ˆäººæœºäº¤äº’ï¼‰(Time Sharing System)</li>\n<li>å®æ—¶ç³»ç»Ÿ(å·¥ä¸šæ§åˆ¶ç³»ç»Ÿç­‰)(Real Time System)</li>\n<li>å¾®æœºæ“ä½œç³»ç»Ÿ\n<ul>\n<li>å•ç”¨æˆ·å•ä»»åŠ¡æ“ä½œç³»ç»Ÿ(CP/Mã€MS-DOS)</li>\n<li>å•ç”¨æˆ·å¤šä»»åŠ¡æ“ä½œç³»ç»Ÿwindows</li>\n<li>å¤šç”¨æˆ·å¤šä»»åŠ¡æ“ä½œç³»ç»ŸLinux</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>3. æ“ä½œç³»ç»Ÿçš„åŸºæœ¬ç‰¹æ€§</h1>\n<ul>\n<li>å¹¶å‘(Concurrence)\n<ul>\n<li>å¹¶è¡Œ:å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€æ—¶åˆ»å‘ç”Ÿã€å¹¶å‘:å¤šä¸ªäº‹ä»¶åœ¨åŒä¸€ä¸ªæ—¶é—´å‘ç”Ÿã€ä¸²è¡Œ:å¤šä¸ªäº‹ä»¶æŒ‰é¡ºåºæ‰§è¡Œ</li>\n<li>å¹¶å‘æ€§ï¼šä¸€æ®µæ—¶é—´å†…å®è§‚ä¸Šæœ‰å¤šä¸ªç¨‹åºåŒæ—¶è¿è¡Œï¼Œå¾®è§‚ä¸Šå¤šä¸ªç¨‹åºåˆ†æ—¶è¿è¡Œ</li>\n</ul>\n</li>\n<li>å…±äº«(Sharing)\n<ul>\n<li>èµ„æºå…±äº«/å¤ç”¨:ç³»ç»Ÿä¸­çš„èµ„æºå¯ä¾›å†…å­˜ä¸­å¤šä¸ªå¹¶å‘è¿›ç¨‹å…±åŒä½¿ç”¨</li>\n<li>äº’æ–¥å…±äº«æ–¹å¼ï¼šä¸€å®šæ—¶é—´å†…ï¼Œåªå…è®¸ä¸€ä¸ªè¿›ç¨‹è®¿é—®ä¸´ç•Œèµ„æº</li>\n</ul>\n</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/5882cbd92d95d868467a2.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "ç®—æ³•",
      "url": "https://javaguide.cn/backend/cs/%E7%AE%97%E6%B3%95.html",
      "id": "https://javaguide.cn/backend/cs/%E7%AE%97%E6%B3%95.html",
      "summary": "æ•°æ®ç»“æ„å’Œç®—æ³• 1. æ¦‚è¿° æ•°æ®dataç»“æ„(structure)æ˜¯ä¸€é—¨ç ”ç©¶ç»„ç»‡æ•°æ®æ–¹å¼çš„å­¦ç§‘ï¼Œæœ‰äº†ç¼–ç¨‹è¯­è¨€ä¹Ÿå°±æœ‰äº†æ•°æ®ç»“æ„.å­¦å¥½æ•°æ®ç»“æ„å¯ä»¥ç¼–å†™æ›´åŠ æœ‰æ•ˆç‡çš„ä»£ç  ç¨‹åº = æ•°æ®ç»“æ„ + ç®—æ³• 1.1. æ•°æ®ç»“æ„çš„åˆ†ç±» çº¿æ€§ç»“æ„ï¼šç‰¹ç‚¹æ˜¯æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€å¯¹ä¸€çš„çº¿æ€§å…³ç³»ï¼šå¸¸è§çš„æœ‰ï¼šæ•°ç»„ã€é˜Ÿåˆ—ã€é“¾è¡¨å’Œæ ˆ.æœ‰ä¸¤ç§ä¸åŒçš„å­˜å‚¨ç»“æ„ï¼Œå³é¡ºåºå­˜å‚¨ç»“æ„(æ•°ç»„)å’Œé“¾å¼å­˜...",
      "content_html": "<p>æ•°æ®ç»“æ„å’Œç®—æ³•</p>\n<!--more-->\n<h1>1. æ¦‚è¿°</h1>\n<ul>\n<li>æ•°æ®dataç»“æ„(structure)æ˜¯ä¸€é—¨ç ”ç©¶ç»„ç»‡æ•°æ®æ–¹å¼çš„å­¦ç§‘ï¼Œæœ‰äº†ç¼–ç¨‹è¯­è¨€ä¹Ÿå°±æœ‰äº†æ•°æ®ç»“æ„.å­¦å¥½æ•°æ®ç»“æ„å¯ä»¥ç¼–å†™æ›´åŠ æœ‰æ•ˆç‡çš„ä»£ç </li>\n<li>ç¨‹åº = æ•°æ®ç»“æ„ + ç®—æ³•</li>\n</ul>\n<h2>1.1. æ•°æ®ç»“æ„çš„åˆ†ç±»</h2>\n<ul>\n<li>çº¿æ€§ç»“æ„ï¼šç‰¹ç‚¹æ˜¯æ•°æ®å…ƒç´ ä¹‹é—´å­˜åœ¨ä¸€å¯¹ä¸€çš„çº¿æ€§å…³ç³»ï¼šå¸¸è§çš„æœ‰ï¼šæ•°ç»„ã€é˜Ÿåˆ—ã€é“¾è¡¨å’Œæ ˆ.æœ‰ä¸¤ç§ä¸åŒçš„å­˜å‚¨ç»“æ„ï¼Œå³é¡ºåºå­˜å‚¨ç»“æ„(æ•°ç»„)å’Œé“¾å¼å­˜å‚¨ç»“æ„(é“¾è¡¨)\n<ul>\n<li>é¡ºåºå­˜å‚¨çš„çº¿æ€§è¡¨ç§°ä¸ºé¡ºåºè¡¨ï¼Œé¡ºåºè¡¨ä¸­çš„å­˜å‚¨å…ƒç´ æ˜¯è¿ç»­çš„</li>\n<li>é“¾å¼å­˜å‚¨çš„çº¿æ€§è¡¨ç§°ä¸ºé“¾è¡¨ï¼Œé“¾è¡¨ä¸­çš„å­˜å‚¨å…ƒç´ ä¸ä¸€å®šæ˜¯è¿ç»­çš„ï¼Œå…ƒç´ èŠ‚ç‚¹ä¸­å­˜æ”¾æ•°æ®å…ƒç´ ä»¥åŠç›¸é‚»å…ƒç´ çš„åœ°å€ä¿¡æ¯</li>\n</ul>\n</li>\n<li>éçº¿æ€§ç»“æ„åŒ…æ‹¬ï¼šäºŒç»´æ•°ç»„ï¼Œå¤šç»´æ•°ç»„ï¼Œå¹¿ä¹‰è¡¨ï¼Œæ ‘ç»“æ„ï¼Œå›¾ç»“æ„</li>\n</ul>\n<h2>1.2. ç®—æ³•çš„æ—¶é—´å¤æ‚åº¦</h2>\n<ul>\n<li>åº¦é‡ä¸€ä¸ªç¨‹åº(ç®—æ³•)æ‰§è¡Œæ—¶é—´çš„ä¸¤ç§æ–¹æ³•\n<ul>\n<li>äº‹åç»Ÿè®¡çš„æ–¹æ³•\n<ul>\n<li>è¦æƒ³å¯¹è®¾è®¡çš„ç®—æ³•çš„è¿è¡Œæ€§èƒ½è¿›è¡Œè¯„æµ‹ï¼Œéœ€è¦å®é™…è¿è¡Œè¯¥ç¨‹åºï¼›</li>\n<li>æ‰€å¾—æ—¶é—´çš„ç»Ÿè®¡é‡ä¾èµ–äºè®¡ç®—æœºçš„ç¡¬ä»¶ã€è½¯ä»¶ç­‰ç¯å¢ƒå› ç´ ,è¦åœ¨åŒä¸€å°è®¡ç®—æœºçš„ç›¸åŒçŠ¶æ€ä¸‹è¿è¡Œï¼Œæ‰èƒ½æ¯”è¾ƒç®—æ³•é€Ÿåº¦</li>\n</ul>\n</li>\n<li>äº‹å‰ä¼°ç®—çš„æ–¹æ³•ï¼šé€šè¿‡åˆ†ææŸä¸ªç®—æ³•çš„æ—¶é—´å¤æ‚åº¦æ¥åˆ¤æ–­å“ªä¸ªç®—æ³•æ›´ä¼˜.</li>\n</ul>\n</li>\n<li>æ—¶é—´é¢‘åº¦\n<ul>\n<li>ä¸€ä¸ªç®—æ³•èŠ±è´¹çš„æ—¶é—´ä¸ç®—æ³•ä¸­è¯­å¥çš„æ‰§è¡Œæ¬¡æ•°æˆæ­£æ¯”ä¾‹ï¼Œå“ªä¸ªç®—æ³•ä¸­è¯­å¥æ‰§è¡Œæ¬¡æ•°å¤šï¼Œå®ƒèŠ±è´¹æ—¶é—´å°±å¤šã€‚</li>\n<li>ä¸€ä¸ªç®—æ³•ä¸­çš„è¯­å¥æ‰§è¡Œæ¬¡æ•°ç§°ä¸ºè¯­å¥é¢‘åº¦æˆ–æ—¶é—´é¢‘åº¦ã€‚è®°ä¸ºT(n)ã€‚</li>\n</ul>\n</li>\n<li>æ—¶é—´å¤æ‚åº¦\n<ul>\n<li>ä¸€èˆ¬æƒ…å†µä¸‹ï¼Œç®—æ³•ä¸­çš„åŸºæœ¬æ“ä½œè¯­å¥çš„é‡å¤æ‰§è¡Œæ¬¡æ•°æ˜¯é—®é¢˜è§„æ¨¡nçš„æŸä¸ªå‡½æ•°ï¼Œç”¨T(n)è¡¨ç¤ºï¼Œ</li>\n<li>è‹¥æœ‰æŸä¸ªè¾…åŠ©å‡½æ•°f(n)ï¼Œä½¿å¾—å½“nè¶‹è¿‘äºæ— ç©·å¤§æ—¶ï¼Œ<code>T(n) / f(n)</code> çš„æé™å€¼ä¸ºä¸ç­‰äºé›¶çš„å¸¸æ•°ï¼Œåˆ™ç§°f(n)æ˜¯T(n)çš„åŒæ•°é‡çº§å‡½æ•°ã€‚</li>\n<li>è®°ä½œ <code>T(n)=ï¼¯( f(n) )ï¼Œç§°ï¼¯( f(n) )</code>&nbsp; ä¸ºç®—æ³•çš„æ¸è¿›æ—¶é—´å¤æ‚åº¦ï¼Œç®€ç§°æ—¶é—´å¤æ‚åº¦ã€‚</li>\n<li>T(n) ä¸åŒï¼Œä½†æ—¶é—´å¤æ‚åº¦å¯èƒ½ç›¸åŒã€‚ å¦‚ï¼šT(n)=nÂ²+7n+6 ä¸ T(n)=3nÂ²+2n+2 å®ƒä»¬çš„T(n)&nbsp;ä¸åŒï¼Œä½†æ—¶é—´å¤æ‚åº¦ç›¸åŒï¼Œéƒ½ä¸ºO(nÂ²)</li>\n<li>è®¡ç®—æ—¶é—´å¤æ‚åº¦çš„æ–¹æ³•ï¼š\n<ul>\n<li>å¸¸æ•°1ä»£æ›¿è¿è¡Œæ—¶é—´ä¸­çš„æ‰€æœ‰åŠ æ³•å¸¸æ•°&nbsp; <code>T(n)=nÂ²+7n+6  =&gt; T(n)=nÂ²+7n+1</code></li>\n<li>ä¿®æ”¹åçš„è¿è¡Œæ¬¡æ•°å‡½æ•°ä¸­ï¼Œåªä¿ç•™æœ€é«˜é˜¶é¡¹&nbsp; <code>T(n)=nÂ²+7n+1 =&gt; T(n) = nÂ²</code></li>\n<li>å»é™¤æœ€é«˜é˜¶é¡¹çš„ç³»æ•° <code>T(n) = 4nÂ² =&gt; T(n) = nÂ² =&gt; O(nÂ²)</code></li>\n</ul>\n</li>\n<li>å¸¸è§çš„æ—¶é—´å¤æ‚åº¦\n<ul>\n<li>å¸¸æ•°é˜¶O(1):æ— è®ºä»£ç æ‰§è¡Œäº†å¤šå°‘è¡Œï¼Œåªè¦æ˜¯æ²¡æœ‰å¾ªç¯ç­‰å¤æ‚ç»“æ„ï¼Œä»£ç çš„æ—¶é—´å¤æ‚åº¦å°±éƒ½æ˜¯O(1)</li>\n<li>å¯¹æ•°é˜¶O(log2n) <code>int i = 1 ; while(i&lt;n){ i = i*2 } </code></li>\n<li>çº¿æ€§é˜¶O(n) <code>for(int i=0;i&lt;n;i++){System.out.print(i)}</code></li>\n<li>çº¿æ€§å¯¹æ•°é˜¶O(nlog2n) <code>for(int m=0;m&lt;n;m++){ int 1 = 1 ; while(i&lt;n){ i = i*2 } }</code></li>\n<li>å¹³æ–¹é˜¶O(n^2) <code>for(int i=0;i&lt;n;i++){for(int j=0;j&lt;n;j++){System.out.print(j)}}</code></li>\n<li>ç«‹æ–¹é˜¶O(n^3)</li>\n<li>kæ¬¡æ–¹é˜¶O(n^k)</li>\n<li>æŒ‡æ•°é˜¶O(2^n)</li>\n<li>å¸¸è§çš„ç®—æ³•æ—¶é—´å¤æ‚åº¦ç”±å°åˆ°å¤§ä¾æ¬¡ä¸ºï¼š<code>ÎŸ(1)ï¼œÎŸ(log2n)ï¼œÎŸ(n)ï¼œÎŸ(nlog2n)ï¼œÎŸ(n2)ï¼œÎŸ(n3)ï¼œÎŸ(nk)ï¼œÎŸ(2n)</code>,å°½å¯èƒ½é¿å…ä½¿ç”¨æŒ‡æ•°é˜¶çš„ç®—æ³•</li>\n</ul>\n</li>\n<li>å¹³å‡æ—¶é—´å¤æ‚åº¦ï¼šæ‰€æœ‰å¯èƒ½çš„è¾“å…¥å®ä¾‹å‡ä»¥ç­‰æ¦‚ç‡å‡ºç°çš„æƒ…å†µä¸‹ï¼Œè¯¥ç®—æ³•çš„è¿è¡Œæ—¶é—´ã€‚</li>\n<li>æœ€åæ—¶é—´å¤æ‚åº¦ï¼šæœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ã€‚ä¸€èˆ¬è®¨è®ºçš„æ—¶é—´å¤æ‚åº¦å‡æ˜¯æœ€åæƒ…å†µä¸‹çš„æ—¶é—´å¤æ‚åº¦ã€‚ä¿è¯ç®—æ³•è¿è¡Œæ—¶é—´ä¸ä¼šæ¯”æœ€åæƒ…å†µæ›´é•¿</li>\n</ul>\n</li>\n</ul>\n<h2>1.3. ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦</h2>\n<ul>\n<li>ç®—æ³•çš„ç©ºé—´å¤æ‚åº¦(Space Complexity)å®šä¹‰ä¸ºè¯¥ç®—æ³•æ‰€è€—è´¹çš„å­˜å‚¨ç©ºé—´ï¼Œå®ƒä¹Ÿæ˜¯é—®é¢˜è§„æ¨¡nçš„å‡½æ•°ã€‚æ˜¯å¯¹ä¸€ä¸ªç®—æ³•åœ¨è¿è¡Œè¿‡ç¨‹ä¸­ä¸´æ—¶å ç”¨å­˜å‚¨ç©ºé—´å¤§å°çš„é‡åº¦</li>\n<li>æœ‰çš„ç®—æ³•éœ€è¦å ç”¨çš„ä¸´æ—¶å·¥ä½œå•å…ƒæ•°ä¸è§£å†³é—®é¢˜çš„è§„æ¨¡næœ‰å…³ï¼Œå®ƒéšç€nçš„å¢å¤§è€Œå¢å¤§ï¼Œå½“nè¾ƒå¤§æ—¶ï¼Œå°†å ç”¨è¾ƒå¤šçš„å­˜å‚¨å•å…ƒï¼Œä¾‹å¦‚å¿«é€Ÿæ’åºå’Œå½’å¹¶æ’åºç®—æ³•å°±å±äºè¿™ç§æƒ…å†µ</li>\n<li>åœ¨åšç®—æ³•åˆ†ææ—¶ï¼Œä¸»è¦è®¨è®ºçš„æ˜¯æ—¶é—´å¤æ‚åº¦ã€‚ä»ç”¨æˆ·ä½¿ç”¨ä½“éªŒä¸Šçœ‹ï¼Œæ›´çœ‹é‡çš„ç¨‹åºæ‰§è¡Œçš„é€Ÿåº¦ã€‚ä¸€äº›ç¼“å­˜äº§å“(redis, memcache)å’Œç®—æ³•(åŸºæ•°æ’åº)æœ¬è´¨å°±æ˜¯ç”¨ç©ºé—´æ¢æ—¶é—´.</li>\n</ul>\n<h2>1.4. ç®—æ³•æ¡†æ¶</h2>\n<h3>1.4.1. æ•°æ®ç»“æ„çš„å­˜å‚¨æ–¹å¼</h3>\n<ul>\n<li>æ•°æ®ç»“æ„çš„å­˜å‚¨æ–¹å¼åªæœ‰ä¸¤ç§ï¼šæ•°ç»„ï¼ˆé¡ºåºå­˜å‚¨:æŸ¥æ‰¾å—ï¼Œç´¢å¼•è®¿é—®ï¼Œå¢åˆ å¿«ï¼Œéœ€è¦æ‰©å®¹ï¼‰å’Œé“¾è¡¨ï¼ˆé“¾å¼å­˜å‚¨ï¼šå¢åˆ å¿«ï¼Œåªéœ€æ“ä½œå°¾ç»“ç‚¹ï¼ŒæŸ¥æ‰¾æ…¢ï¼Œéå†ï¼‰\n<ul>\n<li>ã€Œé˜Ÿåˆ—(å…ˆè¿›å…ˆå‡º)ã€ã€ã€Œæ ˆ(å…ˆè¿›å…ˆå‡º)ã€è¿™ä¸¤ç§æ•°æ®ç»“æ„æ—¢å¯ä»¥ä½¿ç”¨é“¾è¡¨ä¹Ÿå¯ä»¥ä½¿ç”¨æ•°ç»„å®ç°ã€‚ç”¨æ•°ç»„å®ç°ï¼Œå°±è¦å¤„ç†æ‰©å®¹ç¼©å®¹çš„é—®é¢˜ï¼›ç”¨é“¾è¡¨å®ç°ï¼Œæ²¡æœ‰è¿™ä¸ªé—®é¢˜ï¼Œä½†éœ€è¦æ›´å¤šçš„å†…å­˜ç©ºé—´å­˜å‚¨èŠ‚ç‚¹æŒ‡é’ˆã€‚</li>\n<li>ã€Œå›¾ã€çš„ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼Œé‚»æ¥è¡¨å°±æ˜¯é“¾è¡¨ï¼Œé‚»æ¥çŸ©é˜µå°±æ˜¯äºŒç»´æ•°ç»„ã€‚é‚»æ¥çŸ©é˜µåˆ¤æ–­è¿é€šæ€§è¿…é€Ÿï¼Œå¹¶å¯ä»¥è¿›è¡ŒçŸ©é˜µè¿ç®—è§£å†³ä¸€äº›é—®é¢˜ï¼Œä½†æ˜¯å¦‚æœå›¾æ¯”è¾ƒç¨€ç–çš„è¯å¾ˆè€—è´¹ç©ºé—´ã€‚é‚»æ¥è¡¨æ¯”è¾ƒèŠ‚çœç©ºé—´ï¼Œä½†æ˜¯å¾ˆå¤šæ“ä½œçš„æ•ˆç‡ä¸Šè‚¯å®šæ¯”ä¸è¿‡é‚»æ¥çŸ©é˜µã€‚</li>\n<li>ã€Œæ•£åˆ—è¡¨ã€å°±æ˜¯é€šè¿‡æ•£åˆ—å‡½æ•°æŠŠé”®æ˜ å°„åˆ°ä¸€ä¸ªå¤§æ•°ç»„é‡Œã€‚è€Œä¸”å¯¹äºè§£å†³æ•£åˆ—å†²çªçš„æ–¹æ³•ï¼Œæ‹‰é“¾æ³•éœ€è¦é“¾è¡¨ç‰¹æ€§ï¼Œæ“ä½œç®€å•ï¼Œä½†éœ€è¦é¢å¤–çš„ç©ºé—´å­˜å‚¨æŒ‡é’ˆï¼›çº¿æ€§æ¢æŸ¥æ³•å°±éœ€è¦æ•°ç»„ç‰¹æ€§ï¼Œä»¥ä¾¿è¿ç»­å¯»å€ï¼Œä¸éœ€è¦æŒ‡é’ˆçš„å­˜å‚¨ç©ºé—´ï¼Œä½†æ“ä½œç¨å¾®å¤æ‚äº›ã€‚</li>\n<li>ã€Œæ ‘ã€ï¼Œç”¨æ•°ç»„å®ç°å°±æ˜¯ã€Œå †ã€ï¼Œå› ä¸ºã€Œå †ã€æ˜¯ä¸€ä¸ªå®Œå…¨äºŒå‰æ ‘ï¼Œç”¨æ•°ç»„å­˜å‚¨ä¸éœ€è¦èŠ‚ç‚¹æŒ‡é’ˆï¼Œæ“ä½œä¹Ÿæ¯”è¾ƒç®€å•ï¼›ç”¨é“¾è¡¨å®ç°å°±æ˜¯å¾ˆå¸¸è§çš„é‚£ç§ã€Œæ ‘ã€ï¼Œå› ä¸ºä¸ä¸€å®šæ˜¯å®Œå…¨äºŒå‰æ ‘ï¼Œæ‰€ä»¥ä¸é€‚åˆç”¨æ•°ç»„å­˜å‚¨ã€‚ä¸ºæ­¤ï¼Œåœ¨è¿™ç§é“¾è¡¨ã€Œæ ‘ã€ç»“æ„ä¹‹ä¸Šï¼Œåˆè¡ç”Ÿå‡ºå„ç§å·§å¦™çš„è®¾è®¡ï¼Œæ¯”å¦‚äºŒå‰æœç´¢æ ‘ã€AVL æ ‘ã€çº¢é»‘æ ‘ã€åŒºé—´æ ‘ã€B æ ‘ç­‰ç­‰ï¼Œä»¥åº”å¯¹ä¸åŒçš„é—®é¢˜</li>\n</ul>\n</li>\n<li>æ•°ç»„ç”±äºæ˜¯ç´§å‡‘è¿ç»­å­˜å‚¨,å¯ä»¥éšæœºè®¿é—®ï¼Œé€šè¿‡ç´¢å¼•å¿«é€Ÿæ‰¾åˆ°å¯¹åº”å…ƒç´ ï¼Œè€Œä¸”ç›¸å¯¹èŠ‚çº¦å­˜å‚¨ç©ºé—´ã€‚ä½†æ­£å› ä¸ºè¿ç»­å­˜å‚¨ï¼Œå†…å­˜ç©ºé—´å¿…é¡»ä¸€æ¬¡æ€§åˆ†é…å¤Ÿï¼Œæ‰€ä»¥è¯´æ•°ç»„å¦‚æœè¦æ‰©å®¹ï¼Œéœ€è¦é‡æ–°åˆ†é…ä¸€å—æ›´å¤§çš„ç©ºé—´ï¼Œå†æŠŠæ•°æ®å…¨éƒ¨å¤åˆ¶è¿‡å»ï¼Œæ—¶é—´å¤æ‚åº¦ O(N)ï¼›è€Œä¸”ä½ å¦‚æœæƒ³åœ¨æ•°ç»„ä¸­é—´è¿›è¡Œæ’å…¥å’Œåˆ é™¤ï¼Œæ¯æ¬¡å¿…é¡»æ¬ç§»åé¢çš„æ‰€æœ‰æ•°æ®ä»¥ä¿æŒè¿ç»­ï¼Œæ—¶é—´å¤æ‚åº¦ O(N)ã€‚</li>\n<li>é“¾è¡¨å› ä¸ºå…ƒç´ ä¸è¿ç»­ï¼Œè€Œæ˜¯é æŒ‡é’ˆæŒ‡å‘ä¸‹ä¸€ä¸ªå…ƒç´ çš„ä½ç½®ï¼Œæ‰€ä»¥ä¸å­˜åœ¨æ•°ç»„çš„æ‰©å®¹é—®é¢˜ï¼›å¦‚æœçŸ¥é“æŸä¸€å…ƒç´ çš„å‰é©±å’Œåé©±ï¼Œæ“ä½œæŒ‡é’ˆå³å¯åˆ é™¤è¯¥å…ƒç´ æˆ–è€…æ’å…¥æ–°å…ƒç´ ï¼Œæ—¶é—´å¤æ‚åº¦ O(1)ã€‚ä½†æ˜¯æ­£å› ä¸ºå­˜å‚¨ç©ºé—´ä¸è¿ç»­ï¼Œä½ æ— æ³•æ ¹æ®ä¸€ä¸ªç´¢å¼•ç®—å‡ºå¯¹åº”å…ƒç´ çš„åœ°å€ï¼Œæ‰€ä»¥ä¸èƒ½éšæœºè®¿é—®ï¼›è€Œä¸”ç”±äºæ¯ä¸ªå…ƒç´ å¿…é¡»å­˜å‚¨æŒ‡å‘å‰åå…ƒç´ ä½ç½®çš„æŒ‡é’ˆï¼Œä¼šæ¶ˆè€—ç›¸å¯¹æ›´å¤šçš„å‚¨å­˜ç©ºé—´ã€‚</li>\n</ul>\n<h3>1.4.2. æ•°æ®ç»“æ„çš„åŸºæœ¬æ“ä½œæ¡†æ¶(éå†+è®¿é—®=&gt;æ ‘=&gt;äºŒå‰æ ‘=&gt;å‰ä¸­ååºéå†)</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ•°ç»„éå†æ¡†æ¶ï¼Œå…¸å‹çš„çº¿æ€§è¿­ä»£ç»“æ„\nvoid traverse(int[] arr) {\n    for (int i = 0; i &lt; arr.length; i++) {\n        // è¿­ä»£è®¿é—® arr[i]\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é“¾è¡¨éå†æ¡†æ¶ï¼Œå…¼å…·è¿­ä»£å’Œé€’å½’ç»“æ„\n/* åŸºæœ¬çš„å•é“¾è¡¨èŠ‚ç‚¹ */\nclass ListNode {\n    int val;\n    ListNode next;\n}\n\nvoid traverse(ListNode head) {\n    for (ListNode p = head; p != null; p = p.next) {\n        // è¿­ä»£è®¿é—® p.val\n    }\n}\n\nvoid traverse(ListNode head) {\n    // é€’å½’è®¿é—® head.val\n    traverse(head.next);\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>äºŒå‰æ ‘éå†æ¡†æ¶ï¼Œå…¸å‹çš„éçº¿æ€§é€’å½’éå†ç»“æ„\n/* åŸºæœ¬çš„äºŒå‰æ ‘èŠ‚ç‚¹ */\nclass TreeNode {\n    int val;\n    TreeNode left, right;\n}\n\nvoid traverse(TreeNode root) {\n    traverse(root.left);\n    traverse(root.right);\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>äºŒå‰æ ‘æ¡†æ¶å¯ä»¥æ‰©å±•ä¸º N å‰æ ‘çš„éå†æ¡†æ¶\n/* åŸºæœ¬çš„ N å‰æ ‘èŠ‚ç‚¹ */\nclass TreeNode {\n    int val;\n    TreeNode[] children;\n}\n\nvoid traverse(TreeNode root) {\n    for (TreeNode child : root.children)\n        traverse(child);\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¤§éƒ¨åˆ†ç®—æ³•æŠ€å·§ï¼Œæœ¬è´¨ä¸Šéƒ½æ˜¯æ ‘çš„éå†é—®é¢˜\nvoid traverse(TreeNode root) {\n    // å‰åºéå†\n    traverse(root.left)\n    // ä¸­åºéå†\n    traverse(root.right)\n    // ååºéå†\n}\n</code></pre></div><h1>2. ç¨€ç–æ•°ç»„sparsearray</h1>\n<ul>\n<li>ç¨€ç–æ•°ç»„ï¼šå½“ä¿å­˜ä¸€ä¸ªæ•°ç»„ä¸­å¤§éƒ¨åˆ†å…ƒç´ ä¸º0æˆ–è€…åŒä¸€ä¸ªå€¼çš„æ—¶ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå¦‚æœå†™å…¥ç£ç›˜åˆ™å‡å°‘I/Oï¼Œæå‡æ€§èƒ½</li>\n<li>é—®é¢˜:äº”å­æ£‹ç¨‹åºå­˜ç›˜é€€å‡ºå’Œç»­ä¸Šç›˜åŠŸèƒ½ï¼ŒäºŒç»´æ•°ç»„çš„æ£‹ç›˜ã€åœ°å›¾ç­‰</li>\n<li>æ€è·¯:\n<ul>\n<li>äºŒç»´æ•°ç»„ -&gt; ç¨€ç–æ•°ç»„\n<ul>\n<li>éå†äºŒç»´æ•°ç»„å¾—åˆ°æœ‰æ•ˆæ•°æ®çš„ä¸ªæ•°sum</li>\n<li>æ ¹æ®sum åˆ›å»ºç¨€ç–æ•°ç»„<code>sparseArr int[sum + 1][3]</code>(ç•™ä¸ªä¸€ç»´æ•°ç»„æ•°ç»„ä¸€å…±æœ‰å‡ è¡Œå‡ åˆ—ï¼Œæœ‰å¤šå°‘ä¸ªä¸åŒçš„å€¼)</li>\n<li>ç¬¬1ä¸ªä¸€ç»´æ•°ç»„è®°å½•æ•°ç»„çš„ä¸€ç»´æ•°ç»„ä¸ªæ•°ã€äºŒç»´æ•°ç»„çš„ä¸ªæ•°ã€æœ‰æ•ˆæ•°æ®ä¸ªæ•°sum</li>\n<li>ä»ç¬¬2ä¸ªä¸€ç»´æ•°ç»„å¼€å§‹è®°å½•æ•°ç»„çš„æœ‰æ•ˆæ•°æ®<code>ï¼ˆint[?][1]å’Œint[?][2]è®°å½•æœ‰æ•ˆæ•°æ®çš„ä½ç½®int[?][3]è®°å½•æœ‰æ•ˆæ•°æ®çš„å€¼ï¼‰</code>ç›´åˆ°æ‰€æœ‰æ•°ç»„è®°å½•å®Œ</li>\n</ul>\n</li>\n<li>ç¨€ç–æ•°ç»„ è½¬ äºŒç»´æ•°ç»„æ€è·¯\n<ul>\n<li>å…ˆæ ¹æ®è¯»å–ç¨€ç–æ•°ç»„çš„ç¬¬ä¸€ä¸ªä¸€ç»´æ•°ç»„æ•°æ®å»ºç«‹äºŒç»´æ•°ç»„</li>\n<li>ä»ç¬¬2ä¸ªä¸€ç»´æ•°ç»„å¼€å§‹å°†ç»™äºŒç»´æ•°ç»„ä¸€ä¸€èµ‹å€¼</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/fe862b3b8a9644e8f5035.png\" alt=\"ç¨€ç–æ•°ç»„2.png\" tabindex=\"0\"><figcaption>ç¨€ç–æ•°ç»„2.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    public class SparseArray {\n        public static void main(String[] args) {\n            int[][] testarray = new int[5][6];\n            testarray[2][1] = 3;\n            testarray[0][3] = 10;\n            testarray[4][5] = 4;\n            System.out.println(\"åŸæ¥æ•°ç»„~~\");\n            printArray(testarray);\n            System.out.println(\"ç¨€ç–æ•°ç»„~~\");\n            printArray(getSpaseArray(testarray));\n            System.out.println(\"åŸæ¥æ•°ç»„~~\");\n            printArray(getOldArray(getSpaseArray(testarray)));\n        }\n        \n        public static int[][] getSpaseArray(int[][] oldArray){\n            //1.æ±‚å‡ºæœ‰æ•ˆæ•°æ®çš„ä¸ªæ•°\n            int sum = 0;\n            for(int i=0;i&lt;oldArray.length;i++){\n                for(int j=0;j&lt;oldArray[i].length;j++){\n                    if(oldArray[i][j]!=0){\n                        sum++;\n                    }\n                }\n            }\n            //2.åˆ›å»ºç¨€ç–æ•°ç»„\n            int[][] result= new int[sum+1][3];\n            result[0][0] = oldArray.length;//æ¯ä¸ªèµ‹å€¼\n            result[0][1] = oldArray[0].length;\n            result[0][2] = sum;\n            int index = 0;//ç”¨äºè®°å½•æ˜¯ç¬¬å‡ ä¸ªé0æ•°æ®,ç¨€ç–æ•°ç»„çš„\"ç¬¬å‡ è¡Œ\"\n            for(int i=0;i&lt;oldArray.length;i++){\n                for(int j=0;j&lt;oldArray[i].length;j++){\n                    if(oldArray[i][j]!=0){\n                        index++;\n                        result[index][0] = i;\n                        result[index][1] = j;\n                        result[index][2] = oldArray[i][j];\n                    }\n                }\n            }\n            return result;\n        }\n        \n        public static int[][] getOldArray(int[][] spaseArray){\n            int[][] result = new int[spaseArray[0][0]][spaseArray[0][1]];\n            for(int i=1;i&lt;spaseArray.length;i++){//å°†åé¢å‡ è¡Œè¯»å–å®Œå°±è¡Œäº†\n                result[spaseArray[i][0]][spaseArray[i][1]] = spaseArray[i][2];\n            }\n            return result;\n        }\n        \n        public static void printArray(int[][] printarray){\n            for(int i=0;i&lt;printarray.length;i++){\n                for(int j=0;j&lt;printarray[i].length;j++){\n                    System.out.printf(\"%d\\t\",printarray[i][j]);\n                }\n                System.out.println();\n            }\n        }\n    }\n</code></pre></div><h1>3. é˜Ÿåˆ—</h1>\n<ul>\n<li>é˜Ÿåˆ—æ˜¯ä¸€ä¸ªæœ‰åºåˆ—è¡¨ï¼Œå¯ä»¥ç”¨æ•°ç»„æˆ–æ˜¯é“¾è¡¨æ¥å®ç°ã€‚éµå¾ªå…ˆå…¥å…ˆå‡ºçš„åŸåˆ™ã€‚å³ï¼šå…ˆå­˜å…¥é˜Ÿåˆ—çš„æ•°æ®ï¼Œè¦å…ˆå–å‡ºã€‚åå­˜å…¥çš„è¦åå–å‡º</li>\n<li>ä½¿ç”¨æ¡ä»¶/åº”ç”¨å®ä¾‹:é“¶è¡Œæ’é˜Ÿ</li>\n<li>å•å‘é˜Ÿåˆ—(æ•°ç»„ç»“æ„)\n<ul>\n<li>æŒ‡é’ˆfrontæŒ‡å‘ç¬¬ä¸€ä¸ªå…ƒç´ å‰ä¸€ä¸ªä½ç½®é»˜è®¤ä¸º-1</li>\n<li>æŒ‡é’ˆrearæŒ‡å‘æœ€åä¸€ä¸ªå…ƒç´ é»˜è®¤ä¸º-1</li>\n<li>é˜Ÿåˆ—çš„æœ€å¤§å®¹é‡ä¸ºmaxSize</li>\n<li>é˜Ÿåˆ—æ»¡çš„æ¡ä»¶ä¸ºrear = maxSize - 1</li>\n<li>é˜Ÿåˆ—nullçš„æ¡ä»¶ä¸ºfront == rear</li>\n<li>ç»™é˜Ÿåˆ—æ·»åŠ å…ƒç´ æ—¶,å…ˆåˆ¤æ–­æ»¡,å…ˆrear++ç„¶åarr[rear]èµ‹å€¼</li>\n<li>å‡ºé˜Ÿåˆ—æ—¶ï¼Œå…ˆåˆ¤æ–­nullï¼Œå…ˆfront++å¹¶è¿”å›arr[front]</li>\n<li>é˜Ÿåˆ—å¤´æ•°æ®ä¸ºarr[front+1];</li>\n<li>å­˜åœ¨çš„é—®é¢˜:æ•°ç»„ä¸èƒ½å¤ç”¨,ä½¿ç”¨ç®—æ³•æ”¹æˆç¯å½¢é˜Ÿåˆ—å–æ¨¡è§£å†³</li>\n</ul>\n</li>\n<li>å¾ªç¯é˜Ÿåˆ—(æ•°ç»„ç»“æ„)\n<ul>\n<li>æŒ‡é’ˆfrontæŒ‡å‘é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ ,é»˜è®¤ä¸º0</li>\n<li>æŒ‡é’ˆrearæŒ‡å‘é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ çš„åä¸€ä¸ªä½ç½®,é»˜è®¤ä¸º0</li>\n<li>é˜Ÿåˆ—çš„æœ€å¤§æ•°é‡ä¸ºmaxSize</li>\n<li>é˜Ÿåˆ—æ»¡çš„æ¡ä»¶<code>(rear+1)%maxSize==front</code></li>\n<li>é˜Ÿåˆ—ä¸ºnullæ¡ä»¶rear==front</li>\n<li>æœ‰æ•ˆæ•°å­—çš„ä¸ªæ•°<code>size = (rear+maxSize-front)%maxSize</code>,æ¨å¯¼è¿‡ç¨‹\n<ul>\n<li>å½“<code>rear&gt;=front,size = rear - front = rear - front + 0 = (rear - front) % maxSize + maxSize % maxSize = (rear - front + maxSize ) % maxSize  (æ³¨ï¼šrear - front &lt; maxSize)</code></li>\n<li>å½“<code>rear&lt;front,size = (rear-0) + (maxSize - front) = rear - front + maxSize = (rear - front + maxSize ) % maxSize (æ³¨ï¼šrear - front &lt; maxSize)</code></li>\n</ul>\n</li>\n<li>ä¸ºäº†åŒºåˆ†å¾ªç¯é˜Ÿåˆ—ä¸­é˜Ÿåˆ—ä¸ºæ»¡æ—¶å’Œé˜Ÿåˆ—ä¸ºç©ºæ—¶çš„æƒ…å†µï¼Œå¯ä»¥æœ‰è‡³å°‘2ç§æ–¹æ³•\n<ul>\n<li>æµªè´¹ä¸€ä¸ªç©ºé—´ï¼Œæ¥åŒºåˆ†é˜Ÿåˆ—ä¸ºæ»¡æ—¶å’Œé˜Ÿåˆ—ä¸ºç©ºæ—¶çš„æƒ…å†µï¼Œä¹Ÿå°±æ˜¯å½“ <code>( rear + 1 ) % maxSize == front</code>çš„æ—¶å€™ï¼Œè¡¨ç¤ºé˜Ÿåˆ—å·²ç»æ»¡äº†ï¼Œå½“front == tailçš„æ—¶å€™ï¼Œè¡¨ç¤ºé˜Ÿåˆ—ä¸ºç©ºã€‚rearæ°¸è¿œæŒ‡å‘\"ç©ºå…ƒç´ \".ï¼ˆæœ¬ä¾‹å­ï¼‰</li>\n<li>é™„åŠ ä¸€ä¸ªæ ‡å¿—ä½tagï¼Œå½“headèµ¶ä¸Štailï¼Œé˜Ÿåˆ—ç©ºï¼Œåˆ™ä»¤tag=0,å½“tailèµ¶ä¸Šheadï¼Œé˜Ÿåˆ—æ»¡ï¼Œåˆ™ä»¤tag=1</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1e004863e3a952a2c7ac8.png\" alt=\"é˜Ÿåˆ—.png\" tabindex=\"0\"><figcaption>é˜Ÿåˆ—.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    //ä½¿ç”¨æ•°ç»„æ¨¡æ‹Ÿå•å‘é˜Ÿåˆ— -ç¼–å†™ä¸€ä¸ªArrayQueueç±»\n    class ArrayQueue {\n        private int maxSize; // è¡¨ç¤ºæ•°ç»„çš„æœ€å¤§å®¹é‡\n        private int front = -1; // æŒ‡å‘é˜Ÿåˆ—å¤´éƒ¨ï¼ŒæŒ‡å‘é˜Ÿåˆ—å¤´çš„å‰ä¸€ä¸ªä½ç½®\n        private int rear = -1; // æŒ‡å‘é˜Ÿåˆ—å°¾ï¼ŒæŒ‡å‘é˜Ÿåˆ—å°¾çš„æ•°æ®\n        private int[] arr; // è¯¥æ•°ç»„ç”¨äºå­˜æ”¾æ•°æ®, æ¨¡æ‹Ÿé˜Ÿåˆ—\n        public ArrayQueue(int arrMaxSize) {\n            maxSize = arrMaxSize;\n            arr = new int[maxSize];\n        }\n        public boolean isFull() {return rear == maxSize - 1;}// åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦æ»¡\n        public boolean isEmpty() {return rear == front;}// åˆ¤æ–­é˜Ÿåˆ—æ˜¯å¦ä¸ºç©º\n        public void addQueue(int n) {\n            if (isFull()) System.out.println(\"é˜Ÿåˆ—æ»¡ï¼Œä¸èƒ½åŠ å…¥æ•°æ®~~\");return;\n            rear++; // è®©rear åç§»\n            arr[rear] = n;\n        }\n        public int getQueue() {\n            if (isEmpty()) System.out.println(\"é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~\");return;\n            front++; // frontåç§»\n            return arr[front];\n        }\n        public void showQueue() {\n            if (isEmpty()) System.out.println(\"é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~\");return;\n            for (int i = 0; i &lt; arr.length; i++) {\n                System.out.printf(\"arr[%d]=%d\\n\", i, arr[i]);\n            }\n        }\n        public int headQueue() {// æ˜¾ç¤ºé˜Ÿåˆ—çš„å¤´æ•°æ®ï¼Œ æ³¨æ„ä¸æ˜¯å–å‡ºæ•°æ®\n            if (isEmpty()) throw new RuntimeException(\"é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~\");\n            return arr[front + 1];\n        }\n    } \n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    class CircleArray {\n        private int maxSize;// è¡¨ç¤ºæ•°ç»„çš„æœ€å¤§å®¹é‡\n        private int front = 0;//æŒ‡å‘é˜Ÿåˆ—çš„ç¬¬ä¸€ä¸ªå…ƒç´ \n        private int rear = 0;//æŒ‡å‘é˜Ÿåˆ—çš„æœ€åä¸€ä¸ªå…ƒç´ çš„åä¸€ä¸ªä½ç½®. å› ä¸ºç©ºå‡ºä¸€ä¸ªç©ºé—´åšä¸ºçº¦å®š.\n        private int[] arr; // è¯¥æ•°æ®ç”¨äºå­˜æ”¾æ•°æ®, æ¨¡æ‹Ÿé˜Ÿåˆ—\n        \n        public CircleArray(int arrMaxSize) {\n            maxSize = arrMaxSize;\n            arr = new int[maxSize];\n        }\n        public boolean isFull() {return (rear  + 1) % maxSize == front;}\n        public boolean isEmpty() {return rear == front;}\n        public void addQueue(int n) {\n            if (isFull()) System.out.println(\"é˜Ÿåˆ—æ»¡ï¼Œä¸èƒ½åŠ å…¥æ•°æ®~\");return;\n            arr[rear] = n;\n            rear = (rear + 1) % maxSize; //å°† rear åç§», è¿™é‡Œå¿…é¡»è€ƒè™‘å–æ¨¡\n        }\n        public int getQueue() {// è·å–é˜Ÿåˆ—çš„æ•°æ®, å‡ºé˜Ÿåˆ—\n            if (isEmpty()) throw new RuntimeException(\"é˜Ÿåˆ—ç©ºï¼Œä¸èƒ½å–æ•°æ®);\n            int value = arr[front];\n            front = (front + 1) % maxSize;\n            return value;\n        }\n        public void showQueue() {\n            if (isEmpty()) System.out.println(\"é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~\");return;\n            for (int i = front; i &lt; front + size() ; i++) {\n                System.out.printf(\"arr[%d]=%d\\n\", i % maxSize, arr[i % maxSize]);\n            }\n        }\n        public int size() {\n            return (rear + maxSize - front) % maxSize;   \n        }\n        public int headQueue() {// æ˜¾ç¤ºé˜Ÿåˆ—çš„å¤´æ•°æ®ï¼Œ æ³¨æ„ä¸æ˜¯å–å‡ºæ•°æ®\n            if (isEmpty()) throw new RuntimeException(\"é˜Ÿåˆ—ç©ºçš„ï¼Œæ²¡æœ‰æ•°æ®~~\");\n            return arr[front];\n        }\n    }  \n</code></pre></div><h1>4. é“¾è¡¨</h1>\n<ul>\n<li>é“¾è¡¨æ˜¯æœ‰åºçš„åˆ—è¡¨ï¼Œæ˜¯ä»¥èŠ‚ç‚¹çš„æ–¹å¼æ¥å­˜å‚¨,æ˜¯é“¾å¼å­˜å‚¨ï¼Œæ¯ä¸ªèŠ‚ç‚¹åŒ…å«dataåŸŸï¼Œnext åŸŸï¼šæŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹.</li>\n<li>é“¾è¡¨çš„å„ä¸ªèŠ‚ç‚¹ä¸ä¸€å®šæ˜¯è¿ç»­å­˜å‚¨.é“¾è¡¨åˆ†å¸¦å¤´èŠ‚ç‚¹çš„é“¾è¡¨å’Œæ²¡æœ‰å¤´èŠ‚ç‚¹çš„é“¾è¡¨</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/954fffe0ef1d2c2cbd746.png\" alt=\"é“¾è¡¨.png\" tabindex=\"0\"><figcaption>é“¾è¡¨.png</figcaption></figure>\n<h2>4.1. å•é“¾è¡¨</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    class SingleLinkedList {\n        private HeroNode head = new HeroNode(0, \"\", \"\");//å…ˆåˆå§‹åŒ–ä¸€ä¸ªå¤´èŠ‚ç‚¹, å¤´èŠ‚ç‚¹ä¸è¦åŠ¨, ä¸å­˜æ”¾å…·ä½“çš„æ•°æ®\n        public HeroNode getHead() {return head;}\n        //ä¸è€ƒè™‘ç¼–å·é¡ºåºæ—¶æ·»åŠ èŠ‚ç‚¹åˆ°å•å‘é“¾è¡¨æ—¶ï¼Œæ‰¾åˆ°å½“å‰é“¾è¡¨çš„æœ€åèŠ‚ç‚¹ï¼Œå°†è¿™ä¸ªèŠ‚ç‚¹çš„nextæŒ‡å‘æ–°èŠ‚ç‚¹\n        public void add(HeroNode heroNode) {\n            HeroNode temp = head;\n            while(true) {\n                if(temp.next == null) break;\n                temp = temp.next;\n            }\n            temp.next = heroNode;\n        }\n        //æ ¹æ®æ¡ä»¶å°†å…ƒç´ æ’å…¥åˆ°æŒ‡å®šä½ç½®(å¦‚æœæœ‰è¿™å…ƒç´ ï¼Œåˆ™æ·»åŠ å¤±è´¥ï¼Œå¹¶ç»™å‡ºæç¤º)\n        public void addByOrder(HeroNode heroNode) {\n            HeroNode temp = head;\n            boolean flag = false;\n            while(true) {\n                if(temp.next == null) break;\n                if(temp.next.no &gt; heroNode.no) break;\n                if (temp.next.no == heroNode.no) {flag = true;break;}\n                temp = temp.next;\n            }\n            if(flag) {\n                System.out.printf(\"å‡†å¤‡æ’å…¥çš„è‹±é›„çš„ç¼–å· %d å·²ç»å­˜åœ¨äº†, ä¸èƒ½åŠ å…¥\\n\", heroNode.no);\n            } else {\n                heroNode.next = temp.next;\n                temp.next = heroNode;\n            }\n        }\n        //ä¿®æ”¹èŠ‚ç‚¹çš„ä¿¡æ¯, æ ¹æ®noç¼–å·æ¥ä¿®æ”¹ï¼Œå³noç¼–å·ä¸èƒ½æ”¹.\n        public void update(HeroNode newHeroNode) {\n            HeroNode temp = head;\n            boolean flag = false;\n            while(true) {\n                if (temp == null) break;\n                if(temp.no == newHeroNode.no) {flag = true;break;}\n                temp = temp.next;\n            }\n            if(flag) {\n                temp.name = newHeroNode.name;\n                temp.nickname = newHeroNode.nickname;\n            } else {\n                System.out.printf(\"æ²¡æœ‰æ‰¾åˆ° ç¼–å· %d çš„èŠ‚ç‚¹ï¼Œä¸èƒ½ä¿®æ”¹\\n\", newHeroNode.no);\n            }\n        }\n        //åˆ é™¤èŠ‚ç‚¹\n        public void del(int no) {\n            HeroNode temp = head;\n            boolean flag = false; \n            while(true) {\n                if(temp.next == null) break; \n                if(temp.next.no == no) {flag = true;break;}\n                temp = temp.next;\n            }\n            if(flag) {\n                temp.next = temp.next.next;\n            }else {\n                System.out.printf(\"è¦åˆ é™¤çš„ %d èŠ‚ç‚¹ä¸å­˜åœ¨\\n\", no);\n            }\n        }\n        //æ˜¾ç¤ºé“¾è¡¨[éå†]\n        public void list() {\n            if(head.next == null) return;\n            HeroNode temp = head.next;\n            while(true) {\n                if(temp == null) break;\n                temp = temp.next;\n            }\n        }\n    }\n    //å®šä¹‰HeroNodeï¼Œæ¯ä¸ªHeroNode å¯¹è±¡å°±æ˜¯ä¸€ä¸ªèŠ‚ç‚¹\n    class HeroNode {\n        public int no;\n        public String name;\n        public String nickname;\n        public HeroNode next; //æŒ‡å‘ä¸‹ä¸€ä¸ªèŠ‚ç‚¹\n        public HeroNode(int no, String name, String nickname) {\n            this.no = no;\n            this.name = name;\n            this.nickname = nickname;\n        }\n        //toString\n    }\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /**\n\t* 1.è·å–åˆ°å•é“¾è¡¨çš„èŠ‚ç‚¹çš„ä¸ªæ•°(å¦‚æœæ˜¯å¸¦å¤´ç»“ç‚¹çš„é“¾è¡¨ï¼Œéœ€æ±‚ä¸ç»Ÿè®¡å¤´èŠ‚ç‚¹)\n    * @param head é“¾è¡¨çš„å¤´èŠ‚ç‚¹\n    * @return è¿”å›çš„å°±æ˜¯æœ‰æ•ˆèŠ‚ç‚¹çš„ä¸ªæ•°\n    */\n    public static int getLength(HeroNode head) {\n        if(head.next == null) return 0;\n        int length = 0;//å®šä¹‰ä¸€ä¸ªè¾…åŠ©çš„å˜é‡, è¿™é‡Œæˆ‘ä»¬æ²¡æœ‰ç»Ÿè®¡å¤´èŠ‚ç‚¹\n        HeroNode cur = head.next;\n        while(cur != null) {\n            length++;\n            cur = cur.next;\n        }\n        return length;\n    }\n\t/**\n\t * 2.æŸ¥æ‰¾å•é“¾è¡¨ä¸­çš„å€’æ•°ç¬¬kä¸ªç»“ç‚¹ ã€æ–°æµªé¢è¯•ã€‘\n\t *  å…ˆæŠŠé“¾è¡¨ä»å¤´åˆ°å°¾éå†ï¼Œå¾—åˆ°é“¾è¡¨çš„æ€»çš„é•¿åº¦size ä»é“¾è¡¨çš„ç¬¬ä¸€ä¸ªå¼€å§‹éå† (size-index)ä¸ªï¼Œå°±å¯ä»¥å¾—åˆ°\n\t * @param head headèŠ‚ç‚¹\n\t * @param index è¡¨ç¤ºæ˜¯å€’æ•°ç¬¬indexä¸ªèŠ‚ç‚¹\n\t * @return\n\t */\n\tpublic static HeroNode findLastIndexNode(HeroNode head, int index) {\n\t\tif(head.next == null) return null;\n\t\tint size = getLength(head);\n\t\tif(index &lt;=0 || index &gt; size) {\n\t\t\treturn null; \n\t\t}\n\t\tHeroNode cur = head.next;\n\t\tfor(int i =0; i&lt; size - index; i++) {\n\t\t\tcur = cur.next;\n\t\t}\n\t\treturn cur;\n\t}\n\t/**\n\t * å°†æ—§é“¾è¡¨çš„æ•°æ®å–å‡ºå¹¶å°†å…¶æ”¾åˆ°æ–°é“¾è¡¨çš„æœ€å‰ç«¯\n\t * å•é“¾è¡¨åè½¬ ã€è…¾è®¯é¢è¯•ã€‘\n\t * @param head\n\t */\n\tpublic static void reversetList(HeroNode head) {\n\t\tif(head.next == null || head.next.next == null) return ;\n\t\tHeroNode cur = head.next;\n\t\tHeroNode next = null;// æŒ‡å‘å½“å‰èŠ‚ç‚¹[cur]çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæ–¹ä¾¿å¾ªç¯çš„æ—¶å€™æŒ‡å‘å½“å‰èŠ‚ç‚¹\n\t\tHeroNode reverseHead = new HeroNode(0, \"\", \"\");\n\t\t//éå†åŸæ¥çš„é“¾è¡¨ï¼Œæ¯éå†ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°±å°†å…¶å–å‡ºï¼Œå¹¶æ”¾åœ¨æ–°çš„é“¾è¡¨reverseHead çš„æœ€å‰ç«¯\n\t\twhile(cur != null) { \n\t\t\tnext = cur.next;//å…ˆæš‚æ—¶ä¿å­˜å½“å‰èŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå› ä¸ºåé¢éœ€è¦ä½¿ç”¨\n\t\t\t//</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/fe862b3b8a9644e8f5035.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç®—æ³•"
      ]
    },
    {
      "title": "è®¡ç®—æœºå¸¸è¯†",
      "url": "https://javaguide.cn/backend/cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%B8%B8%E8%AF%86.html",
      "id": "https://javaguide.cn/backend/cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%B8%B8%E8%AF%86.html",
      "summary": "è®¡ç®—æœºçš„å¸¸è¯† 1. å†…å­˜å›¾ 2. å­—ç¬¦ç¼–ç è¡¨åŠå­—ç¬¦ä¸ç¼–ç è§£ç  3. ASCIIç  4. å¾ªç¯å†—ä½™æ ¡éªŒCRC(Cyclic Redundancy Check) 5. å“ˆå¸Œç®—æ³• 6. ä½è¿ç®— 7. æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨ 1. å†…å­˜å›¾ å†…å­˜.pngå†…å­˜.png 2. å­—ç¬¦ç¼–ç è¡¨åŠå­—ç¬¦ä¸ç¼–ç è§£ç  ASCIIè¡¨ã€‚å®šé•¿ï¼Œå•å­—èŠ‚7ä½ç¼–ç ã€‚å„ç§è‹±æ–‡å­—ç¬¦å¯¹åº”çš„ç¼–ç ã€‚ ...",
      "content_html": "<p>è®¡ç®—æœºçš„å¸¸è¯†</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E5%86%85%E5%AD%98%E5%9B%BE\">1. å†…å­˜å›¾</a></li>\n<li><a href=\"#2-%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E8%A1%A8%E5%8F%8A%E5%AD%97%E7%AC%A6%E4%B8%8E%E7%BC%96%E7%A0%81%E8%A7%A3%E7%A0%81\">2. å­—ç¬¦ç¼–ç è¡¨åŠå­—ç¬¦ä¸ç¼–ç è§£ç </a></li>\n<li><a href=\"#3-ascii%E7%A0%81\">3. ASCIIç </a></li>\n<li><a href=\"#4-%E5%BE%AA%E7%8E%AF%E5%86%97%E4%BD%99%E6%A0%A1%E9%AA%8Ccrccyclic-redundancy-check\">4. å¾ªç¯å†—ä½™æ ¡éªŒCRC(Cyclic Redundancy Check)</a></li>\n<li><a href=\"#5-%E5%93%88%E5%B8%8C%E7%AE%97%E6%B3%95\">5. å“ˆå¸Œç®—æ³•</a></li>\n<li><a href=\"#6-%E4%BD%8D%E8%BF%90%E7%AE%97\">6. ä½è¿ç®—</a></li>\n<li><a href=\"#7-%E6%B5%AE%E7%82%B9%E6%95%B0%E5%9C%A8%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E5%AD%98%E5%82%A8\">7. æµ®ç‚¹æ•°åœ¨è®¡ç®—æœºä¸­çš„å­˜å‚¨</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. å†…å­˜å›¾</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8dd3fad59c299b802ad94.png\" alt=\"å†…å­˜.png\" tabindex=\"0\"><figcaption>å†…å­˜.png</figcaption></figure>\n<h1>2. å­—ç¬¦ç¼–ç è¡¨åŠå­—ç¬¦ä¸ç¼–ç è§£ç </h1>\n<pre><code>ç”Ÿæ´»ä¸­å­—ç¬¦å’Œè®¡ç®—æœºäºŒè¿›åˆ¶çš„å¯¹åº”å…³ç³»è¡¨\n</code></pre>\n<ul>\n<li>ASCIIè¡¨ã€‚å®šé•¿ï¼Œå•å­—èŠ‚7ä½ç¼–ç ã€‚å„ç§è‹±æ–‡å­—ç¬¦å¯¹åº”çš„ç¼–ç ã€‚</li>\n<li>iso-8859-1/latin1:æ‹‰ä¸ç è¡¨ï¼Œå®šé•¿å•å­—èŠ‚8ä½ç¼–ç ï¼Œ1-xxxxxxx  è´Ÿæ•°ã€‚</li>\n<li>GB2312:ç®€ä½“ä¸­æ–‡ç è¡¨ï¼ˆæ±‰å­—ç¼–ç å­—ç¬¦åŸºæœ¬é›†ï¼‰ã€‚å®šé•¿ï¼ŒåŒå­—èŠ‚ç¼–ç ã€‚</li>\n<li>GBK:ï¼ˆæ±‰å­—å†…ç æ‰©å±•è§„èŒƒï¼‰å‘ä¸‹å…¼å®¹GB2312ã€å®šé•¿ã€‚åŒå­—èŠ‚ç¼–ç ï¼Œ</li>\n<li>unicodeï¼šå…¼å®¹å…¨çƒçš„å­—ç¬¦é›†ã€‚å›½é™…æ ‡å‡†ç è¡¨:åŒå­—èŠ‚ç¼–ç ã€‚</li>\n<li>UTF-8(unicodeå­—ç¬¦é›†)ï¼Œéå®šé•¿ï¼Œä»¥1-4å­—èŠ‚ä¸ºå•ä½å¯¹Unicodeè¿›è¡Œç¼–ç \n<ul>\n<li>ç¼–ç¨‹æ¨èä½¿ç”¨UTF-8ã€windowsé»˜è®¤GBKç¼–ç <br>\nJavaä¸­çš„charç±»å‹ç”¨çš„å°±æ˜¯è¿™ä¸ªç è¡¨ã€‚char c = 'a';å ä¸¤ä¸ªå­—èŠ‚ã€‚<br>\nJavaä¸­çš„å­—ç¬¦ä¸²æ˜¯æŒ‰ç…§ç³»ç»Ÿé»˜è®¤ç è¡¨æ¥è§£æçš„ã€‚<br>\nç®€ä½“ä¸­æ–‡ç‰ˆ å­—ç¬¦ä¸²é»˜è®¤çš„ç è¡¨æ˜¯GBKã€‚<br>\nUTF-8:åŸºäºunicodeï¼Œä¸€ä¸ªå­—èŠ‚å°±å¯ä»¥å­˜å‚¨æ•°æ®ï¼Œä¸è¦ç”¨ä¸¤ä¸ªå­—èŠ‚å­˜å‚¨ï¼Œ<br>\nè€Œä¸”è¿™ä¸ªç è¡¨æ›´åŠ çš„æ ‡å‡†åŒ–ï¼Œåœ¨æ¯ä¸€ä¸ªå­—èŠ‚å¤´åŠ å…¥äº†ç¼–ç ä¿¡æ¯(åæœŸåˆ°apiä¸­æŸ¥æ‰¾)ã€‚<br>\næ–‡å­—</li>\n</ul>\n</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/8dd3fad59c299b802ad94.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "è®¡ç®—æœºç»„æˆåŸç†",
      "url": "https://javaguide.cn/backend/cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.html",
      "id": "https://javaguide.cn/backend/cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BB%84%E6%88%90%E5%8E%9F%E7%90%86.html",
      "summary": "è®¡ç®—æœºç»„æˆåŸç† 1. è®¡ç®—æœºç³»ç»Ÿæ¦‚è®º 1.1. è®¡ç®—æœºç³»ç»Ÿç»„æˆ->è®¡ç®—æœºæ€§èƒ½çš„å¥½åå–å†³äºè½¯ç¡¬ä»¶åŠŸèƒ½çš„æ€»å’Œ 1.2. ç°ä»£è®¡ç®—æœºçš„è§£é¢˜è¿‡ç¨‹ 1.3. è®¡ç®—æœºç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„ 1.4. è®¡ç®—æœºåŸºæœ¬ç»„æˆ 2. è®¡ç®—æœºå‘å±•ç®€å² 3. ç³»ç»Ÿæ€»çº¿ 3.1. æ€»çº¿çš„åŸºæœ¬æ¦‚å¿µ 3.2. æ€»çº¿åˆ†ç±» 3.3. æ€»çº¿æ€§èƒ½æŒ‡æ ‡ 3.4. æ€»çº¿æ ‡å‡† 3.5. æ€»çº¿æ§åˆ¶ 4. å­˜å‚¨...",
      "content_html": "<p>è®¡ç®—æœºç»„æˆåŸç†</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E6%A6%82%E8%AE%BA\">1. è®¡ç®—æœºç³»ç»Ÿæ¦‚è®º</a>\n<ul>\n<li><a href=\"#11-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%BB%84%E6%88%90-%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9A%84%E5%A5%BD%E5%9D%8F%E5%8F%96%E5%86%B3%E4%BA%8E%E8%BD%AF%E7%A1%AC%E4%BB%B6%E5%8A%9F%E8%83%BD%E7%9A%84%E6%80%BB%E5%92%8C\">1.1. è®¡ç®—æœºç³»ç»Ÿç»„æˆ-&gt;è®¡ç®—æœºæ€§èƒ½çš„å¥½åå–å†³äºè½¯ç¡¬ä»¶åŠŸèƒ½çš„æ€»å’Œ</a></li>\n<li><a href=\"#12-%E7%8E%B0%E4%BB%A3%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E8%A7%A3%E9%A2%98%E8%BF%87%E7%A8%8B\">1.2. ç°ä»£è®¡ç®—æœºçš„è§£é¢˜è¿‡ç¨‹</a></li>\n<li><a href=\"#13-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84\">1.3. è®¡ç®—æœºç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„</a></li>\n<li><a href=\"#14-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%9F%BA%E6%9C%AC%E7%BB%84%E6%88%90\">1.4. è®¡ç®—æœºåŸºæœ¬ç»„æˆ</a></li>\n</ul>\n</li>\n<li><a href=\"#2-%E8%AE%A1%E7%AE%97%E6%9C%BA%E5%8F%91%E5%B1%95%E7%AE%80%E5%8F%B2\">2. è®¡ç®—æœºå‘å±•ç®€å²</a></li>\n<li><a href=\"#3-%E7%B3%BB%E7%BB%9F%E6%80%BB%E7%BA%BF\">3. ç³»ç»Ÿæ€»çº¿</a>\n<ul>\n<li><a href=\"#31-%E6%80%BB%E7%BA%BF%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\">3.1. æ€»çº¿çš„åŸºæœ¬æ¦‚å¿µ</a></li>\n<li><a href=\"#32-%E6%80%BB%E7%BA%BF%E5%88%86%E7%B1%BB\">3.2. æ€»çº¿åˆ†ç±»</a></li>\n<li><a href=\"#33-%E6%80%BB%E7%BA%BF%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87\">3.3. æ€»çº¿æ€§èƒ½æŒ‡æ ‡</a></li>\n<li><a href=\"#34-%E6%80%BB%E7%BA%BF%E6%A0%87%E5%87%86\">3.4. æ€»çº¿æ ‡å‡†</a></li>\n<li><a href=\"#35-%E6%80%BB%E7%BA%BF%E6%8E%A7%E5%88%B6\">3.5. æ€»çº¿æ§åˆ¶</a></li>\n</ul>\n</li>\n<li><a href=\"#4-%E5%AD%98%E5%82%A8%E5%99%A8\">4. å­˜å‚¨å™¨</a>\n<ul>\n<li><a href=\"#41-%E5%AD%98%E5%82%A8%E4%BB%8B%E8%B4%A8\">4.1. å­˜å‚¨ä»‹è´¨</a></li>\n<li><a href=\"#42-%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E5%88%86%E7%B1%BB\">4.2. å­˜å‚¨å™¨çš„åˆ†ç±»</a></li>\n<li><a href=\"#43-%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84\">4.3. å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„</a></li>\n<li><a href=\"#44-%E5%AD%98%E5%82%A8%E7%B3%BB%E7%BB%9F%E5%B1%82%E6%AC%A1%E7%BB%93%E6%9E%84\">4.4. å­˜å‚¨ç³»ç»Ÿå±‚æ¬¡ç»“æ„</a></li>\n<li><a href=\"#45-%E4%B8%BB%E5%AD%98%E5%82%A8%E5%99%A8\">4.5. ä¸»å­˜å‚¨å™¨</a></li>\n<li><a href=\"#46-%E5%AD%98%E5%82%A8%E5%99%A8%E7%9A%84%E6%A0%A1%E9%AA%8C%E6%B1%89%E6%98%8E%E7%A0%81\">4.6. å­˜å‚¨å™¨çš„æ ¡éªŒ(æ±‰æ˜ç )</a></li>\n<li><a href=\"#47-%E9%AB%98%E9%80%9F%E7%BC%93%E5%86%B2%E5%AD%98%E5%82%A8%E5%99%A8\">4.7. é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨</a></li>\n<li><a href=\"#48-%E7%BC%93%E5%AD%98-%E4%B8%BB%E5%AD%98%E5%9C%B0%E5%9D%80%E6%98%A0%E5%B0%84%E6%96%B9%E5%BC%8F%E4%B8%BB%E5%AD%98%E5%9C%B0%E5%9D%80%E6%98%A0%E5%B0%84%E5%88%B0cache%E5%9C%B0%E5%9D%80%E7%A7%B0%E4%B8%BA%E5%9C%B0%E5%9D%80%E6%98%A0%E5%B0%84\">4.8. ï¼Ÿï¼Ÿï¼Ÿï¼Ÿç¼“å­˜-ä¸»å­˜åœ°å€æ˜ å°„æ–¹å¼ï¼ˆä¸»å­˜åœ°å€æ˜ å°„åˆ°Cacheåœ°å€ç§°ä¸ºåœ°å€æ˜ å°„ï¼‰</a></li>\n<li><a href=\"#49-%E6%9B%BF%E6%8D%A2%E7%AD%96%E7%95%A5\">4.9. æ›¿æ¢ç­–ç•¥</a></li>\n<li><a href=\"#410-%E8%BE%85%E5%8A%A9%E5%AD%98%E5%82%A8%E5%99%A8\">4.10. è¾…åŠ©å­˜å‚¨å™¨</a></li>\n</ul>\n</li>\n<li><a href=\"#5-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F\">5. è¾“å…¥è¾“å‡ºç³»ç»Ÿ</a>\n<ul>\n<li><a href=\"#51-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F%E5%8F%91%E5%B1%95%E6%A6%82%E5%86%B5\">5.1. è¾“å…¥è¾“å‡ºç³»ç»Ÿå‘å±•æ¦‚å†µ</a></li>\n<li><a href=\"#52-%E8%BE%93%E5%85%A5%E8%BE%93%E5%87%BA%E7%B3%BB%E7%BB%9F%E7%9A%84%E7%BB%84%E6%88%90\">5.2. è¾“å…¥è¾“å‡ºç³»ç»Ÿçš„ç»„æˆ</a></li>\n<li><a href=\"#53-io%E8%AE%BE%E5%A4%87%E4%B8%8E%E4%B8%BB%E6%9C%BA%E7%9A%84%E8%81%94%E7%B3%BB%E6%96%B9%E5%BC%8F\">5.3. I/Oè®¾å¤‡ä¸ä¸»æœºçš„è”ç³»æ–¹å¼</a></li>\n<li><a href=\"#54-io%E8%AE%BE%E5%A4%87%E4%B8%8E%E4%B8%BB%E6%9C%BA%E4%BF%A1%E6%81%AF%E4%BC%A0%E9%80%81%E7%9A%84%E6%8E%A7%E5%88%B6%E6%96%B9%E5%BC%8F\">5.4. I/Oè®¾å¤‡ä¸ä¸»æœºä¿¡æ¯ä¼ é€çš„æ§åˆ¶æ–¹å¼</a></li>\n<li><a href=\"#55-io%E6%8E%A5%E5%8F%A3\">5.5. I/Oæ¥å£</a></li>\n<li><a href=\"#56-%E6%8E%A5%E5%8F%A3%E7%9A%84%E5%8A%9F%E8%83%BD%E5%92%8C%E7%BB%84%E6%88%90\">5.6. æ¥å£çš„åŠŸèƒ½å’Œç»„æˆ</a></li>\n<li><a href=\"#57-%E7%A8%8B%E5%BA%8F%E4%B8%AD%E6%96%AD%E6%96%B9%E5%BC%8F\">5.7. ç¨‹åºä¸­æ–­æ–¹å¼</a></li>\n<li><a href=\"#58-%E4%B8%AD%E6%96%AD%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E7%9A%84%E6%B5%81%E7%A8%8B\">5.8. ä¸­æ–­æœåŠ¡ç¨‹åºçš„æµç¨‹</a></li>\n<li><a href=\"#59-dma%E6%96%B9%E5%BC%8F\">5.9. DMAæ–¹å¼</a></li>\n</ul>\n</li>\n<li><a href=\"#6-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E8%BF%90%E7%AE%97%E6%96%B9%E6%B3%95\">6. è®¡ç®—æœºçš„è¿ç®—æ–¹æ³•</a>\n<ul>\n<li><a href=\"#61-%E8%BF%9B%E5%88%B6%E7%9A%84%E6%A6%82%E8%BF%B0\">6.1. è¿›åˆ¶çš„æ¦‚è¿°</a></li>\n<li><a href=\"#62-%E8%AE%A1%E7%AE%97%E6%9C%BA%E4%B8%AD%E7%9A%84%E6%95%B0\">6.2. è®¡ç®—æœºä¸­çš„æ•°</a></li>\n<li><a href=\"#63-%E6%95%B0%E7%9A%84%E5%AE%9A%E7%82%B9%E8%A1%A8%E7%A4%BA%E5%92%8C%E6%B5%AE%E7%82%B9%E8%A1%A8%E7%A4%BA\">6.3. æ•°çš„å®šç‚¹è¡¨ç¤ºå’Œæµ®ç‚¹è¡¨ç¤º</a></li>\n<li><a href=\"#64-%E5%AE%9A%E7%82%B9%E6%95%B0%E7%9A%84%E5%8A%A0%E5%87%8F%E6%B3%95\">6.4. å®šç‚¹æ•°çš„åŠ å‡æ³•</a></li>\n<li><a href=\"#65-%E5%AE%9A%E7%82%B9%E6%95%B0%E4%B9%98%E6%B3%95%E8%BF%90%E7%AE%97\">6.5. å®šç‚¹æ•°ä¹˜æ³•è¿ç®—</a></li>\n<li><a href=\"#66-%E5%AE%9A%E7%82%B9%E6%95%B0%E9%99%A4%E6%B3%95%E8%BF%90%E7%AE%97\">6.6. å®šç‚¹æ•°é™¤æ³•è¿ç®—</a></li>\n<li><a href=\"#67-%E6%B5%AE%E7%82%B9%E6%95%B0%E7%9A%84%E5%8A%A0%E5%87%8F%E6%B3%95\">6.7. æµ®ç‚¹æ•°çš„åŠ å‡æ³•</a></li>\n</ul>\n</li>\n<li><a href=\"#7-%E6%8C%87%E4%BB%A4%E7%B3%BB%E7%BB%9F\">7. æŒ‡ä»¤ç³»ç»Ÿ</a>\n<ul>\n<li><a href=\"#71-%E6%9C%BA%E5%99%A8%E6%8C%87%E4%BB%A4\">7.1. æœºå™¨æŒ‡ä»¤</a></li>\n<li><a href=\"#72-%E6%93%8D%E4%BD%9C%E6%95%B0%E7%B1%BB%E5%9E%8B\">7.2. æ“ä½œæ•°ç±»å‹</a></li>\n<li><a href=\"#73-%E6%93%8D%E4%BD%9C%E7%B1%BB%E5%9E%8B\">7.3. æ“ä½œç±»å‹</a></li>\n<li><a href=\"#74-%E5%AF%BB%E5%9D%80%E6%96%B9%E5%BC%8F\">7.4. å¯»å€æ–¹å¼</a></li>\n</ul>\n</li>\n<li><a href=\"#8-cpu%E7%9A%84%E7%BB%93%E6%9E%84%E5%92%8C%E5%8A%9F%E8%83%BD\">8. CPUçš„ç»“æ„å’ŒåŠŸèƒ½</a>\n<ul>\n<li><a href=\"#81-%E6%8E%A7%E5%88%B6%E5%99%A8%E7%9A%84%E5%9F%BA%E6%9C%AC%E5%8A%9F%E8%83%BD\">8.1. æ§åˆ¶å™¨çš„åŸºæœ¬åŠŸèƒ½</a></li>\n<li><a href=\"#82-cpu%E7%BB%93%E6%9E%84%E6%A1%86%E5%9B%BE\">8.2. CPUç»“æ„æ¡†å›¾</a></li>\n</ul>\n</li>\n<li><a href=\"#9-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E6%8E%A7%E5%88%B6%E5%99%A8\">9. è®¡ç®—æœºçš„æ§åˆ¶å™¨</a></li>\n<li><a href=\"#10-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%9A%84%E8%BF%90%E7%AE%97%E5%99%A8\">10. è®¡ç®—æœºçš„è¿ç®—å™¨</a>\n<ul>\n<li><a href=\"#101-cpu%E7%9A%84%E5%AF%84%E5%AD%98%E5%99%A8\">10.1. CPUçš„å¯„å­˜å™¨</a></li>\n<li><a href=\"#102-%E6%8E%A7%E5%88%B6%E5%8D%95%E5%85%83%E5%92%8C%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F\">10.2. æ§åˆ¶å•å…ƒå’Œä¸­æ–­ç³»ç»Ÿ</a></li>\n<li><a href=\"#103-%E6%8C%87%E4%BB%A4%E5%91%A8%E6%9C%9F\">10.3. æŒ‡ä»¤å‘¨æœŸ</a></li>\n</ul>\n</li>\n<li><a href=\"#11-%E4%B8%AD%E6%96%AD%E7%B3%BB%E7%BB%9F\">11. ä¸­æ–­ç³»ç»Ÿ</a>\n<ul>\n<li><a href=\"#111-%E6%A6%82%E8%BF%B0\">11.1. æ¦‚è¿°</a></li>\n<li><a href=\"#112-%E4%B8%AD%E6%96%AD%E5%88%A4%E4%BC%98%E9%80%BB%E8%BE%91\">11.2. ä¸­æ–­åˆ¤ä¼˜é€»è¾‘</a></li>\n<li><a href=\"#113-%E4%B8%AD%E6%96%AD%E6%9C%8D%E5%8A%A1%E7%A8%8B%E5%BA%8F%E5%85%A5%E5%8F%A3%E5%9C%B0%E5%9D%80%E7%9A%84%E5%AF%BB%E6%89%BE\">11.3. ä¸­æ–­æœåŠ¡ç¨‹åºå…¥å£åœ°å€çš„å¯»æ‰¾</a></li>\n<li><a href=\"#114-%E4%B8%AD%E6%96%AD%E5%93%8D%E5%BA%94\">11.4. ä¸­æ–­å“åº”</a></li>\n<li><a href=\"#115-%E4%B8%AD%E6%96%AD%E5%B1%8F%E8%94%BD%E6%8A%80%E6%9C%AF%E7%94%A8%E4%BA%8E%E5%A4%9A%E9%87%8D%E4%B8%AD%E6%96%AD\">11.5. ä¸­æ–­å±è”½æŠ€æœ¯(ç”¨äºå¤šé‡ä¸­æ–­)</a></li>\n</ul>\n</li>\n<li><a href=\"#12-%E6%8E%A7%E5%88%B6%E5%8D%95%E5%85%83%E7%9A%84%E5%8A%9F%E8%83%BD\">12. æ§åˆ¶å•å…ƒçš„åŠŸèƒ½</a>\n<ul>\n<li><a href=\"#121-%E5%BE%AE%E6%93%8D%E4%BD%9C%E5%91%BD%E4%BB%A4%E7%9A%84%E5%88%86%E6%9E%90\">12.1. å¾®æ“ä½œå‘½ä»¤çš„åˆ†æ</a></li>\n<li><a href=\"#122-%E4%B8%AD%E6%96%AD%E5%91%A8%E6%9C%9F\">12.2. ä¸­æ–­å‘¨æœŸ</a></li>\n</ul>\n</li>\n<li><a href=\"#13-%E8%AE%A1%E7%AE%97%E6%9C%BA%E6%8C%87%E4%BB%A4%E7%9A%84%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B\">13. è®¡ç®—æœºæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹</a></li>\n<li><a href=\"#cpu%E5%AE%9E%E7%8E%B0%E5%8E%9F%E5%AD%90%E6%80%A7\">CPUå®ç°åŸå­æ€§</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. è®¡ç®—æœºç³»ç»Ÿæ¦‚è®º</h1>\n<h2>1.1. è®¡ç®—æœºç³»ç»Ÿç»„æˆ-&gt;è®¡ç®—æœºæ€§èƒ½çš„å¥½åå–å†³äºè½¯ç¡¬ä»¶åŠŸèƒ½çš„æ€»å’Œ</h2>\n<ul>\n<li>ç¡¬ä»¶ï¼šè®¡ç®—æœºå®ä½“éƒ¨åˆ†ï¼Œç”±å„ç§ç”µå­å…ƒå™¨ä»¶ï¼Œå„ç±»å…‰ã€ç”µã€æœºè®¾å¤‡çš„å®ç‰©ç»„æˆ</li>\n<li>è½¯ä»¶ï¼šç”±äººä»¬äº‹å…ˆç¼–åˆ¶çš„å…·æœ‰å„ç±»ç‰¹æ®ŠåŠŸèƒ½çš„ç¨‹åºç»„æˆï¼Œå¸¸å­˜æ”¾åœ¨è®¡ç®—æœºçš„ä¸»å­˜æˆ–è¾…å­˜å†…ï¼Œåˆ†ä¸ºç³»ç»Ÿè½¯ä»¶å’Œåº”ç”¨è½¯ä»¶\n<ul>\n<li>ç³»ç»Ÿè½¯ä»¶/ç¨‹åºï¼šç®¡ç†æ•´ä¸ªè®¡ç®—æœºç³»ç»Ÿï¼Œç›‘è§†æœåŠ¡ï¼Œä½¿ç³»ç»Ÿèµ„æºå¾—åˆ°åˆç†è°ƒåº¦ï¼Œé«˜æ•ˆè¿è¡Œï¼ŒåŒ…æ‹¬æ ‡å‡†ç¨‹åºåº“ã€è¯­è¨€å¤„ç†ç¨‹åºï¼ˆå¦‚å°†æ±‡ç¼–è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€çš„æ±‡ç¼–ç¨‹åºæˆ–è€…å°†é«˜çº§è¯­è¨€ç¿»è¯‘æˆæœºå™¨è¯­è¨€çš„ç¼–è¯‘ç¨‹åºï¼‰ã€æ“ä½œç³»ç»Ÿï¼ˆå¦‚æ‰¹å¤„ç†ç³»ç»Ÿã€åˆ†æ—¶ç³»ç»Ÿã€å®æ—¶ç³»ç»Ÿï¼‰ã€æœåŠ¡ç¨‹åºï¼ˆå¦‚è¯Šæ–­ç¨‹åºã€è°ƒè¯•ç¨‹åºã€è¿æ¥ç¨‹åºç­‰ï¼‰æ•°æ®åº“ç®¡ç†ç³»ç»Ÿã€ç½‘ç»œè½¯ä»¶ç­‰</li>\n<li>åº”ç”¨è½¯ä»¶/ç¨‹åºï¼šæ ¹æ®ä»»åŠ¡éœ€è¦ç¼–åˆ¶çš„å„ç§ç¨‹åºï¼Œå¦‚ç§‘å­¦è®¡ç®—ç¨‹åºï¼Œæ•°æ®å¤„ç†ç¨‹åºï¼Œè¿‡ç¨‹æ§åˆ¶ç¨‹åºï¼Œäº‹åŠ¡ç®¡ç†ç¨‹åºç­‰</li>\n</ul>\n</li>\n</ul>\n<h2>1.2. ç°ä»£è®¡ç®—æœºçš„è§£é¢˜è¿‡ç¨‹</h2>\n<ul>\n<li>ç”±ç”¨æˆ·ç”¨é«˜çº§è¯­è¨€ç¼–å†™ç¨‹åºï¼ˆæºç¨‹åºï¼‰ï¼Œç„¶åå°†å®ƒå’Œæ•°æ®ä¸€èµ·é€å…¥è®¡ç®—æœºå†…ï¼Œå†ç”±è®¡ç®—æœºå°†å…¶ç¿»è¯‘æˆæœºå™¨èƒ½è¯†åˆ«çš„æœºå™¨è¯­è¨€ç¨‹åºï¼ˆç›®æ ‡ç¨‹åºï¼‰ï¼Œæœºå™¨è‡ªåŠ¨è¿è¡Œè¯¥æœºå™¨è¯­è¨€ç¨‹åºï¼Œå¹¶å°†ç»“æœè¾“å‡º</li>\n</ul>\n<h2>1.3. è®¡ç®—æœºç³»ç»Ÿçš„å±‚æ¬¡ç»“æ„</h2>\n<ul>\n<li>\n<p>æœºå™¨è¯­è¨€æœºå™¨ï¼šç”¨æˆ·å¿…é¡»ç”¨äºŒè¿›åˆ¶ä»£ç æ¥ç¼–å†™ç¨‹åºï¼ˆæœºå™¨è¯­è¨€ç¨‹åºï¼‰ï¼Œå¯ä»¥ç›´æ¥åœ¨æœºå™¨ä¸Šæ‰§è¡Œï¼Œç›´æ¥æ‰§è¡Œæœºå™¨è¯­è¨€çš„æœºå™¨ç§°ä¸ºå®é™…æœºå™¨M1</p>\n</li>\n<li>\n<p>æ±‡ç¼–è¯­è¨€æœºå™¨ï¼šæ±‡ç¼–è¯­è¨€ä½¿ç”¨ç¬¦å·è¡¨ç¤ºæŒ‡ä»¤æˆ–æ•°æ®æ‰€åœ¨å­˜å‚¨å•å…ƒçš„åœ°å€ï¼Œä½¿ç¨‹åºå‘˜å¯ä»¥ä¸å†ä½¿ç”¨ç¹æ‚è€Œåˆæ˜“é”™çš„äºŒè¿›åˆ¶ä»£ç ç¼–å†™ç¨‹åºï¼›æ±‡ç¼–ç¨‹åºå°†æ±‡ç¼–è¯­è¨€ç¨‹åºç¿»è¯‘æˆæœºå™¨è¯­è¨€ç¨‹åº</p>\n</li>\n<li>\n<p>é«˜çº§è¯­è¨€æœºå™¨ï¼šç¨‹åºå‘˜ä¸å¿…äº†è§£ã€æŒæ¡å®é™…æœºå™¨M1çš„æœºå‹ã€å†…éƒ¨çš„å…·ä½“ç»„æˆåŠå…¶æŒ‡ä»¤ç³»ç»Ÿï¼Œåªéœ€æŒæ¡é«˜çº§è¯­è¨€çš„è¯­æ³•å’Œè¯­ä¹‰ï¼Œä¾¿å¯ç›´æ¥ç¼–ç¨‹ã€‚åœ¨è¿›å…¥æœºå™¨è¯­è¨€æœºå™¨è¿è¡Œå‰ï¼Œç”±ç¿»è¯‘ç¨‹åºå°†é«˜çº§è¯­è¨€ç¨‹åºç¿»è¯‘æˆæœºå™¨è¯­è¨€ç¨‹åºã€‚ç¿»è¯‘ç¨‹åºåˆ†ä¸ºç¼–è¯‘ç¨‹åºå’Œè§£é‡Šç¨‹åº</p>\n<ul>\n<li>ç¼–è¯‘ç¨‹åºï¼šå°†é«˜çº§è¯­è¨€ç¨‹åºçš„å…¨éƒ¨è¯­å¥ä¸€æ¬¡å…¨éƒ¨ç¿»è¯‘æˆæœºå™¨è¯­è¨€ç¨‹åºï¼Œè€Œåå†æ‰§è¡Œæœºå™¨è¯­è¨€ç¨‹åºã€‚åªè¦æºç¨‹åºä¸å˜ï¼Œæ— éœ€å†æ¬¡è¿›è¡Œç¿»è¯‘ã€‚äº§ç”Ÿæ–°çš„ç¨‹åºï¼ˆC\\C++\\Golangï¼‰</li>\n<li>è§£æç¨‹åºï¼šé€æ¡ç¿»è¯‘æºç¨‹åºçš„è¯­å¥å¹¶æ‰§è¡Œï¼Œç›´è‡³å®Œæˆæºç¨‹åºçš„å…¨éƒ¨ç¿»è¯‘ä»»åŠ¡ï¼Œç¿»è¯‘ä¸€æ¬¡æ‰§è¡Œä¸€æ¬¡ï¼Œå³ä½¿ä¸‹ä¸€æ¬¡é‡å¤æ‰§è¡Œè¯¥è¯­å¥æ—¶ï¼Œä¹Ÿå¿…é¡»é‡æ–°ç¿»è¯‘ã€‚ä¸äº§ç”Ÿæ–°çš„ç¨‹åºï¼ˆPython\\Php\\Javascriptï¼‰</li>\n</ul>\n</li>\n<li>\n<p>å¾®ç¨‹åºæœºå™¨ï¼šå°†æœºå™¨è¯­è¨€æœºå™¨ä¸­çš„æ¯ä¸€æ¡æœºå™¨æŒ‡ä»¤ç¿»è¯‘æˆä¸€ç»„å¾®æŒ‡ä»¤ï¼Œæ„æˆä¸€ä¸ªå¾®ç¨‹åºã€‚æœºå™¨è¯­è¨€æœºå™¨æ¯æ‰§è¡Œå®Œå¯¹åº”äºä¸€æ¡æœºå™¨æŒ‡ä»¤çš„å¾®ç¨‹åºåï¼Œä¾¿ç”±æœºå™¨è¯­è¨€æœºå™¨ä¸­çš„ä¸‹ä¸€æ¡æŒ‡ä»¤ä½¿å¾®ç¨‹åºæœºå™¨è‡ªåŠ¨è¿›å…¥ä¸å…¶ç›¸å¯¹åº”çš„å¦ä¸€ä¸ªå¾®ç¨‹åºçš„æ‰§è¡Œã€‚å¾®ç¨‹åºæœºå™¨å¯ä»¥çœ‹åšæ˜¯å¯¹æœºå™¨è¯­è¨€æœºå™¨çš„åˆ†è§£ï¼Œå³ç”¨å¾®ç¨‹åºæœºå™¨çš„å¾®ç¨‹åºè§£é‡Šå¹¶æ‰§è¡Œæ¯ä¸€æ¡æœºå™¨æŒ‡ä»¤</p>\n</li>\n<li>\n<p>æ“ä½œç³»ç»Ÿæœºå™¨ï¼šç”±æ“ä½œç³»ç»Ÿè½¯ä»¶æ„æˆã€‚æä¾›æ±‡ç¼–è¯­è¨€å’Œé«˜çº§è¯­è¨€åœ¨ä½¿ç”¨å’Œå®ç°è¿‡ç¨‹ä¸­æ‰€éœ€çš„æŸäº›åŸºæœ¬æ“ä½œï¼Œè¿˜èµ·åˆ°æ§åˆ¶å¹¶ç®¡ç†è®¡ç®—æœºç³»ç»Ÿå…¨éƒ¨ç¡¬ä»¶å’Œè½¯ä»¶èµ„æºçš„ä½œç”¨ï¼Œä¸ºç”¨æˆ·ä½¿ç”¨è®¡ç®—æœºç³»ç»Ÿæä¾›æä¸ºæ–¹ä¾¿çš„æ¡ä»¶ï¼Œæ“ä½œç³»ç»Ÿçš„åŠŸèƒ½æ˜¯é€šè¿‡å…¶æ§åˆ¶è¯­è¨€æ¥å®ç°çš„</p>\n</li>\n<li>\n<p>ç¡¬ä»¶ç ”ç©¶çš„ä¸»è¦å¯¹è±¡å½’ç»“ä¸ºä¼ ç»Ÿæœºå™¨M1å’Œå¾®ç¨‹åºæœºå™¨M0ï¼Œè½¯ä»¶çš„ç ”ç©¶å¯¹è±¡ä¸»è¦æ˜¯æ“ä½œç³»ç»ŸåŠä»¥ä¸Šçš„å„çº§è™šæ‹Ÿæœº<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2b1b1bc7cd4defb97dd4a.png\" alt=\"9.PNG\"></p>\n</li>\n<li>\n<p>è®¡ç®—æœºç³»ç»Ÿçš„å±æ€§ï¼šç¨‹åºå‘˜çœ‹åˆ°çš„ä¼ ç»Ÿæœºå™¨çš„å±æ€§ï¼šåŒ…æ‹¬æŒ‡ä»¤é›†ã€æ•°æ®ç±»å‹ã€å­˜å‚¨å™¨å¯»å€æŠ€æœ¯ã€i/oæœºç†ç­‰å¤§å¤šæ•°æ˜¯æŠ½è±¡å±æ€§</p>\n</li>\n<li>\n<p>è®¡ç®—æœºä½“ç³»ç»“æ„ï¼šæŒ‡é‚£äº›èƒ½å¤Ÿè¢«ç¨‹åºå‘˜æ‰€è§åˆ°çš„è®¡ç®—æœºç³»ç»Ÿçš„å±æ€§ï¼Œå³æ¦‚å¿µæ€§çš„ç»“æ„ä¸åŠŸèƒ½ç‰¹æ€§</p>\n</li>\n<li>\n<p>è®¡ç®—æœºç»„æˆï¼šæŒ‡å¦‚ä½•å®ç°è®¡ç®—æœºä½“ç³»ç»“æ„æ‰€ä½“ç°çš„å±æ€§ï¼ˆæŒ‡ä»¤ç³»ç»Ÿå±äºè®¡ç®—æœºç»“æ„é—®é¢˜ï¼Œè€ŒæŒ‡ä»¤çš„å®ç°ã€å¦‚ä½•å–æŒ‡ä»¤ã€åˆ†ææŒ‡ä»¤ã€å–æ“ä½œæ•°ã€è¿ç®—ã€é€ç»“æœç­‰å±äºè®¡ç®—æœºç»„æˆé—®é¢˜ï¼Œç»“æ„ç›¸åŒçš„è®¡ç®—æœºï¼Œç»„æˆï¼ˆç»“æ„å®ç°ï¼‰ä¸ä¸€å®šç›¸åŒï¼‰</p>\n</li>\n</ul>\n<h2>1.4. è®¡ç®—æœºåŸºæœ¬ç»„æˆ</h2>\n<ul>\n<li>å†¯è¯ºä¾æ›¼è®¡ç®—æœº:1945å¹´ï¼Œæ•°å­¦å®¶å†¯è¯ºä¾æ›¼æå‡ºå­˜å‚¨ç¨‹åºçš„æ¦‚å¿µï¼Œä»¥æ­¤æ¦‚å¿µä¸ºåŸºç¡€çš„è®¡ç®—æœºéƒ½ç§°ä¸ºå†¯è¯ºä¾æ›¼æœºã€‚ç‰¹ç‚¹å¦‚ä¸‹\n<ul>\n<li>è®¡ç®—æœºæ˜¯ç”±è¿ç®—å™¨ã€å­˜å‚¨å™¨ã€æ§åˆ¶å™¨ã€è¾“å…¥è®¾å¤‡å’Œè¾“å‡ºè®¾å¤‡äº”å¤§éƒ¨ä»¶ç»„æˆ</li>\n<li>æŒ‡ä»¤å’Œæ•°æ®å‡ä»¥äºŒè¿›åˆ¶è¡¨ç¤ºï¼Œå­˜æ”¾åœ¨å­˜å‚¨å™¨å†…ï¼Œå¹¶å¯æŒ‰åœ°å€å¯»è®¿</li>\n<li>æŒ‡ä»¤ç”±æ“ä½œç å’Œåœ°å€ç ç»„æˆï¼Œæ“ä½œç ç”¨æ¥è¡¨ç¤ºæ“ä½œçš„æ€§è´¨ï¼Œåœ°å€ç ç”¨æ¥è¡¨ç¤ºæ“ä½œæ•°åœ¨å­˜å‚¨å™¨ä¸­çš„ä½ç½®</li>\n<li>æŒ‡ä»¤åœ¨å­˜å‚¨å™¨å†…æŒ‰é¡ºåºå­˜æ”¾ã€‚é€šå¸¸æŒ‡ä»¤æ˜¯é¡ºåºæ‰§è¡Œçš„ï¼Œåœ¨ç‰¹æ€§æ¡ä»¶ä¸‹ï¼Œå¯æ ¹æ®è¿ç®—ç»“æœæˆ–æ ¹æ®è®¾å®šæ¡ä»¶æ”¹å˜æ‰§è¡Œé¡ºåº</li>\n<li>æœºå™¨ä»¥è¿ç®—å™¨ä¸ºä¸­å¿ƒï¼Œè¾“å…¥è¾“å‡ºè®¾å¤‡ä¸å­˜å‚¨å™¨é—´çš„æ•°æ®ä¼ é€é€šè¿‡è¿ç®—å™¨å®Œæˆ</li>\n<li>å†¯è¯ºä¾æ›¼ç“¶é¢ˆ-&gt;è¿ç®—å™¨è¿ç®—é€Ÿåº¦æ¯”å­˜å‚¨å™¨è®¿é—®é€Ÿåº¦å¿«ï¼ˆCPUç»å¸¸ç©ºè½¬ç­‰å¾…æ•°æ®ä¼ è¾“ï¼‰</li>\n</ul>\n</li>\n<li>è®¡ç®—æœºçš„ç¡¬ä»¶æ¡†å›¾\n<ul>\n<li>ç»å…¸çš„å†¯è¯ºä¾æ›¼è®¡ç®—æœºä»¥è¿ç®—å™¨ä¸ºä¸­å¿ƒ</li>\n<li>ç°ä»£çš„è®¡ç®—æœºä»¥å­˜å‚¨å™¨ä¸ºä¸­å¿ƒ</li>\n<li>è¿ç®—å™¨ï¼šå®Œæˆç®—æœ¯è¿ç®—å’Œé€»è¾‘è¿ç®—ï¼Œå¹¶å°†è¿ç®—çš„ä¸­é—´ç»“æœæš‚å­˜åœ¨è¿ç®—å™¨å†…</li>\n<li>å­˜å‚¨å™¨ï¼šå­˜æ”¾æ•°æ®å’Œç¨‹åº</li>\n<li>æ§åˆ¶å™¨ï¼šæ§åˆ¶ã€æŒ‡æŒ¥ç¨‹åºå’Œæ•°æ®çš„è¾“å…¥ã€è¿è¡Œä»¥åŠå¤„ç†è¿ç®—ç»“æœï¼Œè§£é‡Šå­˜å‚¨å™¨ä¸­çš„æŒ‡ä»¤ï¼Œå¹¶å‘å‡ºå„ç§æ“ä½œå‘½ä»¤æ¥æ‰§è¡ŒæŒ‡ä»¤</li>\n<li>è¾“å…¥è®¾å¤‡ï¼šå°†äººä»¬ç†Ÿæ‚‰çš„ä¿¡æ¯å½¢å¼è½¬æ¢ä¸ºæœºå™¨èƒ½è¯†åˆ«çš„ä¿¡æ¯å½¢å¼</li>\n<li>è¾“å‡ºè®¾å¤‡ï¼šå°†æœºå™¨è¿ç®—ç»“æœè½¬æ¢ä¸ºäººä¹ˆç†Ÿæ‚‰çš„ä¿¡æ¯å½¢å¼</li>\n</ul>\n</li>\n<li>ç°ä»£è®¡ç®—æœºç»„æˆ\n<ul>\n<li>ä¸»æœº\n<ul>\n<li>ä¸­å¤®å¤„ç†å™¨CPU(Central Processing Unit)=è¿ç®—å™¨ï¼ˆç®—æœ¯é€»è¾‘å•å…ƒArithmetic Logic Unit,ALUï¼‰+æ§åˆ¶å™¨ï¼ˆæ§åˆ¶å•å…ƒControl Unit,CUï¼‰</li>\n<li>ä¸»å­˜å‚¨å™¨(Main Memory,MM)</li>\n</ul>\n</li>\n<li>I/Oè®¾å¤‡(å¤–éƒ¨è®¾å¤‡) = è¾“å…¥è®¾å¤‡ + è¾“å‡ºè®¾å¤‡</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f1eaf30bbe80adb74a1a8.png\" alt=\"1.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ffd9f676eecdaf2d46b96.png\" alt=\"2.png\"></p>\n<ul>\n<li>è®¡ç®—æœºçš„å·¥ä½œæ­¥éª¤ï¼ˆå¾…è¡¥å……ï¼‰</li>\n<li>è®¡ç®—æœºç¡¬ä»¶çš„ä¸»è¦æŠ€æœ¯æŒ‡æ ‡\n<ul>\n<li>æœºå™¨å­—é•¿ï¼šCPUä¸€æ¬¡èƒ½å¤„ç†æ•°æ®çš„ä½æ•°ï¼Œä¸CPUå¯„å­˜å™¨ä½æ•°æœ‰å…³ï¼Œå­—é•¿è¶Šé•¿ï¼Œæ•°çš„è¡¨ç¤ºèŒƒå›´è¶Šå¤§ï¼Œç²¾åº¦è¶Šé«˜</li>\n<li>å­˜å‚¨å®¹é‡ï¼šåŒ…æ‹¬äº†ä¸»å­˜å®¹é‡å’Œè¾…å­˜å®¹é‡ï¼Œä¸»å­˜å®¹é‡æŒ‡ä¸»å­˜ä¸­å­˜æ”¾äºŒè¿›åˆ¶ä»£ç çš„æ€»ä½æ•°\n<ul>\n<li>å­˜å‚¨å®¹é‡ = å­˜å‚¨å•å…ƒä¸ªæ•° x å­˜å‚¨å­—é•¿ï¼ˆå­˜å‚¨å•å…ƒä¸ªæ•° = 2^MARçš„ä½æ•°ï¼Œå­˜å‚¨å­—é•¿ = MDRçš„ä½æ•°ï¼‰</li>\n<li>è®¡ç®—æœºå­˜å‚¨è®¾å¤‡çš„æœ€å°ä¿¡æ¯å•å…ƒå«â€œä½ï¼ˆbitï¼‰â€æˆ–â€œæ¯”ç‰¹ä½â€ï¼Œç”¨bè¡¨ç¤ºã€‚</li>\n<li>è®¡ç®—æœºæœ€å°çš„å­˜å‚¨å•å…ƒå«â€œå­—èŠ‚ï¼ˆbyteï¼‰â€ï¼Œç”¨Bè¡¨ç¤ºï¼Œå­—èŠ‚æ˜¯ç”±è¿ç»­çš„8ä¸ªä½ç»„æˆ</li>\n<li>å½“ç¨‹åºéœ€è¦ä½¿ç”¨å­˜å‚¨ç©ºé—´æ—¶ï¼Œæ“ä½œç³»ç»Ÿæœ€å°ä¼šåˆ†æ´¾ç»™ç¨‹åº1ä¸ªå­—èŠ‚ï¼Œè€Œä¸æ˜¯1ä¸ªä½</li>\n<li>1ä¸ªå­—èŠ‚ï¼ˆ8ä½ï¼‰å­˜å‚¨çš„æœ€å¤§æ•°æ®æ˜¯11111111çš„äºŒè¿›åˆ¶æ•°</li>\n<li>1Bï¼ˆå­—èŠ‚ï¼‰ = 8bitã€1KB = 1024B(å¯„å­˜å™¨)ã€1MB = 1024KB(é«˜é€Ÿç¼“å­˜)ã€1GB = 1024MB(å†…å­˜/ç¡¬ç›˜) 1TB = 1024GB(ç¡¬ç›˜)ã€1PB = 1024TB(äº‘ç¡¬ç›˜)ï¼Œ1EB=1024PB(æ•°æ®ä»“åº“)</li>\n</ul>\n</li>\n<li>è¿ç®—é€Ÿåº¦\n<ul>\n<li>MIPSï¼ˆMillion Instruction Per Second ç™¾ä¸‡æ¡æŒ‡ä»¤æ¯ç§’ï¼‰ï¼šå•ä½æ—¶é—´å†…æ‰§è¡ŒæŒ‡ä»¤çš„å¹³å‡æ¡æ•°</li>\n<li>CPIï¼ˆCycle Per Instructionï¼‰ï¼šæ‰§è¡Œä¸€æ¡æŒ‡ä»¤æ‰€éœ€çš„æ—¶é’Ÿå‘¨æœŸï¼ˆæœºå™¨ä¸»é¢‘çš„å€’æ•°ï¼‰</li>\n<li>FLOPSï¼ˆFloating Point Operation Per Second æµ®ç‚¹æ•°è¿ç®—æ¬¡æ•°æ¯ç§’ï¼‰</li>\n</ul>\n</li>\n<li>CPUé€Ÿåº¦ï¼š\n<ul>\n<li>CPUçš„æ—¶é’Ÿé¢‘ç‡ã€‚å•ä½èµ«å…¹Hzï¼šç§’åˆ†ä¹‹ä¸€ã€‚æ¯ç§’ä¸­çš„å‘¨æœŸæ€§å˜åŠ¨é‡å¤æ¬¡æ•°çš„è®¡é‡ã€‚é«˜ä½ç”µå¹³æ¯ç§’é’Ÿå˜åŠ¨çš„é¢‘ç‡</li>\n<li>1Hz = 1/sï¼Œå³åœ¨å•ä½æ—¶é—´å†…å®ŒæˆæŒ¯åŠ¨çš„æ¬¡æ•°ï¼Œå•ä½ä¸ºèµ«å…¹ï¼ˆ1èµ«å…¹=1æ¬¡/ç§’ï¼‰ã€‚2GHz=2*1000^3Hz=æ¯ç§’20äº¿æ¬¡å˜åŠ¨é«˜ä½ç”µå¹³</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>2. è®¡ç®—æœºå‘å±•ç®€å²</h1>\n<ul>\n<li>ç¬¬ä¸€ä»£ç”µå­ç®¡è®¡ç®—æœºï¼ˆ1946-1957ï¼‰:ç¬¬äºŒæ¬¡ä¸–ç•Œå¤§æˆ˜ä¸­ç”±ç”µå­ç®¡ç»„æˆçš„ç”µå­æ•°å­—ç§¯åˆ†æœºå’Œè®¡ç®—æœºï¼ˆElectronic Numerical Integerator And Computer,ENIACï¼‰ï¼Œé‡‡ç”¨åè¿›åˆ¶è¿ç®—ï¼Œç”µè·¯ç»“æ„å¤æ‚ï¼Œè€—ç”µé‡å¤§ï¼Œä½“ç§¯å¤§ï¼Œæ“ä½œå¤æ‚</li>\n<li>ç¬¬äºŒä»£æ™¶ä½“ç®¡è®¡ç®—æœºï¼ˆ1957-1964ï¼‰ï¼šè´å°”å®éªŒå®¤å‘æ˜ç”¨åŠå¯¼ä½“ç»„æˆçš„æ™¶ä½“ç®¡ã€‚é›†æˆåº¦ç›¸å¯¹è¾ƒé«˜ï¼Œç©ºé—´å ç”¨ç›¸å¯¹å°ï¼ŒåŠŸè€—ç›¸å¯¹è¾ƒä½ï¼Œè¿è¡Œé€Ÿåº¦è¾ƒå¿«ï¼Œæ“ä½œç›¸å¯¹ç®€å•ã€‚äº¤äº’æ›´åŠ æ–¹ä¾¿</li>\n<li>ç¬¬ä¸‰ä»£é›†æˆç”µè·¯è®¡ç®—æœºï¼ˆ1964-1980ï¼‰ï¼šï¼ˆå¾·å·ä»ªå™¨å‘æ˜äº†é›†æˆç”µè·¯ICï¼‰è®¡ç®—æœºå˜å¾—æ›´å°ï¼ŒåŠŸè€—å˜å¾—æ›´ä½ï¼Œè®¡ç®—é€Ÿåº¦å˜å¾—æ›´å¿«</li>\n<li>è¶…å¤§è§„æ¨¡é›†æˆç”µè·¯è®¡ç®—æœºï¼ˆ1980-ç°åœ¨ï¼‰ï¼š ä¸€ä¸ªèŠ¯ç‰‡é›†æˆäº†ä¸Šç™¾ä¸‡çš„æ™¶ä½“ç®¡ï¼Œé€Ÿåº¦æ›´å¿«ï¼Œä½“ç§¯æ›´å°ï¼Œä»·æ ¼æ›´ä½ï¼Œæ›´èƒ½è¢«å¤§ä¼—æ¥å—ï¼Œç”¨é€”ä¸°å¯Œï¼šæ–‡æœ¬å¤„ç†ã€è¡¨æ ¼å¤„ç†ã€é«˜äº¤äº’çš„æ¸¸æˆä¸åº”ç”¨</li>\n</ul>\n<h1>3. ç³»ç»Ÿæ€»çº¿</h1>\n<h2>3.1. æ€»çº¿çš„åŸºæœ¬æ¦‚å¿µ</h2>\n<ul>\n<li>æ€»çº¿è¿æ¥ï¼šè®¡ç®—æœºå°†å„éƒ¨ä»¶è¿åˆ°ä¸€ç»„å…¬å…±ä¿¡æ¯ä¼ è¾“çº¿ä¸Š</li>\n<li>æ€»çº¿: å¤šä¸ªéƒ¨ä»¶çš„ä¿¡æ¯ä¼ è¾“çº¿ï¼Œå„éƒ¨ä»¶å…±äº«çš„ä¼ è¾“ä»‹è´¨ã€‚ç”±è®¸å¤šä¼ è¾“çº¿å’Œé€šè·¯ç»„æˆï¼Œæ¯æ¡çº¿å¯ä¸€ä½ä¸€ä½åœ°ä¼ è¾“äºŒè¿›åˆ¶ä»£ç ï¼Œ16æ¡ä¼ è¾“çº¿ç»„æˆçš„æ€»çº¿å¯ä»¥åŒæ—¶ä¼ è¾“16ä½äºŒè¿›åˆ¶ä»£ç </li>\n<li>å½“å¤šä¸ªéƒ¨ä»¶åŒæ—¶å‘æ€»çº¿å‘é€ä¿¡æ¯ï¼ŒåŠ¿å¿…å¯¼è‡´ä¿¡å·å†²çªï¼Œä¼ è¾“æ— æ•ˆã€‚å› æ­¤åœ¨æŸä¸€ä¸ªæ—¶åˆ»ï¼Œåªå…è®¸æœ‰ä¸€ä¸ªéƒ¨ä»¶å‘æ€»çº¿å‘é€ä¿¡æ¯ï¼Œè€Œå¤šä¸ªéƒ¨ä»¶å¯ä»¥åŒæ—¶ä»æ€»çº¿ä¸Šæ¥æ”¶ç›¸åŒçš„ä¿¡æ¯</li>\n<li>å„ç±»æ€»çº¿ç»“æ„</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/89cf6bfb02d7fb5b3fd3d.png\" alt=\"10.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e8201c19b05063373ad5f.png\" alt=\"11.png\"></p>\n<h2>3.2. æ€»çº¿åˆ†ç±»</h2>\n<ul>\n<li>æŒ‰æ•°æ®ä¼ è¾“æ–¹å¼åˆ†ï¼šå¹¶è¡Œä¼ è¾“æ€»çº¿(8ä½ã€16ä½ã€32ä½ã€64ä½ä¼ è¾“æ€»çº¿)ã€ä¸²è¡Œä¼ è¾“æ€»çº¿</li>\n<li>æŒ‰ä½¿ç”¨èŒƒå›´åˆ†ï¼šå¤–è®¾æ€»çº¿ã€æµ‹æ§æ€»çº¿ã€ç½‘ç»œé€šä¿¡æ€»çº¿ç­‰</li>\n<li>æŒ‰è¿æ¥éƒ¨ä»¶ä¸åŒ\n<ul>\n<li>ç‰‡å†…æ€»çº¿ï¼šèŠ¯ç‰‡å†…éƒ¨çš„æ€»çº¿ï¼Œå¯„å­˜å™¨ä¸å¯„å­˜å™¨ä¹‹é—´ã€å¯„å­˜å™¨ä¸æ§åˆ¶å™¨ã€è¿ç®—å™¨ä¹‹é—´éƒ½ç”±ç‰‡å†…æ€»çº¿è¿æ¥</li>\n<li>ç³»ç»Ÿæ€»çº¿ï¼šCPUã€ä¸»å­˜ã€I/Oè®¾å¤‡ï¼ˆé€šè¿‡I/Oæ¥å£ï¼‰å„å¤§éƒ¨ä»¶ä¹‹é—´çš„ä¿¡æ¯ä¼ è¾“çº¿ï¼ŒæŒ‰ä¼ è¾“ä¿¡æ¯ä¸åŒåˆ†\n<ul>\n<li>æ•°æ®æ€»çº¿ï¼ˆåŒå‘ä¼ è¾“æ€»çº¿ï¼‰ï¼šä¼ è¾“å„åŠŸèƒ½éƒ¨ä»¶ä¹‹é—´çš„æ•°æ®ä¿¡æ¯ã€‚æ•°æ®æ€»çº¿çš„ä½æ•°ç§°ä¸ºæ•°æ®æ€»çº¿å®½åº¦ï¼Œä¸æœºå™¨å­—é•¿ï¼Œå­˜å‚¨å­—é•¿æœ‰å…³</li>\n<li>åœ°å€æ€»çº¿ï¼ˆå•å‘è¾“å‡ºæ€»çº¿ï¼‰ï¼šç”¨æ¥æŒ‡å‡ºæ•°æ®æ€»çº¿ä¸Šæºæ•°æ®æˆ–ç›®çš„æ•°æ®åœ¨å†…å­˜ä¸­çš„åœ°å€æˆ–I/Oè®¾å¤‡çš„åœ°å€ï¼Œåœ°å€æ€»çº¿çš„ä½æ•°å’Œå­˜å‚¨å•å…ƒä¸ªæ•°æœ‰å…³ï¼Œåœ°å€çº¿20æ ¹ï¼Œåˆ™å¯¹åº”çš„å­˜å‚¨å•å…ƒä¸ªæ•°ä¸º2^20</li>\n<li>æ§åˆ¶æ€»çº¿ï¼šå‘å‡ºå„ç§æ§åˆ¶ä¿¡å·çš„ä¼ è¾“çº¿ï¼Œä»»ä¸€æ§åˆ¶çº¿çš„ä¼ è¾“éƒ½æ˜¯å•å‘çš„ï¼Œå¯ä»¥ç›‘è§†ä¸åŒç»„ä»¶ä¹‹é—´çš„çŠ¶æ€ï¼ˆå°±ç»ªã€æœªå°±ç»ªï¼‰ã€‚æ§åˆ¶ä¿¡å·ç»ç”±æ§åˆ¶æ€»çº¿ä»ä¸€ä¸ªç»„ä»¶å‘é€ç»™å¦å¤–ä¸€ä¸ªç»„ä»¶ï¼Œå¸¸è§æ§åˆ¶ä¿¡å·å¦‚ä¸‹ï¼š\n<ul>\n<li>æ—¶é’Ÿï¼šåŒæ­¥å„ç§æ“ä½œ</li>\n<li>å¤ä½ï¼šåˆå§‹åŒ–æ‰€æœ‰éƒ¨ä»¶</li>\n<li>æ€»çº¿è¯·æ±‚ï¼šè¡¨ç¤ºæŸéƒ¨ä»¶éœ€è¦è·å¾—æ€»çº¿ä½¿ç”¨æƒ</li>\n<li>æ€»çº¿å…è®¸ï¼šè¡¨ç¤ºéœ€è¦è·å¾—æ€»çº¿ä½¿ç”¨æƒçš„éƒ¨ä»¶å·²è·å¾—äº†æ§åˆ¶æƒ</li>\n<li>ä¸­æ–­è¯·æ±‚ï¼šè¡¨ç¤ºæŸéƒ¨ä»¶æå‡ºä¸­æ–­è¯·æ±‚</li>\n<li>å­˜å‚¨å™¨å†™ï¼šå°†æ•°æ®æ€»çº¿ä¸Šçš„æ•°æ®å†™è‡³å­˜å‚¨å™¨çš„æŒ‡å®šåœ°å€å•å…ƒå†…</li>\n<li>å­˜å‚¨å™¨è¯»ï¼šå°†æŒ‡å®šå­˜å‚¨å•å…ƒä¸­çš„æ•°æ®è¯»åˆ°æ•°æ®æ€»çº¿ä¸Š</li>\n<li>I/Oè¯»ï¼šä»æŒ‡å®šçš„I/Oç«¯å£å°†æ•°æ®è¯»åˆ°æ•°æ®æ€»çº¿ä¸Š</li>\n<li>I/Oå†™ï¼šå°†æ•°æ®æ€»çº¿ä¸Šçš„æ•°æ®è¾“å‡ºåˆ°æŒ‡å®šçš„I/Oç«¯å£å†…</li>\n<li>ä¼ è¾“å“åº”ï¼šè¡¨ç¤ºæ•°æ®å·²è¢«æ¥æ”¶ï¼Œæˆ–å·²å°†æ•°æ®ä¼ é€è‡³æ•°æ®æ€»çº¿ä¸Š</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é€šä¿¡æ€»çº¿ï¼šç”¨äºè®¡ç®—æœºç³»ç»Ÿä¹‹é—´æˆ–è®¡ç®—æœºç³»ç»Ÿä¸å…¶ä»–ç³»ç»Ÿä¹‹é—´ï¼ˆæ§åˆ¶ä»ªè¡¨ã€ç§»åŠ¨é€šä¿¡ç­‰ï¼‰çš„é€šä¿¡ã€‚æŒ‰ä¼ è¾“æ–¹å¼åˆ†\n<ul>\n<li>ä¸²è¡Œé€šä¿¡ï¼šæ•°æ®åœ¨å•æ¡1ä½å®½çš„ä¼ è¾“çº¿ä¸Šï¼Œä¸€ä½ä¸€ä½åœ°æŒ‰é¡ºåºåˆ†æ—¶ä¼ é€ï¼Œå¦‚1å­—èŠ‚çš„æ•°æ®ï¼Œåœ¨ä¸²è¡Œä¼ é€ä¸­ï¼Œéœ€è¦é€šè¿‡ä¸€æ¡ä¼ è¾“çº¿åˆ†8æ¬¡ç”±åœ°ä½åˆ°é«˜ä½æŒ‰é¡ºåºé€ä½ä¼ é€ï¼Œé€‚å®œäºè¿œè·ç¦»ä¼ é€ï¼Œä»å‡ ç±³åˆ°è¾¾æ•°åƒå…¬é‡Œ</li>\n<li>å¹¶è¡Œé€šä¿¡ï¼šæ•°æ®åœ¨å¤šæ¡ä¸€ä½å®½çš„ä¼ è¾“çº¿ä¸Šï¼ŒåŒæ—¶æœ‰æºä¼ é€åˆ°ç›®çš„åœ°ï¼Œå¦‚1å­—èŠ‚çš„æ•°æ®ï¼Œåœ¨å¹¶è¡Œä¼ é€ä¸­ï¼Œè¦é€šè¿‡8æ¡å¹¶è¡Œä¼ è¾“çº¿åŒæ—¶ç”±æºä¼ é€åˆ°ç›®çš„åœ°ã€‚é€‚å®œè¿‘è·ç¦»æ•°æ®ä¼ è¾“ï¼Œå°äº30m</li>\n<li>éƒ½ä¸è·ç¦»æˆåæ¯”ï¼Œä¸²è¡Œé€šä¿¡è´¹ç”¨ä½</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>3.3. æ€»çº¿æ€§èƒ½æŒ‡æ ‡</h2>\n<ul>\n<li>æ€»çº¿å®½åº¦ï¼šæ€»çº¿çš„æ ¹æ•°ï¼Œç”¨bitï¼ˆä½ï¼‰è¡¨ç¤ºï¼Œ8ã€16ã€32ã€64ä½ï¼ˆå³8ã€16ã€32ã€64æ ¹ï¼‰</li>\n<li>æ€»çº¿å¸¦å®½ï¼šæ€»çº¿çš„ä¼ è¾“é€Ÿç‡ï¼Œå•ä½æ—¶é—´å†…æ€»çº¿ä¸Šä¼ è¾“æ•°æ®çš„ä½æ•°ï¼Œé€šå¸¸ç”¨æ¯ç§’ä¼ è¾“çš„å­—èŠ‚æ•°MBpsï¼ˆå…†å­—èŠ‚æ¯ç§’ï¼‰è¡¨ç¤ºï¼Œä¾‹å¦‚ï¼Œæ€»çº¿å·¥ä½œé¢‘ç‡ä¸º33MHzï¼Œæ€»çº¿å®½åº¦ä¸º32ä½ï¼ˆ4Bï¼‰ï¼Œåˆ™æ€»çº¿å¸¦å®½ä¸º33 x ï¼ˆ32ï¼‰Ã· 8 = 132MBps</li>\n<li>æ—¶é’ŸåŒæ­¥/å¼‚æ­¥ï¼šæ€»çº¿ä¸Šçš„æ•°æ®ä¸æ—¶é’ŸåŒæ­¥å·¥ä½œçš„æ€»çº¿ç§°ä¸ºåŒæ­¥æ€»çº¿ï¼Œä¸æ—¶é’Ÿä¸åŒæ­¥å·¥ä½œçš„æ€»çº¿ç§°ä¸ºå¼‚æ­¥æ€»çº¿</li>\n<li>æ€»çº¿å¤ç”¨ï¼šä¸€æ¡ä¿¡å·çº¿ä¸Šåˆ†æ—¶ä¼ é€ä¸¤ç§ä¿¡å·ï¼Œç‰©ç†ä¸Šå°†åœ°å€æ€»çº¿å’Œæ•°æ®æ€»çº¿å…±ç”¨ä¸€ç»„ç‰©ç†çº¿è·¯ã€‚åˆ†æ—¶ä¼ è¾“åœ°å€ä¿¡å·å’Œæ•°æ®ä¿¡å·</li>\n<li>ä¿¡å·çº¿æ•°ï¼šåœ°å€ã€æ•°æ®ã€æ§åˆ¶æ€»çº¿ä¸‰ç§æ€»çº¿æ•°æ€»å’Œ</li>\n<li>æ€»çº¿æ§åˆ¶æ–¹å¼:åŒ…æ‹¬çªå‘å·¥ä½œï¼Œè‡ªåŠ¨é…ç½®ï¼Œä»²è£æ–¹å¼ï¼Œé€»è¾‘æ–¹å¼ï¼Œè®¡æ•°æ–¹å¼ç­‰</li>\n<li>è´Ÿè½½èƒ½åŠ›ï¼šå½“æ€»çº¿æ¥ä¸Šè´Ÿè½½åï¼Œæ€»çº¿è¾“å…¥è¾“å‡ºçš„é€»è¾‘ç”µå¹³æ˜¯å¦èƒ½ä¿æŒåœ¨æ­£å¸¸çš„é¢å®šèŒƒå›´å†…ï¼Œé€šå¸¸ç”¨å¯è¿æ¥æ‰©å¢ç”µè·¯æ¿æ•°ååº”æ€»çº¿çš„è´Ÿè½½èƒ½åŠ›</li>\n<li>å…¶ä»–æŒ‡æ ‡ï¼šç”µæºç”µå‹ã€æ€»çº¿å®½åº¦æ˜¯å¦èƒ½æ‰©å±•ç­‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/60609ac2bc8b113115b76.png\" alt=\"13.png\"></li>\n</ul>\n<h2>3.4. æ€»çº¿æ ‡å‡†</h2>\n<ul>\n<li>ç³»ç»Ÿä¸å„æ¨¡å—ã€æ¨¡å—ä¸æ¨¡å—ä¹‹é—´çš„ä¸€ä¸ªäº’è¿çš„æ ‡å‡†ç•Œé¢ã€‚ç•Œé¢å¯¹å®ƒä¸¤ç«¯çš„æ¨¡å—éƒ½æ˜¯é€æ˜çš„ï¼Œç•Œé¢çš„ä»»ä¸€æ–¹åªéœ€æ ¹æ®æ€»çº¿æ ‡å‡†çš„è¦æ±‚å®Œæˆè‡ªèº«ä¸€æ–¹çš„åŠŸèƒ½è¦æ±‚ï¼Œ æ— éœ€äº†è§£å¯¹æ–¹æ¥å£ä¸æ€»çº¿çš„è¿æ¥è¦æ±‚ï¼ŒæŒ‰æ€»çº¿è®¾è®¡çš„æ¥å£å¯è§†ä¸ºé€šç”¨æ¥å£</li>\n<li>æµè¡Œçš„æ€»çº¿æ ‡å‡†ï¼šISAæ€»çº¿ã€EISAæ€»çº¿ã€VESAæ€»çº¿ã€PCIæ€»çº¿å¸¸ç”¨ã€AGPæ€»çº¿ï¼ˆæ˜¾å¡ï¼‰ã€RS-232Cæ€»çº¿ã€USBæ€»çº¿(Universal Serial Bus)</li>\n</ul>\n<h2>3.5. æ€»çº¿æ§åˆ¶</h2>\n<ul>\n<li>\n<p>æ€»çº¿åˆ¤ä¼˜æ§åˆ¶ï¼š</p>\n<ul>\n<li>æ€»çº¿ä¸Šæ‰€è¿æ¥çš„è®¾å¤‡ï¼ŒæŒ‰å…¶å¯¹æ€»çº¿æœ‰æ— æ§åˆ¶èƒ½åŠ›å¯åˆ†ä¸ºä¸»è®¾å¤‡ï¼ˆæ¨¡å—ï¼‰å’Œä»è®¾å¤‡ï¼ˆè®¾å¤‡ï¼‰</li>\n<li>ä¸»è®¾å¤‡å¯¹æ€»çº¿æœ‰æ§åˆ¶æƒï¼Œä»è®¾å¤‡åªèƒ½å“åº”ä»ä¸»è®¾å¤‡å‘è¿‡æ¥çš„æ€»çº¿å‘½ä»¤ï¼Œå¯¹æ€»çº¿æ— æ§åˆ¶æƒ</li>\n<li>æ€»çº¿ä¸Šçš„ä¿¡æ¯ä¼ é€æ˜¯ç”±ä¸»è®¾å¤‡å¯åŠ¨çš„ï¼Œç”±ä¸»è®¾å¤‡å‘é€æ€»çº¿è¯·æ±‚ä¿¡å·</li>\n<li>è‹¥å¤šä¸ªä¸»è®¾å¤‡åŒæ—¶ä½¿ç”¨æ€»çº¿ï¼Œåˆ™ç”±æ€»çº¿æ§åˆ¶å™¨çš„åˆ¤ä¼˜ã€ä»²è£é€»è¾‘æŒ‰ä¸€å®šçš„ä¼˜å…ˆç­‰çº§é¡ºåºç¡®å®šå“ªä¸ªè®¾å¤‡èƒ½ä½¿ç”¨æ€»çº¿ï¼Œåªæœ‰è·å¾—æ€»çº¿ä½¿ç”¨æƒçš„ä¸»è®¾å¤‡æ‰èƒ½å¼€å§‹ä¼ é€æ•°æ®</li>\n</ul>\n</li>\n<li>\n<p>æ€»çº¿åˆ¤ä¼˜æ§åˆ¶åˆ†ç±»</p>\n<ul>\n<li>é›†ä¸­æ§åˆ¶ä¼˜å…ˆæƒä»²è£æ–¹å¼ï¼šå°†æ§åˆ¶é€»è¾‘é›†ä¸­åœ¨ä¸€å¤„ï¼ˆå¦‚CPUï¼‰\n<ul>\n<li>é“¾å¼æŸ¥è¯¢ï¼š\n<ul>\n<li>ç”¨ä¸‰æ ¹çº¿æ€»çº¿æ§åˆ¶ï¼ˆBSæ€»çº¿å¿™ã€BRæ€»çº¿è¯·æ±‚ã€BGæ€»çº¿åŒæ„ï¼‰ï¼Œå…¶ä¸­æ€»çº¿åŒæ„ä¿¡å·BGæ˜¯ä¸²è¡Œåœ°ä»ä¸€ä¸ªI/Oæ¥å£é€åˆ°ä¸‹ä¸€ä¸ªI/æ¥å£ã€‚å¦‚æœBGåˆ°è¾¾çš„æ¥å£æœ‰æ€»çº¿è¯·æ±‚ï¼ŒBGä¿¡å·å°±ä¸å†å¾€ä¸‹ä¼ ï¼Œè¯¥æ¥å£è·å¾—æ€»çº¿ä½¿ç”¨æƒï¼Œå¹¶å»ºç«‹æ€»çº¿å¿™BSä¿¡å·ï¼Œè¡¨ç¤ºå®ƒå ç”¨äº†æ€»çº¿ã€‚ç¦»æ€»çº¿æ§åˆ¶éƒ¨ä»¶æœ€è¿‘çš„è®¾å¤‡å…·æœ‰æœ€é«˜çš„ä¼˜å…ˆçº§ã€‚</li>\n<li>ç”µè·¯å¤æ‚åº¦ä½ï¼Œæ§åˆ¶çº¿å°‘ï¼Œä»²è£æ–¹å¼ç®€å•ï¼Œå®¹æ˜“æ‰©å……è®¾å¤‡ã€‚</li>\n<li>ä¼˜å…ˆçº§ä½çš„è®¾å¤‡éš¾ä»¥è·å¾—æ€»çº¿ä½¿ç”¨æƒï¼Œå¯¹ç”µè·¯æ•…éšœæ•æ„Ÿ</li>\n<li>ä»…ç”¨2æ ¹çº¿ç¡®å®šæ€»çº¿ä½¿ç”¨æƒå±äºå“ªä¸ªè®¾å¤‡(nä¸ºå…è®¸æ¥çº³çš„æœ€å¤§è®¾å¤‡æ•°)</li>\n</ul>\n</li>\n<li>è®¡æ—¶å™¨å®šæ—¶æŸ¥è¯¢\n<ul>\n<li>ç›¸æ¯”é“¾å¼æŸ¥è¯¢å¤šäº†è®¾å¤‡åœ°å€çº¿ï¼Œå°‘äº†æ€»çº¿åŒæ„çº¿BG</li>\n<li>æ€»çº¿æ§åˆ¶å™¨æ¥æ”¶åˆ°BRé€æ¥çš„æ€»çº¿è¯·æ±‚ä¿¡å·åï¼Œåœ¨æ€»çº¿æœªè¢«ä½¿ç”¨ï¼ˆBS=0ï¼‰çš„æƒ…å†µä¸‹ï¼Œæ€»çº¿æ§åˆ¶éƒ¨ä»¶ä¸­çš„è®¡æ•°å™¨å¼€å§‹è®¡æ•°ï¼Œå¹¶é€šè¿‡è®¾å¤‡åœ°å€æ€»çº¿ï¼Œå‘å„è®¾å¤‡å‘å‡ºä¸€ç»„åœ°å€ä¿¡å·ã€‚å½“æŸä¸ªè¯·æ±‚çš„å ç”¨çš„è®¾å¤‡åœ°å€ä¸è®¡æ•°å€¼ä¸€è‡´æ—¶ï¼Œä¾¿è·å¾—æ€»çº¿ä½¿ç”¨æƒï¼Œæ­¤æ—¶ç»ˆæ­¢è®¡æ•°æŸ¥è¯¢</li>\n<li>è®¡æ•°å¯ä»¥ä»0å¼€å§‹ï¼Œæ­¤æ—¶ä¸€æ—¦è®¾å¤‡çš„ä¼˜å…ˆæ¬¡åºè¢«å›ºå®šï¼Œè®¾å¤‡çš„ä¼˜å…ˆçº§å°±æŒ‰0-né¡ºåºæ’åºï¼Œå›ºå®šä¸å˜ï¼›è®¡æ•°å¯ä»¥ä»ä¸Šä¸€æ¬¡è®¡æ•°çš„ç»ˆæ­¢ç‚¹å¼€å§‹ï¼Œæ˜¯ä¸€ç§å¾ªç¯çš„æ–¹æ³•ï¼Œæ­¤æ—¶è®¾å¤‡ä½¿ç”¨æ€»çº¿çš„ä¼˜å…ˆçº§ç›¸ç­‰ï¼›è®¡æ•°çš„åˆå§‹å€¼å¯ä»¥ç”±ç¨‹åºè®¾ç½®ï¼Œæ•…ä¼˜å…ˆæ¬¡åºå¯ä»¥æ”¹å˜</li>\n<li>è®¾å¤‡çš„ä¼˜å…ˆçº§å¯ä»¥æ”¹å˜ã€‚ç”µè·¯æ•…éšœæ•æ„Ÿæ€§é™ä½</li>\n<li>æ§åˆ¶å¤æ‚ï¼Œå¢åŠ äº†æ§åˆ¶çº¿æ•°</li>\n<li>ä½¿ç”¨log2næ ¹çº¿ç¡®å®šæ€»çº¿ä½¿ç”¨æƒå±äºå“ªä¸ªè®¾å¤‡(nä¸ºå…è®¸æ¥çº³çš„æœ€å¤§è®¾å¤‡æ•°)</li>\n</ul>\n</li>\n<li>ç‹¬ç«‹è¯·æ±‚\n<ul>\n<li>æ¯å°è®¾å¤‡å‡æœ‰ä¸€å¯¹æ€»çº¿è¯·æ±‚çº¿BRå’Œæ€»çº¿åŒæ„çº¿BGã€‚æ€»çº¿æ§åˆ¶éƒ¨ä»¶ä¸­æœ‰ä¸€æ’é˜Ÿç”µè·¯ï¼Œå¯æ ¹æ®ä¼˜å…ˆæ¬¡åºç¡®å®šå“åº”é‚£ä¸€å°è®¾å¤‡çš„è¯·æ±‚ã€‚</li>\n<li>å¥½å¤„ï¼šå“åº”é€Ÿåº¦å¿«ï¼Œä¼˜å…ˆé¡ºåºæ§åˆ¶çµæ´»ã€</li>\n<li>åå¤„ï¼šæ§åˆ¶çº¿æ•°é‡å¤šï¼Œæ€»çº¿æ§åˆ¶å¤æ‚</li>\n<li>ä½¿ç”¨2næ ¹çº¿ç¡®å®šæ€»çº¿ä½¿ç”¨æƒå±äºå“ªä¸ªè®¾å¤‡(nä¸ºå…è®¸æ¥çº³çš„æœ€å¤§è®¾å¤‡æ•°)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>åˆ†å¸ƒå¼ï¼šå°†æ§åˆ¶é€»è¾‘åˆ†æ•£åœ¨ä¸æ€»çº¿è¿æ¥çš„å„ä¸ªéƒ¨ä»¶æˆ–è®¾å¤‡ä¸Š<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1bb119fee9de6648cc32e.png\" alt=\"22.png\"></li>\n</ul>\n</li>\n<li>\n<p>æ€»çº¿é€šä¿¡æ§åˆ¶</p>\n<ul>\n<li>æ€»çº¿é€šä¿¡æ§åˆ¶è§£å†³é€šä¿¡åŒæ–¹å¦‚ä½•è·çŸ¥ä¼ è¾“å¼€å§‹å’Œä¼ è¾“ç»“æŸï¼Œä»¥åŠé€šä¿¡åŒæ–¹å¦‚ä½•åè°ƒé…åˆ</li>\n<li>æ€»çº¿å‘¨æœŸ:å®Œæˆä¸€æ¬¡æ€»çº¿æ“ä½œçš„æ—¶é—´\n<ul>\n<li>ç”³è¯·åˆ†é…é˜¶æ®µï¼šç”±éœ€è¦ä½¿ç”¨æ€»çº¿çš„ä¸»è®¾å¤‡å‘å‡ºç”³è¯·ï¼Œç»æ€»çº¿ä»²è£è®°è¿‡å†³å®šä¸‹ä¸€ä¼ è¾“å‘¨æœŸçš„æ€»çº¿ä½¿ç”¨æƒæˆäºˆæŸä¸€ç”³è¯·è€…</li>\n<li>å¯»å€é˜¶æ®µï¼šå–å¾—äº†ä½¿ç”¨æƒçš„ä¸»æ¨¡å—é€šè¿‡æ€»çº¿å‘å‡ºæœ¬æ¬¡è¦è®¿é—®çš„ä»æ¨¡å—çš„åœ°å€åŠæœ‰å…³å‘½ä»¤ï¼Œå¯åŠ¨å‚ä¸æœ¬æ¬¡ä¼ è¾“çš„ä»æ¨¡å—</li>\n<li>ä¼ æ•°é˜¶æ®µï¼šä¸»æ¨¡å—å’Œä»æ¨¡å—è¿›è¡Œæ•°æ®äº¤æ¢ï¼Œæ•°æ®æœ‰æºæ¨¡å—å‘å‡ºï¼Œç»æ•°æ®æ€»çº¿æµå…¥ç›®çš„æ¨¡å—</li>\n<li>ç»“æŸé˜¶æ®µï¼šä¸»æ¨¡å—çš„æœ‰å…³ä¿¡æ¯ä»ç³»ç»Ÿæ€»çº¿ä¸Šæ’¤é™¤ï¼Œè®©å‡ºæ€»çº¿ä½¿ç”¨æƒ</li>\n</ul>\n</li>\n<li>é€šä¿¡æ–¹å¼\n<ul>\n<li>åŒæ­¥é€šä¿¡ï¼šé€šä¿¡åŒæ–¹ç”±ç»Ÿä¸€æ—¶æ ‡æ§åˆ¶æ•°æ®ä¼ é€ï¼Œæ—¶æ ‡é€šå¸¸ç”±CPUçš„æ€»çº¿æ§åˆ¶éƒ¨ä»¶å‘å‡ºï¼Œé€åˆ°æ€»çº¿ä¸Šçš„æ‰€æœ‰éƒ¨ä»¶ï¼Œä¹Ÿå¯ä»¥ç”±æ¯ä¸ªéƒ¨ä»¶å„è‡ªçš„æ—¶åºå‘é€å™¨å‘å‡ºï¼Œä½†å¿…é¡»ç”±æ€»çº¿æ§åˆ¶éƒ¨ä»¶å‘å‡ºçš„æ—¶é’Ÿä¿¡å·å¯¹ä»–ä»¬è¿›è¡ŒåŒæ­¥\n<ul>\n<li>ä¼˜ç¼ºç‚¹ï¼šè§„å®šæ˜ç¡®ã€ç»Ÿä¸€ï¼Œå„æ¨¡å—çš„é…åˆç®€å•ä¸€ä¸€è‡´ï¼›å¯¹ä¸åŒé€Ÿåº¦çš„éƒ¨ä»¶è€Œè¨€ï¼Œå¿…é¡»æŒ‰æœ€æ…¢çš„é€Ÿåº¦çš„éƒ¨ä»¶è®¾è®¡å…¬å…±æ—¶é’Ÿï¼Œä¸¥é‡å½±å“æ€»çº¿å·¥ä½œæ•ˆç‡ï¼Œç¼ºä¹çµæ´»æ€§</li>\n<li>é€‚ç”¨äºæ€»çº¿é•¿åº¦çŸ­ã€å„éƒ¨ä»¶å­˜å–æ—¶é—´æ¯”è¾ƒä¸€è‡´çš„åœºåˆ</li>\n</ul>\n</li>\n<li>å¼‚æ­¥é€šä¿¡\n<ul>\n<li>å…è®¸å„æ¨¡å—é€Ÿåº¦ä¸ä¸€è‡´ï¼Œæ²¡æœ‰å…¬å…±çš„æ—¶é’Ÿæ ‡å‡†ï¼Œä¸è¦æ±‚æ‰€æœ‰éƒ¨ä»¶ä¸¥æ ¼çš„åŒä¸€æ“ä½œæ—¶é—´</li>\n<li>é‡‡ç”¨åº”ç­”ï¼ˆæ¡æ‰‹ï¼‰çš„æ–¹å¼ï¼Œå½“ä¸»æ¨¡å—å‘å‡ºè¯·æ±‚ä¿¡å·æ—¶ï¼Œä¸€ç›´ç­‰å¾…ä»æ¨¡å—åé¦ˆå›æ¥çš„å“åº”ä¿¡å·åæ‰å¼€å§‹é€šä¿¡ï¼Œè¦æ±‚ä¸»ä»æ¨¡å—ä¹‹é—´å¢åŠ ä¸¤æ¡åº”ç­”çº¿ï¼ˆæ¡æ‰‹äº¤äº’ä¿¡å·çº¿ï¼‰</li>\n<li>å¼‚æ­¥é€šä¿¡åº”ç­”æ–¹å¼(å¹¶è¡Œæˆ–ä¸²è¡Œä¼ é€)\n<ul>\n<li>ä¸äº’é”ï¼ˆCPUå‘ä¸»å­˜å†™ä¿¡æ¯ï¼‰ï¼šä¸»æ¨¡å—å‘å‡ºä¿¡å·åï¼Œä¸å¿…ç­‰å¾…æ¥åˆ°ä»æ¨¡å—çš„å›ç­”ä¿¡å·ï¼Œè€Œæ˜¯ç»è¿‡ä¸€æ®µæ—¶é—´ï¼Œç¡®è®¤ä»æ¨¡å—å·²æ”¶åˆ°è¯·æ±‚ä¿¡å·åï¼Œä¾¿æ’¤é”€å…¶è¯·æ±‚ä¿¡å·ï¼Œä»æ¨¡å—æ¥æ”¶åˆ°è¯·æ±‚ä¿¡å·åï¼Œåœ¨æ¡ä»¶å…è®¸æ—¶å‘å‡ºå›ç­”ä¿¡å·ï¼Œå¹¶ä¸”ç»è¿‡ä¸€æ®µæ—¶é—´ç¡®è®¤ä¸»æ¨¡å—æ”¶åˆ°å›ç­”ä¿¡å·åï¼Œè‡ªåŠ¨æ’¤é”€å›ç­”ä¿¡å·</li>\n<li>åŠäº’é”ï¼ˆå¤šæœºç³»ç»Ÿä¸­CPUè®¿é—®å…±äº«å­˜å‚¨å™¨ï¼‰ï¼šä¸»æ¨¡å—å‘å‡ºè¯·æ±‚ä¿¡å·åå¿…é¡»æ¥åˆ°ä»æ¨¡å—çš„å›ç­”ä¿¡å·æ‰æ’¤é”€å…¶è¯·æ±‚ä¿¡å·ã€‚ä»æ¨¡å—æ¥æ”¶åˆ°è¯·æ±‚ä¿¡å·åï¼Œä¸å¿…ç¡®è®¤ä¸»æ¨¡å—æ”¶åˆ°å›ç­”ä¿¡å·åï¼Œç»è¿‡ä¸€æ®µæ—¶é—´åè‡ªåŠ¨æ’¤é”€å›ç­”ä¿¡å·</li>\n<li>å…¨äº’é”ï¼ˆç½‘ç»œé€šä¿¡ï¼‰ï¼šä¸»æ¨¡å—å‘å‡ºè¯·æ±‚ä¿¡å·åå¿…é¡»æ¥åˆ°ä»æ¨¡å—çš„å›ç­”ä¿¡å·æ‰æ’¤é”€å…¶è¯·æ±‚ä¿¡å·ã€‚ä»æ¨¡å—å‘å‡ºåº”ç­”ä¿¡å·å¾…ä¸»æ¨¡å—è¯·æ±‚ä¿¡å·æ’¤é”€åï¼Œå†æ’¤é”€è¯·æ±‚ä¿¡å·<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/25a073dfb1519b145a517.png\" alt=\"23.png\"></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>åŠåŒæ­¥é€šä¿¡\n<ul>\n<li>ä¿ç•™äº†åŒæ­¥é€šä¿¡çš„åŸºæœ¬ç‰¹ç‚¹ï¼Œå¦‚æ‰€æœ‰çš„åœ°å€ã€å‘½ä»¤ã€æ•°æ®ä¿¡å·çš„å‘å‡ºæ—¶é—´ï¼Œéƒ½ä¸¥æ ¼å‚ç…§ç³»ç»Ÿæ—¶é’Ÿçš„æŸä¸ªå‰æ²¿å¼€å§‹ã€‚è€Œæ¥æ”¶æ–¹éƒ½é‡‡ç”¨ç³»ç»Ÿæ—¶é—´åæ²¿æ—¶åˆ»æ¥è¿›è¡Œåˆ¤æ–­è¯†åˆ«ï¼ŒåŒæ—¶åƒå¼‚æ­¥é€šä¿¡ï¼Œå…è®¸ä¸åŒé€Ÿåº¦çš„æ¨¡å—å’Œè°å·¥ä½œã€å¢è®¾ä¸€æ¡WAITå“åº”ä¿¡å·çº¿ï¼Œé‡‡ç”¨æ’å…¥æ—¶é’Ÿï¼ˆç­‰å¾…ï¼‰å‘¨æœŸçš„æªæ–½æ¥åè°ƒé€šä¿¡åŒæ–¹çš„é…åˆé—®é¢˜</li>\n<li>ä¼˜ç¼ºç‚¹ï¼šæ¯”å¼‚æ­¥é€šä¿¡ç®€å•ã€‚å…¨ç³»ç»Ÿå†…å„æ¨¡å—åœ¨ç»Ÿä¸€ç³»ç»Ÿæ—¶é’Ÿæ§åˆ¶ä¸‹åŒæ­¥å·¥ä½œï¼Œå¯é æ€§é«˜ï¼ŒåŒæ­¥ç»“æ„æ–¹ä¾¿</li>\n<li>ç¼ºç‚¹ï¼šå¯¹ç³»ç»Ÿæ—¶é’Ÿé¢‘ç‡ä¸èƒ½è¦æ±‚å¤ªé«˜ï¼Œç³»ç»Ÿå·¥ä½œé€Ÿåº¦ä¸é«˜</li>\n</ul>\n</li>\n<li>åˆ†ç¦»å¼é€šä¿¡ï¼ˆå¤§å‹è®¡ç®—æœºï¼‰\n<ul>\n<li>å°†ä¸€ä¸ªä¼ è¾“å‘¨æœŸ/æ€»çº¿å‘¨æœŸåˆ†è§£ä¸ºä¸¤ä¸ªå­å‘¨æœŸï¼›ç¬¬ä¸€ä¸ªå­å‘¨æœŸï¼Œä¸»æ¨¡å—Aç”³è¯·å¹¶è·å¾—æ€»çº¿ä½¿ç”¨æƒåï¼Œå°†æ•°æ®ä¼ è¾“åˆ°æ€»çº¿ä¸Šï¼Œå¹¶æ”¾å¼ƒæ€»çº¿ä½¿ç”¨æƒï¼›ç¬¬äºŒä¸ªå­å‘¨æœŸï¼Œä»æ¨¡å—Bæ¥æ”¶åˆ°ä¸»æ¨¡å—å‘æ¥çš„ä¿¡å·åï¼Œå‡†å¤‡å¥½ä¼ è¾“æ•°æ®åæ‰ç”³è¯·å¹¶è·å¾—æ€»çº¿ä½¿ç”¨æƒï¼Œå°†æ•°æ®ä¼ è¾“ç»™ä¸»æ¨¡å—Aï¼Œå¹¶æ”¾å¼ƒæ€»çº¿ä½¿ç”¨æƒ</li>\n<li>ç‰¹ç‚¹\n<ul>\n<li>å„æ¨¡å—éƒ½å˜æˆä¸»æ¨¡å—éƒ½è¦æå‡ºç”³è¯·å ç”¨æ€»çº¿ä½¿ç”¨æƒ</li>\n<li>åœ¨å¾—åˆ°æ€»çº¿ä½¿ç”¨æƒåï¼Œä¸»æ¨¡å—åœ¨é™å®šçš„æ—¶é—´å†…æƒ³å¯¹æ–¹ä¼ é€ä¿¡æ¯ï¼Œé‡‡ç”¨åŒæ­¥æ–¹å¼ä¼ é€ï¼Œä¸å†ç­‰å¾…å¯¹æ–¹çš„åº”ç­”ä¿¡å·</li>\n<li>å„æ¨¡å—åœ¨å‡†å¤‡æ•°æ®çš„è¿‡ç¨‹ä¸­ä¸å ç”¨æ€»çº¿ï¼Œä½¿æ€»çº¿å¯æ¥å—å…¶ä»–æ¨¡å—çš„è¯·æ±‚</li>\n<li>æ€»çº¿è¢«å ç”¨æ—¶ä¸å­˜åœ¨ç©ºé—²ç­‰å¾…æ—¶é—´ï¼Œå……åˆ†åˆ©ç”¨äº†æ€»çº¿çš„æœ‰æ•ˆå ç”¨ï¼Œå®ç°äº†æ€»çº¿åœ¨å¤šä¸ªä¸»ã€ä»æ¨¡å—ä¹‹é—´ä¿¡æ¯äº¤å‰é‡å å¹¶è¡Œå¼ä¼ é€<br>\n-ç¼ºç‚¹ï¼šæ§åˆ¶å¤æ‚ï¼Œæ™®é€šå¾®å‹è®¡ç®—æœºç³»ç»Ÿå¾ˆå°‘é‡‡ç”¨</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>4. å­˜å‚¨å™¨</h1>\n<h2>4.1. å­˜å‚¨ä»‹è´¨</h2>\n<ul>\n<li>èƒ½å¯„å­˜\"0\"ã€\"1\"ä¸¤ç§ä»£ç å¹¶èƒ½åŒºåˆ«ä¸¤ç§çŠ¶æ€çš„ç‰©è´¨æˆ–å…ƒå™¨ä»¶ï¼Œå­˜å‚¨ä»‹è´¨ä¸»è¦æœ‰åŠå¯¼ä½“å™¨ä»¶ã€ç£æ€§ææ–™å’Œå…‰ç›˜ç­‰</li>\n</ul>\n<h2>4.2. å­˜å‚¨å™¨çš„åˆ†ç±»</h2>\n<ul>\n<li>æŒ‰å­˜å‚¨ä»‹è´¨åˆ†ç±»\n<ul>\n<li>åŠå¯¼ä½“å­˜å‚¨å™¨ï¼šå­˜å‚¨å…ƒä»¶ç”±åŠå¯¼ä½“å™¨ä»¶ç»„æˆçš„å­˜å‚¨å™¨ï¼Œä¼˜ç‚¹ï¼šä½“ç§¯å°ã€åŠŸè€—ä½ã€å­˜å–æ—¶é—´çŸ­ï¼›ç¼ºç‚¹ï¼šæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼ˆç”µæºæ¶ˆå¤±æ—¶ï¼Œæ‰€å­˜ä¿¡æ¯éšå³ä¸¢å¤±ï¼‰å†…å­˜ã€Uç›˜ã€å›ºæ€ç¡¬ç›˜</li>\n<li>ç£è¡¨é¢å­˜å‚¨å™¨ï¼šåœ¨é‡‘å±æˆ–å¡‘æ–™è¡¨é¢ä¸Šæ¶‚ä¸€å±‚ç£æ€§ææ–™ä½œä¸ºè®°å½•ä»‹è´¨ï¼Œå·¥ä½œæ—¶ç£å±‚éšè½½ç£ä½“é«˜é€Ÿè¿è½¬ï¼Œç”¨ç£å¤´åœ¨ç£å±‚ä¸Šè¿›è¡Œè¯»/å†™æ“ä½œã€‚æŒ‰è½½ç£ä½“å½¢çŠ¶ä¸åŒåˆ†ï¼šç£ç›˜ã€ç£å¸¦ã€ç£é¼“ï¼ˆå°‘ç”¨ï¼‰ï¼Œå…·æœ‰çŸ©å½¢ç£æ»å›çº¿ç‰¹æ€§çš„ææ–™ä½œè¡¨é¢ç‰©è´¨ï¼Œå®ƒä»¬æŒ‰å…¶å‰©ç£çš„çŠ¶æ€ä¸åŒåŒºåˆ†0æˆ–è€…1ï¼Œè€Œä¸”å‰©ç£çŠ¶æ€ä¸ä¼šè½»æ˜“ä¸¢å¤±ï¼Œå±äºéæ˜“å¤±æ€§å­˜å‚¨å™¨</li>\n<li>ç£èŠ¯å­˜å‚¨å™¨ï¼šç”±ç¡¬ç£ææ–™åšæˆçš„ç¯çŠ¶å…ƒä»¶ï¼Œåœ¨ç£èŠ¯ä¸­ç©¿æœ‰é©±åŠ¨çº¿å’Œè¯»å‡ºçº¿ï¼Œä¾¿å¯ä»¥è¿›è¡Œè¯»/å†™æ“ä½œ(æ°¸ä¹…è®°å¿†å­˜å‚¨å™¨)ï¼Œå› ä¸ºä½“ç§¯å¤ªå¤§ï¼Œå·¥è‰ºå¤æ‚ã€åŠŸè€—å¤ªå¤§ä¸ç”¨äº†</li>\n<li>å…‰ç›˜å­˜å‚¨å™¨ï¼šåº”ç”¨æ¿€å…‰åœ¨è®°å½•ä»‹è´¨ï¼ˆç£å…‰ææ–™ä¸Šï¼‰è¿›è¡Œè¯»/å†™çš„å­˜å‚¨å™¨ï¼Œéæ˜“å¤±æ€§å­˜å‚¨å™¨ï¼›è€ç”¨æ€§å¥½ã€è®°å½•å¯†åº¦é«˜ã€å¯äº’æ¢æ€§å¼ºç‰¹ç‚¹ï¼Œå¸¸ç”¨</li>\n</ul>\n</li>\n<li>æŒ‰å­˜å‚¨æ–¹å¼åˆ†ç±»\n<ul>\n<li>éšæœºå­˜å‚¨å™¨ï¼ˆRAM Random Access Memoryä¸»å­˜ï¼‰:å¯è¯»å†™ï¼Œä»»ä½•ä¸€ä¸ªå­˜å‚¨å•å…ƒçš„å†…å®¹éƒ½å¯éšæœºå­˜å–ï¼Œå­˜å–æ—¶é—´ä¸å­˜å‚¨å•å…ƒçš„ç‰©ç†ä½ç½®æ— å…³ï¼Œåˆ†ä¸ºé™æ€RAMï¼ˆä»¥è§¦å‘å™¨åŸç†å¯„å­˜ä¿¡æ¯ï¼‰å’ŒåŠ¨æ€RAM(ä»¥ç”µå®¹æ”¾ç”µåŸç†å¯„å­˜ä¿¡æ¯ï¼Œæ¯éš”ä¸€æ®µæ—¶é—´åˆ·æ–°ä¸€æ¬¡)</li>\n<li>åªè¯»å­˜å‚¨å™¨ï¼ˆROM Read Only Memoryï¼‰ï¼šåªèƒ½å¯¹å­˜å‚¨çš„å†…å®¹è¯»å‡ºï¼Œä¸èƒ½å¯¹å…¶é‡æ–°å†™å…¥çš„å­˜å‚¨å™¨ã€‚é€šå¸¸å­˜æ”¾å›ºå®šä¸å˜çš„ç¨‹åºã€å¸¸æ•°å’Œæ±‰å­—å­—åº“ï¼Œç”šè‡³ç”¨äºæ“ä½œç³»ç»Ÿçš„å›ºåŒ–ã€‚ä¸éšæœºå­˜å‚¨å™¨å¯å…±åŒä½œä¸ºä¸»å­˜ä¸€éƒ¨åˆ†ï¼Œç»Ÿä¸€æ„æˆä¸»å­˜çš„åœ°å€åŸŸ</li>\n<li>ä¸²è¡Œè®¿é—®å­˜å‚¨å™¨ï¼ˆé¡ºåºå­˜å‚¨å™¨-ç£å¸¦å­˜å‚¨å™¨ï¼‰ï¼šå¯¹å­˜å‚¨å™¨è¯»å†™æ—¶ï¼Œåªèƒ½æŒ‰ç‰©ç†ä½ç½®å…ˆåé¡ºåºå¯»å€ï¼›ä¿¡æ¯ä½ç½®ä¸åŒï¼Œè¯»å†™æ—¶é—´ä¸åŒï¼Œå¦‚ç£å¸¦ã€ç£ç›˜</li>\n<li>ç›´æ¥å­˜å‚¨å™¨ï¼šéƒ¨åˆ†ä¸²è¡Œè®¿é—®çš„å­˜å‚¨å™¨ï¼ˆç£ç›˜ï¼‰ï¼šåœ¨å¯¹ç£ç›˜è¯»/å†™æ—¶ï¼Œé¦–å…ˆç›´æ¥æŒ‡å‡ºè¯¥å­˜å‚¨å™¨ä¸­çš„æŸä¸ªå°åŒºåŸŸï¼ˆç£é“ï¼‰ï¼Œç„¶åå†é¡ºåºå¯»è®¿ï¼Œç›´è‡³æ‰¾åˆ°ä½ç½®ã€‚æ•…å‰æ®µæ˜¯ç›´æ¥è®¿é—®ï¼Œåç«¯æ˜¯ä¸²è¡Œè®¿é—®</li>\n</ul>\n</li>\n<li>æŒ‰åœ¨è®¡ç®—æœºä¸­çš„ä½œç”¨åˆ†ç±»\n<ul>\n<li>ä¸»å­˜å‚¨å™¨ï¼ˆä¸»å­˜ï¼‰ï¼šå’ŒCPUç›´æ¥äº¤æ¢ä¿¡æ¯ï¼Œé€Ÿåº¦å¿«ï¼Œå®¹é‡å°ï¼Œæ¯ä½ä»·æ ¼é«˜</li>\n<li>è¾…åŠ©å­˜å‚¨å™¨ï¼ˆç£ç›˜ã€Uç›˜ã€å…‰ç›˜ã€ç£å¸¦ç­‰ï¼‰ï¼šå­˜æ”¾å½“å‰æš‚æ—¶ä¸ç”¨çš„ç¨‹åºå’Œæ•°æ®ï¼Œä¸èƒ½å’ŒCPUç›´æ¥äº¤æ¢ä¿¡æ¯ï¼Œé€Ÿåº¦æ…¢ï¼Œå®¹é‡å¤§ï¼Œæ¯ä½ä»·æ ¼ä½</li>\n<li>ç¼“å†²å­˜å‚¨å™¨ï¼ˆL1ã€L2ã€L3ç¼“å­˜ï¼ŒCPUå¯„å­˜å™¨ç­‰ï¼‰ï¼šç”¨åœ¨é€Ÿåº¦ä¸åŒçš„éƒ¨ä»¶ä¹‹ä¸­ï¼Œå¦‚CPUä¸ä¸»å­˜ä¹‹é—´å¯è®¾ç½®ä¸€ä¸ªå¿«é€Ÿç¼“å­˜<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/bc75707d79485b2dbb8b4.png\" alt=\"24.png\"></li>\n</ul>\n</li>\n</ul>\n<h2>4.3. å­˜å‚¨å™¨çš„å±‚æ¬¡ç»“æ„</h2>\n<ul>\n<li>å­˜å‚¨å™¨çš„æ€§èƒ½æŒ‡æ ‡ï¼šé€Ÿåº¦ã€å®¹é‡å’Œæ¯ä½ä»·æ ¼ï¼ˆä½ä»·ï¼‰</li>\n<li>å­˜å‚¨å™¨é€Ÿåº¦ã€å®¹é‡å’Œä½ä»·çš„å…³ç³»\n<ul>\n<li>ä½ä»·å’Œé€Ÿåº¦:è¾…å­˜ï¼ˆç£ç›˜ã€ç£å¸¦ï¼‰&lt;ä¸»å­˜&lt;ç¼“å­˜&lt;å¯„å­˜å™¨</li>\n<li>å®¹é‡:è¾…å­˜ï¼ˆç£ç›˜ã€ç£å¸¦ï¼‰&gt;ä¸»å­˜&gt;ç¼“å­˜&gt;å¯„å­˜å™¨</li>\n</ul>\n</li>\n<li>å¯„å­˜å™¨å’Œç¼“å­˜Cacheé€šå¸¸æ”¾åœ¨CPUä¸­ï¼Œå¯„å­˜å™¨ä¸­çš„æ•°ç›´æ¥åœ¨CPUå†…éƒ¨å‚ä¸è¿ç®—ï¼Œä¸»å­˜å­˜æ”¾å°†è¦å‚ä¸è¿è¡Œçš„ç¨‹åºå’Œæ•°æ®</li>\n<li>CPUï¼Œç¼“å­˜ï¼Œä¸»å­˜èƒ½ç›´æ¥äº¤ä¿¡æ¯ï¼ŒCPUä¸èƒ½ç›´æ¥è®¿é—®è¾…å­˜</li>\n</ul>\n<h2>4.4. å­˜å‚¨ç³»ç»Ÿå±‚æ¬¡ç»“æ„</h2>\n<ul>\n<li>ç¼“å­˜-ä¸»å­˜å±‚æ¬¡ï¼šåˆ©ç”¨å±€éƒ¨æ€§åŸç†è§£å†³CPUå’Œä¸»å­˜é€Ÿåº¦ä¸åŒ¹é…é—®é¢˜ï¼Œé€Ÿåº¦æ¥è¿‘äºç¼“å­˜ï¼Œå®¹é‡å’Œä½ä»·æ¥è¿‘ä¸»å­˜\n<ul>\n<li>åœ¨CPUä¸ä¸»å­˜ä¹‹é—´å¢åŠ ä¸€å±‚é€Ÿåº¦å¿«ï¼ˆå®¹é‡å°ï¼‰çš„Cache</li>\n<li>ç”±äºç¼“å­˜çš„é€Ÿåº¦æ¯”ä¸»å­˜çš„é€Ÿåº¦é«˜ï¼Œåªè¦å°†CPUè¿‘æœŸè¦ç”¨çš„ä¿¡æ¯è°ƒå…¥ç¼“å­˜ï¼ŒCPUä¾¿å¯ä»¥ç›´æ¥ä»ç¼“å­˜ä¸­è·å–ä¿¡æ¯ï¼Œä»è€Œæé«˜è®¿å­˜é€Ÿåº¦ï¼Œä½†ç”±äºç¼“å­˜å®¹é‡å°ï¼Œå› æ­¤éœ€ä¸æ–­åœ°å°†ä¸»å­˜çš„å†…å®¹è°ƒå…¥ç¼“å­˜ï¼Œä½¿ç¼“å­˜ä¸­åŸæ¥çš„ä¿¡æ¯è¢«æ›¿æ¢ï¼›ä¸»å­˜å’Œç¼“å­˜ä¹‹é—´æ•°æ®è°ƒåŠ¨æ˜¯ç”±ç¡¬ä»¶è‡ªåŠ¨å®Œæˆçš„ï¼Œå¯¹ç¨‹åºå‘˜é€æ˜</li>\n</ul>\n</li>\n<li>ä¸»å­˜-è¾…å­˜å±‚æ¬¡ï¼ˆè™šæ‹Ÿå­˜å‚¨ç³»ç»Ÿï¼‰åˆ©ç”¨å±€éƒ¨æ€§åŸç†è§£å†³å­˜å‚¨ç³»ç»Ÿçš„å®¹é‡é—®é¢˜ï¼Œé€Ÿåº¦æ¥è¿‘ä¸»å­˜ï¼Œå®¹é‡å’Œä½ä»·æ¥è¿‘è¾…å­˜\n<ul>\n<li>ä¸»å­˜ä¹‹å¤–å¢åŠ è¾…åŠ©å­˜å‚¨å™¨ï¼ˆç£ç›˜ã€sdå¡ã€Uç›˜ç­‰ï¼‰</li>\n<li>è¾…å­˜çš„é€Ÿåº¦æ¯”ä¸»å­˜ä½ï¼Œä½†æ˜¯å®¹é‡æ¯”ä¸»å­˜å¤§ï¼Œå¯ä»¥æš‚æ—¶å­˜æ”¾å¤§é‡æœªç”¨åˆ°çš„ä¿¡æ¯ã€‚å½“CPUéœ€è¦ç”¨åˆ°è¿™äº›ä¿¡æ¯æ—¶ï¼Œå°†è¾…å­˜çš„å†…å®¹è°ƒå…¥ä¸»å­˜ï¼Œä¾›CPIç›´æ¥è®¿é—®ã€‚ä¸»å­˜å’Œè¾…å­˜ä¹‹é—´çš„æ•°æ®è°ƒåŠ¨æ˜¯ç”±ç¡¬ä»¶å’Œæ“ä½œç³»ç»Ÿå…±åŒå®Œæˆçš„<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/345cff6c6aca5673b559d.png\" alt=\"25.png\"></li>\n</ul>\n</li>\n</ul>\n<h2>4.5. ä¸»å­˜å‚¨å™¨</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/487b251954b6e04569b6e.png\" alt=\"36.PNG\" tabindex=\"0\"><figcaption>36.PNG</figcaption></figure>\n<ul>\n<li>ä¸»å­˜ç”±åŠå¯¼ä½“é›†æˆç”µè·¯æ„æˆï¼Œé©±åŠ¨å™¨ã€è¯‘ç å™¨å’Œè¯»å†™ç”µè·¯å‡åˆ¶ä½œäºå­˜å‚¨èŠ¯ç‰‡ä¸­ï¼Œè€ŒMARå’ŒMDRåˆ¶ä½œåœ¨CPUèŠ¯ç‰‡å†…ã€‚å­˜å‚¨èŠ¯ç‰‡å’ŒCOUèŠ¯ç‰‡å¯é€šè¿‡æ€»çº¿è¿æ¥</li>\n<li>æ ¹æ®MARä¸­çš„åœ°å€è®¿é—®æŸä¸ªå­˜å‚¨å•å…ƒæ—¶ï¼Œè¿˜éœ€ç»è¿‡åœ°å€è¯‘ç ã€é©±åŠ¨ç­‰ç”µè·¯ï¼Œæ‰èƒ½æ‰¾åˆ°æ‰€éœ€è®¿é—®çš„å•å…ƒã€‚è¯»å‡ºæ—¶éœ€è¦ç»è¿‡è¯»å‡ºæ”¾å¤§å™¨ï¼Œæ‰èƒ½å°†è¢«é€‰ä¸­çš„å•å…ƒçš„å­˜å‚¨å­—é€åˆ°MDRã€‚å†™å…¥æ—¶ï¼ŒMDRä¸­çš„æ•°æ®ä¹Ÿå¿…é¡»ç»è¿‡å†™å…¥ç”µè·¯æ‰å›ŠçœŸæ­£å†™å…¥åˆ°è¢«é€‰ä¸­çš„å•å…ƒä¸­</li>\n<li>è¯»å†™è¿‡ç¨‹\n<ul>\n<li>å½“è¦ä»å­˜å‚¨å™¨è¯»å‡ºæŸä¸€ä¿¡æ¯å­—æ—¶ï¼Œé¦–å…ˆç”±CPUå°†è¯¥å­—çš„åœ°å€é€åˆ°MARã€‚ç»åœ°å€æ€»çº¿é€è‡³ä¸»å­˜ï¼Œç„¶åå‘å‡ºè¯»å‘½ä»¤ã€‚ä¸»å­˜æ¥åˆ°è¯»å‘½ä»¤åï¼Œå¾—çŸ¥éœ€å°†è¯¥åœ°å€å•å…ƒçš„å†…å®¹è¯»å‡ºï¼Œä¾¿å®Œæˆè¯»æ“ä½œï¼Œå°†è¯¥å•å…ƒçš„å†…å®¹è¯»è‡³æ•°æ®æ€»çº¿ä¸Šï¼Œç”±CPUå†³å®šç”±MDRé€åˆ°ä»€ä¹ˆåœ°æ–¹</li>\n<li>å½“è¦å‘ä¸»å­˜ä¸­å­˜å…¥ä¸€ä¸ªä¿¡æ¯å­—æ—¶ï¼Œé¦–å…ˆCPUå°†è¯¥å­—æ‰€åœ¨å­˜å‚¨å•å…ƒçš„åœ°å€ç»MARé€åˆ°åœ°å€æ€»çº¿ï¼Œå¹¶å°†ä¿¡æ¯å­—é€å…¥MDRï¼Œç„¶åå‘ä¸»å­˜å‘å‡ºå†™å‘½ä»¤ï¼Œä¸»å­˜æ¥åˆ°å†™å‘½ä»¤åï¼Œä¾¿å°†æ•°æ®çº¿ä¸Šçš„ä¿¡æ¯å†™å…¥åˆ°å¯¹åº”åœ°å€å…ˆæŒ‡å‡ºçš„ä¸»å­˜å•å…ƒä¸­</li>\n</ul>\n</li>\n<li>ä¸»å­˜ä¸­å­˜å‚¨å•å…ƒåœ°å€çš„åˆ†é…\n<ul>\n<li>ä¸»å­˜å„å­˜å‚¨å•å…ƒçš„ç©ºé—´ä½ç½®æ˜¯ç”±å•å…ƒåœ°å€å·æ¥è¡¨ç¤ºçš„ï¼Œè€Œåœ°å€æ€»çº¿æ˜¯ç”¨æ¥æŒ‡å‡ºå­˜å‚¨å•å…ƒåœ°å€å·çš„ï¼Œæ ¹æ®è¯¥åœ°å€å¯è¯»å‡ºæˆ–å†™å…¥ä¸€ä¸ªå­˜å‚¨å­—ã€‚è®¡ç®—æœºç³»ç»Ÿå¯ä»¥æŒ‰å­—å¯»å€ï¼Œä¹Ÿå¯ä»¥æŒ‰å­—èŠ‚å¯»å€</li>\n</ul>\n</li>\n<li>å­˜å‚¨ä½“ï¼šç”±è®¸å¤šå­˜å‚¨å•å…ƒç»„æˆ</li>\n<li>å­˜å‚¨å•å…ƒï¼šç”±è®¸å¤šå­˜å‚¨å…ƒä»¶ç»„æˆ,ä»¥8ä½äºŒè¿›åˆ¶ä½œä¸ºä¸€ä¸ªå­˜å‚¨å•å…ƒï¼Œä¹Ÿå°±æ˜¯ä¸€ä¸ªå­—èŠ‚ã€‚å­˜å‚¨å•å…ƒæœ‰ç¼–å·ï¼Œè¿™äº›ç¼–å·ç§°ä¸ºå­˜å‚¨å•å…ƒçš„åœ°å€å·ã€‚å­˜å‚¨å•å…ƒæŒ‰åœ°å€å¯»è®¿ã€‚è¿™äº›åœ°å€éƒ½æ˜¯äºŒè¿›åˆ¶çš„å½¢å¼ã€‚</li>\n<li>å­˜å‚¨å…ƒä»¶ï¼šå¯ä»¥å¯„å­˜ä¸€ä½äºŒè¿›åˆ¶ä»£ç 0/1</li>\n<li>å­—/å­˜å‚¨å­—/å­˜å‚¨å­—é•¿ï¼šä¸€ä¸ªå­˜å‚¨å•å…ƒå­˜å‚¨çš„äºŒè¿›åˆ¶ä»£ç ç»„åˆ/ä½æ•°ï¼ˆ8ã€16ã€32ä½ï¼‰ï¼Œ8ä½2è¿›åˆ¶æ•°è¡¨ç¤ºä¸€ä¸ªå­—èŠ‚ï¼Œå› æ­¤å­˜å‚¨å­—é•¿å–8çš„å€æ•°ï¼Œä¸»è¦çœ‹è®¡ç®—æœºä½æ•°</li>\n<li>å­—å—ï¼šå­˜å‚¨åœ¨è¿ç»­çš„å­˜å‚¨å•å…ƒä¸­è€Œè¢«çœ‹ä½œæ˜¯ä¸€ä¸ªå•å…ƒçš„ä¸€ç»„å­—ï¼ˆåŒ…å«å¤šä¸ªå­—ï¼‰</li>\n<li>å¤§å°å…³ç³»ï¼šå­˜å‚¨ä½“åŒ…æ‹¬å¤šä¸ªå­˜å‚¨å•å…ƒï¼Œä¸€ä¸ªå­˜å‚¨å•å…ƒåŒ…æ‹¬å¤šä¸ªå­˜å‚¨å…ƒä»¶ï¼Œä¸€ä¸ªå­˜å‚¨å…ƒä»¶èƒ½å¯„å­˜ä¸€ä½äºŒè¿›åˆ¶ç </li>\n<li>å­—èŠ‚åœ°å€ï¼šæ¯ä¸ªå­˜å‚¨å•å…ƒçš„åœ°å€ã€‚</li>\n<li>å­—åœ°å€ï¼šä¸€ä¸ªå­˜å‚¨å­—é•¿çš„å­˜å‚¨å•å…ƒåœ°å€ï¼Œå¯ä»¥æ˜¯é«˜ä½å­—èŠ‚åœ°å€æˆ–è€…åœ°ä½å­—èŠ‚åœ°å€ã€‚ä¸€ä¸ªå­—æœ‰nä½ï¼ˆ8ã€16ã€32ä½ï¼‰ï¼Œä¸€ä¸ªå­—å—å…±Bä¸ªå­—ï¼Œä¸»å­˜å…±Mä¸ªå­—å—ï¼Œä¸»å­˜æ€»å­—æ•° = B<em>Mï¼Œä¸»å­˜æ€»å®¹é‡ = B</em>M*32ï¼ˆbitsï¼‰ï¼Œå­—çš„åœ°å€ï¼šå‰mä½æŒ‡å®šå­—å—çš„åœ°å€ï¼Œåbä½æŒ‡å®šå­—åœ¨å­—å—ä¸­çš„åœ°å€ï¼Œåˆ™ 2^m = M ã€2^b=B</li>\n<li>ä¸»å­˜çš„æŠ€æœ¯æŒ‡æ ‡\n<ul>\n<li>å­˜å‚¨å®¹é‡ï¼šä¸»å­˜èƒ½å­˜æ”¾äºŒè¿›åˆ¶ä»£ç çš„æ€»ä½æ•°/å­—èŠ‚æ€»æ•°\n<ul>\n<li>å­˜å‚¨å®¹é‡ = å­˜å‚¨å•å…ƒä¸ªæ•° x å­˜å‚¨å­—é•¿ = å­˜å‚¨å•å…ƒä¸ªæ•° x å­˜å‚¨å­—é•¿ /8</li>\n<li>åœ°å€çº¿ä¸ºnæ ¹ï¼Œé‚£ä¹ˆå­˜å‚¨å•å…ƒä¸ªæ•°ä¸º2^næ ¹</li>\n</ul>\n</li>\n<li>å­˜å‚¨é€Ÿåº¦ï¼šç”¨å­˜å–æ—¶é—´å’Œå­˜å–å‘¨æœŸè¡¨ç¤º\n<ul>\n<li>å­˜å–æ—¶é—´(Memory Access Time)ï¼šå¯åŠ¨ä¸€æ¬¡å­˜å‚¨å™¨è¯»/å†™æ“ä½œåˆ°å®Œæˆè¯¥æ“ä½œæ‰€éœ€çš„å…¨éƒ¨æ—¶é—´\n<ul>\n<li>è¯»å‡ºæ—¶é—´ï¼šä»å­˜å‚¨å™¨æ”¶åˆ°æœ‰æ•ˆåœ°å€å¼€å§‹ï¼Œåˆ°äº§ç”Ÿæœ‰æ•ˆè¾“å‡ºæ‰€éœ€çš„å…¨éƒ¨æ—¶é—´</li>\n<li>å†™å…¥æ—¶é—´ï¼šä»å­˜å‚¨å™¨æ”¶åˆ°æœ‰æ•ˆåœ°å€å¼€å§‹ï¼Œåˆ°æ•°æ®å†™å…¥è¢«é€‰ä¸­å•å…ƒä¸ºæ­¢æ‰€éœ€çš„å…¨éƒ¨æ—¶é—´</li>\n</ul>\n</li>\n<li>å­˜å–å‘¨æœŸ(Memory Cycle Time)ï¼šå­˜å‚¨å™¨è¿›è¡Œè¿ç»­ä¸¤æ¬¡ç‹¬ç«‹çš„å­˜å‚¨å™¨æ“ä½œæ‰€éœ€çš„æœ€å°æ—¶é—´é—´éš”ï¼Œé€šå¸¸å­˜å–å‘¨æœŸå¤§äºå­˜å–æ—¶é—´</li>\n</ul>\n</li>\n<li>å­˜å‚¨å™¨å¸¦å®½ï¼šå•ä½æ—¶é—´å†…å­˜å‚¨å™¨å­˜å–çš„ä¿¡æ¯é‡ï¼Œå•ä½ç”¨å­—/ç§’æˆ–å­—èŠ‚/ç§’æˆ–å•ä½/ç§’è¡¨ç¤º.æé«˜å­˜å‚¨å¸¦å®½æªæ–½ï¼šç¼©çŸ­å­˜å–å‘¨æœŸã€å¢åŠ å­˜å‚¨å­—é•¿ã€å¢åŠ å­˜å‚¨ä½“</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6a4bdf735fe6b9defaff1.png\" alt=\"46.PNG\" tabindex=\"0\"><figcaption>46.PNG</figcaption></figure>\n<h2>4.6. å­˜å‚¨å™¨çš„æ ¡éªŒ(æ±‰æ˜ç )</h2>\n<ul>\n<li>æ±‰æ˜ç ï¼šä½¿ç”¨å¶æ ¡éªŒã€åˆ†ç»„æ ¡éªŒï¼Œåªæœ‰ä¸€ä½çº é”™èƒ½åŠ›\n<ul>\n<li>å¥‡æ ¡éªŒï¼šè¿™ä¸²åºåˆ—1çš„ä¸ªæ•°å¦‚æœä¸ºå¶æ•°åˆ™åœ¨å‰é¢åŠ ä¸ª1ï¼Œä½¿1çš„ä¸ªæ•°å˜æˆå¥‡æ•°ï¼Œå¦åˆ™åŠ 0ã€‚</li>\n<li>å¶æ ¡éªŒï¼šè¿™ä¸²åºåˆ—1çš„ä¸ªæ•°å¦‚æœä¸ºå¥‡æ•°åˆ™åœ¨å‰é¢åŠ ä¸ª1ï¼Œä½¿1çš„ä¸ªæ•°å˜æˆå¶æ•°ï¼Œå¦åˆ™åŠ 0ã€‚</li>\n<li>è®¾éœ€è¦æ£€æµ‹çš„äºŒè¿›åˆ¶ä»£ç ä¸ºnä½ï¼Œæ·»åŠ Kä½æ£€æµ‹ä½ï¼Œç»„æˆn+kä½çš„ä»£ç ï¼Œ</li>\n<li>å…¶ä¸­kæ»¡è¶³ï¼š2^k &gt;= n+k+1</li>\n<li>n+kä½ä»£ç ä»å·¦åˆ°å³ä¾æ¬¡ä¸º1,2,3,4,5...,n+kä½</li>\n<li>æ ¡éªŒä½å®‰æ’ä½ç½®ç¼–å·ï¼š1,2,4,8,...,2^(k-1)</li>\n<li>åˆ†ç»„ä¾æ®ï¼šp1 xxx1 p2 xx1x p3 x1xx p4 1xxxï¼ŒåŒä¸€æ ·æ ¼å¼çš„ä½æ•°çš„æ•°åˆ†æˆä¸€ç»„</li>\n<li>æ£€é”™ä¾æ®ï¼šæ¯ç»„é‡Œé¢â€œ1â€çš„ä¸ªæ•°ä¸ºå¶æ•°</li>\n<li>å‡ºé”™ä½ç½®: åˆ†ç»„ä»å¤§åˆ°å°ä»å·¦åˆ°å³æ’åºï¼Œå¤±è´¥çš„ç»„ä¸º1ï¼ŒæˆåŠŸçš„ç»„ä¸º0ï¼Œåˆ™ç»„æˆçš„äºŒè¿›åˆ¶æ•°å³ä¸ºå‡ºé”™çš„ä½ç½®</li>\n</ul>\n</li>\n<li>ä¸¾ä¾‹ï¼šåºåˆ—ä¸º1100\n<ol>\n<li>äºŒè¿›åˆ¶ä»£ç ä¸ºn=4ä½,æ ¹æ®2^k &gt;= n+k+1ç®—å‡ºk=3</li>\n<li>æ ¡éªŒä½å®‰æ’ä½ç½®ä¸º1,2,4ä¸‰ä¸ªä½ç½®</li>\n<li>4+3ä½ä»£ç ç¬¬1-7ä½ä»å·¦åˆ°å³ä¾æ¬¡ä¸º x1,x2,1,x3,1,0,0 å…¶ä¸­x1,x2,x3ä¸ºéœ€è¦æ·»åŠ çš„æ£€æµ‹ä½ï¼Œæš‚æ—¶æ²¡ç®—å‡ºæ¥æ˜¯å¤šå°‘</li>\n<li>å°†åŒæ ·æ ¼å¼çš„ç¬¬å‡ ä½æ”¾ä¸€èµ·åˆ†æˆä¸‰ç»„ï¼š<br>\n4.1 ç¬¬ä¸€ç»„(<strong>1)=&gt;ç¬¬1,3,5,7(x1,1,1,0)ä½ 1çš„ä¸ªæ•°ä¸ºå¥‡æ•°ï¼Œå› æ­¤x1=0<br>\n4.2 ç¬¬äºŒç»„(<em>1</em>)=&gt;ç¬¬2,3,6,7(x2,1,0,0)ä½,1çš„ä¸ªæ•°ä¸ºå¶æ•°ï¼Œå› æ­¤x2=1<br>\n4.3 ç¬¬ä¸‰ç»„(1</strong>)=&gt;ç¬¬4,5,6,7(x3,1,0,0)ä½,1çš„ä¸ªæ•°ä¸ºå¶æ•°ï¼Œå› æ­¤x3=1</li>\n<li>å¾—å‡ºæœ€ç»ˆæ•°æ®0,1,1,1,0,0</li>\n<li>å‡ºé”™ä½ç½®:å‡å¦‚2å’Œ3ç»„å‡ºé”™,å°†åˆ†ç»„ä»å¤§åˆ°å°æ’åˆ—ï¼Œåˆ™å‡ºé”™ä½æ•°ä¸ºç¬¬6ä½(äºŒè¿›åˆ¶ä¸º110)</li>\n</ol>\n</li>\n</ul>\n<h2>4.7. é«˜é€Ÿç¼“å†²å­˜å‚¨å™¨</h2>\n<ul>\n<li>äº§ç”ŸåŸå› \n<ul>\n<li>ç”±äºI/Oè®¾å¤‡å‘ä¸»å­˜è¯·æ±‚çš„çº§åˆ«é«˜äºCPUè®¿å­˜ï¼Œè¿™å°±å‡ºç°äº†CPUç­‰å¾…I/Oè®¾å¤‡è®¿å­˜çš„ç°è±¡ï¼Œè‡´ä½¿CPUç©ºç­‰ä¸€æ®µæ—¶é—´ï¼Œç”šè‡³å¯èƒ½ç­‰å¾…å‡ ä¸ªä¸»å­˜å‘¨æœŸï¼Œä»è€Œé™ä½äº†CPUçš„å·¥ä½œæ•ˆç‡ã€‚ä¸ºäº†é¿å…CPUä¸I/Oè®¾å¤‡äº‰æŠ¢è®¿å­˜ï¼Œå¯åœ¨CPUä¸ä¸»å­˜åŠ ä¸€çº§ç¼“å­˜ï¼Œä¸»å­˜å¯ä»¥å°†CPUè¦å–çš„ä¿¡æ¯æå‰é€è‡³ç¼“å­˜ã€‚ä¸€æ—¦ä¸»å­˜åœ¨ä¸I/Oè®¾å¤‡äº¤æ¢æ—¶ï¼ŒCPUå¯ç›´æ¥ä»ç¼“å­˜ä¸­è¯»å–æ‰€éœ€ä¿¡æ¯ï¼Œä¸å¿…ç©ºç­‰è€Œå½±å“æ•ˆç‡ã€‚</li>\n<li>ä¸ºäº†è§£å†³ä¸»å­˜ä¸CPUé€Ÿåº¦ä¸åŒ¹é…çš„é—®é¢˜</li>\n</ul>\n</li>\n<li>å±€éƒ¨æ€§åŸç†ï¼šæŒ‡CPUè®¿é—®å­˜å‚¨å™¨æ—¶ï¼Œæ— è®ºæ˜¯å­˜å–æŒ‡ä»¤è¿˜æ˜¯å­˜å–æ•°æ®ï¼Œæ‰€è®¿é—®çš„å­˜å‚¨å•å…ƒéƒ½è¶‹äºèšé›†åœ¨ä¸€ä¸ªè¾ƒå°çš„è¿ç»­åŒºåŸŸä¸­</li>\n<li>å·¥ä½œåŸç†ï¼šä»»ä½•æ—¶åˆ»éƒ½æœ‰ä¸€äº›ä¸»å­˜å—åœ¨ç¼“å­˜å—ä¸­ï¼ŒCPUè¯»å–ä¸»å­˜æŸå­—æ—¶ï¼Œè‹¥æ‰€éœ€çš„å­—å·²åœ¨ç¼“å­˜ä¸­ï¼Œå³å¯ç›´æ¥è®¿é—®Cache(CPUä¸Cacheä¹‹é—´é€šå¸¸ä¸€æ¬¡ä¼ é€ä¸€ä¸ªå­—) ç¼“å­˜å‘½ä¸­ï¼›è‹¥æ‰€éœ€çš„å­—ä¸åœ¨ç¼“å­˜ä¸­ï¼Œéœ€å°†è¯¥å­—æ‰€åœ¨çš„ä¸»å­˜çš„æ•´ä¸ªå­—å—ä¸€æ¬¡è°ƒå…¥ç¼“å­˜ä¸­ï¼ˆç¼“å­˜ä¸ä¸»å­˜ä¹‹é—´æ˜¯å­—å—ä¼ é€ï¼‰ç¼“å­˜ä¸å‘½ä¸­ï¼›å¦‚æœä¸»å­˜å—å·²è°ƒå…¥ç¼“å­˜å—ï¼Œåˆ™ç§°è¯¥ä¸»å­˜å—ä¸ç¼“å­˜å—å»ºç«‹äº†å¯¹åº”å…³ç³»ã€‚</li>\n<li>ç”±äºç¼“å­˜çš„å—æ•°è¿œå°äºä¸»å­˜çš„å—æ•°ã€‚å› æ­¤ï¼Œç¼“å­˜å—ä¸èƒ½å”¯ä¸€åœ°ã€æ°¸ä¹…åœ°åªå¯¹åº”ä¸€ä¸ªä¸»å­˜å—ï¼Œæ•…æ¯ä¸ªç¼“å­˜å¿«éœ€è®¾ä¸€ä¸ªæ ‡è®°ï¼Œç”¨æ¥è¡¨ç¤ºå½“å‰å­˜æ”¾çš„æ˜¯å“ªä¸€ä¸ªä¸»å­˜å—ï¼Œè¯¥æ ‡è®°çš„å†…å®¹ç›¸å½“äºä¸»å­˜å—çš„ç¼–å·ã€‚CPUè¯»ä¿¡æ¯æ—¶ï¼Œè¦å°†ä¸»å­˜åœ°å€çš„é«˜mä½ï¼ˆæˆ–mä½ä¸­çš„ä¸€éƒ¨åˆ†ï¼‰ä¸ç¼“å­˜å—æ¯”è¾ƒï¼Œåˆ¤æ–­æ‰€è¯»ä¿¡æ¯æ˜¯å¦å·²åœ¨ç¼“å­˜ä¸­</li>\n<li>åœ¨ä¸€ä¸ªç¨‹åºæ‰§è¡ŒæœŸé—´ï¼Œè®¾Neä¸ºè®¿é—®Cacheçš„æ€»å‘½ä¸­æ¬¡æ•°ï¼ŒNmä¸ºè®¿é—®ä¸»å­˜çš„æ€»æ¬¡æ•°ï¼Œåˆ™å‘½ä¸­ç‡h=Ne/(Ne+Nm)</li>\n<li>è®¾tcä¸ºå‘½ä¸­æ—¶Cacheè®¿é—®æ—¶é—´ï¼Œtmä¸ºæœªå‘½ä¸­æ—¶çš„ä¸»å­˜è®¿é—®æ—¶é—´ï¼Œ1-hè¡¨ç¤ºæœªå‘½ä¸­ç‡ï¼Œåˆ™Cache-ä¸»å­˜ç³»ç»Ÿçš„å¹³å‡æ—¶é—´ta=htc+(1-h)tmï¼Œè®¿é—®æ•ˆç‡e = tc/ta x 100% = tc/(htc+(1-h)tm)x100%</li>\n<li>Cacheå®¹é‡è¶Šå¤§ï¼Œå…¶CPUå‘½ä¸­ç‡è¶Šé«˜ï¼Œå½“Cacheåˆ°è¾¾ä¸€å®šå€¼æ—¶ï¼Œå‘½ä¸­ç‡å·²ä¸å› å®¹é‡çš„å¢å¤§è€Œæœ‰æ˜æ˜¾çš„æé«˜</li>\n<li>å—é•¿ä¸å‘½ä¸­ç‡å…³ç³»ï¼šå–å†³äºå„ç¨‹åºçš„å±€éƒ¨ç‰¹æ€§ï¼Œå½“å—ç”±å°åˆ°å¤§å¢é•¿æ—¶ï¼Œèµ·åˆä¼šå› å±€éƒ¨æ€§åŸç†ä½¿å‘½ä¸­ç‡æœ‰æ‰€æé«˜ï¼Œç”±å±€éƒ¨æ€§åŸç†æŒ‡å‡ºï¼Œåœ¨å·²è¢«è®¿é—®å­—çš„é™„è¿‘ï¼Œè¿‘æœŸä¹Ÿå¯èƒ½è¢«è®¿é—®ï¼Œå› æ­¤ï¼Œå¢å¤§å—é•¿ï¼Œå¯å°†æ›´å¤šæœ‰ç”¨å­—å­˜å…¥ç¼“å­˜ï¼Œæé«˜å‘½ä¸­ç‡ï¼›å½“å—ç»§ç»­å¢å¤§æ—¶ï¼Œå‘½ä¸­ç‡å¯èƒ½ä¸‹é™ï¼Œå› ä¸ºè£…å…¥ç¼“å­˜çš„æœ‰ç”¨æ•°æ®åè€Œå°‘äºè¢«æ›¿æ¢æ‰çš„æœ‰ç”¨æ•°æ®ã€‚ç”±äºå—é•¿çš„å¢å¤§ï¼Œå¯¼è‡´ç¼“å­˜ä¸­å—æ•°çš„å‡å°‘ï¼Œè€Œæ–°è£…å…¥çš„å—è¦è¦†ç›–æ—§å—ï¼Œå¾ˆå¯èƒ½å‡ºç°å°‘æ•°å—åˆšåˆšè£…å…¥å°±è¢«è¦†ç›–ï¼Œå› æ­¤å‘½ä¸­ç‡åè€Œä¸‹é™ã€‚å†è€…ï¼Œå—å¢å¤§åï¼Œè¿½åŠ ä¸Šçš„å­—è·ç¦»å·²è¢«è®¿é—®çš„å­—æ›´è¿œï¼Œæ•…è¿‘æœŸè¢«è®¿é—®çš„å¯èƒ½æ€§ä¼šæ›´å°‘</li>\n</ul>\n<h2>4.8. ï¼Ÿï¼Ÿï¼Ÿï¼Ÿç¼“å­˜-ä¸»å­˜åœ°å€æ˜ å°„æ–¹å¼ï¼ˆä¸»å­˜åœ°å€æ˜ å°„åˆ°Cacheåœ°å€ç§°ä¸ºåœ°å€æ˜ å°„ï¼‰</h2>\n<pre><code>- ç›´æ¥æ˜ å°„ï¼ˆå›ºå®šçš„æ˜ å°„å…³ç³»ï¼‰\n    - è®¾Cä¸ºç¼“å­˜å—æ•°ï¼Œmä¸ºä¸»å­˜å—æ•°ï¼Œiä¸ºç¼“å­˜å—å·ï¼Œjä¸ºä¸»å­˜å—å·ï¼Œæ ‡è®°t = m-c C = 2^c\n    - æ˜ å°„å…³ç³» i = j mod C æˆ– i = j mod 2^c å³ ç¼“å­˜å¿«Cå¯¹åº”ä¸»å­˜å—C,2C,...,2^m\n    - æ¯ä¸ªç¼“å­˜å— i å¯ä»¥å’Œè‹¥å¹²ä¸ªä¸»å­˜å—å¯¹åº”ï¼Œä¸»å­˜å—å·modç»“æœç›¸åŒçš„éƒ½å¯¹åº”åŒä¸€ä¸ªç¼“å­˜å—å·ã€‚æ¯ä¸ªä¸»å­˜å— j åªèƒ½å’Œä¸€ä¸ªç¼“å†²å—å¯¹åº”\n    - å…ˆæ ¹æ®ä¸­é—´Cä½å­—æ®µæ‰¾åˆ°Cacheå­—å—å·å¯¹åº”çš„å­—å—ï¼Œæ ¹æ®å­—å—çš„â€œæ ‡è®°â€æ˜¯å¦ä¸ä¸»å­˜åœ°å€çš„é«˜tä½ç›¸ç¬¦åˆ¤æ–­ã€‚è‹¥ç¬¦åˆä¸”æœ‰æ•ˆä½ä¸ºâ€œ1â€ï¼Œè¡¨ç¤ºè¯¥Cacheå—ä¸ä¸»å­˜æ¨¡å—å»ºç«‹äº†å¯¹åº”å…³ç³»ï¼ˆå‘½ä¸­ï¼‰å¯æ ¹æ®bä½åœ°å€ä»Cacheä¸­è·å¾—ä¿¡æ¯ï¼›è‹¥ä¸ç¬¦åˆæˆ–æœ‰æ•ˆä½ä¸ºâ€œ0â€(ä¸å‘½ä¸­)ï¼Œåˆ™ä»ä¸»å­˜è¯»å…¥æ–°çš„å­—å—æ¥æ›¿ä»£æ—§çš„å­—å—ï¼ŒåŒæ—¶å°†ä¿¡æ¯é€å¾€CPUï¼Œå¹¶ä¿®æ”¹Cacheâ€œæ ‡è®°â€ã€‚å¦‚æœåŸæ¥æœ‰æ•ˆä½ä¸ºâ€œ0â€ï¼Œåˆ™æ”¹ä¸ºâ€œ1â€\n    - ä¼˜ç‚¹ï¼šå®ç°ç®€å•ï¼Œåªéœ€åˆ©ç”¨ä¸»å­˜åœ°å€çš„æŸäº›ä½ç½®ç›´æ¥åˆ¤æ–­ï¼Œå³å¯ç¡®å®šæ‰€éœ€å­—å—æ˜¯å¦åœ¨ç¼“å­˜ä¸­\n    - ç¼ºç‚¹ï¼šä¸å¤Ÿçµæ´»ï¼Œæ¯ä¸ªä¸»å­˜å—åªèƒ½å¯¹åº”ç±³ä¸€ä¸ªç¼“å­˜å—ï¼Œå³ä½¿ç¼“å­˜å†…è¿˜ç©ºç€è®¸å¤šä½ç½®ä¹Ÿä¸èƒ½å ç”¨ï¼Œç¼“å­˜ç©ºé—´åˆ©ç”¨ç‡ä½ã€‚å¦‚æœç¨‹åºæ°å¥½é‡å¤è®¿é—®å¯¹åº”åŒä¸€ç¼“å­˜ä½ç½®çš„ä¸åŒä¸»å­˜å—ï¼Œå°±è¦ä¸åœåœ°æ›¿æ¢ï¼Œä»è€Œé™ä½å‘½ä¸­ç‡\n- å…¨ç›¸è”æ˜ å°„ï¼ˆçµæ´»æ€§å¤§çš„æ˜ å°„å…³ç³»ï¼‰\n    - å°†ä¸»å­˜æ ‡è®°ä»tä½å¢åŠ åˆ°t+cä½ï¼Œè®¿é—®Cacheæ—¶ä¸»å­˜å­—å—æ ‡è®°éœ€è¦å’ŒCacheå…¨éƒ¨æ ‡è®°è¿›è¡Œæ¯”è¾ƒï¼Œæ‰èƒ½åˆ¤æ–­å‡ºæ‰€è®¿é—®çš„ä¸»å­˜åœ°å€æ˜¯å¦å­˜åœ¨\n    - å…è®¸ä¸»å­˜ä¸­æ¯ä¸€å­—å—æ˜ å°„åˆ°Cacheçš„ä»»ä½•ä¸€å—ä½ç½®ä¸Šï¼Œå¯ä»¥ä»å·²è¢«å æ»¡çš„Cacheä¸­æ›¿æ¢å‡ºä»»ä¸€æ—§å­—å—ï¼Œ\n    - çµæ´»ï¼Œå‘½ä¸­ç‡é«˜ï¼Œç¼©å°äº†å—å†²çªç‡;é€»è¾‘ç”µè·¯å¤šï¼Œæˆæœ¬é«˜ï¼Œå®é™…çš„Cacheè¿˜è¦é‡‡ç”¨å„ç§æªæ–½å‡å°‘åœ°å€çš„æ¯”è¾ƒæ¬¡æ•°\n- ç»„ç›¸è”æ˜ å°„ï¼ˆä¸Šè¿°ä¸¤ç§æ˜ å°„çš„æŠ˜ä¸­ï¼‰\n    - æŠŠCacheåˆ†ä¸ºQç»„ï¼Œæ¯ç»„Rå— ä¸»å­˜å—å·modç»“æœç›¸åŒçš„éƒ½å¯¹åº”åŒä¸€ç»„\n    - è®¾iä¸ºç¼“å­˜ç»„å·ï¼Œjä¸ºä¸»å­˜å—å· i = j mod Q\n    - å½“r = 0æ—¶æ˜¯ç›´æ¥æ˜ å°„æ–¹å¼ï¼Œå½“r = cæ—¶æ˜¯å…¨ç›¸è”æ˜ å°„æ–¹å¼\n</code></pre>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/82f12111d9760fa948119.png\" alt=\"30.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/44ea13005fa8dace3b384.png\" alt=\"31.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5915ee0d665aa75dca8e8.png\" alt=\"32.PNG\"></p>\n<h2>4.9. æ›¿æ¢ç­–ç•¥</h2>\n<ul>\n<li>æ›¿æ¢æ—¶æœºï¼šå½“æ–°çš„ä¸»å­˜å—éœ€è¦è°ƒå…¥Cacheå¹¶ä¸”å¯ç”¨ç©ºé—²ä½ç½®åˆè¢«å æ»¡ï¼Œéœ€è¦æ›¿æ¢æ•°æ®</li>\n<li>éšæœºç®—æ³•ï¼šå¯é‡‡ç”¨ä¸€ä¸ªéšæœºæ•°äº§ç”Ÿå™¨äº§ç”Ÿä¸€ä¸ªéšæœºè¢«æ›¿æ¢çš„å—ï¼Œæ²¡æœ‰å±€éƒ¨æ€§åŸç†ï¼Œä¸èƒ½æé«˜ç¼“å­˜å‘½ä¸­ç‡</li>\n<li>å…ˆè¿›å…ˆå‡ºç®—æ³•ï¼ˆFIFOï¼‰ä¼˜å…ˆæ›¿æ¢æœ€å…ˆè¿›å…¥é˜Ÿåˆ—çš„å­—å—ï¼Œæ·˜æ±°æœ€å…ˆè¿›å…¥é˜Ÿåˆ—çš„å­—å—ï¼›å®¹æ˜“å®ç°ï¼Œå¼€é”€å°ï¼Œæ²¡æœ‰ä½¿ç”¨è®¿å­˜çš„å±€éƒ¨æ€§åŸç†ï¼Œä¸èƒ½æé«˜ç¼“å­˜å‘½ä¸­ç‡</li>\n<li>æœ€è¿‘æœ€å°‘ä½¿ç”¨ç®—æ³•ï¼ˆLeast Recently Used,LRUï¼‰ï¼šä¼˜å…ˆæ·˜æ±°ä¸€æ®µæ—¶é—´å†…æ²¡æœ‰ä½¿ç”¨çš„å­—å—ã€‚ä¸€èˆ¬åªè®°å½•æ¯ä¸ªå—æœ€è¿‘ä¸€æ¬¡ä½¿ç”¨çš„æ—¶é—´ã€‚åˆ©ç”¨è®¿å­˜å±€éƒ¨æ€§åŸç†ï¼Œå¹³å‡å‘½ä¸­ç‡æ¯”FIFOé«˜ã€‚ä¸€èˆ¬ä½¿ç”¨åŒå‘é“¾è¡¨å®ç°ã€‚æŠŠå½“å‰è®¿é—®èŠ‚ç‚¹ç½®äºé“¾è¡¨å‰é¢ï¼ˆä¿è¯é“¾è¡¨å¤´éƒ¨èŠ‚ç‚¹æ˜¯æœ€è¿‘ä½¿ç”¨çš„ï¼‰</li>\n</ul>\n<h2>4.10. è¾…åŠ©å­˜å‚¨å™¨</h2>\n<ul>\n<li>è¾…å­˜å…·æœ‰å®¹é‡å¤§ã€é€Ÿåº¦æ…¢ã€ä»·æ ¼ä½ã€å¯è„±æœºä¿å­˜ä¿¡æ¯ç­‰ç‰¹ç‚¹ï¼Œå±\"éæ˜“å¤±æ€§\"å­˜å‚¨å™¨</li>\n<li>ä¸»å­˜å…·æœ‰é€Ÿåº¦å¿«ã€æˆæœ¬é«˜ã€å®¹é‡å°ç­‰ç‰¹ç‚¹ï¼Œè€Œå¤§å¤šæ•°ç”±åŠå¯¼ä½“èŠ¯ç‰‡æ„æˆï¼Œæ‰€å­˜ä¿¡æ¯æ— æ³•æ°¸ä¹…ä¿å­˜ï¼Œå±\"æ˜“å¤±æ€§\"å­˜å‚¨å™¨</li>\n<li>è¾…å­˜å­˜å‚¨å™¨æœ‰ç¡¬ç£ç›˜ã€è½¯ç£ç›˜ã€ç£å¸¦ã€å…‰ç›˜ç­‰ï¼Œå‰ä¸‰ç§å±äºç£è¡¨é¢å­˜å‚¨å™¨</li>\n<li>ç£è¡¨é¢å­˜å‚¨å™¨çš„ä¸»è¦æŠ€æœ¯æŒ‡æ ‡\n<ul>\n<li>è®°å½•å¯†åº¦ï¼šå•ä½é•¿åº¦å†…æ‰€å­˜å‚¨çš„äºŒè¿›åˆ¶ä¿¡æ¯é‡</li>\n<li>å­˜å‚¨å®¹é‡ï¼šå¤–å­˜æ‰€èƒ½å­˜å‚¨çš„äºŒè¿›åˆ¶ä¿¡æ¯æ€»æ•°é‡ï¼Œä¸€èˆ¬ä»¥ä½æˆ–å­—èŠ‚ä¸ºå•ä½</li>\n<li>å¹³å‡å¯»å€æ—¶é—´</li>\n<li>æ•°æ®ä¼ è¾“ç‡ï¼šå•ä½æ—¶é—´å†…ç£å­˜å‚¨å™¨å‘ä¸»æœºä¼ é€æ•°æ®çš„ä½æ•°æˆ–å­—èŠ‚æ•°</li>\n<li>è¯¯ç ç‡ï¼šè¡¡é‡ç£è¡¨é¢å­˜å‚¨å™¨å‡ºé”™æ¦‚ç‡çš„å‚æ•°ï¼Œç­‰äºä»è¾…å­˜è¯»å‡ºæ—¶ï¼Œå‡ºé”™ä¿¡æ¯ä½æ•°å’Œè¯»å‡ºä¿¡æ¯çš„æ€»ä½æ•°ä¹‹æ¯”ã€‚ä¸ºäº†çº æ­£å‡ºé”™ç‡ï¼Œé€šå¸¸é‡‡ç”¨å¾ªç¯å†—ä½™ç å‘ç°å¹¶çº æ­£é”™è¯¯</li>\n</ul>\n</li>\n<li>è¾…åŠ©å­˜å‚¨å™¨-ç£ç›˜ï¼ˆç¡¬ç›˜ï¼‰\n<ul>\n<li>è¡¨é¢æ˜¯å¯ç£åŒ–çš„ç¡¬ç£æ€§ç‰¹æ€§ææ–™ã€‚- ç§»åŠ¨ç£å¤´å¾„å‘è¿åŠ¨è¯»å–ç£é“ä¿¡æ¯</li>\n<li>ç£ç›˜å¯»é“ç®—æ³•ï¼š\n<ul>\n<li>å…ˆæ¥å…ˆæœåŠ¡ç®—æ³•ï¼šæŒ‰é¡ºåºè®¿é—®è¿›ç¨‹çš„ç£é“è¯»å†™éœ€æ±‚</li>\n<li>æœ€çŸ­å¯»é“æ—¶é—´ä¼˜å…ˆï¼šä¸ç£å¤´å½“å‰ä½ç½®æœ‰å…³ã€ä¼˜å…ˆè®¿é—®ç¦»ç£å¤´æœ€è¿‘çš„ç£é“</li>\n<li>æ‰«æç®—æ³•ï¼ˆç”µæ¢¯ç®—æ³•ï¼‰ï¼šæ¯æ¬¡åªå¾€ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ã€åˆ°è¾¾ä¸€ä¸ªæ–¹å‘éœ€è¦æœåŠ¡çš„å°½å¤´å†åæ–¹å‘ç§»åŠ¨</li>\n<li>å¾ªç¯æ‰«æç®—æ³•ï¼šåªå¾€ä¸€ä¸ªæ–¹å‘ç§»åŠ¨ï¼Œç”±å†…å¾€å¤–æˆ–ç”±å¤–å¾€å†…è¯»å–<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/af1be3f8a5a19f9738e5b.png\" alt=\"43.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8fd497485ec44bca2765a.png\" alt=\"42.PNG\"></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>5. è¾“å…¥è¾“å‡ºç³»ç»Ÿ</h1>\n<h2>5.1. è¾“å…¥è¾“å‡ºç³»ç»Ÿå‘å±•æ¦‚å†µ</h2>\n<ul>\n<li>æ—©æœŸé˜¶æ®µï¼šI/Oè®¾å¤‡ä¸ä¸»å­˜äº¤æ¢ä¿¡æ¯éƒ½å¿…é¡»é€šè¿‡CPU</li>\n<li>æ¥å£æ¨¡å—å’ŒDMAé˜¶æ®µï¼š\n<ul>\n<li>I/Oè®¾å¤‡é€šè¿‡æ¥å£æ¨¡å—ä¸ä¸»æœºè¿æ¥ï¼Œè®¡ç®—æœºç³»ç»Ÿé‡‡ç”¨äº†æ€»çº¿ç»“æ„ï¼Œæ¥å£ä¸­é€šå¸¸è®¾æœ‰æ•°æ®é€šè·¯å’Œæ§åˆ¶é€šè·¯ï¼Œæ•°æ®ç»è¿‡æ¥å£æ—¢èµ·åˆ°ç¼“å†²ä½œç”¨ï¼Œåˆå¯å®Œæˆä¸²-å¹¶å˜æ¢</li>\n<li>æ§åˆ¶é€šè·¯ç”¨ä»¥ä¼ é€CPUå‘I/Oè®¾å¤‡å‘å‡ºçš„å„ç§æ§åˆ¶å‘½ä»¤ï¼Œæˆ–ä½¿CPUæ¥å—æ¥è‡ªI/Oè®¾å¤‡çš„åé¦ˆä¿¡å·</li>\n<li>ä¸ºäº†è¿›ä¸€æ­¥æé«˜CPUå·¥ä½œæ•ˆç‡ï¼Œå‡ºç°äº†ç›´æ¥å­˜å‚¨å™¨å­˜å–ï¼ˆDirect Memory Access,DMAï¼‰æŠ€æœ¯ï¼ŒI/Oè®¾å¤‡ä¸ä¸»å­˜ä¹‹é—´æœ‰ä¸€æ¡ç›´æ¥æ•°æ®é€šè·¯ï¼ŒI/Oè®¾å¤‡å¯ä»¥ä¸ä¸»å­˜ç›´æ¥äº¤æ¢ä¿¡æ¯ï¼Œä½¿CPUåœ¨I/Oè®¾å¤‡ä¸ä¸»å­˜äº¤æ¢ä¿¡æ¯æ—¶èƒ½ç»§ç»­å®Œæˆè‡ªèº«çš„å·¥ä½œï¼Œèµ„æºåˆ©ç”¨ç‡å¾—åˆ°äº†è¿›ä¸€æ­¥æé«˜</li>\n</ul>\n</li>\n<li>é€šé“ç»“æ„çš„é˜¶æ®µ\n<ul>\n<li>å¯¹äºå¤§å‹è®¡ç®—æœºï¼ŒDMAæ–¹å¼éšç€I/Oè®¾å¤‡å¢åŠ è€Œå¢åŠ äº†ç¡¬ä»¶æˆæœ¬ï¼Œè¿˜å¯¼è‡´è®¿é—®ä¸»å­˜çš„å†²çªé—®é¢˜</li>\n<li>CPUè¿˜éœ€è¦å¯¹ä¼—å¤šDMAæ¥å£ç®¡ç†ï¼Œå ç”¨CPUæ—¶é—´ï¼Œé¢‘ç¹è¿›å…¥å‘¨æœŸæŒªç”¨å‘¨æœŸï¼Œå½±å“CPUå·¥ä½œæ•ˆç‡</li>\n<li>åœ¨å¤§ä¸­å‹è®¡ç®—æœºç³»ç»Ÿä¸­ï¼Œé‡‡ç”¨I/Oé€šé“çš„æ–¹å¼è¿›è¡Œæ•°æ®äº¤æ¢</li>\n<li>é€šé“æ˜¯ç”¨æ¥è´Ÿè´£ç®¡ç†I/Oè®¾å¤‡ä»¥åŠå®ç°ä¸»å­˜ä¸I/Oè®¾å¤‡ä¹‹é—´äº¤æ¢ä¿¡æ¯çš„éƒ¨ä»¶ï¼Œå¯ä»¥è§†ä¸ºä¸€ç§å…·æœ‰ç‰¹æ®ŠåŠŸèƒ½çš„å¤„ç†å™¨ï¼Œå…·æœ‰ä¸“ç”¨çš„é€šé“æŒ‡ä»¤ï¼Œèƒ½ç‹¬ç«‹æ‰§è¡Œé€šé“æŒ‡ä»¤æ‰€ç¼–å†™çš„è¾“å…¥è¾“å‡ºç¨‹åºï¼Œä½†ä¸æ˜¯ä¸€ä¸ªå®Œå…¨ç‹¬ç«‹çš„å¤„ç†å™¨</li>\n</ul>\n</li>\n<li>I/Oå¤„ç†æœºé˜¶æ®µ\n<ul>\n<li>I/Oå¤„ç†æœºç‹¬ç«‹äºä¸»æœºå·¥ä½œï¼Œå¯å®ŒæˆI/Oæ§åˆ¶ã€ç åˆ¶è½¬æ¢ã€æ ¼å¼å¤„ç†ã€æ•°æ®å—æ£€é”™ã€çº é”™ç­‰æ“ä½œï¼Œå¹¶è¡Œæ€§æ›´é«˜</li>\n</ul>\n</li>\n</ul>\n<h2>5.2. è¾“å…¥è¾“å‡ºç³»ç»Ÿçš„ç»„æˆ</h2>\n<ul>\n<li>I/Oè½¯ä»¶\n<ul>\n<li>å°†ç”¨æˆ·ç¼–åˆ¶çš„ç¨‹åºï¼ˆæˆ–æ•°æ®ï¼‰è¾“å…¥ä¸»æœºå†…</li>\n<li>å°†è¿ç®—ç»“æœè¾“é€ç»™ç”¨æˆ·</li>\n<li>å®ç°è¾“å…¥è¾“å‡ºç³»ç»Ÿä¸ä¸»æœºå·¥ä½œçš„åè°ƒç­‰</li>\n</ul>\n</li>\n<li>I/OæŒ‡ä»¤\n<ul>\n<li>æ“ä½œç ï¼šä¸å…¶ä»–æŒ‡ä»¤çš„åˆ¤åˆ«ä»£ç </li>\n<li>å‘½ä»¤ç ï¼šä½“ç°I/Oè®¾å¤‡çš„å…·ä½“æ“ä½œ\n<ul>\n<li>å°†æ•°æ®ä»I/Oè®¾å¤‡è¾“å…¥ä¸»æœº</li>\n<li>å°†æ•°æ®ä»ä¸»æœºè¾“å‡ºåˆ°I/Oè®¾å¤‡</li>\n<li>çŠ¶æ€æµ‹è¯•</li>\n<li>å½¢æˆæŸäº›æ“ä½œæŒ‡ä»¤ï¼Œä¸ä¸åŒI/Oè®¾å¤‡äº¤æ¢ä¿¡æ¯è¦å®Œæˆä¸åŒçš„æ“ä½œ</li>\n<li>è®¾å¤‡ç ï¼šå¤šå°I/Oè®¾å¤‡çš„é€‰æ‹©ç </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é€šé“æŒ‡ä»¤ï¼šå¯¹å…·æœ‰I/Oé€šé“çš„ç³»ç»Ÿä¸“é—¨è®¾ç½®çš„æŒ‡ä»¤\n<ul>\n<li>æŒ‡æ˜å‚ä¸ä¼ é€ï¼ˆå†™å…¥æˆ–è¯»å–ï¼‰çš„æ•°æ®ç»„åœ¨ä¸»å­˜ä¸­çš„é¦–åœ°å€</li>\n<li>æŒ‡æ˜éœ€è¦ä¼ é€çš„å­—èŠ‚æ•°æˆ–æ‰€ä¼ é€æ•°æ®ç»„çš„æœ«åœ°å€</li>\n<li>æŒ‡æ˜æ‰€é€‰è®¾å¤‡çš„è®¾å¤‡ç åŠå®ŒæˆæŸç§æ“ä½œçš„å‘½ä»¤ç </li>\n</ul>\n</li>\n<li>I/Oç¡¬ä»¶</li>\n</ul>\n<h2>5.3. I/Oè®¾å¤‡ä¸ä¸»æœºçš„è”ç³»æ–¹å¼</h2>\n<ul>\n<li>I/Oè®¾å¤‡ç¼–å€æ–¹å¼(I/Oè®¾å¤‡ç çœ‹ä½œåœ°å€ç )\n<ul>\n<li>ç»Ÿä¸€ç¼–å€ï¼šå°†I/Oåœ°å€çœ‹ä½œå­˜å‚¨å™¨åœ°å€çš„ä¸€éƒ¨åˆ†ã€‚å ç”¨ä¸»å­˜å®¹é‡ï¼Œä½†æ— éœ€ä¸“ç”¨çš„I/OæŒ‡ä»¤</li>\n<li>ä¸ç»Ÿä¸€ç¼–å€ï¼šå°†I/Oåœ°å€å’Œå­˜å‚¨å™¨åœ°å€åˆ†å¼€ï¼Œå¯¹I/Oè®¾å¤‡çš„è®¿é—®å¿…é¡»æœ‰ä¸“ç”¨çš„I/OæŒ‡ä»¤ã€‚ä¸å ç”¨ä¸»å­˜å®¹é‡ï¼Œä½†éœ€è®¾I/Oä¸“ç”¨æŒ‡ä»¤</li>\n<li>å½“è®¾å¤‡é€šè¿‡æ¥å£å’Œä¸»æœºç›¸è¿æ—¶ï¼ŒCPUå¯ä»¥é€šè¿‡æ¥å£åœ°å€æ¥è®¿é—®I/Oè®¾å¤‡</li>\n</ul>\n</li>\n<li>è®¾å¤‡ç¼–å€ï¼šæ¯å°è®¾å¤‡èµ‹äºˆä¸€ä¸ªè®¾å¤‡å·ï¼Œå½“éœ€è¦å¯åŠ¨è®¾å¤‡æ—¶ï¼Œå¯ç”±I/OæŒ‡ä»¤çš„è®¾å¤‡ç å­—æ®µç›´æ¥æŒ‡å‡ºè¯¥è®¾å¤‡çš„è®¾å¤‡å·ã€‚é€šè¿‡æ¥å£ç”µè·¯ä¸­çš„è®¾å¤‡é€‰æ‹©ç”µè·¯ï¼Œä¾¿å¯é€‰ä¸­è¦äº¤æ¢ä¿¡æ¯çš„è®¾å¤‡</li>\n<li>ä¼ é€æ–¹å¼ï¼ˆéœ€é…ç½®ä¸åŒçš„æ¥å£ç”µè·¯ï¼‰\n<ul>\n<li>å¹¶è¡Œä¼ é€ï¼šåœ¨åŒä¸€ç¬é—´ï¼Œnä½ä¿¡æ¯åŒæ—¶ä»CPUè¾“å‡ºå€¼I/Oè®¾å¤‡ï¼Œæˆ–ç”±I/Oè®¾å¤‡è¾“å…¥åˆ°CPUï¼Œä¼ é€é€Ÿåº¦è¾ƒå¿«ï¼Œè¦æ±‚æ•°æ®çº¿å¤š</li>\n<li>ä¸²è¡Œä¼ é€ï¼ˆè¿œè·ç¦»é€šä¿¡ï¼‰ï¼šåœ¨åŒä¸€ç¬é—´åªä¼ é€ä¸€ä½ä¿¡æ¯ï¼Œåœ¨ä¸åŒæ—¶åˆ»è¿ç»­é€ä¸ºä¼ é€ä¸€ä¸²ä¿¡æ¯ã€‚ä¼ é€é€Ÿåº¦æ…¢ï¼Œåªéœ€ä¸€æ ¹æ•°æ®çº¿å’Œä¸€æ ¹åœ°çº¿</li>\n</ul>\n</li>\n<li>è”ç»œæ–¹å¼ï¼šI/Oè®¾å¤‡ä¸ä¸»æœºä¹‹é—´ç›¸äº’äº†è§£å½¼æ­¤æ‰€å¤„çš„çŠ¶æ€\n<ul>\n<li>ç«‹å³å“åº”æ–¹å¼ï¼šå·¥ä½œé€Ÿåº¦ååˆ†ç¼“æ…¢çš„I/Oè®¾å¤‡</li>\n<li>å¼‚æ­¥å·¥ä½œé‡‡ç”¨åº”ç­”ä¿¡å·è”ç»œï¼šå½“I/Oè®¾å¤‡ä¸ä¸»æœºå·¥ä½œé€Ÿåº¦ä¸åŒ¹é…ï¼Œä¸€æ–¹æ•°æ®å‡†å¤‡å¥½äº†æ‰é€šçŸ¥å¦å¤–ä¸€æ–¹å–æ•°æ®</li>\n<li>åŒæ­¥å·¥ä½œé‡‡ç”¨åŒæ­¥æ—¶æ ‡è”ç»œï¼šéœ€è¦é…ç½®ä¸“ç”¨ç”µè·¯ï¼Œç”¨ä»¥äº§ç”ŸåŒæ­¥æ—¶æ ‡æ¥æ§åˆ¶åŒæ­¥å·¥ä½œ</li>\n</ul>\n</li>\n<li>è¿æ¥æ–¹å¼\n<ul>\n<li>è¾å°„å¼ï¼šæ¯å°I/Oè®¾å¤‡éƒ½æœ‰ä¸€å¥—æ§åˆ¶çº¿è·¯å’Œä¸€ç»„ä¿¡å·çº¿ï¼Œæ‰€ç”¨å™¨ä»¶å’Œè¿çº¿è¾ƒå¤šï¼Œå¯¹I/Oè®¾å¤‡çš„å¢åˆ éƒ½æ¯”è¾ƒå›°éš¾</li>\n<li>æ€»çº¿å¼ï¼ˆç°ä»£è®¡ç®—æœºï¼‰ï¼šé€šè¿‡ä¸€ç»„æ€»çº¿ï¼ˆåœ°å€å…ˆã€æ•°æ®çº¿ã€æ§åˆ¶çº¿ç­‰ï¼‰ï¼Œå°†æ‰€æœ‰çš„I/Oè®¾å¤‡å’Œä¸»æœºè¿æ¥</li>\n</ul>\n</li>\n</ul>\n<h2>5.4. I/Oè®¾å¤‡ä¸ä¸»æœºä¿¡æ¯ä¼ é€çš„æ§åˆ¶æ–¹å¼</h2>\n<ul>\n<li>ç¨‹åºæŸ¥è¯¢æ–¹å¼(è½®è¯¢)\n<ul>\n<li>ç”±CPUä¸æ–­æŸ¥è¯¢I/Oè®¾å¤‡æ˜¯å¦å·²åšå¥½å‡†å¤‡ï¼Œä»è€Œæ§åˆ¶I/Oè®¾å¤‡ä¸ä¸»æœºäº¤æ¢ä¿¡æ¯</li>\n<li>è¦æ±‚I/Oæ¥å£å†…è®¾ç½®ä¸€ä¸ªèƒ½åæ˜ I/Oè®¾å¤‡æ˜¯å¦å‡†å¤‡å°±ç»ªçš„çŠ¶æ€æ ‡è®°ï¼ŒCPUé€šè¿‡å¯¹æ­¤æ ‡è®°çš„æ£€æµ‹ï¼Œå¯å¾—çŸ¥I/Oè®¾å¤‡çš„å‡†å¤‡æƒ…å†µ</li>\n<li>ä½¿CPUå’ŒI/Oè®¾å¤‡å¤„äºä¸²è¡Œå·¥ä½œçŠ¶æ€ï¼ŒCPUå·¥ä½œæ•ˆç‡ä¸é«˜</li>\n</ul>\n</li>\n<li>ç¨‹åºä¸­æ–­æ–¹å¼\n<ul>\n<li>å½“I/Oè®¾å¤‡å‡†å¤‡å°±ç»ªå¹¶å‘CPUå‘å‡ºä¸­æ–­è¯·æ±‚åæ‰äºˆä»¥å“åº”ï¼Œå¤§å¤§æé«˜CPUçš„å·¥ä½œæ•ˆç‡</li>\n<li>CPUå’ŒI/Oæ¥å£ä¸ä»…åœ¨ç¡¬ä»¶æ–¹é¢éœ€å¢åŠ ç›¸åº”çš„ç”µè·¯ï¼Œè€Œåœ¨è½¯ä»¶æ–¹é¢è¿˜å¿…é¡»ç¼–åˆ¶ä¸­æ–­æœåŠ¡ç¨‹åº</li>\n<li>CPUæœ‰ä¸“é—¨çš„ç”µè·¯å“åº”ä¸­æ–­ä¿¡å·ï¼Œå°†å½“å‰å·¥ä½œæš‚åœï¼Œ åšIOè®¾å¤‡çš„å·¥ä½œï¼Œåšå®Œå†ç»§ç»­åšå½“å‰å·¥ä½œ</li>\n<li>æä¾›ä½é€Ÿè®¾å¤‡é€šçŸ¥CPUçš„ä¸€ç§å¼‚æ­¥çš„æ–¹å¼ï¼ŒCPUå¯ä»¥é«˜é€Ÿè¿è½¬çš„åŒæ—¶å…¼é¡¾ä½é€Ÿè®¾å¤‡çš„å“åº”</li>\n</ul>\n</li>\n<li>DMAæ–¹å¼ï¼ˆI/Oè®¾å¤‡ç›´æ¥ä¸ä¸»å­˜äº¤æ¢ä¿¡æ¯ï¼‰ï¼ˆç¡¬ç›˜å’Œå¤–ç½®æ˜¾å¡ï¼‰\n<ul>\n<li>DMAæ–¹å¼ä¸­ï¼Œä¸»å­˜ä¸I/Oè®¾å¤‡ä¹‹é—´æœ‰ä¸€æ¡æ•°æ®é€šè·¯ï¼Œä¸»å­˜ä¸I/Oè®¾å¤‡äº¤æ¢ä¿¡æ¯æ—¶ï¼Œæ— é¡»è°ƒç”¨ä¸­æ–­æœåŠ¡ç¨‹åºï¼Œå¯ä»¥æé«˜CPUæ•ˆç‡ã€‚è‹¥å‡ºç°DMAå’ŒCPUåŒæ—¶è®¿é—®ä¸»å­˜ï¼ŒCPUæ€»çº¿æ€»æ˜¯å°†å æœ‰æƒè®©ç»™DMAï¼Œé€šå¸¸æŠŠDMAè¿™ç§å æœ‰ç§°ä¸ºçªƒå–æˆ–æŒªç”¨ã€‚çªƒå–çš„æ—¶é—´ä¸€èˆ¬ä¸ºä¸€ä¸ªå­˜å–å‘¨æœŸï¼Œæ•…åˆæŠŠDMAå ç”¨å­˜å–å‘¨æœŸç§°ä¸ºçªƒå–å‘¨æœŸ/æŒªç”¨å‘¨æœŸã€‚è€Œä¸”åœ¨DMAçªƒå–å­˜å–å‘¨æœŸæ—¶ï¼ŒCPUèƒ½ç»§ç»­ä½œå†…éƒ¨æ“ä½œï¼ˆå¦‚ä¹˜æ³•è¿ç®—ï¼‰</li>\n<li>éœ€è¦å¢åŠ å¿…è¦çš„æ¥å£ç”µè·¯</li>\n<li>ç¨‹åºä¸­æ–­å’ŒDMAéƒ½æ˜¯è®¡ç®—æœºIOå’Œä½é€Ÿè®¾å¤‡çš„äº¤äº’æ–¹å¼ï¼Œç¨‹åºä¸­æ–­æ–¹å¼å®ç°ç®€å•ï¼ŒDMAæ–¹å¼æ•ˆç‡æ›´é«˜</li>\n</ul>\n</li>\n<li>I/Oé€šé“æ–¹å¼</li>\n<li>I/Oå¤„ç†æœºæ–¹å¼</li>\n</ul>\n<h2>5.5. I/Oæ¥å£</h2>\n<ul>\n<li>I/Oæ¥å£ï¼šä¸»æœºä¸I/Oè®¾å¤‡ä¹‹é—´è®¾ç½®çš„ä¸€ä¸ªç¡¬ä»¶ç”µè·¯æœºå™¨ç›¸åº”çš„è½¯ä»¶æ§åˆ¶</li>\n<li>è®¾ç½®åŸå› \n<ul>\n<li>ä¸€å°æœºå™¨é€šå¸¸é…æœ‰å¤šå°I/Oè®¾å¤‡ï¼Œå„è‡ªæœ‰è®¾å¤‡å·ï¼Œé€šè¿‡æ¥å£å¯å®ç°I/Oè®¾å¤‡çš„é€‰æ‹©</li>\n<li>I/Oè®¾å¤‡ç§ç±»ç¹å¤šï¼Œé€Ÿåº¦ä¸ä¸€ï¼Œä¸CPUé€Ÿåº¦ç›¸å·®å¯èƒ½å¾ˆå¤§ï¼Œé€šè¿‡æ¥å£å¯å®ç°æ•°æ®ç¼“å†²ï¼Œè¾¾åˆ°é€Ÿåº¦åŒ¹é…</li>\n<li>æœ‰äº›è®¾å¤‡å¯èƒ½ä¸²è¡Œã€å¯èƒ½å¹¶è¡Œä¼ é€ï¼Œé€šè¿‡æ¥å£å¯å®ç°</li>\n<li>å¯å®ç°ç”µå¹³è½¬æ¢</li>\n<li>å¯ä¼ é€æ§åˆ¶å‘½ä»¤</li>\n<li>å¯é€šè¿‡æ¥å£ç›‘è§†è®¾å¤‡çš„å·¥ä½œçŠ¶æ€ï¼Œä¾›CPUæŸ¥è¯¢</li>\n</ul>\n</li>\n<li>ç«¯å£ï¼šæŒ‡æ¥å£ç”µè·¯ä¸­çš„ä¸€äº›å¯„å­˜å™¨ï¼Œåˆ†åˆ«ç”¨æ¥å­˜æ”¾æ•°æ®ä¿¡æ¯ï¼Œæ§åˆ¶ä¿¡æ¯å’ŒçŠ¶æ€ä¿¡æ¯ï¼Œç›¸åº”çš„ç«¯å£åˆ†åˆ«ç§°ä¸ºæ•°æ®ç«¯å£ã€æ§åˆ¶ç«¯å£ã€å’ŒçŠ¶æ€ç«¯å£ã€‚è‹¥å¹²ä¸ªç«¯å£åŠ ä¸Šç›¸åº”çš„æ§åˆ¶é€»è¾‘æ‰èƒ½ç»„æˆæ¥å£ã€‚</li>\n</ul>\n<h2>5.6. æ¥å£çš„åŠŸèƒ½å’Œç»„æˆ</h2>\n<ul>\n<li>æ€»çº¿è¿æ¥æ–¹å¼çš„I/Oæ¥å£ç”µè·¯ï¼šå…¶ä¸­I/Oæ€»çº¿åŒ…æ‹¬\n<ul>\n<li>æ•°æ®çº¿ï¼šI/Oè®¾å¤‡ä¸ä¸»æœºä¹‹é—´æ•°æ®ä»£ç çš„ä¼ é€çº¿ï¼Œå…¶æ ¹æ•°ä¸€èˆ¬ç­‰äºå­˜å‚¨å­—é•¿çš„ä½æ•°æˆ–å­—ç¬¦çš„ä½æ•°</li>\n<li>è®¾å¤‡é€‰æ‹©çº¿ï¼šä¸»æœºé€‰æ‹©IOè®¾å¤‡è¿›è¡Œæ“ä½œçš„ä¿¡å·çº¿ï¼Œå¯¹è¿åœ¨æ€»çº¿ä¸Šçš„è®¾å¤‡è¿›è¡Œé€‰æ‹©ã€‚ä¼ é€è®¾å¤‡ç ï¼Œæ ¹æ•°å–å†³äºI/OæŒ‡ä»¤ä¸­è®¾å¤‡ç çš„ä½æ•°</li>\n<li>å‘½ä»¤çº¿ï¼šä¼ è¾“CPUå‘I/Oè®¾å¤‡å‘å‡ºçš„å„ç§å‘½ä»¤ä¿¡å·ï¼Œå¦‚å¯åŠ¨ã€æ¸…é™¤ã€å±è”½ã€è¯»ã€å†™ç­‰ï¼Œä¸€ç»„å•å‘æ€»çº¿ï¼Œæ ¹æ•°ä¸å‘½ä»¤ä¿¡å·å¤šå°‘æœ‰å…³</li>\n<li>çŠ¶æ€çº¿ï¼šå°†I/Oè®¾å¤‡çš„çŠ¶æ€å‘ä¸»æœºæŠ¥å‘Šçš„ä¿¡å·çº¿ï¼Œä¸€ç»„å•å‘æ€»çº¿ã€‚æŸ¥è¯¢è®¾å¤‡æ˜¯å¦å·²ç»æ­£å¸¸è¿æ¥å¹¶å°±ç»ªï¼ŒæŸ¥è¯¢è®¾å¤‡æ˜¯å¦å·²ç»è¢«å ç”¨</li>\n</ul>\n</li>\n<li>æ¥å£çš„åŠŸèƒ½å’Œç»„æˆ\n<ul>\n<li>é€‰å€åŠŸèƒ½</li>\n<li>ä¼ é€å‘½ä»¤çš„åŠŸèƒ½ï¼šè®¾æœ‰å‘½ä»¤å¯„å­˜å™¨ï¼ˆå­˜æ”¾I/OæŒ‡ä»¤ä¸­çš„å‘½ä»¤ç ã€‚å—è®¾é€‰ä¸­ä¿¡å·æ§åˆ¶ï¼‰å’Œå‘½ä»¤è¯‘ç å™¨</li>\n<li>ä¼ é€æ•°æ®çš„åŠŸèƒ½ï¼ˆç¼“å†²èƒ½åŠ›ï¼‰è®¾æœ‰æ•°æ®ç¼“å†²å¯„å­˜å™¨ï¼Œæš‚å­˜I/Oè®¾å¤‡ä¸ä¸»æœºå‡†å¤‡äº¤æ¢çš„ä¿¡æ¯</li>\n<li>åæ˜ I/Oè®¾å¤‡å·¥ä½œçŠ¶æ€çš„åŠŸèƒ½ï¼ˆä¸­æ–­è¯·æ±‚è§¦å‘å™¨ï¼Œå±è”½è§¦å‘å™¨MASKï¼‰</li>\n</ul>\n</li>\n<li>æ¥å£ç±»å‹\n<ul>\n<li>æŒ‰æ•°æ®ä¼ é€æ–¹å¼ï¼šå¹¶è¡Œæ¥å£ã€‚ä¸²è¡Œæ¥å£</li>\n<li>æŒ‰åŠŸèƒ½é€‰æ‹©çš„çµæ´»æ€§åˆ†ç±»ï¼šå¯ç¼–ç¨‹æ¥å£ï¼Œä¸å¯ç¼–ç¨‹æ¥å£</li>\n<li>æŒ‰é€šç”¨æ€§åˆ†ç±»ï¼šé€šç”¨æ¥å£ï¼Œä¸“ç”¨æ¥å£</li>\n<li>æŒ‰æ•°æ®ä¼ é€çš„æ§åˆ¶æ–¹å¼ï¼šç¨‹åºå‹æ¥å£(è¿æ¥é€Ÿåº¦è¾ƒæ…¢çš„è®¾å¤‡)ï¼ŒDMAå‹æ¥å£</li>\n</ul>\n</li>\n</ul>\n<h2>5.7. ç¨‹åºä¸­æ–­æ–¹å¼</h2>\n<ul>\n<li>ä¸­æ–­ï¼šè®¡ç®—æœºåœ¨æ‰§è¡Œç¨‹åºçš„è¿‡ç¨‹ä¸­ï¼Œå½“å‡ºç°å¼‚å¸¸æƒ…å†µæˆ–ç‰¹æ®Šè¯·æ±‚æ—¶ï¼Œè®¡ç®—æœºåœæ­¢ç°è¡Œç¨‹åºçš„è¿è¡Œã€è½¬å‘å¯¹è¿™äº›å¼‚å¸¸æƒ…å†µæˆ–ç‰¹æ®Šè¯·æ±‚çš„å¤„ç†ï¼Œå¤„ç†ç»“æŸååœ¨è¿”å›åˆ°ç°è¡Œç¨‹åºçš„é—´æ–­å¤„ï¼Œç»§ç»­æ‰§è¡ŒåŸç¨‹åº</li>\n<li>ä¸­æ–­æŠ€æœ¯å¼•å…¥åŸå› ï¼šé€‚åº”I/Oè®¾å¤‡å·¥ä½œé€Ÿåº¦ä½çš„é—®é¢˜ï¼Œæé«˜è®¡ç®—æœºæ•´æœºæ•ˆç‡ã€‚å®æ—¶æ§åˆ¶çš„éœ€è¦</li>\n</ul>\n<h2>5.8. ä¸­æ–­æœåŠ¡ç¨‹åºçš„æµç¨‹</h2>\n<ul>\n<li>ä¸­æ–­æœåŠ¡ç¨‹åºçš„æµç¨‹\n<ul>\n<li>ä¿æŠ¤ç°åœº\n<ul>\n<li>ä¿å­˜ç¨‹åºæ–­ç‚¹ï¼Œç”±ä¸­æ–­éšæŒ‡ä»¤å®Œæˆ</li>\n<li>ä¿å­˜çŠ¶æ€å¯„å­˜å™¨çš„å†…å®¹ï¼Œç”±ä¸­æ–­æœåŠ¡ç¨‹åºå®Œæˆ</li>\n</ul>\n</li>\n<li>ä¸­æ–­æœåŠ¡ï¼ˆè®¾å¤‡æœåŠ¡ï¼‰</li>\n<li>æ¢å¤ç°åœºï¼šè¦æ±‚åœ¨é€€å‡ºä¸­æ–­æœåŠ¡ç¨‹åºä¹‹å‰ï¼Œå°†ç¨‹åºä¸­æ–­æ—¶çš„â€œç°åœºâ€æ¢å¤åˆ°åŸæ¥çš„å¯„å­˜å™¨ä¸­</li>\n<li>ä¸­æ–­è¿”å›ï¼šä¸­æ–­æœåŠ¡ç¨‹åºçš„æœ€åä¸€æ¡æŒ‡ä»¤ï¼Œä½¿å…¶è¿”å›åˆ°åŸç¨‹åºçš„æ–­ç‚¹å¤„ï¼Œä»¥ä¾¿ç»§ç»­æ‰§è¡ŒåŸç¨‹åº</li>\n</ul>\n</li>\n<li>å¤šé‡ä¸­æ–­ï¼šè®¡ç®—æœºåœ¨å¤„ç†ä¸­æ–­çš„è¿‡ç¨‹ä¸­ï¼Œæœ‰å¯èƒ½å‡ºç°æ–°çš„ä¸­æ–­è¯·æ±‚ï¼Œå¦‚æœCPUæš‚åœç°è¡Œçš„ä¸­æ–­æœåŠ¡ç¨‹åºï¼Œè½¬å»å¤„ç†æ–°çš„ä¸­æ–­è¯·æ±‚ï¼Œè¿™ç§ç°è±¡ç§°ä¸ºä¸­æ–­åµŒå¥—</li>\n<li>å•é‡ä¸­æ–­ï¼šCPUåœ¨æ‰§è¡Œä¸­æ–­æœåŠ¡ç¨‹åºæ—¶ï¼Œå¯¹æ–°çš„ä¸­æ–­è¯·æ±‚ä¸äºˆç†ç¬</li>\n<li>ä¸¤è€…åŒºåˆ«ï¼šå¼€ä¸­æ–­åœ¨ä¿æŠ¤ç°åœºåé¢<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c2fcdb7566ae66cd532a2.png\" alt=\"37.PNG\"></li>\n</ul>\n<h2>5.9. DMAæ–¹å¼</h2>\n<ul>\n<li>DMAä¸ä¸»å­˜äº¤æ¢æ•°æ®ä½¿é‡‡ç”¨çš„æ–¹æ³•\n<ul>\n<li>åœæ­¢CPUè®¿é—®ä¸»å­˜\n<ul>\n<li>å½“å¤–è®¾è¦ä¼ é€ä¸€æ‰¹æ•°æ®æ—¶ï¼Œç”±DMAæ¥å£å‘CPUå‘ä¸€ä¸ªåœæ­¢ä¿¡å·ï¼Œè¦æ±‚CPUæ”¾å¼ƒåœ°å€çº¿ã€æ•°æ®çº¿å’Œæœ‰å…³æ§åˆ¶çº¿çš„ä½¿ç”¨æƒ</li>\n<li>æ§åˆ¶ç®€å•ï¼Œé€‚ç”¨äºæ•°æ®ä¼ è¾“ç‡å¾ˆé«˜çš„I/Oè®¾å¤‡å®ç°æˆç»„æ•°æ®çš„ä¼ é€</li>\n<li>ç¼ºç‚¹æ˜¯DMAæ¥å£åœ¨è®¿é—®ä¸»å­˜æ—¶ï¼ŒCPUåŸºæœ¬ä¸Šå¤„äºä¸å·¥ä½œçŠ¶æ€æˆ–ä¿æŒåŸçŠ¶æ€</li>\n<li>è€Œä¸”å³ä½¿I/Oè®¾å¤‡é«˜é€Ÿè¿è¡Œï¼Œä¸¤ä¸ªæ•°æ®ä¹‹é—´çš„å‡†å¤‡é—´éš”æ—¶é—´ä¹Ÿæ€»å¤§äºä¸€ä¸ªå­˜å–å‘¨æœŸ</li>\n<li>å› æ­¤ï¼ŒCPUå¯¹ä¸»å­˜çš„åˆ©ç”¨ç‡å¹¶æ²¡å¾—åˆ°å……åˆ†çš„å‘æŒ¥</li>\n</ul>\n</li>\n<li>å‘¨æœŸæŒªç”¨ï¼ˆå¹¿æ³›ä½¿ç”¨ï¼‰\n<ul>\n<li>æ¯å½“I/Oè®¾å¤‡å‘å‡ºDMAè¯·æ±‚æ—¶ï¼ŒI/Oè®¾å¤‡ä¾¿æŒªç”¨æˆ–çªƒå–æ€»çº¿å ç”¨å…¨ä¸€ä¸ªæˆ–å‡ ä¸ªä¸»å­˜å‘¨æœŸ</li>\n<li>I/Oè®¾å¤‡æ¯æŒªç”¨ä¸€ä¸ªä¸»å­˜å‘¨æœŸéƒ½è¦ç”³è¯·æ€»çº¿æ§åˆ¶æƒï¼Œå»ºç«‹æ€»çº¿æ§åˆ¶æƒå’Œå½’è¿˜æ€»çº¿æ§åˆ¶æƒ</li>\n<li>å°½ç®¡ä¼ è¾“ä¸€ä¸ªå­—å¯¹ä¸»å­˜è€Œè¨€åªå ç”¨ä¸€ä¸ªä¸»å­˜å‘¨æœŸï¼Œä½†å¯¹DMAæ¥å£è€Œè¨€ï¼Œå®è´¨ä¸Šè¦å 2-5ä¸ªä¸»å­˜å‘¨æœŸï¼ˆç”±é€»è¾‘çº¿è·¯çš„å»¶è¿Ÿç‰¹æ€§è€Œå®šï¼‰ï¼Œé€‚ç”¨äºI/Oè®¾å¤‡è¯»å†™å‘¨æœŸå¤§äºä¸»å­˜å‘¨æœŸçš„æƒ…å†µ</li>\n</ul>\n</li>\n<li>DMAä¸CPUäº¤æ›¿è®¿é—®\n<ul>\n<li>é€‚åˆCPUå·¥ä½œå‘¨æœŸæ¯”ä¸»å­˜å­˜å–å‘¨æœŸé•¿çš„æƒ…å†µ</li>\n<li>ä¸éœ€è¦æ€»çº¿ä½¿ç”¨æƒçš„ç”³è¯·ã€å»ºç«‹å’Œå½’è¿˜è¿‡ç¨‹</li>\n<li>CPUä¸åœæ­¢ä¸»ç¨‹åºè¿è¡Œï¼Œä¸ç­‰å¾…ï¼Œä¹Ÿå®Œæˆäº†DMAæ•°æ®ä¼ é€</li>\n<li>ç¡¬ä»¶é€»è¾‘å¤æ‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>DMAæ¥å£çš„åŠŸèƒ½å’Œç»„æˆ\n<ul>\n<li>å‘CPUç”³è¯·DMAä¼ é€</li>\n<li>åœ¨CPUå…è®¸DMAå·¥ä½œæ—¶ï¼Œå¤„ç†æ€»çº¿æ§åˆ¶æƒçš„è½¬äº¤</li>\n<li>åœ¨DMAæœŸé—´ç®¡ç†ç³»ç»Ÿæ€»çº¿ï¼Œæ§åˆ¶æ•°æ®ä¼ é€</li>\n<li>ç¡®å®šå’Œä¿®æˆæ•°æ®ä¼ é€çš„èµ·å§‹åœ°å€å’Œæ•°æ®é•¿åº¦ï¼Œä¿®æ­£æ•°æ®ä¼ é€è¿‡ç¨‹ä¸­çš„æ•°æ®åœ°å€å’Œæ•°æ®é•¿åº¦</li>\n<li>åœ¨æ•°æ®å—ä¼ é€ç»“æŸæ—¶ï¼Œç»™å‡ºDMAæ“ä½œå®Œæˆçš„ä¿¡å·</li>\n</ul>\n</li>\n<li>DMAç‰¹ç‚¹\n<ul>\n<li>ä»æ•°æ®ä¼ é€çœ‹ï¼Œç¨‹åºä¸­æ–­æ–¹å¼é ç¨‹åºä¼ é€ï¼ŒDMAæ–¹å¼é ç¡¬ä»¶ä¼ é€</li>\n<li>ä»CPUå“åº”æ—¶é—´çœ‹ï¼Œç¨‹åºä¸­æ–­åœ¨ä¸€æ¡æŒ‡ä»¤æ‰§è¡Œç»“æŸæ—¶å“åº”ï¼Œè€ŒDMAæ–¹å¼å¯åœ¨æŒ‡ä»¤å‘¨æœŸå†…ä»»æ„å­˜å–å‘¨æœŸç»“æŸæ—¶å“åº”</li>\n<li>ç¨‹åºä¸­æ–­æ–¹å¼æœ‰å¤„ç†å¼‚å¸¸æ—¶é—´èƒ½åŠ›ï¼ŒDMAæ²¡æœ‰ï¼Œä¸»è¦ç”¨äºå¤§æ‰¹æ•°æ®çš„ä¼ é€</li>\n<li>ç¨‹åºä¸­æ–­æ–¹å¼éœ€è¦ä¸­æ–­ç°è¡Œç¨‹åºï¼Œæ•…éœ€ä¿æŠ¤ç°åœºï¼ŒDMAä¸éœ€è¦</li>\n<li>DMAä¼˜å…ˆçº§æ¯”ç¨‹åºä¸­æ–­é«˜</li>\n</ul>\n</li>\n</ul>\n<h1>6. è®¡ç®—æœºçš„è¿ç®—æ–¹æ³•</h1>\n<h2>6.1. è¿›åˆ¶çš„æ¦‚è¿°</h2>\n<ul>\n<li>å¸¸è§è¿›åˆ¶ï¼šäºŒè¿›åˆ¶ã€åè¿›åˆ¶ã€å…«è¿›åˆ¶ã€åå…­è¿›åˆ¶ï¼ˆç½‘å¡macåœ°å€ï¼‰ã€å…­åè¿›åˆ¶ï¼ˆæ—¶é’Ÿï¼‰</li>\n<li>äºŒè¿›åˆ¶è¿ç®—åŸºç¡€\n<ul>\n<li>ä»»ä½•è¿›åˆ¶è¡¨ç¤º N = dn * r^n-1 +...+ d1 * r^1 + d0</li>\n<li>äºŒè¿›åˆ¶æ•´æ•°è½¬åè¿›åˆ¶ï¼ˆæŒ‰æƒå±•å¼€æ³•ï¼‰N = (01100101) = 1 * 2^6 + 1 * 2^5 + 1*2^2 + 1 = 101</li>\n<li>åè¿›åˆ¶æ•´æ•°è½¬äºŒè¿›åˆ¶ï¼ˆé‡å¤ç›¸é™¤æ³•ï¼‰N = (01100101) = 1 * 2^6 + 1 * 2^5 + 1*2^2 + 1 = 101<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/90a2e411c0c74485b9e47.png\" alt=\"38.PNG\"></li>\n<li>äºŒè¿›åˆ¶å°æ•°è½¬åè¿›åˆ¶ï¼ˆæŒ‰æƒå±•å¼€æ³•ï¼‰N = ï¼ˆ0.11001ï¼‰ = 1 * 2^-1 + 1 *2 ^-2 + 1 * 2^-5 - 0.78125 = 25/32</li>\n<li>åè¿›åˆ¶å°æ•°è½¬äºŒè¿›åˆ¶ï¼ˆé‡å¤ç›¸ä¹˜æ³•ï¼‰N = ï¼ˆ0.11001ï¼‰ = 1 * 2^-1 + 1 *2 ^-2 + 1 * 2^-5 - 0.78125 = 25/32<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/33fabec9c0a874b4f5b92.png\" alt=\"39.PNG\"></li>\n</ul>\n</li>\n</ul>\n<h2>6.2. è®¡ç®—æœºä¸­çš„æ•°</h2>\n<ul>\n<li>è®¡ç®—æœºä¸­çš„æ•°å‡æ”¾åœ¨å¯„å­˜å™¨ä¸­ï¼Œé€šå¸¸å¯„å­˜å™¨çš„ä½æ•°ä¸ºæœºå™¨å­—é•¿ã€‚</li>\n<li>å‚ä¸è¿ç®—çš„æ•°\n<ul>\n<li>æ— ç¬¦å·æ•°ï¼šæ²¡æœ‰ç¬¦å·çš„æ•°ï¼Œåœ¨å¯„å­˜å™¨ä¸­çš„æ¯ä¸€ä½éƒ½å¯ç”¨æ¥å­˜æ”¾æ•°å€¼</li>\n<li>æœ‰ç¬¦å·æ•°ï¼šéœ€æµå‡ºä½ç½®å­˜æ”¾ç¬¦å·</li>\n</ul>\n</li>\n<li>åŸç è¡¨ç¤ºæ³•\n<ul>\n<li>æœ€å·¦è¾¹ç¬¦å·ä½ä½¿ç”¨0è¡¨ç¤ºæ­£æ•°ã€1è¡¨ç¤ºè´Ÿæ•°,ç”¨é€—å·å°†ç¬¦å·ä½å’Œæ•°å€¼éš”å¼€ï¼Œç”¨å°æ•°ç‚¹å°†å°æ•°çš„ç¬¦å·ä½å’Œæ•°å€¼éš”å¼€</li>\n<li>0æœ‰ä¸¤ç§è¡¨ç¤ºæ–¹æ³•ï¼š00ã€10</li>\n</ul>\n</li>\n<li>è¡¥ç è¡¨ç¤ºæ³•\n<ul>\n<li>åŸç è¿›è¡Œè¿ç®—éå¸¸å¤æ‚ï¼Œç‰¹åˆ«æ˜¯ä¸¤ä¸ªæ“ä½œæ•°ç¬¦å·ä¸åŒçš„æ—¶å€™ï¼Œéœ€è¦åˆ¤æ–­ä¸¤ä¸ªæ“ä½œæ•°ç»å¯¹å€¼å¤§å°ï¼Œä½¿ç”¨ç»å¯¹å€¼å¤§çš„æ•°å‡å»ç»å¯¹å€¼å°çš„æ•°ï¼Œå¯¹äºç¬¦å·å€¼ã€ä»¥ç»å¯¹å€¼å¤§çš„ä¸ºå‡†ï¼›å¸Œæœ›æ‰¾åˆ°ä¸åŒç¬¦å·æ“ä½œæ•°æ›´åŠ ç®€å•çš„è¿ç®—æ–¹æ³•ï¼›å¸Œæœ›æ‰¾åˆ°ä½¿ç”¨æ­£æ•°ä»£æ›¿è´Ÿæ•°çš„æ–¹æ³•ï¼›ä½¿ç”¨åŠ æ³•æ“ä½œä»£æ›¿å‡æ³•æ“ä½œï¼Œä»è€Œæ¶ˆé™¤å‡æ³•</li>\n<li>æ­£æ•°çš„è¡¥ç æ˜¯æœ¬èº«ï¼Œè´Ÿæ•°çš„è¡¥ç æ˜¯åŸç åŸºç¡€ä¸Šç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™å„ä½å–åååŠ 1ï¼ˆåç +1ï¼‰</li>\n</ul>\n</li>\n<li>åç è¡¨ç¤ºæ³•\n<ul>\n<li>åç çš„ç›®çš„æ˜¯æ‰¾å‡ºæºç å’Œè¡¥ç ä¹‹é—´çš„è§„å¾‹ã€æ¶ˆé™¤è½¬æ¢è¿‡ç¨‹ä¸­çš„å‡æ³•</li>\n<li>åç ä¸­çš„0ä¹Ÿæœ‰2ç§è¡¨è¾¾æ–¹å¼</li>\n<li>æ­£æ•°çš„åç æ˜¯æœ¬èº«ï¼Œè´Ÿæ•°çš„åç æ˜¯åŸç åŸºç¡€ä¸Šç¬¦å·ä½ä¸å˜ï¼Œå…¶ä½™å„ä½å–å</li>\n</ul>\n</li>\n</ul>\n<h2>6.3. æ•°çš„å®šç‚¹è¡¨ç¤ºå’Œæµ®ç‚¹è¡¨ç¤º</h2>\n<ul>\n<li>å°æ•°ç‚¹çš„è¡¨ç¤ºæ–¹æ³•\n<ul>\n<li>å®šç‚¹è¡¨ç¤ºï¼ˆçº¯å°æ•°ã€çº¯æ•´æ•°ï¼‰ï¼šå®šç‚¹è¡¨ç¤ºæ•°ç§°ä¸ºå®šç‚¹æ•°ã€‚å°æ•°ç‚¹å›ºå®šåœ¨æŸä¸ªä½ç½®çš„æ•°ç§°ä¸ºå®šç‚¹æ•°</li>\n<li>æµ®ç‚¹è¡¨ç¤ºï¼Œæµ®ç‚¹è¡¨ç¤ºçš„æ•°ç§°ä¸ºæµ®ç‚¹æ•°ï¼šè®¡ç®—æœºå¤„ç†çš„å¾ˆå¤§ç¨‹åº¦ä¸Šä¸æ˜¯çº¯å°æ•°æˆ–çº¯æ•´æ•°ã€‚æ•°æ®èŒƒå›´å¾ˆå¤§ï¼Œå®šç‚¹æ•°éš¾ä»¥è¡¨è¾¾ã€‚</li>\n</ul>\n</li>\n<li>æµ®ç‚¹æ•°çš„è¡¨ç¤ºå½¢å¼ï¼ˆç§‘å­¦è®¡æ•°æ³•ï¼‰\n<ul>\n<li>123450000000 = 1.2345x10^11ï¼ˆå°¾æ•°ï¼š1.2345ã€åŸºæ•°ï¼š10ã€é˜¶ç ï¼š11ï¼‰</li>\n<li>N = S * r^j ï¼ˆå°¾æ•°ï¼šsï¼ˆè§„å®šä½¿ç”¨çº¯å°æ•°ï¼‰ åŸºæ•°ï¼šr ï¼ˆ2,4,8,16ï¼‰é˜¶ç ï¼šjï¼‰</li>\n<li>é˜¶ç ç¬¦å·ä½ã€é˜¶ç æ•°å€¼ä½ã€å°¾æ•°ç¬¦å·ä½ã€å°¾æ•°æ•°å€¼ä½</li>\n<li>å°¾æ•°ä½æ•°nååº”æµ®ç‚¹æ•°ç²¾åº¦ï¼Œé˜¶ç¬¦å’Œé˜¶ç ä½æ•°måˆèµ·æ¥ååº”æµ®ç‚¹æ•°çš„è¡¨ç¤ºèŒƒå›´å’Œå®é™…ä½ç½®</li>\n<li>å°¾æ•°è§„å®šä½¿ç”¨çº¯å°æ•°ï¼Œå°†å°¾æ•°æœ€é«˜ä½ä¸º1çš„æµ®ç‚¹æ•°ç§°ä¸ºè§„æ ¼åŒ–æ•° ï¼Œå…¶ç²¾åº¦æœ€é«˜ï¼Œä¸ºäº†æé«˜ç²¾åº¦å¿…é¡»è§„æ ¼åŒ–</li>\n<li>åŸºæ•°rè¶Šå¤§ï¼Œå¯è¡¨ç¤ºçš„æµ®ç‚¹æ•°èŒƒå›´è¶Šå¤§ï¼Œè¡¨ç¤ºçš„æ•°çš„ä¸ªæ•°è¶Šå¤šï¼Œä½†ç²¾åº¦åè€Œä¸‹é™</li>\n</ul>\n</li>\n<li>æµ®ç‚¹æ•°çš„è¡¨ç¤ºèŒƒå›´\n<ul>\n<li>å‡è®¾é˜¶ç æ•°å€¼å–mä½ï¼Œå°¾æ•°æ•°å€¼å–nä½</li>\n<li>é˜¶ç èŒƒå›´ï¼š[-(2^m - 1),2^m - 1]</li>\n<li>å°¾æ•°èŒƒå›´ï¼š[-(1-2^-n),-(2^-n)] [2^-n,1-2^-n]</li>\n<li>å½“æµ®ç‚¹æ•°é˜¶ç å¤§äºæœ€å¤§é˜¶ç ç§°ä¸ºä¸Šæº¢ï¼Œå°äºæœ€å°é˜¶ç æ˜¯ç§°ä¸ºä¸‹æº¢<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c3af2d2b57a8f8b280ff6.png\" alt=\"40.PNG\"><br>\nå•ç²¾åº¦æµ®ç‚¹æ•°ï¼šä½¿ç”¨4å­—èŠ‚ã€32ä½æ¥è¡¨è¾¾æµ®ç‚¹æ•°<br>\nåŒç²¾åº¦æµ®ç‚¹æ•°ï¼šä½¿ç”¨8å­—èŠ‚ã€64ä½æ¥è¡¨è¾¾æµ®ç‚¹æ•°</li>\n</ul>\n</li>\n<li>å®šç‚¹æ•°å’Œæµ®ç‚¹æ•°çš„å¯¹æ¯”\n<ul>\n<li>å½“å®šç‚¹æ•°ä¸æµ®ç‚¹æ•°ä½æ•°ç›¸åŒæ—¶ï¼Œæµ®ç‚¹æ•°è¡¨ç¤ºçš„èŒƒå›´æ›´å¤§</li>\n<li>å½“æµ®ç‚¹æ•°ä½æ•°ä¸ºè§„æ ¼åŒ–æ•°æ—¶ï¼Œæµ®ç‚¹æ•°çš„ç›¸å¯¹ç²¾åº¦æ›´é«˜</li>\n<li>æµ®ç‚¹æ•°è¿ç®—åŒ…å«é˜¶ç å’Œå°¾æ•°ï¼Œè¿ç®—ç»“æœè¦æ±‚è§„æ ¼åŒ–ï¼Œæ•…æµ®ç‚¹æ•°è¿ç®—æ­¥éª¤å¤šï¼Œæµ®ç‚¹æ•°çš„è¿ç®—æ›´ä¸ºå¤æ‚</li>\n<li>åœ¨æº¢å‡ºçš„åˆ¤æ–­æ–¹æ³•ä¸Šï¼Œæµ®ç‚¹æ•°æ˜¯å¯¹è§„æ ¼åŒ–æ•°çš„é˜¶ç è¿›è¡Œåˆ¤æ–­ï¼Œå®šç‚¹æ•°æ˜¯å¯¹æ•°å€¼æœ¬èº«è¿›è¡Œåˆ¤æ–­</li>\n<li>æµ®ç‚¹æ•°åœ¨æ•°çš„è¡¨ç¤ºèŒƒå›´ã€ç²¾åº¦ã€æº¢å‡ºå¤„ç†ã€ç¼–ç¨‹ç­‰å½“é¢å‡ä¼˜äºå®šç‚¹æ•°</li>\n<li>æµ®ç‚¹æ•°åœ¨æ•°çš„è¿ç®—è§„åˆ™ã€è¿ç®—é€Ÿåº¦ã€ç¡¬ä»¶æˆæœ¬æ–¹é¢ä¸å¦‚å®šç‚¹æ•°</li>\n</ul>\n</li>\n</ul>\n<h2>6.4. å®šç‚¹æ•°çš„åŠ å‡æ³•</h2>\n<ul>\n<li>æ•´æ•°åŠ æ³•ï¼š[A]è¡¥ + [B]è¡¥ = [A+B]è¡¥ï¼ˆmod2^n+1ï¼‰</li>\n<li>å°æ•°åŠ æ³•ï¼š[A]è¡¥ + [B]è¡¥ = [A+B]è¡¥ï¼ˆmod2ï¼‰</li>\n<li>æ•´æ•°å‡æ³•ï¼š[A-B]è¡¥ = [A]è¡¥ + [-B]è¡¥ï¼ˆmod2^n+1ï¼‰-&gt;[-B]è¡¥ = [B]è¡¥ è¿åŒç¬¦å·ä½æŒ‰ä½å–å,æœ«ä½+1</li>\n<li>å°æ•°å‡æ³•ï¼š[A-B]è¡¥ = [A]è¡¥ + [-B]è¡¥ï¼ˆmod2ï¼‰-&gt;[-B]è¡¥ = [B]è¡¥ è¿åŒç¬¦å·ä½æŒ‰ä½å–å,æœ«ä½+1</li>\n<li>æ•°å€¼ä½ä¸ç¬¦å·ä½ä¸€åŒè¿ç®—ï¼Œå¹¶å°†ç¬¦å·ä½äº§ç”Ÿçš„è¿›ä½è‡ªç„¶ä¸¢æ‰</li>\n<li>åˆ¤æ–­æº¢å‡ºï¼š\n<ul>\n<li>ä¸€ä½ç¬¦å·åˆ¤æ–­æº¢å‡ºï¼šæ— è®ºåŠ æ³•è¿˜æ˜¯å‡æ³•ï¼Œåªè¦å®é™…å‚åŠ æ“ä½œçš„ä¸¤ä¸ªæ•°ç¬¦å·ç›¸åŒï¼Œç»“æœåˆä¸åŸæ“ä½œæ•°ä¸åŒï¼Œå³ä¸ºæº¢å‡ºï¼Œä¸ºäº†èŠ‚çœæ—¶é—´ï¼Œé€šå¸¸ç”¨ç¬¦å·ä½äº§ç”Ÿçš„è¿›ä½ä¸æœ€é«˜æœ‰æ•ˆä½äº§ç”Ÿçš„è¿›ä½äº¦æˆ–æ“ä½œåï¼Œç»“æœä¸º1è¡¨ç¤ºæº¢å‡ºï¼Œå¦åˆ™æ— æº¢å‡º</li>\n<li>åŒç¬¦å·ä½åˆ¤æ–­æ³•ï¼šå•ç¬¦å·ä¸ºè¡¨ç¤ºå˜æˆåŒç¬¦å·ä½ï¼š0=&gt;00,i=&gt;11ï¼ŒåŒç¬¦å·ä½äº§ç”Ÿçš„è¿›ä½ä¸¢å¼ƒï¼Œç»“æœçš„åŒç¬¦å·ä¸ºä¸åŒåˆ™è¡¨ç¤ºæº¢å‡ºã€‚01æ­£æº¢å‡ºï¼Œ10è´Ÿæº¢å‡º</li>\n</ul>\n</li>\n</ul>\n<h2>6.5. å®šç‚¹æ•°ä¹˜æ³•è¿ç®—</h2>\n<ul>\n<li>ä¹˜æ³•è¿ç®—å¯ç”¨ç§»ä½å’ŒåŠ æ³•å®ç°</li>\n<li>ç”±ä¹˜æ•°çš„æœ«ä½å€¼ç¡®å®šè¢«ä¹˜æ•°æ˜¯å¦ä¸åŸéƒ¨åˆ†ç§¯ç›¸åŠ ï¼Œç„¶åå³ç§»ä¸€ä½ï¼Œå½¢æˆæ–°çš„éƒ¨åˆ†ç§¯ï¼›åŒæ—¶ï¼Œä¹˜æ•°ä¹Ÿå³ç§»ä¸€ä½ï¼Œç”±æ¬¡ä½ä½ä½œæ–°çš„æœ«ä½ï¼Œç©ºå‡ºæœ€é«˜ä½æ”¾éƒ¨åˆ†ç§¯çš„æœ€ä½ä½ã€‚</li>\n<li>æ¯æ¬¡åšåŠ æ³•æ—¶ï¼Œè¢«ä¹˜æ•°ä»…ä»…ä¸åŸéƒ¨åˆ†ç§¯çš„é«˜ä½ç›¸åŠ ï¼Œå…¶ä½ä½è¢«ç§»è‡³ä¹˜æ•°æ‰€ç©ºå‡ºçš„é«˜ä½ä½ç½®ã€‚<br>\nä¾‹2.X=0.0010ï¼ŒY=-0.1101ï¼ŒXY=ï¼Ÿ<br>\nè¢«ä¹˜æ•°A=|X|=00.0010,ä¹˜æ•°B=|Y|=0.1101<br>\n1.Bçš„æœ«ä½æ˜¯1,Aéœ€è¦åŠ B,å¾—åˆ°00.0000+00.0010=00.0010,å³ç§»ä¸€ä½å¾—åˆ°00.0001(éƒ¨åˆ†ç§¯),Bå³ç§»ä¸€ä½å¾—åˆ°10.110<br>\n2.Bçš„æœ«ä½æ˜¯0,Aéœ€è¦åŠ B,å¾—åˆ°00.0001+00.0000=00.0001,å³ç§»ä¸€ä½å¾—åˆ°00.0000(éƒ¨åˆ†ç§¯),Bå³ç§»ä¸€ä½å¾—åˆ°110.11<br>\n3.Bçš„æœ«ä½æ˜¯1,Aéœ€è¦åŠ B,å¾—åˆ°00.0000+00.0010=00.0010,å³ç§»ä¸€ä½å¾—åˆ°00.0001(éƒ¨åˆ†ç§¯),Bå³ç§»ä¸€ä½å¾—åˆ°1110.1<br>\n4.Bçš„æœ«ä½æ˜¯1,Aéœ€è¦åŠ B,å¾—åˆ°00.0001+00.0010=00.0011,å³ç§»ä¸€ä½å¾—åˆ°00.0001(éƒ¨åˆ†ç§¯),Bå³ç§»ä¸€ä½å¾—åˆ°11110<br>\n5.æœ€åç»“æœ1.00011010ã€‚ï¼ˆå¯¹äºç»“æœæ­£è´Ÿï¼Œåªéœ€å°†X,Yä¸¤ä¸ªæ•°ç¬¦å·ä½åšå¼‚æˆ–ã€‚åŒå·ä¸ºæ­£ï¼Œå¼‚å·ä¸ºè´Ÿï¼‰</li>\n</ul>\n<h2>6.6. å®šç‚¹æ•°é™¤æ³•è¿ç®—</h2>\n<h2>6.7. æµ®ç‚¹æ•°çš„åŠ å‡æ³•</h2>\n<pre><code>    å¯¹é˜¶-&gt;å°¾æ•°æ±‚å’Œ-&gt;å°¾æ•°è§„æ ¼åŒ–-&gt;èˆå…¥-&gt;æº¢å‡ºåˆ¤æ–­\n        x = 0.1101 x 2^01 ,y = -0.1010 x 2^11 è®¡ç®—x+y\n    å¯¹é˜¶ï¼š\n        é˜¶ç æŒ‰å°é˜¶å¯¹é½å¤§é˜¶çš„åŸåˆ™\n        å¯¹é˜¶çš„ç›®çš„æ˜¯ä½¿å¾—ä¸¤ä¸ªæµ®ç‚¹æ•°é˜¶ç ä¸€è‡´ï¼Œä½¿å¾—å°¾æ•°å¯ä»¥è¿›è¡Œè¿ç®—\n        å¯¹é˜¶å 0.1101 x 2^01 -&gt; 0.001101 x 2^11\n    å°¾æ•°æ±‚å’Œ\n        ä½¿ç”¨è¡¥ç è¿›è¡Œå°æ•°çš„åŠ å‡æ³•ï¼Œä½¿ç”¨åŒç¬¦å·ä½\n        [x]åŸ = 00.0011 [x]è¡¥ = 00.0011\n        [y]åŸ = 11.1010 [y]è¡¥ = 11,0110\n        S = [x+y]è¡¥ = 11.1001ï¼ˆè¿›ä½mod2æ¶ˆæ‰ï¼‰\n    å°¾æ•°è§„æ ¼åŒ–\n        [S]è¡¥ = 00.1xxxxxxï¼ˆS&gt;0ï¼‰\n        [S]è¡¥ = 11.0xxxxxxï¼ˆS&lt;0ï¼‰\n        å·¦è§„ï¼š00.0xxxxx æˆ–11.1xxxå°¾æ•°å·¦ç§»ï¼Œé˜¶ç åŠ  å³:è‹¥ç¬¦å·ä½ä¸æœ€é«˜ä½ä¸ä¸€è‡´,éœ€è¦è¿›è¡Œå·¦è§„ï¼Œ\n        å³è§„ï¼š01.0xxxxx æˆ–10.xxxå°¾æ•°å³ç§»ï¼Œé˜¶ç å‡ å³:ç¬¦å·ä½ä¸ä¸€è‡´åˆ™å³è§„\n        11.1001ä¸æ»¡è¶³-&gt;(1)11.001(0)å·¦ç§»-&gt;11.0010\n    èˆå…¥\n        å½“å³è§„æ—¶ï¼Œæ‰éœ€è¦èˆå…¥ï¼Œå› ä¸ºå³è§„å°¾æ•°ä½ä½ä¸¢å¤±ï¼Œå¼•èµ·è¯¯å·®ï¼Œä¸¢å¤±ç²¾åº¦ï¼Œä½¿ç”¨èˆå…¥æé«˜ç²¾åº¦\n        0èˆ1å…¥ï¼šè¢«ç§»å»çš„æœ€é«˜ä½ä¸º1åˆ™æœ«ä½+1ï¼Œå¦åˆ™ä¸å˜\n</code></pre>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c1bdf6abd172a57c4efc4.png\" alt=\"40.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/323d182b0822f749168e4.png\" alt=\"41.PNG\"><br>\næº¢å‡ºï¼š<br>\nå®šç‚¹è¿ç®—ç¬¦å·ä½ä¸ä¸€è‡´ä¸ºæº¢å‡º<br>\næµ®ç‚¹è¿ç®—å°¾æ•°åŒç¬¦å·ä½ä¸ä¸€è‡´ä¸ç®—æº¢å‡ºï¼Œå› ä¸ºå°¾æ•°åŒç¬¦å·å¯ä»¥è¿›è¡Œå³è§„<br>\næµ®ç‚¹è¿ç®—ä¸»è¦é€šè¿‡é˜¶ç çš„åŒç¬¦å·ä½åˆ¤æ–­æ˜¯å¦æº¢å‡º<br>\nå¦‚æœè§„æ ¼åŒ–åï¼Œé˜¶ç åŒç¬¦å·ä½ä¸ä¸€è‡´ï¼Œåˆ™è®¤ä¸ºæ˜¯æº¢å‡º<br>\n[x]è¡¥ = 01,xxxxä¸Šæº¢<br>\n[x]è¡¥ = 10,xxxxä¸‹æº¢,æŒ‰æœºå™¨é›¶å¤„ç†</p>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5bdcb2ff68d462511f3f0.png\" alt=\"42.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/568bc0addc5c68dec5d3d.png\" alt=\"43.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ad871a13df917034af41e.png\" alt=\"44.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/dfc2d9cbbb8d81d234162.png\" alt=\"45.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d3ed7d3f2499664d185bc.png\" alt=\"46.PNG\"><br>\næµ®ç‚¹æ•°çš„ä¹˜é™¤æ³•è¿ç®—<br>\nä¹˜æ³•ï¼šé˜¶ç ç›¸åŠ ï¼Œå°¾æ•°æ±‚ç§¯<br>\né™¤æ³•ï¼šé˜¶ç ç›¸å‡ï¼Œå°¾æ•°æ±‚å•†<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c23719ed84b26b05301b9.png\" alt=\"49.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/99223cfe689840a5b62dc.png\" alt=\"50.PNG\"></p>\n<h1>7. æŒ‡ä»¤ç³»ç»Ÿ</h1>\n<h2>7.1. æœºå™¨æŒ‡ä»¤</h2>\n<ul>\n<li>æœºå™¨æŒ‡ä»¤:æ¯ä¸€æ¡æœºå™¨è¯­è¨€ç§°ä¸ºæœºå™¨æŒ‡ä»¤</li>\n<li>æŒ‡ä»¤ç³»ç»Ÿ:å…¨éƒ¨æœºå™¨æŒ‡ä»¤çš„é›†åˆã€æœºå™¨çš„æŒ‡ä»¤ç³»ç»Ÿé›†ä¸­åæ˜ äº†æœºå™¨çš„åŠŸèƒ½</li>\n<li>æŒ‡ä»¤æ˜¯ç”±æ“ä½œç å’Œåœ°å€ç ç»„æˆ\n<ul>\n<li>æ“ä½œç ï¼šæŒ‡æ˜æŒ‡ä»¤è¦å®Œæˆçš„æ“ä½œï¼Œä½æ•°åæ˜ äº†æœºå™¨çš„æ“ä½œç§ç±»ï¼ˆæœºå™¨å…è®¸çš„æŒ‡ä»¤æ¡æ•°ï¼‰ã€‚å¦‚æ“ä½œç å 7ä½ï¼Œåˆ™è¯¥æœºå™¨æœ€å¤šåŒ…å«2^7=128æ¡æŒ‡ä»¤</li>\n<li>åœ°å€ç ï¼šæŒ‡å‡ºè¯¥æŒ‡ä»¤çš„æºæ“ä½œæ•°çš„åœ°å€ï¼ˆä¸€ä¸ªæˆ–ä¸¤ä¸ªï¼‰ã€ç»“æœçš„åœ°å€ä»¥åŠä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ã€åœ°å€åŒ…æ‹¬ä¸»å­˜ã€å¯„å­˜å™¨ã€I/Oè®¾å¤‡çš„åœ°å€</li>\n</ul>\n</li>\n<li>å››åœ°å€æŒ‡ä»¤ï¼šåŒ…æ‹¬OPæ“ä½œç ï¼ŒA1ç¬¬ä¸€æ“ä½œæ•°åœ°å€ã€A2ç¬¬äºŒæ“ä½œæ•°åœ°å€ã€A3ç»“æœåœ°å€ã€A4ä¸‹ä¸€æ¡æŒ‡ä»¤åœ°å€ã€‚å®Œæˆ(A1)OP(A2)-&gt;A3æ“ä½œ</li>\n<li>ä¸‰åœ°å€æŒ‡ä»¤ï¼šåŒ…æ‹¬OPæ“ä½œç ï¼ŒA1ç¬¬ä¸€æ“ä½œæ•°åœ°å€ã€A2ç¬¬äºŒæ“ä½œæ•°åœ°å€ã€A3ç»“æœåœ°å€ï¼Œå®Œæˆ(A1)OP(A2)-&gt;A3æ“ä½œï¼Œåç»­æŒ‡ä»¤çš„åœ°å€éšå«åœ¨ç¨‹åºè®¡æ•°å™¨PCä¸­</li>\n<li>äºŒåœ°å€æŒ‡ä»¤ï¼šåŒ…æ‹¬OPæ“ä½œç ï¼Œå®Œæˆ(A1)OP(A2)-&gt;A1æ“ä½œï¼Œæ­¤æ—¶A1å­—æ®µæ—¢ä»£è¡¨æ“ä½œæ•°çš„åœ°å€ï¼Œåˆä»£è¡¨å­˜æ”¾æœ¬æ¬¡ç»“æœçš„åœ°å€.æˆ–è€…å®Œæˆ(A1)OP(A2)-&gt;A1æ“ä½œï¼Œæ­¤æ—¶A2é™¤äº†ä»£è¡¨æºæ“ä½œæ•°çš„åœ°å€å¤–ï¼Œè¿˜ä»£è¡¨ä¸­é—´ç»“æœçš„å­˜æ”¾åœ°å€</li>\n<li>ä¸€åœ°å€æŒ‡ä»¤ï¼šåŒ…æ‹¬OPæ“ä½œç ï¼ŒACCæ—¢å­˜æ”¾å‚ä¸è¿ç®—çš„æ“ä½œæ•°ï¼Œåˆå­˜æ”¾è¿ç®—çš„ä¸­é—´ç»“æœã€‚å®Œæˆ(ACC)OP(A1)-&gt;ACCæ“ä½œã€å®Œæˆä¸€æ¡ä¸€åœ°å€æŒ‡ä»¤åªéœ€ä¸¤æ¬¡è®¿å­˜</li>\n<li>é›¶åœ°å€æŒ‡ä»¤ï¼šåŒ…æ‹¬æ— åœ°å€ç ï¼Œå¦‚ç©ºæ“ä½œï¼ˆNOPï¼‰ã€åœæœºï¼ˆHLTï¼‰è¿™ç±»æŒ‡ä»¤åªæœ‰æ“ä½œç ã€‚å­ç¨‹åºè¿”å›ï¼ˆRETï¼‰ã€ä¸­æ–­è¿”å›ï¼ˆIRETï¼‰è¿™ç±»æŒ‡ä»¤æ²¡æœ‰åœ°å€ç </li>\n<li>æŒ‡ä»¤å­—é•¿ï¼šæŒ‡ä»¤å­—é•¿å–å†³äºæ“ä½œç çš„é•¿åº¦ã€æ“ä½œæ•°åœ°å€çš„é•¿åº¦å’Œæ“ä½œæ•°åœ°å€çš„ä¸ªæ•°</li>\n</ul>\n<h2>7.2. æ“ä½œæ•°ç±»å‹</h2>\n<ul>\n<li>åœ°å€ï¼šåœ°å€å¯è¢«è®¤ä¸ºæ˜¯ä¸€ä¸ªæ— ç¬¦å·çš„æ•´æ•°</li>\n<li>æ•°å­—ï¼šè®¡ç®—æœºå¸¸è§çš„æ•°å­—æœ‰å®šç‚¹æ•°ã€æµ®ç‚¹æ•°å’Œåè¿›åˆ¶æ•°</li>\n<li>å­—ç¬¦ï¼šASCIIç ï¼Œé‡è¦çš„å­—ç¬¦ç¼–ç </li>\n<li>é€»è¾‘æ•°æ®ï¼šé€»è¾‘è¿ç®—æ—¶ï¼Œnä¸ª0å’Œ1çš„ç»„åˆä¸æ˜¯è¢«çœ‹åšç®—æœ¯æ•°å­—è€Œæ˜¯è¢«çœ‹åšé€»è¾‘æ•°</li>\n</ul>\n<h2>7.3. æ“ä½œç±»å‹</h2>\n<ul>\n<li>æ•°æ®ä¼ é€ï¼šåŒ…æ‹¬å¯„å­˜å™¨ä¸å¯„å­˜å™¨ã€å¯„å­˜å™¨ä¸ç®—æœ¯å•å…ƒã€å­˜å‚¨å•å…ƒä¸å­˜å‚¨å•å…ƒä¹‹é—´çš„ä¼ é€ã€‚æ•°æ®å¯¹æ¥ã€äº¤æ¢åœ°å€æ•°æ®ã€æ¸…é›¶ç½®ä¸€ç­‰æ“ä½œ</li>\n<li>ç®—æœ¯é€»è¾‘æ“ä½œï¼šç®—æœ¯è¿ç®—ï¼ˆæ“ä½œæ•°ä¹‹é—´çš„åŠ å‡ä¹˜é™¤è¿ç®—ï¼‰å’Œé€»è¾‘è¿ç®—ï¼ˆä¸ï¼Œéï¼Œæˆ–ï¼Œå¼‚æˆ–ï¼‰</li>\n<li>ç§»ä½ï¼šç®—æœ¯ç§»ä½ã€é€»è¾‘ç§»ä½å’Œå¾ªç¯ç§»ä½ã€‚ç§»ä½æ“ä½œæ—¶é—´æ¯”ä¹˜é™¤æ“ä½œæ‰§è¡Œæ—¶é—´çŸ­ï¼Œç§»ä½æ“ä½œç»å¸¸è¢«ç”¨æ¥ä»£æ›¿ç®€å•çš„ä¹˜æ³•å’Œé™¤æ³•è¿ç®—ã€‚æ•°æ®å·¦ç§»ï¼ˆä¹˜2ï¼‰ã€æ•°æ®å³ç§»ï¼ˆé™¤2ï¼‰</li>\n<li>è½¬ç§»ï¼šæ”¹å˜è®¡ç®—æœºç¨‹åºæ‰§è¡ŒæŒ‡ä»¤é¡ºåº\n<ul>\n<li>æ— æ¡ä»¶è½¬ç§»</li>\n<li>æ¡ä»¶è½¬ç§»ï¼šæ ¹æ®å½“å‰æŒ‡ä»¤çš„æ‰§è¡Œç»“æœå†³å®šæ˜¯å¦éœ€è¦è½¬ç§»</li>\n<li>è°ƒç”¨ä¸è¿”å›\n<ul>\n<li>è°ƒç”¨æŒ‡ä»¤åŒ…æ‹¬è¿‡ç¨‹è°ƒç”¨ã€ç³»ç»Ÿè°ƒç”¨å’Œå­ç¨‹åºè°ƒç”¨ã€‚å®ç°ä¸€ä¸ªç¨‹åºè½¬ç§»åˆ°å¦ä¸€ä¸ªç¨‹åºçš„æ“ä½œ</li>\n<li>è°ƒç”¨æŒ‡ä»¤ï¼ˆCALLï¼‰ä¸€èˆ¬ä¸è¿”å›ï¼ˆRETURNï¼‰æŒ‡ä»¤é…åˆä½¿ç”¨.call ç”¨äºå½“å‰çš„ç¨‹åºä½ç½®è½¬è‡³å­ç¨‹åºçš„å…¥å£ï¼Œreturnç”¨äºå­ç¨‹åºæ‰§è¡Œå®Œåé‡æ–°å›åˆ°åŸç¨‹åºçš„æ–­ç‚¹</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é™·é˜±ä¸é™·é˜±æŒ‡ä»¤ï¼šé™·é˜±å…¶å®æ˜¯ä¸€ç§æ„å¤–äº‹æ•…çš„ä¸­æ–­ï¼Œä¸€æ—¦å‡ºç°æ„å¤–æ•…éšœï¼Œè®¡ç®—æœºå‘å‡ºé™·é˜±ä¿¡å·ï¼Œæš‚åœå½“å‰ç¨‹åºçš„æ‰§è¡Œï¼Œè½¬å…¥æ•…éšœå¤„ç†ç¨‹åºè¿›è¡Œç›¸åº”æ•…éšœå¤„ç†</li>\n<li>è¾“å…¥è¾“å‡ºï¼šå¯¹äºI/Oå•ç‹¬ç¼–å€çš„è®¡ç®—æœºï¼Œè®¾æœ‰è¾“å…¥è¾“å‡ºæŒ‡ä»¤</li>\n<li>å…¶ä»–ï¼šç­‰å¾…æŒ‡ä»¤ã€åœæœºæŒ‡ä»¤ã€ç©ºæ“ä½œæŒ‡ä»¤ã€å¼€ä¸­æ–­æŒ‡ä»¤ã€å…³ä¸­æ–­æŒ‡ä»¤ã€ç½®æ¡ä»¶ç æŒ‡ä»¤ç­‰</li>\n<li>æ•°æ®åœ¨å­˜å‚¨å™¨ä¸­çš„å­˜æ”¾æ–¹å¼ï¼šè®¡ç®—æœºä¸­çš„æ•°æ®å­˜æ”¾åœ¨å­˜å‚¨å™¨æˆ–å¯„å­˜å™¨ä¸­ï¼Œè€Œå¯„å­˜å™¨çš„ä½æ•°ä¾¿å¯ååº”æœºå™¨å­—é•¿</li>\n</ul>\n<h2>7.4. å¯»å€æ–¹å¼</h2>\n<ul>\n<li>å¯»å€æ–¹å¼æ˜¯æŒ‡å®šæœ¬æŒ‡ä»¤çš„æ•°æ®åœ°å€ä»¥åŠä¸‹ä¸€æ¡å°†è¦æ‰§è¡Œçš„æŒ‡ä»¤åœ°å€çš„æ–¹æ³•</li>\n<li>æŒ‡ä»¤å¯»å€\n<ul>\n<li>é¡ºåºå¯»å€ï¼ˆé€šè¿‡ç¨‹åºè®¡æ•°å™¨PCåŠ 1è‡ªåŠ¨å½¢æˆä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€å®ç°ï¼‰</li>\n<li>è·³è·ƒå¯»å€ï¼ˆé€šè¿‡è½¬ç§»ç±»æŒ‡ä»¤å®ç°ï¼‰</li>\n</ul>\n</li>\n<li>æ•°æ®å¯»å€ï¼šåœ°å€æŒ‡ä»¤åŒ…æ‹¬æ“ä½œç ã€å¯»å€ç‰¹å¾ã€å½¢å¼åœ°å€Aã€‚æ“ä½œæ•°çš„çœŸå®åœ°å€ç§°ä¸ºæœ‰æ•ˆåœ°å€è®°ä¸ºEA\n<ul>\n<li>ç«‹å³å¯»å€ï¼šæ“ä½œæ•°æœ¬èº«åœ¨æŒ‡ä»¤å­—å†…ï¼Œæ•°æ®é‡‡ç”¨è¡¥ç å½¢å¼å­˜æ”¾ã€‚å½¢å¼åœ°å€Aæ˜¯æ“ä½œæ•°æœ¬èº«ã€‚æ‰§è¡Œé˜¶æ®µæ— éœ€è®¿å­˜ï¼ˆé€Ÿåº¦å¿«ï¼Œåœ°å€ç ä½æ•°é™åˆ¶æ“ä½œæ•°è¡¨ç¤ºèŒƒå›´ï¼‰</li>\n<li>ç›´æ¥å¯»å€ï¼šæŒ‡ä»¤å­—ä¸­çš„å½¢å¼åœ°å€Aå°±æ˜¯æ“ä½œæ•°çš„çœŸå®åœ°å€EAã€‚æ‰§è¡Œé˜¶æ®µè®¿å­˜ä¸€æ¬¡ï¼ˆå¯»æ‰¾æ“ä½œæ•°ç®€å•ï¼Œåœ°å€ç ä½æ•°é™åˆ¶æ“ä½œæ•°è¡¨ç¤ºèŒƒå›´ï¼‰</li>\n<li>éšå«å¯»å€ï¼šæŒ‡ä»¤ä¸­æ“ä½œæ•°çš„åœ°å€ï¼Œéšå«åœ¨æ“ä½œç æˆ–æŸä¸ªå¯„å­˜å™¨ä¸­</li>\n<li>é—´æ¥å¯»å€ï¼šå½¢å¼åœ°å€æŒ‡å‡ºæ“ä½œæ•°æœ‰æ•ˆåœ°å€æ‰€åœ¨çš„å­˜å‚¨å•å…ƒåœ°å€ã€‚ä¾¿äºç¼–å€ç¨‹åºï¼Œæ‰©å¤§äº†æ“ä½œæ•°çš„å¯»å€èŒƒå›´ï¼Œéœ€è¦è®¿å­˜å¤šæ¬¡ï¼Œä½¿æŒ‡ä»¤æ‰§è¡Œæ—¶é—´å»¶é•¿ï¼ˆæ“ä½œæ•°å¯»å€èŒƒå›´å¤§ï¼Œé€Ÿåº¦æ…¢ï¼‰</li>\n<li>å¯„å­˜å™¨å¯»å€ï¼šåœ°å€ç å­—æ®µç›´æ¥æŒ‡å‡ºå¯„å­˜å™¨çš„ç¼–å·ï¼Œæ— éœ€è®¿å­˜ï¼Œå‡å°‘æ‰§è¡Œå¯»å€</li>\n<li>å¯„å­˜å™¨é—´æ¥å¯»å€ï¼šåœ°å€ç å­—æ®µç›´æ¥æŒ‡å‡ºæ“ä½œæ•°æ‰€åœ¨ä¸»å­˜çš„åœ°å€å·ï¼ŒæŒ‡ä»¤æ‰§è¡Œé˜¶æ®µéœ€è¦è®¿é—®ä¸»å­˜</li>\n<li>åŸºå€å¯»å€ï¼šè®¾æœ‰åŸºå€å¯„å­˜å™¨BRï¼Œæ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€EAç­‰äºæŒ‡ä»¤å­—ä¸­çš„å½¢å¼åœ°å€å’ŒåŸºå€å¯„å­˜å™¨ä¸­çš„å†…å®¹ç›¸åŠ ã€‚æ‰©å¤§æ“ä½œæ•°çš„å¯»å€èŒƒå›´</li>\n<li>å˜å€å¯»å€ï¼šè®¾æœ‰å˜å€å¯„å­˜å™¨IXï¼Œæ“ä½œæ•°çš„æœ‰æ•ˆåœ°å€EAç­‰äºæŒ‡ä»¤å­—ä¸­çš„å½¢å¼åœ°å€å’Œå˜å€å¯„å­˜å™¨ä¸­çš„å†…å®¹ç›¸åŠ </li>\n<li>ç›¸å¯¹å¯»å€ï¼šæœ‰æ•ˆåœ°å€å°†ç¨‹åºè®¡æ•°å™¨PCä¸æŒ‡ä»¤å­—ä¸­çš„å½¢å¼åœ°å€Aç›¸åŠ è€Œæˆï¼Œå¸¸ç”¨äºè½¬ç§»ç±»æŒ‡ä»¤</li>\n<li>å †æ ˆå¯»å€ï¼šç”¨å¯„å­˜å™¨ç»„å®ç°æˆ–ä¸»å­˜ä¸€éƒ¨åˆ†ç©ºé—´ä½œå †æ ˆ</li>\n</ul>\n</li>\n</ul>\n<h1>8. CPUçš„ç»“æ„å’ŒåŠŸèƒ½</h1>\n<h2>8.1. æ§åˆ¶å™¨çš„åŸºæœ¬åŠŸèƒ½</h2>\n<ul>\n<li>å–æŒ‡ä»¤:æ§åˆ¶å™¨èƒ½è‡ªåŠ¨å½¢æˆæŒ‡ä»¤çš„åœ°å€ï¼Œå¹¶èƒ½å‘å‡ºå–æŒ‡ä»¤çš„å‘½ä»¤ï¼Œå°†å¯¹åº”çš„æŒ‡ä»¤å–åˆ°æ§åˆ¶å™¨ä¸­</li>\n<li>åˆ†ææŒ‡ä»¤:åˆ†ææŒ‡ä»¤è¦å®Œæˆä»€ä¹ˆæ“ä½œï¼Œåˆ†æå‚ä¸è¿™æ¬¡æ“ä½œçš„æ“ä½œæ•°åœ°å€</li>\n<li>æ‰§è¡ŒæŒ‡ä»¤:æ ¹æ®åˆ†ææŒ‡ä»¤äº§ç”Ÿçš„æ“ä½œå‘½ä»¤å’Œæ“ä½œåœ°å€çš„è¦æ±‚ï¼Œå½¢æˆæ“ä½œæ§åˆ¶ä¿¡å·åºåˆ—ï¼Œé€šè¿‡å¯¹è¿ç®—å™¨ã€å­˜å‚¨å™¨ä»¥åŠI/Oè®¾å¤‡çš„æ“ä½œï¼Œæ‰§è¡Œæ¯æ¡æŒ‡ä»¤</li>\n<li>æ§åˆ¶ç¨‹åºçš„è¾“å…¥å’Œè¿ç®—ç»“æœçš„è¾“å‡ºä»¥åŠå¯¹æ€»çº¿çš„ç®¡ç†</li>\n<li>ä¸­æ–­å¤„ç†ï¼šå¤„ç†æœºå™¨è¿è¡Œè¿‡ç¨‹ä¸­å‡ºç°çš„å¼‚å¸¸æƒ…å†µå’Œç‰¹æ®Šè¯·æ±‚</li>\n</ul>\n<h2>8.2. CPUç»“æ„æ¡†å›¾</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/aa2e9cd7508dd7187ca80.png\" alt=\"41.PNG\" tabindex=\"0\"><figcaption>41.PNG</figcaption></figure>\n<h1>9. è®¡ç®—æœºçš„æ§åˆ¶å™¨</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/955a2f2ec34e75b115ff2.png\" alt=\"44.PNG\" tabindex=\"0\"><figcaption>44.PNG</figcaption></figure>\n<ul>\n<li>ç¨‹åºè®¡æ•°å™¨ï¼š\n<ul>\n<li>ç”¨æ¥å­˜å‚¨ä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€</li>\n<li>å¾ªç¯ä»ç¨‹åºè®¡æ•°å™¨ä¸­æ‹¿å‡ºæŒ‡ä»¤</li>\n<li>å½“æŒ‡ä»¤è¢«æ‹¿å‡ºæ—¶ï¼ŒæŒ‡å‘ä¸‹ä¸€æ¡æŒ‡ä»¤</li>\n</ul>\n</li>\n<li>æ—¶åºå‘ç”Ÿå™¨\n<ul>\n<li>ç”µæ°”å·¥ç¨‹é¢†åŸŸï¼Œç”¨äºå‘é€æ—¶åºè„‰å†²</li>\n<li>CPUæ ¹æ®ä¸åŒçš„æ—¶åºè„‰å†²æœ‰èŠ‚å¥çš„è¿›è¡Œå·¥ä½œï¼ˆèŠ‚æ‹å™¨ï¼‰</li>\n</ul>\n</li>\n<li>æŒ‡ä»¤è¯‘ç å™¨\n<ul>\n<li>æŒ‡ä»¤è¯‘ç å™¨æ˜¯æ§åˆ¶å™¨çš„ä¸»è¦éƒ¨ä»¶ä¹‹ä¸€</li>\n<li>è®¡ç®—æœºæŒ‡ä»¤ç”±æ“ä½œç å’Œåœ°å€ç ç»„æˆ</li>\n<li>ç¿»è¯‘æ“ä½œç å¯¹åº”çš„æ“ä½œä»¥åŠæ§åˆ¶ä¼ è¾“åœ°å€ç å¯¹åº”çš„æ•°æ®</li>\n</ul>\n</li>\n<li>æŒ‡ä»¤å¯„å­˜å™¨\n<ul>\n<li>æŒ‡ä»¤å¯„å­˜å™¨ä¹Ÿæ˜¯æ§åˆ¶å™¨çš„ä¸»è¦éƒ¨ä»¶ä¹‹ä¸€</li>\n<li>ä»ä¸»å­˜æˆ–é«˜é€Ÿç¼“å­˜å–è®¡ç®—æœºæŒ‡ä»¤</li>\n</ul>\n</li>\n<li>ä¸»å­˜åœ°å€å¯„å­˜å™¨\n<ul>\n<li>ä¿å­˜å½“å‰CPUæ­£è¦è®¿é—®çš„å†…å­˜å•å…ƒçš„åœ°å€</li>\n</ul>\n</li>\n<li>ä¸»å­˜æ•°æ®å¯„å­˜å™¨\n<ul>\n<li>ä¿å­˜å½“å‰CPUæ­£è¦è¯»æˆ–å†™çš„ä¸»å­˜æ•°æ®</li>\n</ul>\n</li>\n<li>é€šç”¨å¯„å­˜å™¨\n<ul>\n<li>ç”¨äºæš‚æ—¶å­˜æ”¾æˆ–ä¼ é€æ•°æ®æˆ–æŒ‡ä»¤</li>\n<li>å¯ä¿å­˜ALUçš„è¿ç®—ä¸­é—´ç»“æœ</li>\n<li>å®¹é‡æ¯”ä¸€èˆ¬ä¸“ç”¨å¯„å­˜å™¨å¤§</li>\n</ul>\n</li>\n</ul>\n<h1>10. è®¡ç®—æœºçš„è¿ç®—å™¨</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c4f2c2c4bf4893ccfc6e9.png\" alt=\"45.PNG\" tabindex=\"0\"><figcaption>45.PNG</figcaption></figure>\n<ul>\n<li>æ•°æ®ç¼“å­˜å™¨\n<ul>\n<li>åˆ†ä¸ºè¾“å…¥ç¼“å†²å’Œè¾“å‡ºç¼“å†²</li>\n<li>è¾“å…¥ç¼“å†²æš‚æ—¶å­˜æ”¾å¤–è®¾é€è¿‡æ¥çš„æ•°æ®</li>\n<li>è¾“å‡ºç¼“å­˜æš‚æ—¶å­˜æ”¾é€å¾€å¤–è®¾çš„æ•°æ®</li>\n</ul>\n</li>\n<li>ALU\n<ul>\n<li>ALU ç®—æœ¯é€»è¾‘å•å…ƒã€è¿ç®—å™¨çš„ä¸»è¦ç»„æˆ</li>\n<li>å¸¸è§çš„ä½è¿ç®—ï¼ˆå·¦å³ç§»ã€ä¸æˆ–éç­‰ï¼‰</li>\n<li>ç®—æœ¯è¿ç®—ï¼ˆåŠ å‡ä¹˜é™¤ï¼‰</li>\n</ul>\n</li>\n<li>çŠ¶æ€å­—å¯„å­˜å™¨\n<ul>\n<li>å­˜æ”¾è¿ç®—çŠ¶æ€ï¼ˆæ¡ä»¶ç ã€è¿›ä½ã€æº¢å‡ºã€ç»“æœæ­£è´Ÿç­‰ï¼‰</li>\n<li>å­˜æ”¾è¿ç®—æ§åˆ¶ä¿¡æ¯ï¼ˆè°ƒè¯•è·Ÿè¸ªæ ‡è®°ä½ã€å…è®¸ä¸­æ–­ä½ç­‰ï¼‰</li>\n</ul>\n</li>\n<li>é€šç”¨å¯„å­˜å™¨\n<ul>\n<li>ç”¨äºæš‚æ—¶å­˜æ”¾æˆ–ä¼ é€æ•°æ®æˆ–æŒ‡ä»¤</li>\n<li>å¯ä¿å­˜ALUçš„è¿ç®—ä¸­é—´ç»“æœ</li>\n<li>å®¹é‡æ¯”ä¸€èˆ¬ä¸“ç”¨å¯„å­˜å™¨å¤§</li>\n</ul>\n</li>\n</ul>\n<h2>10.1. CPUçš„å¯„å­˜å™¨</h2>\n<ul>\n<li>ç”¨æˆ·å¯è§å¯„å­˜å™¨ï¼šCPUæ‰§è¡Œæœºå™¨è¯­è¨€è®¿é—®çš„å¯„å­˜å™¨\n<ul>\n<li>é€šç”¨å¯„å­˜å™¨ï¼šå¯ç”±ç¨‹åºè®¾è®¡è€…æŒ‡å®šè®¸å¤šåŠŸèƒ½ï¼Œå¯ç”¨äºå­˜æ”¾æ“ä½œæ•°ï¼Œä¹Ÿå¯ç”¨ä¸ºæ»¡è¶³æŸç§å¯»å€æ–¹å¼æ‰€éœ€çš„å¯„å­˜å™¨</li>\n<li>æ•°æ®å¯„å­˜å™¨ï¼šå­˜æ”¾æ“ä½œæ•°</li>\n<li>åœ°å€å¯„å­˜å™¨ï¼šå­˜æ”¾åœ°å€ï¼Œå¯ç”¨äºç‰¹æ®Šçš„å¯»å€æ–¹å¼</li>\n<li>æ¡ä»¶ç å¯„å­˜å™¨ï¼šå­˜æ”¾æ¡ä»¶ç ï¼Œå¯¹ç”¨æˆ·éƒ¨åˆ†é€æ˜ï¼Œæ¡ä»¶ç æ˜¯CPUæ ¹æ®è¿ç®—ç»“æœç”±ç¡¬ä»¶è®¾ç½®çš„ä½</li>\n<li>æ§åˆ¶å’ŒçŠ¶æ€å¯„å­˜å™¨\n<ul>\n<li>MARï¼šå­˜å‚¨å™¨åœ°å€å¯„å­˜å™¨ã€å­˜æ”¾å°†è¢«è®¿é—®çš„å­˜å‚¨å•å…ƒçš„åœ°å€</li>\n<li>MDRï¼šå­˜å‚¨å™¨æ•°æ®å¯„å­˜å™¨ã€å­˜æ”¾æ¬²å­˜å…¥å­˜å‚¨å™¨ä¸­çš„æ•°æ®æˆ–æœ€è¿‘ä»å­˜å‚¨å™¨ä¸­è¯»å‡ºçš„æ•°æ®</li>\n<li>PCï¼šç¨‹åºè®¡æ•°å™¨ï¼šå­˜æ”¾ç°è¡ŒæŒ‡ä»¤çš„åœ°å€ï¼Œå¯è®¡æ•°</li>\n<li>IRï¼šæŒ‡ä»¤å¯„å­˜å™¨ï¼šå­˜æ”¾å½“å‰æ¬²æ‰§è¡Œçš„æŒ‡ä»¤</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>10.2. æ§åˆ¶å•å…ƒå’Œä¸­æ–­ç³»ç»Ÿ</h2>\n<ul>\n<li>æ§åˆ¶å•å…ƒCUæ˜¯æä¾›å®Œæˆè®¡ç®—æœºå…¨éƒ¨æŒ‡ä»¤æ“ä½œçš„å¾®æ“ä½œå‘½ä»¤åºåˆ—éƒ¨ä»¶</li>\n<li>å¾®æ“ä½œåºåˆ—å½¢æˆæ–¹æ³•\n<ul>\n<li>ç»„åˆé€»è¾‘è®¾è®¡æ–¹æ³•ï¼Œä¸ºç¡¬è¿çº¿é€»è¾‘</li>\n<li>å¾®ç¨‹åºè®¾è®¡æ–¹æ³•ï¼Œä¸ºå­˜å‚¨é€»è¾‘</li>\n</ul>\n</li>\n<li>ä¸­æ–­ç³»ç»Ÿ\n<ul>\n<li>å¤„ç†è®¡ç®—æœºçš„å„ç§ä¸­æ–­</li>\n</ul>\n</li>\n</ul>\n<h2>10.3. æŒ‡ä»¤å‘¨æœŸ</h2>\n<ul>\n<li>æŒ‡ä»¤å‘¨æœŸ:CPUæ¯å–å‡ºå¹¶æ‰§è¡Œä¸€æ¡æŒ‡ä»¤æ‰€éœ€çš„å…¨éƒ¨æ—¶é—´ï¼Œä¹Ÿæ˜¯CPUå®Œæˆä¸€æ¡æŒ‡ä»¤çš„æ—¶é—´\n<ul>\n<li>å–æŒ‡å‘¨æœŸ:å®Œæˆå–æŒ‡ä»¤å’Œåˆ†ææŒ‡ä»¤çš„æ“ä½œ</li>\n<li>æ‰§è¡Œå‘¨æœŸ:å®Œæˆæ‰§è¡ŒæŒ‡ä»¤çš„æ“ä½œ</li>\n<li>é—´å€å‘¨æœŸ:é—´æ¥å¯»å€æŒ‡ä»¤å–æ“ä½œæ•°æœ‰æ•ˆåœ°å€</li>\n<li>ä¸­æ–­å‘¨æœŸ:ä¿å­˜ç¨‹åºæ–­ç‚¹</li>\n</ul>\n</li>\n</ul>\n<h1>11. ä¸­æ–­ç³»ç»Ÿ</h1>\n<h2>11.1. æ¦‚è¿°</h2>\n<ul>\n<li>ä¸­æ–­äº§ç”ŸåŸå› ï¼šä¸ºäº†æé«˜è®¡ç®—æœºæ•ˆç‡ã€‚ä¸ºäº†å¤„ç†ä¸€äº›å¼‚å¸¸æƒ…å†µä»¥åŠå®æ—¶æ§åˆ¶ã€å¤šé“ç¨‹åºå’Œå¤šå¤„ç†æœºçš„éœ€è¦</li>\n<li>å¼•èµ·ä¸­æ–­çš„å„ç§å› ç´ \n<ul>\n<li>äººä¸ºè®¾ç½®çš„ä¸­æ–­</li>\n<li>ç¨‹åºæ€§äº‹æ•…ï¼šå¦‚å®šç‚¹æº¢å‡º</li>\n<li>ç¡¬ä»¶æ•…éšœï¼šå¦‚æ’ä»¶æ¥è§¦ä¸è‰¯</li>\n<li>I/Oè®¾å¤‡ï¼šI/Oè®¾å¤‡è¢«å¯åŠ¨åï¼Œä¸€æ—¦å‡†å¤‡å°±ç»ªï¼Œä¾¿å‘CPUå‘å‡ºä¸­æ–­è¯·æ±‚</li>\n<li>å¤–éƒ¨äº‹ä»¶ï¼šç”¨æˆ·é€šè¿‡é”®ç›˜æ¥ä¸­æ–­ç°è¡Œç¨‹åº</li>\n</ul>\n</li>\n<li>ä¸­æ–­ç³»ç»Ÿéœ€è§£å†³çš„é—®é¢˜\n<ul>\n<li>å„ä¸­æ–­æºå¦‚ä½•å‘CPUæå‡ºä¸­æ–­è¯·æ±‚</li>\n<li>å½“å¤šä¸ªä¸­æ–­æºåŒæ—¶æå‡ºä¸­æ–­è¯·æ±‚æ—¶ï¼Œä¸­æ–­ç³»ç»Ÿå¦‚ä½•ç¡®å®šä¼˜å…ˆå“åº”é‚£ä¸ªä¸­æ–­æºçš„è¯·æ±‚</li>\n<li>CPUåœ¨ä»€ä¹ˆæ¡ä»¶ã€ä»€ä¹ˆæ—¶å€™ã€ä»¥ä»€ä¹ˆæ–¹å¼æ¥å“åº”ä¸­æ–­</li>\n<li>CPUå“åº”ä¸­æ–­åå¦‚ä½•ä¿æŠ¤ç°åœº</li>\n<li>CPUå“åº”ä¸­æ–­åï¼Œå¦‚ä½•åœæ­¢åŸç¨‹åºçš„æ‰§è¡Œè€Œè½¬å…¥ä¸­æ–­æœåŠ¡ç¨‹åºçš„å…¥å£åœ°å€</li>\n<li>ä¸­æ–­å¤„ç†ç»“æŸåï¼ŒCPUå¦‚ä½•æ¢å¤ç°åœºï¼Œå¦‚ä½•å›åˆ°åŸç¨‹åºçš„é—´æ–­å¤„</li>\n<li>åœ¨ä¸­æ–­å¤„ç†è¿‡ç¨‹ä¸­åˆå‡ºç°äº†æ–°çš„ä¸­æ–­è¯·æ±‚ï¼ŒCPUè¯¥å¦‚ä½•å¤„ç†</li>\n</ul>\n</li>\n<li>ä¸­æ–­è¯·æ±‚æ ‡è®°ï¼šä¸ºäº†åˆ¤æ–­æ˜¯å“ªä¸ªä¸­æ–­æºæå‡ºè¯·æ±‚ï¼Œåœ¨ä¸­æ–­ç³»ç»Ÿä¸­å¿…é¡»è®¾ç½®ä¸­æ–­è¯·æ±‚æ ‡è®°è§¦å‘å™¨INTRï¼Œå½“çŠ¶æ€ä¸º1ï¼Œè¡¨ç¤ºä¸­æ–­æºæœ‰è¯·æ±‚ï¼Œè¿™ç§è§¦å‘å™¨å¯é›†ä¸­è®¾åœ¨CPUå†…ï¼Œç»„æˆä¸€ä¸ªä¸­æ–­è¯·æ±‚æ ‡è®°å¯„å­˜å™¨</li>\n</ul>\n<h2>11.2. ä¸­æ–­åˆ¤ä¼˜é€»è¾‘</h2>\n<ul>\n<li>ä»»ä½•ä¸€ä¸ªä¸­æ–­ç³»ç»Ÿï¼Œåœ¨ä»»æ„ä¸€ä¸ªæ—¶åˆ»ï¼Œåªèƒ½å“åº”ä¸€ä¸ªä¸­æ–­æºçš„è¯·æ±‚ã€å„ä¸­æ–­æºçš„ä¼˜å…ˆé¡ºåºæ˜¯æ ¹æ®è¯¥ä¸­æ–­æºè‹¥å¾—ä¸åˆ°åŠæ—¶å“åº”ï¼Œè‡´ä½¿æœºå™¨å·¥ä½œå‡ºé”™çš„ä¸¥é‡ç¨‹åº¦è€Œå®šçš„ã€‚å®ç°æ–¹æ³•å¦‚ä¸‹\n<ul>\n<li>ç¡¬ä»¶æ’é˜Ÿï¼š1.é“¾å¼æ’é˜Ÿå™¨ï¼Œå¯¹åº”ä¸­æ–­è¯·æ±‚è§¦å‘å™¨åˆ†æ•£åœ¨å„ä¸ªæ¥å£ç”µè·¯ä¸­çš„æƒ…å†µã€‚2.CPUå†…çš„æ’é˜Ÿå™¨</li>\n<li>è½¯ä»¶æ’é˜Ÿï¼šé€šè¿‡ç¼–å†™æŸ¥è¯¢ç¨‹åºå®ç°ï¼Œç¨‹åºæŒ‰ä¸­æ–­æºçš„ä¼˜å…ˆç­‰çº§ï¼Œä»é«˜è‡³ä½é€çº§æŸ¥è¯¢å„ä¸­æ–­æºæ˜¯å¦æœ‰ä¸­æ–­è¯·æ±‚</li>\n</ul>\n</li>\n</ul>\n<h2>11.3. ä¸­æ–­æœåŠ¡ç¨‹åºå…¥å£åœ°å€çš„å¯»æ‰¾</h2>\n<ul>\n<li>ç¡¬ä»¶å‘é‡æ³•:åˆ©ç”¨ç¡¬ä»¶äº§ç”Ÿå‘é‡åœ°å€ï¼Œå†ç”±å‘é‡åœ°å€æ‰¾åˆ°ä¸­æ–­æœåŠ¡ç¨‹åºçš„å…¥å£åœ°å€.å‘é‡åœ°å€ç”±ä¸­æ–­å‘é‡åœ°å€éƒ¨ä»¶äº§ç”Ÿï¼Œè¿™ä¸ªç”µè·¯è¯¾åˆ†æ•£è®¾ç½®åœ¨å„ä¸ªæ¥å£ç”µè·¯ä¸­ï¼Œä¹Ÿå¯è®¾ç½®åœ¨CPUå†…</li>\n<li>è½¯ä»¶æŸ¥è¯¢æ³•:ç”¨è½¯ä»¶å¯»æ‰¾ä¸­æ–­æœåŠ¡ç¨‹åºå…¥å£åœ°å€çš„æ–¹æ³•</li>\n</ul>\n<h2>11.4. ä¸­æ–­å“åº”</h2>\n<ul>\n<li>å“åº”ä¸­æ–­çš„æ¡ä»¶:CPUå“åº”I/Oä¸­æ–­çš„æ¡ä»¶æ—¶å…è®¸ä¸­æ–­è§¦å‘å™¨å¿…é¡»ä¸ºâ€œ1â€</li>\n<li>å“åº”ä¸­æ–­çš„æ—¶é—´:åœ¨æŒ‡ä»¤æ‰§è¡Œå‘¨æœŸç»“æŸåï¼Œå“åº”ä»»ä½•ä¸­æ–­æºçš„è¯·æ±‚ï¼Œå› ä¸ºåœ¨æ‰§è¡Œå‘¨æœŸç»“æŸæ—¶åˆ»ç»Ÿä¸€å‘æ‰€æœ‰ä¸­æ–­æºå‘ä¸­æ–­æŸ¥è¯¢ä¿¡å·ï¼Œåªæœ‰æ­¤æ—¶ï¼ŒCPUæ‰èƒ½è·çŸ¥å“ªä¸ªä¸­æ–­æºæœ‰è¯·æ±‚</li>\n<li>ä¸­æ–­æŒ‡ä»¤æ“ä½œ\n<ul>\n<li>ä¿æŠ¤ç¨‹åºæ–­ç‚¹ï¼šå°†å½“å‰ç¨‹åºè®¡æ•°å™¨PCçš„å†…å®¹ä¿å­˜åˆ°å­˜å‚¨å™¨ä¸­ã€‚å®ƒå¯ä»¥å­˜åœ¨å­˜å‚¨å™¨çš„ç‰¹å®šå•å…ƒå†…ï¼Œä¹Ÿå¯ä»¥å­˜å…¥å †æ ˆ</li>\n<li>å¯»æ‰¾ä¸­æ–­æœåŠ¡ç¨‹åºçš„å…¥å£åœ°å€\n<ul>\n<li>ç¬¬ä¸€ç§ï¼Œåœ¨ä¸­æ–­å‘¨æœŸå†…ï¼Œå°†å‘é‡åœ°å€é€è‡³PCï¼Œä½¿CPUæ‰§è¡Œä¸‹ä¸€æ¡æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤ï¼Œè½¬è‡³ä¸­æ–­æœåŠ¡ç¨‹åºçš„å…¥å£åœ°å€</li>\n<li>ç¬¬äºŒç§ï¼Œåœ¨ä¸­æ–­å‘¨æœŸå†…ï¼Œå°†è½¯ä»¶æŸ¥è¯¢å…¥å£åœ°å€çš„ç¨‹åºé¦–åœ°å€é€è‡³PCï¼Œä½¿CPUæ‰§è¡Œä¸­æ–­è¯†åˆ«ç¨‹åºï¼Œæ‰¾åˆ°å…¥å£åœ°å€</li>\n</ul>\n</li>\n<li>å…³ä¸­æ–­ï¼šä¸­æ–­å‘¨æœŸå†…å¿…é¡»è‡ªåŠ¨å…³ä¸­æ–­ï¼Œä»¥ç¦æ­¢CPUå†æ¬¡å“åº”æ–°çš„ä¸­æ–­è¯·æ±‚</li>\n</ul>\n</li>\n<li>ä¿æŠ¤ç°åœº\n<ul>\n<li>ä¿å­˜ç¨‹åºæ–­ç‚¹ï¼šç”±ä¸­æ–­éšæŒ‡ä»¤å®Œæˆ</li>\n<li>CPUå†…éƒ¨å„å¯„å­˜å™¨å†…å®¹çš„ç°åœºï¼šåœ¨ä¸­æ–­æœåŠ¡ç¨‹åºä¸­ç”±å®¢æˆ·æˆ–ç³»ç»Ÿç”¨æœºå™¨æŒ‡ä»¤ç¼–ç¨‹å®ç°</li>\n</ul>\n</li>\n<li>æ¢å¤ç°åœº<br>\nåœ¨ä¸­æ–­è¿”å›å‰ï¼Œå¿…é¡»å°†å¯„å­˜å™¨çš„å†…å®¹æ¢å¤åˆ°ä¸­æ–­å¤„ç†å‰çš„çŠ¶æ€ï¼Œç”±ä¸­æ–­æœåŠ¡ç¨‹åºå®Œæˆ</li>\n</ul>\n<h2>11.5. ä¸­æ–­å±è”½æŠ€æœ¯(ç”¨äºå¤šé‡ä¸­æ–­)</h2>\n<ul>\n<li>å¤šé‡ä¸­æ–­:å½“CPUæ­£åœ¨æ‰§è¡ŒæŸä¸ªä¸­æ–­æœåŠ¡ç¨‹åºæ˜¯ï¼Œå¦ä¸€ä¸ªä¸­æ–­æºåˆæå‡ºäº†æ–°çš„ä¸­æ–­è¯·æ±‚ï¼Œè€ŒCPUåˆå“åº”äº†è¿™ä¸ªæ–°çš„è¯·æ±‚ï¼Œæš‚æ—¶åœæ­¢æ­£åœ¨è¿è¡Œçš„æœåŠ¡ç¨‹åºï¼Œè½¬å»æ‰§è¡Œæ–°çš„ä¸­æ–­æœåŠ¡ç¨‹åº<br>\nå®ç°å¤šé‡ä¸­æ–­æ¡ä»¶\n<ul>\n<li>æå‰è®¾ç½®â€œå¼€ä¸­æ–­â€æŒ‡ä»¤ï¼šå¤šé‡ä¸­æ–­çš„å¼€ä¸­æ–­æŒ‡ä»¤çš„ä½ç½®å‰äºå•é‡ä¸­æ–­ï¼Œä»è€Œä¿è¯å¤šé‡ä¸­æ–­å…è®¸å‡ºç°ä¸­æ–­åµŒå¥—</li>\n<li>ä¼˜å…ˆçº§åˆ«é«˜çš„ä¸­æ–­æºæœ‰æƒä¸­æ–­ä¼˜å…ˆçº§åˆ«ä½çš„ä¸­æ–­æºï¼šåœ¨æ»¡è¶³ä¸Šé¢çš„æ¡ä»¶æ‰è¡Œ</li>\n</ul>\n</li>\n</ul>\n<h1>12. æ§åˆ¶å•å…ƒçš„åŠŸèƒ½</h1>\n<h2>12.1. å¾®æ“ä½œå‘½ä»¤çš„åˆ†æ</h2>\n<ul>\n<li>æ§åˆ¶å•å…ƒå…·æœ‰å‘å‡ºå„ç§å¾®æ“ä½œå‘½ä»¤ï¼ˆæ§åˆ¶ä¿¡å·ï¼‰åºåˆ—çš„åŠŸèƒ½</li>\n<li>å–æŒ‡å‘¨æœŸ\n<ul>\n<li>ç°è¡ŒæŒ‡ä»¤åœ°å€é€è‡³å­˜å‚¨å™¨åœ°å€å¯„å­˜å™¨ PC-&gt;MAR</li>\n<li>å‘ä¸»å­˜å‘é€è¯»å‘½ä»¤ï¼Œå¯åŠ¨ä¸»å­˜è¯»æ“ä½œ 1-&gt;R</li>\n<li>å°†MARé€šè¿‡åœ°å€æ€»çº¿æ‰€æŒ‡çš„ä¸»å­˜å•å…ƒä¸­çš„æŒ‡ä»¤ç»æ•°æ®çº¿è¯»è‡³MDRå†…M(MAR)-&gt;MDR</li>\n<li>å°†MDRçš„å†…å®¹é€è‡³IR MDR-&gt;IR</li>\n<li>æŒ‡ä»¤çš„æ“ä½œç é€è‡³CUè¯‘ç  OP(PC)-&gt;CU</li>\n<li>å½¢æˆä¸‹ä¸€æ¡æŒ‡ä»¤çš„åœ°å€ (PC)+1-&gt;PC</li>\n</ul>\n</li>\n<li>é—´å€å‘¨æœŸ\n<ul>\n<li>å°†æŒ‡ä»¤çš„åœ°å€ç éƒ¨åˆ†é€è‡³å­˜å‚¨å™¨åœ°å€å¯„å­˜å™¨ Ad(IR)-&gt;MAR</li>\n<li>å‘ä¸»å­˜å‘é€è¯»å‘½ä»¤ï¼Œå¯åŠ¨ä¸»å­˜ä½œè¯»æ“ä½œ 1-&gt;R</li>\n<li>å°†MARé€šè¿‡åœ°å€æ€»çº¿æ‰€æŒ‡çš„ä¸»å­˜å•å…ƒçš„æœ‰æ•ˆåœ°å€ç»æ•°æ®æ€»çº¿è¯»è‡³MDRå†… M(MAR)-MDR</li>\n<li>å°†æœ‰æ•ˆåœ°å€é€è‡³æŒ‡ä»¤å¯„å­˜å™¨çš„åœ°å€å­—æ®µMDR-&gt;Ad(IR)</li>\n</ul>\n</li>\n<li>æ‰§è¡Œå‘¨æœŸ\n<ul>\n<li>éè®¿å­˜æŒ‡ä»¤\n<ul>\n<li>æ¸…é™¤ç´¯åŠ å™¨æŒ‡ä»¤CLA</li>\n<li>ç´¯åŠ å™¨å–åæŒ‡ä»¤COM</li>\n<li>ç®—æœ¯å³ç§»ä¸€ä½æŒ‡ä»¤SHR</li>\n<li>å¾ªç¯å·¦ç§»ä¸€ä½æŒ‡ä»¤CSL</li>\n<li>åœæœºæŒ‡ä»¤STP</li>\n</ul>\n</li>\n<li>è®¿å­˜æŒ‡ä»¤\n<ul>\n<li>åŠ æ³•æŒ‡ä»¤ADD X</li>\n<li>å­˜æ•°æŒ‡ä»¤STA X</li>\n<li>å–æ•°æŒ‡ä»¤LDA X</li>\n</ul>\n</li>\n<li>è½¬ç§»ç±»æŒ‡ä»¤\n<ul>\n<li>æ— æ¡ä»¶è½¬ç§»æŒ‡ä»¤ JMP X</li>\n<li>æ¡ä»¶è½¬ç§»ï¼ˆè´Ÿåˆ™è½¬ï¼‰æŒ‡ä»¤BAN</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>12.2. ä¸­æ–­å‘¨æœŸ</h2>\n<ul>\n<li>å°†ç‰¹å®šåœ°å€0é€è‡³å­˜å‚¨å™¨åœ°å€å¯„å­˜å™¨</li>\n<li>å‘ä¸»å­˜å‘å†™å‘½ä»¤ï¼Œå¯åŠ¨å­˜å‚¨å™¨å†™æ“ä½œ</li>\n<li>å°†PCçš„ç¨‹åºæ–­ç‚¹é€è‡³MDR</li>\n<li>å°†MDRçš„ç¨‹åºæ–­ç‚¹é€šè¿‡æ•°æ®æ€»çº¿å†™å…¥åˆ°MARé€šè¿‡åœ°å€æ€»çº¿æ‰€æŒ‡ç¤ºçš„ä¸»å­˜å•å…ƒ0åœ°å€å•å…ƒä¸­</li>\n<li>å°†å‘é‡åœ°å€å½¢æˆéƒ¨ä»¶çš„è¾“å‡ºé€è‡³PCï¼Œä¸ºä¸‹ä¸€æ¡æŒ‡ä»¤çš„å–æŒ‡å‘¨æœŸåšå‡†å¤‡</li>\n<li>å…³ä¸­æ–­ï¼Œå°†å…è®¸ä¸­æ–­è§¦å‘æŒ‡ä»¤æ¸…0</li>\n</ul>\n<h1>13. è®¡ç®—æœºæŒ‡ä»¤çš„æ‰§è¡Œè¿‡ç¨‹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/087360e79d3aefd3cb4b5.png\" alt=\"47.PNG\" tabindex=\"0\"><figcaption>47.PNG</figcaption></figure>\n<ul>\n<li>CPUçš„æµæ°´çº¿è®¾è®¡</li>\n<li>ç±»ä¼¼å·¥å‚çš„è£…é…çº¿</li>\n<li>å·¥å‚çš„è£…é…çº¿ä½¿å¾—å¤šä¸ªäº§å“å¯ä»¥åŒæ—¶è¢«åŠ å·¥</li>\n<li>åœ¨åŒä¸€ä¸ªæ—¶åˆ»ï¼Œä¸åŒäº§å“ä½äºä¸åŒçš„åŠ å·¥é˜¶æ®µ</li>\n<li>ä¸²è¡Œæ‰§è¡Œmæ¡æŒ‡ä»¤ï¼šT1 = 3t x m</li>\n<li>æµæ°´çº¿æ‰§è¡Œmæ¡æŒ‡ä»¤ï¼šT2 = t x ï¼ˆm+2ï¼‰</li>\n<li>H = T2/T1 = t x (m+2) / 3t x m = 1/3 + 1/3mæé«˜äº†3å€</li>\n</ul>\n<h1>CPUå®ç°åŸå­æ€§</h1>\n<ul>\n<li>\n<p>1.æ€»çº¿é”ï¼šæŒ‡å°†CPUè·Ÿå†…å­˜ä¹‹é—´çš„é€šä¿¡é”ä½ï¼Œå…¶ä»–CPUä¸èƒ½æ“ä½œå…±äº«å†…å­˜ä¸­çš„æ•°æ®ã€‚å³å½“ä¸€ä¸ªCPUè®¿é—®æ•°æ®è¿›è¡Œæ“ä½œæ—¶ï¼Œä¼šå…ˆå‘æ€»çº¿å‘é€ä¸€ä¸ªLOCK#ä¿¡å·ï¼Œå¦‚æœæˆåŠŸï¼Œè¯¥CPUä¼šç‹¬äº«è¿™ä¸ªå…±äº«å†…å­˜ç›´è‡³æ“ä½œå®Œæˆæˆ–è€…è¶…æ—¶ï¼Œè€Œæ­¤æ—¶å…¶ä»–CPUå¯¹å†…å­˜çš„æ“ä½œè¯·æ±‚ä¼šè¢«é˜»å¡ã€‚ä½¿ç”¨LOCK#ä¿¡å·ä¼šæŠŠCPUä¸å†…å­˜ä¹‹é—´çš„é€šä¿¡é”ä½ï¼Œä½¿å¾—é”å®šæœŸé—´å…¶ä»–CPUæ— æ³•æ“ä½œå…¶ä»–å†…å­˜åœ°å€çš„æ•°æ®ï¼Œå› æ­¤æ€»çº¿é”å¼€é”€æ¯”è¾ƒå¤§ã€‚</p>\n</li>\n<li>\n<p>2.ç¼“å­˜é”: æŒ‡å°†åŸå­æ“ä½œæ”¾åœ¨CPUç¼“å­˜ä¸­è¿›è¡Œï¼ˆL1ã€L2ã€L3é«˜é€Ÿç¼“å­˜ï¼‰ã€‚â€œç¼“å­˜é”å®šâ€æŒ‡å½“å‘ç”Ÿå…±äº«å†…å­˜çš„é”å®šï¼ŒCPUä¸ä¼šåœ¨æ€»çº¿ä¸Šå£°æ˜LOCK#ä¿¡å·ï¼Œè€Œæ˜¯å¯¹CPUçš„ç¼“å­˜ä¸­çš„ç¼“å­˜è¡Œè¿›è¡Œé”å®šï¼Œåœ¨é”å®šæœŸé—´å…¶ä»–CPUä¸èƒ½åŒæ—¶ç¼“å­˜è¯¥æ•°æ®ï¼Œåœ¨ä¿®æ”¹åï¼Œé€šè¿‡ç¼“å­˜ä¸€è‡´æ€§ä¿è¯åŸå­æ€§ã€‚</p>\n</li>\n<li>\n<p>3.åªèƒ½ä½¿ç”¨æ€»çº¿é”çš„æƒ…å†µ</p>\n<ul>\n<li>æ“ä½œçš„æ•°æ®ä¸èƒ½è¢«ç¼“å­˜åœ¨CPUä¸Šæˆ–æ“ä½œçš„æ•°æ®è·¨å¤šä¸ªç¼“å­˜è¡Œæ—¶</li>\n<li>å¤„ç†å™¨ä¸æ”¯æŒ</li>\n</ul>\n</li>\n<li>\n<p>4.MESI</p>\n<ul>\n<li>1.MESIåè®®æ˜¯å®ç°ç¼“å­˜ä¸€è‡´æ€§çš„åœ¨Intelä¸Šä½¿ç”¨æ¯”è¾ƒå¹¿æ³›çš„ä¸€ç§åè®®ï¼Œç¼“å­˜è¡Œçš„çŠ¶æ€æœ‰å››ç§.è¯¥åè®®è¦æ±‚åœ¨æ¯ä¸ªç¼“å­˜è¡Œä¸­ç»´æŠ¤ä¸¤ä¸ªçŠ¶æ€ä½ï¼Œä½¿å¾—æ¯ä¸ªæ•°æ®å•å…ƒå¯èƒ½å¤„åœ¨è¿™å››ç§çŠ¶æ€ä¸­çš„ä¸€ç§ã€‚\n<ul>\n<li>Modified(ä¿®æ”¹)è¡¨ç¤ºç¼“å­˜è¡Œçš„æ•°æ®è¢«ä¿®æ”¹äº†ï¼Œä½†æ˜¯è¿˜æ²¡æœ‰æ›´æ–°åˆ°ä¸»å†…å­˜ã€‚å¤„äºè¿™ä¸€çŠ¶æ€çš„æ•°æ®ï¼Œåªåœ¨æœ¬CPUä¸­æœ‰ç¼“å­˜æ•°æ®ï¼Œå…¶ä»–CPUæ²¡æœ‰ã€‚</li>\n<li>Exclusive(ç‹¬äº«)è¡¨ç¤ºç¼“å­˜è¡Œä¸­çš„æ•°æ®æ˜¯ç‹¬æœ‰çš„ã€‚å¤„äºè¿™ä¸€çŠ¶æ€çš„æ•°æ®ï¼Œåªåœ¨æœ¬CPUä¸­æœ‰ç¼“å­˜ï¼Œå…¶ä»–CPUæ²¡æœ‰ï¼Œä¸”æ•°æ®ä¸ä¸»å†…å­˜ä¸­ä¿æŒä¸€è‡´ã€‚</li>\n<li>Share(å…±äº«)è¡¨ç¤ºç¼“å­˜è¡Œä¸­çš„æ•°æ®æ˜¯å…±äº«çš„ã€‚å¤„äºè¿™ä¸€çŠ¶æ€çš„æ•°æ®åœ¨å¤šä¸ªCPUä¸­éƒ½æœ‰ç¼“å­˜ï¼Œä¸”ä¸ä¸»å†…å­˜ä¿æŒä¸€è‡´ã€‚</li>\n<li>Invalid(æ— æ•ˆ)è¡¨ç¤ºç¼“å­˜è¡Œä¸­çš„æ•°æ®æ˜¯æ— æ•ˆçš„ã€‚</li>\n</ul>\n</li>\n<li>MESIåè®®é€šè¿‡å¯¹ä¸åŒçš„çŠ¶æ€å¢æ·»ä¸åŒçš„ç›‘å¬ä»»åŠ¡ä¿è¯ç¼“å­˜ä¸€è‡´æ€§\n<ul>\n<li>Modified:å¤„äºMçŠ¶æ€çš„ç¼“å­˜è¡Œï¼Œå¿…é¡»æ—¶åˆ»ç›‘å¬æ‰€æœ‰è¯•å›¾è¯»å–è¯¥ç¼“å­˜è¡Œå¯¹åº”çš„ä¸»å†…å­˜åœ°å€çš„åŠ¨ä½œï¼Œå¦‚æœç›‘å¬åˆ°ï¼Œåˆ™å¿…é¡»åœ¨æ­¤æ“ä½œå°†å…¶ç¼“å­˜è¡Œä¸­çš„æ•°æ®å†™å›ä¸»å†…å­˜ï¼Œå…¶ç¼“å­˜è¡ŒçŠ¶æ€è®¾ç½®ä¸ºSã€‚|</li>\n<li>Exclusive:å¤„äºEçŠ¶æ€çš„ç¼“å­˜è¡Œï¼Œå¿…é¡»æ—¶åˆ»ç›‘å¬æ‰€æœ‰è¯•å›¾è¯»å–è¯¥ç¼“å­˜è¡Œå¯¹åº”çš„ä¸»å†…å­˜åœ°å€çš„åŠ¨ä½œï¼Œå¦‚æœç›‘å¬åˆ°ï¼Œåˆ™å¿…é¡»å°†å…¶ç¼“å­˜è¡ŒçŠ¶æ€è®¾ç½®ä¸ºS|</li>\n<li>Share:å¤„äºSçŠ¶æ€çš„ç¼“å­˜è¡Œï¼Œå¿…é¡»æ—¶åˆ»ç›‘å¬æ‰€æœ‰è¯•å›¾ä½¿è¯¥ç¼“å­˜è¡Œæ— æ•ˆæˆ–è€…ç‹¬äº«åŠ¨ä½œï¼Œå¦‚æœç›‘å¬åˆ°ï¼Œåˆ™å¿…é¡»å°†å…¶ç¼“å­˜è¡ŒçŠ¶æ€è®¾ç½®ä¸ºI|</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>2.MESIæ¶ˆæ¯<br>\n|æ¶ˆæ¯å|æ¶ˆæ¯ç±»å‹|æè¿°|<br>\n|:-ğŸ˜:-ğŸ˜:-ğŸ˜<br>\n|Read|è¯·æ±‚|é€šçŸ¥å…¶ä»–å¤„ç†å™¨ï¼Œå½“å‰å¤„ç†å™¨å‡†å¤‡ä¸»å†…å­˜æŸä¸ªæ•°æ®ã€‚è¯¥æ¶ˆæ¯åŒ…å«å¾…è¯»å–æ•°æ®çš„å†…å­˜åœ°å€<br>\n|Read|Respond|å“åº”|è¯¥æ¶ˆæ¯åŒ…å«è¢«è¯·æ±‚çš„è¯»å–æ¶ˆæ¯çš„æ•°æ®ï¼Œå¯èƒ½æ˜¯ä¸»å†…å­˜æä¾›çš„ï¼Œä¹Ÿå¯èƒ½æ˜¯å—…æ¢åˆ°Readæ¶ˆæ¯çš„å…¶ä»–å¤„Cacheæä¾›ï¼Œä¸»è¦çœ‹å—…æ¢åˆ°Readæ¶ˆæ¯çš„Cacheä¸­ç¼“å­˜è¡Œçš„çŠ¶æ€<br>\n|Invalidate|è¯·æ±‚|é€šçŸ¥å…¶ä»–å¤„ç†å™¨å°†å…¶é«˜é€Ÿç¼“å­˜ä¸­æŒ‡å®šå†…å­˜åœ°å€å¯¹åº”çš„ç¼“å­˜è¡ŒçŠ¶æ€ç½®ä¸ºI<br>\n|Invalidate|Acknowledgeå“åº”\tæ¥æ”¶åˆ°Invalidateæ¶ˆæ¯çš„å¤„ç†å™¨å¿…é¡»å›å¤æ­¤å“åº”ï¼Œä»¥è¡¨ç¤ºåˆ é™¤äº†å…¶é«˜é€Ÿç¼“å­˜ä¸Šçš„å“åº”å‰¯æœ¬ï¼ˆç½®ä¸ºIï¼‰<br>\n|Read|Invalidate|è¯·æ±‚|ç”±Readæ¶ˆæ¯å’ŒInvalidateæ¶ˆæ¯ç»„åˆå½¢æˆã€‚å®ƒçš„ä½œç”¨æ˜¯é€šçŸ¥å…¶å®ƒå¤„ç†ï¼Œå‘é€è¯¥æ¶ˆæ¯çš„å¤„ç†å™¨å‡†å¤‡æ›´æ–°ä¸€ä¸ªæ•°æ®ï¼Œè¯·æ±‚å…¶å®ƒå¤„ç†å™¨åˆ é™¤å…¶é«˜é€Ÿç¼“å­˜ä¸­ç›¸åº”çš„å‰¯æœ¬æ•°æ®ã€‚æ¥æ”¶åˆ°è¯¥æ¶ˆæ¯çš„å¤„ç†å™¨å¿…é¡»å›å¤Invalidate Acknowledgeæ¶ˆæ¯ï¼Œä¸»å†…å­˜å›å¤Read Responseæ¶ˆæ¯ï¼Œå‘é€è¯¥æ¶ˆæ¯çš„å¤„ç†å™¨æœŸæœ›æ”¶åˆ°ä¸€ä¸ªRead Responseä»¥åŠå¤šä¸ªInvalidate Acknowledge|<br>\n|Writeback|è¯·æ±‚|è¯¥æ¶ˆæ¯åŒ…å«éœ€è¦å†™å…¥ä¸»å†…å­˜çš„æ•°æ®åŠå…¶å¯¹åº”çš„å†…å­˜åœ°å€|</p>\n</li>\n<li>\n<p>3.MESIå¤„ç†æµç¨‹</p>\n</li>\n<li>\n<p>MESIåè®®åœ¨æ•°æ®çš„è¯»å†™æ—¶ï¼Œæ˜¯é€šè¿‡å¾€æ€»çº¿ä¸­å‘é€æ¶ˆæ¯è¯·æ±‚ä»¥åŠæ¥æ”¶å“åº”æ¥ä¿è¯æ•°æ®çš„ä¸€è‡´æ€§ï¼Œä»¥ä¸‹ä»¥ä¸¤ä¸ªCPUä¸ºä¾‹å­ï¼ˆCPUAã€CPUBï¼‰</p>\n</li>\n<li>\n<p>1.æ•°æ®è¯»æµç¨‹</p>\n<ul>\n<li>CPUAéœ€è¦è¯»å–æ•°æ®X,CPUAé¦–å…ˆæ ¹æ®æ•°æ®çš„åœ°å€åœ¨è‡ªå·±çš„ç¼“å­˜ä¸­æŸ¥æ‰¾</li>\n<li>1.1 å¦‚æœèƒ½æ‰¾åˆ°ï¼Œå¹¶ä¸”ç¼“å­˜è¡ŒçŠ¶æ€æ—¶Mã€Eã€Sï¼Œè¯´æ˜ç¼“å­˜è¡Œçš„æ•°æ®å¯¹äºå½“å‰è¯»è¯·æ±‚æ˜¯å¯ç”¨çš„ï¼Œç›´æ¥ä»ç¼“å­˜è¡Œè·å–åœ°å€Aå¯¹åº”çš„æ•°æ®</li>\n<li>1.2 å¦‚æœæ‰¾ä¸åˆ°æˆ–è€…ç¼“å­˜è¡Œçš„çŠ¶æ€æ˜¯Iï¼ŒCPUAä¼šå…ˆæ€»çº¿å‘é€Readæ¶ˆæ¯ï¼Œå…¶ä»–å¤„ç†å™¨ï¼ˆCPUBï¼‰ä¼šç›‘å¬æ€»çº¿ä¸Šçš„æ¶ˆæ¯ï¼Œæ”¶åˆ°æ¶ˆæ¯åï¼Œä»æ¶ˆæ¯ä¸­è§£æå‡ºéœ€è¦è¯»å–çš„åœ°å€ï¼Œç„¶ååœ¨è‡ªå·±çš„ç¼“å­˜ä¸­æŸ¥æ‰¾ç¼“å­˜è¡Œï¼Œæ ¹æ®ç¼“å­˜è¡Œçš„çŠ¶æ€ä¼šå‡ºç°ä¸åŒæƒ…å†µ\n<ul>\n<li>1.2.1 çŠ¶æ€ä¸ºS/E , CPUBä¼šæ„é€ Read Responseæ¶ˆæ¯ï¼Œå°†ç¼“å­˜è¡Œä¸­çš„æ•°æ®æ”¾åˆ°æ¶ˆæ¯ä¸­ï¼Œå‘é€åˆ°æ€»çº¿åŒæ—¶æ›´æ–°è‡ªå·±ç¼“å­˜è¡Œçš„çŠ¶æ€ä¸ºSï¼ŒCPUAæ”¶åˆ°å“åº”æ¶ˆæ¯åï¼Œä¼šå°†æ¶ˆæ¯ä¸­çš„æ•°æ®å­˜å…¥ç›¸åº”çš„ç¼“å­˜è¡Œä¸­ï¼ŒåŒæ—¶æ›´æ–°ç¼“å­˜è¡Œçš„çŠ¶æ€ä¸ºS</li>\n<li>1.2.2 çŠ¶æ€ä¸ºMï¼Œä¼šå…ˆå°†è‡ªå·±ç¼“å­˜è¡Œä¸­çš„æ•°æ®å†™å…¥ä¸»å†…å­˜ï¼Œå¹¶å“åº”Read Responseæ¶ˆæ¯åŒæ—¶å°†ç¼“å­˜è¡ŒçŠ¶æ€æ›´æ–°ä¸ºS</li>\n<li>1.2.3 çŠ¶æ€ä¸ºIæˆ–è€…åœ¨è‡ªå·±çš„ç¼“å­˜ä¸­ä¸å­˜åœ¨åœ°å€Açš„æ•°æ®ï¼Œé‚£ä¹ˆä¸»å†…å­˜ä¼šæ„é€ Read Responseæ¶ˆæ¯ï¼Œä»ä¸»å†…å­˜è¯»å–åŒ…å«æŒ‡å®šåœ°å€çš„å—å·æ•°æ®æ”¾å…¥æ¶ˆæ¯ï¼ˆç¼“å­˜è¡Œå¤§å°å’Œå†…å­˜å—å¤§å°ä¸€è‡´æ‰€ä»¥å¯ä»¥å­˜æ”¾çš„ä¸‹ï¼‰ï¼Œå¹¶å°†æ¶ˆæ¯å‘é€åˆ°æ€»çº¿ï¼ˆâ­æ€ä¹ˆåˆ¤æ–­æ¶ˆæ¯ç”±CPUBå‘é€è¿˜æ˜¯ä¸»å†…å­˜å‘é€ï¼‰</li>\n</ul>\n</li>\n<li>CPUAè·æ¥æ”¶åˆ°æ€»çº¿æ¶ˆæ¯ä¹‹åï¼Œè§£æå‡ºæ•°æ®ä¿å­˜åœ¨è‡ªå·±çš„ç¼“å­˜ä¸­ã€‚</li>\n</ul>\n</li>\n<li>\n<p>2.æ•°æ®å†™æµç¨‹(ä¸€ä¸ªå¤„ç†å™¨çš„ç¼“å­˜å›å†™åˆ°å†…å­˜ä¼šå¯¼è‡´å…¶ä»–å¤„ç†å™¨çš„ç¼“å­˜æ— æ•ˆ)</p>\n<ul>\n<li>CPUAéœ€è¦å¯¹åœ°å€Açš„Xæ•°æ®è¿›è¡Œå†™æ“ä½œï¼ˆâ­ä»»ä½•ä¸€ä¸ªå¤„ç†å™¨æ‰§è¡Œå†…å­˜æ“ä½œæ—¶ï¼Œå¿…é¡»æ‹¥æœ‰ç›¸åº”æ•°æ®çš„æ‰€æœ‰æƒï¼‰</li>\n<li>2.1CPUAé¦–å…ˆæ ¹æ®å†…å­˜åœ°å€åœ¨è‡ªå·±ç¼“å­˜ä¸­æŸ¥æ‰¾ï¼Œæ ¹æ®ä¸åŒçš„çŠ¶æ€æœ‰ä¸åŒå¤„ç†\n<ul>\n<li>2.1.1ä¸ºE/Mæ—¶ï¼Œè¯´æ˜å½“å‰CPUAå·²ç»æ‹¥æœ‰äº†ç›¸åº”æ•°æ®çš„æ‰€æœ‰æƒï¼Œæ­¤æ—¶CPUAä¼šç›´æ¥å°†æ•°æ®å†™å…¥ç¼“å­˜è¡Œä¸­ï¼Œå¹¶æ›´æ–°ç¼“å­˜è¡ŒçŠ¶æ€ä¸ºMï¼Œæ­¤æ—¶ä¸éœ€è¦å‘æ€»çº¿å‘é€ä»»ä½•æ¶ˆæ¯</li>\n<li>2.1.2ä¸ºSæ—¶ï¼Œè¯´æ˜æ•°æ®è¢«å…±äº«ï¼Œå…¶å®ƒCPUä¸­æœ‰å¯èƒ½å­˜æœ‰è¯¥æ•°æ®çš„å‰¯æœ¬ï¼Œåˆ™CPUAå‘æ€»çº¿å‘é€Invalidate æ¶ˆæ¯ä»¥è·å–æ•°æ®çš„æ‰€æœ‰æƒï¼Œå…¶å®ƒå¤„ç†å™¨ï¼ˆCPUB)æ”¶åˆ°Invalidateæ¶ˆæ¯å,ä¼šå°†å…¶é«˜é€Ÿç¼“å­˜ä¸­ç›¸åº”çš„ç¼“å­˜è¡ŒçŠ¶æ€æ›´æ–°ä¸ºIï¼Œè¡¨ç¤ºå·²ç»é€»è¾‘åˆ é™¤ç›¸åº”çš„å‰¯æœ¬æ•°æ®ï¼Œå¹¶å›å¤Invalidate Acknowledgeæ¶ˆæ¯ï¼ŒCPUAæ”¶åˆ°æ‰€æœ‰å¤„ç†å™¨çš„å“åº”æ¶ˆæ¯åï¼Œä¼šå°†æ•°æ®æ›´æ–°åˆ°ç›¸åº”çš„ç¼“å­˜è¡Œä¹‹ä¸­ï¼ŒåŒæ—¶ä¿®æ”¹ç¼“å­˜è¡ŒçŠ¶æ€ä¸ºEï¼Œæ­¤æ—¶æ‹¥æœ‰æ•°æ®çš„æ‰€æœ‰æƒï¼Œä¼šå¯¹ç¼“å­˜è¡Œæ•°æ®è¿›è¡Œæ›´æ–°ï¼Œæœ€ç»ˆè¯¥ç¼“å­˜è¡ŒçŠ¶æ€ä¸ºM</li>\n<li>2.1.3ä¸ºIæ—¶æˆ–è€…æ‰¾ä¸åˆ°æ—¶ï¼Œåˆ™CPUAå‘æ€»çº¿å‘é€Read Invalidateæ¶ˆæ¯\n<ul>\n<li>2.1.3.1å…¶å®ƒå¤„ç†å™¨ï¼ˆCPUBï¼‰æ”¶åˆ°Invalidate æ¶ˆæ¯åï¼Œå¦‚æœç¼“å­˜è¡Œä¸ä¸ºIçš„è¯ï¼Œä¼šå°†å…¶é«˜é€Ÿç¼“å­˜ä¸­ç›¸åº”çš„ç¼“å­˜è¡ŒçŠ¶æ€æ›´æ–°ä¸ºIï¼Œè¡¨ç¤ºå·²ç»é€»è¾‘åˆ é™¤ç›¸åº”çš„å‰¯æœ¬æ•°æ®ï¼Œå¹¶å›å¤``Invalidate Acknowledge`æ¶ˆæ¯</li>\n<li>2.1.3.2ä¸»å†…å­˜æ”¶åˆ°Readæ¶ˆæ¯åï¼Œä¼šå“åº”Read Responseæ¶ˆæ¯å°†éœ€è¦è¯»å–çš„æ•°æ®å‘Šè¯‰CPUA</li>\n<li>2.1.3.3CPUAæ”¶åˆ°æ‰€æœ‰å¤„ç†å™¨çš„Invalidate Acknowledgeæ¶ˆæ¯å’Œä¸»å†…å­˜çš„Read Responseæ¶ˆæ¯åï¼Œä¼šå°†æ•°æ®æ›´æ–°åˆ°ç›¸åº”çš„ç¼“å­˜è¡Œä¹‹ä¸­ï¼ŒåŒæ—¶ä¿®æ”¹ç¼“å­˜è¡ŒçŠ¶æ€ä¸ºEï¼Œæ­¤æ—¶æ‹¥æœ‰æ•°æ®çš„æ‰€æœ‰æƒï¼Œä¼šå¯¹ç¼“å­˜è¡Œæ•°æ®è¿›è¡Œæ›´æ–°ï¼Œæœ€ç»ˆè¯¥ç¼“å­˜è¡ŒçŠ¶æ€ä¸ºM</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>MESI åè®®æ›´å¤æ‚ï¼Œä½†æˆ‘ä»¬æ²¡å¿…è¦è®°å¾—è¿™ä¹ˆç»†ã€‚æˆ‘ä»¬åªéœ€è¦è®°ä½æœ€å…³é”®çš„ 2 ç‚¹ï¼š</p>\n<ul>\n<li>å…³é”® 1 - é˜»æ­¢åŒæ—¶æœ‰å¤šä¸ªæ ¸å¿ƒä¿®æ”¹çš„å…±äº«æ•°æ®ï¼š å½“ä¸€ä¸ª CPU æ ¸å¿ƒè¦æ±‚ä¿®æ”¹æ•°æ®æ—¶ï¼Œä¼šå…ˆå¹¿æ’­ RFO è¯·æ±‚è·å¾— Cache å—çš„æ‰€æœ‰æƒï¼Œå¹¶å°†å…¶å®ƒ CPU æ ¸å¿ƒä¸­å¯¹åº”çš„ Cache å—ç½®ä¸ºå·²å¤±æ•ˆçŠ¶æ€ï¼›</li>\n<li>å…³é”® 2 - å»¶è¿Ÿå›å†™ï¼š åªæœ‰åœ¨éœ€è¦çš„æ—¶å€™æ‰å°†æ•°æ®å†™å›å†…å­˜ï¼Œå½“ä¸€ä¸ª CPU æ ¸å¿ƒè¦æ±‚è®¿é—®å·²å¤±æ•ˆçŠ¶æ€çš„ Cache å—æ—¶ï¼Œä¼šå…ˆè¦æ±‚å…¶å®ƒæ ¸å¿ƒå…ˆå°†æ•°æ®å†™å›å†…å­˜ï¼Œå†ä»å†…å­˜è¯»å–ã€‚</li>\n</ul>\n</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/2b1b1bc7cd4defb97dd4a.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "è®¡ç®—æœºç½‘ç»œ",
      "url": "https://javaguide.cn/backend/cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html",
      "id": "https://javaguide.cn/backend/cs/%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C.html",
      "summary": "æ“ä½œç³»ç»Ÿ 1. è®¡ç®—æœºç½‘ç»œæ¦‚è¿° 1.1. è®¡ç®—æœºç½‘ç»œæ¦‚å¿µ 1.2. è®¡ç®—æœºç½‘ç»œç»„æˆ 1.3. è®¡ç®—æœºç½‘ç»œåŠŸèƒ½ï¼šæ•°æ®é€šä¿¡ã€èµ„æºå…±äº«ã€åˆ†å¸ƒå¼å¤„ç†ã€ä¿¡æ¯ç»¼åˆå¤„ç†ã€è´Ÿè½½å‡è¡¡ã€æé«˜å¯é æ€§ 1.4. è®¡ç®—æœºç½‘ç»œåˆ†ç±» 1.5. è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„ 1.6. è®¡ç®—æœºç½‘ç»œæ€§èƒ½æŒ‡æ ‡ 2. ç‰©ç†å±‚ 2.1. ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ 2.2. æ•°æ®é€šä¿¡çš„åŸºç¡€çŸ¥è¯†ï¼ˆäº†è§£ï¼‰ 2.3....",
      "content_html": "<p>æ“ä½œç³»ç»Ÿ</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E8%BF%B0\">1. è®¡ç®—æœºç½‘ç»œæ¦‚è¿°</a>\n<ul>\n<li><a href=\"#11-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%A6%82%E5%BF%B5\">1.1. è®¡ç®—æœºç½‘ç»œæ¦‚å¿µ</a></li>\n<li><a href=\"#12-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%BB%84%E6%88%90\">1.2. è®¡ç®—æœºç½‘ç»œç»„æˆ</a></li>\n<li><a href=\"#13-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%8A%9F%E8%83%BD%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E8%B5%84%E6%BA%90%E5%85%B1%E4%BA%AB%E5%88%86%E5%B8%83%E5%BC%8F%E5%A4%84%E7%90%86%E4%BF%A1%E6%81%AF%E7%BB%BC%E5%90%88%E5%A4%84%E7%90%86%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1%E6%8F%90%E9%AB%98%E5%8F%AF%E9%9D%A0%E6%80%A7\">1.3. è®¡ç®—æœºç½‘ç»œåŠŸèƒ½ï¼šæ•°æ®é€šä¿¡ã€èµ„æºå…±äº«ã€åˆ†å¸ƒå¼å¤„ç†ã€ä¿¡æ¯ç»¼åˆå¤„ç†ã€è´Ÿè½½å‡è¡¡ã€æé«˜å¯é æ€§</a></li>\n<li><a href=\"#14-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E5%88%86%E7%B1%BB\">1.4. è®¡ç®—æœºç½‘ç»œåˆ†ç±»</a></li>\n<li><a href=\"#15-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E7%9A%84%E4%BD%93%E7%B3%BB%E7%BB%93%E6%9E%84\">1.5. <strong>è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„</strong></a></li>\n<li><a href=\"#16-%E8%AE%A1%E7%AE%97%E6%9C%BA%E7%BD%91%E7%BB%9C%E6%80%A7%E8%83%BD%E6%8C%87%E6%A0%87\">1.6. <strong>è®¡ç®—æœºç½‘ç»œæ€§èƒ½æŒ‡æ ‡</strong></a></li>\n</ul>\n</li>\n<li><a href=\"#2-%E7%89%A9%E7%90%86%E5%B1%82\">2. ç‰©ç†å±‚</a>\n<ul>\n<li><a href=\"#21-%E7%89%A9%E7%90%86%E5%B1%82%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\">2.1. ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ</a></li>\n<li><a href=\"#22-%E6%95%B0%E6%8D%AE%E9%80%9A%E4%BF%A1%E7%9A%84%E5%9F%BA%E7%A1%80%E7%9F%A5%E8%AF%86%E4%BA%86%E8%A7%A3\">2.2. æ•°æ®é€šä¿¡çš„åŸºç¡€çŸ¥è¯†ï¼ˆäº†è§£ï¼‰</a></li>\n<li><a href=\"#23-%E4%BC%A0%E8%BE%93%E5%AA%92%E4%BD%93\">2.3. ä¼ è¾“åª’ä½“</a></li>\n<li><a href=\"#24-%E4%BF%A1%E9%81%93%E5%A4%8D%E7%94%A8%E6%8A%80%E6%9C%AF\">2.4. ä¿¡é“å¤ç”¨æŠ€æœ¯</a></li>\n<li><a href=\"#25-%E7%89%A9%E7%90%86%E5%B1%82%E8%AE%BE%E5%A4%87\">2.5. ç‰©ç†å±‚è®¾å¤‡</a></li>\n<li><a href=\"#26-%E8%BF%9E%E6%8E%A5%E7%94%A8%E6%88%B7%E4%B8%8E%E4%BA%92%E8%81%94%E7%BD%91%E7%9A%84%E6%8E%A5%E5%85%A5%E7%BD%91\">2.6. è¿æ¥ç”¨æˆ·ä¸äº’è”ç½‘çš„æ¥å…¥ç½‘</a></li>\n</ul>\n</li>\n<li><a href=\"#3-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82\">3. æ•°æ®é“¾è·¯å±‚</a>\n<ul>\n<li><a href=\"#31-%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82%E6%A6%82%E5%BF%B5\">3.1. æ•°æ®é“¾è·¯å±‚æ¦‚å¿µ</a></li>\n<li><a href=\"#32-%E5%B9%BF%E5%9F%9F%E7%BD%91%E4%BD%BF%E7%94%A8%E7%82%B9%E5%AF%B9%E7%82%B9%E4%BF%A1%E9%81%93%E7%9A%84%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82\">3.2. å¹¿åŸŸç½‘ä½¿ç”¨ç‚¹å¯¹ç‚¹ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚</a></li>\n<li><a href=\"#33-%E5%B1%80%E5%9F%9F%E7%BD%91\">3.3. å±€åŸŸç½‘</a></li>\n<li><a href=\"#34-%E5%B1%80%E5%9F%9F%E7%BD%91%E4%BD%BF%E7%94%A8%E5%B9%BF%E6%92%AD%E4%BF%A1%E9%81%93%E7%9A%84%E6%95%B0%E6%8D%AE%E9%93%BE%E8%B7%AF%E5%B1%82\">3.4. å±€åŸŸç½‘ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚</a></li>\n<li><a href=\"#35-%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%9A%84mac%E5%B1%82%E5%AA%92%E4%BD%93%E6%8E%A5%E5%85%A5%E6%8E%A7%E5%88%B6mac%E5%B1%82\">3.5. ä»¥å¤ªç½‘çš„MACå±‚ï¼ˆåª’ä½“æ¥å…¥æ§åˆ¶MACå±‚ï¼‰</a></li>\n<li><a href=\"#36-%E4%BB%A5%E5%A4%AA%E7%BD%91%E7%9A%84%E6%89%A9%E5%B1%95%E4%BB%8E%E7%BD%91%E7%BB%9C%E5%B1%82%E7%9C%8B%E6%9D%A5%E8%BF%98%E6%98%AF%E4%B8%80%E4%B8%AA%E7%BD%91%E7%BB%9C\">3.6. ä»¥å¤ªç½‘çš„æ‰©å±•(ä»ç½‘ç»œå±‚çœ‹æ¥è¿˜æ˜¯ä¸€ä¸ªç½‘ç»œ)</a></li>\n</ul>\n</li>\n<li><a href=\"#4-%E7%BD%91%E7%BB%9C%E5%B1%82\">4. ç½‘ç»œå±‚</a>\n<ul>\n<li><a href=\"#41-ip%E4%BD%93%E7%B3%BB%E7%9A%84%E7%BD%91%E7%BB%9C%E5%B1%82%E6%8F%90%E4%BE%9B%E7%9A%84%E6%9C%8D%E5%8A%A1%E5%92%8C%E8%99%9A%E6%8B%9F%E4%BA%92%E8%BF%9E%E7%BD%91%E7%BB%9C\">4.1. IPä½“ç³»çš„ç½‘ç»œå±‚æä¾›çš„æœåŠ¡å’Œè™šæ‹Ÿäº’è¿ç½‘ç»œ</a></li>\n<li><a href=\"#42-ip%E5%9C%B0%E5%9D%80%E5%8F%8A%E5%85%B6%E7%BC%96%E5%9D%80%E6%96%B9%E6%B3%95%E4%B8%89%E4%B8%AA%E9%98%B6%E6%AE%B5\">4.2. IPåœ°å€åŠå…¶ç¼–å€æ–¹æ³•ä¸‰ä¸ªé˜¶æ®µ</a></li>\n<li><a href=\"#43-ip%E6%95%B0%E6%8D%AE%E6%8A%A5%E7%BD%91%E7%BB%9C%E5%B1%82%E5%8D%8F%E8%AE%AE%E6%95%B0%E6%8D%AE%E5%8D%95%E5%85%83\">4.3. ipæ•°æ®æŠ¥(ç½‘ç»œå±‚åè®®æ•°æ®å•å…ƒ)</a></li>\n<li><a href=\"#44-%E5%9C%B0%E5%9D%80%E8%A7%A3%E6%9E%90%E5%8D%8F%E8%AE%AEarpaddress-resolution-protocol-%E5%90%8C%E4%B8%80%E4%B8%AA%E5%B1%80%E5%9F%9F%E7%BD%91%E8%B7%A8%E7%BD%91%E7%BB%9C%E7%94%B1%E8%B7%AF%E7%94%B1%E5%99%A8%E5%AE%8C%E6%88%90%E8%BD%AC%E5%8F%91\">4.4. åœ°å€è§£æåè®®ARPï¼ˆAddress Resolution Protocol åŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œè·¨ç½‘ç»œç”±è·¯ç”±å™¨å®Œæˆè½¬å‘ï¼‰</a></li>\n<li><a href=\"#45-%E7%BD%91%E7%BB%9C%E6%8E%A7%E5%88%B6%E6%8A%A5%E6%96%87%E5%8D%8F%E8%AE%AE-icmpinternet-control-message-protocol%E4%B8%BA%E4%BA%86%E6%9B%B4%E6%9C%89%E6%95%88%E5%9C%B0%E8%BD%AC%E5%8F%91ip%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%92%8C%E6%8F%90%E4%BA%A4%E4%BA%A4%E4%BB%98%E6%88%90%E5%8A%9F%E7%9A%84%E6%9C%BA%E4%BC%9A\">4.5. ç½‘ç»œæ§åˆ¶æŠ¥æ–‡åè®® ICMP(Internet Control Message Protocol)ï¼ˆä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘ipæ•°æ®æŠ¥å’Œæäº¤äº¤ä»˜æˆåŠŸçš„æœºä¼šï¼‰</a></li>\n<li><a href=\"#46-%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AE-%E8%B7%AF%E7%94%B1%E4%BF%A1%E6%81%AF%E5%8D%8F%E8%AE%AEriprouting-information-protocol\">4.6. å†…éƒ¨ç½‘å…³åè®®-è·¯ç”±ä¿¡æ¯åè®®RIP(Routing Information Protocol)</a></li>\n<li><a href=\"#47-%E5%86%85%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEospfopenshortest-path-first\">4.7. å†…éƒ¨ç½‘å…³åè®®OSPF(OpenShortest Path First)</a></li>\n<li><a href=\"#48-%E5%A4%96%E9%83%A8%E7%BD%91%E5%85%B3%E5%8D%8F%E8%AE%AEbgp\">4.8. å¤–éƒ¨ç½‘å…³åè®®BGP</a></li>\n<li><a href=\"#49-%E8%B7%AF%E7%94%B1%E5%99%A8%E7%9A%84%E6%9E%84%E6%88%90\">4.9. è·¯ç”±å™¨çš„æ„æˆ</a></li>\n<li><a href=\"#410-%E8%99%9A%E6%8B%9F%E4%B8%93%E7%94%A8%E7%BD%91vpn\">4.10. è™šæ‹Ÿä¸“ç”¨ç½‘VPN</a></li>\n<li><a href=\"#411-%E7%BD%91%E7%BB%9C%E5%9C%B0%E5%9D%80%E8%BD%AC%E6%8D%A2nat-network-address-translation\">4.11. ç½‘ç»œåœ°å€è½¬æ¢NAT (Network Address Translation)</a></li>\n</ul>\n</li>\n<li><a href=\"#5-%E8%BF%90%E8%BE%93%E5%B1%82\">5. è¿è¾“å±‚</a>\n<ul>\n<li><a href=\"#51-%E8%BF%90%E8%BE%93%E5%B1%82%E6%A6%82%E8%BF%B0\">5.1. è¿è¾“å±‚æ¦‚è¿°</a></li>\n<li><a href=\"#52-%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8D%8F%E8%AE%AEudpuser-datagram-protocol\">5.2. ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP(User Datagram Protocol)</a></li>\n<li><a href=\"#53-%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AEtcptransmission-control-protocol\">5.3. ä¼ è¾“æ§åˆ¶åè®®TCP(Transmission Control Protocol)</a></li>\n</ul>\n</li>\n<li><a href=\"#6-%E5%BA%94%E7%94%A8%E5%B1%82\">6. åº”ç”¨å±‚</a>\n<ul>\n<li><a href=\"#61-%E6%A6%82%E8%BF%B0\">6.1. æ¦‚è¿°</a></li>\n<li><a href=\"#62-%E5%9F%9F%E5%90%8D%E7%B3%BB%E7%BB%9Fdns\">6.2. åŸŸåç³»ç»ŸDNS</a></li>\n<li><a href=\"#63-ftpfile-transfer-protocol%E6%96%87%E4%BB%B6%E4%BC%A0%E9%80%81%E5%8D%8F%E8%AE%AE\">6.3. FTP(File Transfer Protocolæ–‡ä»¶ä¼ é€åè®®)</a></li>\n<li><a href=\"#64-%E8%BF%9C%E7%A8%8B%E7%BB%88%E7%AB%AF%E5%8D%8F%E8%AE%AEtelnet\">6.4. è¿œç¨‹ç»ˆç«¯åè®®TELNET</a></li>\n<li><a href=\"#65-%E4%B8%87%E7%BB%B4%E7%BD%91\">6.5. ä¸‡ç»´ç½‘</a></li>\n<li><a href=\"#66-%E8%B6%85%E6%96%87%E6%9C%AC%E4%BC%A0%E9%80%81%E5%8D%8F%E8%AE%AEhttphypertext-transfer-protocol\">6.6. è¶…æ–‡æœ¬ä¼ é€åè®®http(HyperText Transfer Protocol)</a></li>\n<li><a href=\"#67-%E5%8A%A8%E6%80%81%E4%B8%BB%E6%9C%BA%E9%85%8D%E7%BD%AE%E5%8D%8F%E8%AE%AEdhcpdynamic-host-configuration-protocol\">6.7. åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP(Dynamic Host Configuration Protocol)</a></li>\n<li><a href=\"#68-https%E5%8D%8F%E8%AE%AE%E8%AF%A6%E8%A7%A3\">6.8. HTTPSåè®®è¯¦è§£</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<h1>1. è®¡ç®—æœºç½‘ç»œæ¦‚è¿°</h1>\n<h2>1.1. è®¡ç®—æœºç½‘ç»œæ¦‚å¿µ</h2>\n<ul>\n<li>ISP(Internet Service Provider)ï¼šå› ç‰¹ç½‘æœåŠ¡æä¾›è€…ï¼ˆå¦‚ä¸­å›½ç”µä¿¡ç­‰ï¼‰ï¼Œå¯ä»¥ä»å› ç‰¹ç½‘ç®¡ç†ç»“æ„ç”³è¯·åˆ°å¾ˆå¤šIPåœ°å€ã€‚ä»»ä½•æœºæ„å’Œä¸ªäººåªè¦å‘æŸä¸ªISPäº¤çº³è§„å®šè´¹ç”¨å°±èƒ½è·å–IPåœ°å€ä½¿ç”¨æƒï¼Œå¹¶å¯é€šè¿‡è¯¥ISPæ¥å…¥äº’è”ç½‘.ä¸­å›½é€šè¿‡æµ·åº•ç”µç¼†è¿æ¥å¤–å›½ç½‘ç»œ</li>\n<li>IXP(Internet eXchagne Point)ï¼šå› ç‰¹ç½‘äº¤æ¢ç‚¹ï¼Œå°†ä¸¤ä¸ªISPç›´æ¥è¿æ¥ï¼Œä¸éœ€è¦é€šè¿‡ç¬¬ä¸‰ä¸ªISPè½¬å‘åˆ†ç»„ï¼Œæ›´åŠ æœ‰æ•ˆåˆ©ç”¨ç½‘ç»œèµ„æºã€‚ä¸€èˆ¬ç”±ä¸€ä¸ªæˆ–å¤šä¸ªæ•°æ®é“¾è·¯å±‚çš„ç½‘ç»œäº¤æ¢æœºæ„æˆçš„å±€åŸŸç½‘ç»„æˆï¼Œè®¸å¤šISPå†è¿æ¥åˆ°è¿™äº›ç½‘ç»œäº¤æ¢æœºçš„ç›¸å…³ç«¯å£</li>\n<li>RFC(Request For Comments)æ‰€æœ‰çš„å› ç‰¹ç½‘æ ‡å‡†éƒ½æ˜¯ä»¥RFCçš„å½¢å¼åœ¨å› ç‰¹ç½‘ä¸Šå‘è¡¨çš„</li>\n<li>è®¡ç®—æœºç½‘ç»œæ ‡å‡†åŒ–å·¥ä½œæ­¥éª¤ï¼šå› ç‰¹ç½‘è‰æ¡ˆã€å»ºè®®æ ‡å‡†ã€è‰æ¡ˆæ ‡å‡†ã€å› ç‰¹ç½‘æ ‡å‡†</li>\n<li>è®¡ç®—æœºç½‘ç»œç›¸å…³ç»„ç»‡ï¼šå›½é™…æ ‡å‡†åŒ–ç»„ç»‡ï¼ˆISOï¼‰ã€å›½é™…ç”µä¿¡è”ç›Ÿï¼ˆITUï¼‰ã€ç¾å›½ç”µæ°”å’Œç”µå­å·¥ç¨‹å¸ˆåä¼šï¼ˆIEEEï¼‰ç­‰</li>\n<li>è®¡ç®—æœºç½‘ç»œï¼šäº’è¿çš„ã€è‡ªæ²»çš„è®¡ç®—æœºç³»ç»Ÿçš„é›†åˆ</li>\n<li>AN(Access Network)æ¥å…¥ç½‘/æœ¬åœ°æ¥å…¥ç½‘æˆ–å±…æ°‘æ¥å…¥ç½‘ã€‚æ¥å…¥ç½‘æ˜¯ä»æŸä¸ªç«¯ç³»ç»Ÿåˆ°å¦ä¸€ä¸ªç«¯ç³»ç»Ÿçš„è·¯å¾„ä¸­ï¼Œç”±è¿™ä¸ªç«¯ç³»ç»Ÿåˆ°ç¬¬ä¸€ä¸ªè¾¹ç¼˜è·¯ç”±å™¨ä¹‹é—´çš„ä¸€äº›ç‰©ç†é“¾è·¯ç»„æˆã€‚ç”¨æˆ·å¯ä»¥ä½¿ç”¨å¤šç§æ¥å…¥ç½‘æŠ€æœ¯è¿æ¥åˆ°å› ç‰¹ç½‘ISP</li>\n<li>ç½‘ç»œåè®®(network protocol)ï¼šä¸ºè¿›è¡Œç½‘ç»œä¸­æ•°æ®äº¤æ¢è€Œå»ºç«‹çš„è§„åˆ™ã€æ ‡å‡†æˆ–çº¦å®šï¼Œè§„å®šäº†æ‰€äº¤æ¢çš„æ•°æ®çš„æ ¼å¼ä»¥åŠæœ‰å…³çš„åŒæ­¥é—®é¢˜ã€‚ç”±ä»¥ä¸‹ä¸‰è¦ç´ ç»„æˆ\n<ul>\n<li>è¯­æ³•ï¼šå®šä¹‰æ•°æ®å’Œæ§åˆ¶ä¿¡æ¯çš„ç»“æ„æˆ–æ ¼å¼</li>\n<li>è¯­ä¹‰ï¼šå®šä¹‰è¦å‘å‡ºä½•ç§æ§åˆ¶ä¿¡æ¯ï¼Œå®Œæˆä½•ç§åŠ¨ä½œä»¥åŠåšå‡ºä½•ç§å“åº”</li>\n<li>åŒæ­¥ï¼šå³äº‹ä»¶å®ç°é¡ºåºçš„è¯¦ç»†è¯´æ˜</li>\n</ul>\n</li>\n<li>å®ä½“(entity)ï¼šä»»ä½•å¯ä»¥å‘é€å’Œæ¥æ”¶ä¿¡æ¯çš„ç¡¬ä»¶æˆ–è½¯ä»¶è¿›ç¨‹</li>\n<li>å¯¹ç­‰å±‚ï¼šä¸åŒæœºå™¨ä¸Šçš„åŒä¸€å±‚</li>\n<li>å¯¹ç­‰å®ä½“ï¼šåŒä¸€å±‚ä¸Šçš„å®ä½“</li>\n<li>åè®®ï¼šæ§åˆ¶ä¸¤ä¸ªå¯¹ç­‰å®ä½“ï¼ˆæˆ–å¤šä¸ªå®ä½“ï¼‰è¿›è¡Œé€šä¿¡çš„è§„åˆ™çš„é›†åˆï¼Œåè®®åœ¨è¯­æ³•æ–¹é¢çš„è§„åˆ™å®šä¹‰äº†æ‰€äº¤æ¢çš„ä¿¡æ¯çš„æ ¼å¼ï¼›è€Œåè®®åœ¨è¯­ä¹‰æ–¹é¢çš„è§„åˆ™å°±å®šä¹‰äº†å‘é€è€…æˆ–è€…æ¥å—è€…æ‰€è¦å®Œæˆçš„æ“ä½œï¼›åè®®åœ¨åŒæ­¥æ–¹é¢è§„å®šäº†æ”¶å‘åŒæ–¹çš„æ—¶åºå…³ç³»ï¼Œå³åœ¨ä¸€å®šæ¡ä»¶ä¸‹åº”å½“å‘ç”Ÿä»€ä¹ˆäº‹ä»¶ã€‚åœ¨åè®®çš„æ§åˆ¶ä¸‹ï¼Œä¸¤ä¸ªå¯¹ç­‰å®ä½“ä¹‹é—´çš„é€šä¿¡ä½¿å¾—æœ¬å±‚èƒ½å¤Ÿå‘ä¸Šä¸€å±‚æä¾›æœåŠ¡ã€‚è¦å®ç°æœ¬å±‚åè®®ï¼Œè¿˜éœ€è¦ä½¿ç”¨ä¸‹é¢ä¸€å±‚æä¾›çš„æœåŠ¡ï¼Œä¸‹é¢çš„åè®®å¯¹ä¸Šé¢çš„å®ä½“æ˜¯é€æ˜çš„</li>\n<li>æœåŠ¡è®¿é—®ç‚¹SAP(Service Access Point)/æ¥å£ï¼šåœ¨åŒä¸€ç³»ç»Ÿä¸­ç›¸é‚»ä¸¤å±‚å®ä½“è¿›è¡Œäº¤äº’ï¼ˆå³äº¤æ¢ä¿¡æ¯ï¼‰çš„åœ°æ–¹\n<ul>\n<li>æœåŠ¡æ•°æ®å•å…ƒSDU(Service Data Unit)ï¼šç¬¬nå±‚çš„æœåŠ¡æ•°æ®å•å…ƒï¼Œè®°ä½œn-SDU å±‚ä¸å±‚ä¹‹é—´äº¤æ¢çš„æ•°æ®çš„å•ä½ï¼ˆå±‚ä¸å±‚ä¹‹é—´äº¤æ¢çš„æ•°æ®å•ä½ï¼‰</li>\n<li>åè®®æ§åˆ¶ä¿¡æ¯PCIï¼šç¬¬nå±‚çš„åè®®æ§åˆ¶ä¿¡æ¯ï¼Œè®°ä½œn-PCI</li>\n<li>æ¥å£æ§åˆ¶ä¿¡æ¯ICIï¼šç¬¬nå±‚çš„æ¥å£æ§åˆ¶ä¿¡æ¯ï¼Œè®°ä½œn-ICI</li>\n<li>åè®®æ•°æ®å•å…ƒPDU(Protocol Date Unit)ï¼šn-SDU + n-PCI = n-PDU ï¼ˆå¯¹ç­‰å±‚æ¬¡ä¹‹é—´ä¼ é€çš„æ•°æ®å•ä½ï¼‰</li>\n<li>æ¥å£æ•°æ®å•å…ƒIDUï¼šn-SDU + n-ICI = n-IDU</li>\n</ul>\n</li>\n</ul>\n<h2>1.2. è®¡ç®—æœºç½‘ç»œç»„æˆ</h2>\n<ul>\n<li>å·¥ä½œæ–¹å¼ç»„æˆ\n<ul>\n<li>è¾¹ç¼˜éƒ¨åˆ†ï¼šç”±æ‰€æœ‰è¿æ¥åœ¨å› ç‰¹ç½‘ä¸Šçš„ä¸»æœº/ç«¯ç³»ç»Ÿç»„æˆï¼Œç”¨æ¥è¿›è¡Œé€šä¿¡å’Œèµ„æºå…±äº«ï¼›ç«¯ç³»ç»Ÿä¹‹é—´çš„é€šä¿¡(å®é™…æ˜¯è®¡ç®—æœºè¿›ç¨‹é—´é€šä¿¡)æ–¹å¼åˆ†ä¸ºï¼š\n<ul>\n<li>ç»ˆç«¯æœºå™¨-&gt;è·¯ç”±å™¨-&gt;ç½‘å…³-&gt;åœ°åŒºISP</li>\n<li>ç»ˆç«¯æœºå™¨-&gt;è·¯ç”±å™¨-&gt;å†…éƒ¨ç½‘å…³-&gt;ç»Ÿä¸€ç½‘å…³-&gt;åœ°åŒºISP</li>\n<li>å®¢æˆ·-æœåŠ¡å™¨ï¼ˆC/Sï¼‰æ–¹å¼ï¼šå®¢æˆ·æ˜¯æœåŠ¡çš„è¯·æ±‚æ–¹ï¼ŒæœåŠ¡å™¨æ˜¯æœåŠ¡çš„æä¾›æ–¹ã€‚æœåŠ¡çš„è¯·æ±‚æ–¹å’ŒæœåŠ¡æä¾›æ–¹éƒ½è¦ä½¿ç”¨ç½‘ç»œæ ¸å¿ƒéƒ¨åˆ†æ‰€æä¾›çš„æœåŠ¡</li>\n<li>å¯¹ç­‰è¿æ¥æ–¹å¼ï¼ˆP2Pï¼‰æ–¹å¼ï¼šè¿è¡Œäº†å¯¹ç­‰è¿æ¥è½¯ä»¶çš„ä¸¤ä¸ªä¸»æœºå¯ä»¥å¹³ç­‰çš„ã€å¯¹ç­‰è¿æ¥é€šä¿¡ï¼ˆæ¯ä¸ªä¸»æœºæ—¢æ˜¯å®¢æˆ·ç«¯ä¹Ÿæ˜¯æœåŠ¡ç«¯ï¼‰</li>\n</ul>\n</li>\n<li>æ ¸å¿ƒéƒ¨åˆ†ï¼šç”±å¤§é‡çš„ç½‘ç»œå’Œè¿æ¥è¿™äº›ç½‘ç»œçš„è·¯ç”±å™¨ç»„æˆï¼Œä¸ºè¾¹ç¼˜éƒ¨åˆ†æä¾›è¿é€šæ€§å’Œäº¤æ¢æœåŠ¡\n<ul>\n<li>ä¸»å¹²ISP-&gt;å›½é™…è·¯ç”±å™¨-&gt;ä¸»å¹²ISP</li>\n<li>æŠ¥æ–‡(message)ï¼šè¦å‘é€çš„æ•´å—æ•°æ®</li>\n<li>åˆ†ç»„/åŒ…(packet)ï¼šå‘é€æŠ¥æ–‡å‰æŠŠè¾ƒé•¿çš„æŠ¥æ–‡åˆ’åˆ†ä¸ºä¸€ä¸ªæ›´å°çš„ç­‰é•¿æ•°æ®æ®µï¼Œåœ¨æ¯ä¸ªæ•°æ®æ®µå‰é¢åŠ ä¸Šå¿…è¦çš„æ§åˆ¶ä¿¡æ¯ç»„æˆçš„é¦–éƒ¨/åŒ…å¤´(header)åï¼Œå°±æ„æˆåˆ†ç»„ã€‚åˆ†ç»„æ˜¯å› ç‰¹ç½‘ä¸­ä¼ é€çš„æ•°æ®å•å…ƒã€‚ç”±äºåˆ†ç»„ä¸­çš„é¦–éƒ¨åŒ…å«äº†è¯¸å¦‚ç›®çš„åœ°å€å’Œæºåœ°å€ç­‰é‡è¦æ§åˆ¶ä¿¡æ¯ï¼Œæ¯ä¸ªåˆ†ç»„æ‰èƒ½åœ¨å› ç‰¹ç½‘ä¸­ç‹¬ç«‹åœ°é€‰æ‹©è·¯å¾„ï¼Œå¹¶è¢«æ­£ç¡®äº¤ä»˜åˆ°åˆ†ç»„ä¼ è¾“çš„ç»ˆç‚¹</li>\n<li>è·¯ç”±å™¨æ˜¯å®ç°åˆ†ç»„äº¤æ¢ï¼ˆpacket switchingï¼‰çš„å…³é”®æ„ä»¶ï¼Œä»»åŠ¡æ˜¯è½¬å‘æ”¶åˆ°çš„åˆ†ç»„(ç½‘ç»œå±‚çš„IPæ•°æ®æŠ¥)ã€‚åˆ†ç»„äº¤æ¢é‡‡ç”¨å­˜å‚¨è½¬å‘æŠ€æœ¯ã€‚è·¯ç”±å™¨æ”¶åˆ°ä¸€ä¸ªåˆ†ç»„ï¼Œå…ˆæš‚æ—¶åœ¨å­˜å‚¨å™¨(å†…å­˜)ä¸­å­˜å‚¨ä¸€ä¸‹ï¼Œæ£€æŸ¥å…¶é¦–éƒ¨ï¼ŒæŸ¥æ‰¾è½¬å‘è¡¨ï¼ŒæŒ‰ç…§é¦–éƒ¨ä¸­çš„ç›®çš„åœ°å€ï¼Œæ‰¾åˆ°åˆé€‚çš„æ¥å£è½¬å‘å‡ºå»ï¼ŒæŠŠåˆ†ç»„äº¤ç»™ä¸‹ä¸€ä¸ªè·¯ç”±å™¨ã€‚è¿™æ ·ä¸€æ­¥ä¸€æ­¥åœ°ï¼ˆæœ‰æ—¶å€™ä¼šç»è¿‡å‡ åä¸ªä¸åŒçš„è·¯ç”±å™¨ï¼‰ä»¥å­˜å‚¨è½¬å‘çš„æ–¹å¼ï¼ŒæŠŠåˆ†ç»„äº¤ä»˜æœ€ç»ˆçš„ç›®çš„ä¸»æœºã€‚å„è·¯ç”±å™¨ä¹‹é—´å¿…é¡»ç»å¸¸äº¤æ¢å½¼æ­¤æŒæ¡çš„è·¯ç”±ä¿¡æ¯ï¼Œä»¥ä¾¿åˆ›å»ºå’Œç»´æŒè·¯ç”±å™¨ä¸­çš„è½¬å‘è¡¨ï¼Œä½¿å¾—è½¬å‘è¡¨åœ¨æ•´ä¸ªç½‘ç»œæ‹“è¡¥å‘ç”Ÿå˜åŒ–æ—¶åŠæ—¶æ›´æ–°ã€‚</li>\n<li>åˆ†ç»„äº¤æ¢åœ¨ä¼ é€æ•°æ®ä¹‹å‰ä¸å¿…å ç”¨ä¸€æ¡ç«¯åˆ°ç«¯çš„é€šä¿¡èµ„æºï¼Œåˆ†ç»„åœ¨å“ªæ®µé“¾è·¯ä¸Šä¼ é€æ—¶ï¼Œæ‰å ç”¨è¿™æ®µé“¾è·¯çš„é€šä¿¡èµ„æº;åˆ†ç»„äº¤æ¢ä¸éœ€è¦å»ºç«‹è¿æ¥å’Œé‡Šæ”¾è¿æ¥;é‡‡ç”¨åœ¨æ•°æ®é€šä¿¡è¿‡ç¨‹ä¸­æ–­ç»­ï¼ˆæˆ–åŠ¨æ€ï¼‰åˆ†é…ä¼ è¾“å¸¦å®½çš„ç­–ç•¥</li>\n<li>åˆ†ç»„åœ¨å„è·¯ç”±å™¨å­˜å‚¨è½¬å‘éœ€è¦æ’é˜Ÿï¼Œé€ æˆä¸€å®šæ—¶å»¶;åˆ†ç»„äº¤æ¢æ— æ³•ä¿è¯é€šä¿¡æ—¶ç«¯åˆ°ç«¯æ‰€éœ€çš„å¸¦å®½;å„åˆ†ç»„æºå¸¦çš„æ§åˆ¶ä¿¡æ¯é€ æˆä¸€å®šå¼€é”€ã€‚æ•´ä¸ªåˆ†ç»„äº¤æ¢ç½‘è¿˜éœ€è¦ä¸“é—¨çš„ç®¡ç†å’Œæ§åˆ¶æœºåˆ¶</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ç‰©ç†ç»„æˆ\n<ul>\n<li>ç¡¬ä»¶ï¼šç”±ä¸»æœºã€é€šä¿¡å¤„ç†æœºï¼ˆå‰ç«¯å¤„ç†å™¨ï¼‰ã€é€šä¿¡çº¿è·¯ï¼ˆæœ‰çº¿çº¿è·¯å’Œæ— çº¿çº¿è·¯ï¼‰å’Œäº¤æ¢è®¾å¤‡ï¼ˆäº¤æ¢æœºç­‰è¿æ¥è®¾å¤‡ï¼‰ç»„æˆ</li>\n<li>è½¯ä»¶ï¼šå®ç°èµ„æºå…±äº«çš„è½¯ä»¶å’Œæ–¹ä¾¿ç”¨æˆ·ä½¿ç”¨çš„å„ç§å·¥å…·è½¯ä»¶</li>\n<li>åè®®ï¼šæ•°æ®åœ¨çº¿è·¯ä¸Šä¼ è¾“éµå¾ªçš„è§„åˆ™</li>\n</ul>\n</li>\n<li>åŠŸèƒ½ç»„æˆ\n<ul>\n<li>é€šä¿¡å­ç½‘ï¼šç”±å„ç§ä¼ è¾“ä»‹è´¨ã€é€šä¿¡è®¾å¤‡å’Œç›¸åº”çš„ç½‘ç»œåè®®ç»„æˆï¼Œä¸ºç½‘ç»œæä¾›æ•°æ®ä¼ è¾“ã€äº¤æ¢å’Œæ§åˆ¶èƒ½åŠ›ï¼Œå®ç°è”ç½‘è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡</li>\n<li>èµ„æºå­ç½‘ï¼šç”±ä¸»æœºã€ç»ˆç«¯ä»¥åŠå„ç§è½¯ä»¶èµ„æºã€ä¿¡æ¯èµ„æºç»„æˆï¼Œè´Ÿè´£å…¨ç½‘çš„æ•°æ®å¤„ç†ä¸šåŠ¡ï¼Œå‘ç½‘ç»œç”¨æˆ·æä¾›å„ç§ç½‘ç»œèµ„æºä¸æœåŠ¡</li>\n</ul>\n</li>\n</ul>\n<h2>1.3. è®¡ç®—æœºç½‘ç»œåŠŸèƒ½ï¼šæ•°æ®é€šä¿¡ã€èµ„æºå…±äº«ã€åˆ†å¸ƒå¼å¤„ç†ã€ä¿¡æ¯ç»¼åˆå¤„ç†ã€è´Ÿè½½å‡è¡¡ã€æé«˜å¯é æ€§</h2>\n<h2>1.4. è®¡ç®—æœºç½‘ç»œåˆ†ç±»</h2>\n<ul>\n<li>æŒ‰ç½‘ç»œä½œç”¨èŒƒå›´åˆ†ç±»ï¼šå¹¿åŸŸç½‘WAN(Wide Area Network)ã€åŸåŸŸç½‘MAN(Metropolitan Area Network)ã€å±€åŸŸç½‘LAN(Local Area Network)ã€ä¸ªäººåŒºåŸŸç½‘PAN(Personal Area Network)</li>\n<li>æŒ‰ä½¿ç”¨è€…åˆ†ç±»ï¼šå…¬ç”¨ç½‘(public network)ã€ä¸“ç”¨ç½‘(private network)</li>\n<li>æŒ‰æ‹“è¡¥ç»“æ„åˆ†ç±»ï¼šæ˜Ÿå‹ç½‘ç»œã€æ€»çº¿å‹ç½‘ç»œã€ç¯å½¢ç½‘ç»œã€ç½‘çŠ¶å½¢ç½‘ç»œ</li>\n<li>æŒ‰ä¼ è¾“æŠ€æœ¯åˆ†ç±»ï¼šå¹¿æ’­å¼ç½‘ç»œã€ç‚¹å¯¹ç‚¹ç½‘ç»œ</li>\n<li>æŒ‰æ•°æ®äº¤æ¢æŠ€æœ¯åˆ†ç±»ï¼šç”µè·¯äº¤æ¢ç½‘ç»œã€æŠ¥æ–‡äº¤æ¢ç½‘ç»œã€åˆ†ç»„äº¤æ¢ç½‘ç»œ</li>\n<li>æœåŠ¡ï¼šä¸‹å±‚ä¸ºç›¸é‚»ä¸Šå±‚æä¾›çš„åŠŸèƒ½è°ƒç”¨\n<ul>\n<li>é¢å‘è¿æ¥çš„æœåŠ¡TCPï¼šåŒæ–¹é€šä¿¡éœ€è¦å»ºç«‹é€šä¿¡çº¿è·¯ï¼ŒåŒ…æ‹¬å»ºç«‹è¿æ¥ã€ä½¿ç”¨è¿æ¥å’Œé‡Šæ”¾è¿æ¥3ä¸ªè¿‡ç¨‹</li>\n<li>é¢å‘æ— è¿æ¥çš„æœåŠ¡UDP/IPï¼šé€šä¿¡æ—¶åªéœ€æŠŠæ¯ä¸ªå¸¦æœ‰ç›®çš„åœ°å€çš„åŒ…ï¼ˆæŠ¥æ–‡åˆ†ç»„ï¼‰ä¼ é€åˆ°çº¿è·¯ä¸Šï¼Œç”±ç³»ç»Ÿé€‰å®šè·¯çº¿è¿›è¡Œä¼ è¾“</li>\n<li>å¯é æœåŠ¡ï¼šç½‘ç»œå…·æœ‰æ£€é”™ã€çº é”™ã€åº”ç­”æœºåˆ¶ï¼Œèƒ½ä¿è¯æ•°æ®æ­£ç¡®ã€å¯é åœ°ä¼ é€åˆ°ç›®çš„åœ°</li>\n<li>ä¸å¯é æœåŠ¡ï¼šç½‘ç»œä¸èƒ½ä¿è¯æ•°æ®æ­£ç¡®ã€å¯é åœ°ä¼ é€åˆ°ç›®çš„åœ°ï¼Œå°½åŠ›è€Œä¸ºçš„æœåŠ¡</li>\n</ul>\n</li>\n</ul>\n<h2>1.5. <strong>è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„</strong></h2>\n<ul>\n<li><strong>è®¡ç®—æœºç½‘ç»œçš„ä½“ç³»ç»“æ„</strong>:è®¡ç®—æœºç½‘ç»œçš„å„å±‚åŠå…¶åè®®çš„é›†åˆ/è¿™ä¸ªè®¡ç®—æœºç½‘ç»œåŠå…¶æ„ä»¶æ‰€å®Œæˆçš„åŠŸèƒ½çš„ç²¾ç¡®å®šä¹‰</li>\n<li>è®¡ç®—æœºç½‘ç»œä½“ç³»ç»“æ„åˆ†å±‚å¥½å¤„ï¼šå„å±‚ä¹‹é—´æ˜¯ç‹¬ç«‹çš„ã€çµæ´»æ€§å¥½ã€ç»“æ„ä¸Šå¯ä»¥åˆ†å‰²å¼€ã€æ˜“äºå®ç°å’Œç»´æŠ¤ã€èƒ½ä¿ƒè¿›æ ‡å‡†åŒ–å·¥ä½œ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/006edd2a16af2f7f2b12b.png\" alt=\"24.PNG\"></li>\n<li>å›½é™…æ ‡å‡†åŒ–ç»„ç»‡ISOæå‡ºçš„å¼€æ”¾ç³»ç»Ÿäº’è¿åŸºæœ¬å‚è€ƒæ¨¡å‹OSI/RM(Open Systems Interconnection Reference Model)æ¨¡å‹ï¼šæ³•å¾‹ä¸Šçš„å›½é™…æ ‡å‡†ï¼ˆ7å±‚åè®®çš„ä½“ç³»ç»“æ„ï¼‰(äº†è§£)</li>\n<li><strong>TCP/IPçš„ä½“ç³»ç»“æ„</strong>ï¼šäº‹å®ä¸Šçš„å›½é™…æ ‡å‡†(5å±‚åè®®çš„ä½“ç³»ç»“æ„)\n<ul>\n<li><strong>åº”ç”¨å±‚(ç”¨æˆ·å¯¹ç”¨æˆ·)</strong>ï¼šåº”ç”¨è¿›ç¨‹é—´çš„é€šä¿¡å’Œäº¤äº’è§„åˆ™ï¼ˆhttpã€SMTPã€FTPåè®®ï¼‰ä½¿ç”¨æŠ¥æ–‡ä½œä¸ºæ•°æ®å•å…ƒ</li>\n<li><strong>ä¼ è¾“å±‚(åº”ç”¨å¯¹åº”ç”¨ã€è¿›ç¨‹å¯¹è¿›ç¨‹)</strong>ï¼šè´Ÿè´£å‘ä¸¤ä¸ªä¸»æœºè¿›ç¨‹ä¹‹é—´çš„é€šä¿¡æä¾›é€šç”¨çš„æ•°æ®ä¼ è¾“æœåŠ¡ï¼ˆTCP/UDPåè®®ï¼‰</li>\n<li><strong>ç½‘ç»œå±‚(ä¸»æœºå¯¹ä¸»æœº)</strong>ï¼šè´Ÿè´£ä¸ºåˆ†ç»„äº¤æ¢ç½‘ä¸Šçš„ä¸åŒä¸»æœºæä¾›é€šä¿¡æœåŠ¡ï¼ŒæŠŠè¿è¾“å±‚çš„æŠ¥æ–‡å°è£…æˆåˆ†ç»„æˆ–åŒ…ï¼ˆIPæ•°æ®æŠ¥ï¼‰</li>\n<li><strong>æ•°æ®é“¾è·¯å±‚</strong>ï¼šè´Ÿè´£å°†ç½‘ç»œå±‚äº¤ä¸‹æ¥çš„IPæ•°æ®æŠ¥ç»„æˆå¸§</li>\n<li><strong>ç‰©ç†å±‚</strong>ï¼šç¡®å®šå¦‚ä½•è¯†åˆ«å‘é€æ–¹çš„æ¯”ç‰¹æµå’Œè¿æ¥ç”µç¼†çš„æ’å¤´åº”è¯¥æœ‰å¤šå°‘å¼•è„šä»¥åŠå„æ¡å¼•è„šåº”è¯¥å¦‚ä½•è¿æ¥ã€‚æ•°æ®å•ä½æ¯”ç‰¹</li>\n</ul>\n</li>\n</ul>\n<h2>1.6. <strong>è®¡ç®—æœºç½‘ç»œæ€§èƒ½æŒ‡æ ‡</strong></h2>\n<ul>\n<li><strong>æ¯”ç‰¹(bit)</strong>:äºŒè¿›åˆ¶æ•°å­—ä¸­ä¸€ä¸ªçš„1æˆ–0</li>\n<li><strong>é€Ÿç‡/æ¯”ç‰¹ç‡</strong>:å•ä½æ—¶é—´å†…ä¼ é€çš„æ¯”ç‰¹æ•°ï¼Œå•ä½b/sã€bit/sã€kb/sã€‚ç½‘ç»œçš„<strong>é¢å®šé€Ÿç‡</strong>.å¸¸ç”¨å•ä½ä¸ºMbps</li>\n<li><strong>å¸¦å®½(bandwidth)</strong>ï¼šå•ä½æ—¶é—´å†…ä»ç½‘ç»œçš„æŸä¸€ç‚¹åˆ°å¦ä¸€ç‚¹æ‰€èƒ½é€šè¿‡çš„<strong>æœ€é«˜æ•°æ®ç‡</strong>ã€‚å•ä½b/sã€kb/sã€‚è¡¨ç¤ºç½‘ç»œçš„é€šä¿¡çº¿è·¯ä¼ é€æ•°æ®çš„èƒ½åŠ›</li>\n<li><strong>ååé‡(throughput)</strong>ï¼šå•ä½æ—¶é—´å†…é€šè¿‡æŸä¸ªç½‘ç»œï¼ˆæˆ–ä¿¡é“ã€æ¥å£ï¼‰çš„<strong>å®é™…æ•°æ®é‡</strong>ï¼Œæœ‰æ—¶ååé‡è¿˜å¯ä»¥ç”¨æ¯ç§’ä¼ é€çš„å­—èŠ‚æ•°æˆ–å¸§æ•°è¡¨ç¤ºã€‚å—ç½‘ç»œçš„å¸¦å®½æˆ–è€…ç½‘ç»œçš„é¢å®šé€Ÿç‡çš„é™åˆ¶</li>\n<li><strong>æ—¶å»¶(delay/latency)</strong>ï¼šæ•°æ®ï¼ˆä¸€ä¸ªæŠ¥æ–‡\\åˆ†ç»„\\æ¯”ç‰¹ï¼‰ä»ç½‘ç»œï¼ˆæˆ–é“¾è·¯ï¼‰çš„ä¸€ç«¯ä¼ é€åˆ°å¦ä¸€ç«¯æ‰€éœ€çš„æ—¶é—´ï¼Œå•ä½sï¼ŒåŒ…æ‹¬å‘é€æ—¶å»¶ã€ä¼ æ’­æ—¶å»¶ã€å¤„ç†æ—¶å»¶ã€æ’é˜Ÿæ—¶å»¶\n<ul>\n<li>å‘é€æ—¶å»¶ï¼šå‘é€æ—¶å»¶ = æ•°æ®é•¿åº¦ï¼ˆbitï¼‰/å‘é€é€Ÿç‡ï¼ˆbit/sï¼‰(å—é™äºç½‘å¡)</li>\n<li>ä¼ æ’­æ—¶å»¶ï¼šä¼ æ’­æ—¶å»¶ = ä¼ è¾“è·¯å¾„è·ç¦»/ä¼ æ’­é€Ÿç‡(bit/s)ï¼ˆå—é™äºä¼ è¾“ä»‹è´¨ï¼‰</li>\n<li>æ’é˜Ÿæ—¶å»¶ï¼šæ’é˜Ÿæ—¶å»¶ = æ•°æ®åŒ…åœ¨ç½‘ç»œè®¾å¤‡ä¸­ç­‰å¾…è¢«å¤„ç†çš„æ—¶é—´</li>\n<li>å¤„ç†æ—¶å»¶ï¼šæ•°æ®åŒ…åˆ°è¾¾è®¾å¤‡æˆ–è€…ç›®çš„æœºå™¨è¢«å¤„ç†éœ€è¦çš„æ—¶é—´</li>\n</ul>\n</li>\n<li><strong>æ—¶å»¶å¸¦å®½ç§¯</strong>ï¼šä¼ æ’­æ—¶å»¶ä¹˜ä»¥å¸¦å®½ï¼ˆä»¥æ¯”ç‰¹ä¸ºå•ä½çš„é“¾è·¯é•¿åº¦ï¼‰å•ä½bit</li>\n<li><strong>å¾€è¿”æ—¶é—´RTT(Round-Trip Time)</strong>ï¼šä»å‘é€æ–¹å‘é€æ•°æ®å¼€å§‹ï¼Œåˆ°å‘é€æ–¹æ”¶åˆ°æ¥è‡ªæ¥å—æ–¹çš„ç«‹å³å‘é€çš„ç¡®è®¤æ‰€éœ€çš„æ—¶é—´ã€‚ä¸å‘é€çš„åˆ†ç»„é•¿åº¦æœ‰å…³.pingå‘½ä»¤æŸ¥çœ‹RTT</li>\n<li><strong>ä¿¡é“åˆ©ç”¨ç‡</strong>ï¼šæŸä¿¡é“æœ‰ç™¾åˆ†ä¹‹å‡ çš„æ—¶é—´æ˜¯è¢«åˆ©ç”¨çš„ï¼ˆæœ‰æ•°æ®é€šè¿‡ï¼‰ã€‚å®Œå…¨ç©ºé—²çš„ä¿¡é“åˆ©ç”¨ç‡ä¸º0</li>\n<li><strong>ç½‘ç»œåˆ©ç”¨ç‡</strong>ï¼šå…¨ç½‘è·¯çš„ä¿¡é“åˆ©ç”¨ç‡çš„åŠ æƒå¹³å‡å€¼ï¼Œä¿¡é“æˆ–ç½‘ç»œåˆ©ç”¨ç‡å¤ªé«˜ä¼šäº§ç”Ÿå¾ˆå¤§æ—¶å»¶</li>\n</ul>\n<h1>2. ç‰©ç†å±‚</h1>\n<h2>2.1. ç‰©ç†å±‚çš„åŸºæœ¬æ¦‚å¿µ</h2>\n<ul>\n<li>ç‰©ç†å±‚çš„ä¸»è¦ä»»åŠ¡ï¼šç¡®å®šä¸ä¼ è¾“åª’ä½“çš„æ¥å£æœ‰å…³çš„ä¸€äº›ç‰¹æ€§\n<ul>\n<li>æœºæ¢°ç‰¹æ€§ï¼šæŒ‡æ˜æ¥å£æ‰€ç”¨æ¥çº¿å™¨çš„å½¢çŠ¶å’Œå°ºå¯¸ã€å¼•è„šæ•°ç›®å’Œæ’åˆ—ã€å›ºå®šå’Œé”å®šè£…ç½®ç­‰</li>\n<li>ç”µæ°”ç‰¹æ€§ï¼šæŒ‡æ˜æ¥å£ç”µç¼†çš„å„æ¡çº¿ä¸Šå‡ºç°çš„ç”µå‹çš„èŒƒå›´</li>\n<li>åŠŸèƒ½ç‰¹æ€§ï¼šæŒ‡æ˜æŸæ¡çº¿ä¸Šå‡ºç°çš„æŸä¸€ç”µå¹³çš„ç”µå‹çš„æ„ä¹‰</li>\n<li>è¿‡ç¨‹ç‰¹æ€§ï¼šæŒ‡æ˜ä¸åŒåŠŸèƒ½çš„å„ç§å¯èƒ½æ—¶é—´çš„å‡ºç°é¡ºåº</li>\n</ul>\n</li>\n<li>ç‰©ç†å±‚ä½œç”¨ï¼šè€ƒè™‘æ€æ ·æ‰èƒ½åœ¨è¿æ¥å„ç§è®¡ç®—æœºçš„ä¼ è¾“åª’ä½“ä¸Šä¼ è¾“æ•°æ®æ¯”ç‰¹æµï¼Œè€Œä¸æ˜¯æŒ‡å…·ä½“åª’ä½“ã€‚å±è”½ä¼ è¾“åª’ä½“å’Œé€šä¿¡æ‰‹æ®µçš„å·®å¼‚ï¼Œä½¿æ•°æ®é“¾è·¯å±‚æ„Ÿè§‰ä¸åˆ°.è¿æ¥ä¸åŒçš„ç‰©ç†è®¾å¤‡,ä¼ è¾“æ¯”ç‰¹æµï¼ˆé«˜ä½ç”µå¹³ã€æ•°å­—ä¿¡å·ï¼‰</li>\n<li>æ¯”ç‰¹æµï¼šç‰©ç†å±‚çš„ä¼ è¾“çš„å•ä½(æ•°å­—ä¿¡å·ï¼ˆé«˜ä½ç”µå¹³ï¼‰)</li>\n</ul>\n<h2>2.2. æ•°æ®é€šä¿¡çš„åŸºç¡€çŸ¥è¯†ï¼ˆäº†è§£ï¼‰</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1b2277e0e71f845df91ca.png\" alt=\"42.PNG\" tabindex=\"0\"><figcaption>42.PNG</figcaption></figure>\n<ul>\n<li>æ•°æ®é€šä¿¡ç³»ç»Ÿæ¨¡å‹\n<ul>\n<li>æºç³»ç»Ÿ/å‘é€ç«¯/å‘é€æ–¹\n<ul>\n<li>æºç‚¹(source)/æºç«™/ä¿¡æºï¼šæºç‚¹è®¾å¤‡äº§ç”Ÿè¦è¾“å‡ºçš„æ•°å­—æ¯”ç‰¹æµ</li>\n<li>å‘é€å™¨/è°ƒåˆ¶è§£è°ƒå™¨ï¼šæºç‚¹ç”Ÿæˆçš„æ•°å­—æ¯”ç‰¹æµè¦é€šè¿‡å‘é€å™¨ç¼–ç æˆæ¨¡æ‹Ÿä¿¡å·</li>\n</ul>\n</li>\n<li>ä¼ è¾“ç³»ç»Ÿ/ä¼ è¾“ç½‘ç»œ/ä¿¡é“ï¼šä¿¡å·çš„ä¼ è¾“åª’è´¨</li>\n<li>ç›®çš„ç³»ç»Ÿ/æ¥æ”¶ç«¯/æ¥æ”¶æ–¹\n<ul>\n<li>æ¥æ”¶å™¨/è°ƒåˆ¶è§£è°ƒå™¨ï¼šæ¥æ”¶æ¨¡æ‹Ÿä¿¡å·è¿›è¡Œè§£è°ƒè¿˜åŸæˆæºç‚¹äº§ç”Ÿçš„æ•°å­—æ¯”ç‰¹æµ</li>\n<li>ç»ˆç‚¹(destination)/ç›®çš„ç«™/ä¿¡å®¿ï¼šç»ˆç‚¹è®¾å¤‡ä»æ¥æ”¶å™¨è·å–ä¼ é€è¿‡æ¥çš„æ•°å­—æ¯”ç‰¹æµï¼Œç„¶åè¾“å‡ºä¿¡æ¯</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>æ•°æ®(data)ï¼šä¼ é€æ¶ˆæ¯çš„å®ä½“ï¼Œé€šå¸¸æ˜¯æœ‰æ„ä¹‰çš„ç¬¦å·åºåˆ—</li>\n<li>ç å…ƒï¼šåœ¨ä½¿ç”¨æ—¶é—´åŸŸçš„æ³¢å½¢è¡¨ç¤ºæ•°å­—ä¿¡å·æ—¶ï¼Œåˆ™ä»£è¡¨ä¸åŒç¦»æ•£æ•°å€¼çš„åŸºæœ¬æ³¢å½¢å°±ç§°ä¸ºç å…ƒ</li>\n<li>ä¿¡å·(signal)ï¼šæ•°æ®çš„ç”µæ°”æˆ–ç”µç£çš„è¡¨ç°ã€‚æ ¹æ®ä¿¡å·ä¸­ä»£è¡¨æ¶ˆæ¯çš„å‚æ•°å–å€¼æ–¹å¼ä¸åŒåˆ†ä¸ºï¼š\n<ul>\n<li>æ¨¡æ‹Ÿ/è¿ç»­/å®½å¸¦ä¿¡å·ï¼šä»£è¡¨æ¶ˆæ¯çš„å‚æ•°çš„å–å€¼æ˜¯è¿ç»­å˜åŒ–çš„ï¼›å°†åŸºå¸¦ä¿¡å·è°ƒåˆ¶åå½¢æˆ(ç”¨æˆ·çš„è°ƒåˆ¶è°ƒèŠ‚å™¨åˆ°ç”µè¯ç«¯å±€ä¹‹é—´çš„ç”¨æˆ·çº¿ä¸Šä¼ è¾“çš„å°±æ˜¯æ¨¡æ‹Ÿä¿¡å·)</li>\n<li>æ•°å­—/ç¦»æ•£/åŸºå¸¦ä¿¡å·ï¼šä»£è¡¨æ¶ˆæ¯çš„å‚æ•°çš„å–å€¼æ˜¯æœ‰é™ç¦»æ•£çš„ï¼›å°†æ•°æ®ä¿¡å·çš„0å’Œ1ç”¨ä¸åŒçš„ç”µå‹è¡¨ç¤º(PCåˆ°è°ƒåˆ¶è§£è°ƒå™¨ä¹‹é—´ï¼Œæˆ–åœ¨ç”µè¯ç½‘ä¸­ç»§çº¿ä¸Šä¼ è¾“çš„å°±æ˜¯æ•°å­—ä¿¡å·)</li>\n</ul>\n</li>\n<li>ä¿¡é“(channel):ç”¨æ¥è¡¨ç¤ºå‘æŸä¸€ä¸ªæ–¹å‘ä¼ é€ä¿¡æ¯çš„åª’ä½“ï¼Œä¸€æ¡é€šä¿¡ç”µè·¯é€šå¸¸åŒ…å«ä¸€æ¡å‘é€ä¿¡é“å’Œä¸€æ¡æ¥æ”¶ä¿¡é“</li>\n<li>åŸºå¸¦ä¿¡å·ï¼šæ¥è‡ªä¿¡æºçš„ä¿¡å·ï¼ˆè®¡ç®—æœºè¾“å‡ºçš„ä»£è¡¨å„ç§æ–‡å­—æˆ–å›¾åƒæ–‡ä»¶çš„æ•°æ®ä¿¡å·éƒ½å±äºåŸºå¸¦ä¿¡å·</li>\n<li>è°ƒåˆ¶(modulation): è§£å†³åŸºå¸¦ä¿¡å·å¾€å¾€åŒ…å«è¾ƒå¤šçš„ä½é¢‘æˆåˆ†ï¼Œç”šè‡³æœ‰ç›´æµæˆåˆ†ï¼Œè€Œå¾ˆå¤šä¿¡é“å¹¶ä¸èƒ½ä¼ è¾“è¿™ç§ä½é¢‘åˆ†é‡æˆ–ç›´æµåˆ†é‡çš„é—®é¢˜\n<ul>\n<li>åŸºå¸¦è°ƒåˆ¶/ç¼–ç (coding)ï¼šä»…å¯¹åŸºå¸¦ä¿¡å·çš„æ³¢å½¢è¿›è¡Œå˜æ¢ï¼Œä½¿å®ƒèƒ½å¤Ÿä¸ä¿¡é“ç‰¹æ€§ç›¸é€‚åº”ã€‚å˜æ¢åçš„ä¿¡å·ä¾ç„¶æ˜¯åŸºå¸¦ä¿¡å·;å¸¸ç”¨æ›¼å½»æ–¯ç‰¹(Manchester)ç¼–ç æ–¹å¼ï¼šäº§ç”Ÿä¿¡å·é¢‘ç‡é«˜ï¼Œè¿˜å…·æœ‰åŒæ­¥èƒ½åŠ›ï¼Œå³èƒ½ä»æ³¢å½¢æœ¬èº«æå–ä¿¡å·æ—¶é’Ÿé¢‘ç‡</li>\n<li>å¸¦é€šè°ƒåˆ¶ï¼šä½¿ç”¨è½½æ³¢è¿›è¡Œè°ƒåˆ¶ï¼ŒæŠŠåŸºå¸¦ä¿¡å·çš„é¢‘ç‡èŒƒå›´æ¬ç§»åˆ°è¾ƒé«˜çš„é¢‘æ®µï¼Œå¹¶è½¬æ¢ä¸ºæ¨¡æ‹Ÿ/å¸¦é€šä¿¡å·ï¼ˆä»…åœ¨ä¸€æ®µé¢‘ç‡èŒƒå›´å†…èƒ½å¤Ÿé€šè¿‡ä¿¡é“ï¼‰åŸºæœ¬çš„å¸¦é€šè°ƒåˆ¶æ–¹æ³•å¦‚ä¸‹\n<ul>\n<li>è°ƒå¹…(AM) è½½æ³¢çš„æŒ¯å¹…éšåŸºå¸¦æ•°å­—ä¿¡å·è€Œå˜åŒ–</li>\n<li>è°ƒé¢‘(FM) è½½æ³¢çš„é¢‘ç‡éšåŸºå¸¦æ•°å­—ä¿¡å·è€Œå˜åŒ–</li>\n<li>è°ƒç›¸(PM) è½½æ³¢çš„åˆå§‹ç›¸ä½éšåŸºå¸¦æ•°å­—ä¿¡å·è€Œå˜åŒ–</li>\n<li>ä¸ºäº†è¾¾åˆ°æ›´é«˜çš„ä¿¡æ¯ä¼ è¾“é€Ÿç‡ï¼Œå¿…é¡»é‡‡ç”¨å¤šå…ƒåˆ¶çš„æŒ¯å¹…ç›¸ä½æ··åˆè°ƒåˆ¶æ–¹æ³•-&gt;æ­£äº¤æŒ¯å¹…è°ƒåˆ¶QAM(Quadrature Amplitude Modulation)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>æ•°æ®ä¼ è¾“æ–¹å¼\n<ul>\n<li>ä¸²è¡Œä¼ è¾“ï¼šä¸€ä¸ªä¸€ä¸ªæ¯”ç‰¹æŒ‰ç…§é¡ºåºä¼ è¾“ï¼ˆè¿œè·ç¦»ä¼ è¾“ï¼‰</li>\n<li>å¹¶è¡Œä¼ è¾“ï¼šå¤šä¸ªæ¯”ç‰¹é€šè¿‡å¤šæ¡é€šä¿¡ä¿¡é“ä¼ è¾“ï¼ˆè¿‘è·ç¦»ä¼ è¾“ï¼‰</li>\n</ul>\n</li>\n<li>é€šä¿¡æ–¹å¼\n<ul>\n<li>åŒæ­¥é€šä¿¡ï¼šè¦æ±‚æ¥æ”¶ç«¯çš„æ—¶é’Ÿé¢‘ç‡å’Œå‘é€ç«¯çš„æ—¶é’Ÿé¢‘ç‡ç›¸ç­‰ï¼Œä»¥ä¾¿æ¥æ”¶ç«¯å¯¹æ”¶åˆ°çš„æ¯”ç‰¹æµçš„é‡‡ç”¨åˆ¤å†³æ—¶é—´æ˜¯å‡†ç¡®çš„</li>\n<li>å¼‚æ­¥é€šä¿¡ï¼šå‘é€æ•°æ®ä»¥å­—èŠ‚ä¸ºå•ä½ï¼Œå‘é€å®Œä¸€ä¸ªå­—èŠ‚åå¯ä»¥ç»è¿‡ä»»æ„é•¿çš„æ—¶é—´é—´éš”å†å‘é€ä¸‹ä¸€ä¸ªå­—èŠ‚</li>\n</ul>\n</li>\n<li><strong>ä¿¡æ¯äº¤äº’æ–¹å¼</strong>\n<ul>\n<li><strong>å•å‘é€šä¿¡/å•å·¥é€šä¿¡</strong>ï¼šåªèƒ½æœ‰ä¸€ä¸ªæ–¹å‘çš„é€šä¿¡è€Œæ²¡æœ‰åæ–¹å‘çš„äº¤äº’ï¼ˆæ— çº¿ç”µå¹¿æ’­æˆ–æœ‰çº¿ç”µå¹¿æ’­ï¼‰ï¼Œ1ä¸ªä¿¡é“</li>\n<li><strong>åŒå‘äº¤æ›¿é€šä¿¡/åŠåŒå·¥é€šä¿¡</strong>ï¼šåŒæ–¹éƒ½å¯ä»¥å‘é€æ¶ˆæ¯ï¼Œä½†ä¸èƒ½åŒæ–¹åŒæ—¶å‘é€å’ŒåŒæ—¶æ¥æ”¶ï¼Œ2ä¸ªä¿¡é“</li>\n<li><strong>åŒæ–¹åŒæ—¶é€šä¿¡/å…¨åŒå·¥é€šä¿¡</strong>ï¼šé€šä¿¡çš„åŒæ–¹éƒ½å¯ä»¥åŒæ—¶å‘é€å’Œæ¥æ”¶æ¶ˆæ¯ï¼Œ2ä¸ªä¿¡é“</li>\n</ul>\n</li>\n<li>æ•°å­—é€šä¿¡çš„ä¼˜ç‚¹ï¼šåœ¨æ¥æ”¶ç«¯åªè¦èƒ½ä»å¤±çœŸçš„æ³¢å½¢è¯†åˆ«å‡ºåŸæ¥çš„ä¿¡å·ï¼Œé‚£ä¹ˆè¿™ç§å¤±çœŸå¯¹é€šä¿¡è´¨é‡å°±æ²¡æœ‰å½±å“ã€‚ç å…ƒçš„ä¼ è¾“é€Ÿç‡è¶Šé«˜ï¼Œæˆ–è€…ä¿¡å·ä¼ è¾“çš„è·ç¦»è¶Šè¿œï¼Œæˆ–å™ªå£°å¹²æ‰°è¶Šå¤§ï¼Œæˆ–ä¼ è¾“åª’ä½“è´¨é‡è¶Šå·®ï¼Œåœ¨æ¥æ”¶ç«¯çš„æ³¢å½¢å¤±çœŸå°±è¶Šä¸¥é‡ã€‚</li>\n<li><strong>é™åˆ¶ç å…ƒåœ¨ä¿¡é“ä¸Šä¼ è¾“é€Ÿç‡çš„å› ç´ </strong>ï¼š\n<ul>\n<li><strong>ä¿¡é“èƒ½é€šè¿‡çš„é¢‘ç‡èŒƒå›´</strong>ï¼š<strong>å¥ˆå¥æ–¯ç‰¹(Nyquistå¥ˆæ°)å‡†åˆ™</strong>ï¼šåœ¨ä»»ä½•ä¿¡é“ä¸­ï¼Œç å…ƒä¼ è¾“é€Ÿç‡æ˜¯æœ‰ä¸Šé™çš„ï¼Œä¼ è¾“é€Ÿç‡è¶…è¿‡æ­¤ä¸Šé™ï¼Œå°±ä¼šå‡ºç°ä¸¥é‡çš„ç é—´ä¸²æ‰°çš„é—®é¢˜ï¼Œä½¿æ¥æ”¶ç«¯å¯¹ç å…ƒçš„åˆ¤åˆ«æˆä¸ºä¸å¯èƒ½ã€‚å¦‚æœä¿¡é“çš„é¢‘å¸¦è¶Šå®½ï¼Œä¹Ÿå°±æ˜¯èƒ½å¤Ÿé€šè¿‡çš„ä¿¡å·é«˜é¢‘åˆ†é‡è¶Šå¤šï¼Œé‚£ä¹ˆå°±å¯ä»¥ç”¨æ›´é«˜çš„é€Ÿç‡ä¼ é€ç å…ƒè€Œä¸å‡ºç°ç é—´ä¸²æ‰°</li>\n<li><strong>ä¿¡å™ªæ¯”</strong>ï¼šä¿¡å·çš„å¹³å‡åŠŸç‡å’Œå™ªå£°çš„å¹³å‡åŠŸç‡ä¹‹æ¯”ï¼ˆS/Nï¼‰ï¼Œå•ä½åˆ†è´(dB)ï¼š<strong>é¦™å†œ(Shannon)å…¬å¼</strong>ï¼šä¿¡é“çš„å¸¦å®½æˆ–ä¿¡é“ä¸­çš„ä¿¡å™ªæ¯”è¶Šå¤§ï¼Œä¿¡æ¯çš„æé™ä¼ è¾“é€Ÿç‡è¶Šé«˜ï¼Œåªè¦ä¿¡æ¯ä¼ è¾“é€Ÿç‡ä½äºä¿¡é“çš„æé™ä¿¡æ¯ä¼ è¾“é€Ÿç‡ï¼Œå°±å¯ä»¥æ‰¾åˆ°æŸç§åŠæ³•æ¥å®ç°æ— å·®é”™çš„ä¼ è¾“ã€‚å½“ç å…ƒä¼ è¾“é€Ÿç‡è¾¾åˆ°ä¸Šé™æ—¶ï¼Œå¯ä»¥é€šè¿‡ç¼–ç çš„æ–¹å¼è®©æ¯ä¸ªç å…ƒæºå¸¦æ›´å¤šæ¯”ç‰¹çš„ä¿¡æ¯é‡æ¥æé«˜ä¿¡æ¯çš„ä¼ è¾“é€Ÿç‡</li>\n</ul>\n</li>\n</ul>\n<h2>2.3. ä¼ è¾“åª’ä½“</h2>\n<ul>\n<li><strong>ä¼ è¾“åª’ä½“/ä¼ è¾“ä»‹è´¨/ä¼ è¾“åª’ä»‹</strong>ï¼Œå°±æ˜¯æ•°æ®ä¼ è¾“ç³»ç»Ÿä¸­åœ¨å‘é€å™¨å’Œæ¥æ”¶å™¨ä¸­çš„ç‰©ç†é€šè·¯\n<ul>\n<li><strong>å¼•å¯¼å‹ä¼ è¾“åª’ä½“</strong>ï¼šç”µç£æ³¢æ²¿ç€å›ºä½“åª’ä½“ä¼ æ’­ï¼šåŒç»çº¿ï¼ˆç½‘çº¿ï¼ŒåŒç»ä¸ºäº†æŠ‘åˆ¶ç›¸é‚»å¯¼çº¿å™ªå£°å¹²æ‰°ï¼‰ã€åŒè½´ç”µç¼†ï¼ˆæœ‰çº¿ç”µè§†ç½‘ï¼‰å’Œå…‰çº¤</li>\n<li><strong>éå¼•å¯¼å‹ä¼ è¾“åª’ä½“</strong>ï¼šç”µç£æ³¢åœ¨è‡ªç”±ç©ºé—´ä¸­ä¼ è¾“ï¼ˆæ— çº¿ï¼‰ï¼šæ— çº¿ç”µå¾®æ³¢é€šä¿¡å’Œçº¢å¤–é€šä¿¡ã€æ¿€å…‰é€šä¿¡</li>\n</ul>\n</li>\n</ul>\n<h2>2.4. ä¿¡é“å¤ç”¨æŠ€æœ¯</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4917849a166e641a1cb00.png\" alt=\"43.PNG\" tabindex=\"0\"><figcaption>43.PNG</figcaption></figure>\n<ul>\n<li>æé«˜ä¿¡é“åˆ©ç”¨ç‡</li>\n<li>é¢‘åˆ†å¤ç”¨FDM(Frequency Division Multiplexing)ï¼šæŒ‰é¢‘ç‡åˆ’åˆ†çš„ä¸åŒä¿¡é“ï¼Œç”¨æˆ·åˆ†åˆ°ä¸€å®šçš„é¢‘å¸¦åï¼Œåœ¨é€šä¿¡è¿‡ç¨‹ä¸­è‡ªå§‹è‡³ç»ˆéƒ½å ç”¨è¿™ä¸ªé¢‘å¸¦ï¼Œæ‰€æœ‰ç”¨æˆ·åœ¨åŒæ ·çš„æ—¶é—´å ç”¨ä¸åŒçš„é¢‘ç‡å¸¦å®½</li>\n<li>æ—¶åˆ†å¤ç”¨TDM(Time Division Multiplexing)/åŒæ­¥æ—¶åˆ†å¤ç”¨ï¼šæŒ‰æ—¶é—´åˆ’åˆ†ä¸ºä¸€æ®µæ®µç­‰é•¿çš„æ—¶åˆ†å¤ç”¨å¸§(TMDå¸§)ï¼Œæ¯ä¸€ä¸ªæ—¶åˆ†å¤ç”¨çš„ç”¨æˆ·åœ¨æ¯ä¸€ä¸ªTDMå¸§ä¸­å ç”¨å›ºå®šåºåˆ—å·çš„é—´éš™ï¼Œæ‰€æœ‰ç”¨æˆ·æ˜¯åœ¨ä¸åŒæ—¶é—´å ç”¨åŒæ ·çš„é¢‘å¸¦å®½åº¦ï¼Œæ¯ä¸ªç”¨æˆ·å ç”¨çš„é¢‘å¸¦å®½åº¦å›ºå®š</li>\n<li>ç»Ÿè®¡/å¼‚æ­¥æ—¶åˆ†å¤ç”¨STDM(Statistic TDM)ï¼šæ‰€æœ‰ç”¨æˆ·æ˜¯åœ¨ä¸åŒæ—¶é—´å ç”¨åŒæ ·çš„é¢‘å¸¦å®½åº¦ï¼Œæ¯ä¸ªç”¨æˆ·å ç”¨çš„é¢‘å¸¦å®½åº¦æ ¹æ®éœ€è¦å˜åŒ–</li>\n<li>æ³¢åˆ†å¤ç”¨WDM(Wavelength Division Multiplexing)/å…‰çš„é¢‘åˆ†å¤ç”¨ï¼šå…‰çº¤æŠ€æœ¯ä¸­ç”±äºå…‰è½½æ³¢çš„é¢‘ç‡å¾ˆé«˜ï¼Œå› æ­¤ä¹ æƒ¯ä¸Šç”¨æ³¢é•¿è€Œä¸ç”¨é¢‘ç‡æ¥è¡¨ç¤ºæ‰€ç”¨çš„å…‰è½½æ³¢ï¼Œæ•…ç§°ä¸ºæ³¢åˆ†å¤ç”¨</li>\n<li>ç åˆ†å¤ç”¨CDM(Code Division Multiplexing)ï¼šæ‰€æœ‰ç”¨æˆ·å¯ä»¥åœ¨åŒæ ·çš„æ—¶é—´ä½¿ç”¨åŒæ ·çš„é¢‘å¸¦ã€‚å„ç”¨æˆ·ä½¿ç”¨ç»è¿‡ç‰¹æ®Šå¤„ç†çš„ä¸åŒç å‹ï¼Œå› æ­¤å„ä¸ªç”¨æˆ·ä¹‹é—´ä¸ä¼šé€ æˆå¹²æ‰°</li>\n</ul>\n<h2>2.5. ç‰©ç†å±‚è®¾å¤‡</h2>\n<ul>\n<li>ä¸­ç»§å™¨ï¼šå°†å·²ç»è¡°å‡å¾—ä¸å®Œæ•´çš„ä¿¡å·ç»è¿‡æ•´ç†ï¼Œé‡æ–°äº§ç”Ÿå®Œæ•´çš„ä¿¡å·åœ¨ç»§ç»­ä¼ é€ï¼Œæ”¾å¤§çš„æ˜¯æ•°å­—ä¿¡å·</li>\n<li>é›†çº¿å™¨ï¼šå¤šä¸ªç«¯å£çš„ä¸­ç»§å™¨ï¼Œæ”¶åˆ°æ¶ˆæ¯åå¹¿æ’­åˆ°å…¶ä»–è®¡ç®—æœºï¼Œå…¶ä»–è®¡ç®—æœºåˆ¤æ–­æ˜¯å¦æ˜¯å‘ç»™è‡ªå·±çš„ï¼Œæ˜¯è‡ªå·±çš„å°±å¤„ç†</li>\n</ul>\n<h2>2.6. è¿æ¥ç”¨æˆ·ä¸äº’è”ç½‘çš„æ¥å…¥ç½‘</h2>\n<ul>\n<li>æ‰€è°“æ¥å…¥ç½‘ï¼Œå°±æ˜¯æŒ‡è¿æ¥äº’è”ç½‘ä¸å®¶åº­ã€å…¬å¸ç½‘ç»œçš„é€šä¿¡çº¿è·¯ ã€‚ä¸€èˆ¬å®¶ç”¨çš„æ¥å…¥ç½‘æ–¹å¼åŒ…æ‹¬ ADSL ã€FTTH ã€CATVã€ç”µè¯çº¿ã€ISDN ç­‰ï¼Œå…¬å¸åˆ™è¿˜å¯èƒ½ä½¿ç”¨ä¸“çº¿\n<ul>\n<li>ADSLï¼šAsymmetric Digital Subscriber Lineï¼Œä¸å¯¹ç§°æ•°å­—ç”¨æˆ·çº¿ã€‚å®ƒæ˜¯ä¸€ç§åˆ©ç”¨æ¶è®¾åœ¨ç”µçº¿æ†ä¸Šçš„é‡‘å±ç”µè¯çº¿æ¥è¿›è¡Œé«˜é€Ÿé€šä¿¡çš„æŠ€æœ¯ï¼Œå®ƒçš„ä¸Šè¡Œæ–¹å‘ï¼ˆç”¨æˆ·åˆ°äº’è”ç½‘ï¼‰å’Œä¸‹è¡Œæ–¹å‘ï¼ˆäº’è”ç½‘åˆ°ç”¨æˆ·ï¼‰çš„é€šä¿¡é€Ÿç‡æ˜¯ä¸å¯¹ç§°çš„</li>\n<li>FTTHï¼šFiber To The Homeï¼Œå…‰çº¤åˆ°æˆ·ã€‚æŒ‡çš„æ˜¯å°†å…‰çº¤æ¥å…¥å®¶åº­çš„æ„æ€</li>\n<li>ç”¨æˆ·ç«¯è·¯ç”±å™¨ å‘å‡ºçš„ç½‘ç»œåŒ…é€šè¿‡ ADSL Modem å’Œç”µè¯çº¿åˆ°è¾¾ç”µè¯å±€ï¼Œç„¶ååˆ°è¾¾ ADSL çš„ç½‘ç»œè¿è¥å•†ï¼ˆå³ ISPï¼Œäº’è”<br>\nç½‘æœåŠ¡æä¾›å•†ï¼‰ã€‚åœ¨ç½‘ç»œåŒ…ä»ç”¨æˆ·ä¼ è¾“åˆ°è¿è¥å•†çš„è¿‡ç¨‹ä¸­ï¼Œä¼šå˜æ¢å‡ ç§ä¸åŒçš„å½¢æ€ï¼Œ</li>\n<li>BASï¼šBroadband Access Serverï¼Œå®½å¸¦æ¥å…¥æœåŠ¡å™¨ã€‚å®ƒä¹Ÿæ˜¯ä¸€ç§è·¯ç”±å™¨ã€‚</li>\n<li>PPPï¼šPoint-to-Point Protocolï¼Œç‚¹åˆ°ç‚¹åè®®ã€‚å®ƒæ˜¯ç”µè¯çº¿ã€ISDN ç­‰é€šä¿¡çº¿è·¯æ‰€ä½¿ç”¨çš„ä¸€ç§åè®®ï¼Œé›†æˆäº†ç”¨æˆ·è®¤è¯ã€é…ç½®ä¸‹å‘ã€æ•°æ®å‹ç¼©ã€åŠ å¯†ç­‰å„ç§åŠŸèƒ½ã€‚</li>\n<li>ADSL Modem ä¼šæŠŠåŒ…æ‹†åˆ†æˆå¾ˆå¤šå°æ ¼å­ï¼ˆå›¾ 4.3 â‘¦ï¼‰ï¼Œæ¯ä¸€ä¸ªå°æ ¼å­ç§°ä¸ºä¸€ä¸ªä¿¡å…ƒã€‚ä¿¡å…ƒæ˜¯ä¸€ä¸ªéå¸¸å°çš„æ•°æ®å—ï¼Œå¼€å¤´æ˜¯æœ‰ 5ä¸ªå­—èŠ‚çš„å¤´éƒ¨ï¼Œåé¢æ˜¯ 48 ä¸ªå­—èŠ‚çš„æ•°æ®ï¼Œç”¨äºä¸€ç§å«ä½œ ATM çš„é€šä¿¡æŠ€æœ¯ã€‚ADSL Modem å°†åŒ…æ‹†åˆ†æˆä¿¡å…ƒï¼Œå¹¶è½¬æ¢æˆç”µä¿¡å·å‘é€ç»™åˆ†ç¦»å™¨ã€‚</li>\n<li>ATMï¼šAsynchronous Transfer Modeï¼Œå¼‚æ­¥ä¼ è¾“ã€‚å®ƒæ˜¯åœ¨ä»¥ç”µè¯çº¿ä¸ºè½½ä½“çš„ä¼ ç»Ÿç”µè¯æŠ€æœ¯åŸºç¡€ä¸Šæ‰©å±•å‡ºæ¥çš„ä¸€ç§é€šä¿¡æ–¹å¼ã€‚å®ƒçš„æ•°æ®ä¼ è¾“æ˜¯ä»¥â€œä¿¡å…ƒâ€ä¸ºå•ä½æ¥è¿›è¡Œçš„ï¼Œè¿™å’Œä»¥åŒ…ä¸ºå•ä½ä¼ è¾“æ•°æ®çš„ TCP/IP å¾ˆåƒï¼Œä½†è¿™ç§æ–¹å¼å¹¶ä¸é€‚ç”¨äºè®¡ç®—æœºé€šä¿¡</li>\n<li>å°†æ•°å­—ä¿¡æ¯è½¬æ¢æˆæ¨¡æ‹Ÿä¿¡å·ï¼ŒADSL é‡‡ç”¨çš„æ–¹æ³•è¦å¤æ‚ä¸€äº›ã€‚å…¶ä¸­æœ‰ä¸¤ä¸ªåŸå› ï¼Œä¸€ä¸ªåŸå› æ˜¯æ–¹æ³¢ä¿¡å·çš„æ³¢å½¢å®¹æ˜“å¤±çœŸï¼Œéšç€è·ç¦»çš„å»¶é•¿é”™è¯¯ç‡ä¹Ÿä¼šæé«˜ï¼›å¦ä¸€ä¸ªåŸå› æ˜¯æ–¹æ³¢ä¿¡å·è¦†ç›–äº†ä»ä½é¢‘åˆ°é«˜é¢‘çš„å®½å¹¿é¢‘æ®µï¼Œä¿¡å·é¢‘ç‡è¶Šé«˜ï¼Œè¾å°„å‡ºæ¥çš„ç”µ<br>\nç£å™ªå£°å°±è¶Šå¼ºï¼Œå› æ­¤ä¿¡å·é¢‘è°±å¤ªå®½å°±éš¾ä»¥æ§åˆ¶å™ªå£°ã€‚ADSL Modem é‡‡ç”¨äº†ä¸€ç§ç”¨åœ†æ»‘æ³¢å½¢ï¼ˆæ­£å¼¦æ³¢ï¼‰å¯¹ä¿¡å·è¿›è¡Œåˆæˆæ¥è¡¨ç¤º 0 å’Œ 1 çš„æŠ€æœ¯ï¼Œè¿™ç§æŠ€æœ¯ç§°ä¸ºè°ƒåˆ¶ã€‚è°ƒåˆ¶æœ‰å¾ˆå¤šæ–¹å¼ï¼ŒADSL é‡‡ç”¨çš„è°ƒåˆ¶æ–¹å¼æ˜¯æŒ¯å¹…è°ƒåˆ¶ï¼ˆASKï¼‰å’Œç›¸ä½è°ƒåˆ¶ï¼ˆPSKï¼‰ç›¸ç»“åˆçš„æ­£äº¤æŒ¯å¹…è°ƒåˆ¶ï¼ˆQAMï¼‰ æ–¹å¼ï¼ˆæŒ¯å¹…è°ƒåˆ¶æ˜¯ç”¨ä¿¡å·çš„å¼ºå¼±ï¼Œä¹Ÿå°±æ˜¯ä¿¡å·æŒ¯å¹…çš„å¤§å°æ¥å¯¹åº” 0 å’Œ 1 çš„æ–¹å¼ã€‚å¦‚å›¾ 4.4ï¼ˆbï¼‰ï¼ŒæŒ¯å¹…å°çš„ä¿¡å·ä¸º0ï¼ŒæŒ¯å¹…å¤§çš„ä¿¡å·ä¸º 1ï¼Œå¦‚æœå°†æŒ¯å¹…å¢åŠ åˆ° 4 ä¸ªçº§åˆ«ï¼Œåˆ™æŒ¯å¹…ä»å°åˆ°å¤§å¯åˆ†åˆ«å¯¹åº”<br>\n00ã€01ã€10 å’Œ 11ï¼Œè¿™æ ·å°±å¯ä»¥è¡¨ç¤ºä¸¤ä¸ªæ¯”ç‰¹äº†ã€‚ä¸è¿‡ï¼Œä¿¡å·ä¼šåœ¨ä¼ è¾“è¿‡ç¨‹ä¸­å‘ç”Ÿè¡°å‡ï¼Œä¹Ÿä¼šå—åˆ°å™ªå£°å½±å“è€Œå¤±çœŸï¼Œå¦‚æœæŒ¯å¹…çº§åˆ«å¤ªå¤šï¼Œæ¥æ”¶æ–¹å¯¹ä¿¡å·çš„è¯†åˆ«å°±å®¹æ˜“å‡ºé”™ï¼Œå› æ­¤æŒ¯å¹…çº§åˆ«ä¹Ÿä¸èƒ½å¤ªå¤šã€‚å¦ä¸€ä¸ªç»„æˆè¦ç´ æ˜¯ç›¸ä½è°ƒåˆ¶ï¼Œè¿™æ˜¯ä¸€ç§æ ¹æ®ä¿¡å·çš„ç›¸ä½æ¥å¯¹åº” 0 å’Œ 1 çš„æ–¹å¼ã€‚Modem äº§ç”Ÿçš„ä¿¡å·æ˜¯ä»¥ä¸€å®šå‘¨æœŸæŒ¯åŠ¨çš„æ³¢ï¼Œå¦‚å›¾ 4.5 æ‰€ç¤ºï¼ŒæŒ¯åŠ¨çš„èµ·å§‹ä½ç½®ä¸åŒï¼Œæ³¢çš„å½¢çŠ¶ä¹Ÿå°±ä¸åŒã€‚å¦‚æœå°†æ³¢çš„ä¸€ä¸ªæŒ¯åŠ¨å‘¨æœŸç†è§£ä¸ºä¸€ä¸ªåœ†ï¼Œåˆ™èµ·å§‹ä½ç½®å°±å¯ä»¥ç”¨ 0 åº¦åˆ° 360 åº¦çš„è§’åº¦æ¥è¡¨ç¤ºï¼Œè¿™ä¸ªè§’åº¦å°±æ˜¯ç›¸ä½ï¼Œç”¨è§’åº¦æ¥å¯¹åº” 0 å’Œ 1 çš„æ–¹å¼å°±å«ä½œç›¸ä½è°ƒåˆ¶ã€‚ä¾‹å¦‚ï¼Œä» 0 åº¦å¼€å§‹çš„æ³¢ä¸º 0ï¼Œä» 180 åº¦å¼€å§‹çš„æ³¢ä¸º 1ï¼Œè¿™æ˜¯ä¸€ç§æœ€ç®€å•çš„å¯¹åº”å…³ç³»ï¼ŒADSL ä½¿ç”¨çš„æ­£äº¤æŒ¯å¹…è°ƒåˆ¶å°±æ˜¯å°†å‰é¢è¿™ä¸¤ç§æ–¹å¼ç»„åˆèµ·æ¥å®ç°çš„ã€‚æ­£äº¤æŒ¯å¹…è°ƒåˆ¶å°±å¯ä»¥ç”¨ä¸€ä¸ªæ³¢è¡¨ç¤ºæ›´å¤šçš„æ¯”ç‰¹ï¼Œä»è€Œæé«˜ä¼ è¾“é€Ÿç‡ã€‚æ­£äº¤æŒ¯å¹…è°ƒåˆ¶ä¸­ï¼Œé€šè¿‡å¢åŠ æŒ¯å¹…å’Œç›¸ä½çš„çº§åˆ«ï¼Œå°±å¯ä»¥å¢åŠ èƒ½è¡¨ç¤ºçš„æ¯”ç‰¹æ•°ã€‚ä¾‹å¦‚ï¼Œå¦‚æœæŒ¯å¹…å’Œç›¸ä½å„è‡ªéƒ½æœ‰ 4 ä¸ªçº§åˆ«ï¼Œé‚£ä¹ˆç»„åˆèµ·æ¥å°±æœ‰ 16 ä¸ªçº§åˆ«ï¼Œä¹Ÿå°±å¯ä»¥è¡¨ç¤º 4 ä¸ªæ¯”ç‰¹çš„å€¼ã€‚å½“ç„¶ï¼Œå’Œå•ç‹¬ä½¿ç”¨æŒ¯å¹…è°ƒåˆ¶æˆ–ç›¸ä½è°ƒåˆ¶çš„æƒ…å†µä¸€æ ·ï¼Œçº§åˆ«è¿‡å¤šå°±å®¹æ˜“å‘ç”Ÿè¯¯åˆ¤ï¼Œå› æ­¤è¿™ç§æ–¹æ³•æå‡çš„é€Ÿç‡æ˜¯æœ‰é™åº¦çš„ã€‚ï¼‰</li>\n<li>ä¿¡å·æ˜¯ä¸€ä¸ªé¢‘ç‡çš„æ³¢ï¼Œä¸åŒé¢‘ç‡çš„æ³¢å¯ä»¥åˆæˆï¼Œä¹Ÿå¯ä»¥ç”¨æ»¤æ³¢å™¨ä»åˆæˆçš„æ³¢ä¸­åˆ†ç¦»å‡ºæŸä¸ªç‰¹å®šé¢‘ç‡çš„æ³¢ã€‚å› æ­¤ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨å¤šä¸ªé¢‘ç‡åˆæˆçš„æ³¢æ¥ä¼ è¾“ä¿¡å·ï¼Œè¿™æ ·ä¸€æ¥ï¼Œèƒ½å¤Ÿè¡¨ç¤ºçš„æ¯”ç‰¹æ•°å°±å¯ä»¥æˆå€æé«˜äº†ã€‚ADSL ä½¿ç”¨é—´éš”ä¸º 4.3125 kHz çš„ä¸Šç™¾ä¸ªä¸åŒé¢‘ç‡çš„æ³¢è¿›è¡Œåˆæˆï¼Œæ¯ä¸ªæ³¢éƒ½é‡‡ç”¨æ­£äº¤æŒ¯å¹…è°ƒåˆ¶ï¼Œè€Œä¸”ï¼Œæ ¹æ®å™ªå£°ç­‰æ¡ä»¶çš„ä¸åŒï¼Œæ¯ä¸ªæ³¢è¡¨ç¤ºçš„æ¯”ç‰¹æ•°æ˜¯å¯å˜çš„ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå™ªå£°å°çš„é¢‘æ®µå¯ä»¥ç»™æ³¢åˆ†é…æ›´å¤šçš„æ¯”ç‰¹ï¼Œå™ªå£°å¤§çš„é¢‘æ®µåˆ™ç»™æ³¢åˆ†é…è¾ƒå°‘çš„æ¯”ç‰¹ ï¼Œæ¯ä¸ªé¢‘æ®µè¡¨ç¤ºçš„æ¯”ç‰¹æ•°åŠ èµ·æ¥ï¼Œå°±å†³å®šäº†æ•´ä½“çš„ä¼ è¾“é€Ÿç‡ã€‚ADSL æŠ€æœ¯ä¸­ï¼Œä¸Šè¡Œæ–¹å‘ï¼ˆç”¨æˆ·åˆ°äº’è”ç½‘ï¼‰å’Œä¸‹è¡Œæ–¹å‘ï¼ˆäº’è”ç½‘åˆ°ç”¨æˆ·ï¼‰çš„ä¼ è¾“é€Ÿç‡æ˜¯ä¸åŒçš„ï¼ŒåŸå› ä¹Ÿåœ¨è¿™é‡Œã€‚å¦‚æœä¸Šè¡Œä½¿ç”¨ 26 ä¸ªé¢‘æ®µï¼Œä¸‹è¡Œåˆ™å¯ä»¥ä½¿ç”¨ 95 ä¸ªæˆ–è€… 223 ä¸ªé¢‘æ®µï¼Œæ³¢çš„æ•°é‡ä¸åŒï¼Œå¯¼è‡´äº†ä¸Šä¸‹è¡Œé€Ÿç‡ä¸åŒã€‚å½“ç„¶ï¼Œä¸‹è¡Œä½¿ç”¨çš„é¢‘æ®µè¾ƒé«˜ï¼Œè¿™äº›ä¿¡å·å®¹æ˜“è¡°å‡è€Œä¸”æ›´å®¹æ˜“å—åˆ°å™ªå£°çš„å½±å“ï¼Œå› æ­¤è¿™äº›é¢‘æ®µå¯èƒ½åªèƒ½è¡¨ç¤ºè¾ƒå°‘çš„æ¯”ç‰¹æ•°ï¼Œæˆ–è€…å¹²è„†æ— æ³•ä¼ è¾“ä¿¡å·ã€‚è·ç¦»è¶Šè¿œï¼Œé¢‘ç‡è¶Šé«˜ï¼Œè¿™ç§æƒ…å†µä¹Ÿå°±è¶Šæ˜¾è‘—ï¼Œå› æ­¤å¦‚æœä½ å®¶è·ç¦»ç”µè¯<br>\nå±€å¤ªè¿œï¼Œé€Ÿç‡å°±ä¼šä¸‹é™ã€‚å™ªå£°å’Œè¡°å‡ç­‰å½±å“çº¿è·¯è´¨é‡çš„å› ç´ åœ¨æ¯æ¡çº¿è·¯ä¸Šéƒ½ä¸åŒï¼Œè€Œä¸”ä¼šéšç€æ—¶é—´å‘ç”Ÿå˜åŒ–ã€‚å› æ­¤ï¼ŒADSL ä¼šæŒç»­æ£€æŸ¥çº¿è·¯è´¨é‡ï¼ŒåŠ¨æ€åˆ¤æ–­ä½¿ç”¨çš„é¢‘æ®µæ•°é‡ï¼Œä»¥åŠæ¯ä¸ªé¢‘æ®µåˆ†é…åˆ°çš„æ¯”ç‰¹æ•°ã€‚å…·ä½“æ¥è¯´ï¼Œå½“ Modem é€šç”µåï¼Œä¼šå‘é€æµ‹è¯•ä¿¡å·ï¼Œå¹¶æ ¹æ®ä¿¡å·çš„æ¥æ”¶æƒ…å†µåˆ¤æ–­ä½¿ç”¨çš„é¢‘æ®µæ•°é‡å’Œæ¯ä¸ªé¢‘æ®µçš„æ¯”ç‰¹æ•°ï¼Œè¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºè®­ç»ƒï¼ˆæ¡<br>\næ‰‹ï¼‰ï¼Œéœ€è¦å‡ ç§’åˆ°å‡ åç§’çš„æ—¶é—´ã€‚</li>\n<li>è¦é€šè¿‡åˆ†ç¦»å™¨å°†ä¼ å…¥çš„ä¿¡å·åˆ†ç¦»ï¼Œä»¥ç¡®ä¿ ADSL ä¿¡å·ä¸ä¼šä¼ å…¥ç”µè¯æœºã€‚å…·ä½“æ¥è¯´ï¼Œåˆ†ç¦»å™¨çš„åŠŸèƒ½æ˜¯å°†ä¸€å®šé¢‘ç‡ä»¥ä¸Šçš„ä¿¡å·è¿‡æ»¤æ‰ï¼Œä¹Ÿå°±æ˜¯è¿‡æ»¤æ‰äº† ADSL ä½¿ç”¨çš„é«˜é¢‘ä¿¡å·ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåªæœ‰ç”µè¯ä¿¡å·æ‰ä¼šä¼ å…¥ç”µè¯æœºï¼Œä½†å¯¹äºå¦ä¸€å¤´çš„ ADSL Modemï¼Œåˆ™æ˜¯ä¼ è¾“åŸæœ¬çš„æ··åˆä¿¡å·ç»™å®ƒã€‚ADSL Modem å†…éƒ¨å·²ç»å…·å¤‡å°† ADSL é¢‘ç‡å¤–çš„ä¿¡å·è¿‡æ»¤æ‰çš„åŠŸèƒ½ï¼Œå› æ­¤ä¸éœ€è¦åœ¨åˆ†ç¦»å™¨è¿›è¡Œè¿‡æ»¤ï¼Œå¦‚æœADSL é€šä¿¡è¿‡ç¨‹ä¸­æ‹¿èµ·è¯ç­’å¯¼è‡´çº¿è·¯çŠ¶æ€æ”¹å˜ï¼Œå°±éœ€è¦é‡æ–°è®­ç»ƒï¼ˆæ¡æ‰‹ï¼‰ï¼Œè¿™å°±ä¼šå¯¼è‡´å‡ åç§’çš„é€šä¿¡ä¸­æ–­ï¼Œåˆ†ç¦»å™¨å¯ä»¥é˜²æ­¢å‘ç”Ÿè¿™æ ·çš„é—®é¢˜ã€‚</li>\n<li>ä¿¡å·é€šè¿‡ç”µè¯çº¿åˆ°è¾¾ç”µè¯å±€ä¹‹åï¼Œä¼šç»è¿‡é…çº¿ç›˜ã€åˆ†ç¦»å™¨åˆ°è¾¾ DSLAM ï¼ˆå›¾ 4.3 â‘¨ï¼‰ã€‚åœ¨è¿™é‡Œï¼Œç”µä¿¡å·ä¼šè¢«è¿˜åŸæˆæ•°å­—ä¿¡æ¯â€”â€”ä¿¡å…ƒï¼ˆå›¾ 4.3 â‘©ï¼‰ã€‚ DSLAM é€šè¿‡è¯»å–ä¿¡å·æ³¢å½¢ï¼Œæ ¹æ®æŒ¯å¹…å’Œç›¸ä½åˆ¤æ–­å¯¹åº”çš„æ¯”ç‰¹å€¼ï¼Œå°†ä¿¡å·è¿˜åŸæˆæ•°å­—ä¿¡æ¯ï¼Œè¿™ä¸€è¿‡ç¨‹å’Œç”¨æˆ·ç«¯çš„ ADSL Modem åœ¨æ¥æ”¶æ•°æ®æ—¶çš„è¿‡ç¨‹æ˜¯ä¸€æ ·çš„ã€‚å› æ­¤ï¼Œå¦‚æœåœ¨ç”µè¯å±€é‡Œå®‰è£…ä¸€å¤§å †å’Œç”¨æˆ·ç«¯ä¸€æ ·çš„ ADSL Modemï¼Œä¹Ÿå¯ä»¥å®Œæˆè¿™äº›å·¥ä½œï¼Œåªä¸è¿‡å®‰è£…è¿™ä¹ˆå¤š Modeméœ€è¦å ç”¨å¤§é‡çš„ç©ºé—´ï¼Œè€Œä¸”ç›‘æ§èµ·æ¥ä¹Ÿéå¸¸å›°éš¾ã€‚å› æ­¤ï¼Œç”µè¯å±€ä½¿ç”¨äº† DSLAM è®¾å¤‡ï¼Œå®ƒæ˜¯ä¸€ç§å°†ç›¸å½“äºå¾ˆå¤šä¸ª ADSL Modem çš„åŠŸèƒ½é›†ä¸­åœ¨ä¸€ä¸ªå¤–å£³é‡Œçš„è®¾å¤‡ã€‚</li>\n<li>DSLAMï¼šDSL Access Multiplexerï¼Œæ•°å­—ç”¨æˆ·çº¿æ¥å…¥å¤ç”¨è®¾å¤‡ã€‚å®ƒæ˜¯ä¸€ç§ç”µè¯å±€ç”¨çš„å¤šè·¯ ADSL Modemï¼Œå¯ä»¥ç†è§£ä¸ºå°†å¤šä¸ª ADSL Modem æ•´åˆåœ¨ä¸€ä¸ªå¤–å£³é‡Œçš„è®¾å¤‡ã€‚DSLAM å…·æœ‰ ATM æ¥å£ï¼Œå’Œåæ–¹è·¯ç”±å™¨æ”¶å‘æ•°æ®æ—¶ä½¿ç”¨çš„æ˜¯åŸå§‹ç½‘ç»œåŒ…æ‹†åˆ†åçš„ ATM ä¿¡å…ƒå½¢å¼</li>\n<li>BAS è´Ÿè´£å°† ATM ä¿¡å…ƒè¿˜åŸæˆç½‘ç»œåŒ…å¹¶è½¬å‘åˆ°äº’è”ç½‘å†…éƒ¨ã€‚</li>\n</ul>\n</li>\n<li>å…‰çº¤æ¥å…¥ç½‘ï¼ˆFTTHï¼‰\n<ul>\n<li>å…‰ä¿¡å·äº®è¡¨ç¤º 1ï¼Œæš—è¡¨ç¤º 0.å…ˆå°†æ•°å­—ä¿¡æ¯è½¬æ¢æˆç”µä¿¡å·ï¼Œç„¶åå†å°†ç”µä¿¡å·è½¬æ¢æˆå…‰ä¿¡å·ã€‚è¿™é‡Œçš„ç”µä¿¡å·éå¸¸ç®€å•ï¼Œ1 ç”¨é«˜ç”µå‹è¡¨ç¤ºï¼Œ0 ç”¨ä½ç”µå‹è¡¨ç¤ºã€‚å°†è¿™æ ·çš„ç”µä¿¡å·è¾“å…¥ LEDã€æ¿€å…‰äºŒæç®¡ç­‰å…‰æºåï¼Œè¿™äº›å…‰æºå°±ä¼šæ ¹æ®ä¿¡å·ç”µå‹çš„å˜åŒ–å‘å…‰ï¼Œé«˜ç”µå‹å‘å…‰äº®ï¼Œä½ç”µå‹å‘å…‰æš—ã€‚è¿™æ ·çš„å…‰ä¿¡å·åœ¨å…‰çº¤ä¸­ä¼ å¯¼ä¹‹åï¼Œå°±å¯ä»¥é€šè¿‡å…‰çº¤åˆ°è¾¾æ¥æ”¶ç«¯ã€‚æ¥æ”¶ç«¯æœ‰å¯ä»¥æ„Ÿåº”å…‰çº¿çš„å…‰æ•å…ƒä»¶ï¼Œå…‰æ•å…ƒä»¶å¯ä»¥æ ¹æ®å…‰çš„äº®åº¦äº§ç”Ÿä¸åŒçš„ç”µå‹ã€‚å½“å…‰ä¿¡å·ç…§å°„åˆ°ä¸Šé¢æ—¶ï¼Œå…‰äº®çš„æ—¶å€™å°±äº§ç”Ÿé«˜ç”µå‹ï¼Œå…‰æš—çš„æ—¶å€™å°±äº§ç”Ÿä½ç”µå‹ï¼Œè¿™æ ·å°±å°†å…‰ä¿¡å·è½¬æ¢æˆäº†ç”µä¿¡å·ã€‚æœ€åå†å°†ç”µä¿¡å·è½¬æ¢æˆæ•°å­—ä¿¡æ¯ï¼Œæˆ‘ä»¬å°±æ¥æ”¶åˆ°æ•°æ®äº†ã€‚</li>\n<li>å…‰æºåœ¨æ‰€æœ‰æ–¹å‘ä¸Šéƒ½ä¼šå‘å…‰ï¼Œå› æ­¤ä¼šæœ‰å„ç§è§’åº¦çš„å…‰çº¿è¿›å…¥çº¤èŠ¯ï¼Œä½†å…¥å°„è§’åº¦å¤ªå¤§çš„å…‰çº¿ä¼šåœ¨çº¤èŠ¯å’ŒåŒ…å±‚ï¼ˆçº¤èŠ¯å¤–æ²¿éƒ¨åˆ†ï¼‰çš„è¾¹ç•Œä¸ŠæŠ˜å°„å‡ºå»ï¼Œåªæœ‰å…¥å°„è§’è¾ƒå°çš„å…‰çº¿ä¼šè¢«åŒ…å±‚å…¨åå°„ï¼Œä»è€Œåœ¨çº¤èŠ¯ä¸­å‰è¿›.å…‰ä¹Ÿæ˜¯ä¸€ç§æ³¢ï¼Œå› æ­¤å…‰ä¹Ÿæœ‰å¦‚å›¾ 4.5 ä¸­é‚£æ ·çš„ç›¸ä½ï¼Œå½“å…‰çº¿åœ¨çº¤èŠ¯å’ŒåŒ…å±‚çš„è¾¹ç•Œä¸Šåå°„æ—¶ï¼Œä¼šç”±äºåå°„è§’äº§ç”Ÿç›¸ä½å˜åŒ–ã€‚å½“æœåå°„é¢å‰è¿›çš„å…‰çº¿å’Œè¢«åå°„å›æ¥çš„å…‰çº¿äº¤ä¼šæ—¶ï¼Œå¦‚æœä¸¤æ¡å…‰çº¿çš„ç›¸ä½ä¸ä¸€è‡´ï¼Œå°±ä¼šå½¼æ­¤å‘ç”Ÿå¹²æ¶‰æŠµæ¶ˆï¼Œåªæœ‰é‚£äº›ç›¸ä½ä¸€è‡´çš„å…‰çº¿æ‰ä¼šç»§ç»­åœ¨å…‰çº¤ä¸­ä¼ å¯¼ã€‚å…‰åœ¨è¢«çº¤èŠ¯å’ŒåŒ…å±‚çš„è¾¹ç•Œåå°„æ—¶ï¼Œç›¸ä½ä¼šå‘ç”Ÿå˜åŒ–ã€‚è¿™ä¸ªå˜åŒ–çš„é‡éšå…‰åœ¨åå°„é¢çš„åå°„è§’åº¦ä¸åŒè€Œä¸åŒï¼Œå¤§å¤šæ•°è§’åº¦ä¸‹ï¼Œéƒ½ä¼šå› ä¸ºç›¸ä½ä¸åŒè€Œè¢«å¹²æ¶‰æŠµæ¶ˆã€‚ä¸è¿‡ï¼Œæœ‰å‡ ä¸ªç‰¹å®šçš„è§’åº¦ä¸‹ï¼Œå‘åå°„é¢å‰è¿›çš„å…‰å’Œåå°„å›æ¥çš„å…‰çš„ç›¸ä½æ˜¯ä¸€è‡´çš„ï¼Œåªæœ‰ä»¥è¿™äº›è§’åº¦åå°„çš„å…‰æ‰èƒ½ç»§ç»­å‘å‰ä¼ å¯¼ï¼ˆå›¾ 4.13ï¼‰ã€‚è¿›å…¥å…‰çº¤çš„å…‰çº¿æœ‰å„ç§è§’åº¦ï¼Œä½†å…¶ä¸­ï¼Œåªæœ‰å°‘æ•°æŒ‰ç…§ç‰¹å®šè§’åº¦å…¥å°„ä»¥ä¿æŒç›¸ä½ä¸€è‡´çš„å…‰çº¿æ‰ä¼šç»§ç»­ä¼ å¯¼ã€‚</li>\n<li>å…‰çº¤å¯ä»¥åˆ’åˆ†æˆå‡ ç§ç±»å‹ï¼Œå¤§ä½“ä¸ŠåŒ…æ‹¬è¾ƒç»†çš„å•æ¨¡å…‰çº¤ï¼ˆ8ï½10 Î¼mï¼‰å’Œè¾ƒç²—çš„å¤šæ¨¡å…‰çº¤ï¼ˆ50 Î¼m æˆ– 62.5 Î¼mï¼‰ã€‚å•æ¨¡å…‰çº¤çš„çº¤èŠ¯å¾ˆç»†ï¼Œåªæœ‰å…¥å°„è§’å¾ˆå°çš„å…‰çº¿æ‰èƒ½è¿›å…¥ï¼Œå› æ­¤åœ¨èƒ½å¤Ÿä¿æŒç›¸ä½ä¸€è‡´çš„è§’åº¦ä¸­ï¼Œåªæœ‰è§’åº¦æœ€å°çš„å…‰çº¿èƒ½è¿›å…¥å…‰çº¤ã€‚åè¿‡æ¥å¯ä»¥è¯´ï¼Œå•æ¨¡å…‰çº¤çš„çº¤èŠ¯ç›´å¾„å°±æ˜¯æŒ‰ç…§åªå…è®¸ç›¸ä½ä¸€è‡´çš„æœ€å°è§’åº¦çš„å…‰è¿›å…¥è€Œè®¾è®¡çš„ã€‚å¤šæ¨¡å…‰çº¤çš„çº¤èŠ¯æ¯”è¾ƒç²—ï¼Œå…¥å°„è§’æ¯”è¾ƒå¤§çš„å…‰ä¹Ÿå¯ä»¥è¿›å…¥ï¼Œè¿™æ ·ä¸€æ¥ï¼Œåœ¨ç›¸ä½ä¸€è‡´çš„è§’åº¦ä¸­ï¼Œä¸ä»…è§’åº¦æœ€å°çš„å¯ä»¥åœ¨å…‰çº¤ä¸­ä¼ å¯¼ï¼Œå…¶ä»–è§’åº¦æ›´å¤§ä¸€äº›çš„ä¹Ÿå¯ä»¥ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¯ä»¥æœ‰å¤šæ¡å…‰çº¿åœ¨çº¤èŠ¯ä¸­åŒæ—¶ä¼ å¯¼ã€‚æ¢å¥è¯è¯´ï¼Œå•æ¨¡å’Œå¤šæ¨¡å®é™…ä¸Šè¡¨ç¤ºç›¸ä½ä¸€è‡´çš„è§’åº¦æœ‰ä¸€ä¸ªè¿˜æ˜¯å¤šä¸ª</li>\n<li>å¤šæ¨¡å…‰çº¤ä¸­å¯ä»¥ä¼ å¯¼å¤šæ¡å…‰çº¿ï¼Œè¿™æ„å‘³ç€èƒ½é€šè¿‡çš„å…‰çº¿è¾ƒå¤šï¼Œå¯¹å…‰æºå’Œå…‰æ•å…ƒä»¶çš„æ€§èƒ½è¦æ±‚ä¹Ÿå°±è¾ƒä½ï¼Œä»è€Œå¯ä»¥é™ä½å…‰æºå’Œå…‰æ•å…ƒä»¶çš„ä»·æ ¼ã€‚ç›¸å¯¹åœ°ï¼Œå•æ¨¡å…‰çº¤çš„çº¤èŠ¯ä¸­åªèƒ½ä¼ å¯¼ä¸€æ¡å…‰çº¿ï¼Œèƒ½é€šè¿‡çš„å…‰çº¿è¾ƒå°‘ï¼Œç›¸åº”åœ°å¯¹äºå…‰æºå’Œå…‰æ•å…ƒä»¶çš„æ€§èƒ½è¦æ±‚å°±è¾ƒé«˜ï¼Œä½†ä¿¡å·çš„å¤±çœŸä¼šæ¯”è¾ƒå°ã€‚</li>\n<li>ä¿¡å·å¤±çœŸä¸å…‰åœ¨çº¤èŠ¯ä¼ å¯¼æ—¶åå°„çš„æ¬¡æ•°ç›¸å…³ã€‚å¤šæ¨¡å…‰çº¤ä¸­ï¼Œå¤šæ¡åå°„è§’ä¸åŒçš„å…‰çº¿åŒæ—¶ä¼ å¯¼ï¼Œå…¶ä¸­åå°„è§’è¶Šå¤§çš„å…‰çº¿åå°„æ¬¡æ•°è¶Šå¤šï¼Œèµ°è¿‡çš„è·ç¦»ä¹Ÿå°±è¶Šé•¿ï¼›ç›¸å¯¹åœ°ï¼Œåå°„è§’è¶Šå°çš„å…‰çº¿èµ°è¿‡çš„è·ç¦»è¶ŠçŸ­ã€‚å…‰é€šè¿‡çš„è·ç¦»ä¼šå½±å“å…¶åˆ°è¾¾æ¥æ”¶ç«¯çš„æ—¶é—´ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œé€šè¿‡çš„è·ç¦»è¶Šé•¿ï¼Œåˆ°è¾¾æ¥æ”¶ç«¯çš„æ—¶é—´è¶Šé•¿ã€‚ç»“æœï¼Œå¤šæ¡å…‰çº¿åˆ°è¾¾çš„æ—¶é—´ä¸åŒï¼Œä¿¡å·çš„å®½åº¦å°±ä¼šè¢«æ‹‰ä¼¸ï¼Œè¿™å°±é€ æˆäº†å¤±çœŸã€‚å› æ­¤ï¼Œå…‰çº¤è¶Šé•¿ï¼Œå¤±çœŸè¶Šå¤§ï¼Œå½“è¶…è¿‡å…è®¸èŒƒå›´æ—¶ï¼Œé€šä¿¡å°±ä¼šå‡ºé”™ï¼ˆå›¾ 4.15ï¼‰ã€‚ç›¸å¯¹åœ°ï¼Œå•æ¨¡å…‰çº¤åˆ™ä¸ä¼šå‡ºç°è¿™æ ·çš„é—®é¢˜ã€‚å› ä¸ºåœ¨çº¤èŠ¯ä¼ å¯¼çš„å…‰çº¿åªæœ‰ä¸€æ¡ï¼Œä¸ä¼šå› ä¸ºè¡Œè¿›è·ç¦»çš„å·®å¼‚äº§ç”Ÿ.æ—¶é—´å·®ï¼Œæ‰€ä»¥å³ä¾¿å…‰çº¤å¾ˆé•¿ï¼Œä¹Ÿä¸ä¼šäº§ç”Ÿä¸¥é‡çš„å¤±çœŸã€‚å…‰çº¤çš„æœ€å¤§é•¿åº¦ä¹Ÿæ˜¯ç”±ä¸Šè¿°æ€§è´¨å†³å®šçš„ã€‚å•æ¨¡å…‰çº¤çš„å¤±çœŸå°ï¼Œå¯ä»¥æ¯”å¤šæ¨¡å…‰çº¤æ›´é•¿ï¼Œå› æ­¤å¤šæ¨¡å…‰çº¤ä¸»è¦ç”¨äºä¸€åº§å»ºç­‘ç‰©é‡Œé¢çš„è¿æ¥ï¼Œå•æ¨¡å…‰çº¤åˆ™ç”¨äºè·ç¦»è¾ƒè¿œçš„å»ºç­‘ç‰©ä¹‹é—´çš„è¿æ¥ã€‚FTTH å±äºåè€…ï¼Œå› æ­¤ä¸»è¦ä½¿ç”¨å•æ¨¡å…‰çº¤ã€‚</li>\n<li>FTTH ï¼Œä»å½¢æ€ä¸Šå¯å¤§è‡´åˆ†ä¸ºä¸¤ç§.ä¸€ç§æ˜¯ç”¨ä¸€æ ¹å…‰çº¤ç›´æ¥ä»ç”¨æˆ·ç«¯è¿æ¥åˆ°æœ€è¿‘çš„ç”µè¯å±€ï¼ˆå›¾ 4.16ï¼ˆaï¼‰ï¼‰ã€‚è¿™ç§ç±»å‹çš„ FTTH ä¸­ï¼Œç”¨æˆ·å’Œç”µè¯å±€ä¹‹é—´é€šè¿‡å…‰çº¤ç›´æ¥è¿æ¥ï¼Œç½‘ç»œåŒ…çš„ä¼ è¾“æ–¹å¼å¦‚ä¸‹ã€‚é¦–å…ˆï¼Œç”¨æˆ·ç«¯çš„å…‰çº¤æ”¶å‘å™¨(å°†ä»¥å¤ªç½‘çš„ç”µä¿¡å·è½¬æ¢æˆå…‰ä¿¡å·çš„è®¾å¤‡ï¼Œä¹Ÿå«â€œç»ˆç«¯ç›’â€) å°†ä»¥å¤ªç½‘çš„ç”µä¿¡å·è½¬æ¢æˆå…‰ä¿¡å·ã€‚è¿™ä¸€æ­¥åªè¿›è¡Œç”µä¿¡å·åˆ°å…‰ä¿¡å·çš„è½¬æ¢ï¼Œè€Œä¸ä¼šåƒ ADSL ä¸€æ ·è¿˜éœ€è¦å°†åŒ…æ‹†åˆ†æˆä¿¡å…ƒï¼Œå¤§å®¶å¯ä»¥è®¤ä¸ºæ˜¯å°†ä»¥å¤ªç½‘åŒ…åŸåŸæœ¬æœ¬åœ°è½¬æ¢æˆäº†å…‰ä¿¡å·ã€‚æ¥ä¸‹æ¥ï¼Œå…‰ä¿¡å·é€šè¿‡è¿æ¥åˆ°å…‰çº¤æ”¶å‘å™¨çš„å…‰çº¤ç›´æ¥åˆ°è¾¾BAS å‰é¢çš„å¤šè·¯å…‰çº¤æ”¶å‘å™¨ã€‚FTTH ä¸€èˆ¬ä½¿ç”¨å•æ¨¡å…‰çº¤ï¼Œå› æ­¤å…¶çº¤èŠ¯ä¸­åªæœ‰ç‰¹å®šè§’åº¦çš„å…‰ä¿¡å·èƒ½å¤Ÿåå°„å¹¶å‰è¿›ã€‚ç„¶åï¼Œå¤šè·¯å…‰çº¤æ”¶å‘å™¨å°†å…‰ä¿¡å·è½¬æ¢æˆç”µä¿¡å·ï¼ŒBAS çš„ç«¯å£æ¥æ”¶ä¹‹åï¼Œå°†åŒ…è½¬å‘åˆ°äº’è”ç½‘å†…éƒ¨ã€‚æŠŠç½‘ç»œåŒ…å‘é€åˆ°äº’è”ç½‘ä¹‹åï¼ŒæœåŠ¡å™¨ä¼šæ”¶åˆ°å“åº”ï¼Œå“åº”åŒ…çš„å…‰ä¿¡å·ä¹Ÿæ˜¯æ²¿ç€åŒä¸€æ¡å…‰çº¤ä¼ è¾“åˆ°ç”¨æˆ·ç«¯çš„ã€‚è¿™é‡Œï¼Œå‰å¾€äº’è”ç½‘çš„ä¸Šè¡Œå…‰ä¿¡å·å’Œå‰å¾€ç”¨æˆ·çš„ä¸‹è¡Œå…‰ä¿¡å·åœ¨å…‰çº¤ä¸­æ··åˆåœ¨ä¸€èµ·ï¼Œä¿¡å·ä¼šå˜å¾—æ— æ³•è¯†åˆ«ï¼Œå› æ­¤æˆ‘ä»¬éœ€è¦å¯¹å®ƒä»¬è¿›è¡ŒåŒºåˆ†ï¼ŒåŠæ³•æ˜¯ä¸Šè¡Œå’Œä¸‹è¡Œä¿¡å·é‡‡ç”¨ä¸åŒæ³¢é•¿çš„å…‰ã€‚æ³¢é•¿ä¸åŒçš„å…‰æ··åˆåå¯é€šè¿‡æ£±é•œåŸç†è¿›è¡Œåˆ†ç¦»ï¼Œå› æ­¤å…‰çº¤ä¸­çš„ä¸Šè¡Œå’Œä¸‹è¡Œä¿¡å·å³ä¾¿æ··åˆèµ·æ¥ä¹Ÿå¯ä»¥è¯†åˆ«ã€‚åƒè¿™æ ·åœ¨ä¸€æ¡å…‰çº¤ä¸­ä½¿ç”¨ä¸åŒçš„æ³¢é•¿ä¼ è¾“å¤šä¸ªå…‰ä¿¡å·çš„æ–¹å¼å«ä½œæ³¢åˆ†å¤ç”¨.å¦ä¸€ç§å…‰çº¤çš„æ¥å…¥æ–¹å¼æ˜¯åœ¨ç”¨æˆ·é™„è¿‘çš„ç”µçº¿æ†ä¸Šå®‰è£…ä¸€ä¸ªåä¸ºåˆ†å…‰å™¨çš„è®¾å¤‡ï¼Œé€šè¿‡è¿™ä¸ªè®¾å¤‡è®©å…‰çº¤åˆ†è·¯ï¼ŒåŒæ—¶è¿æ¥å¤šä¸ªç”¨æˆ· ï¼ˆå›¾ 4.16ï¼ˆbï¼‰ï¼‰ã€‚åœ¨è¿™ç§æ–¹å¼ä¸‹ï¼Œç”¨æˆ·ç«¯ä¸ä½¿ç”¨å…‰çº¤æ”¶å‘å™¨ï¼Œè€Œæ˜¯ä½¿ç”¨ä¸€ä¸ªå«ä½œONU çš„è®¾å¤‡ï¼Œå®ƒå°†ä»¥å¤ªç½‘çš„ç”µä¿¡å·è½¬æ¢æˆå…‰ä¿¡å·ä¹‹åï¼Œä¼šåˆ°è¾¾ BAS å‰é¢çš„ä¸€ä¸ªå«ä½œ OLT çš„è®¾å¤‡ã€‚å…‰ä¿¡å·çš„ä¼ å¯¼æ–¹å¼å’Œåˆšæ‰ä»‹ç»çš„ç›´è¿æ–¹å¼æ˜¯ä¸€æ ·çš„ï¼Œä½†æœ‰ä¸€ç‚¹ä¸åŒï¼Œå› ä¸ºå¤šä¸ªç”¨æˆ·åŒæ—¶æ”¶å‘ç½‘ç»œåŒ…æ—¶ä¿¡å·ä¼šåœ¨åˆ†å…‰å™¨äº§ç”Ÿç¢°æ’ã€‚å› æ­¤ï¼Œ OLT å’Œ ONU ä¸­å…·å¤‡é€šè¿‡è°ƒæ•´ä¿¡å·æ”¶å‘æ—¶æœºæ¥é¿å…ç¢°æ’çš„åŠŸèƒ½ã€‚å…·ä½“æ¥è¯´ï¼Œ OLT ä¼šè°ƒæ•´ä¿¡å·å‘é€æ—¶æœºå¹¶å‘ ONU ä¸‹å‘æŒ‡ä»¤ï¼ŒONU åˆ™æ ¹æ® OLT çš„æŒ‡ä»¤æ¥å‘é€æ•°æ®ã€‚åè¿‡æ¥ï¼Œå½“ BAS ç«¯å‘ç”¨æˆ·å‘é€æ•°æ®æ—¶ï¼Œåˆ†å…‰å™¨åªéœ€è¦å°†ä¿¡å·å‘ç»™æ‰€æœ‰ç”¨æˆ·å°±å¯ä»¥äº†ï¼Œè¿™é‡Œå¹¶ä¸ä¼šå‘ç”Ÿç¢°æ’ï¼Œä½†è¿™æ ·åšä¼šå¯¼è‡´ä¸€ä¸ªç”¨æˆ·æ”¶åˆ°å…¶ä»–æ‰€æœ‰ç”¨æˆ·çš„ä¿¡å·ï¼Œé€ æˆä¿¡æ¯æ³„éœ²çš„é—®é¢˜ï¼Œå› æ­¤éœ€è¦åœ¨æ¯ä¸ªåŒ…å‰é¢åŠ ä¸Šç”¨äºè¯†åˆ« ONU çš„ä¿¡æ¯ï¼Œå½“ONU æ”¶åˆ°ä¿¡å·åï¼Œä¼šæ¥æ”¶å‘ç»™è‡ªå·±çš„ä¿¡å·å¹¶å°†å…¶è½¬æ¢æˆä»¥å¤ªç½‘ä¿¡å·(é€šè¿‡å…‰çº¤åˆ†è·¯è¿æ¥å¤šä¸ªç”¨æˆ·çš„å…‰çº¤æ¥å…¥æ¨¡å¼ç»Ÿç§°ä¸º PONï¼ˆPassive Optical Networkï¼Œæ— æºå…‰ç½‘ç»œï¼‰ï¼Œå¯åˆ†ä¸º GE-PONã€WDM-PONã€B-PONã€G-PON ç­‰å¤šç§æ–¹å¼ï¼Œç°åœ¨å¤§å¤šä½¿ç”¨æœ€é«˜é€Ÿç‡ä¸º 1 Gbit/s çš„ GE-PON æ–¹å¼ã€‚ONUï¼šOptical Network Unitï¼Œå…‰ç½‘ç»œå•å…ƒã€‚å®ƒå’Œå…‰çº¤æ”¶å‘å™¨ä¸€æ ·ï¼Œå¯ä»¥å°†ç”µä¿¡å·è½¬æ¢æˆå…‰ä¿¡å·ï¼Œé™¤æ­¤ä¹‹å¤–è¿˜å…·æœ‰å’Œç”µè¯å±€çš„ OLT ç›¸äº’é…åˆé¿å…ä¿¡å·ç¢°æ’çš„åŠŸèƒ½ã€‚è¿™ä¸ªè®¾å¤‡æœ‰æ—¶ä¹Ÿè¢«å«ä½œç»ˆç«¯ç›’ï¼Œå› æ­¤ç»ˆç«¯ç›’è¿™ä¸ªè¯æœ¬èº«æ˜¯å¯¹å…‰çº¤æ”¶å‘å™¨å’Œ ONU ç­‰å…‰çº¤ç»ˆç«¯è®¾å¤‡çš„ç»Ÿç§°ã€‚)</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4b09022d9497be0d42775.png\" alt=\"48.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b67214c5ba95462379b7a.png\" alt=\"49.PNG\"></p>\n<h1>3. æ•°æ®é“¾è·¯å±‚</h1>\n<h2>3.1. æ•°æ®é“¾è·¯å±‚æ¦‚å¿µ</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c97b0b9b567e71323152a.png\" alt=\"44.PNG\" tabindex=\"0\"><figcaption>44.PNG</figcaption></figure>\n<ul>\n<li>ç ”ç©¶åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸­ï¼Œåˆ†ç»„æ€æ ·ä»ä¸€ä¸ªä¸»æœºä¼ é€åˆ°å¦ä¸€ä¸ªä¸»æœºï¼ˆä¸ç»è¿‡è·¯ç”±å™¨ï¼‰</li>\n<li><strong>é“¾è·¯(link)</strong>ï¼šä»ä¸€ä¸ªç«™ç‚¹åˆ°ç›¸é‚»èŠ‚ç‚¹çš„ä¸€æ®µç‰©ç†çº¿è·¯ï¼ˆæœ‰çº¿æˆ–è€…æ— çº¿ï¼‰ï¼Œè€Œä¸­é—´æ²¡æœ‰ä»»ä½•å…¶ä»–çš„äº¤æ¢ç»“ç‚¹ã€‚</li>\n<li><strong>æ•°æ®é“¾è·¯(data link)</strong>ï¼šç‰©ç†çº¿è·¯å’Œå®ç°é€šä¿¡åè®®çš„ç¡¬ä»¶æˆ–è€…è½¯ä»¶æ„æˆäº†æ•°æ®é“¾è·¯</li>\n<li><strong>ç½‘ç»œé€‚é…å™¨</strong>ï¼šæ—¢æœ‰ç¡¬ä»¶ï¼Œä¹Ÿæœ‰è½¯ä»¶å®ç°äº†æ•°æ®é“¾è·¯åè®®ï¼ŒåŒ…æ‹¬äº†æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä¸¤ä¸ªåŠŸèƒ½</li>\n<li><strong>å¸§</strong>ï¼šæ•°æ®é“¾è·¯å±‚çš„åè®®æ•°æ®å•å…ƒï¼Œæ•°æ®é“¾è·¯å±‚çš„æ•°æ®çš„åŸºæœ¬å•ä½,ç‰©ç†å±‚åªä¼ è¾“æ¯”ç‰¹æµã€ä¸ç®¡\"å¸§\"</li>\n<li><strong>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¿¡é“ç±»å‹</strong>ï¼š\n<ul>\n<li>ç‚¹å¯¹ç‚¹ä¿¡é“:ä½¿ç”¨ä¸€å¯¹ä¸€çš„ç‚¹å¯¹ç‚¹é€šä¿¡æ–¹å¼</li>\n<li>å¹¿æ’­ä¿¡é“ï¼šä½¿ç”¨ä¸€å¯¹å¤šçš„å¹¿æ’­é€šä¿¡æ–¹å¼</li>\n</ul>\n</li>\n<li>æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚äº¤ä¸‹æ¥çš„IPæ•°æ®æŠ¥æ„æˆå¸§å‘é€åˆ°é“¾è·¯ä¸Šï¼Œä»¥åŠæŠŠæ¥æ”¶åˆ°çš„å¸§ä¸­çš„æ•°æ®å–å‡ºå¹¶ä¸Šäº¤ç»™ç½‘ç»œå±‚</li>\n<li>æ•°æ®é“¾è·¯å±‚åè®®çš„ä¸‰ä¸ªé—®é¢˜\n<ul>\n<li><strong>å°è£…æˆå¸§(framing)</strong>ï¼šåœ¨ç½‘ç»œå±‚çš„IPæ•°æ®æŠ¥çš„å‰ååˆ†åˆ«æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œè¿™æ ·å°±æ„æˆäº†å¸§ï¼Œæ¥æ”¶ç«¯åœ¨æ”¶åˆ°ç‰©ç†å±‚ä¸Šäº¤æ¯”ç‰¹æµåï¼Œå°±èƒ½æ ¹æ®é¦–éƒ¨å’Œå°¾éƒ¨çš„æ ‡è®°ï¼Œä»æ”¶åˆ°çš„æ¯”ç‰¹æµä¸­è¯†åˆ«å¸§çš„å¼€å§‹å’Œç»“æŸã€‚ä¸€ä¸ªå¸§çš„é•¿åº¦ç­‰äºæ•°æ®éƒ¨åˆ†åŠ ä¸Šå¸§é¦–éƒ¨å’Œå¸§å°¾éƒ¨çš„é•¿åº¦ã€‚ç„¶åäº¤ç»™ç‰©ç†å±‚ä¼ è¾“\n<ul>\n<li>æœ€å¤§ä¼ é€å•å…ƒï¼ˆMTU Maximum Transfer Unitï¼‰ï¼šå¸§çš„æ•°æ®éƒ¨åˆ†é•¿åº¦ä¸Šé™ï¼›ä¸ºäº†æé«˜å¸§çš„ä¼ è¾“æ•ˆç‡ï¼Œåº”å½“ä½¿å¸§çš„æ•°æ®éƒ¨åˆ†é•¿åº¦å°½å¯èƒ½åœ°å¤§äºé¦–éƒ¨å’Œå°¾éƒ¨çš„é•¿åº¦ã€‚è¿‡å°:æ¬¡æ•°å¤ªå¤šï¼Œä¼šå½±å“ä¼ è¾“çš„æ•ˆç‡ï¼Œæ•°æ®å¸§è¿‡å¤§:æ—¶å»¶å¤ªå¤§ã€‚MTUä¸€èˆ¬ä¸º1500å­—èŠ‚</li>\n<li>å¸§å®šç•Œï¼šå¸§é¦–éƒ¨æ§åˆ¶å­—ç¬¦SOH(Start Of Header)æ”¾åœ¨å¸§çš„æœ€å‰é¢è¡¨ç¤ºå¸§å¼€å§‹ï¼Œå¸§å°¾éƒ¨æ§åˆ¶å­—ç¬¦EOT(End Of Transmission)è¡¨ç¤ºå¸§çš„ç»“æŸï¼Œæ¥æ”¶æ–¹æ”¶åˆ°å¸§ä¸å®Œæ•´æ—¶ï¼ˆåªæœ‰å¼€å§‹æ— ç»“æŸï¼‰å¿…é¡»ä¸¢å¼ƒ</li>\n<li>æ³¨æ„:å½“æ•°æ®æ˜¯ç”±å¯æ‰“å°çš„ASCIIç ç»„æˆçš„æ–‡æœ¬æ–‡ä»¶æ—¶ï¼ŒSOHäºŒè¿›åˆ¶ç¼–ç ä¸º00000001ã€‚EOTäºŒè¿›åˆ¶ç¼–ç ä¸º00000100</li>\n</ul>\n</li>\n<li><strong>é€æ˜ä¼ è¾“</strong>:æ— è®ºä»€ä¹ˆæ ·çš„æ¯”ç‰¹ç»„åˆçš„æ•°æ®éƒ½èƒ½å¤Ÿé€šè¿‡è¿™ä¸ªæ•°æ®é“¾è·¯å±‚\n<ul>\n<li>æœ¬è´¨ï¼šä½¿æ•°æ®ä¸­å‡ºç°çš„æ§åˆ¶å­—ç¬¦\"SOH\"å’Œ\"EOT\"åœ¨æ¥æ”¶ç«¯ä¸è¢«è§£é‡Šä¸ºæ§åˆ¶å­—ç¬¦</li>\n<li>å½“ä¼ é€çš„å¸§æ˜¯æ–‡æœ¬æ–‡ä»¶ï¼ˆé”®ç›˜ä¸Šè¾“å…¥ï¼‰ç»„æˆçš„å¸§æ—¶ä¸å¯èƒ½å‡ºç°å¸§å®šç•Œæ§åˆ¶ç¬¦ï¼Œè€ŒäºŒè¿›åˆ¶çš„è®¡ç®—æœºç¨‹åºæˆ–å›¾åƒå¯èƒ½</li>\n<li>å­—èŠ‚å¡«å……(byte stuffing)/å­—ç¬¦å¡«å……(character stuffing):å‘é€ç«¯çš„æ•°æ®é“¾è·¯å±‚åœ¨æ•°æ®ä¸­å‡ºç°æ§åˆ¶å­—ç¬¦â€œEOTâ€æˆ–â€SOHâ€œæ—¶æ²¡åœ¨å…¶å‰é¢æ’å…¥ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦â€ESCâ€œ(00011011)ï¼Œè€Œåœ¨æ¥æ”¶ç«¯çš„æ•°æ®é“¾è·¯å±‚å†æŠŠæ•°æ®é€å¾€ç½‘ç»œå±‚ä¹‹å‰åˆ é™¤è¿™ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œå¦‚æœè½¬ä¹‰å­—ç¬¦ä¹Ÿå‡ºç°åœ¨æ•°æ®ä¸­é‚£ä¹ˆåœ¨è½¬ä¹‰å­—ç¬¦å‰é¢å†æ’å…¥ä¸€ä¸ªè½¬ä¹‰å­—ç¬¦ï¼Œå½“æ¥æ”¶åˆ°ä¸¤ä¸ªè½¬ä¹‰å­—ç¬¦çš„æ—¶å€™æŠŠå‰é¢çš„é‚£ä¸ªåˆ é™¤æ‰å°±è¡Œ</li>\n</ul>\n</li>\n<li><strong>å·®é”™æ£€æµ‹</strong>ï¼šæ¯”ç‰¹åœ¨ä¼ è¾“è¿‡ç¨‹ä¸­äº§ç”Ÿçš„é”™è¯¯(æ”¶åˆ°å¹²æ‰°äº§ç”Ÿ)\n<ul>\n<li>ä¼ è¾“å·®é”™ï¼šæ¯”ç‰¹å·®é”™ã€å¸§ä¸¢å¤±ã€å¸§é‡å¤ã€å¸§å¤±åº</li>\n<li>æ¯”ç‰¹å·®é”™ï¼š1å¯èƒ½å˜æˆ0,0å¯èƒ½å˜æˆ1</li>\n<li>è¯¯ç ç‡BER(Bit Error Rate)ï¼šåœ¨ä¸€æ®µæ—¶é—´å†…ï¼Œä¼ è¾“é”™è¯¯çš„æ¯”ç‰¹æ‰€å çš„æ¯”ç‰¹æ€»æ•°ï¼Œä¿¡å™ªæ¯”è¶Šé«˜ï¼Œè¯¯ç ç‡è¶Šå°</li>\n<li>æ¯”ç‰¹å·®é”™æ£€æµ‹åŠæ³•ï¼šå¾ªç¯å†—ä½™æ£€éªŒCRCï¼Œä¸ºè¿›è¡Œæ£€é”™æ·»åŠ å†—ä½™ç ç§°ä¸ºå¸§æ£€éªŒåºåˆ—FCS</li>\n<li>åœ¨æ•°æ®é“¾è·¯å±‚ä½¿ç”¨CRCå¾ªç¯å†—ä½™æ£€éªŒ(Cyclic Redundancy Check)ï¼Œèƒ½å¤Ÿå®ç°çš„æ˜¯æ— æ¯”ç‰¹å·®é”™ä¼ è¾“ï¼Œè€Œä¸æ˜¯å¯é ä¼ è¾“ï¼ˆæ²¡æœ‰é‡ä¼ ï¼‰</li>\n<li>æ•°æ®é“¾è·¯å±‚åªè¿›è¡Œæ•°æ®çš„æ£€æµ‹ï¼Œä¸è¿›è¡Œçº æ­£ï¼ˆé”™è¯¯ç›´æ¥ä¸¢å¼ƒï¼‰</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>3.2. å¹¿åŸŸç½‘ä½¿ç”¨ç‚¹å¯¹ç‚¹ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚</h2>\n<ul>\n<li>é€šä¿¡çš„ä¸»è¦æ­¥éª¤\n<ul>\n<li>ç»“ç‚¹Açš„æ•°æ®é“¾è·¯å±‚æŠŠç½‘ç»œå±‚äº¤ä¸‹æ¥çš„ipæ•°æ®æŠ¥æ·»åŠ é¦–éƒ¨å’Œå°¾éƒ¨å°è£…æˆå¸§</li>\n<li>ç»“ç‚¹AæŠŠå°è£…å¥½çš„å¸§å‘é€ç»™ç»“ç‚¹Bçš„æ•°æ®é“¾è·¯å±‚</li>\n<li>è‹¥ç»“ç‚¹Bçš„æ•°æ®é“¾è·¯å±‚æ”¶åˆ°çš„å¸§æ— å·®é”™ï¼Œåˆ™ä»æ”¶åˆ°çš„å¸§ä¸­æå–å‡ºipæ•°æ®æŠ¥ä¸Šäº¤ç»™ä¸Šé¢çš„ç½‘ç»œå±‚ï¼›å¦åˆ™ä¸¢å¼ƒè¿™ä¸ªå¸§</li>\n</ul>\n</li>\n<li>ç‚¹å¯¹ç‚¹åè®®PPP(Point-to-Point Protocol)\n<ul>\n<li>PPPåè®®ç»„æˆ\n<ul>\n<li>ç”¨æˆ·è®¡ç®—æœºå’ŒISPè¿›è¡Œé€šä¿¡æ—¶çš„æ•°æ®é“¾è·¯å±‚åè®®</li>\n<li>ä¸€ä¸ªå°†ipåè®®å°è£…åˆ°ä¸²è¡Œé“¾è·¯çš„æ–¹æ³•ï¼šPPPæ—¢æ”¯æŒå¼‚æ­¥é“¾è·¯ï¼ˆæ— å¥‡å¶æ ¡éªŒçš„8æ¯”ç‰¹æ•°æ®ï¼‰ï¼Œä¹Ÿæ”¯æŒé¢å‘æ¯”ç‰¹çš„åŒæ­¥é“¾è·¯ï¼Œipæ•°æ®æŠ¥åœ¨PPPå¸§ä¸­å°±æ˜¯ä¿¡æ¯éƒ¨åˆ†ï¼Œå…¶çš„é•¿åº¦å—æœ€å¤§ä¼ é€å•å…ƒçš„MTUé™åˆ¶</li>\n<li>ä¸€ä¸ªç”¨æ¥å»ºç«‹ã€é…ç½®å’Œæµ‹è¯•çš„æ•°æ®é“¾è·¯è¿æ¥çš„é“¾è·¯æ§åˆ¶åè®®LCP(Link Control Protocol)ï¼Œé€šä¿¡çš„åŒæ–¹å¯ä»¥åå•†ä¸€äº›é€‰é¡¹</li>\n<li>ä¸€å¥—ç½‘ç»œæ§åˆ¶åè®®NCP(Network Control Protocol)ï¼Œå…¶ä¸­çš„æ¯ä¸€ä¸ªåè®®æ”¯æŒä¸åŒçš„ç½‘ç»œå±‚åè®®</li>\n</ul>\n</li>\n<li>PPPåè®®çš„å¸§æ ¼å¼<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6a68bf17cb131382f3cb1.png\" alt=\"1.png\">\n<ul>\n<li>pppå¸§é¦–éƒ¨\n<ul>\n<li>æ ‡å¿—å­—æ®µF(Flag)ï¼šè§„å®šä¸º0x7Eï¼ˆ01111110ï¼‰ï¼Œè¡¨ç¤ºä¸€ä¸ªå¸§çš„å¼€å§‹ï¼Œå¸§å®šç•Œç¬¦</li>\n<li>åœ°å€å­—æ®µAï¼šè§„å®šä¸º0xFFï¼ˆ11111111ï¼‰</li>\n<li>æ§åˆ¶å­—æ®µCï¼šè§„å®šä¸º0x03ï¼ˆ00000011ï¼‰</li>\n<li>åè®®å­—æ®µï¼š2å­—èŠ‚ï¼Œä¸º0x0021æ—¶ï¼ŒPPPå¸§çš„ä¿¡æ¯å­—æ®µå°±æ˜¯IPæ•°æ®æŠ¥ã€‚0xC021æ—¶ï¼ŒPPPé“¾è·¯æ§åˆ¶åè®®LCPï¼›0x8021æ—¶ï¼Œç½‘ç»œå±‚çš„æ§åˆ¶æ•°æ®ã€‚</li>\n</ul>\n</li>\n<li>ä¿¡æ¯å­—æ®µçš„é•¿åº¦æ˜¯å¯å˜çš„ï¼Œä¸è¶…è¿‡1500å­—èŠ‚</li>\n<li>PPPå¸§å°¾éƒ¨\n<ul>\n<li>å°¾éƒ¨ä¸­çš„ç¬¬ä¸€å­—æ®µï¼ˆ2å­—èŠ‚ï¼‰æ˜¯ä½¿ç”¨CRCçš„å¸§æ£€éªŒåºåˆ—FCS</li>\n<li>æ ‡å¿—å­—æ®µFï¼Œè§„å®šä¸º0x7E(01111110)ï¼Œè¡¨ç¤ºä¸€ä¸ªå¸§çš„ç»“æŸã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>PPPåè®®é€æ˜ä¼ è¾“å®ç°æ–¹å¼\n<ul>\n<li>å½“PPPä½¿ç”¨å¼‚æ­¥ä¼ è¾“ï¼ˆé€ä¸ªå­—ç¬¦åœ°ä¼ é€ï¼‰æ—¶ï¼ŒæŠŠè½¬ä¹‰ç¬¦å®šä¹‰ä¸º0x7Dï¼ˆ01111101ï¼‰ï¼Œæ­¤æ—¶ä½¿ç”¨å­—èŠ‚å¡«å……å®ç°é€æ˜ä¼ è¾“ï¼Œè½¬ä¹‰ç®—æ³•ä¸ºå½“ 0x7d å‡ºç°åœ¨æ•°æ®ä¸­æ—¶ï¼Œç´§æ¥ç€çš„å­—ç¬¦çš„ç¬¬ 6 ä¸ªæ¯”ç‰¹è¦å–å…¶è¡¥ç ï¼Œå³ä¸ 0x20 åšå¼‚æˆ–è¿ç®—ã€‚RFC1662è§„å®šï¼š\n<ul>\n<li>0x7Eå­—èŠ‚è½¬æˆ2å­—èŠ‚åºåˆ—ï¼ˆ0x7Dï¼Œ0x5Eï¼‰</li>\n<li>0x7Då­—èŠ‚ï¼ˆå‡ºç°äº†å’Œè½¬ä¹‰å­—ç¬¦ä¸€æ ·çš„æ¯”ç‰¹ç»„åˆï¼‰è½¬å˜æˆ2å­—èŠ‚åºåˆ—ï¼ˆ0x7Dï¼Œ0x5Dï¼‰</li>\n<li>ASCIIç çš„æ§åˆ¶å­—ç¬¦ï¼ˆå³æ•°å€¼å°äº0x20çš„å­—ç¬¦ï¼‰ï¼Œåˆ™åœ¨è¯¥å­—ç¬¦å‰é¢éœ€è¦åŠ å…¥0x7Då­—èŠ‚ï¼ŒåŒæ—¶å°†è¯¥å­—ç¬¦çš„ç¼–ç åŠ ä»¥æ”¹å˜ã€‚ä¾‹å¦‚å‡ºç°0x03(åœ¨æ§åˆ¶å­—ç¬¦ä¸­æ˜¯â€œä¼ è¾“ç»“æŸâ€EXTï¼‰å°±è¦æŠŠå®ƒè½¬å˜ä¸º2å­—èŠ‚åºåˆ—ï¼ˆ0x7Dï¼Œ0x23ï¼‰</li>\n</ul>\n</li>\n<li>å½“PPPåè®®åœ¨SONET/SDHé“¾è·¯ä½¿ç”¨åŒæ­¥ä¼ è¾“ï¼ˆä¸€è¿ä¸²çš„æ¯”ç‰¹è¿ç»­ä¼ é€ï¼‰ï¼Œé‡‡ç”¨é›¶æ¯”ç‰¹ä¼ è¾“å®ç°é€æ˜ä¼ è¾“\n<ul>\n<li>åœ¨å‘é€ç«¯ï¼Œæ‰«ææ•´ä¸ªä¿¡æ¯å­—æ®µï¼Œåªè¦å‘ç°æœ‰5ä¸ªè¿ç»­çš„1ï¼Œåˆ™ç«‹å³å¡«å…¥ä¸€ä¸ª0ï¼ˆç¡¬ä»¶å®ç°ï¼‰ï¼Œæ¥æ”¶ç«¯æ”¶åˆ°5ä¸ªè¿ç»­1æ—¶ï¼ŒæŠŠåé¢çš„0åˆ é™¤è¿˜åŸæˆåŸæ¥çš„ä¿¡æ¯æ¯”ç‰¹æµ</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>PPPåè®®å·¥ä½œè¿‡ç¨‹\n<ul>\n<li>å½“ç”¨æˆ·æ‹¨å·æ¥å…¥ISPåï¼Œå°±å»ºç«‹äº†ä¸€æ¡ä»ç”¨æˆ·PCåˆ°ISPçš„ç‰©ç†è¿æ¥ã€‚ç”¨æˆ·PCå‘ISPå‘é€ä¸€ç³»åˆ—çš„é“¾è·¯æ§åˆ¶åè®®LCPåˆ†ç»„ï¼Œä»¥ä¾¿å»ºç«‹LCPè¿æ¥ã€‚è¿™äº›åˆ†ç»„åŠå…¶å“åº”é€‰æ‹©äº†å°†è¦ä½¿ç”¨çš„ä¸€äº›PPPå‚æ•°ï¼Œç„¶åè¿›è¡Œç½‘ç»œå±‚é…ç½®ï¼Œç½‘ç»œæ§åˆ¶åè®®NCPç»™æ–°æ¥å…¥çš„ç”¨æˆ·PCåˆ†é…ä¸€ä¸ªä¸´æ—¶çš„IPåœ°å€,DNSæœåŠ¡å™¨åœ°å€ä»¥åŠé»˜è®¤ç½‘å…³çš„IPåœ°å€ã€‚è¿™æ ·PCç”¨æˆ·å°±ç§°ä¸ºå› ç‰¹ç½‘ä¸Šçš„ä¸€ä¸ªæœ‰IPåœ°å€çš„ä¸»æœºäº†.å½“ç”¨æˆ·é€šä¿¡å®Œæ¯•æ—¶ï¼ŒNCPé‡Šæ”¾ç½‘ç»œå±‚è¿æ¥ï¼Œæ”¶å›åŸæ¥åˆ†é…å‡ºå»çš„IPåœ°å€ã€‚LCPé‡Šæ”¾æ•°æ®é“¾è·¯å±‚è¿æ¥ã€‚æœ€åé‡Šæ”¾çš„æ˜¯ç‰©ç†å±‚çš„è¿æ¥ã€‚</li>\n<li>PPPé“¾è·¯çš„èµ·å§‹å’Œç»ˆæ­¢çŠ¶æ€æ°¸è¿œæ˜¯é“¾è·¯é™æ­¢(Link Dead)çŠ¶æ€ï¼Œè¿™æ—¶åœ¨ç”¨æˆ·PCå’ŒISPçš„è·¯ç”±å™¨ä¹‹é—´å¹¶ä¸å­˜åœ¨ç‰©ç†å±‚çš„è¿æ¥</li>\n<li>å½“ç”¨æˆ·PCé€šè¿‡è°ƒåˆ¶è°ƒèŠ‚å™¨å‘¼å«è·¯ç”±å™¨ï¼ˆç‚¹å‡»æ‹¨å·ï¼‰æ—¶ï¼Œ<strong>ç”¨æˆ·åå’Œå¯†ç é€šè¿‡ RADIUSï¼ˆè¿œç¨‹ç”¨æˆ·æ‹¨å·è®¤è¯ç³»ç»Ÿï¼ŒåŒ…æ‹¬papå’Œchapï¼‰ åè®®ä» RAS å‘é€åˆ°è®¤è¯æœåŠ¡å™¨</strong>,è·¯ç”±å™¨å°±èƒ½å¤Ÿæ£€æµ‹åˆ°è°ƒåˆ¶è°ƒè§£å™¨å‘å‡ºçš„è½½æ³¢ä¿¡å·ã€‚åœ¨åŒæ–¹å»ºç«‹ç‰©ç†å±‚è¿æ¥åï¼ŒPPPè¿›å…¥\"é“¾è·¯å»ºç«‹\"çŠ¶æ€(Link Establish)ã€‚</li>\n<li>LCPå¼€å§‹åå•†ä¸€äº›é…ç½®é€‰é¡¹ï¼Œå³å‘é€LCPçš„é…ç½®è¯·æ±‚å¸§(Configure-Request)ï¼ˆPPPå¸§ï¼Œåè®®å­—æ®µä¸ºLCPå¯¹åº”ä»£ç ï¼‰ï¼ŒåŒ…æ‹¬é“¾è·¯ä¸Šçš„æœ€å¤§å¸§é•¿ï¼Œæ‰€ä½¿ç”¨çš„çš„é‰´åˆ«åè®®(authentication protocol)çš„è§„çº¦ï¼ˆå¦‚æœæœ‰çš„è¯ï¼‰ï¼Œä»¥åŠä¸é€‚ä½¿ç”¨PPPå¸§ä¸­çš„åœ°å€å’Œæ§åˆ¶å­—æ®µï¼ˆå› ä¸ºè¿™ä¸¤ä¸ªå­—æ®µçš„å€¼æ˜¯å›ºå®šçš„ï¼Œæ²¡æœ‰ä»»ä½•ä¿¡æ¯é‡ï¼Œå¯ä»¥å¿½ç•¥ï¼‰</li>\n<li>é“¾è·¯çš„å¦ä¸€ç«¯å¯ä»¥å‘é€ä¸€ä¸‹å‡ ç§å“åº”ä¸­çš„ä¸€ç§\n<ul>\n<li>é…ç½®ç¡®è®¤å¸§(Configure-Ack)ï¼šæ‰€æœ‰é€‰é¡¹éƒ½æ¥å—</li>\n<li>é…ç½®å¦è®¤å¸§(Configure-Nak)ï¼šæ‰€æœ‰é€‰é¡¹éƒ½ç†è§£ä½†ä¸æ¥å—</li>\n<li>é…ç½®æ‹’ç»å¸§(Configure-Reject)ï¼šé€‰é¡¹é‡Œé¢æœ‰çš„æ— æ³•è¯†åˆ«æˆ–ä¸èƒ½æ¥å—ï¼Œéœ€è¦åå•†</li>\n</ul>\n</li>\n<li>åå•†ç»“æŸååŒæ–¹å»ºç«‹äº†LCPé“¾è·¯ï¼Œæ¥ç€è¿›å…¥\"é‰´åˆ«\"(Authenticate)çŠ¶æ€ï¼Œåªå…è®¸ä¼ é€LCPåè®®çš„åˆ†ç»„ï¼Œé‰´åˆ«åè®®çš„åˆ†ç»„ä»¥åŠç›‘æµ‹é“¾è·¯è´¨é‡çš„åˆ†ç»„ã€‚\n<ul>\n<li>è‹¥ä½¿ç”¨å£ä»¤å…¼å¤‡åè®®PAPï¼Œåˆ™éœ€è¦å‘èµ·é€šä¿¡çš„ä¸€æ–¹å‘é€èº«ä»½æ ‡è¯†ç¬¦å’Œå£ä»¤ï¼Œç³»ç»Ÿå¯å…è®¸ç”¨æˆ·é‡è¯•è‹¥å¹²æ¬¡</li>\n<li>å¦‚æœéœ€è¦æœ‰æ›´å¥½çš„å®‰å…¨æ€§ã€‚åˆ™å¯ä½¿ç”¨æ¡æ‰‹é‰´åˆ«åè®®CHAPã€‚</li>\n</ul>\n</li>\n<li>è‹¥èº«ä»½é‰´åˆ«å¤±è´¥ã€‚åˆ™è½¬åˆ°é“¾è·¯ç»ˆæ­¢çŠ¶æ€ã€‚è‹¥é‰´åˆ«æˆåŠŸï¼Œåˆ™è¿›å…¥ç½‘ç»œå±‚åè®®çŠ¶æ€(Network layer)ï¼ˆPPPé“¾è·¯çš„ä¸¤ç«¯çš„ç½‘ç»œæ§åˆ¶åè®®NCPæ ¹æ®ç½‘ç»œå±‚çš„ä¸åŒåè®®äº’ç›¸äº¤æ¢ç½‘ç»œå±‚ç‰¹å®šçš„ç½‘ç»œæ§åˆ¶åˆ†ç»„ï¼‰PPPåè®®ä¸¤ç«¯çš„ç½‘ç»œå±‚å¯ä»¥è¿è¡Œä¸åŒçš„ç½‘ç»œå±‚åè®®ï¼Œä½†ä»ç„¶å¯ä½¿ç”¨åŒä¸€ä¸ªPPPåè®®è¿›è¡Œé€šä¿¡\n<ul>\n<li>ï¼ˆäº†è§£ï¼‰å¦‚æœåœ¨PPPé“¾è·¯ä¸Šè¿è¡Œçš„æ˜¯IPåè®®ï¼Œåˆ™å¯¹PPPé“¾è·¯çš„æ¯ä¸€æ®µé…ç½®IPåè®®æ¨¡å—ï¼ˆå¦‚åˆ†é…IPåœ°å€ï¼‰æ—¶å°±è¦ä½¿ç”¨NCPä¸­æ”¯æŒIPçš„åè®®-IPæ§åˆ¶åè®®IPCPã€‚IPCPåˆ†ç»„ä¹Ÿå°è£…æˆPPPå¸§ï¼ˆåè®®å­—æ®µä¸º0x8021ï¼‰åœ¨PPPé“¾è·¯ä¸Šä¼ é€ã€‚åœ¨ä½é€Ÿé“¾è·¯ä¸Šè¿è¡Œæ—¶ï¼ŒåŒæ–¹è¿˜å¯ä»¥åå•†ä½¿ç”¨å‹ç¼©çš„TCPå’ŒIPé¦–éƒ¨ï¼Œä»¥å‡å°‘åœ¨é“¾è·¯ä¸Šå‘é€çš„æ¯”ç‰¹æ•°</li>\n</ul>\n</li>\n<li>ç½‘ç»œå±‚é…ç½®å®Œæ¯•åï¼Œé“¾è·¯è¿›å…¥å¯è¿›è¡Œæ•°æ®é€šä¿¡çš„\"é“¾è·¯æ‰“å¼€\"çŠ¶æ€ã€‚é“¾è·¯çš„ä¸¤ä¸ªPPPæ–­ç‚¹å¯ä»¥å½¼æ­¤å‘å¯¹æ–¹å‘é€åˆ†ç»„ã€‚ä¸¤ä¸ªPPPç«¯ç‚¹è¿˜å¯å‘é€ä¼šé€è¯·æ±‚LCPåˆ†ç»„å’Œå›é€å›ç­”LCPåˆ†ç»„ï¼Œä»¥æ£€æŸ¥é“¾è·¯çš„çŠ¶æ€</li>\n<li>æ•°æ®ä¼ è¾“ç»“æŸåå¯ä»¥æœ‰é“¾è·¯çš„ä¸€æ®µå‘å‡ºç»ˆæ­¢è¯·æ±‚LCPåˆ†ç»„ï¼‰(Terminate-Request)è¯·æ±‚ç»ˆæ­¢é“¾è·¯è¿æ¥ï¼Œåœ¨æ”¶åˆ°å¯¹æ–¹å‘æ¥çš„ç»ˆæ­¢ç¡®è®¤LCPåˆ†ç»„(Terminate-Ack)åï¼Œè½¬åˆ°LCPé“¾è·¯ç»ˆæ­¢çŠ¶æ€ï¼Œå¦‚æœé“¾è·¯å‡ºç°æ•…éšœï¼Œä¹Ÿä¼šä»é“¾è·¯æ‰“å¼€çŠ¶æ€è½¬åˆ°é“¾è·¯ç»ˆæ­¢çŠ¶æ€ï¼Œå½“è°ƒåˆ¶è°ƒè§£å™¨çš„è½½æ³¢åœæ­¢åï¼Œå›åˆ°é“¾è·¯é™æ­¢çŠ¶æ€</li>\n<li>PPPoE æ˜¯å°† PPP æ¶ˆæ¯è£…å…¥ä»¥å¤ªç½‘åŒ…è¿›è¡Œä¼ è¾“çš„æ–¹å¼</li>\n<li>é€šè¿‡éš§é“å°†ç½‘ç»œåŒ…å‘é€ç»™è¿è¥å•†.éš§é“æœ‰å‡ ç§å®ç°æ–¹å¼.TCP è¿æ¥å°±æ˜¯å…¶ä¸­ä¸€ç§å®ç°æ–¹å¼ï¼ˆå›¾ 4.19ï¼ˆaï¼‰ï¼‰ã€‚è¿™ç§æ–¹å¼ä¸­ï¼Œé¦–å…ˆéœ€è¦åœ¨ç½‘ç»œä¸Šçš„ä¸¤å°éš§é“è·¯ç”±å™¨ ä¹‹é—´å»ºç«‹ TCP è¿æ¥ï¼Œç„¶åå°†è¿æ¥ä¸¤ç«¯çš„å¥—æ¥å­—å½“ä½œæ˜¯è·¯ç”±å™¨çš„ç«¯å£ï¼Œå¹¶ä»è¿™ä¸ªç«¯å£æ¥æ”¶å‘æ•°æ®ã€‚æ¢å¥è¯è¯´ï¼Œåœ¨è·¯ç”±å™¨æ”¶å‘åŒ…æ—¶ï¼Œæ˜¯åŸºäºéš§é“çš„è§„åˆ™å‘éš§é“ä¸­æ”¾å…¥æˆ–å–å‡ºç½‘ç»œåŒ…ï¼Œè¿™æ—¶ï¼ŒTCP è¿æ¥å°±å¥½åƒå˜æˆäº†ä¸€æ ¹ç½‘çº¿ï¼ŒåŒ…ä»è¿™é‡Œç©¿è¿‡åˆ°è¾¾å¦ä¸€ç«¯.åŸºäºå°è£…ï¼ˆencapsulationï¼‰çš„éš§é“å®ç°æ–¹å¼ï¼Œè¿™ç§æ–¹å¼æ˜¯å°†åŒ…å«å¤´éƒ¨åœ¨å†…çš„æ•´ä¸ªåŒ…è£…å…¥å¦ä¸€ä¸ªåŒ…ä¸­ä¼ è¾“åˆ°éš§é“çš„å¦ä¸€ç«¯ã€‚åœ¨è¿™ç§æ–¹å¼ä¸­ï¼ŒåŒ…æœ¬èº«å¯ä»¥åŸå°ä¸åŠ¨åœ°åˆ°è¾¾å¦ä¸€ç«¯çš„å‡ºå£</li>\n<li>äº’è”ç½‘æ¥å…¥è·¯ç”±å™¨åœ¨è½¬å‘åŒ…æ—¶éœ€è¦è¿›è¡Œåœ°å€è½¬æ¢<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b59468b6af5bf95567787.png\" alt=\"3.png\">\t<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ecca2b702dfa139bc55bb.png\" alt=\"50.PNG\"></li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>3.3. å±€åŸŸç½‘</h2>\n<ul>\n<li>å±€åŸŸç½‘æœ€ä¸»è¦çš„ç‰¹ç‚¹ï¼šå°±æ˜¯ç½‘ç»œä¸ºä¸€ä¸ªå•ä½æ‰€æ‹¥æœ‰ï¼Œä¸”åœ°ç†èŒƒå›´å’Œç«™ç‚¹æ•°ç›®å‡æœ‰é™ã€‚</li>\n<li>å±€åŸŸç½‘çš„ä¸»è¦ä¼˜ç‚¹\n<ul>\n<li>å…·æœ‰å¹¿æ’­åŠŸèƒ½ï¼Œä»ä¸€ä¸ªç«™ç‚¹å¯æ–¹ä¾¿åœ°è®¿é—®å…¨ç½‘ã€‚å±€åŸŸç½‘ä¸Šçš„ä¸»æœºå¯å…±äº«è¿æ¥åœ¨å±€åŸŸç½‘ä¸Šçš„å„ç§ç¡¬ä»¶å’Œè½¯ä»¶èµ„æº</li>\n<li>ä¾¿äºç³»ç»Ÿçš„æ‰©å±•å’Œé€æ¸åœ°æ¼”å˜ï¼Œå„è®¾å¤‡çš„ä½ç½®å¯çµæ´»åœ°è°ƒæ•´å’Œæ”¹å˜</li>\n<li>æé«˜ç³»ç»Ÿçš„å¯é æ€§(reliability)ã€å¯ç”¨æ€§(availibility)ã€ç”Ÿå­˜æ€§(survivability)</li>\n</ul>\n</li>\n<li>å±€åŸŸç½‘å¯æŒ‰ç½‘ç»œæ‹“æ‰‘è¿›è¡Œåˆ†ç±»<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/be0dea012e5a83f9b0661.png\" alt=\"30.png\">\n<ul>\n<li>æ˜Ÿå½¢ç½‘ï¼šç”±äºé›†çº¿å™¨(hub)çš„å‡ºç°å’ŒåŒç»çº¿å¤§é‡ç”¨äºå±€åŸŸç½‘ä¸­ï¼Œæ˜Ÿå½¢ä»¥å¤ªç½‘å’Œå¤šçº§æ˜Ÿå½¢ç»“æ„çš„ä»¥å¤ªç½‘è·å¾—äº†éå¸¸å¹¿æ³›çš„åº”ç”¨</li>\n<li>ç¯å½¢ç½‘ï¼š æœ€å…¸å‹çš„å°±æ˜¯ä»¤ç‰Œç¯å½¢ç½‘(token ring)ï¼Œç®€ç§°ä¸ºä»¤ç‰Œç¯ã€‚</li>\n<li>æ€»çº¿ç½‘ï¼šå„ç«™ç›´æ¥è¿åœ¨æ€»çº¿ä¸Šã€‚æ€»çº¿ä¸¤ç«¯çš„åŒ¹é…ç”µé˜»å¸æ”¶åœ¨æ€»çº¿ä¸Šä¼ æ’­çš„ç”µç£æ³¢ä¿¡å·çš„èƒ½é‡ï¼Œé¿å…åœ¨æ€»çº¿ä¸Šäº§ç”Ÿæœ‰å®³çš„ç”µç£æ³¢åå°„</li>\n</ul>\n</li>\n<li>å…±äº«ä¿¡é“çš„æ–¹æ³•\n<ul>\n<li>é™æ€åˆ’åˆ†ä¿¡é“(ä»£ä»·é«˜ï¼Œä¸é€‚åˆäºå±€åŸŸç½‘ä½¿ç”¨)ç”¨æˆ·åªè¦åˆ†é…åˆ°äº†ä¿¡é“å°±ä¸ä¼šå’Œå…¶ä»–ç”¨æˆ·å‘é€å†²çªã€‚å¦‚é¢‘åˆ†å¤ç”¨</li>\n<li>åŠ¨æ€åª’ä½“æ¥å…¥æ§åˆ¶/å¤šç‚¹æ¥å…¥(multiple access) ï¼ˆä¿¡é“å¹¶éåœ¨ç”¨æˆ·é€šä¿¡æ—¶å›ºå®šåˆ†é…ç»™ç”¨æˆ·ï¼‰\n<ul>\n<li><strong>éšæœºæ¥å…¥</strong>ï¼šæ‰€æœ‰ç”¨æˆ·å¯éšæœºåœ°å‘é€ä¿¡æ¯ã€‚ä½†å¦‚æœæ°å·§æœ‰ä¸¤ä¸ªæˆ–æ›´å¤šçš„ç”¨æˆ·åœ¨åŒä¸€æ—¶åˆ»å‘é€ä¿¡æ¯ï¼Œé‚£ä¹ˆåœ¨å…±äº«åª’ä½“ä¸Šå°±è¦å‘ç”Ÿç¢°æ’(å‘ç”Ÿäº†å†²çª)ï¼Œä½¿å¾—è¿™äº›ç”¨æˆ·çš„å‘é€éƒ½å¤±è´¥ã€‚å› æ­¤å¿…é¡»æœ‰è§£å†³ç¢°æ’çš„ç½‘ç»œåè®®</li>\n<li>å—æ§æ¥å…¥ï¼šç”¨æˆ·ä¸èƒ½éšæœºåœ°å‘é€ä¿¡æ¯è€Œå¿…é¡»æœä»ä¸€å®šçš„æ§åˆ¶ã€‚åˆ†ä¸ºåˆ†æ•£æ§åˆ¶çš„ä»¤ç‰Œç¯å±€åŸŸç½‘å’Œé›†ä¸­æ§åˆ¶çš„å¤šç‚¹çº¿è·¯æ¢è¯¢(polling)/è½®è¯¢ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é€šä¿¡é€‚é…å™¨çš„ä½œç”¨ï¼ˆç½‘ç»œæ¥å£å¡NIC(Network Interface Card)æˆ–ç½‘å¡ï¼Œè£…æœ‰å¤„ç†å™¨å’Œå­˜å‚¨å™¨RAMå’ŒROMï¼Œ)\n<ul>\n<li>æ’å…¥ä¸»æ¿æ—¶ï¼Œéœ€è¦æŠŠç®¡ç†è¯¥é€‚é…çš„å™¨çš„è®¾å¤‡é©±åŠ¨ç¨‹åºå®‰è£…åœ¨è®¡ç®—æœºæ“ä½œç³»ç»Ÿä¸­ã€‚è¿™ä¸ªé©±åŠ¨ç¨‹åºä»¥åå°±ä¼šå‘Šè¯‰é€‚é…å™¨ï¼Œåº”å½“ä»å­˜å‚¨å™¨ä»€ä¹ˆä½ç½®ä¸ŠæŠŠå¤šé•¿çš„æ•°æ®å—å‘é€åˆ°å±€åŸŸç½‘ï¼Œæˆ–è€…åº”å½“åœ¨å­˜å‚¨å™¨çš„ä»€ä¹ˆä½ç½®ä¸ŠæŠŠå±€åŸŸç½‘ä¼ é€è¿‡æ¥çš„æ•°æ®å—å­˜å‚¨ä¸‹æ¥</li>\n<li>è¿›è¡Œæ•°æ®ä¸²è¡Œä¼ è¾“å’Œå¹¶è¡Œä¼ è¾“çš„è½¬æ¢ï¼šé€‚é…å™¨å’Œå±€åŸŸç½‘ä¹‹é—´çš„é€šä¿¡æ˜¯é€šè¿‡ç”µç¼†æˆ–åŒç»çº¿ä»¥ä¸²è¡Œä¼ è¾“æ–¹å¼è¿›è¡Œçš„ï¼Œå’Œè®¡ç®—æœºä¹‹é—´çš„é€šä¿¡åˆ™æ˜¯é€šè¿‡è®¡ç®—æœºä¸»æ¿ä¸Šçš„I/Oæ€»çº¿ä»¥å¹¶è¡Œä¼ è¾“æ–¹å¼è¿›è¡Œçš„ã€‚</li>\n<li>ç”±äºç½‘ç»œä¸Šçš„æ•°æ®ç‡å’Œè®¡ç®—æœºæ€»çº¿ä¸Šçš„æ•°æ®ç‡å¹¶ä¸ç›¸åŒï¼Œæ‰€ä»¥åœ¨é€‚é…å™¨ä¸­å¿…é¡»è£…æœ‰å¯¹æ•°æ®è¿›è¡Œç¼“å­˜çš„å­˜å‚¨èŠ¯ç‰‡</li>\n<li>å®ç°ä»¥å¤ªç½‘åè®®ã€‚é€‚é…å™¨åŒ…å«äº†æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä¸¤å±‚æ¬¡çš„åŠŸèƒ½</li>\n<li>é€‚é…å™¨æ¥æ”¶å’Œå‘é€å„ç§å¸§æ—¶ä¸ä½¿ç”¨è®¡ç®—æœºçš„CPUã€‚è¿™æ—¶CPUå¯ä»¥å¤„ç†å…¶ä»–ä»»åŠ¡ã€‚å½“é€‚é…å™¨æ”¶åˆ°æœ‰å·®é”™çš„å¸§æ—¶ï¼Œå°±æŠŠè¿™ä¸ªå¸§ä¸¢å¼ƒè€Œä¸å¿…é€šçŸ¥è®¡ç®—æœºã€‚å½“é€‚é…å™¨æ”¶åˆ°æ­£ç¡®çš„å¸§æ—¶ï¼Œå®ƒå°±ä½¿ç”¨ä¸­æ–­æ¥é€šçŸ¥è¯¥è®¡ç®—æœºå¹¶äº¤ä»˜ç»™åè®®æ ˆä¸­çš„ç½‘ç»œå±‚ã€‚å½“è®¡ç®—æœºè¦å‘é€IPæ•°æ®æŠ¥æ—¶ï¼Œå°±ç”±åè®®æ ˆæŠŠIPæ•°æ®æŠ¥å‘ä¸‹äº¤ç»™é€‚é…å™¨ï¼Œç»„è£…æˆå¸§åå‘é€åˆ°å±€åŸŸç½‘ã€‚</li>\n<li>è®¡ç®—æœºçš„ç¡¬ä»¶åœ°å€â€”â€”MACåœ°å€ï¼Œå°±åœ¨é€‚é…å™¨çš„ROMä¸­ï¼Œç”Ÿäº§æ—¶å·²ç»å†™å…¥ã€‚è®¡ç®—æœºçš„è½¯ä»¶åœ°å€â€”â€”IPåœ°å€ï¼Œå°±åœ¨è®¡ç®—æœºçš„å­˜å‚¨å™¨ä¸­</li>\n<li><strong>ç½‘å¡å¹¶ä¸æ˜¯é€šä¸Šç”µä¹‹åå°±å¯ä»¥é©¬ä¸Šå¼€å§‹å·¥ä½œçš„ï¼Œè€Œæ˜¯å’Œå…¶ä»–ç¡¬ä»¶ä¸€æ ·ï¼Œéƒ½éœ€è¦è¿›è¡Œåˆå§‹åŒ–ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰“å¼€è®¡ç®—æœºå¯åŠ¨æ“ä½œç³»ç»Ÿçš„æ—¶å€™ï¼Œç½‘å¡é©±åŠ¨ç¨‹åºä¼šå¯¹ç¡¬ä»¶è¿›è¡Œåˆå§‹åŒ–æ“ä½œï¼Œç„¶åç¡¬ä»¶æ‰è¿›å…¥å¯ä»¥ä½¿ç”¨çš„çŠ¶æ€ã€‚è¿™äº›æ“ä½œåŒ…æ‹¬ç¡¬ä»¶é”™è¯¯æ£€æŸ¥ã€åˆå§‹è®¾ç½®ç­‰æ­¥éª¤ï¼Œè¿™äº›æ­¥éª¤å¯¹äºå¾ˆå¤šå…¶ä»–ç¡¬ä»¶ä¹Ÿæ˜¯å…±é€šçš„ï¼Œä½†ä¹Ÿæœ‰ä¸€äº›æ“ä½œæ˜¯ä»¥å¤ªç½‘ç‰¹æœ‰çš„ï¼Œé‚£å°±æ˜¯åœ¨æ§åˆ¶ä»¥å¤ªç½‘æ”¶å‘æ“ä½œçš„ MAC æ¨¡å—ä¸­è®¾ç½® MAC åœ°å€ã€‚è¯»å– MAC åœ°å€çš„æ“ä½œæ˜¯ç”±ç½‘å¡é©±åŠ¨ç¨‹åºæ¥å®Œæˆçš„ï¼Œå› æ­¤ç½‘å¡é©±åŠ¨ç¨‹åºä¹Ÿå¯ä»¥ä¸ä»ç½‘å¡ ROM ä¸­è¯»å–åœ°å€ï¼Œè€Œæ˜¯å°†é…ç½®æ–‡ä»¶ä¸­è®¾å®šçš„ MAC åœ°å€æ‹¿å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­å¹¶ç”¨äºè®¾å®š MAC å¤´éƒ¨ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¾“å…¥ MAC åœ°å€ã€‚ç½‘å¡ä¸­ä¿å­˜çš„ MAC åœ°å€ä¼šç”±ç½‘å¡é©±åŠ¨ç¨‹åºè¯»å–å¹¶åˆ†é…ç»™MACæ¨¡å—ã€‚</strong></li>\n</ul>\n</li>\n</ul>\n<h2>3.4. å±€åŸŸç½‘ä½¿ç”¨å¹¿æ’­ä¿¡é“çš„æ•°æ®é“¾è·¯å±‚</h2>\n<ul>\n<li>ä½¿ç”¨åŸå› ï¼šåŒä¸€æ—¶é—´åªå…è®¸ä¸€å°è®¡ç®—æœºå‘é€æ•°æ®ï¼Œå¦åˆ™å„è®¡ç®—æœºä¼šç›¸äº’å¹²æ‰°ï¼Œå‘é€æ•°æ®è¢«ç ´åã€‚éšç€äº¤æ¢å¼é›†çº¿å™¨ï¼ˆäº¤æ¢æœºï¼‰æ™®åŠï¼Œä¿¡å·å·²ç»ä¸ä¼šå‘ç”Ÿç¢°æ’äº†ï¼‰</li>\n<li>ä¸ºäº†é€šä¿¡æ–¹ä¾¿ï¼Œä»¥å¤ªç½‘é‡‡å–äº†ä»¥ä¸‹ä¸¤ç§æªæ–½\n<ul>\n<li>é‡‡ç”¨è¾ƒä¸ºçµæ´»çš„æ— è¿æ¥çš„å·¥ä½œæ–¹å¼ï¼Œå³ä¸å¿…å…ˆå»ºç«‹è¿æ¥å°±å¯ä»¥ç›´æ¥å‘é€æ•°æ®ï¼Œé€‚é…å™¨å¯¹å‘é€çš„æ•°æ®å¸§ä¸è¿›è¡Œç¼–å·ï¼Œä¹Ÿä¸è¦æ±‚å¯¹æ–¹å‘å›ç¡®è®¤ã€‚ä»¥å¤ªç½‘æä¾›çš„æœåŠ¡æ˜¯å°½æœ€å¤§åŠªåŠ›çš„äº¤ä»˜ï¼Œå³ä¸å¯é çš„äº¤ä»˜ï¼›å½“ç›®çš„ç«™æ”¶åˆ°ç”±å·®é”™çš„æ•°æ®å¸§æ—¶å°±ä¸¢å¼ƒã€‚å¯¹æœ‰å·®é”™å¸§æ˜¯å¦éœ€è¦é‡ä¼ åˆ™ç”±é«˜å±‚æ¥å†³å®šï¼Œä»¥å¤ªç½‘å¹¶ä¸çŸ¥é“é‡ä¼ å¸§ï¼Œè€Œæ˜¯å½“åšæ–°çš„æ•°æ®å¸§æ¥å‘é€ï¼›æ€»çº¿ä¸Šåªè¦æœ‰ä¸€å°è®¡ç®—æœºåœ¨å‘é€æ•°æ®ï¼Œæ€»çº¿çš„ä¼ è¾“èµ„æºå°±ä¼šè¢«å ç”¨ï¼Œåœ¨åŒä¸€æ—¶é—´åªèƒ½å…è®¸ä¸€å°è®¡ç®—æœºå‘é€æ•°æ®ï¼›å¦åˆ™å„è®¡ç®—æœºä¹‹é—´å°±ä¼šäº’ç›¸å¹²æ‰°ï¼Œä½¿å¾—æ‰€å‘é€æ•°æ®è¢«ç ´åï¼Œä»¥å¤ªç½‘ä½¿ç”¨æœ€ç®€å•çš„éšæœºæ¥å…¥ï¼Œè§£å†³å†²çªçš„åè®®æ˜¯ï¼šCSMA/CDï¼Œè½½æ³¢ç›‘å¬å¤šç‚¹æ¥å…¥/ç¢°æ’æ£€æµ‹(Carrier Sense Multiple Access with Conllsion Detection)</li>\n<li>ä»¥å¤ªç½‘å‘é€çš„æ•°æ®éƒ½æ˜¯ä½¿ç”¨æ›¼å½»æ–¯ç‰¹ç¼–ç çš„ä¿¡å·ã€‚äºŒè¿›åˆ¶åŸºå¸¦æ•°å­—ä¿¡å·é€šå¸¸å°±æ˜¯é«˜ï¼Œä½ç”µå‹äº¤æ›¿å‡ºç°çš„ä¿¡å·ï¼›è¿™ç§ä¿¡å·æœ€å¤§çš„é—®é¢˜å°±æ˜¯å½“å‡ºç°ä¸€é•¿ä¸²è¿1æˆ–0æ—¶ï¼Œæ¥æ”¶ç«¯æ— æ³•ä»æ¥æ”¶åˆ°çš„æ¯”ç‰¹æµä¸­æå–ä½åŒæ­¥ï¼ˆæ¯”ç‰¹åŒæ­¥ï¼‰ä¿¡å·ï¼›è€Œæ›¼å½»æ–¯ç‰¹ç¼–ç æ–¹æ³•æ˜¯æŠŠæ¯ä¸€ä¸ªç å…ƒåˆ†æˆä¸¤ä¸ªç›¸ç­‰çš„é—´éš”ï¼Œç å…ƒ1æ˜¯åœ¨å‰ä¸€ä¸ªé—´éš”ä¸ºä½ç”µå‹ï¼Œè€Œåä¸€ä¸ªé—´éš”ä¸ºé«˜ç”µå‹ï¼Œç å…ƒ0åˆšå¥½ç›¸åï¼ˆ1æ˜¯â€œå‰é«˜åä½â€ï¼Œè€Œ0æ˜¯â€œå‰ç¬¬åé«˜â€ï¼‰ï¼Œæ›¼å½»æ–¯ç‰¹ç¼–ç çš„ç¼ºç‚¹æ˜¯ï¼Œå®ƒæ‰€å çš„é¢‘å¸¦å®½åº¦æ¯”åŸå§‹çš„åŸºå¸¦ä¿¡å·å¢åŠ äº†ä¸€å€ï¼ˆå› ä¸ºæ¯ç§’ä¼ é€çš„ç å…ƒåŠ å€äº†ï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b4888f40d9536a83c09e5.png\" alt=\"45.PNG\"></li>\n</ul>\n</li>\n<li>CSMA/CDåè®®çš„è¦ç‚¹ï¼š\n<ul>\n<li>â€œå¤šç‚¹æ¥å…¥â€ï¼šæ€»çº¿å‹ç½‘ç»œï¼Œè®¸å¤šè®¡ç®—æœºä»¥å¤šç‚¹æ¥å…¥çš„æ–¹å¼è¿æ¥åœ¨ä¸€æ ¹æ€»çº¿ä¸Šã€‚</li>\n<li>â€œè½½æ³¢ç›‘å¬â€ï¼šæ¯ä¸ªç«™å¿…é¡»ä¸åœåœ°ç”¨ç”µå­æŠ€æœ¯æ£€æµ‹ä¿¡é“ã€‚å‘é€å‰æ£€æµ‹ä¸ºäº†è·å¾—å‘é€æƒï¼Œå‘é€ä¸­æ£€æµ‹ä¸ºäº†å‘ç°æœ‰æ²¡æœ‰å…¶ä»–ç«™çš„å‘é€å’Œæœ¬ç«™å‘é€çš„ç¢°æ’</li>\n<li>â€œç¢°æ’æ£€æµ‹â€ï¼šè¾¹å‘é€è¾¹ç›‘å¬ï¼›å½“å‡ ä¸ªç«™åŒæ—¶åœ¨æ€»çº¿ä¸Šå‘é€æ•°æ®æ—¶ï¼Œæ€»çº¿ä¸Šçš„ä¿¡å·ç”µå‹å˜åŒ–å¹…åº¦å°†ä¼šå¢å¤§ï¼ˆç›¸äº’å åŠ ï¼‰ï¼Œå½“é€‚é…å™¨æ£€æµ‹åˆ°çš„ä¿¡å·ç”µå‹å˜åŒ–å¹…åº¦è¶…è¿‡ä¸€å®šçš„é—¨é™å€¼æ—¶ï¼Œå°±è®¤ä¸ºæ€»çº¿ä¸Šè‡³å°‘æœ‰ä¸¤ä¸ªç«™åŒæ—¶åœ¨å‘é€æ•°æ®ï¼Œè¡¨æ˜äº§ç”Ÿäº†ç¢°æ’ï¼›è¿™æ—¶ï¼Œæ€»çº¿ä¸Šä¼ è¾“çš„ä¿¡å·äº§ç”Ÿä¸¥é‡çš„å¤±çœŸï¼Œæ— æ³•ä»ä¸­æ¢å¤å‡ºæœ‰ç”¨çš„ä¿¡æ¯ï¼Œæ­¤æ—¶å…¶é€‚é…å™¨å°±è¦ç«‹å³åœæ­¢å‘é€ï¼Œç»è¿‡ä¸€æ®µéšæœºæ—¶é—´å†å‘</li>\n<li>è™½ç„¶æ¯ä¸€ä¸ªç«™åœ¨å‘é€æ•°æ®ä¹‹å‰å·²ç»ç›‘å¬åˆ°ä¿¡é“ä¸º\"ç©ºé—²\"ï¼Œä½†ç”µç£æ³¢åœ¨æ€»çº¿ä¸Šæ€»æ˜¯ä»¥æœ‰é™çš„é€Ÿç‡ä¼ æ’­ï¼Œå¯¼è‡´æ•°æ®è¿˜ä¼šåœ¨æ€»çº¿ä¸Šç¢°æ’</li>\n<li>æ€»çº¿ä¸Šçš„å•ç¨‹ç«¯åˆ°ç«¯ä¼ æ’­æ—¶å»¶è®°ä¸ºÏ„ï¼Œå‘é€æ•°æ®åæœ€è¿Ÿè¦ç»è¿‡2Ï„ï¼ˆä¸¤å€çš„æ€»çº¿ç«¯åˆ°ç«¯çš„å¾€è¿”ä¼ æ’­æ—¶å»¶ï¼‰æ‰èƒ½çŸ¥é“è‡ªå·±å‘é€çš„æ•°æ®å’Œå…¶ä»–ç«™å‘é€çš„æ•°æ®æœ‰ç¢°æ’ï¼Œå› æ­¤ï¼Œä»¥å¤ªç½‘ç«¯åˆ°ç«¯å¾€è¿”æ—¶é—´2rç§°ä¸ºäº‰ç”¨æœŸcontention periodï¼ˆç¢°æ’çª—å£collision windowï¼‰ï¼›ç»è¿‡äº‰ç”¨æœŸè¿˜æ²¡æœ‰æ£€æµ‹åˆ°ç¢°æ’ï¼Œæ‰èƒ½è‚¯å®šè¿™æ¬¡å‘é€ä¸ä¼šå‘é€ç¢°æ’ï¼›</li>\n<li>åœ¨ä½¿ç”¨CSMA/CDåè®®æ—¶ï¼Œä¸€ä¸ªç«™ä¸å¯èƒ½åŒæ—¶è¿›è¡Œå‘é€å’Œæ¥æ”¶ï¼ˆä½†å¿…é¡»è¾¹å‘é€è¾¹ç›‘å¬ï¼‰ã€‚åªèƒ½è¿›è¡ŒåŠåŒå·¥é€šä¿¡</li>\n<li>ä»¥å¤ªç½‘é‡‡ç”¨æˆªæ–­äºŒè¿›åˆ¶æŒ‡æ•°é€€é¿ç®—æ³•(truncated binary exponential backoff)æ¥ç¡®å®šç¢°æ’åé‡ä¼ çš„æ—¶æœºï¼Œé¿å…ç©ºé—²åå„ç«™é‡ä¼ æ—¶å‘ç”Ÿå†²çªçš„æ¦‚ç‡å‡å°ï¼›åŸºæœ¬é€€é¿æ—¶é—´ä¸ºäº‰ç”¨æœŸ2Ï„ï¼Œå…·ä½“çš„äº‰ç”¨æœŸæ—¶é—´51.2Î¼s,ä¹Ÿç§°ä¸º512æ¯”ç‰¹æ—¶é—´ï¼Œ1æ¯”ç‰¹æ—¶é—´ä¸ºå‘é€1æ¯”ç‰¹æ‰€éœ€æ—¶é—´ã€‚ä»ç¦»æ•£çš„æ•´æ•°é›†åˆ[0,1..ï¼ˆ2^k-1ï¼‰]ä¸­éšæœºå–å‡ºä¸€ä¸ªæ•°ï¼Œè®°ä¸ºrã€‚é‡ä¼ åº”æ¨åçš„æ—¶é—´å°±æ˜¯rå€çš„äº‰ç”¨æœŸï¼Œå³r*2Ï„ï¼›Kä¸ºç¢°æ’æ¬¡æ•°æ—¶ã€‚K=Min[é‡ä¼ æ¬¡æ•°ï¼Œ10]ï¼Œå½“é‡ä¼ è¾¾16æ¬¡ä»ä¸èƒ½æˆåŠŸæ—¶ï¼Œåˆ™ä¸¢å¼ƒè¯¥å¸§ï¼Œå¹¶å‘é«˜å±‚æŠ¥å‘Š</li>\n<li>é€‚é…å™¨æ¯å‘é€ä¸€ä¸ªæ–°çš„å¸§ï¼Œå°±è¦æ‰§è¡Œä¸€æ¬¡CSMA/CDç®—æ³•ï¼Œé€‚é…å™¨å¯¹è¿‡å»å‘é€è¿‡çš„ç¢°æ’æ²¡æœ‰è®°å¿†åŠŸèƒ½ï¼›</li>\n<li>ä¸ºäº†é¿å…åœ¨å‘é€å®Œæ¯•ä¹‹å‰æ²¡æœ‰æ£€æµ‹å‡ºç¢°æ’ï¼šä»¥å¤ªç½‘è§„å®šä¸€ä¸ªæœ€çŸ­å¸§é•¿64å­—èŠ‚ï¼Œå³512bitï¼Œé€šè¿‡å¡«å……ä½¿å¸§é•¿ä¸å°äº64å­—èŠ‚ï¼›å‡¡æ˜¯é•¿åº¦å°äº64å­—èŠ‚çš„å¸§éƒ½æ˜¯ç”±äºå†²çªè€Œå¼‚å¸¸ä¸­æ­¢çš„æ— æ•ˆå¸§ï¼Œåªè¦æ”¶åˆ°äº†è¿™ç§æ— æ•ˆå¸§ï¼Œå°±åº”å½“ç«‹å³å°†å…¶ä¸¢å¼ƒï¼›</li>\n<li>å¼ºåŒ–ç¢°æ’ï¼šå½“å‘é€æ•°æ®çš„ç«™å‘ç°ç¢°æ’æ—¶ï¼Œé™¤äº†ç«‹å³åœæ­¢å‘é€æ•°æ®å¤–ï¼Œè¿˜è¦å†å‘é€32æˆ–48æ¯”ç‰¹çš„äººä¸ºå¹²æ‰°ä¿¡å·(jamming signal)ï¼Œä»¥ä¾¿è®©æ‰€æœ‰ç”¨æˆ·éƒ½çŸ¥é“å‘ç”Ÿç¢°æ’</li>\n<li>ä»¥å¤ªç½‘è§„å®šå¸§é—´æœ€å°é—´éš”ä¸º9.6Î¼sï¼Œç›¸å½“äº96æ¯”ç‰¹æ—¶é—´ï¼Œä¸ºäº†ä½¿åˆšåˆšæ¥æ”¶åˆ°æ•°æ®å¸§çš„ç«™çš„æ¥æ”¶ç¼“å­˜æ¥å¾—åŠæ¸…ç†</li>\n</ul>\n</li>\n<li>CSMA/CDåè®®çš„è¦ç‚¹å½’çº³ï¼š\n<ul>\n<li>1.å‡†å¤‡å‘é€ï¼šé€‚é…å™¨ä»ç½‘ç»œå±‚è·å¾—ä¸€ä¸ªåˆ†ç»„ï¼ŒåŠ ä¸Šä»¥å¤ªç½‘çš„é¦–éƒ¨å’Œå°¾éƒ¨ï¼Œç»„æˆä»¥å¤ªç½‘å¸§ï¼Œæ”¾å…¥é€‚é…å™¨çš„ç¼“å­˜ä¸­ï¼Œä½†åœ¨å‘é€ä¹‹å‰ï¼Œå¿…é¡»å…ˆæ£€æµ‹ä¿¡é“ï¼›</li>\n<li>2.æ£€æµ‹ä¿¡é“ï¼šè‹¥æ£€æµ‹åˆ°ä¿¡é“å¿™ï¼Œåˆ™åº”ä¸åœåœ°æ£€æµ‹ï¼Œä¸€ç›´ç­‰å¾…ä¿¡é“è½¬ä¸ºç©ºé—²ã€‚è‹¥æ£€æµ‹åˆ°ä¿¡é“ç©ºé—²ï¼Œå¹¶åœ¨96æ¯”ç‰¹æ—¶é—´å†…ä¿¡é“ä¿æŒç©ºé—²ï¼Œå°±å‘é€è¿™ä¸ªå¸§ï¼›</li>\n<li>3.åœ¨å‘é€è¿‡ç¨‹ä¸­ä»ä¸åœåœ°æ£€æµ‹ä¿¡é“ï¼Œå³ç½‘ç»œé€‚é…å™¨è¦è¾¹å‘é€è¾¹ç›‘å¬ï¼Œè¿™é‡Œåªæœ‰ä¸¤ç§å¯èƒ½æ€§ï¼š\n<ul>\n<li>ä¸€æ˜¯å‘é€æˆåŠŸï¼šåœ¨äº‰ç”¨æœŸå†…ä¸€ç›´æ²¡æœ‰æ£€æµ‹åˆ°ç¢°æ’ï¼Œè¿™ä¸ªå¸§è‚¯å®šèƒ½å¤Ÿå‘é€æˆåŠŸï¼›å›åˆ°1</li>\n<li>äºŒæ˜¯å‘é€å¤±è´¥ï¼šåœ¨äº‰ç”¨æœŸå†…æ£€æµ‹åˆ°ç¢°æ’ï¼Œè¿™æ˜¯ç«‹å³åœæ­¢å‘é€æ•°æ®ï¼Œå¹¶æŒ‰ç…§è§„å®šå‘é€äººä¸ºå¹²æ‰°ä¿¡å·ï¼›é€‚é…å™¨æ¥ç€å°±æ‰§è¡ŒæŒ‡æ•°é€€é¿ç®—æ³•ï¼Œç­‰å¾…rå€512æ¯”ç‰¹æ—¶é—´åï¼Œè¿”å›æ­¥éª¤2ï¼Œç»§ç»­æ£€æµ‹ä¿¡é“ï¼›ä½†è‹¥é‡ä¼ 16æ¬¡è¿˜ä¸èƒ½æˆåŠŸï¼Œåˆ™åœæ­¢é‡ä¼ è€Œå‘ä¸ŠæŠ¥é”™ï¼›</li>\n</ul>\n</li>\n<li>ä»¥å¤ªç½‘æ¯å‘é€å®Œä¸€å¸§åŒæ—¶å·²å‘é€çš„å¸§æš‚æ—¶ä¿ç•™ä¸€ä¸‹ã€‚å¦‚æœåœ¨äº‰ç”¨æœŸå†…æ£€æµ‹å‘ç”Ÿäº†ç¢°æ’ï¼Œé‚£ä¹ˆè¿˜è¦æ¨è¿Ÿä¸€æ®µæ—¶é—´åå†æŠŠè¿™ä¸ªæš‚æ—¶ä¿ç•™çš„å¸§é‡ä¼ 1æ¬¡</li>\n</ul>\n</li>\n<li>é›†çº¿å™¨/ä¸­ç»§å¼é›†çº¿å™¨:æ˜Ÿå‹æ‹“è¡¥çš„ä¸­å¿ƒå¯é æ€§å¾ˆé«˜çš„è®¾å¤‡ï¼ˆåŠåŒå·¥ï¼Œäº¤æ¢æœºå…¨åŒå·¥ï¼‰\n<ul>\n<li>ä½¿ç”¨é›†çº¿å™¨çš„ä»¥å¤ªç½‘åœ¨é€»è¾‘ä¸Šä»ç„¶æ˜¯ä¸€ä¸ªæ€»çº¿ç½‘ï¼Œå„ç«™å…±äº«é€»è¾‘ä¸Šçš„æ€»çº¿ï¼Œä½¿ç”¨çš„ä¾ç„¶æ˜¯CSMA/CDåè®®</li>\n<li>ä¸€ä¸ªé›†çº¿å™¨ä¸Šæœ‰è®¸å¤šæ¥å£ã€‚æ¯ä¸ªæ¥å£é€šè¿‡RJ-45æ’å¤´ä¸ä¸»æœºç›¸è¿ã€‚å¾ˆåƒå¤šæ¥å£çš„è½¬å‘å™¨</li>\n<li>é›†çº¿å™¨å·¥ä½œåœ¨ç‰©ç†å±‚ï¼Œæ¥å£çš„ä½œç”¨å°±æ˜¯ç®€å•çš„è½¬å‘æ¯”ç‰¹ï¼Œä¸è¿›è¡Œç¢°æ’æ£€æµ‹ï¼Œç¢°æ’æ£€æµ‹æ˜¯ä¸»æœºçš„ç½‘å¡è¿›è¡Œçš„ã€‚</li>\n<li>é›†çº¿å™¨é‡‡ç”¨ä¸“é—¨çš„èŠ¯ç‰‡è¿›è¡Œè‡ªé€‚åº”ä¸²éŸ³å›æ³¢æŠµæ¶ˆ</li>\n<li></li>\n<li>é›†çº¿å™¨è¿æ¥çš„å¤šä¸ªä¸»æœºæ„æˆå­ç½‘ï¼Œå¤šä¸ªé›†çº¿å™¨å†ä¸è·¯ç”±å™¨è¿æ¥æ„æˆå¤§çš„ç½‘ç»œ</li>\n<li>å®¶ç”¨è·¯ç”±å™¨å¯ä»¥åŒ…å«é›†çº¿å™¨åŠŸèƒ½</li>\n<li>é›†çº¿å™¨ä¼šå°†ä¿¡å·å‘å¾€æ‰€æœ‰çº¿è·¯ï¼Œå¦‚æœåŒæ—¶è¾“å…¥å¤šä¸ªä¿¡å·å°±ä¼šå‘ç”Ÿç¢°æ’ï¼Œæ— æ³•åŒæ—¶ä¼ è¾“å¤šè·¯ä¿¡å·</li>\n</ul>\n</li>\n</ul>\n<h2>3.5. ä»¥å¤ªç½‘çš„MACå±‚ï¼ˆåª’ä½“æ¥å…¥æ§åˆ¶MACå±‚ï¼‰</h2>\n<ul>\n<li>åœ¨å±€åŸŸç½‘ä¸­ï¼Œç¡¬ä»¶åœ°å€åˆç§°ä¸ºç‰©ç†åœ°å€æˆ–è€…MACåœ°å€ï¼Œå®é™…ä¸Šæ˜¯é€‚é…å™¨åœ°å€æˆ–é€‚é…å™¨æ ‡è¯†ç¬¦æˆ–æ¥å£æ ‡è¯†ç¬¦ã€‚\n<ul>\n<li>IEEE 802æ ‡å‡†è§„å®šäº†ä¸€ç§48ä½çš„å…¨çƒåœ°å€ï¼Œå›ºåŒ–åœ¨ç½‘å¡ï¼ˆé€‚é…å™¨ï¼‰çš„ROMä¸­çš„åœ°å€ã€‚æ›´æ¢é€‚é…å™¨å°±æ›´æ¢äº†macåœ°å€ï¼Œ6å­—èŠ‚ï¼Œä¸åœ°ç†ä½ç½®æ— å…³ã€‚ä¸€ä¸ªç½‘å¡ä¸€ä¸ªMACåœ°å€ã€‚ä½¿ç”¨åå…­è¿›åˆ¶è¡¨ç¤º ipconfig /all</li>\n<li>ç½‘å¡å…·æœ‰è¿‡æ»¤åŠŸèƒ½ï¼Œå½“å®ƒæ”¶åˆ°ä¸€ä¸ªMACå¸§å°±å¼€å§‹ç”¨ç¡¬ä»¶æ£€æŸ¥MACå¸§ä¸­çš„ç›®çš„åœ°å€ï¼Œå¦‚æœæ˜¯å‘å¾€æœ¬ç«™çš„å°±æ”¶ä¸‹ï¼Œä¸æ˜¯å°±ä¸¢å¼ƒï¼Œä¸åšå…¶ä»–å¤„ç†ã€‚åŒ…æ‹¬\n<ul>\n<li>å•æ’­(unicast)å¸§ï¼ˆä¸€å¯¹ä¸€ï¼‰ã€‚å³æ”¶åˆ°çš„å¸§çš„MACåœ°å€ä¸æœ¬ç«™çš„ç¡¬ä»¶åœ°å€ç›¸åŒ</li>\n<li>å¹¿æ’­(broadcast)å¸§ï¼ˆä¸€å¯¹å…¨ä½“ï¼‰ã€‚å³å‘é€ç»™æœ¬å±€åŸŸç½‘ä¸Šæ‰€æœ‰ç«™ç‚¹çš„å¸§ï¼ˆå…¨1åœ°å€ï¼‰</li>\n<li>å¤šæ’­(multicast)å¸§ï¼ˆä¸€å¯¹å¤šï¼‰ã€‚å³å‘é€ç»™æœ¬å±€åŸŸç½‘ä¸Šä¸€éƒ¨åˆ†ç«™ç‚¹çš„å¸§</li>\n</ul>\n</li>\n<li>ç½‘å¡è‡³å°‘èƒ½è¯†åˆ«å•æ’­å’Œå¹¿æ’­å¸§ï¼Œç½‘å¡è¿˜æœ‰ä¸€ä¸ªæ··æ‚æ–¹å¼å·¥ä½œæ¨¡å¼ï¼Œåªè¦å‘ç°æœ‰å¸§åœ¨ä»¥å¤ªç½‘ä¸Šä¼ æ’­å°±ä¼šæ¥æ”¶ä¸‹æ¥ã€‚å¯ä½œä¸ºçªƒå¬æ–¹å¼å’Œç½‘ç»œç»´æŠ¤å’Œç®¡ç†äººå‘˜æ”¹å–„ç½‘ç»œçš„ä¸€ç§å·¥å…·</li>\n<li>åªæœ‰åœ¨æ“ä½œç³»ç»Ÿå¯åŠ¨è¿‡ç¨‹ä¸­å¯¹ç½‘å¡è¿›è¡Œåˆå§‹åŒ–çš„æ—¶å€™æ‰ä¼šè¯»å– MAC åœ°å€ï¼Œè¯»å–å‡ºæ¥ä¹‹åä¼šå­˜æ”¾åœ¨å†…å­˜ä¸­ï¼Œæ¯æ¬¡æ‰§è¡Œæ”¶å‘æ“ä½œæ—¶å®é™…ä¸Šä½¿ç”¨çš„æ˜¯å†…å­˜ä¸­çš„å€¼ã€‚æ­¤å¤–ï¼Œè¯»å– MAC åœ°å€çš„æ“ä½œæ˜¯ç”±ç½‘å¡é©±åŠ¨ç¨‹åºæ¥å®Œæˆçš„ï¼Œå› æ­¤ç½‘å¡é©±åŠ¨ç¨‹åºä¹Ÿå¯ä»¥ä¸ä»ç½‘å¡ ROM ä¸­è¯»å–åœ°å€ï¼Œè€Œæ˜¯å°†é…ç½®æ–‡ä»¶ä¸­è®¾å®šçš„ MAC åœ°å€æ‹¿å‡ºæ¥æ”¾åˆ°å†…å­˜ä¸­å¹¶ç”¨äºè®¾å®š MAC å¤´éƒ¨ï¼Œæˆ–è€…ä¹Ÿå¯ä»¥é€šè¿‡å‘½ä»¤è¾“å…¥ MAC åœ°å€</li>\n</ul>\n</li>\n<li>MACå¸§çš„æ ¼å¼<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6e6f75f5ff77fd87d1f5b.png\" alt=\"7.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/73e559b40b3f2144d0cdb.png\" alt=\"46.PNG\">\n<ul>\n<li>å‰åŒæ­¥ç ï¼š7ä¸ªå­—èŠ‚ï¼ˆ1å’Œ0äº¤æ›¿ï¼‰ç”¨æ¥ä½¿æ¥æ”¶ç«¯çš„é€‚é…å™¨åœ¨æ¥æ”¶MACå¸§æ—¶èƒ½å¤Ÿè¿…é€Ÿè°ƒæ•´æ—¶é’Ÿé¢‘ç‡ï¼Œä½¿å®ƒå’Œå‘é€ç«¯çš„é¢‘ç‡ç›¸åŒã€‚åœ¨ä½¿ç”¨SONET/SDHè¿›è¡ŒåŒæ­¥ä¼ è¾“æ—¶åˆ™ä¸éœ€è¦å‰åŒæ­¥ç ï¼Œå› ä¸ºåŒæ­¥ä¼ è¾“æ—¶æ”¶å‘åŒæ–¹çš„ä½åŒæ­¥æ€»æ˜¯ä¸€ç›´ä¿æŒç€</li>\n<li>å¸§å¼€å§‹å®šç•Œç¬¦ï¼š1ä¸ªå­—èŠ‚(10101011)</li>\n<li>MACç›®çš„åœ°å€ï¼š6ä¸ªå­—èŠ‚ï¼Œç½‘å¡åªå¤„ç†ä¸å½“å‰é€‚é…å™¨çš„ç‰©ç†åœ°å€ç›¸åŒçš„æ•°æ®å¸§ï¼Œä¸åŒåˆ™ç›´æ¥ä¸¢å¼ƒã€‚</li>\n<li>æºMACåœ°å€ï¼š6ä¸ªå­—èŠ‚</li>\n<li>ç±»å‹ï¼šç”¨æ¥æ ‡å¿—ä¸Šä¸€å±‚ä½¿ç”¨çš„æ˜¯ä»€ä¹ˆåè®®ï¼Œå†³å®šæŠŠæ•°æ®äº¤ä»˜ç»™ä¸Šå±‚çš„åè®®ï¼Œè¯¥å­—æ®µä¸º0x0800æ—¶äº¤ä»˜ç»™IPåè®®ï¼Œä¸º0x0806äº¤ä»˜ç»™ARPï¼Œ0X8035äº¤ä»˜ç»™RARPã€‚0x86DDäº¤ä»˜ç»™IPv6</li>\n<li>æ•°æ®/æœ‰æ•ˆè½½è·:46(æœ€å°é•¿åº¦64å­—èŠ‚å‡å»18å­—èŠ‚é¦–éƒ¨,ä¸å¤Ÿåˆ™åœ¨æ•°æ®åé¢åŠ å…¥æ•´æ•°å­—èŠ‚å¡«å……å­—æ®µ)-1500å­—èŠ‚(MTU)</li>\n<li>å¸§æ£€éªŒåºåˆ—FCSï¼ˆä½¿ç”¨CRCå¾ªç¯å†—ä½™æ ¡éªŒæ³•ï¼‰ï¼š4ä¸ªå­—èŠ‚ï¼Œæ£€æµ‹è¯¥å¸§æ˜¯å¦å‡ºç°å·®é”™ã€‚ä¸åŒ…æ‹¬å‰åŒæ­¥ç å’Œå¸§å¼€å§‹å®šç•Œç¬¦</li>\n</ul>\n</li>\n<li>MACå¸§ä¸­æ²¡æœ‰å¸§é•¿åº¦å­—æ®µï¼šå› ä¸ºæ›¼å½»æ–¯ç‰¹ç¼–ç çš„æ¯ä¸€ä¸ªç å…ƒï¼ˆä¸ç®¡ç å…ƒæ˜¯1æˆ–0ï¼‰çš„æ­£ä¸­é—´ä¸€å®šæœ‰ä¸€æ¬¡ç”µå‹çš„è½¬æ¢ï¼ˆä»é«˜åˆ°ä½æˆ–ä»ä½åˆ°é«˜ï¼‰ã€‚å½“å‘é€æ–¹å§ä¸€ä¸ªä»¥å¤ªç½‘å¸§å‘é€å®Œæ¯•åï¼Œå°±ä¸å†å‘é€å…¶ä»–ç å…ƒäº†ï¼ˆ1,0éƒ½ä¸å‘é€ï¼‰ã€‚å› æ­¤ï¼Œå‘é€æ–¹ç½‘ç»œé€‚é…å™¨çš„æ¥å£ä¸Šçš„ç”µå‹å°±ä¸å†å˜åŒ–äº†ï¼Œè¿™æ ·æ¥æ”¶æ–¹å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°æ‰¾åˆ°ä»¥å¤ªç½‘å¸§çš„ç»“æŸä½ç½®ã€‚åœ¨è¿™ä¸ªä½ç½®å¾€å‰æ•°4ä¸ªå­—èŠ‚ï¼ˆFCSå­—æ®µé•¿åº¦4å­—èŠ‚ï¼‰å°±èƒ½ç¡®å®šæ•°æ®å­—æ®µç»“æŸçš„ä½ç½®äº†</li>\n<li>å½“å¸§é•¿åº¦å°äº46å­—èŠ‚æ—¶ï¼Œmacå°±ä¼šåœ¨æ•°æ®å­—æ®µçš„åé¢åŠ å…¥ä¸€ä¸ªæ•´æ•°å­—èŠ‚çš„å¡«å……å­—æ®µï¼Œä¿è¯ä¸å°äº46å­—èŠ‚ï¼Œä¸Šå±‚åè®®å¿…é¡»å®šä¹‰äº†æ•°æ®é•¿åº¦ä¿è¯çŸ¥é“æ•°æ®é•¿åº¦ï¼Œç”¨ä»¥å»æ‰å¡«å……å­—æ®µ</li>\n<li>ä»¥å¤ªç½‘ä¸Šä¼ é€æ•°æ®ä»¥å¸§ä¸ºå•ä½ä¼ é€ï¼Œå„å¸§ç›´æ¥å¿…é¡»æœ‰é—´éš™ï¼Œå› æ­¤æ¥æ”¶ç«¯åªè¦æ‰¾åˆ°å¸§å¼€å§‹ç•Œå®šç¬¦ï¼Œå…¶åé¢åˆ°è¾¾çš„æ¯”ç‰¹æµå°±éƒ½å±äºåŒä¸€ä¸ªMACå¸§ï¼Œå¯è§ä»¥å¤ªç½‘ä¸éœ€è¦ä½¿ç”¨å¸§ç»“æŸç•Œå®šç¬¦ï¼Œä¹Ÿä¸éœ€è¦ä½¿ç”¨å­—èŠ‚æ’å…¥ä¿è¯é€æ˜ä¼ è¾“</li>\n<li>æ— æ•ˆçš„MACå¸§\n<ul>\n<li>å¸§çš„é•¿åº¦ä¸æ˜¯æ•´æ•°ä¸ªå­—èŠ‚</li>\n<li>ç”¨æ”¶åˆ°çš„å¸§æ£€éªŒåºåˆ—FCSæŸ¥å‡ºæœ‰å·®é”™ã€‚</li>\n<li>å¸§é•¿åº¦æ•°æ®å­—æ®µä¸åœ¨46-1500ä¹‹é—´ã€‚æœ‰æ•ˆçš„MACå¸§é•¿åº¦ä¸º64-1518å­—èŠ‚ä¹‹é—´ï¼ˆé¦–éƒ¨å 18å­—èŠ‚ï¼‰</li>\n</ul>\n</li>\n<li>MACå¸§åœ¨ä¸åŒç½‘ç»œä¸Šä¼ é€æ—¶ï¼Œå…¶macå¸§é¦–éƒ¨ä¸­çš„æºåœ°å€å’Œç›®çš„åœ°å€è¦å‘ç”Ÿå˜åŒ–</li>\n</ul>\n<h2>3.6. ä»¥å¤ªç½‘çš„æ‰©å±•(ä»ç½‘ç»œå±‚çœ‹æ¥è¿˜æ˜¯ä¸€ä¸ªç½‘ç»œ)</h2>\n<ul>\n<li>åœ¨ç‰©ç†å±‚æ‰©å±•ä»¥å¤ªç½‘ï¼šæ‰©å±•ä¸»æœºå’Œé›†çº¿å™¨ä¹‹é—´è·ç¦»è¦ä½¿ç”¨ä¸€å¯¹å…‰çº¤å’Œä¸€å¯¹å…‰çº¤è°ƒåˆ¶è°ƒè§£å™¨ï¼ˆä½œç”¨æ˜¯è¿›è¡Œç”µä¿¡å·å’Œå…‰ä¿¡å·çš„è½¬æ¢ï¼‰</li>\n<li>åœ¨æ•°æ®é“¾è·¯å±‚æ‰©å±•ä»¥å¤ªç½‘ï¼ˆä½¿ç”¨ç½‘æ¡¥ï¼‰\n<ul>\n<li>ç½‘æ¡¥å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ï¼Œå®ƒæ ¹æ®MACå¸§çš„ç›®çš„åœ°å€å¯¹æ”¶åˆ°çš„å¸§è¿›è¡Œè½¬å‘æˆ–è¿‡æ»¤ã€‚ç½‘æ¡¥åœ¨è½¬å‘å¸§æ—¶ï¼Œä¸æ”¹å˜å¸§çš„æºåœ°å€</li>\n<li>å½“ç½‘æ¡¥æ”¶åˆ°ä¸€ä¸ªå¸§æ—¶ï¼Œå…ˆæ£€æŸ¥æ­¤å¸§çš„ç›®çš„MACåœ°å€ï¼Œç„¶åå†ç¡®å®šå°†è¯¥å¸§è½¬å‘åˆ°å“ªä¸€ä¸ªæ¥å£ï¼Œæˆ–è€…æ˜¯æŠŠå®ƒä¸¢å¼ƒ</li>\n<li>ç½‘æ¡¥çš„å†…éƒ¨ç»“æ„\n<ul>\n<li>ç½‘æ¡¥æœ‰å¤šä¸ªæ¥å£ã€‚ä»¥å¤ªç½‘é€šè¿‡ç½‘æ¡¥è¿æ¥èµ·æ¥åï¼Œå°±æˆä¸ºä¸€ä¸ªè¦†ç›–èŒƒå›´æ›´å¤§çš„ä»¥å¤ªç½‘ï¼Œè€ŒåŸæ¥çš„æ¯ä¸ªä»¥å¤ªç½‘å°±å¯ä»¥ç§°ä¸ºä¸€ä¸ªç½‘æ®µ(segment)</li>\n<li>ç½‘æ¡¥é€šè¿‡è½¬å‘è¡¨æ¥è½¬å‘å¸§ã€‚è½¬å‘è¡¨ä¹Ÿç§°ä¸ºè½¬å‘æ•°æ®åº“æˆ–è·¯ç”±ç›®å½•ã€‚æ¯ä¸€é¡¹åŒ…æ‹¬åœ°å€å’Œæ¥å£</li>\n</ul>\n</li>\n<li>ç½‘æ¡¥çš„ä¼˜ç‚¹\n<ul>\n<li>è¿‡æ»¤é€šä¿¡é‡ï¼Œå¢å¤§ååé‡ï¼Œç½‘æ¡¥å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚çš„MACå­å±‚ï¼Œå¯ä»¥ä½¿ä»¥å¤ªç½‘å„ç½‘æ®µæˆä¸ºéš”ç¦»åŒºçš„ç¢°æ’åŸŸã€‚</li>\n<li>æ‰©å¤§äº†ç‰©ç†èŒƒå›´ï¼Œå› è€Œä¹Ÿå¢åŠ äº†æ•´ä¸ªä»¥å¤ªç½‘ä¸Šå·¥ä½œç«™çš„æœ€å¤§æ•°ç›®ã€‚</li>\n<li>æé«˜äº†å¯é æ€§ï¼Œå½“ç½‘ç»œå‡ºç°äº†æ•…éšœæ—¶ï¼Œä¸€èˆ¬åªå½±å“ä¸ªåˆ«ç½‘æ®µã€‚</li>\n<li>å¯äº’è¿ä¸åŒç‰©ç†å±‚ã€ä¸åŒMACå­å±‚å’Œä¸åŒé€Ÿç‡(å¦‚10Mb/sæˆ–100Mb/s)çš„ä»¥å¤ªç½‘</li>\n</ul>\n</li>\n<li>ç½‘æ¡¥çš„ç¼ºç‚¹\n<ul>\n<li>å¢åŠ äº†æ—¶å»¶ï¼›ç”±äºç½‘æ¡¥å¯¹æ¥æ”¶çš„å¸§è¦å…ˆå­˜å‚¨å’ŒæŸ¥æ‰¾è½¬å‘è¡¨ï¼Œç„¶åæ‰è½¬å‘ï¼Œè€Œè½¬å‘ä¹‹å‰ï¼Œè¿˜å¿…é¡»æ‰§è¡ŒCSMA/CDç®—æ³•(å‘ç”Ÿç¢°æ’æ—¶è¦é€€é¿)</li>\n<li>åœ¨MACå­å±‚å¹¶æ²¡æœ‰æµé‡æ§åˆ¶åŠŸèƒ½ã€‚å½“ç½‘ç»œä¸Šçš„è´Ÿè·å¾ˆé‡æ—¶ï¼Œç½‘æ¡¥ä¸­çš„ç¼“å­˜çš„å­˜å‚¨ç©ºé—´å¯èƒ½ä¸å¤Ÿè€Œå‘ç”Ÿæº¢å‡ºï¼Œä»¥è‡´äº§ç”Ÿå¸§ä¸¢å¤±çš„ç°è±¡ã€‚</li>\n<li>åªé€‚ç”¨äºç”¨æˆ·æ•°ä¸å¤ªå¤š(ä¸è¶…è¿‡å‡ ç™¾ä¸ª)å’Œé€šä¿¡é‡ä¸å¤ªå¤§çš„ä»¥å¤ªç½‘ï¼Œå¦åˆ™æœ‰æ—¶è¿˜ä¼šå› ä¼ æ’­è¿‡å¤šçš„å¹¿æ’­ä¿¡æ¯è€Œäº§ç”Ÿç½‘ç»œæ‹¥å¡(å¹¿æ’­é£æš´)</li>\n</ul>\n</li>\n<li>é€æ˜ç½‘æ¡¥çš„å·¥ä½œåŸç†\n<ul>\n<li>å…ˆæŒ‰ç…§è‡ªå­¦ä¹ ç®—æ³•å¤„ç†æ”¶åˆ°çš„å¸§ï¼Œå¹¶ä¸”æŒ‰ç…§è½¬å‘è¡¨è½¬å‘å‡ºå»ï¼Œ</li>\n<li>è®°å½•æ‰€æœ‰æ¥æ”¶åˆ°æ¥å£çš„å¸§çš„æºåœ°å€è®°å½•ä¸ºæ¥å£å¯¹åº”çš„åœ°å€çš„keyã€valueæ ¼å¼ï¼ŒåŒæ—¶è®°å½•è¿›å…¥ç½‘æ¡¥çš„æ—¶é—´ï¼Œè¿‡æœŸå°±åˆ é™¤è¯¥åœ°å€è®°å½•</li>\n</ul>\n</li>\n<li>æºè·¯ç”±ç½‘æ¡¥ï¼šç”±å‘é€å¸§çš„æºç«™è´Ÿè´£è·¯ç”±é€‰æ‹©çš„ç½‘æ¡¥ï¼Œåœ¨å‘é€å¸§æ—¶ï¼ŒæŠŠè¯¦ç»†çš„è·¯ç”±ä¿¡æ¯æ”¾åœ¨å¸§çš„é¦–éƒ¨ä¸­\n<ul>\n<li>ä¸ºäº†å‘ç°åˆé€‚çš„è·¯ç”±ï¼Œæºç«™ä»¥å¹¿æ’­çš„æ–¹å¼å‘æ¬²é€šä¿¡çš„ç›®çš„ç«™å‘é€ä¸€ä¸ªå‘ç°å¸§ä¸ºæ¢æµ‹ä¹‹ç”¨ï¼Œå‘ç°å¸§å°†åœ¨æ•´ä¸ªä»¥å¤ªç½‘æ²¿ç€æ‰€æœ‰å¯èƒ½çš„è·¯ç”±ä¼ é€ã€‚åœ¨ä¼ é€è¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªå‘ç°å¸§éƒ½è®°å½•æ‰€ç»è¿‡çš„è·¯ç”±ã€‚å½“è¿™äº›å‘ç°å¸§åˆ°è¾¾ç›®çš„ç«™æ—¶ï¼Œå°±æ²¿ç€å„è‡ªçš„è·¯ç”±è¿”å›æºç«™ã€‚æºç«™å¾—çŸ¥è¿™äº›è·¯ç”±åï¼Œä»æ‰€æœ‰å¯èƒ½çš„è·¯ç”±ä¸­é€‰æ‹©å‡ºä¸€ä¸ªæœ€ä½³è·¯ç”±ã€‚ä»¥åï¼Œå‡¡ä»è¿™ä¸ªæºç«™å‘è¯¥ç›®çš„åœ°å‘é€çš„å¸§çš„é¦–éƒ¨ï¼Œéƒ½å¿…é¡»æºå¸¦æºç«™æ‰€ç¡®å®šçš„è¿™ä¸€è·¯ç”±ä¿¡æ¯ã€‚</li>\n<li>å‘ç°å¸§è¿˜èƒ½å¸®åŠ©æºç«™ç¡®å®šæ•´ä¸ªç½‘ç»œå¯ä»¥é€šè¿‡çš„å¸§çš„æœ€å¤§é•¿åº¦ã€‚</li>\n<li>æºè·¯ç”±ç½‘æ¡¥å¯¹ä¸»æœºä¸é€æ˜ï¼Œä¸»æœºå¿…é¡»çŸ¥é“ç½‘æ¡¥çš„è¡¨ç¤ºä»¥åŠè¿æ¥åˆ°å“ªä¸€ä¸ªç½‘æ®µä¸Šï¼Œä½¿ç”¨æºè·¯ç”±ç½‘æ¡¥å¯ä»¥åˆ©ç”¨æœ€ä½³è·¯ç”±ï¼Œè‹¥åœ¨ä¸¤ä¸ªä»¥å¤ªç½‘ä¹‹é—´ä½¿ç”¨å¹¶è”çš„æºè·¯ç”±ç½‘æ¡¥ï¼Œåˆ™å¯ä½¿é€šä¿¡é‡è¾ƒå¹³å‡åœ°åˆ†é…ç»™æ¯ä¸ªç½‘æ¡¥ï¼Œç”¨é€æ˜ç½‘æ¡¥åˆ™åªèƒ½ä½¿ç”¨ç”Ÿæˆæ ‘ï¼Œè€Œç”Ÿæˆæ ‘ä¸€èˆ¬å¹¶ä¸èƒ½ä¿è¯æ‰€ä½¿ç”¨çš„çš„è·¯ç”±æ˜¯æœ€ä½³çš„ï¼Œä¹Ÿä¸èƒ½åœ¨ä¸åŒçš„é“¾è·¯ä¸­è´Ÿè½½å‡è¡¡ã€‚</li>\n</ul>\n</li>\n<li>å¤šæ¥å£ç½‘æ¡¥ï¼šä»¥å¤ªç½‘äº¤æ¢æœºï¼ˆå®è´¨ä¸Šå°±æ˜¯æœ‰ä¸€ä¸ªå¤šæ¥å£çš„ç½‘æ¡¥ï¼‰å·¥ä½œåœ¨æ•°æ®é“¾è·¯å±‚ï¼Œæ¯ä¸ªæ¥å£éƒ½ç›´æ¥ä¸ä¸€ä¸ªå•ä¸ªä¸»æœºæˆ–å¦ä¸€ä¸ªé›†çº¿å™¨ç›¸è¿(æ™®é€šç½‘æ¡¥çš„æ¥å£å¾€å¾€è¿æ¥åˆ°ä»¥å¤ªç½‘çš„ä¸€ä¸ªç½‘æ®µ)ï¼Œå¹¶ä¸”ä¸€èˆ¬éƒ½å·¥ä½œåœ¨å…¨åŒå·¥æ–¹å¼ã€‚å½“ä¸»æœºéœ€è¦é€šä¿¡æ—¶ï¼Œäº¤æ¢æœºèƒ½åŒæ—¶è¿é€šè®¸å¤šå¯¹çš„æ¥å£ï¼Œä½¿æ¯ä¸€å¯¹äº’ç›¸é€šä¿¡çš„ä¸»æœºéƒ½èƒ½åƒç‹¬å ä¼ è¾“åª’ä½“é‚£ä¸ªæ ·ï¼Œæ— ç¢°æ’åœ°ä¼ è¾“æ•°æ®ã€‚ä¹Ÿæ˜¯ä¸€ç§å³æ’å³ç”¨è®¾å¤‡ï¼Œå†…éƒ¨è½¬å‘è¡¨ä¹Ÿæ˜¯é€šè¿‡è‡ªå­¦ä¹ ç®—æ³•é€æ¸å»ºç«‹èµ·æ¥ã€‚ä¸å­˜åœ¨ç¢°æ’é—®é¢˜ï¼Œå› ä¸ºäº¤æ¢æœºç«¯å£å’Œç½‘å¡çš„PHYï¼ˆMAUï¼‰æ¨¡å—ä»¥åŠMACæ¨¡å—ï¼Œå…¶å†…éƒ¨å‘é€çš„å’Œæ¥æ”¶çš„ç”µè·¯æ˜¯å„è‡ªç‹¬ç«‹çš„ï¼Œä¿¡å·ä¸ä¼šå‘ç”Ÿç¢°æ’ï¼Œåªè¦ä¸ä½¿ç”¨é›†çº¿å™¨ï¼Œå°±å¯ä»¥é¿å…ä¿¡å·ç¢°æ’äº†ï¼Œæ ¹æ®MACåœ°å€åˆ¤æ–­è½¬å‘ç›®æ ‡\n<ul>\n<li>äº¤æ¢æœºå†…éƒ¨æœ‰ä¸€å¼ MACåœ°å€ä¸ç½‘çº¿ç«¯å£çš„å¯¹åº”è¡¨ã€‚å½“æ”¶åˆ°åŒ…æ—¶ï¼Œä¼šå°†ç›¸åº”çš„ç«¯å£å·å’Œå‘é€æ–¹çš„MACåœ°å€å†™å…¥è¡¨ä¸­ï¼Œè¿™æ ·å°±å¯ä»¥æ ¹æ®åœ°å€åˆ¤æ–­å‡ºè¯¥è®¾å¤‡è¿æ¥åœ¨å“ªä¸ªç«¯å£ä¸Šäº†ã€‚äº¤æ¢æœºå°±æ˜¯æ ¹æ®è¿™äº›ä¿¡æ¯åˆ¤æ–­åº”è¯¥æŠŠåŒ…è½¬å‘åˆ°å“ªé‡Œçš„</li>\n<li>äº¤æ¢æœºç«¯å£çš„ MAC æ¨¡å—ä¸å…·æœ‰ MAC åœ°å€ã€‚äº¤æ¢æœºæ ¹æ® MAC åœ°å€è¡¨æŸ¥æ‰¾ MAC åœ°å€ï¼Œç„¶åå°†ä¿¡å·å‘é€åˆ°ç›¸åº”çš„ç«¯å£ã€‚</li>\n<li>MAC åœ°å€è¡¨çš„ç»´æŠ¤:ç¬¬ä¸€ç§æ˜¯æ”¶åˆ°åŒ…æ—¶ï¼Œå°†å‘é€æ–¹ MAC åœ°å€ä»¥åŠå…¶è¾“å…¥ç«¯å£çš„å·ç å†™å…¥ MAC åœ°å€è¡¨ä¸­ã€‚ç”±äºæ”¶åˆ°åŒ…çš„é‚£ä¸ªç«¯å£å°±è¿æ¥ç€å‘é€è¿™ä¸ªåŒ…çš„è®¾å¤‡ï¼Œæ‰€ä»¥åªè¦å°†è¿™ä¸ªåŒ…çš„å‘é€æ–¹ MAC åœ°å€å†™å…¥åœ°å€è¡¨ï¼Œä»¥åå½“æ”¶åˆ°å‘å¾€è¿™ä¸ªåœ°å€çš„åŒ…æ—¶ï¼Œäº¤æ¢æœºå°±å¯ä»¥å°†å®ƒè½¬å‘åˆ°æ­£ç¡®çš„ç«¯å£äº†ã€‚äº¤æ¢æœºæ¯æ¬¡æ”¶åˆ°åŒ…æ—¶éƒ½ä¼šæ‰§è¡Œè¿™ä¸ªæ“ä½œï¼Œå¦ä¸€ç§æ˜¯åˆ é™¤åœ°å€è¡¨ä¸­æŸæ¡è®°å½•çš„æ“ä½œï¼Œè¿™æ˜¯ä¸ºäº†é˜²æ­¢è®¾å¤‡ç§»åŠ¨æ—¶äº§ç”Ÿé—®é¢˜ã€‚åœ°å€è¡¨ä¸­çš„è®°å½•ä¸èƒ½æ°¸ä¹…æœ‰æ•ˆï¼Œè€Œæ˜¯è¦åœ¨ä¸€æ®µæ—¶é—´ä¸ä½¿ç”¨åå°±è‡ªåŠ¨åˆ é™¤ã€‚</li>\n<li>å½“äº¤æ¢æœºå‘ç°ä¸€ä¸ªåŒ…è¦å‘å›åˆ°åŸç«¯å£æ—¶ï¼Œå°±ä¼šç›´æ¥ä¸¢å¼ƒè¿™ä¸ªåŒ…ã€‚</li>\n<li>æ˜¯åœ°å€è¡¨ä¸­æ‰¾ä¸åˆ°æŒ‡å®šçš„ MAC åœ°å€ã€‚è¿™å¯èƒ½æ˜¯å› ä¸ºå…·æœ‰è¯¥åœ°å€çš„è®¾å¤‡è¿˜æ²¡æœ‰å‘äº¤æ¢æœºå‘é€è¿‡åŒ…ï¼Œæˆ–è€…è¿™ä¸ªè®¾å¤‡ä¸€æ®µæ—¶é—´æ²¡æœ‰å·¥ä½œå¯¼è‡´åœ°å€è¢«ä»åœ°å€è¡¨ä¸­åˆ é™¤äº†ã€‚è¿™ç§æƒ…å†µä¸‹ï¼Œäº¤æ¢æœºæ— æ³•åˆ¤æ–­åº”è¯¥æŠŠåŒ…è½¬å‘åˆ°å“ªä¸ªç«¯å£ï¼Œåªèƒ½å°†åŒ…è½¬å‘åˆ°é™¤äº†æºç«¯å£ä¹‹å¤–çš„æ‰€æœ‰ç«¯å£ä¸Šï¼Œæ— è®ºè¯¥è®¾å¤‡è¿æ¥åœ¨å“ªä¸ªç«¯å£ä¸Šéƒ½èƒ½æ”¶åˆ°è¿™ä¸ªåŒ…ã€‚è¿™æ ·åšä¸ä¼šäº§ç”Ÿä»€ä¹ˆé—®é¢˜ï¼Œå› ä¸ºä»¥å¤ªç½‘çš„è®¾è®¡æœ¬æ¥å°±æ˜¯å°†åŒ…å‘é€åˆ°æ•´ä¸ªç½‘ç»œçš„ï¼Œç„¶ååªæœ‰ç›¸åº”çš„æ¥æ”¶è€…æ‰æ¥æ”¶åŒ…ï¼Œè€Œå…¶ä»–è®¾å¤‡åˆ™ä¼šå¿½ç•¥è¿™ä¸ªåŒ…ã€‚</li>\n<li>å¦‚æœæ¥æ”¶æ–¹ MAC åœ°å€æ˜¯ä¸€ä¸ªå¹¿æ’­åœ°å€ ï¼Œé‚£ä¹ˆäº¤æ¢æœºä¼šå°†åŒ…å‘é€åˆ°é™¤æºç«¯å£ä¹‹å¤–çš„æ‰€æœ‰ç«¯å£</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>4. ç½‘ç»œå±‚</h1>\n<h2>4.1. IPä½“ç³»çš„ç½‘ç»œå±‚æä¾›çš„æœåŠ¡å’Œè™šæ‹Ÿäº’è¿ç½‘ç»œ</h2>\n<ul>\n<li>ç ”ç©¶åˆ†ç»„æ€ä¹ˆä»ä¸€ä¸ªç½‘ç»œé€šè¿‡è·¯ç”±å™¨è½¬å‘åˆ°å¦å¤–ä¸€ä¸ªç½‘ç»œ</li>\n<li>TCP/IPä½“ç³»çš„ç½‘ç»œå±‚å‘ä¸Šåªæä¾›ç®€å•çµæ´»çš„ã€æ— è¿æ¥çš„ï¼Œå°½é‡å¤§åŠªåŠ›äº¤ä»˜çš„æ•°æ®æŠ¥æœåŠ¡ã€‚ç½‘ç»œå‘é€åˆ†ç»„æ—¶ä¸éœ€è¦å…ˆå»ºç«‹è¿æ¥ã€‚æ¯ä¸€ä¸ªåˆ†ç»„ï¼ˆIPæ•°æ®æŠ¥ï¼‰ç‹¬ç«‹å‘é€ï¼Œä¸å…¶å‰åçš„åˆ†ç»„æ— å…³ï¼ˆä¸è¿›è¡Œç¼–å·ï¼‰ã€‚ç½‘ç»œå±‚ä¸æä¾›æœåŠ¡è´¨é‡çš„æ‰¿è¯ºã€‚æ‰€å‘é€çš„åˆ†ç»„å¯èƒ½å‡ºé”™ï¼Œä¸¢å¤±ï¼Œé‡å¤å’Œå¤±åºï¼Œä¹Ÿä¸ä¿è¯åˆ†ç»„äº¤ä»˜çš„æ—¶é™ã€‚</li>\n<li>äº’è”ç½‘æ˜¯å¯ä»¥ç”±å¤šç§å¼‚æ„ç½‘ç»œäº’è¿ç»„æˆã€‚å‚åŠ äº’è¿çš„è®¡ç®—æœºç½‘ç»œéƒ½ä½¿ç”¨ç›¸åŒçš„ç½‘é™…åè®®IPï¼Œå› æ­¤å¯ä»¥æŠŠäº’è¿ä»¥åçš„è®¡ç®—æœºç½‘ç»œçœ‹æˆä¸€ä¸ªè™šæ‹Ÿäº’è”ç½‘ç»œï¼Œç‰©ç†è®¾å¤‡é€šè¿‡ä½¿ç”¨IPåè®®,å±è”½äº†ç‰©ç†ç½‘ç»œä¹‹é—´çš„å·®å¼‚ï¼Œå°†ç½‘ç»œäº’ç›¸è¿æ¥èµ·æ¥è¦ä½¿ç”¨ä¸€äº›ä¸­é—´è®¾å¤‡\n<ul>\n<li>ç‰©ç†å±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšè½¬å‘å™¨ï¼ˆåŒä¸€ä¸ªç½‘ç»œï¼‰</li>\n<li>æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšç½‘æ¡¥æˆ–æ¡¥æ¥å™¨ï¼ˆåŒä¸€ä¸ªç½‘ç»œï¼‰</li>\n<li>ç½‘ç»œå±‚ä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšè·¯ç”±å™¨ï¼ˆè¿æ¥ä¸åŒç½‘ç»œï¼‰</li>\n<li>ç½‘ç»œå±‚ä»¥ä¸Šä½¿ç”¨çš„ä¸­é—´è®¾å¤‡å«åšç½‘å…³ã€‚ç”¨ç½‘å…³è¿æ¥ä¸¤ä¸ªä¸å…¼å®¹çš„ç³»ç»Ÿéœ€è¦åœ¨é«˜å±‚è¿›è¡Œåè®®çš„è½¬æ¢ï¼ˆè¿æ¥ä¸åŒç½‘ç»œï¼‰</li>\n</ul>\n</li>\n<li>è·¯ç”±å™¨æ ¹æ®ç›®æ ‡åœ°å€åˆ¤æ–­ä¸‹ä¸€ä¸ªè·¯ç”±å™¨çš„ä½ç½®ï¼ˆIPåè®®æ ¹æ®ç›®æ ‡åœ°å€åˆ¤æ–­ä¸‹ä¸€ä¸ªIPè½¬å‘è®¾å¤‡çš„ä½ç½®ï¼‰</li>\n<li>é›†çº¿å™¨å†å­ç½‘ä¸­å°†ç½‘ç»œåŒ…ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±ï¼ˆå­ç½‘ä¸­çš„ä»¥å¤ªç½‘åè®®å°†åŒ…ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªè½¬å‘è®¾å¤‡ï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/89ee1e096d0ac2a37d859.png\" alt=\"21.PNG\"></li>\n</ul>\n<h2>4.2. IPåœ°å€åŠå…¶ç¼–å€æ–¹æ³•ä¸‰ä¸ªé˜¶æ®µ</h2>\n<ul>\n<li>ipåœ°å€ï¼šå› ç‰¹ç½‘ä¸Šçš„æ¯ä¸ªä¸»æœºï¼ˆæˆ–è·¯ç”±å™¨ï¼‰çš„æ¯ä¸€ä¸ªæ¥å£åˆ†é…ä¸€ä¸ªåœ¨å…¨çƒå”¯ä¸€çš„32ä½æ ‡è¯†ç¬¦ã€‚ç”±å› ç‰¹ç½‘åå­—å’Œæ•°å­—åˆ†é…æœºæ„ICANNè¿›è¡Œåˆ†é…ï¼›ipåœ°å€ä¸ä»…ä»…æŒ‡æ˜äº†ä¸»æœºï¼Œè€Œä¸”æŒ‡æ˜äº†ä¸»æœºæ‰€è¿æ¥çš„ç½‘ç»œï¼ˆåœ¨æ•´ä¸ªå› ç‰¹ç½‘å†…å”¯ä¸€ï¼‰</li>\n<li>ipåœ°å€çš„ç‰¹ç‚¹ï¼š\n<ul>\n<li>æ¯ä¸€ä¸ªIPåœ°å€éƒ½ç”±ç½‘ç»œå·(å› ç‰¹ç½‘èŒƒå›´å†…å”¯ä¸€)å’Œä¸»æœºå·(ç½‘ç»œå·æ‰€æŒ‡æ˜çš„ç½‘ç»œèŒƒå›´å†…å”¯ä¸€)ä¸¤éƒ¨åˆ†ç»„æˆã€‚æ˜¯ä¸€ç§åˆ†ç­‰çº§çš„åœ°å€ç»“æ„ï¼ŒIPåœ°å€ç®¡ç†æœºæ„åœ¨åˆ†é…IPåœ°å€æ—¶åªåˆ†é…ç½‘ç»œå·ï¼Œè€Œå‰©ä¸‹çš„ä¸»æœºå·åˆ™ç”±å¾—åˆ°è¯¥ç½‘ç»œå·çš„å•ä½è‡ªè¡Œåˆ†é…ã€‚è¿™æ ·å°±æ–¹ä¾¿äº†IPåœ°å€çš„ç®¡ç†ã€‚è·¯ç”±å™¨ä»…æ ¹æ®ç›®çš„ä¸»æœºæ‰€è¿æ¥çš„ç½‘ç»œå·æ¥è½¬å‘åˆ†ç»„ï¼Œä½¿è·¯ç”±è¡¨ä¸­çš„é¡¹ç›®æ•°å¤§å¹…åº¦å‡å°‘ï¼Œä»è€Œå‡å°‘äº†è·¯ç”±è¡¨æ‰€å çš„å­˜å‚¨ç©ºé—´åŠæŸ¥æ‰¾çš„æ—¶é—´</li>\n<li>IPåœ°å€æ˜¯æ ‡å¿—ä¸»æœºï¼ˆæˆ–è·¯ç”±å™¨ï¼‰å’Œä¸€æ¡é“¾è·¯çš„æ¥å£ã€‚å½“ä¸€ä¸ªä¸»æœºåŒæ—¶è¿æ¥åˆ°ä¸¤ä¸ªç½‘ç»œä¸Šæ—¶ï¼Œå°±å¿…é¡»åŒæ—¶å…·æœ‰ä¸¤ä¸ªç›¸åº”çš„IPåœ°å€ï¼Œå…¶ç½‘ç»œå·å¿…é¡»æ˜¯ä¸åŒçš„ã€‚è¿™ç§ä¸»æœºç§°ä¸ºå¤šå½’å±ä¸»æœºã€‚ç”±äºä¸€ä¸ªè·¯ç”±å™¨è‡³å°‘åº”å½“è¿æ¥åˆ°ä¸¤ä¸ªç½‘ç»œï¼Œå› æ­¤ä¸€ä¸ªè·¯ç”±å™¨è‡³å°‘åº”å½“æœ‰ä¸¤ä¸ªä¸åŒçš„IPåœ°å€</li>\n<li>ä¸€ä¸ªç½‘ç»œæ˜¯æŒ‡å…·æœ‰ç›¸åŒç½‘ç»œå·çš„ä¸»æœºçš„é›†åˆã€‚ç”¨è½¬å‘å™¨æˆ–ç½‘æ¡¥è¿æ¥èµ·æ¥çš„è‹¥å¹²ä¸ªå±€åŸŸç½‘å…·æœ‰åŒæ ·çš„ç½‘ç»œå·.å…·æœ‰ä¸åŒç½‘ç»œå·çš„å±€åŸŸç½‘å¿…é¡»ä½¿ç”¨è·¯ç”±å™¨è¿›è¡Œäº’è¿</li>\n<li>ç‰©ç†åœ°å€æ˜¯æ•°æ®é“¾è·¯å±‚å’Œç‰©ç†å±‚ä½¿ç”¨çš„åœ°å€ï¼Œè€ŒIPåœ°å€æ˜¯ç½‘ç»œå±‚å’Œä»¥ä¸Šå„å±‚ä½¿ç”¨çš„é€»è¾‘åœ°å€ï¼ˆipåœ°å€ç”±è½¯ä»¶å®ç°ï¼‰</li>\n<li>ipåœ°å€æ”¾åœ¨ipæ•°æ®æŠ¥çš„é¦–éƒ¨ï¼Œè€Œç¡¬ä»¶åœ°å€åˆ™æ”¾åœ¨macå¸§çš„é¦–éƒ¨ã€‚åœ¨ç½‘ç»œå±‚ä»¥ä¸Šä½¿ç”¨çš„æ˜¯ipåœ°å€ï¼Œè€Œæ•°æ®é“¾è·¯å±‚åŠä»¥ä¸‹ä½¿ç”¨çš„æ˜¯ç¡¬ä»¶åœ°å€</li>\n</ul>\n</li>\n<li>ipåœ°å€çš„ç¼–å€æ–¹æ³•å…±ç»å†ä¸‰ä¸ªå†å²é˜¶æ®µï¼š\n<ul>\n<li>åˆ†ç±»çš„ipåœ°å€ï¼šç”±ç½‘ç»œå·å’Œä¸»æœºå·ç»„æˆï¼ŒAã€Bã€Cç±»åœ°å€éƒ½æ˜¯å•æ’­åœ°å€ï¼ˆä¸€å¯¹ä¸€é€šä¿¡ï¼‰ï¼Œä¸€ç§åˆ†ç­‰çº§çš„åœ°å€ç»“æ„<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/49b9deb5b0584458f6ed5.png\" alt=\"9.png\">\n<ul>\n<li>Aç±»åœ°å€:å•æ’­åœ°å€ï¼ˆ2^31ä¸ªåœ°å€ï¼‰\n<ul>\n<li>ç½‘ç»œå·1ä¸ªå­—èŠ‚ï¼Œï¼ˆç±»åˆ«ä½ï¼‰ç¬¬ä¸€ä½ä¸º0ï¼Œç½‘ç»œå·æ•°2^7-2ã€‚127ä½œä¸ºæœ¬åœ°è½¯ä»¶ç¯å›æµ‹è¯•(loopback test)æœ¬ä¸»æœºçš„è¿›ç¨‹ä¹‹é—´çš„é€šä¿¡ä¹‹ç”¨ã€‚å…¨0ä¿ç•™åœ°å€ï¼Œè¡¨ç¤ºæœ¬ç½‘ç»œ</li>\n<li>ä¸»æœºå·3ä¸ªå­—èŠ‚ï¼Œä¸»æœºæ•°2^24-2ã€‚å…¨0è¡¨ç¤ºâ€œæœ¬ä¸»æœºâ€æ‰€è¿æ¥åˆ°çš„å•ä¸ªç½‘ç»œåœ°å€ï¼Œè€Œå…¨1è¡¨ç¤ºè¯¥ç½‘ç»œä¸Šçš„æ‰€æœ‰ä¸»æœºï¼ˆå¹¿æ’­åœ°å€ï¼‰</li>\n</ul>\n</li>\n<li>Bç±»åœ°å€:å•æ’­åœ°å€ï¼ˆ2^30ä¸ªåœ°å€ï¼‰\n<ul>\n<li>ç½‘ç»œå·2ä¸ªå­—èŠ‚ï¼Œå‰ä¸¤ä½ä¸º10ï¼Œç½‘ç»œå·æ•°2^14-1ã€‚128.0.0.0ä¸æŒ‡æ´¾</li>\n<li>ä¸»æœºå·2ä¸ªå­—èŠ‚ï¼Œæœ€å¤§ä¸»æœºæ•°æ˜¯2^16-2ï¼ˆå‡å»å…¨0å’Œå…¨1çš„ä¸»æœºå·ï¼‰ã€‚</li>\n</ul>\n</li>\n<li>Cç±»åœ°å€:å•æ’­åœ°å€ï¼ˆ2^29ä¸ªåœ°å€ï¼‰\n<ul>\n<li>ç½‘ç»œå·3ä¸ªå­—èŠ‚ï¼Œå‰ä¸‰ä½ä¸º110ï¼Œç½‘ç»œå·æ•°ï¼ˆ2^21-1ï¼‰ã€‚192.0.0.0ä¸æŒ‡æ´¾</li>\n<li>ä¸»æœºå·1ä¸ªå­—èŠ‚ï¼Œæœ€å¤§ä¸»æœºæ•°æ˜¯2^8-2ã€‚ï¼ˆå‡å»å…¨0å’Œå…¨1çš„ä¸»æœºå·ï¼‰ã€‚</li>\n</ul>\n</li>\n<li>Dç±»åœ°å€:å¤šæ’­åœ°å€ï¼šç½‘ç»œå·æ ˆ4ä¸ªå­—èŠ‚ï¼Œå‰å››ä½ä¸º1110</li>\n<li>Eç±»åœ°å€ï¼šå‰4ä½1111ï¼Œä¿ç•™ä»¥åç”¨<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3c75de06024e9ff9efed9.png\" alt=\"22.PNG\"></li>\n</ul>\n</li>\n<li>åˆ’åˆ†å­ç½‘\n<ul>\n<li>ä¸¤çº§IPåœ°å€å¼Šç«¯ï¼šIPåœ°å€ç©ºé—´çš„åˆ©ç”¨ç‡æœ‰æ—¶å¾ˆä½ã€ä¸çµæ´»ï¼Œä¸èƒ½éšæ—¶çµæ´»å¢åŠ æŸå•ä½ç½‘ç»œï¼Œç»™æ¯ä¸€ä¸ªç‰©ç†ç½‘ç»œåˆ†é…ä¸€ä¸ªç½‘ç»œå·ä¼šä½¿è·¯ç”±è¡¨å˜å¾—å¤ªå¤§å› è€Œä½¿ç½‘ç»œæ€§èƒ½å˜åã€‚</li>\n<li>åˆ’åˆ†å­ç½‘ï¼šIPåœ°å€ä¸­å¢åŠ äº†ä¸€ä¸ªâ€œå­ç½‘å·å­—æ®µâ€ã€‚ä½¿ä¸¤çº§IPåœ°å€å˜æˆä¸‰çº§IPåœ°å€ã€‚\n<ul>\n<li>ç‰©ç†ç½‘ç»œåˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªå­ç½‘åå¯¹å¤–ä»ç„¶è¡¨ç°ä¸ºä¸€ä¸ªæ²¡æœ‰åˆ’åˆ†å­ç½‘çš„ç½‘ç»œã€‚</li>\n<li>ç½‘ç»œçš„ä¸»æœºå·å‡å°‘äº†è‹¥å¹²ä½ä½œä¸ºå­ç½‘å·ã€‚ IPåœ°å€={&lt;ç½‘ç»œå·&gt;,&lt;å­ç½‘å·&gt;,&lt;ä¸»æœºå·&gt;}</li>\n<li>å‡¡æ˜¯ä»å…¶ä»–ç½‘ç»œå‘é€ç»™æœ¬å•ä½æŸä¸ªä¸»æœºçš„IPæ•°æ®æŠ¥ï¼Œä»ç„¶æ˜¯æ ¹æ®IPæ•°æ®æŠ¥çš„ç›®çš„ç½‘ç»œå·æ‰¾åˆ°è¿æ¥åœ¨æœ¬å•ä½ç½‘ç»œä¸Šçš„è·¯ç”±å™¨ã€‚æœ¬å•ä½ç½‘ç»œä¸Šçš„è·¯ç”±å™¨æ¥æ”¶äº†æ•°æ®æŠ¥ä¹‹åï¼ŒæŒ‰ç…§ç›®çš„ç½‘ç»œå·å’Œå­ç½‘å·æ‰¾åˆ°ç›®çš„ç½‘ç»œçš„å­ç½‘ï¼Œå°†IPæ•°æ®æŠ¥äº¤ä»˜ç»™ç›®çš„ä¸»æœºã€‚</li>\n</ul>\n</li>\n<li>å­ç½‘æ©ç \n<ul>\n<li>å­ç½‘æ©ç ï¼Œ32ä½ï¼Œä¸€èˆ¬æ˜¯ç”±å…¨1å’Œå…¨0ç»„æˆï¼Œå…¨1éƒ¨åˆ†åŒ…æ‹¬äº†ç½‘ç»œå·å’Œå­ç½‘å·ï¼Œå…¨0éƒ¨åˆ†åŒ…æ‹¬äº†ä¸»æœºå·ã€‚å­ç½‘æ©ç å’ŒIPåœ°å€çš„äºŒè¿›åˆ¶æ•°å­—é€ä½ç›¸â€œä¸â€ï¼ˆå…¨1å¾—1ï¼Œå…¶ä»–ä¸º0ï¼‰ã€‚å°±å¯ä»¥å¾—åˆ°å­ç½‘ç½‘ç»œåœ°å€ã€‚Aç±»åœ°å€255.0.0.0ã€Bç±»åœ°å€255.255.0.0ã€cç±»åœ°å€255.255.255.0ï¼Œå­ç½‘æ©ç ä¸ºäº†æ›´ä¾¿äºæŸ¥æ‰¾è·¯ç”±è¡¨ï¼ŒåŒºåˆ†ipåœ°å€ç§ç±»</li>\n<li>ä¸»æœºå·éƒ¨åˆ†å…¨ä¸º0ä»£è¡¨æ•´ä¸ªå­ç½‘ï¼Œå…¨1ä»£è¡¨å‘å­ç½‘ä¸Šæ‰€æœ‰è®¾å¤‡å‘é€åŒ…ï¼ˆå¹¿æ’­ï¼‰</li>\n<li>è‹¥ä¸€ä¸ªè·¯ç”±å™¨è¿æ¥åœ¨ä¸¤ä¸ªå­ç½‘ä¸Šå°±æ‹¥æœ‰ä¸¤ä¸ªç½‘ç»œåœ°å€å’Œä¸¤ä¸ªå­ç½‘æ©ç </li>\n</ul>\n</li>\n<li>ä½¿ç”¨å­ç½‘åˆ†ç»„çš„è½¬å‘\n<ul>\n<li>ä½¿ç”¨å­ç½‘åˆ’åˆ†åï¼Œè·¯ç”±è¡¨å¿…é¡»åŒ…å«ç›®çš„ç½‘ç»œåœ°å€ï¼Œå­ç½‘æ©ç å’Œä¸‹ä¸€è·³åœ°å€ã€‚è·¯ç”±å™¨è½¬å‘åˆ†ç»„çš„ç®—æ³•ï¼ˆæµç¨‹ï¼‰å¦‚ä¸‹ï¼š\n<ul>\n<li>1ï¼‰ä»æ”¶åˆ°çš„æ•°æ®æŠ¥é¦–éƒ¨æå–ç›®çš„IPåœ°å€D</li>\n<li>2ï¼‰å…ˆåˆ¤æ–­æ˜¯å¦ä¸ºç›´æ¥äº¤ä»˜ã€‚å¯¹è·¯ç”±å™¨ç›´æ¥ç›¸è¿çš„ç½‘ç»œè¿›è¡Œé€ä¸ªæ£€æŸ¥ï¼šç”¨å„ç½‘ç»œçš„å­ç½‘æ©ç å’ŒDé€ä½ç›¸ä¸,çœ‹ç»“æœæ˜¯å¦å’Œç›¸å¯¹åº”çš„ç›®çš„ç½‘ç»œåœ°å€åŒ¹é…ã€‚è‹¥åŒ¹é…ï¼Œåˆ™æŠŠåˆ†ç»„è¿›è¡Œç›´æ¥äº¤ä»˜ï¼Œè½¬å‘ä»»åŠ¡ç»“æŸã€‚å¦åˆ™å°±æ˜¯é—´æ¥äº¤ä»˜ï¼Œæ‰§è¡Œï¼ˆ3ï¼‰ã€‚</li>\n<li>3ï¼‰è‹¥è·¯ç”±è¡¨ä¸­æœ‰ç›®çš„åœ°å€ä¸ºDçš„ç‰¹å®šä¸»æœºè·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±ï¼šå¦åˆ™æ‰§è¡Œï¼ˆ4ï¼‰ã€‚</li>\n<li>4ï¼‰å¯¹è·¯ç”±è¡¨çš„æ¯ä¸€è¡Œï¼Œç”¨å…¶ä¸­çš„å­ç½‘æ©ç å’ŒDé€ä½ç›¸ä¸ï¼Œå…¶ç»“æœä¸ºNä¸è¯¥è¡Œçš„ç›®çš„ç½‘ç»œåœ°å€åŒ¹é…ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›å¦åˆ™æ‰§è¡Œï¼ˆ5ï¼‰ã€‚</li>\n<li>5ï¼‰è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„é»˜è®¤è·¯ç”±å™¨ï¼›å¦åˆ™æ‰§è¡Œï¼ˆ6ï¼‰ã€‚</li>\n<li>6ï¼‰æŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>æ— åˆ†ç±»åŸŸé—´è·¯ç”±é€‰æ‹©CIDR(Classless Inter-Domain Routing)æ„æˆè¶…ç½‘ï¼ˆIPV4åœ°å€è€—å°½ï¼‰\n<ul>\n<li>32ä½çš„IPåœ°å€åˆ†ä¸ºç½‘ç»œå‰ç¼€å’Œä¸»æœºå¥½ä¸¤éƒ¨åˆ†:CIDRä½¿ç”¨CIDRè®¡æ³•, åœ¨ipåœ°å€åé¢åŠ ä¸Š/ å†™ä¸Šç½‘ç»œå‰ç¼€çš„ä½æ•°</li>\n<li>CIDRæŠŠç½‘ç»œå‰ç¼€ç›¸åŒçš„è¿ç»­ipåœ°å€ç»„æˆä¸€ä¸ªCIDRåœ°å€å—/è¶…ç½‘.åªè¦çŸ¥é“CIDRåœ°å€å—ä¸­çš„ä»»ä½•ä¸€ä¸ªåœ°å€ï¼Œå°±å¯ä»¥çŸ¥é“è¿™ä¸ªåœ°å€å—çš„èµ·å§‹åœ°å€ï¼ˆä¸»æœºå…¨0ï¼‰å’Œæœ€å¤§åœ°å€ï¼ˆä¸»æœºå…¨1ï¼‰ï¼Œä»¥åŠåœ°å€å—ä¸­çš„åœ°å€æ•°ã€‚ç”±äºä¸€ä¸ªCIDRåœ°å€ä¸­æœ‰å¾ˆå¤šåœ°å€ï¼Œæ‰€æœ‰åœ¨è·¯ç”±è¡¨ä¸­å°±åˆ©ç”¨CIDRåœ°å€æ¥æŸ¥æ‰¾ç›®çš„ç½‘ç»œã€‚è¿™ç§åœ°å€çš„èšåˆå¸¸ç§°ä¸ºè·¯ç”±èšåˆï¼Œä½¿å¾—è·¯ç”±è¡¨ä¸­çš„ä¸€ä¸ªé¡¹ç›®å¯ä»¥è¡¨ç¤ºåŸæ¥ä¼ ç»Ÿåˆ†ç±»åœ°å€çš„å¤šä¸ªï¼Œè·¯ç”±èšåˆä¹Ÿç§°ä¸ºæ„æˆè¶…ç½‘</li>\n<li>32ä½å­ç½‘æ©ç ï¼šæ–œçº¿è®¡æ³•ä¸­ï¼Œæ–œçº¿åé¢çš„æ•°å­—å°±æ˜¯åœ°å€æ©ç ä¸­1çš„ä¸ªæ•°ï¼Œåé¢å…¨éƒ¨æ˜¯0ï¼Œ</li>\n<li>å‰ç¼€æœ€é•¿åŒ¹é…ï¼šåœ¨CIDRä¸­è·¯ç”±è¡¨ä¸­æ¯ä¸€ä¸ªé¡¹ç›®åŒ…æ‹¬äº†ç½‘ç»œå‰ç¼€å’Œä¸‹ä¸€æ¡çš„åœ°å€.è·¯ç”±é€‰æ‹©ç½‘ç»œå‰ç¼€æœ€é•¿çš„è·¯ç”±.</li>\n<li>äºŒå‰çº¿ç´¢æŸ¥æ‰¾è·¯ç”±è¡¨ï¼šåœ¨å‰ç¼€æœ€é•¿åŒ¹é…ç®—æ³•ä¸­,ç”¨äºŒå‰æ ‘çš„æ•°æ®ç»“æ„è¿›è¡Œç»„ç»‡æé«˜æŸ¥æ‰¾é€Ÿåº¦ï¼Œå…ˆä»IPåœ°å€ä¸­æ‰¾å‡ºå„ä¸ªIPåœ°å€ä¸­å”¯ä¸€çš„å‰ç¼€, ç„¶åé€šè¿‡å”¯ä¸€çš„å‰ç¼€æ„æˆäºŒå‰æ ‘, å…¶ä¸­äºŒå‰æ ‘çš„å·¦å­©å­æ˜¯å¯¹åº”çš„å€¼ä¸º0, å³å­©å­å€¼ä¸º1</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>4.3. ipæ•°æ®æŠ¥(ç½‘ç»œå±‚åè®®æ•°æ®å•å…ƒ)</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7db126fcc82bce692b2e6.png\" alt=\"13.png\" tabindex=\"0\"><figcaption>13.png</figcaption></figure>\n<ul>\n<li>IPæ•°æ®æŠ¥ï¼š32ä½ï¼ˆ4å­—èŠ‚ï¼‰ã€‚ä¸€ä¸ªIPæ•°æ®æŠ¥ç”±å›ºå®šé•¿åº¦20å­—èŠ‚çš„é¦–éƒ¨å’Œé•¿åº¦å¯å˜æ•°æ®ä¸¤éƒ¨åˆ†ç»„æˆã€‚\n<ul>\n<li>ç‰ˆæœ¬ï¼šå 4ä½ï¼ŒIPåè®®ç‰ˆæœ¬ã€‚é€šä¿¡åŒæ–¹ä½¿ç”¨çš„IPåè®®çš„ç‰ˆæœ¬å¿…é¡»ä¸€è‡´ã€‚ç›®å‰å¹¿æ³›ä½¿ç”¨çš„IPåè®®ç‰ˆæœ¬å·ä¸ºIPv4ã€‚</li>\n<li>é¦–éƒ¨é•¿åº¦ï¼šå 4ä½ï¼Œè¡¨ç¤º5-15ï¼Œå•ä½32ä½å­—(4å­—èŠ‚)ï¼Œ20-60å­—èŠ‚ã€‚å¦‚æœIPæ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ä¸æ˜¯4å­—èŠ‚çš„æ•´æ•°å€æ—¶ï¼Œå¿…é¡»åˆ©ç”¨æœ€åçš„å¡«å……å­—æ®µåŠ ä»¥å¡«å……</li>\n<li>åŒºåˆ†æœåŠ¡ã€‚å 8ä½ï¼Œç”¨æ¥è·å¾—æ›´å¥½çš„æœåŠ¡ã€‚è¿™ä¸ªå­—æ®µåŸæ¥å«åšæœåŠ¡ç±»å‹ï¼Œä½†å®é™…ä¸€ç›´æ²¡äººç”¨ã€‚</li>\n<li>æ€»é•¿åº¦ã€‚é¦–éƒ¨å’Œæ•°æ®ä¹‹å’Œçš„é•¿åº¦ï¼Œ16ä½ï¼Œå•ä½å­—èŠ‚ã€‚æœ€å¤§æ€»é•¿åº¦2^16-1ã€‚IPæ•°æ®æŠ¥çš„æ€»é•¿åº¦å¦‚æœå¤§äºæ•°æ®é“¾è·¯å±‚çš„MTUï¼ˆæœ€å¤§ä¼ é€å•å…ƒ1500å­—èŠ‚ï¼‰ éœ€è¦è¿›è¡Œåˆ†ç‰‡å¤„ç†ã€‚IPåè®®è§„å®šï¼Œå› ç‰¹ç½‘ä¸­æ‰€æœ‰ä¸»æœºå’Œè·¯ç”±å™¨ï¼Œå¿…é¡»èƒ½å¤Ÿæ¥å—é•¿åº¦ä¸è¶…è¿‡576å­—èŠ‚çš„æ•°æ®æŠ¥ã€‚åœ¨åˆ†ç‰‡æ—¶ï¼Œæ•°æ®æŠ¥é¦–éƒ¨ä¸­çš„æ€»é•¿åº¦å­—æ®µæ˜¯æŒ‡åˆ†ç‰‡åçš„æ¯ä¸€ä¸ªåˆ†ç‰‡çš„é¦–éƒ¨é•¿åº¦ä¸è¯¥åˆ†ç‰‡çš„æ•°æ®é•¿åº¦æ€»å’Œ</li>\n<li>æ ‡è¯†(identification)ï¼šå 16ä½ã€‚IPè½¯ä»¶åœ¨å­˜å‚¨å™¨ä¸­ç»´æŒä¸€ä¸ªè®¡æ•°å™¨ï¼Œæ¯äº§ç”Ÿä¸€ä¸ªæ•°æ®æŠ¥ï¼Œæ ‡è¯†çš„è®¡æ•°å™¨å°±ä¼šåŠ 1ï¼Œç›¸åŒçš„æ ‡è¯†å­—æ®µå€¼ä½¿åˆ†ç‰‡åçš„å„æ•°æ®æŠ¥ç‰‡æœ€åèƒ½æ­£ç¡®å¾—é‡è£…æˆåŸæ¥çš„æ•°æ®æŠ¥</li>\n<li>æ ‡å¿—(flag)ï¼šå 3ä½ï¼Œä½†ç›®å‰åªæœ‰ä¸¤ä½æœ‰æ„ä¹‰ã€‚æœ€ä½ä½è®°ä¸ºMF(More Fragment)MF=1è¡¨ç¤ºåé¢â€œè¿˜æœ‰åˆ†ç‰‡â€çš„æ•°æ®æŠ¥ã€‚MF=0è¡¨ç¤ºä¸ºæœ€åä¸€ä½ã€‚ä¸­é—´ä¸€ä½è®°ä¸ºDF(Don't Flagment)è®°ä¸ºä¸èƒ½åˆ†ç‰‡ã€‚åªæœ‰å½“DF=0æ—¶æ‰å…è®¸åˆ†ç‰‡ã€‚</li>\n<li>ç‰‡åç§»ï¼šå 13ä½ã€‚ç‰‡åç§»æŒ‡å‡ºï¼šè¾ƒé•¿çš„åˆ†ç»„åœ¨åˆ†ç‰‡åï¼ŒæŸç‰‡åœ¨åŸåˆ†ç»„ä¸­çš„ç›¸å¯¹ä½ç½®ã€‚ä»¥8å­—èŠ‚ä¸ºå•ä½ï¼Œä¹Ÿå°±æ˜¯æ¯ä¸ªåˆ†ç‰‡çš„é•¿åº¦ä¸€å®šæ˜¯8å­—èŠ‚çš„æ•´æ•°å€ã€‚æ ‡è¯†=å­—èŠ‚åºå·é™¤ä»¥8ã€‚</li>\n<li>ç”Ÿå­˜æ—¶é—´TTLï¼šå 8ä½ï¼Œå•ä½è·³æ•°ï¼Œ0-255ï¼Œæ•°æ®æŠ¥åœ¨å› ç‰¹ç½‘ä¸­è‡³å¤šå¯ä»¥ç»è¿‡å¤šå°‘ä¸ªè·¯ç”±å™¨ï¼Œç”±å‘å‡ºæ•°æ®æŠ¥æºç‚¹è®¾ç½®è¿™ä¸ªå­—æ®µã€‚é˜²æ­¢æ— æ³•äº¤ä»˜çš„æ•°æ®åœ¨ç½‘ç»œä¸­å…œåœˆå­ã€‚æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±å™¨å°±å‡1ã€‚å½“TTLä¸º0æ—¶å°±ä¸¢æ‰è¿™ä¸ªæ•°æ®æŠ¥ã€‚</li>\n<li>åè®® å 8ä½ã€‚æŒ‡å‡ºæ­¤æ•°æ®æŠ¥æºå¸¦çš„æ•°æ®æ˜¯ä½¿ç”¨å“ªç§åè®®ï¼Œä»¥ä¾¿ç›®çš„ä¸»æœºIPå±‚çŸ¥é“å°†æ•°æ®ä¸Šäº¤ç»™é‚£ä¸ªå¤„ç†è¿‡ç¨‹,TCP<br>\n06,UDP17,ICMP01</li>\n<li>é¦–éƒ¨æ£€éªŒå’Œ å 16ä½ã€‚åªæ£€éªŒæ•°æ®æŠ¥çš„é¦–éƒ¨ã€‚æ•°æ®æŠ¥æ¯ç»è¿‡ä¸€ä¸ªè·¯ç”±ï¼Œè·¯ç”±å™¨éƒ½è¦ä»æ–°è®¡ç®—ä¸€ä¸‹é¦–éƒ¨æ£€éªŒå’Œï¼ˆä¸€äº›å­—æ®µï¼Œå¦‚ç”Ÿå­˜æ—¶é—´ã€æ ‡å¿—ã€ç‰‡åç§»ç­‰éƒ½å¯èƒ½å‘ç”Ÿå˜åŒ–ï¼‰ã€‚åœ¨å‘é€æ–¹ï¼Œå…ˆæŠŠIPæ•°æ®æŠ¥é¦–éƒ¨åˆ’åˆ†ä¸ºè®¸å¤š16ä½å­—çš„åºåˆ—ï¼Œå¹¶æŠŠæ ¡éªŒå’Œå­—æ®µè®¾ç½®é›¶ã€‚ç”¨åç ç®—æœ¯è¿ç®—æŠŠæ‰€æœ‰16ä½å­—ç›¸åŠ åï¼Œå°†å¾—åˆ°çš„å’Œçš„åç å†™å…¥æ£€éªŒå’Œå­—æ®µã€‚æ¥æ”¶æ–¹æ”¶åˆ°æ•°æ®æŠ¥åï¼Œå°†é¦–éƒ¨çš„æ‰€æœ‰16ä½å­—å†ç”¨åç ç®—æœ¯è¿ç®—ç›¸åŠ ä¸€æ¬¡ã€‚å°†å¾—åˆ°çš„å’Œå–åç ï¼Œå³å¾—å‡ºæ¥æ”¶æ–¹æ ¡éªŒå’Œçš„è®¡ç®—ç»“æœï¼Œè‹¥é¦–éƒ¨æœªå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œç»“æœå¿…ä¸º0ï¼Œå¦åˆ™ä¸¢å¼ƒæ•°æ®æŠ¥</li>\n<li>æºåœ°å€ å 32ä½</li>\n<li>ç›®çš„åœ°å€ å 32ä½</li>\n<li>IPæ•°æ®æŠ¥é¦–éƒ¨çš„å¯å˜éƒ¨åˆ†ï¼ˆå¾ˆå°‘ä½¿ç”¨ï¼‰ï¼šä¸€ä¸ªé€‰é¡¹å­—æ®µï¼Œç”¨æ¥æ”¯æŒæ’é”™ã€æµ‹é‡ä»¥åŠå®‰å…¨ç­‰æªæ–½ï¼Œå†…å®¹ä¸°å¯Œï¼Œæ­¤å­—æ®µçš„é•¿åº¦å¯å˜ï¼Œä»1-40å­—èŠ‚ä¸ç­‰ï¼Œå–å†³äºæ‰€é€‰æ‹©çš„é¡¹ç›®</li>\n</ul>\n</li>\n<li>ipå±‚åˆ†ç»„è½¬å‘çš„æµç¨‹\n<ul>\n<li>è·¯ç”±è¡¨æŒ‰ä¸»æœºçš„ç½‘ç»œåœ°å€æ¥åˆ¶ä½œï¼Œåœ¨è·¯ç”±è¡¨ä¸­æ¯ä¸€æ¡è·¯ç”±æœ€ä¸»è¦çš„æ˜¯ä¸€ä¸‹ä¸¤ä¸ªä¿¡æ¯ï¼šç›®çš„ç½‘ç»œåœ°å€ï¼Œä¸‹ä¸€è·³åœ°å€ã€‚ï¼ˆå¯ä»¥ç”¨route printæŸ¥çœ‹è·¯ç”±è¡¨ã€‚Interface åˆ—ï¼Œè¡¨ç¤ºç½‘å¡ç­‰ç½‘ç»œæ¥å£ï¼Œè¿™äº›ç½‘ç»œæ¥å£å¯ä»¥å°†åŒ…å‘é€ç»™é€šä¿¡å¯¹è±¡ï¼ŒGateway åˆ—è¡¨ç¤ºä¸‹ä¸€ä¸ªè·¯ç”±å™¨çš„ IP åœ°å€ï¼Œå°†åŒ…å‘ç»™è¿™ä¸ª IP åœ°å€ï¼Œè¯¥åœ°å€å¯¹åº”çš„è·¯ç”±å™¨ å°±ä¼šå°†åŒ…è½¬å‘åˆ°ç›®æ ‡åœ°å€ã€‚å¦‚æœ Gateway å’Œ Interface åˆ—çš„ IP åœ°å€ç›¸åŒï¼Œå°±è¡¨ç¤ºä¸éœ€è¦è·¯ç”±å™¨è¿›è¡Œè½¬å‘ï¼Œå¯ä»¥ç›´æ¥å°†åŒ…å‘ç»™æ¥æ”¶æ–¹çš„ IP åœ°å€ã€‚Metricè¡¨ç¤ºé€šè¿‡è¿™æ¡è·¯ç”±ä¼ è¾“åŒ…çš„æˆæœ¬ï¼Œè¶Šå°è¯´æ˜è·ç¦»è¶Šè¿‘ã€‚è·¯ç”±è¡¨çš„ç¬¬ 1 è¡Œä¸­ï¼Œç›®æ ‡åœ°å€å’Œå­ç½‘æ©ç  éƒ½æ˜¯ 0.0.0.0ï¼Œè¿™è¡¨ç¤ºé»˜è®¤ç½‘å…³ï¼Œå¦‚æœå…¶ä»–æ‰€æœ‰æ¡ç›®éƒ½æ— æ³•åŒ¹é…ï¼Œå°±ä¼šè‡ªåŠ¨åŒ¹é…è¿™ä¸€è¡Œï¼‰ã€‚è·¯ç”±è¡¨çš„å­ç½‘æ©ç åˆ—å€¼è¡¨ç¤ºåœ¨åŒ¹é…ç½‘ç»œç›®æ ‡åœ°å€æ—¶éœ€è¦å¯¹æ¯”çš„æ¯”ç‰¹æ•°é‡ï¼ˆè·¯ç”±èšåˆï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/7513ea41a9cf0dde6f01c.png\" alt=\"47.PNG\"></li>\n<li>å› ç‰¹ç½‘æ‰€æœ‰çš„åˆ†ç»„è½¬å‘éƒ½æ˜¯åŸºäºç›®çš„ä¸»æœºæ‰€åœ¨çš„ç½‘ç»œã€‚IPæ•°æ®æŠ¥æœ€ç»ˆå¯ä»¥æ‰¾åˆ°ç›®çš„ä¸»æœºæ‰€åœ¨çš„ç½‘ç»œä¸Šçš„è·¯ç”±å™¨ï¼ˆå¯èƒ½è¦é€šè¿‡å¤šæ¬¡é—´æ¥äº¤ä»˜ï¼‰ã€‚åªæœ‰åˆ°è¾¾æœ€åä¸€ä¸ªè·¯ç”±å™¨æ—¶ï¼Œæ‰è¯•å›¾å‘ç›®çš„ä¸»æœºå¯¹æ•°æ®æŠ¥çš„ç›´æ¥äº¤ä»˜</li>\n<li>ç‰¹å®šä¸»æœºè·¯ç”±ï¼šå¯¹ç‰¹å®šçš„ç›®çš„ä¸»æœºæŒ‡æ˜ä¸€ä¸ªè·¯ç”±ã€‚æœ‰åˆ©äºå¯¹ç½‘ç»œçš„è¿æ¥æˆ–è·¯ç”±è¡¨è¿›è¡Œæ’é”™</li>\n<li>é»˜è®¤è·¯ç”±ï¼ˆ0.0.0.0ï¼‰ï¼šå‡å°‘è·¯ç”±è¡¨æ‰€å ç”¨çš„ç©ºé—´å’Œæœç´¢è·¯ç”±è¡¨æ‰€ç”¨çš„æ—¶é—´ã€‚æ‰¾ä¸åˆ°åŒ¹é…è·¯ç”±æ—¶é€‰æ‹©é»˜è®¤è·¯ç”±ã€‚åªè¦å°†å­ç½‘æ©ç è®¾ç½®ä¸º 0.0.0.0ï¼Œé‚£ä¹ˆæ— è®ºä»»ä½•åœ°å€éƒ½èƒ½åŒ¹é…åˆ°è¿™ä¸€æ¡è®°å½•ï¼Œè¿™æ ·å°±ä¸ä¼šå‘ç”Ÿä¸çŸ¥é“è¦è½¬å‘åˆ°å“ªé‡Œçš„é—®é¢˜äº†</li>\n<li>å¾…è½¬å‘çš„æ•°æ®æŠ¥æ€ä¹ˆæ‰¾åˆ°ä¸‹ä¸€è·³çš„è·¯ç”±å™¨ï¼Ÿ\n<ul>\n<li>å½“è·¯ç”±å™¨æ”¶åˆ°ä¸€ä¸ªå¾…è½¬å‘çš„æ•°æ®æŠ¥ï¼Œåœ¨ä»è·¯ç”±è¡¨å¾—å‡ºä¸‹ä¸€è·³è·¯ç”±å™¨çš„IPåœ°å€åäº¤é€æ•°æ®é“¾è·¯å±‚çš„ç½‘ç»œæ¥å£è½¯ä»¶ã€‚æŠŠä¸‹ä¸€è·³çš„è·¯ç”±å™¨çš„IPåœ°å€è½¬æ¢æˆç¡¬ä»¶åœ°å€ï¼ˆARPï¼‰ï¼Œå¹¶æ”¾åœ¨é“¾è·¯å±‚çš„MACå¸§çš„é¦–éƒ¨å¹¶æ ¹æ®è¿™ä¸ªç¡¬ä»¶åœ°å€æ‰¾åˆ°ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚å½“å‘é€ä¸€è¿ä¸²æ•°æ®æŠ¥æ—¶ï¼Œä¸Šè¿°çš„è¿™ç§æŸ¥æ‰¾è·¯ç”±è¡¨ã€è®¡ç®—ç¡¬ä»¶åœ°å€ã€å†™å…¥MACå¸§çš„é¦–éƒ¨ç­‰è¿‡ç¨‹ï¼Œå°†ä¸æ–­é‡å¤è¿›è¡Œï¼Œé€ æˆä¸€å®šå¼€é”€</li>\n</ul>\n</li>\n<li>åˆ†ç»„è½¬å‘ç®—æ³•\n<ul>\n<li>1ï¼‰ä»æ•°æ®æŠ¥çš„é¦–éƒ¨æå–ç›®çš„ä¸»æœºçš„IPåœ°å€Dï¼Œå¾—å‡ºç›®çš„ç½‘ç»œåœ°å€ä¸ºNã€‚</li>\n<li>2ï¼‰è‹¥Nå°±æ˜¯äºæ­¤è·¯ç”±ç›´æ¥ç›¸è¿çš„æŸä¸ªç½‘ç»œåœ°å€ï¼Œåˆ™è¿›è¡Œç›´æ¥äº¤ä»˜ï¼Œä¸éœ€è¦åœ¨ç»è¿‡å…¶ä»–çš„è·¯ç”±å™¨ï¼Œç›´æ¥æŠŠæ•°æ®æŠ¥äº¤ä»˜ç›®çš„ä¸»æœºã€‚</li>\n<li>3ï¼‰è‹¥è·¯ç”±è¡¨ä¸­æœ‰ç›®çš„åœ°å€ä¸ºDçš„ç‰¹å®šä¸»æœºè·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼›å¦åˆ™æ‰§è¡Œï¼ˆ4ï¼‰</li>\n<li>4ï¼‰è‹¥è·¯ç”±è¡¨ä¸­æœ‰åˆ°è¾¾ç½‘ç»œNçš„è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„ä¸‹ä¸€è·³è·¯ç”±ï¼›å¦åˆ™ï¼Œæ‰§è¡Œ5ï¼‰</li>\n<li>5ï¼‰è‹¥è·¯ç”±è¡¨ä¸­æœ‰ä¸€ä¸ªé»˜è®¤è·¯ç”±ï¼Œåˆ™æŠŠæ•°æ®æŠ¥ä¼ é€ç»™è·¯ç”±è¡¨ä¸­æ‰€æŒ‡æ˜çš„é»˜è®¤è·¯ç”±ï¼›å¦åˆ™ï¼Œæ‰§è¡Œ6ï¼‰</li>\n<li>6ï¼‰æŠ¥å‘Šè½¬å‘åˆ†ç»„å‡ºé”™ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>4.4. åœ°å€è§£æåè®®ARPï¼ˆAddress Resolution Protocol åŒä¸€ä¸ªå±€åŸŸç½‘ï¼Œè·¨ç½‘ç»œç”±è·¯ç”±å™¨å®Œæˆè½¬å‘ï¼‰</h2>\n<ul>\n<li>ARPåè®®å°±æ˜¯ä¸ºäº†ä»ç½‘ç»œå±‚ä½¿ç”¨çš„ipè§£æå‡ºåœ¨æ•°æ®é“¾è·¯å±‚ä½¿ç”¨çš„ç¡¬ä»¶åœ°å€ã€‚cmdæŸ¥çœ‹å‘½ä»¤ arp -a</li>\n<li>ARPåè®®æ˜¯åœ¨ARPé«˜é€Ÿç¼“å­˜ä¸­å­˜æ”¾ä»ipåœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„è¡¨ï¼Œå¹¶ä¸”è¿™ä¸ªæ˜ å°„è¡¨ç»å¸¸åŠ¨æ€æ›´æ–°ï¼ˆæ–°å¢æˆ–è€…è¶…æ—¶åˆ é™¤ï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/43213b677e352d96ea3ac.png\" alt=\"11.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/55bc0e6f1c478415b2fa6.png\" alt=\"12.png\"></li>\n<li>ARPåè®®å·¥ä½œåŸç†\n<ul>\n<li>æ¯ä¸ªä¸»æœºéƒ½è®¾æœ‰ä¸€ä¸ªARPç¼“å­˜è¡¨ï¼Œé‡Œé¢æœ‰æœ¬å±€åŸŸç½‘ä¸Šå„ä¸»æœºå’Œè·¯ç”±å™¨çš„IPåœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„è¡¨</li>\n<li>å½“ä¸»æœºAè¦å‘æœ¬å±€åŸŸç½‘ä¸Šçš„æŸä¸ªä¸»æœºBå‘é€IPæ•°æ®æŠ¥æ—¶ï¼Œå°±å…ˆåœ¨å…¶ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥æ‰¾æœ‰æ— ä¸»æœºBçš„IPåœ°å€ã€‚å¦‚æœæœ‰ï¼Œå°±åœ¨ARPé«˜é€Ÿç¼“å­˜ä¸­æŸ¥å‡ºå…¶å¯¹åº”çš„ç¡¬ä»¶åœ°å€ï¼Œå†æŠŠå…¶ç¡¬ä»¶åœ°å€å†™å…¥åˆ°MACå¸§ï¼Œç„¶åé€šè¿‡å±€åŸŸç½‘æŠŠè¯¥MACå¸§å‘å¾€æ­¤ç¡¬ä»¶åœ°å€</li>\n<li>å¦‚æœä¸»æœºé«˜é€Ÿç¼“å­˜ä¸­æ²¡æœ‰åˆ™è¿è¡ŒARPï¼ŒæŒ‰ç…§ä»¥ä¸‹æ­¥éª¤æŸ¥æ‰¾å‡ºä¸»æœºBçš„ç¡¬ä»¶åœ°å€ã€‚\n<ul>\n<li>ARPè¿›ç¨‹åœ¨æœ¬å±€åŸŸç½‘å¹¿æ’­å‘é€ä¸€ä¸ªARPè¯·æ±‚åˆ†ç»„ã€‚åŒæ—¶æŠŠè‡ªå·±çš„ipåœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„å†™å…¥ARPè¯·æ±‚åˆ†ç»„ã€‚æœ¬å±€åŸŸç½‘ä¸Šæ‰€æœ‰çš„ä¸»æœºä¸Šè¿è¡Œçš„ARPè¿›ç¨‹éƒ½æ”¶åˆ°æ­¤ARPè¯·æ±‚åˆ†ç»„</li>\n<li>ä¸»æœºBåœ¨ARPè¯·æ±‚åˆ†ç»„ä¸­è§åˆ°è‡ªå·±çš„IPåœ°å€ï¼Œè®°å½•Açš„åœ°å€æ˜ å°„å¹¶å‘Aå‘é€ARPå“åº”åˆ†ç»„(å•æ’­)ï¼ŒåŒæ—¶å†™å…¥è‡ªå·±çš„ç¡¬ä»¶åœ°å€ã€‚</li>\n<li>ä¸»æœºAæ”¶åˆ°ä¸»æœºBçš„ARPå“åº”åˆ†ç»„åï¼Œå°±åœ¨å…¶ARPé«˜é€Ÿç¼“å­˜ä¸­å†™å…¥ä¸»æœºBçš„IPåœ°å€åˆ°ç¡¬ä»¶åœ°å€çš„æ˜ å°„ã€‚</li>\n<li>ç”±äºå…¶ä½™çš„æ‰€æœ‰ä¸»æœºçš„IPåœ°å€éƒ½ä¸ARPè¯·æ±‚åˆ†ç»„ä¸­è¦æŸ¥è¯¢çš„IPåœ°å€ä¸ä¸€è‡´ï¼Œå› æ­¤éƒ½ä¸ç†ç¬è¿™ä¸ªARPè¯·æ±‚åˆ†ç»„</li>\n</ul>\n</li>\n<li>å§”æ‰˜ARPæˆ–ARPä»£ç†ï¼ˆARP Proxyï¼‰:å½“å‘é€ä¸»æœºå’Œç›®çš„ä¸»æœºä¸åœ¨åŒä¸€ä¸ªå±€åŸŸç½‘ä¸­æ—¶ï¼Œå‘é€ä¸»æœºé€šè¿‡ARPåè®®è·å¾—çš„æ˜¯ä¸€å°å¯ä»¥é€šå¾€å±€åŸŸç½‘å¤–çš„è·¯ç”±å™¨çš„MACåœ°å€ã€‚äºæ˜¯æ­¤åå‘é€ä¸»æœºå‘å¾€ç›®çš„ä¸»æœºçš„æ‰€æœ‰å¸§ï¼Œéƒ½å°†å‘å¾€è¯¥è·¯ç”±å™¨ï¼Œé€šè¿‡å®ƒå‘å¤–å‘é€ã€‚</li>\n<li>ARPç¼“å­˜è¡¨æ¯ä¸€é¡¹éƒ½è®¾ç½®ç”Ÿå­˜æ—¶é—´ï¼Œå‡¡è¶…è¿‡ç”Ÿå­˜æ—¶é—´çš„é¡¹ç›®å°±ä»é«˜é€Ÿç¼“å­˜ä¸­åˆ é™¤æ‰</li>\n</ul>\n</li>\n<li>arp -aå‘½ä»¤æŸ¥çœ‹ARPç¼“å­˜å†…å®¹ï¼Œarp -d [ip] åˆ é™¤ARPç¼“å­˜æ¡ç›®</li>\n</ul>\n<h2>4.5. ç½‘ç»œæ§åˆ¶æŠ¥æ–‡åè®® ICMP(Internet Control Message Protocol)ï¼ˆä¸ºäº†æ›´æœ‰æ•ˆåœ°è½¬å‘ipæ•°æ®æŠ¥å’Œæäº¤äº¤ä»˜æˆåŠŸçš„æœºä¼šï¼‰</h2>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/82332515ce8c9937d8eb1.png\" alt=\"31.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d6eb753a0094cd33c27d8.png\" alt=\"23.PNG\"></p>\n<ul>\n<li>ICMPç½‘ç»œæ§åˆ¶æŠ¥æ–‡åè®®ï¼šå…è®¸ä¸»æœºæˆ–è·¯ç”±å™¨æŠ¥å‘Šå·®é”™æƒ…å†µå’Œæä¾›æœ‰å…³å¼‚å¸¸æƒ…å†µçš„æŠ¥å‘Šï¼ŒICMPæŠ¥æ–‡ä½œä¸ºIPæ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ã€‚æ‰€æœ‰çš„ICMPå·®é”™æŠ¥æ–‡ä¸­çš„æ•°æ®å­—æ®µéƒ½æœ‰åŒæ ·çš„æ ¼å¼ï¼ŒæŠŠæ”¶åˆ°çš„éœ€è¦è¿›è¡Œå·®é”™æŠ¥å‘Šçš„IPæ•°æ®æŠ¥çš„é¦–éƒ¨å’Œæ•°æ®å­—æ®µçš„å‰8ä¸ªå­—èŠ‚ï¼ˆè¿è¾“å±‚ç«¯å£å·TCPå’ŒUDPï¼Œå‘é€åºå·TCPï¼‰æå–å‡ºæ¥ï¼Œä½œä¸ºICMPæŠ¥æ–‡çš„æ•°æ®å­—æ®µï¼Œå†åŠ ä¸Šç›¸åº”çš„ICMPå·®é”™æŠ¥æ–‡çš„å‰8ä¸ªå­—èŠ‚æ„æˆICMPçš„å·®é”™æŠ¥å‘ŠæŠ¥æ–‡ã€‚</li>\n<li>ICMPæŠ¥æ–‡ç§ç±»-&gt;æ£€éªŒå’Œå­—æ®µç”¨æ¥æ£€éªŒæ•´ä¸ªICMPæŠ¥æ–‡\n<ul>\n<li>å·®é”™æŠ¥å‘ŠæŠ¥æ–‡\n<ul>\n<li>ç±»å‹å€¼3ï¼šç»ˆç‚¹ä¸å¯è¾¾ï¼Œå½“è·¯ç”±å™¨æˆ–ä¸»æœºä¸èƒ½äº¤ä»˜æ•°æ®æŠ¥æ—¶å°±å‘æºç‚¹å‘é€ç»ˆç‚¹ä¸å¯è¾¾æŠ¥æ–‡</li>\n<li>ç±»å‹å€¼4ï¼šæºç‚¹æŠ‘åˆ¶ï¼Œå½“è·¯ç”±å™¨æˆ–ä¸»æœºç”±äºé˜»å¡è€Œä¸¢å¼ƒæ•°æ®æŠ¥æ—¶ï¼Œå°±å‘æºç‚¹å‘é€æºç‚¹æŠ‘åˆ¶æŠ¥æ–‡ï¼Œä½¿æºç‚¹æŠŠæ•°æ®æŠ¥çš„å‘é€é€Ÿç‡å‡æ…¢</li>\n<li>ç±»å‹å€¼5ï¼šæ”¹å˜è·¯ç”±(Redirectï¼‰ï¼Œè·¯ç”±å™¨æŠŠæ”¹å˜è·¯ç”±æŠ¥æ–‡å‘ç»™ä¸»æœºï¼Œè®©ä¸»æœºçŸ¥é“ä¸‹æ¬¡åº”å°†æ•°æ®æŠ¥å‘é€ç»™å¦å¤–çš„è·¯ç”±å™¨</li>\n<li>ç±»å‹å€¼11ï¼šè¶…æ—¶ï¼Œå½“è·¯ç”±å™¨æ”¶åˆ°ç”Ÿå­˜æ—¶é—´ä¸ºé›¶çš„æ•°æ®æŠ¥æ—¶ï¼Œé™¤ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥å¤–ï¼Œè¿˜è¦å‘æºç‚¹å‘é€æ—¶é—´è¶…è¿‡æŠ¥æ–‡ã€‚å½“ç»ˆç‚¹åœ¨é¢„å…ˆè§„å®šçš„æ—¶é—´å†…ä¸èƒ½æ”¶åˆ°ä¸€ä¸ªæ•°æ®æŠ¥çš„å…¨éƒ¨æ•°æ®ç¢ç‰‡æ—¶ï¼Œå°±æŠŠæ•°æ®æŠ¥ç‰‡éƒ½ä¸¢å¼ƒï¼Œå¹¶å‘æºç‚¹å‘é€è¶…æ—¶æŠ¥æ–‡</li>\n<li>ç±»å‹å€¼12ï¼šå‚æ•°é—®é¢˜ï¼Œå½“è·¯ç”±å™¨æˆ–ç›®çš„ä¸»æœºæ”¶åˆ°çš„æ•°æ®æŠ¥é¦–éƒ¨ä¸­æœ‰çš„å­—æ®µçš„å€¼ä¸æ­£ç¡®æ—¶ï¼Œå°±ä¸¢å¼ƒè¯¥æ•°æ®æŠ¥ï¼Œå¹¶å‘æºç‚¹å‘é€å‚æ•°é—®é¢˜æŠ¥æ–‡</li>\n<li>ä»¥ä¸‹å‡ ç§æƒ…å†µéƒ½ä¸ä¼šå¯¼è‡´äº§ç”ŸICMPå·®é”™æŠ¥æ–‡ï¼ˆé˜²æ­¢è¿‡å»å…è®¸ICMPå·®é”™æŠ¥æ–‡å¯¹å¹¿æ’­åˆ†ç»„å“åº”æ‰€å¸¦æ¥çš„å¹¿æ’­é£æš´ï¼‰\n<ul>\n<li>ICMPå·®é”™æŠ¥æ–‡</li>\n<li>ç¬¬ä¸€ä¸ªåˆ†ç‰‡çš„æ•°æ®æŠ¥ç‰‡çš„æ‰€æœ‰åç»­æ•°æ®æŠ¥ç‰‡</li>\n<li>å…·æœ‰å¤šæ’­åœ°å€çš„æ•°æ®æŠ¥</li>\n<li>å…·æœ‰ç‰¹æ®Šåœ°å€ï¼ˆ127.0.0.0æˆ–0.0.0.0ï¼‰çš„æ•°æ®æŠ¥<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c5e11a83c00b6f5eed2e4.png\" alt=\"35.PNG\"></li>\n</ul>\n</li>\n</ul>\n</li>\n<li>è¯¢é—®æŠ¥å‘ŠæŠ¥æ–‡\n<ul>\n<li>ç±»å‹å€¼8æˆ–è€…0ï¼šå›é€(Echo)è¯·æ±‚æˆ–åº”ç­”ï¼Œä¸»æœºæˆ–è·¯ç”±å™¨å‘ç‰¹å®šçš„ç›®çš„ä¸»æœºå‘å‡ºçš„è¯¢é—®ã€‚ç”¨æ¥æµ‹è¯•ç›®çš„ç«™æ˜¯å¦å¯è¾¾ä»¥åŠäº†è§£æœ‰å…³çŠ¶æ€ï¼Œæ”¶åˆ°æ­¤æŠ¥æ–‡çš„ä¸»æœºå¿…é¡»ç»™æºä¸»æœºæˆ–è·¯ç”±å™¨å‘é€ICMPå›é€å›ç­”æŠ¥æ–‡</li>\n<li>ç±»å‹å€¼13æˆ–14ï¼šæ—¶é—´æˆ³(Timestamp)è¯·æ±‚æˆ–åº”ç­”ã€‚è¯·æŸä¸ªä¸»æœºæˆ–è·¯ç”±å™¨å›ç­”å½“å‰çš„æ—¥æœŸå’Œæ—¶é—´ã€‚åœ¨ICMPæ—¶é—´æˆ³å›ç­”æŠ¥æ–‡ä¸­æœ‰ä¸€ä¸ª32ä½çš„å­—æ®µï¼Œå†™å…¥ä»1900å¹´1æœˆ1æ—¥åˆ°å½“å‰æ—¶åˆ»å…±å¤šå°‘ç§’ï¼Œç”¨æ¥è¿›è¡Œæ—¶é’ŸåŒæ­¥å’Œæµ‹é‡æ—¶é—´</li>\n</ul>\n</li>\n<li>ICMPçš„åº”ç”¨ä¸¾ä¾‹\n<ul>\n<li>PINGï¼ˆPacket InterNet Groperï¼‰åˆ†ç»„ç½‘é—´æ¢æµ‹ï¼Œç”¨äºæµ‹è¯•ä¸¤ä¸ªä¸»æœºä¹‹é—´çš„è¿é€šæ€§ã€‚pingä½¿ç”¨äº†ICMPå›é€è¯·æ±‚ä¸å›é€å›ç­”æŠ¥æ–‡ã€‚ åº”ç”¨å±‚ç›´æ¥ä½¿ç”¨ç½‘ç»œå±‚ICMPçš„ä¸€ä¸ªä¾‹å­</li>\n<li>TraceRoute/tracertç”¨æ¥è·Ÿè¸ªä¸€ä¸ªåˆ†ç»„ä»æºç‚¹åˆ°ç»ˆç‚¹çš„è·¯å¾„ã€‚ä½¿ç”¨äº†ICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡\n<ul>\n<li>TraceRouteä»æºä¸»æœºå‘ç›®çš„ä¸»æœºå‘é€ä¸€è¿ä¸²çš„IPæ•°æ®åŒ…ï¼Œæ•°æ®æŠ¥ä¸­å°è£…çš„æ˜¯æ— æ³•äº¤ä»˜çš„UDPç”¨æˆ·æ•°æ®æŠ¥ã€‚ç¬¬ä¸€ä¸ªP1çš„ç”Ÿå­˜æ—¶é—´TTLè®¾ç½®ä¸º1ã€‚å½“P1è¾¾åˆ°è·¯å¾„ä¸Šçš„ç¬¬ä¸€ä¸ªè·¯ç”±å™¨R1æ—¶ï¼ŒR1å…ˆæ”¶ä¸‹å®ƒï¼Œæ¥ç€æŠŠTTLçš„å€¼å‡1ã€‚ç”±äºTTLçš„å€¼ç­‰äºé›¶äº†ï¼ŒR1å°±æŠŠP1ä¸¢å¼ƒäº†ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ª<strong>ICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡</strong>ã€‚æ¥ç€å‘é€ç¬¬äºŒä¸ªæ•°æ®æŠ¥P2ï¼Œå¹¶æŠŠTTLè®¾ç½®ä¸º2ã€‚P2å…ˆåˆ°è¾¾è·¯ç”±å™¨R1ï¼ŒR1æ”¶ä¸‹ï¼ŒæŠŠTTLå‡1å†è½¬å‘ç»™è·¯ç”±å™¨R2ã€‚R2æ”¶åˆ°P2æ—¶TTLä¸º1ï¼Œä½†å‡1åTTLå˜ä¸ºé›¶äº†ã€‚R2å°±ä¸¢å¼ƒP2ï¼Œå¹¶å‘æºä¸»æœºå‘é€ä¸€ä¸ªICMPæ—¶é—´è¶…è¿‡å·®é”™æŠ¥å‘ŠæŠ¥æ–‡......TraceRouteæ¯æ¬¡å°†é€å‡ºçš„æŠ¥æ–‡çš„TTLåŠ 1æ¥å‘ç°å¦ä¸€ä¸ªè·¯ç”±å™¨ï¼Œè¿™æ ·ä¸€ç›´ç»§ç»­ä¸‹å»ï¼Œå½“æœ€åä¸€ä¸ªæ•°æ®æŠ¥åˆšåˆšåˆ°è¾¾ç›®çš„ä¸»æœºçš„æ—¶å€™ï¼Œæ•°æ®æŠ¥çš„TTLæ˜¯1ã€‚ä¸»æœºä¸è½¬å‘æ•°æ®åŒ…ä¹Ÿä¸æŠŠTTLå€¼å‡1ã€‚ç›®çš„ä¸»æœºè¦å‘ä¸»æœºå‘é€<strong>ICMPç»ˆç‚¹ä¸å¯è¾¾å·®é”™æŠ¥å‘ŠæŠ¥æ–‡</strong>ã€‚è¿™æ ·ï¼Œæºä¸»æœºè¾¾åˆ°äº†è‡ªå·±çš„ç›®çš„ï¼Œå› ä¸ºè¿™äº›è·¯ç”±å™¨å’Œæœ€åç›®çš„ä¸»æœºå‘æ¥çš„ICMPæŠ¥æ–‡æ­£å¥½ç»™å‡ºäº†æºä¸»æœºæƒ³çŸ¥é“çš„è·¯ç”±ä¿¡æ¯â€”â€”åˆ°è¾¾ç›®çš„ä¸»æœºæ‰€ç»è¿‡çš„è·¯ç”±å™¨çš„IPåœ°å€ï¼Œä»¥åŠåˆ°è¾¾å…¶ä¸­çš„æ¯ä¸€ä¸ªè·¯ç”±å™¨çš„å¾€è¿”æ—¶é—´ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å› ç‰¹ç½‘çš„è·¯ç”±é€‰æ‹©åè®®\n<ul>\n<li>æ ¹æ®ç®—æ³•æ˜¯å¦éšç½‘ç»œçš„é€šä¿¡é‡æˆ–æ‹“è¡¥è‡ªé€‚åº”åœ°è°ƒæ•´å˜åŒ–åˆ’åˆ†ï¼š\n<ul>\n<li>é™æ€è·¯ç”±é€‰æ‹©ç­–ç•¥â€”â€”éè‡ªé€‚åº”è·¯ç”±é€‰æ‹©ï¼Œç®€å•å’Œå¼€é”€è¾ƒå°ï¼Œä¸èƒ½åŠæ—¶é€‚åº”ç½‘ç»œçŠ¶æ€çš„å˜åŒ–ã€‚å°ç½‘ç»œ</li>\n<li>åŠ¨æ€è·¯ç”±é€‰æ‹©ç­–ç•¥â€”â€”è‡ªé€‚åº”è·¯ç”±é€‰æ‹©ï¼Œèƒ½è¾ƒå¥½åœ°é€‚åº”ç½‘ç»œçŠ¶æ€çš„å˜åŒ–ï¼Œå®ç°èµ·æ¥å¤æ‚ï¼Œå¼€é”€ä¹Ÿæ¯”è¾ƒå¤§ã€‚å¤§ç½‘ç»œ</li>\n</ul>\n</li>\n<li>å› ç‰¹ç½‘é‡‡ç”¨çš„è·¯ç”±é€‰æ‹©åè®®ä¸»è¦æ˜¯è‡ªé€‚åº”çš„ã€åˆ†å¸ƒå¼è·¯ç”±é€‰æ‹©åè®®\n<ul>\n<li>å› ç‰¹ç½‘çš„è§„æ¨¡éå¸¸å¤§ã€‚å¦‚æœè®©æ‰€æœ‰çš„è·¯ç”±å™¨çŸ¥é“æ‰€æœ‰çš„ç½‘ç»œæ€æ ·åˆ°è¾¾ã€‚åˆ™è¿™ç§è·¯ç”±è¡¨å°†éå¸¸å¤§ï¼Œå¤„ç†èµ·æ¥ä¹Ÿå¤ªèŠ±æ—¶é—´ï¼Œè€Œæ‰€æœ‰è¿™äº›è·¯ç”±å™¨ä¹‹é—´äº¤æ¢è·¯ç”±ä¿¡æ¯æ‰€éœ€çš„å¸¦å®½ä¼šä½¿å› ç‰¹ç½‘çš„é€šä¿¡é“¾è·¯é¥±å’Œ</li>\n<li>è®¸å¤šå•ä½ä¸æ„¿æ„å¤–ç•Œäº†è§£è‡ªå·±å•ä½ç½‘ç»œçš„å¸ƒå±€ç»†èŠ‚å’Œæœ¬éƒ¨é—¨é‡‡ç”¨çš„è·¯ç”±é€‰æ‹©åè®®ï¼Œä½†åŒæ—¶è¿˜å¸Œæœ›è¿æ¥åˆ°å› ç‰¹ç½‘ä¸Šï¼Œä¸ºæ­¤ï¼Œå› ç‰¹ç½‘å°†æ•´ä¸ªäº’è”ç½‘åˆ’åˆ†ä¸ºè®¸å¤šè¾ƒå°çš„è‡ªæ²»ç³»ç»Ÿ</li>\n</ul>\n</li>\n<li>è‡ªæ²»ç³»ç»ŸAS(AutonomousSystem)ï¼šä¸€ä¸ªç®¡ç†æœºæ„ä¸‹çš„ç½‘ç»œè®¾å¤‡ç¾¤ã€‚å°½ç®¡ASä½¿ç”¨äº†å¤šç§å†…éƒ¨è·¯ç”±é€‰æ‹©åè®®ï¼Œä½†ASå¯¹å…¶ä»–ASè¡¨ç°å‡ºçš„æ˜¯ä¸€ä¸ªå•ä¸€çš„å’Œä¸€è‡´çš„è·¯ç”±é€‰æ‹©ç­–ç•¥ã€‚ä¸€ä¸ªå¤§çš„ISPå°±æ˜¯ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿï¼Œè‡ªæ²»ç³»ç»Ÿä¹‹é—´çš„è·¯ç”±é€‰æ‹©ç§°ä¸ºåŸŸé—´è·¯ç”±é€‰æ‹©ï¼Œè‡ªæ²»ç³»ç»Ÿå†…éƒ¨çš„è·¯ç”±é€‰æ‹©å«åšåŸŸå†…è·¯ç”±é€‰æ‹©</li>\n<li>å› ç‰¹ç½‘æœ‰ä¸¤å¤§ç±»è·¯ç”±é€‰æ‹©åè®®\n<ul>\n<li>å†…éƒ¨ç½‘å…³åè®®IGP(Interior Gateway Protocol)&nbsp;å³åœ¨ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†…éƒ¨ä½¿ç”¨çš„è·¯ç”±é€‰æ‹©åè®®ã€‚ä¸äº’è”ç½‘ä¸­å…¶ä»–è‡ªæ²»ç³»ç»Ÿé€‰ç”¨ä»€ä¹ˆè·¯ç”±é€‰æ‹©åè®®æ— å…³ã€‚å¦‚RIPå’ŒOSPFåè®®</li>\n<li>å¤–éƒ¨ç½‘å…³åè®®EGP(External Gateway Protocol)&nbsp;æºç«™å’Œç›®çš„ç«™å¤„åœ¨ä¸åŒçš„è‡ªæ²»ç³»ç»Ÿä½¿ç”¨çš„è·¯ç”±é€‰æ‹©åè®®ã€‚å¦‚BGPåè®®</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>äº’è”ç½‘çš„å®ä½“å¹¶ä¸æ˜¯ç”±ä¸€ä¸ªç»„ç»‡è¿è¥ç®¡ç†çš„å•ä¸€ç½‘ç»œï¼Œè€Œæ˜¯ç”±å¤šä¸ªè¿è¥å•†ç½‘ç»œç›¸äº’è¿æ¥ç»„æˆçš„ï¼ˆå›¾ 4.23ï¼‰ã€‚<br>\nADSLã€FTTH ç­‰æ¥å…¥ç½‘æ˜¯ä¸ç”¨æˆ·ç­¾çº¦çš„è¿è¥å•†è®¾å¤‡ç›¸è¿çš„ï¼Œè¿™äº›è®¾å¤‡ç§°ä¸º POP</li>\n<li>NOCï¼šNetwork Operation Centerï¼Œç½‘ç»œè¿è¡Œä¸­å¿ƒã€‚NOC æ˜¯è¿è¥å•†çš„æ ¸å¿ƒè®¾å¤‡ï¼Œä» POP ä¼ æ¥çš„ç½‘ç»œåŒ…éƒ½ä¼šé›†ä¸­åˆ°è¿™é‡Œï¼Œå¹¶ä»è¿™é‡Œè¢«è½¬å‘åˆ°ç¦»ç›®çš„åœ°æ›´è¿‘çš„POPï¼Œæˆ–è€…æ˜¯è½¬å‘åˆ°å…¶ä»–çš„è¿è¥å•†ã€‚è¿™é‡Œä¹Ÿéœ€è¦é…å¤‡é«˜æ€§èƒ½çš„è·¯ç”±å™¨</li>\n<li>IXï¼šäº’è”ç½‘äº¤æ¢ä¸­å¿ƒã€‚è®¾ç½®ä¸€ä¸ªä¸­å¿ƒè®¾å¤‡ï¼Œå°†æ‰€æœ‰çš„è¿è¥å•†éƒ½ç”¨é€šä¿¡çº¿è·¯è¿æ¥èµ·æ¥ã€‚é€šè¿‡è¿æ¥åˆ°ä¸­å¿ƒè®¾å¤‡çš„æ–¹å¼æ¥å‡å°‘çº¿è·¯æ•°é‡ï¼Œè¿™ä¸ªä¸­å¿ƒè®¾å¤‡å°±ç§°ä¸ºIXï¼ŒIX çš„æ ¸å¿ƒæ˜¯å…·æœ‰å¤§é‡é«˜é€Ÿä»¥å¤ªç½‘ ç«¯å£çš„äºŒå±‚äº¤æ¢æœºã€‚äºŒå±‚äº¤æ¢æœºçš„åŸºæœ¬åŸç†å’Œä¸€èˆ¬äº¤æ¢æœºç›¸åŒï¼Œå¤§å®¶å¯ä»¥è®¤ä¸º IX çš„æ ¸å¿ƒå°±æ˜¯å¤§å‹çš„ã€é«˜é€Ÿçš„äº¤æ¢æœºã€‚</li>\n</ul>\n<h2>4.6. å†…éƒ¨ç½‘å…³åè®®-è·¯ç”±ä¿¡æ¯åè®®RIP(Routing Information Protocol)</h2>\n<ul>\n<li>RIPæ˜¯ä¸€ç§åˆ†å¸ƒå¼çš„åŸºäºè·ç¦»å‘é‡çš„è·¯ç”±é€‰æ‹©åè®®ã€‚è¦æ±‚ç½‘ç»œä¸­çš„æ¯ä¸€ä¸ªè·¯ç”±å™¨éƒ½è¦ç»´æŠ¤ä»å®ƒè‡ªå·±åˆ°å…¶ä»–æ¯ä¸€ä¸ªç›®çš„ç½‘ç»œçš„è·ç¦»è®°å½•ã€‚</li>\n<li>è·ç¦»/è·³æ•°ï¼šä»ä¸€è·¯ç”±å™¨åˆ°ç›´æ¥è¿æ¥çš„ç½‘ç»œçš„è·ç¦»å®šä¹‰ä¸º1ã€‚ä»ä¸€ä¸ªè·¯ç”±å™¨åˆ°éç›´æ¥è¿æ¥çš„ç½‘ç»œçš„è·ç¦»å®šä¹‰ä¸ºæ‰€ç»è¿‡çš„è·¯ç”±å™¨æ•°åŠ 1ã€‚åŠ â€œ1â€æ˜¯å› ä¸ºåˆ°è¾¾ç›®çš„ç½‘ç»œåå°±è¿›è¡Œç›´æ¥äº¤ä»˜ï¼Œè€Œåˆ°ç›´æ¥çš„ç½‘ç»œçš„è·ç¦»å·²ç»å®šä¹‰ä¸º1ã€‚RIPå…è®¸ä¸€æ¡è·¯å¾„æœ€å¤šåªèƒ½åŒ…å«15ä¸ªè·¯ç”±å™¨ã€‚â€œè·ç¦»â€ä¸º16æ—¶å³ç›¸å½“äºä¸å¯è¾¾ã€‚å¯è§RIPåªé€‚ç”¨äºå°å‹äº’è”ç½‘ã€‚RIPä¸èƒ½åœ¨ä¸¤ä¸ªç½‘ç»œä¹‹é—´åŒæ—¶ä½¿ç”¨å¤šæ¡è·¯ç”±ã€‚RIPé€‰æ‹©ä¸€ä¸ªå…·æœ‰æœ€å°‘è·¯ç”±å™¨çš„è·¯ç”±ï¼ˆå³æœ€çŸ­è·¯ç”±ï¼‰ï¼Œå“ªæ€•è¿˜å­˜åœ¨å¦ä¸€æ¡é«˜é€Ÿ(ä½æ—¶å»¶)ä½†è·¯ç”±å™¨è¾ƒå¤šçš„è·¯ç”±ã€‚</li>\n<li>æŒ‰å›ºå®šçš„æ—¶é—´é—´éš”ï¼ˆ30sï¼‰ä»…å’Œç›¸é‚»è·¯ç”±å™¨äº¤æ¢æœ¬è·¯ç”±å™¨çš„è·¯ç”±è¡¨(åˆ°æŸä¸ªç½‘ç»œNã€åˆ°Nçš„è·ç¦»ï¼Œä¸‹ä¸€è·³åœ°å€ï¼Œæ›´æ–°åŸåˆ™æ˜¯åˆ°æ¯ä¸ªç½‘ç»œçš„æœ€çŸ­è·ç¦»)ã€‚å½“ç½‘ç»œæ‹“è¡¥å‘ç”Ÿå˜åŒ–æ—¶ï¼Œè·¯ç”±å™¨ä¹ŸåŠæ—¶å‘ç›¸é‚»è·¯ç”±å™¨é€šå‘Šæ‹“è¡¥å˜åŒ–åçš„è·¯ç”±ä¿¡æ¯ã€‚ä½¿å¾—æ¯ä¸€ä¸ªè·¯ç”±å™¨åˆ°æ¯ä¸€ä¸ªç›®çš„ç½‘ç»œçš„è·¯ç”±æ˜¯æœ€çŸ­çš„</li>\n<li>RIPåè®®å’ŒOSPFåè®®éƒ½æ˜¯åˆ†å¸ƒå¼è·¯ç”±é€‰æ‹©åè®®ï¼Œæ¯ä¸ªè·¯ç”±å™¨éƒ½è¦ä¸æ–­åœ°å’Œå…¶ä»–ä¸€äº›è·¯ç”±å™¨äº¤æ¢è·¯ç”±ä¿¡æ¯</li>\n<li>è·¯ç”±è¡¨çš„å»ºç«‹ï¼šè·¯ç”±å™¨åœ¨åˆšåˆšå¼€å§‹å·¥ä½œæ—¶ï¼ŒåªçŸ¥é“åˆ°ç›´æ¥è¿æ¥çš„ç½‘ç»œçš„è·ç¦»ï¼ˆæ­¤è·ç¦»å®šä¹‰ä¸º1ï¼‰ã€‚ä»¥åï¼Œæ¯ä¸€ä¸ªè·¯ç”±å™¨ä¹Ÿåªå’Œæ•°ç›®éå¸¸æœ‰é™çš„ç›¸é‚»è·¯ç”±å™¨äº¤æ¢å¹¶æ›´æ–°è·¯ç”±ä¿¡æ¯ã€‚ç»è¿‡è‹¥å¹²æ¬¡æ›´æ–°åï¼Œæ‰€æœ‰çš„è·¯ç”±å™¨æœ€ç»ˆéƒ½ä¼šçŸ¥é“åˆ°è¾¾æœ¬è‡ªæ²»ç³»ç»Ÿä¸­ä»»ä½•ä¸€ä¸ªç½‘ç»œçš„æœ€çŸ­è·ç¦»å’Œä¸‹ä¸€è·³è·¯ç”±å™¨çš„åœ°å€ã€‚RIPåè®®çš„æ”¶æ•›(convergence)è¿‡ç¨‹è¾ƒå¿«ï¼Œå³åœ¨è‡ªæ²»ç³»ç»Ÿä¸­æ‰€æœ‰çš„ç»“ç‚¹éƒ½å¾—åˆ°æ­£ç¡®çš„è·¯ç”±é€‰æ‹©ä¿¡æ¯çš„è¿‡ç¨‹ã€‚</li>\n<li>è·ç¦»å‘é‡ç®—æ³•(Bellman-Fordç®—æ³•)\n<ul>\n<li>æ”¶åˆ°ç›¸é‚»è·¯ç”±å™¨ï¼ˆå…¶åœ°å€ä¸ºXï¼‰çš„ä¸€ä¸ªRIPæŠ¥æ–‡ï¼š</li>\n<li>å…ˆä¿®æ”¹æ­¤RIPæŠ¥æ–‡ä¸­çš„æ‰€æœ‰é¡¹ç›®ï¼šä¸‹ä¸€è·³åœ°å€éƒ½æ”¹ä¸ºXï¼Œè·ç¦»+1ã€‚å¯¹ä¿®æ”¹åçš„RIPæŠ¥æ–‡ä¸­çš„æ¯ä¸€ä¸ªé¡¹ç›®(åˆ°ç›®çš„ç½‘ç»œNã€‚è·ç¦»dï¼Œä¸‹ä¸€è·³åœ°å€X)\n<ul>\n<li>è‹¥é¡¹ç›®ä¸­çš„ç›®çš„ç½‘ç»œä¸åœ¨è·¯ç”±è¡¨ä¸­ï¼Œåˆ™æŠŠè¯¥é¡¹ç›®åŠ åˆ°è·¯ç”±è¡¨ä¸­ï¼›</li>\n<li>è‹¥é¡¹ç›®ä¸­çš„ç›®çš„ç½‘ç»œåœ¨è·¯ç”±è¡¨ä¸­ä¸”ä¸‹ä¸€è·³å­—æ®µç»™å‡ºçš„è·¯ç”±å™¨åœ°å€æ˜¯åŒæ ·çš„ï¼Œåˆ™æŠŠæ”¶åˆ°çš„é¡¹ç›®æ›¿æ¢åŸè·¯ç”±è¡¨ä¸­çš„é¡¹ç›®ï¼›</li>\n<li>è‹¥é¡¹ç›®ä¸­çš„ç›®çš„ç½‘ç»œåœ¨è·¯ç”±è¡¨ä¸­ä¸”ä¸‹ä¸€è·³å­—æ®µç»™å‡ºçš„è·¯ç”±å™¨åœ°å€æ˜¯ä¸åŒçš„ï¼Œæ”¶åˆ°é¡¹ç›®ä¸­çš„è·ç¦»å°äºè·¯ç”±è¡¨ä¸­çš„è·ç¦»ï¼Œåˆ™è¿›è¡Œæ›´æ–°ï¼›</li>\n</ul>\n</li>\n<li>è‹¥3åˆ†é’Ÿè¿˜æ²¡æœ‰æ”¶åˆ°ç›¸é‚»è·¯ç”±å™¨çš„æ›´æ–°è·¯ç”±è¡¨ï¼Œåˆ™æŠŠæ­¤ç›¸é‚»è·¯ç”±å™¨è®°ä¸ºä¸å¯è¾¾è·¯ç”±å™¨ï¼Œå³å°†è·ç¦»ç½®ä¸º16ï¼ˆè¡¨ç¤ºä¸å¯è¾¾ï¼‰</li>\n</ul>\n</li>\n<li>RIP2åè®®çš„æŠ¥æ–‡æ ¼å¼ï¼ˆä½¿ç”¨è¿è¾“å±‚çš„ç”¨æˆ·æ•°æ®æŠ¥UDPè¿›è¡Œä¼ é€ï¼Œç«¯å£520ï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9cdf8ba4e441e5c894475.png\" alt=\"15.png\">\n<ul>\n<li>é¦–éƒ¨ï¼š4ä¸ªå­—èŠ‚ï¼Œå‘½ä»¤å­—æ®µæŒ‡å‡ºæŠ¥æ–‡çš„æ„ä¹‰ã€‚1è¡¨ç¤ºè¯·æ±‚è·¯ç”±ä¿¡æ¯ï¼Œ2è¡¨ç¤ºå¯¹è¯·æ±‚è·¯ç”±ä¿¡æ¯çš„å“åº”æˆ–æœªè¢«è¯·æ±‚è€Œå‘å‡ºçš„è·¯ç”±æ›´æ–°æŠ¥æ–‡ã€‚â€œå¿…é¡»ä¸º0â€æ˜¯ä¸ºäº†4å­—èŠ‚çš„å¯¹é½</li>\n<li>è·¯ç”±éƒ¨åˆ†ï¼š20ä¸ªå­—èŠ‚ åœ°å€æ—æ ‡è¯†ç¬¦ï¼ˆåœ°å€ç±»åˆ«ï¼‰å­—æ®µç”¨æ¥æ ‡å¿—æ‰€ä½¿ç”¨çš„åœ°å€åè®®(IPåœ°å€æ—¶ä¸º2)ã€‚è·¯ç”±æ ‡è®°å¡«å…¥è‡ªæ²»ç³»ç»Ÿå·ASNï¼Œè€ƒè™‘ä½¿RIPæœ‰å¯èƒ½æ”¶åˆ°æœ¬è‡ªæ²»ç³»ç»Ÿä»¥å¤–çš„è·¯ç”±é€‰æ‹©ä¿¡æ¯</li>\n<li>RIP2è¿˜å…·æœ‰ç®€å•çš„é‰´åˆ«åŠŸèƒ½ï¼Œè‹¥ä½¿ç”¨é‰´åˆ«åŠŸèƒ½ï¼Œåˆ™å°†åŸæ¥å†™å…¥ç¬¬ä¸€ä¸ªè·¯ç”±ä¿¡æ¯ï¼ˆ20å­—èŠ‚ï¼‰çš„ä½ç½®ç”¨ä½œé‰´åˆ«ã€‚å¹¶å°†åœ°å€æ—æ ‡è¯†ç¬¦ç½®ä¸ºå…¨1(0xFFFF)ï¼Œè·¯ç”±æ ‡è®°å¸å…¥é‰´åˆ«ç±»å‹ï¼Œå‰©ä¸‹16å­—èŠ‚ä¸ºé‰´åˆ«æ•°æ®ã€‚åœ¨é‰´åˆ«æ•°æ®ä¹‹åæ‰å†™å…¥è·¯ç”±ä¿¡æ¯ï¼Œæ­¤æ—¶æœ€å¤šèƒ½æ”¾å…¥24ä¸ªè·¯ç”±ä¿¡æ¯</li>\n<li>æœ€å¤šå¯ä»¥åŒ…æ‹¬25ä¸ªè·¯ç”±ï¼Œæœ€å¤§é•¿åº¦æ˜¯4+20X25=504å­—èŠ‚</li>\n</ul>\n</li>\n<li>RIPåè®®çš„ä¼˜ç¼ºç‚¹ï¼š\n<ul>\n<li>å½“ç½‘ç»œå‡ºç°æ•…éšœæ—¶ï¼ŒåŸå› åªèƒ½ç›¸ä¿¡ç›¸é‚»è·¯ç”±å™¨ã€‚è¦ç»è¿‡æ¯”è¾ƒé•¿çš„æ—¶é—´æ‰èƒ½å°†æ­¤ä¿¡æ¯ä¼ é€åˆ°æ‰€æœ‰çš„è·¯ç”±å™¨ã€‚â€œåæ¶ˆæ¯ä¼ çš„æ…¢â€ï¼Œæ›´æ–°æ”¶æ•›æ—¶é—´è¿‡é•¿ã€‚ï¼ˆå¯ä»¥é€šè¿‡è®©è·¯ç”±å™¨è®°å½•æ”¶åˆ°æŸç‰¹å®šè·¯ç”±ä¿¡æ¯çš„æ¥å£ï¼Œè€Œä¸è®©åŒä¸€è·¯ç”±ä¿¡æ¯å†é€šè¿‡æ­¤æ¥å£å‘åæ–¹å‘ä¼ é€ï¼‰</li>\n<li>å®ç°ç®€å•ï¼Œå¼€é”€è¾ƒå°ã€‚</li>\n<li>é™åˆ¶äº†ç½‘ç»œçš„è§„æ¨¡ï¼Œä½¿ç”¨çš„æœ€å¤§è·ç¦»ä¸º15ï¼ˆ16è¡¨ç¤ºä¸å¯è¾¾ï¼‰ã€‚è·¯ç”±å™¨ä¹‹é—´äº¤æ¢çš„è·¯ç”±ä¿¡æ¯æ˜¯è·¯ç”±å™¨ä¸­çš„å®Œæ•´è·¯ç”±è¡¨ï¼Œå› è€Œéšç€ç½‘ç»œè§„æ¨¡çš„æ‰©å¤§ï¼Œå¼€é”€ä¹Ÿå°±å¢åŠ ã€‚å¯¹äºè¾ƒå¤§çš„ç½‘ç»œåº”è¯¥ä½¿ç”¨OSPFåè®®</li>\n</ul>\n</li>\n</ul>\n<h2>4.7. å†…éƒ¨ç½‘å…³åè®®OSPF(OpenShortest Path First)</h2>\n<ul>\n<li>OSPF â€œå¼€æ”¾æœ€çŸ­è·¯å¾„ä¼˜å…ˆâ€ ä½¿ç”¨äº†Dijkstraæå‡ºçš„æœ€çŸ­è·¯å¾„ç®—æ³•SPF åˆ†å¸ƒå¼çš„é“¾è·¯çŠ¶æ€åè®®</li>\n<li>OSPFåªæœ‰å½“é“¾è·¯çŠ¶æ€å‘ç”Ÿå˜åŒ–æ—¶ï¼Œä½¿ç”¨æ´ªæ³›æ³•ï¼Œæœ¬è‡ªæ²»ç³»ç»Ÿä¸­æ‰€æœ‰è·¯ç”±å™¨é€šè¿‡æ‰€æœ‰è¾“å‡ºç«¯å£å‘é€ä¸æœ¬è·¯ç”±å™¨ç›¸é‚»çš„æ‰€æœ‰è·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€ä¿¡æ¯ã€‚â€œé“¾è·¯çŠ¶æ€â€å°±æ˜¯è¯´æ˜æœ¬è·¯ç”±å™¨éƒ½å’Œå“ªäº›è·¯ç”±å™¨ç›¸é‚»ï¼Œä»¥åŠè¯¥é“¾è·¯çš„â€œåº¦é‡â€(metric)ï¼ˆè´¹ç”¨ã€è·ç¦»ã€æ—¶å»¶ã€å¸¦å®½ç­‰ï¼‰</li>\n<li>é“¾è·¯çŠ¶æ€æ•°æ®åº“/å…¨ç½‘çš„æ‹“æ‰‘ç»“æ„å›¾(link-statedatabase)ï¼šç”±äºå„è·¯ç”±å™¨ä¹‹é—´é¢‘ç¹åœ°äº¤æ¢é“¾è·¯çŠ¶æ€ä¿¡æ¯ï¼Œå› æ­¤æ‰€æœ‰çš„è·¯ç”±å™¨æœ€ç»ˆéƒ½èƒ½å»ºç«‹ä¸€ä¸ªé“¾è·¯çŠ¶æ€æ•°æ®åº“ã€‚å®ƒåœ¨å…¨ç½‘èŒƒå›´å†…æ˜¯ä¸€è‡´çš„ï¼ˆè¿™ç§°ä¸ºé“¾è·¯çŠ¶æ€æ•°æ®åº“çš„åŒæ­¥ï¼‰ã€‚å› æ­¤ï¼Œæ¯ä¸€ä¸ªè·¯ç”±å™¨éƒ½çŸ¥é“å…¨ç½‘ä¸€å…±æœ‰å¤šå°‘è·¯ç”±å™¨ï¼Œä»¥åŠå“ªäº›è·¯ç”±å™¨æ—¶ç›¸è¿çš„ï¼Œä»£ä»·æ˜¯å¤šå°‘ã€‚æ¯ä¸ªè·¯ç”±å™¨ä½¿ç”¨é“¾è·¯çŠ¶æ€æ•°æ®åº“ä¸­çš„æ•°æ®ï¼Œæ„é€ å‡ºè‡ªå·±çš„è·¯ç”±è¡¨ã€‚OSPFçš„é“¾è·¯çŠ¶æ€æ•°æ®åº“èƒ½è¾ƒå¿«åœ°è¿›è¡Œæ›´æ–°ï¼Œä½¿å„ä¸ªè·¯ç”±å™¨èƒ½åŠæ—¶æ›´æ–°å…¶è·¯ç”±è¡¨ã€‚OSPFçš„æ›´æ–°è¿‡ç¨‹æ”¶æ•›å¾—å¿«æ˜¯å…¶é‡è¦ä¼˜ç‚¹ã€‚</li>\n<li>ä¸ºäº†ä½¿OSPFèƒ½å¤Ÿç”¨äºè§„æ¨¡å¾ˆå¤§çš„ç½‘ç»œï¼ŒOSPFå°†ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿå†åˆ’åˆ†ä¸ºè‹¥å¹²ä¸ªæ›´å°çš„èŒƒå›´ï¼Œå«ä½œåŒºåŸŸã€‚æ¯ä¸€ä¸ªåŒºåŸŸéƒ½æœ‰ä¸€ä¸ª32ä½çš„åŒºåŸŸæ ‡è¯†ç¬¦ï¼ˆç”¨ç‚¹åˆ†åè¿›åˆ¶è¡¨ç¤ºï¼‰ã€‚åœ¨ä¸€ä¸ªåŒºåŸŸå†…çš„è·¯ç”±å™¨æœ€å¥½ä¸è¶…è¿‡200ä¸ªã€‚å°†åˆ©ç”¨æ´ªæ³›æ³•äº¤æ¢é“¾è·¯çŠ¶æ€ä¿¡æ¯çš„èŒƒå›´å±€é™äºæ¯ä¸€ä¸ªåŒºåŸŸè€Œä¸æ˜¯æ•´ä¸ªçš„è‡ªæ²»ç³»ç»Ÿï¼Œè¿™å°±å‡å°‘äº†æ•´ä¸ªç½‘ç»œä¸Šçš„é€šä¿¡é‡ã€‚åœ¨ä¸€ä¸ªåŒºåŸŸå†…éƒ¨çš„è·¯ç”±å™¨åªçŸ¥é“æœ¬åŒºåŸŸçš„å®Œæ•´ç½‘ç»œæ‹“æ‰‘ï¼Œè€Œä¸çŸ¥é“å…¶ä»–åŒºåŸŸçš„ç½‘ç»œæ‹“æ‰‘çš„æƒ…å†µã€‚ä¸ºäº†ä½¿æ¯ä¸€ä¸ªåŒºåŸŸèƒ½å¤Ÿå’Œæœ¬åŒºåŸŸä»¥å¤–çš„åŒºåŸŸè¿›è¡Œé€šä¿¡ã€‚OSPFä½¿ç”¨å±‚æ¬¡ç»“æ„çš„åŒºåŸŸåˆ’åˆ†ã€‚åœ¨ä¸Šå±‚çš„åŒºåŸŸå«ä½œä¸»å¹²åŒºåŸŸ(backbonearea)ã€‚ä¸»å¹²åŒºåŸŸçš„æ ‡è¯†ç¬¦è§„å®šä¸º0.0.0.0ã€‚ä¸»å¹²åŒºåŸŸçš„ä½œç”¨æ˜¯ç”¨æ¥è¿é€šå…¶ä»–åœ¨ä¸‹å±‚çš„åŒºåŸŸã€‚ä»å…¶ä»–åŒºåŸŸæ¥çš„ä¿¡æ¯éƒ½ç”±åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨è¿›è¡Œæ¦‚æ‹¬ï¼Œæ¯ä¸ªåŒºåŸŸè‡³å°‘ä¸€ä¸ªåŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ï¼Œåœ¨ä¸»å¹²åŒºåŸŸå†…çš„è·¯ç”±å™¨å«åšä¸»å¹²è·¯ç”±å™¨ï¼Œä¸€ä¸ªè·¯ç”±å™¨æ—¢å¯ä»¥æ˜¯åŒºåŸŸè¾¹ç•Œè·¯ç”±å™¨ä¹Ÿå¯ä»¥æ˜¯ä¸»å¹²è·¯ç”±å™¨ï¼Œåœ¨ä¸»å¹²åŒºåŸŸå†…è¿˜è¦æœ‰ä¸€ä¸ªè·¯ç”±å™¨ä¸“é—¨å’Œè‡ªæ²»ç³»ç»Ÿå¤–çš„å…¶ä»–è‡ªæ²»ç³»ç»Ÿäº¤æ¢è·¯ç”±ä¿¡æ¯ï¼Œè¿™æ ·çš„è·¯ç”±å«åšè‡ªæ²»ç³»ç»Ÿè¾¹ç•Œè·¯ç”±å™¨</li>\n<li>OSPFåˆ†ç»„ï¼šä½¿ç”¨IPæ•°æ®æŠ¥ä¼ é€ï¼ŒIPæ•°æ®æŠ¥é¦–éƒ¨çš„åè®®å­—æ®µä¸º89ï¼Œä½¿ç”¨24å­—èŠ‚çš„å›ºå®šé¦–éƒ¨é•¿åº¦<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2267913f15f5a39da05b8.png\" alt=\"32.PNG\">\n<ul>\n<li>ç‰ˆæœ¬å·--å½“å‰ç‰ˆæœ¬å·2ã€‚</li>\n<li>ç±»å‹--OSPFåˆ†ç»„5ç§ç±»å‹ä¸­çš„å“ªä¸€ç§ã€‚</li>\n<li>åˆ†ç»„é•¿åº¦--åŒ…æ‹¬OSPFå¤´åœ¨å†…çš„åˆ†ç»„çš„é•¿åº¦ã€‚ä»¥å­—èŠ‚ä¸ºå•ä½</li>\n<li>è·¯ç”±å™¨æ ‡è¯†ç¬¦--æ ‡å¿—å‘é€è¯¥åˆ†ç»„çš„è·¯ç”±å™¨çš„æ¥å£çš„IPåœ°å€</li>\n<li>åŒºåŸŸæ ‡è¯†ç¬¦--åˆ†ç»„æ‰€å±çš„åŒºåŸŸæ ‡è¯†ç¬¦</li>\n<li>æ ¡éªŒå’Œ--åŒ…å«æœ‰é™¤äº†å¯¹æ•°æ®æŸåçš„è®¤è¯éƒ¨åˆ†ä¹‹å¤–çš„æ•´ä¸ªOSPFåˆ†ç»„çš„æ ¡éªŒã€‚æ£€éªŒåˆ†ç»„ä¸­çš„å·®é”™</li>\n<li>é‰´åˆ«ç±»å‹--åŒ…å«æœ‰è®¤è¯çš„ç±»å‹ç ï¼š0æ²¡æœ‰è®¤è¯ï¼ˆnull authenticationï¼‰ã€‚1ä¸ºæ™®é€šæ–‡æœ¬ï¼ˆå£ä»¤ï¼‰ã€‚2ä¸ºMD5</li>\n<li>é‰´åˆ«ï¼šé‰´åˆ«ç±»å‹ä¸º0å°±å¡«å…¥0ï¼Œé‰´åˆ«ç±»å‹ä¸º1åˆ™å¡«å…¥8ä¸ªå­—ç¬¦çš„å£ä»¤</li>\n</ul>\n</li>\n<li>OSPFå…±æœ‰ä»¥ä¸‹äº”ç§åˆ†ç»„ç±»å‹ï¼š\n<ul>\n<li>ç±»å‹1ï¼Œé—®å€™(Hello)åˆ†ç»„ï¼Œç”¨æ¥å‘ç°å’Œç»´æŒé‚»ç«™çš„å¯è¾¾æ€§ã€‚</li>\n<li>ç±»å‹2ï¼Œæ•°æ®åº“æè¿°(Database Description)åˆ†ç»„ï¼Œå‘é‚»ç«™ç»™å‡ºè‡ªå·±çš„é“¾è·¯çŠ¶æ€æ•°æ®åº“ä¸­çš„æ‰€æœ‰é“¾è·¯çŠ¶æ€é¡¹ç›®çš„æ‘˜è¦ä¿¡æ¯ã€‚</li>\n<li>ç±»å‹3ï¼Œé“¾è·¯çŠ¶æ€è¯·æ±‚(Link State Request)åˆ†ç»„ï¼Œå‘å¯¹æ–¹è¯·æ±‚å‘é€æŸäº›é“¾è·¯çŠ¶æ€é¡¹æ›°çš„è¯¦ç»†ä¿¡æ¯ã€‚</li>\n<li>ç±»å‹4ï¼Œé“¾è·¯çŠ¶æ€æ›´æ–°(Link State Update)åˆ†ç»„ï¼Œç”¨æ´ªæ³›æ³•å¯¹å…¨ç½‘æ›´æ–°é“¾è·¯çŠ¶æ€ã€‚è·¯ç”±å™¨ä½¿ç”¨è¿™ç§åˆ†ç»„å°†å…¶é“¾è·¯çŠ¶æ€é€šçŸ¥ç»™é‚»ç«™</li>\n<li>ç±»å‹5ï¼Œé“¾è·¯çŠ¶æ€ç¡®è®¤(Link State Acknowledgment)åˆ†ç»„ï¼Œå¯¹é“¾è·¯æ›´æ–°åˆ†ç»„çš„ç¡®è®¤ã€‚</li>\n</ul>\n</li>\n<li>OSPFçš„å…¶ä»–ç‰¹ç‚¹\n<ul>\n<li>OSPFå…è®¸ç®¡ç†å‘˜ç»™æ¯æ¡è·¯ç”±æŒ‡æ´¾ä¸åŒçš„ä»£ä»·ã€‚å¯¹äºä¸åŒç±»å‹çš„ä¸šåŠ¡å¯è®¡ç®—å‡ºä¸åŒçš„è·¯ç”±ã€‚</li>\n<li>å¦‚æœåˆ°åŒä¸€ä¸ªç›®çš„ç½‘ç»œæœ‰å¤šæ¡ç›¸åŒä»£ä»·çš„è·¯å¾„ï¼Œé‚£ä¹ˆå¯ä»¥å°†é€šä¿¡é‡åˆ†é…ç»™è¿™å‡ æ¡è·¯å¾„ã€‚è¿™å«ä½œå¤šè·¯å¾„é—´çš„è´Ÿè½½å¹³è¡¡(load balancing)ã€‚</li>\n<li>æ‰€æœ‰åœ¨OSPFè·¯ç”±å™¨ä¹‹é—´äº¤æ¢çš„åˆ†ç»„ï¼ˆä¾‹å¦‚ï¼Œé“¾è·¯çŠ¶æ€æ›´æ–°åˆ†ç»„ï¼‰éƒ½å…·æœ‰é‰´åˆ«çš„åŠŸèƒ½ï¼Œå› è€Œä¿è¯äº†ä»…åœ¨å¯ä¿¡èµ–çš„è·¯ç”±å™¨ä¹‹é—´äº¤æ¢é“¾è·¯çŠ¶æ€ä¿¡æ¯ã€‚</li>\n<li>OSPFæ”¯æŒå¯å˜é•¿åº¦çš„å­ç½‘åˆ’åˆ†å’Œæ— åˆ†ç±»çš„ç¼–å€CIDRã€‚</li>\n<li>ç”±äºç½‘ç»œä¸­çš„é“¾è·¯çŠ¶æ€å¯èƒ½ç»å¸¸å‘ç”Ÿå˜åŒ–ï¼ŒOSPFè®©æ¯ä¸€ä¸ªé“¾è·¯çŠ¶æ€éƒ½å¸¦ä¸Šä¸€ä¸ª32ä½çš„åºå·ï¼Œåºå·è¶Šå¤§çŠ¶æ€å°±è¶Šæ–°ã€‚</li>\n</ul>\n</li>\n<li>OSPFçš„åŸºæœ¬æ“ä½œ\n<ul>\n<li>OSPFè§„å®šï¼Œæ¯ä¸¤ä¸ªç›¸é‚»è·¯ç”±å™¨æ¯éš”10ç§’é’Ÿè¦äº¤æ¢ä¸€æ¬¡é—®å€™åˆ†ç»„ç¡®çŸ¥é‚»ç«™æ˜¯å¯è¾¾çš„ã€‚å› ä¸ºåªæœ‰å¯è¾¾é‚»ç«™çš„é“¾è·¯çŠ¶æ€ä¿¡æ¯æ‰å­˜å…¥é“¾è·¯çŠ¶æ€æ•°æ®åº“ï¼ˆè·¯ç”±è¡¨å°±æ˜¯æ ¹æ®é“¾è·¯çŠ¶æ€æ•°æ®åº“è®¡ç®—å‡ºæ¥çš„ï¼‰ã€‚è‹¥æœ‰40ç§’é’Ÿæ²¡æœ‰æ”¶åˆ°æŸä¸ªç›¸é‚»è·¯ç”±å™¨å‘æ¥çš„é—®å€™åˆ†ç»„ï¼Œåˆ™å¯è®¤ä¸ºè¯¥ç›¸é‚»è·¯ç”±å™¨æ˜¯ä¸å¯è¾¾çš„ï¼Œåº”ç«‹å³ä¿®æ”¹é“¾è·¯çŠ¶æ€æ•°æ®åº“ï¼Œå¹¶é‡æ–°è®¡ç®—è·¯ç”±è¡¨ã€‚</li>\n<li>å…¶ä»–çš„å››ç§åˆ†ç»„éƒ½æ˜¯ç”¨æ¥è¿›è¡Œé“¾è·¯çŠ¶æ€æ•°æ®åº“çš„åŒæ­¥ã€‚åŒæ­¥å°±æ˜¯æŒ‡ä¸åŒè·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€æ•°æ®åº“çš„å†…å®¹æ˜¯ä¸€æ ·çš„ã€‚ä¸¤ä¸ªåŒæ­¥çš„è·¯ç”±å™¨å«åšâ€œå®Œå…¨é‚»æ¥çš„â€(fully adjacent)è·¯ç”±å™¨ã€‚</li>\n<li>å½“ä¸€ä¸ªè·¯ç”±å™¨åˆšå¼€å§‹å·¥ä½œæ—¶ï¼Œä¸ºäº†å‡å°‘å¼€é”€ï¼ŒOSPFè®©æ¯ä¸€ä¸ªè·¯ç”±å™¨ç”¨æ•°æ®åº“æè¿°åˆ†ç»„å’Œç›¸é‚»è·¯ç”±å™¨äº¤æ¢æœ¬æ•°æ®åº“ä¸­å·²æœ‰çš„é“¾è·¯çŠ¶æ€æ‘˜è¦ä¿¡æ¯ï¼ˆä¸»è¦å°±æ˜¯æŒ‡å‡ºæœ‰å“ªäº›è·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€ä¿¡æ¯ï¼ˆä»¥åŠå…¶åºå·ï¼‰å·²ç»å†™å…¥äº†æ•°æ®åº“ï¼‰ã€‚ç»è¿‡ä¸ç›¸é‚»è·¯ç”±å™¨äº¤æ¢æ•°æ®åº“æè¿°åˆ†ç»„åï¼Œè·¯ç”±å™¨å°±ä½¿ç”¨é“¾è·¯çŠ¶æ€è¯·æ±‚åˆ†ç»„ï¼Œå‘å¯¹æ–¹è¯·æ±‚å‘é€è‡ªå·±æ‰€ç¼ºå°‘çš„æŸäº›é“¾è·¯çŠ¶æ€é¡¹ç›®çš„è¯¦ç»†ä¿¡æ¯ã€‚é€šè¿‡ä¸€ç³»åˆ—çš„è¿™ç§åˆ†ç»„äº¤æ¢ï¼Œå…¨ç½‘åŒæ­¥çš„é“¾è·¯æ•°æ®åº“å°±å»ºç«‹äº†</li>\n<li>åœ¨ç½‘ç»œè¿è¡Œçš„è¿‡ç¨‹ä¸­ï¼Œåªè¦ä¸€ä¸ªè·¯ç”±å™¨çš„é“¾è·¯çŠ¶æ€å‘ç”Ÿå˜åŒ–ï¼Œè¯¥è·¯ç”±å™¨å°±è¦ä½¿ç”¨é“¾è·¯çŠ¶æ€æ›´æ–°åˆ†ç»„ï¼Œç”¨å¯é çš„æ´ªæ³›æ³•å‘å…¨ç½‘æ›´æ–°é“¾è·¯çŠ¶æ€ã€‚</li>\n<li>ä¸ºäº†ç¡®ä¿é“¾è·¯çŠ¶æ€æ•°æ®åº“ä¸å…¨ç½‘ä¿æŒä¸€è‡´ï¼ŒOSPFè¿˜è§„å®šæ¯éš”ä¸€æ®µæ—¶é—´ï¼ˆå¦‚30åˆ†é’Ÿï¼‰å°±è¦åˆ·æ–°ä¸€æ¬¡æ•°æ®åº“ä¸­çš„é“¾è·¯çŠ¶æ€</li>\n<li>OSPFåè®®å¯¹å¤šç‚¹æ¥å…¥çš„å±€åŸŸç½‘é‡‡ç”¨äº†æŒ‡å®šçš„è·¯ç”±å™¨çš„æ–¹æ³•ï¼Œä½¿å¹¿æ’­çš„ä¿¡æ¯é‡å¤§å¤§å‡å°‘ã€‚æŒ‡å®šçš„è·¯ç”±å™¨ä»£è¡¨è¯¥å±€åŸŸç½‘ä¸Šæ‰€æœ‰çš„é“¾è·¯å‘è¿æ¥åˆ°è¯¥ç½‘ç»œçš„å„è·¯ç”±å™¨å‘é€çš„çŠ¶æ€ä¿¡æ¯<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e7e37152fa4c50bf2cb28.png\" alt=\"51.PNG\"></li>\n</ul>\n</li>\n</ul>\n<h2>4.8. å¤–éƒ¨ç½‘å…³åè®®BGP</h2>\n<ul>\n<li>BGPä½¿ç”¨åŸå› ï¼šå› ç‰¹ç½‘è§„æ¨¡å¤ªå¤§ï¼Œä½¿å¾—ASä¹‹é—´è·¯ç”±é€‰æ‹©éå¸¸å›°éš¾ï¼ŒASä¹‹é—´çš„è·¯ç”±é€‰æ‹©å¿…é¡»è€ƒè™‘æœ‰å…³ç­–ç•¥</li>\n<li>BGPæ˜¯ä¸åŒè‡ªæ²»ç³»ç»Ÿçš„è·¯ç”±å™¨ä¹‹é—´äº¤æ¢è·¯ç”±ä¿¡æ¯çš„åè®®ã€‚é‡‡ç”¨è·¯å¾„å‘é‡è·¯ç”±é€‰æ‹©åè®®</li>\n<li>BGPå‘è¨€äºº(BGPspeaker)\n<ul>\n<li>æ¯ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿçš„ç®¡ç†å‘˜è¦é€‰æ‹©è‡³å°‘ä¸€ä¸ªè·¯ç”±å™¨ä½œä¸ºè¯¥è‡ªæ²»ç³»ç»Ÿçš„â€œBGPå‘è¨€äººâ€ã€‚ä¸¤ä¸ªBGPå‘è¨€äººéƒ½æ˜¯é€šè¿‡ä¸€ä¸ªå…±äº«ç½‘ç»œè¿æ¥åœ¨ä¸€èµ·çš„ï¼Œè€ŒBGPå‘è¨€äººå¾€å¾€å°±æ˜¯BGPè¾¹ç•Œè·¯ç”±å™¨ï¼Œä¸€ä¸ªBGPå‘è¨€äººä¸å…¶ä»–è‡ªæ²»ç³»ç»Ÿä¸­çš„BGPå‘è¨€äººè¦äº¤æ¢è·¯ç”±ä¿¡æ¯ï¼Œå°±è¦å…ˆå»ºç«‹TCPè¿æ¥ï¼Œç„¶ååœ¨æ­¤è¿æ¥ä¸Šäº¤æ¢BGPæŠ¥æ–‡ä»¥å»ºç«‹BGPä¼šè¯(session)ï¼Œåˆ©ç”¨BGPä¼šè¯äº¤æ¢è·¯ç”±ä¿¡æ¯ã€‚å½“BGPå‘è¨€äººäº’ç›¸äº¤æ¢äº†ç½‘ç»œå¯è¾¾æ€§çš„ä¿¡æ¯ï¼ˆåˆ°è¾¾æŸä¸ªç½‘ç»œï¼ˆä½¿ç”¨ç½‘ç»œå‰ç¼€è¡¨ç¤ºï¼‰æ‰€è¦ç»è¿‡çš„ä¸€ç³»åˆ—è‡ªæ²»ç³»ç»Ÿï¼‰åï¼Œå„BGPå‘è¨€äººå°±æ ¹æ®æ‰€é‡‡ç”¨çš„ç­–ç•¥ä»æ”¶åˆ°çš„è·¯ç”±ä¿¡æ¯ä¸­æ‰¾å‡ºåˆ°è¾¾å„ASçš„è¾ƒå¥½è·¯ç”±ã€‚</li>\n</ul>\n</li>\n<li>BGPæŠ¥æ–‡(ç«¯å£å·179)<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f4447060bd5a6795d4412.png\" alt=\"33.PNG\">\n<ul>\n<li>å››ç§ç±»å‹çš„BGPæŠ¥æ–‡å…·æœ‰åŒæ ·çš„é€šç”¨é¦–éƒ¨ï¼Œå…¶é•¿åº¦ä¸º19å­—èŠ‚ã€‚é€šç”¨é¦–éƒ¨åˆ†ä¸ºä¸‰ä¸ªå­—æ®µã€‚\n<ul>\n<li>æ ‡è®°(marker)å­—æ®µä¸º16å­—èŠ‚é•¿ï¼Œç”¨æ¥é‰´åˆ«æ”¶åˆ°çš„BGPæŠ¥æ–‡ã€‚å½“ä¸ä½¿ç”¨é‰´åˆ«æ—¶ï¼Œæ ‡è®°å­—æ®µè¦ç½®ä¸ºå…¨1ã€‚</li>\n<li>é•¿åº¦å­—æ®µæŒ‡å‡ºåŒ…æ‹¬é€šç”¨é¦–éƒ¨åœ¨å†…çš„æ•´ä¸ªBGPæŠ¥æ–‡ä»¥å­—èŠ‚ä¸ºå•ä½çš„é•¿åº¦ï¼Œæœ€å°å€¼æ˜¯19ï¼Œæœ€å¤§å€¼æ˜¯4096ã€‚</li>\n<li>ç±»å‹å­—æ®µçš„å€¼ä¸ºlåˆ°4ï¼Œåˆ†åˆ«å¯¹åº”äºä¸Šè¿°å››ç§BGPæ’®æ–‡ä¸­çš„ä¸€ç§ã€‚</li>\n</ul>\n</li>\n<li>OPENæŠ¥æ–‡ï¼šå…±æœ‰6ä¸ªå­—æ®µï¼Œå³ç‰ˆæœ¬ï¼ˆ1å­—èŠ‚ï¼Œå€¼æ˜¯4ï¼‰ã€æœ¬è‡ªæ²»ç³»ç»Ÿå·ï¼ˆ2å­—èŠ‚ï¼Œä½¿ç”¨å…¨çƒå”¯ä¸€çš„16ä½è‡ªæ²»ç³»ç»Ÿå·ï¼Œç”±ICANNåœ°åŒºç™»è®°æœºæ„åˆ†é…ï¼‰ã€ä¿æŒæ—¶é—´ï¼ˆ2å­—èŠ‚ï¼Œä»¥ç§’è®¡ç®—çš„ä¿æŒä¸ºé‚»ç«™å…³ç³»çš„æ—¶é—´ï¼‰ã€BGPæ ‡è¯†ç¬¦ï¼ˆ4å­—èŠ‚ï¼Œè¯¥è·¯ç”±å™¨çš„IPåœ°å€ï¼‰ã€å¯é€‰å‚æ•°é•¿åº¦ï¼ˆ1å­—èŠ‚ï¼‰å’Œå¯é€‰å‚æ•°ã€‚ç”¨æ¥ä¸ç›¸é‚»çš„å¦ä¸€ä¸ªBGPå‘è¨€äººå»ºç«‹å…³ç³»ã€‚ä½¿é€šä¿¡åˆå§‹åŒ–</li>\n<li>UPDATEæŠ¥æ–‡å…±æœ‰5ä¸ªå­—æ®µï¼Œå³ä¸å¯è¡Œè·¯ç”±é•¿åº¦ï¼ˆ2å­—èŠ‚ï¼ŒæŒ‡æ˜ä¸‹ä¸€ä¸ªå­—æ®µçš„é•¿åº¦ï¼‰ã€æ’¤æ¶ˆçš„è·¯ç”±ï¼ˆåˆ—å‡ºæ‰€æœ‰è¦æ’¤æ¶ˆçš„è·¯ç”±ï¼‰ã€è·¯å¾„å±æ€§æ€»é•¿åº¦ï¼ˆ2å­—èŠ‚ï¼ŒæŒ‡æ˜Fä¸€ä¸ªå­—æ®µçš„é•¿åº¦ï¼‰ã€è·¯å¾„å±æ€§ï¼ˆå®šä¹‰åœ¨è¿™ä¸ªæŠ¥æ–‡ä¸­å¢åŠ çš„è·¯å¾„çš„å±æ€§ï¼‰å’Œç½‘ç»œå±‚å¯è¾¾æ€§ä¿¡æ¯NLRI(Network Layer Reachability Information)ã€‚æœ€åè¿™ä¸ªå­—æ®µå®šä¹‰å‘å‡ºæ­¤æŠ¥æ–‡çš„ç½‘ç»œï¼ŒåŒ…æ‹¬ç½‘ç»œå‰ç¼€çš„ä½æ•°ã€IPåœ°å€å‰ç¼€ã€‚ç”¨æ¥å‘é€æŸä¸€è·¯ç”±çš„ä¿¡æ¯ï¼Œä»¥åŠåˆ—å‡ºè¦æ’¤æ¶ˆçš„å¤šæ¡è·¯ç”±ã€‚</li>\n<li>KEEPALIVEæŠ¥æ–‡åªæœ‰BGPçš„19å­—èŠ‚é•¿çš„é€šç”¨é¦–éƒ¨ã€‚ç”¨æ¥ç¡®è®¤æ‰“å¼€æŠ¥æ–‡å’Œå‘¨æœŸæ€§åœ°è¯å®é‚»ç«™å…³ç³»ã€‚</li>\n<li>NOTIFICATIONæŠ¥æ–‡æœ‰3ä¸ªå­—æ®µï¼Œå³å·®é”™ä»£ç ï¼ˆ1å­—èŠ‚ï¼‰ã€å·®é”™å­ä»£ç ï¼ˆ1å­—èŠ‚ï¼‰å’Œå·®é”™æ•°æ®ï¼ˆç»™å‡ºæœ‰å…³å·®é”™çš„è¯Šæ–­ä¿¡æ¯ï¼‰ï¼Œç”¨æ¥å‘é€æ£€æµ‹åˆ°çš„å·®é”™</li>\n<li>ROUTE-REFRESHæŠ¥æ–‡ï¼Œåªæœ‰4å­—èŠ‚é•¿ï¼Œä¸é‡‡ç”¨BGPæŠ¥æ–‡æ ¼å¼ï¼Œè¯·æ±‚å¯¹ç­‰ç«¯é‡æ–°é€šå‘Š</li>\n</ul>\n</li>\n<li>BGPåè®®çš„ç‰¹ç‚¹\n<ul>\n<li>BGPåè®®äº¤æ¢è·¯ç”±ä¿¡æ¯çš„ç»“ç‚¹æ•°é‡çº§æ˜¯è‡ªæ²»ç³»ç»Ÿä¸ªæ•°çš„é‡çº§ï¼Œè¿™è¦æ¯”è¿™äº›è‡ªæ²»ç³»ç»Ÿä¸­çš„ç½‘ç»œæ•°å°‘å¾ˆå¤šã€‚\tæ¯ä¸€ä¸ªè‡ªæ²»ç³»ç»Ÿä¸­BGPå‘è¨€äººï¼ˆæˆ–è¾¹ç•Œè·¯ç”±å™¨ï¼‰çš„æ•°ç›®æ˜¯å¾ˆå°‘çš„ã€‚è¿™æ ·å°±ä½¿å¾—è‡ªæ²»ç³»ç»Ÿä¹‹é—´çš„è·¯ç”±é€‰æ‹©ä¸è‡´è¿‡åˆ†å¤æ‚ã€‚</li>\n<li>BGPæ”¯æŒCIDRï¼Œå› æ­¤BGPçš„è·¯ç”±è¡¨ä¹Ÿå°±åº”å½“åŒ…æ‹¬ç›®çš„ç½‘ç»œå‰ç¼€ã€ä¸‹ä¸€è·³è·¯ç”±å™¨ï¼Œä»¥åŠåˆ°è¾¾è¯¥ç›®çš„ç½‘ç»œæ‰€è¦ç»è¿‡çš„å„ä¸ªè‡ªæ²»ç³»ç»Ÿåºåˆ—ã€‚ç”±äºä½¿ç”¨äº†è·¯å¾„å‘é‡ä¿¡æ¯ã€‚å°±å¯ä»¥å¾ˆå®¹æ˜“åœ°é¿å…äº§ç”Ÿå…œåœˆå­çš„è·¯ç”±ã€‚å¦‚æœä¸€ä¸ªBGPå‘è¨€äººæ”¶åˆ°äº†å…¶ä»–BGPå‘è¨€äººå‘æ¥çš„è·¯å¾„é€šçŸ¥ï¼Œå®ƒè¦æ£€æŸ¥ä¸€ä¸‹æœ¬è‡ªæ²»ç³»ç»Ÿæ˜¯å¦åœ¨æ­¤é€šçŸ¥çš„è·¯å¾„ä¸­ï¼Œå¦‚æœåœ¨è¿™æ¡è·¯å¾„ä¸­ï¼Œå°±ä¸èƒ½é‡‡ç”¨è¿™æ¡è·¯å¾„</li>\n<li>åœ¨BGPåˆšåˆšè¿è¡Œæ—¶ï¼ŒBGPçš„é‚»ç«™æ˜¯äº¤æ¢æ•´ä¸ªçš„BGPè·¯ç”±è¡¨ã€‚ä½†ä»¥ååªéœ€è¦åœ¨å‘ç”Ÿå˜åŒ–æ—¶æ›´æ–°æœ‰å˜åŒ–çš„éƒ¨åˆ†ã€‚èŠ‚çœç½‘ç»œå¸¦å®½å’Œè·¯ç”±å™¨çš„å¤„ç†å¼€é”€ã€‚</li>\n<li>ä¸¤ä¸ªä¸åŒASå®šæœŸåœ°äº¤æ¢è·¯ç”±ä¿¡æ¯ï¼Œæœ‰ä¸€ä¸ªå•†è°ˆçš„è¿‡ç¨‹ï¼ˆå› ä¸ºå¾ˆå¯èƒ½å¯¹æ–¹è·¯ç”±å™¨çš„è´Ÿè·å·²å¾ˆé‡ï¼Œå› è€Œä¸æ„¿æ„å†åŠ é‡è´Ÿæ‹…ï¼‰ã€‚å› æ­¤ï¼Œä¸€å¼€å§‹å‘é‚»ç«™è¿›è¡Œå•†è°ˆæ—¶å°±å¿…é¡»å‘é€OPENæŠ¥æ–‡ã€‚å¦‚æœé‚»ç«™æ¥å—è¿™ç§é‚»ç«™å…³ç³»ï¼Œå°±ç”¨KEEPALIVEæ’®æ–‡å“åº”ã€‚è¿™æ ·,ä¸¤ä¸ªBGPå‘è¨€äººçš„é‚»ç«™å…³ç³»å°±å»ºç«‹,ä¸€æ—¦é‚»ç«™å…³ç³»å»ºç«‹äº†ï¼Œå°±è¦ç»§ç»­ç»´æŒè¿™ç§å…³ç³»ã€‚åŒæ–¹ä¸­çš„æ¯ä¸€æ–¹éƒ½éœ€è¦ç¡®ä¿¡å¯¹æ–¹æ˜¯å­˜åœ¨çš„ï¼Œä¸”ä¸€ç›´åœ¨ä¿æŒè¿™ç§é‚»ç«™å…³ç³»ã€‚ä¸ºæ­¤ï¼Œè¿™ä¸¤ä¸ªBGPå‘è¨€äººå½¼æ­¤è¦å‘¨æœŸæ€§åœ°äº¤æ¢KEEPALIVEæŠ¥æ–‡ï¼ˆä¸€èˆ¬æ¯éš”30ç§’ï¼‰ã€‚KEEPALIVEæŠ¥æ–‡åªæœ‰19å­—èŠ‚é•¿ï¼ˆåªç”¨BGPæŠ¥æ–‡çš„é€šç”¨é¦–éƒ¨ï¼‰å› æ­¤ä¸ä¼šé€ æˆç½‘ç»œä¸Šå¤ªå¤§çš„å¼€é”€ã€‚</li>\n<li>BGPå‘è¨€äººå¯ä»¥ç”¨UPDATEæŠ¥æ–‡æ’¤æ¶ˆå®ƒä»¥å‰æ›¾ç»é€šçŸ¥è¿‡çš„è·¯ç”±ï¼Œä¹Ÿå¯ä»¥å®£å¸ƒå¢åŠ æ–°çš„è·¯ç”±ã€‚æ’¤æ¶ˆè·¯ç”±å¯ä»¥ä¸€æ¬¡æ’¤æ¶ˆè®¸å¤šæ¡ï¼Œä½†å¢åŠ æ–°è·¯ç”±æ—¶ï¼Œæ¯ä¸ªæ›´æ–°æŠ¥æ–‡åªèƒ½å¢åŠ ä¸€æ¡</li>\n<li>BGPå¯ä»¥å¾ˆå®¹æ˜“åœ°è§£å†³è·ç¦»å‘é‡è·¯ç”±é€‰æ‹©ç®—æ³•ä¸­\"åæ¶ˆæ¯ä¼ æ’­å¾—æ…¢\"çš„é—®é¢˜ã€‚å½“æŸä¸ªè·¯ç”±å™¨æˆ–é“¾è·¯å‡ºç°æ•…éšœæ—¶ï¼Œç”±äºBGPå‘è¨€äººå¯ä»¥ä»ä¸æ­¢ä¸€ä¸ªé‚»ç«™è·å¾—è·¯ç”±ä¿¡æ¯ï¼Œå› æ­¤å¾ˆå®¹æ˜“é€‰æ‹©å‡ºæ–°çš„è·¯ç”±ã€‚è·ç¦»å‘é‡ç®—æ³•å¾€å¾€ä¸èƒ½ç»™å‡ºæ­£ç¡®é€‰æ‹©ï¼Œå› ä¸ºè¿™äº›ç®—æ³•ä¸èƒ½æ”¯æŒå“ªäº›é‚»ç«™åˆ°ç›®çš„ç«™çš„è·¯ç”±æ˜¯ç‹¬ç«‹çš„</li>\n</ul>\n</li>\n</ul>\n<h2>4.9. è·¯ç”±å™¨çš„æ„æˆ</h2>\n<ul>\n<li>è·¯ç”±åªæœ‰ç½‘ç»œå±‚å’Œç½‘ç»œæ¥å£å±‚</li>\n<li>macåœ°å€è¡¨ï¼šmacåœ°å€æ˜ å°„åˆ°ç¡¬ä»¶æ¥å£</li>\n<li>è·¯ç”±å™¨æ˜¯ä¸€ç§å…·æœ‰å¤šä¸ªè¾“å…¥ç«¯å£å’Œå¤šä¸ªè¾“å‡ºç«¯å£çš„ä¸“ç”¨è®¡ç®—æœºï¼Œå…¶ä»»åŠ¡æ˜¯è½¬å‘åˆ†ç»„ã€‚ä»è·¯ç”±å™¨æŸä¸ªè¾“å…¥ç«¯å£æ”¶åˆ°çš„åˆ†ç»„ï¼ŒæŒ‰ç…§åˆ†ç»„è¦å»çš„ç›®çš„åœ°ï¼ˆå³ç›®çš„ç½‘ç»œï¼‰ï¼ŒæŠŠè¯¥åˆ†ç»„ä»è·¯ç”±å™¨çš„æŸä¸ªåˆé€‚çš„è¾“å‡ºç«¯å£è½¬å‘ç»™ä¸‹ä¸€è·³è·¯ç”±å™¨ã€‚ä¸‹ä¸€è·³è·¯ç”±å™¨ä¹ŸæŒ‰ç…§è¿™ç§æ–¹æ³•å¤„ç†åˆ†ç»„ï¼Œç›´åˆ°è¯¥åˆ†ç»„åˆ°è¾¾ç»ˆç‚¹ä¸ºæ­¢ã€‚è·¯ç”±å™¨çš„è½¬å‘åˆ†ç»„æ­£æ˜¯ç½‘ç»œå±‚çš„ä¸»è¦å·¥ä½œ</li>\n<li>è·¯ç”±å™¨ç»“æ„å¯ä»¥åˆ†ä¸ºè·¯ç”±é€‰æ‹©(æ§åˆ¶)éƒ¨åˆ†å’Œåˆ†ç»„è½¬å‘éƒ¨åˆ†\n<ul>\n<li>åˆ†ç»„è½¬å‘éƒ¨åˆ†å¯ä»¥æ”¯æŒå¤šç§é€šä¿¡æŠ€æœ¯ï¼ŒADSLã€FTTHï¼Œä»¥åŠå„ç§å®½å¸¦ä¸“çº¿ç­‰ï¼Œåªè¦ç«¯å£æ¨¡å—å®‰è£…äº†æ”¯æŒè¿™äº›æŠ€æœ¯çš„ç¡¬ä»¶å³å¯ã€‚</li>\n</ul>\n</li>\n<li>è·¯ç”±å™¨åœ¨è½¬å‘åŒ…æ—¶ï¼Œé¦–å…ˆä¼šé€šè¿‡ç«¯å£å°†å‘è¿‡æ¥çš„åŒ…æ¥æ”¶è¿›æ¥ï¼Œè¿™ä¸€æ­¥çš„å·¥ä½œè¿‡ç¨‹å–å†³äºç«¯å£å¯¹åº”çš„é€šä¿¡æŠ€æœ¯ã€‚å¯¹äºä»¥å¤ªç½‘ç«¯å£æ¥è¯´ï¼Œå°±æ˜¯æŒ‰ç…§ä»¥å¤ªç½‘è§„èŒƒè¿›è¡Œå·¥ä½œï¼Œè€Œæ— çº¿å±€åŸŸç½‘ç«¯å£åˆ™æŒ‰ç…§æ— çº¿å±€åŸŸç½‘çš„è§„èŒƒå·¥ä½œï¼Œæ€»ä¹‹å°±æ˜¯å§”æ‰˜ç«¯å£çš„ç¡¬ä»¶å°†åŒ…æ¥æ”¶è¿›æ¥ã€‚æ¥ä¸‹æ¥ï¼Œåˆ†ç»„è½¬å‘éƒ¨åˆ†ä¼šæ ¹æ®æ¥æ”¶åˆ°çš„åŒ…çš„ IP å¤´éƒ¨ä¸­è®°å½•çš„æ¥æ”¶æ–¹ IP åœ°å€ï¼Œåœ¨è·¯ç”±è¡¨ä¸­è¿›è¡ŒæŸ¥è¯¢ï¼Œä»¥æ­¤åˆ¤æ–­è½¬å‘ç›®æ ‡ã€‚ç„¶åï¼Œåˆ†ç»„è½¬å‘éƒ¨åˆ†å°†åŒ…è½¬ç§»åˆ°è½¬å‘ç›®æ ‡å¯¹åº”çš„ç«¯å£ï¼Œç«¯å£å†æŒ‰ç…§ç¡¬ä»¶çš„è§„åˆ™å°†åŒ…å‘é€å‡ºå»ï¼Œä¹Ÿå°±<br>\næ˜¯åˆ†ç»„è½¬å‘éƒ¨åˆ†å§”æ‰˜ç«¯å£æ¨¡å—å°†åŒ…å‘é€å‡ºå»çš„æ„æ€</li>\n<li>è·¯ç”±å™¨çš„ç«¯å£æœ‰IPåœ°å€å’ŒMACåœ°å€ï¼Œèƒ½å¤Ÿæˆä¸ºä»¥å¤ªç½‘çš„å‘é€æ–¹æˆ–è€…æ¥æ”¶æ–¹ï¼Œè€Œäº¤æ¢æœºåªè´Ÿè´£è½¬å‘ï¼Œä¸èƒ½æˆä¸ºå‘é€æ–¹æˆ–è€…æ¥æ”¶æ–¹ã€‚åªæ¥æ”¶ä¸è‡ªèº«åœ°å€åŒ¹é…çš„åŒ…ï¼Œé‡åˆ°ä¸åŒ¹é…çš„åŒ…åˆ™ç›´æ¥ä¸¢å¼ƒã€‚</li>\n<li>è·¯ç”±å™¨æ ¹æ®IPåœ°å€è½¬å‘ã€‚è·¯ç”±å™¨ä¼šå¿½ç•¥ä¸»æœºå·ï¼ŒåªåŒ¹é…ç½‘ç»œå·ã€‚</li>\n<li>å¯¹è·¯ç”±è¡¨è¿›è¡Œç»´æŠ¤ã€‚æ ¹æ®è·¯ç”±åè®®æœºåˆ¶ï¼Œé€šè¿‡è·¯ç”±å™¨ä¹‹é—´çš„ä¿¡æ¯äº¤æ¢ç”±è·¯ç”±å™¨è‡ªè¡Œç»´æŠ¤è·¯ç”±è¡¨çš„è®°å½•</li>\n<li>é€šè¿‡è·¯ç”±å™¨è½¬å‘çš„ç½‘ç»œåŒ…ï¼Œå…¶æ¥æ”¶æ–¹ MAC åœ°å€ä¸ºè·¯ç”±å™¨ç«¯å£çš„ MAC åœ°å€ã€‚</li>\n<li>å¦‚æœåœ¨è·¯ç”±è¡¨ä¸­æ— æ³•æ‰¾åˆ°åŒ¹é…çš„è®°å½•ï¼Œè·¯ç”±å™¨ä¼šä¸¢å¼ƒè¿™ä¸ªåŒ…ï¼Œå¹¶é€šè¿‡ ICMP æ¶ˆæ¯å‘ŠçŸ¥å‘é€æ–¹ ã€‚</li>\n<li>æˆ‘ä»¬éœ€è¦çŸ¥é“è¾“å‡ºç«¯å£çš„ MTU ï¼Œçœ‹çœ‹è¿™ä¸ªåŒ…èƒ½ä¸èƒ½ä¸åˆ†ç‰‡ç›´æ¥å‘é€ã€‚æœ€å¤§åŒ…é•¿åº¦æ˜¯ç”±ç«¯å£ç±»å‹å†³å®šçš„ï¼Œç”¨è¿™ä¸ªæœ€å¤§é•¿åº¦å‡æ‰å¤´éƒ¨çš„é•¿åº¦å°±æ˜¯ MTUï¼Œå°† MTU ä¸è¦è½¬å‘çš„åŒ…é•¿åº¦è¿›è¡Œæ¯”è¾ƒã€‚å¦‚æœè¾“å‡ºç«¯å£çš„ MTU è¶³å¤Ÿå¤§ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸åˆ†ç‰‡ç›´æ¥å‘é€ï¼›å¦‚æœè¾“å‡ºç«¯å£çš„ MTU å¤ªå°ï¼Œé‚£ä¹ˆå°±éœ€è¦å°†åŒ…æŒ‰ç…§è¿™ä¸ª MTU è¿›è¡Œåˆ†ç‰‡ï¼Œä½†åœ¨æ­¤ä¹‹å‰è¿˜éœ€è¦çœ‹ä¸€ä¸‹ IP å¤´éƒ¨ä¸­çš„æ ‡å¿—å­—æ®µï¼Œç¡®è®¤æ˜¯å¦å¯ä»¥åˆ†ç‰‡ã€‚ä¸€èˆ¬æ¥è¯´éƒ½æ˜¯å¯ä»¥åˆ†ç‰‡çš„ï¼Œä½†ä¸‹é¢ä¸¤ç§æƒ…å†µä¸èƒ½åˆ†ç‰‡ï¼š1ï¼‰å‘é€æ–¹åº”ç”¨ç¨‹åºç­‰è®¾ç½®äº†ä¸å…è®¸åˆ†ç‰‡ï¼›2ï¼‰è¿™ä¸ªåŒ…å·²ç»æ˜¯ç»è¿‡åˆ†ç‰‡åçš„åŒ…ã€‚å¦‚æœæŸ¥è¯¢æ ‡å¿—å­—æ®µå‘ç°ä¸èƒ½åˆ†ç‰‡ï¼Œé‚£ä¹ˆå°±åªèƒ½ä¸¢å¼ƒè¿™ä¸ªåŒ…ï¼Œå¹¶é€šè¿‡ ICMP æ¶ˆæ¯é€šçŸ¥å‘é€æ–¹ã€‚å¦åˆ™ï¼Œå°±å¯ä»¥æŒ‰ç…§è¾“å‡ºç«¯å£ MTU å¯¹æ•°æ®è¿›è¡Œä¾æ¬¡æ‹†åˆ†äº†ã€‚åœ¨åˆ†ç‰‡ä¸­ï¼ŒTCP å¤´éƒ¨åŠå…¶åé¢çš„éƒ¨åˆ†éƒ½æ˜¯å¯åˆ†ç‰‡çš„æ•°æ®ï¼Œå°½ç®¡TCP å¤´éƒ¨ä¸å±äºç”¨æˆ·æ•°æ®ï¼Œä½†ä» IP æ¥çœ‹ä¹Ÿæ˜¯ TCP è¯·æ±‚ä¼ è¾“çš„æ•°æ®çš„ä¸€éƒ¨åˆ†ã€‚æ•°æ®è¢«æ‹†åˆ†åï¼Œæ¯ä¸€ä»½æ•°æ®å‰é¢ä¼šåŠ ä¸Š IP å¤´éƒ¨ï¼Œå…¶å¤§éƒ¨åˆ†å†…å®¹éƒ½å’ŒåŸæœ¬çš„ IP å¤´éƒ¨ä¸€æ¨¡ä¸€æ ·ï¼Œä½†å…¶ä¸­æœ‰éƒ¨åˆ†å­—æ®µéœ€è¦æ›´æ–°ï¼Œè¿™äº›å­—æ®µç”¨äº<br>\nè®°å½•åˆ†ç‰‡ç›¸å…³çš„ä¿¡æ¯ã€‚</li>\n<li>IPï¼ˆè·¯ç”±å™¨ï¼‰è´Ÿè´£å°†åŒ…é€è¾¾é€šä¿¡å¯¹è±¡è¿™ä¸€æ•´ä½“è¿‡ç¨‹ï¼Œè€Œå…¶ä¸­å°†åŒ…ä¼ è¾“åˆ°ä¸‹ä¸€ä¸ªè·¯ç”±å™¨çš„è¿‡ç¨‹åˆ™æ˜¯ç”±ä»¥<br>\nå¤ªç½‘ï¼ˆäº¤æ¢æœºï¼‰æ¥è´Ÿè´£çš„ã€‚</li>\n<li>åŒ…è¿‡æ»¤å°±æ˜¯åœ¨å¯¹åŒ…è¿›è¡Œè½¬å‘æ—¶ï¼Œæ ¹æ® MAC å¤´éƒ¨ã€IP å¤´éƒ¨ã€TCP å¤´éƒ¨çš„å†…å®¹ï¼ŒæŒ‰ç…§äº‹å…ˆè®¾ç½®å¥½çš„è§„åˆ™å†³å®šæ˜¯è½¬å‘è¿™ä¸ªåŒ…ï¼Œè¿˜æ˜¯ä¸¢å¼ƒè¿™ä¸ªåŒ…ã€‚æˆ‘ä»¬é€šå¸¸è¯´çš„é˜²ç«å¢™è®¾å¤‡æˆ–è½¯ä»¶ï¼Œå¤§å¤šæ•°éƒ½æ˜¯åˆ©ç”¨è¿™ä¸€æœºåˆ¶æ¥é˜²æ­¢éæ³•å…¥ä¾µçš„ ã€‚</li>\n</ul>\n<h2>4.10. è™šæ‹Ÿä¸“ç”¨ç½‘VPN</h2>\n<ul>\n<li>å› ç‰¹ç½‘ä¸­çš„æ‰€æœ‰è·¯ç”±å™¨ï¼Œå¯¹ç›®çš„åœ°å€æ˜¯ä¸“ç”¨åœ°å€ï¼ˆå¯é‡ç”¨åœ°å€ï¼‰çš„æ•°æ®æŠ¥ä¸€å¾‹ä¸è¿›è¡Œè½¬å‘ï¼Œé‡‡ç”¨ä¸“ç”¨IPåœ°å€çš„äº’è”ç½‘ç»œç§°ä¸ºä¸“ç”¨äº’è”ç½‘æˆ–è€…æœ¬åœ°äº’è”ç½‘/ä¸“ç”¨ç½‘ï¼Œä»…æœºæ„å†…éƒ¨ä½¿ç”¨ã€‚å†…ç½‘åœ°å€ï¼š\n<ul>\n<li>10.0.0.0åˆ°10.255.255.255(æˆ–è®°ä¸º10.0.0.0/8 ç§°ä¸º24ä½å—)</li>\n<li>172.16.0.0åˆ°172.31.255.255(æˆ–è®°ä¸º172.16.0.0/12 ç§°ä¸º20ä½å—)</li>\n<li>192.168.0.0åˆ°192.168.255.255(æˆ–è®°ä¸º192.168.0.0/16 ç§°ä¸º16ä½å—)</li>\n</ul>\n</li>\n<li>VPNå±äºè¿œç¨‹è®¿é—®æŠ€æœ¯ï¼Œç®€å•åœ°è¯´å°±æ˜¯åˆ©ç”¨å…¬ç”¨ç½‘ç»œæ¶è®¾ä¸“ç”¨ç½‘ç»œã€‚ä¾‹å¦‚æŸå…¬å¸å‘˜å·¥å‡ºå·®åˆ°å¤–åœ°ï¼Œä»–æƒ³è®¿é—®ä¼ä¸šå†…ç½‘çš„æœåŠ¡å™¨èµ„æºï¼Œè¿™ç§è®¿é—®å°±å±äºè¿œç¨‹è®¿é—®ã€‚</li>\n<li>è®©å¤–åœ°å‘˜å·¥è®¿é—®åˆ°å†…ç½‘èµ„æºï¼Œåˆ©ç”¨VPNçš„è§£å†³æ–¹æ³•å°±æ˜¯åœ¨å†…ç½‘ä¸­æ¶è®¾ä¸€å°VPNæœåŠ¡å™¨ã€‚å¤–åœ°å‘˜å·¥åœ¨å½“åœ°è¿ä¸Šäº’è”ç½‘åï¼Œé€šè¿‡äº’è”ç½‘è¿æ¥VPNæœåŠ¡å™¨ï¼Œç„¶åé€šè¿‡VPNæœåŠ¡å™¨è¿›å…¥ä¼ä¸šå†…ç½‘ã€‚ä¸ºäº†ä¿è¯æ•°æ®å®‰å…¨ï¼ŒVPNæœåŠ¡å™¨å’Œå®¢æˆ·æœºä¹‹é—´çš„é€šè®¯æ•°æ®éƒ½è¿›è¡Œäº†åŠ å¯†å¤„ç†ã€‚æœ‰äº†æ•°æ®åŠ å¯†ï¼Œå°±å¯ä»¥è®¤ä¸ºæ•°æ®æ˜¯åœ¨ä¸€æ¡ä¸“ç”¨çš„æ•°æ®é“¾è·¯ä¸Šè¿›è¡Œå®‰å…¨ä¼ è¾“ï¼Œå°±å¦‚åŒä¸“é—¨æ¶è®¾äº†ä¸€ä¸ªä¸“ç”¨ç½‘ç»œä¸€æ ·ï¼Œä½†å®é™…ä¸ŠVPNä½¿ç”¨çš„æ˜¯äº’è”ç½‘ä¸Šçš„å…¬ç”¨é“¾è·¯ï¼Œå› æ­¤VPNç§°ä¸ºè™šæ‹Ÿä¸“ç”¨ç½‘ç»œï¼Œå…¶å®è´¨ä¸Šå°±æ˜¯åˆ©ç”¨åŠ å¯†æŠ€æœ¯åœ¨å…¬ç½‘ä¸Šå°è£…å‡ºä¸€ä¸ªæ•°æ®é€šè®¯éš§é“ã€‚</li>\n</ul>\n<h2>4.11. ç½‘ç»œåœ°å€è½¬æ¢NAT (Network Address Translation)</h2>\n<ul>\n<li>éœ€è¦åœ¨ä¸“ç”¨ç½‘è¿æ¥åˆ°å› ç‰¹ç½‘çš„è·¯ç”±å™¨ä¸Šå®‰è£…NATè½¯ä»¶ã€‚è£…æœ‰NATè½¯ä»¶çš„è·¯ç”±å™¨å«åšNATè·¯ç”±å™¨ï¼Œå®ƒè‡³å°‘æœ‰ä¸€ä¸ªæœ‰æ•ˆçš„å¤–éƒ¨å…¨çƒIPåœ°å€ã€‚è¿™æ ·ï¼Œæ‰€æœ‰ä½¿ç”¨æœ¬åœ°åœ°å€çš„ä¸»æœºåœ¨å’Œå¤–ç•Œé€šä¿¡æ—¶ï¼Œéƒ½è¦åœ¨NATè·¯ç”±å™¨ä¸Šå°†å…¶æœ¬åœ°åœ°å€è½¬æ¢æˆå…¨çƒIPåœ°å€ï¼Œæ‰èƒ½å’Œå› ç‰¹ç½‘è¿æ¥(å…¶å®ç›¸å½“äºäº¤ç»™NATä»£ç†è®¿é—®ç½‘ç»œä¸Šçš„å…¶ä»–ä¸»æœº)</li>\n<li>ä¸ºäº†æ›´åŠ æœ‰æ•ˆåˆ©ç”¨NATè·¯ç”±å™¨ä¸Šçš„å…¨çƒIPåœ°å€ï¼Œå¸¸ç”¨çš„NATæŠŠè¿è¾“å±‚çš„ç«¯å£å·æ‹¥å¡ï¼Œç§°ä¸ºç½‘ç»œåœ°å€ä¸ç«¯å£å·è½¬æ¢NAPT</li>\n<li>é€šè¿‡NATè·¯ç”±å™¨çš„é€šä¿¡å¿…é¡»ç”±ä¸“ç”¨ç½‘å†…çš„ä¸»æœºå‘èµ·ï¼Œå› ä¸ºNATè·¯ç”±å™¨ä¸çŸ¥é“åº”å½“æŠŠç›®çš„IPåœ°å€è½¬æ¢æˆä¸“ç”¨ç½‘å†…çš„å“ªä¸ªæœ¬åœ°IPåœ°å€</li>\n<li>åŒ…æ”¶å‘è¿‡ç¨‹ä¸­ï¼Œåœ°å€è½¬æ¢è®¾å¤‡éœ€è¦æ ¹æ®å¯¹åº”è¡¨æŸ¥æ‰¾ç§æœ‰åœ°å€å’Œå…¬æœ‰åœ°å€çš„å¯¹åº”å…³ç³»ï¼Œå†æ”¹å†™åœ°å€å’Œç«¯å£å·ä¹‹åè¿›è¡Œè½¬å‘ã€‚å½“æ•°æ®æ”¶å‘ç»“æŸï¼Œè¿›å…¥æ–­å¼€é˜¶æ®µï¼Œè®¿é—®äº’è”ç½‘çš„æ“ä½œå…¨éƒ¨å®Œæˆåï¼Œå¯¹åº”è¡¨ä¸­çš„è®°å½•å°±ä¼šè¢«åˆ é™¤ã€‚</li>\n</ul>\n<h1>5. è¿è¾“å±‚</h1>\n<h2>5.1. è¿è¾“å±‚æ¦‚è¿°</h2>\n<ul>\n<li>è¿è¾“å±‚æœ‰ä¸¤ä¸ªå¾ˆé‡è¦çš„åŠŸèƒ½\n<ul>\n<li>å¤ç”¨ï¼šå‘é€æ–¹ä¸åŒçš„åº”ç”¨è¿›ç¨‹éƒ½å¯ä»¥ä½¿ç”¨åŒä¸€ä¸ªè¿è¾“å±‚åè®®ä¼ é€æ•°æ®</li>\n<li>åˆ†ç”¨ï¼šæ¥æ”¶æ–¹çš„è¿è¾“å±‚åœ¨å‰¥å»æŠ¥æ–‡çš„é¦–éƒ¨åèƒ½å¤ŸæŠŠè¿™äº›æ•°æ®æ­£ç¡®äº¤ä»˜ç›®çš„åº”ç”¨è¿›ç¨‹</li>\n</ul>\n</li>\n<li>è¿è¾“å±‚å±äºé¢å‘é€šä¿¡éƒ¨åˆ†çš„æœ€é«˜å±‚ï¼ŒåŒæ—¶ä¹Ÿæ˜¯ç”¨æˆ·åŠŸèƒ½ä¸­çš„æœ€åº•å±‚ã€‚ç½‘ç»œçš„è¾¹ç¼˜éƒ¨åˆ†çš„ä¸¤ä¸ªä¸»æœºä½¿ç”¨ç½‘ç»œçš„æ ¸å¿ƒéƒ¨åˆ†çš„åŠŸèƒ½è¿›è¡Œç«¯åˆ°ç«¯çš„é€šä¿¡æ—¶ï¼Œåªæœ‰ä¸»æœºçš„åè®®æ ˆæ‰æœ‰è¿è¾“å±‚ï¼Œè€Œè·¯ç”±å™¨åœ¨è½¬å‘åˆ†ç»„æ—¶éƒ½åªç”¨åˆ°ä¸‹ä¸‰å±‚çš„åŠŸèƒ½</li>\n<li>åè®®ç«¯å£å·(protocol port number)/ç«¯å£(port)ã€‚16ä½ã€æ ‡è¯†TCP/IPä½“ç³»ä¸­ä¸åŒæ“ä½œç³»ç»Ÿçš„åº”ç”¨è¿›ç¨‹ã€‚åˆ†ä¸ºä¸¤ç§ï¼šæœåŠ¡ç«¯ä½¿ç”¨çš„ç«¯å£å·ï¼šç³»ç»Ÿç«¯å£å·[0ï½1023]ã€ç™»è®°ç«¯å£å·[1024ï½49151]ï¼›å®¢æˆ·ç«¯ä½¿ç”¨çš„çŸ­æš‚ç«¯å£å·ï¼š[49152ï½65535]<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6d619df80480ebf17163c.jpg\" alt=\"18.png\"></li>\n</ul>\n<h2>5.2. ç”¨æˆ·æ•°æ®æŠ¥åè®®UDP(User Datagram Protocol)</h2>\n<ul>\n<li>\n<p>UDPç‰¹ç‚¹</p>\n<ul>\n<li><strong>UDPæ”¯æŒä¸€å¯¹ä¸€ã€ä¸€å¯¹å¤šã€å¤šå¯¹ä¸€å’Œå¤šå¯¹å¤šçš„äº¤äº’é€šä¿¡</strong></li>\n<li><strong>UDPä½¿ç”¨å°½æœ€å¤§åŠªåŠ›äº¤ä»˜ï¼Œå³ä¸ä¿è¯å¯é äº¤ä»˜</strong>ã€‚å› æ­¤ä¸»æœºä¸éœ€è¦ç»´æŒå¤æ‚çš„è¿æ¥çŠ¶æ€è¡¨</li>\n<li><strong>UDPæ˜¯é¢å‘æŠ¥æ–‡çš„ã€‚å‘é€æ–¹çš„UDPå¯¹åº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æŠ¥æ–‡ï¼Œåœ¨æ·»åŠ é¦–éƒ¨åå°±ç›´æ¥äº¤ä»˜IPå±‚</strong>ï¼›è‹¥æŠ¥æ–‡å¤ªé•¿ï¼ŒIPå±‚åœ¨ä¼ é€æ—¶å¯èƒ½è¦è¿›è¡Œåˆ†ç‰‡ï¼Œè‹¥æŠ¥æ–‡å¤ªçŸ­ï¼Œä¼šä½¿IPæ•°æ®æŠ¥çš„é¦–éƒ¨çš„ç›¸å¯¹é•¿åº¦å¤ªå¤§ï¼Œéƒ½ä¼šé™ä½äº†IPå±‚çš„æ•ˆç‡ã€‚</li>\n<li><strong>UDPçš„é¦–éƒ¨å¼€é”€å°ï¼Œåªæœ‰8ä¸ªå­—èŠ‚ï¼Œæ¯”TCPçš„20ä¸ªå­—èŠ‚çš„é¦–éƒ¨è¦çŸ­</strong></li>\n<li>UDPæ˜¯æ— è¿æ¥çš„ï¼Œå‘é€æ•°æ®ä¹‹å‰ä¸éœ€è¦å»ºç«‹è¿æ¥ï¼ˆå‘é€æ•°æ®ç»“æŸæ—¶ä¹Ÿæ²¡æœ‰è¿æ¥å¯é‡Šæ”¾ï¼‰ï¼Œå‡å°‘äº†å¼€é”€å’Œå‘é€æ•°æ®ä¹‹å‰çš„æ—¶å»¶</li>\n<li>UDPæ²¡æœ‰æ‹¥å¡æ§åˆ¶ï¼Œå› æ­¤ç½‘ç»œå‡ºç°çš„æ‹¥å¡ä¸ä¼šä½¿æºä¸»æœºçš„å‘é€é€Ÿç‡é™ä½ã€‚</li>\n<li>UDPç”¨äºè§†é¢‘éŸ³é¢‘ç­‰</li>\n</ul>\n</li>\n<li>\n<p>UDPæŠ¥æ–‡æ ¼å¼</p>\n<ul>\n<li>é¦–éƒ¨å­—æ®µï¼š8ä¸ªå­—èŠ‚ï¼Œç”±å››ä¸ªå­—æ®µç»„æˆï¼Œæ¯ä¸ªå­—æ®µçš„é•¿åº¦éƒ½æ˜¯ä¸¤ä¸ªå­—èŠ‚\n<ul>\n<li>æºç«¯å£: 2å­—èŠ‚ æºç«¯å£å·ï¼Œåœ¨éœ€è¦å¯¹æ–¹å›ä¿¡æ—¶é€‰ç”¨ï¼Œä¸éœ€è¦æ—¶å¯å…¨0</li>\n<li>ç›®çš„ç«¯å£:2å­—èŠ‚ ç›®çš„ç«¯å£å·ã€‚è¿™åœ¨ç»ˆç‚¹äº¤ä»˜æŠ¥æ–‡æ—¶å¿…é¡»è¦ä½¿ç”¨åˆ°</li>\n<li>é•¿åº¦:2å­—èŠ‚ UDPç”¨æˆ·æ•°æ®æŠ¥çš„é•¿åº¦ï¼Œå…¶æœ€å°å€¼æ˜¯8ï¼ˆä»…æœ‰é¦–éƒ¨ï¼‰</li>\n<li>æ£€éªŒå’Œ:2å­—èŠ‚ æ£€æµ‹UDPç”¨æˆ·æ•°æ®æŠ¥åœ¨ä¼ è¾“ä¸­æ˜¯å¦æœ‰é”™ã€‚æœ‰é”™å°±ä¸¢å¼ƒ</li>\n</ul>\n</li>\n<li>æ•°æ®å­—æ®µ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f02170314a64b67683f88.png\" alt=\"34.PNG\"></li>\n</ul>\n</li>\n<li>\n<p>UDPè®¡ç®—æ£€éªŒå’Œâ€”â€”æŠŠé¦–éƒ¨å’Œæ•°æ®éƒ¨åˆ†ä¸€èµ·éƒ½æ£€éªŒ</p>\n<ul>\n<li>åœ¨å‘é€æ–¹çš„UDPç”¨æˆ·æ•°æ®æŠ¥ä¹‹å‰ä¸´æ—¶å¢åŠ 12ä¸ªå­—èŠ‚çš„ä¼ªé¦–éƒ¨(ä¸å‚ä¸ä¼ è¾“)ï¼Œå¹¶æŠŠå…¨é›¶æ”¾å…¥æ£€éªŒå’Œå­—æ®µã€‚ç„¶åæŠŠä¼ªé¦–éƒ¨ä»¥åŠUDPç”¨æˆ·æ•°æ®æŠ¥çœ‹æˆæ˜¯ç”±è®¸å¤š16ä½çš„å­—ä¸²æ¥èµ·æ¥ã€‚è‹¥UDPç”¨æˆ·æ•°æ®æŠ¥çš„æ•°æ®éƒ¨åˆ†ä¸æ˜¯å¶æ•°ä¸ªå­—èŠ‚ï¼Œåˆ™è¦å¡«å…¥ä¸€ä¸ªå…¨é›¶å­—èŠ‚ï¼ˆä½†æ­¤å­—èŠ‚ä¸å‘é€ï¼‰ã€‚æœ€åæŒ‰äºŒè¿›åˆ¶åç è®¡ç®—å‡ºè¿™äº›16ä½å­—çš„å’Œã€‚å°†æ­¤å’Œçš„äºŒè¿›åˆ¶åç ä½œä¸ºæ£€éªŒå’Œå­—æ®µï¼Œå°±å‘é€è¿™æ ·çš„UDPç”¨æˆ·æ•°æ®æŠ¥</li>\n<li>åœ¨æ¥æ”¶æ–¹ï¼ŒæŠŠæ”¶åˆ°çš„UDPç”¨æˆ·æ•°æ®æŠ¥è¿åŒä¼ªé¦–éƒ¨ï¼ˆä»¥åŠå¯èƒ½çš„å¡«å……å…¨é›¶å­—èŠ‚ï¼‰ä¸€èµ·ï¼ŒæŒ‰äºŒè¿›åˆ¶åç æ±‚è¿™äº›16ä½å­—çš„å’Œã€‚å½“æ— å·®é”™æ—¶å…¶ç»“æœåº”ä¸ºå…¨1ã€‚å¦åˆ™å°±è¡¨æ˜æœ‰å·®é”™å‡ºç°ï¼Œæ¥æ”¶æ–¹å°±åº”ä¸¢å¼ƒè¿™ä¸ªUDPç”¨æˆ·æ•°æ®æŠ¥ï¼ˆä¹Ÿå¯ä»¥ä¸Šäº¤ç»™åº”ç”¨å±‚ï¼Œä½†é™„ä¸Šå‡ºç°äº†å·®é”™çš„è­¦å‘Šï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/349726b142d5dc53670b7.png\" alt=\"26.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9beb33fa6584bca0b141c.png\" alt=\"35.PNG\"></li>\n</ul>\n</li>\n</ul>\n<h2>5.3. ä¼ è¾“æ§åˆ¶åè®®TCP(Transmission Control Protocol)</h2>\n<ul>\n<li>\n<p>TCPç‰¹ç‚¹</p>\n<ul>\n<li>TCPæ˜¯é¢å‘è¿æ¥çš„ã€‚å‘é€æ•°æ®ä¹‹å‰ï¼Œå¿…é¡»å…ˆå»ºç«‹TCPè¿æ¥ã€‚åœ¨å‘é€æ•°æ®ç»“æŸæ—¶ï¼Œå¿…é¡»é‡Šæ”¾å·²ç»å»ºç«‹çš„TCPè¿æ¥</li>\n<li>æ¯ä¸€æ¡TCPè¿æ¥åªèƒ½æœ‰ä¸€å¯¹ä¸€çš„ä¸¤ä¸ªç«¯ç‚¹(endpoint)ã€‚TCPè¿æ¥çš„ç«¯ç‚¹å«åšå¥—æ¥å­—(socket)ã€‚å¥—æ¥å­—Socket = IPåœ°å€ï¼šç«¯å£å·ï¼ŒåŒä¸€ä¸ªIPåœ°å€æˆ–è€…ç«¯å£å·éƒ½æœ‰å¤šä¸ªTCPè¿æ¥ï¼Œå¥—æ¥å­—æœ¬è´¨æ˜¯é€šä¿¡æ“ä½œçš„å„ç§æ§åˆ¶ä¿¡æ¯ï¼Œå¯ç”¨netstat -andæŸ¥çœ‹ï¼Œaæ˜¾ç¤ºæ‰€æœ‰å¥—æ¥å­—ï¼Œn IPåœ°å€å’Œç«¯å£å·ï¼Œoæ˜¾ç¤ºä½¿ç”¨è¯¥å¥—æ¥å­—çš„ç¨‹åºPIDã€‚0.0.0.0è¡¨ç¤ºæ— é€šä¿¡ï¼Œä¸ç»‘å®šIPåœ°å€ã€‚*:*è¡¨ç¤ºUDP</li>\n<li>TCPæä¾›å¯é äº¤ä»˜çš„æœåŠ¡ã€‚é€šè¿‡TCPè¿æ¥ä¼ é€çš„æ•°æ®ï¼Œæ— å·®é”™ã€ä¸ä¸¢å¤±ã€ä¸é‡å¤ã€å¹¶ä¸”æŒ‰åºåˆ°è¾¾</li>\n<li>TCPæä¾›å…¨åŒå·¥é€šä¿¡ã€‚TCPå…è®¸é€šä¿¡åŒæ–¹çš„åº”ç”¨è¿›ç¨‹åœ¨ä»»ä½•æ—¶å€™éƒ½èƒ½å‘é€æ•°æ®ã€‚ä¸¤ç«¯éƒ½è®¾æœ‰å‘é€ç¼“å­˜å’Œæ¥æ”¶ç¼“å­˜ç”¨æ¥ä¸´æ—¶å­˜æ”¾åŒå‘é€šä¿¡çš„æ•°æ®ã€‚åœ¨å‘é€æˆ–æ¥æ”¶æ—¶ï¼Œåº”ç”¨ç¨‹åºåœ¨æŠŠæ•°æ®ä¼ é€æˆ–æ”¾å…¥ç»™TCPçš„ç¼“å­˜åï¼Œåœ¨åˆé€‚çš„æ—¶å€™æŠŠæ•°æ®å‘é€å‡ºå»æˆ–è€…è¯»å–å‡ºæ¥</li>\n<li>TCPæ˜¯é¢å‘å­—èŠ‚æµçš„ã€‚TCPæŠŠåº”ç”¨ç¨‹åºäº¤ä¸‹æ¥çš„æ•°æ®çœ‹æˆä»…ä»…æ˜¯ä¸€è¿ä¸²çš„æ— ç»“æ„æ— æ„ä¹‰çš„å­—èŠ‚æµã€‚TCPä¿è¯æ¥æ”¶æ–¹åº”ç”¨ç¨‹åºæ‰€æ”¶åˆ°çš„å­—èŠ‚æµå’Œå‘é€æ–¹åº”ç”¨ç¨‹åºæ‰€å‘å‡ºçš„å­—èŠ‚æµå®Œå…¨ä¸€æ ·ã€‚æ¥æ”¶æ–¹åº”ç”¨ç¨‹åºå¿…é¡»æœ‰èƒ½åŠ›è¯†åˆ«æ”¶åˆ°çš„å­—èŠ‚æµï¼ŒæŠŠä»–è¿˜åŸæˆæœ‰æ„ä¹‰çš„åº”ç”¨å±‚æ•°æ®</li>\n</ul>\n</li>\n<li>\n<p>TCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨æ ¼å¼ï¼ˆé¦–éƒ¨é•¿åº¦[20-60]å­—èŠ‚-&gt;å›ºå®š20å­—èŠ‚+ã€0-40ã€‘å­—èŠ‚çš„é€‰é¡¹ï¼‰<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b527fa063670a3fe0e678.png\" alt=\"20.png\"></p>\n<ul>\n<li>æºç«¯å£å’Œç›®çš„ç«¯å£:å„å 2ä¸ªå­—èŠ‚ï¼Œæºç«¯å£å·å’Œç›®çš„ç«¯å£å·ã€‚</li>\n<li>åºå·/æŠ¥æ–‡æ®µåºå·seqï¼š4å­—èŠ‚ã€‚æœ¬æŠ¥æ–‡æ®µæ•°æ®çš„ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼Œ[0, 2^32-1]ï¼Œä½¿ç”¨mod2^32è¿ç®—ã€‚TCPè¿æ¥ä¸­ä¼ é€çš„å­—èŠ‚æµä¸­çš„æ¯ä¸€ä¸ªå­—èŠ‚éƒ½æŒ‰é¡ºåºç¼–å·ã€‚ä¸€ä¸ªå­—èŠ‚ä¸€ä¸ªåºå·ï¼Œå­—èŠ‚æµçš„èµ·å§‹åºå·å¿…é¡»åœ¨è¿æ¥å»ºç«‹æ—¶è®¾ç½®ã€‚ï¼ˆä¸ºäº†å®‰å…¨ï¼Œåˆå§‹å€¼æ˜¯éšæœºçš„ï¼‰</li>\n<li>ç¡®è®¤å·ack:4å­—èŠ‚ï¼ŒæœŸæœ›æ”¶åˆ°å¯¹æ–¹ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µçš„ç¬¬ä¸€ä¸ªæ•°æ®å­—èŠ‚çš„åºå·ã€‚è‹¥ç¡®è®¤å·ä¸ºNï¼Œåˆ™è¡¨æ˜åˆ°åºå·N-1ä¸ºæ­¢çš„æ‰€æœ‰æ•°æ®éƒ½å·²æ­£ç¡®æ”¶åˆ°</li>\n<li>æ•°æ®åç§»:4ä½ï¼ŒTCPæŠ¥æ–‡æ®µçš„é¦–éƒ¨é•¿åº¦ã€‚0-15 å•ä½æ˜¯32ä½å­—/4å­—èŠ‚</li>\n<li>ä¿ç•™:å 6ä½ï¼Œä¿ç•™ä¸ºä»Šåä½¿ç”¨ï¼Œä½†ç›®å‰ç½®ä¸º0</li>\n<li>æ§åˆ¶ä½-&gt;ç´§æ€¥URG(URGent):å½“URG=1æ—¶ï¼Œå‘é€æ–¹TCPå°±æŠŠç´§æ€¥æ•°æ®æ’å…¥åˆ°æœ¬æŠ¥æ–‡æ®µæ•°æ®çš„æœ€å‰é¢ï¼Œè¡¨ç¤ºæœ‰ç´§æ€¥æ•°æ®è¦ä¼ è¾“ï¼Œè€Œåœ¨ç´§æ€¥æ•°æ®åé¢çš„æ•°æ®ä»æ˜¯æ™®é€šæ•°æ®ã€‚è¿™æ—¶è¦ä¸é¦–éƒ¨ä¸­ç´§æ€¥æŒ‡é’ˆ(Urgent Pointer)å­—æ®µé…åˆä½¿ç”¨ã€‚ï¼ˆControl + Cï¼‰</li>\n<li>æ§åˆ¶ä½-&gt;ç¡®è®¤ACK(ACKnowlegment)ACK=1ç¡®è®¤å·æœ‰æ•ˆã€‚ACK=0ç¡®è®¤å·æ— æ•ˆã€‚TCPè§„å®šï¼Œåœ¨è¿æ¥å»ºç«‹åæ‰€æœ‰ä¼ é€çš„æŠ¥æ–‡æ®µéƒ½å¿…é¡»æŠŠACKç½®1</li>\n<li>æ§åˆ¶ä½-&gt;æ¨é€PSH(PuSH)å½“PSH=læ—¶ï¼Œå°±å°½å¿«äº¤ä»˜æ¥æ”¶åº”ç”¨è¿›ç¨‹ï¼Œè€Œä¸å†ç­‰åˆ°æ•´ä¸ªç¼“å­˜éƒ½å¡«æ»¡äº†åå†å‘ä¸Šäº¤ä»˜</li>\n<li>æ§åˆ¶ä½-&gt;å¤ä½RST(ReSeT)RST=1è¡¨æ˜TCPè¿æ¥ä¸­å‡ºç°ä¸¥é‡å·®é”™ï¼Œå¿…é¡»é‡Šæ”¾è¿æ¥ç„¶åå†é‡æ–°å»ºç«‹è¿æ¥ã€‚è¿˜ç”¨æ¥æ‹’ç»éæ³•æŠ¥æ–‡æ®µæˆ–æ‹’ç»æ‰“å¼€è¿æ¥</li>\n<li>æ§åˆ¶ä½-&gt;åŒæ­¥SYN (SYNchronization)  åœ¨è¿æ¥å»ºç«‹æ—¶ç”¨æ¥åŒæ­¥åºå·ã€‚</li>\n<li>æ§åˆ¶ä½-&gt;ç»ˆæ­¢FIN (FINis) å½“FIN=læ—¶ï¼Œè¡¨æ˜æ­¤æŠ¥æ–‡æ®µçš„å‘é€æ–¹çš„æ•°æ®å·²å‘é€å®Œæ¯•ï¼Œå¹¶è¦æ±‚é‡Šæ”¾è¿è¾“è¿æ¥</li>\n<li>çª—å£rwnd:2å­—èŠ‚ã€‚[0, 2^16-1] ä»æœ¬æŠ¥æ–‡æ®µé¦–éƒ¨ä¸­çš„ç¡®è®¤å·ç®—èµ·ï¼Œæ¥æ”¶æ–¹ç›®å‰å…è®¸å¯¹æ–¹å‘é€çš„æ•°æ®é‡ï¼ˆå› ä¸ºæ¥æ”¶æ–¹çš„æ•°æ®ç¼“å­˜ç©ºé—´æœ‰é™ï¼‰çª—å£å­—æ®µæ˜ç¡®æŒ‡å‡ºäº†ç°åœ¨å…è®¸å¯¹æ–¹å‘é€çš„æ•°æ®é‡</li>\n<li>æ£€éªŒå’Œï¼š2å­—èŠ‚ã€‚æ£€éªŒçš„èŒƒå›´åŒ…æ‹¬é¦–éƒ¨å’Œæ•™æ®è¿™ä¸¤éƒ¨åˆ†ã€‚å’ŒUDPä¸€æ ·è®¡ç®—æ£€éªŒå’Œï¼Œä½†åº”æŠŠä¼ªé¦–éƒ¨ç¬¬4ä¸ªå­—æ®µä¸­çš„17æ”¹ä¸º6ï¼ˆTCPçš„åè®®å·æ˜¯6ï¼‰ï¼ŒæŠŠç¬¬5å­—æ®µä¸­çš„UDPé•¿åº¦æ”¹ä¸ºTCPé•¿åº¦</li>\n<li>ç´§æ€¥æŒ‡é’ˆ:2å­—èŠ‚ã€‚URG=1æ—¶æ‰æœ‰æ„ä¹‰ï¼ŒæŒ‡å‡ºäº†ç´§æ€¥æ•°æ®çš„æœ«å°¾åœ¨æŠ¥æ–‡æ®µä¸­çš„ä½ç½®ï¼ˆç´§æ€¥æ•°æ®ç»“æŸåå°±æ˜¯æ™®é€šæ•°æ®ï¼‰ã€‚å½“æ‰€æœ‰ç´§æ€¥æ•°æ®éƒ½å¤„ç†å®Œæ—¶ï¼ŒTCPå°±å‘Šè¯‰åº”ç”¨ç¨‹åºæ¢å¤åˆ°æ­£å¸¸æ“ä½œã€‚å³ä½¿çª—å£ä¸ºé›¶æ—¶ä¹Ÿå¯å‘é€ç´§æ€¥æ•°æ®ã€‚</li>\n<li>é€‰é¡¹:é•¿åº¦å¯å˜ï¼Œæœ€é•¿40å­—èŠ‚\n<ul>\n<li>æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦MSS (Maximum Segment Size):æ¯ä¸€ä¸ªTCPæŠ¥æ–‡æ®µä¸­çš„æ•°æ®å­—æ®µçš„æœ€å¤§é•¿åº¦ã€‚è‹¥é€‰æ‹©è¾ƒå°çš„MSSé•¿åº¦ï¼Œç½‘ç»œçš„åˆ©ç”¨ç‡å°±é™ä½ã€‚è‹¥TCPæŠ¥æ–‡æ®µéå¸¸é•¿ï¼ŒlPå±‚ä¼ è¾“æ—¶è¦åˆ†è§£æˆå¤šä¸ªçŸ­æ•°æ®æŠ¥ç‰‡ã€‚åœ¨ç»ˆç‚¹è¦æŠŠæ”¶åˆ°çš„å„ä¸ªçŸ­æ•°æ®æŠ¥ç‰‡è£…é…æˆåŸæ¥çš„TCPæŠ¥æ–‡æ®µã€‚å½“ä¼ è¾“å‡ºé”™æ—¶è¿˜è¦è¿›è¡Œé‡ä¼ ã€‚ä¹Ÿä¼šä½¿å¼€é”€å¢å¤§ã€‚å› æ­¤ï¼ŒMSSåº”å°½å¯èƒ½å¤§äº›ï¼Œåªè¦åœ¨IPå±‚ä¼ è¾“æ—¶ä¸éœ€è¦åˆ†ç‰‡å°±è¡Œã€‚åœ¨è¿æ¥å»ºç«‹çš„è¿‡ç¨‹ä¸­ï¼ŒåŒæ–¹èƒ½æŠŠè‡ªå·±èƒ½å¤Ÿæ”¯æŒçš„MSSå†™å…¥è¿™ä¸€å­—æ®µï¼Œä»¥åå°±æŒ‰ç…§è¿™ä¸ªæ•°å€¼ä¼ è¾“æ•°æ®ï¼Œä¸¤ä¸ªä¼ é€æ–¹å‘å¯ä»¥æœ‰ä¸åŒçš„MSSå€¼ã€‚MSSçš„é»˜è®¤å€¼æ˜¯536å­—èŠ‚é•¿ã€‚æ•…æ‰€æœ‰åœ¨äº’è”ç½‘ä¸Šçš„ä¸»æœºéƒ½åº”è¯¥æ¥å—çš„æŠ¥æ–‡æ®µé•¿åº¦æ˜¯536+20ï¼ˆå›ºå®šé¦–éƒ¨é•¿åº¦ï¼‰=556å­—èŠ‚ã€‚ï¼ˆï¼Ÿç”±MACå¸§æœ€å¤§ä¼ è¾“å•å…ƒMTUå†³å®šï¼Œå‡å»TCPå’ŒIPå¤´éƒ¨å¾—åˆ°ï¼‰</li>\n<li>çª—å£æ‰©å¤§é€‰é¡¹:ä¸ºäº†æ‰©å¤§çª—å£ã€‚å 3å­—èŠ‚ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºç§»ä½å€¼S(æœ€å¤§å€¼æ˜¯14)ã€‚æ–°çš„çª—å£å€¼ç­‰äºTCPé¦–éƒ¨ä¸­çš„çª—å£ä½æ•°ä»16å¢å¤§åˆ°(16+S),ç›¸å½“äºçª—å£æœ€å¤§å€¼å¢å¤§åˆ° 2^(16+14)-1=2^30-1)ã€‚çª—å£æ‰©å¤§é€‰é¡¹å¯ä»¥åœ¨åŒæ–¹åˆå§‹å»ºç«‹TCPè¿æ¥æ—¶è¿›è¡Œåå•†ã€‚</li>\n<li>æ—¶é—´æˆ³é€‰é¡¹ï¼š10å­—èŠ‚ï¼Œå…¶ä¸­æœ€ä¸»è¦çš„å­—æ®µæ—¶é—´æˆ³å€¼å­—æ®µï¼ˆ4å­—èŠ‚ï¼‰å’Œæ—¶é—´æˆ³å›é€å›ç­”å­—æ®µï¼ˆ4å­—èŠ‚ï¼‰ã€‚\n<ul>\n<li>è®¡ç®—å¾€è¿”æ—¶é—´RTTã€‚å‘é€æ–¹åœ¨å‘é€æŠ¥æ–‡æ®µæ—¶æŠŠå½“å‰æ—¶é’Ÿçš„æ—¶é—´å€¼æ”¾å…¥æ—¶é—´æˆ³å­—æ®µï¼Œæ¥æ”¶æ–¹åœ¨ç¡®è®¤è¯¥æŠ¥æ–‡æ®µæ—¶æŠŠæ—¶é—´æˆ³å­—æ®µå€¼å¤åˆ¶åˆ°æ—¶é—´æˆ³å›é€å›ç­”å­—æ®µã€‚å‘é€æ–¹åœ¨æ”¶åˆ°ç¡®è®¤æŠ¥æ–‡åï¼Œå¯ä»¥å‡†ç¡®åœ°è®¡ç®—å‡ºRTT</li>\n<li>å¤„ç†TCPåºå·è¶…è¿‡2^32/é˜²æ­¢åºå·ç»•å›PAWS (ProtectAgainst Wrapped Sequence numbers)ã€‚é«˜é€Ÿç½‘ç»œåœ¨ä¸€æ¬¡TCPè¿æ¥çš„æ•°æ®ä¼ é€ä¸­åºå·å¾ˆå¯èƒ½ä¼šè¢«é‡å¤ä½¿ç”¨ã€‚ä¸ºäº†ä½¿æ¥æ”¶æ–¹èƒ½å¤ŸæŠŠæ–°çš„æŠ¥æ–‡æ®µå’Œå…¶ä»–çš„æŠ¥æ–‡æ®µåŒºåˆ†å¼€ï¼Œå¯ä»¥åŠ ä¸Šè¿™ç§æ—¶é—´æˆ³</li>\n</ul>\n</li>\n<li>é€‰æ‹©ç¡®è®¤SACKï¼šåªä¼ é€ç¼ºå°‘çš„æ•°æ®è€Œä¸é‡ä¼ å·²ç»æ­£ç¡®åˆ°è¾¾æ¥æ”¶æ–¹çš„æ•°æ®ã€‚æ¥æ”¶æ–¹å‘Šè¯‰å‘é€æ–¹æ²¡æ”¶åˆ°çš„è¿ç»­çš„å­—èŠ‚å—è¾¹ç•Œï¼Œå­—èŠ‚å—å·¦è¾¹ç•Œæ˜¯ç¬¬ä¸€ä¸ªå­—èŠ‚çš„åºå·ï¼Œè€Œå³è¾¹å‡1æ‰æ˜¯å­—èŠ‚å—ä¸­çš„æœ€åä¸€ä¸ªåºå·ã€‚é€‰é¡¹ä¸­æœ€å¤šèƒ½æŒ‡æ˜4ä¸ªå­—èŠ‚å—çš„å 4ä¸ªå­—èŠ‚çš„è¾¹ç•Œä¿¡æ¯(å³æœ€å¤š32å­—èŠ‚)ã€‚å¦å¤–è¿˜åŒ…æ‹¬ä¸€ä¸ªå­—èŠ‚æŒ‡æ˜æ˜¯SACKé€‰é¡¹ï¼Œå¦ä¸€ä¸ªå­—èŠ‚æŒ‡æ˜è¿™ä¸ªé€‰é¡¹è¦å ç”¨å¤šå°‘å­—èŠ‚</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>TCPçš„è¿è¾“è¿æ¥ç®¡ç†<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/41e6eb528927d80eac755.png\" alt=\"27.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b03555c0c8b95dd455de1.png\" alt=\"29.png\"></p>\n<ul>\n<li>TCPè¿æ¥å»ºç«‹ï¼ˆä¸‰æ¬¡æ¡æ‰‹ï¼‰éœ€è¦å®¢æˆ·ç«¯å†å‘é€ç¡®è®¤çš„ç›®çš„æ˜¯é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡ï¼ˆæ»ç•™ï¼‰çªç„¶åˆä¼ åˆ°æœåŠ¡ç«¯ï¼Œäº§ç”Ÿé”™è¯¯ï¼ŒåŒæ—¶ç¡®è®¤ä¸¤è¾¹çš„å‘é€å’Œæ¥æ”¶åŠŸèƒ½æ­£å¸¸\n<ul>\n<li>TCPæœåŠ¡å™¨è¿›ç¨‹å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶å—TCBï¼Œç„¶åæœåŠ¡å™¨è¿›ç¨‹å°±å¤„äºLISTENï¼ˆæ”¶å¬ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·çš„è¿æ¥è¯·æ±‚ã€‚å¦‚æœ‰ï¼Œå³ä½œå‡ºå“åº”</li>\n<li>TCPå®¢æˆ·è¿›ç¨‹ä¹Ÿæ˜¯å…ˆåˆ›å»ºä¼ è¾“æ§åˆ¶æ¨¡å—TCBï¼Œç„¶åå‘TCPæœåŠ¡ç«¯å‘å‡ºè¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µï¼Œè¿™æ—¶é¦–éƒ¨ä¸­çš„åŒæ­¥ä½SYN=1ï¼ŒåŒæ—¶é€‰æ‹©ä¸€ä¸ªåˆå§‹åºå·seq=xã€‚TCPå®¢æˆ·è¿›ç¨‹è¿›å…¥SYN-SENTï¼ˆåŒæ­¥å·²å‘é€ï¼‰çŠ¶æ€ï¼ˆTCPè§„å®šï¼ŒSYN=1çš„æŠ¥æ–‡æ®µä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ï¼‰</li>\n<li>TCPæœåŠ¡å™¨æ”¶åˆ°è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µåï¼Œå¦‚åŒæ„å»ºç«‹è¿æ¥ï¼Œåˆ™å‘Aå‘é€ç¡®è®¤ã€‚åœ¨ç¡®è®¤æŠ¥æ–‡æ®µä¸­åº”æŠŠSYNä½å’ŒACKä½éƒ½ç½®1ï¼Œç¡®è®¤å·æ˜¯ack=x+lï¼ŒåŒæ—¶ä¹Ÿä¸ºè‡ªå·±é€‰æ‹©ä¸€ä¸ªåˆå§‹åºå·seq=yã€‚è¿™ä¸ªæŠ¥æ–‡æ®µä¹Ÿä¸èƒ½æºå¸¦æ•°æ®ï¼Œä½†åŒæ ·è¦æ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚TCPæœåŠ¡å™¨è¿›ç¨‹è¿›å…¥SYN-RCVDï¼ˆåŒæ­¥æ”¶åˆ°ï¼‰çŠ¶æ€ã€‚</li>\n<li>TCPå®¢æˆ·è¿›ç¨‹æ”¶åˆ°æœåŠ¡å™¨çš„ç¡®è®¤åï¼Œè¿˜è¦å‘æœåŠ¡å™¨ç»™å‡ºç¡®è®¤ï¼Œç¡®è®¤æŠ¥æ–‡ACK=1ï¼Œç¡®è®¤å·ack=y+1ï¼Œåºå·seq=x+1ï¼Œå®¢æˆ·ç«¯è¿›å…¥è¿æ¥çŠ¶æ€(TCPçš„æ ‡å‡†è§„å®šï¼ŒACKæŠ¥æ–‡æ®µå¯ä»¥æºå¸¦æ•°æ®ï¼Œä½†å¦‚æœä¸æºå¸¦æ•°æ®åˆ™ä¸æ¶ˆè€—åºå·)</li>\n<li>TCPæœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„ç¡®è®¤åï¼Œä¹Ÿè¿›å…¥ESTABLISHEDçŠ¶æ€</li>\n</ul>\n</li>\n<li>TCPè¿æ¥é‡Šæ”¾ï¼ˆå››æ¬¡æŒ¥æ‰‹ï¼‰\n<ul>\n<li>TCPå®¢æˆ·ç«¯å…ˆå‘å…¶TCPæœåŠ¡ç«¯å‘å‡ºè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œå¹¶åœæ­¢å†å‘é€æ•°æ®ï¼Œä¸»åŠ¨å…³é—­TCPè¿æ¥ã€‚æŠŠè¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µé¦–éƒ¨çš„ç»ˆæ­¢æ§åˆ¶ä½FINç½®1ï¼Œå…¶åºå·seq=uï¼Œå®ƒç­‰äºå‰é¢å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ lã€‚è¿›å…¥FIN-WAIT-1ï¼ˆç»ˆæ­¢ç­‰å¾…1ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡å™¨çš„ç¡®è®¤ã€‚TCPè§„å®šï¼ŒFINæŠ¥æ–‡æ®µå³ä½¿ä¸æºå¸¦æ•°æ®ï¼Œå®ƒä¹Ÿæ¶ˆè€—æ‰ä¸€ä¸ªåºå·ã€‚</li>\n<li>TCPæœåŠ¡ç«¯æ”¶åˆ°è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µåå³å‘å‡ºç¡®è®¤ï¼Œç¡®è®¤å·æ˜¯ack=u+lï¼Œè€Œè¿™ä¸ªæŠ¥æ–‡æ®µè‡ªå·±çš„åºå·æ˜¯vï¼Œç­‰äºå‰é¢å·²ä¼ é€è¿‡çš„æ•°æ®çš„æœ€åä¸€ä¸ªå­—èŠ‚çš„åºå·åŠ 1ã€‚ç„¶åå°±è¿›å…¥CLOSE-WAITï¼ˆå…³é—­ç­‰å¾…ï¼‰çŠ¶æ€ã€‚TCPæœåŠ¡å™¨è¿›ç¨‹è¿™æ—¶åº”é€šçŸ¥é«˜å±‚åº”ç”¨è¿›ç¨‹ï¼Œå› è€Œä»å®¢æˆ·ç«¯åˆ°æœåŠ¡ç«¯è¿™ä¸ªæ–¹å‘çš„è¿æ¥å°±é‡Šæ”¾äº†ï¼Œè¿™æ—¶çš„TCPè¿æ¥å¤„äºåŠå…³é—­(half-close)çŠ¶æ€ï¼Œå³å®¢æˆ·ç«¯å·²ç»æ²¡æœ‰æ•°æ®è¦å‘é€äº†ï¼Œä½†æœåŠ¡ç«¯è‹¥å‘é€æ•°æ®ï¼Œå®¢æˆ·ç«¯ä»è¦æ¥æ”¶ã€‚ä»æœåŠ¡ç«¯åˆ°å®¢æˆ·ç«¯è¿™ä¸ªæ–¹å‘çš„è¿æ¥å¹¶æœªå…³é—­ï¼Œè¿™ä¸ªçŠ¶æ€å¯èƒ½ä¼šæŒç»­ä¸€äº›æ—¶é—´ã€‚</li>\n<li>TCPå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡æ®µçš„ç¡®è®¤åï¼Œè¿›å…¥FIN-WAIT-2ï¼ˆç»ˆæ­¢ç­‰å¾…2ï¼‰çŠ¶æ€ï¼Œç­‰å¾…æœåŠ¡ç«¯å‘å‡ºçš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡æ®µï¼Œè‹¥æœåŠ¡ç«¯å·²ç»æ²¡æœ‰è¦æƒ³è¦å‘é€çš„æ•°æ®ï¼Œåˆ™é€šçŸ¥TCPé‡Šæ”¾è¿æ¥ï¼ŒæœåŠ¡ç«¯å‘å‡ºé‡Šæ”¾æŠ¥æ–‡FIN=1ï¼Œå‡å®šæœåŠ¡ç«¯çš„åºå·ä¸ºwï¼ˆåœ¨åŠå…³é—­çŠ¶æ€ä¸‹æœåŠ¡ç«¯åˆå¯èƒ½å‘é€äº†ä¸€äº›æ•°æ®ï¼‰ï¼ŒæœåŠ¡ç«¯å¿…é¡»é‡å¤ä¸Šæ¬¡å·²å‘é€è¿‡çš„ç¡®è®¤å·ack=u+1ï¼Œæ­¤æ—¶æœåŠ¡ç«¯è¿›å…¥LAST-ACKï¼ˆæœ€åç¡®è®¤ï¼‰çŠ¶æ€ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„ç¡®è®¤</li>\n<li>TCPå®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡ç«¯çš„è¿æ¥é‡Šæ”¾æŠ¥æ–‡åï¼Œå¿…é¡»å‘å‡ºç¡®è®¤ï¼ŒæŠŠACK=1ï¼Œç¡®è®¤å·ä¸ºack=w+1ï¼Œåºå·seq=u+1ï¼ˆå‰é¢å‘é€è¿‡çš„FINæŠ¥æ–‡æ®µä¹Ÿè¦æ¶ˆè€—ä¸€ä¸ªåºå·ï¼‰ï¼Œè¿›å…¥TIME-WAITï¼ˆæ—¶é—´ç­‰å¾…ï¼‰çŠ¶æ€ã€‚ç»è¿‡æ—¶é—´ç­‰å¾…è®¡æ—¶å™¨ï¼ˆTIME-WAIT timerï¼‰è®¾ç½®çš„æ—¶é—´2MSLåï¼Œå®¢æˆ·ç«¯è¿›å…¥CLOSEDçŠ¶æ€ï¼›æ—¶é—´MSLå«åšæœ€é•¿æŠ¥æ–‡æ®µå¯¿å‘½ï¼ˆå»ºè®®è®¾ç½®ä¸º2åˆ†é’Ÿï¼‰</li>\n</ul>\n</li>\n<li>ç­‰å¾…è®¡æ—¶å™¨ï¼šä¸ºä»€ä¹ˆå®¢æˆ·ç«¯æ®µåœ¨TIME-WAITçŠ¶æ€å¿…é¡»ç­‰å¾…2MSLæ—¶é—´ï¼Ÿ\n<ul>\n<li>ä¸ºäº†ä¿è¯å®¢æˆ·ç«¯å‘é€çš„æœ€åä¸€ä¸ªACKæŠ¥æ–‡èƒ½åˆ°è¾¾æœåŠ¡ç«¯ã€‚è¿™ä¸ªACKæŠ¥æ–‡æœ‰å¯èƒ½ä¸¢å¤±ï¼Œå› è€Œå¤„åœ¨LAST-ACKçŠ¶æ€çš„æœåŠ¡ç«¯æ”¶ä¸åˆ°å¯¹å·²å‘é€çš„FIN+ACKæŠ¥æ–‡æ®µçš„ç¡®è®¤ã€‚æœåŠ¡ç«¯å°±ä¼šè¶…æ—¶é‡ä¼ FIN+ACKæŠ¥æ–‡æ®µï¼Œè€Œå®¢æˆ·ç«¯å°±èƒ½åœ¨2MSLæ—¶é—´å†…æ”¶åˆ°è¿™ä¸ªé‡ä¼ çš„FIN+ACKæŠ¥æ–‡æ®µï¼Œæ¥ç€å®¢æˆ·ç«¯é‡ä¼ ä¸€æ¬¡ç¡®è®¤ï¼Œé‡æ–°å¯åŠ¨2MSLè®¡æ—¶å™¨ï¼Œæœ€åå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æ­£å¸¸è¿›å…¥CLOSEDçŠ¶æ€</li>\n<li>ä¸ºäº†é˜²æ­¢å·²å¤±æ•ˆçš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µå‡ºç°åœ¨æœ¬è¿æ¥ä¸­ï¼Œå®¢æˆ·ç«¯åœ¨å‘é€å®Œæœ€åä¸€ä¸ªACKæŠ¥æ–‡æ®µåï¼Œå†ç»è¿‡æ—¶é—´2MSLï¼Œå°±å¯ä»¥ä½¿æœ¬è¿æ¥æŒç»­çš„æ—¶é—´å†…æ‰€äº§ç”Ÿçš„æ‰€æœ‰æŠ¥æ–‡æ®µéƒ½ä»ç½‘ç»œä¸­æ¶ˆå¤±ï¼Œè¿™æ ·å°±å¯ä»¥ä½¿ä¸‹ä¸€ä¸ªæ–°çš„è¿æ¥ä¸­ä¸ä¼šå‡ºç°è¿™ç§æ—§çš„è¿æ¥è¯·æ±‚æŠ¥æ–‡æ®µã€‚æœåŠ¡ç«¯åªè¦æ”¶åˆ°äº†å®¢æˆ·ç«¯å‘å‡ºçš„ç¡®è®¤ï¼Œå°±è¿›å…¥CLOSEDçŠ¶æ€ã€‚åŒæ ·ï¼ŒæœåŠ¡ç«¯åœ¨æ’¤é”€ç›¸åº”çš„ä¼ è¾“æ§åˆ¶å—ä¹‹åï¼Œå°±ç»“æŸäº†è¿™æ¬¡çš„TCPè¿æ¥ï¼ŒæœåŠ¡ç«¯ç»“æŸTCPè¿æ¥çš„æ—¶é—´è¦æ¯”å®¢æˆ·ç«¯æ—©</li>\n</ul>\n</li>\n<li>ä¿æ´»è®¡æ—¶å™¨(Keepalive timer)\n<ul>\n<li>æœåŠ¡å™¨æ¯æ”¶åˆ°ä¸€æ¬¡å®¢æˆ·ç«¯çš„æ•°æ®ï¼Œå°±é‡æ–°è®¾ç½®ä¿æ´»è®¡æ—¶å™¨ï¼Œé€šå¸¸æ˜¯2å°æ—¶ï¼Œè‹¥2å°æ—¶å€™æ²¡æœ‰æ”¶åˆ°å®¢æˆ·çš„æ•°æ®ï¼ŒæœåŠ¡å™¨å°±å‘é€ä¸€ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µï¼Œä»¥åæ¯éš”75åˆ†é’Ÿå°±å‘é€ä¸€æ¬¡ï¼Œè‹¥ä¸€è¿å‘é€10ä¸ªæ¢æµ‹æŠ¥æ–‡æ®µåä»æ— å®¢æˆ·çš„å“åº”ï¼ŒæœåŠ¡å™¨å°±è®¤ä¸ºå®¢æˆ·ç«¯å‡ºç°æ•…éšœï¼Œæ¥ç€å…³é—­è¿æ¥</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>TCPçš„æœ‰é™çŠ¶æ€æœº<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2ab4d20951e951319e040.png\" alt=\"27.png\"></p>\n</li>\n<li>\n<p>ä¼ è¾“æ§åˆ¶åè®®TCPå¯é ä¼ è¾“</p>\n<ul>\n<li>å¯é ä¼ è¾“ï¼šå½“å‡ºç°å·®é”™æ—¶è®©å‘é€æ–¹é‡ä¼ å‡ºç°å·®é”™çš„æ•°æ®ï¼ŒåŒæ—¶åœ¨æ¥æ”¶æ–¹æ¥ä¸åŠå¤„ç†æ”¶åˆ°çš„æ•°æ®æ—¶ï¼ŒåŠæ—¶å‘Šè¯‰å‘é€æ–¹é€‚å½“é™ä½å‘é€æ•°æ®çš„é€Ÿåº¦ã€‚è¿™æ ·ä¸€æ¥ï¼Œæœ¬æ¥æ˜¯ä¸å¯é çš„ä¼ è¾“ä¿¡é“å°±èƒ½å¤Ÿå®ç°å¯é ä¼ è¾“äº†ã€‚</li>\n<li>å¯é ä¼ è¾“åè®®ï¼šè‡ªåŠ¨é‡ä¼ è¯·æ±‚ï¼ˆAutomatic Repeat reQuestï¼ŒARQï¼‰åè®®åŒ…æ‹¬åœæ­¢ç­‰å¾…ARQåè®®ã€è¿ç»­ARQåè®®</li>\n<li>è‡ªåŠ¨é‡ä¼ è¯·æ±‚ï¼ˆAutomatic Repeat reQuestï¼ŒARQï¼‰åè®®ï¼Œåœæ­¢ç­‰å¾…åè®®ï¼ˆç®€å•ä½†æ˜¯ä¿¡é“åˆ©ç”¨ç‡ä½ï¼‰\n<ul>\n<li>åœæ­¢ç­‰å¾…ï¼šæ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„å°±åœæ­¢å‘é€ï¼Œç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ï¼Œåœ¨æ”¶åˆ°ç¡®è®¤åå†å‘ä¸‹ä¸€ä¸ªåˆ†ç»„</li>\n<li>è¶…æ—¶é‡ä¼ ï¼šå‘é€æ–¹åªè¦è¶…è¿‡äº†ä¸€æ®µæ—¶é—´æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ï¼Œå°±è®¤ä¸ºåˆšæ‰å‘é€çš„åˆ†ç»„ä¸¢å¤±ï¼Œé‡ä¼ å‰é¢å‘é€è¿‡çš„åˆ†ç»„ã€‚è¦å®ç°è¶…æ—¶é‡ä¼ ï¼Œå°±è¦åœ¨æ¯å‘é€å®Œä¸€ä¸ªåˆ†ç»„è®¾ç½®ä¸€ä¸ªè¶…æ—¶è®¡æ—¶å™¨ã€‚å¦‚æœåœ¨è¶…æ—¶è®¡æ—¶å™¨åˆ°æœŸä¹‹å‰æ”¶åˆ°äº†å¯¹æ–¹çš„ç¡®è®¤ï¼Œå°±æ’¤é”€å·²è®¾ç½®çš„è¶…æ—¶è®¡æ—¶å™¨ã€‚è¶…æ—¶è®¡æ—¶å™¨è®¾ç½®çš„é‡ä¼ æ—¶é—´åº”å½“æ¯”æ•°æ®åœ¨åˆ†ç»„ä¼ è¾“çš„å¹³å‡å¾€è¿”æ—¶é—´æ›´é•¿ä¸€äº›ã€‚ï¼ˆå¦‚æœé‡ä¼ æ—¶é—´è®¾å®šå¤ªé•¿ï¼Œé€šä¿¡æ•ˆç‡ä½ï¼Œå¤ªçŸ­ï¼Œäº§ç”Ÿä¸å¿…è¦çš„é‡ä¼ ï¼Œæµªè´¹ç½‘ç»œèµ„æºï¼‰TCP ä¼šåœ¨å‘é€æ•°æ®çš„è¿‡ç¨‹ä¸­æŒç»­æµ‹é‡ ACK å·çš„è¿”å›æ—¶é—´ï¼Œå¦‚æœACKå·è¿”å›å˜æ…¢ï¼Œåˆ™ç›¸åº”å»¶é•¿ç­‰å¾…æ—¶é—´ï¼›ç›¸å¯¹åœ°ï¼Œå¦‚æœACKå·é©¬ä¸Šå°±èƒ½è¿”å›ï¼Œåˆ™ç›¸åº”ç¼©çŸ­ç­‰å¾…æ—¶é—´</li>\n<li>å‘é€æ–¹åœ¨å‘é€å®Œä¸€ä¸ªåˆ†ç»„åï¼Œå¿…é¡»æš‚æ—¶ä¿ç•™å·²å‘é€çš„åˆ†ç»„çš„å‰¯æœ¬ï¼ˆä¸ºå‘ç”Ÿè¶…æ—¶é‡ä¼ æ—¶ä½¿ç”¨ï¼‰ã€‚åªæœ‰åœ¨æ”¶åˆ°ç›¸åº”çš„ç¡®è®¤åæ‰èƒ½æ¸…é™¤æš‚æ—¶ä¿ç•™çš„åˆ†ç»„å‰¯æœ¬</li>\n<li>åˆ†ç»„å’Œç¡®è®¤åˆ†ç»„éƒ½å¿…é¡»è¿›è¡Œç¼–å·ã€‚è¿™æ ·æ‰èƒ½æ˜ç¡®æ˜¯å“ªä¸€ä¸ªå‘é€å‡ºå»çš„åˆ†ç»„æ”¶åˆ°äº†ç¡®è®¤ï¼Œè€Œå“ªä¸€ä¸ªåˆ†ç»„è¿˜æ²¡æœ‰æ”¶åˆ°ç¡®è®¤ã€‚</li>\n<li>ç¡®è®¤ä¸¢å¤±ï¼ˆæ¥æ”¶æ–¹å‘é€çš„ç¡®è®¤ä¸¢å¤±äº†ï¼‰ï¼šæ¥æ”¶æ–¹åˆæ”¶åˆ°äº†é‡ä¼ çš„åˆ†ç»„ã€‚ä¸¢å¼ƒè¿™ä¸ªé‡å¤çš„åˆ†ç»„ã€‚å¹¶å‘å‘é€æ–¹å‘é€ç¡®è®¤ã€‚</li>\n<li>ç¡®è®¤è¿Ÿåˆ°ï¼ˆæ¥æ”¶æ–¹å‘é€çš„ç¡®è®¤è¿Ÿåˆ°äº†ï¼‰å‘é€æ–¹æ”¶åˆ°æ¥æ”¶æ–¹é‡å¤çš„ç¡®è®¤æ—¶ï¼Œæ”¶ä¸‹å°±ä¸¢å¼ƒï¼Œæ¥æ”¶æ–¹æ”¶åˆ°é‡å¤çš„åˆ†ç»„æ—¶ï¼ŒåŒæ ·ä¸¢å¼ƒé‡å¤çš„åˆ†ç»„ï¼Œå¹¶é‡ä¼ ç¡®è®¤åˆ†ç»„</li>\n</ul>\n</li>\n<li>è¿ç»­ARQåè®®ï¼ˆä»¥å­—èŠ‚ä¸ºå•ä½çš„æ»‘åŠ¨çª—å£åè®®ï¼‰\n<ul>\n<li>å‘é€æ–¹ç»´æŒçš„å‘é€çª—å£ï¼Œä½äºå‘é€çª—å£å†…çš„åˆ†ç»„éƒ½å¯æŒ‰ç…§åˆ†ç»„åºå·ä»å°åˆ°å¤§è¿ç»­å‘é€å‡ºå»ï¼Œè€Œä¸éœ€è¦ç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ã€‚ä¿¡é“åˆ©ç”¨ç‡æé«˜äº†</li>\n<li>è¿ç»­ARQåè®®è§„å®šï¼Œå‘é€æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªç¡®è®¤ï¼Œå°±æŠŠå‘é€çª—å£å‘å‰æ»‘åŠ¨ä¸€ä¸ªåˆ†ç»„çš„ä½ç½®ã€‚æ¥æ”¶æ–¹ä¸€èˆ¬é‡‡ç”¨ç´¯ç§¯ç¡®è®¤çš„æ–¹å¼ã€‚æ¥æ”¶æ–¹ä¸å¿…å¯¹æ”¶åˆ°çš„åˆ†ç»„é€ä¸ªå‘é€ç¡®è®¤ï¼Œè€Œæ˜¯åœ¨æ”¶åˆ°å‡ ä¸ªåˆ†ç»„åï¼Œ<strong>å¯¹æŒ‰åºåˆ°è¾¾çš„æœ€åä¸€ä¸ªåˆ†ç»„å‘é€ç¡®è®¤</strong>ï¼Œè¡¨ç¤ºåˆ°è¿™ä¸ªåˆ†ç»„ä¸ºæ­¢çš„æ‰€æœ‰åˆ†ç»„éƒ½å·±æ­£ç¡®æ”¶åˆ°ã€‚æ¥æ”¶æ–¹å¯ä»¥åœ¨åˆé€‚çš„æ—¶å€™å‘é€ç¡®è®¤ï¼Œä¹Ÿå¯ä»¥åœ¨è‡ªå·±æœ‰æ•°æ®è¦å‘é€æ—¶æŠŠç¡®è®¤ä¿¡æ¯é¡ºä¾¿æå¸¦ä¸Šï¼ˆæ¥æ”¶æ–¹ä¸åº”è¿‡åˆ†æ¨è¿Ÿå‘é€ç¡®è®¤ï¼Œå¦åˆ™ä¼šå¯¼è‡´å‘é€æ–¹ä¸å¿…è¦çš„å†²è½¬ï¼Œåè€Œæµªè´¹ç½‘ç»œèµ„æºï¼ŒTCPè§„å®šï¼Œç¡®è®¤æ¨è¿Ÿçš„æ—¶é—´ä¸åº”è¯¥è¶…è¿‡0.5ç§’ã€‚è‹¥æ”¶åˆ°ä¸€è¿ä¸²å…·æœ‰æœ€å¤§é•¿åº¦çš„æŠ¥æ–‡æ®µï¼Œåˆ™å¿…é¡»æ¯ä¸ªä¸€æ®µæŠ¥æ–‡æ®µå°±è¦å‘é€ä¸€ä¸ªç¡®è®¤ï¼Œæå¸¦ç¡®è®¤ä¸ç»å¸¸å‘ç”Ÿï¼Œå› ä¸ºå¤§å¤šæ•°åº”ç”¨ç¨‹åºä¸åŒæ—¶åœ¨ä¸¤ä¸ªæ–¹å‘ä¸Šå‘é€æ•°æ®ï¼‰ï¼Œ</li>\n<li>ç´¯ç§¯ç¡®è®¤å®¹æ˜“å®ç°ï¼Œå³ä½¿ç¡®è®¤ä¸¢å¤±ä¹Ÿä¸å¿…é‡ä¼ ã€‚ä½†ä¸èƒ½å‘å‘é€æ–¹åæ˜ å‡ºæ¥æ”¶æ–¹å·²ç»æ­£ç¡®æ”¶åˆ°çš„æ‰€æœ‰åˆ†ç»„çš„ä¿¡æ¯ã€‚å½“é€šä¿¡çº¿è·¯è´¨é‡ä¸å¥½æ—¶ï¼Œä¼šå‘ç”Ÿå›é€€Né—®é¢˜ï¼Œå¦‚æœå‘é€æ–¹å‘é€å‰5ä¸ªåˆ†ç»„ï¼Œè€Œä¸­é—´çš„ç¬¬ä¸‰ä¸ªåˆ†ç»„ä¸¢å¤±äº†ï¼Œè¿™æ—¶æ¥æ”¶æ–¹åªèƒ½å¯¹å‰ä¸¤ä¸ªåˆ†ç»„å‘å‡ºç¡®è®¤ã€‚å‘é€æ–¹æ— æ³•çŸ¥é“åé¢ä¸‰ä¸ªåˆ†ç»„çš„ä¸‹è½ï¼Œè€Œåªå¥½æŠŠåé¢çš„ä¸‰ä¸ªåˆ†ç»„éƒ½å†é‡ä¼ ä¸€æ¬¡ï¼Œå«åšå›é€€Nï¼Œè¡¨ç¤ºéœ€è¦å†é€€å›æ¥é‡ä¼ å·²å‘é€è¿‡çš„Nä¸ªåˆ†ç»„ã€‚</li>\n<li>å¯¹ä¸æŒ‰åºåˆ°è¾¾çš„æ•°æ®å…ˆä¸´æ—¶å­˜æ”¾åœ¨æ¥æ”¶çª—å£ä¸­ï¼Œç­‰åˆ°å­—èŠ‚æµä¸­æ‰€ç¼ºå°‘çš„å­—èŠ‚æ”¶åˆ°åï¼Œå†æŒ‰åºäº¤ä»˜ä¸Šå±‚åº”ç”¨</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>ä¼ è¾“æ§åˆ¶åè®®TCPæµé‡æ§åˆ¶(flow control)</p>\n<ul>\n<li>æµé‡æ§åˆ¶ï¼šè®©å‘é€æ–¹çš„é€Ÿç‡ä¸è¦å¤ªå¿«ï¼Œè¦è®©æ¥æ”¶æ–¹æ¥å¾—åŠæ¥æ”¶</li>\n<li>æ»‘åŠ¨çª—å£æœºåˆ¶ï¼šè¿æ¥å»ºç«‹åï¼Œå‘é€æ–¹çš„å‘é€çª—å£rwndä¸èƒ½è¶…è¿‡æ¥æ”¶æ–¹ç»™å‡ºçš„æ¥æ”¶çª—å£æ•°å€¼ï¼ˆå•ä½å­—èŠ‚ï¼‰é€šè¿‡çª—å£å¤§å°æ§åˆ¶å¯¹æ–¹å‘é€é€Ÿç‡</li>\n<li>å‘é€æ–¹æ”¶åˆ°é›¶çª—å£é€šçŸ¥åä¸ä¹…ï¼Œæ¥æ”¶æ–¹çš„æ¥æ”¶ç¼“å­˜åˆæœ‰ä¸€äº›å­˜å‚¨ç©ºé—´ï¼Œä½†æ¥æ”¶æ–¹çš„å‘é€çª—å£ä¿¡æ¯ä¸¢å¤±ï¼Œå‘é€æ–¹ä¸€ç›´ç­‰å¾…éé›¶çª—å£å¯¼è‡´æ­»é”ï¼šåªè¦TCPè¿æ¥çš„ä¸€æ–¹æ”¶åˆ°å¯¹æ–¹çš„é›¶çª—å£é€šçŸ¥ï¼Œå¯åŠ¨æŒç»­è®¡æ—¶å™¨ï¼Œè‹¥æ—¶é—´åˆ°æœŸï¼Œåˆ™å‘é€ä¸€ä¸ªé›¶çª—å£æ¢æµ‹æŠ¥æ–‡æ®µï¼Œå¯¹æ–¹å°±åœ¨ç¡®è®¤è¿™ä¸ªå­—æ®µæ—¶ç»™å‡ºç°åœ¨çš„çª—å£å€¼ã€‚å¦‚æœçª—å£ä»ç„¶æ˜¯é›¶ï¼Œé‡æ–°è®¾ç½®æŒç»­è®¡æ—¶å™¨ã€‚å¦‚æœçª—å£ä¸æ˜¯é›¶ï¼Œé‚£ä¹ˆæ­»é”å±€é¢æ‰“ç ´</li>\n</ul>\n</li>\n<li>\n<p>TCPçš„æ‹¥å¡(congestion)æ§åˆ¶</p>\n<ul>\n<li>æ‹¥å¡:æŸæ®µæ—¶é—´ï¼Œè‹¥å¯¹ç½‘ç»œä¸­æŸä¸€èµ„æºçš„éœ€æ±‚è¶…è¿‡äº†è¯¥èµ„æºæ‰€èƒ½æä¾›çš„å¯ç”¨éƒ¨åˆ†ï¼Œç½‘ç»œçš„æ€§èƒ½å°±è¦å˜åçš„æƒ…å†µã€‚</li>\n<li>æ‹¥å¡æ§åˆ¶å°±æ˜¯é˜²æ­¢è¿‡å¤šçš„æ•°æ®æ³¨å…¥åˆ°ç½‘ç»œä¸­ï¼Œè¿™æ ·å¯ä»¥ä½¿ç½‘ç»œä¸­çš„è·¯ç”±å™¨æˆ–é“¾è·¯ä¸è‡´è¿‡è½½ã€‚</li>\n<li>æ‹¥å¡æ§åˆ¶æ‰€è¦åšçš„éƒ½æœ‰ä¸€ä¸ªå‰æï¼Œå°±æ˜¯ç½‘ç»œèƒ½å¤Ÿæ‰¿å—ç°æœ‰çš„ç½‘ç»œè´Ÿè·ã€‚æ‹¥å¡æ§åˆ¶æ˜¯ä¸€ä¸ªå…¨å±€æ€§çš„è¿‡ç¨‹ï¼Œæ¶‰åŠåˆ°æ‰€æœ‰çš„ä¸»æœºã€æ‰€æœ‰çš„è·¯ç”±å™¨ï¼Œä»¥åŠä¸é™ä½ç½‘ç»œä¼ è¾“æ€§èƒ½æœ‰å…³æ‰€æœ‰å› ç´ ã€‚ä½†TCPè¿æ¥çš„ç«¯ç‚¹åªè¦è¿Ÿè¿Ÿä¸èƒ½æ”¶åˆ°å¯¹æ–¹çš„ç¡®è®¤ä¿¡æ¯ï¼Œå°±çŒœæƒ³åœ¨å½“å‰ç½‘ç»œä¸­çš„æŸå¤„å¾ˆå¯èƒ½å‘ç”Ÿäº†æ‹¥å¡ï¼Œä½†è¿™æ—¶å´æ— æ³•çŸ¥é“æ‹¥å¡åˆ°åº•å‘ç”Ÿåœ¨ç½‘ç»œçš„ä½•å¤„ï¼Œä¹Ÿæ— æ³•çŸ¥é“å‘ç”Ÿæ‹¥å¡çš„å…·ä½“åŸå› ã€‚</li>\n<li>ç›¸åï¼Œæµé‡æ§åˆ¶å¾€å¾€æŒ‡ç‚¹å¯¹ç‚¹é€šä¿¡é‡çš„æ§åˆ¶ï¼Œæ˜¯ä¸ªç«¯åˆ°ç«¯çš„é—®é¢˜ï¼ˆæ¥æ”¶ç«¯æ§åˆ¶å‘é€ç«¯ï¼‰ã€‚æµé‡æ§åˆ¶æ‰€è¦åšçš„å°±æ˜¯æŠ‘åˆ¶å‘é€ç«¯å‘é€æ•°æ®çš„é€Ÿç‡ï¼Œä»¥ä¾¿ä½¿æ¥æ”¶ç«¯æ¥å¾—åŠæ¥æ”¶ã€‚</li>\n<li>å‘é€æ–¹ç»´æŒä¸€ä¸ªå«åšæ‹¥å¡çª—å£CWNDçš„çŠ¶æ€å˜é‡ï¼Œæ‹¥å¡çª—å£çš„å¤§å°å–å†³äºç½‘ç»œçš„æ‹¥å¡ç¨‹åº¦ï¼Œå¹¶ä¸”åŠ¨æ€åœ°å˜åŒ–ï¼Œå‘é€æ–¹è®©è‡ªå·±çš„å‘é€çª—å£ç­‰äºæ‹¥å¡çª—å£ï¼Œå¦‚æœå†è€ƒè™‘åˆ°æ¥æ”¶æ–¹çš„æ¥æ”¶èƒ½åŠ›ï¼Œé‚£ä¹ˆå‘é€çª—å£è¿˜å¯èƒ½å°äºæ‹¥å¡çª—å£</li>\n<li>åªè¦å‘é€æ–¹æ²¡æœ‰æŒ‰æ—¶æ”¶åˆ°åº”å½“åˆ°è¾¾çš„ç¡®è®¤æŠ¥æ–‡ï¼Œå°±çŒœæƒ³ç½‘ç»œå¯èƒ½å‡ºç°æ‹¥å¡ã€‚</li>\n<li>TCPæ‹¥å¡æ§åˆ¶æ–¹æ³•\n<ul>\n<li>æ…¢å¼€å§‹å’Œæ‹¥å¡é¿å…ç®—æ³•\n<ul>\n<li>æ…¢å¼€å§‹ï¼šå…ˆæŠŠæ‹¥å¡çª—å£cwndè®¾ç½®ä¸ºä¸€ä¸ªæœ€å¤§æŠ¥æ–‡æ®µMSSçš„æ•°å€¼ã€‚æ¯æ”¶åˆ°ä¸€ä¸ªå¯¹æ–°çš„æŠ¥æ–‡æ®µç¡®è®¤å°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£å¢åŠ è‡³å¤šä¸€ä¸ªMSSçš„æ•°å€¼ï¼Œæ¯ç»è¿‡ä¸€ä¸ªä¼ è¾“è½®æ¬¡ï¼Œæ‹¥å¡çª—å£cwndå°±åŠ å€</li>\n<li>æ‹¥å¡é¿å…ç®—æ³•ï¼šæ¯ç»è¿‡ä¸€ä¸ªå¾€è¿”æ—¶é—´å°±æŠŠå‘é€æ–¹çš„æ‹¥å¡çª—å£cwndåŠ 1</li>\n<li>æ…¢å¼€å§‹é—¨é™ssthreshï¼šé˜²æ­¢æ‹¥å¡çª—å£å¢é•¿è¿‡å¤§å¼•èµ·ç½‘ç»œæ‹¥å¡ï¼Œæ‹¥å¡çª—å£cwndå°äºæ…¢å¼€å§‹é—¨é™ä½¿ç”¨æ…¢å¼€å§‹ç®—æ³•ï¼Œå¦åˆ™ä½¿ç”¨æ‹¥å¡é¿å…ç®—æ³•</li>\n<li>æ— è®ºåœ¨æ…¢å¼€å§‹é˜¶æ®µè¿˜æ˜¯åœ¨æ‹¥å¡é¿å…é˜¶æ®µï¼Œåªè¦å‘é€æ–¹åˆ¤æ–­ç½‘ç»œå‡ºç°æ‹¥å¡ï¼ˆå…¶æ ¹æ®å°±æ˜¯æ²¡æœ‰æŒ‰æ—¶æ”¶åˆ°ç¡®è®¤ï¼‰ï¼Œå°±è¦æŠŠæ…¢å¼€å§‹é—¨ssthreshè®¾ç½®ä¸ºå‡ºç°æ‹¥å¡æ—¶çš„å‘é€æ–¹çª—å£å€¼çš„ä¸€åŠï¼ˆä½†ä¸èƒ½å°äº2ï¼‰ã€‚ç„¶åæŠŠæ‹¥å¡çª—å£cwndé‡æ–°è®¾ç½®ä¸ºlï¼Œæ‰§è¡Œæ…¢å¼€å§‹ç®—æ³•</li>\n</ul>\n</li>\n<li>å¿«é‡ä¼ å’Œå¿«æ¢å¤\n<ul>\n<li>å¿«é‡ä¼ ï¼šæ¥æ”¶æ–¹æ¯æ”¶åˆ°ä¸€ä¸ªå¤±åºçš„æŠ¥æ–‡æ®µåå°±ç«‹å³å‘å‡ºé‡å¤ç¡®è®¤ï¼ˆä¸ºçš„æ˜¯ä½¿å‘é€æ–¹åŠæ—©çŸ¥é“æœ‰æŠ¥æ–‡æ®µæ²¡æœ‰åˆ°è¾¾å¯¹æ–¹ï¼‰ï¼Œè€Œä¸ç”¨ç­‰å¾…è‡ªå·±å‘é€æ•°æ®æ—¶æ‰è¿›è¡Œæå¸¦ç¡®è®¤ï¼Œå‘é€æ–¹ä¸€è¿æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤å°±ç«‹å³é‡ä¼ å¯¹æ–¹å°šæœªæ”¶åˆ°çš„ä¸‹ä¸€ä¸ªæŠ¥æ–‡æ®µã€‚è€Œä¸å¿…ç»§ç»­ç­‰å¾…ä¸ºæ”¶åˆ°æŠ¥æ–‡æ®µè®¾ç½®çš„é‡ä¼ è®¡æ—¶å™¨åˆ°æœŸ</li>\n<li>å¿«æ¢å¤ï¼šå½“å‘é€æ–¹è¿ç»­æ”¶åˆ°ä¸‰ä¸ªé‡å¤ç¡®è®¤æ—¶ï¼Œæ…¢å¼€å§‹é—¨é™å‡åŠï¼ŒæŠŠcwndå€¼è®¾ç½®ä¸ºæ…¢å¼€å§‹é—¨é™çš„æ•°å€¼ï¼Œæ‰§è¡Œæ‹¥å¡é¿å…ç®—æ³•</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å‘é€çª—å£çš„ä¸Šé™å€¼ = Min[rwnd,cwnd]ï¼Œå½“rwnd&lt;cwndæ—¶ï¼Œæ˜¯æ¥æ”¶æ–¹çš„æ¥æ”¶èƒ½åŠ›é™åˆ¶å‘é€æ–¹çª—å£çš„æœ€å¤§å€¼ï¼Œå½“rwnd&gt;cwndæ—¶ï¼Œæ˜¯ç½‘ç»œæ‹¥å¡é™åˆ¶å‘é€æ–¹çª—å£çš„æœ€å¤§å€¼</li>\n</ul>\n</li>\n<li>\n<p>4ä¸ªå®šæ—¶å™¨: è¶…æ—¶å®šæ—¶å™¨ï¼ŒæŒç»­è®¡æ—¶å™¨ï¼Œç­‰å¾…è®¡æ—¶å™¨ï¼Œä¿æ´»è®¡æ—¶å™¨</p>\n</li>\n</ul>\n<h1>6. åº”ç”¨å±‚</h1>\n<h2>6.1. æ¦‚è¿°</h2>\n<ul>\n<li>è¿è¾“å±‚ä¸ºåº”ç”¨è¿›ç¨‹æä¾›äº†ç«¯åˆ°ç«¯çš„é€šä¿¡æœåŠ¡ï¼Œä½†ä¸åŒçš„ç½‘ç»œåº”ç”¨è¿›ç¨‹ä¹‹é—´ï¼Œè¿˜éœ€è¦æœ‰ä¸åŒçš„é€šä¿¡è§„åˆ™ï¼Œå› æ­¤éœ€è¦æœ‰åº”ç”¨å±‚åè®®<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/64d1c2fd5d2936cc62893.jpg\" alt=\"18.png\"></li>\n</ul>\n<h2>6.2. åŸŸåç³»ç»ŸDNS</h2>\n<ul>\n<li>\n<p>åŸŸåç³»ç»ŸDNSï¼ˆDomain Name Systemï¼‰æ˜¯å› ç‰¹ç½‘ä½¿ç”¨çš„å‘½åç³»ç»Ÿï¼Œå®ŒæˆåŸŸåï¼ˆä¸»æœºåå­—ï¼‰åˆ°IPåœ°å€çš„è§£æï¼Œä¹Ÿå¯ä»¥å°†é‚®ä»¶åœ°å€ä¸é‚®ä»¶æœåŠ¡å™¨è¿›è¡Œå…³è”ï¼ŒåŸŸååˆ°IPåœ°å€çš„è§£æç”±åˆ†å¸ƒåœ¨äº’è”ç½‘ä¸Šçš„è®¸å¤šåŸŸåæœåŠ¡å™¨ç¨‹åºå…±åŒå®Œæˆçš„ï¼Œå› ç‰¹ç½‘çš„åŸŸåç³»ç»ŸDNSè¢«è®¾è®¡æˆä¸ºä¸€ä¸ªè”æœºåˆ†å¸ƒå¼æ•°æ®åº“ç³»ç»Ÿã€‚</p>\n</li>\n<li>\n<p>åŸŸåä¸IPå¹¶ç”¨åŸå› ï¼š1.åŸŸåæ¯”IPæ–¹ä¾¿è®°å¿†ç†è§£ï¼Œ2.IPé•¿åº¦å›ºå®šè¿è¡Œæ•ˆç‡é«˜</p>\n</li>\n<li>\n<p>åŸŸååˆ°IPåœ°å€çš„è§£æè¿‡ç¨‹</p>\n<ul>\n<li>å½“æŸä¸€ä¸ªåº”ç”¨è¿›ç¨‹éœ€è¦æŠŠä¸»æœºåè§£æä¸ºIPåœ°å€æ—¶ï¼Œè¯¥åº”ç”¨è¿›ç¨‹å°±è°ƒç”¨è§£æç¨‹åºï¼ˆåŒ…å«åœ¨æ“ä½œç³»ç»Ÿçš„Socketåº“ä¸­ï¼Œç”¨äºè°ƒç”¨ç½‘ç»œåŠŸèƒ½çš„ç¨‹åºç»„ä»¶é›†åˆï¼‰ï¼Œå¹¶æˆä¸ºDNSçš„ä¸€ä¸ªå®¢æˆ·ï¼ŒæŠŠå¾…è§£æçš„åŸŸåæ”¾åœ¨DNSè¯·æ±‚æŠ¥æ–‡ä¸­ï¼Œä»¥UDPç”¨æˆ·æ•°æ®æŠ¥çš„æ–¹å¼å‘é€ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼ˆå‡å°‘å¼€æ”¯ï¼‰ã€‚æœ¬åœ°åŸŸåæœåŠ¡å™¨å†æŸ¥æ‰¾åŸŸååï¼ŒæŠŠå¯¹åº”çš„IPåœ°å€æ”¾åœ¨å›ç­”æŠ¥æ–‡ä¸­è¿”å›ï¼Œåº”ç”¨è¿›ç¨‹è·å¾—ç›®çš„ä¸»æœºçš„IPåœ°å€åå³å¯è¿›è¡Œé€šä¿¡ã€‚</li>\n<li>è‹¥æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸èƒ½å›ç­”è¯¥è¯·æ±‚ï¼Œåˆ™æ­¤æ—¶åŸŸåæœåŠ¡å™¨å°±æš‚æ—¶æˆä¸ºDNSä¸­çš„å¦ä¸€ä¸ªå®¢æˆ·ï¼Œç„¶åå†å‘æ ¹åŸŸåæœåŠ¡å™¨å‘é€ä¿¡æ¯ï¼Œå¾—åˆ°é¡¶çº§åŸŸåæœåŠ¡å™¨IPåœ°å€ï¼Œç„¶åç»§ç»­å‘é¡¶çº§åŸŸåæœåŠ¡å™¨å‘å‡ºæŸ¥è¯¢è¯·æ±‚ã€‚è¿™ç§è¿‡ç¨‹ç›´åˆ°æ‰¾åˆ°è¯¥è¯·æ±‚çš„åŸŸåæœåŠ¡å™¨ä¸ºæ­¢</li>\n<li>æ¥è‡ªå®¢æˆ·ç«¯æŸ¥è¯¢æ¶ˆæ¯åŒ…æ‹¬ï¼šåŸŸåï¼ˆæœåŠ¡å™¨ï¼Œé‚®ä»¶æœåŠ¡å™¨ï¼ˆ@åé¢çš„éƒ¨åˆ†ï¼‰çš„åç§°ï¼‰ï¼ŒClassï¼ˆINæ ‡è¯†äº’è”ç½‘ï¼Œè¯†åˆ«é™¤äº’è”ç½‘å¤–çš„åº”ç”¨ï¼‰ï¼Œè®°å½•ç±»å‹ï¼ˆè¡¨ç¤ºåŸŸåå¯¹åº”ä½•ç§ç±»å‹çš„è®°å½•ã€‚Aï¼šåŸŸåå¯¹åº”çš„æ˜¯IPåœ°å€ï¼ŒMXï¼šåŸŸåå¯¹åº”é‚®ä»¶æœåŠ¡å™¨å’Œä¼˜å…ˆçº§ï¼ˆæ•°å€¼å°çš„ä¼˜å…ˆï¼‰ï¼ŒPTRï¼šæ ¹æ®IPåœ°å€æŸ¥åŸŸåï¼ŒCNAMEï¼šæŸ¥è¯¢åŸŸåç›¸å…³åˆ«åï¼ŒNSï¼šæŸ¥è¯¢DNSæœåŠ¡å™¨IPåœ°å€ï¼ŒSOAï¼šæŸ¥è¯¢åŸŸåå±æ€§ä¿¡æ¯ï¼‰</li>\n</ul>\n</li>\n<li>\n<p>åŸŸåçš„å±‚æ¬¡ç»“æ„</p>\n<ul>\n<li>äº’è”ç½‘é‡‡ç”¨å±‚æ¬¡æ ‘çŠ¶ç»“æ„çš„å‘½åæ–¹æ³•ï¼Œä»»ä½•ä¸€ä¸ªè¿æ¥åœ¨äº’è”ç½‘ä¸Šçš„ä¸»æœºæˆ–è·¯ç”±å™¨ï¼Œéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€çš„åŸŸåï¼Œ</li>\n<li>åŸŸæ˜¯åå­—ç©ºé—´ä¸­ä¸€ä¸ªå¯è¢«ç®¡ç†çš„åˆ’åˆ†ï¼ŒåŸŸè¿˜å¯ä»¥åˆ’åˆ†å­åŸŸï¼Œå­åŸŸè¿˜å¯ä»¥åˆ’åˆ†ä¸ºå­åŸŸçš„å­åŸŸï¼Œå½¢æˆäº†é¡¶çº§åŸŸã€äºŒçº§åŸŸã€ä¸‰çº§åŸŸç­‰ã€‚</li>\n<li>æ¯ä¸ªåŸŸåç”±æ ‡å·åºåˆ—ç»„æˆï¼Œå„æ ‡å·ç”¨ç‚¹â€œ.â€éš”å¼€ï¼ŒåŸŸåä¸­çš„æ ‡å·éƒ½ç”±è‹±æ–‡å­—æ¯å’Œæ•°å­—ç»„æˆï¼Œæ¯ä¸€ä¸ªæ ‡å·éƒ½ä¸è¶…è¿‡63ä¸ªå­—ç¬¦ï¼Œä¸åŒºåˆ†å¤§å°å†™å­—æ¯ï¼Œé™¤äº†-ä¸èƒ½ä½¿ç”¨å…¶ä»–æ ‡ç‚¹æœåŠ¡å·ï¼Œçº§åˆ«æœ€ä½çš„åŸŸåå†™å·¦è¾¹ï¼Œçº§åˆ«æœ€é«˜çš„åŸŸåå†™æœ€å³è¾¹ï¼Œå®Œæ•´åŸŸåä¸èƒ½è¶…è¿‡255ä¸ªå­—ç¬¦ï¼›<a href=\"http://mail.cctv.com\" target=\"_blank\" rel=\"noopener noreferrer\">mail.cctv.com</a> mailä¸‰çº§åŸŸåï¼ŒcctväºŒçº§åŸŸåï¼Œcomä¸€çº§åŸŸåï¼Œå„çº§åŸŸåç”±å…¶ä¸Šä¸€çº§çš„åŸŸåç®¡ç†æœºæ„ç®¡ç†ï¼Œè€Œæœ€é«˜çš„é¡¶çº§åŸŸååˆ™ç”±ICANNè¿›è¡Œç®¡ç†ï¼Œmail.cctv.comåŸŸçš„DNSæœåŠ¡å™¨æ³¨å†Œåˆ°cctv.comåŸŸçš„DNSæœåŠ¡å™¨ä¸­ï¼Œcctv.comåŸŸçš„DNSæœåŠ¡å™¨æ³¨å†Œåˆ°comåŸŸDNSæœåŠ¡å™¨ä¸­</li>\n</ul>\n</li>\n<li>\n<p>åŸŸåæœåŠ¡å™¨</p>\n<ul>\n<li>DNSæœåŠ¡å™¨ç®¡è¾–èŒƒå›´ä»¥åŒºä¸ºå•ä½ï¼ŒåŒºå°äºç­‰äºåŸŸã€‚åŸŸåæœåŠ¡å™¨æ‰€è´Ÿè´£ç®¡è¾–çš„èŒƒå›´å«åŒºï¼Œä¸€ä¸ªåŒºä¸­çš„æ‰€æœ‰èŠ‚ç‚¹å¿…é¡»æ˜¯èƒ½å¤Ÿè¿é€šçš„ï¼Œæ¯ä¸€ä¸ªåŒºè®¾ç½®ç›¸åº”çš„æƒé™åŸŸåæœåŠ¡å™¨ï¼Œç”¨æ¥ä¿å­˜è¯¥åŒºä¸­çš„æ‰€æœ‰ä¸»æœºçš„åŸŸååˆ°IPåœ°å€çš„æ˜ å°„ï¼Œ</li>\n<li>æ ¹åŸŸåæœåŠ¡å™¨ï¼šæœ€é«˜å±‚æ¬¡çš„åŸŸåæœåŠ¡å™¨ï¼Œæ‰€æœ‰çš„æ ¹åŸŸåæœåŠ¡å™¨éƒ½çŸ¥é“æ‰€æœ‰çš„é¡¶çº§åŸŸåæœåŠ¡å™¨çš„åŸŸåå’ŒIPåœ°å€ï¼Œå› ç‰¹ç½‘å…±æœ‰13ä¸ªä¸åŒIPåœ°å€çš„åŸŸåæœåŠ¡å™¨ï¼Œæ ¹åŸŸåæœåŠ¡å™¨é‡‡ç”¨ä»»æ’­æŠ€æœ¯ï¼Œå½“DNSå®¢æˆ·å‘æŸä¸ªæ ¹åŸŸåæœåŠ¡å™¨çš„IPåœ°å€å‘å‡ºæŸ¥è¯¢æŠ¥æ–‡æ—¶ï¼Œäº’è”ç½‘ä¸Šçš„è·¯ç”±å™¨å°±èƒ½æ‰¾åˆ°ç¦»è¿™ä¸ªDNSå®¢æˆ·æœ€è¿‘çš„ä¸€ä¸ªæ ¹åŸŸåæœåŠ¡å™¨ï¼Œæ ¹åŸŸåæœåŠ¡å™¨ä¸æŠŠå¾…æŸ¥è¯¢çš„åŸŸåç›´æ¥è½¬æ¢æˆIPåœ°å€ï¼Œè€Œæ˜¯å‘Šè¯‰æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸‹ä¸€æ­¥åº”è¯¥æ‰¾å“ªä¸ªé¡¶çº§åŸŸåæœåŠ¡å™¨</li>\n<li>é¡¶çº§åŸŸåæœåŠ¡å™¨ï¼šè´Ÿè´£ç®¡ç†åœ¨è¯¥é¡¶çº§åŸŸåæœåŠ¡å™¨æ³¨å†Œçš„æ‰€æœ‰äºŒçº§åŸŸåï¼Œå½“æ”¶åˆ°DNSæŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œå°±ç»™å‡ºæœ€åçš„ç»“æœæˆ–è€…ä¸‹ä¸€æ­¥åŸŸåæœåŠ¡å™¨åœ°å€</li>\n<li>æƒé™åŸŸåæœåŠ¡å™¨ï¼šè´Ÿè´£ä¸€ä¸ªåŒºçš„åŸŸåæœåŠ¡å™¨ï¼Œå½“ä¸èƒ½ç»™å‡ºæŸ¥è¯¢ç­”æ¡ˆæ—¶ï¼Œä¼šç»™å‡ºä¸‹ä¸€æ­¥æƒé™æœåŠ¡å™¨åœ°å€</li>\n<li>æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼šå½“ä¸€å°ä¸»æœºå‘å‡ºDNSæŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œè¯·æ±‚æŠ¥æ–‡å‘ç»™æœ¬åœ°åŸŸåæœåŠ¡å™¨ï¼Œæ¯ä¸€ä¸ªISPéƒ½æœ‰æœ¬åœ°åŸŸåæœåŠ¡å™¨</li>\n<li>æ‰€æœ‰DNSæœåŠ¡å™¨éƒ½ä¿å­˜äº†æ ¹åŸŸçš„DNSæœåŠ¡å™¨ä¿¡æ¯<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f0da2fd8d1f899f57658a.png\" alt=\"37.PNG\"></li>\n</ul>\n</li>\n<li>\n<p>åŸŸåè§£æè¿‡ç¨‹</p>\n<ul>\n<li>æœ¬æœºå‘æœ¬åœ°åŸŸåæœåŠ¡å™¨æŸ¥è¯¢ä¸€èˆ¬éƒ½æ˜¯é‡‡ç”¨é€’å½’æŸ¥è¯¢ï¼šå¦‚æœæœ¬æœºæ‰€è¯¢é—®çš„æœ¬åœ°åŸŸåæœåŠ¡å™¨ä¸çŸ¥é“è¢«æŸ¥è¯¢åŸŸåçš„IPåœ°å€ï¼Œé‚£ä¹ˆæœ¬åœ°åŸŸåæœåŠ¡å™¨ä»¥DNSå®¢æˆ·çš„èº«ä»½ï¼Œå‘å…¶ä»–æ ¹åŸŸåæœåŠ¡å™¨ç»§ç»­å‘å‡ºæŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡ï¼ˆæ›¿è¯¥ä¸»æœºç»§ç»­æŸ¥è¯¢ï¼‰ï¼Œè€Œä¸æ˜¯è®©è¯¥ä¸»æœºè‡ªå·±è¿›è¡Œä¸‹ä¸€æ­¥æŸ¥è¯¢ã€‚å› æ­¤ï¼Œé€’å½’æŸ¥è¯¢çš„è¿”å›ç»“æœæ˜¯æ‰€è¦æŸ¥è¯¢çš„IPåœ°å€ï¼Œæˆ–è€…æ˜¯æŠ¥é”™ï¼Œè¡¨ç¤ºæ— æ³•æŸ¥è¯¢åˆ°æ‰€éœ€çš„IPåœ°å€</li>\n<li>æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘æ ¹åŸŸåæœåŠ¡å™¨æŸ¥è¯¢é€šå¸¸é‡‡ç”¨è¿­ä»£æŸ¥è¯¢ï¼šå½“æœ¬åœ°åŸŸåæœåŠ¡å™¨æ”¶åˆ°æœ¬åœ°åŸŸåæœåŠ¡å™¨å‘å‡ºçš„è¿­ä»£æŸ¥è¯¢è¯·æ±‚æŠ¥æ–‡æ—¶ï¼Œè¦ä¹ˆç»™å‡ºIPåœ°å€ï¼Œè¦ä¹ˆç»™å‡ºä¸‹ä¸€æ­¥è¦æŸ¥è¯¢çš„åŸŸåæœåŠ¡å™¨åœ°å€ï¼Œè®©æœ¬åœ°åŸŸåæœåŠ¡å™¨è¿›è¡Œåç»­çš„æŸ¥è¯¢ï¼Œæœ¬åœ°åŸŸåæœåŠ¡å™¨ä¹Ÿå¯ä»¥é‡‡ç”¨é€’å½’æŸ¥è¯¢ï¼Œå–å†³äºæœ€åˆæŸ¥è¯¢çš„è¯·æ±‚æŠ¥æ–‡è®¾ç½®è¦æ±‚ä½¿ç”¨å“ªä¸€ç§æŸ¥è¯¢æ–¹å¼</li>\n<li>ä¸ºäº†æé«˜åŸŸåæœåŠ¡çš„å¯é æ€§ï¼ŒDNSåŸŸåæœåŠ¡å™¨æŠŠæ•°æ®å¤åˆ¶åˆ°å‡ ä¸ªåŸŸåæœåŠ¡å™¨æ¥ä¿å­˜ï¼Œå…¶ä¸­ä¸€ä¸ªæ˜¯ä¸»åŸŸåæœåŠ¡å™¨ï¼Œå…¶ä»–çš„æ˜¯è¾…åŠ©åŸŸåæœåŠ¡å™¨ï¼Œä¸»åŸŸåæœåŠ¡å™¨å®šæœŸæŠŠæ•°æ®å¤åˆ¶åˆ°è¾…åŠ©åŸŸåæœåŠ¡å™¨ä¸­ï¼Œè€Œæ›´æ”¹æ•°æ®åªèƒ½åœ¨ä¸»åŸŸåæœåŠ¡å™¨ä¸­è¿›è¡Œï¼Œä¿è¯æ•°æ®çš„ä¸€è‡´æ€§</li>\n<li>ä¸ºäº†æé«˜DNSæŸ¥è¯¢æ•ˆç‡ï¼Œå‡è½»æ ¹åŸŸåæœåŠ¡å™¨çš„è´Ÿè·å’Œå‡å°‘äº’è”ç½‘ä¸Šçš„DNSæŸ¥è¯¢æŠ¥æ–‡æ•°é‡ï¼Œåœ¨åŸŸåæœåŠ¡å™¨ä¸­å¹¿æ³›ä½¿ç”¨é«˜é€Ÿç¼“å­˜ï¼Œç”¨æ¥å­˜æ”¾æœ€è¿‘æŸ¥è¯¢è¿‡çš„åŸŸåä»¥åŠä»ä½•å¤„è·å¾—åŸŸåæ˜ å°„ä¿¡æ¯çš„è®°å½•ï¼ˆä¸å­˜åœ¨ä¹Ÿä¼šç¼“å­˜ï¼‰</li>\n<li>ä¸ºäº†ä¿è¯é«˜é€Ÿç¼“å­˜ä¸­çš„å†…å®¹æ­£ç¡®ï¼ŒåŸŸåæœåŠ¡å™¨åº”ä¸ºæ¯é¡¹å†…å®¹è®¾è®¡è®¡æ—¶å™¨å¹¶å¤„ç†è¶…è¿‡åˆç†æ—¶é—´çš„é¡¹ã€‚å½“åŸŸåæœåŠ¡å™¨å·²ä»ç¼“å­˜ä¸­åˆ å»æŸé¡¹ä¿¡æ¯ååˆè¢«è¯·æ±‚æŸ¥è¯¢è¯¥é¡¹ä¿¡æ¯ï¼Œå°±å¿…é¡»é‡æ–°åˆ°æˆæƒç®¡ç†è¯¥é¡¹çš„åŸŸåæœåŠ¡å™¨è·å–ç»‘å®šä¿¡æ¯ï¼Œå½“æƒé™åŸŸåå›ç­”ä¸€ä¸ªæŸ¥è¯¢è¯·æ±‚æ—¶ï¼Œåœ¨å“åº”ä¸­éƒ½æŒ‡æ˜ç»‘å®šæœ‰æ•ˆå­˜åœ¨çš„æ—¶é—´å€¼ï¼Œå¢åŠ æ­¤æ—¶é—´å€¼å¯å‡å°‘ç½‘ç»œå¼€é”€ï¼Œè€Œå‡å°‘æ­¤æ—¶é—´å€¼å¯æé«˜åŸŸåè½¬æ¢çš„å‡†ç¡®æ€§</li>\n</ul>\n</li>\n</ul>\n<h2>6.3. FTP(File Transfer Protocolæ–‡ä»¶ä¼ é€åè®®)</h2>\n<ul>\n<li>FTPæ¦‚è¿°ï¼šFTPæä¾›äº¤äº’å¼è®¿é—®ï¼Œå…è®¸å®¢æˆ·æŒ‡æ˜æ–‡ä»¶çš„ç±»å‹å’Œæ ¼å¼ï¼Œå¹¶å…è®¸æ–‡ä»¶å…·æœ‰å­˜å–æƒé™ï¼›FTPå±è”½äº†å„è®¡ç®—æœºç³»ç»Ÿçš„ç»†èŠ‚ï¼Œå› è€Œé€‚åˆäºåœ¨å¼‚æ„ç½‘ç»œä¸­ä»»ä¸€è®¡ç®—æœºä¹‹é—´ä¼ é€æ–‡ä»¶</li>\n<li>æ–‡ä»¶å…±äº«åè®®\n<ul>\n<li>å¤åˆ¶æ•´ä¸ªæ–‡ä»¶ï¼šè‹¥è¦å­˜å–ä¸€ä¸ªæ–‡ä»¶å¿…é¡»å…ˆè·å¾—ä¸€ä¸ªæœ¬åœ°çš„æ–‡ä»¶å‰¯æœ¬ã€‚è¦ä¿®æ”¹æ–‡ä»¶ï¼Œåªèƒ½å¯¹æ–‡ä»¶å‰¯æœ¬ä¿®æ”¹ï¼Œç„¶åå°†ä¿®æ”¹åçš„æ–‡ä»¶å‰¯æœ¬ä¼ å›åˆ°åŸèŠ‚ç‚¹\n<ul>\n<li>åŸºäºTCPçš„FTPï¼šå‡å°‘æˆ–æ¶ˆé™¤åœ¨ä¸åŒæ“ä½œç³»ç»Ÿä¸‹å¤„ç†æ–‡ä»¶çš„ä¸å…¼å®¹æ€§\n<ul>\n<li>ä½¿ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼ï¼šä¸€ä¸ªFTPæœåŠ¡å™¨è¿›ç¨‹å¯åŒæ—¶ä¸ºå¤šä¸ªå®¢æˆ·è¿›ç¨‹æä¾›æœåŠ¡ã€‚FTPçš„æœåŠ¡å™¨è¿›ç¨‹ç”±ä¸»è¿›ç¨‹ï¼ˆæ¥æ”¶æ–°è¯·æ±‚ï¼‰å’Œè‹¥å¹²å’Œä»å±è¿›ç¨‹ï¼ˆè´Ÿè´£å¤„ç†å•ä¸ªè¯·æ±‚ï¼‰ï¼ˆæ§åˆ¶è¿›ç¨‹å’Œæ•°æ®ä¼ é€è¿›ç¨‹ï¼‰ç»„æˆ</li>\n<li>ä¸»è¿›ç¨‹å·¥ä½œæ­¥éª¤\n<ul>\n<li>æ‰“å¼€ç«¯å£21ï¼Œä½¿å®¢æˆ·è¿›ç¨‹èƒ½å¤Ÿè¿ä¸Š</li>\n<li>ç­‰å¾…å®¢æˆ·è¿›ç¨‹å‘å‡ºè¿æ¥è¯·æ±‚</li>\n<li>å¯åŠ¨ä»å±è¿›ç¨‹å¤„ç†å®¢æˆ·è¿›ç¨‹å‘æ¥çš„è¯·æ±‚ã€‚ä»å±è¿›ç¨‹å¯¹å®¢æˆ·è¿›ç¨‹çš„è¯·æ±‚å¤„ç†å®Œæ¯•åå³ç»ˆæ­¢ï¼Œä½†ä»å±è¿›ç¨‹åœ¨è¿è¡ŒæœŸé—´æ ¹æ®éœ€è¦è¿˜å¯èƒ½åˆ›å»ºå…¶ä»–ä¸€äº›å­è¿›ç¨‹ã€‚</li>\n<li>å›åˆ°ç­‰å¾…çŠ¶æ€ï¼Œç»§ç»­æ¥å—å…¶ä»–å®¢æˆ·è¿›ç¨‹å‘æ¥çš„è¯·æ±‚ã€‚ä¸»è¿›ç¨‹ä¸ä»å±è¿›ç¨‹çš„å¤„ç†æ˜¯å¹¶å‘åœ°è¿›è¡Œ</li>\n</ul>\n</li>\n<li>åœ¨è¿›è¡Œæ–‡ä»¶ä¼ è¾“æ—¶ï¼ŒFTPçš„å®¢æˆ·æœºå’ŒæœåŠ¡å™¨ä¹‹é—´è¦å»ºç«‹ä¸¤ä¸ªTCPè¿æ¥ï¼Œä¸€ä¸ªç”¨äºä¼ è¾“æ§åˆ¶å‘½ä»¤å’Œå“åº”ï¼Œç§°ä¸ºæ§åˆ¶è¿æ¥ï¼Œä¸€ä¸ªç”¨äºå®é™…çš„æ–‡ä»¶å†…å®¹ä¼ è¾“ï¼Œç§°ä¸ºæ•°æ®è¿æ¥ã€‚æ§åˆ¶è¿æ¥åœ¨æ•´ä¸ªä¼šè¯æœŸé—´ä¸€ç›´æ‰“å¼€ï¼ŒFTPå®¢æˆ·ç«¯å‘å‡ºè¯·æ±‚ï¼Œé€šè¿‡æ§åˆ¶è¿æ¥å‘é€ç»™æœåŠ¡ç«¯çš„æ§åˆ¶è¿›ç¨‹ã€‚æœåŠ¡ç«¯çš„æ§åˆ¶è¿›ç¨‹åœ¨æ”¶åˆ°FTPå®¢æˆ·ç«¯å‘æ¥çš„æ–‡ä»¶ä¼ è¾“è¯·æ±‚åå°±åˆ›å»ºæ•°æ®ä¼ é€è¿›ç¨‹ï¼Œç”¨æ¥è¿æ¥å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨çŸ­çš„æ•°æ®ä¼ é€è¿›ç¨‹ã€‚å®Œæˆå®é™…æ–‡ä»¶çš„ä¼ é€ï¼Œä¼ é€å®Œæ¯•åå…³é—­æ•°æ®ä¼ é€è¿æ¥å¹¶ç»“æŸè¿è¡Œ</li>\n</ul>\n</li>\n<li>åŸºäºUDPçš„TFTPï¼ˆç®€å•æ–‡ä»¶ä¼ é€åè®®ï¼‰\n<ul>\n<li>é‡‡ç”¨å®¢æˆ·æœåŠ¡å™¨æ–¹å¼ï¼ŒTFTPåªæ”¯æŒæ–‡ä»¶ä¼ è¾“è€Œä¸æ”¯æŒäº¤äº’ï¼Œè€Œä¸”éœ€è¦æœ‰è‡ªå·±çš„å·®é”™ä¿®æ”¹æªæ–½</li>\n<li>TFTPä¼˜ç‚¹\n<ul>\n<li>TFTPå¯ç”¨äºUDPç¯å¢ƒï¼Œå½“éœ€è¦å°†ç¨‹åºæˆ–æ–‡ä»¶åŒæ—¶å‘è®¸å¤šæœºå™¨ä¸‹è½½æ—¶å°±å¾€å¾€éœ€è¦ä½¿ç”¨TFTP</li>\n<li>TFTPä»£ç æ‰€å å†…å­˜è¾ƒå°ã€‚è¿™å¯¹è¾ƒå°çš„è®¡ç®—æœºæˆ–è€…æŸäº›ç‰¹æ®Šç”¨é€”çš„è®¾å¤‡å¾ˆé‡è¦ï¼Œè¿™äº›è®¾å¤‡ä¸éœ€è¦ç¡¬ç›˜ï¼Œåªéœ€è¦å›ºåŒ–äº†TFTPå’ŒUDPä»¥åŠIPçš„å°å®¹é‡åªè¯»å­˜å‚¨å™¨å³å¯ï¼Œå½“æ¥é€šç”µæºåï¼Œè®¾å¤‡æ‰§è¡Œåªè¯»å­˜å‚¨å™¨ä¸­çš„ä»£ç ï¼Œåœ¨ç½‘ç»œä¸Šå¹¿æ’­ä¸€ä¸ªTFTPè¯·æ±‚ï¼Œç½‘ç»œä¸Šçš„TFTPæœåŠ¡å™¨å‘é€å“åº”ï¼Œå…¶ä¸­åŒ…æ‹¬å¯æ‰§è¡ŒäºŒè¿›åˆ¶ç¨‹åºã€‚è®¾å¤‡æ”¶åˆ°æ­¤æ–‡ä»¶åå°†å…¶æ”¾å…¥å†…å­˜ï¼Œç„¶åå¼€å§‹è¿è¡Œç¨‹åºã€‚è¿™ç§æ–¹å¼å¢åŠ äº†çµæ´»æ€§ï¼Œè¾ƒå°‘å¼€é”€</li>\n</ul>\n</li>\n<li>TFTPçš„ä¸»è¦ç‰¹ç‚¹\n<ul>\n<li>æ¯æ¬¡ä¼ é€çš„æ•°æ®æŠ¥æ–‡ä¸­æœ‰512å­—èŠ‚çš„æ•°æ®ï¼Œä½†æœ€åä¸€æ¬¡å¯ä¸è¶³512å­—èŠ‚</li>\n<li>æ•°æ®æŠ¥æ–‡æŒ‰åºç¼–å·ï¼Œä»1å¼€å§‹</li>\n<li>æ”¯æŒASCIIç æˆ–è€…äºŒè¿›åˆ¶ä¼ é€</li>\n<li>å¯å¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™</li>\n<li>ä½¿ç”¨ç®€å•çš„é¦–éƒ¨</li>\n</ul>\n</li>\n<li>å‘é€å®Œä¸€ä¸ªæ–‡ä»¶å—åå°±ç­‰å¾…å¯¹æ–¹çš„ç¡®è®¤ï¼Œ ç¡®è®¤åº”æŒ‡æ˜æ‰€ç¡®è®¤çš„å—ç¼–å·ï¼Œå‘é€æ•°æ®åçš„è§„å®šæ—¶é—´å†…æ”¶ä¸åˆ°ç¡®è®¤å°±è¦é‡å‘æ•°æ®PDUã€‚å‘é€ç¡®è®¤PDUçš„ä¸€æ–¹ï¼Œè‹¥åœ¨è§„å®šæ—¶é—´å†…æ”¶ä¸åˆ°ä¸‹ä¸€ä¸ªæ–‡ä»¶å—ï¼Œä¹Ÿè¦é‡å‘ç¡®è®¤PDUï¼Œå¯ä¿è¯æ–‡ä»¶çš„ä¼ é€ä¸è‡³å› æŸä¸€ä¸ªæ•°æ®æŠ¥çš„ä¸¢å¤±è€Œå‘Šå¤±è´¥</li>\n<li>TFTPå®¢æˆ·è¿›ç¨‹å‘é€ä¸€ä¸ªè¯»è¯·æ±‚æŠ¥æ–‡æˆ–è€…å†™è¯·æ±‚æŠ¥æ–‡ç»™TFTPæœåŠ¡è¿›ç¨‹ï¼Œç«¯å£å·69ï¼ŒTFTPæœåŠ¡å™¨è¿›ç¨‹é€‰æ‹©ä¸€ä¸ªæ–°çš„ç«¯å£å’ŒTFTPè¿›ç¨‹è¿›è¡Œé€šä¿¡ã€‚è‹¥æ–‡ä»¶çš„é•¿åº¦æ°å¥½ä¸º512å­—èŠ‚æ•´æ•°å€ï¼Œåˆ™åœ¨æ–‡ä»¶ä¼ é€å®Œæ¯•åï¼Œè¿˜å¿…é¡»åœ¨æœ€åå‘é€ä¸€ä¸ªå«é¦–éƒ¨è€Œæ— æ•°æ®çš„æ•°æ®æŠ¥æ–‡ï¼Œè‹¥æ–‡ä»¶é•¿åº¦ä¸æ˜¯512å­—èŠ‚çš„æ•´æ•°å€ï¼Œåˆ™æœ€åä¼ é€æŠ¥æ–‡ä¸­çš„æ•°æ®å­—æ®µä¸€å®šä¸æ»¡512å­—èŠ‚ï¼Œæ­£å¥½ä½œä¸ºæ–‡ä»¶ç»“æŸçš„æ ‡å¿—</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>è”æœºè®¿é—®ï¼šå…è®¸å¤šä¸ªç¨‹åºåŒæ—¶å¯¹ä¸€ä¸ªæ–‡ä»¶è¿›è¡Œå­˜å–ã€‚ç”±æ“ä½œç³»ç»Ÿæä¾›å¯¹è¿œåœ°å…±äº«æ–‡ä»¶è¿›è¡Œè®¿é—®çš„æœåŠ¡ï¼Œç”¨æˆ·å¯ä»¥ç”¨è¿œåœ°æ–‡ä»¶ä½œä¸ºè¾“å…¥å’Œè¾“å‡ºæ¥è¿è¡Œä»»ä½•åº”ç”¨ç¨‹åºï¼Œæ“ä½œç³»ç»Ÿä¸­çš„æ–‡ä»¶ç³»ç»Ÿåˆ™æä¾›å¯¹å…±äº«æ–‡ä»¶çš„é€æ˜å­˜å–ï¼ˆå°†åŸæ¥ç”¨äºå¤„ç†æœ¬åœ°æ–‡ä»¶çš„åº”ç”¨ç¨‹åºç”¨æ¥å¤„ç†è¿œåœ°æ–‡ä»¶æ—¶ï¼Œä¸éœ€è¦å¯¹åº”ç”¨ç¨‹åºä½œæ˜æ˜¾çš„æ”¹åŠ¨ï¼Œå±äºæ–‡ä»¶å…±äº«åè®®çš„ç½‘ç»œæ–‡ä»¶ç³»ç»ŸNFSï¼‰\n<ul>\n<li>NFSå…è®¸åº”ç”¨è¿›ç¨‹æ‰“å¼€ä¸€ä¸ªè¿œåœ°æ–‡ä»¶ï¼Œå¹¶èƒ½åœ¨è¯¥æ–‡ä»¶çš„æŸä¸€ä¸ªç‰¹å®šçš„ä½ç½®ä¸Šå¼€å§‹è¯»å†™æ•°æ®ã€‚è¿™æ ·NFSå¯ä½¿ç”¨æˆ·åªå¤åˆ¶ä¸€ä¸ªå¤§æ–‡ä»¶ä¸­çš„å¾ˆå°çš„ç‰‡æ®µï¼ŒæŠŠè¦æ·»åŠ çš„æ•°æ®å’Œåœ¨æ–‡ä»¶åé¢å†™æ•°æ®çš„è¯·æ±‚ä¸€èµ·å‘é€åˆ°è¿œåœ°NFSæœåŠ¡å™¨ï¼ŒNFSæœåŠ¡å™¨æ›´æ–°æ–‡ä»¶åè¿”å›åº”ç­”ä¿¡æ¯ã€‚åœ¨ç½‘ç»œä¸Šä¼ é€çš„åªæ˜¯å°‘é‡çš„ä¿®æ”¹æ•°æ®</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>6.4. è¿œç¨‹ç»ˆç«¯åè®®TELNET</h2>\n<ul>\n<li>TELNETé€šè¿‡TCPè¿æ¥æ³¨å†Œåˆ°è¿œåœ°çš„å¦ä¸€å°ä¸»æœºä¸Šï¼Œå°†ç”¨æˆ·çš„å‡»é”®ä¼ åˆ°è¿œåœ°ä¸»æœºï¼ŒåŒæ—¶ä¹Ÿèƒ½å°†è¿œåœ°ä¸»æœºçš„è¾“å‡ºé€šè¿‡TCPè¿æ¥è¿”å›åˆ°ç”¨æˆ·å±å¹•ã€‚è¿™ç§æœåŠ¡æ˜¯é€æ˜çš„ï¼Œå› ä¸ºç”¨æˆ·æ„Ÿè§‰åˆ°å¥½åƒé”®ç›˜å’Œæ˜¾ç¤ºå™¨æ˜¯ç›´æ¥è¿æ¥åˆ°è¿œåœ°ä¸»æœºä¸Š</li>\n<li>TELNETä¹Ÿä½¿ç”¨å®¢æˆ·-æœåŠ¡å™¨æ–¹å¼ï¼ŒæœåŠ¡å™¨ä¸­çš„ä¸»è¿›ç¨‹ç­‰å¾…æ–°è¯·æ±‚ï¼Œå¹¶äº§ç”Ÿä»å±è¿›ç¨‹å¤„ç†æ¯ä¸€ä¸ªè¿æ¥</li>\n<li>TELNETèƒ½é€‚åº”è®¸å¤šè®¡ç®—æœºå’Œæ“ä½œç³»ç»Ÿå·®å¼‚ï¼Œå®ƒå®šä¹‰äº†æ•°æ®å’Œå‘½ä»¤æ€ä¹ˆé€šè¿‡å› ç‰¹ç½‘ã€‚å°±æ˜¯æ‰€è°“çš„ç½‘ç»œè™šæ‹Ÿç»ˆç«¯NVTã€‚å®¢æˆ·è½¯ä»¶å’ŒæœåŠ¡å™¨è½¯ä»¶å®Œæˆäº†NVTæ ¼å¼è½¬æ¢ä¸ºè¿œåœ°å’Œæœ¬åœ°ç³»ç»Ÿæ ¼å¼çš„è½¬æ¢</li>\n<li>TELNETæ ¼å¼å®šä¹‰ç®€å•ã€‚æ‰€æœ‰é€šä¿¡ä½¿ç”¨8ä½ä¸€ä¸ªå­—èŠ‚ã€‚åœ¨è¿è½¬æ—¶ï¼ŒNVTä½¿ç”¨7ä½ASCIIç ä¼ é€æ•°æ®ï¼Œé«˜ä½ç½®ä¸º1ç”¨ä½œæ§åˆ¶å‘½ä»¤ã€‚ASCIIç ï¼Œå…±æœ‰95ä¸ªå¯æ‰“å°å­—ç¬¦ï¼ˆå¦‚å­—æ¯ã€æ•°å­—ã€æ ‡ç‚¹ç¬¦å·ï¼‰å’Œ33ä¸ªæ§åˆ¶å­—ç¬¦ ã€‚æ‰€æœ‰å¯æ‰“å°å­—ç¬¦åœ¨NVTä¸­çš„æ„ä¹‰å’Œåœ¨ASCIIç ä¸­ä¸€æ ·ã€‚ä½†NVTåªä½¿ç”¨äº†ASCIIç çš„æ§åˆ¶å­—ç¬¦ä¸­çš„å‡ ä¸ªã€‚NVTè¿˜å®šä¹‰äº†ä¸¤å­—ç¬¦çš„CR-LFä¸ºæ ‡å‡†çš„è¡Œç»“æŸæ§åˆ¶ç¬¦ã€‚å½“ç”¨æˆ·é”®å…¥å›è½¦æŒ‰é”®æ—¶ï¼ŒTELNETå®¢æˆ·ç«¯æŠŠå®ƒè½¬æ¢ä¸ºCR-LFå†è¿›è¡Œä¼ è¾“ï¼Œè€ŒTELNETè¦æŠŠCR-LFè½¬æ¢ä¸ºè¿œåœ°æœºå™¨çš„è¡Œç»“æŸç¬¦</li>\n<li>TELNETçš„é€‰é¡¹åå•†ä½¿TELNETå®¢æˆ·å’ŒTELNETæœåŠ¡å™¨å¯å•†å®šä½¿ç”¨æ›´å¤šç»ˆç«¯åŠŸèƒ½ï¼Œåå•†åŒæ–¹æ˜¯å¹³ç­‰çš„</li>\n</ul>\n<h2>6.5. ä¸‡ç»´ç½‘</h2>\n<ul>\n<li>ä¸‡ç»´ç½‘æ˜¯ä¸€ä¸ªåˆ†å¸ƒå¼çš„è¶…åª’ä½“ç³»ç»Ÿï¼Œæ˜¯è¶…æ–‡æœ¬ï¼ˆåŒ…å«æŒ‡å‘å…¶ä»–æ–‡æ¡£çš„é“¾æ¥çš„æ–‡æœ¬ï¼‰ç³»ç»Ÿçš„æ‰©å……ã€‚ä¸‡ç»´ç½‘ä»¥å®¢æˆ·ç«¯æœåŠ¡å™¨æ–¹å¼å·¥ä½œï¼Œç”¨æˆ·ä¸»æœºä¸Šè¿è¡Œå®¢æˆ·ç«¯ç¨‹åºï¼Œä¸‡ç»´ç½‘æ–‡æ¡£æ‰€é©»ç•™çš„ä¸»æœºåˆ™è¿è¡ŒæœåŠ¡å™¨ç¨‹åºã€‚å®¢æˆ·ç¨‹åºå‘æœåŠ¡å™¨ç¨‹åºå‘è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç¨‹åºå‘å®¢æˆ·ç¨‹åºé€å›å®¢æˆ·æ‰€è¦çš„ä¸‡ç»´ç½‘æ–‡æ¡£ã€‚åœ¨å®¢æˆ·ç«¯ç¨‹åºä¸»çª—å£ä¸Šæ˜¾ç¤ºçš„ä¸‡ç»´ç½‘æ–‡æ¡£ç§°ä¸ºé¡µé¢</li>\n<li>ä¸‡ç»´ç½‘ä½¿ç”¨åœ¨æ•´ä¸ªäº’è”ç½‘ä¸­å”¯ä¸€çš„ç»Ÿä¸€èµ„æºå®šä½ç¬¦urlæ ‡å¿—ä¸‡ç»´ç½‘ä¸Šçš„å„ç§æ–‡æ¡£ï¼Œä½¿ç”¨è¶…æ–‡æœ¬ä¼ é€åè®®httpã€‚httpä½¿ç”¨tcpè¿›è¡Œå¯é ä¼ é€ï¼Œä½¿ç”¨è¶…æ–‡æœ¬æ ‡è®°è¯­è¨€htmlï¼Œä½¿å¾—ä¸‡ç»´ç½‘æ–‡æ¡£åœ¨å„ç§ä¸»æœºä¸Šæ˜¾ç¤ºå’ŒæŸ¥æ‰¾ä¿¡æ¯</li>\n<li>URL(Uniform Resource Locator)ï¼ˆç»Ÿä¸€èµ„æºå®šä½ç¬¦ï¼Œä¸åŒºåˆ†å¤§å°å†™ï¼‰ï¼š&lt;åè®®&gt;://&lt;ä¸»æœº&gt;:&lt;ç«¯å£&gt;/&lt;è·¯å¾„&gt; .è¡¨ç¤ºäº’è”ç½‘ä¸Šå¾—åˆ°çš„èµ„æºä½ç½®å’Œè®¿é—®è¿™äº›èµ„æºçš„æ–¹æ³•ï¼Œæ˜¯ä¸äº’è”ç½‘ç›¸è¿çš„æœºå™¨ä¸Šçš„ä»»ä½•å¯è®¿é—®å¯¹è±¡çš„ä¸€ä¸ªæŒ‡é’ˆï¼Œäº’è”ç½‘ä¸Šçš„æ‰€æœ‰èµ„æºéƒ½æœ‰ä¸€ä¸ªå”¯ä¸€ç¡®å®šçš„urlï¼Œèµ„æºæŒ‡åœ¨äº’è”ç½‘ä¸Šå¯ä»¥è¢«è®¿é—®çš„ä»»ä½•å¯¹è±¡ï¼ŒåŒ…æ‹¬æ–‡ä»¶ç›®å½•ã€æ–‡ä»¶ã€æ–‡æ¡£ã€å›¾åƒã€å£°éŸ³ä»¥åŠä¸äº’è”ç½‘ç›¸è¿çš„ä»»ä½•å½¢å¼çš„æ•°æ®ã€‚èµ„æºè¿˜åŒ…æ‹¬ç”µå­é‚®ä»¶åœ°å€å’ŒUSENETæ–°é—»ç»„åŠå…¶æŠ¥æ–‡ã€‚</li>\n<li>httpçš„urlé»˜è®¤ç«¯å£å·80ï¼šå¯å¿½ç•¥</li>\n</ul>\n<h2>6.6. è¶…æ–‡æœ¬ä¼ é€åè®®http(HyperText Transfer Protocol)</h2>\n<ul>\n<li>httpçš„æ“ä½œè¿‡ç¨‹\n<ul>\n<li>httpè§„å®šå®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯æ¯æ¬¡äº¤äº’ï¼Œéƒ½ç”±ä¸€ä¸ªASCIIç ä¸²æ„æˆçš„è¯·æ±‚å’Œä¸€ä¸ªç±»ä¼¼é€šç”¨å› ç‰¹ç½‘é‚®ä»¶çš„æ‰©å……ï¼Œå³ç±»MIMEçš„ç›¸åº”ç»„æˆï¼ŒHTTPæŠ¥æ–‡é€šå¸¸éƒ½ç”¨TCPè¿æ¥ä¼ é€</li>\n<li>httpæ˜¯é¢å‘äº‹åŠ¡çš„åº”ç”¨å±‚åè®®ï¼Œä¼ é€å®Œæˆè¶…æ–‡æœ¬è·³è½¬æ‰€å¿…é¡»çš„ä¿¡æ¯ï¼Œè€Œä¸”ä¼ é€ä»»ä½•å¯ä»äº’è”ç½‘ä¸Šå¾—åˆ°çš„ä¿¡æ¯</li>\n<li>httpæ˜¯æ— è¿æ¥çš„ï¼Œè™½ç„¶ä½¿ç”¨äº†TCPè¿æ¥ï¼Œä½†é€šä¿¡åŒæ–¹åœ¨äº¤æ¢HTTPæŠ¥æ–‡ä¹‹å‰ä¸éœ€è¦å…ˆå»ºç«‹httpè¿æ¥</li>\n<li>httpæ˜¯æ— çŠ¶æ€çš„ï¼ŒæœåŠ¡å™¨ä¸è®°å¾—æ›¾ç»è®¿é—®è¿‡çš„ç”¨æˆ·ï¼Œä¹Ÿä¸è®°å¾—ä¸ºè¯¥ç”¨æˆ·æ›¾ç»æœåŠ¡è¿‡å¤šå°‘æ¬¡</li>\n<li>è¯·æ±‚ä¸€ä¸ªä¸‡ç»´ç½‘æ–‡æ¡£æ‰€éœ€çš„æ—¶é—´æ˜¯è¯¥æ–‡æ¡£çš„ä¼ è¾“æ—¶é—´åŠ ä¸Šä¸¤å€å¾€è¿”æ—¶é—´RTTï¼ˆä¸€ä¸ªRTTç”¨äºå»ºç«‹TCPï¼Œå¦ä¸€ä¸ªRTTç”¨äºè¯·æ±‚å’Œæ¥æ”¶ä¸‡ç»´ç½‘æ–‡æ¡£ï¼‰ã€‚TCPå»ºç«‹è¿æ¥çš„ä¸‰æŠ¥æ–‡æ¡æ‰‹çš„ç¬¬ä¸‰ä¸ªæŠ¥æ–‡æ®µä¸­çš„æ•°æ®ï¼Œå°±æ˜¯å®¢æˆ·å¯¹ä¸‡ç»´ç½‘çš„è¯·æ±‚æŠ¥æ–‡</li>\n<li>http1.1ä½¿ç”¨æŒç»­è¿æ¥ï¼šä¸‡ç»´ç½‘æœåŠ¡å™¨å™¨å†å‘é€å“åº”åä»ç„¶åœ¨ä¸€æ®µæ—¶é—´å†…ä¿æŒè¿™æ¡è¿æ¥ï¼Œä½¿åŒä¸€ä¸ªå®¢æˆ·ï¼ˆæµè§ˆå™¨ï¼‰å’Œè¯¥æœåŠ¡å™¨å¯ä»¥ç»§ç»­åœ¨è¿™æ¡è¿æ¥ä¸Šä¼ é€åç»­çš„httpè¯·æ±‚æŠ¥æ–‡å’Œå“åº”æŠ¥æ–‡ï¼Œä¸å±€é™äºä¼ é€åŒä¸€ä¸ªé¡µé¢é“¾æ¥çš„æ–‡æ¡£ï¼Œåªè¦æ˜¯åŒä¸€ä¸ªæœåŠ¡å™¨å°±å¯ä»¥</li>\n<li>http1.1åè®®çš„æŒç»­è¿æ¥å·¥ä½œæ–¹å¼\n<ul>\n<li>éæµæ°´çº¿æ–¹å¼ï¼šå®¢æˆ·ç«¯æ”¶åˆ°å‰ä¸€ä¸ªå“åº”åæ‰èƒ½å‘å‡ºä¸‹ä¸€ä¸ªè¯·æ±‚ã€‚åœ¨TCPè¿æ¥å»ºç«‹åï¼Œå®¢æˆ·æ¯è®¿é—®ä¸€æ¬¡å¯¹è±¡éƒ½è¦ç”¨å»ä¸€ä¸ªå¾€è¿”æ—¶é—´RTTã€æœåŠ¡å™¨å‘é€å®Œä¸€ä¸ªå¯¹è±¡åï¼Œå…¶TCPè¿æ¥å¤„äºç©ºé—²çŠ¶æ€ï¼Œæµªè´¹äº†æœåŠ¡å™¨èµ„æº</li>\n<li>æµæ°´çº¿æ–¹å¼ï¼šå®¢æˆ·ç«¯æ”¶åˆ°å“åº”æŠ¥æ–‡å‰èƒ½å¤Ÿæ¥ç€å‘é€æ–°çš„è¯·æ±‚æŠ¥æ–‡ã€‚æœåŠ¡å™¨å¯ä»¥è¿ç»­å‘å›å“åº”æŠ¥æ–‡ï¼Œå®¢æˆ·è®¿é—®çš„æ‰€æœ‰å¯¹è±¡åªéœ€èŠ±è´¹ä¸€ä¸ªRTTæ—¶é—´ã€‚æµæ°´çº¿å·¥ä½œæ–¹å¼ä½¿TCPè¿æ¥ä¸­çš„ç©ºé—²æ—¶é—´å‡å°‘ï¼Œæé«˜äº†æ•ˆç‡</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ä»£ç†æœåŠ¡å™¨/ä¸‡ç»´ç½‘é«˜é€Ÿç¼“å­˜\n<ul>\n<li>ä»£ç†æœåŠ¡å™¨æŠŠæœ€è¿‘çš„ä¸€äº›è¯·æ±‚å’Œå“åº”æš‚å­˜åœ¨æœ¬åœ°ç£ç›˜ä¸­ã€‚å½“æ–°è¯·æ±‚åˆ°è¾¾æ—¶ï¼Œè‹¥ä»£ç†æœåŠ¡å™¨å‘ç°è¿™ä¸ªè¯·æ±‚å’Œæš‚å­˜çš„è¯·æ±‚ç›¸åŒï¼Œå°±è¿”å›æš‚å­˜çš„å“åº”ï¼Œè€Œä¸éœ€è¦æŒ‰URLçš„åœ°å€å†å»äº’è”ç½‘è®¿é—®è¯¥èµ„æºï¼Œä»£ç†æœåŠ¡å™¨æ—¢æ˜¯æœåŠ¡å™¨ä¹Ÿæ˜¯å®¢æˆ·ç«¯</li>\n</ul>\n</li>\n<li>httpçš„æŠ¥æ–‡ç»“æ„ï¼šhttpæ˜¯é¢å‘æ–‡æœ¬çš„ï¼ŒæŠ¥æ–‡ä¸­çš„æ¯ä¸€ä¸ªå­—æ®µéƒ½æ˜¯ASCIIç ä¸²ï¼Œå„å­—æ®µçš„é•¿åº¦éƒ½æ˜¯ä¸å›ºå®šçš„\n<ul>\n<li>å¼€å§‹è¡Œï¼šç”¨äºåŒºåˆ†æ˜¯è¯·æ±‚æŠ¥æ–‡è¿˜æ˜¯å“åº”æŠ¥æ–‡ï¼Œåœ¨è¯·æ±‚æŠ¥æ–‡ä¸­çš„å¼€å§‹è¡Œå«åšè¯·æ±‚è¡Œï¼Œå“åº”æŠ¥æ–‡ä¸­å«çŠ¶æ€è¡Œï¼Œåœ¨å¼€å§‹è¡Œçš„ä¸‰ä¸ªå­—æ®µé—´éƒ½ä»¥ç©ºæ ¼åˆ†éš”å¼€ï¼ŒCRå’ŒLFåˆ†åˆ«ä»£è¡¨å›è½¦å’Œæ¢è¡Œ</li>\n<li>é¦–éƒ¨è¡Œï¼šè¯´æ˜æµè§ˆå™¨ã€æœåŠ¡å™¨æˆ–æŠ¥æ–‡ä¸»ä½“çš„ä¸€äº›ä¿¡æ¯ï¼Œåœ¨æ¯ä¸€ä¸ªé¦–éƒ¨è¡Œä¸­éƒ½æœ‰é¦–éƒ¨å­—æ®µåå’Œå®ƒçš„å€¼ï¼Œæ¯ä¸€è¡Œåœ¨ç»“æŸçš„åœ°æ–¹éƒ½è¦æœ‰å›è½¦å’Œæ¢è¡Œï¼Œé¦–éƒ¨è¡Œç»“æŸæ—¶ï¼Œè¿˜æœ‰ä¸€ç©ºè¡Œå°†é¦–éƒ¨è¡Œå’Œåé¢çš„å®ä½“ä¸»é¢˜åˆ†å¼€\n<ul>\n<li>Authorization èº«ä»½è®¤è¯æ•°æ®</li>\n<li>Connection è®¾ç½®å‘é€å“åº”ä¹‹å TCP è¿æ¥æ˜¯å¦ç»§ç»­ä¿æŒçš„é€šä¿¡é€‰é¡¹</li>\n<li>Referer å½“é€šè¿‡ç‚¹å‡»è¶…çº§é“¾æ¥è¿›å…¥ä¸‹ä¸€ä¸ªé¡µé¢æ—¶ï¼Œåœ¨è¿™é‡Œä¼šè®°å½•ä¸‹ä¸Šä¸€ä¸ªé¡µé¢çš„ URI</li>\n<li>User-Agent å®¢æˆ·ç«¯è½¯ä»¶çš„åç§°å’Œç‰ˆæœ¬å·ç­‰ç›¸å…³ä¿¡æ¯</li>\n<li>Accept å®¢æˆ·ç«¯å¯æ”¯æŒçš„æ•°æ®ç±»å‹ï¼ˆContent-Typeï¼‰ï¼Œä»¥ MIME ç±»å‹æ¥è¡¨ç¤º</li>\n<li>Accept-Charset å®¢æˆ·ç«¯å¯æ”¯æŒçš„å­—ç¬¦é›†</li>\n<li>Accept-Encoding å®¢æˆ·ç«¯å¯æ”¯æŒçš„ç¼–ç æ ¼å¼ï¼ˆContent-Encodingï¼‰ï¼Œä¸€èˆ¬æ¥è¯´è¡¨ç¤ºæ•°æ®çš„å‹ç¼©æ ¼å¼</li>\n<li>Accept-Language å®¢æˆ·ç«¯å¯æ”¯æŒçš„è¯­è¨€ï¼Œæ±‰è¯­ä¸º zhï¼Œè‹±è¯­ä¸º en</li>\n<li>Accept-Language å®¢æˆ·ç«¯å¯æ”¯æŒçš„è¯­è¨€ï¼Œæ±‰è¯­ä¸º zhï¼Œè‹±è¯­ä¸º en</li>\n<li>Accept\u0002Language å®¢æˆ·ç«¯å¯æ”¯æŒçš„è¯­è¨€ï¼Œæ±‰è¯­ä¸º zhï¼Œè‹±è¯­ä¸º en</li>\n<li>If-Modified\u0002Since å¦‚æœå¸Œæœ›ä»…å½“æ•°æ®åœ¨æŸä¸ªæ—¥æœŸä¹‹åæœ‰æ›´æ–°æ—¶æ‰æ‰§è¡Œè¯·æ±‚ï¼Œå¯ä»¥åœ¨è¿™ä¸ªå­—æ®µæŒ‡å®šå¸Œæœ›çš„æ—¥æœŸã€‚ç”¨äºåˆ¤æ–­å®¢æˆ·ç«¯ç¼“å­˜çš„æ•°æ®æ˜¯å¦å·²ç»è¿‡æœŸï¼Œå¦‚æœå·²ç»è¿‡æœŸåˆ™è·å–æ–°çš„æ•°æ®</li>\n<li>Allow è¡¨ç¤ºæŒ‡å®šçš„ URI æ”¯æŒçš„æ–¹æ³•</li>\n<li>Content-Encoding å½“æ¶ˆæ¯ä½“ç»è¿‡å‹ç¼©ç­‰ç¼–ç å¤„ç†æ—¶ï¼Œè¡¨ç¤ºå…¶ç¼–ç æ ¼å¼</li>\n<li>Content-Length è¡¨ç¤ºæ¶ˆæ¯ä½“çš„é•¿åº¦</li>\n<li>Content-Type è¡¨ç¤ºæ¶ˆæ¯ä½“çš„æ•°æ®ç±»å‹ï¼Œä»¥ MIME è§„æ ¼å®šä¹‰çš„æ•°æ®ç±»å‹æ¥è¡¨ç¤º</li>\n<li>Content-Language è¡¨ç¤ºæ¶ˆæ¯ä½“çš„è¯­è¨€ã€‚æ±‰è¯­ä¸º zhï¼Œè‹±è¯­ä¸º en</li>\n</ul>\n</li>\n<li>å®ä½“ä¸»ä½“ï¼šè¯·æ±‚æŠ¥æ–‡ä¸­ä¸€èˆ¬ä¸è¦ï¼Œå“åº”æŠ¥æ–‡ä¸­ä¹Ÿå¯èƒ½æ²¡æœ‰è¿™ä¸ªå­—æ®µã€‚æ ¼å¼ç”±content-typeå®šä¹‰</li>\n<li>httpè¯·æ±‚æŠ¥æ–‡ç‰¹ç‚¹\n<ul>\n<li>è¯·æ±‚è¡Œï¼šæ–¹æ³•ã€è¯·æ±‚èµ„æºURLï¼Œä»¥åŠHTTPç‰ˆæœ¬\n<ul>\n<li>OPTIONï¼šè¯·æ±‚ä¸€äº›é€‰é¡¹ä¿¡æ¯</li>\n<li>GETï¼šè¯·æ±‚è¯»å‡ºURLæ‰€æ ‡å¿—çš„ä¿¡æ¯ï¼ˆåªèƒ½å‘é€å‡ ç™¾å­—èŠ‚çš„æ•°æ®ï¼Œè¶…è¿‡ç”¨POSTæäº¤ï¼‰</li>\n<li>HEAD è¯·æ±‚è¯»å‡ºç”±URLæ‰€æ ‡å¿—çš„ä¿¡æ¯çš„é¦–éƒ¨</li>\n<li>POSTï¼šç»™æœåŠ¡å™¨æ·»åŠ ä¿¡æ¯</li>\n<li>PUTï¼šæŒ‡æ˜URLä¸‹å­˜å‚¨ä¸€ä¸ªæ–‡æ¡£ï¼Œä¸å­˜åœ¨åˆ™åˆ›å»º</li>\n<li>DELETE åˆ é™¤æŒ‡æ˜çš„URLæ‰€æ ‡å¿—çš„èµ„æº</li>\n<li>TRACEï¼šå°†æœåŠ¡å™¨æ”¶åˆ°çš„è¯·æ±‚è¡Œå’Œå¤´éƒ¨è¿”å›ç»™å®¢æˆ·ç«¯ã€‚ç”¨äºä½¿ç”¨ä»£ç†çš„ç¯å¢ƒä¸­æ£€æŸ¥æ”¹å†™è¯·æ±‚çš„æƒ…å†µã€‚è¿›è¡Œç¯å›æµ‹è¯•çš„è¯·æ±‚æŠ¥æ–‡</li>\n<li>CONNETï¼šç”¨äºä»£ç†æœåŠ¡å™¨ä¼ è¾“åŠ å¯†æ¶ˆæ¯</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>httpå“åº”æŠ¥æ–‡ç‰¹ç‚¹\n<ul>\n<li>çŠ¶æ€è¡Œï¼šHTTPç‰ˆæœ¬ï¼ŒçŠ¶æ€ç ï¼Œä»¥åŠè§£é‡ŠçŠ¶æ€ç çš„ç®€å•çŸ­è¯­\n<ul>\n<li>1xxè¡¨ç¤ºé€šçŸ¥ä¿¡æ¯ï¼ˆè¯·æ±‚çš„å¤„ç†è¿›åº¦å’Œæƒ…å†µï¼‰çš„ï¼Œå¦‚è¯·æ±‚æ”¶åˆ°äº†æ­£åœ¨è¿›è¡Œå¤„ç†</li>\n<li>2xxè¡¨ç¤ºæˆåŠŸäº†ï¼Œå¦‚æ¥å—æˆ–çŸ¥é“äº†</li>\n<li>3xxè¡¨ç¤ºé‡å®šå‘ï¼Œå¦‚è¦å®Œæˆè¯·æ±‚è¿˜å¿…é¡»é‡‡å–è¿›ä¸€æ­¥è¡ŒåŠ¨</li>\n<li>4xxè¡¨ç¤ºå®¢æˆ·çš„å·®é”™ï¼Œå¦‚è¯·æ±‚ä¸­æœ‰é”™è¯¯çš„è¯­æ³•æˆ–ä¸èƒ½å®Œæˆ</li>\n<li>5xxè¡¨ç¤ºæœåŠ¡å™¨å·®é”™ï¼Œå¦‚æœåŠ¡å™¨å¤±æ•ˆæ— æ³•å®Œæˆè¯·æ±‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Cookieï¼šhttpæœåŠ¡å™¨å’Œå®¢æˆ·ç›´æ¥ä¼ é€’çš„çŠ¶æ€ä¿¡æ¯\n<ul>\n<li>å½“ç”¨æˆ·æµè§ˆæŸä¸ªä½¿ç”¨Cookieçš„ç½‘ç«™æ—¶ï¼ŒæœåŠ¡å™¨å°±ä¸ºç”¨æˆ·äº§ç”Ÿä¸€ä¸ªå”¯ä¸€çš„è¯†åˆ«ç ï¼Œå¹¶ä»¥æ­¤ä½œä¸ºç´¢å¼•åœ¨æœåŠ¡å™¨çš„åç«¯æ•°æ®åº“äº§ç”Ÿä¸€ä¸ªé¡¹ç›®ï¼Œæ¥ç€åœ¨ç»™ç”¨æˆ·çš„å“åº”æŠ¥æ–‡ä¸­æ·»åŠ å­—æ®µåä¸º\"Set-Cookieï¼šxxx\"çš„é¦–éƒ¨è¡Œï¼Œå€¼å°±æ˜¯èµ‹äºˆç”¨æˆ·çš„\"è¯†åˆ«ç \"ï¼Œç”¨æˆ·æ”¶åˆ°å“åº”æ—¶ï¼Œæµè§ˆå™¨ä¼šåœ¨å®ƒç®¡ç†çš„ç‰¹å®šCookieæ–‡ä»¶ä¸­æ·»åŠ ä¸€è¡Œï¼ŒåŒ…æ‹¬è¿™ä¸ªæœåŠ¡å™¨çš„ä¸»æœºåå’Œ\"Set-Cookie\"åé¢ç»™å‡ºçš„è¯†åˆ«ç ã€‚å½“ç”¨æˆ·ç»§ç»­è®¿é—®è¯¥ç½‘ç«™æ—¶ï¼Œæ²¡å‘å‡ºä¸€ä¸ªhttpè¯·æ±‚ï¼Œæµè§ˆå™¨å°±ä»Cookieæ–‡ä»¶ä¸­å–å‡ºè¿™ä¸ªç½‘ç«™çš„è¯†åˆ«ç ï¼Œå¹¶æ”¾åˆ°httpè¯·æ±‚æŠ¥æ–‡çš„Cookieé¦–éƒ¨è¡Œä¸­\"Cookie\":xxx</li>\n</ul>\n</li>\n</ul>\n<h2>6.7. åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCP(Dynamic Host Configuration Protocol)</h2>\n<ul>\n<li>ä¸ºäº†æŠŠåè®®è½¯ä»¶åšæˆé€šç”¨çš„å’Œä¾¿äºç§»æ¤ï¼Œéœ€è¦æŠŠè½¯ä»¶å‚æ•°åŒ–ï¼Œåœ¨åè®®ä¸­ç»™è¿™äº›å‚æ•°èµ‹å€¼çš„åŠ¨ä½œç§°ä¸ºåè®®é…ç½®</li>\n<li>åŠ¨æ€ä¸»æœºé…ç½®åè®®DHCPæä¾›å³æ’å³ç”¨è”ç½‘æœºåˆ¶ï¼Œå…è®¸ä¸€å°è®¡ç®—æœºåŠ å…¥æ–°çš„ç½‘ç»œå’Œè·å–IPåœ°å€è€Œä¸ç”¨æ‰‹å·¥å‚ä¸</li>\n<li>æ¯ä¸ªç½‘ç»œè‡³å°‘æœ‰ä¸€ä¸ªDHCPä¸­ç»§ä»£ç†ï¼ˆè·¯ç”±å™¨ï¼‰ï¼Œé…ç½®äº†DHCPæœåŠ¡å™¨çš„IPåœ°å€ä¿¡æ¯ã€‚å½“DHCPä¸­ç»§æ”¶åˆ°ä¸»æœºä»¥å¹¿æ’­å½¢å¼å‘é€çš„å‘ç°æŠ¥æ–‡åï¼Œå°±ä»¥å•æ’­æ–¹å¼å‘DHCPæœåŠ¡å™¨è½¬å‘æ­¤æŠ¥æ–‡ï¼Œå¹¶ç­‰å¾…å…¶å›ç­”ã€‚æ”¶åˆ°DHCPæœåŠ¡å™¨å›ç­”çš„æä¾›æŠ¥æ–‡åï¼ŒDHCPä¸­ç»§ä»£ç†å†æŠŠæ­¤æä¾›æŠ¥æ–‡å‘å›ç»™ä¸»æœº</li>\n<li>DHCPæŠ¥æ–‡æ˜¯å±€åŸŸç½‘åè®®ï¼Œä½¿ç”¨UDPç”¨æˆ·æ•°æ®æŠ¥æ•°æ®ï¼ŒDHCPå°±æ˜¯è‡ªåŠ¨è·å¾—IPåœ°å€å’Œè‡ªåŠ¨è·å¾—DNSæœåŠ¡å™¨åœ°å€çš„åŸç†ï¼Œè¡¨ç¤ºè‡ªåŠ¨ä½¿ç”¨DHCPåè®®</li>\n<li>DHCPæœåŠ¡å™¨åˆ†é…ç»™DHCPå®¢æˆ·çš„IPåœ°å€æ˜¯ä¸´æ—¶çš„ï¼Œåªèƒ½åœ¨ä¸€æ®µæœ‰é™æ—¶é—´(ç§Ÿç”¨æœŸ)å†…ä½¿ç”¨è¿™ä¸ªåˆ†é…åˆ°çš„IPåœ°å€</li>\n<li>DHCPå·¥ä½œè¿‡ç¨‹\n<ul>\n<li>DHCPæœåŠ¡å™¨è¢«åŠ¨æ‰“å¼€UDPç«¯å£67ï¼Œç­‰å¾…å®¢æˆ·ç«¯å‘æ¥çš„æŠ¥æ–‡</li>\n<li>DHCPå®¢æˆ·ä»UDPç«¯å£68å‘é€DHCPå‘ç°æŠ¥æ–‡</li>\n<li>å‡¡æ”¶åˆ°DHCPå‘ç°æŠ¥æ–‡çš„DHCPæœåŠ¡å™¨å‘å‡ºDHCPæä¾›æŠ¥æ–‡ï¼ŒDHCPå®¢æˆ·å¯èƒ½æ”¶åˆ°å¤šä¸ªDHCPæä¾›æŠ¥æ–‡</li>\n<li>DHCPå®¢æˆ·ä»å‡ ä¸ªDHCPæœåŠ¡å™¨ä¸­é€‰æ‹©å…¶ä¸­ä¸€ä¸ªï¼Œå¹¶å‘æ‰€é€‰æ‹©çš„DHCPæœåŠ¡å™¨å‘é€DHCPè¯·æ±‚æŠ¥æ–‡</li>\n<li>è¢«é€‰æ‹©çš„DHCPæœåŠ¡å™¨å‘é€ç¡®è®¤æŠ¥æ–‡DHCPACKå¹¶æä¾›IPåœ°å€ï¼Œä»è¿™æ—¶èµ·ï¼ŒDHCPå®¢æˆ·å¯ä»¥ä½¿ç”¨è¿™ä¸ªIPåœ°å€ï¼Œè¿™ç§çŠ¶æ€ç§°ä¸ºå·²ç»‘å®šçŠ¶æ€ï¼Œå› ä¸ºåœ¨DHCPçš„IPåœ°å€å’Œç¡¬ä»¶åœ°å€å·²ç»å®Œæˆç»‘å®šï¼Œå¹¶ä¸”å¯ä»¥å¼€å§‹ä½¿ç”¨å¾—åˆ°çš„ä¸´æ—¶IPåœ°å€ã€‚DHCPå®¢æˆ·è¦æ ¹æ®æœåŠ¡å™¨æä¾›çš„ç§Ÿç”¨æœŸTè®¾ç½®ä¸¤ä¸ªè®¡æ—¶å™¨T1ï¼ˆ0.5Tï¼‰å’ŒT2ï¼ˆ0.785Tï¼‰</li>\n<li>T1æ—¶é—´åˆ°ï¼Œ DHCPå‘é€è¯·æ±‚æŠ¥æ–‡DHCPREQUESTè¦æ±‚æ›´æ–°ç§Ÿç”¨æœŸ</li>\n<li>DHCPæœåŠ¡å™¨è‹¥åŒæ„ï¼Œåˆ™å‘å›ç¡®è®¤æŠ¥æ–‡DHCPACKï¼ŒDHCPå®¢æˆ·å¾—åˆ°äº†æ–°çš„ç§Ÿç”¨æœŸï¼Œé‡æ–°è®¾ç½®è®¡æ—¶å™¨</li>\n<li>DHCPæœåŠ¡å™¨è‹¥ä¸åŒæ„ï¼Œåˆ™å‘å›å¦è®¤æŠ¥æ–‡DHCPNACKã€‚DHCPå®¢æˆ·å¿…é¡»ç«‹å³åœæ­¢ä½¿ç”¨åŸæ¥çš„IPåœ°å€ï¼Œé‡æ–°ç”³è¯·</li>\n<li>è‹¥DHCPæœåŠ¡å™¨ä¸å“åº”è¯·æ±‚æŠ¥æ–‡DHCPREQUESTï¼ŒT2æ—¶é—´åˆ°ï¼ŒDHCPå®¢æˆ·å¿…é¡»é‡æ–°å‘é€è¯·æ±‚æŠ¥æ–‡DHCPREUESTï¼Œç»§ç»­åé¢æ­¥éª¤</li>\n<li>DHCPå®¢æˆ·ç«¯å¯ä»¥éšæ—¶æå‰ç»ˆæ­¢æœåŠ¡å™¨æ‰€æä¾›çš„ç§Ÿç”¨æœŸï¼Œè¿™æ—¶åªéœ€å‘DHCPæœåŠ¡å™¨å‘é€é‡Šæ”¾æŠ¥æ–‡DHCPREKEASEå³å¯</li>\n</ul>\n</li>\n</ul>\n<h2>6.8. HTTPSåè®®è¯¦è§£</h2>\n<ul>\n<li>HTTPæ˜¯æ˜æ–‡ä¼ è¾“çš„,HTTPS(Secure)æ˜¯å®‰å…¨çš„HTTPåè®®,http(s)ğŸ˜•/&lt;ä¸»æœº&gt;:&lt;ç«¯å£&gt;/&lt;è·¯å¾„&gt; 443</li>\n<li>åŠ å¯†æ¨¡å‹\n<ul>\n<li>Aã€Bæ˜¯æ‹¥æœ‰ä¸€å®šæ•°å­¦å…³ç³»çš„ä¸€ç»„ç§˜é’¥</li>\n<li>ç§é’¥ ç§é’¥è‡ªå·±ä½¿ç”¨ï¼Œä¸å¯¹å¤–å…¬å¼€</li>\n<li>å…¬é’¥ å…¬é’¥ç»™å¤§å®¶ä½¿ç”¨ï¼Œå¯¹å¤–å…¬å¼€</li>\n<li>æ•°å­—è¯ä¹¦\n<ul>\n<li>æ•°å­—è¯ä¹¦æ˜¯å¯ä¿¡ä»»ç»„ç»‡é¢å‘ç»™ç‰¹å®šå¯¹è±¡çš„è®¤è¯</li>\n<li>è¯ä¹¦æ ¼å¼ã€ç‰ˆæœ¬å· è¯ä¹¦åºåˆ—å· ç­¾åç®—æ³• æœ‰æ•ˆæœŸ å¯¹è±¡åç§° å¯¹è±¡å…¬å¼€ç§˜é’¥</li>\n</ul>\n</li>\n<li>SSL(Secure Sockets Layer: å®‰å…¨å¥—æ¥å±‚)\n<ul>\n<li>æ•°æ®å®‰å…¨å’Œæ•°æ®å®Œæ•´</li>\n<li>å¯¹ä¼ è¾“å±‚æ•°æ®è¿›è¡ŒåŠ å¯†åä¼ è¾“</li>\n</ul>\n</li>\n<li>æ ¹æ®éšæœºæ•°1ã€2ã€3å’Œç›¸åŒçš„ç®—æ³•ç”Ÿæˆå¯¹ç§°ç§˜é’¥</li>\n<li>åŒæ–¹ä½¿ç”¨å¯¹ç§°ç§˜é’¥è¿›è¡ŒåŠ å¯†é€šä¿¡</li>\n<li>ç»¼åˆä½¿ç”¨å¯¹ç§°åŠ å¯†ã€éå¯¹ç§°åŠ å¯†</li>\n<li>åŒæ–¹åˆ†åˆ«ç”Ÿæˆç§˜é’¥ï¼Œæ²¡æœ‰ç»è¿‡ä¼ è¾“\t<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/036c1b8c9273e6a20e47d.png\" alt=\"38.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6a77477bfda27fbc401c9.png\" alt=\"39.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/47d5cb3100ce3dc3088bf.png\" alt=\"40.PNG\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/782f3db11aa8a906653c6.png\" alt=\"41.PNG\"></li>\n</ul>\n</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/006edd2a16af2f7f2b12b.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "MongoDB",
      "url": "https://javaguide.cn/backend/database/mongodb.html",
      "id": "https://javaguide.cn/backend/database/mongodb.html",
      "summary": "MongoDBæ˜¯nosqlæ•°æ®åº“çš„ä¸€ç§,å¯¹node.jsæœ‰æ¯”è¾ƒå¥½çš„æ”¯æŒ æ˜¯éå…³ç³»å‹æ•°æ®åº“ 1. å…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“ 2. MongoDBæ˜¯æœ€æ¥è¿‘å…³ç³»å‹æ•°æ®åº“çš„éå…³ç³»å‹æ•°æ®åº“ æ”¯æŒçš„æ•°æ®ç±»å‹âˆš 3. mongodbæ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ MongoDBå‘½ä»¤ 5.4. node.jsæ“ä½œmongodb(æ‰€æœ‰å¯¹mongodbæ•°æ®åº“æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„) 1. ...",
      "content_html": "<p>MongoDBæ˜¯nosqlæ•°æ®åº“çš„ä¸€ç§,å¯¹node.jsæœ‰æ¯”è¾ƒå¥½çš„æ”¯æŒ<br>\næ˜¯éå…³ç³»å‹æ•°æ®åº“</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8E%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93\">1. å…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“</a></li>\n<li><a href=\"#2-mongodb%E6%98%AF%E6%9C%80%E6%8E%A5%E8%BF%91%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E9%9D%9E%E5%85%B3%E7%B3%BB%E5%9E%8B%E6%95%B0%E6%8D%AE%E5%BA%93\">2. MongoDBæ˜¯æœ€æ¥è¿‘å…³ç³»å‹æ•°æ®åº“çš„éå…³ç³»å‹æ•°æ®åº“</a></li>\n<li><a href=\"#%E6%94%AF%E6%8C%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\">æ”¯æŒçš„æ•°æ®ç±»å‹âˆš</a></li>\n<li><a href=\"#3-mongodb%E6%95%B0%E6%8D%AE%E5%BA%93%E7%9A%84%E5%9F%BA%E6%9C%AC%E6%A6%82%E5%BF%B5\">3. mongodbæ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ</a></li>\n<li><a href=\"#mongodb%E5%91%BD%E4%BB%A4\">MongoDBå‘½ä»¤</a></li>\n<li><a href=\"#54-nodejs%E6%93%8D%E4%BD%9Cmongodb%E6%89%80%E6%9C%89%E5%AF%B9mongodb%E6%95%B0%E6%8D%AE%E5%BA%93%E6%93%8D%E4%BD%9C%E9%83%BD%E6%98%AF%E5%BC%82%E6%AD%A5%E7%9A%84\">5.4. node.jsæ“ä½œmongodb(æ‰€æœ‰å¯¹mongodbæ•°æ®åº“æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„)</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. å…³ç³»å‹æ•°æ®åº“ä¸éå…³ç³»å‹æ•°æ®åº“</h1>\n<ul>\n<li>å…³ç³»å‹æ•°æ®åº“æ˜¯æŒ‡è¡¨ä¸è¡¨ä¹‹é—´å­˜åœ¨è”ç³»</li>\n<li>æ‰€æœ‰å…³ç³»å‹æ•°æ®åº“åœ¨æ“ä½œä¹‹å‰éƒ½è¦è®¾è®¡è¡¨ç»“æ„</li>\n<li>æ‰€æœ‰å…³ç³»å‹æ•°æ®åº“éƒ½è¦é€šè¿‡sqlè¯­éŸ³æ¥æ“ä½œ</li>\n<li>å…³ç³»å‹æ•°æ®åº“çš„è¡¨è¿˜æ”¯æŒçº¦æŸ</li>\n<li>éå…³ç³»å‹æ•°æ®åº“éå¸¸çµæ´»ï¼ˆé”®å€¼å¯¹ï¼‰</li>\n</ul>\n<h1>2. MongoDBæ˜¯æœ€æ¥è¿‘å…³ç³»å‹æ•°æ®åº“çš„éå…³ç³»å‹æ•°æ®åº“</h1>\n<ul>\n<li>æ•°æ®åº“â†’æ•°æ®åº“ï¼›æ•°æ®è¡¨â†’é›†åˆï¼›è¡¨è®°å½•â†’æ–‡æ¡£å¯¹è±¡</li>\n</ul>\n<h1>æ”¯æŒçš„æ•°æ®ç±»å‹âˆš</h1>\n<p>1ã€String<br>\n2ã€Integer<br>\n3ã€Double<br>\n4ã€Boolean<br>\n5ã€Object<br>\n6ã€Object ID<br>\n7ã€Arrays<br>\n8ã€Min/Max Keys<br>\n9ã€Datetime<br>\n10ã€Code<br>\n11ã€Regular Expression ç­‰</p>\n<h1>3. mongodbæ•°æ®åº“çš„åŸºæœ¬æ¦‚å¿µ</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ•°æ®åº“ï¼ˆå¤§å¯¹è±¡ï¼‰â†’é›†åˆï¼ˆæ•°ç»„ï¼‰â†’æ–‡æ¡£ï¼ˆå°å¯¹è±¡ï¼‰\n{\n\ta(æ•°æ®åº“):{\n\t\taa(é›†åˆ):[\n\t\t\t{\"name\":\"junye1\"},ï¼ˆæ–‡æ¡£1ï¼‰\n\t\t\t{\"name\":\"junye2\"},ï¼ˆæ–‡æ¡£2ï¼‰\n\t\t]\n\t}\n\tb(æ•°æ®åº“):{\n\t\tbb(é›†åˆ):[\n\t\t\t{\"name\":\"junye3\"},ï¼ˆæ–‡æ¡£3ï¼‰\n\t\t\t{\"name\":\"junye4\"},ï¼ˆæ–‡æ¡£4ï¼‰\n\t\t]\n\t}\n\n}\n</code></pre></div><h1>MongoDBå‘½ä»¤</h1>\n<ul>\n<li>æµ‹è¯•æ˜¯å¦æˆåŠŸmongod --versionæµ‹è¯•æ˜¯å¦æˆåŠŸ</li>\n<li>å¼€å¯æœåŠ¡mongod [--dbpath=æ•°æ®å­˜å‚¨ç›®å½•è·¯å¾„]é»˜è®¤ä½¿ç”¨æ‰§è¡Œmongodå‘½ä»¤æ‰€å¤„ç›˜ç¬¦æ ¹ç›®å½•ä¸‹çš„/data/dbä½œä¸ºæ•°æ®å­˜å‚¨ç›®å½•ï¼Œæ‰€ä»¥åœ¨æ‰§è¡Œç¬¬ä¸€æ¬¡å‘½ä»¤çš„æ—¶å€™æ‰‹åŠ¨åˆ›å»ºä¸€ä¸ª/data/dbä½œä¸ºæ•°æ®å­˜å‚¨ç›®å½•</li>\n<li>å…³é—­æœåŠ¡ ï¼šctrl+c</li>\n<li>æŸ¥çœ‹æ•°æ®åº“åˆ—è¡¨show dbs</li>\n<li>æŸ¥çœ‹å½“å‰æ“ä½œçš„æ•°æ®åº“db</li>\n<li>åˆ‡æ¢åˆ°æŒ‡å®šæ•°æ®åº“ï¼Œå¦‚æ²¡æœ‰åˆ™ï¼ˆå½“æœ‰æ•°æ®çš„æ—¶å€™ï¼‰æ–°å»º:use æ•°æ®åº“åç§°</li>\n<li>æ’å…¥æ•°æ® db.student.insertOne({\"name\":\"jack\"})</li>\n<li>æŸ¥è¯¢é›†åˆï¼ˆâ€œè¡¨==æ•°ç»„â€ï¼‰show conllections</li>\n<li>æŸ¥è¯¢é›†åˆä¸‹æ‰€æœ‰çš„æ•°æ®db.student.find()</li>\n</ul>\n<h1>5.4. node.jsæ“ä½œmongodb(æ‰€æœ‰å¯¹mongodbæ•°æ®åº“æ“ä½œéƒ½æ˜¯å¼‚æ­¥çš„)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># ä½¿ç”¨ç¬¬ä¸‰æ–¹monggoseæ“ä½œï¼ˆåŸºäºä¸Šé¢çš„åŒ…å†æ¬¡å°è£…ï¼‰ï¼ˆæ¨èï¼‰\n\n//å®‰è£…npm -i install monggose\nconst mongoose = require('mongoose');\nmongoose.connect('mongodb://localhost/test');\n\nconst Cat = mongoose.model('Cat', { name: String });\n\nconst kitty = new Cat({ name: 'Zildjian' });\nkitty.save().then(() =&gt; console.log('meow'));\n\n# 6. node.jsè¿æ¥mongodbè®¾è®¡é›†åˆç»“æ„\n\nvar mongoose = require('mongoose');\nvar Schema = mongoose.Schema;\n//è®¾è®¡é›†åˆç»“æ„(è¡¨ç»“æ„)\n//å­—æ®µåç§°æ˜¯è¡¨ç»“æ„ä¸­çš„å±æ€§åç§°(çº¦æŸ)å€¼\nvar blogSchema = new Schema({\n\ttitle:  String,\n\tauthor: String,\n\tbody:   String,\n\tcomments: [{ body: String, date: Date }],\n\tdate: { type: Date, default: Date.now },\n\thidden: Boolean,\n\tmeta: {\n\t  votes: Number,\n\t  favs:  Number,\n\t  requireï¼štrue\n\t}\n});\n//å°†æ–‡æ¡£ç»“æ„å‘å¸ƒä¸ºæ¨¡å‹\n//ç¬¬ä¸€ä¸ªå‚æ•°è¡¨ç¤ºæ•°æ®åº“åç§°ï¼Œmongooseä¼šè‡ªåŠ¨å°†å¤§å†™åè¯çš„å­—ç¬¦ä¸²ç”Ÿæˆå°å†™å¤æ•°çš„é›†åˆåç§°ä¾‹å¦‚è¿™é‡Œçš„Blogä¼šå˜æˆblogsé›†åˆåç§°\n//ç¬¬äºŒä¸ªå‚æ•°è¡¨ç¤ºæ¶æ„Schema\nvar Blog = mongoose.model('Blog', blogSchema);\n\n# æ’å…¥æ•°æ®\n\nvar testsave = new Blog({\n\ttitle:  \"haha\",\n\tauthor: \"junye\",\n\tbody:   \"ceshi\",\n\tcomments: [{ body: \"xh\", date: \"2018-08-06\" }],\n\tdate: { type: \"2018-08-06\", default: \"2018-08-06\" },\n\thidden: false,\n\tmeta: {\n\t\t1\n\t}\n\n})\ntest.save((function)(err,ret//è¿”å›å€¼){\n\tif(err){console.log('ä¿å­˜å¤±è´¥')}\n\telse{console.log('ä¿å­˜æˆåŠŸ')}\n})\n\n# æŸ¥è¯¢æ•°æ®\n\n//æŸ¥è¯¢æ‰€æœ‰\nBlog.find(function(err,ret){\n\tif(err){\n\t\tconsole.log('æŸ¥è¯¢å¤±è´¥')\n\t}else{console.log(ret)//è¿”å›æ‰€æœ‰æ•°ç»„}\n})\n//æ¡ä»¶æŸ¥è¯¢ï¼ˆå¯èƒ½å¤šä¸ªï¼‰\nBlog.find({title:'haha'},function(err,ret){\n\tif(err){\n\t\tconsole.log('æŸ¥è¯¢å¤±è´¥')\n\t}else{console.log(ret)//è¿”å›æ‰€æœ‰æ•°ç»„}\n})\n//æŸ¥è¯¢ä¸€ä¸ª\nBlog.findOne({title:'haha'},function(err,ret){\n\tif(err){\n\t\tconsole.log('æŸ¥è¯¢å¤±è´¥')\n\t}else{console.log(ret)//è¿”å›æ‰€æœ‰æ•°ç»„}\n})\n\n# åˆ é™¤æ•°æ®\n\n//æ ¹æ®æ¡ä»¶åˆ é™¤æ‰€æœ‰\nBlog.remove({title:'haha'},function(err,ret){\n\tif(err){\n\t\tconsole.log('åˆ é™¤å¤±è´¥')\n\t}else{console.log('åˆ é™¤æˆåŠŸ')}\n})\n//æ ¹æ®æ¡ä»¶åˆ é™¤ä¸€ä¸ª\nBlog.findOneAndRemove(conditions,[options],[callback])\n//æ ¹æ®idåˆ é™¤ä¸€ä¸ª\nModel.findByIdAndRemove(conditions,[options],[callback])\n\n# æ›´æ–°æ•°æ®\n\n//æ ¹æ®æ¡ä»¶æ›´æ–°æ‰€æœ‰\nBlog.findByIdAndUpdate(conditions,[options],[callback])\n//æ ¹æ®æŒ‡å®šæ¡ä»¶æ›´æ–°ä¸€ä¸ª\nBlog.findOneAndUpdate([conditions],[update][options],[callback])\n//æ ¹æ®idæ›´æ–°ä¸€ä¸ª\nBlog.findByIdAndUpdate('xxxxxxxx',function(err,ret){\n\tif(err){\n\t\tconsole.log('æ›´æ–°å¤±è´¥')\n\t}else{console.log(ret)//æ›´æ–°æˆåŠŸ}\n})\n\n# å¼‚æ­¥promiseæ“ä½œæ•°æ®åº“çš„æ–¹æ³•\nUser.findOne({\n\tusername:'456'\n})\n.then(function(user){\n\tif(user){\n\t\tconsole.log('ç”¨æˆ·å·²å­˜åœ¨')\n\t}else{\n\t\treturn new User({\n\t\t\tusername:'aaa'\n\t\t\tpassword:'123'\n\t\t\temail:'dads'\n\t\t}).save()\n\t}\n}).then(function(ret){\n\n})\n# å¼‚æ­¥å›è°ƒæ“ä½œæ•°æ®åº“çš„æ–¹æ³•\nUser.findOne({username:'456'},function(user){}\n\tif(user){\n\t}else{\n\t\tnew User({\n\t\t\tusername:'aaa'\n\t\t\tpassword:'123'\n\t\t\temail:'dads'\n\t\t}),save(function(){\n\t\t\n\t\t})\n\t}\n)\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æ•°æ®åº“"
      ]
    },
    {
      "title": "MySQL",
      "url": "https://javaguide.cn/backend/database/mysql.html",
      "id": "https://javaguide.cn/backend/database/mysql.html",
      "summary": "1. æ•°æ®åº“æ¦‚å¿µ 2. MySQLæ”¯æŒçš„æ•°æ®ç±»å‹ 2.1. æ•°å€¼ç±»å‹ 2.2. æ—¥æœŸæ—¶é—´ç±»å‹ 2.3. å­—ç¬¦ä¸²ç±»å‹ 2.4. é€‰æ‹©åˆé€‚çš„æ•°æ®ç±»å‹ 3. MySQLä¸­çš„è¿ç®—ç¬¦ 3.1. ç®—æœ¯è¿ç®—ç¬¦ 3.2. æ¯”è¾ƒè¿ç®—ç¬¦ 3.3. é€»è¾‘è¿ç®—ç¬¦ 3.4. ä½è¿ç®—ç¬¦ 4. MySQLå¸¸ç”¨å‡½æ•° 4.1. èšåˆå‡½æ•° 4.2. å­—ç¬¦ä¸²å‡½æ•° 4.3. æ•°å€¼å‡½æ•° 4.4...",
      "content_html": "<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E6%95%B0%E6%8D%AE%E5%BA%93%E6%A6%82%E5%BF%B5\">1. æ•°æ®åº“æ¦‚å¿µ</a></li>\n<li><a href=\"#2-mysql%E6%94%AF%E6%8C%81%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\">2. MySQLæ”¯æŒçš„æ•°æ®ç±»å‹</a>\n<ul>\n<li><a href=\"#21-%E6%95%B0%E5%80%BC%E7%B1%BB%E5%9E%8B\">2.1. æ•°å€¼ç±»å‹</a></li>\n<li><a href=\"#22-%E6%97%A5%E6%9C%9F%E6%97%B6%E9%97%B4%E7%B1%BB%E5%9E%8B\">2.2. æ—¥æœŸæ—¶é—´ç±»å‹</a></li>\n<li><a href=\"#23-%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%B1%BB%E5%9E%8B\">2.3. å­—ç¬¦ä¸²ç±»å‹</a></li>\n<li><a href=\"#24-%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\">2.4. é€‰æ‹©åˆé€‚çš„æ•°æ®ç±»å‹</a></li>\n</ul>\n</li>\n<li><a href=\"#3-mysql%E4%B8%AD%E7%9A%84%E8%BF%90%E7%AE%97%E7%AC%A6\">3. MySQLä¸­çš„è¿ç®—ç¬¦</a>\n<ul>\n<li><a href=\"#31-%E7%AE%97%E6%9C%AF%E8%BF%90%E7%AE%97%E7%AC%A6\">3.1. ç®—æœ¯è¿ç®—ç¬¦</a></li>\n<li><a href=\"#32-%E6%AF%94%E8%BE%83%E8%BF%90%E7%AE%97%E7%AC%A6\">3.2. æ¯”è¾ƒè¿ç®—ç¬¦</a></li>\n<li><a href=\"#33-%E9%80%BB%E8%BE%91%E8%BF%90%E7%AE%97%E7%AC%A6\">3.3. é€»è¾‘è¿ç®—ç¬¦</a></li>\n<li><a href=\"#34-%E4%BD%8D%E8%BF%90%E7%AE%97%E7%AC%A6\">3.4. ä½è¿ç®—ç¬¦</a></li>\n</ul>\n</li>\n<li><a href=\"#4-mysql%E5%B8%B8%E7%94%A8%E5%87%BD%E6%95%B0\">4. MySQLå¸¸ç”¨å‡½æ•°</a>\n<ul>\n<li><a href=\"#41-%E8%81%9A%E5%90%88%E5%87%BD%E6%95%B0\">4.1. èšåˆå‡½æ•°</a></li>\n<li><a href=\"#42-%E5%AD%97%E7%AC%A6%E4%B8%B2%E5%87%BD%E6%95%B0\">4.2. å­—ç¬¦ä¸²å‡½æ•°</a></li>\n<li><a href=\"#43-%E6%95%B0%E5%80%BC%E5%87%BD%E6%95%B0\">4.3. æ•°å€¼å‡½æ•°</a></li>\n<li><a href=\"#44-%E6%97%A5%E6%9C%9F%E5%92%8C%E6%97%B6%E9%97%B4%E5%87%BD%E6%95%B0\">4.4. æ—¥æœŸå’Œæ—¶é—´å‡½æ•°</a></li>\n<li><a href=\"#45-%E6%B5%81%E7%A8%8B%E5%87%BD%E6%95%B0\">4.5. æµç¨‹å‡½æ•°</a></li>\n<li><a href=\"#46-%E5%85%B6%E4%BB%96%E5%87%BD%E6%95%B0\">4.6. å…¶ä»–å‡½æ•°</a></li>\n</ul>\n</li>\n<li><a href=\"#5-%E8%A7%86%E5%9B%BE\">5. è§†å›¾</a></li>\n<li><a href=\"#6-%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E5%92%8C%E5%87%BD%E6%95%B0\">6. å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</a>\n<ul>\n<li><a href=\"#61-%E5%88%9B%E5%BB%BA%E4%BF%AE%E6%94%B9%E5%88%A0%E9%99%A4%E6%9F%A5%E7%9C%8B%E5%AD%98%E5%82%A8%E8%BF%87%E7%A8%8B%E6%88%96%E8%80%85%E5%87%BD%E6%95%B0\">6.1. åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ã€æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°</a></li>\n<li><a href=\"#62-%E5%8F%98%E9%87%8F%E7%9A%84%E4%BD%BF%E7%94%A8\">6.2. å˜é‡çš„ä½¿ç”¨</a></li>\n<li><a href=\"#63-%E6%9D%A1%E4%BB%B6%E7%9A%84%E5%AE%9A%E4%B9%89%E5%92%8C%E5%A4%84%E7%90%86\">6.3. æ¡ä»¶çš„å®šä¹‰å’Œå¤„ç†</a></li>\n<li><a href=\"#64-%E5%85%89%E6%A0%87%E7%9A%84%E4%BD%BF%E7%94%A8\">6.4. å…‰æ ‡çš„ä½¿ç”¨</a></li>\n<li><a href=\"#65-%E6%B5%81%E7%A8%8B%E6%8E%A7%E5%88%B6\">6.5. æµç¨‹æ§åˆ¶</a></li>\n</ul>\n</li>\n<li><a href=\"#7-%E8%A7%A6%E5%8F%91%E5%99%A8\">7. è§¦å‘å™¨</a></li>\n<li><a href=\"#8-mysql%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E\">8. MySQLå­˜å‚¨å¼•æ“</a>\n<ul>\n<li><a href=\"#81-mysql%E5%AD%98%E5%82%A8%E5%BC%95%E6%93%8E%E7%89%B9%E6%80%A7\">8.1. MySQLå­˜å‚¨å¼•æ“ç‰¹æ€§</a></li>\n<li><a href=\"#82-myisam\">8.2. MyISAM</a></li>\n<li><a href=\"#83-innodb\">8.3. InnoDB</a></li>\n<li><a href=\"#84-memory\">8.4. MEMORY</a></li>\n<li><a href=\"#85-innodb%E4%B8%8Ememory%E5%8C%BA%E5%88%AB\">8.5. InnoDBä¸MEMORYåŒºåˆ«</a></li>\n</ul>\n</li>\n<li><a href=\"#9-memory%E8%A1%A8\">9. MEMORYè¡¨</a>\n<ul>\n<li><a href=\"#91-merge\">9.1. MERGE</a></li>\n</ul>\n</li>\n<li><a href=\"#10-mysql%E8%BF%9E%E6%8E%A5\">10. MySQLè¿æ¥</a>\n<ul>\n<li><a href=\"#101-%E9%95%BF%E8%BF%9E%E6%8E%A5%E4%B8%8E%E7%9F%AD%E8%BF%9E%E6%8E%A5\">10.1. é•¿è¿æ¥ä¸çŸ­è¿æ¥</a></li>\n</ul>\n</li>\n<li><a href=\"#11-mysql%E7%B4%A2%E5%BC%95\">11. MySQLç´¢å¼•</a>\n<ul>\n<li><a href=\"#111-%E7%B4%A2%E5%BC%95%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9\">11.1. ç´¢å¼•çš„ä¼˜ç¼ºç‚¹</a></li>\n<li><a href=\"#112-%E7%B4%A2%E5%BC%95%E5%88%86%E7%B1%BB\">11.2. ç´¢å¼•åˆ†ç±»</a>\n<ul>\n<li><a href=\"#1121-%E6%8C%89%E7%89%A9%E7%90%86%E5%AD%98%E5%82%A8%E5%88%86%E7%B1%BB\">11.2.1. æŒ‰ç‰©ç†å­˜å‚¨åˆ†ç±»</a>\n<ul>\n<li><a href=\"#11211-%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95\">11.2.1.1. èšç°‡ç´¢å¼•</a></li>\n<li><a href=\"#11212-%E9%9D%9E%E8%81%9A%E7%B0%87%E7%B4%A2%E5%BC%95\">11.2.1.2. éèšç°‡ç´¢å¼•</a></li>\n</ul>\n</li>\n<li><a href=\"#1122-%E6%8C%89%E5%AD%97%E6%AE%B5%E7%89%B9%E6%80%A7%E5%88%86%E7%B1%BB\">11.2.2. æŒ‰å­—æ®µç‰¹æ€§åˆ†ç±»</a>\n<ul>\n<li><a href=\"#11221-%E4%B8%BB%E9%94%AE%E7%B4%A2%E5%BC%95\">11.2.2.1. ä¸»é”®ç´¢å¼•</a></li>\n<li><a href=\"#11222-%E5%94%AF%E4%B8%80%E6%99%AE%E9%80%9A%E7%B4%A2%E5%BC%95%E5%92%8C%E5%94%AF%E4%B8%80%E7%B4%A2%E5%BC%95%E7%9A%84%E5%8C%BA%E5%88%AB\">11.2.2.2. å”¯ä¸€æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•çš„åŒºåˆ«</a></li>\n</ul>\n</li>\n<li><a href=\"#1123-%E6%8C%89%E7%B4%A2%E5%BC%95%E5%AD%97%E6%AE%B5%E4%B8%AA%E6%95%B0%E5%88%86%E7%B1%BB\">11.2.3. æŒ‰ç´¢å¼•å­—æ®µä¸ªæ•°åˆ†ç±»</a>\n<ul>\n<li><a href=\"#11231-%E5%8D%95%E5%88%97%E7%B4%A2%E5%BC%95\">11.2.3.1. å•åˆ—ç´¢å¼•</a></li>\n<li><a href=\"#11232-%E7%BB%84%E5%90%88%E7%B4%A2%E5%BC%95\">11.2.3.2. ç»„åˆç´¢å¼•</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#113-%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8\">11.3. ç´¢å¼•ä½¿ç”¨</a>\n<ul>\n<li><a href=\"#1131-%E5%89%8D%E7%BC%80%E7%B4%A2%E5%BC%95\">11.3.1. å‰ç¼€ç´¢å¼•</a></li>\n</ul>\n</li>\n<li><a href=\"#114-%E9%87%8D%E5%BB%BA%E7%B4%A2%E5%BC%95\">11.4. é‡å»ºç´¢å¼•</a></li>\n<li><a href=\"#115-%E6%9F%A5%E7%9C%8B%E7%B4%A2%E5%BC%95%E4%BD%BF%E7%94%A8%E6%83%85%E5%86%B5\">11.5. æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ</a></li>\n<li><a href=\"#116-mysql%E7%B4%A2%E5%BC%95%E5%AE%9E%E7%8E%B0\">11.6. MySQLç´¢å¼•å®ç°</a></li>\n<li><a href=\"#117-%E7%B4%A2%E5%BC%95%E7%BB%B4%E6%8A%A4\">11.7. ç´¢å¼•ç»´æŠ¤</a></li>\n<li><a href=\"#118-%E7%B4%A2%E5%BC%95%E8%AE%BE%E8%AE%A1%E5%8E%9F%E5%88%99\">11.8. ç´¢å¼•è®¾è®¡åŸåˆ™</a></li>\n<li><a href=\"#119-%E7%B4%A2%E5%BC%95%E7%9A%84%E5%B8%B8%E8%A7%81%E6%95%B0%E6%8D%AE%E6%A8%A1%E5%9E%8B%E5%AE%9E%E7%8E%B0%E7%B4%A2%E5%BC%95%E7%9A%84%E6%96%B9%E5%BC%8F\">11.9. ç´¢å¼•çš„å¸¸è§æ•°æ®æ¨¡å‹å®ç°ç´¢å¼•çš„æ–¹å¼</a></li>\n<li><a href=\"#1110-%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E4%BD%BF%E7%94%A8%E5%9C%BA%E6%99%AF\">11.10. è‡ªå¢ä¸»é”®ä½¿ç”¨åœºæ™¯</a></li>\n</ul>\n</li>\n<li><a href=\"#12-mysql%E4%BA%8B%E5%8A%A1\">12. MySQLäº‹åŠ¡</a>\n<ul>\n<li><a href=\"#121-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB\">12.1. äº‹åŠ¡éš”ç¦»çº§åˆ«</a></li>\n<li><a href=\"#122-%E6%9F%A5%E7%9C%8B%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB\">12.2. æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«</a></li>\n<li><a href=\"#123-%E4%BA%8B%E5%8A%A1%E9%9A%94%E7%A6%BB%E7%BA%A7%E5%88%AB%E7%9A%84%E5%AE%9E%E7%8E%B0\">12.3. äº‹åŠ¡éš”ç¦»çº§åˆ«çš„å®ç°</a>\n<ul>\n<li><a href=\"#1231-%E9%94%81\">12.3.1. é”</a></li>\n<li><a href=\"#1232-mvcc\">12.3.2. MVCC</a>\n<ul>\n<li><a href=\"#12321-%E5%BF%AB%E7%85%A7%E8%AF%BB\">12.3.2.1. å¿«ç…§è¯»</a></li>\n<li><a href=\"#12322-%E5%BD%93%E5%89%8D%E8%AF%BBcurrent-read\">12.3.2.2. å½“å‰è¯»ï¼ˆcurrent readï¼‰</a></li>\n<li><a href=\"#12323-mvcc%E7%9A%84%E5%AE%9E%E7%8E%B0\">12.3.2.3. MVCCçš„å®ç°</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#124-%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%B9%BB%E8%AF%BB\">12.4. å¦‚ä½•è§£å†³å¹»è¯»ï¼Ÿ</a></li>\n<li><a href=\"#125-%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86\">12.5. äº‹åŠ¡ç®¡ç†</a>\n<ul>\n<li><a href=\"#1251-myisam%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86\">12.5.1. MyISAMäº‹åŠ¡ç®¡ç†</a></li>\n<li><a href=\"#1252-innodb%E4%BA%8B%E5%8A%A1%E7%AE%A1%E7%90%86\">12.5.2. InnoDBäº‹åŠ¡ç®¡ç†</a></li>\n</ul>\n</li>\n<li><a href=\"#126-%E6%80%8E%E4%B9%88%E8%AE%BE%E8%AE%A1%E4%BA%8B%E5%8A%A1%E8%BF%9E%E6%8E%A5%E6%B1%A0%E2%88%9A\">12.6. æ€ä¹ˆè®¾è®¡äº‹åŠ¡è¿æ¥æ± ï¼Ÿâˆš</a></li>\n<li><a href=\"#127-%E4%B8%BA%E4%BB%80%E4%B9%88%E5%BB%BA%E8%AE%AE%E4%BD%A0%E5%B0%BD%E9%87%8F%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E9%95%BF%E4%BA%8B%E5%8A%A1%E5%A6%82%E4%BD%95%E9%81%BF%E5%85%8D%E9%95%BF%E4%BA%8B%E5%8A%A1%E5%AF%B9%E4%B8%9A%E5%8A%A1%E7%9A%84%E5%BD%B1%E5%93%8D\">12.7. ä¸ºä»€ä¹ˆå»ºè®®ä½ å°½é‡ä¸è¦ä½¿ç”¨é•¿äº‹åŠ¡?å¦‚ä½•é¿å…é•¿äº‹åŠ¡å¯¹ä¸šåŠ¡çš„å½±å“ï¼Ÿ</a></li>\n<li><a href=\"#128-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E4%BD%BF%E7%94%A8\">12.8. åˆ†å¸ƒå¼äº‹åŠ¡çš„ä½¿ç”¨</a>\n<ul>\n<li><a href=\"#1281-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E7%9A%84%E5%8E%9F%E7%90%86\">12.8.1. åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸç†</a></li>\n<li><a href=\"#1282-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E8%AF%AD%E6%B3%95\">12.8.2. åˆ†å¸ƒå¼äº‹åŠ¡è¯­æ³•</a></li>\n<li><a href=\"#1283-%E5%88%86%E5%B8%83%E5%BC%8F%E4%BA%8B%E5%8A%A1%E5%AD%98%E5%9C%A8%E7%9A%84%E9%97%AE%E9%A2%98\">12.8.3. åˆ†å¸ƒå¼äº‹åŠ¡å­˜åœ¨çš„é—®é¢˜</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#13-mysql%E9%94%81\">13. MYSQLé”</a>\n<ul>\n<li><a href=\"#131-%E6%8C%89%E9%94%81%E7%9A%84%E7%B2%92%E5%BA%A6%E5%88%86%E7%B1%BB\">13.1. æŒ‰é”çš„ç²’åº¦åˆ†ç±»</a>\n<ul>\n<li><a href=\"#1311-%E5%85%A8%E5%B1%80%E9%94%81\">13.1.1. å…¨å±€é”</a></li>\n<li><a href=\"#1312-%E8%A1%A8%E7%BA%A7%E9%94%81\">13.1.2. è¡¨çº§é”</a>\n<ul>\n<li><a href=\"#13121-%E5%85%83%E6%95%B0%E6%8D%AE%E9%94%81mdlmeta-data-lock\">13.1.2.1. å…ƒæ•°æ®é”MDLmeta data lock</a></li>\n<li><a href=\"#13122-myisam%E8%A1%A8%E9%94%81\">13.1.2.2. MyISAMè¡¨é”</a></li>\n<li><a href=\"#13123-innodb%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BD%BF%E7%94%A8%E8%A1%A8%E9%94%81\">13.1.2.3. InnoDBä»€ä¹ˆæ—¶å€™ä½¿ç”¨è¡¨é”</a></li>\n</ul>\n</li>\n<li><a href=\"#1313-innodb%E8%A1%8C%E9%94%81\">13.1.3. InnoDBè¡Œé”</a>\n<ul>\n<li><a href=\"#13131-innodb-%E8%A1%8C%E9%94%81%E5%AE%9E%E7%8E%B0%E6%96%B9%E5%BC%8F\">13.1.3.1. InnoDB è¡Œé”å®ç°æ–¹å¼</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#132-%E6%8C%89%E9%94%81%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%88%86%E7%B1%BB\">13.2. æŒ‰é”çš„ç±»å‹åˆ†ç±»</a>\n<ul>\n<li><a href=\"#1321-%E8%AF%BB%E5%86%99%E9%94%81%E8%A1%8C%E9%94%81%E6%A8%A1%E5%BC%8F\">13.2.1. è¯»å†™é”è¡Œé”æ¨¡å¼</a></li>\n<li><a href=\"#1322-%E6%84%8F%E5%90%91%E9%94%81%E8%A1%A8%E9%94%81%E6%A8%A1%E5%BC%8F\">13.2.2. æ„å‘é”è¡¨é”æ¨¡å¼</a></li>\n<li><a href=\"#1323-%E8%AF%BB%E5%86%99%E9%94%81%E4%B8%8E%E6%84%8F%E5%90%91%E9%94%81%E5%85%BC%E5%AE%B9%E6%80%A7\">13.2.3. è¯»å†™é”ä¸æ„å‘é”å…¼å®¹æ€§</a></li>\n</ul>\n</li>\n<li><a href=\"#133-innodb%E4%B8%AD%E8%A1%8C%E9%94%81%E5%AE%9A%E7%9A%84%E6%96%B9%E5%BC%8F\">13.3. InnoDBä¸­è¡Œé”å®šçš„æ–¹å¼</a>\n<ul>\n<li><a href=\"#1331-%E8%AE%B0%E5%BD%95%E9%94%81record-lock\">13.3.1. è®°å½•é”ï¼ˆRecord Lockï¼‰</a></li>\n<li><a href=\"#1332-%E9%97%B4%E9%9A%99%E9%94%81gap-lock\">13.3.2. é—´éš™é”ï¼ˆGap Lockï¼‰</a></li>\n<li><a href=\"#1333-%E4%B8%B4%E9%94%AE%E9%94%81next-key-%E9%94%81\">13.3.3. ä¸´é”®é”ï¼ˆNext-Key é”ï¼‰</a></li>\n<li><a href=\"#1334-%E5%8A%A0%E9%94%81%E8%A7%84%E5%88%99\">13.3.4. åŠ é”è§„åˆ™</a></li>\n</ul>\n</li>\n<li><a href=\"#134-%E6%81%A2%E5%A4%8D%E5%92%8C%E5%A4%8D%E5%88%B6%E7%9A%84%E9%9C%80%E8%A6%81%E5%AF%B9-innodb-%E9%94%81%E6%9C%BA%E5%88%B6%E7%9A%84%E5%BD%B1%E5%93%8D\">13.4. æ¢å¤å’Œå¤åˆ¶çš„éœ€è¦ï¼Œå¯¹ InnoDB é”æœºåˆ¶çš„å½±å“</a></li>\n<li><a href=\"#135-%E6%AD%BB%E9%94%81\">13.5. æ­»é”</a>\n<ul>\n<li><a href=\"#1351-%E6%AD%BB%E9%94%81%E4%BE%8B%E5%AD%90\">13.5.1. æ­»é”ä¾‹å­</a></li>\n<li><a href=\"#1352-%E6%AD%BB%E9%94%81%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0\">13.5.2. æ­»é”äº§ç”ŸåŸå› </a></li>\n<li><a href=\"#1353-%E6%AD%BB%E9%94%81%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\">13.5.3. æ­»é”è§£å†³æ–¹æ¡ˆ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#14-mysql%E6%97%A5%E5%BF%97\">14. MYSQLæ—¥å¿—</a>\n<ul>\n<li><a href=\"#141-%E6%97%A5%E5%BF%97%E5%88%86%E7%B1%BB\">14.1. æ—¥å¿—åˆ†ç±»</a>\n<ul>\n<li><a href=\"#1411-mysql%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\">14.1.1. mysqlé…ç½®æ–‡ä»¶</a></li>\n<li><a href=\"#1412-%E9%94%99%E8%AF%AF%E6%97%A5%E5%BF%97\">14.1.2. é”™è¯¯æ—¥å¿—</a></li>\n<li><a href=\"#1413-%E4%BA%8C%E8%BF%9B%E5%88%B6%E6%97%A5%E5%BF%97binlog\">14.1.3. äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBINLOGï¼‰</a>\n<ul>\n<li><a href=\"#14131-binlog%E6%97%A5%E5%BF%97%E6%A0%BC%E5%BC%8F\">14.1.3.1. binlogæ—¥å¿—æ ¼å¼</a></li>\n</ul>\n</li>\n<li><a href=\"#1414-%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97\">14.1.4. æŸ¥è¯¢æ—¥å¿—</a></li>\n<li><a href=\"#1415-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97\">14.1.5. æ…¢æŸ¥è¯¢æ—¥å¿—</a></li>\n<li><a href=\"#1416-redo-log\">14.1.6. redo log</a></li>\n<li><a href=\"#1417-undo-log%E5%9B%9E%E6%BB%9A%E6%97%A5%E5%BF%97\">14.1.7. undo logï¼ˆå›æ»šæ—¥å¿—ï¼‰</a></li>\n</ul>\n</li>\n<li><a href=\"#142-%E4%BA%8B%E5%8A%A1%E6%98%AF%E5%A6%82%E4%BD%95%E9%80%9A%E8%BF%87%E6%97%A5%E5%BF%97%E6%9D%A5%E5%AE%9E%E7%8E%B0%E7%9A%84\">14.2. äº‹åŠ¡æ˜¯å¦‚ä½•é€šè¿‡æ—¥å¿—æ¥å®ç°çš„?</a></li>\n<li><a href=\"#143-%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4\">14.3. ä¸¤é˜¶æ®µæäº¤</a>\n<ul>\n<li><a href=\"#1431-%E4%B8%BA%E4%BB%80%E4%B9%88%E6%97%A5%E5%BF%97%E5%BF%85%E9%A1%BB%E6%9C%89%E4%B8%A4%E9%98%B6%E6%AE%B5%E6%8F%90%E4%BA%A4%E5%91%A2\">14.3.1. ä¸ºä»€ä¹ˆæ—¥å¿—å¿…é¡»æœ‰â€œä¸¤é˜¶æ®µæäº¤â€å‘¢ï¼Ÿ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#15-buffer-pool\">15. buffer Pool</a>\n<ul>\n<li><a href=\"#151-%E6%95%B0%E6%8D%AE%E9%A1%B5\">15.1. æ•°æ®é¡µ</a></li>\n<li><a href=\"#152-%E7%BC%93%E5%AD%98%E9%A1%B5\">15.2. ç¼“å­˜é¡µ</a></li>\n<li><a href=\"#153-sort_buffer\">15.3. sort_buffer</a>\n<ul>\n<li><a href=\"#1531-%E5%85%A8%E5%AD%97%E6%AE%B5%E6%8E%92%E5%BA%8F\">15.3.1. å…¨å­—æ®µæ’åº</a></li>\n<li><a href=\"#1532-rowid%E6%8E%92%E5%BA%8F\">15.3.2. rowidæ’åº</a></li>\n</ul>\n</li>\n<li><a href=\"#154-join-buffer\">15.4. join buffer</a>\n<ul>\n<li><a href=\"#1541-nested-loop-join%E5%BE%AA%E7%8E%AF%E5%B5%8C%E5%A5%97%E7%AE%97%E6%B3%95\">15.4.1. Nested-Loop joinï¼ˆå¾ªç¯åµŒå¥—ï¼‰ç®—æ³•</a>\n<ul>\n<li><a href=\"#15411-index-nested-loop-joinnlj\">15.4.1.1. Index Nested-Loop JoinNLJ</a></li>\n<li><a href=\"#15412-batched-key-acessbka%E7%AE%97%E6%B3%95\">15.4.1.2. Batched Key AcessBKAç®—æ³•</a></li>\n<li><a href=\"#15413-block-nested-loop-joinbnl\">15.4.1.3. Block Nested-Loop JoinBNL</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#155-redo-log-buffer\">15.5. redo log buffer</a></li>\n</ul>\n</li>\n<li><a href=\"#16-sql%E4%BC%98%E5%8C%96\">16. SQLä¼˜åŒ–</a>\n<ul>\n<li><a href=\"#161-sql%E4%BC%98%E5%8C%96%E6%AD%A5%E9%AA%A4\">16.1. SQLä¼˜åŒ–æ­¥éª¤</a>\n<ul>\n<li><a href=\"#1611-%E6%85%A2%E6%9F%A5%E8%AF%A2%E6%97%A5%E5%BF%97%E5%88%86%E6%9E%90\">16.1.1. æ…¢æŸ¥è¯¢æ—¥å¿—åˆ†æ</a></li>\n<li><a href=\"#1542-%E6%85%A2sql%E9%A2%84%E9%98%B2\">15.4.2. æ…¢SQLé¢„é˜²</a></li>\n</ul>\n</li>\n<li><a href=\"#162-%E5%B8%B8%E7%94%A8sql%E7%9A%84%E4%BC%98%E5%8C%96\">16.2. å¸¸ç”¨SQLçš„ä¼˜åŒ–</a>\n<ul>\n<li><a href=\"#1621-%E5%AE%9A%E6%9C%9F%E5%88%86%E6%9E%90%E8%A1%A8%E6%A3%80%E6%9F%A5%E8%A1%A8%E4%BC%98%E5%8C%96%E8%A1%A8\">16.2.1. å®šæœŸåˆ†æè¡¨ã€æ£€æŸ¥è¡¨ã€ä¼˜åŒ–è¡¨</a></li>\n<li><a href=\"#1622-%E5%A4%A7%E6%89%B9%E9%87%8F%E6%8F%92%E5%85%A5%E6%95%B0%E6%8D%AE\">16.2.2. å¤§æ‰¹é‡æ’å…¥æ•°æ®</a></li>\n<li><a href=\"#1623-%E4%BC%98%E5%8C%96-insert-%E8%AF%AD%E5%8F%A5\">16.2.3. ä¼˜åŒ– INSERT è¯­å¥</a></li>\n<li><a href=\"#1624-%E4%BC%98%E5%8C%96-group-by-%E8%AF%AD%E5%8F%A5\">16.2.4. ä¼˜åŒ– GROUP BY è¯­å¥</a></li>\n<li><a href=\"#1625-%E4%BC%98%E5%8C%96-order-by-%E8%AF%AD%E5%8F%A5\">16.2.5. ä¼˜åŒ– ORDER BY è¯­å¥</a></li>\n<li><a href=\"#1626-%E4%BC%98%E5%8C%96limit%E8%AF%AD%E5%8F%A5\">16.2.6. ä¼˜åŒ–LIMITè¯­å¥</a></li>\n<li><a href=\"#1627-%E4%BC%98%E5%8C%96%E5%B5%8C%E5%A5%97%E6%9F%A5%E8%AF%A2\">16.2.7. ä¼˜åŒ–åµŒå¥—æŸ¥è¯¢</a></li>\n<li><a href=\"#1628-%E5%AF%B9%E4%BA%8E%E5%90%AB%E6%9C%89-or-%E7%9A%84%E6%9F%A5%E8%AF%A2%E5%AD%90%E5%8F%A5\">16.2.8. å¯¹äºå«æœ‰ OR çš„æŸ¥è¯¢å­å¥</a></li>\n<li><a href=\"#1629-%E4%BD%BF%E7%94%A8force-index%E6%8C%87%E5%AE%9A%E7%B4%A2%E5%BC%95\">16.2.9. ä½¿ç”¨FORCE INDEXæŒ‡å®šç´¢å¼•</a></li>\n<li><a href=\"#16210-%E5%88%A0%E9%99%A4%E5%A4%A7%E9%87%8F%E6%95%B0%E6%8D%AE\">16.2.10. åˆ é™¤å¤§é‡æ•°æ®</a></li>\n<li><a href=\"#16211-%E4%BC%98%E5%8C%96count%E6%9F%A5%E8%AF%A2\">16.2.11. ä¼˜åŒ–countæŸ¥è¯¢</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#17-%E4%BC%98%E5%8C%96%E6%95%B0%E6%8D%AE%E5%BA%93%E5%AF%B9%E8%B1%A1\">17. ä¼˜åŒ–æ•°æ®åº“å¯¹è±¡</a>\n<ul>\n<li><a href=\"#171-%E4%BC%98%E5%8C%96%E8%A1%A8%E7%9A%84%E6%95%B0%E6%8D%AE%E7%B1%BB%E5%9E%8B\">17.1. ä¼˜åŒ–è¡¨çš„æ•°æ®ç±»å‹</a></li>\n<li><a href=\"#172-%E9%80%9A%E8%BF%87%E6%8B%86%E5%88%86%E6%8F%90%E9%AB%98%E8%A1%A8%E7%9A%84%E8%AE%BF%E9%97%AE%E6%95%88%E7%8E%87\">17.2. é€šè¿‡æ‹†åˆ†æé«˜è¡¨çš„è®¿é—®æ•ˆç‡</a>\n<ul>\n<li><a href=\"#1721-%E9%80%86%E8%A7%84%E8%8C%83%E5%8C%96\">17.2.1. é€†è§„èŒƒåŒ–</a></li>\n<li><a href=\"#1722-%E4%BD%BF%E7%94%A8%E4%B8%AD%E9%97%B4%E8%A1%A8%E6%8F%90%E9%AB%98%E5%A4%A7%E6%95%B0%E6%8D%AE%E8%A1%A8%E7%BB%9F%E8%AE%A1%E6%9F%A5%E8%AF%A2%E9%80%9F%E5%BA%A6\">17.2.2. ä½¿ç”¨ä¸­é—´è¡¨æé«˜å¤§æ•°æ®è¡¨ç»Ÿè®¡æŸ¥è¯¢é€Ÿåº¦</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#18-%E4%BC%98%E5%8C%96-mysql-server\">18. ä¼˜åŒ– MySQL Server</a>\n<ul>\n<li><a href=\"#181-linux%E7%B3%BB%E7%BB%9F%E4%BC%98%E5%8C%96\">18.1. Linuxç³»ç»Ÿä¼˜åŒ–</a></li>\n<li><a href=\"#182-%E6%9F%A5%E7%9C%8B-%E5%BD%B1%E5%93%8Dmysql-server-%E6%80%A7%E8%83%BD%E7%9A%84%E9%87%8D%E8%A6%81%E5%8F%82%E6%95%B0\">18.2. æŸ¥çœ‹ å½±å“MySQL Server æ€§èƒ½çš„é‡è¦å‚æ•°</a>\n<ul>\n<li><a href=\"#1821-myisam-key_buffer_size\">18.2.1. MyISAM-key_buffer_size</a></li>\n<li><a href=\"#1822-myisam-table_cache\">18.2.2. MYISAM-table_cache</a></li>\n<li><a href=\"#1823-innodb_buffer_pool_size\">18.2.3. innodb_buffer_pool_size</a></li>\n<li><a href=\"#1824-innodb_flush_log_at_trx_commit%E8%AE%BE%E7%BD%AE\">18.2.4. innodb_flush_log_at_trx_commitè®¾ç½®</a></li>\n<li><a href=\"#1825-innodb_additional_mem_pool_size%E8%AE%BE%E7%BD%AE\">18.2.5. innodb_additional_mem_pool_sizeè®¾ç½®</a></li>\n<li><a href=\"#1826-innodb_lock_wait_timeout\">18.2.6. innodb_lock_wait_timeout</a></li>\n<li><a href=\"#1827-innodb_support_xa\">18.2.7. innodb_support_xa</a></li>\n<li><a href=\"#1828-innodb_log_buffer_size\">18.2.8. innodb_log_buffer_size</a></li>\n<li><a href=\"#1829-innodb_log_file_size\">18.2.9. innodb_log_file_size</a></li>\n<li><a href=\"#18210-%E5%85%B6%E4%BB%96%E5%8F%82%E6%95%B0\">18.2.10. å…¶ä»–å‚æ•°</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#19-%E7%A3%81%E7%9B%98-io-%E4%BC%98%E5%8C%96\">19. ç£ç›˜ I/O ä¼˜åŒ–</a>\n<ul>\n<li><a href=\"#191-%E4%BD%BF%E7%94%A8%E7%A3%81%E7%9B%98%E9%98%B5%E5%88%97\">19.1. ä½¿ç”¨ç£ç›˜é˜µåˆ—</a>\n<ul>\n<li><a href=\"#1911-%E5%B8%B8%E8%A7%81-raid-%E7%BA%A7%E5%88%AB%E5%8F%8A%E5%85%B6%E7%89%B9%E6%80%A7\">19.1.1. å¸¸è§ RAID çº§åˆ«åŠå…¶ç‰¹æ€§</a></li>\n<li><a href=\"#1912-%E5%A6%82%E4%BD%95%E9%80%89%E6%8B%A9-raid-%E7%BA%A7%E5%88%AB\">19.1.2. å¦‚ä½•é€‰æ‹© RAID çº§åˆ«</a></li>\n<li><a href=\"#1913-%E8%99%9A%E6%8B%9F%E6%96%87%E4%BB%B6%E5%8D%B7%E6%88%96%E8%BD%AFraid\">19.1.3. è™šæ‹Ÿæ–‡ä»¶å·æˆ–è½¯RAID</a></li>\n</ul>\n</li>\n<li><a href=\"#192-%E4%BD%BF%E7%94%A8-symbolic-links-%E5%88%86%E5%B8%83-io\">19.2. ä½¿ç”¨ Symbolic Links åˆ†å¸ƒ I/O</a></li>\n<li><a href=\"#193-%E7%A6%81%E6%AD%A2%E6%93%8D%E4%BD%9C%E7%B3%BB%E7%BB%9F%E6%9B%B4%E6%96%B0%E6%96%87%E4%BB%B6%E7%9A%84-atime-%E5%B1%9E%E6%80%A7\">19.3. ç¦æ­¢æ“ä½œç³»ç»Ÿæ›´æ–°æ–‡ä»¶çš„ atime å±æ€§</a></li>\n<li><a href=\"#194-%E7%94%A8%E8%A3%B8%E8%AE%BE%E5%A4%87raw-device%E5%AD%98%E6%94%BE-innodb-%E7%9A%84%E5%85%B1%E4%BA%AB%E8%A1%A8%E7%A9%BA%E9%97%B4\">19.4. ç”¨è£¸è®¾å¤‡ï¼ˆRaw Deviceï¼‰å­˜æ”¾ InnoDB çš„å…±äº«è¡¨ç©ºé—´</a></li>\n</ul>\n</li>\n<li><a href=\"#20-%E5%BA%94%E7%94%A8%E4%BC%98%E5%8C%96\">20. åº”ç”¨ä¼˜åŒ–</a>\n<ul>\n<li><a href=\"#201-%E4%BD%BF%E7%94%A8%E8%BF%9E%E6%8E%A5%E6%B1%A0\">20.1. ä½¿ç”¨è¿æ¥æ± </a></li>\n<li><a href=\"#202-%E5%87%8F%E5%B0%91%E5%AF%B9-mysql-%E7%9A%84%E8%AE%BF%E9%97%AE\">20.2. å‡å°‘å¯¹ MySQL çš„è®¿é—®</a></li>\n<li><a href=\"#203-%E4%BD%BF%E7%94%A8%E7%BC%93%E5%AD%98\">20.3. ä½¿ç”¨ç¼“å­˜</a></li>\n<li><a href=\"#204-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1\">20.4. è´Ÿè½½å‡è¡¡</a>\n<ul>\n<li><a href=\"#2041-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB\">20.4.1. ä¸»ä»å¤åˆ¶-è¯»å†™åˆ†ç¦»</a></li>\n<li><a href=\"#2042-%E9%87%87%E7%94%A8%E5%88%86%E5%B8%83%E5%BC%8F%E6%95%B0%E6%8D%AE%E5%BA%93%E6%9E%B6%E6%9E%84mysql-cluster\">20.4.2. é‡‡ç”¨åˆ†å¸ƒå¼æ•°æ®åº“æ¶æ„MySQL CLUSTER</a></li>\n</ul>\n</li>\n<li><a href=\"#205-%E5%85%B6%E4%BB%96%E4%BC%98%E5%8C%96%E6%8E%AA%E6%96%BD\">20.5. å…¶ä»–ä¼˜åŒ–æªæ–½</a></li>\n</ul>\n</li>\n<li><a href=\"#21-%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D\">21. å¤‡ä»½ä¸æ¢å¤</a>\n<ul>\n<li><a href=\"#211-%E5%A4%87%E4%BB%BD%E5%88%86%E7%B1%BB%E5%A4%87%E4%BB%BD%E6%95%B0%E6%8D%AE%E7%9A%84%E7%B1%BB%E5%9E%8B%E5%92%8C%E5%B7%A5%E5%85%B7\">21.1. å¤‡ä»½åˆ†ç±»ï¼Œå¤‡ä»½æ•°æ®çš„ç±»å‹å’Œå·¥å…·</a></li>\n<li><a href=\"#212-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E7%AD%96%E7%95%A5\">21.2. å¤‡ä»½/æ¢å¤ç­–ç•¥</a></li>\n<li><a href=\"#213-%E9%80%BB%E8%BE%91%E5%A4%87%E4%BB%BD%E4%B8%8E%E6%81%A2%E5%A4%8D\">21.3. é€»è¾‘å¤‡ä»½ä¸æ¢å¤</a></li>\n<li><a href=\"#214-%E7%89%A9%E7%90%86%E5%A4%87%E4%BB%BD%E5%92%8C%E6%81%A2%E5%A4%8D\">21.4. ç‰©ç†å¤‡ä»½å’Œæ¢å¤</a>\n<ul>\n<li><a href=\"#2141-%E5%86%B7%E5%A4%87%E4%BB%BD\">21.4.1. å†·å¤‡ä»½</a></li>\n<li><a href=\"#2142-%E7%83%AD%E5%A4%87%E4%BB%BD\">21.4.2. çƒ­å¤‡ä»½</a></li>\n</ul>\n</li>\n<li><a href=\"#215-%E5%8F%8C%E6%9C%BA%E7%83%AD%E5%A4%87%E4%BB%BD\">21.5. åŒæœºçƒ­å¤‡ä»½</a></li>\n<li><a href=\"#216-%E6%95%B0%E6%8D%AE%E5%BA%93%E4%B8%8D%E8%83%BD%E5%81%9C%E6%9C%BA%E8%AF%B7%E9%97%AE%E5%A6%82%E4%BD%95%E5%A4%87%E4%BB%BD-%E5%A6%82%E4%BD%95%E8%BF%9B%E8%A1%8C%E5%85%A8%E5%A4%87%E4%BB%BD%E5%92%8C%E5%A2%9E%E9%87%8F%E5%A4%87%E4%BB%BD\">21.6. æ•°æ®åº“ä¸èƒ½åœæœºï¼Œè¯·é—®å¦‚ä½•å¤‡ä»½? å¦‚ä½•è¿›è¡Œå…¨å¤‡ä»½å’Œå¢é‡å¤‡ä»½?</a></li>\n<li><a href=\"#217-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E6%97%B6%E9%97%B4%E6%98%AF%E5%A4%9A%E9%95%BF\">21.7. å¤‡ä»½æ¢å¤æ—¶é—´æ˜¯å¤šé•¿ï¼Ÿ</a></li>\n<li><a href=\"#218-%E5%A4%87%E4%BB%BD%E6%81%A2%E5%A4%8D%E5%A4%B1%E8%B4%A5%E5%A6%82%E4%BD%95%E5%A4%84%E7%90%86\">21.8. å¤‡ä»½æ¢å¤å¤±è´¥å¦‚ä½•å¤„ç†ï¼Ÿ</a></li>\n<li><a href=\"#219-mysqldump-%E5%92%8C-xtrabackup-%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86\">21.9. mysqldump å’Œ xtrabackup å®ç°åŸç†ï¼Ÿ</a></li>\n<li><a href=\"#2110-%E8%A1%A8%E7%9A%84%E5%AF%BC%E5%85%A5%E5%AF%BC%E5%87%BA\">21.10. è¡¨çš„å¯¼å…¥å¯¼å‡º</a></li>\n<li><a href=\"#2111-%E8%A1%A8%E7%9A%84%E5%A4%8D%E5%88%B6\">21.11. è¡¨çš„å¤åˆ¶</a></li>\n<li><a href=\"#2112-%E8%AF%AF%E5%88%A0%E6%95%B0%E6%8D%AE\">21.12. è¯¯åˆ æ•°æ®</a>\n<ul>\n<li><a href=\"#21121-delete%E8%AF%AF%E5%88%A0%E6%95%B0%E6%8D%AE%E8%A1%8C\">21.12.1. deleteè¯¯åˆ æ•°æ®è¡Œ</a>\n<ul>\n<li><a href=\"#211211-%E6%81%A2%E5%A4%8D%E6%96%B9%E6%B3%95\">21.12.1.1. æ¢å¤æ–¹æ³•</a></li>\n<li><a href=\"#211212-%E9%A2%84%E9%98%B2%E5%88%A0%E8%AE%B0%E5%BD%95%E6%96%B9%E6%B3%95\">21.12.1.2. é¢„é˜²åˆ è®°å½•æ–¹æ³•</a></li>\n<li><a href=\"#211213-%E5%88%A0%E9%99%A4%E8%A1%A8%E6%89%80%E6%9C%89%E6%95%B0%E6%8D%AE%E7%9A%84%E6%96%B9%E6%B3%95\">21.12.1.3. åˆ é™¤è¡¨æ‰€æœ‰æ•°æ®çš„æ–¹æ³•</a></li>\n</ul>\n</li>\n<li><a href=\"#21122-drop-table%E6%88%96%E8%80%85truncate-table%E8%AF%AF%E5%88%A0%E6%95%B0%E6%8D%AE%E8%A1%A8drop-database%E8%AF%AF%E5%88%A0%E5%BA%93\">21.12.2. drop tableæˆ–è€…truncate tableè¯¯åˆ æ•°æ®è¡¨/drop databaseè¯¯åˆ åº“</a>\n<ul>\n<li><a href=\"#211221-%E6%81%A2%E5%A4%8D%E6%96%B9%E6%B3%95\">21.12.2.1. æ¢å¤æ–¹æ³•</a></li>\n<li><a href=\"#211222-%E9%A2%84%E9%98%B2%E8%AF%AF%E5%88%A0%E5%BA%93%E8%A1%A8%E7%9A%84%E6%96%B9%E6%B3%95\">21.12.2.2. é¢„é˜²è¯¯åˆ åº“/è¡¨çš„æ–¹æ³•</a></li>\n</ul>\n</li>\n<li><a href=\"#21123-rm%E5%91%BD%E4%BB%A4%E8%AF%AF%E5%88%A0%E6%95%B4%E4%B8%AAmysql%E5%AE%9E%E4%BE%8B\">21.12.3. rmå‘½ä»¤è¯¯åˆ æ•´ä¸ªMySQLå®ä¾‹</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#22-mysql%E6%9D%83%E9%99%90%E7%AE%A1%E7%90%86\">22. MySQLæƒé™ç®¡ç†</a>\n<ul>\n<li><a href=\"#221-%E6%9D%83%E9%99%90%E7%B3%BB%E7%BB%9F%E7%9A%84%E5%B7%A5%E4%BD%9C%E5%8E%9F%E7%90%86\">22.1. æƒé™ç³»ç»Ÿçš„å·¥ä½œåŸç†</a></li>\n<li><a href=\"#222-%E8%B4%A6%E5%8F%B7%E7%AE%A1%E7%90%86\">22.2. è´¦å·ç®¡ç†</a></li>\n</ul>\n</li>\n<li><a href=\"#23-mysql-%E5%AE%89%E5%85%A8\">23. MySQL å®‰å…¨</a></li>\n<li><a href=\"#24-mysql%E5%A4%8D%E5%88%B6\">24. MySQLå¤åˆ¶</a>\n<ul>\n<li><a href=\"#241-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E6%B5%81%E7%A8%8B\">24.1. ä¸»ä»å¤åˆ¶æµç¨‹</a></li>\n<li><a href=\"#242-%E5%A4%8D%E5%88%B6%E9%85%8D%E7%BD%AE\">24.2. å¤åˆ¶é…ç½®</a></li>\n<li><a href=\"#243-%E5%A4%87%E5%BA%93%E5%B9%B6%E8%A1%8C%E5%A4%8D%E5%88%B6%E8%83%BD%E5%8A%9B\">24.3. å¤‡åº“å¹¶è¡Œå¤åˆ¶èƒ½åŠ›</a></li>\n<li><a href=\"#244-%E5%B9%B6%E8%A1%8C%E5%A4%8D%E5%88%B6%E7%AD%96%E7%95%A5\">24.4. å¹¶è¡Œå¤åˆ¶ç­–ç•¥</a>\n<ul>\n<li><a href=\"#2441-mysql-56%E6%8C%89%E5%BA%93%E5%B9%B6%E8%A1%8C%E5%A4%8D%E5%88%B6\">24.4.1. MySQL 5.6æŒ‰åº“å¹¶è¡Œå¤åˆ¶</a></li>\n<li><a href=\"#2442-mysql-57%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%A4%8D%E5%88%B6%E7%AD%96%E7%95%A5\">24.4.2. MySQL 5.7çš„å¹¶è¡Œå¤åˆ¶ç­–ç•¥</a></li>\n<li><a href=\"#2443-mysql-5722%E7%9A%84%E5%B9%B6%E8%A1%8C%E5%A4%8D%E5%88%B6%E7%AD%96%E7%95%A5\">24.4.3. MySQL 5.7.22çš„å¹¶è¡Œå¤åˆ¶ç­–ç•¥</a></li>\n</ul>\n</li>\n<li><a href=\"#245-%E4%B8%BB%E4%BB%8E%E5%A4%8D%E5%88%B6%E9%97%AE%E9%A2%98\">24.5. ä¸»ä»å¤åˆ¶é—®é¢˜</a>\n<ul>\n<li><a href=\"#2451-%E5%BE%AA%E7%8E%AF%E5%A4%8D%E5%88%B6%E9%97%AE%E9%A2%98\">24.5.1. å¾ªç¯å¤åˆ¶é—®é¢˜</a></li>\n<li><a href=\"#2452-%E4%B8%BB%E5%A4%87%E5%BB%B6%E8%BF%9F\">24.5.2. ä¸»å¤‡å»¶è¿Ÿ</a></li>\n<li><a href=\"#2453-%E4%B8%BB%E5%A4%87%E5%BB%B6%E8%BF%9F%E7%9A%84%E6%9D%A5%E6%BA%90\">24.5.3. ä¸»å¤‡å»¶è¿Ÿçš„æ¥æº</a></li>\n<li><a href=\"#2454-%E4%B8%BB%E5%A4%87%E5%BB%B6%E8%BF%9F%E5%9C%BA%E6%99%AF\">24.5.4. ä¸»å¤‡å»¶è¿Ÿåœºæ™¯</a></li>\n<li><a href=\"#2455-%E4%B8%BB%E4%BB%8E%E4%B8%8D%E4%B8%80%E8%87%B4\">24.5.5. ä¸»ä»ä¸ä¸€è‡´</a></li>\n</ul>\n</li>\n<li><a href=\"#246-%E6%97%A5%E5%B8%B8%E7%AE%A1%E7%90%86%E7%BB%B4%E6%8A%A4\">24.6. æ—¥å¸¸ç®¡ç†ç»´æŠ¤</a>\n<ul>\n<li><a href=\"#2461-%E6%9F%A5%E7%9C%8B%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%8A%B6%E6%80%81\">24.6.1. æŸ¥çœ‹ä»æœåŠ¡å™¨çŠ¶æ€</a></li>\n<li><a href=\"#2462-%E4%B8%BB%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%90%8C%E6%AD%A5\">24.6.2. ä¸»ä»æœåŠ¡å™¨åŒæ­¥</a></li>\n<li><a href=\"#2463-%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%A4%8D%E5%88%B6%E5%87%BA%E9%94%99%E7%9A%84%E5%A4%84%E7%90%86\">24.6.3. ä»æœåŠ¡å™¨å¤åˆ¶å‡ºé”™çš„å¤„ç†</a></li>\n<li><a href=\"#2464-log-event-entry-exceeded-max_allowed_packet-%E7%9A%84%E5%A4%84%E7%90%86\">24.6.4. log event entry exceeded max_allowed_packet çš„å¤„ç†</a></li>\n<li><a href=\"#2465-%E5%A4%9A%E4%B8%BB%E5%A4%8D%E5%88%B6%E5%A4%9A%E5%8F%B0%E4%B8%BB%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%AF%B9%E4%B8%80%E5%8F%B0%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%97%B6%E7%9A%84%E8%87%AA%E5%A2%9E%E9%95%BF%E5%8F%98%E9%87%8F%E5%86%B2%E7%AA%81%E9%97%AE%E9%A2%98\">24.6.5. å¤šä¸»å¤åˆ¶å¤šå°ä¸»æœåŠ¡å™¨å¯¹ä¸€å°ä»æœåŠ¡å™¨æ—¶çš„è‡ªå¢é•¿å˜é‡å†²çªé—®é¢˜</a></li>\n<li><a href=\"#2466-%E6%9F%A5%E7%9C%8B%E4%BB%8E%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%9A%84%E5%A4%8D%E5%88%B6%E8%BF%9B%E5%BA%A6\">24.6.6. æŸ¥çœ‹ä»æœåŠ¡å™¨çš„å¤åˆ¶è¿›åº¦</a></li>\n<li><a href=\"#2467-%E5%88%87%E6%8D%A2%E4%B8%BB%E5%A4%87%E6%9C%8D%E5%8A%A1%E5%99%A8\">24.6.7. åˆ‡æ¢ä¸»å¤‡æœåŠ¡å™¨</a>\n<ul>\n<li><a href=\"#24671-%E4%B8%BB%E5%A4%87%E5%88%87%E6%8D%A2%E7%AD%96%E7%95%A5\">24.6.7.1. ä¸»å¤‡åˆ‡æ¢ç­–ç•¥</a></li>\n<li><a href=\"#24672-%E5%9F%BA%E4%BA%8E%E4%BD%8D%E7%82%B9%E7%9A%84%E4%B8%BB%E5%A4%87%E5%88%87%E6%8D%A2\">24.6.7.2. åŸºäºä½ç‚¹çš„ä¸»å¤‡åˆ‡æ¢</a></li>\n<li><a href=\"#24673-%E4%B8%BB%E5%A4%87%E5%88%87%E6%8D%A2%E6%96%B9%E6%A1%88gtidglobal-transaction-identifier\">24.6.7.3. ä¸»å¤‡åˆ‡æ¢æ–¹æ¡ˆGTIDGlobal Transaction Identifier</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#247-%E5%A6%82%E4%BD%95%E5%88%A4%E6%96%AD%E4%B8%80%E4%B8%AA%E4%B8%BB%E6%95%B0%E6%8D%AE%E5%BA%93%E6%98%AF%E4%B8%8D%E6%98%AF%E5%87%BA%E9%97%AE%E9%A2%98%E4%BA%86\">24.7. å¦‚ä½•åˆ¤æ–­ä¸€ä¸ªä¸»æ•°æ®åº“æ˜¯ä¸æ˜¯å‡ºé—®é¢˜äº†ï¼Ÿ</a>\n<ul>\n<li><a href=\"#2471-%E5%A4%96%E9%83%A8%E5%88%A4%E6%96%AD\">24.7.1. å¤–éƒ¨åˆ¤æ–­</a></li>\n<li><a href=\"#2472-%E5%86%85%E9%83%A8%E5%88%A4%E6%96%AD\">24.7.2. å†…éƒ¨åˆ¤æ–­</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#25-mysql-cluster\">25. MySQL Cluster</a>\n<ul>\n<li><a href=\"#251-mysql-cluster%E6%9E%B6%E6%9E%84\">25.1. MySQL Clusteræ¶æ„</a></li>\n</ul>\n</li>\n<li><a href=\"#26-%E5%AD%97%E7%AC%A6%E9%9B%86\">26. å­—ç¬¦é›†</a>\n<ul>\n<li><a href=\"#261-%E6%80%8E%E6%A0%B7%E9%80%89%E6%8B%A9%E5%90%88%E9%80%82%E7%9A%84%E5%AD%97%E7%AC%A6%E9%9B%86\">26.1. æ€æ ·é€‰æ‹©åˆé€‚çš„å­—ç¬¦é›†</a></li>\n<li><a href=\"#262-mysql-%E5%AD%97%E7%AC%A6%E9%9B%86\">26.2. MySQL å­—ç¬¦é›†</a></li>\n<li><a href=\"#263-mysql-%E5%AD%97%E7%AC%A6%E9%9B%86%E7%9A%84%E8%AE%BE%E7%BD%AE\">26.3. MySQL å­—ç¬¦é›†çš„è®¾ç½®</a></li>\n</ul>\n</li>\n<li><a href=\"#27-sql-mode\">27. SQL Mode</a>\n<ul>\n<li><a href=\"#271-sql-mode%E7%AE%80%E4%BB%8B\">27.1. SQL Modeç®€ä»‹</a></li>\n<li><a href=\"#272-%E5%B8%B8%E7%94%A8%E7%9A%84-sql-mode\">27.2. å¸¸ç”¨çš„ SQL Mode</a></li>\n<li><a href=\"#273-sql-mode-%E5%9C%A8%E8%BF%81%E7%A7%BB%E4%B8%AD%E5%A6%82%E4%BD%95%E4%BD%BF%E7%94%A8\">27.3. SQL Mode åœ¨è¿ç§»ä¸­å¦‚ä½•ä½¿ç”¨</a></li>\n</ul>\n</li>\n<li><a href=\"#28-%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F\">28. å…¨è¡¨æ‰«æ</a>\n<ul>\n<li><a href=\"#281-%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F%E5%AF%B9server%E5%B1%82%E7%9A%84%E5%BD%B1%E5%93%8D\">28.1. å…¨è¡¨æ‰«æå¯¹serverå±‚çš„å½±å“</a></li>\n<li><a href=\"#282-%E5%85%A8%E8%A1%A8%E6%89%AB%E6%8F%8F%E5%AF%B9innodb%E7%9A%84%E5%BD%B1%E5%93%8D\">28.2. å…¨è¡¨æ‰«æå¯¹InnoDBçš„å½±å“</a></li>\n<li><a href=\"#283-%E6%89%AB%E6%8F%8F%E8%A1%8C%E6%95%B0\">28.3. æ‰«æè¡Œæ•°</a></li>\n<li><a href=\"#284-%E5%A6%82%E4%BD%95%E6%AD%A3%E7%A1%AE%E5%9C%B0%E6%98%BE%E7%A4%BA%E9%9A%8F%E6%9C%BA%E6%B6%88%E6%81%AF\">28.4. å¦‚ä½•æ­£ç¡®åœ°æ˜¾ç¤ºéšæœºæ¶ˆæ¯ï¼Ÿ</a></li>\n<li><a href=\"#285-%E6%95%91%E7%81%AB%E6%96%B9%E6%B3%95\">28.5. æ•‘ç«æ–¹æ³•</a>\n<ul>\n<li><a href=\"#2851-%E7%9F%AD%E8%BF%9E%E6%8E%A5%E9%A3%8E%E6%9A%B4\">28.5.1. çŸ­è¿æ¥é£æš´</a></li>\n<li><a href=\"#2852-qps%E7%AA%81%E5%A2%9E%E9%97%AE%E9%A2%98\">28.5.2. QPSçªå¢é—®é¢˜</a></li>\n<li><a href=\"#2853-%E6%9F%A5%E8%AF%A2%E6%85%A2\">28.5.3. æŸ¥è¯¢æ…¢</a></li>\n<li><a href=\"#2854-%E5%A6%82%E4%BD%95%E5%AE%89%E5%85%A8%E5%9C%B0%E7%BB%99%E5%B0%8F%E8%A1%A8%E5%8A%A0%E5%AD%97%E6%AE%B5\">28.5.4. å¦‚ä½•å®‰å…¨åœ°ç»™å°è¡¨åŠ å­—æ®µï¼Ÿ</a></li>\n<li><a href=\"#2855-%E5%9C%A8-mysql-%E6%9C%8D%E5%8A%A1%E5%99%A8%E8%BF%90%E8%A1%8C%E7%BC%93%E6%85%A2%E7%9A%84%E6%83%85%E5%86%B5%E4%B8%8B%E8%BE%93%E5%85%A5%E4%BB%80%E4%B9%88%E5%91%BD%E4%BB%A4%E8%83%BD%E7%BC%93%E8%A7%A3%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8E%8B%E5%8A%9B\">28.5.5. åœ¨ MySQL æœåŠ¡å™¨è¿è¡Œç¼“æ…¢çš„æƒ…å†µä¸‹è¾“å…¥ä»€ä¹ˆå‘½ä»¤èƒ½ç¼“è§£æœåŠ¡å™¨å‹åŠ›ï¼Ÿ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#29-%E6%95%B0%E6%8D%AE%E5%BA%93flush\">29. æ•°æ®åº“flush</a>\n<ul>\n<li><a href=\"#291-flush%E7%9A%84%E8%A7%A6%E5%8F%91%E6%9D%A1%E4%BB%B6\">29.1. flushçš„è§¦å‘æ¡ä»¶</a></li>\n<li><a href=\"#292-innodb%E5%88%B7%E8%84%8F%E9%A1%B5%E7%9A%84%E6%8E%A7%E5%88%B6%E7%AD%96%E7%95%A5\">29.2. InnoDBåˆ·è„é¡µçš„æ§åˆ¶ç­–ç•¥</a></li>\n</ul>\n</li>\n<li><a href=\"#30-%E6%95%B0%E6%8D%AE%E5%88%A0%E9%99%A4%E6%B5%81%E7%A8%8B\">30. æ•°æ®åˆ é™¤æµç¨‹</a>\n<ul>\n<li><a href=\"#301-%E9%87%8D%E5%BB%BA%E8%A1%A8-%E8%A7%A3%E5%86%B3%E7%A9%BA%E6%B4%9E%E9%97%AE%E9%A2%98\">30.1. é‡å»ºè¡¨-è§£å†³ç©ºæ´é—®é¢˜</a></li>\n</ul>\n</li>\n<li><a href=\"#31-%E7%BB%84%E6%8F%90%E4%BA%A4group-commit%E6%9C%BA%E5%88%B6\">31. ç»„æäº¤ï¼ˆgroup commitï¼‰æœºåˆ¶</a></li>\n<li><a href=\"#32-%E4%B8%BA%E4%BB%80%E4%B9%88%E8%BF%98%E6%9C%89kill%E4%B8%8D%E6%8E%89%E7%9A%84%E8%AF%AD%E5%8F%A5\">32. ä¸ºä»€ä¹ˆè¿˜æœ‰killä¸æ‰çš„è¯­å¥ï¼Ÿ</a>\n<ul>\n<li><a href=\"#321-kill%E5%91%BD%E4%BB%A4%E6%89%A7%E8%A1%8C%E8%BF%87%E7%A8%8B\">32.1. killå‘½ä»¤æ‰§è¡Œè¿‡ç¨‹</a></li>\n</ul>\n</li>\n<li><a href=\"#33-%E4%B8%B4%E6%97%B6%E8%A1%A8\">33. ä¸´æ—¶è¡¨</a>\n<ul>\n<li><a href=\"#331-%E5%86%85%E5%AD%98%E8%A1%A8%E4%B8%8E%E4%B8%B4%E6%97%B6%E8%A1%A8%E5%8C%BA%E5%88%AB\">33.1. å†…å­˜è¡¨ä¸ä¸´æ—¶è¡¨åŒºåˆ«</a></li>\n<li><a href=\"#332-%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%89%B9%E6%80%A7\">33.2. ä¸´æ—¶è¡¨ç‰¹æ€§</a></li>\n<li><a href=\"#333-%E4%B8%B4%E6%97%B6%E8%A1%A8%E7%9A%84%E5%BA%94%E7%94%A8\">33.3. ä¸´æ—¶è¡¨çš„åº”ç”¨</a></li>\n<li><a href=\"#334-%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%B4%E6%97%B6%E8%A1%A8%E5%8F%AF%E4%BB%A5%E9%87%8D%E5%90%8D\">33.4. ä¸ºä»€ä¹ˆä¸´æ—¶è¡¨å¯ä»¥é‡åï¼Ÿ</a></li>\n<li><a href=\"#335-%E4%BB%80%E4%B9%88%E6%97%B6%E5%80%99%E4%BC%9A%E4%BD%BF%E7%94%A8%E5%86%85%E9%83%A8%E4%B8%B4%E6%97%B6%E8%A1%A8\">33.5. ä»€ä¹ˆæ—¶å€™ä¼šä½¿ç”¨å†…éƒ¨ä¸´æ—¶è¡¨ï¼Ÿ</a></li>\n</ul>\n</li>\n<li><a href=\"#34-%E8%87%AA%E5%A2%9E%E4%B8%BB%E9%94%AE%E4%B8%BA%E4%BB%80%E4%B9%88%E4%B8%8D%E6%98%AF%E8%BF%9E%E7%BB%AD%E7%9A%84\">34. è‡ªå¢ä¸»é”®ä¸ºä»€ä¹ˆä¸æ˜¯è¿ç»­çš„ï¼Ÿ</a>\n<ul>\n<li><a href=\"#341-%E8%87%AA%E5%A2%9E%E5%80%BC%E4%BF%9D%E5%AD%98%E4%BD%8D%E7%BD%AE\">34.1. è‡ªå¢å€¼ä¿å­˜ä½ç½®</a></li>\n<li><a href=\"#342-%E8%87%AA%E5%A2%9E%E5%80%BC%E4%BF%AE%E6%94%B9%E6%9C%BA%E5%88%B6\">34.2. è‡ªå¢å€¼ä¿®æ”¹æœºåˆ¶</a></li>\n</ul>\n</li>\n<li><a href=\"#35-%E8%A6%81%E4%B8%8D%E8%A6%81%E4%BD%BF%E7%94%A8%E5%88%86%E5%8C%BA%E8%A1%A8\">35. è¦ä¸è¦ä½¿ç”¨åˆ†åŒºè¡¨ï¼Ÿ</a>\n<ul>\n<li><a href=\"#351-%E5%88%86%E5%8C%BA%E8%A1%A8%E7%89%B9%E6%80%A7\">35.1. åˆ†åŒºè¡¨ç‰¹æ€§</a></li>\n<li><a href=\"#352-%E4%BB%80%E4%B9%88%E5%9C%BA%E6%99%AF%E4%B8%8B%E9%80%82%E5%90%88%E4%BD%BF%E7%94%A8%E5%88%86%E5%8C%BA%E8%A1%A8%E5%91%A2\">35.2. ä»€ä¹ˆåœºæ™¯ä¸‹é€‚åˆä½¿ç”¨åˆ†åŒºè¡¨å‘¢ï¼Ÿ</a></li>\n<li><a href=\"#353-%E5%88%86%E5%8C%BA%E8%A1%A8%E4%B8%BB%E9%94%AE%E6%80%8E%E4%B9%88%E8%AE%BE%E8%AE%A1\">35.3. åˆ†åŒºè¡¨ä¸»é”®æ€ä¹ˆè®¾è®¡ï¼Ÿ</a></li>\n</ul>\n</li>\n<li><a href=\"#36-mysql%E6%95%B0%E6%8D%AE%E5%BA%93%E8%AE%BE%E8%AE%A1%E8%A7%84%E8%8C%83\">36. MYSQLæ•°æ®åº“è®¾è®¡è§„èŒƒ</a></li>\n<li><a href=\"#37-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB\">37. è¯»å†™åˆ†ç¦»</a>\n<ul>\n<li><a href=\"#371-%E8%AF%BB%E5%86%99%E5%88%86%E7%A6%BB%E5%9F%BA%E6%9C%AC%E6%9E%B6%E6%9E%84\">37.1. è¯»å†™åˆ†ç¦»åŸºæœ¬æ¶æ„</a></li>\n<li><a href=\"#372-%E8%BF%87%E6%9C%9F%E8%AF%BB%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\">37.2. è¿‡æœŸè¯»å…¶è§£å†³æ–¹æ¡ˆ</a>\n<ul>\n<li><a href=\"#3721-%E5%88%A4%E6%96%AD%E4%B8%BB%E5%A4%87%E6%97%A0%E5%BB%B6%E8%BF%9F%E6%96%B9%E6%A1%88\">37.2.1. åˆ¤æ–­ä¸»å¤‡æ— å»¶è¿Ÿæ–¹æ¡ˆ</a></li>\n<li><a href=\"#3722-%E9%85%8D%E5%90%88semi-sync%E6%96%B9%E6%A1%88\">37.2.2. é…åˆsemi-syncæ–¹æ¡ˆ</a></li>\n<li><a href=\"#3723-%E7%AD%89%E4%B8%BB%E5%BA%93%E4%BD%8D%E7%82%B9%E6%96%B9%E6%A1%88\">37.2.3. ç­‰ä¸»åº“ä½ç‚¹æ–¹æ¡ˆï¼›</a></li>\n<li><a href=\"#3724-%E7%AD%89gtid%E6%96%B9%E6%A1%88\">37.2.4. ç­‰GTIDæ–¹æ¡ˆ</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#38-%E5%85%B6%E4%BB%96\">38. å…¶ä»–</a>\n<ul>\n<li><a href=\"#381-mysql%E8%87%AA%E5%A2%9Eid%E7%94%A8%E5%AE%8C%E6%80%8E%E4%B9%88%E5%8A%9E\">38.1. mysqlè‡ªå¢idç”¨å®Œæ€ä¹ˆåŠ?</a></li>\n<li><a href=\"#382-jdbc%E4%B8%ADstatement%E5%92%8Cpreparestatement%E7%9A%84%E5%8C%BA%E5%88%AB\">38.2. jdbcä¸­statementå’ŒPreparestatementçš„åŒºåˆ«ï¼Ÿ</a></li>\n<li><a href=\"#383-mysql%E7%9B%91%E6%8E%A7\">38.3. MySQLç›‘æ§</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<h1>1. æ•°æ®åº“æ¦‚å¿µ</h1>\n<ul>\n<li>å¯åŠ¨MySQLæœåŠ¡:net start mysql5;</li>\n<li>åœæ­¢MySQLæœåŠ¡:net stop mysql5</li>\n<li>æŸ¥çœ‹MySQLæœåŠ¡çš„çŠ¶æ€ï¼šnetstat -nlp</li>\n<li>ç™»å½•mysql:mysql [-host=ipåœ°å€] -uç”¨æˆ·å -p</li>\n</ul>\n<h1>2. MySQLæ”¯æŒçš„æ•°æ®ç±»å‹</h1>\n<h2>2.1. æ•°å€¼ç±»å‹</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5eb3564ceca7b636f4065.png\" alt=\"æ•°æ®ç±»å‹-æ•°å€¼ç±»å‹.PNG\" tabindex=\"0\"><figcaption>æ•°æ®ç±»å‹-æ•°å€¼ç±»å‹.PNG</figcaption></figure>\n<ul>\n<li>zerofill(å¡«å……0):åœ¨æ•°å­—ä½æ•°ï¼ˆç±»å‹åç§°åé¢çš„å°æ‹¬å·å†…æŒ‡å®šæ˜¾ç¤ºå®½åº¦,ä½†å­˜å‚¨å­—èŠ‚æ•°ä¸å˜ï¼‰ä¸å¤Ÿçš„ç©ºé—´ç”¨å­—ç¬¦â€œ0â€å¡«æ»¡ï¼Œå¦‚æœæ’å…¥å¤§äºå®½åº¦é™åˆ¶çš„å€¼ï¼Œè¿˜æ˜¯æŒ‰ç…§ç±»å‹çš„å®é™…ç²¾åº¦è¿›è¡Œä¿å­˜</li>\n<li>UNSIGNED(æ— ç¬¦å·):æ•´æ•°ç±»å‹é‡Œé¢ä¿å­˜éè´Ÿæ•°æˆ–è€…éœ€è¦è¾ƒå¤§çš„ä¸Šé™å€¼æ—¶é€‚ç”¨ï¼Œå–å€¼èŒƒå›´å˜ä¸º0åˆ°ä¸Šé™å–åŸå€¼çš„2å€ï¼Œå¦‚æœä¸€ä¸ªåˆ—æŒ‡å®šä¸ºzerofillï¼Œåˆ™è¯¥åˆ—è‡ªåŠ¨æ·»åŠ  UNSIGNED å±æ€§</li>\n<li>AUTO_INCREMENTã€‚æ•´æ•°ç±»å‹åœ¨éœ€è¦äº§ç”Ÿå”¯ä¸€æ ‡è¯†ç¬¦æˆ–é¡ºåºå€¼æ—¶é€‚ç”¨ã€‚ä¸€èˆ¬ä»1å¼€å§‹ï¼Œæ¯è¡Œå¢åŠ  1ã€‚ä¸€ä¸ªè¡¨ä¸­æœ€å¤šåªèƒ½æœ‰ä¸€ä¸ªã€‚å¯¹äºä½¿ç”¨AUTO_INCREMENTçš„åˆ—ï¼Œåº”è¯¥å®šä¹‰ä¸ºPRIMARY KEYæˆ–UNIQUEé”®</li>\n<li>å°æ•°åŒ…æ‹¬æµ®ç‚¹æ•°å’Œå®šç‚¹æ•°ã€‚æµ®ç‚¹æ•°åŒ…æ‹¬ floatï¼ˆå•ç²¾åº¦ï¼‰å’Œ doubleï¼ˆåŒç²¾åº¦ï¼‰ï¼Œå®šç‚¹æ•°åˆ™åªæœ‰decimalã€‚ä»¥å­—ç¬¦ä¸²å½¢å¼å­˜æ”¾ï¼Œæ¯”æµ®ç‚¹æ•°æ›´ç²¾ç¡®ï¼Œé€‚åˆç”¨æ¥è¡¨ç¤ºè´§å¸ç­‰ç²¾åº¦é«˜çš„æ•°æ®</li>\n<li>æµ®ç‚¹æ•°å’Œå®šç‚¹æ•°éƒ½å¯ä»¥ç”¨ç±»å‹åç§°ååŠ â€œ(M,D)â€ï¼Œè¡¨ç¤ºæ˜¾ç¤ºMä½æ•°å­—ï¼ˆæ•´æ•°ä½+å°æ•°ä½ï¼‰ï¼ŒDä½ä½äºå°æ•°ç‚¹åé¢ï¼Œæµ®ç‚¹æ•°å¦‚æœä¸å†™ç²¾åº¦Må’Œæ ‡åº¦Dï¼Œåˆ™ä¼šæŒ‰ç…§å®é™…ç²¾åº¦å€¼æ˜¾ç¤ºï¼Œå¦‚æœæœ‰ç²¾åº¦å’Œæ ‡åº¦ï¼Œåˆ™ä¼šè‡ªåŠ¨å°†å››èˆäº”å…¥åçš„ç»“æœæ’å…¥ï¼Œç³»ç»Ÿä¸ä¼šæŠ¥é”™ï¼›å®šç‚¹æ•°å¦‚æœä¸å†™ç²¾åº¦å’Œæ ‡åº¦ï¼Œåˆ™æŒ‰ç…§é»˜è®¤å€¼ decimal(10,0)æ¥è¿›è¡Œæ“ä½œï¼Œå¹¶ä¸”å¦‚æœæ•°æ®è¶…è¶Šäº†ç²¾åº¦å’Œæ ‡åº¦å€¼ï¼Œç³»ç»Ÿåˆ™ä¼šæŠ¥é”™ã€‚</li>\n<li>BIT(M)ç”¨æ¥å­˜æ”¾å¤šä½äºŒè¿›åˆ¶æ•°ï¼ŒMèŒƒå›´1ï½64ï¼Œé»˜è®¤1ã€‚å¿…é¡»ç”¨bin()ï¼ˆäºŒè¿›åˆ¶ï¼‰æˆ–è€… hex()ï¼ˆå…­è¿›åˆ¶ï¼‰å‡½æ•°è¯»å–ã€‚æ•°æ®æ’å…¥bitç±»å‹å­—æ®µæ—¶ï¼Œé¦–å…ˆè½¬æ¢ä¸ºäºŒè¿›åˆ¶ï¼Œå¦‚æœä½æ•°å…è®¸ï¼Œå°†æˆåŠŸæ’å…¥ï¼›</li>\n</ul>\n<h2>2.2. æ—¥æœŸæ—¶é—´ç±»å‹</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">æ•°æ®ç±»å‹</th>\n<th style=\"text-align:center\">å­—èŠ‚</th>\n<th style=\"text-align:center\">æœ€å°å€¼</th>\n<th style=\"text-align:center\">æœ€å¤§å€¼</th>\n<th style=\"text-align:center\">é›¶å€¼</th>\n<th style=\"text-align:center\">åœºæ™¯</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">DATE</td>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">1000-01-01</td>\n<td style=\"text-align:center\">9999-12-31</td>\n<td style=\"text-align:center\">0000-00-00</td>\n<td style=\"text-align:center\">å¹´æœˆæ—¥</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">TIME</td>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">-838:59:59</td>\n<td style=\"text-align:center\">838:5959</td>\n<td style=\"text-align:center\">00:00:00</td>\n<td style=\"text-align:center\">æ—¶åˆ†ç§’</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">YEAR</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">1901</td>\n<td style=\"text-align:center\">2155</td>\n<td style=\"text-align:center\">0000</td>\n<td style=\"text-align:center\">å¹´ä»½</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>å¦‚æœè¶…å‡ºæœ‰æ•ˆå€¼èŒƒå›´ï¼Œåœ¨é»˜è®¤çš„SQLModeä¸‹ï¼Œç³»ç»Ÿä¼šè¿›è¡Œé”™è¯¯æç¤ºï¼Œå¹¶å°†ä»¥é›¶å€¼æ¥è¿›è¡Œå­˜å‚¨</li>\n</ul>\n<h2>2.3. å­—ç¬¦ä¸²ç±»å‹</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/296fd0f48ca82e9d987ac.png\" alt=\"æ•°æ®ç±»å‹-å­—ç¬¦ä¸²ç±»å‹.PNG\" tabindex=\"0\"><figcaption>æ•°æ®ç±»å‹-å­—ç¬¦ä¸²ç±»å‹.PNG</figcaption></figure>\n<ul>\n<li>BINARYå’ŒVARBINARYåŒ…å«äºŒè¿›åˆ¶å­—ç¬¦ä¸²è€Œä¸åŒ…å«éäºŒè¿›åˆ¶å­—ç¬¦ä¸²ã€‚ä¿å­˜BINARYå€¼æ—¶é€šè¿‡å¡«å……â€œ0x00â€ï¼ˆé›¶å­—èŠ‚ï¼‰ä»¥è¾¾åˆ°å­—æ®µå®šä¹‰é•¿åº¦ã€‚BINARY(3)åˆ—ï¼Œå½“æ’å…¥æ—¶'a'å˜ä¸º'a\\0\\0'</li>\n<li>ENUMæšä¸¾ç±»å‹ï¼Œéœ€è¦åœ¨å»ºè¡¨æ—¶é€šè¿‡æšä¸¾æ–¹å¼æ˜¾å¼æŒ‡å®šå€¼èŒƒå›´ï¼ˆå¿½ç•¥å¤§å°å†™ï¼‰ï¼Œ1ï½255ä¸ªæˆå‘˜éœ€è¦1ä¸ªå­—èŠ‚ï¼›255ï½65535éœ€è¦2ä¸ªå­—èŠ‚å­˜å‚¨ã€‚æœ€å¤š65535ä¸ªã€‚create table t (gender enum('M','F'));æ’å…¥ä¸åœ¨ENUMæŒ‡å®šèŒƒå›´å†…çš„å€¼æ—¶ï¼Œé»˜è®¤æ’å…¥ç¬¬ä¸€ä¸ªå€¼ã€‚ä¸€æ¬¡åªèƒ½é€‰ä¸€ä¸ªæˆå‘˜</li>\n<li>SETä¹Ÿæ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡ï¼Œæœ€å¤š64ä¸ªã€‚æ¯8ä¸ªæˆå‘˜å 1ä¸ªå­—èŠ‚å­˜å‚¨ï¼›Create table t (col set ï¼ˆ'a','b','c','d'ï¼‰;åŒ…å«é‡å¤æˆå‘˜çš„é›†åˆå°†åªå–ä¸€æ¬¡ï¼›å¯¹äºè¶…å‡ºå…è®¸å€¼èŒƒå›´çš„å€¼å°†æŠ¥é”™ï¼Œä¸€æ¬¡å¯é€‰å¤šä¸ªæˆå‘˜</li>\n</ul>\n<h2>2.4. é€‰æ‹©åˆé€‚çš„æ•°æ®ç±»å‹</h2>\n<ul>\n<li>\n<p>åº”è¯¥æ ¹æ®å®é™…æƒ…å†µé€‰æ‹©èƒ½å¤Ÿæ»¡è¶³éœ€æ±‚çš„æœ€å°å­˜å‚¨ç±»å‹</p>\n</li>\n<li>\n<p>VARCHARå±äºå¯å˜é•¿åº¦çš„å­—ç¬¦ç±»å‹ã€‚CHARå±äºå›ºå®šé•¿åº¦çš„å­—ç¬¦ç±»å‹ã€‚æ‰€ä»¥å¤„ç†é€Ÿåº¦æ¯”VARCHARå¿«å¾—å¤šï¼Œä½†å…¶ç¼ºç‚¹æ˜¯æµªè´¹å­˜å‚¨ç©ºé—´ï¼Œç¨‹åºéœ€è¦å¯¹è¡Œå°¾ç©ºæ ¼è¿›è¡Œå¤„ç†ï¼Œå¯¹äºé‚£äº›é•¿åº¦å˜åŒ–ä¸å¤§å¹¶ä¸”å¯¹æŸ¥è¯¢é€Ÿåº¦æœ‰è¾ƒé«˜è¦æ±‚çš„æ•°æ®å¯ä»¥è€ƒè™‘ä½¿ç”¨CHARç±»å‹å­˜å‚¨</p>\n<ul>\n<li>MyISAMï¼šå»ºè®®ä½¿ç”¨CHAR</li>\n<li>MEMORYï¼šCHARæˆ–VARCHARåˆ—éƒ½æ˜¯ä½œä¸ºCHARç±»å‹å¤„ç†</li>\n<li>InnoDBï¼šå»ºè®®ä½¿ç”¨VARCHARç±»å‹ã€‚æ‰€æœ‰æ•°æ®è¡Œéƒ½ä½¿ç”¨æŒ‡å‘æ•°æ®åˆ—å€¼çš„å¤´æŒ‡é’ˆï¼Œä¸»è¦çš„æ€§èƒ½å› ç´ æ˜¯æ•°æ®è¡Œä½¿ç”¨çš„å­˜å‚¨æ€»é‡ã€‚ç”±äºCHARå¹³å‡å ç”¨çš„ç©ºé—´å¤šäºVARCHARï¼Œå› æ­¤ä½¿ç”¨VARCHARæ¥æœ€å°åŒ–éœ€è¦å¤„ç†çš„æ•°æ®è¡Œçš„å­˜å‚¨æ€»é‡å’Œç£ç›˜I/Oæ˜¯æ¯”è¾ƒå¥½</li>\n</ul>\n</li>\n<li>\n<p>TEXTä¸BLOB</p>\n<ul>\n<li>BLOBå’ŒTEXTå€¼åœ¨æ‰§è¡Œå¤§é‡çš„åˆ é™¤æ“ä½œï¼Œä¼šåœ¨æ•°æ®è¡¨ä¸­ç•™ä¸‹å¾ˆå¤§çš„â€œç©ºæ´â€ï¼Œä»¥åå¡«å…¥è¿™äº›â€œç©ºæ´â€çš„è®°å½•åœ¨æ’å…¥çš„æ€§èƒ½ä¸Šä¼šæœ‰å½±å“ã€‚ä¸ºäº†æé«˜æ€§èƒ½ï¼Œå»ºè®®å®šæœŸä½¿ç”¨ OPTIMIZE TABLE å¯¹è¡¨è¿›è¡Œç¢ç‰‡æ•´ç†é¿å…</li>\n<li>BLOB æˆ– TEXTå¯ä»¥ä½¿ç”¨åˆæˆçš„ï¼ˆSyntheticï¼‰ç´¢å¼•æ¥æé«˜æŸ¥è¯¢æ€§èƒ½ã€‚å°±æ˜¯æ ¹æ®å¤§æ–‡æœ¬å­—æ®µçš„å†…å®¹å¹¶é€šè¿‡ä½¿ç”¨ MD5()SHA1()æˆ– CRC32()å‡½æ•°æˆ–è€…ä½¿ç”¨è‡ªå·±çš„åº”ç”¨ç¨‹åºé€»è¾‘æ¥è®¡ç®—ä¸€ä¸ªæ•£åˆ—å€¼å­˜å‚¨åœ¨å•ç‹¬çš„æ•°æ®åˆ—ä¸­ï¼Œæ¥ä¸‹æ¥å°±å¯ä»¥é€šè¿‡æ£€ç´¢æ•£åˆ—å€¼æ‰¾åˆ°æ•°æ®ã€‚åªèƒ½ç”¨äºç²¾ç¡®åŒ¹é…çš„æŸ¥è¯¢ï¼ˆæ•£åˆ—å€¼å¯¹äºç±»ä¼¼&lt;æˆ–&gt;=ç­‰èŒƒå›´æœç´¢æ“ä½œç¬¦æ˜¯æ²¡æœ‰ç”¨å¤„çš„ï¼‰ã€‚å¦‚æœæ•£åˆ—ç®—æ³•ç”Ÿæˆçš„å­—ç¬¦ä¸²å¸¦æœ‰å°¾éƒ¨ç©ºæ ¼ï¼Œå°±ä¸è¦æŠŠå®ƒä»¬å­˜å‚¨åœ¨CHARæˆ–VARCHARåˆ—ä¸­ï¼Œå®ƒä»¬ä¼šå—åˆ°å°¾éƒ¨ç©ºæ ¼å»é™¤çš„å½±å“ã€‚å¦‚æœéœ€è¦å¯¹BLOBæˆ–è€… CLOB å­—æ®µè¿›è¡Œæ¨¡ç³ŠæŸ¥è¯¢ï¼ŒMySQLæä¾›äº†å‰ç¼€ç´¢å¼•ï¼Œåœ¨ä¸å¿…è¦çš„æ—¶å€™é¿å…æ£€ç´¢å¤§å‹çš„BLOBæˆ–TEXTå€¼</li>\n<li>æŠŠBLOBæˆ–TEXTåˆ—åˆ†ç¦»åˆ°å•ç‹¬çš„è¡¨ä¸­ã€‚åœ¨æŸäº›ç¯å¢ƒä¸­ï¼Œå¦‚æœæŠŠè¿™äº›æ•°æ®åˆ—ç§»åŠ¨åˆ°ç¬¬äºŒå¼ æ•°æ®è¡¨ä¸­ï¼Œå¯ä»¥æŠŠåŸæ•°æ®è¡¨ä¸­çš„æ•°æ®åˆ—è½¬æ¢ä¸ºå›ºå®šé•¿åº¦çš„æ•°æ®è¡Œæ ¼å¼ï¼Œè¿™ä¼šå‡å°‘ä¸»è¡¨ä¸­çš„ç¢ç‰‡ï¼Œå¯ä»¥å¾—åˆ°å›ºå®šé•¿åº¦æ•°æ®è¡Œçš„æ€§èƒ½ä¼˜åŠ¿ã€‚å®ƒè¿˜å¯ä»¥ä½¿ä¸»æ•°æ®è¡¨åœ¨è¿è¡Œ SELECT * æŸ¥è¯¢çš„æ—¶å€™ä¸ä¼šé€šè¿‡ç½‘ç»œä¼ è¾“å¤§é‡çš„ BLOB æˆ– TEXT å€¼ã€‚</li>\n</ul>\n</li>\n<li>\n<p>æµ®ç‚¹æ•°ä¸å®šç‚¹æ•°ã€‚æµ®ç‚¹æ•°ä¸€èˆ¬ç”¨äºè¡¨ç¤ºå«æœ‰å°æ•°éƒ¨åˆ†çš„æ•°å€¼ã€‚ç¼–ç¨‹ä¸­æ³¨æ„æµ®ç‚¹æ•°å­˜åœ¨è¯¯å·®ï¼Œå°½é‡é¿å…æ¯”è¾ƒï¼›å¯¹è´§å¸ç­‰å¯¹ç²¾åº¦æ•æ„Ÿçš„æ•°æ®åº”è¯¥ç”¨å®šç‚¹æ•°</p>\n</li>\n<li>\n<p>å¦‚æœåº”ç”¨åªéœ€è¦è®°å½•â€œå¹´ä»½â€ï¼Œå¯ç”¨1ä¸ªå­—èŠ‚æ¥å­˜å‚¨çš„YEARç±»å‹ï¼Œèƒ½èŠ‚çº¦å­˜å‚¨ï¼Œæé«˜è¡¨çš„æ“ä½œæ•ˆç‡ï¼›å¦‚æœè¦è®°å½•å¹´æœˆæ—¥æ—¶åˆ†ç§’ï¼Œå¹¶ä¸”è®°å½•çš„å¹´ä»½æ¯”è¾ƒä¹…è¿œï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨DATETIMEï¼Œè€Œä¸è¦ç”¨TIMESTAMPã€‚å› ä¸ºTIMESTAMPçš„æ—¥æœŸèŒƒå›´æ¯”DATETIMEè¦çŸ­å¾—å¤šï¼›å¦‚æœè®°å½•çš„æ—¥æœŸéœ€è¦è®©ä¸åŒæ—¶åŒºçš„ç”¨æˆ·ä½¿ç”¨ï¼Œé‚£ä¹ˆæœ€å¥½ä½¿ç”¨ TIMESTAMPï¼Œå› ä¸ºæ—¥æœŸç±»å‹ä¸­åªæœ‰å®ƒèƒ½å¤Ÿå’Œå®é™…æ—¶åŒºç›¸å¯¹åº”</p>\n</li>\n<li>\n<p>å°½å¯èƒ½çš„ä½¿ç”¨not nullå®šä¹‰å­—æ®µ(innodbçš„ç‰¹æ€§æ‰€å†³å®šï¼Œénot nullçš„å€¼ï¼Œéœ€è¦é¢å¤–çš„åœ¨å­—æ®µå­˜å‚¨ï¼ŒåŒæ—¶ä¹Ÿä¼šå¢åŠ IOå’Œå­˜å‚¨çš„å¼€é”€ï¼‰</p>\n</li>\n<li>\n<p>å°½é‡å°‘ç”¨textç±»å‹ï¼Œéç”¨ä¸å¯æ—¶æœ€å¥½è€ƒè™‘åˆ†è¡¨ã€‚</p>\n</li>\n<li>\n<p>è¡¨ä¸­æœ‰å¤§å­—æ®µ X(ä¾‹å¦‚ï¼štext ç±»å‹)ï¼Œä¸”å­—æ®µ X ä¸ä¼šç»å¸¸æ›´æ–°ï¼Œä»¥è¯»ä¸ºä¸ºä¸»ï¼Œè¯·é—®æ‚¨æ˜¯é€‰æ‹©æ‹†æˆå­è¡¨ï¼Œè¿˜æ˜¯ç»§ç»­æ”¾ä¸€èµ·?</p>\n<ul>\n<li>æ‹†å¸¦æ¥çš„é—®é¢˜ï¼šè¿æ¥æ¶ˆè€—+å­˜å‚¨æ‹†åˆ†ç©ºé—´ã€‚æ‹†çš„è¯æœ€å¥½å’Œç»å¸¸è¦æŸ¥è¯¢çš„è¡¨çš„ä¸»é”®åœ¨ç‰©ç†ç»“æ„ä¸Šæ”¾ç½®åœ¨ä¸€èµ·(åˆ†åŒº) é¡ºåº IO ï¼Œå‡å°‘è¿æ¥æ¶ˆè€—ï¼Œæœ€åè¿™æ˜¯ä¸€ä¸ªæ–‡æœ¬åˆ—å†åŠ ä¸Šä¸€ä¸ªå…¨æ–‡ç´¢å¼•æ¥å°½é‡æŠµæ¶ˆè¿æ¥æ¶ˆè€—ã€‚</li>\n<li>ä¸æ‹†å¯èƒ½å¸¦æ¥çš„é—®é¢˜ï¼šæŸ¥è¯¢æ€§èƒ½ã€‚å®é™…åœºæ™¯ä¸‹ï¼Œä¾‹å¦‚è¯´å•†å“è¡¨æ•°æ®é‡æ¯”è¾ƒå¤§çš„æƒ…å†µä¸‹ä½¿ç”¨æ‹†çš„æ–¹æ¡ˆï¼Œä¼šå°†å•†å“æè¿°å•ç‹¬å­˜å‚¨åˆ°ä¸€ä¸ªè¡¨ä¸­ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>3. MySQLä¸­çš„è¿ç®—ç¬¦</h1>\n<h2>3.1. ç®—æœ¯è¿ç®—ç¬¦</h2>\n<ul>\n<li>+ã€-ã€*ã€/æˆ–è€…DIVï¼ˆé™¤æ³•ï¼Œè¿”å›å•†ï¼‰ã€%æˆ–è€…MOD(a,b)ï¼ˆé™¤æ³•ï¼Œè¿”å›ä½™æ•°ï¼‰</li>\n<li>é™¤æ³•è¿ç®—å’Œæ¨¡è¿ç®—ä¸­ï¼Œå¦‚æœé™¤æ•°ä¸º0ï¼Œå°†æ˜¯éæ³•é™¤æ•°ï¼Œè¿”å›ç»“æœä¸ºNULL</li>\n</ul>\n<h2>3.2. æ¯”è¾ƒè¿ç®—ç¬¦</h2>\n<ul>\n<li>=(ä¸èƒ½æ¯”è¾ƒnull)ã€&lt;&gt;æˆ–è€…!=(ä¸èƒ½æ¯”è¾ƒnull)ã€&lt;=&gt;ï¼ˆèƒ½æ¯”è¾ƒNULLç­‰äºï¼‰ã€&lt;ã€&gt;ã€&lt;=ã€&gt;=ã€[not] between(å…¨åŒ…å«)ã€[not] inã€is [not] nullã€like [_'å•ä¸ªå­—ç¬¦ï¼Œ'%'å¤šä¸ªå­—ç¬¦]ã€REGEXPæˆ–RLIKE(æ­£åˆ™è¡¨è¾¾å¼åŒ¹é…),selectä¸­çš„æ¯”è¾ƒtrueåˆ™æ˜¯1ï¼Œfalseåˆ™æ˜¯0,ç”¨äºæ¯”è¾ƒæ•°å­—ã€å­—ç¬¦ä¸²(ä¸åŒºåˆ†å¤§å°å†™)å’Œè¡¨è¾¾å¼.æ•°å­—ä½œä¸ºæµ®ç‚¹æ•°æ¯”è¾ƒï¼Œè€Œå­—ç¬¦ä¸²ä»¥ä¸<br>\nåŒºåˆ†å¤§å°å†™çš„æ–¹å¼è¿›è¡Œæ¯”è¾ƒã€‚</li>\n</ul>\n<h2>3.3. é€»è¾‘è¿ç®—ç¬¦</h2>\n<ul>\n<li>NOTæˆ–è€…!</li>\n<li>ANDæˆ–è€…&amp;&amp; é€»è¾‘ä¸ï¼Œæ“ä½œæ•°æœ‰0ï¼Œç»“æœ0ï¼›æœ‰NULLä¸”æ— 0 ç»“æœNULLï¼Œå…¶ä»–1</li>\n<li>ORæˆ–è€…|| é€»è¾‘æˆ–ï¼Œæ“ä½œæ•°æœ‰1ï¼Œç»“æœ1ï¼›æœ‰NULLä¸”æ— 1ï¼Œç»“æœNULLï¼Œå…¶ä»–0</li>\n<li>XOR é€»è¾‘å¼‚æˆ–,æ“ä½œæ•°æœ‰NULLï¼Œç»“æœnull,æ— nullçœŸå‡å€¼ç›¸å¼‚ï¼Œç»“æœ 1ï¼›å…¶ä»–0ã€‚</li>\n</ul>\n<h2>3.4. ä½è¿ç®—ç¬¦</h2>\n<ul>\n<li>&amp; ä½ä¸ï¼ˆä½ ANDï¼‰ã€| ä½æˆ– ï¼ˆä½ OR ï¼‰ã€^ ä½å¼‚æˆ–ï¼ˆä½ XORï¼‰ã€~ ä½å–åã€&gt;&gt; ä½å³ç§»ã€&lt;&lt; ä½å·¦ç§»,ä½è¿ç®—æ˜¯å°†ç»™å®šçš„æ“ä½œæ•°è½¬åŒ–ä¸ºäºŒè¿›åˆ¶åï¼Œå¯¹å„ä¸ªæ“ä½œæ•°æ¯ä¸€ä½éƒ½è¿›è¡ŒæŒ‡å®šçš„é€»è¾‘è¿ç®—ï¼Œå¾—åˆ°çš„äºŒè¿›åˆ¶ç»“æœè½¬æ¢ä¸ºåè¿›åˆ¶æ•°åå°±æ˜¯ä½è¿ç®—çš„ç»“æœã€‚</li>\n</ul>\n<h1>4. MySQLå¸¸ç”¨å‡½æ•°</h1>\n<h2>4.6. å…¶ä»–å‡½æ•°</h2>\n<ul>\n<li>DATABASE() è¿”å›å½“å‰æ•°æ®åº“å</li>\n<li>VERSION() è¿”å›å½“å‰æ•°æ®åº“ç‰ˆæœ¬</li>\n<li>USER() è¿”å›å½“å‰ç™»å½•ç”¨æˆ·å</li>\n<li>PASSWORD(str) è¿”å›å­—ç¬¦ä¸²strçš„åŠ å¯†ç‰ˆæœ¬</li>\n<li>MD5() è¿”å›å­—ç¬¦ä¸²strçš„MD5å€¼</li>\n</ul>\n<h1>5. è§†å›¾</h1>\n<ul>\n<li>è§†å›¾ï¼ˆViewï¼‰æ˜¯ä¸€ç§è™šæ‹Ÿå­˜åœ¨çš„è¡¨ï¼Œå¹¶ä¸åœ¨æ•°æ®åº“ä¸­å®é™…å­˜åœ¨ï¼Œè¡Œå’Œåˆ—æ•°æ®æ¥è‡ªå®šä¹‰è§†å›¾çš„æŸ¥è¯¢ä¸­ä½¿ç”¨çš„è¡¨ï¼Œå¹¶ä¸”æ˜¯åœ¨ä½¿ç”¨è§†å›¾æ—¶åŠ¨æ€ç”Ÿæˆçš„ã€‚</li>\n<li>è§†å›¾ç›¸å¯¹äºæ™®é€šçš„è¡¨çš„ä¼˜åŠ¿\n<ul>\n<li>ç®€å•ï¼šç”¨æˆ·å®Œå…¨ä¸éœ€è¦å…³å¿ƒåé¢å¯¹åº”çš„è¡¨çš„ç»“æ„ã€å…³è”æ¡ä»¶å’Œç­›é€‰æ¡ä»¶ï¼Œå¯¹ç”¨æˆ·æ¥è¯´å·²ç»æ˜¯è¿‡æ»¤å¥½çš„å¤åˆæ¡ä»¶çš„ç»“æœé›†ã€‚</li>\n<li>å®‰å…¨ï¼šç”¨æˆ·åªèƒ½è®¿é—®ä»–ä»¬è¢«å…è®¸æŸ¥è¯¢çš„ç»“æœé›†ï¼Œå¯¹è¡¨çš„æƒé™ç®¡ç†å¹¶ä¸èƒ½é™åˆ¶åˆ°æŸä¸ªè¡ŒæŸä¸ªåˆ—ï¼Œä½†æ˜¯é€šè¿‡è§†å›¾å°±å¯ä»¥ç®€å•çš„å®ç°</li>\n<li>æ•°æ®ç‹¬ç«‹ï¼šä¸€æ—¦è§†å›¾ç»“æ„ç¡®å®šäº†ï¼Œå¯ä»¥å±è”½è¡¨ç»“æ„å˜åŒ–å¯¹ç”¨æˆ·çš„å½±å“ï¼Œæºè¡¨å¢åŠ åˆ—å¯¹è§†å›¾æ²¡æœ‰å½±å“ï¼›æºè¡¨ä¿®æ”¹åˆ—åï¼Œåˆ™å¯ä»¥é€šè¿‡ä¿®æ”¹è§†å›¾æ¥è§£å†³ï¼Œä¸ä¼šé€ æˆå¯¹è®¿é—®è€…çš„å½±å“</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºæˆ–è€…ä¿®æ”¹è§†å›¾è¦æœ‰ CREATE VIEWæƒé™ï¼Œå¹¶ä¸”å¯¹äºæŸ¥è¯¢æ¶‰åŠçš„åˆ—æœ‰SELECTæƒé™ã€‚å¦‚æœä½¿ç”¨CREATE OR REPLACE æˆ–è€… ALTER ä¿®æ”¹è§†å›¾ï¼Œè¿˜éœ€è¦è¯¥è§†å›¾çš„DROPæƒé™ã€‚\n# åˆ›å»ºè§†å›¾\nmysql&gt; CREATE [OR REPLACE] [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}] VIEW view_name [(column_list)] AS select_statement [WITH [CASCADED | LOCAL] CHECK OPTION]\n# ä¿®æ”¹è§†å›¾\nmysql&gt; ALTER [ALGORITHM = {UNDEFINED | MERGE | TEMPTABLE}]VIEW view_name [(column_list)] AS select_statement [WITH [CASCADED | LOCAL] CHECK OPTION]\n\n# åœ¨ FROM å…³é”®å­—åé¢ä¸èƒ½åŒ…å«å­æŸ¥è¯¢\n# LOCAL æ˜¯åªè¦æ»¡è¶³æœ¬è§†å›¾çš„æ¡ä»¶å°±å¯ä»¥æ›´æ–°è§†å›¾è®°å½•ï¼›\n# CASCADED(é»˜è®¤) åˆ™æ˜¯å¿…é¡»æ»¡è¶³æ‰€æœ‰é’ˆå¯¹è¯¥è§†å›¾çš„æ‰€æœ‰è§†å›¾çš„æ¡ä»¶æ‰å¯ä»¥æ›´æ–°è§†å›¾è®°å½•\n# ä»¥ä¸‹æƒ…å†µè§†å›¾ä¸æ›´æ–°\n  # åŒ…å«èšåˆå‡½æ•°ï¼ˆSUMã€MINã€MAXã€COUNT ç­‰ï¼‰ã€DISTINCTã€GROUP BYã€HAVINGã€UNION æˆ–è€… UNION ALL\n  # å¸¸é‡è§†å›¾ã€‚create or replace view pi as select 3.1415926 as pi;\n  # SELECT ä¸­åŒ…å«å­æŸ¥è¯¢ã€‚create view city_view as select (select city from city where city_id = 1);\n  # JION\n  # FROM ä¸€ä¸ªä¸èƒ½æ›´æ–°çš„è§†å›¾ã€‚\n  # WHERE å­—å¥çš„å­æŸ¥è¯¢å¼•ç”¨äº† FROM å­—å¥ä¸­çš„è¡¨ã€‚\n\n# åˆ é™¤è§†å›¾ \n# éœ€è¦æœ‰è¯¥è§†å›¾DROPæƒé™ã€‚\nmysql&gt; DROP VIEW [IF EXISTS] view_name [, view_name] ...[RESTRICT | CASCADE]\n\n# æŸ¥çœ‹è§†å›¾\n# æ˜¾ç¤ºè¡¨å’Œè§†å›¾çš„åå­—\nmysql&gt; SHOW TABLES \n# æ˜¾ç¤ºè¡¨å’Œè§†å›¾çš„ä¿¡æ¯ï¼ˆè¡¨è¡Œæ•°ï¼‰\nmysql&gt; SHOW TABLE STATUS [FROM db_name] [LIKE 'pattern']\n# æŸ¥è¯¢æŸä¸ªè§†å›¾çš„å®šä¹‰\nmysql&gt; SHOW CREATE VIEW view_name\n# æŸ¥çœ‹è§†å›¾çš„ç›¸å…³ä¿¡æ¯\nmysql&gt; select * from information_schema.views where table_name = 'staff_list'\n</code></pre></div><h1>6. å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°</h1>\n<ul>\n<li>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°æ˜¯äº‹å…ˆç»è¿‡ç¼–è¯‘å¹¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­çš„ä¸€æ®µSQLè¯­å¥çš„é›†åˆï¼Œå¯ä»¥ç®€åŒ–åº”ç”¨å¼€å‘äººå‘˜çš„å¾ˆå¤šå·¥ä½œï¼Œå‡å°‘æ•°æ®åœ¨æ•°æ®åº“å’Œåº”ç”¨æœåŠ¡å™¨ä¹‹é—´çš„ä¼ è¾“ï¼Œå¯¹äºæé«˜æ•°æ®å¤„ç†çš„æ•ˆç‡æ˜¯æœ‰å¥½å¤„çš„ã€‚</li>\n<li>å­˜å‚¨è¿‡ç¨‹çš„å¥½å¤„åœ¨äºå¤„ç†é€»è¾‘éƒ½å°è£…åœ¨æ•°æ®åº“ç«¯ï¼Œè°ƒç”¨è€…ä¸éœ€è¦äº†è§£ä¸­é—´çš„å¤„ç†é€»è¾‘ï¼Œä¸€æ—¦å¤„ç†é€»è¾‘å‘ç”Ÿå˜åŒ–ï¼Œåªéœ€è¦ä¿®æ”¹å­˜å‚¨è¿‡ç¨‹å³å¯ï¼Œè€Œå¯¹è°ƒç”¨è€…çš„ç¨‹åºå®Œå…¨æ²¡æœ‰å½±å“ã€‚</li>\n<li>å‡½æ•°å¿…é¡»æœ‰è¿”å›å€¼ï¼Œè€Œå­˜å‚¨è¿‡ç¨‹æ²¡æœ‰ï¼Œå­˜å‚¨è¿‡ç¨‹çš„å‚æ•°å¯ä»¥ä½¿ç”¨INã€OUTã€INOUTç±»å‹ï¼Œè€Œå‡½æ•°çš„å‚æ•°åªèƒ½æ˜¯INç±»å‹ã€‚</li>\n<li>åˆ›å»ºå­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°éœ€è¦ CREATE ROUTINE æƒé™ï¼Œä¿®æ”¹æˆ–è€…åˆ é™¤å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°éœ€è¦ ALTER ROUTINE æƒé™ï¼Œæ‰§è¡Œå­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°éœ€è¦ EXECUTE æƒé™</li>\n<li>å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„ä¼˜åŠ¿æ˜¯å¯ä»¥å°†æ•°æ®çš„å¤„ç†æ”¾åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šè¿›è¡Œï¼Œé¿å…å°†å¤§é‡çš„ç»“æœé›†ä¼ è¾“ç»™å®¢æˆ·ç«¯ï¼Œå‡å°‘æ•°æ®çš„ä¼ è¾“ï¼Œä½†æ˜¯åœ¨æ•°æ®åº“æœåŠ¡å™¨ä¸Šè¿›è¡Œå¤§é‡çš„å¤æ‚è¿ç®—ä¹Ÿä¼šå ç”¨æœåŠ¡å™¨çš„CPUï¼Œé€ æˆæ•°æ®åº“æœåŠ¡å™¨çš„å‹åŠ›ï¼Œæ‰€ä»¥ä¸è¦åœ¨å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°ä¸­è¿›è¡Œå¤§é‡çš„å¤æ‚è¿ç®—ï¼Œåº”å°½é‡å°†è¿™äº›è¿ç®—æ“ä½œåˆ†æ‘Šåˆ°åº”ç”¨æœåŠ¡å™¨ä¸Šæ‰§è¡Œ</li>\n</ul>\n<h2>6.1. åˆ›å»ºã€ä¿®æ”¹ã€åˆ é™¤ã€æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\n# proc_parameter: [ IN | OUT | INOUT ] param_name type\n# func_parameter: param_name type\n# type: Any valid MySQL data type\n# characteristic: \n  # COMMENT 'string'(å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°çš„æ³¨é‡Šä¿¡æ¯) \n  # SQL SECURITY { DEFINER(é»˜è®¤) | INVOKER }æŒ‡å®šå­ç¨‹åºè¯¥ç”¨åˆ›å»ºå­ç¨‹åºè€…è¿˜æ˜¯ä½¿ç”¨è°ƒç”¨è€…çš„è®¸å¯æ¥æ‰§è¡Œ\n# routine_body: Valid SQL routine statement\n# å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°å…è®¸åŒ…å«DDLè¯­å¥ï¼ŒCommitæˆ–è€…å›æ»šï¼Œè°ƒç”¨å…¶ä»–çš„è¿‡ç¨‹æˆ–è€…å‡½æ•°ï¼Œä½†æ˜¯ä¸å…è®¸æ‰§è¡ŒLOAD DATA INFILEè¯­å¥\n# æ‰§è¡Œåˆ›å»ºè¿‡ç¨‹å’Œå‡½æ•°å¯ä»¥é€šè¿‡â€œDELIMITER $$â€å‘½ä»¤å°†è¯­å¥çš„ç»“æŸç¬¦ä»â€œ;â€ä¿®æ”¹æˆå…¶ä»–ç¬¦å·å¦‚â€œ$$â€ï¼Œè¿™æ ·â€œ;â€å°±ä¸ä¼šè¢«è§£é‡Šæˆè¯­å¥çš„ç»“æŸè€Œæç¤ºé”™è¯¯ã€‚åˆ›å»ºå®Œæ¯•å†é€šè¿‡â€œDELIMITER ;â€å‘½ä»¤å†å°†ç»“æŸç¬¦æ”¹å›æˆâ€œ;â€\n\nmysql&gt; CREATE [DEFINER = { user | CURRENT_USER }] PROCEDURE å­˜å‚¨è¿‡ç¨‹å ([proc_parameter[,...]]) [characteristic ...] routine_body\n\nmysql&gt; CREATE [DEFINER = { user | CURRENT_USER }] FUNCTION å‡½æ•°å ([func_parameter[,...]]) RETURNS type [characteristic ...] routine_body\n\n\n# ä¿®æ”¹å‡½æ•°/å­˜å‚¨è¿‡ç¨‹\nmysql&gt; ALTER {PROCEDURE | FUNCTION} å­˜å‚¨è¿‡ç¨‹å/å‡½æ•°å [characteristic ...]\n\n# è°ƒç”¨è¿‡ç¨‹\nmysql&gt; CALL å­˜å‚¨è¿‡ç¨‹å/å‡½æ•°å([parameter[,...]])\n\n# åˆ›å»ºå¤§é‡æ•°æ®çš„å­˜å‚¨è¿‡ç¨‹\nmysql&gt; create table t(id int primary key, a int, b int,index(a))engine=innodb;\ndelimiter ;;\ncreate procedure idata()\nbegin\ndeclare i int;\nset i=1;\nwhile(i&lt;=1000)do\ninsert into t values(i,i,i);\nset i=i+1;\nend while;\nend;;\ndelimiter ;\ncall idata();\n\n# ä¸€æ¬¡åªèƒ½åˆ é™¤ä¸€ä¸ªå­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°ï¼Œéœ€è¦æœ‰è¯¥è¿‡ç¨‹æˆ–è€…å‡½æ•°çš„ALTER ROUTINE æƒé™\nmysql&gt; DROP {PROCEDURE | FUNCTION} [IF EXISTS] å­˜å‚¨è¿‡ç¨‹å/å‡½æ•°å\n\n# æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°\nmysql&gt; SHOW {PROCEDURE | FUNCTION} STATUS [LIKE 'pattern']\n\n# æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°çš„å®šä¹‰\nmysql&gt; SHOW CREATE {PROCEDURE | FUNCTION} å­˜å‚¨è¿‡ç¨‹å/å‡½æ•°å\n\n# æŸ¥çœ‹å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°çš„ä¿¡æ¯\nmysql&gt; select * from information_schema.routines where ROUTINE_NAME = 'film_in_stock'\n</code></pre></div><h2>6.2. å˜é‡çš„ä½¿ç”¨</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å±€éƒ¨å˜é‡çš„å®šä¹‰ï¼šä½œç”¨èŒƒå›´åœ¨BEGINâ€¦ENDå—ä¸­ï¼Œå¯ä»¥ç”¨åœ¨åµŒå¥—çš„å—ä¸­ã€‚å¿…é¡»å†™åœ¨å¤åˆè¯­å¥çš„å¼€å¤´ï¼Œå¹¶ä¸”åœ¨ä»»ä½•å…¶ä»–è¯­å¥å‰é¢\nmysql&gt; DECLARE å˜é‡å[,...] æ•°æ®ç±»å‹ [DEFAULT value]\n\n# å˜é‡çš„ç›´æ¥èµ‹å€¼(å¸¸é‡æˆ–è€…èµ‹è¡¨è¾¾å¼)\nmysql&gt; SET å˜é‡å = expr [, var_name = expr] ...\n\n# å˜é‡çš„æŸ¥è¯¢ç»“æœèµ‹å€¼\nmysql&gt; SELECT col_name[,...] INTO å˜é‡å[,...] table_expr\n</code></pre></div><h2>6.3. æ¡ä»¶çš„å®šä¹‰å’Œå¤„ç†</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># æ¡ä»¶çš„å®šä¹‰\n# condition_value:{ SQLSTATE [VALUE] sqlstate_value| mysql_error_code }\nmysql&gt; DECLARE æ¡ä»¶å CONDITION FOR condition_value\n\n# æ¡ä»¶çš„å¤„ç†\n# handler_type: { CONTINUE | EXIT } CONTINUE è¡¨ç¤ºç»§ç»­æ‰§è¡Œä¸‹é¢çš„è¯­å¥ï¼ŒEXIT åˆ™è¡¨ç¤ºæ‰§è¡Œç»ˆæ­¢\n# condition_value:\n  { SQLSTATE [VALUE] sqlstate_value\n  | condition_name æ¡ä»¶å\n  | SQLWARNING ä»¥ 01 å¼€å¤´çš„ SQLSTATE ä»£ç çš„é€Ÿè®°\n  | NOT FOUND ä»¥ 02 å¼€å¤´çš„ SQLSTATE ä»£ç çš„é€Ÿè®°\n  | SQLEXCEPTION æ²¡æœ‰è¢« SQLWARNING æˆ– NOT FOUND æ•è·çš„ SQLSTATE ä»£ç çš„é€Ÿè®°\n  | mysql_error_code }\nmysql&gt; DECLARE handler_type HANDLER FOR æ¡ä»¶å[,...] sp_statement\n\n# å¯¹äºé”™è¯¯ERROR 1062 (23000): Duplicate entry '1' for key 'PRIMARY' å¯ä»¥è¿™ä¹ˆå£°æ˜\n# SQLSTATE\nmysql&gt; DECLARE CONTINUE HANDLER FOR SQLSTATE '23000' SET @x2 = 1 \n\n# mysql-error-codeï¼š\nmysql&gt; DECLARE CONTINUE HANDLER FOR 1062 SET @x2 = 1;\n\n# äº‹å…ˆå®šä¹‰ condition_nameï¼š\nmysql&gt; DECLARE DuplicateKey CONDITION FOR SQLSTATE '23000';\nmysql&gt; DECLARE CONTINUE HANDLER FOR DuplicateKey SET @x2 = 1;\n\n# SQLEXCEPTION\nmysql&gt; DECLARE CONTINUE HANDLER FOR SQLEXCEPTION SET @x2 = 1;\n</code></pre></div><h2>6.4. å…‰æ ‡çš„ä½¿ç”¨</h2>\n<ul>\n<li>åœ¨å­˜å‚¨è¿‡ç¨‹å’Œå‡½æ•°ä¸­å¯ä»¥ä½¿ç”¨å…‰æ ‡å¯¹ç»“æœé›†è¿›è¡Œå¾ªç¯çš„å¤„ç†ã€‚</li>\n<li>å˜é‡ã€æ¡ä»¶ã€å¤„ç†ç¨‹åºã€å…‰æ ‡éƒ½æ˜¯é€šè¿‡DECLAREå®šä¹‰ï¼Œå˜é‡å’Œæ¡ä»¶å¿…é¡»åœ¨æœ€å‰é¢å£°æ˜ï¼Œç„¶åæ‰èƒ½æ˜¯å…‰æ ‡çš„å£°æ˜ï¼Œæœ€åæ‰å¯ä»¥æ˜¯å¤„ç†ç¨‹åºçš„å£°æ˜</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å£°æ˜å…‰æ ‡\nmysql&gt; DECLARE å…‰æ ‡å CURSOR FOR select_statement\n\n# OPEN å…‰æ ‡\nmysql&gt; OPEN å…‰æ ‡å\n\n# FETCH å…‰æ ‡\nmysql&gt; FETCH å…‰æ ‡å INTO var_name [, var_name] ...\n\n# CLOSE å…‰æ ‡\nmysql&gt; CLOSE å…‰æ ‡å\n\n# å…‰æ ‡ä½¿ç”¨ä¾‹å­\nmysql&gt; CREATE PROCEDURE payment_stat ()\n -&gt; BEGIN\n -&gt; DECLARE i_staff_id int;\n -&gt; DECLARE d_amount decimal(5,2);\n -&gt; DECLARE cur_payment cursor for select staff_id,amount from payment;\n -&gt; DECLARE EXIT HANDLER FOR NOT FOUND CLOSE cur_payment;\n -&gt; \n -&gt; set @x1 = 0;\n -&gt; set @x2 = 0;\n -&gt; \n -&gt; OPEN cur_payment;\n -&gt; \n -&gt; REPEAT\n -&gt; FETCH cur_payment INTO i_staff_id, d_amount;\n -&gt; if i_staff_id = 2 then\n -&gt; set @x1 = @x1 + d_amount;\n -&gt; else \n -&gt; set @x2 = @x2 + d_amount;\n -&gt; end if;\n -&gt; UNTIL 0 END REPEAT;\n -&gt; \n -&gt; CLOSE cur_payment;\n -&gt; \n -&gt; END;\n -&gt; $$\n</code></pre></div><h2>6.5. æµç¨‹æ§åˆ¶</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># IF è¯­å¥\nIF search_condition THEN statement_list\n[ELSEIF search_condition THEN statement_list] ...\n[ELSE statement_list]\nEND IF\n\n# CASE è¯­å¥\nCASE case_value\nWHEN when_value THEN statement_list\n[WHEN when_value THEN statement_list] ...\n[ELSE statement_list]\nEND CASE\nOr: \nCASE\nWHEN search_condition THEN statement_list\n[WHEN search_condition THEN statement_list] ...\n[ELSE statement_list]\nEND CASE\n\n# LOOPè¯­å¥ï¼Œç®€å•çš„å¾ªç¯ï¼Œé€€å‡ºå¾ªç¯çš„æ¡ä»¶éœ€è¦ä½¿ç”¨å…¶ä»–çš„è¯­å¥å®šä¹‰.é€šå¸¸å¯ä»¥ä½¿ç”¨ LEAVE è¯­å¥å®ç°\n[begin_label:] LOOP\nstatement_list\nEND LOOP [end_label]\n\n# LEAVEè¯­å¥ï¼Œç”¨æ¥ä»æ ‡æ³¨çš„æµç¨‹æ„é€ ä¸­é€€å‡ºï¼Œé€šå¸¸å’Œ BEGIN ... END æˆ–è€…å¾ªç¯ä¸€èµ·ä½¿ç”¨ã€‚\nLEAVE [end_label]\n\n# ITERATEè¯­å¥ï¼Œå¿…é¡»ç”¨åœ¨å¾ªç¯ä¸­ï¼Œä½œç”¨æ˜¯è·³è¿‡å½“å‰å¾ªç¯çš„å‰©ä¸‹çš„è¯­å¥ï¼Œç›´æ¥è¿›å…¥ä¸‹ä¸€è½®å¾ªç¯ã€‚\nITERATE [end_label]\n\n# REPEAT è¯­å¥ï¼Œæœ‰æ¡ä»¶çš„å¾ªç¯æ§åˆ¶è¯­å¥ï¼Œå½“æ»¡è¶³æ¡ä»¶çš„æ—¶å€™é€€å‡ºå¾ªç¯ï¼Œ\n[begin_label:] REPEAT\nstatement_list\nUNTIL search_condition\nEND REPEAT [end_label]\n\n# WHILE è¯­å¥ï¼Œæœ‰æ¡ä»¶çš„å¾ªç¯æ§åˆ¶è¯­å¥ï¼Œå³å½“æ»¡è¶³æ¡ä»¶æ—¶æ‰§è¡Œå¾ªç¯çš„å†…å®¹ï¼Œ\n[begin_label:] WHILE search_condition DO\nstatement_list\nEND WHILE [end_label]\n\n# WHILEæ˜¯æ»¡è¶³æ¡ä»¶æ‰æ‰§è¡Œå¾ªç¯ï¼ŒREPEATæ˜¯æ»¡è¶³æ¡ä»¶é€€å‡ºå¾ªç¯ï¼›WHILEåœ¨é¦–æ¬¡å¾ªç¯æ‰§è¡Œä¹‹å‰å°±åˆ¤æ–­æ¡ä»¶ï¼Œæœ€å°‘æ‰§è¡Œ0æ¬¡ï¼ŒREPEATæ˜¯åœ¨é¦–æ¬¡æ‰§è¡Œå¾ªç¯ä¹‹åæ‰åˆ¤æ–­æ¡ä»¶ï¼Œæœ€å°‘æ‰§è¡Œ1æ¬¡\n</code></pre></div><h1>7. è§¦å‘å™¨</h1>\n<ul>\n<li>è§¦å‘å™¨æ˜¯ä¸è¡¨æœ‰å…³çš„æ•°æ®åº“å¯¹è±¡ï¼Œåœ¨æ»¡è¶³å®šä¹‰æ¡ä»¶æ—¶è§¦å‘ï¼Œå¹¶æ‰§è¡Œè§¦å‘å™¨ä¸­å®šä¹‰çš„è¯­å¥é›†åˆã€‚å¯ä»¥ååŠ©åº”ç”¨åœ¨æ•°æ®åº“ç«¯ç¡®ä¿æ•°æ®çš„å®Œæ•´æ€§</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºè§¦å‘å™¨\n# trigger_timeè§¦å‘æ—¶é—´ï¼ŒBEFOREåœ¨æ£€æŸ¥çº¦æŸå‰è§¦å‘ï¼ŒAFTERåœ¨æ£€æŸ¥çº¦æŸåè§¦å‘\n# trigger_eventè§¦å‘äº‹ä»¶INSERTã€UPDATE æˆ–è€… DELETE\n# å¯¹åŒä¸€ä¸ªè¡¨ç›¸åŒè§¦å‘æ—¶é—´çš„ç›¸åŒè§¦å‘äº‹ä»¶ï¼Œåªèƒ½å®šä¹‰ä¸€ä¸ªè§¦å‘å™¨\n# åˆ«åOLD.å’ŒNEW.æ¥å¼•ç”¨è§¦å‘å™¨ä¸­å‘ç”Ÿå˜åŒ–çš„è®°å½•å†…å®¹ï¼Œè§¦å‘å™¨åªæ”¯æŒè¡Œçº§è§¦å‘çš„ï¼Œä¸æ”¯æŒè¯­å¥çº§è§¦å‘\n# å¯¹äºæœ‰é‡å¤è®°å½•ï¼Œéœ€è¦è¿›è¡ŒUPDATEæ“ä½œçš„INSERTï¼Œè§¦å‘é¡ºåºæ˜¯BEFORE INSERTã€BEFORE UPDATEã€AFTER UPDATE\n# å¯¹äºæ²¡æœ‰é‡å¤è®°å½•çš„INSERTï¼Œè§¦å‘é¡ºåºæ˜¯ BEFORE INSERTã€AFTER INSERT\n# å¯¹äºé‚£äº›å®é™…æ‰§è¡Œ UPDATE æ“ä½œçš„è®°å½•ï¼Œä»ç„¶ä¼šæ‰§è¡Œ BEFORE INSERT è§¦å‘å™¨çš„å†…å®¹\nmysql&gt; CREATE TRIGGER trigger_name trigger_time trigger_event ON tbl_name FOR EACH ROW trigger_stmt\n  \n# åˆ é™¤è§¦å‘å™¨\nmysql&gt; DROP TRIGGER [æ•°æ®åº“.]trigger_name\n\n# æŸ¥è¯¢æŒ‡å®šè§¦å‘å™¨çš„æŒ‡å®šä¿¡æ¯\nmysql&gt; select * from information_schema.triggers where trigger_name = 'ins_film_bef'\n\n# è§¦å‘å™¨çš„ä½¿ç”¨\n# è§¦å‘ç¨‹åºä¸èƒ½è°ƒç”¨å°†æ•°æ®è¿”å›å®¢æˆ·ç«¯çš„å­˜å‚¨ç¨‹åºï¼Œä¸èƒ½ä½¿ç”¨é‡‡ç”¨CALLè¯­å¥çš„åŠ¨æ€SQLï¼Œä½†æ˜¯å…è®¸å­˜å‚¨ç¨‹åºé€šè¿‡å‚æ•°å°†æ•°æ®è¿”å›è§¦å‘ç¨‹åºã€‚ä¹Ÿå°±æ˜¯å­˜å‚¨è¿‡ç¨‹æˆ–è€…å‡½æ•°é€šè¿‡OUTæˆ–è€…INOUTç±»å‹çš„å‚æ•°å°†æ•°æ®è¿”å›è§¦å‘å™¨æ˜¯å¯ä»¥çš„ï¼Œä½†æ˜¯ä¸èƒ½è°ƒç”¨ç›´æ¥è¿”å›æ•°æ®çš„è¿‡ç¨‹\n# ä¸èƒ½åœ¨è§¦å‘å™¨ä¸­ä½¿ç”¨ä»¥æ˜¾å¼æˆ–éšå¼æ–¹å¼å¼€å§‹æˆ–ç»“æŸäº‹åŠ¡çš„è¯­å¥ï¼Œå¦‚ START TRANSACTIONã€COMMIT æˆ– ROLLBACKã€‚\n# è§¦å‘å™¨æ˜¯æŒ‰ç…§ BEFOREè§¦å‘å™¨ã€è¡Œæ“ä½œã€AFTERè§¦å‘å™¨çš„é¡ºåºæ‰§è¡Œçš„ï¼Œå…¶ä¸­ä»»ä½•ä¸€æ­¥æ“ä½œå‘ç”Ÿé”™è¯¯éƒ½ä¸ä¼šç»§ç»­æ‰§è¡Œå‰©ä¸‹çš„æ“ä½œã€‚å¦‚æœæ˜¯å¯¹äº‹åŠ¡è¡¨è¿›è¡Œçš„æ“ä½œï¼Œé‚£ä¹ˆä¼šæ•´ä¸ªä½œä¸ºä¸€ä¸ªäº‹åŠ¡è¢«å›æ»šï¼ˆRollbackï¼‰ï¼Œä½†æ˜¯å¦‚æœæ˜¯å¯¹éäº‹åŠ¡è¡¨è¿›è¡Œçš„æ“ä½œï¼Œé‚£ä¹ˆå·²ç»æ›´æ–°çš„è®°å½•å°†æ— æ³•å›æ»š\n</code></pre></div><h1>8. MySQLå­˜å‚¨å¼•æ“</h1>\n<h2>8.1. MySQLå­˜å‚¨å¼•æ“ç‰¹æ€§</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ab7895c0171c95bd93cf1.png\" alt=\"å„ç§å­˜å‚¨å¼•æ“.PNG\" tabindex=\"0\"><figcaption>å„ç§å­˜å‚¨å¼•æ“.PNG</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># æŸ¥çœ‹mysqlé»˜è®¤å­˜å‚¨å¼•æ“\nmysql&gt; show variables like 'table_type';\n# æŸ¥çœ‹å½“å‰æ•°æ®åº“æ”¯æŒçš„å­˜å‚¨å¼•æ“\nmysql&gt; SHOW ENGINESæˆ–è€…SHOW VARIABLES LIKE 'have%'\n</code></pre></div><h2>8.2. MyISAM</h2>\n<ul>\n<li>æ•°æ®æ–‡ä»¶å’Œç´¢å¼•æ–‡ä»¶å¯ä»¥æ”¾ç½®åœ¨ä¸åŒçš„ç›®å½•ï¼Œå¹³å‡åˆ†å¸ƒIOï¼Œè·å¾—æ›´å¿«çš„é€Ÿåº¦ã€‚éœ€è¦åœ¨å»ºè¡¨æ—¶é€šè¿‡ DATA DIRECTORY å’Œ INDEX DIRECTORY è¯­å¥æŒ‡å®šæŒ‡å®šç´¢å¼•æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶çš„ç»å¯¹è·¯å¾„</li>\n<li>MyISAMç±»å‹çš„è¡¨å¯èƒ½ä¼šæŸåï¼Œå¯ä»¥ç”¨CHECK TABLEæ£€æŸ¥MyISAMè¡¨ï¼Œå¹¶ç”¨REPAIR TABLEä¿®å¤ä¸€ä¸ªæŸåçš„MyISAMè¡¨ã€‚è¡¨æŸåå¯èƒ½å¯¼è‡´æ•°æ®åº“å¼‚å¸¸é‡æ–°å¯åŠ¨ï¼Œéœ€è¦å°½å¿«ä¿®å¤å¹¶å°½å¯èƒ½åœ°ç¡®è®¤æŸåçš„åŸå› </li>\n<li>MyISAMè¡¨æ”¯æŒ3ç§ä¸åŒçš„å­˜å‚¨æ ¼å¼ï¼Œ\n<ul>\n<li>é™æ€è¡¨ï¼ˆé»˜è®¤ï¼‰:æ¯ä¸ªè®°å½•é•¿åº¦å›ºå®šã€‚ä¼˜ç‚¹æ˜¯å­˜å‚¨é€Ÿåº¦å¿«ï¼Œå®¹æ˜“ç¼“å­˜ï¼Œæ•…éšœæ¢å¤å®¹æ˜“ï¼›ç¼ºç‚¹æ˜¯å ç”¨çš„ç©ºé—´é€šå¸¸æ¯”åŠ¨æ€è¡¨å¤šã€‚æ•°æ®åœ¨å­˜å‚¨çš„æ—¶å€™ä¼šæŒ‰ç…§åˆ—çš„å®½åº¦å®šä¹‰è¡¥è¶³ç©ºæ ¼ï¼Œä½†æ˜¯åœ¨åº”ç”¨è®¿é—®çš„æ—¶å€™å¹¶ä¸ä¼šå¾—åˆ°è¿™äº›ç©ºæ ¼ï¼Œè¿™äº›ç©ºæ ¼åœ¨è¿”å›ç»™åº”ç”¨ä¹‹å‰å·²ç»å»æ‰ã€‚å¦‚æœéœ€è¦ä¿å­˜çš„å†…å®¹åé¢æœ¬æ¥å°±å¸¦æœ‰ç©ºæ ¼ï¼Œé‚£ä¹ˆåœ¨è¿”å›ç»“æœçš„æ—¶å€™ä¹Ÿä¼šè¢«å»æ‰</li>\n<li>åŠ¨æ€è¡¨:åŒ…å«å˜é•¿å­—æ®µï¼Œä¼˜ç‚¹æ˜¯å ç”¨çš„ç©ºé—´ç›¸å¯¹å°‘ï¼Œä½†æ˜¯é¢‘ç¹åœ°æ›´æ–°åˆ é™¤è®°å½•ä¼šäº§ç”Ÿç¢ç‰‡ï¼Œéœ€è¦å®šæœŸæ‰§è¡ŒOPTIMIZE TABLEæˆ–myisamchk -ræ”¹å–„æ€§èƒ½ï¼Œæ•…éšœæ¢å¤å›°éš¾</li>\n<li>å‹ç¼©è¡¨ã€‚ç”±myisampackå·¥å…·åˆ›å»ºï¼Œå æ®éå¸¸å°çš„ç£ç›˜ç©ºé—´ã€‚å› ä¸ºæ¯ä¸ªè®°å½•æ˜¯è¢«å•ç‹¬å‹ç¼©çš„ï¼Œæ‰€ä»¥åªæœ‰éå¸¸å°çš„è®¿é—®å¼€æ”¯</li>\n</ul>\n</li>\n<li>Myisam ç”¨ B+Tree æ¥å­˜å‚¨æ•°æ®çš„ã€‚</li>\n</ul>\n<h2>8.3. InnoDB</h2>\n<ul>\n<li>\n<p>è‡ªåŠ¨å¢é•¿åˆ—</p>\n<ul>\n<li>æ’å…¥å€¼å¦‚æœæ˜¯ç©ºæˆ–è€…0ï¼Œåˆ™å®é™…æ’å…¥çš„å°†æ˜¯è‡ªåŠ¨å¢é•¿åçš„å€¼ã€‚å¦‚æœæŒ‡å®šäº†å…·ä½“å€¼ï¼Œä¸”å°äºè‡ªå¢å€¼ï¼Œåˆ™è‡ªå¢å€¼ä¸å˜ï¼›å¤§äºç­‰äºè‡ªå¢å€¼ï¼Œåˆ™è‡ªå¢å€¼ä¿®æ”¹ä¸ºå…·ä½“å€¼</li>\n<li>è‡ªå¢å€¼ç”Ÿæˆç®—æ³•ï¼šä»auto_increment_offsetåˆå§‹å€¼å¼€å§‹ï¼Œä»¥auto_increment_incrementä¸ºæ­¥é•¿ï¼ŒæŒç»­å åŠ </li>\n<li>ALTER TABLE *** AUTO_INCREMENT = n;åœ¨å†…å­˜ä¸­è®¾ç½®è‡ªåŠ¨å¢é•¿åˆ—çš„åˆå§‹å€¼ï¼Œé»˜è®¤ä»1å¼€å§‹ï¼Œå¦‚æœæ•°æ®åº“é‡å¯ï¼Œé‚£ä¹ˆè¿™ä¸ªå€¼å°±ä¼šä¸¢å¤±ï¼Œéœ€è¦é‡æ–°è®¾ç½®ã€‚å¯ä½¿ç”¨LAST_INSERT_ID()æŸ¥è¯¢å½“å‰çº¿ç¨‹æœ€åæ’å…¥è®°å½•ä½¿ç”¨çš„å€¼ã€‚å¦‚æœä¸€æ¬¡æ’å…¥äº†å¤šæ¡è®°å½•ï¼Œé‚£ä¹ˆè¿”å›çš„æ˜¯ç¬¬ä¸€æ¡è®°å½•ä½¿ç”¨çš„è‡ªåŠ¨å¢é•¿å€¼ã€‚å¯¹äºInnoDBï¼Œè‡ªåŠ¨å¢é•¿åˆ—å¿…é¡»æ˜¯ç´¢å¼•ã€‚å¦‚æœæ˜¯ç»„åˆç´¢å¼•ï¼Œä¹Ÿå¿…é¡»æ˜¯ç»„åˆç´¢å¼•çš„ç¬¬ä¸€åˆ—ï¼Œå¯¹äºMyISAMï¼Œè‡ªåŠ¨å¢é•¿åˆ—å¯ä»¥æ˜¯ç»„åˆç´¢å¼•çš„å…¶ä»–åˆ—ï¼Œè¿™æ ·æ’å…¥è®°å½•åï¼Œè‡ªåŠ¨å¢é•¿åˆ—æ˜¯æŒ‰ç…§ç»„åˆç´¢å¼•çš„å‰é¢å‡ åˆ—è¿›è¡Œæ’åºåé€’å¢çš„</li>\n</ul>\n</li>\n<li>\n<p>å¤–é”®çº¦æŸ:åœ¨åˆ›å»ºå¤–é”®çš„æ—¶å€™ï¼Œè¦æ±‚çˆ¶è¡¨å¿…é¡»æœ‰å¯¹åº”çš„ç´¢å¼•ï¼Œå­è¡¨åœ¨åˆ›å»ºå¤–é”®çš„æ—¶å€™ä¹Ÿä¼šè‡ªåŠ¨åˆ›å»ºå¯¹åº”çš„ç´¢å¼•ã€‚ä»…InnoDB å­˜å‚¨å¼•æ“æ”¯æŒå¯¹å¤–éƒ¨å…³é”®å­—çº¦æŸæ¡ä»¶çš„æ£€æŸ¥ã€‚å…¶ä»–ä¸æ”¯æŒï¼Œä»…èµ·å¤‡å¿˜ä½œç”¨</p>\n</li>\n<li>\n<p>å­˜å‚¨æ–¹å¼:InnoDB å­˜å‚¨è¡¨å’Œç´¢å¼•æœ‰ä»¥ä¸‹ä¸¤ç§æ–¹å¼ã€‚</p>\n<ul>\n<li>å…±äº«è¡¨ç©ºé—´å­˜å‚¨ï¼ˆinnodb_file_per_table=OFFï¼‰ï¼Œè¡¨ç»“æ„ä¿å­˜åœ¨.frm æ–‡ä»¶ä¸­ï¼Œæ•°æ®å’Œç´¢å¼•ä¿å­˜åœ¨ innodb_data_home_dirå’Œ innodb_data_file_pathå®šä¹‰çš„è¡¨ç©ºé—´ä¸­ï¼Œå¯ä»¥æ˜¯å¤šä¸ªæ–‡ä»¶ã€‚è¡¨åˆ æ‰ç©ºé—´ä¸å›æ”¶</li>\n<li>å¤šè¡¨ç©ºé—´å­˜å‚¨ï¼ˆinnodb_file_per_table=ONï¼‰ï¼Œè¡¨ç»“æ„ä¿å­˜åœ¨.frmæ–‡ä»¶ä¸­ï¼Œæ•°æ®å’Œç´¢å¼•å•ç‹¬ä¿å­˜åœ¨.ibdä¸­ã€‚å¦‚æœæ˜¯ä¸ªåˆ†åŒºè¡¨ï¼Œæ¯ä¸ªåˆ†åŒºä¿å­˜åœ¨è¡¨å+åˆ†åŒºå.ibdæ–‡ä»¶ï¼Œå¯ä»¥åœ¨åˆ›å»ºåˆ†åŒºçš„æ—¶å€™æŒ‡å®šæ¯ä¸ªåˆ†åŒºçš„æ•°æ®æ–‡ä»¶çš„ä½ç½®ï¼Œå°†è¡¨IOå‡åŒ€åˆ†å¸ƒåœ¨å¤šä¸ªç£ç›˜ä¸Šã€‚ä¿®æ”¹å¤šè¡¨ç©ºé—´çš„å‚æ•°innodb_file_per_tableå¹¶é‡å¯åï¼Œåªå¯¹æ–°å»ºçš„è¡¨ç”Ÿæ•ˆã€‚å³ä¾¿åœ¨å¤šè¡¨ç©ºé—´çš„å­˜å‚¨æ–¹å¼ä¸‹ï¼Œå…±äº«è¡¨ç©ºé—´ä»ç„¶æ˜¯å¿…é¡»çš„ï¼ŒInnoDBæŠŠå†…éƒ¨æ•°æ®è¯å…¸å’Œæœªä½œæ—¥å¿—æ”¾åœ¨è¿™ä¸ªæ–‡ä»¶ä¸­ã€‚è¡¨åˆ æ‰ç©ºé—´å›æ”¶</li>\n</ul>\n</li>\n<li>\n<p>InnoDB é€šè¿‡ B+Tree ç»“æ„å¯¹ ID å»ºç´¢å¼•ï¼Œç„¶ååœ¨å¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨è®°å½•ã€‚</p>\n</li>\n<li>\n<p>è‹¥å»ºç´¢å¼•çš„å­—æ®µä¸æ˜¯ä¸»é”® IDï¼Œåˆ™å¯¹è¯¥å­—æ®µå»ºç´¢å¼•ï¼Œç„¶ååœ¨å¶å­èŠ‚ç‚¹ä¸­å­˜å‚¨çš„æ˜¯è¯¥è®°å½•çš„ä¸»é”®ï¼Œç„¶åé€šè¿‡ä¸»é”®ç´¢å¼•æ‰¾åˆ°å¯¹åº”çš„è®°å½•ã€‚</p>\n</li>\n</ul>\n<h2>8.4. MEMORY</h2>\n<ul>\n<li>MEMORYä½¿ç”¨å­˜åœ¨å†…å­˜ä¸­çš„å†…å®¹æ¥åˆ›å»ºè¡¨ã€‚å­˜å‚¨ä¸ºä¸€ä¸ªç£ç›˜æ–‡ä»¶.frmã€‚è®¿é—®é€Ÿåº¦å¿«</li>\n<li>MySQLå¯åŠ¨æ—¶ä½¿ç”¨--init-fileé€‰é¡¹ï¼ŒæŠŠINSERT INTO ... SELECT æˆ– LOAD DATA INFILEæ”¾å…¥è¿™ä¸ªæ–‡ä»¶ä¸­ï¼Œå°±å¯ä»¥åœ¨æœåŠ¡å¯åŠ¨æ—¶ä»æŒä¹…ç¨³å›ºçš„æ•°æ®æºè£…è½½è¡¨</li>\n<li>é‡Šæ”¾è¢«MEMORYè¡¨ä½¿ç”¨çš„å†…å­˜ï¼Œæ‰§è¡ŒDELETE FROMæˆ–TRUNCATE TABLEï¼Œæˆ–è€…æ•´ä¸ªåœ°åˆ é™¤è¡¨ï¼ˆä½¿ç”¨ DROP TABLE æ“ä½œï¼‰ã€‚</li>\n<li>max_heap_table_sizeè¡¨ç¤ºæ¯ä¸ªMEMORYè¡¨ä¸­å¯ä»¥æ”¾ç½®çš„æ•°æ®é‡çš„å¤§å°</li>\n</ul>\n<h2>8.5. InnoDBä¸MEMORYåŒºåˆ«</h2>\n<ul>\n<li>InnoDBå¼•æ“æŠŠæ•°æ®æ”¾åœ¨ä¸»é”®ç´¢å¼•ä¸Šï¼Œå…¶ä»–ç´¢å¼•ä¸Šä¿å­˜çš„æ˜¯ä¸»é”®idã€‚ç§°ä¹‹ä¸ºç´¢å¼•ç»„ç»‡è¡¨ï¼ˆIndexOrganizied Tableï¼‰ã€‚Memoryå¼•æ“é‡‡ç”¨çš„æ˜¯æŠŠæ•°æ®å•ç‹¬å­˜æ”¾ï¼Œç´¢å¼•ä¸Šä¿å­˜æ•°æ®ä½ç½®çš„æ•°æ®ç»„ç»‡å½¢å¼ï¼Œæˆ‘ä»¬ç§°ä¹‹ä¸ºå †ç»„ç»‡è¡¨ï¼ˆHeapOrganizied Tableï¼‰ã€‚</li>\n<li>å½“æ•°æ®æ–‡ä»¶æœ‰ç©ºæ´çš„æ—¶å€™ï¼ŒInnoDBè¡¨åœ¨æ’å…¥æ–°æ•°æ®çš„æ—¶å€™ï¼Œä¸ºäº†ä¿è¯æ•°æ®æœ‰åºæ€§ï¼Œåªèƒ½åœ¨å›ºå®šçš„ä½ç½®å†™å…¥æ–°å€¼ï¼Œå†…å­˜è¡¨æ‰¾åˆ°ç©ºä½å°±å¯ä»¥æ’å…¥æ–°å€¼ï¼›å†…å­˜è¡¨æ¯ä¸ªæ•°æ®è¡Œè¢«åˆ é™¤ä»¥åï¼Œç©ºå‡ºçš„è¿™ä¸ªä½ç½®éƒ½å¯ä»¥è¢«æ¥ä¸‹æ¥è¦æ’å…¥çš„æ•°æ®å¤ç”¨ã€‚</li>\n<li>æ•°æ®ä½ç½®å‘ç”Ÿå˜åŒ–çš„æ—¶å€™ï¼ŒInnoDBè¡¨åªéœ€è¦ä¿®æ”¹ä¸»é”®ç´¢å¼•ï¼Œå†…å­˜è¡¨éœ€è¦ä¿®æ”¹æ‰€æœ‰ç´¢å¼•ï¼›</li>\n<li>InnoDBè¡¨ç”¨ä¸»é”®ç´¢å¼•æŸ¥è¯¢æ—¶éœ€è¦èµ°ä¸€æ¬¡ç´¢å¼•æŸ¥æ‰¾ï¼Œç”¨æ™®é€šç´¢å¼•æŸ¥è¯¢çš„æ—¶å€™ï¼Œéœ€è¦èµ°ä¸¤æ¬¡ç´¢å¼•æŸ¥æ‰¾ã€‚è€Œå†…å­˜è¡¨æ²¡æœ‰è¿™ä¸ªåŒºåˆ«ï¼Œæ‰€æœ‰ç´¢å¼•çš„â€œåœ°ä½â€éƒ½æ˜¯ç›¸åŒçš„ã€‚</li>\n</ul>\n<h1>9. MEMORYè¡¨</h1>\n<ul>\n<li>å†…å­˜ä¸´æ—¶è¡¨æ’åºçš„æ—¶å€™ä½¿ç”¨äº†rowidæ’åºæ–¹æ³•</li>\n<li>å¦‚æœå†…å­˜ä¸´æ—¶è¡¨å¤§å°è¶…è¿‡äº†tmp_table_sizeï¼Œé‚£ä¹ˆå†…å­˜ä¸´æ—¶è¡¨å°±ä¼šè½¬æˆç£ç›˜ä¸´æ—¶è¡¨ã€‚ç£ç›˜ä¸´æ—¶è¡¨ä½¿ç”¨çš„å¼•æ“é»˜è®¤æ˜¯InnoDBï¼Œæ˜¯ç”±å‚æ•°internal_tmp_disk_storage_engineæ§åˆ¶çš„ã€‚å½“ä½¿ç”¨ç£ç›˜ä¸´æ—¶è¡¨çš„æ—¶å€™ï¼Œå¯¹åº”çš„å°±æ˜¯ä¸€ä¸ªæ²¡æœ‰æ˜¾å¼ç´¢å¼•çš„InnoDBè¡¨çš„æ’åºè¿‡ç¨‹ã€‚</li>\n<li>ä¸å»ºè®®ä½ åœ¨ç”Ÿäº§ç¯å¢ƒä¸Šä½¿ç”¨å†…å­˜è¡¨ã€‚\n<ul>\n<li>å†…å­˜è¡¨çš„é”æ˜¯è¡¨é”</li>\n<li>æ•°æ®æ²¡æœ‰æŒä¹…åŒ–</li>\n</ul>\n</li>\n<li>å†…å­˜ä¸´æ—¶è¡¨åˆšå¥½å¯ä»¥æ— è§†å†…å­˜è¡¨çš„ä¸¤ä¸ªä¸è¶³\n<ul>\n<li>ä¸´æ—¶è¡¨ä¸ä¼šè¢«å…¶ä»–çº¿ç¨‹è®¿é—®ï¼Œæ²¡æœ‰å¹¶å‘æ€§çš„é—®é¢˜ï¼›</li>\n<li>ä¸´æ—¶è¡¨é‡å¯åä¹Ÿæ˜¯éœ€è¦åˆ é™¤çš„ï¼Œæ¸…ç©ºæ•°æ®è¿™ä¸ªé—®é¢˜ä¸å­˜åœ¨ï¼›</li>\n<li>å¤‡åº“çš„ä¸´æ—¶è¡¨ä¹Ÿä¸ä¼šå½±å“ä¸»åº“çš„ç”¨æˆ·çº¿ç¨‹ã€‚</li>\n<li>å†…å­˜è¡¨æ”¯æŒhashç´¢å¼•ï¼Œå¯¹å¤æ‚æŸ¥è¯¢çš„åŠ é€Ÿæ•ˆæœè¿˜æ˜¯å¾ˆä¸é”™çš„ã€‚</li>\n</ul>\n</li>\n<li>æ€ä¹ˆé¿å…å†…å­˜è¡¨çªç„¶ä¸¢æ•°æ®ï¼Œç„¶åå¯¼è‡´ä¸»å¤‡åŒæ­¥åœæ­¢çš„æƒ…å†µã€‚å‡è®¾ä¸»åº“æš‚æ—¶ä¸èƒ½ä¿®æ”¹å¼•æ“ï¼Œ\n<ul>\n<li>å…ˆæŠŠå¤‡åº“çš„å†…å­˜è¡¨å¼•æ“å…ˆéƒ½æ”¹æˆInnoDBã€‚å¯¹äºæ¯ä¸ªå†…å­˜è¡¨ï¼Œæ‰§è¡Œset sql_log_bin=off;alter table tbl_name engine=innodb;é¿å…å¤‡åº“é‡å¯çš„æ—¶å€™ï¼Œæ•°æ®ä¸¢å¤±çš„é—®é¢˜ã€‚ç”±äºä¸»åº“é‡å¯åï¼Œä¼šå¾€binlogé‡Œé¢å†™â€œdelete from tbl_nameâ€ï¼Œè¿™ä¸ªå‘½ä»¤ä¼ åˆ°å¤‡åº“ï¼Œå¤‡åº“çš„åŒåçš„è¡¨æ•°æ®ä¹Ÿä¼šè¢«æ¸…ç©ºã€‚å› æ­¤ï¼Œå°±ä¸ä¼šå‡ºç°ä¸»å¤‡åŒæ­¥åœæ­¢çš„é—®é¢˜ã€‚</li>\n<li>å¦‚æœç”±äºä¸»åº“å¼‚å¸¸é‡å¯ï¼Œè§¦å‘äº†HAï¼Œè¿™æ—¶å€™æˆ‘ä»¬ä¹‹å‰ä¿®æ”¹è¿‡å¼•æ“çš„å¤‡åº“å˜æˆäº†ä¸»åº“ã€‚è€ŒåŸæ¥çš„ä¸»åº“å˜æˆäº†æ–°å¤‡åº“ï¼Œåœ¨æ–°å¤‡åº“ä¸ŠæŠŠæ‰€æœ‰çš„å†…å­˜è¡¨ï¼ˆè¿™æ—¶å€™è¡¨é‡Œæ²¡æ•°æ®ï¼‰éƒ½æ”¹æˆInnoDBè¡¨ã€‚æ‰€ä»¥ï¼Œå¦‚æœæˆ‘ä»¬ä¸èƒ½ç›´æ¥ä¿®æ”¹ä¸»åº“ä¸Šçš„è¡¨å¼•æ“ï¼Œå¯ä»¥é…ç½®ä¸€ä¸ªè‡ªåŠ¨å·¡æ£€çš„å·¥å…·ï¼Œåœ¨å¤‡åº“ä¸Šå‘ç°å†…å­˜è¡¨å°±æŠŠå¼•æ“æ”¹äº†ã€‚</li>\n<li>åŒæ—¶é¿å…åˆ›å»ºæ–°çš„å†…å­˜è¡¨ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>9.1. MERGE</h2>\n<ul>\n<li>MERGE å­˜å‚¨å¼•æ“æ˜¯ä¸€ç»„ MyISAM è¡¨çš„ç»„åˆï¼Œè¿™äº› MyISAM è¡¨å¿…é¡»ç»“æ„å®Œå…¨ç›¸åŒï¼ŒMERGEè¡¨æœ¬èº«å¹¶æ²¡æœ‰æ•°æ®</li>\n<li>å¯¹MERGEè¡¨çš„æ’å…¥æ“ä½œï¼Œæ˜¯é€šè¿‡INSERT_METHODå­å¥å®šä¹‰æ’å…¥çš„è¡¨ï¼Œä½¿ç”¨FIRSTæˆ–LASTå€¼ä½¿å¾—æ’å…¥æ“ä½œè¢«ç›¸åº”åœ°ä½œç”¨åœ¨ç¬¬ä¸€æˆ–æœ€åä¸€ä¸ªè¡¨ä¸Šï¼Œä¸å®šä¹‰è¿™ä¸ªå­å¥æˆ–è€…å®šä¹‰ä¸ºNOï¼Œè¡¨ç¤ºä¸èƒ½å¯¹è¿™ä¸ªMERGEè¡¨æ‰§è¡Œæ’å…¥æ“ä½œï¼Œå¯¹MERGEè¡¨çš„åˆ é™¤æ“ä½œï¼Œåªæ˜¯åˆ é™¤å®šä¹‰ï¼Œå¯¹å†…éƒ¨çš„è¡¨æ²¡æœ‰ä»»ä½•çš„å½±å“</li>\n<li>MERGEè¡¨åœ¨ç£ç›˜ä¸Šä¿ç•™ä¸¤ä¸ªæ–‡ä»¶ï¼Œæ–‡ä»¶å­˜å‚¨è¡¨å®šä¹‰.frm å’Œæ–‡ä»¶åŒ…å«ç»„åˆè¡¨çš„ä¿¡æ¯.MRG(ç”±å“ªäº›è¡¨ç»„æˆã€æ’å…¥æ–°çš„æ•°æ®æ—¶çš„ä¾æ®)</li>\n<li>MERGEè¡¨å¹¶ä¸èƒ½æ™ºèƒ½åœ°å°†è®°å½•å†™åˆ°å¯¹åº”çš„è¡¨ä¸­ï¼Œè€Œåˆ†åŒºè¡¨æ˜¯å¯ä»¥çš„ã€‚é€šå¸¸ä½¿ç”¨MERGEè¡¨æ¥å¯¹å¤šä¸ªè¡¨è¿›è¡ŒæŸ¥è¯¢å’Œæ›´æ–°æ“ä½œï¼Œè€Œå¯¹è¿™ç§æŒ‰ç…§æ—¶é—´è®°å½•çš„æ“ä½œæ—¥å¿—è¡¨åˆ™å¯ä»¥é€æ˜åœ°è¿›è¡Œæ’å…¥æ“ä½œã€‚</li>\n</ul>\n<h1>10. MySQLè¿æ¥</h1>\n<h2>10.1. é•¿è¿æ¥ä¸çŸ­è¿æ¥</h2>\n<ul>\n<li>\n<p>é•¿è¿æ¥æ˜¯æŒ‡è¿æ¥æˆåŠŸåï¼Œå¦‚æœå®¢æˆ·ç«¯æŒç»­æœ‰è¯·æ±‚ï¼Œåˆ™ä¸€ç›´ä½¿ç”¨åŒä¸€ä¸ªè¿æ¥ã€‚çŸ­è¿æ¥åˆ™æ˜¯æŒ‡æ¯æ¬¡æ‰§è¡Œå®Œå¾ˆå°‘çš„å‡ æ¬¡æŸ¥è¯¢å°±æ–­å¼€è¿æ¥ï¼Œä¸‹æ¬¡æŸ¥è¯¢å†é‡æ–°å»ºç«‹ä¸€ä¸ªã€‚</p>\n</li>\n<li>\n<p>æœ‰æ—¶å€™Mysqlå ç”¨å†…å­˜æ¶¨çš„å¾ˆå¿«çš„åŸå› å’Œè§£å†³æ–¹æ¡ˆï¼Ÿ å»ºç«‹è¿æ¥çš„è¿‡ç¨‹é€šå¸¸æ˜¯æ¯”è¾ƒå¤æ‚çš„ï¼Œåœ¨ä½¿ç”¨ä¸­è¦å°½é‡ä½¿ç”¨é•¿è¿æ¥ã€‚ä½†å¤ªå¤šé•¿è¿æ¥å¯èƒ½å¯¼è‡´å†…å­˜å ç”¨å¤ªå¤§ï¼Œè¢«ç³»ç»Ÿå¼ºè¡Œæ€æ‰ï¼ˆOOMï¼‰ï¼Œä»ç°è±¡çœ‹å°±æ˜¯MySQLå¼‚å¸¸é‡å¯äº†ã€‚è§£å†³æ–¹æ¡ˆ1.ä½¿ç”¨ä¸€æ®µæ—¶é—´ï¼Œæˆ–è€…ç¨‹åºé‡Œé¢åˆ¤æ–­æ‰§è¡Œè¿‡ä¸€ä¸ªå ç”¨å†…å­˜çš„å¤§æŸ¥è¯¢åï¼Œæ–­å¼€é•¿è¿æ¥ã€‚2.æ‰§è¡Œmysql_reset_connectionæ¥é‡æ–°åˆå§‹åŒ–è¿æ¥èµ„æºï¼Œæ— éœ€é‡è¿å’Œé‡æ–°åšæƒé™éªŒè¯(MySQL5.7ä»¥ä¸Š)</p>\n</li>\n<li>\n<p>MySQLå»ºç«‹è¿æ¥çš„è¿‡ç¨‹æˆæœ¬æ˜¯å¾ˆé«˜çš„ã€‚é™¤äº†æ­£å¸¸çš„ç½‘ç»œè¿æ¥ä¸‰æ¬¡æ¡æ‰‹å¤–ï¼Œè¿˜éœ€è¦åšç™»å½•æƒé™åˆ¤æ–­å’Œè·å¾—è¿™ä¸ªè¿æ¥çš„æ•°æ®è¯»å†™æƒé™ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœå®¢æˆ·ç«¯ç”±äºå‹åŠ›è¿‡å¤§ï¼Œè¿Ÿè¿Ÿä¸èƒ½æ¥æ”¶æ•°æ®ï¼Œä¼šå¯¹æœåŠ¡ç«¯é€ æˆä»€ä¹ˆä¸¥é‡çš„å½±å“ï¼Ÿæ ¸å¿ƒæ˜¯é€ æˆäº†â€œé•¿äº‹åŠ¡â€ã€‚å¦‚æœå‰é¢çš„è¯­å¥æœ‰æ›´æ–°ï¼Œæ„å‘³ç€å®ƒä»¬åœ¨å ç”¨ç€è¡Œé”ï¼Œä¼šå¯¼è‡´åˆ«çš„è¯­å¥æ›´æ–°è¢«é”ä½ï¼›å½“ç„¶è¯»çš„äº‹åŠ¡ä¹Ÿæœ‰é—®é¢˜ï¼Œå°±æ˜¯ä¼šå¯¼è‡´undo logä¸èƒ½è¢«å›æ”¶ï¼Œå¯¼è‡´å›æ»šæ®µç©ºé—´è†¨èƒ€</p>\n</li>\n</ul>\n<h1>11. MySQLç´¢å¼•</h1>\n<ul>\n<li>ç´¢å¼•æ˜¯ä¸€ç§ç”¨äºå¿«é€ŸæŸ¥è¯¢æ•°æ®çš„æ•°æ®ç»“æ„ï¼Œç”±å­˜å‚¨å¼•æ“å®ç°</li>\n</ul>\n<h2>11.2. ç´¢å¼•åˆ†ç±»</h2>\n<h3>11.2.1. æŒ‰ç‰©ç†å­˜å‚¨åˆ†ç±»</h3>\n<h4>11.2.1.1. èšç°‡ç´¢å¼•</h4>\n<ul>\n<li>èšç°‡ç´¢å¼•ï¼š\n<ul>\n<li>æŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œå› ä¸ºæ•´ä¸ªB+æ ‘æœ¬èº«å°±æ˜¯ä¸€é¢—å¤šå‰å¹³è¡¡æ ‘ï¼Œå¶å­èŠ‚ç‚¹ä¹Ÿéƒ½æ˜¯æœ‰åºçš„ï¼Œå®šä½åˆ°ç´¢å¼•çš„èŠ‚ç‚¹ï¼Œå°±ç›¸å½“äºå®šä½åˆ°äº†æ•°æ®</li>\n<li>ä¾èµ–äºæœ‰åºçš„æ•°æ® ï¼šå› ä¸ºB+æ ‘æ˜¯å¤šè·¯å¹³è¡¡æ ‘ï¼Œå¦‚æœç´¢å¼•çš„æ•°æ®ä¸æ˜¯æœ‰åºçš„ï¼Œé‚£ä¹ˆå°±éœ€è¦åœ¨æ’å…¥æ—¶æ’åºï¼Œå¦‚æœæ•°æ®æ˜¯æ•´å‹è¿˜å¥½ï¼Œå¦åˆ™ç±»ä¼¼äºå­—ç¬¦ä¸²æˆ– UUID è¿™ç§åˆé•¿åˆéš¾æ¯”è¾ƒçš„æ•°æ®ï¼Œæ’å…¥æˆ–æŸ¥æ‰¾çš„é€Ÿåº¦è‚¯å®šæ¯”è¾ƒæ…¢ã€‚</li>\n<li>æ›´æ–°ä»£ä»·å¤§ï¼šå¦‚æœå¯¹ç´¢å¼•åˆ—çš„æ•°æ®è¢«ä¿®æ”¹æ—¶ï¼Œé‚£ä¹ˆå¯¹åº”çš„ç´¢å¼•ä¹Ÿå°†ä¼šè¢«ä¿®æ”¹ï¼Œè€Œä¸”èšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹è¿˜å­˜æ”¾ç€æ•°æ®ï¼Œä¿®æ”¹ä»£ä»·è‚¯å®šæ˜¯è¾ƒå¤§çš„ï¼Œæ‰€ä»¥å¯¹äºä¸»é”®ç´¢å¼•æ¥è¯´ï¼Œä¸»é”®ä¸€èˆ¬éƒ½æ˜¯ä¸å¯è¢«ä¿®æ”¹çš„ã€‚</li>\n</ul>\n</li>\n</ul>\n<h4>11.2.1.2. éèšç°‡ç´¢å¼•</h4>\n<ul>\n<li>éèšé›†ç´¢å¼•ï¼š\n<ul>\n<li>æ›´æ–°ä»£ä»·æ¯”èšé›†ç´¢å¼•è¦å°ã€‚éèšé›†ç´¢å¼•çš„å¶å­èŠ‚ç‚¹æ˜¯ä¸å­˜æ”¾æ•°æ®çš„</li>\n<li>éèšé›†ç´¢å¼•ä¹Ÿä¾èµ–äºæœ‰åºçš„æ•°æ®</li>\n<li>å¯èƒ½ä¼šäºŒæ¬¡æŸ¥è¯¢ï¼ˆå›è¡¨ï¼‰å½“æŸ¥åˆ°ç´¢å¼•å¯¹åº”çš„æŒ‡é’ˆæˆ–ä¸»é”®åï¼Œå¯èƒ½è¿˜éœ€è¦æ ¹æ®æŒ‡é’ˆæˆ–ä¸»é”®å†åˆ°æ•°æ®æ–‡ä»¶æˆ–è¡¨ä¸­æŸ¥è¯¢</li>\n</ul>\n</li>\n</ul>\n<h3>11.2.2. æŒ‰å­—æ®µç‰¹æ€§åˆ†ç±»</h3>\n<h4>11.2.2.1. ä¸»é”®ç´¢å¼•</h4>\n<ul>\n<li>åœ¨InnoDBè¡¨ä¸­ï¼Œå½“æ²¡æœ‰æ˜¾ç¤ºçš„æŒ‡å®šè¡¨çš„ä¸»é”®æ—¶ï¼Œä¼šä½¿ç”¨å”¯ä¸€ç´¢å¼•ä¸”ä¸å…è®¸å­˜åœ¨nullå€¼çš„å­—æ®µä¸ºé»˜è®¤çš„ä¸»é”®ï¼Œå¦åˆ™InnoDBå°†ä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ª6Byteçš„rowidä½œä¸ºä¸»é”®</li>\n<li>è¾…åŠ©ç´¢å¼•ï¼ˆäºŒçº§ç´¢å¼•ï¼‰ï¼šå¶å­èŠ‚ç‚¹å­˜å‚¨çš„æ•°æ®æ˜¯ä¸»é”®</li>\n</ul>\n<h4>11.2.2.2. å”¯ä¸€æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•çš„åŒºåˆ«</h4>\n<ul>\n<li>æŸ¥è¯¢è¿‡ç¨‹ï¼šæŸ¥è¯¢æ—¶éƒ½æ˜¯é€šè¿‡B+æ ‘ä»æ ‘æ ¹å¼€å§‹ï¼ŒæŒ‰å±‚æœç´¢åˆ°å¶å­èŠ‚ç‚¹(æ•°æ®é¡µ)ï¼Œç„¶ååœ¨æ•°æ®é¡µå†…éƒ¨é€šè¿‡äºŒåˆ†æ³•æ¥å®šä½è®°å½•ã€‚å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼ŒæŸ¥æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„ç¬¬ä¸€ä¸ªè®°å½•åï¼Œä¸€ç›´æŸ¥æ‰¾ç›´åˆ°æ‰¾åˆ°ç¬¬ä¸€ä¸ªä¸æ»¡è¶³æ¡ä»¶çš„è®°å½•ï¼Œå¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼ŒæŸ¥æ‰¾åˆ°ç¬¬ä¸€ä¸ªæ»¡è¶³æ¡ä»¶çš„è®°å½•åï¼Œå°±ä¼šåœæ­¢ç»§ç»­æ£€ç´¢ã€‚ç”±äºInnoDBçš„æ•°æ®æ˜¯æŒ‰æ•°æ®é¡µä¸ºå•ä½(é»˜è®¤æ˜¯16KB)æ¥è¯»å†™çš„ã€‚å½“æ‰¾åˆ°æ»¡è¶³æ¡ä»¶çš„è®°å½•çš„æ—¶å€™ï¼Œå®ƒæ‰€åœ¨çš„æ•°æ®é¡µå°±éƒ½åœ¨å†…å­˜é‡Œäº†ã€‚å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼Œå¤šä¸€æ¬¡æŸ¥æ‰¾å’Œåˆ¤æ–­ä¸‹ä¸€æ¡è®°å½•çš„æ“ä½œï¼Œå°±åªéœ€è¦ä¸€æ¬¡æŒ‡é’ˆå¯»æ‰¾å’Œä¸€æ¬¡è®¡ç®—ï¼Œå½“å¦‚æœæ»¡è¶³æ¡ä»¶çš„è®°å½•åˆšå¥½æ˜¯è¿™ä¸ªæ•°æ®é¡µçš„æœ€åä¸€ä¸ªè®°å½•ï¼Œé‚£ä¹ˆè¦å–ä¸‹ä¸€ä¸ªè®°å½•ï¼Œå¿…é¡»è¯»å–ä¸‹ä¸€ä¸ªæ•°æ®é¡µï¼Œä½†æ˜¯ï¼Œå¯¹äºæ•´å‹å­—æ®µï¼Œä¸€ä¸ªæ•°æ®é¡µå¯ä»¥æ”¾è¿‘åƒä¸ªkeyï¼Œå› æ­¤å‡ºç°æ¦‚ç‡ä½ã€‚è®¡ç®—å¹³å‡æ€§èƒ½å·®å¼‚æ—¶ï¼Œå¯¹äºCPUæ¥è¯´å¯å¿½ç•¥ä¸è®¡</li>\n<li>æ›´æ–°è¿‡ç¨‹ï¼šå½“éœ€è¦æ›´æ–°ä¸€ä¸ªæ•°æ®é¡µæ—¶ï¼Œå¦‚æœæ•°æ®é¡µåœ¨å†…å­˜ä¸­å°±ç›´æ¥æ›´æ–°ï¼Œè€Œå¦‚æœè¿™ä¸ªæ•°æ®é¡µè¿˜æ²¡æœ‰åœ¨å†…å­˜ä¸­çš„è¯ï¼Œåœ¨ä¸å½±å“æ•°æ®ä¸€è‡´æ€§çš„å‰æä¸‹ï¼ŒInooDBä¼šå°†è¿™äº›æ›´æ–°æ“ä½œç¼“å­˜åœ¨change bufferä¸­ï¼Œè¿™æ ·å°±ä¸éœ€è¦ä»ç£ç›˜ä¸­è¯»å…¥è¿™ä¸ªæ•°æ®é¡µäº†ã€‚åœ¨ä¸‹æ¬¡æŸ¥è¯¢éœ€è¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µçš„æ—¶å€™ï¼Œå°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œç„¶åæ‰§è¡Œchange bufferä¸­ä¸è¿™ä¸ªé¡µæœ‰å…³çš„æ“ä½œã€‚ä¿è¯è¿™ä¸ªæ•°æ®é€»è¾‘çš„æ­£ç¡®æ€§</li>\n<li>change bufferåœ¨å†…å­˜ä¸­æœ‰æ‹·è´ï¼Œä¹Ÿä¼šè¢«å†™å…¥åˆ°ç£ç›˜ä¸Šã€‚å°†change bufferä¸­çš„æ“ä½œåº”ç”¨åˆ°åŸæ•°æ®é¡µï¼Œå¾—åˆ°æœ€æ–°ç»“æœçš„è¿‡ç¨‹ç§°ä¸ºmergeã€‚æ•°æ®é¡µè¢«è®¿é—®ã€ç³»ç»Ÿåå°çº¿ç¨‹å®šæ—¶ä»»åŠ¡ã€åœ¨æ•°æ®åº“æ­£å¸¸å…³é—­éƒ½ä¼šmergeã€‚å¦‚æœèƒ½å¤Ÿå°†æ›´æ–°æ“ä½œå…ˆè®°å½•åœ¨change bufferï¼Œå‡å°‘è¯»ç£ç›˜ï¼Œè¯­å¥çš„æ‰§è¡Œé€Ÿåº¦ä¼šå¾—åˆ°æ˜æ˜¾çš„æå‡ã€‚è€Œä¸”ï¼Œæ•°æ®è¯»å…¥å†…å­˜æ˜¯éœ€è¦å ç”¨buffer poolçš„ï¼Œæ‰€ä»¥è¿™ç§æ–¹å¼è¿˜èƒ½å¤Ÿé¿å…å ç”¨å†…å­˜ï¼Œæé«˜å†…å­˜åˆ©ç”¨ç‡</li>\n<li>å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œæ‰€æœ‰çš„æ›´æ–°æ“ä½œéƒ½è¦å…ˆåˆ¤æ–­æ˜¯å¦è¿åå”¯ä¸€æ€§çº¦æŸã€‚å¿…é¡»è¦å°†æ•°æ®é¡µè¯»å…¥å†…å­˜æ‰èƒ½åˆ¤æ–­ã€‚å› æ­¤ï¼Œå”¯ä¸€ç´¢å¼•çš„æ›´æ–°å°±ä¸èƒ½ä½¿ç”¨change bufferï¼Œåªæœ‰æ™®é€šç´¢å¼•èƒ½ä½¿ç”¨</li>\n<li>change bufferç”¨çš„æ˜¯buffer poolé‡Œçš„å†…å­˜ï¼Œinnodb_change_buffer_max_sizeè¡¨ç¤ºchange bufferæœ€å¤§å ç”¨buffer poolçš„ç™¾åˆ†æ¯”</li>\n<li>å¦‚æœè¦åœ¨è¡¨ä¸­æ’å…¥ä¸€ä¸ªæ–°è®°å½•çš„è¯ï¼ŒInnoDBçš„å¤„ç†æµç¨‹\n<ul>\n<li>1.è¿™ä¸ªè®°å½•è¦æ›´æ–°çš„ç›®æ ‡é¡µåœ¨å†…å­˜ä¸­ã€‚å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œæ‰¾åˆ°3å’Œ5ä¹‹é—´çš„ä½ç½®ï¼Œåˆ¤æ–­åˆ°æ²¡æœ‰å†²çªï¼Œæ’å…¥è¿™ä¸ªå€¼ï¼Œè¯­å¥æ‰§è¡Œç»“æŸï¼›å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼Œæ‰¾åˆ°3å’Œ5ä¹‹é—´çš„ä½ç½®ï¼Œæ’å…¥è¿™ä¸ªå€¼ï¼Œè¯­å¥æ‰§è¡Œç»“æŸã€‚æ™®é€šç´¢å¼•å’Œå”¯ä¸€ç´¢å¼•å¯¹æ›´æ–°è¯­å¥æ€§èƒ½å½±å“çš„å·®åˆ«ï¼Œåªæ˜¯ä¸€ä¸ªåˆ¤æ–­ï¼Œåªä¼šè€—è´¹å¾®å°çš„CPUæ—¶é—´ã€‚</li>\n<li>2.è¿™ä¸ªè®°å½•è¦æ›´æ–°çš„ç›®æ ‡é¡µä¸åœ¨å†…å­˜ä¸­ã€‚å¯¹äºå”¯ä¸€ç´¢å¼•æ¥è¯´ï¼Œéœ€è¦å°†æ•°æ®é¡µè¯»å…¥å†…å­˜ï¼Œåˆ¤æ–­åˆ°æ²¡æœ‰å†²çªï¼Œæ’å…¥è¿™ä¸ªå€¼ï¼Œè¯­å¥æ‰§è¡Œç»“æŸï¼›å¯¹äºæ™®é€šç´¢å¼•æ¥è¯´ï¼Œåˆ™æ˜¯å°†æ›´æ–°è®°å½•åœ¨change bufferï¼Œè¯­å¥æ‰§è¡Œå°±ç»“æŸäº†ã€‚å°†æ•°æ®ä»ç£ç›˜è¯»å…¥å†…å­˜æ¶‰åŠéšæœºIOçš„è®¿é—®ã€‚change bufferå› ä¸ºå‡å°‘äº†éšæœºç£ç›˜è®¿é—®ï¼Œæ‰€ä»¥å¯¹æ›´æ–°æ€§èƒ½çš„æå‡æ˜æ˜¾</li>\n</ul>\n</li>\n<li>change bufferçš„ä½¿ç”¨åœºæ™¯\n<ul>\n<li>å¯¹æ™®é€šç´¢å¼•å†™å¤šè¯»å°‘çš„æ›´æ–°è¿‡ç¨‹æœ‰åŠ é€Ÿä½œç”¨(è´¦å•ç±»ï¼Œæ—¥å¿—ç±»ç³»ç»Ÿ)ï¼Œè€Œä¸é€‚ç”¨äºå”¯ä¸€ç´¢å¼•ã€‚åè¿‡æ¥ï¼Œå‡è®¾ä¸€ä¸ªä¸šåŠ¡çš„æ›´æ–°æ¨¡å¼æ˜¯å†™å…¥ä¹‹åé©¬ä¸Šä¼šåšæŸ¥è¯¢ï¼Œé‚£ä¹ˆå³ä½¿æ»¡è¶³äº†æ¡ä»¶ï¼Œå°†æ›´æ–°å…ˆè®°å½•åœ¨change bufferï¼Œä½†ä¹‹åç”±äºé©¬ä¸Šè¦è®¿é—®è¿™ä¸ªæ•°æ®é¡µï¼Œä¼šç«‹å³è§¦å‘mergeè¿‡ç¨‹ã€‚è¿™æ ·éšæœºè®¿é—®IOçš„æ¬¡æ•°ä¸ä¼šå‡å°‘ï¼Œåè€Œå¢åŠ äº†change bufferçš„ç»´æŠ¤ä»£ä»·ã€‚</li>\n</ul>\n</li>\n<li>change bufferçš„æ“ä½œä¼šåœ¨äº‹åŠ¡æäº¤æ—¶è®°å½•åˆ°redo logï¼Œæ‰€ä»¥å´©æºƒæ¢å¤çš„æ—¶å€™ï¼Œchange bufferä¸ä¼šä¸¢å¤±æ•°æ®</li>\n<li>mergeçš„æ‰§è¡Œæµç¨‹\n<ul>\n<li>ä»ç£ç›˜è¯»å…¥æ•°æ®é¡µåˆ°å†…å­˜ï¼ˆè€ç‰ˆæœ¬çš„æ•°æ®é¡µï¼‰</li>\n<li>ä»change bufferé‡Œæ‰¾å‡ºè¿™ä¸ªæ•°æ®é¡µçš„change buffer è®°å½•(å¯èƒ½æœ‰å¤šä¸ªï¼‰ï¼Œä¾æ¬¡åº”ç”¨ï¼Œå¾—åˆ°æ–°ç‰ˆæ•°æ®é¡µ</li>\n<li>å†™redo logã€‚è¿™ä¸ªredo logåŒ…å«äº†æ•°æ®çš„å˜æ›´å’Œchange bufferçš„å˜æ›´</li>\n<li>æ•°æ®é¡µå’Œå†…å­˜ä¸­change bufferå¯¹åº”çš„ç£ç›˜ä½ç½®éƒ½è¿˜æ²¡æœ‰ä¿®æ”¹ï¼Œå±äºè„é¡µï¼Œä¹‹åå„è‡ªåˆ·å›è‡ªå·±çš„ç‰©ç†æ•°æ®</li>\n</ul>\n</li>\n</ul>\n<h3>11.2.3. æŒ‰ç´¢å¼•å­—æ®µä¸ªæ•°åˆ†ç±»</h3>\n<h4>11.2.3.1. å•åˆ—ç´¢å¼•</h4>\n<h4>11.2.3.2. ç»„åˆç´¢å¼•</h4>\n<ul>\n<li>ç»„åˆç´¢å¼• æ˜¯æŒ‡å¯¹è¡¨ä¸Šçš„å¤šä¸ªåˆ—è¿›è¡Œç´¢å¼•ã€‚è”åˆç´¢å¼•ä¹Ÿæ˜¯ä¸€æ£µB+æ ‘ï¼Œä¸åŒçš„æ˜¯è”åˆç´¢å¼•çš„é”®å€¼æ•°é‡ä¸æ˜¯1ï¼Œè€Œæ˜¯å¤§äºç­‰äº2</li>\n<li>whereæŸ¥è¯¢å­˜åœ¨å¤šä¸ªæ¡ä»¶æŸ¥è¯¢çš„æ—¶å€™ï¼Œæˆ‘ä»¬éœ€è¦å¯¹æŸ¥è¯¢çš„åˆ—åˆ›å»ºç»„åˆç´¢å¼•ã€‚è¿™æ ·å‡å°‘ç´¢å¼•å­˜å‚¨ç©ºé—´çš„å¼€é”€</li>\n<li>å¦‚ä½•å®‰æ’ç´¢å¼•å†…çš„å­—æ®µé¡ºåºï¼Ÿ\n<ul>\n<li>ç´¢å¼•çš„å¤ç”¨èƒ½åŠ›ã€‚å¦‚æœé€šè¿‡è°ƒæ•´é¡ºåºï¼Œå¯ä»¥å°‘ç»´æŠ¤ä¸€ä¸ªç´¢å¼•ï¼Œé‚£ä¹ˆè¿™ä¸ªé¡ºåºå¾€å¾€å°±æ˜¯éœ€è¦ä¼˜å…ˆè€ƒè™‘é‡‡ç”¨çš„</li>\n<li>ç©ºé—´ã€‚å¦‚æœæ—¢æœ‰è”åˆæŸ¥è¯¢ï¼Œåˆæœ‰åŸºäºaã€bå„è‡ªçš„æŸ¥è¯¢å‘¢ï¼Ÿè¿™æ—¶å€™ä½ ä¸å¾—ä¸éœ€è¦åŒæ—¶ç»´æŠ¤(a,b)ã€(b) è¿™ä¸¤ä¸ªç´¢å¼•ã€‚æœ€å¥½åœ¨é•¿åº¦è¾ƒå°çš„å­—æ®µä¸Šå»ºç«‹ç´¢å¼•</li>\n</ul>\n</li>\n</ul>\n<h2>11.3. ç´¢å¼•ä½¿ç”¨</h2>\n<h2>11.4. é‡å»ºç´¢å¼•</h2>\n<ul>\n<li>ç´¢å¼•å¯èƒ½å› ä¸ºåˆ é™¤ï¼Œæˆ–è€…é¡µåˆ†è£‚ç­‰åŸå› ï¼Œå¯¼è‡´æ•°æ®é¡µæœ‰ç©ºæ´ï¼Œé‡å»ºç´¢å¼•çš„è¿‡ç¨‹ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„ç´¢å¼•ï¼ŒæŠŠæ•°æ®æŒ‰é¡ºåºæ’å…¥ï¼Œè¿™æ ·é¡µé¢çš„åˆ©ç”¨ç‡æœ€é«˜ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•æ›´ç´§å‡‘ã€æ›´çœç©ºé—´</li>\n<li>é‡å»ºæ™®é€šç´¢å¼•k alter table T drop index k; alter table T add index(k);</li>\n<li>é‡å»ºä¸»é”®ç´¢å¼•id alter table T engine=InnoDB;</li>\n</ul>\n<h2>11.5. æŸ¥çœ‹ç´¢å¼•ä½¿ç”¨æƒ…å†µ</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># Handler_read_keyä»£è¡¨äº†ä¸€ä¸ªè¡Œè¢«ç´¢å¼•å€¼è¯»çš„æ¬¡æ•°ï¼Œå€¼è¶Šé«˜è¡¨ç¤ºç´¢å¼•ç»å¸¸ä½¿ç”¨\n# Handler_read_rnd_nextåœ¨æ•°æ®æ–‡ä»¶ä¸­è¯»ä¸‹ä¸€è¡Œçš„è¯·æ±‚æ•°ã€‚å€¼è¶Šé«˜è¡¨ç¤ºç´¢å¼•ä¸ç»å¸¸ä½¿ç”¨\nmysql&gt; show status like 'Handler_read%' \n</code></pre></div><h2>11.6. MySQLç´¢å¼•å®ç°</h2>\n<ul>\n<li>åœ¨MySQLä¸­ï¼Œç´¢å¼•æ˜¯åœ¨å­˜å‚¨å¼•æ“å±‚å®ç°çš„</li>\n<li>åœ¨InnoDBä¸­ï¼Œè¡¨éƒ½æ˜¯æ ¹æ®ä¸»é”®é¡ºåºä»¥ç´¢å¼•çš„å½¢å¼å­˜æ”¾çš„ï¼Œè¿™ç§å­˜å‚¨æ–¹å¼çš„è¡¨ç§°ä¸ºç´¢å¼•ç»„ç»‡è¡¨ã€‚InnoDBä½¿ç”¨äº†B+æ ‘ç´¢å¼•æ¨¡å‹ï¼Œæ‰€ä»¥æ•°æ®éƒ½æ˜¯å­˜å‚¨åœ¨B+æ ‘ä¸­çš„ã€‚æ¯ä¸€ä¸ªç´¢å¼•åœ¨InnoDBé‡Œé¢å¯¹åº”ä¸€æ£µB+æ ‘ã€‚</li>\n<li>æ ¹æ®å¶å­èŠ‚ç‚¹çš„å†…å®¹åˆ†ä¸ºä¸»é”®ç´¢å¼•å’Œéä¸»é”®ç´¢å¼•ã€‚ä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å­˜çš„æ˜¯æ•´è¡Œæ•°æ®ã€‚ç§°ä¸ºèšç°‡ç´¢å¼•ï¼ˆclustered indexï¼‰ã€‚éä¸»é”®ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å†…å®¹æ˜¯ä¸»é”®çš„å€¼ã€‚ç§°ä¸ºäºŒçº§ç´¢å¼•ï¼ˆsecondary indexï¼‰</li>\n<li>å¦‚æœæ˜¯ä¸»é”®æŸ¥è¯¢ï¼Œåˆ™åªéœ€è¦æœç´¢ä¸»é”®æ‰€åœ¨çš„B+æ ‘</li>\n<li>å¦‚æœæ™®é€šç´¢å¼•æŸ¥è¯¢æ–¹å¼ï¼Œåˆ™éœ€è¦å…ˆæœç´¢ç´¢å¼•æ ‘ï¼Œå¾—åˆ°ä¸»é”®çš„å€¼ï¼Œå†åˆ°ä¸»é”®æ‰€åœ¨çš„ç´¢å¼•æ ‘æœç´¢ä¸€æ¬¡ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºå›è¡¨ã€‚åŸºäºéä¸»é”®ç´¢å¼•çš„æŸ¥è¯¢éœ€è¦å¤šæ‰«æä¸€æ£µç´¢å¼•æ ‘ã€‚å› æ­¤ï¼Œåº”è¯¥å°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢ã€‚</li>\n</ul>\n<h2>11.7. ç´¢å¼•ç»´æŠ¤</h2>\n<ul>\n<li>B+æ ‘ä¸ºäº†ç»´æŠ¤ç´¢å¼•æœ‰åºæ€§ï¼Œåœ¨æ’å…¥æ–°å€¼çš„æ—¶å€™éœ€è¦åšå¿…è¦çš„ç»´æŠ¤ã€‚å¯èƒ½åœ¨ç°æœ‰è®°å½•åé¢æ’å…¥ä¸€ä¸ªæ–°è®°å½•ã€‚å¯èƒ½éœ€è¦é€»è¾‘ä¸ŠæŒªåŠ¨åé¢çš„æ•°æ®ï¼Œç©ºå‡ºä½ç½®ã€‚å¦‚æœæœ€åæ‰€åœ¨çš„è®°å½•æ‰€åœ¨çš„æ•°æ®é¡µå·²ç»æ»¡äº†ï¼Œè¿™æ—¶å€™éœ€è¦ç”³è¯·ä¸€ä¸ªæ–°çš„æ•°æ®é¡µï¼Œç„¶åæŒªåŠ¨éƒ¨åˆ†æ•°æ®è¿‡å»ã€‚è¿™ä¸ªè¿‡ç¨‹ç§°ä¸ºé¡µåˆ†è£‚ã€‚åœ¨è¿™ç§æƒ…å†µä¸‹æ€§èƒ½ä¸‹é™ã€‚é¡µåˆ†è£‚æ“ä½œé™ä½äº†æ•°æ®é¡µçš„åˆ©ç”¨ç‡ã€‚å½“ç›¸é‚»ä¸¤ä¸ªé¡µç”±äºåˆ é™¤äº†æ•°æ®ï¼Œåˆ©ç”¨ç‡å¾ˆä½ä¹‹åï¼Œä¼šå°†æ•°æ®é¡µåšåˆå¹¶ã€‚åˆå¹¶çš„è¿‡ç¨‹ï¼Œå¯ä»¥è®¤ä¸ºæ˜¯åˆ†è£‚è¿‡ç¨‹çš„é€†è¿‡ç¨‹</li>\n</ul>\n<h2>11.8. ç´¢å¼•è®¾è®¡åŸåˆ™</h2>\n<ul>\n<li>è€ƒè™‘å»ºç«‹è”åˆç´¢å¼•è€Œä¸æ˜¯å•åˆ—ç´¢å¼•ã€‚å› ä¸ºç´¢å¼•æ˜¯éœ€è¦å ç”¨ç£ç›˜ç©ºé—´çš„ã€‚ç¦»æ•£åº¦å¤§çš„æˆ–è€…é•¿åº¦å°çš„åˆ—æ”¾åˆ°è”åˆç´¢å¼•çš„å‰é¢select count(distince xxx) from t;å°½é‡ä¸è¦åŒ…å«å¤šä¸ªåˆ—çš„æ’åºï¼Œå¦‚æœéœ€è¦æœ€å¥½ç»™è¿™äº›åˆ—åˆ›å»ºå¤åˆç´¢å¼•ã€‚å¤åˆç´¢å¼•ä¸­åªè¦æœ‰ä¸€åˆ—å«æœ‰NULLå€¼ï¼Œé‚£ä¹ˆè¿™ä¸€åˆ—å¯¹äºæ­¤å¤åˆç´¢å¼•å°±æ˜¯æ— æ•ˆçš„ã€‚æ‰€ä»¥æˆ‘ä»¬åœ¨æ•°æ®åº“è®¾è®¡æ—¶ä¸è¦è®©å­—æ®µçš„é»˜è®¤å€¼ä¸ºNULL</li>\n<li>ç´¢å¼•å­—æ®µè¶Šå°è¶Šå¥½ï¼ŒèŠ‚çœå­˜å‚¨ç©ºé—´ï¼ˆå› ä¸ºæ•°æ®åº“æ•°æ®å­˜å‚¨å•ä½æ˜¯ä»¥â€œé¡µâ€ä¸ºå•ä½çš„ï¼Œæ•°æ®å­˜å‚¨çš„è¶Šå¤šï¼ŒIOä¹Ÿä¼šè¶Šå¤§ï¼‰</li>\n<li>å–æ¶ˆå¤–é”®ï¼Œå¯äº¤ç”±ç¨‹åºæ¥çº¦æŸï¼Œæ€§èƒ½æ›´å¥½</li>\n<li>å°½é‡ä½¿ç”¨æ•°å­—å‹å­—æ®µï¼Œè‹¥åªå«æ•°å€¼ä¿¡æ¯çš„å­—æ®µå°½é‡ä¸è¦è®¾è®¡ä¸ºå­—ç¬¦å‹ï¼Œä¼šé™ä½æŸ¥è¯¢å’Œè¿æ¥çš„æ€§èƒ½å¹¶å¢åŠ å­˜å‚¨å¼€é”€ã€‚è¿™æ˜¯å› ä¸ºå¼•æ“åœ¨å¤„ç†æŸ¥è¯¢å’Œè¿æ¥æ—¶ä¼šé€ä¸ªæ¯”è¾ƒå­—ç¬¦ä¸²ä¸­æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œè€Œå¯¹äºæ•°å­—å‹è€Œè¨€åªéœ€è¦æ¯”è¾ƒä¸€æ¬¡</li>\n<li>å­—ç¬¦ä¸²åˆ›å»ºç´¢å¼•çš„æ–¹å¼\n<ul>\n<li>ç›´æ¥åˆ›å»ºå®Œæ•´ç´¢å¼•ï¼Œå¯èƒ½æ¯”è¾ƒå ç”¨ç©ºé—´ï¼›</li>\n<li>å‰ç¼€ç´¢å¼•ï¼ŒèŠ‚çœç©ºé—´ï¼Œç£ç›˜IOå‡å°‘ï¼Œç´¢å¼•é«˜é€Ÿç¼“å­˜ä¸­çš„å—èƒ½å®¹çº³æ›´å¤šçš„é”®å€¼ï¼ŒæŸ¥è¯¢é€Ÿåº¦åŠ å¿«ï¼Œä½†ä¼šå¢åŠ æŸ¥è¯¢æ‰«ææ¬¡æ•°ï¼Œå¹¶ä¸”ä¸èƒ½ä½¿ç”¨è¦†ç›–ç´¢å¼•ï¼Œä¸æ”¯æŒèŒƒå›´æŸ¥è¯¢ï¼› å¯é€šè¿‡æŸ¥è¯¢count(distinct left(field,n))/count(1) å¤§äº0.95çš„nï¼Œç¡®å®šä½¿ç”¨å¤šé•¿çš„å‰ç¼€</li>\n<li>å€’åºå­˜å‚¨ï¼Œå†åˆ›å»ºå‰ç¼€ç´¢å¼•ï¼Œç”¨äºç»•è¿‡å­—ç¬¦ä¸²æœ¬èº«å‰ç¼€çš„åŒºåˆ†åº¦ä¸å¤Ÿçš„é—®é¢˜ï¼›æŸ¥è¯¢select * from t where x = reverse('x'); è®°å¾—ä½¿ç”¨count(distinct)æ–¹æ³•å»åšä¸ªéªŒè¯ã€‚</li>\n<li>hashå­—æ®µ/crc32å­—æ®µç´¢å¼•ï¼ŒæŸ¥è¯¢æ€§èƒ½ç¨³å®šï¼Œæœ‰é¢å¤–çš„å­˜å‚¨å’Œè®¡ç®—æ¶ˆè€—ï¼Œä¸æ”¯æŒèŒƒå›´æ‰«æã€‚æ·»åŠ ä¸€ä¸ªæ•´æ•°å­—æ®µä¿å­˜æ ¡éªŒç ï¼ŒåŒæ—¶åœ¨è¿™ä¸ªå­—æ®µä¸Šåˆ›å»ºç´¢å¼•ã€‚è¿™æ ·ç´¢å¼•å°±å˜å°äº†ï¼Œè®°å¾—æŸ¥è¯¢è¦åˆ¤æ–­filedå’Œæ ¡éªŒç æ˜¯å¦ç›¸åŒã€‚select * from t where x=crc32/hash('x') and x='x'</li>\n</ul>\n</li>\n<li>æ™®é€šç´¢å¼•(ä¸šåŠ¡å”¯ä¸€)å’Œå”¯ä¸€ç´¢å¼•ï¼š\n<ul>\n<li>å†™å¤šè¯»å°‘çš„åœºæ™¯æ™®é€šç´¢å¼•èƒ½ç”¨ä¸Šchange bufferä¼˜åŒ–ï¼Œæ¨èä½¿ç”¨æ™®é€šç´¢å¼•è€Œå”¯ä¸€åªéœ€ä¸šåŠ¡ä¿è¯å³å¯</li>\n<li>ä½¿ç”¨å”¯ä¸€ç´¢å¼•ã€‚è€ƒè™‘æŸåˆ—ä¸­å€¼çš„åˆ†å¸ƒã€‚ç´¢å¼•çš„åˆ—çš„åŸºæ•°è¶Šå¤§ï¼Œç´¢å¼•çš„æ•ˆæœè¶Šå¥½ã€‚åŒºåˆ†åº¦å¤§çš„</li>\n<li>åœ¨ä¸€äº›â€œå½’æ¡£åº“â€çš„åœºæ™¯ï¼Œå¯ä»¥è€ƒè™‘ä½¿ç”¨å”¯ä¸€ç´¢å¼•çš„ã€‚æ¯”å¦‚ï¼Œçº¿ä¸Šæ•°æ®åªéœ€è¦ä¿ç•™åŠå¹´ï¼Œç„¶åå†å²æ•°æ®ä¿å­˜åœ¨å½’æ¡£åº“ã€‚è¿™æ—¶å€™ï¼Œå½’æ¡£æ•°æ®å·²ç»æ˜¯ç¡®ä¿æ²¡æœ‰å”¯ä¸€é”®å†²çªäº†ã€‚è¦æé«˜å½’æ¡£æ•ˆç‡ï¼Œå¯ä»¥è€ƒè™‘æŠŠè¡¨é‡Œé¢çš„å”¯ä¸€ç´¢å¼•æ”¹æˆæ™®é€šç´¢å¼•</li>\n</ul>\n</li>\n<li>ç´¢å¼•åˆ—çš„åŸºæ•°è¶Šå¤§ï¼Œç´¢å¼•æ•ˆæœè¶Šå¥½ã€‚ç»„åˆç´¢å¼•åŸºæ•°æ›´å¤§ï¼Œæ¨èä½¿ç”¨</li>\n<li>åº”å°½å¯èƒ½çš„é¿å…æ›´æ–° clustered ç´¢å¼•æ•°æ®åˆ—ï¼Œå› ä¸º clustered ç´¢å¼•æ•°æ®åˆ—çš„é¡ºåºå°±æ˜¯è¡¨è®°å½•çš„ç‰©ç†å­˜å‚¨ é¡ºåºï¼Œä¸€æ—¦è¯¥åˆ—å€¼æ”¹å˜å°†å¯¼è‡´æ•´ä¸ªè¡¨è®°å½•çš„é¡ºåºçš„è°ƒæ•´ï¼Œä¼šè€—è´¹ç›¸å½“å¤§çš„èµ„æºã€‚è‹¥åº”ç”¨ç³»ç»Ÿéœ€è¦é¢‘ç¹æ›´æ–° clustered ç´¢å¼•æ•°æ®åˆ—ï¼Œé‚£ä¹ˆéœ€è¦è€ƒè™‘æ˜¯å¦åº”å°†è¯¥ç´¢å¼•å»ºä¸º clustered ç´¢å¼•ã€‚</li>\n<li>å°½å¯èƒ½çš„ä½¿ç”¨ varchar/nvarchar ä»£æ›¿ char/nchar ï¼Œå› ä¸ºé¦–å…ˆå˜é•¿å­—æ®µå­˜å‚¨ç©ºé—´å°ï¼Œå¯ä»¥èŠ‚çœå­˜å‚¨ç©ºé—´ï¼Œå…¶æ¬¡å¯¹äºæŸ¥è¯¢æ¥è¯´ï¼Œåœ¨ä¸€ä¸ªç›¸å¯¹è¾ƒå°çš„å­—æ®µå†…æœç´¢æ•ˆç‡æ˜¾ç„¶è¦é«˜äº›</li>\n<li>é¿å…é¢‘ç¹åˆ›å»ºå’Œåˆ é™¤ä¸´æ—¶è¡¨ï¼Œä»¥å‡å°‘ç³»ç»Ÿè¡¨èµ„æºçš„æ¶ˆè€—ã€‚åœ¨æ–°å»ºä¸´æ—¶è¡¨æ—¶ï¼Œå¦‚æœä¸€æ¬¡æ€§æ’å…¥æ•°æ®é‡å¾ˆå¤§ï¼Œé‚£ä¹ˆå¯ä»¥ä½¿ç”¨ select into ä»£æ›¿ create tableï¼Œé¿å…é€ æˆå¤§é‡ log ï¼Œä»¥æé«˜é€Ÿåº¦ï¼›å¦‚æœæ•°æ®é‡ä¸å¤§ï¼Œä¸ºäº†ç¼“å’Œç³»ç»Ÿè¡¨çš„èµ„æºï¼Œåº”å…ˆcreate tableï¼Œç„¶åinsertã€‚</li>\n<li>å¦‚æœä½¿ç”¨åˆ°äº†ä¸´æ—¶è¡¨ï¼Œåœ¨å­˜å‚¨è¿‡ç¨‹çš„æœ€ååŠ¡å¿…å°†æ‰€æœ‰çš„ä¸´æ—¶è¡¨æ˜¾å¼åˆ é™¤ï¼Œå…ˆ truncate table ï¼Œç„¶å drop table ï¼Œè¿™æ ·å¯ä»¥é¿å…ç³»ç»Ÿè¡¨çš„è¾ƒé•¿æ—¶é—´é”å®šã€‚</li>\n</ul>\n<h2>11.9. ç´¢å¼•çš„å¸¸è§æ•°æ®æ¨¡å‹(å®ç°ç´¢å¼•çš„æ–¹å¼)</h2>\n<ul>\n<li>å“ˆå¸Œè¡¨\n<ul>\n<li>ä»¥é”®-å€¼ï¼ˆkey-valueï¼‰å­˜å‚¨æ•°æ®çš„ç»“æ„ï¼Œåªè¦è¾“å…¥æŸ¥æ‰¾å€¼keyï¼Œå°±å¯ä»¥æ‰¾åˆ°å…¶å¯¹åº”å€¼Valueã€‚æŠŠå€¼æ”¾åœ¨æ•°ç»„é‡Œï¼Œç”¨ä¸€ä¸ªå“ˆå¸Œå‡½æ•°æŠŠkeyæ¢ç®—æˆä¸€ä¸ªç¡®å®šçš„ä½ç½®ï¼Œç„¶åæŠŠvalueæ”¾åœ¨æ•°ç»„çš„è¿™ä¸ªä½ç½®ã€‚å¤šä¸ªkeyå€¼ç»è¿‡å“ˆå¸Œå‡½æ•°çš„æ¢ç®—ï¼Œä¼šå‡ºç°åŒä¸€ä¸ªå€¼çš„æƒ…å†µã€‚å“ˆå¸Œå†²çªï¼Œå¤„ç†æ–¹æ³•æ˜¯æ‹‰å‡ºä¸€ä¸ªé“¾è¡¨ã€‚æŸ¥æ‰¾æ—¶å…ˆç”¨å“ˆå¸Œå‡½æ•°æŠŠkeyæ¢ç®—ï¼Œæ‰¾åˆ°åœ¨å“ˆå¸Œè¡¨çš„ä½ç½®ï¼Œç„¶åé¡ºåºéå†é“¾è¡¨ï¼Œæ‰¾åˆ°valueã€‚åœ¨å“ˆå¸Œè¡¨ä¸­çš„keyä¸æ˜¯é€’å¢çš„ï¼Œå¥½å¤„æ˜¯å¢åŠ æ–°valueæ—¶å¾ˆå¿«ï¼Œåªéœ€å¾€åè¿½åŠ ï¼Œå› ä¸ºä¸æ˜¯æœ‰åºçš„ï¼Œæ‰€ä»¥åŒºé—´æŸ¥è¯¢é€Ÿåº¦æ…¢ï¼Œæ¯æ¬¡è¦å…¨éƒ¨æ‰«æã€‚é€‚ç”¨äºåªæœ‰ç­‰å€¼æŸ¥è¯¢çš„åœºæ™¯ï¼Œæ¯”å¦‚MemcachedåŠå…¶ä»–ä¸€äº›NoSQLå¼•æ“ã€‚</li>\n</ul>\n</li>\n<li>æœ‰åºæ•°ç»„\n<ul>\n<li>åœ¨ç­‰å€¼æŸ¥è¯¢æ—¶ï¼Œkeyå€¼æŒ‰é¡ºåºä¿å­˜ï¼Œä½¿ç”¨äºŒåˆ†æ³•å°±èƒ½å¿«é€Ÿæ‰¾åˆ°keyå’Œå¯¹åº”å€¼ï¼Œæ—¶é—´å¤æ‚åº¦æ˜¯O(log(N)),èŒƒå›´æŸ¥è¯¢æ—¶ï¼Œå…ˆç”¨äºŒåˆ†æŸ¥æ‰¾æ‰¾åˆ°ç¬¬ä¸€ä¸ªå¤§äºæœ€å°å€¼çš„keyï¼Œç„¶åå‘å³éå†åˆ°ç¬¬ä¸€ä¸ªå¤§äºæœ€å¤§å€¼çš„keyï¼Œé€€å‡ºå¾ªç¯å³å¯ã€‚ä½†æ˜¯åœ¨æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œå¾€ä¸­é—´æ’å…¥ä¸€ä¸ªè®°å½•å°±å¿…é¡»å¾—æŒªåŠ¨åé¢æ‰€æœ‰çš„è®°å½•ï¼Œæˆæœ¬å¤ªé«˜ã€‚åªé€‚ç”¨äºé™æ€å­˜å‚¨å¼•æ“ï¼Œæ¯”å¦‚ä½ è¦ä¿å­˜çš„æ˜¯2017å¹´æŸä¸ªåŸå¸‚çš„æ‰€æœ‰äººå£ä¿¡æ¯ï¼Œè¿™ç±»ä¸ä¼šå†ä¿®æ”¹çš„æ•°æ®ã€‚</li>\n</ul>\n</li>\n<li>Bæ ‘&amp;B+æ ‘ï¼š\n<ul>\n<li>Bæ ‘/B-æ ‘/å¤šè·¯å¹³è¡¡æŸ¥æ‰¾æ ‘ ï¼ŒB+æ ‘æ˜¯Bæ ‘çš„ä¸€ç§å˜ä½“ã€‚Bæ˜¯Balanced(å¹³è¡¡)çš„æ„æ€ã€‚</li>\n<li>Bæ ‘çš„æ‰€æœ‰èŠ‚ç‚¹æ—¢å­˜æ”¾é”®(key) ä¹Ÿå­˜æ”¾ æ•°æ®(data)ï¼› B+æ ‘åªæœ‰å¶å­èŠ‚ç‚¹å­˜æ”¾ key å’Œ dataï¼Œå…¶ä»–å†…èŠ‚ç‚¹åªå­˜æ”¾ keyã€‚</li>\n<li>Bæ ‘çš„å¶å­èŠ‚ç‚¹éƒ½æ˜¯ç‹¬ç«‹çš„ï¼›B+æ ‘çš„å¶å­èŠ‚ç‚¹æœ‰ä¸€æ¡å¼•ç”¨é“¾æŒ‡å‘ä¸å®ƒç›¸é‚»çš„å¶å­èŠ‚ç‚¹ã€‚</li>\n<li>Bæ ‘çš„æ£€ç´¢çš„è¿‡ç¨‹ç›¸å½“äºå¯¹èŒƒå›´å†…çš„æ¯ä¸ªèŠ‚ç‚¹çš„å…³é”®å­—åšäºŒåˆ†æŸ¥æ‰¾ï¼Œå¯èƒ½è¿˜æ²¡æœ‰åˆ°è¾¾å¶å­èŠ‚ç‚¹ï¼Œæ£€ç´¢å°±ç»“æŸäº†ï¼›B+æ ‘çš„æ£€ç´¢æ•ˆç‡å°±å¾ˆç¨³å®šäº†ï¼Œä»»ä½•æŸ¥æ‰¾éƒ½æ˜¯ä»æ ¹èŠ‚ç‚¹åˆ°å¶å­èŠ‚ç‚¹çš„è¿‡ç¨‹ï¼Œå¶å­èŠ‚ç‚¹çš„é¡ºåºæ£€ç´¢å¾ˆæ˜æ˜¾ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>11.10. è‡ªå¢ä¸»é”®ä½¿ç”¨åœºæ™¯</h2>\n<ul>\n<li>ä»æ€§èƒ½çœ‹ï¼Œè‡ªå¢ä¸»é”®æ¯æ¬¡æ’å…¥ä¸€æ¡æ–°è®°å½•ï¼Œéƒ½æ˜¯è¿½åŠ æ“ä½œï¼Œéƒ½ä¸æ¶‰åŠåˆ°æŒªåŠ¨å…¶ä»–è®°å½•ï¼Œä¹Ÿä¸ä¼šè§¦å‘å¶å­èŠ‚ç‚¹çš„åˆ†è£‚ã€‚è€Œæœ‰ä¸šåŠ¡é€»è¾‘çš„å­—æ®µåšä¸»é”®ï¼Œåˆ™å¾€å¾€ä¸å®¹æ˜“ä¿è¯æœ‰åºæ’å…¥ï¼Œè¿™æ ·å†™æ•°æ®æˆæœ¬ç›¸å¯¹è¾ƒé«˜</li>\n<li>ä»å­˜å‚¨ç©ºé—´çš„è§’åº¦æ¥çœ‹ã€‚ä¸»é”®é•¿åº¦è¶Šå°ï¼Œæ™®é€šç´¢å¼•çš„å¶å­èŠ‚ç‚¹å°±è¶Šå°ï¼Œæ™®é€šç´¢å¼•å ç”¨çš„ç©ºé—´ä¹Ÿå°±è¶Šå°ï¼Œè‡ªå¢ä¸»é”®å¾€å¾€å ç”¨çš„ç©ºé—´æ¯”è¾ƒå°</li>\n<li>ä»€ä¹ˆåœºæ™¯é€‚åˆç”¨ä¸šåŠ¡å­—æ®µç›´æ¥åšä¸»é”®ï¼ŸKVåœºæ™¯ï¼Œå½“åªæœ‰ä¸€ä¸ªå”¯ä¸€ç´¢å¼•ï¼Œæ­¤æ—¶ä¸šåŠ¡å­—æ®µç›´æ¥åšä¸»é”®ï¼Œç”±äºæ²¡æœ‰å…¶ä»–ç´¢å¼•ï¼Œæ‰€ä»¥ä¹Ÿå°±ä¸ç”¨è€ƒè™‘å…¶ä»–ç´¢å¼•çš„å¶å­èŠ‚ç‚¹å¤§å°ã€‚è€ƒè™‘åˆ°â€œå°½é‡ä½¿ç”¨ä¸»é”®æŸ¥è¯¢â€åŸåˆ™ï¼Œç›´æ¥å°†è¿™ä¸ªç´¢å¼•è®¾ç½®ä¸ºä¸»é”®ï¼Œå¯ä»¥é¿å…æ¯æ¬¡æŸ¥è¯¢éœ€è¦æœç´¢ä¸¤æ£µæ ‘</li>\n</ul>\n<h1>12. MySQLäº‹åŠ¡</h1>\n<ul>\n<li>äº‹åŠ¡ï¼šä¸€ä¸ªäº‹åŠ¡ä¸­å¤šæ¬¡æ“ä½œè¦ä¹ˆå…¨éƒ¨æˆåŠŸï¼Œè¦ä¹ˆå…¨éƒ¨å¤±è´¥</li>\n<li>åœ¨MySQLä¸­ï¼Œäº‹åŠ¡æ”¯æŒæ˜¯åœ¨å¼•æ“å±‚å®ç°çš„ã€‚</li>\n<li>MySQL æ”¯æŒå¯¹ MyISAM å’Œ MEMORY å­˜å‚¨å¼•æ“çš„è¡¨è¿›è¡Œè¡¨çº§é”å®šï¼Œå¯¹ BDB å­˜å‚¨å¼•æ“çš„è¡¨è¿›è¡Œé¡µçº§é”å®šï¼Œå¯¹ InnoDB å­˜å‚¨å¼•æ“çš„è¡¨è¿›è¡Œè¡Œçº§é”å®šã€‚é»˜è®¤æƒ…å†µä¸‹ï¼Œè¡¨é”å’Œè¡Œé”éƒ½æ˜¯è‡ªåŠ¨è·å¾—çš„ï¼Œä¸éœ€è¦é¢å¤–çš„å‘½ä»¤ã€‚ä½†æ˜¯æœ‰æ—¶ç”¨æˆ·éœ€è¦æ˜ç¡®åœ°è¿›è¡Œé”è¡¨æˆ–è€…è¿›è¡Œäº‹åŠ¡çš„æ§åˆ¶ï¼Œä»¥ä¾¿ç¡®ä¿æ•´ä¸ªäº‹åŠ¡çš„å®Œæ•´æ€§ï¼Œè¿™æ ·å°±éœ€è¦ä½¿ç”¨äº‹åŠ¡æ§åˆ¶å’Œé”å®šè¯­å¥æ¥å®Œæˆã€‚</li>\n</ul>\n<h2>12.1. äº‹åŠ¡éš”ç¦»çº§åˆ«</h2>\n<ul>\n<li>\n<p>V1ã€V2ã€V3çš„è¿”å›å€¼åˆ†åˆ«æ˜¯ä»€ä¹ˆ?</p>\n<ul>\n<li>è¯»æœªæäº¤ï¼ŒV1=V2=V3=2</li>\n<li>è¯»æäº¤ï¼ŒV1=1,V2=2ã€‚äº‹åŠ¡Bçš„æ›´æ–°åœ¨æäº¤åæ‰èƒ½è¢«Açœ‹åˆ°ã€‚æ‰€ä»¥ï¼ŒV3=2ã€‚</li>\n<li>å¯é‡å¤è¯»ï¼ŒV1=V2=1ï¼ŒV3=2ã€‚V2=1æ˜¯å› ä¸ºäº‹åŠ¡åœ¨æ‰§è¡ŒæœŸé—´çœ‹åˆ°çš„æ•°æ®å‰åå¿…é¡»ä¸€è‡´</li>\n<li>ä¸²è¡ŒåŒ–ï¼Œåœ¨äº‹åŠ¡Bæ‰§è¡Œâ€œå°†1æ”¹æˆ2â€çš„æ—¶å€™ï¼Œä¼šè¢«é”ä½ã€‚ç›´åˆ°äº‹åŠ¡Aæäº¤åï¼Œäº‹åŠ¡Bæ‰å¯ä»¥ç»§ç»­æ‰§è¡Œã€‚ä»Açš„è§’åº¦çœ‹ï¼ŒV1=V2=1ï¼ŒV3=2<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/26a9f40cfc3a646324c43.png\" alt=\"äº‹åŠ¡éš”ç¦»çº§åˆ«.png\"></li>\n</ul>\n</li>\n<li>\n<p>ä»€ä¹ˆæ—¶å€™éœ€è¦â€œå¯é‡å¤è¯»â€çš„åœºæ™¯å‘¢ï¼Ÿ</p>\n</li>\n<li>\n<p>æ•°æ®æ ¡å¯¹é€»è¾‘çš„æ¡ˆä¾‹ã€‚å‡è®¾ä½ åœ¨ç®¡ç†ä¸€ä¸ªä¸ªäººé“¶è¡Œè´¦æˆ·è¡¨ã€‚ä¸€ä¸ªè¡¨å­˜äº†æ¯ä¸ªæœˆæœˆåº•çš„ä½™é¢ï¼Œä¸€ä¸ªè¡¨å­˜äº†è´¦å•æ˜ç»†ã€‚è¿™æ—¶å€™ä½ è¦åšæ•°æ®æ ¡å¯¹ï¼Œä¹Ÿå°±æ˜¯åˆ¤æ–­ä¸Šä¸ªæœˆçš„ä½™é¢å’Œå½“å‰ä½™é¢çš„å·®é¢ï¼Œæ˜¯å¦ä¸æœ¬æœˆçš„è´¦å•æ˜ç»†ä¸€è‡´ã€‚ä½ ä¸€å®šå¸Œæœ›åœ¨æ ¡å¯¹è¿‡ç¨‹ä¸­ï¼Œå³ä½¿æœ‰ç”¨æˆ·å‘ç”Ÿäº†ä¸€ç¬”æ–°çš„äº¤æ˜“ï¼Œä¹Ÿä¸å½±å“ä½ çš„æ ¡å¯¹ç»“æœã€‚è¿™æ—¶å€™ä½¿ç”¨â€œå¯é‡å¤è¯»â€éš”ç¦»çº§åˆ«å°±å¾ˆæ–¹ä¾¿ã€‚äº‹åŠ¡å¯åŠ¨æ—¶çš„è§†å›¾å¯ä»¥è®¤ä¸ºæ˜¯é™æ€çš„ï¼Œä¸å—å…¶ä»–äº‹åŠ¡æ›´æ–°çš„å½±å“</p>\n</li>\n<li>\n<p>ä¸ºä»€ä¹ˆè¡¨ç»“æ„ä¸æ”¯æŒâ€œå¯é‡å¤è¯»â€ï¼Ÿè¿™æ˜¯å› ä¸ºè¡¨ç»“æ„æ²¡æœ‰å¯¹åº”çš„è¡Œæ•°æ®ï¼Œä¹Ÿæ²¡æœ‰rowtrx_idï¼Œå› æ­¤åªèƒ½éµå¾ªå½“å‰è¯»çš„é€»è¾‘</p>\n</li>\n<li>\n<p>å¯é‡å¤è¯»ä¹Ÿå¯é¿å…å¹»è¯»ï¼Œä½¿ç”¨è¡ŒXé”ï¼ˆSELECT ... FOR UPDATEï¼Œçº¦ç­‰äºSERIALIZABLEï¼‰ï¼Œå³ä¾¿å½“å‰è®°å½•idä¸å­˜åœ¨ï¼Œå½“å‰äº‹åŠ¡ä¹Ÿä¼šè·å¾—ä¸€æŠŠè®°å½•é”ï¼ˆå› ä¸ºInnoDBçš„è¡Œé”é”å®šçš„æ˜¯ç´¢å¼•ï¼Œå­˜åœ¨å°±åŠ è¡ŒXé”ï¼Œå¦åˆ™åŠ  next-key locké—´éš™Xé”ï¼‰ï¼Œå…¶ä»–äº‹åŠ¡åˆ™æ— æ³•æ’å…¥æ­¤ç´¢å¼•çš„è®°å½•ï¼Œæ•…æœç»äº†å¹»è¯»ã€‚</p>\n</li>\n</ul>\n<h2>12.2. æŸ¥çœ‹äº‹åŠ¡éš”ç¦»çº§åˆ«</h2>\n<ul>\n<li>Oracleæ•°æ®åº“çš„é»˜è®¤éš”ç¦»çº§åˆ«å…¶å®å°±æ˜¯â€œè¯»æäº¤â€ï¼Œå› æ­¤å¯¹äºä»Oracleè¿ç§»åˆ°MySQLçš„åº”ç”¨ï¼Œä¸€å®šè¦å°†MySQLçš„éš”ç¦»çº§åˆ«è®¾ç½®ä¸ºâ€œè¯»æäº¤â€ã€‚å³å¯åŠ¨å‚æ•°transaction-isolationçš„å€¼è®¾ç½®æˆREAD-COMMITTEDã€‚</li>\n<li>show variables like 'transaction_isolation'</li>\n</ul>\n<h2>12.3. äº‹åŠ¡éš”ç¦»çº§åˆ«çš„å®ç°</h2>\n<h3>12.3.1. é”</h3>\n<ul>\n<li>åœ¨è¯»å–æ•°æ®å‰ï¼Œå¯¹å…¶åŠ é”ï¼Œé˜»æ­¢å…¶ä»–äº‹åŠ¡å¯¹æ•°æ®è¿›è¡Œä¿®æ”¹ã€‚</li>\n</ul>\n<h3>12.3.2. MVCC</h3>\n<ul>\n<li>ä¸ç”¨åŠ ä»»ä½•é”ï¼Œéé˜»å¡å¹¶å‘è¯»ï¼Œé€šè¿‡ä¸€å®šæœºåˆ¶ç”Ÿæˆä¸€ä¸ªæ•°æ®è¯·æ±‚æ—¶é—´ç‚¹çš„ä¸€è‡´æ€§æ•°æ®å¿«ç…§ï¼ˆSnapshot)ï¼Œå¹¶ç”¨è¿™ä¸ªå¿«ç…§æ¥æä¾›ä¸€å®šçº§åˆ«ï¼ˆè¯­å¥çº§æˆ–äº‹åŠ¡çº§ï¼‰çš„ä¸€è‡´æ€§è¯»å–ã€‚ä»ç”¨æˆ·çš„è§’åº¦æ¥çœ‹ï¼Œå¥½è±¡æ˜¯æ•°æ®åº“å¯ä»¥æä¾›åŒä¸€æ•°æ®çš„å¤šä¸ªç‰ˆæœ¬ï¼Œå› æ­¤ï¼Œè¿™ç§æŠ€æœ¯å«åšæ•°æ®å¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶/å¤šç‰ˆæœ¬æ•°æ®åº“ï¼ˆMultiVersion Concurrency Controlï¼Œç®€ç§° MVCC æˆ–MCCï¼‰</li>\n<li>æ˜¯ä¸€ç§ç”¨æ¥è§£å†³è¯»-å†™å†²çªçš„æ— é”å¹¶å‘æ§åˆ¶ï¼Œä¹Ÿå°±æ˜¯ä¸ºäº‹åŠ¡åˆ†é…å•å‘å¢é•¿çš„æ—¶é—´æˆ³ï¼Œä¸ºæ¯ä¸ªä¿®æ”¹ä¿å­˜ä¸€ä¸ªç‰ˆæœ¬ï¼Œç‰ˆæœ¬ä¸äº‹åŠ¡æ—¶é—´æˆ³å…³è”ï¼Œè¯»æ“ä½œåªè¯»è¯¥äº‹åŠ¡å¼€å§‹å‰çš„æ•°æ®åº“çš„å¿«ç…§ã€‚ è¿™æ ·åœ¨è¯»æ“ä½œä¸ç”¨é˜»å¡å†™æ“ä½œï¼Œå†™æ“ä½œä¸ç”¨é˜»å¡è¯»æ“ä½œçš„åŒæ—¶ï¼Œé¿å…äº†è„è¯»å’Œä¸å¯é‡å¤è¯»ã€‚</li>\n</ul>\n<h4>12.3.2.1. å¿«ç…§è¯»</h4>\n<ul>\n<li>åœ¨å¯é‡å¤è¯»çº§åˆ«ä¸‹ï¼Œä¸åŠ é”çš„selectæ“ä½œå°±æ˜¯å¿«ç…§è¯»ï¼Œå³ä¸åŠ é”çš„éé˜»å¡è¯»ï¼›åŸºäºæé«˜å¹¶å‘æ€§èƒ½çš„è€ƒè™‘ï¼Œå¿«ç…§è¯»çš„å®ç°æ˜¯åŸºäºå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶MVCC,åœ¨å¾ˆå¤šæƒ…å†µä¸‹ï¼Œé¿å…äº†åŠ é”æ“ä½œï¼Œé™ä½äº†å¼€é”€ï¼›æ—¢ç„¶æ˜¯åŸºäºå¤šç‰ˆæœ¬ï¼Œå³å¿«ç…§è¯»å¯èƒ½è¯»åˆ°çš„å¹¶ä¸ä¸€å®šæ˜¯æ•°æ®çš„æœ€æ–°ç‰ˆæœ¬ï¼Œè€Œæœ‰å¯èƒ½æ˜¯ä¹‹å‰çš„å†å²ç‰ˆæœ¬</li>\n<li>ä¸²è¡ŒåŒ–éš”ç¦»çº§åˆ«ä¸‹ï¼Œå¿«ç…§è¯»ä¼šé€€åŒ–ä¸ºå½“å‰è¯»ã€‚</li>\n</ul>\n<h4>12.3.2.2. å½“å‰è¯»ï¼ˆcurrent readï¼‰</h4>\n<ul>\n<li>å½“å‰è¯»ï¼ˆcurrent readï¼‰è¯»å·²ç»æäº¤å®Œæˆçš„æœ€æ–°ç‰ˆæœ¬,åŒ…æ‹¬updateï¼Œinsertï¼Œdeleteè¯­å¥ã€select * from t where id = 1 [lock in share mode/for update]</li>\n</ul>\n<h4>12.3.2.3. MVCCçš„å®ç°</h4>\n<ul>\n<li>InnoDBä½¿ç”¨ä¸€è‡´æ€§è¯»è§†å›¾consistent read viewï¼Œundo logï¼Œéšè—å­—æ®µï¼Œå®ç°MVCCï¼ˆå¤šç‰ˆæœ¬å¹¶å‘æ§åˆ¶ï¼‰/äº‹åŠ¡éš”ç¦»ã€‚åœ¨å†…éƒ¨å®ç°ä¸­ï¼ŒInnoDB é€šè¿‡æ•°æ®è¡Œçš„ DB_TRX_ID å’Œ Read View æ¥åˆ¤æ–­æ•°æ®çš„å¯è§æ€§ã€‚å¦‚ä¸å¯è§ï¼Œåˆ™é€šè¿‡æ•°æ®è¡Œçš„ DB_ROLL_PTR æ‰¾åˆ° undo log ä¸­çš„å†å²ç‰ˆæœ¬ã€‚æ¯ä¸ªäº‹åŠ¡è¯»åˆ°çš„æ•°æ®ç‰ˆæœ¬å¯èƒ½æ˜¯ä¸ä¸€æ ·çš„ï¼Œåœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œç”¨æˆ·åªèƒ½çœ‹åˆ°è¯¥äº‹åŠ¡åˆ›å»º Read View ä¹‹å‰å·²ç»æäº¤çš„ä¿®æ”¹å’Œè¯¥äº‹åŠ¡æœ¬èº«åšçš„ä¿®æ”¹ã€‚</li>\n<li>InnoDBæ¯ä¸ªäº‹åŠ¡éƒ½æœ‰è‡ªå¢çš„å”¯ä¸€çš„äº‹åŠ¡IDå³transaction idã€‚æ¯æ¬¡äº‹åŠ¡æ›´æ–°æ•°æ®çš„æ—¶å€™ï¼Œéƒ½ä¼šç”Ÿæˆä¸€ä¸ªæ–°çš„æ•°æ®ç‰ˆæœ¬ï¼Œå¹¶ä¸”æŠŠtransaction idèµ‹å€¼ç»™è¿™ä¸ªæ•°æ®ç‰ˆæœ¬ï¼Œè®°ä¸ºrowtrx_idã€‚æ•°æ®è¡¨ä¸­çš„ä¸€è¡Œè®°å½•ï¼Œå…¶å®å¯èƒ½æœ‰å¤šä¸ªç‰ˆæœ¬ï¼Œæ¯ä¸ªç‰ˆæœ¬æœ‰è‡ªå·±çš„rowtrx_idã€‚å…¶ä¸­ï¼Œå¤šä¸ªç‰ˆæœ¬çš„æ•°æ®è®°å½•åœ¨undolog ã€‚äº‹åŠ¡è¯»å–æ•°æ®æ—¶éœ€è¦æ ¹æ®å½“å‰ç‰ˆæœ¬å’Œundo logè®¡ç®—å‡ºæ¥å€¼ã€‚</li>\n<li>undo log\n<ul>\n<li>å½“è¯»å–è®°å½•æ—¶ï¼Œè‹¥è¯¥è®°å½•è¢«å…¶ä»–äº‹åŠ¡å ç”¨æˆ–å½“å‰ç‰ˆæœ¬å¯¹è¯¥äº‹åŠ¡ä¸å¯è§ï¼Œåˆ™å¯ä»¥é€šè¿‡ undo log è¯»å–ä¹‹å‰çš„ç‰ˆæœ¬æ•°æ®ï¼Œä»¥æ­¤å®ç°å¿«ç…§è¯»</li>\n<li>insert undo logåœ¨insert æ“ä½œä¸­äº§ç”Ÿã€‚åªå¯¹äº‹åŠ¡æœ¬èº«å¯è§ã€åªåœ¨äº‹åŠ¡å›æ»šæ—¶éœ€è¦ã€‘æ•…è¯¥å¯ä»¥åœ¨äº‹åŠ¡æäº¤åç›´æ¥åˆ é™¤ã€‚ä¸éœ€è¦è¿›è¡Œ purge æ“ä½œ</li>\n<li>update undo log update æˆ– delete æ“ä½œä¸­äº§ç”Ÿã€‚éœ€è¦æä¾›MVCCæœºåˆ¶ï¼Œå› æ­¤ä¸èƒ½åœ¨äº‹åŠ¡æäº¤æ—¶å°±è¿›è¡Œåˆ é™¤ã€‚æäº¤æ—¶æ”¾å…¥undo logé“¾è¡¨ï¼Œç­‰å¾…purgeçº¿ç¨‹è¿›è¡Œæœ€åçš„åˆ é™¤ã€‚</li>\n<li>å½“ç³»ç»Ÿé‡Œæ²¡æœ‰æ¯”è¿™ä¸ªå›æ»šæ—¥å¿—æ›´æ—©çš„read-viewçš„æ—¶å€™ã€‚å›æ»šæ—¥å¿—ä¼šè¢«åˆ é™¤</li>\n</ul>\n</li>\n<li>ç‰ˆæœ¬é“¾ï¼šç±»ä¼¼ä¸€ä¸ªé“¾è¡¨ï¼Œé€šè¿‡å›æ»šæŒ‡é’ˆDB_ROLL_PTRï¼Œä¸²è”èµ·æ¥ã€‚é“¾è¡¨å¤´éƒ¨æ˜¯æœ€æ–°çš„æ•°æ®ï¼Œå°¾éƒ¨æ˜¯æœ€æ—§çš„è®°å½•</li>\n</ul>\n<h2>12.4. å¦‚ä½•è§£å†³å¹»è¯»ï¼Ÿ</h2>\n<ul>\n<li>äº§ç”Ÿå¹»è¯»çš„åŸå› æ˜¯è¡Œé”åªèƒ½é”ä½è¡Œï¼Œä¸èƒ½é”ä½æ’å…¥æ–°çºªå½•è¡Œã€‚åªå¥½å¼•å…¥é—´éš™é”(Gap Lock)ã€‚é”çš„å°±æ˜¯ä¸¤ä¸ªå€¼ä¹‹é—´çš„ç©ºéš™</li>\n<li>æ‰§è¡Œ select * from t where d=5 for updateçš„æ—¶å€™ï¼Œä¸ä»…å°†ç»™è¡ŒåŠ ä¸Šäº†è¡Œé”ï¼Œè¿˜ç»™è¡Œä¸¤è¾¹çš„ç©ºéš™åŠ ä¸Šäº†é—´éš™é”ã€‚è·Ÿé—´éš™é”å­˜åœ¨å†²çªå…³ç³»çš„ï¼Œæ˜¯â€œå¾€è¿™ä¸ªé—´éš™ä¸­æ’å…¥ä¸€ä¸ªè®°å½•â€è¿™ä¸ªæ“ä½œã€‚é—´éš™é”ä¹‹é—´éƒ½ä¸å­˜åœ¨å†²çªå…³ç³»ã€‚</li>\n<li>é—´éš™é”å’Œè¡Œé”åˆç§°next-key lockï¼Œé—´éš™é”è®°ä¸ºå¼€åŒºé—´ï¼ŒæŠŠnext-key lockè®°ä¸ºå‰å¼€åé—­åŒºé—´ã€‚ InnoDBç»™æ¯ä¸ªç´¢å¼•åŠ äº†ä¸€ä¸ªä¸å­˜åœ¨çš„æœ€å¤§å€¼supremumï¼Œè¿™æ ·æ‰ç¬¦åˆâ€œéƒ½æ˜¯å‰å¼€åé—­åŒºé—´â€ã€‚</li>\n<li>é—´éš™é”çš„å¼•å…¥ï¼Œå¯èƒ½ä¼šå¯¼è‡´åŒæ ·çš„è¯­å¥é”ä½æ›´å¤§çš„èŒƒå›´ï¼Œè¿™å…¶å®æ˜¯å½±å“äº†å¹¶å‘åº¦çš„</li>\n<li>é—´éš™é”æ˜¯åœ¨å¯é‡å¤è¯»éš”ç¦»çº§åˆ«ä¸‹æ‰ä¼šç”Ÿæ•ˆçš„ã€‚ä¹Ÿå¯ä»¥ä½¿ç”¨è¯»æäº¤éš”ç¦»çº§åˆ«åŠ binlog_format=rowçš„ç»„åˆ</li>\n</ul>\n<h2>12.5. äº‹åŠ¡ç®¡ç†</h2>\n<h3>12.5.1. MyISAMäº‹åŠ¡ç®¡ç†</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># LOCK TABLESå¯ä»¥é”å®šç”¨äºå½“å‰çº¿ç¨‹çš„è¡¨ã€‚å¦‚æœè¡¨è¢«å…¶ä»–çº¿ç¨‹é”å®šï¼Œåˆ™å½“å‰çº¿ç¨‹ä¼šç­‰å¾…ï¼Œç›´åˆ°å¯ä»¥è·å–æ‰€æœ‰é”å®šä¸ºæ­¢ã€‚\n# UNLOCK TABLESå¯ä»¥é‡Šæ”¾å½“å‰çº¿ç¨‹è·å¾—çš„ä»»ä½•é”å®šã€‚å½“å‰çº¿ç¨‹æ‰§è¡Œå¦ä¸€ä¸ªLOCK TABLESæ—¶ï¼Œæˆ–å½“ä¸æœåŠ¡å™¨çš„è¿æ¥è¢«å…³é—­æ—¶ï¼Œæ‰€æœ‰ç”±å½“å‰çº¿ç¨‹é”å®šçš„è¡¨è¢«éšå«åœ°è§£é”\nmysql&gt; LOCK TABLES tbl_name [AS alias] {READ [LOCAL] | [LOW_PRIORITY] WRITE} [, tbl_name [AS alias] {READ [LOCAL] | [LOW_PRIORITY] WRITE}] ...\nmysql&gt; UNLOCK TABLES\n</code></pre></div><h3>12.5.2. InnoDBäº‹åŠ¡ç®¡ç†</h3>\n<ul>\n<li>åœ¨åŒä¸€ä¸ªäº‹åŠ¡ä¸­ï¼Œæœ€å¥½ä¸ä½¿ç”¨ä¸åŒå­˜å‚¨å¼•æ“çš„è¡¨ï¼Œå¦åˆ™ ROLLBACK æ—¶éœ€è¦å¯¹éäº‹åŠ¡ç±»å‹çš„è¡¨è¿›è¡Œç‰¹åˆ«çš„å¤„ç†ï¼Œå› ä¸º COMMITã€ROLLBACK åªèƒ½å¯¹äº‹åŠ¡ç±»å‹çš„è¡¨è¿›è¡Œæäº¤å’Œå›æ»šã€‚</li>\n<li>æ‰€æœ‰çš„ DDL è¯­å¥æ˜¯ä¸èƒ½å›æ»šçš„ï¼Œå¹¶ä¸”éƒ¨åˆ†çš„ DDL è¯­å¥ä¼šé€ æˆéšå¼çš„æäº¤ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># MySQLæ˜¯é»˜è®¤è‡ªåŠ¨æäº¤ï¼ˆAutocommitï¼‰çš„,ä¸€æ¡sqlè¯­å¥å°±æ˜¯ä¸€ä¸ªäº‹åŠ¡ï¼Œå¦‚æœéœ€è¦é€šè¿‡æ˜ç¡®çš„Commitå’ŒRollbackæ¥æäº¤å’Œå›æ»šäº‹åŠ¡ï¼Œé‚£ä¹ˆéœ€è¦é€šè¿‡æ˜ç¡®çš„äº‹åŠ¡æ§åˆ¶å‘½ä»¤æ¥å¼€å§‹äº‹åŠ¡\n# åœ¨ç¬¬ä¸€ä¸ªæ“ä½œè¡¨çš„è¯­å¥æ—¶å¯åŠ¨äº‹åŠ¡\n# å¦‚æœåœ¨é”è¡¨æœŸé—´ï¼Œstart transactionä¼šé€ æˆä¸€ä¸ªéšå«unlock tablesè¢«æ‰§è¡Œ\nmysql&gt; START TRANSACTION | BEGIN [WORK] \n# ç«‹å³å¼€å¯äº‹åŠ¡\nmysql&gt; start transaction with consistent snapshot\n\n# ä¿®æ”¹å½“å‰è¿æ¥çš„æäº¤æ–¹å¼ï¼Œå¦‚æœè®¾ç½®äº†0ï¼Œåˆ™äº‹åŠ¡æŒç»­åˆ°æäº¤æˆ–è€…å›æ»šæˆ–è€…è¿æ¥æ–­å¼€\n# å¦‚æœåªæ˜¯å¯¹æŸäº›è¯­å¥éœ€è¦è¿›è¡Œäº‹åŠ¡æ§åˆ¶ï¼Œåˆ™ä½¿ç”¨ START TRANSACTION è¯­å¥å¼€å§‹ä¸€ä¸ªäº‹åŠ¡æ¯”è¾ƒæ–¹ä¾¿ï¼Œè¿™æ ·äº‹åŠ¡ç»“æŸä¹‹åå¯ä»¥è‡ªåŠ¨å›åˆ°è‡ªåŠ¨æäº¤çš„æ–¹å¼ï¼Œå¦‚æœå¸Œæœ›æ‰€æœ‰çš„äº‹åŠ¡éƒ½ä¸æ˜¯è‡ªåŠ¨æäº¤çš„ï¼Œé‚£ä¹ˆé€šè¿‡ä¿®æ”¹ AUTOCOMMIT æ¥æ§åˆ¶äº‹åŠ¡æ¯”è¾ƒæ–¹ä¾¿ï¼Œè¿™æ ·ä¸ç”¨åœ¨æ¯ä¸ªäº‹åŠ¡å¼€å§‹çš„æ—¶å€™å†æ‰§è¡Œ START TRANSACTION è¯­å¥ã€‚\nmysql&gt; SET AUTOCOMMIT = {0 | 1}\n\n# æäº¤/å›æ»šäº‹åŠ¡\n# CHAIN å’Œ RELEASEå­å¥åˆ†åˆ«ç”¨æ¥å®šä¹‰åœ¨äº‹åŠ¡æäº¤æˆ–è€…å›æ»šä¹‹åçš„æ“ä½œï¼ŒCHAINä¼šç«‹å³å¯åŠ¨ä¸€ä¸ªæ–°äº‹ç‰©ï¼Œå¹¶ä¸”å’Œåˆšæ‰çš„äº‹åŠ¡å…·æœ‰ç›¸åŒçš„éš”ç¦»çº§åˆ«ï¼ŒRELEASEåˆ™ä¼šæ–­å¼€å’Œå®¢æˆ·ç«¯çš„è¿æ¥\nmysql&gt; COMMIT/ROLLBACK [WORK] [AND [NO] CHAIN] [[NO] RELEASE] \n\n# åœ¨äº‹åŠ¡ä¸­å¯ä»¥é€šè¿‡å®šä¹‰SAVEPOINTï¼ŒæŒ‡å®šå›æ»šäº‹åŠ¡çš„ä¸€ä¸ªéƒ¨åˆ†ï¼Œä½†æ˜¯ä¸èƒ½æŒ‡å®šæäº¤äº‹åŠ¡çš„ä¸€ä¸ªéƒ¨åˆ†ã€‚å¯¹äºå¤æ‚çš„åº”ç”¨ï¼Œå¯ä»¥å®šä¹‰å¤šä¸ªä¸åŒçš„ SAVEPOINTï¼Œæ»¡è¶³ä¸åŒçš„æ¡ä»¶æ—¶ï¼Œå›æ»šä¸åŒçš„SAVEPOINTã€‚å¦‚æœå®šä¹‰äº†ç›¸åŒåå­—çš„ SAVEPOINTï¼Œåˆ™åé¢å®šä¹‰çš„SAVEPOINT ä¼šè¦†ç›–ä¹‹å‰çš„å®šä¹‰ã€‚åˆ é™¤åçš„SAVEPOINTï¼Œä¸èƒ½å†æ‰§è¡ŒROLLBACK TO SAVEPOINTå‘½ä»¤\nmysql&gt; savepoint test;\nmysql&gt; rollback to savepoint test;\nmysql&gt; RELEASE SAVEPOINT test;\n</code></pre></div><h2>12.6. æ€ä¹ˆè®¾è®¡äº‹åŠ¡è¿æ¥æ± ï¼Ÿâˆš</h2>\n<ul>\n<li>äº‹åŠ¡è¿æ¥æ± å¯ä»¥ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­å¤šä¸ªæ“ä½œå…±ç”¨ä¸€ä¸ªæ•°æ®åº“è¿æ¥ï¼Œä»è€Œä¿è¯äº†äº‹åŠ¡çš„ä¸€è‡´æ€§å’Œéš”ç¦»æ€§ã€‚</li>\n<li>äº‹åŠ¡è¿æ¥æ± ä¼šåœ¨ç¬¬ä¸€ä¸ªæ“ä½œå¼€å§‹æ—¶è·å–æ•°æ®åº“è¿æ¥ï¼Œå¹¶å°†è¯¥è¿æ¥ä¸å½“å‰çº¿ç¨‹ç»‘å®šï¼Œä¹‹åçš„æ‰€æœ‰æ“ä½œéƒ½ä¼šä½¿ç”¨è¯¥è¿æ¥ï¼Œç›´åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰å°†è¿æ¥é‡Šæ”¾ã€‚è¿™æ ·å°±å¯ä»¥ä¿è¯åŒä¸€ä¸ªäº‹åŠ¡ä¸­çš„æ‰€æœ‰æ“ä½œéƒ½ä½¿ç”¨åŒä¸€ä¸ªè¿æ¥</li>\n<li>äº‹åŠ¡è¿æ¥æ± åœ¨å®ç°ä¸Šéœ€è¦è€ƒè™‘çº¿ç¨‹å®‰å…¨ã€äº‹åŠ¡åµŒå¥—ç­‰é—®é¢˜ï¼Œå› æ­¤æ¯”ä¼ ç»Ÿè¿æ¥æ± æ›´åŠ å¤æ‚å’Œé«˜çº§ã€‚ä¸€äº›æµè¡Œçš„Javaæ¡†æ¶å’Œä¸­é—´ä»¶ï¼Œå¦‚Springå’ŒHibernateï¼Œéƒ½æä¾›äº†äº‹åŠ¡è¿æ¥æ± çš„å®ç°ã€‚</li>\n</ul>\n<h2>12.7. ä¸ºä»€ä¹ˆå»ºè®®ä½ å°½é‡ä¸è¦ä½¿ç”¨é•¿äº‹åŠ¡?å¦‚ä½•é¿å…é•¿äº‹åŠ¡å¯¹ä¸šåŠ¡çš„å½±å“ï¼Ÿ</h2>\n<ul>\n<li>æŸ¥æ‰¾æŒç»­æ—¶é—´è¶…è¿‡60sçš„äº‹åŠ¡ã€‚select * from information_schema.innodb_trx where TIME_TO_SEC(timediff(now(),trx_started))&gt;60</li>\n<li>é•¿äº‹åŠ¡æ„å‘³ç€ç³»ç»Ÿé‡Œé¢ä¼šå­˜åœ¨å¾ˆè€çš„äº‹åŠ¡è§†å›¾ã€‚è¿™ä¸ªäº‹åŠ¡æäº¤ä¹‹å‰ï¼Œæ•°æ®åº“é‡Œé¢å®ƒå¯èƒ½ç”¨åˆ°çš„å›æ»šè®°å½•éƒ½å¿…é¡»ä¿ç•™ï¼Œè¿™å°±ä¼šå¯¼è‡´å¤§é‡å ç”¨å­˜å‚¨ç©ºé—´ã€‚åœ¨MySQL 5.5åŠä»¥å‰çš„ç‰ˆæœ¬ï¼Œå›æ»šæ—¥å¿—æ˜¯è·Ÿæ•°æ®å­—å…¸ä¸€èµ·æ”¾åœ¨ibdataæ–‡ä»¶é‡Œçš„ï¼Œå³ä½¿é•¿äº‹åŠ¡æœ€ç»ˆæäº¤ï¼Œå›æ»šæ®µè¢«æ¸…ç†ï¼Œæ–‡ä»¶ä¹Ÿä¸ä¼šå˜å°ï¼›</li>\n<li>é•¿äº‹åŠ¡è¿˜å ç”¨é”èµ„æºï¼Œä¹Ÿå¯èƒ½æ‹–å®æ•´ä¸ªåº“</li>\n<li>åº”ç”¨å¼€å‘ç«¯ï¼š\n<ul>\n<li>\n<ol>\n<li>ç¡®è®¤æ˜¯å¦ä½¿ç”¨äº†set autocommit=0ã€‚å¯é€šè¿‡general_logçš„æ—¥å¿—æ¥ç¡®è®¤ã€‚æŠŠå®ƒæ”¹æˆ1</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>ç¡®è®¤æ˜¯å¦æœ‰ä¸å¿…è¦çš„åªè¯»äº‹åŠ¡ã€‚æœ‰äº›æ¡†æ¶ä¼šä¹ æƒ¯ä¸ç®¡ä»€ä¹ˆè¯­å¥å…ˆç”¨begin/commitæ¡†èµ·æ¥ã€‚</li>\n</ol>\n</li>\n<li>\n<ol start=\"3\">\n<li>ä¸šåŠ¡è¿æ¥æ•°æ®åº“çš„æ—¶å€™ï¼Œæ ¹æ®ä¸šåŠ¡æœ¬èº«çš„é¢„ä¼°ï¼Œé€šè¿‡SETMAX_EXECUTION_TIMEæ¥æ§åˆ¶æ¯ä¸ªè¯­å¥æ‰§è¡Œçš„æœ€é•¿æ—¶é—´ï¼Œé¿å…å•ä¸ªè¯­å¥æ‰§è¡Œå¤ªé•¿æ—¶é—´</li>\n</ol>\n</li>\n</ul>\n</li>\n<li>æ•°æ®åº“ç«¯ï¼š\n<ul>\n<li>\n<ol>\n<li>ç›‘æ§ information_schema.Innodb_trxè¡¨ï¼Œè®¾ç½®é•¿äº‹åŠ¡é˜ˆå€¼ï¼Œè¶…è¿‡å°±æŠ¥è­¦/æˆ–è€…killï¼›</li>\n</ol>\n</li>\n<li>\n<ol start=\"2\">\n<li>Perconaçš„pt-killè¿™ä¸ªå·¥å…·ä¸é”™ï¼Œæ¨èä½¿ç”¨ï¼›</li>\n</ol>\n</li>\n<li>\n<ol start=\"3\">\n<li>åœ¨ä¸šåŠ¡åŠŸèƒ½æµ‹è¯•é˜¶æ®µè¦æ±‚è¾“å‡ºæ‰€æœ‰çš„general_logï¼Œåˆ†ææ—¥å¿—è¡Œä¸ºæå‰å‘ç°é—®é¢˜ï¼›</li>\n</ol>\n</li>\n<li>\n<ol start=\"4\">\n<li>MySQL 5.6æˆ–è€…æ›´æ–°ç‰ˆæœ¬ï¼ŒæŠŠinnodb_undo_tablespacesè®¾ç½®æˆ2ï¼ˆæˆ–æ›´å¤§å€¼ï¼‰å¦‚æœå‡ºç°å¤§äº‹åŠ¡å¯¼è‡´å›æ»šæ®µè¿‡å¤§ï¼Œè¿™æ ·è®¾ç½®åæ¸…ç†èµ·æ¥æ›´æ–¹ä¾¿</li>\n</ol>\n</li>\n</ul>\n</li>\n</ul>\n<h2>12.8. åˆ†å¸ƒå¼äº‹åŠ¡çš„ä½¿ç”¨</h2>\n<h3>12.8.1. åˆ†å¸ƒå¼äº‹åŠ¡çš„åŸç†</h3>\n<ul>\n<li>MySQLä¸­ä½¿ç”¨åˆ†å¸ƒå¼äº‹åŠ¡çš„åº”ç”¨ç¨‹åºæ¶‰åŠä¸€ä¸ªæˆ–å¤šä¸ªèµ„æºç®¡ç†å™¨å’Œä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨\n<ul>\n<li>èµ„æºç®¡ç†å™¨ï¼ˆRMï¼‰ç”¨äºæä¾›é€šå‘äº‹åŠ¡èµ„æºçš„é€”å¾„ã€‚æ•°æ®åº“æœåŠ¡å™¨æ˜¯ä¸€ç§èµ„æºç®¡ç†å™¨ã€‚è¯¥ç®¡ç†å™¨å¿…é¡»å¯ä»¥æäº¤æˆ–å›æ»šç”±RM ç®¡ç†çš„äº‹åŠ¡</li>\n<li>äº‹åŠ¡ç®¡ç†å™¨ï¼ˆTMï¼‰ç”¨äºåè°ƒä½œä¸ºä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ä¸€éƒ¨åˆ†çš„äº‹åŠ¡ã€‚TMä¸ç®¡ç†æ¯ä¸ªäº‹åŠ¡çš„RMSè¿›è¡Œé€šè®¯ã€‚ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ä¸­å„ä¸ªå•ä¸ªäº‹åŠ¡å‡æ˜¯åˆ†å¸ƒå¼äº‹åŠ¡çš„â€œåˆ†æ”¯äº‹åŠ¡â€ã€‚åˆ†å¸ƒå¼äº‹åŠ¡å’Œå„åˆ†æ”¯é€šè¿‡ä¸€ç§å‘½åæ–¹æ³•è¿›è¡Œæ ‡è¯†</li>\n</ul>\n</li>\n<li>MySQLç›¸å½“äºä¸€ä¸ªç”¨äºç®¡ç†åˆ†å¸ƒå¼äº‹åŠ¡ä¸­çš„ XA äº‹åŠ¡çš„èµ„æºç®¡ç†å™¨ã€‚ä¸ MySQL æœåŠ¡å™¨è¿æ¥çš„å®¢æˆ·ç«¯ç›¸å½“äºäº‹åŠ¡ç®¡ç†å™¨</li>\n<li>è¦æ‰§è¡Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¿…é¡»çŸ¥é“è¿™ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡æ¶‰åŠåˆ°äº†å“ªäº›èµ„æºç®¡ç†å™¨ï¼Œå¹¶ä¸”æŠŠæ¯ä¸ªèµ„æºç®¡ç†å™¨çš„äº‹åŠ¡æ‰§è¡Œåˆ°äº‹åŠ¡å¯ä»¥è¢«æäº¤æˆ–å›æ»šæ—¶ã€‚æ ¹æ®æ¯ä¸ªèµ„æºç®¡ç†å™¨æŠ¥å‘Šçš„æœ‰å…³æ‰§è¡Œæƒ…å†µçš„å†…å®¹ï¼Œè¿™äº›åˆ†æ”¯äº‹åŠ¡å¿…é¡»ä½œä¸ºä¸€ä¸ªåŸå­æ€§æ“ä½œå…¨éƒ¨æäº¤æˆ–å›æ»šã€‚è¦ç®¡ç†ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¿…é¡»è¦è€ƒè™‘ä»»ä½•ç»„ä»¶æˆ–è¿æ¥ç½‘ç»œå¯èƒ½ä¼šæ•…éšœã€‚</li>\n<li>ç”¨äºæ‰§è¡Œåˆ†å¸ƒå¼äº‹åŠ¡çš„è¿‡ç¨‹ä½¿ç”¨ä¸¤é˜¶æ®µæäº¤ï¼Œå‘ç”Ÿæ—¶é—´åœ¨ç”±åˆ†å¸ƒå¼äº‹åŠ¡çš„å„ä¸ªåˆ†æ”¯éœ€è¦è¿›è¡Œçš„è¡ŒåŠ¨å·²ç»è¢«æ‰§è¡Œä¹‹åã€‚\n<ul>\n<li>åœ¨ç¬¬ä¸€é˜¶æ®µï¼Œæ‰€æœ‰çš„åˆ†æ”¯è¢«é¢„å¤‡å¥½ã€‚å®ƒä»¬è¢«TMå‘ŠçŸ¥è¦å‡†å¤‡æäº¤ã€‚è¿™æ„å‘³ç€ç”¨äºç®¡ç†åˆ†æ”¯çš„æ¯ä¸ªRMä¼šè®°å½•å¯¹äºè¢«ç¨³å®šä¿å­˜çš„åˆ†æ”¯çš„è¡ŒåŠ¨ã€‚åˆ†æ”¯æŒ‡ç¤ºæ˜¯å¦å®ƒä»¬å¯ä»¥è¿™ä¹ˆåšã€‚è¿™äº›ç»“æœè¢«ç”¨äºç¬¬äºŒé˜¶æ®µã€‚</li>\n<li>åœ¨ç¬¬äºŒé˜¶æ®µï¼ŒTMå‘ŠçŸ¥RMSæ˜¯å¦è¦æäº¤æˆ–å›æ»šã€‚å¦‚æœåœ¨é¢„å¤‡åˆ†æ”¯æ—¶ï¼Œæ‰€æœ‰çš„åˆ†æ”¯æŒ‡ç¤ºå®ƒä»¬å°†èƒ½å¤Ÿæäº¤ï¼Œåˆ™æ‰€æœ‰çš„åˆ†æ”¯è¢«å‘ŠçŸ¥è¦æäº¤ã€‚å¦‚æœåœ¨é¢„å¤‡æ—¶ï¼Œæœ‰ä»»ä½•åˆ†æ”¯æŒ‡ç¤ºå®ƒå°†ä¸èƒ½æäº¤ï¼Œåˆ™æ‰€æœ‰åˆ†æ”¯è¢«å‘ŠçŸ¥å›æ»šã€‚åœ¨æœ‰äº›æƒ…å†µä¸‹ï¼Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡å¯èƒ½ä¼šä½¿ç”¨ä¸€é˜¶æ®µæäº¤ã€‚ä¾‹å¦‚ï¼Œå½“ä¸€ä¸ªäº‹åŠ¡ç®¡ç†å™¨å‘ç°ï¼Œä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡åªç”±ä¸€ä¸ªäº‹åŠ¡èµ„æºç»„æˆï¼ˆå³å•ä¸€åˆ†æ”¯ï¼‰ï¼Œåˆ™è¯¥èµ„æºå¯ä»¥è¢«å‘ŠçŸ¥åŒæ—¶è¿›è¡Œé¢„å¤‡å’Œæäº¤ã€‚</li>\n</ul>\n</li>\n</ul>\n<h3>12.8.2. åˆ†å¸ƒå¼äº‹åŠ¡è¯­æ³•</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å¯åŠ¨XAäº‹åŠ¡ã€‚xidæ˜¯ä¸€ä¸ªXAäº‹åŠ¡æ ‡è¯†ç¬¦ï¼Œç”¨æ¥å”¯ä¸€æ ‡è¯†ä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ã€‚xidå€¼ç”±å®¢æˆ·ç«¯æä¾›ï¼Œæˆ–ç”±MySQLæœåŠ¡å™¨ç”Ÿæˆ\n# xid å€¼åŒ…å« 1ï½3 ä¸ªéƒ¨åˆ†ï¼šgtrid [, bqual [, formatID ]]\n# gtridåˆ†å¸ƒå¼äº‹åŠ¡æ ‡è¯†ç¬¦ï¼Œç›¸åŒçš„åˆ†å¸ƒå¼äº‹åŠ¡åº”è¯¥ä½¿ç”¨ç›¸åŒçš„gtridï¼Œè¡¨ç¤ºxaäº‹åŠ¡å±äºå“ªä¸ªåˆ†å¸ƒå¼äº‹åŠ¡\n# bqualåˆ†æ”¯é™å®šç¬¦ï¼Œé»˜è®¤å€¼æ˜¯ç©ºä¸²ã€‚å¯¹äºä¸€ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡ä¸­çš„æ¯ä¸ªåˆ†æ”¯äº‹åŠ¡ï¼Œbqualå€¼å¿…é¡»å”¯ä¸€\n# formatID æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œç”¨äºæ ‡è¯†ç”± gtrid å’Œ bqual å€¼ä½¿ç”¨çš„æ ¼å¼ï¼Œé»˜è®¤å€¼æ˜¯1\nmysql&gt; XA {START|BEGIN} xid [JOIN|RESUME] \n\n# æ ‡è¯†XAäº‹åŠ¡ï¼Œç„¶åä½¿äº‹åŠ¡è¿›å…¥ PREPARE çŠ¶æ€ï¼Œä¸¤é˜¶æ®µæäº¤çš„ç¬¬ä¸€ä¸ªæäº¤é˜¶æ®µã€‚\nmysql&gt; XA END xid [SUSPEND [FOR MIGRATE]]\nmysql&gt; XA PREPARE xid\n\n# æäº¤æˆ–è€…å›æ»šå…·ä½“çš„åˆ†æ”¯äº‹åŠ¡ã€‚ä¸¤é˜¶æ®µæäº¤çš„ç¬¬äºŒä¸ªæäº¤é˜¶æ®µï¼Œåˆ†æ”¯äº‹åŠ¡è¢«å®é™…çš„æäº¤æˆ–è€…å›æ»š\nmysql&gt; XA COMMIT xid [ONE PHASE]\nmysql&gt; XA ROLLBACK xid\n\n# è¿”å›å½“å‰æ•°æ®åº“ä¸­å¤„äºPREPAREçŠ¶æ€çš„åˆ†æ”¯äº‹åŠ¡çš„è¯¦ç»†ä¿¡æ¯\nmysql&gt; XA RECOVER \n</code></pre></div><h3>12.8.3. åˆ†å¸ƒå¼äº‹åŠ¡å­˜åœ¨çš„é—®é¢˜</h3>\n<ul>\n<li>åˆ†å¸ƒå¼çš„å…³é”®åœ¨äºå¦‚ä½•ç¡®ä¿åˆ†å¸ƒå¼äº‹åŠ¡çš„å®Œæ•´æ€§ï¼Œä»¥åŠåœ¨æŸä¸ªåˆ†æ”¯å‡ºç°é—®é¢˜æ—¶çš„æ•…éšœè§£å†³ã€‚</li>\n<li>å¦‚æœåˆ†æ”¯äº‹åŠ¡åœ¨è¾¾åˆ° prepare çŠ¶æ€æ—¶ï¼Œæ•°æ®åº“å¼‚å¸¸é‡æ–°å¯åŠ¨ï¼ŒæœåŠ¡å™¨é‡æ–°å¯åŠ¨ä»¥åï¼Œå¯ä»¥ç»§ç»­å¯¹åˆ†æ”¯äº‹åŠ¡è¿›è¡Œæäº¤æˆ–è€…å›æ»šå¾—æ“ä½œï¼Œä½†æ˜¯æäº¤çš„äº‹åŠ¡æ²¡æœ‰å†™ binlogï¼Œå­˜åœ¨ä¸€å®šçš„éšæ‚£ï¼Œå¯èƒ½å¯¼è‡´ä½¿ç”¨ binlog æ¢å¤ä¸¢å¤±éƒ¨åˆ†æ•°æ®ã€‚å¦‚æœå­˜åœ¨å¤åˆ¶çš„æ•°æ®åº“ï¼Œåˆ™æœ‰å¯èƒ½å¯¼è‡´ä¸»ä»æ•°æ®åº“çš„æ•°æ®ä¸ä¸€è‡´</li>\n<li>å¦‚æœåˆ†æ”¯äº‹åŠ¡çš„å®¢æˆ·ç«¯è¿æ¥å¼‚å¸¸ä¸­æ­¢ï¼Œé‚£ä¹ˆæ•°æ®åº“ä¼šè‡ªåŠ¨å›æ»šæœªå®Œæˆçš„åˆ†æ”¯äº‹åŠ¡ï¼Œå¦‚æœæ­¤æ—¶åˆ†æ”¯äº‹åŠ¡å·²ç»æ‰§è¡Œåˆ° prepare çŠ¶æ€ï¼Œé‚£ä¹ˆè¿™ä¸ªåˆ†å¸ƒå¼äº‹åŠ¡çš„å…¶ä»–åˆ†æ”¯å¯èƒ½å·²ç»æˆåŠŸæäº¤ï¼Œå¦‚æœè¿™ä¸ªåˆ†æ”¯å›æ»šï¼Œå¯èƒ½å¯¼è‡´åˆ†å¸ƒå¼äº‹åŠ¡çš„ä¸å®Œæ•´ï¼Œä¸¢å¤±éƒ¨åˆ†åˆ†æ”¯äº‹åŠ¡çš„å†…å®¹ã€‚</li>\n<li>å¦‚æœåˆ†æ”¯äº‹åŠ¡åœ¨æ‰§è¡Œåˆ° prepare çŠ¶æ€æ—¶ï¼Œæ•°æ®åº“å¼‚å¸¸ï¼Œä¸”ä¸èƒ½å†æ­£å¸¸å¯åŠ¨ï¼Œéœ€è¦ä½¿ç”¨å¤‡ä»½å’Œ binlog æ¥æ¢å¤æ•°æ®ï¼Œé‚£ä¹ˆé‚£äº›åœ¨ prepare çŠ¶æ€çš„åˆ†æ”¯äº‹åŠ¡å› ä¸ºå¹¶æ²¡æœ‰è®°å½•åˆ° binlogï¼Œæ‰€ä»¥ä¸èƒ½é€šè¿‡ binlog è¿›è¡Œæ¢å¤ï¼Œåœ¨æ•°æ®åº“æ¢å¤åï¼Œå°†ä¸¢å¤±è¿™éƒ¨åˆ†çš„æ•°æ®ã€‚</li>\n</ul>\n<h1>13. MYSQLé”</h1>\n<ul>\n<li>MyISAMå’ŒMEMORYå­˜å‚¨å¼•æ“é‡‡ç”¨çš„æ˜¯è¡¨çº§é”ï¼ˆtable-level lockingï¼‰ï¼ŒåŒä¸€å¼ è¡¨ä¸Šä»»ä½•æ—¶åˆ»åªèƒ½æœ‰ä¸€ä¸ªæ›´æ–°åœ¨æ‰§è¡Œï¼Œå½±å“ä¸šåŠ¡å¹¶å‘åº¦</li>\n<li>BDBå­˜å‚¨å¼•æ“é‡‡ç”¨çš„æ˜¯é¡µé¢é”ï¼ˆpage-level lockingï¼‰</li>\n<li>InnoDBå­˜å‚¨å¼•æ“é»˜è®¤è¡Œçº§é”ï¼ˆrow-level lockingï¼‰ï¼Œä¹Ÿæ”¯æŒè¡¨çº§é”ï¼Œä½†é»˜è®¤é‡‡ç”¨è¡Œçº§é”</li>\n<li>è¡¨çº§é”æ›´é€‚åˆäºä»¥æŸ¥è¯¢ä¸ºä¸»ï¼Œåªæœ‰å°‘é‡æŒ‰ç´¢å¼•æ¡ä»¶æ›´æ–°æ•°æ®çš„åº”ç”¨ï¼›è¡Œçº§é”åˆ™é€‚åˆäºæœ‰å¤§é‡æŒ‰ç´¢å¼•æ¡ä»¶å¹¶å‘æ›´æ–°å°‘é‡ä¸åŒæ•°æ®ï¼ŒåŒæ—¶åˆæœ‰å¹¶å‘æŸ¥è¯¢çš„åº”ç”¨</li>\n</ul>\n<h2>13.1. æŒ‰é”çš„ç²’åº¦åˆ†ç±»</h2>\n<h3>13.1.1. å…¨å±€é”</h3>\n<ul>\n<li>å…¨å±€é”(FTWRL)æ˜¯å¯¹æ•´ä¸ªæ•°æ®åº“å®ä¾‹åŠ é”ã€‚è®©æ•´ä¸ªåº“å¤„äºåªè¯»çŠ¶æ€ï¼Œä½¿ç”¨åœºæ™¯æ˜¯ä¸æ”¯æŒäº‹åŠ¡çš„å¼•æ“é€»è¾‘å¤‡ä»½</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å…¨å±€é”\nmysql&gt; flush tables with read lock \n# ä¸»åŠ¨é‡Šæ”¾é”ã€‚ä¹Ÿå¯ä»¥åœ¨å®¢æˆ·ç«¯æ–­å¼€çš„æ—¶å€™è‡ªåŠ¨é‡Šæ”¾\nmysql&gt; unlock tables\n</code></pre></div><h3>13.1.2. è¡¨çº§é”</h3>\n<h4>13.1.2.1. å…ƒæ•°æ®é”MDL(meta data lock)</h4>\n<ul>\n<li>åœ¨è®¿é—®ä¸€ä¸ªè¡¨çš„æ—¶å€™ä¼šè¢«è‡ªåŠ¨åŠ ä¸Šã€‚ä¸ºäº†ä¿è¯è¯»å†™çš„æ­£ç¡®æ€§ã€‚å½“å¯¹ä¸€ä¸ªè¡¨åšå¢åˆ æ”¹æŸ¥æ“ä½œçš„æ—¶å€™ï¼ŒåŠ MDLè¯»é”ï¼›å½“è¦å¯¹è¡¨åšç»“æ„å˜æ›´æ“ä½œçš„æ—¶å€™ï¼ŒåŠ MDLå†™é”ã€‚è¯»é”ä¹‹é—´ä¸äº’æ–¥ï¼Œè¯»å†™é”ä¹‹é—´ã€å†™é”ä¹‹é—´æ˜¯äº’æ–¥çš„ï¼Œç”¨æ¥ä¿è¯å˜æ›´è¡¨ç»“æ„æ“ä½œçš„å®‰å…¨æ€§ã€‚å› æ­¤ï¼Œå¦‚æœæœ‰ä¸¤ä¸ªçº¿ç¨‹è¦åŒæ—¶ç»™ä¸€ä¸ªè¡¨åŠ å­—æ®µï¼Œå…¶ä¸­ä¸€ä¸ªè¦ç­‰å¦ä¸€ä¸ªæ‰§è¡Œå®Œæ‰èƒ½å¼€å§‹æ‰§è¡Œ</li>\n<li>äº‹åŠ¡ä¸­çš„MDLé”åœ¨è¯­å¥æ‰§è¡Œæ˜¯ç”³è¯·ï¼Œäº‹åŠ¡æäº¤æ—¶æ‰é‡Šæ”¾</li>\n</ul>\n<h4>13.1.2.2. MyISAMè¡¨é”</h4>\n<ul>\n<li>MyISAM å­˜å‚¨å¼•æ“åªæ”¯æŒè¡¨é”</li>\n<li>æŸ¥è¯¢è¡¨çº§é”äº‰ç”¨æƒ…å†µshow status like 'table%'ï¼Œå¦‚æœTable_locks_waitedå€¼æ¯”è¾ƒé«˜ï¼Œåˆ™å­˜åœ¨ç€è¾ƒä¸¥é‡çš„è¡¨çº§é”äº‰ç”¨æƒ…å†µ</li>\n<li>è¡¨çº§é”çš„é”æ¨¡å¼åŒ…æ‹¬ï¼šè¡¨å…±äº«è¯»é”ï¼ˆTable Read Lockï¼‰å’Œè¡¨ç‹¬å å†™é”ï¼ˆTable Write Lockï¼‰ã€‚è¯»æ“ä½œä¸å†™æ“ä½œä¹‹é—´ï¼Œä»¥åŠå†™æ“ä½œä¹‹é—´æ˜¯ä¸²è¡Œçš„ï¼è¯»è¯»æ“ä½œæ˜¯å¹¶è¡Œçš„</li>\n<li>lock table è¡¨å write/read [local];ä½¿ç”¨unlock tablesæˆ–è€…å®¢æˆ·ç«¯æ–­å¼€çš„æ—¶å€™é‡Šæ”¾ã€‚åˆ«çš„çº¿ç¨‹çš„ä¼šè¢«é˜»å¡ï¼Œlocalè¡¨ç¤ºåœ¨æ»¡è¶³ MyISAM è¡¨å¹¶å‘æ’å…¥æ¡ä»¶çš„æƒ…å†µä¸‹ï¼Œå…è®¸å…¶ä»–ç”¨æˆ·åœ¨è¡¨å°¾å¹¶å‘æ’å…¥è®°å½•</li>\n<li>MyISAM åœ¨æ‰§è¡ŒæŸ¥è¯¢è¯­å¥ï¼ˆSELECTï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„æ‰€æœ‰è¡¨åŠ è¯»é”ï¼Œåœ¨æ‰§è¡Œæ›´æ–°æ“ä½œï¼ˆUPDATEã€DELETEã€INSERT ç­‰ï¼‰å‰ï¼Œä¼šè‡ªåŠ¨ç»™æ¶‰åŠçš„è¡¨åŠ å†™é”ï¼Œç”¨æˆ·ä¸€èˆ¬ä¸éœ€è¦ç›´æ¥ç”¨ LOCK TABLE å‘½ä»¤ç»™ MyISAM è¡¨æ˜¾å¼åŠ é”ã€‚æ˜¾ç¤ºåŠ é”ä¸€èˆ¬æ˜¯ä¸ºäº†äº‹åŠ¡ï¼Œå®ç°å¯¹æŸä¸€æ—¶é—´ç‚¹å¤šä¸ªè¡¨çš„ä¸€è‡´æ€§è¯»å–</li>\n<li>åœ¨ç”¨ LOCK TABLES ç»™è¡¨æ˜¾å¼åŠ è¡¨é”æ—¶ï¼Œå¿…é¡»åŒæ—¶å–å¾—æ‰€æœ‰æ¶‰åŠåˆ°è¡¨çš„é”ï¼Œåœ¨æ‰§è¡Œ LOCK TABLES åï¼Œåªèƒ½è®¿é—®æ˜¾å¼åŠ é”çš„è¿™äº›è¡¨ï¼Œä¸èƒ½è®¿é—®æœªåŠ é”çš„è¡¨ï¼›åŒæ—¶ï¼Œå¦‚æœåŠ çš„æ˜¯è¯»é”ï¼Œé‚£ä¹ˆåªèƒ½æ‰§è¡ŒæŸ¥è¯¢æ“ä½œï¼Œè€Œä¸èƒ½æ‰§è¡Œæ›´æ–°æ“ä½œã€‚å…¶å®ï¼Œåœ¨è‡ªåŠ¨åŠ é”çš„æƒ…å†µä¸‹ä¹ŸåŸºæœ¬å¦‚æ­¤ï¼ŒMyISAM æ€»æ˜¯ä¸€æ¬¡è·å¾— SQL è¯­å¥æ‰€éœ€è¦çš„å…¨éƒ¨é”ã€‚å› æ­¤ä¸ä¼šå‡ºç°æ­»é”ï¼ˆDeadlock Freeï¼‰ã€‚å½“ä½¿ç”¨ LOCK TABLES æ—¶ï¼Œä¸ä»…éœ€è¦ä¸€æ¬¡é”å®šç”¨åˆ°çš„æ‰€æœ‰è¡¨ï¼Œä¸”åŒä¸€ä¸ªè¡¨åœ¨SQLè¯­å¥ä¸­å‡ºç°å¤šå°‘æ¬¡ï¼Œå°±è¦é€šè¿‡ä¸SQLè¯­å¥ä¸­ç›¸åŒçš„åˆ«åé”å®šå¤šå°‘æ¬¡ï¼Œå¦åˆ™ä¹Ÿä¼šå‡ºé”™ï¼</li>\n<li>å¹¶å‘æ’å…¥ï¼ˆConcurrent Insertsï¼‰\n<ul>\n<li>ç³»ç»Ÿå˜é‡concurrent_insertæ§åˆ¶MyISAMå­˜å‚¨å¼•æ“å¹¶å‘æ’å…¥,\n<ul>\n<li>0/NEVERåˆ™ä¸å…è®¸å¹¶å‘æ’å…¥ã€‚</li>\n<li>1/AUTO å¦‚æœMyISAMè¡¨ä¸­æ²¡æœ‰ç©ºæ´ï¼ˆå³è¡¨çš„ä¸­é—´æ²¡æœ‰è¢«åˆ é™¤çš„è¡Œï¼‰ï¼ŒMyISAMå…è®¸åœ¨ä¸€ä¸ªè¿›ç¨‹è¯»è¡¨çš„åŒæ—¶ï¼Œå¦ä¸€ä¸ªè¿›ç¨‹ä»è¡¨å°¾æ’å…¥è®°å½•ã€‚é»˜è®¤</li>\n<li>2/ALWAYS ï¼Œæ— è®ºMyISAMè¡¨ä¸­æœ‰æ²¡æœ‰ç©ºæ´ï¼Œéƒ½å…è®¸åœ¨è¡¨å°¾å¹¶å‘æ’å…¥è®°å½•</li>\n</ul>\n</li>\n<li>å¯ä»¥åˆ©ç”¨MyISAMå­˜å‚¨å¼•æ“çš„å¹¶å‘æ’å…¥ç‰¹æ€§ï¼Œæ¥è§£å†³åº”ç”¨ä¸­å¯¹åŒä¸€è¡¨æŸ¥è¯¢å’Œæ’å…¥çš„é”äº‰ç”¨ã€‚ä¾‹å¦‚è®¾ä¸º2ï¼Œæ€»æ˜¯å…è®¸å¹¶å‘æ’å…¥ï¼›åŒæ—¶ï¼Œé€šè¿‡å®šæœŸåœ¨ç³»ç»Ÿç©ºé—²æ—¶æ®µæ‰§è¡ŒOPTIMIZE TABLEè¯­å¥æ¥æ•´ç†ç©ºé—´ç¢ç‰‡ï¼Œæ”¶å›å› åˆ é™¤è®°å½•è€Œäº§ç”Ÿçš„ä¸­é—´ç©ºæ´</li>\n</ul>\n</li>\n<li>MyISAMé”è°ƒåº¦\n<ul>\n<li>å†™ä¼˜å…ˆè°ƒåº¦æœºåˆ¶ï¼šè¿›ç¨‹åŒæ—¶è¯·æ±‚è¯»é”å’Œå†™é”ï¼Œå†™è¿›ç¨‹å…ˆè·å¾—é”ï¼›å³ä½¿è¯»è¯·æ±‚å…ˆåˆ°é”ç­‰å¾…é˜Ÿåˆ—ï¼Œå†™è¯·æ±‚ååˆ°ï¼Œå†™é”ä¹Ÿä¼šæ’åˆ°è¯»é”è¯·æ±‚ä¹‹å‰ï¼MySQLè®¤ä¸ºå†™è¯·æ±‚ä¸€èˆ¬æ¯”è¯»è¯·æ±‚è¦é‡è¦ã€‚å› æ­¤MyISAM è¡¨ä¸å¤ªé€‚åˆäºæœ‰å¤§é‡æ›´æ–°æ“ä½œå’ŒæŸ¥è¯¢æ“ä½œåº”ç”¨ï¼Œå› ä¸ºï¼Œå¤§é‡çš„æ›´æ–°æ“ä½œä¼šé€ æˆæŸ¥è¯¢æ“ä½œå¾ˆéš¾è·å¾—è¯»é”ï¼Œä»è€Œå¯èƒ½æ°¸è¿œé˜»å¡ã€‚</li>\n<li>é€šè¿‡æŒ‡å®šå¯åŠ¨å‚æ•°low-priority-updatesï¼Œä½¿MyISAMå¼•æ“é»˜è®¤ç»™äºˆè¯»è¯·æ±‚ä»¥ä¼˜å…ˆçš„æƒåˆ©ã€‚</li>\n<li>é€šè¿‡æ‰§è¡Œå‘½ä»¤SET LOW_PRIORITY_UPDATES=1ï¼Œä½¿è¯¥è¿æ¥å‘å‡ºçš„æ›´æ–°è¯·æ±‚ä¼˜å…ˆçº§é™ä½ã€‚</li>\n<li>é€šè¿‡æŒ‡å®šINSERTã€UPDATEã€DELETEè¯­å¥çš„LOW_PRIORITYå±æ€§ï¼Œé™ä½è¯¥è¯­å¥çš„ä¼˜å…ˆçº§ã€‚</li>\n<li>ç³»ç»Ÿå‚æ•°max_write_lock_countè®¾ç½®ä¸€ä¸ªåˆé€‚çš„å€¼ï¼Œå½“ä¸€ä¸ªè¡¨çš„è¯»é”è¾¾åˆ°è¿™ä¸ªå€¼åï¼ŒMySQLå°±æš‚æ—¶å°†å†™è¯·æ±‚çš„ä¼˜å…ˆçº§é™ä½ï¼Œç»™è¯»è¿›ç¨‹ä¸€å®šè·å¾—é”çš„æœºä¼šã€‚</li>\n</ul>\n</li>\n<li>ä¸€äº›éœ€è¦é•¿æ—¶é—´è¿è¡Œçš„æŸ¥è¯¢æ“ä½œï¼Œä¹Ÿä¼šä½¿å†™è¿›ç¨‹â€œé¥¿æ­»â€ï¼å› æ­¤ï¼Œåº”ç”¨ä¸­åº”å°½é‡é¿å…å‡ºç°é•¿æ—¶é—´è¿è¡Œçš„æŸ¥è¯¢æ“ä½œï¼Œä¸è¦æ€»æƒ³ç”¨ä¸€æ¡SELECTè¯­å¥æ¥è§£å†³é—®é¢˜ï¼Œå› ä¸ºè¿™ç§çœ‹ä¼¼å·§å¦™çš„SQLè¯­å¥ï¼Œå¾€å¾€æ¯”è¾ƒå¤æ‚ï¼Œæ‰§è¡Œæ—¶é—´è¾ƒé•¿ï¼Œåœ¨å¯èƒ½çš„æƒ…å†µä¸‹å¯ä»¥é€šè¿‡ä½¿ç”¨ä¸­é—´è¡¨ç­‰æªæ–½å¯¹SQLè¯­å¥åšä¸€å®šçš„â€œåˆ†è§£â€ï¼Œä½¿æ¯ä¸€æ­¥æŸ¥è¯¢éƒ½èƒ½åœ¨è¾ƒçŸ­æ—¶é—´å®Œæˆï¼Œä»è€Œå‡å°‘é”å†²çªã€‚å¦‚æœå¤æ‚æŸ¥è¯¢ä¸å¯é¿å…ï¼Œåº”å°½é‡å®‰æ’åœ¨æ•°æ®åº“ç©ºé—²æ—¶æ®µæ‰§è¡Œï¼Œæ¯”å¦‚ä¸€äº›å®šæœŸç»Ÿè®¡å¯ä»¥å®‰æ’åœ¨å¤œé—´æ‰§è¡Œã€‚</li>\n</ul>\n<h4>13.1.2.3. InnoDBä»€ä¹ˆæ—¶å€™ä½¿ç”¨è¡¨é”</h4>\n<ul>\n<li>æƒ…å†µ1ï¼šäº‹åŠ¡éœ€è¦æ›´æ–°å¤§è¡¨å¤§é‡æ•°æ®ï¼Œå¦‚æœä½¿ç”¨é»˜è®¤çš„è¡Œé”ï¼Œäº‹åŠ¡æ‰§è¡Œæ•ˆç‡ä½ï¼Œå¯èƒ½é€ æˆå…¶ä»–äº‹åŠ¡é•¿æ—¶é—´é”ç­‰å¾…å’Œé”å†²çª</li>\n<li>æƒ…å†µ2ï¼šäº‹åŠ¡æ¶‰åŠå¤šä¸ªè¡¨ï¼Œå¯èƒ½å¼•èµ·æ­»é”ï¼Œé€ æˆå¤§é‡äº‹åŠ¡å›æ»šã€‚å¯ä»¥è€ƒè™‘ä¸€æ¬¡æ€§é”å®šäº‹åŠ¡æ¶‰åŠçš„è¡¨</li>\n<li>InnoDBä½¿ç”¨è¡¨é”æ³¨æ„ç‚¹\n<ul>\n<li>LOCK TABLESç»™InnoDBåŠ è¡¨çº§é”ï¼Œç”±Serverå±‚è´Ÿè´£ï¼Œä»…å½“autocommit=0ã€innodb_table_locks=1ï¼ˆé»˜è®¤ï¼‰æ—¶ï¼ŒInnoDBæ‰ä¼šç»™MySQLåŠ çš„è¡¨é”ï¼ŒServerå±‚ä¹Ÿæ‰èƒ½æ„ŸçŸ¥InnoDBåŠ çš„è¡Œé”ï¼ŒInnoDBæ‰èƒ½è‡ªåŠ¨è¯†åˆ«æ¶‰åŠè¡¨çº§é”çš„æ­»é”ï¼›å¦åˆ™ï¼ŒInnoDBå°†æ— æ³•è‡ªåŠ¨æ£€æµ‹å¹¶å¤„ç†è¿™ç§æ­»é”</li>\n<li>äº‹åŠ¡ç»“æŸå‰ï¼Œä¸è¦ç”¨UNLOCK TABLESé‡Šæ”¾è¡¨é”ï¼Œå› ä¸ºä¼šéšå«åœ°æäº¤äº‹åŠ¡ï¼›COMMITæˆ–ROLLBACKå¹¶ä¸èƒ½é‡Šæ”¾ç”¨LOCK TABLES åŠ çš„è¡¨çº§é”ï¼Œå¿…é¡»ç”¨UNLOCK TABLESé‡Šæ”¾</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å†™è¡¨ t1 å¹¶ä»è¡¨ t è¯»\nSET AUTOCOMMIT=0;\nLOCK TABLES t1 WRITE, t2 READ, ...;\n[do something with tables t1 and t2 here];\nCOMMIT;\nUNLOCK TABLES;\n</code></pre></div><h3>13.1.3. InnoDBè¡Œé”</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># æŸ¥çœ‹InnoDBè¡Œé”äº‰ç”¨æƒ…å†µï¼ˆå¦‚ InnoDB_row_lock_waits å’Œ InnoDB_row_lock_time_avgï¼‰\nmysql&gt; show status like 'innodb_row_lock%';\n# å¦‚æœå‘ç°é”äº‰ç”¨æ¯”è¾ƒä¸¥é‡ï¼Œå¯é€šè¿‡è®¾ç½®InnoDB Monitorsæ¥è¿›ä¸€æ­¥è§‚å¯Ÿå‘ç”Ÿé”å†²çªçš„è¡¨ã€æ•°æ®è¡Œç­‰ï¼Œå¹¶åˆ†æé”äº‰ç”¨çš„åŸå› \n# è®¾ç½®ç›‘è§†å™¨\nCREATE TABLE innodb_monitor(a INT) ENGINE=INNODB;\n# æŸ¥çœ‹ç›‘è§†å™¨\nshow engine innodb status;\n# å…³é—­ç›‘è§†å™¨\nDROP TABLE innodb_monitor;\n# è®¾ç½®ç›‘è§†å™¨åï¼Œåœ¨ SHOW INNODB STATUS çš„æ˜¾ç¤ºå†…å®¹ä¸­ï¼Œä¼šæœ‰è¯¦ç»†çš„å½“å‰é”ç­‰å¾…çš„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨åã€é”ç±»å‹ã€é”å®šè®°å½•çš„æƒ…å†µç­‰ï¼Œä¾¿äºè¿›è¡Œè¿›ä¸€æ­¥çš„åˆ†æå’Œé—®é¢˜çš„ç¡®å®šã€‚æ‰“å¼€ç›‘è§†å™¨ä»¥åï¼Œé»˜è®¤æƒ…å†µä¸‹æ¯ 15 ç§’ä¼šå‘æ—¥å¿—ä¸­è®°å½•ç›‘æ§çš„å†…å®¹ï¼Œå¦‚æœé•¿æ—¶é—´æ‰“å¼€ä¼šå¯¼è‡´.err æ–‡ä»¶å˜å¾—éå¸¸çš„å·¨å¤§ï¼Œæ‰€ä»¥ç”¨æˆ·åœ¨ç¡®è®¤é—®é¢˜åŸå› ä¹‹åï¼Œè¦è®°å¾—åˆ é™¤ç›‘æ§è¡¨ä»¥å…³é—­ç›‘è§†å™¨\n</code></pre></div><ul>\n<li>ä¸¤é˜¶æ®µé”åè®®ï¼šåœ¨InnoDBäº‹åŠ¡ä¸­ï¼Œè¡Œé”æ˜¯åœ¨éœ€è¦çš„æ—¶å€™æ‰åŠ ä¸Šçš„ï¼Œç­‰åˆ°äº‹åŠ¡ç»“æŸæ—¶æ‰é‡Šæ”¾ã€‚</li>\n<li>å¦‚æœä½ çš„äº‹åŠ¡ä¸­éœ€è¦é”å¤šä¸ªè¡Œï¼Œè¦æŠŠæœ€å¯èƒ½é€ æˆé”å†²çªã€æœ€å¯èƒ½å½±å“å¹¶å‘åº¦çš„é”å°½é‡å¾€åæ”¾</li>\n<li>æœåŠ¡å™¨CPUæ¶ˆè€—æ¥è¿‘100%ï¼Œä½†æ•´ä¸ªæ•°æ®åº“æ¯ç§’å°±æ‰§è¡Œä¸åˆ°100ä¸ªäº‹åŠ¡ã€‚è¿™æ˜¯ä»€ä¹ˆåŸå› å‘¢ï¼Ÿå¯èƒ½æ˜¯æ­»é”äº†</li>\n</ul>\n<h4>13.1.3.1. InnoDB è¡Œé”å®ç°æ–¹å¼</h4>\n<ul>\n<li>InnoDBè¡Œé”æ˜¯é€šè¿‡ç»™ç´¢å¼•å¯¹åº”çš„è®°å½•æ‰€è¦ç´¢å¼•å€¼åŠ é”æ¥å®ç°çš„ï¼ŒOracleæ˜¯é€šè¿‡åœ¨æ•°æ®å—ä¸­å¯¹ç›¸åº”æ•°æ®è¡ŒåŠ é”æ¥å®ç°çš„</li>\n<li>InnoDBè¡Œé”åœ¨ä¸é€šè¿‡ç´¢å¼•æ¡ä»¶æŸ¥è¯¢çš„æ—¶å€™ï¼Œä½¿ç”¨çš„æ˜¯è¡¨é”</li>\n<li>æ˜¯å¦ä½¿ç”¨ç´¢å¼•æ¥æ£€ç´¢æ•°æ®æ˜¯ç”± MySQL é€šè¿‡åˆ¤æ–­ä¸åŒæ‰§è¡Œè®¡åˆ’çš„ä»£ä»·æ¥å†³å®šçš„ã€‚å¦‚æœ MySQL è®¤ä¸ºå…¨è¡¨æ‰«ææ•ˆç‡æ›´é«˜ï¼Œæ¯”å¦‚å¯¹ä¸€äº›å¾ˆå°çš„è¡¨ï¼Œå®ƒå°±ä¸ä¼šä½¿ç”¨ç´¢å¼•ï¼ŒInnoDBå°†ä½¿ç”¨è¡¨é”</li>\n</ul>\n<h2>13.2. æŒ‰é”çš„ç±»å‹åˆ†ç±»</h2>\n<h3>13.2.1. è¯»å†™é”(è¡Œé”æ¨¡å¼)</h3>\n<ul>\n<li>å…±äº«é”(S)/è¯»é”ï¼šäº‹åŠ¡åœ¨è¯»å–è®°å½•çš„æ—¶å€™è·å–å…±äº«é”ï¼Œå…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è·å–ã€‚SELECT * FROM è¡¨å WHEREæ¡ä»¶ LOCK IN SHARE MODE</li>\n<li>æ’ä»–é”(X)/å†™é”ï¼šäº‹åŠ¡åœ¨ä¿®æ”¹è®°å½•çš„æ—¶å€™è·å–æ’ä»–é”ï¼Œä¸å…è®¸å¤šä¸ªäº‹åŠ¡åŒæ—¶è·å–ã€‚SELECT * FROM è¡¨å WHEREæ¡ä»¶ FOR UPDATE</li>\n<li>å…±äº«é”ä¸»è¦ç”¨åœ¨éœ€è¦æ•°æ®ä¾å­˜å…³ç³»æ—¶æ¥ç¡®è®¤æŸè¡Œè®°å½•æ˜¯å¦å­˜åœ¨ï¼Œå¹¶ç¡®ä¿æ²¡æœ‰å…¶ä»–äº‹åŠ¡å¯¹è¿™ä¸ªè®°å½•è¿›è¡ŒUPDATEæˆ–è€…DELETEæ“ä½œã€‚ä½†æ˜¯å¦‚æœå½“å‰äº‹åŠ¡ä¹Ÿéœ€è¦å¯¹è¯¥è®°å½•è¿›è¡Œæ›´æ–°æ“ä½œï¼Œåˆ™å¾ˆæœ‰å¯èƒ½é€ æˆæ­»é”ï¼Œå¯¹äºé”å®šè¡Œè®°å½•åéœ€è¦è¿›è¡Œæ›´æ–°æ“ä½œçš„åº”ç”¨ï¼Œåº”è¯¥ä½¿ç”¨ SELECT... FOR UPDATE æ–¹å¼è·å¾—æ’ä»–é”</li>\n</ul>\n<h3>13.2.2. æ„å‘é”(è¡¨é”æ¨¡å¼)</h3>\n<ul>\n<li>æ ¹æ®è¡¨ä¸­çš„è®°å½•æ²¡æœ‰è¡Œé”å¹¶å¿«é€Ÿåˆ¤æ–­æ˜¯å¦å¯ä»¥å¯¹æŸä¸ªè¡¨ä½¿ç”¨è¡¨é”ã€‚</li>\n<li>æ„å‘å…±äº«é”(Intention Shared Lock,IS)äº‹åŠ¡æ‰“ç®—ç»™æ•°æ®è¡ŒåŠ è¡Œå…±äº«é”(Sé”)ï¼ŒåŠ å…±äº«é”å‰å¿…é¡»å…ˆå–å¾—è¯¥è¡¨çš„ISé”</li>\n<li>æ„å‘æ’ä»–é”(Intention Exclusive Lockï¼ŒIX)äº‹åŠ¡æ‰“ç®—ç»™æ•°æ®è¡ŒåŠ è¡Œæ’ä»–é”(xé”)ï¼ŒåŠ æ’ä»–é”å‰å¿…é¡»å…ˆå–å¾—è¯¥è¡¨çš„IXé”</li>\n<li>æ„å‘é”æ˜¯InnoDBè‡ªåŠ¨åŠ çš„ï¼Œæ— æ³•æ‰‹åŠ¨æ“ä½œï¼Œåœ¨ä¸ºæ•°æ®è¡ŒåŠ å…±äº«/æ’ä»–é”ä¹‹å‰ï¼ŒInooDBä¼šå…ˆè·å–è¯¥æ•°æ®è¡Œæ‰€åœ¨åœ¨æ•°æ®è¡¨çš„å¯¹åº”æ„å‘é”</li>\n</ul>\n<h3>13.2.3. è¯»å†™é”ä¸æ„å‘é”å…¼å®¹æ€§</h3>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/68a4a42572c418a19750a.png\" alt=\"MYSQLè¡Œé”å…¼å®¹æ€§.PNG\" tabindex=\"0\"><figcaption>MYSQLè¡Œé”å…¼å®¹æ€§.PNG</figcaption></figure>\n<ul>\n<li>Xä¸ä»»ä½•é”å†²çªï¼ŒIXä¸Så†²çªï¼Œå…¶ä»–éƒ½å…¼å®¹</li>\n</ul>\n<h2>13.3. InnoDBä¸­è¡Œé”å®šçš„æ–¹å¼</h2>\n<h3>13.3.1. è®°å½•é”ï¼ˆRecord Lockï¼‰</h3>\n<h3>13.3.2. é—´éš™é”ï¼ˆGap Lockï¼‰</h3>\n<h3>13.3.3. ä¸´é”®é”ï¼ˆNext-Key é”ï¼‰</h3>\n<ul>\n<li>ä½¿ç”¨ç”¨èŒƒå›´æ¡ä»¶è€Œä¸æ˜¯ç›¸ç­‰æ¡ä»¶æ£€ç´¢æ•°æ®å¹¶è¯·æ±‚å…±äº«æˆ–æ’ä»–é”æ—¶ï¼ŒInnoDBä¼šç»™ç¬¦åˆæ¡ä»¶çš„å·²æœ‰æ•°æ®è®°å½•çš„ç´¢å¼•é¡¹åŠ é”ï¼›ä¹Ÿä¼šå¯¹é”®å€¼åœ¨æ¡ä»¶èŒƒå›´å†…ä½†å¹¶ä¸å­˜åœ¨çš„è®°å½•ï¼Œå«åšâ€œé—´éš™(GAP)â€ï¼ŒåŠ é”ï¼Œè¿™ç§é”æœºåˆ¶å°±æ˜¯é—´éš™é”ï¼ˆNext-Keyé”ï¼‰</li>\n<li>é—´éš™é”çš„ç›®çš„ï¼Œä¸ºäº†é˜²æ­¢å¹»è¯»ï¼Œä»¥æ»¡è¶³ç›¸å…³éš”ç¦»çº§åˆ«çš„è¦æ±‚ï¼Œä¹Ÿä¸ºäº†æ»¡è¶³å…¶æ¢å¤å’Œå¤åˆ¶çš„éœ€è¦ã€‚</li>\n<li>åœ¨ä½¿ç”¨èŒƒå›´æ¡ä»¶æ£€ç´¢å¹¶é”å®šè®°å½•æ—¶ï¼ŒInnoDB è¿™ç§åŠ é”æœºåˆ¶ä¼šé˜»å¡ç¬¦åˆæ¡ä»¶èŒƒå›´å†…é”®å€¼çš„å¹¶å‘æ’å…¥ï¼Œå¾€å¾€ä¼šé€ æˆä¸¥é‡çš„é”ç­‰å¾…ã€‚å› æ­¤ï¼Œåº”ç”¨å¼€å‘è¦å°½é‡ä¼˜åŒ–ä¸šåŠ¡é€»è¾‘ï¼Œå°½é‡ä½¿ç”¨ç›¸ç­‰æ¡ä»¶æ¥è®¿é—®æ›´æ–°æ•°æ®ï¼Œé¿å…ä½¿ç”¨èŒƒå›´æ¡ä»¶</li>\n<li>å¦‚æœä½¿ç”¨ç›¸ç­‰æ¡ä»¶è¯·æ±‚ç»™ä¸€ä¸ªä¸å­˜åœ¨çš„è®°å½•åŠ é”ï¼ŒInnoDBä¹Ÿä¼šä½¿ç”¨é—´éš™é”ï¼</li>\n<li>ä¸€ä¸ªç©ºè¡¨åªæœ‰ä¸€ä¸ªé—´éš™ï¼Œæ¯”å¦‚select * from t where id&gt;0 for update;åŠ é”çš„èŒƒå›´å°±æ˜¯next-key lock (-âˆ, supremum]</li>\n</ul>\n<h3>13.3.4. åŠ é”è§„åˆ™</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å¼€å¯é”ç›‘è§†å™¨\nSET GLOBAL innodb_status_output=ON;\nSET GLOBAL innodb_status_output_locks=ON;\n</code></pre></div><ul>\n<li>å¯é‡å¤è¯»éš”ç¦»çº§åˆ«(repeatable-read)ä¸‹ã€‚éµå®ˆä¸¤é˜¶æ®µé”åè®®ï¼Œæ‰€æœ‰åŠ é”çš„èµ„æºï¼Œéƒ½æ˜¯åœ¨äº‹åŠ¡æäº¤æˆ–è€…å›æ»šçš„æ—¶å€™æ‰é‡Šæ”¾çš„ã€‚åŠ é”çš„åŸºæœ¬å•ä½æ˜¯next-key lockã€‚å‰å¼€åé—­åŒºé—´ï¼ŒæŸ¥æ‰¾è¿‡ç¨‹ä¸­è®¿é—®åˆ°çš„å¯¹è±¡æ‰ä¼šåŠ é”ï¼ˆlimité™åˆ¶è®¿é—®å¯¹è±¡ä¹Ÿä¼šé™åˆ¶é”çš„èŒƒå›´ï¼‰</li>\n<li>æäº¤éš”ç¦»çº§åˆ«(read-committed)ä¸‹ï¼Œæ²¡æœ‰é—´éš™é”</li>\n<li>æ ¹æ®å®Œæ•´ç»“æœé›†åˆ¤æ–­åŠ é”è§„åˆ™ï¼ˆå—order byæ¡ä»¶,whereæ¡ä»¶ï¼Œlimitç­‰å½±å“ï¼‰</li>\n<li>ç­‰å€¼æŸ¥è¯¢ï¼ˆinä¹Ÿæ˜¯ç­‰å€¼æŸ¥è¯¢ï¼‰\n<ul>\n<li>è®°å½•ä¸å­˜åœ¨éƒ½æ˜¯åŠ (x-1,x+1)Gap-key Lock</li>\n<li>è®°å½•å­˜åœ¨\n<ul>\n<li>èšç°‡ç´¢å¼•ï¼šèšç°‡ç´¢å¼•Record Lockï¼ˆNext-key Locké™çº§ä¼˜åŒ–ä¸º Record Lockï¼‰</li>\n<li>å”¯ä¸€ç´¢å¼•ï¼šå”¯ä¸€ç´¢å¼•Record Lockã€èšç°‡ç´¢å¼•Record Lockï¼ˆéƒ½æ˜¯Next-key Locké™çº§ä¼˜åŒ–ä¸º Record Lockï¼‰</li>\n<li>æ™®é€šç´¢å¼•ï¼šæ™®é€šç´¢å¼•(x-1,x]Next-key Lockã€(x,x+1)Gap-key Lockã€èšç°‡ç´¢å¼•Record Lock</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>èŒƒå›´æŸ¥è¯¢\n<ul>\n<li>èšé›†ç´¢å¼•\n<ul>\n<li>åŒ¹é…è®°å½•åŠ Next-key Lock;ï¼šåªæœ‰&gt;=çš„ç­‰å€¼(=)åŒ¹é…åŠ Record Lock</li>\n<li>å¯¹äº&lt;å’Œ&lt;=ï¼šå‘å³æ‰«æç›´åˆ°æ‰¾åˆ°ä¸åŒ¹é…çš„ç´¢å¼•è®°å½•ä¸ŠNext-key Lock.</li>\n<li>å¯¹äº&gt;å’Œ&gt;=ï¼Œä¼šå¯¹supremum (ä¸Šç•Œé™ä¼ªå€¼) ä¸ŠNext-key Lockï¼šé”çš„æ˜¯èšé›†ç´¢å¼•æœ€å¤§å€¼åé¢çš„é—´éš™</li>\n</ul>\n</li>\n<li>å”¯ä¸€ç´¢å¼• å’Œ æ™®é€šç´¢å¼•ï¼š\n<ul>\n<li>å¦‚æœèµ°äº†ç´¢å¼•ï¼š\n<ul>\n<li>åŒ¹é…è®°å½•åŠ Next-key Lockï¼Œå¯¹åº”çš„èšé›†ç´¢å¼•ä¸ŠRecord Lock;</li>\n<li>å¯¹äº&lt;å’Œ&lt;=ï¼Œå‘å³æ‰«æç›´åˆ°æ‰¾åˆ°ä¸åŒ¹é…çš„ç´¢å¼•è®°å½•ä¸ŠNext-key Lockï¼Œå¯¹åº”çš„èšé›†ç´¢å¼•ä¸ŠRecord Lock</li>\n<li>å¯¹äº&gt;å’Œ&gt;=ï¼Œä¼šå¯¹supremum (ä¸Šç•Œé™ä¼ªå€¼) ä¸ŠNext-key Lockï¼šé”çš„æ˜¯è¯¥ç´¢å¼•æœ€å¤§å€¼åé¢çš„é—´éš™</li>\n</ul>\n</li>\n<li>å¦‚æœæ²¡èµ°ç´¢å¼•ï¼Œé‚£ä¹ˆå°±ä¼šæŠŠæ‰€æœ‰ èšé›†ç´¢å¼•è®°å½•å’Œé—´éš™éƒ½é”ä¸Šï¼Œå°±æ˜¯æ‰€è°“çš„é”è¡¨ï¼Œæˆ–å«è¡Œé”å‡è¡¨é”.</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>13.4. æ¢å¤å’Œå¤åˆ¶çš„éœ€è¦ï¼Œå¯¹ InnoDB é”æœºåˆ¶çš„å½±å“</h2>\n<ul>\n<li>MySQLçš„æ¢å¤æœºåˆ¶ï¼ˆå¤åˆ¶å…¶å®å°±æ˜¯åœ¨ Slave Mysql ä¸æ–­åšåŸºäº BINLOG çš„æ¢å¤ï¼‰æœ‰ä»¥ä¸‹ç‰¹ç‚¹ã€‚\n<ul>\n<li>MySQLçš„æ¢å¤æ˜¯é‡æ–°æ‰§è¡ŒBINLOGä¸­çš„SQLè¯­å¥ã€‚Oracleæ˜¯åŸºäºæ•°æ®åº“æ–‡ä»¶å—çš„ã€‚</li>\n<li>MySQLçš„æ¢å¤æ˜¯æŒ‰æŒ‰ç…§äº‹åŠ¡æäº¤çš„å…ˆåé¡ºåºè¿›è¡Œçš„ã€‚Oracleçš„æ¢å¤æ˜¯æŒ‰ç³»ç»Ÿæ›´æ–°å·ï¼ˆSystem Change Numberï¼ŒSCNï¼‰æ¥è¿›è¡Œçš„ï¼Œæ¯ä¸ªäº‹åŠ¡éƒ½ä¼šåˆ†é…ä¸€ä¸ªå…¨å±€å”¯ä¸€çš„SCNï¼ŒSCNçš„é¡ºåºä¸äº‹åŠ¡å¼€å§‹çš„æ—¶é—´é¡ºåºæ˜¯ä¸€è‡´çš„</li>\n</ul>\n</li>\n<li>MySQL çš„æ¢å¤æœºåˆ¶è¦æ±‚ï¼šåœ¨ä¸€ä¸ªäº‹åŠ¡æœªæäº¤å‰ï¼Œå…¶ä»–å¹¶å‘äº‹åŠ¡ä¸èƒ½æ’å…¥æ»¡è¶³å…¶é”å®šæ¡ä»¶çš„ä»»ä½•è®°å½•ï¼Œä¸å…è®¸å‡ºç°å¹»è¯»ï¼Œå®é™…ä¸Šæ˜¯è¦æ±‚äº‹åŠ¡è¦ä¸²è¡ŒåŒ–ã€‚å› æ­¤InnoDBè¦ç”¨åˆ°é—´éš™é”</li>\n<li>å¯¹äºinsert into target_tab select * from source_tab where ...å’Œcreate table new_tab ...select ... From source_tab where ...(CTAS)è¯­å¥ï¼ŒInnoDBç»™source_tabåŠ å…±äº«é”ï¼Œå¹¶æ²¡æœ‰ä½¿ç”¨å¤šç‰ˆæœ¬æ•°æ®ä¸€è‡´æ€§è¯»æŠ€æœ¯ï¼ä¸ºäº†ä¿è¯æ¢å¤å’Œå¤åˆ¶çš„æ­£ç¡®æ€§ã€‚ä¸åŠ é”çš„è¯ï¼Œå¦‚æœåœ¨ä¸Šè¿°è¯­å¥æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…¶ä»–äº‹åŠ¡å¯¹ source_tab åšäº†æ›´æ–°æ“ä½œï¼Œå°±å¯èƒ½å¯¼è‡´æ•°æ®æ¢å¤çš„ç»“æœé”™è¯¯ã€‚å› æ­¤ï¼ŒINSERT...SELECT...å’ŒCREATE TABLE...SELECT...è¯­å¥ï¼Œå¯èƒ½ä¼šé˜»æ­¢å¯¹æºè¡¨çš„å¹¶å‘æ›´æ–°ï¼Œé€ æˆå¯¹æºè¡¨é”çš„ç­‰å¾…ã€‚å¦‚æœæŸ¥è¯¢æ¯”è¾ƒå¤æ‚çš„è¯ï¼Œä¼šé€ æˆä¸¥é‡çš„æ€§èƒ½é—®é¢˜ï¼Œæˆ‘ä»¬åœ¨åº”ç”¨ä¸­åº”å°½é‡é¿å…ä½¿ç”¨ã€‚å®é™…ä¸Šï¼ŒMySQLå°†è¿™ç§SQLå«ä½œä¸ç¡®å®šï¼ˆnon-deterministicï¼‰çš„SQLï¼Œä¸æ¨èä½¿ç”¨ã€‚</li>\n<li>å¦‚æœåº”ç”¨ä¸­ä¸€å®šè¦ç”¨è¿™ç§ SQL æ¥å®ç°ä¸šåŠ¡é€»è¾‘ï¼Œåˆä¸å¸Œæœ›å¯¹æºè¡¨çš„å¹¶å‘æ›´æ–°äº§ç”Ÿå½±å“ï¼Œå¯é€šè¿‡ä½¿ç”¨â€œselect * from source_tab ... Into outfileâ€å’Œâ€œload data infile ...â€è¯­å¥ç»„åˆæ¥é—´æ¥å®ç°</li>\n</ul>\n<h1>14. MYSQLæ—¥å¿—</h1>\n<ul>\n<li>WALæŠ€æœ¯(Write-Ahead Logging)ï¼šå…ˆé¡ºåºå†™æ—¥å¿—ï¼Œå†å†™ç£ç›˜.å°½é‡å‡å°‘éšæœºè¯»å†™ã€‚ä¸ºäº†è§£å†³MySQLé‡Œå¦‚æœæ¯ä¸€æ¬¡çš„æ›´æ–°æ“ä½œéƒ½éœ€è¦å†™è¿›ç£ç›˜ï¼Œç„¶åç£ç›˜ä¹Ÿè¦æ‰¾åˆ°å¯¹åº”çš„é‚£æ¡è®°å½•ï¼Œç„¶åå†æ›´æ–°ï¼Œæ•´ä¸ªè¿‡ç¨‹IOæˆæœ¬å¾ˆé«˜çš„é—®é¢˜</li>\n</ul>\n<h2>14.1. æ—¥å¿—åˆ†ç±»</h2>\n<h3>14.1.1. mysqlé…ç½®æ–‡ä»¶</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># æœç´¢mysqlé…ç½®æ–‡ä»¶ä½ç½® \nshell&gt; mysql --help | grep 'Default options' -A 1\nDefault options are read from the following files in the given order:\n/etc/my.cnf /etc/mysql/my.cnf /usr/etc/my.cnf ~/.my.cnf\n</code></pre></div><h3>14.1.2. é”™è¯¯æ—¥å¿—</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># ç”¨--log-error[=file_name]é€‰é¡¹å¯åŠ¨\nshell&gt; $(which mysqld_safe) --log-error=/var/log/newlog.log &amp;\n\n# æŸ¥çœ‹é”™è¯¯æ—¥å¿—ä½ç½®-&gt;log_error:/var/log/mysqld.log\nmysql&gt; show variables like 'log_error';\n</code></pre></div><h3>14.1.3. äºŒè¿›åˆ¶æ—¥å¿—ï¼ˆBINLOGï¼‰</h3>\n<ul>\n<li>binlogæ˜¯MySQLçš„Serverå±‚å®ç°çš„ï¼Œæ‰€æœ‰å¼•æ“éƒ½å¯ä»¥ä½¿ç”¨ã€‚</li>\n<li>binlogæ˜¯é€»è¾‘æ—¥å¿—ï¼Œè®°å½•è¯­å¥çš„åŸå§‹é€»è¾‘ï¼Œæ¯”å¦‚â€œç»™ID=2è¿™ä¸€è¡Œçš„cå­—æ®µåŠ 1â€</li>\n<li>binlogæ˜¯å¯ä»¥è¿½åŠ å†™å…¥çš„ã€‚binlogæ–‡ä»¶å†™åˆ°ä¸€å®šå¤§å°åä¼šåˆ‡æ¢åˆ°ä¸‹ä¸€ä¸ªï¼Œå¹¶ä¸ä¼šè¦†ç›–ä»¥å‰çš„æ—¥å¿—</li>\n<li>ä¸ºä»€ä¹ˆä¼šæœ‰ä¸¤ä»½æ—¥å¿—å‘¢ï¼Ÿå› ä¸ºMyISAMæ²¡æœ‰crash-safeçš„èƒ½åŠ›ï¼Œbinlogæ—¥å¿—åªèƒ½ç”¨äºå½’æ¡£ã€‚æ‰€ä»¥InnoDBä½¿ç”¨å¦å¤–ä¸€å¥—redo logæ¥å®ç°crash-safeèƒ½åŠ›ã€‚</li>\n<li>binlogçš„å†™å…¥æœºåˆ¶ï¼šäº‹åŠ¡æ‰§è¡Œè¿‡ç¨‹ä¸­ï¼Œå…ˆæŠŠæ—¥å¿—å†™åˆ°binlog cacheå†…å­˜(çº¿ç¨‹ç§æœ‰)ï¼Œç„¶åwriteåˆ°page cacheï¼Œäº‹åŠ¡æäº¤çš„æ—¶å€™ï¼ŒfsyncæŒä¹…åŒ–åˆ°binlogæ–‡ä»¶ä¸­ã€‚å¹¶æ¸…ç©ºbinlog cacheã€‚</li>\n<li>binlog_cache_sizeæ§åˆ¶å•ä¸ªçº¿ç¨‹å†…binlog cacheæ‰€å å†…å­˜çš„å¤§å°ã€‚å¦‚æœè¶…è¿‡äº†ï¼Œå°±è¦æš‚å­˜åˆ°ç£ç›˜ã€‚</li>\n<li>sync_binlogæ§åˆ¶writeå’Œfsyncçš„æ—¶æœº\n<ul>\n<li>0è¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½åªwriteï¼Œä¸fsyncï¼›</li>\n<li>1è¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½ä¼šæ‰§è¡ŒfsyncæŒä¹…åŒ–åˆ°ç£ç›˜ã€‚ä¿è¯MySQLå¼‚å¸¸é‡å¯ä¹‹åbinlogä¸ä¸¢å¤±</li>\n<li>å¤§äº1è¡¨ç¤ºæ¯æ¬¡æäº¤äº‹åŠ¡éƒ½writeï¼Œä½†ç´¯ç§¯Nä¸ªäº‹åŠ¡åæ‰fsyncã€‚ä¸»æœºå‘ç”Ÿå¼‚å¸¸é‡å¯ï¼Œä¼šä¸¢å¤±æœ€è¿‘Nä¸ªäº‹åŠ¡çš„binlogæ—¥å¿—</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># my.cnfé…ç½®æˆ–è€…ç”¨--log-bin[=file_name]é€‰é¡¹å¯åŠ¨\n# é…ç½®serverid\nserver-id=1\n# å¼€å¯binlogæ—¥å¿—\nlog_bin=ON\n# binlogæ—¥å¿—çš„åŸºæœ¬æ–‡ä»¶å\nlog_bin_basename=/var/lib/mysql/mysql-bin\n# binlogæ–‡ä»¶çš„ç´¢å¼•æ–‡ä»¶ï¼Œç®¡ç†æ‰€æœ‰binlogæ–‡ä»¶\nlog_bin_index=/var/lib/mysql/mysql-bin.index\n# è®¾ç½®æ—¥å¿—è·¯å¾„ï¼Œæ³¨æ„è·¯ç»éœ€è¦mysqlç”¨æˆ·æœ‰æƒé™å†™=ä¸Šé¢æœ€åä¸‰å¥\n# log-bin = /data/mysql/logs/mysql-bin.log\n#è®¾ç½®æ—¥å¿—ä¸‰ç§æ ¼å¼ï¼šSTATEMENTã€ROWã€MIXED ã€‚\nbinlog_format = mixed\n#è®¾ç½®binlogæ¸…ç†æ—¶é—´ ä¸´æ—¶è®¾ç½®binlogæ–‡ä»¶ä¿ç•™æ—¶é•¿ï¼Œé‡å¯å¤±æ•ˆset global expire_logs_days=30;\nexpire_logs_days = 7\n#binlogæ¯ä¸ªæ—¥å¿—æ–‡ä»¶å¤§å° ä¸´æ—¶è®¾ç½®binlogå¤§å°ï¼Œé‡å¯å¤±æ•ˆset global max_binlog_size = 1024;\nmax_binlog_size = 100m\n#binlogç¼“å­˜å¤§å°\nbinlog_cache_size = 4m\n#æœ€å¤§binlogç¼“å­˜å¤§å°\nmax_binlog_cache_size = 512m\n\n# é‡å¯mysql\n1ã€ä½¿ç”¨ service å¯åŠ¨ï¼šservice mysql start\n2ã€ä½¿ç”¨ mysqld è„šæœ¬å¯åŠ¨ï¼š/etc/inint.d/mysql start\n3ã€ä½¿ç”¨ safe_mysqld å¯åŠ¨ï¼šsafe_mysql&amp;\n \n1ã€ä½¿ç”¨ service å¯åŠ¨ï¼šservice mysql stop\n2ã€ä½¿ç”¨ mysqld è„šæœ¬å¯åŠ¨ï¼š/etc/inint.d/mysql stop\n3ã€mysqladmin shutdown\n \n1ã€ä½¿ç”¨ service é‡å¯ï¼šservice mysql restart\n2ã€ä½¿ç”¨ mysqld è„šæœ¬é‡å¯ï¼š/etc/inint.d/mysql restart\n\n# æŸ¥çœ‹binlogé…ç½®\nmysql&gt; SHOW VARIABLES LIKE 'log_bin%';\n\n# æŸ¥çœ‹binlogä¿ç•™æ—¶é•¿\nmysql&gt;show variables like 'expire_logs_days';\n\n# æŸ¥çœ‹binlogæ–‡ä»¶å¤§å°é™åˆ¶\nmysql&gt;show variables like 'max_binlog_size';\n\n# æŸ¥çœ‹æ—¥å¿—åˆ—è¡¨\nshell&gt; system ls -ltr /var/lib/mysql/mysql-bin*\n# å…¶ä¸­ mysql-bin.indexæ˜¯æ—¥å¿—çš„ç´¢å¼•æ–‡ä»¶ï¼Œè®°å½•äº†æœ€å¤§çš„æ—¥å¿—åºå·\nmysql&gt; show binary logs;\n\n# æŸ¥çœ‹binlogå†…å®¹\nshell&gt; mysqlbinlog mysql-bin.000002;\nshell&gt; mysqlbinlog --start-datetime=\"2017-09-17 07:21:09\" --stop-datetime=\"2017-09-19 07:59:50\" mysql-bin.000002\nshell&gt; mysqlbinlog --start-position=205 --stop-position=2205 mysql-bin.000002\nshell&gt; mysqlbinlog --no-defaults -d databasename mysql-bin.000002\n\nmysql&gt; show binlog events in 'mysql-bin.000123';\nmysql&gt; show master status;\n\n# åˆ é™¤æ—¥å¿—\n## æ–¹æ³•1åˆ é™¤æ‰€æœ‰ BINLOG æ—¥å¿—ï¼Œæ–°æ—¥å¿—ç¼–å·ä»â€œ000001â€å¼€å§‹\nmysql&gt; reset MASTER;\n## æ–¹æ³•2åˆ é™¤ç¼–å·000006ä¹‹å‰çš„æ—¥å¿—\nmysql&gt;purge master logs to 'mysql-bin.000006';\n## æ–¹æ³•3åˆ é™¤æ—¥æœŸä¸ºâ€œyyyy-mm-dd hh24:mi:ssâ€ä¹‹å‰äº§ç”Ÿçš„æ‰€æœ‰æ—¥å¿—\nmysql&gt; purge master logs before '2007-08-10 04:07:00';\n## æ–¹æ³•4è®¾ç½®å‚æ•°--expire_logs_days=#ï¼Œè¿‡äº†æŒ‡å®šçš„å¤©æ•°åæ—¥å¿—å°†ä¼šè¢«è‡ªåŠ¨åˆ é™¤\nåœ¨ my.cnf çš„[mysqld]ä¸­åŠ å…¥â€œexpire_logs_day=3â€\nå°†ç³»ç»Ÿæ—¶é—´æ”¹ä¸º 3 å¤©ä»¥å\nshell&gt; date -s '20071226 14:00:00'\nshow variables like 'expire_logs_days'; # æŸ¥çœ‹è¿‡æœŸæ—¶é—´\nset global expire_logs_days = 30; # è®¾ç½®è¿‡æœŸæ—¶é—´\n# è§¦å‘æ—¥å¿—æ–‡ä»¶æ›´æ–°\nmysql&gt; flush logs\n\n# ä¿®æ”¹é…ç½®ååˆ·æ–°æ—¥å¿—æ–‡ä»¶\nmysql&gt;flush logs\n\n# å…¶ä»–é€‰é¡¹\n--binlog-do-db=db_nameåªè®°å½•æŒ‡å®šæ•°æ®åº“çš„binlog\n--binlog-ignore-db=db_nameå¿½ç•¥æŒ‡å®šæ•°æ®åº“çš„binlog\n--innodb-safe-binlogå’Œ--sync-binlogï¼Nï¼ˆæ¯å†™ N æ¬¡æ—¥å¿—åŒæ­¥ç£ç›˜ï¼‰é…åˆä½¿ç”¨ï¼Œä½¿å¾—äº‹åŠ¡åœ¨æ—¥å¿—ä¸­çš„è®°å½•æ›´åŠ å®‰å…¨\n\n</code></pre></div><h4>14.1.3.1. binlogæ—¥å¿—æ ¼å¼</h4>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å½“binlog_format=statementæ—¶ï¼Œè®°å½•çš„æ˜¯SQLåŸæ–‡,å‡å°‘äº†æ—¥å¿—é‡ï¼ŒèŠ‚çº¦äº†IOï¼Œæé«˜æ€§èƒ½ã€‚æ­¤æ—¶æŸäº›sqlä¼šäº§ç”Ÿwarningï¼Œå› ä¸ºæœ‰å¯èƒ½äº§ç”Ÿä¸»å¤‡ä¸ä¸€è‡´çš„æƒ…å†µï¼Œå³åœ¨ä¸»æ•°æ®åº“ä¸åœ¨ä»æ•°æ®åº“ä½¿ç”¨çš„ç´¢å¼•ä¸ä¸€æ ·å¯¼è‡´æ•°æ®ä¸ä¸€è‡´çš„é—®é¢˜\n# ä½¿ç”¨ä»¥ä¸‹å‡½æ•°çš„è¯­å¥ä¹Ÿæ— æ³•è¢«å¤åˆ¶ï¼š\n- LOAD_FILE()\n- UUID()\n- USER()\n- FOUND_ROWS()\n- SYSDATE() (é™¤éå¯åŠ¨æ—¶å¯ç”¨äº† --sysdate-is-now é€‰é¡¹)\n- åœ¨ INSERT ...SELECT ä¼šäº§ç”Ÿæ¯” RBR æ›´å¤šçš„è¡Œçº§é” ã€‚\n# å½“binlog_format=statementæ—¶ï¼Œinsert into t values(10,10, now());å¦‚æœè¿™ä¸ªbinlogè¿‡äº†1åˆ†é’Ÿæ‰ä¼ ç»™å¤‡åº“çš„è¯ï¼Œé‚£ä¸»å¤‡çš„æ•°æ®ä¸å°±ä¸ä¸€è‡´äº†å—ï¼ŸåŸæ¥binlogåœ¨è®°å½•eventçš„æ—¶å€™ï¼Œå¤šè®°äº†ä¸€æ¡å‘½ä»¤ï¼šSET TIMESTAMP=1546103491ã€‚çº¦å®šäº†æ¥ä¸‹æ¥çš„now()å‡½æ•°çš„è¿”å›æ—¶é—´ã€‚å› æ­¤å€¼æ˜¯å›ºå®šçš„ã€‚ç¡®ä¿äº†ä¸»å¤‡æ•°æ®çš„ä¸€è‡´æ€§\nmysql&gt; delete from t /*comment*/ where a&gt;=4 and t_modified&lt;='2018-11-10' limit 1;\nmysql&gt; show binlog events in 'master.000001';\n+</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/5eb3564ceca7b636f4065.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æ•°æ®åº“"
      ]
    },
    {
      "title": "oracle",
      "url": "https://javaguide.cn/backend/database/oracle.html",
      "id": "https://javaguide.cn/backend/database/oracle.html",
      "summary": "oralce:å¤§å‹æ•°æ®åº“ oracle 10g å•è¡¨æŸ¥è¯¢ select: condition order by group by group byå¢å¼º å‡½æ•°ï¼šç®€åŒ–æ“ä½œ å•è¡Œå‡½æ•° å­—ç¬¦å‡½æ•° å¤§å°å†™æ§åˆ¶å‡½æ•° å­—ç¬¦æ§åˆ¶å‡½æ•° æ•°å€¼å‡½æ•° æ—¥æœŸå‡½æ•° è½¬æ¢å‡½æ•° oracleè½¬æ¢å‡½æ•°.png select to_char(sysdate,'yyyy-mm-dd hh2...",
      "content_html": "<p>oralce:å¤§å‹æ•°æ®åº“</p>\n<!--more-->\n<h2>oracle 10g</h2>\n<h3>å•è¡¨æŸ¥è¯¢</h3>\n<pre><code>select *|[distinct] colum|expression|function() [as][alias](s)]\n\tfrom table[alias](s)|dual\n\t[where condition(s)]\n\t[group by column(s)]\n\t[having condition(s)] \n\t[order by column|number|alias|expression \n\t[asc|desc] [nulls first|nulls last](s)];\n</code></pre>\n<h4>select:</h4>\n<pre><code>distinctä½œç”¨ä¸åé¢æ‰€æœ‰çš„åˆ—ï¼Œæ‰€æœ‰åˆ—ç›¸åŒçš„æ‰ä¼šå»æ‰\n\taliasæœ‰ç‰¹æ®Šç¬¦å·æˆ–è€…å…³é”®å­—(æ•°å­—æ±‰å­—)å°±è¦åŠ åŒå¼•å·(pl/sqlå°±ä¸ç”¨)ï¼Œå•å¼•å·è¡¨ç¤ºæ—¥æœŸå’Œå­—ç¬¦\n\tselect * from emp;\n\tselect empno,ename,job,mgr,hiredate,sal,comm,deptno from emp;\n\tselect empno as \"å‘˜å·¥å·\",ename,sal \"æœˆ è–ª\",\n\tsal*12,comm,sal*12+nvl(comm,0) from emp\n\tselect distinct deptno from emp;\n\tselect distinct deptno,job from emp;\n\tselect ename,sal*12 from emp;\n\tselect ename,sal*12 income,sal*12+comm from emp;\n</code></pre>\n<h4>condition</h4>\n<pre><code>where ä¸­çš„å­—æ¯æ˜¯åŒºåˆ†å¤§å°å†™ï¼Œæ—¥æœŸæ ¼å¼å¿…é¡»ä¸æ•°æ®åº“ä¸€è‡´ï¼Œé»˜è®¤DD-MON-RR\\mysqlä¸åŒºåˆ†å¤§å°å†™\n\tæ¯”è¾ƒè¿ç®—ç¬¦=ã€&lt;&gt;ï¼ˆï¼=ï¼‰ã€&gt;ã€&gt;=ã€&lt;=ã€&lt;ã€between and ï¼ˆé—­åŒºé—´ï¼Œå°åˆ°å¤§ã€æ—¥æœŸä¹Ÿè¡Œï¼‰\n\tinï¼ˆseté›†åˆï¼‰ã€not inï¼ˆseté›†åˆï¼‰ã€is nullã€is not nullã€likeï¼ˆ%ã€_ã€æ—¥æœŸã€\\escapeï¼‰\n\tlib\n\tè½¬æ„å­—ç¬¦\\ç´§è·Ÿåé¢çš„ä¸€ä¸ªæŒ‰æœ¬èº«ï¼Œä¸æŒ‰ç‰¹æ®Šå­—ç¬¦ã€   \n\tselect *from emp where ename like '%\\_%' escape '\\'ï¼›\n\té€»è¾‘è¿ç®—ç¬¦\n\tandï¼ˆä¸¤ä¸ªè€ƒè™‘between andï¼‰ã€or ï¼ˆå¤šä¸ªorè€ƒè™‘inï¼‰ã€notï¼ˆä¸å¤§äºï¼šnotï¼ˆsal&gt;1500ï¼‰ï¼‰\n\tä¾‹å­\n\tselect * from emp where sal between 1500 and 3000\n\tselect * from emp where sal &gt;1500 and sal&lt;3000\n\tselect * from emp where hiredate bettweeen '1-1æœˆ-1981' and '31-12æœˆ-1981' \n\tselect * from emp where empno in (7396,7499,7521)\n\tselect * from emp where ename in('SMITH','ALLEN','WARD')\n\tselect * from emp where comm is not null\n\tselect * from emp where comm is null\n\tselect * from emp where deptno not in (10,20)\n\tselect * from emp where empno=7396 or empno=7499 or empno=7521;\n\tselect * from emp where deptno=10;\n\tselect * from emp where ename='KING'\n\tselect * from emp where ename='King'\n\tselect * from emp where hiredate='17-11æœˆ-81';\n\tselect * from emp where hiredate='1981-11-17'\n\tselect * from emp where empno &lt;&gt; 7396;\n\tselect * from emp where empno != 7396;\n\tselect * from emp where empno like '_M%'\n\tselect * from emp where empno like '%M%'\n\tselect last_name, hire_date from employees where hire_date like '% -94'\n\tselect * from emp where ename like '____'\n\tselect * from emp where comm is not null or sal&gt;1500;\n\tselect * from emp where comm is not null and sal&gt;1500;\n\tselect * from emp where comm is not null and not(sal&gt;1500);\n</code></pre>\n<h4>order by</h4>\n<pre><code>â‘ é»˜è®¤å‡åºasc desc é™åº  æ’åºæ”¾åœ¨æœ€åæ‰§è¡Œï¼Œé™åºåªä½œç”¨ä¸ä¸ä»–æœ€è¿‘çš„åˆ—ã€\n\tâ‘¡nulls Firstå’Œ null last è°ƒèŠ‚æ˜¾ç¤ºä½ç½®\n\tâ‘¢ä½œç”¨äºåé¢æ‰€æœ‰çš„åˆ—ï¼Œå…ˆæŒ‰ç¬¬ä¸€åˆ—å‡åºï¼Œç›¸åŒçš„æŒ‰ç¬¬äºŒåˆ—é™åºæ’åˆ—\n\tâ‘£æ’åºåçš„ç»“æœï¼Œæ˜¯å¦æ˜¯åŸæ¥çš„è¡¨ï¼Ÿä¸æ˜¯ï¼Œæ˜¯ä¸´æ—¶è¡¨\n\tâ‘¤order by åé¢  + åˆ—ã€è¡¨è¾¾å¼ã€åˆ«åã€åºå·ï¼ˆç¬¬å‡ åˆ—ã€ä¸èƒ½è¶…è¿‡åˆ—æ•°ï¼‰\n\tä¾‹å­\n\tselect * from emp order by sal asc, hiredate desc;\n\tselect * from emp order by sal desc\n\tselect * from emp order by sal\n\tselect empno,ename,sal,sal*12 from emp order by sal*12 desc;\n\tselect empno,ename,sal,sal*12 å¹´è–ª  from emp order by å¹´è–ª desc\n\tselect empno,ename,sal,sal*12 å¹´è–ª  from emp order by 4 desc\n\tselect empno,ename,sal,sal*12 å¹´è–ª from emp order by 5 desc\n\tORDER BY é¡¹å¿…é¡»æ˜¯ SELECT-list è¡¨è¾¾å¼çš„æ•°ç›® \n\tselect * from emp  order by deptno,sal;\n\tselect *  from emp order by deptno,sal desc\n\tselect sal from emp order by sal*12\n\tselect * from emp order by sal nulls first;\n\tselect * from emp order by sal nulls last;\n</code></pre>\n<h4>group by</h4>\n<pre><code>â‘ åˆ†ç»„å‡½æ•°åªèƒ½æŸ¥å‡ºgroup by åˆ†ç»„æ¡ä»¶å­—æ®µå’Œåˆ†ç»„å‡½æ•°çš„å€¼ï¼Œä¸èƒ½æœ‰å…¶ä»–å­—æ®µ\n\tä¸ä½¿ç”¨group by åªå¯ä»¥æŸ¥è¯¢å‡ºæ¥åˆ†ç»„å‡½æ•°çš„å€¼\n\tâ‘¡å­˜åœ¨äºselectè¡¨ä¸­ï¼Œè€Œæœªè¢«ç»„å‡½æ•°åŒ…å«çš„æ‰€æœ‰çš„åˆ—éƒ½è¦åŒ…å«åœ¨group byä¸­ï¼Œ\n\tåŒ…å«åœ¨groupbyå­å¥ä¸­çš„åˆ—ä¸å¿…åŒ…å«åœ¨selectä¸­\n\tâ‘¢è¿‡æ»¤åˆ†ç»„å‡½æ•°çš„å€¼having ä¸whereçš„åŒºåˆ«ï¼Œwhereåé¢ä¸èƒ½æœ‰ç»„å‡½æ•°\n\tâ‘£å¤šä¸ªåˆ—çš„åˆ†ç»„: å…ˆæŒ‰ç…§ç¬¬ä¸€ä¸ªåˆ—åˆ†ç»„ï¼Œå¦‚æœç›¸åŒï¼Œå†ç¬¬äºŒä¸ªåˆ—åˆ†ç»„ï¼Œä»¥æ­¤ç±»æ¨\n\tä¾‹å­\n\tselect deptno,avg(sal) from emp group by deptno having avg(sal)&gt;2000\n\tselect deptno,avg(sal) from emp  where deptno=10 group by deptno\n\tselect deptno,avg(sal)  from emp  group by deptno  having deptno=10;\n\tselect deptno,job,sum(sal)  from emp group by deptno,job  order by 1;\n\tselect deptnoï¼Œcountï¼ˆenameï¼‰,avg(sal)  from emp group by deptno\n</code></pre>\n<h4>group byå¢å¼º</h4>\n<pre><code>SQL&gt; group by çš„å¢å¼ºoracleæ‰è¡Œï¼ŒåšæŠ¥è¡¨\n\tSQL&gt; select deptno,job,sum(sal) from emp group by deptno,job\n\tSQL&gt; +\n\tSQL&gt; select deptno,sum(sal) from emp group by deptno\n\tSQL&gt; +\n\tSQL&gt; select sum(sal) from emp\n\tSQL&gt; \n\tSQL&gt; ====\n\tSQL&gt; select deptno,job,sum(sal) from emp group by rollup(deptno,job)\n\tSQL&gt; æŠ½è±¡\n\tSQL&gt; group by rollup(a,b)\n\tSQL&gt; =\n\tSQL&gt; group by a,b\n\tSQL&gt; +\n\tSQL&gt; group by a\n\tSQL&gt; +\n\tSQL&gt; æ²¡æœ‰group by\n\toracleçš„æ”¯æŒæŠ¥è¡¨åŠŸèƒ½ï¼Œbreak on nullï¼Œç›¸åŒçš„ä¸æ˜¾ç¤ºï¼Œä¸åŒéƒ¨é—¨å·ï¼Œä»¥deptnoä¸ºæ ‡å¿—ï¼Œ\n\tåˆ†ç»„åéš”è¡Œæ˜¾ç¤ºbreak on deptno skip 2ã€selectå¯ä»¥é€šè¿‡é›†åˆè¿ç®—ç›¸åŠ å‡\n</code></pre>\n<h2>å‡½æ•°ï¼šç®€åŒ–æ“ä½œ</h2>\n<h3>å•è¡Œå‡½æ•°</h3>\n<h4>å­—ç¬¦å‡½æ•°</h4>\n<h5>å¤§å°å†™æ§åˆ¶å‡½æ•°</h5>\n<pre><code>select lower('HELLO') ,upper('hello'),initcap('hello') from dual (ä¼ªè¡¨)\n</code></pre>\n<h5>å­—ç¬¦æ§åˆ¶å‡½æ•°</h5>\n<pre><code>select concat('hello','World') from dual(ä¼ªè¡¨)\n\tselect 'ç¼–å·æ˜¯'  || empno  || 'çš„é›‡å‘˜,å§“åæ˜¯'||ename from emp;\n\tselect substr('Hello World',4) å­ä¸² from dual;lo World  \n\tselect substr('Hello World',4,3) å­ä¸² from dual;lo \n\tselect length('Hello World') å­—ç¬¦,lengthb('Hello World') å­—èŠ‚ from dual;11ã€11\n\tselect length('åŒ—äº¬') å­—ç¬¦,lengthb('åŒ—äº¬') å­—èŠ‚ from dual\n\t2ã€4è‹±æ–‡å­—ç¬¦å’Œå­—èŠ‚ä¸€æ ·ï¼Œä¸€ä¸ªæ±‰å­—ä¸¤ä¸ªå­—èŠ‚\n\tselect replace('hello','l','x')from dual; hexxo\n\tselect instr('Hello World','ll') ä½ç½® from dual;3\n\tselect lpad('a',1,'*') å·¦,rpad('abcd',1,'*') å³ from dual;*a a* å·¦å³å¡«å……\n\tselect trim('H' from 'Hello WorldH') from dual;ello World å»æ‰å‰åæŒ‡å®šçš„å­—ç¬¦\n\tselect wm_concat(ename) nameslist from emp group by deptno;  10 CLARK,KING\n</code></pre>\n<h4>æ•°å€¼å‡½æ•°</h4>\n<pre><code>\tselect round(45.926,2) ä¸€,round(45.926,1) äºŒ,round(45.926,0) ä¸‰,\n\t\tround(45.926,-1) å››,round(45.926,-2) äº” from dual;\n\t\t45.93       45.9         46         50          0   \n\t\tselect trunc(45.926,2) ä¸€,trunc(45.926,1) äºŒ,trunc(45.926,0) ä¸‰,\n\t\ttrunc(45.926,-1) å››,trunc(45.926,-2) äº” from dual\n\t\t45.92       45.9         45         40          0   \n\t\tselect mod(1600,300) from dual; 100çœ‹å°æ•°ç‚¹çš„ä½ç½®ï¼šå‘å³ä¸ºæ­£\n</code></pre>\n<h4>æ—¥æœŸå‡½æ•°</h4>\n<pre><code>é»˜è®¤å«æœ‰æ—¥æœŸå’Œæ—¶é—´ï¼Œé»˜è®¤æ ¼å¼DD-MON-RR  mysql dateæ—¥æœŸã€datetimeæ—¶é—´\n\tæ•°å­¦è¿ç®—ï¼šæ—¥æœŸåŠ å‡ï¼ˆæ²¡ä¹˜é™¤ï¼‰æ•°å­—ä»ä¸ºæ—¥æœŸï¼Œ\n\tæ—¥æœŸä¹‹å·®ï¼ˆä¸åŠ ï¼Œæ²¡æ„ä¹‰ï¼‰ä¸ºå¤©æ•°ï¼ˆæ•°å­—ï¼‰\n\tå¤©æ•°ï¼ˆæ•°å­—ï¼‰å¯ä»¥åŠ å‡ä¹˜é™¤\n\tselect (sysdate-1) æ˜¨å¤©,sysdate ä»Šå¤©,(sysdate+1) æ˜å¤© from dual;29-9æœˆ -16 \n\tselect ename,hiredate,(sysdate-hiredate) å¤©,(sysdate-hiredate)/7 æ˜ŸæœŸ,\n\t(sysdate-hiredate)/30 æœˆ,(sysdate-hiredate)/365 å¹´ from emp;\n\tselect to_char(sysdate,'yyyy-mm-dd hh24:mi:ss') from dual;2016-09-29 11:58:32   \n\tnext_dayæŒ‡å®šæ—¥æœŸçš„ ä¸‹ä¸ªæ—¥æœŸ\n\tselect next_day(sysdate,'ç¤¼æ‹œäº”') from dual å‘¨ä¸­çš„æ—¥æ— æ•ˆ \n\tæ¯ä¸ªæ˜ŸæœŸä¸€è‡ªåŠ¨å¤‡ä»½è¡¨ä¸­çš„æ•°æ® 1ã€åˆ†å¸ƒå¼æ•°æ®åº“ï¼Œç‰©ç†ä¸Šä¸åœ¨ä¸€èµ·ï¼Œé€»è¾‘ä¸€èµ·çš„æ•°æ®åº“\n\t2ã€è§¦å‘å™¨ å¿«ç…§æ‹·è´æ•°æ®\n\troundã€trunc\n\tå‡è®¾SYSDATE=â€˜25-JUL-95â€™\n\tround(SYSDATE,'MONTH')â†’01-AUG-95\n\tround(SYSDATE,'YEAR')â†’01-JAN-96\n\ttrunc(SYSDATE,'MONTH')â†’01-JUL-95\n\ttrunc(SYSDATE,'YEAR')â†’01-JAN-95\n\tselect months_between(sysdate,hiredate),add_months(sysdate,53) ,\n\tnext_day(sysdate,'sunday') ,last_day(sysdate) from emp;è®¡ç®—å·¥é¾„\n</code></pre>\n<h4>è½¬æ¢å‡½æ•°</h4>\n<pre><code>éšå¼oracleè‡ªåŠ¨:select * from emp where deptno=10;\n\tæ˜¾å¼:æ—¥æœŸè½¬æ¢æ ¼å¼to_charï¼ˆdateï¼Œâ€™æ ¼å¼â€˜ï¼‰'yyyy-mm-dd'ã€'fmyyyy-mm-dd'å»æ‰09çš„0\n\tå¯ä»¥ç”¨æ¥åˆ†åˆ«å–å‡ºå¹´ã€æœˆã€æ—¥\n</code></pre>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9988d14146fdb19c78d04.png\" alt=\"oracleè½¬æ¢å‡½æ•°.png\"><br>\nselect to_char(sysdate,'yyyy-mm-dd hh24:mi:ss\"ä»Šå¤©æ˜¯\"day') from dual;<br>\næ•°å­—è½¬æ¢æ ¼å¼to_charï¼ˆnumberï¼Œâ€™æ ¼å¼â€˜ï¼‰å¯ä»¥åˆ†åˆ«å–å‡ºå„ä¸ªä½ç½®çš„ä½æ•°\t<br>\nLæœ¬åœ°è´§å¸ç¬¦å·ï¼Œ.å°æ•°ç‚¹ï¼Œåƒä½ç¬¦$ç¾å…ƒç¬¦0é›¶9æ•°å­—<br>\nselect to_char(sal,'L9,999.99') from emp;ï¿¥800.00<br>\nå­—ç¬¦è½¬æ¢ä¸ºæ•°å­—to_number(char[,'æ ¼å¼'])<br>\nå­—ç¬¦è½¬æ¢æˆæ—¥æœŸto_date(char[,'æ ¼å¼''])</p>\n<h4>é€šç”¨å‡½æ•°:é€‚ç”¨äºä»»ä½•æ•°æ®ç±»å‹åŒ…æ‹¬null</h4>\n<pre><code>nvlï¼ˆe1,e2ï¼‰ã€nvl2ï¼ˆa,b,cï¼‰ã€nullifï¼ˆa,bï¼‰ã€coalesceï¼ˆe1,e2ï¼‰\n\tnvl2çš„énullä¸ºbï¼Œnullä¸ºc nullifä¸¤ä¸ªè¡¨è¾¾å¼ç›¸åŒè¿”å›nullï¼Œå¦åˆ™è¿”å›a\n\tselect sal*12+nvl2(comm,comm,0) from emp;\n\tselect nullif('abc','abc') å€¼ from dual;\t\n\tselect comm,sal,coalesce(comm,sal) \"ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼\" from emp;\n\t\t  COMM        SAL ç¬¬ä¸€ä¸ªä¸ä¸ºnullçš„å€¼                                        \n</code></pre>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/9988d14146fdb19c78d04.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æ•°æ®åº“"
      ]
    },
    {
      "title": "redis",
      "url": "https://javaguide.cn/backend/database/redis.html",
      "id": "https://javaguide.cn/backend/database/redis.html",
      "summary": "1. NoSQLä»‹ç» 2. NoSQLäº§ç”ŸåŸå›  3. NoSQLçš„ç‰¹ç‚¹ 4. redisä»‹ç» 5. Redisæ•°æ®åº“ 6. æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒ 7. äº‹åŠ¡ 8. å®‰è£…ä¸å¯åŠ¨ 9. jedisçš„æ“ä½œ 10. rediså•æœºå®‰è£… 11. Redisé›†ç¾¤çš„æ­å»º 12. javaè¿æ¥åˆ™ç”¨jedis 1. NoSQLä»‹ç» å…³ç³»å‹æ•°æ®åº“æ˜¯åŸºäºå…³ç³»è¡¨çš„æ•°æ®åº“ï¼Œæœ€ç»ˆä¼šå°†æ•°...",
      "content_html": "<!-- TOC -->\n<ul>\n<li><a href=\"#1-nosql%E4%BB%8B%E7%BB%8D\">1. NoSQLä»‹ç»</a></li>\n<li><a href=\"#2-nosql%E4%BA%A7%E7%94%9F%E5%8E%9F%E5%9B%A0\">2. NoSQLäº§ç”ŸåŸå› </a></li>\n<li><a href=\"#3-nosql%E7%9A%84%E7%89%B9%E7%82%B9\">3. NoSQLçš„ç‰¹ç‚¹</a></li>\n<li><a href=\"#4-redis%E4%BB%8B%E7%BB%8D\">4. redisä»‹ç»</a></li>\n<li><a href=\"#5-redis%E6%95%B0%E6%8D%AE%E5%BA%93\">5. Redisæ•°æ®åº“</a></li>\n<li><a href=\"#6-%E6%B6%88%E6%81%AF%E8%AE%A2%E9%98%85%E4%B8%8E%E5%8F%91%E5%B8%83\">6. æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒ</a></li>\n<li><a href=\"#7-%E4%BA%8B%E5%8A%A1\">7. äº‹åŠ¡</a></li>\n<li><a href=\"#8-%E5%AE%89%E8%A3%85%E4%B8%8E%E5%90%AF%E5%8A%A8\">8. å®‰è£…ä¸å¯åŠ¨</a></li>\n<li><a href=\"#9-jedis%E7%9A%84%E6%93%8D%E4%BD%9C\">9. jedisçš„æ“ä½œ</a></li>\n<li><a href=\"#10-redis%E5%8D%95%E6%9C%BA%E5%AE%89%E8%A3%85\">10. rediså•æœºå®‰è£…</a></li>\n<li><a href=\"#11-redis%E9%9B%86%E7%BE%A4%E7%9A%84%E6%90%AD%E5%BB%BA\">11. Redisé›†ç¾¤çš„æ­å»º</a></li>\n<li><a href=\"#12-java%E8%BF%9E%E6%8E%A5%E5%88%99%E7%94%A8jedis\">12. javaè¿æ¥åˆ™ç”¨jedis</a></li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. NoSQLä»‹ç»</h1>\n<ul>\n<li>å…³ç³»å‹æ•°æ®åº“æ˜¯åŸºäºå…³ç³»è¡¨çš„æ•°æ®åº“ï¼Œæœ€ç»ˆä¼šå°†æ•°æ®æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Š</li>\n<li>nosqlæ•°æ®åº“æ˜¯åŸºäºç‰¹æ®Šçš„ç»“æ„ï¼Œå¹¶å°†æ•°æ®å­˜å‚¨åˆ°å†…å­˜çš„æ•°æ®åº“</li>\n<li>ä»æ€§èƒ½ä¸Šè€Œè¨€ï¼Œnosqlæ•°æ®åº“è¦ä¼˜äºå…³ç³»å‹æ•°æ®åº“</li>\n<li>ä»å®‰å…¨æ€§ä¸Šè€Œè¨€å…³ç³»å‹æ•°æ®åº“è¦ä¼˜äºnosqlæ•°æ®åº“</li>\n<li>ä¸€ä¸ªé¡¹ç›®ä¸­nosqlå’Œå…³ç³»å‹æ•°æ®åº“ä¼šä¸€èµ·ä½¿ç”¨ï¼Œè¾¾åˆ°æ€§èƒ½å’Œå®‰å…¨æ€§çš„åŒä¿è¯</li>\n</ul>\n<h1>2. NoSQLäº§ç”ŸåŸå› </h1>\n<ul>\n<li>1.æ•°æ®åº“é«˜å¹¶å‘è¯»å†™éœ€æ±‚</li>\n<li>2.æµ·é‡æ•°æ®é«˜æ•ˆç‡å­˜å‚¨å’Œè®¿é—®</li>\n<li>3.æ•°æ®åº“é«˜æ‰©å±•æ€§å’Œé«˜å¯ç”¨æ€§</li>\n</ul>\n<h1>3. NoSQLçš„ç‰¹ç‚¹</h1>\n<ul>\n<li>æ˜“æ‰©å±•ã€å¤§æ•°æ®é‡ï¼Œé«˜æ€§èƒ½ï¼Œçµæ´»çš„æ•°æ®æ¨¡å‹,é«˜å¯ç”¨</li>\n</ul>\n<h1>4. redisä»‹ç»</h1>\n<ul>\n<li>redisæ˜¯ä¸€ç§é«˜çº§çš„key-valueçš„å­˜å‚¨ç³»ç»Ÿ</li>\n<li>Redisä¸­æ‰€æœ‰çš„æ•°æ®éƒ½æ˜¯å­—ç¬¦ä¸²ã€‚å‘½ä»¤ä¸åŒºåˆ†å¤§å°å†™ï¼Œkeyæ˜¯åŒºåˆ†å¤§å°å†™çš„ã€‚Redisæ˜¯å•çº¿ç¨‹çš„ã€‚Redisä¸­ä¸é€‚åˆä¿å­˜å†…å®¹å¤§çš„æ•°æ®ã€‚</li>\n</ul>\n<h1>5. Redisæ•°æ®åº“</h1>\n<ul>\n<li>å¤šæ•°æ®åº“</li>\n<li>æœ‰0-15æ•°æ®åº“ï¼Œé»˜è®¤ä¸º0ï¼Œé€‰æ‹©æ•°æ®åº“select né€‰æ‹©nå·æ•°æ®åº“</li>\n<li>ç§»åº“ move newkey nå°†å½“å‰çš„keyç§»æ¤åˆ°nå·åº“ä¸­</li>\n</ul>\n<h1>6. æ¶ˆæ¯è®¢é˜…ä¸å‘å¸ƒ</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/28327364030668f3c4d44.jpg\" alt=\"æ¶ˆæ¯çš„è®¢é˜…ä¸å‘å¸ƒ.JPG\" tabindex=\"0\"><figcaption>æ¶ˆæ¯çš„è®¢é˜…ä¸å‘å¸ƒ.JPG</figcaption></figure>\n<h1>7. äº‹åŠ¡</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/cc1727548496fd141234c.png\" alt=\"redisäº‹åŠ¡.png\" tabindex=\"0\"><figcaption>redisäº‹åŠ¡.png</figcaption></figure>\n<h1>8. å®‰è£…ä¸å¯åŠ¨</h1>\n<ul>\n<li>åœ¨redisçš„binç›®å½•ä¸‹å¯ä»¥æ‰§è¡Œ./redis-serverå‰ç«¯å¯åŠ¨æ–¹å¼</li>\n<li>åœ¨binä¸‹æ‰§è¡Œå‘½ä»¤,/redis-server redis.conf(åç«¯å¯åŠ¨)</li>\n<li>å…³é—­ï¼šå…³é—­è¿›ç¨‹ã€åœ¨å®¢æˆ·ç«¯ä¸‹shutdown</li>\n<li>è¿æ¥redis redis-cli -h ip -p port</li>\n</ul>\n<h1>9. jedisçš„æ“ä½œ</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…commons-pool2-2.3.jar\\jedis2.7.0jar\n\nJedisConfig config=new JedisConfig()ï¼›\nconfig.setMaxtotal(30);\nconfig.setMaxIdle(10)\nJedisPool pool = new JedisPool(JedisConfig,host,port);\nJedis jedis=null;\njedis=pool.getResource();\njedis.set(key,æ•°æ®ç±»å‹)\njedis.get(key,æ•°æ®ç±»å‹)\n\nJedis jedis = new Jedis(host,port);\njedis.set(key,æ•°æ®ç±»å‹)\njedis.get(key,æ•°æ®ç±»å‹)\n</code></pre></div><h1>10. rediså•æœºå®‰è£…</h1>\n<ul>\n<li>\n<p>Redisæ˜¯cè¯­è¨€å¼€å‘çš„ã€‚</p>\n</li>\n<li>\n<p>å®‰è£…rediséœ€è¦cè¯­è¨€çš„ç¼–è¯‘ç¯å¢ƒã€‚å¦‚æœæ²¡æœ‰gccéœ€è¦åœ¨çº¿å®‰è£…ã€‚yum install gcc-c++</p>\n</li>\n<li>\n<p>å®‰è£…æ­¥éª¤ï¼š</p>\n<ul>\n<li>1.redisçš„æºç åŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿã€‚</li>\n<li>2.è§£å‹ç¼©redisã€‚</li>\n<li>3.ç¼–è¯‘ã€‚è¿›å…¥redisæºç ç›®å½•ã€‚make</li>\n<li>4.å®‰è£…ã€‚make install PREFIX=/usr/local/redis PREFIXå‚æ•°æŒ‡å®šredisçš„å®‰è£…ç›®å½•ã€‚ä¸€èˆ¬è½¯ä»¶å®‰è£…åˆ°/usrç›®å½•ä¸‹</li>\n<li>5.redisçš„å¯åŠ¨ï¼š\n<ul>\n<li>å‰ç«¯å¯åŠ¨ï¼šåœ¨redisçš„å®‰è£…ç›®å½•ä¸‹ç›´æ¥å¯åŠ¨redis-server</li>\n<li>[root@localhost bin]# ./redis-server</li>\n<li>åå°å¯åŠ¨ï¼šæŠŠ/root/redis-3.0.0/redis.confå¤åˆ¶åˆ°/usr/local/redis/binç›®å½•ä¸‹</li>\n<li>[root@localhost redis-3.0.0]# cp redis.conf /usr/local/redis/bin/</li>\n</ul>\n</li>\n<li>6.ä¿®æ”¹é…ç½®æ–‡ä»¶ï¼šdaemonize no ä¸ºyes\n<ul>\n<li>[root@localhost bin]# ./redis-server redis.conf</li>\n</ul>\n</li>\n<li>æŸ¥çœ‹redisè¿›ç¨‹ï¼š[root@localhost bin]# ps aux|grep redis</li>\n</ul>\n</li>\n<li>\n<p>redis-cliè¿æ¥ : [root@localhost bin]# ./redis-cli é»˜è®¤è¿æ¥localhostè¿è¡Œåœ¨6379ç«¯å£çš„redisæœåŠ¡ã€‚</p>\n<ul>\n<li>[root@localhost bin]# ./redis-cli -h 192.168.25.153 -p 6379<br>\n-hï¼šè¿æ¥çš„æœåŠ¡å™¨çš„åœ°å€<br>\n-pï¼šæœåŠ¡çš„ç«¯å£å·</li>\n</ul>\n</li>\n<li>\n<p>å…³é—­redisï¼š[root@localhost bin]# ./redis-cli shutdown</p>\n</li>\n<li>\n<p>è®¾ç½®å¯†ç ï¼šconfig set requirepass pass_123456</p>\n</li>\n<li>\n<p>è·å–å¯†ç ï¼šconfig get requirepass</p>\n</li>\n<li>\n<p>ç™»å½•ï¼šauth password</p>\n</li>\n</ul>\n<h1>11. Redisé›†ç¾¤çš„æ­å»º</h1>\n<ul>\n<li>\n<p>Redisé›†ç¾¤ä¸­è‡³å°‘åº”è¯¥æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ã€‚è¦ä¿è¯é›†ç¾¤çš„é«˜å¯ç”¨ï¼Œéœ€è¦æ¯ä¸ªèŠ‚ç‚¹æœ‰ä¸€ä¸ªå¤‡ä»½æœºã€‚</p>\n<ul>\n<li>Redisé›†ç¾¤è‡³å°‘éœ€è¦6å°æœåŠ¡å™¨ã€‚</li>\n<li>æ­å»ºä¼ªåˆ†å¸ƒå¼ã€‚å¯ä»¥ä½¿ç”¨ä¸€å°è™šæ‹Ÿæœºè¿è¡Œ6ä¸ªrediså®ä¾‹ã€‚éœ€è¦ä¿®æ”¹redisçš„ç«¯å£å·7001-7006</li>\n</ul>\n</li>\n<li>\n<p>é›†ç¾¤æ­å»ºç¯å¢ƒ</p>\n<ul>\n<li>\n<p>ä½¿ç”¨rubyè„šæœ¬æ­å»ºé›†ç¾¤ã€‚éœ€è¦rubyçš„è¿è¡Œç¯å¢ƒã€‚</p>\n<ul>\n<li>yum install ruby</li>\n<li>yum install rubygems</li>\n</ul>\n</li>\n<li>\n<p>å®‰è£…rubyè„šæœ¬è¿è¡Œä½¿ç”¨çš„åŒ…ã€‚</p>\n<ul>\n<li>å°†redis-3.0.0å’Œredis-3.0.0.gemæ”¾åœ¨ä¸€èµ·ç„¶åæ‰§è¡Œ</li>\n<li>gem install redis-3.0.0.gem</li>\n</ul>\n</li>\n<li>\n<p>æ­å»ºæ­¥éª¤:éœ€è¦6ä¸ªrediså®ä¾‹ã€‚éœ€è¦è¿è¡Œåœ¨ä¸åŒçš„ç«¯å£7001-7006</p>\n</li>\n</ul>\n</li>\n<li>\n<p>ç¬¬ä¸€æ­¥ï¼šåˆ›å»º6ä¸ªrediså®ä¾‹ï¼Œæ¯ä¸ªå®ä¾‹è¿è¡Œåœ¨ä¸åŒçš„ç«¯å£ã€‚</p>\n<ul>\n<li>å¦‚æœä½ çš„èŠ‚ç‚¹ä¸­åŒ…å«äº†appendonly.aofå’Œdump.rdbè¯·åˆ é™¤äº†ï¼Œä¿è¯èŠ‚ç‚¹çš„å¹²å‡€</li>\n<li>éœ€è¦ä¿®æ”¹redis.confé…ç½®æ–‡ä»¶ã€‚é…ç½®æ–‡ä»¶ä¸­è¿˜éœ€è¦æŠŠcluster-enabled yeså‰çš„æ³¨é‡Šå»æ‰ã€‚</li>\n<li>åŒæ—¶ä¿®æ”¹portä¸º7001</li>\n<li>cp redis/bin /usr/java/redis-cluster/redis07 -rå°†ä¹‹å‰å®‰è£…å¥½çš„binç›®å½•ä¸€ä¸ªä¸€ä¸ªå¤åˆ¶åˆ°redis-clusterä¸­</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5a73634ac3215338bd49b.png\" alt=\"å›¾ç‰‡7.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡7.png</figcaption></figure>\n<ul>\n<li>ç¬¬äºŒæ­¥ï¼šå¯åŠ¨æ¯ä¸ªrediså®ä¾‹ã€‚\n<ul>\n<li>åœ¨redis-clusterç›®å½•ä¸‹åˆ›å»ºstart-all.shæ‰§è¡Œvim start</li>\n<li>ç„¶åiå†™å…¥</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tcd redis01\n\t./redis-server redis.conf\n\tcd ..\n\tcd redis02\n\t./redis-server redis.conf\n\tcd ..\n\tcd redis03\n\t./redis-server redis.conf\n\tcd ..\n\tcd redis04\n\t./redis-server redis.conf\n\tcd ..\n\tcd redis05\n\t./redis-server redis.conf\n\tcd ..\n\tcd redis06\n\t./redis-server redis.conf\n\tcd ..\n\tç„¶åescï¼Œç„¶åï¼šwqé€€å‡º\n\tæ‰§è¡Œchmod u+x start-all.shæˆæƒ\n\tæ‰§è¡Œ./start-all.shå¼€å¯æ‰€æœ‰rediså®ä¾‹\n\tæ‰§è¡Œps aux|grep redisæŸ¥çœ‹æ‰€æœ‰èŠ‚ç‚¹è¿›ç¨‹çœ‹æ˜¯å¦æˆåŠŸ\n\tåœ¨redisæºç çš„srcåœ¨æœ‰ä¸€ä¸ªæ–‡ä»¶å«redis-trib.rb\n\tå°†å®ƒå¤åˆ¶åˆ°/usr/java/redis-clusterç›®å½•ä¸‹\n</code></pre></div><ul>\n<li>ç¬¬ä¸‰æ­¥ï¼šä½¿ç”¨rubyè„šæœ¬æ­å»ºé›†ç¾¤ã€‚\n<ul>\n<li>å°†å®ƒå¤åˆ¶åˆ°/usr/java/redis-clusterç›®å½•ä¸‹æ‰§è¡Œ</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\t./redis-trib.rb create --replicas 1 192.168.25.153:7001 192.168.25.153:7002 192.168.25.153:7003 192.168.25.153:7004 192.168.25.153:7005 192.168.25.153:7006\n</code></pre></div><ul>\n<li>è¿™ä¸ªä¸è¦éšä¾¿ä¹±ç”¨ï¼å¦åˆ™è¦å…³é—­redisæ‰€æœ‰çš„èŠ‚ç‚¹ï¼Œç„¶åå°†æ¯ä¸ªèŠ‚ç‚¹ä¸‹aofã€rdbã€nodes.confæœ¬åœ°å¤‡ä»½æ–‡ä»¶åˆ é™¤ï¼› é‡å¯æ‰€æœ‰èŠ‚ç‚¹ï¼Œç„¶åé‡æ–°æ‰§è¡Œè„šæœ¬ï¼\n<ul>\n<li>åˆ›å»ºå…³é—­é›†ç¾¤çš„è„šæœ¬ï¼š</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>[root@localhost redis-cluster]# vim shutdow-all.sh\nredis01/redis-cli -p 7001 shutdown\nredis01/redis-cli -p 7002 shutdown\nredis01/redis-cli -p 7003 shutdown\nredis01/redis-cli -p 7004 shutdown\nredis01/redis-cli -p 7005 shutdown\nredis01/redis-cli -p 7006 shutdown\n[root@localhost redis-cluster]# chmod u+x shutdow-all.sh \n\né›†ç¾¤çš„ä½¿ç”¨æ–¹æ³•\nRedis-cliè¿æ¥é›†ç¾¤ã€‚[root@localhost redis-cluster]# redis01/redis-cli -p 7002 -c  -cï¼šä»£è¡¨è¿æ¥çš„æ˜¯redisé›†ç¾¤\n</code></pre></div><h1>12. javaè¿æ¥åˆ™ç”¨jedis</h1>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/28327364030668f3c4d44.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "mycat",
      "url": "https://javaguide.cn/backend/databasemiddleware/mycat.html",
      "id": "https://javaguide.cn/backend/databasemiddleware/mycat.html",
      "summary": "mycatæ˜¯ç”¨æ¥åšæ•°æ®åº“é›†ç¾¤çš„ ä»€ä¹ˆæ˜¯MyCATï¼Ÿ MyCATçš„å…³é”®ç‰¹æ€§ MyCATæ¶æ„ å›¾ç‰‡1.pngå›¾ç‰‡1.png Mycatè§£å†³çš„é—®é¢˜ å›¾ç‰‡2.pngå›¾ç‰‡2.png Mycatå¯¹å¤šæ•°æ®åº“çš„æ”¯æŒ å›¾ç‰‡3.pngå›¾ç‰‡3.png åˆ†ç‰‡ç­–ç•¥ å›¾ç‰‡4.pngå›¾ç‰‡4.png Mycatè¯»å†™åˆ†ç¦» å›¾ç‰‡5.pngå›¾ç‰‡5.png å›¾ç‰‡6.pngå›¾ç‰‡6.png",
      "content_html": "<p>mycatæ˜¯ç”¨æ¥åšæ•°æ®åº“é›†ç¾¤çš„</p>\n<!--more-->\n<h2>ä»€ä¹ˆæ˜¯MyCATï¼Ÿ</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç®€å•çš„è¯´ï¼ŒMyCATå°±æ˜¯ï¼š\nä¸€ä¸ªå½»åº•å¼€æºçš„ï¼Œé¢å‘ä¼ä¸šåº”ç”¨å¼€å‘çš„â€œå¤§æ•°æ®åº“é›†ç¾¤â€\næ”¯æŒäº‹åŠ¡ã€ACIDã€å¯ä»¥æ›¿ä»£Mysqlçš„åŠ å¼ºç‰ˆæ•°æ®åº“\nä¸€ä¸ªå¯ä»¥è§†ä¸ºâ€œMysqlâ€é›†ç¾¤çš„ä¼ä¸šçº§æ•°æ®åº“ï¼Œç”¨æ¥æ›¿ä»£æ˜‚è´µçš„Oracleé›†ç¾¤\nä¸€ä¸ªèåˆå†…å­˜ç¼“å­˜æŠ€æœ¯ã€NosqlæŠ€æœ¯ã€HDFSå¤§æ•°æ®çš„æ–°å‹SQL Server\nç»“åˆä¼ ç»Ÿæ•°æ®åº“å’Œæ–°å‹åˆ†å¸ƒå¼æ•°æ®ä»“åº“çš„æ–°ä¸€ä»£ä¼ä¸šçº§æ•°æ®åº“äº§å“\nä¸€ä¸ªæ–°é¢–çš„æ•°æ®åº“ä¸­é—´ä»¶äº§å“\n</code></pre></div><h2>MyCATçš„å…³é”®ç‰¹æ€§</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ”¯æŒ SQL 92æ ‡å‡†\næ”¯æŒMysqlé›†ç¾¤ï¼Œå¯ä»¥ä½œä¸ºProxyä½¿ç”¨\næ”¯æŒJDBCè¿æ¥ORACLEã€DB2ã€SQL Serverï¼Œå°†å…¶æ¨¡æ‹Ÿä¸ºMySQL  Serverä½¿ç”¨\næ”¯æŒgalera for mysqlé›†ç¾¤ï¼Œpercona-clusteræˆ–è€…mariadb clusterï¼Œæä¾›é«˜å¯ç”¨æ€§æ•°æ®åˆ†ç‰‡é›†ç¾¤\nè‡ªåŠ¨æ•…éšœåˆ‡æ¢ï¼Œé«˜å¯ç”¨æ€§\næ”¯æŒè¯»å†™åˆ†ç¦»ï¼Œæ”¯æŒMysqlåŒä¸»å¤šä»ï¼Œä»¥åŠä¸€ä¸»å¤šä»çš„æ¨¡å¼\næ”¯æŒå…¨å±€è¡¨ï¼Œæ•°æ®è‡ªåŠ¨åˆ†ç‰‡åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼Œç”¨äºé«˜æ•ˆè¡¨å…³è”æŸ¥è¯¢\næ”¯æŒç‹¬æœ‰çš„åŸºäºE-R å…³ç³»çš„åˆ†ç‰‡ç­–ç•¥ï¼Œå®ç°äº†é«˜æ•ˆçš„è¡¨å…³è”æŸ¥è¯¢\nå¤šå¹³å°æ”¯æŒï¼Œéƒ¨ç½²å’Œå®æ–½ç®€å•\n</code></pre></div><h2>MyCATæ¶æ„</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/be77b7731e8a7d473fae0.png\" alt=\"å›¾ç‰‡1.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡1.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¦‚å›¾æ‰€ç¤ºï¼šMyCATä½¿ç”¨Mysqlçš„é€šè®¯åè®®æ¨¡æ‹Ÿæˆäº†ä¸€ä¸ªMysqlæœåŠ¡å™¨ï¼Œå¹¶å»ºç«‹äº†å®Œæ•´çš„Schemaï¼ˆæ•°æ®åº“ï¼‰ã€Table ï¼ˆæ•°æ®è¡¨ï¼‰ã€User(ç”¨æˆ·)çš„é€»è¾‘æ¨¡å‹ï¼Œ\nå¹¶å°†è¿™å¥—é€»è¾‘æ¨¡å‹æ˜ å°„åˆ°åç«¯çš„å­˜å‚¨èŠ‚ç‚¹DataNodeï¼ˆMySQL Instanceï¼‰ä¸Šçš„çœŸå®ç‰©ç†åº“ä¸­ï¼Œ\nè¿™æ ·ä¸€æ¥ï¼Œæ‰€æœ‰èƒ½ä½¿ç”¨Mysqlçš„å®¢æˆ·ç«¯ä»¥åŠç¼–ç¨‹è¯­è¨€éƒ½èƒ½å°†MyCATå½“æˆæ˜¯Mysql Serveræ¥ä½¿ç”¨ï¼Œä¸å¿…å¼€å‘æ–°çš„å®¢æˆ·ç«¯åè®®ã€‚\n</code></pre></div><h2>Mycatè§£å†³çš„é—®é¢˜</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ€§èƒ½é—®é¢˜\næ•°æ®åº“è¿æ¥è¿‡å¤š\nE-Råˆ†ç‰‡éš¾å¤„ç†\nå¯ç”¨æ€§é—®é¢˜\næˆæœ¬å’Œä¼¸ç¼©æ€§é—®é¢˜\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/68e7f50ac03acbda118c5.png\" alt=\"å›¾ç‰‡2.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡2.png</figcaption></figure>\n<h2>Mycatå¯¹å¤šæ•°æ®åº“çš„æ”¯æŒ</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/49b80914303756fdc7d09.png\" alt=\"å›¾ç‰‡3.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡3.png</figcaption></figure>\n<h2>åˆ†ç‰‡ç­–ç•¥</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>MyCATæ”¯æŒæ°´å¹³åˆ†ç‰‡ä¸å‚ç›´åˆ†ç‰‡ï¼š\næ°´å¹³åˆ†ç‰‡ï¼šä¸€ä¸ªè¡¨æ ¼çš„æ•°æ®åˆ†å‰²åˆ°å¤šä¸ªèŠ‚ç‚¹ä¸Šï¼ŒæŒ‰ç…§è¡Œåˆ†éš”ã€‚\nå‚ç›´åˆ†ç‰‡ï¼šä¸€ä¸ªæ•°æ®åº“ä¸­å¤šä¸ªè¡¨æ ¼Aï¼ŒBï¼ŒCï¼ŒAå­˜å‚¨åˆ°èŠ‚ç‚¹1ä¸Šï¼ŒBå­˜å‚¨åˆ°èŠ‚ç‚¹2ä¸Šï¼ŒCå­˜å‚¨åˆ°èŠ‚ç‚¹3ä¸Šã€‚\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3bf27b197b0c27e368119.png\" alt=\"å›¾ç‰‡4.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡4.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>MyCATé€šè¿‡å®šä¹‰è¡¨çš„åˆ†ç‰‡è§„åˆ™æ¥å®ç°åˆ†ç‰‡ï¼Œæ¯ä¸ªè¡¨æ ¼å¯ä»¥æ†ç»‘ä¸€ä¸ªåˆ†ç‰‡è§„åˆ™ï¼Œæ¯ä¸ªåˆ†ç‰‡è§„åˆ™æŒ‡å®šä¸€ä¸ªåˆ†ç‰‡å­—æ®µå¹¶ç»‘å®šä¸€ä¸ªå‡½æ•°ï¼Œæ¥å®ç°åŠ¨æ€åˆ†ç‰‡ç®—æ³•ã€‚\n\nSchemaï¼šé€»è¾‘åº“ï¼Œä¸MySQLä¸­çš„Databaseï¼ˆæ•°æ®åº“ï¼‰å¯¹åº”ï¼Œä¸€ä¸ªé€»è¾‘åº“ä¸­å®šä¹‰äº†æ‰€åŒ…æ‹¬çš„Tableã€‚\nTableï¼šè¡¨ï¼Œå³ç‰©ç†æ•°æ®åº“ä¸­å­˜å‚¨çš„æŸä¸€å¼ è¡¨ï¼Œè¡¨æ ¼éœ€è¦å£°æ˜å…¶æ‰€å­˜å‚¨çš„é€»è¾‘æ•°æ®èŠ‚ç‚¹DataNodeã€‚åœ¨æ­¤å¯ä»¥æŒ‡å®šè¡¨çš„åˆ†ç‰‡è§„åˆ™ã€‚\nDataNodeï¼šMyCATçš„é€»è¾‘æ•°æ®èŠ‚ç‚¹ï¼Œæ˜¯å­˜æ”¾tableçš„å…·ä½“ç‰©ç†èŠ‚ç‚¹ï¼Œä¹Ÿç§°ä¹‹ä¸ºåˆ†ç‰‡èŠ‚ç‚¹ï¼Œé€šè¿‡DataSourceæ¥å…³è”åˆ°åç«¯æŸä¸ªå…·ä½“æ•°æ®åº“ä¸Š\nDataSourceï¼šå®šä¹‰æŸä¸ªç‰©ç†åº“çš„è®¿é—®åœ°å€ï¼Œç”¨äºæ†ç»‘åˆ°Datanodeä¸Š\n</code></pre></div><h2>Mycatè¯»å†™åˆ†ç¦»</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ•°æ®åº“è¯»å†™åˆ†ç¦»å¯¹äºå¤§å‹ç³»ç»Ÿæˆ–è€…è®¿é—®é‡å¾ˆé«˜çš„äº’è”ç½‘åº”ç”¨æ¥è¯´ï¼Œæ˜¯å¿…ä¸å¯å°‘çš„ä¸€ä¸ªé‡è¦åŠŸèƒ½ã€‚å¯¹äºMySQLæ¥è¯´ï¼Œæ ‡å‡†çš„è¯»å†™åˆ†ç¦»æ˜¯ä¸»ä»æ¨¡å¼ï¼Œ\nä¸€ä¸ªå†™èŠ‚ç‚¹Masteråé¢è·Ÿç€å¤šä¸ªè¯»èŠ‚ç‚¹ï¼Œè¯»èŠ‚ç‚¹çš„æ•°é‡å–å†³äºç³»ç»Ÿçš„å‹åŠ›ï¼Œé€šå¸¸æ˜¯1-3ä¸ªè¯»èŠ‚ç‚¹çš„é…ç½®\nMycatè¯»å†™åˆ†ç¦»å’Œè‡ªåŠ¨åˆ‡æ¢æœºåˆ¶ï¼Œéœ€è¦mysqlçš„ä¸»ä»å¤åˆ¶æœºåˆ¶é…åˆã€‚\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c4d3eb1798cca24863085.png\" alt=\"å›¾ç‰‡5.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡5.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Mysqlçš„ä¸»ä»å¤åˆ¶\nä¸»ä»é…ç½®éœ€è¦æ³¨æ„çš„åœ°æ–¹\n1ã€ä¸»DB serverå’Œä»DB serveræ•°æ®åº“çš„ç‰ˆæœ¬ä¸€è‡´\n2ã€ä¸»DB serverå’Œä»DB serveræ•°æ®åº“æ•°æ®ä¸€è‡´[ è¿™é‡Œå°±ä¼šå¯ä»¥æŠŠä¸»çš„å¤‡ä»½åœ¨ä»ä¸Šè¿˜åŸï¼Œä¹Ÿå¯ä»¥ç›´æ¥å°†ä¸»çš„æ•°æ®ç›®å½•æ‹·è´åˆ°ä»çš„ç›¸åº”æ•°æ®ç›®å½•]\n3ã€ä¸»DB serverå¼€å¯äºŒè¿›åˆ¶æ—¥å¿—,ä¸»DB serverå’Œä»DB serverçš„server_idéƒ½å¿…é¡»å”¯ä¸€\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/290e0357dc61fcd674032.png\" alt=\"å›¾ç‰‡6.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡6.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Mysqlä¸»æœåŠ¡å™¨é…ç½®\nç¬¬ä¸€æ­¥ï¼šä¿®æ”¹my.confæ–‡ä»¶ï¼š\nåœ¨[mysqld]æ®µä¸‹æ·»åŠ ï¼š\nbinlog-do-db=db1\nbinlog-ignore-db=mysql\n#å¯ç”¨äºŒè¿›åˆ¶æ—¥å¿—\nlog-bin=mysql-bin\n#æœåŠ¡å™¨å”¯ä¸€IDï¼Œä¸€èˆ¬å–IPæœ€åä¸€æ®µ\nserver-id=134\n\nç¬¬äºŒæ­¥ï¼šé‡å¯mysqlæœåŠ¡\nservice mysqld restart\n\nç¬¬ä¸‰æ­¥ï¼šå»ºç«‹å¸æˆ·å¹¶æˆæƒslave\nmysql&gt;GRANT FILE ON *.* TO 'backup'@'%' IDENTIFIED BY '123456';\nmysql&gt;GRANT REPLICATION SLAVE, REPLICATION CLIENT ON *.* to 'backup'@'%' identified by '123456'; \n#ä¸€èˆ¬ä¸ç”¨rootå¸å·ï¼Œâ€œ%â€è¡¨ç¤ºæ‰€æœ‰å®¢æˆ·ç«¯éƒ½å¯èƒ½è¿ï¼Œåªè¦å¸å·ï¼Œå¯†ç æ­£ç¡®ï¼Œæ­¤å¤„å¯ç”¨å…·ä½“å®¢æˆ·ç«¯IPä»£æ›¿ï¼Œå¦‚192.168.145.226ï¼ŒåŠ å¼ºå®‰å…¨ã€‚\nåˆ·æ–°æƒé™ :FLUSH PRIVILEGES;\næŸ¥çœ‹mysqlç°åœ¨æœ‰å“ªäº›ç”¨æˆ·:select user,host from mysql.user;\n\nç¬¬å››æ­¥ï¼šæŸ¥è¯¢masterçš„çŠ¶æ€\nmysql&gt; show master status;\n+</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/be77b7731e8a7d473fae0.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Git",
      "url": "https://javaguide.cn/backend/developmenttool/git.html",
      "id": "https://javaguide.cn/backend/developmenttool/git.html",
      "summary": "gitä»£ç ç®¡ç†å·¥å…· 1. ä»‹ç» gitä»“åº“ç»„æˆéƒ¨åˆ† 2. é¡¹ç›®ç®¡ç† 3. gitå‘½ä»¤ Git å’Œ SVN çš„ä¼˜ç¼ºç‚¹ï¼Ÿ gitå¦‚ä½•è§£å†³å†²çªï¼Ÿ ä»€ä¹ˆæ˜¯ fork æ“ä½œï¼Ÿ 1. ä»‹ç» Gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆã€é«˜é€Ÿçš„å¤„ç†ä»å¾ˆå°åˆ°éå¸¸å¤§çš„é¡¹ç›®ç‰ˆæœ¬ç®¡ç†ã€‚ 1.png1.png gitä»“åº“ç»„æˆéƒ¨åˆ† å·¥ä½œåŒº(Working Directory)...",
      "content_html": "<p>gitä»£ç ç®¡ç†å·¥å…·</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E4%BB%8B%E7%BB%8D\">1. ä»‹ç»</a></li>\n<li><a href=\"#git%E4%BB%93%E5%BA%93%E7%BB%84%E6%88%90%E9%83%A8%E5%88%86\">gitä»“åº“ç»„æˆéƒ¨åˆ†</a></li>\n<li><a href=\"#2-%E9%A1%B9%E7%9B%AE%E7%AE%A1%E7%90%86\">2. é¡¹ç›®ç®¡ç†</a></li>\n<li><a href=\"#3-git%E5%91%BD%E4%BB%A4\">3. gitå‘½ä»¤</a></li>\n<li><a href=\"#git-%E5%92%8C-svn-%E7%9A%84%E4%BC%98%E7%BC%BA%E7%82%B9\">Git å’Œ SVN çš„ä¼˜ç¼ºç‚¹ï¼Ÿ</a></li>\n<li><a href=\"#git%E5%A6%82%E4%BD%95%E8%A7%A3%E5%86%B3%E5%86%B2%E7%AA%81\">gitå¦‚ä½•è§£å†³å†²çªï¼Ÿ</a></li>\n<li><a href=\"#%E4%BB%80%E4%B9%88%E6%98%AF-fork-%E6%93%8D%E4%BD%9C\">ä»€ä¹ˆæ˜¯ fork æ“ä½œï¼Ÿ</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. ä»‹ç»</h1>\n<p>Gitæ˜¯ä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼ç‰ˆæœ¬æ§åˆ¶ç³»ç»Ÿï¼Œå¯ä»¥æœ‰æ•ˆã€é«˜é€Ÿçš„å¤„ç†ä»å¾ˆå°åˆ°éå¸¸å¤§çš„é¡¹ç›®ç‰ˆæœ¬ç®¡ç†ã€‚</p>\n<figure><img src=\"https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwac4b6b53d5456c8e13428f6803458191.png\" alt=\"1.png\" tabindex=\"0\"><figcaption>1.png</figcaption></figure>\n<h1>gitä»“åº“ç»„æˆéƒ¨åˆ†</h1>\n<ul>\n<li>å·¥ä½œåŒº(Working Directory)ï¼šåœ¨ Git ç®¡ç†ä¸‹çš„æ­£å¸¸ç›®å½•éƒ½ç®—æ˜¯å·¥ä½œåŒºï¼Œæˆ‘ä»¬å¹³æ—¶çš„ç¼–è¾‘å·¥ä½œéƒ½æ˜¯åœ¨å·¥ä½œåŒºå®Œæˆã€‚</li>\n<li>æš‚å­˜åŒº(Stage)ï¼šä¸´æ—¶åŒºåŸŸã€‚é‡Œé¢å­˜æ”¾å°†è¦æäº¤æ–‡ä»¶çš„å¿«ç…§ã€‚</li>\n<li>å†å²è®°å½•åŒº(History)ï¼šgit commit åçš„è®°å½•åŒºã€‚</li>\n<li>ä¸‰ä¸ªåŒºçš„è½¬æ¢å…³ç³»ä»¥åŠè½¬æ¢æ‰€ä½¿ç”¨çš„å‘½ä»¤<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0c8b9d3839f0f3a1b3e90.png\" alt=\"Gitä»“åº“ç»„æˆéƒ¨åˆ†.jpg\"></li>\n</ul>\n<h1>2. é¡¹ç›®ç®¡ç†</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>- æ²¡æœ‰ä»“åº“æ—¶åˆ›å»ºä»“åº“å¹¶æäº¤ä»£ç \necho \"# utils\" &gt;&gt; README.md\ngit init\ngit add README.md\ngit commit -m \"first commit\"\ngit remote add origin https://github.com/HeChuangJun/utils.git\ngit push -u origin master\n\n- æœ‰ä»“åº“æ—¶æäº¤ä»£ç \ngit remote add origin https://github.com/HeChuangJun/utils.git\ngit push -u origin master\n\n- ç¬¬äºŒæ¬¡æäº¤ä»£ç \ngit add .\ngit commit -m \"æäº¤ä¿¡æ¯\"\ngit push\n</code></pre></div><h1>3. gitå‘½ä»¤</h1>\n<ul>\n<li>gitå‘½ä»¤è¡¨:<a href=\"https://gitee.com/liaoxuefeng/learn-java/raw/master/teach/git-cheatsheet.pdf\" target=\"_blank\" rel=\"noopener noreferrer\">https://gitee.com/liaoxuefeng/learn-java/raw/master/teach/git-cheatsheet.pdf</a></li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºç‰ˆæœ¬åº“\n- git clone &lt;ulr&gt; //å…‹éš†è¿œç¨‹ç‰ˆæœ¬åº“\n- git init //åˆå§‹åŒ–æœ¬åœ°ç‰ˆæœ¬åº“(å½“å‰ç›®å½•ä¸‹å¤šäº†ä¸€ä¸ª.gitéšè—ç›®å½•)\n\n# ä¿®æ”¹å’Œæäº¤\n- git status //æŸ¥çœ‹æ–‡ä»¶çš„æäº¤æƒ…å†µ\n- git diff [&lt;file&gt;]//æŸ¥çœ‹[æ–‡ä»¶]å˜æ›´å†…å®¹\n- git add . //è·Ÿè¸ªæ‰€æœ‰æ”¹åŠ¨æ–‡ä»¶,æäº¤åˆ°æš‚å­˜åŒº\n- git add &lt;file&gt; //è·Ÿè¸ªæŒ‡å®šæ–‡ä»¶ æ–‡ä»¶æ·»åŠ åˆ°æš‚å­˜åŒº.\n- git mv &lt;old&gt; &lt;new&gt; //æ–‡ä»¶æ”¹å\n- git rm &lt;file&gt; //åˆ é™¤æ–‡ä»¶\n- git rm --cached &lt;file&gt; //åœæ­¢è·Ÿè¸ªæ–‡ä»¶ä½†ä¸åˆ é™¤\n- git commit -m \"commit message\" //å°†æš‚å­˜åŒºçš„æ–‡ä»¶æ·»åŠ åˆ°ä»“åº“\n- git commit --amend //ä¿®æ”¹æœ€åä¸€æ¬¡æäº¤\n\n- git stash  //æš‚å­˜ã€‚\n- git stash pop //æ¢å¤æœ€è¿‘ä¸€æ¬¡çš„æš‚å­˜ã€‚\n- git stash list//gitæ˜¾ç¤ºæ‰€æœ‰å¤‡ä»½:\n- git stash popï¼Œæ¢å¤çš„å¤‡ä»½åŒæ—¶æŠŠstashå†…å®¹ä¹Ÿåˆ äº†\n- git stash apply stash@{0} //gitæ¢å¤å•ä¸ªå¤‡ä»½ä¸åˆ é™¤stashçš„å†…å®¹:\n\n# æŸ¥çœ‹æäº¤å†å²\n- git log //æ˜¾ç¤ºgitæœ€è¿‘åˆ°æœ€è¿œçš„æäº¤commit idå†å²\n- git log -p &lt;file&gt; //æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æäº¤å†å²\n- git blame &lt;file&gt; //ä»¥åˆ—è¡¨çš„æ–¹å¼æŸ¥çœ‹æŒ‡å®šæ–‡ä»¶çš„æäº¤å†å²\n- git show &lt;commit&gt;//æŸ¥çœ‹æŸæ¬¡æäº¤å†…å®¹\n- git reflog //æ˜¾ç¤ºå‘½ä»¤å†å²\n- git log --pretty=oneline //æ˜¾ç¤ºgitæœ€è¿‘ä¸€æ¬¡çš„commit idå†å²\n\n# æ’¤é”€\n- git reset &lt;file&gt; //ä»æš‚å­˜åŒºæ¢å¤åˆ°å·¥ä½œæ–‡ä»¶ã€‚git add &lt;file&gt; çš„é€†æ“ä½œã€‚\n- git reset --hard HEAD //æ’¤é”€å·¥ä½œç›®å½•ä¸­æ‰€æœ‰æœªæäº¤æ–‡ä»¶çš„ä¿®æ”¹å†…å®¹\n- git reset --hard HEAD^(^)//å›é€€ä¸Š(ä¸Š)ä¸ªç‰ˆæœ¬\n- git reset --hard HEAD~100//å›é€€è®¸å¤šç‰ˆæœ¬\n- git reset --hard &lt;commit id&gt;//å›é€€ï¼ˆæ›´æ–°ï¼‰åˆ°æŒ‡å®šç‰ˆæœ¬\n- git reset HEAD^ ï¼šæ¢å¤æœ€è¿‘ä¸€æ¬¡æäº¤è¿‡çš„çŠ¶æ€ï¼Œå³æ”¾å¼ƒä¸Šæ¬¡æäº¤åçš„æ‰€æœ‰æœ¬æ¬¡ä¿®æ”¹` ã€‚\n- git checkout HEAD &lt;file&gt; //æ’¤é”€æŒ‡å®šçš„æœªæäº¤æ–‡ä»¶çš„ä¿®æ”¹å†…å®¹\n- git revert &lt;commit&gt; //æ’¤é”€æŒ‡å®šçš„æäº¤id\n\n# åˆ†æ”¯\n- git branch //æŸ¥çœ‹æ‰€æœ‰æœ¬åœ°åˆ†æ”¯,å¹¶æ˜¾ç¤ºå½“å‰åˆ†æ”¯\n- git branch -r //æŸ¥çœ‹è¿œç¨‹åˆ†æ”¯\n- git branch &lt;new-branch&gt; //åˆ›å»ºæ–°åˆ†æ”¯ \n- git checkout &lt;branch/tag&gt; //åˆ‡æ¢åˆ†æ”¯\n- git checkout -b &lt;branch&gt; //gitåˆ›å»ºåˆ†æ”¯å¹¶åˆ‡æ¢åˆ°åˆ†æ”¯,ç›¸å½“äº git branch &lt;åˆ†æ”¯å&gt; + git checkout &lt;åˆ†æ”¯å&gt;\n- git branch -d &lt;branch&gt; //åˆ é™¤æœ¬åœ°åˆ†æ”¯\n- git push origin :&lt;branch&gt; //å†’å·åˆ é™¤è¿œç¨‹åˆ†æ”¯\n\n# æ ‡ç­¾\n- git tag //æŸ¥çœ‹æœ¬åœ°æ‰€æœ‰tagæ ‡ç­¾\n- gti show &lt;tagname&gt;//æŸ¥çœ‹æŒ‡å®šæ ‡ç­¾\n- git tag &lt;tagname&gt; [&lt;commitid&gt;] //åŸºäº[æäº¤id]æœ€æ–°æäº¤åˆ›å»ºæ ‡ç­¾\n- git tag -a v0.1 -m \"version 0.1 released\" 1094adb //gitæ‰“æ ‡ç­¾æŒ‡å®šç‰ˆæœ¬å’Œæ ‡ç­¾çš„ä¿¡æ¯:\n- git push origin &lt;tagname&gt;//æ¨é€æœ¬åœ°æ ‡ç­¾åˆ°è¿œç¨‹\n- git push origin </code></pre></div>",
      "image": "https://b.bdstatic.com/comment/Y_bZHaS27NSYIAE9PqRzMwac4b6b53d5456c8e13428f6803458191.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "Maven",
      "url": "https://javaguide.cn/backend/developmenttool/maven.html",
      "id": "https://javaguide.cn/backend/developmenttool/maven.html",
      "summary": "mavené¡¹ç›®ç®¡ç†å·¥å…· 1. mavenæ¦‚è¿° 2. mavené¡¹ç›®æ„å»ºè¿‡ç¨‹ 3. mavené¡¹ç›®ä¾èµ–ç®¡ç† 4. mavenä»“åº“ 5. mavenå·¥ç¨‹ç›®å½• 6. å¸¸ç”¨mavenå‘½ä»¤ 7. mavenæ¦‚å¿µæ¨¡å‹å†…å®¹ 8. pom.xmlåŸºæœ¬é…ç½® 9. ä¾èµ–ç®¡ç† 10. ä¾èµ–èŒƒå›´å¯¹ä¼ é€’ä¾èµ–çš„å½±å“ 11. ä¾èµ–ä¼ é€’ä¸ä¾èµ–å†²çªè§£å†³ 1. mavenæ¦‚è¿° apach...",
      "content_html": "<p>mavené¡¹ç›®ç®¡ç†å·¥å…·</p>\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-maven%E6%A6%82%E8%BF%B0\">1. mavenæ¦‚è¿°</a></li>\n<li><a href=\"#2-maven%E9%A1%B9%E7%9B%AE%E6%9E%84%E5%BB%BA%E8%BF%87%E7%A8%8B\">2. mavené¡¹ç›®æ„å»ºè¿‡ç¨‹</a></li>\n<li><a href=\"#3-maven%E9%A1%B9%E7%9B%AE%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86\">3. mavené¡¹ç›®ä¾èµ–ç®¡ç†</a></li>\n<li><a href=\"#4-maven%E4%BB%93%E5%BA%93\">4. mavenä»“åº“</a></li>\n<li><a href=\"#5-maven%E5%B7%A5%E7%A8%8B%E7%9B%AE%E5%BD%95\">5. mavenå·¥ç¨‹ç›®å½•</a></li>\n<li><a href=\"#6-%E5%B8%B8%E7%94%A8maven%E5%91%BD%E4%BB%A4\">6. å¸¸ç”¨mavenå‘½ä»¤</a></li>\n<li><a href=\"#7-maven%E6%A6%82%E5%BF%B5%E6%A8%A1%E5%9E%8B%E5%86%85%E5%AE%B9\">7. mavenæ¦‚å¿µæ¨¡å‹å†…å®¹</a></li>\n<li><a href=\"#8-pomxml%E5%9F%BA%E6%9C%AC%E9%85%8D%E7%BD%AE\">8. pom.xmlåŸºæœ¬é…ç½®</a></li>\n<li><a href=\"#9-%E4%BE%9D%E8%B5%96%E7%AE%A1%E7%90%86\">9. ä¾èµ–ç®¡ç†</a></li>\n<li><a href=\"#10-%E4%BE%9D%E8%B5%96%E8%8C%83%E5%9B%B4%E5%AF%B9%E4%BC%A0%E9%80%92%E4%BE%9D%E8%B5%96%E7%9A%84%E5%BD%B1%E5%93%8D\">10. ä¾èµ–èŒƒå›´å¯¹ä¼ é€’ä¾èµ–çš„å½±å“</a></li>\n<li><a href=\"#11-%E4%BE%9D%E8%B5%96%E4%BC%A0%E9%80%92%E4%B8%8E%E4%BE%9D%E8%B5%96%E5%86%B2%E7%AA%81%E8%A7%A3%E5%86%B3\">11. ä¾èµ–ä¼ é€’ä¸ä¾èµ–å†²çªè§£å†³</a></li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. mavenæ¦‚è¿°</h1>\n<ul>\n<li>apacheä¸‹çš„é¡¹ç›®ç®¡ç†å·¥å…·,å¼€æºjavaé¡¹ç›®</li>\n<li>ä¸€æ­¥æ„å»ºé¡¹ç›®ï¼šé¡¹ç›®æ„å»ºè¿‡ç¨‹æ ‡å‡†åŒ–ï¼Œä¸€ä¸ªå‘½ä»¤å®Œæˆã€ç¼–è¯‘ã€æµ‹è¯•ã€è¿è¡Œã€æ‰“åŒ…ã€éƒ¨ç½²ã€è¿è¡Œ(tomcat:run)</li>\n<li>ä¾èµ–ç®¡ç†ï¼šä¸ç”¨æ‰‹åŠ¨å¯¼å…¥jaråŒ…ï¼Œåœ¨pom.xmlå®šä¹‰åæ ‡è‡ªåŠ¨ä»mavenä»“åº“ä¸­ä¸‹è½½ï¼Œä¸æ˜“å‡ºé”™</li>\n<li>è·¨å¹³å° window å’Œ linuxéƒ½å¯ä»¥ä½¿ç”¨</li>\n<li>éµå¾ªè§„èŒƒï¼Œæé«˜å¼€å‘æ•ˆç‡ï¼Œé™ä½é¡¹ç›®ç»´æŠ¤æˆæœ¬</li>\n</ul>\n<h1>2. mavené¡¹ç›®æ„å»ºè¿‡ç¨‹</h1>\n<ul>\n<li>æ¸…ç†(clean)ã€ç¼–è¯‘(commpile)ã€æµ‹è¯•ã€æŠ¥å‘Šã€</li>\n<li>æ‰“åŒ…(packageï¼šjavaâ†’jarã€webâ†’war)ã€éƒ¨ç½²</li>\n<li>è¿è¡ŒmavenLtomcatï¼šrunã€tomcat7:run</li>\n<li>ä¸€ä¸ªå‘½ä»¤å®Œæˆæ„å»ºã€è¿è¡Œã€æ–¹ä¾¿å¿«æ·ï¼Œæ¯ä¸ªæ„å»ºé˜¶æ®µè§„èŒƒï¼Œæœ‰åˆ©äºå›¢é˜Ÿå¼€å‘</li>\n</ul>\n<h1>3. mavené¡¹ç›®ä¾èµ–ç®¡ç†</h1>\n<ul>\n<li>é€šè¿‡pom.xmlå¯¹jaråŒ…ç‰ˆæœ¬åŒä¸€ç®¡ç†ï¼Œé¿å…å†²çªã€å¯ä»¥ä»mavenä»“åº“ä¸­ä¸‹è½½jaråŒ…</li>\n</ul>\n<h1>4. mavenä»“åº“</h1>\n<ul>\n<li>ä¼˜å…ˆæŸ¥æ‰¾æœ¬åœ°ä»“åº“ã€æ²¡æœ‰æŸ¥è¿œç¨‹(å¯ä»¥ç§æœ)ã€æœ€åä¸­å¤®ã€æŸ¥åˆ°è‡ªåŠ¨ä¸‹è½½åˆ°æœ¬åœ°ä»“åº“ä¿å­˜</li>\n<li>æœ¬åœ°ä»“åº“(é»˜è®¤:${usr.dir}/.m2/repository)</li>\n<li>è¿œç¨‹ä»“åº“ï¼šäº’è”ç½‘æˆ–å±€åŸŸç½‘å†…</li>\n<li>ä¸­å¤®ä»“åº“ï¼šhttpï¼š<a href=\"//repo1.maven.org/maven2%E3%80%81maven%E5%9B%A2%E9%98%9F%E8%87%AA%E5%B7%B1%E7%BB%B4%E6%8A%A4\" target=\"_blank\" rel=\"noopener noreferrer\">//repo1.maven.org/maven2ã€mavenå›¢é˜Ÿè‡ªå·±ç»´æŠ¤</a></li>\n<li>é…ç½®æœ¬åœ°ä»“åº“</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>F:\\apache-maven-3.5.3\\conf\\setting.xml\n&lt;localRepository&gt;F:\\repository&lt;/localRepository&gt;\n</code></pre></div><h1>5. mavenå·¥ç¨‹ç›®å½•</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/92c263ed3f7d72f7502aa.png\" alt=\"mavenå·¥ç¨‹ç›®å½•\" tabindex=\"0\"><figcaption>mavenå·¥ç¨‹ç›®å½•</figcaption></figure>\n<h1>6. å¸¸ç”¨mavenå‘½ä»¤</h1>\n<ul>\n<li>mvn compile å°†src/main/javaä¸‹çš„ æ–‡ä»¶ç¼–è¯‘ä¸ºclassæ–‡ä»¶ å¹¶æ”¾åˆ°target/classesç›®å½•ä¸‹,ä¸ç¼–è¯‘æµ‹è¯•çš„ä»£ç </li>\n<li>mvn test æ‰§è¡Œsrc/test/javaçš„å•å…ƒæµ‹è¯•ç±»</li>\n<li>mvn clean åˆ é™¤targetç›®å½•çš„å†…å®¹(åŒ…æ‹¬æ‰“åŒ…ç»“æœå’Œç¼–è¯‘ç»“æœ)ï¼Œæ¸…ç†åç¼–è¯‘</li>\n<li>mvn package javaå·¥ç¨‹â†’jarã€webå·¥ç¨‹â†’waråŒ…ï¼Œé»˜è®¤jaråŒ…åç§°ï¼šartificild-version.jar</li>\n<li>mvn installï¼šå°†mavenæ‰“æˆjaråŒ…æˆ–è€…waråŒ…å‘å¸ƒåˆ°æœ¬åœ°ä»“åº“(æ¨¡å—å¼€å‘çš„æ—¶å€™ä½¿ç”¨)å®‰è£…åˆ°ä»“åº“/groupId/artifacid/version</li>\n<li>tomcat:run ä¸€é”®å¯åŠ¨</li>\n</ul>\n<h1>7. mavenæ¦‚å¿µæ¨¡å‹å†…å®¹</h1>\n<ul>\n<li>é¡¹ç›®å¯¹è±¡æ¨¡å‹:pom.xmlå®šä¹‰é¡¹ç›®åæ ‡ã€ä¾èµ–ã€ä¿¡æ¯ã€æ’ä»¶ç›®æ ‡</li>\n<li>æ ‡å‡†é›†åˆ:æ ‡å‡†ç›®å½•ç»“æ„ã€ç”Ÿå‘½å‘¨æœŸé˜¶æ®µã€ä¾èµ–ç®¡ç†æœ‰æ ‡å‡†çš„åæ ‡å®šä¹‰</li>\n<li>é¡¹ç›®ç”Ÿå‘½å‘¨æœŸ:æ¸…ç†(clean)ã€ç¼–è¯‘(commpile)ã€æµ‹è¯•(test)ã€æŠ¥å‘Šã€æ‰“åŒ…(packageï¼šjavaâ†’jarã€webâ†’war)ã€éƒ¨ç½² é€šè¿‡å‘½ä»¤å®ç°ç”Ÿå‘½å‘¨æœŸ</li>\n<li>ä¾èµ–ç®¡ç†ç³»ç»Ÿ:å¯¹jaråŒ…åŒä¸€ç®¡ç†</li>\n<li>è¿è¡Œå®šä¹‰åœ¨ç”Ÿå‘½å‘¨æœŸé˜¶æ®µä¸­æ’ä»¶çš„ç›®æ ‡çš„é€»è¾‘:mavenç®¡ç†é¡¹ç›®ç”Ÿå‘½å‘¨æœŸè¿‡ç¨‹éƒ½æ˜¯åŸºäºæ’ä»¶å®Œæˆçš„</li>\n</ul>\n<h1>8. pom.xmlåŸºæœ¬é…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;project&gt;:æ–‡ä»¶çš„æ ¹èŠ‚ç‚¹\n\t&lt;modelVersion&gt;:pom.xmlä½¿ç”¨çš„å¯¹è±¡æ¨¡å‹ç‰ˆæœ¬\n\t&lt;groupId&gt;:é¡¹ç›®åç§°ï¼šç»„ç»‡å+é¡¹ç›®åã€‚ç±»ä¼¼åŒ…å\n\t&lt;artifactId&gt;:æ¨¡å—åï¼Œå­é¡¹ç›®åæˆ–æ¨¡å—åç§°\n\t&lt;version&gt;:å½“å‰ç‰ˆæœ¬å·snapshotå¿«ç…§ç‰ˆæœ¬éæ­£å¼ç‰ˆæœ¬releaseä¸ºæ­£å¼å‘å¸ƒç‰ˆ\n\t&lt;packaging&gt;:æ‰“åŒ…ç±»å‹jarã€warã€pomçˆ¶å·¥ç¨‹ä½¿ç”¨è¿™ä¸ªè®¾ç½®ä¸packageæœ‰å…³\n\t&lt;name&gt;:é¡¹ç›®çš„æ˜¾ç¤ºåï¼Œå¸¸ç”¨äºmavençš„ç”Ÿæˆæ–‡æ¡£\n\t&lt;description&gt;:é¡¹ç›®æè¿°ï¼Œå¸¸ç”¨äºmavençš„ç”Ÿæˆæ–‡æ¡£\n\t&lt;dependencies&gt;:é¡¹ç›®ä¾èµ–æ„ä»¶é…ç½®ï¼Œé…ç½®é¡¹ç›®ä¾èµ–æ„ä»¶çš„åæ ‡\n&lt;build&gt;:é¡¹ç›®æ„å»ºé…ç½®ï¼Œé…ç½®ç¼–è¯‘ï¼Œè¿è¡Œæ’ä»¶ç­‰\n</code></pre></div><h1>9. ä¾èµ–ç®¡ç†</h1>\n<ul>\n<li>ä¾èµ–èŒƒå›´(æ·»åŠ ä¾èµ–jaråŒ…æ ¼å¼)</li>\n<li>ä¾èµ–waråŒ…ã€ä¾èµ–æ¨¡å—\\ä¾èµ–èŒƒå›´ç”±å¼ºåˆ°å¼±çš„é¡ºåºæ˜¯ï¼šcompile&gt;provided&gt;runtime&gt;test<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1981723b2ddbd1162469b.png\" alt=\"1.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5bc716d0fa32c19a37e1c.png\" alt=\"2.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0f9106b3033aecf7b87c6.png\" alt=\"3.png\"></li>\n</ul>\n<h1>10. ä¾èµ–èŒƒå›´å¯¹ä¼ é€’ä¾èµ–çš„å½±å“</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1b1f8d1ff53575fc3ff22.png\" alt=\"4.png\" tabindex=\"0\"><figcaption>4.png</figcaption></figure>\n<h1>11. ä¾èµ–ä¼ é€’ä¸ä¾èµ–å†²çªè§£å†³</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>- è°ƒè§£åŸåˆ™\n  - ç¬¬ä¸€å£°æ˜è€…ä¼˜å…ˆåŸåˆ™ï¼šè°å…ˆå£°æ˜è°å…ˆä¾èµ–\n  - è·¯å¾„è¿‘è€…ä¼˜å…ˆåŸåˆ™ï¼šè°çš„ä¾èµ–å±‚å°ï¼Œè°å…ˆè¢«ä¾èµ–\n- æ’é™¤ä¾èµ–\n\t&lt;dependency&gt;\n\t\t&lt;groupId&gt;org.apache.struts&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;struts2-spring-plugin&lt;/artifactId&gt;\n\t\t&lt;version&gt;2.3.24&lt;/version&gt;\n\t\t&lt;exclusions&gt;\n\t\t\t&lt;exclusion&gt;\n\t\t\t\t&lt;groupId&gt;org.springframework&lt;/groupId&gt;\n\t\t\t\t&lt;artifactId&gt;spring-beans&lt;/artifactId&gt;\n\t\t\t&lt;/exclusion&gt;\n\t\t&lt;/exclusions&gt;\n\t&lt;/dependency&gt;\n- é”å®šç‰ˆæœ¬:é…ç½®äº†é”å®šç‰ˆæœ¬å¿…é¡»ç›¸åº”åœ°é…ç½®ä¾èµ–ï¼Œä½†ä¸éœ€è¦æŒ‡å®šç‰ˆæœ¬\n\t&lt;dependencyManagement&gt;\n\t\t&lt;dependencies&gt;\n\t\t\t&lt;dependency&gt;\n\t\t\t&lt;groupId&gt;org.springframework&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;spring-bean&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;4.2.4.RELEASE&lt;/version&gt;\n\t\t\t&lt;/dependency&gt;\n\t\t&lt;/dependencies&gt;\n\t&lt;/dependencyManagement&gt;\n</code></pre></div><h1>12. mavenç§æœ(äº†è§£)è‡ªå·±çœ‹æ–‡æ¡£</h1>\n<h1>13. springbootè®¾ç½®ä¸ºwindowsæœåŠ¡ mavenæ’ä»¶</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;plugin&gt;\n\t&lt;groupId&gt;cn.joylau.code&lt;/groupId&gt;\n\t&lt;artifactId&gt;joylau-springboot-daemon-windows&lt;/artifactId&gt;\n\t&lt;version&gt;1.1.RELEASE&lt;/version&gt;\n\t&lt;executions&gt;\n\t\t&lt;execution&gt;\n\t\t\t&lt;id&gt;make-win-service&lt;/id&gt;\n\t\t\t&lt;phase&gt;install&lt;/phase&gt;\n\t\t\t&lt;goals&gt;\n\t\t\t\t&lt;goal&gt;make-win-service&lt;/goal&gt;\n\t\t\t&lt;/goals&gt;\n\t\t&lt;/execution&gt;\n\t&lt;/executions&gt;\n\t&lt;configuration&gt;\n\t&lt;vmOptions&gt;           \n\t\t-Xbootclasspath/a:config/ -Xmx1024m -Xms512m -XX:MaxPermSize=256m -XX:PermSize=128m -Dfile.encoding=UTF-8 -Dcom.sun.management.jmxremote -Dcom.sun.management.jmxremote.ssl=false -Dcom.sun.management.jmxremote.authenticate=false -Dcom.sun.management.jmxremote.port=22221            \n\t&lt;/vmOptions&gt;\n\t&lt;arguments&gt;\n\t&lt;/arguments&gt;\n&lt;/configuration&gt;\n&lt;/plugin&gt;\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/92c263ed3f7d72f7502aa.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "JSP",
      "url": "https://javaguide.cn/backend/j2ee/jsp.html",
      "id": "https://javaguide.cn/backend/j2ee/jsp.html",
      "summary": "jsp/el/jstl jsp(Java Server Page) jspè¿è¡ŒåŸç† æ–‡æ¡£ç»“æ„ jspåŸºæœ¬è¯­æ³• jsp9å¤§å†…ç½®å¯¹è±¡ï¼ˆç¬”è¯•ï¼‰ el(${elè¡¨è¾¾å¼}):Expression Language 11ä¸ªå†…ç½®å¯¹è±¡(è‡ªå®šä¹‰çš„æ•°æ®å¿…é¡»æ”¾åœ¨åŸŸä¸­elæ‰èƒ½å¾—åˆ°) jstlï¼ˆjsp Standard Tag Library) jsp(Java Server ...",
      "content_html": "<p>jsp/el/jstl</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#jspjava-server-page\">jsp(Java Server Page)</a></li>\n<li><a href=\"#jsp%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86\">jspè¿è¡ŒåŸç†</a></li>\n<li><a href=\"#%E6%96%87%E6%A1%A3%E7%BB%93%E6%9E%84\">æ–‡æ¡£ç»“æ„</a></li>\n<li><a href=\"#jsp%E5%9F%BA%E6%9C%AC%E8%AF%AD%E6%B3%95\">jspåŸºæœ¬è¯­æ³•</a></li>\n<li><a href=\"#jsp9%E5%A4%A7%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1%E7%AC%94%E8%AF%95\">jsp9å¤§å†…ç½®å¯¹è±¡ï¼ˆç¬”è¯•ï¼‰</a></li>\n<li><a href=\"#elel%E8%A1%A8%E8%BE%BE%E5%BC%8Fexpression-language\">el(${elè¡¨è¾¾å¼}):Expression Language</a></li>\n<li><a href=\"#11%E4%B8%AA%E5%86%85%E7%BD%AE%E5%AF%B9%E8%B1%A1%E8%87%AA%E5%AE%9A%E4%B9%89%E7%9A%84%E6%95%B0%E6%8D%AE%E5%BF%85%E9%A1%BB%E6%94%BE%E5%9C%A8%E5%9F%9F%E4%B8%ADel%E6%89%8D%E8%83%BD%E5%BE%97%E5%88%B0\">11ä¸ªå†…ç½®å¯¹è±¡(è‡ªå®šä¹‰çš„æ•°æ®å¿…é¡»æ”¾åœ¨åŸŸä¸­elæ‰èƒ½å¾—åˆ°)</a></li>\n<li><a href=\"#jstljsp-standard-tag-library\">jstlï¼ˆjsp Standard Tag Library)</a></li>\n</ul>\n<!-- /TOC -->\n<h1>jsp(Java Server Page)</h1>\n<ul>\n<li>å»ºç«‹åœ¨Servletè§„èŒƒä¸Šçš„åŠ¨æ€ç½‘é¡µå¼€å‘æŠ€æœ¯æœ¬è´¨æ˜¯servletï¼ˆHtml + Javaï¼‰</li>\n<li>ç‰¹ç‚¹:è·¨å¹³å°ã€ä¸šåŠ¡ä»£ç ç›¸åˆ†ç¦»ã€JavaBeanç»„ä»¶é‡ç”¨ã€é¢„ç¼–è¯‘ï¼ˆä¸€ä¸ªç”¨æˆ·åªç¼–è¯‘ä¸€æ¬¡ï¼‰</li>\n<li>äº§ç”ŸåŸå› :htmlé¡µé¢è¾“å‡ºå¤ªéº»çƒ¦</li>\n</ul>\n<h1>jspè¿è¡ŒåŸç†</h1>\n<ul>\n<li>æœ¬è´¨å°±æ˜¯servletï¼Œç¬¬ä¸€æ¬¡è¢«è®¿é—®çš„æ—¶å€™è¢«webå®¹å™¨ç¿»è¯‘æˆservletå†æ‰§è¡Œ</li>\n<li>helloServlet.jspâ†’helloServlet_jsp.javaæºæ–‡ä»¶â†’helloServlet_jsp.classå­—èŠ‚ç æ–‡ä»¶</li>\n<li>è¢«ç¿»è¯‘åçš„servletåœ¨Tomcatçš„workç›®å½•ä¸­å¯ä»¥æ‰¾åˆ°</li>\n<li>F:\\Tomcat\\apache-tomcat-7.0.52\\work\\Catalina\\localhost\\WEB17\\org\\apache\\jsp</li>\n<li>jspç»§æ‰¿äº†HttpjspBaseï¼ŒHttpjspBaseç±»åˆç»§æ‰¿äº†HttpServletï¼Œæ•…jspå°±æ˜¯servlet</li>\n</ul>\n<h1>æ–‡æ¡£ç»“æ„</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\" pageEncoding=\"UTF-8\"%&gt;\n&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"http://www.w3.org/TR/html4/loose.dtd\"&gt;\n&lt;html&gt;\n  &lt;head&gt;\n    &lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n    &lt;title&gt;Insert title here&lt;/title&gt;\n  &lt;/head&gt;\n  &lt;body&gt;\n  &lt;/body&gt;\n&lt;/html&gt;\n</code></pre></div><h1>jspåŸºæœ¬è¯­æ³•</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">è„šæœ¬åˆ†ç±»</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">&lt;%(å˜é‡/æ–¹æ³•/è¯­å¥ç­‰)%&gt;</td>\n<td style=\"text-align:center\">jspScriptletsï¼šè¢«ç¿»è¯‘åˆ°Servletä¸­çš„serviceæ–¹æ³•çš„å±€éƒ¨å˜é‡ã€‚è°ƒç”¨å®Œåˆ™é‡Šæ”¾å†…å­˜ç©ºé—´,å¸¸ç”¨äºè¾“å‡º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">&lt;%=(å˜é‡/è¡¨è¾¾å¼)%&gt;</td>\n<td style=\"text-align:center\">jspè¡¨è¾¾å¼ï¼šè¢«ç¿»è¯‘æˆservletä¸­serviceæ–¹æ³•å†…éƒ¨out.print()è¾“å‡ºï¼Œå˜é‡æˆ–è€…è¡¨è¾¾å¼åé¢ä¸èƒ½æœ‰åˆ†å·</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">&lt;%!javaä»£ç %&gt;</td>\n<td style=\"text-align:center\">jspå£°æ˜è¯­å¥:è¢«ç¿»è¯‘æˆservletç±»çš„æˆå‘˜æ–¹æ³•/å˜é‡/ä»£ç å—ï¼Œé™æ€æ–¹æ³•/å˜é‡/ä»£ç å—,å¯¹æ•´ä¸ªjspé¡µé¢æœ‰æ•ˆ</td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">æ³¨é‡Šåˆ†ç±»</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n<th style=\"text-align:center\">å¯è§èŒƒå›´</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Htmlæ³¨é‡Š</td>\n<td style=\"text-align:center\">&lt;!--æ³¨é‡Šå†…å®¹--&gt;</td>\n<td style=\"text-align:center\">jspæºç ã€javaæºç ã€htmlæºç </td>\n</tr>\n<tr>\n<td style=\"text-align:center\">javaæ³¨é‡Š</td>\n<td style=\"text-align:center\">//å•è¡Œæ³¨é‡Š/<em>å¤šè¡Œæ³¨é‡Š</em>/</td>\n<td style=\"text-align:center\">javaæºç ã€jspæºç </td>\n</tr>\n<tr>\n<td style=\"text-align:center\">jspæ³¨é‡Š</td>\n<td style=\"text-align:center\">&lt;%--æ³¨é‡Šå†…å®¹--%&gt;</td>\n<td style=\"text-align:center\">jspæºç </td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">æŒ‡ä»¤(æŒ‡å¯¼jspç¿»è¯‘å’Œè¿è¡Œçš„å‘½ä»¤)åˆ†ç±»</th>\n<th style=\"text-align:center\">å±æ€§</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">&lt;%@page å±æ€§å1=\"å±æ€§å€¼1\"%&gt;</td>\n<td style=\"text-align:center\">languageï¼šjspè„šæœ¬ä¸­å¯ä»¥åµŒå…¥çš„è¯­è¨€ç§ç±»java</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å±æ€§åç§°åŒºåˆ†å¤§å°å†™</td>\n<td style=\"text-align:center\">pageEncodingï¼šè¯»å–jspæ–‡ä»¶å†…å®¹é‡‡ç”¨çš„ç¼–ç ä¸€å®šè¦å’Œä¿å­˜æ–‡ä»¶çš„ç¼–ç ä¸€è‡´--å†…éƒ¨å¯ä»¥åŒ…å«contentType</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">contentTypeï¼šæœ‰æ•ˆæ–‡æ¡£ç±»å‹text/html;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">sessionï¼šæ˜¯å¦jspåœ¨ç¿»è¯‘æ—¶è‡ªåŠ¨åˆ›å»ºtrue/false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">importï¼šå¯¼å…¥javaçš„åŒ… å¯å¤šæ¬¡ï¼Œå…¶ä»–åªèƒ½ä¸€æ¬¡java.util.*</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">errorPageï¼šå½“å½“å‰é¡µé¢å‡ºé”™åè·³è½¬åˆ°å“ªä¸ªé¡µé¢</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">isErrorPageï¼šå½“å‰é¡µé¢æ˜¯ä¸€ä¸ªå¤„ç†é”™è¯¯çš„é¡µé¢true/false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">buffer:8kb,jspç¼“å­˜å¤§å°ï¼Œä¹Ÿæ˜¯outçš„ç¼“å†²åŒºå¤§å°</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">autoFlush:è‡ªåŠ¨åˆ·æ–°,true/false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">&lt;%@taglib å±æ€§å1=\"å±æ€§å€¼1\" &gt;</td>\n<td style=\"text-align:center\">uriï¼šè¦å¼•å…¥çš„(jstlã€struts2)æ ‡ç­¾åº“åœ°å€, prefix:å‰ç¼€ ä½¿ç”¨<a href=\"xxx:%E5%89%8D%E7%BC%80\">xxx:å‰ç¼€</a></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">&lt;%@include å±æ€§å1=\"å±æ€§å€¼1\"%&gt;</td>\n<td style=\"text-align:center\">file:è¢«åŒ…å«çš„ç›¸å¯¹äºwebcontentæ–‡ä»¶åœ°å€ï¼ˆé™æ€åŒ…å«ï¼‰</td>\n</tr>\n</tbody>\n</table>\n<h1>jsp9å¤§å†…ç½®å¯¹è±¡ï¼ˆç¬”è¯•ï¼‰</h1>\n<pre><code>jspè¢«ç¿»è¯‘æˆservletåï¼Œserviceæ–¹æ³•ä¸­æœ‰9ä¸ªå¯¹è±¡å®šä¹‰å¹¶åˆå§‹åŒ–å®Œæ¯•ï¼Œjspè„šæœ¬å¯ç›´æ¥ä½¿ç”¨\næ‰€æœ‰å¯¹è±¡éƒ½å¯ä»¥å­˜å–æ•°æ®request.setAttribute(\"age\", 30);\n</code></pre>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">9å¤§å†…ç½®å¯¹è±¡åç§°</th>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">request</td>\n<td style=\"text-align:center\">HttpServletRequest</td>\n<td style=\"text-align:center\">å¾—åˆ°ç”¨æˆ·è¯·æ±‚ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">response</td>\n<td style=\"text-align:center\">HttpServletResponse</td>\n<td style=\"text-align:center\">æœåŠ¡å™¨å‘å®¢æˆ·ç«¯å›åº”ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">config</td>\n<td style=\"text-align:center\">ServletConfig</td>\n<td style=\"text-align:center\">æœåŠ¡å™¨é…ç½®ï¼Œå¯ä»¥å–å¾—åˆå§‹åŒ–å‚æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">session</td>\n<td style=\"text-align:center\">HttpSession</td>\n<td style=\"text-align:center\">ä¿å­˜ç”¨æˆ·ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">application</td>\n<td style=\"text-align:center\">ServletContext</td>\n<td style=\"text-align:center\">æ‰€æœ‰ç”¨æˆ·çš„å…±äº«ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">page</td>\n<td style=\"text-align:center\">Object</td>\n<td style=\"text-align:center\">æŒ‡å½“å‰é¡µé¢è½¬æ¢åçš„Servletç±»çš„å®ä¾‹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">exception</td>\n<td style=\"text-align:center\">Throwable</td>\n<td style=\"text-align:center\">è¡¨ç¤ºjspé¡µé¢æ‰€å‘ç”Ÿçš„å¼‚å¸¸ï¼Œåœ¨é”™è¯¯é¡µé¢ä¸­æ‰èµ·ä½œç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">pageContext</td>\n<td style=\"text-align:center\">PageContext</td>\n<td style=\"text-align:center\">jspçš„é¡µé¢å®¹å™¨,jspé¡µé¢çš„ä¸Šä¸‹æ–‡å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">â‘ è·å¾—å…¶ä»–8ä¸ªå†…ç½®å¯¹è±¡ï¼špageContext.getRequest()</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">â‘¡åŸŸå¯¹è±¡:setAttribute(String name,Object obj[,int scope])</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">getAttribute(String name[,int scope])</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">removeAttrbute(String name[,int scope])</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">pageContext.(PAGE/REQUEST/SESSION/APPLICATION)_SCOPE</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">â‘¢findAttribute(String name)ä¾æ¬¡ä»pageï¼Œrequestï¼Œsessionï¼ŒapplicationåŸŸä¸­è·å–å±æ€§</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">out</td>\n<td style=\"text-align:center\">jspWriter</td>\n<td style=\"text-align:center\">ç”¨äºé¡µé¢è¾“å‡º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">response.getWriter().write(\"a\")ï¼Œå…ˆè¾“å‡ºï¼Œout.writeåè¾“å‡º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">out.write()å…ˆæ”¾åˆ°jspWriterç¼“å†²åŒºä¸­(é»˜è®¤8kb)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">è‹¥pageå±æ€§buffer=â€œ0kbâ€ å…³é—­outç¼“å†²åŒº,åˆ™æŒ‰é¡ºåºè¾“å‡º</td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">jspæ ‡ç­¾/åŠ¨ä½œ</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">&lt;jsp:include /&gt;</td>\n<td style=\"text-align:center\">page:è¢«åŒ…å«çš„é¡µé¢çš„åœ°å€ flush:åŒ…å«é¡µé¢flushæ˜¯å¦å°†è¾“å‡ºå†…å®¹ç«‹å³åˆ·æ–°åˆ°å®¢æˆ·ç«¯ï¼Œé»˜è®¤falseï¼Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">false;ç­‰å…¨éƒ¨åŠ è½½å®Œäº†å†åˆ·æ–°</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">&lt;jsp:forward /&gt;</td>\n<td style=\"text-align:center\">page=\"è¦è½¬å‘è¯·æ±‚çš„èµ„æºç›¸å¯¹äºwebcontentåœ°å€\"</td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">includeæŒ‡ä»¤(é™æ€åŒ…å«)</th>\n<th style=\"text-align:center\">includeæ ‡ç­¾(åŠ¨æ€åŒ…å«)</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å¼•å…¥çš„èµ„æºå¿…é¡»æ˜¯jspæ ¼å¼çš„æ–‡ä»¶</td>\n<td style=\"text-align:center\">å¼•å…¥çš„èµ„æºå¿…é¡»èƒ½è¢«webå®¹å™¨ç‹¬ç«‹è¿è¡Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¼•å…¥çš„èµ„æºæ˜¯ç¼–è¯‘å‰åŒ…å«çš„</td>\n<td style=\"text-align:center\">å¼•å…¥çš„èµ„æºæ˜¯ç¼–è¯‘ååŒ…å«çš„</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ä¸é™åˆ¶æ”¹å˜çŠ¶æ€ç å’Œè®¾ç½®å“åº”å¤´</td>\n<td style=\"text-align:center\">ä¸èƒ½æ”¹å˜çŠ¶æ€ç å’Œè®¾ç½®å“åº”å¤´</td>\n</tr>\n</tbody>\n</table>\n<h1>el(${elè¡¨è¾¾å¼}):Expression Language</h1>\n<pre><code>ç®€å•çš„æ•°æ®è®¿é—®è¯­è¨€,ä½¿jspçš„ä»£ç æ›´åŠ ç®€åŒ–\n</code></pre>\n<h1>11ä¸ªå†…ç½®å¯¹è±¡(è‡ªå®šä¹‰çš„æ•°æ®å¿…é¡»æ”¾åœ¨åŸŸä¸­elæ‰èƒ½å¾—åˆ°)</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">åˆ†ç±»</th>\n<th style=\"text-align:center\">å†…ç½®å¯¹è±¡åç§°</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ä½œç”¨åŸŸ</td>\n<td style=\"text-align:center\">pageScope</td>\n<td style=\"text-align:center\">pageä½œç”¨åŸŸ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">requestScope</td>\n<td style=\"text-align:center\">requestä½œç”¨åŸŸ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">sessionScope</td>\n<td style=\"text-align:center\">sessionä½œç”¨åŸŸ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">applicationScope</td>\n<td style=\"text-align:center\">applicationä½œç”¨åŸŸ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è¯·æ±‚å‚æ•°</td>\n<td style=\"text-align:center\">param</td>\n<td style=\"text-align:center\">è·å¾—ä¸€ä¸ªå‚æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">paramValues</td>\n<td style=\"text-align:center\">è·å¾—ä¸€ç»„å‚æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è¯·æ±‚å¤´</td>\n<td style=\"text-align:center\">header</td>\n<td style=\"text-align:center\">è·å¾—ä¸€ä¸ªè¯·æ±‚å¤´</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">headerValues</td>\n<td style=\"text-align:center\">è·å¾—ä¸€ç»„è¯·æ±‚å¤´</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">jspä¸Šä¸‹æ–‡å¯¹è±¡</td>\n<td style=\"text-align:center\">pageContext</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å…¨å±€åˆå§‹åŒ–å‚æ•°</td>\n<td style=\"text-align:center\">initParam</td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">cookie</td>\n<td style=\"text-align:center\">cookie</td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">å†…ç½®å¯¹è±¡ä½¿ç”¨</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">${å†…ç½®å¯¹è±¡}</td>\n<td style=\"text-align:center\">è·å¾—å†…ç½®å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">${å†…ç½®å¯¹è±¡.key}</td>\n<td style=\"text-align:center\">è·å¾—å†…ç½®å¯¹è±¡æ•°æ®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">${å†…ç½®å¯¹è±¡.[key-xxx]}</td>\n<td style=\"text-align:center\">è·å¾—å†…ç½®å¯¹è±¡æœ‰-æˆ–è€…ç©ºæ ¼çš„æ•°æ®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">${å†…ç½®å¯¹è±¡.key[index]}</td>\n<td style=\"text-align:center\">è·å¾—å†…ç½®å¯¹è±¡æ•°æ®ä¸ºæ•°ç»„,list,map,å¯¹è±¡é›†åˆçš„æ•°æ®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">${key}</td>\n<td style=\"text-align:center\">åº•å±‚ä½¿ç”¨findAttribute(\"name\"),ä¾æ¬¡ä»pageã€requestã€sessionã€applicationè·å¾—æ•°æ®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">${pageContext.request}</td>\n<td style=\"text-align:center\">pageContextè·å¾—å…¶ä»–å…«å¤§å¯¹è±¡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$(pageContext.request.contextPath)/XXX</td>\n<td style=\"text-align:center\">ç›¸å½“äº&lt;%=pageContext.getRequest().getContextPath%&gt;è·å¾—WEBåº”ç”¨çš„åç§°</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">${è¡¨è¾¾å¼}</td>\n<td style=\"text-align:center\">elè¡¨è¾¾å¼è¿ç®—</td>\n</tr>\n</tbody>\n</table>\n<h1>jstlï¼ˆjsp Standard Tag Library)</h1>\n<ul>\n<li>jspæ ‡å‡†æ ‡ç­¾åº“ï¼Œå¯ä»¥åµŒå…¥åœ¨jspé¡µé¢ä¸­ä½¿ç”¨æ ‡ç­¾çš„å½¢å¼å®Œæˆä¸šåŠ¡é€»è¾‘ç­‰åŠŸèƒ½ã€‚</li>\n<li>jstlå‡ºç°çš„ç›®çš„åŒelä¸€æ ·ä¹Ÿæ˜¯è¦æåˆ°jspé¡µé¢ä¸­çš„è„šæœ¬ä»£ç </li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">jstlä½¿ç”¨</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å¯¼å…¥jstl.jar</td>\n<td style=\"text-align:center\">åŒ…å«JSTLè§„èŒƒä¸­å®šä¹‰çš„æ¥å£å’Œç›¸å…³ç±»</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¯¼å…¥standard.jar</td>\n<td style=\"text-align:center\">åŒ…å«ç”¨äºå®ç°JSTLçš„.classæ–‡ä»¶ä»¥åŠJSTLä¸­5ä¸ªæ ‡ç­¾åº“æè¿°ç¬¦æ–‡ä»¶ï¼ˆTLDï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¼•å…¥æ ‡ç­¾åº“</td>\n<td style=\"text-align:center\">&lt;%@taglib uri=\"<a href=\"http://java.sun.com/jsp/jstl/core\" target=\"_blank\" rel=\"noopener noreferrer\">http://java.sun.com/jsp/jstl/core</a>\" prefix=\"c\"%&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">éå†å¯¹è±¡</td>\n<td style=\"text-align:center\">&lt;c:forEach begin=\"0\"end=\"5\"var=\"i\" step=â€œ2â€&gt;${i}&lt;/c:forEach&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">&lt;c:forEach items=\"å°†è¦è¿­ä»£çš„å¯¹è±¡\" var=\"æ¯ä¸€ä¸ªå¯¹è±¡çš„å€¼\" [varStatus=\"\"]&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è·å¾—æ™®é€šlistçš„å€¼</td>\n<td style=\"text-align:center\">&lt;c:forEach items=\"{str }&lt;/c:forEach&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è·å¾—listå¯¹è±¡çš„å€¼</td>\n<td style=\"text-align:center\">&lt;c:forEach items=\"{<a href=\"http://user.name\" target=\"_blank\" rel=\"noopener noreferrer\">user.name</a> }${user.age}&lt;/c:forEach&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è·å¾—æ™®é€šmapçš„å€¼</td>\n<td style=\"text-align:center\">&lt;c:forEach items=\"{entry.key }==${entry.value }&lt;/c:forEach&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è·å¾—mapå¯¹è±¡çš„å€¼</td>\n<td style=\"text-align:center\">&lt;c:forEach items=\"{<a href=\"http://entry.value.name\" target=\"_blank\" rel=\"noopener noreferrer\">entry.value.name</a> }--${entry.value.password }&lt;/c:forEach&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">åˆ¤æ–­æ¡ä»¶</td>\n<td style=\"text-align:center\">&lt;c:if test=\"\" var=\"\" scope=\"page\"&gt;&lt;/c:if&gt;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">è¾“å‡º</td>\n<td style=\"text-align:center\">&lt;c:out value=\"hello,world\"&gt;</td>\n</tr>\n</tbody>\n</table>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "spring",
      "url": "https://javaguide.cn/backend/j2ee/spring.html",
      "id": "https://javaguide.cn/backend/j2ee/spring.html",
      "summary": "spring 1. springä»‹ç» 4. springæ¡†æ¶ä½¿ç”¨ 5. springä¸junitæ•´åˆæµ‹è¯•ï¼ˆå¸¸ç”¨ï¼‰ 6. applicationContext.xmlé…ç½®è¯¦è§£ 7. springåˆ›å»ºå¯¹è±¡çš„æ–¹å¼ 8. SpringAOP 9. springæ•´åˆJDBC 10. springäº‹åŠ¡ 11. spring webé¡¹ç›®é…ç½® 12. springæ•´åˆ...",
      "content_html": "<p>spring</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-spring%E4%BB%8B%E7%BB%8D\">1. springä»‹ç»</a></li>\n<li><a href=\"#4-spring%E6%A1%86%E6%9E%B6%E4%BD%BF%E7%94%A8\">4. springæ¡†æ¶ä½¿ç”¨</a></li>\n<li><a href=\"#5-spring%E4%B8%8Ejunit%E6%95%B4%E5%90%88%E6%B5%8B%E8%AF%95%E5%B8%B8%E7%94%A8\">5. springä¸junitæ•´åˆæµ‹è¯•ï¼ˆå¸¸ç”¨ï¼‰</a></li>\n<li><a href=\"#6-applicationcontextxml%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3\">6. applicationContext.xmlé…ç½®è¯¦è§£</a></li>\n<li><a href=\"#7-spring%E5%88%9B%E5%BB%BA%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%96%B9%E5%BC%8F\">7. springåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</a></li>\n<li><a href=\"#8-springaop\">8. SpringAOP</a></li>\n<li><a href=\"#9-spring%E6%95%B4%E5%90%88jdbc\">9. springæ•´åˆJDBC</a></li>\n<li><a href=\"#10-spring%E4%BA%8B%E5%8A%A1\">10. springäº‹åŠ¡</a></li>\n<li><a href=\"#11-spring-web%E9%A1%B9%E7%9B%AE%E9%85%8D%E7%BD%AE\">11. spring webé¡¹ç›®é…ç½®</a></li>\n<li><a href=\"#12-spring%E6%95%B4%E5%90%88struts2\">12. springæ•´åˆstruts2</a></li>\n<li><a href=\"#13-spring%E6%95%B4%E5%90%88c3p0%E8%BF%9E%E6%8E%A5%E6%B1%A0\">13. springæ•´åˆc3p0è¿æ¥æ± </a></li>\n<li><a href=\"#14-spring%E6%95%B4%E5%90%88hibernate\">14. springæ•´åˆhibernate</a></li>\n<li><a href=\"#15-spring%E7%9A%84java%E9%85%8D%E7%BD%AE%E5%A4%9A%E6%95%B0%E6%8D%AE%E6%BA%90\">15. springçš„javaé…ç½®å¤šæ•°æ®æº</a></li>\n<li><a href=\"#16-spring4x%E7%9A%84java%E9%85%8D%E7%BD%AE%E6%96%B9%E5%BC%8F%E5%8F%AF%E4%BB%A5%E5%AE%8C%E5%85%A8%E6%9B%BF%E4%BB%A3xml%E9%85%8D%E7%BD%AE\">16. Spring4.xçš„Javaé…ç½®æ–¹å¼ï¼ˆå¯ä»¥å®Œå…¨æ›¿ä»£xmlé…ç½®ï¼‰</a></li>\n<li><a href=\"#17-spring4x%E9%85%8D%E7%BD%AE%E6%95%B0%E6%8D%AE%E5%BA%93%E8%BF%9E%E6%8E%A5%E6%B1%A0\">17. spring4.xé…ç½®æ•°æ®åº“è¿æ¥æ± </a></li>\n<li><a href=\"#spring%E4%B8%8D%E5%90%8C%E7%B1%BB%E5%9E%8B%E7%9A%84%E4%BA%8B%E4%BB%B6\">springä¸åŒç±»å‹çš„äº‹ä»¶ï¼Ÿ</a></li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. springä»‹ç»</h1>\n<ul>\n<li>springæ¡†æ¶æ€§è´¨æ˜¯å±äºå®¹å™¨æ€§è´¨çš„.å®¹å™¨ä¸­è£…ä»€ä¹ˆå¯¹è±¡å°±æœ‰ä»€ä¹ˆåŠŸèƒ½.æ‰€ä»¥å¯ä»¥ä¸€ç«™å¼.ä¸ä»…ä¸æ’æ–¥å…¶ä»–æ¡†æ¶,è¿˜èƒ½å¸®å…¶ä»–æ¡†æ¶ç®¡ç†å¯¹è±¡.</li>\n<li>aopæ”¯æŒ\\iocæ€æƒ³'\\spring jdbc\\aop äº‹åŠ¡\\junit æµ‹è¯•æ”¯æŒ</li>\n</ul>\n<h1>4. springæ¡†æ¶ä½¿ç”¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>xmlé…ç½®\nå¯¼åŒ…\ncom.springsource.org.apache.log4j-1.2.15.jarå¯é€‰\nspring-beans-4.2.4.RELEASE.jar\nspring-context-4.2.4.RELEASE.jar\nspring-core-4.2.4.RELEASE.jar\nspring-expression-4.2.4.RELEASE.jar\n\ncom.springsource.org.apache.commons.logging-1.1.1.jaræ—¥å¿—åŒ…\n\nåˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼Œset/getæ–¹æ³•\nåœ¨srcä¸‹çš„applicationContext.xmlä¸­å¯¼å…¥çº¦æŸbeansçº¦æŸ,å¹¶æ³¨å†Œå¯¹è±¡\n&lt;bean name=\"\" class=\"\"/&gt;\nä»£ç æµ‹è¯•\n@Test\npublic void fun(){\n\tApplicationContext ac = new ClassPathXmlApplicationContext(\"applicationContext.xml\");\n\tUser u = ac.getBean(\"user\");\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨è§£é…ç½®\nå¯¼åŒ…ä¸€æ ·\né…ç½®applicationContext.xmlå¼€å¯ä½¿ç”¨æ³¨è§£ä»£ç†\nå¯¼å…¥çº¦æŸspring-context-4.2.xsd\næŒ‡å®šæ‰«æè¯¥com.junye.beanåŒ…åŠå­å­™åŒ…ä¸‹æ‰€æœ‰ç±»ä¸­çš„æ³¨è§£\n&lt;context:component-scan base-package=\"com.junye.bean\"&gt;&lt;/context&gt;\nåœ¨ç±»ä¸­ä½¿ç”¨æ³¨è§£å®Œæˆé…ç½®\nå°†å¯¹è±¡æ³¨å†Œåˆ°å®¹å™¨å››ä¸ªæ³¨è§£æ²¡åŒºåˆ«ï¼Œå”¯ä¸€åŒºåˆ†å°±æ˜¯åˆ†å±‚ï¼Œæ¨èä½¿ç”¨æœ€åä¸‰ä¸ª\n@component(\"user\")\n@Controller(\"user\")//webå±‚\n@Service(\"user\")//serviceå±‚\n@Repository(\"user\")//daoå±‚\n\nä¿®æ”¹å¯¹è±¡çš„ä½œç”¨èŒƒå›´(strutsä¸­çš„Actionæ˜¯å¤šä¾‹çš„æ‰çº¿ç¨‹å®‰å…¨ï¼Œå•ä¾‹ä¸å®‰å…¨)\n@Scope(scopeName=\"prototype\")\t\n\nå€¼ç±»å‹æ³¨å…¥\n@Value(\"tom\")//é€šè¿‡åå°„çš„Fieldèµ‹å€¼,ç ´åäº†å°è£…æ€§\nprivate String name;\né€šè¿‡setæ–¹æ³•èµ‹å€¼,æ¨èä½¿ç”¨.\n@Value(\"tom\")\npublic void setName(String name){\n\tthis.name=name;\n}\n\nå¼•ç”¨ç±»å‹æ³¨å…¥\n@Autowired//è‡ªåŠ¨è£…é…,å¦‚æœåŒ¹é…å¤šä¸ªç±»å‹ä¸€è‡´çš„å¯¹è±¡ï¼Œå°†æ— æ³•é€‰æ‹©æ³¨å…¥é‚£ä¸ªå¯¹è±¡\n@Qualifier(\"car2\")å‘Šè¯‰springå®¹å™¨è‡ªåŠ¨è£…é…é‚£ä¸ªåç§°çš„å¯¹è±¡\nprivate Car car;\n@Resource(name=\"car\")æ‰‹åŠ¨æ³¨å…¥ï¼ŒæŒ‡å®šæ³¨å…¥é‚£ä¸ªå¯¹è±¡\nprivate Car car;\n\nåˆå§‹åŒ–|é”€æ¯æ–¹æ³•\n@PostConstruct//åœ¨å¯¹è±¡è¢«åˆ›å»ºåè°ƒç”¨ã€‚init-method\npublic voud init(){}\n@PreDestroy//åœ¨é”€æ¯ä¹‹å‰è°ƒç”¨ã€‚destory-method\npublic void destory(){}\n</code></pre></div><h1>5. springä¸junitæ•´åˆæµ‹è¯•ï¼ˆå¸¸ç”¨ï¼‰</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…\ncom.springsource.org.apache.log4j-1.2.15.jarå¯é€‰\nspring-beans-4.2.4.RELEASE.jar\nspring-context-4.2.4.RELEASE.jar\nspring-core-4.2.4.RELEASE.jar\nspring-expression-4.2.4.RELEASE.jar\ncom.springsource.org.apache.commons.logging-1.1.1.jar\nspring-aop-4.2.4.RELEASE.jar\n\nspring-test-4.2.4.RELEASE.jar\n\né…ç½®æ³¨è§£ä¸æµ‹è¯•\n@RunWith(SpringJUnit4ClassRunner.class)\t\t\n@ContextConfiguration(\"classpath:applicationContext.xml\")\npublic class Demo{\n\t@Resource(name=\"user\")\n\tprivate User u;\n\t\n\t@Test\n\tpublic void fun1(){\n\t\tSystem.out.println(\"æµ‹è¯•\");\n\t}\n}\n</code></pre></div><h1>6. applicationContext.xmlé…ç½®è¯¦è§£</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;!-- \nBeanå…ƒç´ ï¼šæè¿°éœ€è¦springå®¹å™¨ç®¡ç†çš„å¯¹è±¡\nclasså±æ€§:è¢«ç®¡ç†å¯¹è±¡çš„å®Œæ•´ç±»å.\nnameå±æ€§:å‘½åè¢«ç®¡ç†çš„å¯¹è±¡.è·å¾—å¯¹è±¡æ—¶æ ¹æ®è¯¥åç§°è·å¾—å¯¹è±¡.å¯é‡å¤.å¯ç”¨ç‰¹æ®Šå­—ç¬¦ï¼ˆæ¨èï¼‰\nidå±æ€§: ä¸nameå±æ€§ä¸€æ¨¡ä¸€æ ·. åç§°ä¸å¯é‡å¤.ä¸èƒ½ä½¿ç”¨ç‰¹æ®Šå­—ç¬¦. \nscopeå±æ€§(æ•´åˆstruts2æ—¶,ActionBeanå¿…é¡»é…ç½®ä¸ºå¤šä¾‹çš„)\n\tsingleton(é»˜è®¤å€¼):å•ä¾‹å¯¹è±¡.è¢«æ ‡è¯†ä¸ºå•ä¾‹çš„å¯¹è±¡åœ¨springå®¹å™¨ä¸­åªä¼šå­˜åœ¨ä¸€ä¸ªå®ä¾‹\n\tprototype:å¤šä¾‹åŸå‹.è¢«æ ‡è¯†ä¸ºå¤šä¾‹çš„å¯¹è±¡,æ¯æ¬¡å†è·å¾—æ‰ä¼šåˆ›å»º.æ¯æ¬¡åˆ›å»ºéƒ½æ˜¯æ–°çš„å¯¹è±¡.\n\trequest:webç¯å¢ƒä¸‹.å¯¹è±¡ä¸requestç”Ÿå‘½å‘¨æœŸä¸€è‡´.\n\tsession:webç¯å¢ƒä¸‹,å¯¹è±¡ä¸sessionç”Ÿå‘½å‘¨æœŸä¸€è‡´. \nç”Ÿå‘½å‘¨æœŸå±æ€§(éœ€è¦åœ¨ç›¸åº”çš„ç±»ä¸­å®ç°å…¶æ–¹æ³•)\n\té…ç½®ç”Ÿå‘½å‘¨æœŸåˆå§‹åŒ–æ–¹æ³•.springä¼šåœ¨å¯¹è±¡åˆ›å»ºä¹‹åç«‹å³è°ƒç”¨.init-method\n\té…ç½®ç”Ÿå‘½å‘¨æœŸçš„é”€æ¯æ–¹æ³•.springå®¹å™¨åœ¨å…³é—­å¹¶é”€æ¯æ‰€æœ‰å®¹å™¨ä¸­çš„å¯¹è±¡ä¹‹å‰è°ƒç”¨.destory-method\t\n--&gt;\n&lt;bean  id=\"user\" name=\"user\" class=\"cn.bean.User\" scope=\"singleton\" init-method=\"init\" destroy-method=\"destroy\"&gt;&lt;/bean&gt;\n&lt;!-- springçš„åˆ†æ¨¡å—é…ç½®(å¯¼å…¥å…¶ä»–springé…ç½®æ–‡ä»¶) --&gt;\n&lt;import resource=\"cn/b_create/applicationContext.xml\"/&gt;\n</code></pre></div><h1>7. springåˆ›å»ºå¯¹è±¡çš„æ–¹å¼</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç©ºå‚æ„é€ æ–¹å¼\n&lt;bean name=\"junye\" class=\"cn.junye.hello.Junye\"&gt;&lt;/bean&gt;\n\né™æ€å·¥å‚(äº†è§£)ä¸éœ€åˆ›å»ºå³å¯ç”¨ç±»åè°ƒç”¨é™æ€æ–¹æ³•\npublic class UserFactory{\n\tpublic static User createUser(){\n\t\tSystem.out.println(\"é™æ€å·¥å‚åˆ›å»ºUser\");\n\t\treturn new User();\n\t}\n}\n&lt;bean name=\"userFactory\" class=\"cn.junye.hello.UserFactory\" factory-method=\"createUser\"&gt;&lt;/bean&gt;\n\nå®ä¾‹å·¥å‚(äº†è§£)\npublic  User fun(){\n\tSystem.out.println(\"å®ä¾‹å·¥å‚åˆ›å»ºUser\");\n\treturn new User();\t\n}\n&lt;!-- è°ƒç”¨UserFactoryå¯¹è±¡çš„createUser2æ–¹æ³•åˆ›å»ºåä¸ºuser3çš„å¯¹è±¡.æ”¾å…¥å®¹å™¨--&gt;\n&lt;bean  name=\"user3\" factory-bean=\"userFactory\" factory-method=\"fun\"&gt;&lt;/bean&gt;\n&lt;bean  name=\"userFactory\" class=\"cn.b_create.UserFactory\" &lt;/bean&gt;\n</code></pre></div><h1>8. SpringAOP</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>xmlé…ç½®\nå¯¼åŒ…\ncom.springsource.org.apache.log4j-1.2.15.jar\nspring-beans-4.2.4.RELEASE.jar\nspring-context-4.2.4.RELEASE.jar\nspring-core-4.2.4.RELEASE.jar\nspring-expression-4.2.4.RELEASE.jar\ncom.springsource.org.apache.commons.logging-1.1.1.jar\nspringçš„aopåŒ…\nspring-aspects-4.2.4.RELEASE.jar\nspring-aop-4.2.4.RELEASE.jar\nspringéœ€è¦çš„ç¬¬ä¸‰æ–¹aopåŒ…\ncom.springsource.org.aopalliance-1.0.0.jar\ncom.springsource.org.aspectj.weaver-1.6.8.RELEASE.jar\n\nç›®æ ‡å¯¹è±¡(æ¥å£å®ç°å…³ç³»)\npublic class UserServiceImpl implements UserService {\n\t@Override\n\tpublic void save() {\n\t\tSystem.out.println(\"ä¿å­˜ç”¨æˆ·!\");\n\t}\n}\n\nå‡†å¤‡é€šçŸ¥ç±»\npublic class MyAdvice {\n\t//å‰ç½®é€šçŸ¥:ç›®æ ‡æ–¹æ³•è¿è¡Œä¹‹å‰è°ƒç”¨\n\tpublic void before(){\n\t\tSystem.out.println(\"è¿™æ˜¯å‰ç½®é€šçŸ¥!!\");\n\t}\n\t//ç¯ç»•é€šçŸ¥:åœ¨ç›®æ ‡æ–¹æ³•ä¹‹å‰å’Œä¹‹åéƒ½è°ƒç”¨\n\tpublic Object around(ProceedingJoinPoint pjp) throws Throwable {\n\t\tSystem.out.println(\"è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹å‰çš„éƒ¨åˆ†!!\");\n\t\tObject proceed = pjp.proceed();//è°ƒç”¨ç›®æ ‡æ–¹æ³•\n\t\tSystem.out.println(\"è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹åçš„éƒ¨åˆ†!!\");\n\t\treturn proceed;\n\t}\n\t//åç½®é€šçŸ¥:åœ¨ç›®æ ‡æ–¹æ³•è¿è¡Œä¹‹åè°ƒç”¨(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨)\n\tpublic void afterReturning(){\n\t\tSystem.out.println(\"è¿™æ˜¯åç½®é€šçŸ¥(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨)!!\");\n\t}\n\t//åç½®é€šçŸ¥:åœ¨ç›®æ ‡æ–¹æ³•è¿è¡Œä¹‹åè°ƒç”¨(æ— è®ºæ˜¯å¦å‡ºç° å¼‚å¸¸éƒ½ä¼šè°ƒç”¨)\n\tpublic void after(){\n\t\tSystem.out.println(\"è¿™æ˜¯åç½®é€šçŸ¥(å‡ºç°å¼‚å¸¸ä¹Ÿä¼šè°ƒç”¨)!!\");\n\t}\n\t//å¼‚å¸¸é€šçŸ¥:å¦‚æœå‡ºç°å¼‚å¸¸,å°±ä¼šè°ƒç”¨\n\tpublic void afterException(){\n\t\tSystem.out.println(\"å‡ºäº‹å•¦!å‡ºç°å¼‚å¸¸äº†!!\");\n\t}\n}\né…ç½®applicationContext.xml,å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡ä¸­\n//å¯¼å…¥aopçº¦æŸ\n&lt;!-- 1.é…ç½®ç›®æ ‡å¯¹è±¡ --&gt;\n&lt;bean name=\"userService\" class=\"cn.itcast.service.UserServiceImpl\" &gt;&lt;/bean&gt;\n\n&lt;!-- 2.é…ç½®é€šçŸ¥å¯¹è±¡ --&gt;\n&lt;bean name=\"myAdvice\" class=\"cn.itcast.d_springaop.MyAdvice\" &gt;&lt;/bean&gt;\n\n&lt;aop:config&gt;&lt;!--æ‰§è¡Œé¡ºåºä¸ºä¸‹é¢é‚£ä¸ª--&gt;\n\t&lt;aop:pointcut expression=\"execution(* cn.service.*ServiceImpl.*(..))\" id=\"pc\"/&gt;\n\t&lt;aop:aspect ref=\"myAdvice\" &gt;\n\t\t&lt;aop:before method=\"before\" pointcut-ref=\"pc\" /&gt;\n\t\t&lt;aop:around method=\"around\" pointcut-ref=\"pc\" /&gt;\n\t\t&lt;aop:after-returning method=\"afterReturning\" pointcut-ref=\"pc\" /&gt;\n\t\t&lt;aop:after method=\"after\" pointcut-ref=\"pc\"/&gt;\n\t\t&lt;aop:after-throwing method=\"afterException\" pointcut-ref=\"pc\"/&gt;\n\t&lt;/aop:aspect&gt;\n&lt;/aop:config&gt;\n\n&lt;!-- é…ç½®åˆ‡å…¥ç‚¹ ï¼Œé…ç½®è¦è¢«åˆ‡çš„æ–¹æ³•é€šå¸¸åœ¨serviceå±‚\n\npublic void cn.itcast.service.UserServiceImpl.save() \nvoid cn.itcast.service.UserServiceImpl.save()\n* cn.itcast.service.UserServiceImpl.save()\n* cn.itcast.service.UserServiceImpl.*()\n\n* cn.itcast.service.*ServiceImpl.*(..)åŒ…æ‹¬ä¸€åˆ°å¤šçš„å‚æ•°\n* cn.itcast.service..*ServiceImpl.*(..)åŒ…æ‹¬æ‰€æœ‰çš„å­åŒ… --&gt;\næµ‹è¯•\n\n@RunWith(SpringJUnit4ClassRunner.class)\n@ContextConfiguration(\"classpath:applicationContext.xml\")\npublic class Demo {\n\t@Resource(name=\"myAop\")\n\tprivate MyAop us;æ¥å£\n\t@Test\n\tpublic void fun1(){\n\t\tus.save();\n\t}\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨è§£é…ç½®\nå¯¼åŒ…(ä¸€æ ·)\nå¼€å¯ä½¿ç”¨æ³¨è§£å®Œæˆç»‡å…¥\n&lt;aop:aspectj-autoproxy&gt;&lt;/aop:aspectj-autoproxy&gt;\nå‡†å¤‡ç›®æ ‡å¯¹è±¡(ä¸€æ ·)\t\nå‡†å¤‡é€šçŸ¥(ä¸€æ ·)é…ç½®ç›®æ ‡å¯¹è±¡å’Œé€šçŸ¥å¯¹è±¡ï¼ˆxmlä¸­ï¼‰ä¸€æ ·\né…ç½®è¿›è¡Œç»‡å…¥,å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡ä¸­\n//é€šçŸ¥ç±»\n@Aspect\n//è¡¨ç¤ºè¯¥ç±»æ˜¯ä¸€ä¸ªé€šçŸ¥ç±»\npublic class MyAdvice {\n\t@Pointcut(\"execution(* cn.itcast.service.*ServiceImpl.*(..))\")\n\tpublic void pc(){}\n\t//å‰ç½®é€šçŸ¥\n\t//æŒ‡å®šè¯¥æ–¹æ³•æ˜¯å‰ç½®é€šçŸ¥,å¹¶åˆ¶å®šåˆ‡å…¥ç‚¹\n\t@Before(\"MyAdvice.pc()\")\n\tpublic void before(){\n\t\tSystem.out.println(\"è¿™æ˜¯å‰ç½®é€šçŸ¥!!\");\n\t}\n\t//åç½®é€šçŸ¥\n\t@AfterReturning(\"execution(* cn.itcast.service.*ServiceImpl.*(..))\")\n\tpublic void afterReturning(){\n\t\tSystem.out.println(\"è¿™æ˜¯åç½®é€šçŸ¥(å¦‚æœå‡ºç°å¼‚å¸¸ä¸ä¼šè°ƒç”¨)!!\");\n\t}\n\t//ç¯ç»•é€šçŸ¥\n\t@Around(\"execution(* cn.itcast.service.*ServiceImpl.*(..))\")\n\tpublic Object around(ProceedingJoinPoint pjp) throws Throwable {\n\t\tSystem.out.println(\"è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹å‰çš„éƒ¨åˆ†!!\");\n\t\tObject proceed = pjp.proceed();//è°ƒç”¨ç›®æ ‡æ–¹æ³•\n\t\tSystem.out.println(\"è¿™æ˜¯ç¯ç»•é€šçŸ¥ä¹‹åçš„éƒ¨åˆ†!!\");\n\t\treturn proceed;\n\t}\n\t//å¼‚å¸¸é€šçŸ¥\n\t@AfterThrowing(\"execution(* cn.itcast.service.*ServiceImpl.*(..))\")\n\tpublic void afterException(){\n\t\tSystem.out.println(\"å‡ºäº‹å•¦!å‡ºç°å¼‚å¸¸äº†!!\");\n\t}\n\t//åç½®é€šçŸ¥\n\t@After(\"execution(* cn.itcast.service.*ServiceImpl.*(..))\")\n\tpublic void after(){\n\t\tSystem.out.println(\"è¿™æ˜¯åç½®é€šçŸ¥(å‡ºç°å¼‚å¸¸ä¹Ÿä¼šè°ƒç”¨)!!\");\n\t}\n}\n@beforeï¼ˆMyadvice.pc()æŒ‡å¯»æ‰¾Myadviceçš„pcæ–¹æ³•çš„pointcutæ³¨é‡Šï¼Œä¸pcè¿™ä¸ªæ–¹æ³•å†…å®¹æ— å…³ï¼‰\n</code></pre></div><h1>9. springæ•´åˆJDBC</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8a89f9ce1d4d779c62ba4.png\" alt=\"dao.png\" tabindex=\"0\"><figcaption>dao.png</figcaption></figure>\n<ul>\n<li>springæä¾›äº†å¾ˆå¤šæ¨¡æ¿æ•´åˆDaoæŠ€æœ¯</li>\n<li>springä¸­æä¾›äº†ä¸€ä¸ªå¯ä»¥æ“ä½œæ•°æ®åº“çš„å¯¹è±¡.å¯¹è±¡å°è£…äº†jdbcæŠ€æœ¯.</li>\n<li>JDBCTemplate =&gt; JDBCæ¨¡æ¿å¯¹è±¡ä¸DBUtilsä¸­çš„QueryRunneréå¸¸ç›¸ä¼¼.</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…\ncom.springsource.com.mchange.v2.c3p0-0.9.1.2.jar\ncom.springsource.org.apache.commons.logging-1.1.1.jar\ncom.springsource.org.apache.log4j-1.2.15.jar\nmysql-connector-java-5.1.7-bin.jar\nspring-aop-4.2.4.RELEASE.jar\nspring-beans-4.2.4.RELEASE.jar\nspring-context-4.2.4.RELEASE.jar\nspring-core-4.2.4.RELEASE.jar\nspring-expression-4.2.4.RELEASE.jar\nspring-jdbc-4.2.4.RELEASE.jar\nspring-test-4.2.4.RELEASE.jar\nspring-tx-4.2.4.RELEASE.jar\n\nå‡†å¤‡æ•°æ®åº“\napplication.xmlçš„é…ç½®\n\nJdbcTemplateä¾èµ–dataSourceï¼ŒUserDaoä¾èµ–JdbcTemplate\n\n&lt;context:property-placeholder location=\"classpath:db.properties\"  /&gt;\n&lt;bean name=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\" &gt;\n\t&lt;property name=\"jdbcUrl\" value=\"${jdbc.jdbcUrl}\" &gt;&lt;/property&gt;\n\t&lt;property name=\"driverClass\" value=\"${jdbc.driverClass}\" &gt;&lt;/property&gt;\n\t&lt;property name=\"user\" value=\"${jdbc.user}\" &gt;&lt;/property&gt;\n\t&lt;property name=\"password\" value=\"${jdbc.password}\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n&lt;bean name=\"jdbcTemplate\" class=\"org.springframework.jdbc.core.JdbcTemplate\" &gt;\n\t&lt;property name=\"dataSource\" ref=\"dataSource\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n&lt;bean name=\"userDao\" class=\"cn.itcast.a_jdbctemplate.UserDaoImpl\" &gt;\n\t&lt;property name=\"jt\" ref=\"jdbcTemplate\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n\næµ‹è¯•\nâ‘¢1ã€Daoå®ç°ç±»é€šè¿‡å®šä¹‰private JdbcTemplate jtå’Œsetæ–¹æ³•æ“ä½œæ•°æ®åº“\n2ã€Daoå®ç°ç±»ç»§æ‰¿jdbcDaoSupporté€šè¿‡super.getJdbcTemplate()æ“ä½œæ•°æ®åº“\npublic class UserDaoImpl extends JdbcDaoSupport implements UserDao {\n\t@Override\n\tpublic void save(User u) {\n\t\tString sql = \"insert into t_user values(null,?) \";\n\t\tsuper.getJdbcTemplate().update(sql, u.getName());\n\t}\n\t@Override\n\tpublic void delete(Integer id) {\n\t\tString sql = \"delete from t_user where id = ? \";\n\t\tsuper.getJdbcTemplate().update(sql,id);\n\t}\n\t@Override\n\tpublic void update(User u) {\n\t\tString sql = \"update  t_user set name = ? where id=? \";\n\t\tsuper.getJdbcTemplate().update(sql, u.getName(),u.getId());\n\t}\n\t@Override\n\tpublic User getById(Integer id) {\n\t\tString sql = \"select * from t_user where id = ? \";\n\t\treturn super.getJdbcTemplate().queryForObject(sql,new RowMapper&lt;User&gt;(){\n\t@Override\n\tpublic User mapRow(ResultSet rs, int arg1) throws SQLException {\n\t\tUser u = new User();\n\t\tu.setId(rs.getInt(\"id\"));\n\t\tu.setName(rs.getString(\"name\"));\n\t\treturn u;\n\t\t}}, id);\n\t}\n\t@Override\n\tpublic int getTotalCount() {\n\t\tString sql = \"select count(*) from t_user  \";\n\t\tInteger count = super.getJdbcTemplate().queryForObject(sql, Integer.class);\n\t\treturn count;\n\t}\n\n\t@Override\n\tpublic List&lt;User&gt; getAll() {\n\t\tString sql = \"select * from t_user  \";\n\t\tList&lt;User&gt; list = super.getJdbcTemplate().query(sql, new RowMapper&lt;User&gt;(){\n\t\t@Override\n\t\tpublic User mapRow(ResultSet rs, int arg1) throws SQLException {\n\t\t\tUser u = new User();\n\t\t\tu.setId(rs.getInt(\"id\"));\n\t\t\tu.setName(rs.getString(\"name\"));\n\t\t\treturn u;\n\t\t}});\n\treturn list;\n\t}\n}\n</code></pre></div><h1>10. springäº‹åŠ¡</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>xmlé…ç½®(aop)\nå¯¼åŒ…\ncom.springsource.com.mchange.v2.c3p0-0.9.1.2.jar\ncom.springsource.org.aopalliance-1.0.0.jar\ncom.springsource.org.apache.commons.logging-1.1.1.jar\ncom.springsource.org.apache.log4j-1.2.15.jar\ncom.springsource.org.aspectj.weaver-1.6.8.RELEASE.jar\nmysql-connector-java-5.1.7-bin.jar\nspring-aop-4.2.4.RELEASE.jar\nspring-aspects-4.2.4.RELEASE.jar\nspring-beans-4.2.4.RELEASE.jar\nspring-context-4.2.4.RELEASE.jar\nspring-core-4.2.4.RELEASE.jar\nspring-expression-4.2.4.RELEASE.jar\nspring-jdbc-4.2.4.RELEASE.jar\nspring-test-4.2.4.RELEASE.jar\nspring-tx-4.2.4.RELEASE.jar\t\t\t\t\n\napplication.xmlé…ç½®\n&lt;!-- å¯¼å…¥æ–°çš„çº¦æŸ(tx)\nbeans: æœ€åŸºæœ¬\ncontext:è¯»å–propertiesé…ç½®\naop:é…ç½®aop\ntx:é…ç½®äº‹åŠ¡é€šçŸ¥ --&gt;\n&lt;!-- å°†æ ¸å¿ƒäº‹åŠ¡ç®¡ç†å™¨é…ç½®åˆ°springå®¹å™¨ --&gt;\n&lt;bean name=\"transactionManager\" class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\" &gt;\n\t&lt;property name=\"dataSource\" ref=\"dataSource\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n&lt;!-- é…ç½®é€šçŸ¥ï¼ˆç¯ç»•é€šçŸ¥ï¼‰ä¼šæ”¹å†™æ•°æ®åº“çš„è¯­å¥å¢åŠ äº†read-onlyçš„è¯ä¼šæŠ¥é”™--&gt;\n&lt;tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\" &gt;\n\t&lt;tx:attributes&gt;\n\t\t&lt;tx:method name=\"save*\" isolation=\"REPEATABLE_READ\" propagation=\"REQUIRED\" read-only=\"false\" /&gt;\n\t&lt;/tx:attributes&gt;\n&lt;/tx:advice&gt;\n\n&lt;!--é…ç½®å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡--&gt;\n&lt;aop:config&gt;\n\t&lt;aop:advisor advice-ref=\"txAdvice\" pointcut=\"execution(* cn.service.*.*(..))\" /&gt;\n&lt;/aop:config&gt;\næˆ–è€…\n&lt;!-- é…ç½®ç»‡å…¥ --&gt;\n&lt;aop:config  &gt;\n\t&lt;!-- é…ç½®åˆ‡ç‚¹è¡¨è¾¾å¼ --&gt;\n\t&lt;aop:pointcut expression=\"execution(* cn.itcast.service.*ServiceImpl.*(..))\" id=\"txPc\"/&gt;\n\t&lt;!-- é…ç½®åˆ‡é¢ : é€šçŸ¥+åˆ‡ç‚¹ advice-ref:é€šçŸ¥çš„åç§°pointcut-ref:åˆ‡ç‚¹çš„åç§°--&gt;\n\t&lt;aop:advisor advice-ref=\"txAdvice\" pointcut-ref=\"txPc\" /&gt;\n&lt;/aop:config&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨è§£é…ç½®(aop)\nå¯¼åŒ…ï¼ˆä¸€æ ·ï¼‰\nå¯¼å…¥æ–°çš„çº¦æŸ(tx)(ä¸€æ ·)\nå°†æ ¸å¿ƒäº‹åŠ¡ç®¡ç†å™¨é…ç½®åˆ°springå®¹å™¨(ä¸€æ ·)\nå¼€å¯æ³¨è§£ç®¡ç†äº‹åŠ¡&lt;tx:annotation-driven/&gt;\nåœ¨ç±»æˆ–æ–¹æ³•ä¸Šé¢é…ç½®æ³¨è§£\n- @Transactional(isolation=Isolation.REPEATABLE_READ,propagation=Propagation.REQUIRED,readOnly=true)\t\t\t\t\t\n</code></pre></div><h1>11. spring webé¡¹ç›®é…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…(41ä¸ª)\nåˆ›å»ºé…ç½®æ–‡ä»¶applicationContext.xml,å¹¶å¯¼å…¥çº¦æŸ(4ä¸ª)beans|context|aop|tx\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txmlns=\"http://www.springframework.org/schema/beans\" \n\txmlns:context=\"http://www.springframework.org/schema/context\"\n\txmlns:aop=\"http://www.springframework.org/schema/aop\" \n\txmlns:tx=\"http://www.springframework.org/schema/tx\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\thttp://www.springframework.org/schema/beans/spring-beans-4.2.xsd \n\thttp://www.springframework.org/schema/context \n\thttp://www.springframework.org/schema/context/spring-context-4.2.xsd \n\thttp://www.springframework.org/schema/aop \n\thttp://www.springframework.org/schema/aop/spring-aop-4.2.xsd \n\thttp://www.springframework.org/schema/tx \n\thttp://www.springframework.org/schema/tx/spring-tx-4.2.xsd \"&gt;\n&lt;/beans&gt;\n\né…ç½®springéšé¡¹ç›®å¯åŠ¨(web.xml)\n&lt;!-- è®©springéšwebå¯åŠ¨è€Œåˆ›å»ºçš„ç›‘å¬å™¨ --&gt;\n&lt;listener&gt;\n\t&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n&lt;!-- é…ç½®springé…ç½®æ–‡ä»¶ä½ç½®å‚æ•° --&gt;\n&lt;context-param&gt;\n\t&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n\t&lt;param-value&gt;classpath:applicationContext.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n</code></pre></div><h1>12. springæ•´åˆstruts2</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…\nstruts.xmlé…ç½®å¸¸é‡\nåœ¨/struts2-spring-plugin-2.3.24.jar/struts-plugin.xml\nstruts.objectFactory = spring\tå°†actionçš„åˆ›å»ºäº¤ç»™springå®¹å™¨(å·²å¼€)\n&lt;constant name=\"struts.objectFactory\" value=\"spring\"&gt;&lt;/constant&gt;\n\nåœ¨/struts2-core-2.3.24.jar/default.properties\t\nstruts.objectFactory.spring.autoWire = name springè´Ÿè´£è£…é…Actionä¾èµ–å±æ€§(å·²å¼€)\n\n\té…ç½®struts2ä¸»é…ç½®æ–‡ä»¶struts.xmlå¹¶å€’å…¥çº¦æŸ\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\t&lt;!DOCTYPE struts PUBLIC\n\t\"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\"\n\t\"http://struts.apache.org/dtds/struts-2.3.dtd\"&gt;\n\t\t&lt;package name=\"crm\" namespace=\"/\" extends=\"struts-default\" &gt;\n\t\t\t&lt;!-- classå±æ€§ä¸Šå¡«å†™springä¸­actionå¯¹è±¡çš„BeanNameå®Œå…¨ç”±springç®¡ç†actionç”Ÿå‘½å‘¨æœŸ,åŒ…æ‹¬Actionçš„åˆ›å»º æ³¨æ„:éœ€è¦æ‰‹åŠ¨ç»„è£…ä¾èµ–å±æ€§\n\t\t\tstruts.xmlï¼ŒActionä¸­çš„å±æ€§ä¸ç»„è£…åˆ™ä¸ºnull--&gt;\n\t\t\t&lt;action name=\"UserAction_*\" class=\"userAction\" method=\"{1}\" &gt;\n\t\t\t\t&lt;result name=\"toHome\" type=\"redirect\" &gt;/index.htm&lt;/result&gt;\n\t\t\t\t&lt;result name=\"error\" &gt;/login.jsp&lt;/result&gt;\n\t\t\t&lt;/action&gt;\n\t\t&lt;/package&gt;\n\t&lt;/struts&gt;\n\n\né…ç½®applicationContext.xml\n\n&lt;!-- æ³¨æ„:Actionå¯¹è±¡ä½œç”¨èŒƒå›´ä¸€å®šæ˜¯å¤šä¾‹çš„.è¿™æ ·æ‰ç¬¦åˆstruts2æ¶æ„ --&gt;\n&lt;bean name=\"userAction\" class=\"cn.action.UserAction\" scope=\"prototype\" &gt;\n\t&lt;property name=\"userService\" ref=\"userService\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n\né…ç½®struts2æ ¸å¿ƒè¿‡æ»¤å™¨åˆ°web.xml\n&lt;filter&gt;\n\t&lt;filter-name&gt;struts2&lt;/filter-name&gt;\n\t&lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n\t&lt;filter-name&gt;struts2&lt;/filter-name&gt;\n\t&lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre></div><h1>13. springæ•´åˆc3p0è¿æ¥æ± </h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®db.properties\njdbc.jdbcUrl=jdbc:mysql:///crm_32\njdbc.driverClass=com.mysql.jdbc.Driver\njdbc.user=root\njdbc.password=1234\n\nå¼•å…¥è¿æ¥æ± åˆ°springä¸­\n\t&lt;!-- è¯»å–db.propertiesæ–‡ä»¶ --&gt;\n\t&lt;context:property-placeholder location=\"classpath:db.properties\" /&gt;\n\t&lt;bean name=\"dataSource\" class=\"com.mchange.v2.c3p0.ComboPooledDataSource\" &gt;\n\t\t&lt;property name=\"jdbcUrl\" value=\"${jdbc.jdbcUrl}\" &gt;&lt;/property&gt;\n\t\t&lt;property name=\"driverClass\" value=\"${jdbc.driverClass}\" &gt;&lt;/property&gt;\n\t\t&lt;property name=\"user\" value=\"${jdbc.user}\" &gt;&lt;/property&gt;\n\t\t&lt;property name=\"password\" value=\"${jdbc.password}\" &gt;&lt;/property&gt;\n\t&lt;/bean&gt;\n\n\n\tå°†è¿æ¥æ± æ³¨å…¥ç»™SessionFactory\n\t&lt;bean name=\"sessionFactory\" class=\"org.springframework.orm.hibernate5.LocalSessionFactoryBean\" &gt;\n\t&lt;!-- å°†è¿æ¥æ± æ³¨å…¥åˆ°sessionFactory, hibernateä¼šé€šè¿‡è¿æ¥æ± è·å¾—è¿æ¥ --&gt;\n\t&lt;property name=\"dataSource\" ref=\"dataSource\" &gt;&lt;/property&gt;\n</code></pre></div><h1>14. springæ•´åˆhibernate</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼å…¥å®ä½“ç±»&amp;ormå…ƒæ•°æ®\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \n\"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;hibernate-mapping package=\"\" &gt;\n\t&lt;class name=\"\" table=\"\" &gt;\n\t&lt;id name=\"\" column=\"\" &gt;\n\t\t&lt;generator class=\"native|assigned|uuid|increment|hilo|identity|sequence\"&gt;&lt;/generator&gt;\n\t&lt;/id&gt;\n\t&lt;property name=\"\" column=\"\" &gt;&lt;/property&gt;\n\n\t&lt;set name=\"\" inverse=\"true|false\" cascade=\"save-update|delete|all\" \n\tlazy=\"true|false|extra\" fetch=\"select/join/subselect\" batch-size=\"3\"&gt;\n\t&lt;key column=\"\" &gt;&lt;/key&gt;\n\t\t&lt;one-to-many class=\"\" /&gt;\n\t&lt;/set&gt;\n\t&lt;many-to-one name=\"\" column=\"\" class=\"\" inverse=\"false|true\" cascade=\"save-update|delete|all\" \n\t\tlazy=\"false/proxy\" fetch=\"select/join\"&gt;\n\t&lt;/many-to-one&gt;\n\n\t&lt;set name=\"\" table=\"\" inverse=\"true|false\" cascade=\"save-update|delete|all\"\n\t\tlazy=\"true|false|extra\" fetch=\"select/join/subselect\"&gt;\n\t\t&lt;key column=\"\" &gt;&lt;/key&gt;\n\t\t&lt;many-to-many class=\"\" column=\"\" &gt;&lt;/many-to-many&gt;\n\t&lt;/set&gt;\n\t&lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n\nåœ¨springé…ç½®ä¸­æ”¾ç½®hibernateé…ç½®ä¿¡æ¯\n//å°†sessionFactoryäº¤ç»™springä»£æ›¿é…ç½®ä¸»é…ç½®æ–‡ä»¶\n&lt;bean name=\"sessionFactory\" class=\"org.springframework.orm.hibernate5.LocalSessionFactoryBean\" &gt;\n&lt;!-- å°†è¿æ¥æ± æ³¨å…¥åˆ°sessionFactory, hibernateä¼šé€šè¿‡è¿æ¥æ± è·å¾—è¿æ¥ --&gt;\n\t&lt;property name=\"dataSource\" ref=\"dataSource\" &gt;&lt;/property&gt;\n\t&lt;property name=\"hibernateProperties\"&gt;\n\t&lt;props&gt;\n\t\t&lt;prop key=\"hibernate.connection.driver_class\" &gt;com.mysql.jdbc.Driver&lt;/prop&gt;\n\t\t&lt;prop key=\"hibernate.connection.url\" &gt;jdbc:mysql:///crm&lt;/prop&gt;\n\t\t&lt;prop key=\"hibernate.connection.username\" &gt;root&lt;/prop&gt;\n\t\t&lt;prop key=\"hibernate.connection.password\" &gt;1234&lt;/prop&gt; --&gt;\n\t\t&lt;prop key=\"hibernate.dialect\" &gt;org.hibernate.dialect.MySQL5Dialect&lt;/prop&gt;\n\n\t\t&lt;prop key=\"hibernate.show_sql\" &gt;true&lt;/prop&gt;\n\t\t&lt;prop key=\"hibernate.format_sql\" &gt;true&lt;/prop&gt;\n\t\t&lt;prop key=\"hibernate.hbm2ddl.auto\" &gt;update&lt;/prop&gt;\n\t&lt;/props&gt;\n\t&lt;!-- â‘ å¼•å…¥ormå…ƒæ•°æ®,æŒ‡å®šormå…ƒæ•°æ®æ‰€åœ¨çš„åŒ…è·¯å¾„,springä¼šè‡ªåŠ¨è¯»å–åŒ…ä¸­çš„æ‰€æœ‰é…ç½® --&gt;\n\t&lt;/property&gt;\n\t\t&lt;property name=\"mappingDirectoryLocations\" value=\"classpath:cn/itcast/domain\" &gt;\n\t&lt;/property&gt;\n\t&lt;!--â‘¡å¼•å…¥ormå…ƒæ•°æ®,æŒ‡å®šormå…ƒæ•°æ®æ‰€åœ¨çš„åŒ…è·¯å¾„,springä¼šè‡ªåŠ¨è¯»å–åŒ…ä¸­çš„æ‰€æœ‰é…ç½®--&gt;\n\t&lt;!--&lt;property name=\"mappingLocations\"&gt;\n\t\t&lt;list&gt;\n\t\t\t&lt;value&gt;classpath:com/itheima/bos/domain/*.xml&lt;/value&gt;\n\t\t&lt;/list&gt;\n\t&lt;/property&gt;--&gt;\n&lt;/bean&gt;\n\n&lt;!-- ä¸ºdaoæ³¨å…¥sessionFactory --&gt;\n&lt;bean name=\"userDao\" class=\"cn.itcast.dao.impl.UserDaoImpl\" &gt;\n\t&lt;property name=\"sessionFactory\" ref=\"sessionFactory\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n\nhibernateæ“ä½œæ•°æ®åº“\n\ndaoå®ç°ç±»ç»§æ‰¿HibernateDaoSupportæ“ä½œHIbernateTemplate\nå¢åˆ æ”¹\nthis.getHibernateTemplate().save(entity);\nthis.getHibernateTemplate().delete(entity);\nthis.getHibernateTemplate().update(entity);\nthis.getHibernateTemplate().get(entityClass, id);\n\nspringä¸­hibernateçš„aopäº‹åŠ¡\n\né…ç½®äº‹åŠ¡ç®¡ç†å™¨(xmlå’Œæ³¨è§£éƒ½è¦é…ç½®)\n&lt;bean name=\"transactionManager\" class=\"org.springframework.orm.hibernate5.HibernateTransactionManager\" &gt;\n\t&lt;property name=\"sessionFactory\" ref=\"sessionFactory\" &gt;&lt;/property&gt;\n&lt;/bean&gt;\n\n1ã€xmlé…ç½®aopäº‹åŠ¡\né…ç½®é€šçŸ¥\n&lt;tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\" &gt;\n\t&lt;tx:attributes&gt;\n\t\t&lt;tx:method name=\"save*\" isolation=\"REPEATABLE_READ\" propagation=\"REQUIRED\" read-only=\"false\" /&gt;\n\t&lt;/tx:attributes&gt;\n&lt;/tx:advice&gt;\n\n\né…ç½®å°†é€šçŸ¥ç»‡å…¥ç›®æ ‡å¯¹è±¡ï¼Œé…ç½®åˆ‡ç‚¹ï¼Œé…ç½®åˆ‡é¢ \n&lt;aop:config&gt;\n\t&lt;aop:pointcut expression=\"execution(* com.serviceimpl.*ServiceImpl.*(..))\" id=\"txPc\"/&gt;\n\t&lt;aop:advisor advice-ref=\"txAdvice\" pointcut-ref=\"txPc\" /&gt;\n&lt;/aop:config&gt; \n\n2ã€æ³¨è§£é…ç½®aopäº‹åŠ¡\nå¼€å¯æ³¨è§£äº‹åŠ¡&lt;tx:annotation-driven transaction-manager=\"transactionManager\" /&gt;\t\n\n\nServiceç±»ã€æ–¹æ³•ä¸­ä½¿ç”¨æ³¨è§£\n@Transactional(isolation=Isolation.REPEATABLE_READ,\npropagation=Propagation.REQUIRED,readOnly=false)\t\t\t\t\t\n\nä¸ºäº†é¿å…ä½¿ç”¨æ‡’åŠ è½½æ—¶å‡ºç°no-sessioné—®é¢˜.éœ€è¦æ‰©å¤§sessionçš„ä½œç”¨èŒƒå›´\næ³¨æ„: ä»»ä½•filterä¸€å®šè¦åœ¨strutsçš„filterä¹‹å‰è°ƒç”¨ï¼Œåœ¨struts2è¿‡æ»¤å™¨å‰é¢\né…ç½®web.xml\n&lt;filter&gt;\n\t&lt;filter-name&gt;openSessionInView&lt;/filter-name&gt;\n\t&lt;filter-class&gt;org.springframework.orm.hibernate5.support.OpenSessionInViewFilter&lt;/filter-class&gt;\n&lt;/filter&gt;\n&lt;filter-mapping&gt;\n\t&lt;filter-name&gt;openSessionInView&lt;/filter-name&gt;\n\t&lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n&lt;/filter-mapping&gt;\n</code></pre></div><h1>15. springçš„javaé…ç½®å¤šæ•°æ®æº</h1>\n<h1>16. Spring4.xçš„Javaé…ç½®æ–¹å¼ï¼ˆå¯ä»¥å®Œå…¨æ›¿ä»£xmlé…ç½®ï¼‰</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tç¼–å†™SpringConfig ç”¨äºå®ä¾‹åŒ–Springå®¹å™¨ï¼Œæ•´ä¸ªæ–‡ä»¶ç›¸å½“äºapplicationContext.xml\n\t@Configuration //é€šè¿‡è¯¥æ³¨è§£æ¥è¡¨æ˜è¯¥ç±»æ˜¯ä¸€ä¸ªSpringçš„é…ç½®ï¼Œç›¸å½“äºä¸€ä¸ªxmlæ–‡ä»¶\n\t\t@ComponentScan(basePackages = \"cn.itcast.springboot.javaconfig\") //é…ç½®æ‰«æåŒ…ï¼Œæ‰«æç»„ä»¶\n\t\t//@PropertySourceå¯ä»¥æŒ‡å®šè¯»å–çš„é…ç½®æ–‡ä»¶ï¼Œé€šè¿‡@Valueæ³¨è§£è·å–å€¼\n\t\t@PropertySource(value= {\"classpath:jdbc.properties\",\"xxxx\"},ignoreResourceNotFound=true)\n\t\tpublic class SpringConfig {\n\t\t@Value(\"${jdbc.url}\")\n\t\tprivate String jdbcUrl;\t\n\t\t@Bean // é€šè¿‡è¯¥æ³¨è§£æ¥è¡¨æ˜æ˜¯ä¸€ä¸ªBeanå¯¹è±¡ï¼Œç›¸å½“äºxmlä¸­çš„&lt;bean&gt;\n\t\tpublic UserDAO getUserDAO(){\n\t\t\treturn new UserDAO(); // ç›´æ¥newå¯¹è±¡åšæ¼”ç¤º\n\t\t}\n\t}\n</code></pre></div><h1>17. spring4.xé…ç½®æ•°æ®åº“è¿æ¥æ± </h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tå¯¼å…¥ä¾èµ–ï¼š\n\t\t&lt;!-- è¿æ¥æ±  --&gt;\n\t\t&lt;dependency&gt;\n\t\t&lt;groupId&gt;com.jolbox&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;bonecp-spring&lt;/artifactId&gt;\n\t\t&lt;version&gt;0.8.0.RELEASE&lt;/version&gt;\n\t\t&lt;/dependency&gt;\n\n\txmlé…ç½®æ”¹é€ æˆjavaé…ç½®æ–¹å¼ï¼š\n\t@Value(\"${jdbc.url}\")\n\t\tprivate String jdbcUrl;\n\n\t\t@Value(\"${jdbc.driverClassName}\")\n\t\tprivate String jdbcDriverClassName;\n\n\t\t@Value(\"${jdbc.username}\")\n\t\tprivate String jdbcUsername;\n\n\t\t@Value(\"${jdbc.password}\")\n\t\tprivate String jdbcPassword;\n\n\t\t@Bean(destroyMethod = \"close\")\n\t\tpublic DataSource dataSource() {\n\t\tBoneCPDataSource boneCPDataSource = new BoneCPDataSource();\n\t\tboneCPDataSource.setDriverClass(jdbcDriverClassName);\n\t\tboneCPDataSource.setJdbcUrl(jdbcUrl);\n\t\tboneCPDataSource.setUsername(jdbcUsername);\n\t\tboneCPDataSource.setPassword(jdbcUsername);\n\t\t// æ£€æŸ¥æ•°æ®åº“è¿æ¥æ± ä¸­ç©ºé—²è¿æ¥çš„é—´éš”æ—¶é—´ï¼Œå•ä½æ˜¯åˆ†ï¼Œé»˜è®¤å€¼ï¼š240ï¼Œå¦‚æœè¦å–æ¶ˆåˆ™è®¾ç½®ä¸º0\n\t\tboneCPDataSource.setIdleConnectionTestPeriodInMinutes(60);\n\t\t// è¿æ¥æ± ä¸­æœªä½¿ç”¨çš„é“¾æ¥æœ€å¤§å­˜æ´»æ—¶é—´ï¼Œå•ä½æ˜¯åˆ†ï¼Œé»˜è®¤å€¼ï¼š60ï¼Œå¦‚æœè¦æ°¸è¿œå­˜æ´»è®¾ç½®ä¸º0\n\t\tboneCPDataSource.setIdleMaxAgeInMinutes(30);\n\t\t// æ¯ä¸ªåˆ†åŒºæœ€å¤§çš„è¿æ¥æ•°\n\t\tboneCPDataSource.setMaxConnectionsPerPartition(100);\n\t\t// æ¯ä¸ªåˆ†åŒºæœ€å°çš„è¿æ¥æ•°    \n\t\tboneCPDataSource.setMinConnectionsPerPartition(5);\n\t\treturn boneCPDataSource;\n\t\t}\n</code></pre></div><h1>springä¸åŒç±»å‹çš„äº‹ä»¶ï¼Ÿ</h1>\n<ul>\n<li>Spring çš„ ApplicationContext æä¾›äº†æ”¯æŒäº‹ä»¶å’Œä»£ç ä¸­ç›‘å¬å™¨çš„åŠŸèƒ½,Spring æä¾›äº†ä»¥ä¸‹äº”ç§æ ‡å‡†çš„äº‹ä»¶ï¼š</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//ç›‘å¬ç³»ç»Ÿäº‹ä»¶\nä¸Šä¸‹æ–‡æ›´æ–°äº‹ä»¶ï¼ˆContextRefreshedEventï¼‰ï¼šè¯¥äº‹ä»¶ä¼šåœ¨ApplicationContext è¢«åˆå§‹åŒ–æˆ–è€…æ›´æ–°æ—¶å‘å¸ƒã€‚ä¹Ÿå¯ä»¥åœ¨è°ƒç”¨ConfigurableApplicationContext æ¥å£ä¸­çš„ #refresh() æ–¹æ³•æ—¶è¢«è§¦å‘ã€‚\nä¸Šä¸‹æ–‡å¼€å§‹äº‹ä»¶ï¼ˆContextStartedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨ConfigurableApplicationContext çš„ #start() æ–¹æ³•å¼€å§‹/é‡æ–°å¼€å§‹å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚\nä¸Šä¸‹æ–‡åœæ­¢äº‹ä»¶ï¼ˆContextStoppedEventï¼‰ï¼šå½“å®¹å™¨è°ƒç”¨ ConfigurableApplicationContext çš„ #stop() æ–¹æ³•åœæ­¢å®¹å™¨æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚\nä¸Šä¸‹æ–‡å…³é—­äº‹ä»¶ï¼ˆContextClosedEventï¼‰ï¼šå½“ApplicationContext è¢«å…³é—­æ—¶è§¦å‘è¯¥äº‹ä»¶ã€‚å®¹å™¨è¢«å…³é—­æ—¶ï¼Œå…¶ç®¡ç†çš„æ‰€æœ‰å•ä¾‹ Bean éƒ½è¢«é”€æ¯ã€‚\nè¯·æ±‚å¤„ç†äº‹ä»¶ï¼ˆRequestHandledEventï¼‰ï¼šåœ¨ We båº”ç”¨ä¸­ï¼Œå½“ä¸€ä¸ªHTTP è¯·æ±‚ï¼ˆrequestï¼‰ç»“æŸè§¦å‘è¯¥äº‹ä»¶ã€‚\npublic class AllApplicationEventListener implements ApplicationListener&lt;ApplicationEvent&gt; {  \n    @Override  \n    public void onApplicationEvent(ApplicationEvent applicationEvent) {}\n}\n//è‡ªå®šä¹‰äº‹ä»¶\npublic class CustomApplicationEvent extends ApplicationEvent{  \n    public CustomApplicationEvent(Object source, final String msg) {  \n        super(source);\n    }  \n}\n//ç›‘å¬è‡ªå®šä¹‰äº‹ä»¶\npublic class CustomEventListener implements ApplicationListener&lt;CustomApplicationEvent&gt; {\n    @Override  \n    public void onApplicationEvent(CustomApplicationEvent applicationEvent) {}\n}\n//å‘å¸ƒè‡ªå®šä¹‰äº‹ä»¶\n// åˆ›å»º CustomApplicationEvent äº‹ä»¶\nCustomApplicationEvent customEvent = new CustomApplicationEvent(applicationContext, \"Test message\");\n// å‘å¸ƒäº‹ä»¶\napplicationContext.publishEvent(customEvent);\n</code></pre></div><p>@ConditionalOnMissingBeanæ¡ä»¶æ³¨è§£æœ€å¥½åœ¨@AutoConfigurationé‡Œé¢çš„@Beanä¸Šé¢ä½¿ç”¨ï¼ŒåŒæ—¶å°†è¯¥é…ç½®ç±»æ³¨å†Œä¸ºè‡ªåŠ¨é…ç½®ç±»ï¼Œæ‰èƒ½ä¿è¯100%ç”Ÿæ•ˆï¼Œå¦åˆ™ä¼šè¢«å¦å¤–çš„é…ç½®ç±»è¦†ç›–</p>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/8a89f9ce1d4d779c62ba4.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "springboot",
      "url": "https://javaguide.cn/backend/j2ee/springboot.html",
      "id": "https://javaguide.cn/backend/j2ee/springboot.html",
      "summary": "springboot 1. SpringBoot 2. springboot2ç¨‹åºå…¥é—¨ 3. Spring Boot API 4. è‡ªå®šä¹‰SpringMVCçš„é…ç½®(æ‹¦æˆªå™¨) 5. Mybatiså’ŒSpring Bootæ•´åˆ(ä¸¤ç§æ–¹å¼) 6. Springçš„æ•´åˆRedis 7. Springçš„æ•´åˆHttpclient 8. Springçš„æ•´åˆRabbit...",
      "content_html": "<p>springboot</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-springboot\">1. SpringBoot</a></li>\n<li><a href=\"#2-springboot2%E7%A8%8B%E5%BA%8F%E5%85%A5%E9%97%A8\">2. springboot2ç¨‹åºå…¥é—¨</a></li>\n<li><a href=\"#3-spring-boot-api\">3. Spring Boot API</a></li>\n<li><a href=\"#4-%E8%87%AA%E5%AE%9A%E4%B9%89springmvc%E7%9A%84%E9%85%8D%E7%BD%AE%E6%8B%A6%E6%88%AA%E5%99%A8\">4. è‡ªå®šä¹‰SpringMVCçš„é…ç½®(æ‹¦æˆªå™¨)</a></li>\n<li><a href=\"#5-mybatis%E5%92%8Cspring-boot%E6%95%B4%E5%90%88%E4%B8%A4%E7%A7%8D%E6%96%B9%E5%BC%8F\">5. Mybatiså’ŒSpring Bootæ•´åˆ(ä¸¤ç§æ–¹å¼)</a></li>\n<li><a href=\"#6-spring%E7%9A%84%E6%95%B4%E5%90%88redis\">6. Springçš„æ•´åˆRedis</a></li>\n<li><a href=\"#7-spring%E7%9A%84%E6%95%B4%E5%90%88httpclient\">7. Springçš„æ•´åˆHttpclient</a></li>\n<li><a href=\"#8-spring%E7%9A%84%E6%95%B4%E5%90%88rabbitmq\">8. Springçš„æ•´åˆRabbitMQ</a></li>\n<li><a href=\"#9-spring%E6%95%B4%E5%90%88servletfilterlistener\">9. springæ•´åˆServletã€Filterã€Listener</a></li>\n<li><a href=\"#10-springboot%E5%B8%B8%E8%A7%81%E9%97%AE%E9%A2%98\">10. springbootå¸¸è§é—®é¢˜</a></li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. SpringBoot</h1>\n<p>springbootå¿«é€Ÿåˆ›å»ºä¸€ä¸ªç‹¬ç«‹è¿è¡Œã€å‡†ç”Ÿäº§çº§åˆ«çš„åŸºäºspringæ¡†æ¶çš„é¡¹ç›®<br>\nspringbootå…¶å®åŒ…å«äº†springmvcç­‰è®¸å¤šçš„ç»„ä»¶ï¼Œè¿˜å…è®¸è‡ªåŠ¨é…ç½®ï¼Œçœäº‹</p>\n<h1>2. springboot2ç¨‹åºå…¥é—¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åˆ›å»ºmavené¡¹ç›®ï¼Œæ‰“åŒ…æ–¹å¼é€‰æ‹©warï¼Œè·³è¿‡éª¨æ¶\né…ç½®pom.xmlï¼ˆæ³¨æ„ç¼–è¯‘jdkç‰ˆæœ¬å’Œè¿è¡Œçš„jdkç‰ˆæœ¬åŒ¹é…ï¼‰\n\t&lt;project xmlns=\"http://maven.apache.org/POM/4.0.0\" \n\t\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n\t\txsi:schemaLocation=\"http://maven.apache.org/POM/4.0.0 \n\t\thttp://maven.apache.org/xsd/maven-4.0.0.xsd\"&gt;\n\t\t&lt;modelVersion&gt;4.0.0&lt;/modelVersion&gt;\n\t\t&lt;groupId&gt;com.junye&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;testspringboot&lt;/artifactId&gt;\n\t\t&lt;version&gt;0.0.1-SNAPSHOT&lt;/version&gt;\n\t\t&lt;!--æ‰“åŒ…çš„æ–¹å¼ä¸ºwarï¼Œè‡ªåŠ¨ç”ŸæˆjaråŒ…--&gt;\n\t\t&lt;packaging&gt;war&lt;/packaging&gt;\n\t\t&lt;name&gt;testspringboot&lt;/name&gt;\n\t\t&lt;description&gt;AAA&lt;/description&gt;\n\t\t&lt;!-- å®šä¹‰å…¬å…±èµ„æºç‰ˆæœ¬ --&gt;\n\t\t&lt;parent&gt;\n\t\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t\t&lt;artifactId&gt;spring-boot-starter-parent&lt;/artifactId&gt;\n\t\t\t&lt;version&gt;2.0.2.RELEASE&lt;/version&gt;\n\t\t&lt;/parent&gt;\n\t\t&lt;!--è®¾ç½®èµ„æºçš„ç‰ˆæœ¬--&gt;\n\t\t&lt;properties&gt;\n\t\t&lt;project.build.sourceEncoding&gt;UTF-8&lt;/project.build.sourceEncoding&gt;\n\t\t&lt;project.reporting.outputEncoding&gt;UTF-8&lt;/project.reporting.outputEncoding&gt;\n\t\t&lt;java.version&gt;1.8&lt;/java.version&gt;\n\t\t&lt;/properties&gt;\n\t\t\n\t\t&lt;dependencies&gt;\n\t\t&lt;dependency&gt;\n\t\t&lt;!-- ä¸Šè¾¹å¼•å…¥ parentï¼Œå› æ­¤ ä¸‹è¾¹æ— éœ€æŒ‡å®šç‰ˆæœ¬ï¼Œç›¸å½“äºé…ç½®äº†springmvc --&gt;\n\t\t&lt;!-- åŒ…å« mvc,aop ç­‰jarèµ„æº --&gt;\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n\t\t&lt;!--ä½¿ç”¨åˆ«çš„æœåŠ¡å™¨ï¼Œå¦‚undertow\n\t\t&lt;exclusions&gt;\n\t\t&lt;exclusion&gt;\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;spring-boot-starter-tomcat&lt;/artifactId&gt;\n\t\t&lt;/exclusion&gt;\n\t\t&lt;/exclusions&gt;\n\t\t&lt;/dependency&gt;\n\t\tæŒ‡å®šç‰¹å®šçš„æœåŠ¡å™¨\n\t\t&lt;dependency&gt;\n\t\t   &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t   &lt;artifactId&gt;spring-boot-starter-undertow&lt;/artifactId&gt;\n\t\t&lt;/dependency&gt;--&gt;\n\t\t&lt;/dependencies&gt;\n\t\t&lt;build&gt;\n\t\t&lt;!--æŒ‡å®šspringbootçš„mavenæ’ä»¶--&gt;\n\t\t&lt;plugins&gt;\n\t\t&lt;plugin&gt;\n\t\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t\t&lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n\t\t&lt;/plugin&gt;\n\t\t&lt;/plugins&gt;\n\t\t&lt;/build&gt;\n\t\t&lt;/project&gt;\nsrc/main/javaä¸‹çš„ç¨‹åºå…¥å£ï¼šChapter1Applicationï¼ˆå¿…é¡»ï¼‰\n\trunä¸­ä¼ å…¥çš„åå­—å¿…é¡»ä¸ç±»åä¸€è‡´\n\t\tpackage com.junye.test;\n\t\timport org.springframework.boot.SpringApplication;\n\t\timport org.springframework.boot.autoconfigure.SpringBootApplication;\n\t\t@SpringBootApplication\n\t\tpublic class Chapter1Application {\n\t\t\tpublic static void main(String[] args) {\n\t\t\t\tSpringApplication.run(Chapter1Application.class, args);\n\t\t\t}\n\t\t}\n\n\nsrc/main/javaä¸‹çš„controllerå±‚ï¼ˆå¿…é¡»ï¼‰\n\tpackage com.junye.test;\n\t\timport org.springframework.stereotype.Controller;\n\t\timport org.springframework.ui.Model;\n\t\timport org.springframework.web.bind.annotation.RequestMapping;\n\t\timport org.springframework.web.bind.annotation.RestController;\n\t\t@RestController//è‡ªåŠ¨è¿”å›jsonæ•°æ®\n\t\tpublic class HelloController {\n\t\t@RequestMapping(\"/hello\")\n\t\tpublic String index() {\n\t\treturn \"Hello World\";\n\t\t}\n\t\t}\n\t\nå¯åŠ¨é¡¹ç›®çš„æ–¹æ³•\n\tDebug Runæˆ–è€…è¿è¡Œä¸»å‡½æ•°æˆ–è€…mavençš„spring-bootï¼šrun\n\tå®Œæˆä¸Šè¿°æ­¥éª¤è®¿é—®ï¼šhttp://localhost:8080/helloå³å¯æ˜¾ç¤ºhelloworld\nspringbootå‚æ•°æ¥æ”¶ä¸è¿”å›ä¸springmvcä¸€è‡´\n</code></pre></div><h1>3. Spring Boot API</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å…¥å£ç±»å’Œ@SpringBootApplication\nSpring Bootçš„é¡¹ç›®ä¸€èˆ¬éƒ½ä¼šæœ‰*Applicationçš„å…¥å£ç±»ï¼Œå…¥å£ç±»ä¸­ä¼šæœ‰mainæ–¹æ³•ï¼Œè¿™æ˜¯ä¸€ä¸ªæ ‡å‡†çš„Javaåº”ç”¨ç¨‹åºçš„å…¥å£æ–¹æ³•ã€‚\n@SpringBootApplicationæ³¨è§£æ˜¯Spring Bootçš„æ ¸å¿ƒæ³¨è§£ï¼Œå®ƒå…¶å®æ˜¯ä¸€ä¸ªç»„åˆæ³¨è§£\n\n@SpringBootConfiguration=&gt;@Configuration\n@EnableAutoConfiguration å¯ç”¨è‡ªåŠ¨é…ç½®ä½¿é¡¹ç›®ä¸­ä¾èµ–çš„jaråŒ…è‡ªåŠ¨é…ç½®é¡¹ç›®çš„é…ç½®é¡¹\n@ComponentScan(\n    excludeFilters = {@Filter(\n    type = FilterType.CUSTOM,\n    classes = {TypeExcludeFilter.class}\n), @Filter(\n    type = FilterType.CUSTOM,\n    classes = {AutoConfigurationExcludeFilter.class}\n)}//é»˜è®¤æ‰«æ@SpringBootApplicationæ‰€åœ¨ç±»çš„åŒçº§ç›®å½•ä»¥åŠå®ƒçš„å­ç›®å½•\n\nå…³é—­è‡ªåŠ¨é…ç½®\nspring-boot-autoconfigure-xxx.jar\n@SpringBootApplication(exclude={RedisAutoConfiguration.class})\n\nè‡ªå®šä¹‰Banner(springå¯åŠ¨å›¾æ¡ˆ)\nhttp://patorjk.com/software/taag/#p=display&amp;f=Graffiti&amp;t=Type%20Something%20\næ‹·è´ç”Ÿæˆçš„å­—ç¬¦åˆ°ä¸€ä¸ªæ–‡æœ¬æ–‡ä»¶ä¸­ï¼Œå¹¶ä¸”å°†è¯¥æ–‡ä»¶å‘½åä¸ºbanner.txtï¼Œå°†banner.txtæ‹·è´åˆ°mavené¡¹ç›®çš„resourcesç›®å½•ä¸­å³å¯\nå…³é—­Banner application.properties\nspring.main.banner-mode = off\n\nå…¨å±€é…ç½®æ–‡ä»¶application.propertiesæˆ–è€…application.ymlï¼Œåœ¨resourcesç›®å½•ä¸‹æˆ–è€…ç±»è·¯å¾„ä¸‹çš„/configä¸‹ï¼Œ\nserver.port=8088 #tomcatç«¯å£\nserver.servlet-path=*.html # ä¿®æ”¹è¿›å…¥DispatcherServletçš„è§„åˆ™ä¸ºï¼š*.html\n    \nè®¾ç½®æ—¥å¿—çº§åˆ«\nlogging.level.org.springframework=DEBUG\n\né™æ€èµ„æºè·¯å¾„\nspring.resources.static-locations=classpath:/META-INF/resources/,classpath:/resources/,classpath:/static/,classpath:/public/\n\nmvcè§†å›¾\nspring.mvc.view.prefix=/WEB-INF/views/\nspring.mvc.view.suffix=.jsp\n\n# springbootè®¾ç½®sessionè¿‡æœŸçš„æ—¶é—´\nserver.session.timeout=120\n\nspringbootjavaé…ç½®å’Œapplication.propertiesé…ç½®å†²çªä¼˜å…ˆjavaé…ç½®\nspringbootçš„@componenté…ç½®å¯¼è‡´æ•°æ®æºé…ç½®ä¸å¯ç”¨ï¼Œè¯´æ˜springbootçš„é…ç½®æ˜¯å…ˆåŠ è½½componentç„¶åå†åŠ configuration\n\nå¼•å…¥xmlé…ç½®æ–‡ä»¶\n@ImportResource({\"classpath:xxx-context.xml\"})\n\nè¯»å–å¤–éƒ¨çš„é…ç½®æ–‡ä»¶\n@PropertySource(value = { \"classpath:jdbc.properties\", \"classpath:env.properties\"})\n</code></pre></div><h1>4. è‡ªå®šä¹‰SpringMVCçš„é…ç½®(æ‹¦æˆªå™¨)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç»§æ‰¿WebMvcConfigurerAdapter,ç„¶åé‡å†™çˆ¶ç±»ä¸­çš„æ–¹æ³•è¿›è¡Œæ‰©å±•ã€‚\nimport java.nio.charset.Charset;\nimport java.util.List;\n\nimport javax.servlet.http.HttpServletRequest;\nimport javax.servlet.http.HttpServletResponse;\n\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.http.converter.HttpMessageConverter;\nimport org.springframework.http.converter.StringHttpMessageConverter;\nimport org.springframework.web.servlet.HandlerInterceptor;\nimport org.springframework.web.servlet.ModelAndView;\nimport org.springframework.web.servlet.config.annotation.InterceptorRegistry;\nimport org.springframework.web.servlet.config.annotation.WebMvcConfigurerAdapter;\n\n@Configuration\npublic class MySrpingMVCConfig extends WebMvcConfigurerAdapter{\n\t// è‡ªå®šä¹‰æ‹¦æˆªå™¨\n\t@Override\n\tpublic void addInterceptors(InterceptorRegistry registry) {\n\t\tHandlerInterceptor handlerInterceptor = new HandlerInterceptor() {\n\t\t\t@Override\n\t\t\tpublic boolean preHandle(HttpServletRequest request, HttpServletResponse response, Object handler)\n\t\t\tthrows Exception {\n\t\t\t\tSystem.out.println(\"è‡ªå®šä¹‰æ‹¦æˆªå™¨............\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\t@Override\n\t\t\tpublic void postHandle(HttpServletRequest request, HttpServletResponse response, Object handler,\n\t\t\tModelAndView modelAndView) throws Exception {\n\n\t\t\t}\n\n\t\t\t@Override\n\t\t\tpublic void afterCompletion(HttpServletRequest request, HttpServletResponse response, Object handler,\n\t\t\tException ex) throws Exception {\n\t\t\t}\n\t\t};\n\t\t//æ³¨å†Œæ‹¦æˆªå™¨     \n\t\tregistry.addInterceptor(handlerInterceptor).addPathPatterns(\"/**\");\n\t}\n\n\t// è‡ªå®šä¹‰æ¶ˆæ¯è½¬åŒ–å™¨çš„ç¬¬äºŒç§æ–¹æ³•\n\t@Override\n\tpublic void configureMessageConverters(List&lt;HttpMessageConverter&lt;?&gt;&gt; converters) {\n\t\tStringHttpMessageConverter converter  = new StringHttpMessageConverter(Charset.forName(\"UTF-8\"));\n\t\tconverters.add(converter);\n\t}\n\n}\n</code></pre></div><h1>5. Mybatiså’ŒSpring Bootæ•´åˆ(ä¸¤ç§æ–¹å¼)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä½¿ç”¨mybatiså®˜æ–¹æä¾›çš„Spring Bootæ•´åˆåŒ…å®ç°https://github.com/mybatis/spring-boot-starter\n&lt;!--ä¸‰åŒ…åˆä¸€ï¼ŒåŒ…æ‹¬mybatisã€æ•´åˆåŒ…å’Œäº‹åŠ¡åŒ…--&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.mybatis.spring.boot&lt;/groupId&gt;\n\t&lt;artifactId&gt;mybatis-spring-boot-starter&lt;/artifactId&gt;\n\t&lt;version&gt;1.3.0&lt;/version&gt;\n&lt;/dependency&gt;\n@Mapperï¼ˆåœ¨æ¥å£ä¸Šé¢æ³¨è§£å³å¯ï¼‰æˆ–è€…ç›´æ¥æ‰«æåŒ…\n@MapperScan(basePackages= {\"com.junye.testspringbootMybaits\"})\n@Transactionalï¼ˆserviceå±‚ä¸Šé¢æ³¨å†Œï¼‰\njavaé…ç½®sqlfactorysessionå’Œæ•°æ®æº\n@Bean\n//@Primary//è®¾ç½®ä¼˜å…ˆ,å¤šæ•°æ®æºçš„æ—¶å€™ä½¿ç”¨å°±æ˜¯å½“é‡åˆ°æ•°æ®å¯¹æ¥çš„æ—¶å€™ç”¨\npublic ComboPooledDataSource getComboPooledDataSource() throws PropertyVetoException{\n\tComboPooledDataSource cd=new ComboPooledDataSource();\n\tcd.setDriverClass(\"com.mysql.cj.jdbc.Driver\");\n\tcd.setJdbcUrl(\"jdbc:mysql://localhost:3306/testmybatis?useSSL=true&amp;serverTimezone=GMT%2B8\");\n\tcd.setUser(\"root\");\n\tcd.setPassword(\"1105128664\");\n\treturn cd;\n}\n\n@Bean(name=\"sqlSessionFactory\")\npublic SqlSessionFactoryBean getSqlSessionFactoryBean() throws Exception{\n\tSqlSessionFactoryBean sf = new SqlSessionFactoryBean();\n\tsf.setDataSource(getComboPooledDataSource());\n\tsf.setMapperLocations(new PathMatchingResourcePatternResolver().getResources(\"classpath:match2/test/*.xml\"));\n\tsf.setTypeAliasesPackage(\"com.junye.test\");//è®¾ç½®åŒ…çš„åˆ«å\n\t//ä¸‹é¢çš„é…ç½®å¯æœ‰å¯æ— ï¼Œæ¯•ç«Ÿè®¾ç½®åŒ…çš„åˆ«åå·²ç»è®¾è®¡å¥½äº†\n\t//sf.setConfigLocation(new PathMatchingResourcePatternResolver().getResource(\"classpath:mybatis-configuration.xml\"));\n\treturn sf;\n}\n\nä½¿ç”¨mybatis-springæ•´åˆçš„æ–¹å¼ï¼ˆæ¨èï¼‰\n&lt;!--mybatisæ ¸å¿ƒåŒ…--&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n\t&lt;artifactId&gt;mybatis&lt;/artifactId&gt;\n\t&lt;version&gt;3.2.8&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;!--æ•´åˆåŒ…--&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.mybatis&lt;/groupId&gt;\n\t&lt;artifactId&gt;mybatis-spring&lt;/artifactId&gt;\n\t&lt;version&gt;1.2.2&lt;/version&gt;\n&lt;/dependency&gt; \n&lt;!--æ•´åˆäº‹åŠ¡--&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t&lt;artifactId&gt;spring-boot-starter-jdbc&lt;/artifactId&gt;\n&lt;/dependency&gt;\njavaé…ç½®ç±»\nimport javax.sql.DataSource;\nimport org.mybatis.spring.SqlSessionFactoryBean;\nimport org.springframework.boot.autoconfigure.condition.ConditionalOnMissingBean;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.core.io.Resource;\nimport org.springframework.core.io.support.PathMatchingResourcePatternResolver;\nimport org.springframework.core.io.support.ResourcePatternResolver;\nimport org.mybatis.spring.mapper.MapperScannerConfigurer;\n@Configuration\npublic class MyBatisConfig {\n@Bean\n@ConditionalOnMissingBean //å½“å®¹å™¨é‡Œæ²¡æœ‰æŒ‡å®šçš„Beançš„æƒ…å†µä¸‹åˆ›å»ºè¯¥å¯¹è±¡\npublic SqlSessionFactoryBean sqlSessionFactory(DataSource dataSource) {\n\tSqlSessionFactoryBean sqlSessionFactoryBean = new SqlSessionFactoryBean();\n\tsqlSessionFactoryBean.setDataSource(dataSource);\n\tResourcePatternResolver resolver = new PathMatchingResourcePatternResolver();\n\tResource mybatisConfigXml = resolver.getResource(\"classpath:mybatis/mybatis-config.xml\");\n\tsqlSessionFactoryBean.setConfigLocation(mybatisConfigXml);\n\tsqlSessionFactoryBean.setTypeAliasesPackage(\"com.taotao.cart.pojo\");\n\treturn sqlSessionFactoryBean;\n}\n// mapperæ¥å£çš„æ‰«æå™¨ï¼Œå¯ç”¨@MapperScanä»£æ›¿\n@Bean\npublic MapperScannerConfigurer mapperScannerConfigurer() {\n\tMapperScannerConfigurer mapperScannerConfigurer = new MapperScannerConfigurer();\n\tmapperScannerConfigurer.setBasePackage(\"com.taotao.cart.mapper\");\n\treturn mapperScannerConfigurer;\n\t}\n}\n\näº‹åŠ¡ç®¡ç†\nåœ¨Spring Bootä¸­æ¨èä½¿ç”¨@Transactionalæ³¨è§£æ¥ç”³æ˜äº‹åŠ¡ã€‚\nå½“å¼•å…¥jdbcä¾èµ–ä¹‹åï¼ŒSpring Bootä¼šè‡ªåŠ¨é»˜è®¤åˆ†åˆ«æ³¨å…¥DataSourceTransactionManager\næˆ–JpaTransactionManagerï¼Œæ‰€ä»¥æˆ‘ä»¬ä¸éœ€è¦ä»»ä½•é¢å¤–é…ç½®å°±å¯ä»¥ç”¨@Transactionalæ³¨è§£è¿›è¡Œäº‹åŠ¡çš„ä½¿ç”¨ã€‚\nåœ¨Serviceä¸­æ·»åŠ @Transactionalæ³¨è§£ï¼š\n\n</code></pre></div><h1>6. Springçš„æ•´åˆRedis</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tåœ¨Spring Bootä¸­æä¾›äº†RedisTempplateçš„æ“ä½œï¼Œ\n\timport java.util.ArrayList;\n\timport java.util.List;\n\n\timport org.springframework.beans.factory.annotation.Value;\n\timport org.springframework.context.annotation.Bean;\n\timport org.springframework.context.annotation.Configuration;\n\timport org.springframework.context.annotation.PropertySource;\n\n\timport redis.clients.jedis.JedisPoolConfig;\n\timport redis.clients.jedis.JedisShardInfo;\n\timport redis.clients.jedis.ShardedJedisPool;\n\n\t@Configuration\n\t@PropertySource(value = \"classpath:redis.properties\")\n\tpublic class RedisSpringConfig {\n\n\t@Value(\"${redis.maxTotal}\")\n\tprivate Integer redisMaxTotal;\n\n\t@Value(\"${redis.node1.host}\")\n\tprivate String redisNode1Host;\n\n\t@Value(\"${redis.node1.port}\")\n\tprivate Integer redisNode1Port;\n\n\tprivate JedisPoolConfig jedisPoolConfig() {\n\t\tJedisPoolConfig jedisPoolConfig = new JedisPoolConfig();\n\t\tjedisPoolConfig.setMaxTotal(redisMaxTotal);\n\t\treturn jedisPoolConfig;\n\t}\n\n\t@Bean\n\tpublic ShardedJedisPool shardedJedisPool() {\n\t\tList&lt;JedisShardInfo&gt; jedisShardInfos = new ArrayList&lt;JedisShardInfo&gt;();\n\t\tjedisShardInfos.add(new JedisShardInfo(redisNode1Host, redisNode1Port));\n\t\treturn new ShardedJedisPool(jedisPoolConfig(), jedisShardInfos);\n\t\t}\n\t}\n</code></pre></div><h1>7. Springçš„æ•´åˆHttpclient</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>import org.apache.http.client.config.RequestConfig;\nimport org.apache.http.impl.client.CloseableHttpClient;\nimport org.apache.http.impl.client.HttpClients;\nimport org.apache.http.impl.conn.PoolingHttpClientConnectionManager;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\nimport org.springframework.context.annotation.PropertySource;\nimport org.springframework.context.annotation.Scope;\n\nimport com.taotao.common.httpclient.IdleConnectionEvictor;\n\n@Configuration\n@PropertySource(value = \"classpath:httpclient.properties\")\npublic class HttpclientSpringConfig {\n\n@Value(\"${http.maxTotal}\")\nprivate Integer httpMaxTotal;\n\n@Value(\"${http.defaultMaxPerRoute}\")\nprivate Integer httpDefaultMaxPerRoute;\n\n@Value(\"${http.connectTimeout}\")\nprivate Integer httpConnectTimeout;\n\n@Value(\"${http.connectionRequestTimeout}\")\nprivate Integer httpConnectionRequestTimeout;\n\n@Value(\"${http.socketTimeout}\")\nprivate Integer httpSocketTimeout;\n\n@Value(\"${http.staleConnectionCheckEnabled}\")\nprivate Boolean httpStaleConnectionCheckEnabled;\n\n@Autowired\nprivate PoolingHttpClientConnectionManager manager;\n\n@Bean\npublic PoolingHttpClientConnectionManager poolingHttpClientConnectionManager() {\n\tPoolingHttpClientConnectionManager poolingHttpClientConnectionManager = new PoolingHttpClientConnectionManager();\n\t// æœ€å¤§è¿æ¥æ•°\n\tpoolingHttpClientConnectionManager.setMaxTotal(httpMaxTotal);\n\t// æ¯ä¸ªä¸»æœºçš„æœ€å¤§å¹¶å‘æ•°\n\tpoolingHttpClientConnectionManager.setDefaultMaxPerRoute(httpDefaultMaxPerRoute);\n\treturn poolingHttpClientConnectionManager;\n}\n\n// å®šæœŸå…³é—­æ— æ•ˆè¿æ¥\n@Bean\npublic IdleConnectionEvictor idleConnectionEvictor() {\n\treturn new IdleConnectionEvictor(manager);\n}\n\n// å®šä¹‰Httpclientå¯¹\n@Bean\n@Scope(\"prototype\")\npublic CloseableHttpClient closeableHttpClient() {\n\treturn HttpClients.custom().setConnectionManager(this.manager).build();\n}\n\n// è¯·æ±‚é…ç½®\n@Bean\npublic RequestConfig requestConfig() {\n\treturn RequestConfig.custom().setConnectTimeout(httpConnectTimeout) // åˆ›å»ºè¿æ¥çš„æœ€é•¿æ—¶é—´\n\t.setConnectionRequestTimeout(httpConnectionRequestTimeout) // ä»è¿æ¥æ± ä¸­è·å–åˆ°è¿æ¥çš„æœ€é•¿æ—¶é—´\n\t.setSocketTimeout(httpSocketTimeout) // æ•°æ®ä¼ è¾“çš„æœ€é•¿æ—¶é—´\n\t.setStaleConnectionCheckEnabled(httpStaleConnectionCheckEnabled) // æäº¤è¯·æ±‚å‰æµ‹è¯•è¿æ¥æ˜¯å¦å¯ç”¨\n\t.build();\n}\n\n}\n</code></pre></div><h1>8. Springçš„æ•´åˆRabbitMQ</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼å…¥spring-boot-starter-amqpçš„ä¾èµ–\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.springframeword.boot&lt;/groupId&gt;\n\t&lt;artifactId&gt;spring-boot-starter-amqp&lt;/artifactId&gt;\n&lt;/dependency&gt;\napplication.propertiesæ–‡ä»¶ä¸­é…ç½®RabbitMQçš„è¿æ¥ä¿¡æ¯\nspring.rabbitmq.host=127.0.0.1\nspring.rabbitmq.port=5672\nspring.rabbitmq.password=root\nspring.rabbitmq.username=test\nspring.rabbitmq.virtual-hos=/test\n\nç¼–å†™Rabbitçš„Springé…ç½®ç±»\nimport org.springframework.amqp.core.Queue;\nimport org.springframework.amqp.rabbit.connection.ConnectionFactory;\nimport org.springframework.amqp.rabbit.core.RabbitAdmin;\nimport org.springframework.beans.factory.annotation.Autowired;\nimport org.springframework.context.annotation.Bean;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\npublic class RabbitMQSpringConfig {\n\n@Autowired\nprivate ConnectionFactory connectionFactory;\n\n// ç®¡ç†\n@Bean\npublic RabbitAdmin rabbitAdmin() {\n\treturn new RabbitAdmin(connectionFactory);\n}\n\n// å£°æ˜é˜Ÿåˆ—\n@Bean\npublic Queue taotaoCartLoginQueue() {\n\t// é»˜è®¤å°±æ˜¯è‡ªåŠ¨å£°æ˜çš„\n\treturn new Queue(\"TAOTAO-CART-LOGIN-QUEUE\", true);\n}\n\n// å£°æ˜é˜Ÿåˆ—\n@Bean\npublic Queue taotaoCartOrderSuccessQueue() {\n\t// é»˜è®¤å°±æ˜¯è‡ªåŠ¨å£°æ˜çš„\n\treturn new Queue(\"TAOTAO-CART-ORDER-SUCCESS-QUEUE\", true);\n}\n\n}\nè®¾ç½®ç›‘å¬\n@Component\npublic class Test{\n\t@RabbitListener(queues = \"xxxx\")\n\tpublic void fun(){}\n}\n</code></pre></div><h1>9. springæ•´åˆServletã€Filterã€Listener</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨å†ŒServlet\nâ‘ ä½¿ç”¨ServletRegistrationBeanæ³¨å†Œ\nä½¿ç”¨ServletRegistrationBeanæ³¨å†Œåªéœ€è¦åœ¨@Configurationç±»ä¸­åŠ å…¥å³å¯\n@Configuration\npublic class Registration{\n@Bean  \npublic ServletRegistrationBean myServlet() {  \n\tServletRegistrationBean myServlet = new ServletRegistrationBean();  \n\tmyServlet.addUrlMappings(\"/servlet\");  \n\tmyServlet.setServlet(new MyServlet());  \n\treturn myServlet;  \n}\n}\nâ‘¡ä½¿ç”¨@WebServlet\nä½¿ç”¨@WebServletæ³¨å†Œï¼Œéœ€è¦åœ¨Servletç±»ä¸Šä½¿ç”¨è¯¥æ³¨è§£å³å¯ï¼Œ\nä½†æ˜¯éœ€è¦åœ¨@Configurationç±»ä¸­ä½¿ç”¨@ServletComponentScanæ‰«ææ³¨å†Œç›¸åº”çš„Servlet\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨å†ŒFilter\næ³¨æ„æ³¨å†Œå¤šä¸ªfilterè¦è‡ªå·±ä¸€ä¸ªä¸ªæ³¨å†Œä¸è¦æŒ¤åœ¨ä¸€èµ·\nâ‘ ä½¿ç”¨FilterRegistrationBeanæ³¨å†Œ\nä½¿ç”¨FilterRegistrationBeanæ³¨å†ŒFilterï¼Œåªéœ€è¦åœ¨@Configurationç±»ä¸­åŠ å…¥å³å¯\n@Bean  \npublic FilterRegistrationBean myFilter() {  \n\tFilterRegistrationBean myFilter = new FilterRegistrationBean();  \n\tmyFilter.addUrlPatterns(\"/*\");  \n\tmyFilter.setFilter(new MyFilter());  \n\treturn myFilter;  \n}  \nâ‘¡ä½¿ç”¨@WebFilter\nä½¿ç”¨@WebFilteræ³¨å†Œï¼Œéœ€è¦åœ¨Filterç±»ä¸Šä½¿ç”¨è¯¥æ³¨è§£å³å¯ï¼Œ\nä½†æ˜¯éœ€è¦åœ¨@Configurationç±»ä¸­ä½¿ç”¨@ServletComponentScanæ‰«ææ³¨å†Œç›¸åº”çš„Filterã€‚\n \n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ³¨å†ŒListener\nâ‘ ä½¿ç”¨ServletListenerRegistrationBeanæ³¨å†Œ\nä½¿ç”¨ServletListenerRegistrationBeanæ³¨å†ŒListeneråªéœ€è¦åœ¨@Configurationç±»ä¸­åŠ å…¥å³å¯\n@Bean  \npublic ServletListenerRegistrationBean&lt;MyListener&gt; myServletListener() {  \n\tServletListenerRegistrationBean&lt;MyListener&gt; myListener = \n\tnew ServletListenerRegistrationBean&lt;MyListener&gt;();\n\tmyListener.setListener(new MyListener());  \n\treturn myListener;  \n}  \nâ‘¡ä½¿ç”¨@WebListener\nä½¿ç”¨@WebListeneræ³¨å†Œï¼Œéœ€è¦åœ¨Filterç±»ä¸Šä½¿ç”¨è¯¥æ³¨è§£å³å¯ï¼Œ\nä½†æ˜¯éœ€è¦åœ¨@Configurationç±»ä¸­ä½¿ç”¨Spring Bootæä¾›çš„æ³¨è§£\n@ServletComponentScanæ‰«ææ³¨å†Œç›¸åº”çš„Listener\n</code></pre></div><h1>10. springbootå¸¸è§é—®é¢˜</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/03d148b38878303db4ee4.png\" alt=\"47.png\" tabindex=\"0\"><figcaption>47.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Slf4jæ—¥å¿—è­¦å‘Š\næç¤ºæˆ‘ä»¬å½“å‰çš„é¡¹ç›®ä¸­slf4jå¼•å…¥äº†2ä¸ªï¼Œå¯¼è‡´äº†jarå†²çªã€‚\nè§£å†³ï¼šåˆ é™¤è‡ªå·±å¼•å…¥åˆ°slf4jçš„ä¾èµ–\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.slf4j&lt;/groupId&gt;\n\t&lt;artifactId&gt;slf4j-log4jl2&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\njspè®¿é—®404çš„é—®é¢˜\nç”±äºSpring bootä½¿ç”¨çš„å†…åµŒçš„tomcatï¼Œè€Œå†…åµŒçš„tamcatæ˜¯ä¸æ”¯æŒjspé¡µé¢çš„ï¼Œ\nå¯¼åŒ…\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.apache.tomcat.embed&lt;/groupId&gt;\n\t&lt;artifactId&gt;tomcat-embed-jasper&lt;/artifactId&gt;\n\t&lt;scope&gt;provided&lt;/scope&gt;\n&lt;/dependency&gt;\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/03d148b38878303db4ee4.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "SpringCloud",
      "url": "https://javaguide.cn/backend/j2ee/springcloud.html",
      "id": "https://javaguide.cn/backend/j2ee/springcloud.html",
      "summary": "1. springcloudå¸¸ç”¨ç»„ä»¶ 1.1. æœåŠ¡å‘ç°ä¸æ³¨å†ŒZooKeeperã€Eurekaã€consoul 1.2. æœåŠ¡é—´è°ƒç”¨Feignä¸æ–­è·¯å™¨Hystrix 1.3. ç½‘å…³Zuulã€gatyway 1.4. åˆ†å¸ƒå¼é…ç½®consul 1.5. è´Ÿè½½å‡è¡¡Ribbon 1. springcloudå¸¸ç”¨ç»„ä»¶ 1.1. æœåŠ¡å‘ç°ä¸æ³¨å†ŒZooKeeperã€...",
      "content_html": "<!-- TOC -->\n<ul>\n<li><a href=\"#1-springcloud%E5%B8%B8%E7%94%A8%E7%BB%84%E4%BB%B6\">1. springcloudå¸¸ç”¨ç»„ä»¶</a>\n<ul>\n<li><a href=\"#11-%E6%9C%8D%E5%8A%A1%E5%8F%91%E7%8E%B0%E4%B8%8E%E6%B3%A8%E5%86%8Czookeepereurekaconsoul\">1.1. æœåŠ¡å‘ç°ä¸æ³¨å†ŒZooKeeperã€Eurekaã€consoul</a></li>\n<li><a href=\"#12-%E6%9C%8D%E5%8A%A1%E9%97%B4%E8%B0%83%E7%94%A8feign%E4%B8%8E%E6%96%AD%E8%B7%AF%E5%99%A8hystrix\">1.2. æœåŠ¡é—´è°ƒç”¨Feignä¸æ–­è·¯å™¨Hystrix</a></li>\n<li><a href=\"#13-%E7%BD%91%E5%85%B3zuulgatyway\">1.3. ç½‘å…³Zuulã€gatyway</a></li>\n<li><a href=\"#14-%E5%88%86%E5%B8%83%E5%BC%8F%E9%85%8D%E7%BD%AEconsul\">1.4. åˆ†å¸ƒå¼é…ç½®consul</a></li>\n<li><a href=\"#15-%E8%B4%9F%E8%BD%BD%E5%9D%87%E8%A1%A1ribbon\">1.5. è´Ÿè½½å‡è¡¡Ribbon</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. springcloudå¸¸ç”¨ç»„ä»¶</h1>\n<h2>1.1. æœåŠ¡å‘ç°ä¸æ³¨å†ŒZooKeeperã€Eurekaã€consoul</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//åªéœ€è¦ä½¿ç”¨ @EnableEurekaServer æ³¨è§£å°±å¯ä»¥è®©åº”ç”¨å˜ä¸º Eureka Server\n@EnableEurekaServer\n@SpringBootApplication\npublic class EurekaApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(EurekaApplication.class, args);\n    }\n}\n\neureka:\n  instance:\n    hostname: localhost\n  client:\n    # eureka.client.fetch-registry: è¡¨ç¤ºæ˜¯å¦ä» Eureka Server è·å–æ³¨å†Œä¿¡æ¯ï¼Œé»˜è®¤ä¸ºtrueã€‚å¦‚æœè¿™æ˜¯ä¸€ä¸ªå•ç‚¹çš„ Eureka Serverï¼Œä¸éœ€è¦åŒæ­¥å…¶ä»–èŠ‚ç‚¹çš„æ•°æ®ï¼Œè®¾ä¸ºfalse\n    fetch-registry: false\n    # eureka.client.register-with-eureka: è¡¨ç¤ºæ˜¯å¦å°†è‡ªå·±æ³¨å†Œåˆ° Eureka Server, é»˜è®¤ä¸ºtrueã€‚ç”±äºå½“å‰åº”ç”¨å°±æ˜¯ Eureka Server, å› æ­¤è®¾ä¸º false\n    register-with-eureka: false\n    # è®¾ç½® Eureka Server æ‰€åœ¨çš„åœ°å€ï¼ŒæŸ¥è¯¢æœåŠ¡å’Œæ³¨å†ŒæœåŠ¡éƒ½éœ€è¦ä¾èµ–è¿™ä¸ªåœ°å€\n    service-url:\n      defaultZone: http://${eureka.instance.hostname}:${server.port}/eureka/\n\npom.xml\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-server&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><ul>\n<li>Eureka client</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//åªéœ€è¦ä½¿ç”¨ @EnableEurekaClient æ³¨è§£å°±å¯ä»¥è®©åº”ç”¨å˜ä¸º Eureka Client\n@EnableEurekaClient\n@SpringBootApplication\npublic class HomepageCourseApplication {\n    public static void main(String[] args) {\n        SpringApplication.run(HomepageCourseApplication.class, args);\n    }\n}\n\neureka:\n  client:\n    service-url:\n      defaultZone: http://localhost:8000/eureka/\n\npom.xml\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-eureka-client&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><ul>\n<li>æœåŠ¡æ³¨å†Œä¸å‘ç°consul</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é»˜è®¤ç«¯å£8500\nå¯åŠ¨å‘½ä»¤consul agent -client 0.0.0.0 -dev -config-dir=config-dev\nmysql.json\n{\n\t\"service\": \n\t{\n\t\t\"id\": \"mysql\",\n\t\t\"name\": \"mysql\",\n\t\t\"tags\": [\"mysql\"],\n\t\t\"address\": \"127.0.0.1\",\n\t\t\"port\": 3306,\n\t\t\"checks\": \n\t\t[\n\t\t\t{\n\t\t\t\t\"id\": \"mysql\",\n    \t\t\t\"name\": \"mysql\",\n    \t\t\t\"tcp\": \"127.0.0.1:3306\",\n    \t\t\t\"interval\": \"60s\",\n    \t\t\t\"timeout\": \"2s\"\n\t\t\t}\n\t\t]\n\t}\n}\n\njavaæ³¨å†Œ\n@EnableDiscoveryClient\n@RestController\n\nspring.cloud.consul.enabled=true\nspring.cloud.consul.host=localhost\nspring.cloud.consul.port=8500\nspring.cloud.consul.discovery.serviceName=xlsys-hscl-distributed-server\nspring.cloud.consul.discovery.tags=xlsys,xlsys-server,xlsys-hscl-distributed-server\nspring.cloud.consul.discovery.prefer-ip-address=true\nspring.cloud.consul.discovery.instance-id=server2\nspring.cloud.consul.discovery.healthCheckPath=/xlsys-check\nspring.cloud.consul.discovery.healthCheckInterval=2s\n</code></pre></div><h2>1.2. æœåŠ¡é—´è°ƒç”¨Feignä¸æ–­è·¯å™¨Hystrix</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@EnableFeignClients\n@EnableCircuitBreaker\n@EnableEurekaClient\n@SpringBootApplication\npublic class HomepageUserApplication {\n\n    public static void main(String[] args) {\n\n        SpringApplication.run(HomepageUserApplication.class, args);\n    }\n}\nä¸spring:application:name: eureka-client-homepage-courseå¯¹åº”CourseClientHystrixç†”æ–­é™çº§ç­–ç•¥\n@FeignClient(value = \"eureka-client-homepage-course\", fallback = CourseClientHystrix.class)\npublic interface CourseClient {\n\n    @RequestMapping(value = \"/homepage-course/get/course\", method = RequestMethod.GET)\n    CourseInfo getCourseInfo(Long id);\n\n    @RequestMapping(value = \"/homepage-course/get/courses\", method = RequestMethod.POST)\n    List&lt;CourseInfo&gt; getCourseInfos(@RequestBody CourseInfosRequest request);\n}\n\n@Component\npublic class CourseClientHystrix implements CourseClient {\n\n    @Override\n    public CourseInfo getCourseInfo(Long id) {\n        return CourseInfo.invalid();\n    }\n\n    @Override\n    public List&lt;CourseInfo&gt; getCourseInfos(CourseInfosRequest request) {\n        return Collections.emptyList();\n    }\n}\n\nfeign:\n  hystrix:\n    enabled: true\nhystrix.command.default.execution.isolation.thread.timeoutInMilliseconds=180000\n&lt;!-- å¼•å…¥ Feign, å¯ä»¥ä»¥å£°æ˜çš„æ–¹å¼è°ƒç”¨å¾®æœåŠ¡ --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;!-- å¼•å…¥æœåŠ¡å®¹é”™ Hystrix çš„ä¾èµ– --&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-hystrix&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><h2>1.3. ç½‘å…³Zuulã€gatyway</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//SpringCloudApplication = @SpringBootApplication + @EnableDiscoveryClient + @EnableCircuitBreaker\n@EnableZuulProxy\n@SpringCloudApplication\npublic class ZuulGatewayApplication {\n\n    public static void main(String[] args) {\n\n        SpringApplication.run(ZuulGatewayApplication.class, args);\n    }\n}\nserver:\n  port: 9000\n\nzuul:\n  prefix: /imooc\n  routes:\n    course:\n      path: /homepage-course/** ==&gt;server.servlet.context-path:/homepage-course\n      serviceId: eureka-client-homepage-course ==&gt;spring.application.name:eureka-client-homepage-course\n      strip-prefix: false\n    user:\n      path: /homepage-user/**\n      serviceId: eureka-client-homepage-user\n      strip-prefix: false\nè®¿é—®ç½‘å…³ï¼šhttp://ç½‘å…³æœåŠ¡ip:ç½‘å…³æœåŠ¡çš„ç«¯å£å·/imooc/....\nä¸è®¿é—®ç½‘å…³ï¼šhttp://æ™®é€šæœåŠ¡ip:æ™®é€šæœåŠ¡çš„ç«¯å£å·/....\n\npom.xml\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-netflix-zuul&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><ul>\n<li>ç½‘å…³gateway</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>spring.cloud.gateway.discovery.locator.enabled=true\nspring.cloud.gateway.discovery.locator.lower-case-service-id=true\nspring.cloud.gateway.httpclient.ssl.useInsecureTrustManager=true\nspring.cloud.gateway.httpclient.ssl.handshake-timeout-millis=10000\nspring.cloud.gateway.httpclient.ssl.close-notify-flush-timeout-millis=3000\nspring.cloud.gateway.httpclient.ssl.close-notify-read-timeout-millis=0\n</code></pre></div><h2>1.4. åˆ†å¸ƒå¼é…ç½®consul</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>spring.cloud.consul.config.enabled=true\nspring.cloud.consul.config.format=PROPERTIES\nspring.cloud.consul.config.prefix=config\nspring.cloud.consul.config.data-key=data\n\n@EnableFeignClients //å¯ç”¨OpenFeign\n\næœåŠ¡é—´è°ƒç”¨\n@FeignClient(\"server2\")\npublic interface OpenFeginDemo {\n    @GetMapping(\"/testserver2\")\n    public String test();\n}\n</code></pre></div><h2>1.5. è´Ÿè½½å‡è¡¡Ribbon</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ribbon.ConnectTimeout=30000\nribbon.ReadTimeout=60000\nribbon.SocketTimeout=60000\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "SpringCloudAlibaba",
      "url": "https://javaguide.cn/backend/j2ee/springcloudalibaba.html",
      "id": "https://javaguide.cn/backend/j2ee/springcloudalibaba.html",
      "summary": "åˆ©ç”¨Springå®˜æ–¹å‘å¯¼æ„å»ºSpring Cloud Alibaba idea->new Project->é€‰æ‹©springbootç‰ˆæœ¬->Web->Spring Web->create 1.pom.xmlåŠ å…¥ç‰ˆæœ¬å‚æ•°å’Œä¾èµ–ç®¡ç†å™¨å’Œnacos 2.application.properties newproject.pngnewproject.png n...",
      "content_html": "<!-- TOC -->\n<h1>åˆ©ç”¨Springå®˜æ–¹å‘å¯¼æ„å»ºSpring Cloud Alibaba</h1>\n<ul>\n<li>idea-&gt;new Project-&gt;é€‰æ‹©springbootç‰ˆæœ¬-&gt;Web-&gt;Spring Web-&gt;create</li>\n<li>1.pom.xmlåŠ å…¥ç‰ˆæœ¬å‚æ•°å’Œä¾èµ–ç®¡ç†å™¨å’Œnacos</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;properties&gt;\n    &lt;java.version&gt;17&lt;/java.version&gt;\n    &lt;!--1.åŠ å…¥ä¸‹é¢2ä¸ª--&gt;\n    &lt;spring-cloud.version&gt;2022.0.1&lt;/spring-cloud.version&gt;\n    &lt;spring-cloud-alibaba.version&gt;2022.0.0.0-RC1&lt;/spring-cloud-alibaba.version&gt;\n&lt;/properties&gt;\n\n&lt;dependencies&gt;\n  &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-web&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-starter-test&lt;/artifactId&gt;\n        &lt;scope&gt;test&lt;/scope&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;org.projectlombok&lt;/groupId&gt;\n        &lt;artifactId&gt;lombok&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;!--3.å¼•å…¥nacos--&gt;\n    &lt;dependency&gt;\n        &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-discovery&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n&lt;/dependencies&gt;\n\n&lt;dependencyManagement&gt;\n    &lt;dependencies&gt;\n        &lt;!--2.åŠ å…¥2ä¸ªä¾èµ–ç®¡ç†å™¨--&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-dependencies&lt;/artifactId&gt;\n            &lt;version&gt;${spring-cloud.version}&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n        &lt;dependency&gt;\n            &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n            &lt;artifactId&gt;spring-cloud-alibaba-dependencies&lt;/artifactId&gt;\n            &lt;version&gt;${spring-cloud-alibaba.version}&lt;/version&gt;\n            &lt;type&gt;pom&lt;/type&gt;\n            &lt;scope&gt;import&lt;/scope&gt;\n        &lt;/dependency&gt;\n    &lt;/dependencies&gt;\n&lt;/dependencyManagement&gt;\n</code></pre></div><ul>\n<li>2.application.properties</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\nserver.port=80\n# nacoså‚æ•°\nspring.application.name=first-microservice\nspring.cloud.nacos.discovery.username=nacos\nspring.cloud.nacos.discovery.password=nacos\nspring.cloud.nacos.discovery.server-addr=nacos:8848\nspring.cloud.nacos.discovery.namespace=public\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a05791cc2ebf7434eb2aa.jpg\" alt=\"newproject.png\" tabindex=\"0\"><figcaption>newproject.png</figcaption></figure>\n<h1>nacoså¿ƒè·³æœºåˆ¶</h1>\n<ul>\n<li>å¥åº·æ£€æŸ¥æœºåˆ¶ï¼šå®¢æˆ·ç«¯ä¸»åŠ¨ä¸ŠæŠ¥æˆ–è€…æœåŠ¡ç«¯ä¸»åŠ¨å‘å®¢æˆ·ç«¯æ¢æµ‹</li>\n<li>ä¸»æµçš„æ³¨å†Œä¸­å¿ƒï¼ŒåŒ…æ‹¬nacosçš„å¥åº·æ£€æŸ¥æœºåˆ¶ä¸»è¦éƒ½é‡‡ç”¨äº† TTLï¼ˆTime To Liveï¼‰æœºåˆ¶ï¼Œå³å®¢æˆ·ç«¯åœ¨â¼€å®šæ—¶é—´æ²¡æœ‰å‘æ³¨å†Œä¸­å¿ƒå‘é€å¿ƒè·³ï¼Œé‚£ä¹ˆæ³¨å†Œä¸­å¿ƒä¼šè®¤ä¸ºæ­¤æœåŠ¡ä¸å¥åº·ï¼Œè¿›è€Œè§¦å‘åç»­çš„å‰”é™¤é€»è¾‘</li>\n<li>Nacos æä¾›äº†ä¸¤ç§æœåŠ¡ç±»å‹ä¾›ç”¨æˆ·æ³¨å†Œå®ä¾‹æ—¶é€‰æ‹©ï¼Œå®ä¾‹åˆ†ä¸ºä¸´æ—¶å®ä¾‹å’Œæ°¸ä¹…å®ä¾‹ã€‚\n<ul>\n<li>ä¸´æ—¶å®ä¾‹åªæ˜¯ä¸´æ—¶å­˜åœ¨äºæ³¨å†Œä¸­å¿ƒä¸­ï¼Œä¼šåœ¨æœåŠ¡ä¸‹çº¿æˆ–ä¸å¯ç”¨æ—¶è¢«æ³¨å†Œä¸­å¿ƒå‰”é™¤ï¼Œ\n<ul>\n<li>OpenAPI è¿›è¡ŒæœåŠ¡æ³¨å†Œã€‚å®é™…æ˜¯ç”¨æˆ·æ ¹æ®è‡ªèº«éœ€æ±‚è°ƒç”¨ Http æ¥å£å¯¹æœåŠ¡è¿›è¡Œæ³¨å†Œï¼Œç„¶åé€šè¿‡ Http æ¥å£å‘é€å¿ƒè·³åˆ°æ³¨å†Œä¸­å¿ƒã€‚åœ¨æ³¨å†ŒæœåŠ¡çš„åŒæ—¶ä¼šæ³¨å†Œâ¼€ä¸ªå…¨å±€çš„å®¢æˆ·ç«¯å¿ƒè·³æ£€æµ‹çš„ä»»åŠ¡ã€‚åœ¨æœåŠ¡â¼€æ®µæ—¶é—´æ²¡æœ‰æ”¶åˆ°æ¥è‡ªå®¢æˆ·ç«¯çš„å¿ƒè·³åï¼Œè¯¥ä»»åŠ¡ä¼šå°†å…¶æ ‡è®°ä¸ºä¸å¥åº·ï¼Œå¦‚æœåœ¨é—´éš”çš„æ—¶é—´å†…è¿˜æœªæ”¶åˆ°å¿ƒè·³ï¼Œé‚£ä¹ˆè¯¥ä»»åŠ¡ä¼šå°†å…¶å‰”é™¤ã€‚</li>\n<li>SDK çš„æ³¨å†Œæ–¹å¼å®é™…æ˜¯é€šè¿‡ RPC ä¸æ³¨å†Œä¸­å¿ƒä¿æŒè¿æ¥ã€‚å®¢æˆ·ç«¯ä¼šå®šæ—¶çš„é€šè¿‡ RPC è¿æ¥å‘ Nacos æ³¨å†Œä¸­å¿ƒå‘é€å¿ƒè·³ï¼Œä¿æŒè¿æ¥çš„å­˜æ´»ã€‚å¦‚æœå®¢æˆ·ç«¯å’Œæ³¨å†Œä¸­å¿ƒçš„è¿æ¥æ–­å¼€ï¼Œé‚£ä¹ˆæ³¨å†Œä¸­å¿ƒä¼šä¸»åŠ¨å‰”é™¤è¯¥ client æ‰€æ³¨å†Œçš„æœåŠ¡ï¼Œè¾¾åˆ°ä¸‹çº¿çš„æ•ˆæœã€‚</li>\n</ul>\n</li>\n<li>æ°¸ä¹…å®ä¾‹å¥åº·æ£€æŸ¥æœºåˆ¶ï¼šæ°¸ä¹…å®ä¾‹æ°¸ä¸æé™¤ä½†æ˜¯ä¼šå¿ƒè·³å¤±è´¥ã€‚Nacos ä¸­ä½¿ç”¨ SDK å¯¹äºæ°¸ä¹…å®ä¾‹çš„æ³¨å†Œå®é™…ä¹Ÿæ˜¯ä½¿ç”¨ OpenAPI çš„æ–¹å¼è¿›è¡Œæ³¨å†Œï¼Œè¿™æ ·å¯ä»¥ä¿è¯å³ä½¿æ˜¯å®¢æˆ·ç«¯ä¸‹çº¿åä¹Ÿä¸ä¼šå½±å“æ°¸ä¹…å®ä¾‹çš„å¥åº·æ£€æŸ¥ã€‚Nacos é‡‡ç”¨çš„æ˜¯æ³¨å†Œä¸­å¿ƒæ¢æµ‹æœºåˆ¶ï¼Œæ³¨å†Œä¸­å¿ƒä¼šåœ¨æ°¸ä¹…æœåŠ¡åˆå§‹åŒ–æ—¶æ ¹æ®å®¢æˆ·ç«¯é€‰æ‹©çš„åè®®ç±»å‹æ³¨å†Œæ¢æ´»çš„å®šæ—¶ä»»åŠ¡ã€‚Nacos ç°åœ¨å†…ç½®æä¾›äº†ä¸‰ç§æ¢æµ‹çš„åè®®ï¼Œå³Httpã€TCP ä»¥åŠ MySQL ã€‚â¼€èˆ¬è€Œè¨€ Http å’Œ TCP å·²ç»å¯ä»¥æ¶µç›–ç»å¤§å¤šæ•°çš„å¥åº·æ£€æŸ¥åœºæ™¯ã€‚</li>\n</ul>\n</li>\n<li>å¯¹äºé›†ç¾¤ä¸‹çš„æœåŠ¡ï¼ŒNacos â¼€ä¸ªæœåŠ¡åªä¼šè¢« Nacos é›†ç¾¤ä¸­çš„â¼€ä¸ªæ³¨å†Œä¸­å¿ƒæ‰€è´Ÿè´£ï¼Œå…¶ä½™èŠ‚ç‚¹çš„æœåŠ¡ä¿¡æ¯åªæ˜¯é›†ç¾¤å‰¯æœ¬ï¼Œç”¨äºè®¢é˜…è€…åœ¨æŸ¥è¯¢æœåŠ¡åˆ—è¡¨æ—¶ï¼Œå§‹ç»ˆå¯ä»¥è·å–åˆ°å…¨éƒ¨çš„æœåŠ¡åˆ—è¡¨ã€‚ä¸´æ—¶å®ä¾‹åªä¼šå¯¹å…¶è¢«è´Ÿè´£çš„æ³¨å†Œä¸­å¿ƒèŠ‚ç‚¹å‘é€å¿ƒè·³ä¿¡æ¯ï¼Œæ³¨å†Œä¸­å¿ƒæœåŠ¡èŠ‚ç‚¹ä¼šå¯¹å…¶è´Ÿè´£çš„æ°¸ä¹…å®ä¾‹è¿›è¡Œå¥åº·æ¢æµ‹ï¼Œåœ¨è·å–åˆ°å¥åº·çŠ¶æ€åç”±å½“å‰è´Ÿè´£çš„æ³¨å†Œä¸­å¿ƒèŠ‚ç‚¹å°†å¥åº·ä¿¡æ¯åŒæ­¥åˆ°é›†ç¾¤ä¸­çš„å…¶ä»–çš„æ³¨å†Œä¸­å¿ƒã€‚</li>\n<li>åœ¨ Nacos ä¸­ï¼ŒæœåŠ¡çš„æ³¨å†Œæˆ‘ä»¬ä»æ³¨å†Œæ–¹å¼ç»´åº¦å®é™…å¯ä»¥åˆ†ä¸ºä¸¤å¤§ç±»ã€‚\n<ul>\n<li>SDK RPC è¿æ¥è¿›è¡Œæ³¨å†Œï¼Œå®¢æˆ·ç«¯ä¼šå’Œæ³¨å†Œä¸­å¿ƒä¿æŒé“¾æ¥ã€‚åªéœ€è¦å’Œæ³¨å†Œä¸­å¿ƒé›†ç¾¤ä¸­çš„ä»»æ„â¼€å°èŠ‚ç‚¹å»ºç«‹è”ç³»ï¼Œé‚£ä¹ˆç”±è¿™ä¸ªèŠ‚ç‚¹è´Ÿè´£è¿™ä¸ªå®¢æˆ·ç«¯å°±å¯ä»¥äº†ã€‚æ³¨å†Œä¸­å¿ƒä¼šåœ¨å¯åŠ¨æ—¶æ³¨å†Œâ¼€ä¸ªå…¨å±€çš„åŒæ­¥ä»»åŠ¡ï¼Œç”¨äºå°†å…¶å½“å‰è´Ÿè´£çš„æ‰€æœ‰èŠ‚ç‚¹ä¿¡æ¯åŒæ­¥åˆ°é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹ï¼Œå…¶ä»–éè´Ÿè´£çš„èŠ‚ç‚¹ä¹Ÿä¼šåˆ›å»ºè¯¥å®¢æˆ·ç«¯çš„ä¿¡æ¯ï¼Œåœ¨éè´Ÿè´£çš„èŠ‚ç‚¹ä¸Šï¼Œè¿æ¥ç±»å‹çš„å®¢æˆ·ç«¯ï¼Œä¼šæœ‰â¼€ä¸ªç»­çº¦æ—¶é—´çš„æ¦‚å¿µï¼Œåœ¨æ”¶åˆ°å…¶ä»–èŠ‚ç‚¹çš„åŒæ­¥ä¿¡æ¯æ—¶ï¼Œæ›´æ–°ç»­çº¦æ—¶é—´ä¸ºå½“å‰æ—¶é—´ï¼Œå¦‚æœåœ¨é›†ç¾¤ä¸­çš„å…¶ä»–èŠ‚ç‚¹åœ¨â¼€æ®µæ—¶é—´å†…æ²¡æœ‰æ”¶åˆ°ä¸æ˜¯è‡ªå·±çš„è´Ÿè´£çš„èŠ‚ç‚¹çš„åŒæ­¥ä¿¡æ¯ï¼Œé‚£ä¹ˆè®¤ä¸ºæ­¤èŠ‚ç‚¹å·²ç»ä¸å¥åº·ï¼Œä»è€Œè¾¾åˆ°å¯¹ä¸æ˜¯è‡ªå·±è´Ÿè´£çš„èŠ‚ç‚¹å¥åº·çŠ¶æ€æ£€æŸ¥ã€‚</li>\n<li>OpenAPI è¿›è¡Œ IP å’Œç«¯å£æ³¨å†Œã€‚OpenAPI æ³¨å†Œçš„ä¸´æ—¶å®ä¾‹ä¹Ÿæ˜¯é€šè¿‡åŒæ­¥è‡ªèº«è´Ÿè´£çš„èŠ‚ç‚¹åˆ°å…¶ä»–èŠ‚ç‚¹æ¥æ›´æ–°å…¶ä»–èŠ‚ç‚¹çš„å¯¹åº”çš„ä¸´æ—¶å®ä¾‹çš„å¿ƒè·³æ—¶é—´ï¼Œä¿è¯å…¶ä»–èŠ‚ç‚¹ä¸ä¼šåˆ é™¤æˆ–è€…ä¿®æ”¹æ­¤å®ä¾‹çš„å¥åº·çŠ¶æ€ã€‚å‰é¢æˆ‘ä»¬ç‰¹åˆ«æŒ‡æ˜äº†æ˜¯ä¸´æ—¶å®ä¾‹è€Œæ²¡æœ‰è¯´æ‰€æœ‰å®ä¾‹ï¼Œä½ åº”è¯¥ä¹Ÿå¯èƒ½ä¼šæƒ³åˆ°è¿™ç§æ–¹å¼å¯¹äºæŒä¹…åŒ–èŠ‚ç‚¹ä¼šæ˜¾å¾—å¤šä½™ï¼Œæ°¸ä¹…å®ä¾‹ä¼šåœ¨è¢«ä¸»åŠ¨åˆ é™¤å‰â¼€ç›´å­˜åœ¨äºæ³¨å†Œä¸­å¿ƒï¼Œé‚£ä¹ˆæˆ‘ä»¬å¥åº·æ£€æŸ¥å¹¶ä¸ä¼šå»åˆ é™¤å®ä¾‹ï¼Œæ‰€ä»¥æˆ‘ä»¬åªéœ€è¦åœ¨è´Ÿè´£çš„èŠ‚ç‚¹æ°¸ä¹…å®ä¾‹å¥åº·çŠ¶æ€å˜æ›´çš„æ—¶å€™é€šçŸ¥åˆ°å…¶ä½™çš„èŠ‚ç‚¹å³å¯ã€‚</li>\n</ul>\n</li>\n<li>æœ€åã€‚å¦‚æœä¸æ˜¯ç»™é›†ç¾¤ä¸­raftç®—æ³•èŠ‚ç‚¹çš„leaderå‘é€è¯·æ±‚ï¼Œåˆ™è¯¥èŠ‚ç‚¹ä¼šè½¬å‘åˆ°leaderå»ï¼Œleaderåˆ¤æ–­å®Œå†åŒæ­¥åˆ°å½“å‰èŠ‚ç‚¹</li>\n</ul>\n<h1>ä¸´æ—¶èŠ‚ç‚¹ä¸æ°¸ä¹…èŠ‚ç‚¹é…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># é»˜è®¤ä¸´æ—¶èŠ‚ç‚¹\n# å¼€å¯æŸ¥çœ‹å¿ƒè·³åŒ…æ—¥å¿—\nlogging.level.root=debug\n# ä¸´æ—¶èŠ‚ç‚¹åŸºäºå¿ƒè·³åŒ…å½¢å¼å‘Nacoså‘é€ï¼Œæ¯5ç§’å‘é€ä¸€æ¬¡\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\nlogging.level.root=debug\n# å¼€å¯æ°¸ä¹…èŠ‚ç‚¹\nspring.cloud.nacos.discovery.ephemeral=false\n# ä¸€å®šè¦é…ç½®è¿™ä¸ªipæ®µï¼Œå¦åˆ™nacosæœåŠ¡ç«¯å¯¹å®¢æˆ·ç«¯æ¢æµ‹å†å¤šç½‘å¡æƒ…å†µä¸‹ä¸çŸ¥é“å¯¹èµ°å“ªä¸ªç½‘å¡\nspring.cloud.inetutils.preferred-networks=192.168.31\n# æ°¸ä¹…èŠ‚ç‚¹æ¯ç§’ä¼šæ¥æ”¶åˆ°æ¥è‡ªNacosçš„æ¢æŸ¥\n</code></pre></div><h1>Raftç®—æ³•ä¸Distroç®—æ³•</h1>\n<p>Raftç®—æ³•ç”¨äºæœåŠ¡æ•°æ®æŒä¹…åŒ–ï¼Œä¿è¯ä¸€è‡´æ€§ï¼Œé¦–å…ˆä½é¢‘ï¼Œéœ€è¦å…³æ³¨æ‰€æœ‰èŠ‚ç‚¹æ•°æ®ä¸€è‡´æ€§<br>\nDistroç®—æ³•ç”¨äºæœåŠ¡æ³¨å†Œï¼Œå…³æ³¨æ€§èƒ½è€Œä¸å¤ªå…³æ³¨æ•°æ®åº“ï¼Œè€Œä¸”Raftç®—æ³•å¦‚æœ3ä¸ªèŠ‚ç‚¹æœ‰2ä¸ªæŒ‚äº†å°±æŒ‚äº†ï¼Œæ˜¾ç„¶ä¸åˆç†</p>\n<h1>å®¢æˆ·ç«¯è´Ÿè½½å‡è¡¡å™¨ä¸Spring Cloud Loadbalancer</h1>\n<ul>\n<li>Spring Cloud Loadbalancerä¸ç”¨å†™ipåªç”¨å†™æœåŠ¡å</li>\n<li>Spring Cloud Loadbalanceråˆå§‹åŒ–æ—¶å»æ³¨å†Œä¸­å¿ƒæŸ¥è¯¢å¯ç”¨æœåŠ¡åˆ—è¡¨å¹¶ä¿å­˜åˆ°å†…å­˜ï¼ŒæœåŠ¡ä¸Šä¸‹çº¿æ—¶æ³¨å†Œä¸­å¿ƒä¼šæ¨é€æ¶ˆæ¯Spring Cloud Loadbalancerå¹¶æ›´æ–°å¯ç”¨æœåŠ¡åˆ—è¡¨</li>\n</ul>\n<h1>OpenFeign</h1>\n<ul>\n<li>OpenFeignæ˜¯Spring Cloudé¡¹ç›®ä¸­çš„ä¸€ä¸ªæ¨¡å—ï¼Œå®ƒæ˜¯åŸºäºFeignå¼€å‘çš„ï¼Œå¯ä»¥çœ‹ä½œæ˜¯å¯¹Feignçš„è¿›ä¸€æ­¥å°è£…å’Œå¢å¼ºã€‚Feignæ˜¯ä¸€ä¸ªå£°æ˜å¼ã€æ¨¡æ¿åŒ–çš„HTTPå®¢æˆ·ç«¯ï¼Œå®ƒçš„ç›®æ ‡æ˜¯ç®€åŒ–HTTP APIå¼€å‘ã€‚OpenFeignåœ¨Feignçš„åŸºç¡€ä¸Šå¢åŠ äº†å¯¹Spring MVCæ³¨è§£ã€Spring Bootè‡ªåŠ¨é…ç½®ç­‰ç‰¹æ€§çš„æ”¯æŒï¼Œå¹¶ä¸”é›†æˆäº†Spring Cloudçš„æœåŠ¡å‘ç°å’Œè´Ÿè½½å‡è¡¡åŠŸèƒ½ã€‚ç›¸æ¯”äºFeignï¼ŒOpenFeignæ›´é€‚åˆåœ¨Spring Cloudå¾®æœåŠ¡æ¶æ„ä¸­ä½¿ç”¨ã€‚</li>\n<li>1.ä¾èµ–</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-cloud-starter-openfeign&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><ul>\n<li>2.configç±»å¢åŠ @EnableFeignClientsæ³¨è§£</li>\n<li>3.ä¸€ä¸ªåŸºäºSpring Cloudçš„Feignå®¢æˆ·ç«¯æ¥å£ã€‚å…¶ä¸­ï¼Œ@FeignClient(name = \"provider-service\")æ ‡æ³¨è¡¨ç¤ºè¯¥æ¥å£æ˜¯å¯¹åä¸º\"provider-service\"çš„æœåŠ¡è¿›è¡Œè°ƒç”¨ï¼Œè¿™ä¸ªæœåŠ¡åç§°é€šå¸¸æ˜¯åœ¨é…ç½®æ–‡ä»¶ä¸­æŒ‡å®šçš„ï¼Œç”¨äºå®ç°æœåŠ¡å‘ç°ã€‚<br>\næ¥å£ä¸­å®šä¹‰äº†ä¸‰ä¸ªæ–¹æ³•ï¼Œå®ƒä»¬å¯¹åº”ç€æœåŠ¡æä¾›è€…ä¸­çš„ä¸‰ä¸ªAPIæ¥å£ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package com.itlaoqi.consumerserviceopenfeign.feignclient;\n\nimport com.itlaoqi.consumerserviceopenfeign.dto.User;\nimport org.springframework.cloud.openfeign.FeignClient;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.PathVariable;\nimport org.springframework.web.bind.annotation.PostMapping;\nimport org.springframework.web.bind.annotation.RequestBody;\nimport org.springframework.web.bind.annotation.RequestParam;\n\nimport java.util.List;\nimport java.util.Map;\n\n@FeignClient(name = \"provider-service\")\npublic interface ProviderServiceFeignClient {\n\n    @GetMapping(\"/hello\")\n    Map&lt;String, Object&gt; sendMessage();\n\n    @PostMapping(\"/user/{uid}\")\n    User createUser(@PathVariable(\"uid\") String uid, @RequestBody User user);\n\n    @GetMapping(\"/list\")\n    List&lt;User&gt; query(@RequestParam(\"page\") int page, @RequestParam(\"rows\") int rows);\n}\n\n</code></pre></div><ul>\n<li>4.ä½¿ç”¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package com.itlaoqi.consumerserviceopenfeign.controller;\n\nimport com.itlaoqi.consumerserviceopenfeign.dto.User;\nimport com.itlaoqi.consumerserviceopenfeign.feignclient.ProviderServiceFeignClient;\nimport jakarta.annotation.Resource;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n\nimport java.util.List;\n\n@RestController\npublic class ConsumerController {\n    @Resource\n    private ProviderServiceFeignClient providerServiceFeignClient;\n    @GetMapping(\"/do1\")\n    public List doSth1(){\n        List&lt;User&gt; userList = providerServiceFeignClient.query(1, 10);\n        return userList;\n    }\n\n    @GetMapping(\"/do2\")\n    public User doSth2(){\n        String uid=\"10\";\n        User user = providerServiceFeignClient.createUser(uid, new User(uid, \"testUser\", \"testPassword\", \"testNickname\"));\n        return user;\n    }\n\n    @GetMapping(\"/do3\")\n    public String doSth3(){\n        String result = providerServiceFeignClient.hello();\n        return result;\n    }\n}\n\n</code></pre></div><h1>gateway</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>  &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-cloud-starter-loadbalancer&lt;/artifactId&gt;\n  &lt;/dependency&gt;\n\n  &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-cloud-starter-gateway&lt;/artifactId&gt;\n  &lt;/dependency&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>spring:\n  application:\n    name: gateway\n  cloud:\n    nacos:\n      discovery:\n        username: nacos\n        password: nacos\n        server-addr: nacos:8848\n    gateway:#è‡ªåŠ¨æ ¹æ®æœåŠ¡ååŒ¹é…\n      discovery:\n        locator:\n          enabled: true\nserver:\n  port: 80\n\n\n</code></pre></div><h1>gatewayè‡ªå®šä¹‰è°“è¯</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># TokenHeaderä¸ºè°“è¯å‰ç¼€ï¼ŒSpringcloudä¼šè‡ªåŠ¨å°†RoutePredicateFactoryåç¼€æ³¨å†Œä¸ºè°“è¯\npackage com.itlaoqi.gateway.predicate;\n\nimport org.springframework.cloud.gateway.handler.predicate.AbstractRoutePredicateFactory;\nimport org.springframework.http.HttpHeaders;\nimport org.springframework.stereotype.Component;\nimport org.springframework.web.server.ServerWebExchange;\n\nimport java.util.Arrays;\nimport java.util.List;\nimport java.util.Map;\nimport java.util.Set;\nimport java.util.function.Predicate;\n\n@Component\npublic class TokenHeaderRoutePredicateFactory extends AbstractRoutePredicateFactory&lt;TokenHeaderRoutePredicateFactory.Config&gt; {\n\n    public TokenHeaderRoutePredicateFactory() {\n        super(Config.class);\n    }\n\n    @Override\n    public Predicate&lt;ServerWebExchange&gt; apply(Config config) {\n        return exchange -&gt; {\n            Set&lt;Map.Entry&lt;String, List&lt;String&gt;&gt;&gt; headers = exchange.getRequest().getHeaders().entrySet();\n            for(Map.Entry me : headers){\n                if(me.getKey().equals(config.getHeaderName())){\n                    return true;\n                }\n            }\n            return false;\n        };\n    }\n\n    public static class Config {\n        private String headerName;\n\n        public String getHeaderName() {\n            return headerName;\n        }\n\n        public void setHeaderName(String headerName) {\n            this.headerName = headerName;\n        }\n    }\n\n    @Override\n    public List&lt;String&gt; shortcutFieldOrder() {\n        return Arrays.asList(\"headerName\");\n    }\n}\n\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>spring:\n    ...\n    gateway:\n      discovery:\n        locator:\n          enabled: false\n      routes:\n        - id: route_user_service \n          uri: lb://gateway-user-service\n          predicates:\n            - Path=/user/** \n            - TokenHeader=Token # è°“è¯å‰ç¼€ä¸è°“è¯åç§°\n          filters:\n            - StripPrefix=1\n</code></pre></div><h1>nacos config</h1>\n<p>grpcé•¿è¿æ¥ç›‘å¬</p>\n<div class=\"language-pom.xml\" data-ext=\"pom.xml\" data-title=\"pom.xml\"><pre class=\"language-pom.xml\"><code>&lt;!-- Nacosé…ç½®ä¸­å¿ƒstarter --&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;com.alibaba.cloud&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-cloud-starter-alibaba-nacos-config&lt;/artifactId&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n  &lt;groupId&gt;org.springframework.cloud&lt;/groupId&gt;\n  &lt;artifactId&gt;spring-cloud-starter-bootstrap&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><p>tax-service-dev.yaml</p>\n<div class=\"language-bootstrap.yml\" data-ext=\"bootstrap.yml\" data-title=\"bootstrap.yml\"><pre class=\"language-bootstrap.yml\"><code>spring:\n  application:\n    name: tax-service\n  profiles:\n    active: dev\n  cloud:\n    nacos:\n      config:\n        file-extension: yml\n        server-addr: 192.168.31.231:8848\n        username: nacos\n        password: nacos\nlogging:\n  level:\n    root: info\n\n</code></pre></div><p>@RefreshScope</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package com.itlaoqi.nacosconfig.config;\n\nimport lombok.Data;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.cloud.context.config.annotation.RefreshScope;\nimport org.springframework.context.annotation.Configuration;\n\n@Configuration\n@RefreshScope\n@Data\npublic class Setting {\n    @Value(\"${setting.upload-addr}\")\n    private String uploadAddr;\n    @Value(\"${setting.path}\")\n    private String path;\n}\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/a05791cc2ebf7434eb2aa.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "web",
      "url": "https://javaguide.cn/backend/j2ee/web.html",
      "id": "https://javaguide.cn/backend/j2ee/web.html",
      "summary": "web 1. WEBä¸‰å¤§è§„èŒƒ 2. javax.servlet.Servlet servlet 3. javax.servlet.http.HttpServlet 4. javax.servlet.ServletRequest 5. javax.servlet.http.HttpServletRequest 6. javax.servlet.Servl...",
      "content_html": "<p>web</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-web%E4%B8%89%E5%A4%A7%E8%A7%84%E8%8C%83\">1. WEBä¸‰å¤§è§„èŒƒ</a></li>\n<li><a href=\"#2-javaxservletservlet-servlet\">2. javax.servlet.Servlet servlet</a></li>\n<li><a href=\"#3-javaxservlethttphttpservlet\">3. javax.servlet.http.HttpServlet</a></li>\n<li><a href=\"#4-javaxservletservletrequest\">4. javax.servlet.ServletRequest</a></li>\n<li><a href=\"#5-javaxservlethttphttpservletrequest\">5. javax.servlet.http.HttpServletRequest</a></li>\n<li><a href=\"#6-javaxservletservletresponse\">6. javax.servlet.ServletResponse</a></li>\n<li><a href=\"#7-javaxservlethttphttpservletresponse\">7. javax.servlet.http.HttpServletResponse</a></li>\n<li><a href=\"#8-javaxservletservletcontext\">8. javax.servlet.ServletContext</a></li>\n<li><a href=\"#9-javaxservletservletconfig\">9. javax.servlet.ServletConfig</a></li>\n<li><a href=\"#10-javaxservlethttpcookie\">10. javax.servlet.http.Cookie</a></li>\n<li><a href=\"#11-javaxservlethttphttpsession\">11. javax.servlet.http.HttpSession</a></li>\n<li><a href=\"#12-javautileventlistener\">12. java.util.EventListener</a></li>\n<li><a href=\"#13-javaxservletservletcontextlistener\">13. javax.servlet.ServletContextListener</a></li>\n<li><a href=\"#14-javaxservlethttphttpsessionlistener\">14. javax.servlet.http.HttpSessionListener</a></li>\n<li><a href=\"#15-javaxservletservletrequestlistener\">15. javax.servlet.ServletRequestListener</a></li>\n<li><a href=\"#16-javaxservletservletcontextattributelistener\">16. javax.servlet.ServletContextAttributeListener</a></li>\n<li><a href=\"#17-javaxservlethttphttpsessionattributelistener\">17. javax.servlet.http.HttpSessionAttributeListener</a></li>\n<li><a href=\"#18-javaxservletservletrequestattributelistener\">18. javax.servlet.ServletRequestAttributeListener</a></li>\n<li><a href=\"#19-javaxservlethttphttpsessionbindinglistener\">19. javax.servlet.http.HttpSessionBindingListener</a></li>\n<li><a href=\"#20-javaxservlethttphttpsessionactivationlistener\">20. javax.servlet.http.HttpSessionActivationListener</a></li>\n<li><a href=\"#21-javaxservletfilter\">21. javax.servlet.Filter</a></li>\n<li><a href=\"#22-webxml%E9%85%8D%E7%BD%AE\">22. web.xmlé…ç½®</a></li>\n<li><a href=\"#23-%E6%96%87%E4%BB%B6%E4%B8%8B%E8%BD%BD\">23. æ–‡ä»¶ä¸‹è½½</a></li>\n<li><a href=\"#24-mail\">24. mail</a></li>\n<li><a href=\"#25-%E8%BD%AC%E5%8F%91%E4%B8%8E%E9%87%8D%E5%AE%9A%E5%90%91%E7%9A%84%E5%8C%BA%E5%88%AB\">25. è½¬å‘ä¸é‡å®šå‘çš„åŒºåˆ«</a></li>\n<li><a href=\"#26-javaee%E5%AF%B9%E8%B1%A1%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F\">26. javaeeå¯¹è±¡ç”Ÿå‘½å‘¨æœŸ</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. WEBä¸‰å¤§è§„èŒƒ</h1>\n<ul>\n<li>servletã€filterã€listener</li>\n<li>requestå®¢æˆ·ç«¯å‘é€çš„å‚æ•° åˆ°æœåŠ¡å™¨ç«¯éƒ½æ˜¯å­—ç¬¦ä¸²</li>\n</ul>\n<h1>2. javax.servlet.Servlet servlet</h1>\n<ul>\n<li>ç”¨äºè·å–è¯·æ±‚æ•°æ®ã€å¤„ç†è¯·æ±‚ã€å®Œæˆå“åº”</li>\n<li>ä½¿ç”¨servletå¯ä»¥å®ç°servletæ¥å£å¹¶é…ç½®web.xmlï¼Œä½†æ˜¯ä¸æ¨è</li>\n<li>init(ServletConfig config);//servletå¯¹è±¡åˆ›å»ºçš„æ—¶å€™æ‰§è¡ŒServletConfig:ä»£è¡¨çš„æ˜¯è¯¥servletå¯¹è±¡çš„é…ç½®ä¿¡æ¯</li>\n<li>service(ServletRequest request,ServletResponse response);//æ¯æ¬¡è¯·æ±‚éƒ½ä¼šæ‰§è¡Œ</li>\n<li>destroy();//servleté”€æ¯çš„æ—¶å€™æ‰§è¡Œ</li>\n</ul>\n<h1>3. javax.servlet.http.HttpServlet</h1>\n<ul>\n<li>ä½¿ç”¨servletå¯ä»¥ç»§æ‰¿HttpServletå¹¶å¤å†™HttpServletç±»çš„doGetã€doPostæ–¹æ³•å¹¶é…ç½®web.xml</li>\n<li>init();//servletå¯¹è±¡åˆ›å»ºçš„æ—¶å€™æ‰§è¡Œ</li>\n<li>doGet(HttpServletRequest request,HttpServletResponse response);//æ¯æ¬¡getè¯·æ±‚éƒ½ä¼šæ‰§è¡Œ</li>\n<li>doPost(HttpServletRequest request,HttpServletResponse response);//æ¯æ¬¡postè¯·æ±‚éƒ½ä¼šæ‰§è¡Œ</li>\n<li>destroy();//servleté”€æ¯çš„æ—¶å€™æ‰§è¡Œ</li>\n</ul>\n<h1>4. javax.servlet.ServletRequest</h1>\n<h1>5. javax.servlet.http.HttpServletRequest</h1>\n<ul>\n<li>è·å¾—è¯·æ±‚è¡Œ\n<ul>\n<li>String getContextPath()è·å¾—â€/â€œ+webåº”ç”¨åç§°,ä¾‹å¦‚/WEB15_request</li>\n<li>String getMethod()</li>\n<li>String getRequestURI()è·å¾—ç›¸å¯¹webåº”ç”¨åœ°å€/WEB15_request/line</li>\n<li>String getRequestURL()è·å¾—ç»å¯¹è·¯å¾„<a href=\"http://localhost:8080/WEB15_request/line\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:8080/WEB15_request/line</a></li>\n<li>String getRemoteAddr()è·å¾—è®¿é—®çš„å®¢æˆ·ç«¯IPåœ°å€</li>\n<li>String getQueryString()getæäº¤urlåœ°å€åçš„å‚æ•°å­—ç¬¦ä¸²username=lisi&amp;password=123</li>\n<li>String getProtocol();è·å–è¯·æ±‚è¡Œä¸­çš„åè®®åå’Œç‰ˆæœ¬</li>\n<li>String getServletPath();</li>\n<li>String getRemotePort();</li>\n<li>String getRemoteHost();</li>\n<li>String getLocalAddr();</li>\n<li>String getLocalName();</li>\n<li>String getLocalHost();</li>\n<li>int getLocalPort();</li>\n<li>String getServerName();</li>\n<li>int getServerPort();</li>\n<li>String getScheme();//è·å–è¯·æ±‚åè®®å</li>\n<li>StringBuffer getRequestURL();</li>\n</ul>\n</li>\n<li>è·å¾—è¯·æ±‚å¤´\n<ul>\n<li>String getHeaderï¼ˆString nameï¼‰</li>\n<li>Enumeration getHeaders(String name)</li>\n<li>Enumeration getHeaderNames()</li>\n<li>Long getDateHeader(String name)</li>\n<li>int getIntHeader(String name)</li>\n<li>String getContentType()</li>\n<li>int getContentLength()</li>\n<li>String getCharacterEncoding()</li>\n</ul>\n</li>\n<li>è·å¾—è¯·æ±‚ä½“\n<ul>\n<li>String getParameter(String name) å¤šä¸ªåªè·å¾—ä¸€ä¸ªï¼Œæ²¡æœ‰åˆ™è¿”å›null</li>\n<li>Map&lt;String,String[]&gt; getParameterMap()è·å¾—æŒ‡å®šå‚æ•°åå¯¹åº”çš„æ‰€æœ‰é”®å€¼</li>\n<li>String[] getParameterValues(String name)è·å¾—æŒ‡å®šå‚æ•°åå¯¹åº”çš„æ‰€æœ‰å€¼ï¼ˆå°‘ç”¨ï¼‰</li>\n<li>Enumeration getParameterNames()</li>\n</ul>\n</li>\n<li>ä¹±ç ï¼šæµè§ˆå™¨çš„ä¸­æ–‡ç”¨UTF-8ç¼–ç ï¼Œè€ŒHTTPåè®®ä½¿ç”¨iSO8859-1ç¼–ç ã€‚ä¸åŒçš„æµè§ˆå™¨æ¥æ”¶å’Œå‘é€æ•°æ®å–å†³äºæµè§ˆå™¨ç±»å‹ï¼Œé€šè¿‡Httpè¯·æ±‚ä½“ä¸­çš„User-Agentå±æ€§å¯ä»¥è¾¨åˆ«\n<ul>\n<li>postä¹±ç  request.setCharacterEncoding(\"UTF-8\");</li>\n<li>getä¹±ç  String parameter=new String(parameter.getbytes(\"iso8859-1\"),\"utf-8\");</li>\n</ul>\n</li>\n<li>è½¬å‘ request.getRequestDispatcher(â€/?â€).forward(req,resp);</li>\n<li>åŸŸå¯¹è±¡\n<ul>\n<li>Object setAttribute (String name, Object o)setæ³¨æ„åå­—ç›¸åŒæ—¶åˆ™è¦†ç›–</li>\n<li>String getAttribute(String name)</li>\n<li>void removeAttribute(String name)</li>\n</ul>\n</li>\n</ul>\n<h1>6. javax.servlet.ServletResponse</h1>\n<h1>7. javax.servlet.http.HttpServletResponse</h1>\n<ul>\n<li>è®¾ç½®å“åº”è¡Œ\n<ul>\n<li>void setStatus(int sc)</li>\n<li>void sendError(int sc,[String messge])</li>\n</ul>\n</li>\n<li>è®¾ç½®å“åº”å¤´(å€¼ä¸é‡å¤)\n<ul>\n<li>void addHeader(String name, String value)</li>\n<li>void setHeader(String name, String value);</li>\n</ul>\n</li>\n<li>è®¾ç½®å®šæ—¶åˆ·æ–°çš„å¤´:setHeader(\"refresh\", \"5;url=<a href=\"http://www.baidu.com\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.baidu.com</a>\");\n<ul>\n<li>void addIntHeader(String name, int value)</li>\n<li>void setIntHeader(String name, int value)</li>\n<li>void addDateHeader(String name, long date)</li>\n<li>void setDateHeader(String name, long date)</li>\n<li>void setContentLength(int len)</li>\n<li>void setContentType(String type)</li>\n<li>void setLocale(Locale loc)</li>\n<li>void setCharacterEncoding(String charset)</li>\n</ul>\n</li>\n<li>è®¾ç½®å“åº”ä½“\n<ul>\n<li>getWriter().write(\"\")å­—ç¬¦ä¸²ï¼Œå¯ä»¥æ’å…¥æ ‡ç­¾</li>\n<li>getOutputStream().write(byte[] bytes) å› ä¸ºgetWriter()ä¹‹å‰å·²è°ƒç”¨getOutputStream(),æ•…ä¸¤è€…ä¸èƒ½åŒæ—¶ä½¿ç”¨</li>\n<li>setHeader(\"content-Type\",\"text/html;charset=utf-8\");ä¸­æ–‡ä¹±ç </li>\n<li>sendRedirect(\"/WEB14/servlet2\");é‡å®šå‘</li>\n<li>setStatus(302);setHeader(\"Location\", \"/WEB14/servlet2\");</li>\n</ul>\n</li>\n</ul>\n<h1>8. javax.servlet.ServletContext</h1>\n<ul>\n<li>è·å¾—ServletContext\n<ul>\n<li>ServletConfig.getServletContext();</li>\n<li>this.getServletContext();ï¼ˆæ¨èï¼‰</li>\n</ul>\n</li>\n<li>è·å¾—web.xmlå…¨å±€çš„åˆå§‹åŒ–å‚æ•° getInitParameter(String name);</li>\n<li>åŸŸå¯¹è±¡(æ•´ä¸ªwebåº”ç”¨)\n<ul>\n<li>void setAtrribute(String name,Object obj);</li>\n<li>Object getAttribute(String name);</li>\n<li>void removeAttribute(String name);</li>\n</ul>\n</li>\n<li>WebContextç›®å½•å†…ä»»ä½•èµ„æºç»å¯¹è·¯å¾„\n<ul>\n<li>String getRealPath(String path);//:/WEB-INF/</li>\n<li>InputStream getResourceAsStream(String path); ä»¥/å¼€å¤´pathç›¸å¯¹WebContextç›®å½•InputStream</li>\n</ul>\n</li>\n</ul>\n<h1>9. javax.servlet.ServletConfig</h1>\n<ul>\n<li>è·å¾—è¯¥servletåœ¨web.xmlä¸Šçš„name String getServletName();</li>\n<li>è·å¾—è¯¥servletçš„åˆå§‹åŒ–çš„å‚æ•°\n<ul>\n<li>String getInitParameter(String name);</li>\n<li>Enumeration getInitParameterNames();</li>\n</ul>\n</li>\n<li>è·å¾—Servletcontextå¯¹è±¡ ServletContext getServletContext();</li>\n</ul>\n<h1>10. javax.servlet.http.Cookie</h1>\n<ul>\n<li>cookieä¼šä»¥å“åº”å¤´çš„å½¢å¼å‘é€ç»™å®¢æˆ·ç«¯ï¼šset-cookie:â€name=zhengsanâ€</li>\n<li>cookieä¸èƒ½å­˜å‚¨ä¸­æ–‡ã€å®ƒæ˜¯æµè§ˆå™¨ç¼“å­˜çš„ä¸€éƒ¨åˆ†ã€‚</li>\n<li>cookieæ•°æ®å­˜å‚¨åœ¨å®¢æˆ·ç«¯æœ¬åœ°ï¼Œå‡å°‘æœåŠ¡å™¨ç«¯çš„å­˜å‚¨çš„å‹åŠ›ï¼Œå®‰å…¨æ€§ä¸å¥½ï¼Œå®¢æˆ·ç«¯å¯ä»¥æ¸…é™¤cookie,æœ‰å¤§å°å’Œä¸ªæ•°çš„é™åˆ¶</li>\n<li>ä¼šè¯çº§åˆ«cookieï¼šä¸è®¾ç½®cookieä¼šå­˜å‚¨åœ¨æµè§ˆå™¨çš„å†…å­˜ä¸­ï¼Œéšæµè§ˆå™¨å…³é—­é”€æ¯</li>\n<li>æŒä¹…çº§åˆ«cookieï¼šè®¾ç½®cookieä¿¡æ¯ä¼šè¢«æŒä¹…åŒ–åˆ°æµè§ˆå™¨çš„ç£ç›˜æ–‡ä»¶é‡Œï¼Œè¿‡æœŸæµè§ˆå™¨è‡ªåŠ¨åˆ é™¤</li>\n<li>åˆ›å»ºCookieCookie cookie = new Cookie(name,value)</li>\n<li>æŒä¹…åŒ–æ—¶é—´cookie.setMaxAge(ç§’);</li>\n<li>è¯·æ±‚æ—¶cookieè¢«æºå¸¦è·¯å¾„\n<ul>\n<li>cookie.setPath();ä¸è®¾ç½®ï¼Œcookieä¿¡æ¯ä¼šåœ¨è®¿é—®äº§ç”Ÿè¯¥cookieçš„webèµ„æºæ‰€åœ¨çš„è·¯å¾„éƒ½æºå¸¦cookieä¿¡æ¯ï¼Œä¼šè¦†ç›–</li>\n<li>cookie.setPath(\"/WEB\");è®¿é—®WEBåº”ç”¨ä¸­çš„ä»»ä½•èµ„æºéƒ½æºå¸¦cookie</li>\n<li>cookie.setPath(\"/WEB/cookieServlet\");è®¿é—®WEB16ä¸­çš„cookieServletæ—¶æ‰æºå¸¦cookieä¿¡æ¯</li>\n<li>cookie.setPath(\"/\");ä»£è¡¨è®¿é—®tomcatä¸‹æ‰€æœ‰çš„webé¡¹ç›®çš„cookieä¿¡æ¯</li>\n</ul>\n</li>\n<li>å‘å®¢æˆ·ç«¯å‘é€cookie response.addCookie(Cookie cookie);//å¦‚æœè·¯å¾„å’Œåç§°ä¸€æ ·ï¼Œä¸¤æ¬¡addä¼šè¦†ç›–</li>\n<li>è·å¾—å®¢æˆ·ç«¯çš„cookie Cookie[] cookies = request.getCookies();</li>\n<li>è·å¾—cookieçš„é”®å€¼ cookie.getName();cookie.getValue();</li>\n<li>åˆ é™¤cookie\n<ul>\n<li>Cookie cookie = new Cookie(\"name\",\"\");//å°†cookieçš„nameè®¾ç½®ä¸åˆ é™¤çš„cookieä¸€è‡´</li>\n<li>cookie.setPath(\"/WEB16\");//å°†pathè®¾ç½®æˆä¸è¦åˆ é™¤cookieçš„pathä¸€è‡´</li>\n<li>cookie.setMaxAge(0);//è®¾ç½®æ—¶é—´æ˜¯0;</li>\n<li>response.addCookie(cookie);</li>\n</ul>\n</li>\n</ul>\n<h1>11. javax.servlet.http.HttpSession</h1>\n<ul>\n<li>sessionå°†æ•°æ®å­˜å‚¨åˆ°æœåŠ¡å™¨ç«¯ï¼Œå®‰å…¨æ€§ç›¸å¯¹å¥½ï¼Œå¢åŠ æœåŠ¡å™¨çš„å‹åŠ›ï¼Œæ²¡æœ‰å¤§å°å’Œä¸ªæ•°é™åˆ¶</li>\n<li>sessionä¼šä¸ºæ¯ä¸ªå®¢æˆ·ç«¯éƒ½åˆ›å»ºä¸€å—å†…å­˜ç©ºé—´å­˜å‚¨å®¢æˆ·çš„æ•°æ®,ä½†å®¢æˆ·ç«¯éœ€è¦æ¯æ¬¡éƒ½æºå¸¦ä¸€ä¸ªæ ‡è¯†IDå»æœåŠ¡å™¨ä¸­å¯»æ‰¾å±äºè‡ªå·±çš„å†…å­˜ç©ºé—´ã€‚</li>\n<li>æ‰€ä»¥è¯´Sessionçš„å®ç°æ˜¯åŸºäºCookieï¼ŒSessionéœ€è¦å€ŸåŠ©äºCookieå­˜å‚¨å®¢æˆ·çš„å”¯ä¸€æ€§æ ‡è¯†JSESSIONIDæ¥è¾¨åˆ«æ˜¯å“ªä¸ªå®¢æˆ·ç«¯</li>\n<li>è·å¾—Session request.getSession([boolean create])</li>\n<li>è·å¾—sessionid String getId()</li>\n<li>è®¾ç½®sessionç©ºé—²æ—¶é—´ void setMaxInactiveInterval(int interval)</li>\n<li>è·å¾—servletcontext ServletContext getServletContext()</li>\n<li>sessionåŸŸ\n<ul>\n<li>void setAttribute(String name,Object obj);</li>\n<li>Object getAttribute(String name);</li>\n<li>void removeAttribute(String name);</li>\n</ul>\n</li>\n<li>é”€æ¯session void invalidate();</li>\n</ul>\n<h1>12. java.util.EventListener</h1>\n<h1>13. javax.servlet.ServletContextListener</h1>\n<ul>\n<li>contextInitialized(ServlertContextEvent sre)</li>\n<li>contextDestroyed(ServlertContextEvent sre)</li>\n<li>ServletContext context = ServlertContextEvent.getServletContext();\n<ul>\n<li>â‘ åˆå§‹åŒ–ï¼šå¯¹è±¡ã€æ•°æ®ã€åŠ è½½æ•°æ®åº“é©±åŠ¨ï¼Œè¿æ¥æ± çš„åˆå§‹åŒ–</li>\n<li>â‘¡åŠ è½½ä¸€äº›åˆå§‹åŒ–çš„é…ç½®æ–‡ä»¶</li>\n</ul>\n</li>\n</ul>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "AbstractQueuedSynchronizer",
      "url": "https://javaguide.cn/backend/java/aqs.html",
      "id": "https://javaguide.cn/backend/java/aqs.html",
      "summary": "AbstractQueuedSynchronizer",
      "content_html": "<p>AbstractQueuedSynchronizer</p>\n<!-- more -->\n<h1>48. AQS çš„åŸç†æ˜¯ä»€ä¹ˆï¼Ÿå…±äº«æ¨¡å¼æœ‰å“ªäº›ï¼Ÿ</h1>\n<ul>\n<li>\n<p>AQSç”¨æ¥æ„å»ºé”å’ŒåŒæ­¥å™¨çš„æ¡†æ¶ï¼Œå¦‚ReentrantLockã€ReentrantReadWriteLockï¼ŒFutureTaskç­‰ç­‰çš†æ˜¯åŸºäºAQSçš„</p>\n</li>\n<li>\n<p>æ€æƒ³ï¼šå¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºç©ºé—²ï¼Œåˆ™å°†å½“å‰è¯·æ±‚èµ„æºçš„çº¿ç¨‹è®¾ç½®ä¸ºæœ‰æ•ˆçš„å·¥ä½œçº¿ç¨‹ï¼Œå¹¶ä¸”å°†å…±äº«èµ„æºè®¾ç½®ä¸ºé”å®šçŠ¶æ€ã€‚å¦‚æœè¢«è¯·æ±‚çš„å…±äº«èµ„æºè¢«å ç”¨ï¼Œé˜»å¡è¯¥çº¿ç¨‹ç„¶ååŠ å…¥åˆ°CLHé˜Ÿåˆ—ä¸­ç­‰å¾…è¢«å”¤é†’ã€‚AQSä½¿ç”¨ä¸€ä¸ªintæˆå‘˜å˜é‡(state) æ¥è¡¨ç¤ºåŒæ­¥çŠ¶æ€ï¼Œé€šè¿‡å†…ç½®çš„ FIFO é˜Ÿåˆ—æ¥å®Œæˆè·å–èµ„æºçº¿ç¨‹çš„æ’é˜Ÿå·¥ä½œã€‚ä½¿ç”¨ CAS å¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹ã€‚</p>\n</li>\n<li>\n<p>AQSèµ„æºå…±äº«æ–¹å¼</p>\n<ul>\n<li>Exclusiveï¼ˆç‹¬å ï¼‰ï¼šåªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½æ‰§è¡Œï¼Œå¦‚ReentrantLockã€‚åˆå¯åˆ†ä¸ºå…¬å¹³é”å’Œéå…¬å¹³é”</li>\n<li>Shareï¼ˆå…±äº«ï¼‰ï¼šå¤šä¸ªçº¿ç¨‹å¯åŒæ—¶æ‰§è¡Œï¼Œå¦‚Semaphoreã€CountDownLatchã€CyclicBarrierã€ReadWriteLock</li>\n</ul>\n</li>\n<li>\n<p>AQSçš„æ¨¡æ¿æ–¹æ³•è®¾è®¡æ¨¡å¼ï¼Œæ¨èå®šä¹‰ä¸ºé™æ€å†…éƒ¨ç±»å¹¶æŒ‰éœ€è¦é‡å†™ä¸‹é¢å‡ ä¸ªæ¨¡æ¿æ–¹æ³•ï¼›è¿™äº›æ–¹æ³•çš„å®ç°å¿…é¡»æ˜¯å†…éƒ¨çº¿ç¨‹å®‰å…¨çš„ï¼Œéé˜»å¡</p>\n<ul>\n<li>isHeldExclusively()//è¯¥çº¿ç¨‹æ˜¯å¦æ­£åœ¨ç‹¬å èµ„æºã€‚åªæœ‰ç”¨åˆ°conditionæ‰éœ€è¦å»å®ç°å®ƒ</li>\n<li>tryAcquire(int)//ç‹¬å æ–¹å¼ã€‚å°è¯•è·å–èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›false</li>\n<li>tryRelease(int)//ç‹¬å æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›false</li>\n<li>tryAcquireShared(int)//å…±äº«æ–¹å¼ã€‚å°è¯•è·å–èµ„æºã€‚è´Ÿæ•°è¡¨ç¤ºå¤±è´¥ï¼›0è¡¨ç¤ºæˆåŠŸï¼Œä½†æ²¡æœ‰å‰©ä½™å¯ç”¨èµ„æºï¼›æ­£æ•°è¡¨ç¤ºæˆåŠŸï¼Œä¸”æœ‰å‰©ä½™èµ„æº</li>\n<li>tryReleaseShared(int)//å…±äº«æ–¹å¼ã€‚å°è¯•é‡Šæ”¾èµ„æºï¼ŒæˆåŠŸåˆ™è¿”å›trueï¼Œå¤±è´¥åˆ™è¿”å›false</li>\n</ul>\n</li>\n<li>\n<p>åœ¨è·å–é”æ—¶ï¼ŒAQSç»´æŠ¤ä¸€ä¸ªåŒå‘åŒæ­¥é˜Ÿåˆ—ï¼Œè·å–é”å¤±è´¥çš„çº¿ç¨‹ä¼šåŠ å…¥åˆ°é˜Ÿåˆ—ä¸­è¿›è¡Œè‡ªæ—‹ç›´åˆ°è·å–é”é€€å‡ºï¼ŒæœŸé—´å¦‚æœå‰é©±èŠ‚ç‚¹è¢«æˆåŠŸè®¾ç½®ä¸ºsignalåˆ™é˜»å¡å½“å‰çº¿ç¨‹</p>\n</li>\n<li>\n<p>åœ¨é‡Šæ”¾é”æ—¶ï¼ŒAQSä¼šè°ƒç”¨unparkSuccessor()æ–¹æ³•å”¤é†’åç»§èŠ‚ç‚¹</p>\n</li>\n</ul>\n<h1>2. åŒæ­¥é˜Ÿåˆ—èŠ‚ç‚¹(åŒå‘é“¾è¡¨)</h1>\n<ul>\n<li>åŒæ­¥å™¨ä¾èµ–å†…éƒ¨çš„åŒæ­¥CLH(Craig,Landin,and Hagersten)é˜Ÿåˆ—ï¼ˆä¸€ä¸ªFIFOåŒå‘é˜Ÿåˆ—ï¼‰æ¥å®ŒæˆåŒæ­¥çŠ¶æ€çš„ç®¡ç†ï¼Œå°†æ¯æ¡è¯·æ±‚å…±äº«èµ„æºçš„çº¿ç¨‹å°è£…æˆä¸€ä¸ªCLHé”é˜Ÿåˆ—çš„ä¸€ä¸ªç»“ç‚¹ï¼ˆNodeï¼‰æ¥å®ç°é”çš„åˆ†é…ã€‚å½“å‰çº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€æˆåŠŸæ—¶ï¼Œå°†ä¼šè¢«è®¾ç½®ä¸ºåŒæ­¥é˜Ÿåˆ—é¦–èŠ‚ç‚¹ï¼Œç”±äºå·²ç»è·å–åŒæ­¥çŠ¶æ€æˆåŠŸï¼Œå› æ­¤è®¾ç½®å¤´èŠ‚ç‚¹çš„æ–¹æ³•å¹¶ä¸éœ€è¦ä½¿ç”¨CASæ¥ä¿è¯ï¼Œå®ƒåªéœ€è¦å°†é¦–èŠ‚ç‚¹è®¾ç½®æˆä¸ºåŸé¦–èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹å¹¶æ–­å¼€åŸé¦–èŠ‚ç‚¹çš„nextå¼•ç”¨å³å¯ã€‚è·å–åŒæ­¥çŠ¶æ€å¤±è´¥æ—¶ï¼ŒåŒæ­¥å™¨ä¼šå°†å½“å‰çº¿ç¨‹ä»¥åŠç­‰å¾…çŠ¶æ€ç­‰ä¿¡æ¯æ„é€ æˆä¸ºä¸€ä¸ªèŠ‚ç‚¹ï¼ˆNodeï¼‰å¹¶å°†å…¶åŠ å…¥åŒæ­¥é˜Ÿåˆ—å°¾éƒ¨ï¼ŒåŒæ—¶ä¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼ŒåŠ å…¥é˜Ÿåˆ—çš„è¿‡ç¨‹å¿…é¡»è¦ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œå› æ­¤åŒæ­¥å™¨æä¾›äº†ä¸€ä¸ªåŸºäºCASçš„è®¾ç½®å°¾èŠ‚ç‚¹çš„æ–¹æ³•ï¼šcompareAndSetTail(Node expect,Node update)ï¼Œå®ƒéœ€è¦ä¼ é€’å½“å‰çº¿ç¨‹â€œè®¤ä¸ºâ€çš„å°¾èŠ‚ç‚¹å’Œå½“å‰èŠ‚ç‚¹ï¼Œåªæœ‰è®¾ç½®æˆåŠŸåï¼Œå½“å‰èŠ‚ç‚¹æ‰æ­£å¼ä¸ä¹‹å‰çš„å°¾èŠ‚ç‚¹å»ºç«‹å…³è”ã€‚å½“åŒæ­¥çŠ¶æ€é‡Šæ”¾æ—¶ï¼Œä¼šæŠŠç­‰å¾…é˜Ÿåˆ—ä¸­åç»§èŠ‚ç‚¹çº¿ç¨‹å”¤é†’ï¼Œä½¿å…¶å†æ¬¡å°è¯•è·å–åŒæ­¥çŠ¶æ€ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e9915cfd1e0090d670830.jpg\" alt=\"åŒæ­¥é˜Ÿåˆ—çš„åŸºæœ¬ç»“æ„.png\"></li>\n<li>åŒæ­¥é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹ï¼ˆNodeï¼‰ç”¨æ¥ä¿å­˜è·å–åŒæ­¥çŠ¶æ€å¤±è´¥çš„çº¿ç¨‹å¼•ç”¨ã€ç­‰å¾…çŠ¶æ€ä»¥åŠå‰é©±å’Œåç»§èŠ‚ç‚¹</li>\n<li>åŒæ­¥çŠ¶æ€çš„ç®¡ç†volatile int stateï¼Œé€šè¿‡getStateï¼ŒsetStateï¼ŒcompareAndSetStateä½¿ç”¨CASå¯¹è¯¥åŒæ­¥çŠ¶æ€è¿›è¡ŒåŸå­æ“ä½œå®ç°å¯¹å…¶å€¼çš„ä¿®æ”¹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public abstract class AbstractQueuedSynchronizer extends AbstractOwnableSynchronizer implements java.io.Serializable{\n\n    static final class Node {\n        static final Node SHARED = new Node();//èŠ‚ç‚¹åœ¨å…±äº«æ¨¡å¼ä¸­ç­‰å¾…\n        static final Node EXCLUSIVE = null;//èŠ‚ç‚¹åœ¨ç‹¬äº«æ¨¡å¼ç­‰å¾…\n\n        static final int CANCELLED =  1;//å½“å‰èŠ‚ç‚¹çš„çº¿ç¨‹è¢«å–æ¶ˆï¼ˆå½“å‰çº¿ç¨‹åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­ç­‰å¾…è¶…æ—¶æˆ–è€…è¢«ä¸­æ–­ï¼‰èŠ‚ç‚¹è¿›å…¥è¯¥çŠ¶æ€å°†ä¸ä¼šå˜åŒ–ï¼Œçº¿ç¨‹ä¹Ÿä¸ä¼šå†é˜»å¡/ç­‰å¾…\n        static final int SIGNAL    = -1;//å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹å¤„äºé˜»å¡/ç­‰å¾…çŠ¶æ€ï¼Œå½“å‰èŠ‚ç‚¹å¿…é¡»åœ¨é‡Šæ”¾æˆ–è€…è¢«å–æ¶ˆæ—¶é€šè¿‡signalæ–¹æ³•å”¤é†’åç»­èŠ‚ç‚¹ï¼Œè·å¾—é”çš„æ–¹æ³•acquireåœ¨signalæ–¹æ³•åè°ƒç”¨ï¼Œä¸ºäº†é¿å…ç«äº‰ï¼Œå¿…é¡»é‡è¯•åŸå­è·å–é”ï¼Œå¤±è´¥åˆ™é˜»å¡\n        static final int CONDITION = -2;//å½“å‰èŠ‚ç‚¹åœ¨ç­‰å¾…Conditionç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…è¢«å”¤é†’\n        static final int PROPAGATE = -3;//è¡¨ç¤ºä¸‹ä¸€æ¬¡å…±äº«å¼åŒæ­¥çŠ¶æ€è·å–å°†ä¼šæ— æ¡ä»¶ä¼ æ’­ä¸‹å» \n        volatile int waitStatus;//compareAndSetWaitStatus//åŒæ­¥é˜Ÿåˆ—çš„ç­‰å¾…çŠ¶æ€é»˜è®¤0;\n\n        volatile Node prev;//predecessor å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ å½“èŠ‚ç‚¹åŠ å…¥åŒæ­¥é˜Ÿåˆ—æ—¶è¢«è®¾ç½®(å°¾éƒ¨æ·»åŠ )\n        volatile Node next;//successor å½“å‰èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹\n        volatile Thread thread;//åŠ å…¥åŒæ­¥é˜Ÿåˆ—çš„çº¿ç¨‹å¼•ç”¨\n        Node nextWaiter;//æŒ‡å‘æ¡ä»¶ç­‰å¾…çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œæˆ–è€…ç‰¹å®šçš„åˆ†äº«èŠ‚ç‚¹SHAREDï¼ŒèŠ‚ç‚¹ç±»å‹(ç‹¬å å’Œå…±äº«)å’Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„åç»§èŠ‚ç‚¹å…±ç”¨åŒä¸€ä¸ªå­—æ®µ\n\n        final boolean isShared() {//åˆ¤æ–­å½“å‰èŠ‚ç‚¹æ˜¯ä¸æ˜¯åœ¨å…±äº«æ¨¡å¼ä¸­ç­‰å¾…\n            return nextWaiter == SHARED;\n        }\n\n        final Node predecessor() throws NullPointerException {\n            Node p = prev;\n            if (p == null)\n                throw new NullPointerException();\n            else\n                return p;\n        }\n\n        Node() {}    // Used to establish initial head or SHARED marker\n    \n        Node(Thread thread, Node mode) {     // Used by addWaiter\n            this.nextWaiter = mode;\n            this.thread = thread;\n        }\n\n        Node(Thread thread, int waitStatus) { // Used by Condition\n            this.waitStatus = waitStatus;\n            this.thread = thread;\n        }\n    }\n\n    private transient volatile Node head;//compareAndSetHead\n    private transient volatile Node tail;//compareAndSetTail\n\n    private volatile int state;//set/get/compareAndSetState\n\n}\n</code></pre></div><h1>3. ç‹¬å é”çš„è·å–acquire(int arg)å’Œé‡Šæ”¾release(int arg)</h1>\n<ul>\n<li>é€šè¿‡è°ƒç”¨åŒæ­¥å™¨çš„acquire(int arg)æ–¹æ³•å¯ä»¥è·å–åŒæ­¥çŠ¶æ€ï¼Œè¯¥æ–¹æ³•å¯¹ä¸­æ–­ä¸æ•æ„Ÿï¼Œä¹Ÿå°±æ˜¯ç”±äºçº¿ç¨‹è·å–åŒæ­¥çŠ¶æ€å¤±è´¥åè¿›å…¥åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œåç»­å¯¹çº¿ç¨‹è¿›è¡Œä¸­æ–­æ“ä½œæ—¶ï¼Œçº¿ç¨‹ä¸ä¼šä»åŒæ­¥é˜Ÿåˆ—ä¸­ç§»å‡ºï¼Œ<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3587c268ff7987d7194c7.jpg\" alt=\"èŠ‚ç‚¹è‡ªæ—‹è·å–åŒæ­¥çŠ¶æ€.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0dea4caed6f09b4eb4cad.jpg\" alt=\"ç‹¬å å¼åŒæ­¥çŠ¶æ€è·å–æµç¨‹.png\"></li>\n<li>ç‹¬å å¼åŒæ­¥çŠ¶æ€è·å–å’Œé‡Šæ”¾è¿‡ç¨‹æ€»ç»“ï¼šåœ¨è·å–åŒæ­¥çŠ¶æ€æ—¶ï¼ŒåŒæ­¥å™¨ç»´æŠ¤ä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—ï¼Œè·å–çŠ¶æ€å¤±è´¥çš„çº¿ç¨‹éƒ½ä¼šè¢«åŠ å…¥åˆ°é˜Ÿåˆ—ä¸­å¹¶åœ¨é˜Ÿåˆ—ä¸­è¿›è¡Œè‡ªæ—‹ï¼›ç§»å‡ºé˜Ÿåˆ—ï¼ˆæˆ–åœæ­¢è‡ªæ—‹ï¼‰çš„æ¡ä»¶æ˜¯å‰é©±èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹ä¸”æˆåŠŸè·å–äº†åŒæ­¥çŠ¶æ€ã€‚åœ¨é‡Šæ”¾åŒæ­¥çŠ¶æ€æ—¶ï¼ŒåŒæ­¥å™¨è°ƒç”¨tryRelease(int arg)æ–¹æ³•é‡Šæ”¾åŒæ­¥çŠ¶æ€ï¼Œç„¶åå”¤é†’å¤´èŠ‚ç‚¹çš„åç»§èŠ‚ç‚¹ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /*\n    * ç‹¬å é”çš„è·å–\n    *    å°è¯•è·å–é”ï¼Œå¤±è´¥åˆ™è‡ªæ—‹åŠ å…¥åŒæ­¥é˜Ÿåˆ—é˜Ÿå°¾ç›´åˆ°æˆåŠŸä¸ºæ­¢\n    *    ç„¶åè‡ªæ—‹å°è¯•è·å–é”è¿”å›ä¸­æ–­çŠ¶æ€å¹¶é€€å‡ºï¼ŒæœŸé—´å¦‚æœå°†å‰é©±èŠ‚ç‚¹çŠ¶æ€æˆåŠŸè®¾ç½®ä¸ºsignalåæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œè¢«å”¤é†’ååˆ¤æ–­ä¸­æ–­çŠ¶æ€åœ¨è·å–é”åè¿”å›\n    * 1 è°ƒç”¨tryAcquireè‡ªå®šä¹‰åŒæ­¥å™¨å®ç°çš„å­ç±»æ–¹æ³•ï¼Œéœ€è¦ä¿è¯çº¿ç¨‹å®‰å…¨åœ°è·å–é”ï¼ŒæˆåŠŸåˆ™è¿”å›ï¼Œå¤±è´¥æ‰§è¡Œ2\n    * 2 è°ƒç”¨addWaiter()å°†å½“å‰çº¿ç¨‹æ„é€ æˆç‹¬äº«ç±»å‹çš„NodeåŠ å…¥é˜Ÿåˆ—ï¼Œå¹¶è¿”å›æ„é€ çš„èŠ‚ç‚¹Nodeï¼Œç»§ç»­æ‰§è¡Œ3\n    * 3 è°ƒç”¨acquireQueued()æ— é™å¾ªç¯å°è¯•è·å–é”ï¼ŒæˆåŠŸåˆ™è¿”å›ä¸­æ–­çŠ¶æ€ï¼Œå¤±è´¥åˆ™å°†Nodeçš„å‰é©±èŠ‚ç‚¹ç½®ä¸ºSginalåæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œè¢«å”¤é†’ååˆ¤æ–­å½“å‰çº¿ç¨‹çš„ä¸­æ–­çŠ¶æ€åœ¨æˆåŠŸè·å–é”åè¿”å›\n    * 4 acquireQueued()è¿”å›trueæ—¶ï¼Œä¸­æ–­ï¼ˆåœæ­¢ï¼‰å½“å‰çº¿ç¨‹Thread.currentThread().interrupt()\n    */\n    public final void acquire(int arg) {\n        if (!tryAcquire(arg)//1\n            &amp;&amp; acquireQueued( //3\n                addWaiter(Node.EXCLUSIVE),//2\n            arg))\n        selfInterrupt();//4\n    }\n\n    /*\n    * æ ¹æ®å½“å‰çº¿ç¨‹å’Œmodeæ„é€ NodeåŠ å…¥åŒæ­¥é˜Ÿåˆ—å°¾éƒ¨ï¼Œå¹¶è¿”å›æ„é€ çš„èŠ‚ç‚¹Node\n    * 2.1 æ ¹æ®å½“å‰çº¿ç¨‹å’Œmodeæ„é€ ç‹¬å æ¨¡å¼çš„èŠ‚ç‚¹Node\n    * 2.2 è‹¥tailèŠ‚ç‚¹ä¸ä¸ºnullåˆ™ä½¿ç”¨CASæ“ä½œcompareAndSetTailå°†NodeåŠ å…¥åˆ°é˜Ÿå°¾ï¼›å¿«é€Ÿå…¥é˜ŸæˆåŠŸåˆ™è¿”å›nodeï¼Œå¤±è´¥åˆ™æ‰§è¡Œ3\n    * 2.3 è°ƒç”¨enq()æ— é™å¾ªç¯åˆå§‹åŒ–é˜Ÿå¤´ç©ºèŠ‚ç‚¹æˆ–è€…ä½¿ç”¨CASæ“ä½œç›´åˆ°compareAndSetTailå°†NodeåŠ å…¥åˆ°é˜Ÿå°¾ä¸­(è‡ªæ—‹)\n    *    2.3.1 å¦‚æœtailä¸ºnullï¼Œæ„é€ æ–°çš„ç©ºèŠ‚ç‚¹ï¼Œå¹¶å°†å…¶è®¾ç½®ä¸ºé˜Ÿåˆ—çš„Headï¼Œæ­¤æ—¶head=tail=new Node();\n    *    2.3.2 å¦‚æœtailä¸ä¸ºnullï¼Œä½¿ç”¨CASæ“ä½œcompareAndSetTailå°†NodeåŠ å…¥åˆ°é˜Ÿå°¾(è·Ÿ2ä¸€æ ·)\n    */\n    private Node addWaiter(Node mode) {\n        Node node = new Node(Thread.currentThread(), mode);//2.1\n        Node pred = tail;\n        if (pred != null) {//2.2\n            node.prev = pred;\n            /**\n             * åŸºäºCASå°†nodeè®¾ç½®ä¸ºå°¾èŠ‚ç‚¹ï¼Œå¦‚æœè®¾ç½®å¤±è´¥ï¼Œè¯´æ˜åœ¨å½“å‰çº¿ç¨‹è·å–å°¾èŠ‚ç‚¹åˆ°ç°åœ¨è¿™æ®µè¿‡ç¨‹ä¸­å·²ç»æœ‰å…¶ä»–çº¿ç¨‹å°†å°¾èŠ‚ç‚¹ç»™æ›¿æ¢è¿‡äº†ï¼Œç¡®ä¿èŠ‚ç‚¹èƒ½å¤Ÿè¢«çº¿ç¨‹å®‰å…¨æ·»åŠ \n             * å‡è®¾æœ‰é“¾è¡¨node1--&gt;node2--&gt;predï¼ˆå½“ç„¶æ˜¯åŒé“¾è¡¨ï¼Œè¿™é‡Œç”»æˆåŒé“¾è¡¨æ‰åˆé€‚ï¼‰,\n             * é€šè¿‡CASå°†predæ›¿æ¢æˆäº†nodeèŠ‚ç‚¹ï¼Œå³å½“ä¸‹çš„é“¾è¡¨ä¸ºnode1--&gt;node2--&gt;node,\n             * ç„¶åæ ¹æ®ä¸Šè¾¹çš„\"node.prev = pred\"ä¸ä¸‹è¾¹çš„\"pred.next = node\"å°†predæ’å…¥åˆ°åŒé“¾è¡¨ä¸­å»ï¼Œç»„æˆæœ€ç»ˆçš„é“¾è¡¨å¦‚ä¸‹ï¼š\n             * node1--&gt;node2--&gt;pred--&gt;node\n             * è¿™æ ·çš„è¯ï¼Œå®é™…ä¸Šæˆ‘ä»¬å‘ç°æ²¡æœ‰æŒ‡å®šnode2.next=predä¸pred.prev=node2ï¼Œè¿™æ˜¯ä¸ºä»€ä¹ˆå‘¢ï¼Ÿ\n             * å› ä¸ºåœ¨ä¹‹å‰è¿™ä¸¤å¥å°±æ—©å°±æ‰§è¡Œå¥½äº†ï¼Œå³node2.nextå’Œpred.prevè¿™ä¸¤ä¸ªå±æ€§ä¹‹å‰å°±è®¾ç½®å¥½äº†\n             */\n            if (compareAndSetTail(pred, node)) {\n                pred.next = node;\n                return node;\n            }\n        }\n        enq(node);//2.3\n        return node;\n    }\n    //åŒæ­¥å™¨é€šè¿‡â€œæ­»å¾ªç¯â€æ¥ä¿è¯èŠ‚ç‚¹çš„æ­£ç¡®æ·»åŠ ï¼Œåªæœ‰é€šè¿‡CASå°†èŠ‚ç‚¹è®¾ç½®æˆä¸ºå°¾èŠ‚ç‚¹ä¹‹åï¼Œå½“å‰çº¿ç¨‹æ‰èƒ½ä»è¯¥æ–¹æ³•è¿”å›ï¼Œå¦åˆ™ï¼Œå½“å‰çº¿ç¨‹ä¸æ–­åœ°å°è¯•è®¾ç½®ã€‚enq(final Node node)æ–¹æ³•å°†å¹¶å‘æ·»åŠ èŠ‚ç‚¹çš„è¯·æ±‚é€šè¿‡CASå˜å¾—â€œä¸²è¡ŒåŒ–â€äº†ã€‚\n    private Node enq(final Node node) {//2.3\n        for (;;) {//2.3\n            Node t = tail;\n            if (t == null) { //2.3.1\n                /*\n                * åŸºäºCASå°†æ–°èŠ‚ç‚¹ï¼ˆdummyèŠ‚ç‚¹ï¼‰è®¾ç½®åˆ°å¤´ä¸Šheadå»ï¼Œå¦‚æœè®¾ç½®å¤±è´¥ï¼Œåˆ™è¯´æ˜ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­ï¼Œå·²ç»æœ‰å…¶ä»–çº¿ç¨‹è®¾ç½®è¿‡äº†\n                * å¦‚æœè®¾ç½®æˆåŠŸåˆ™head=tail=new Node()ï¼Œä¹‹åæœ‰æ–°èŠ‚ç‚¹å…¥é˜Ÿçš„è¯ï¼Œå°±æ’å…¥åˆ°è¯¥dummyä¹‹å\n                */\n                if (compareAndSetHead(new Node()))//ç©ºç™½çš„èŠ‚ç‚¹ç”¨æ¥æ–°å»ºæ–°çš„èŠ‚ç‚¹\n                    tail = head;\n            } else {//3.2\n                node.prev = t;\n                if (compareAndSetTail(t, node)) {\n                    t.next = node;\n                    return t;\n                }\n            }\n        }\n    }\n    /* \n    * èŠ‚ç‚¹è¿›å…¥åŒæ­¥é˜Ÿåˆ—åæ— é™å¾ªç¯(è‡ªæ—‹)ç›´è‡³è·å–é”é€€å‡ºï¼Œå¦‚æœè·å–ä¸åˆ°åˆ™é˜»å¡ï¼Œè€Œè¢«é˜»å¡çº¿ç¨‹çš„å”¤é†’ä¸»è¦ä¾é å‰é©±èŠ‚ç‚¹çš„å‡ºé˜Ÿæˆ–é˜»å¡çº¿ç¨‹è¢«ä¸­æ–­æ¥å®ç°ã€‚å¦‚æœå°†Nodeçš„å‰ç½®èŠ‚ç‚¹ç½®ä¸ºSginalæˆåŠŸåæŒ‚èµ·å½“å‰çº¿ç¨‹ï¼Œçº¿ç¨‹è¢«å”¤é†’ååˆ¤æ–­ä¸­æ–­çŠ¶æ€\n    * 1 æ— é™å¾ªç¯\n    * 2 åŒæ­¥é˜Ÿåˆ—è·å¾—é”çš„æ¡ä»¶ï¼šå¦‚æœå½“å‰é©±èŠ‚ç‚¹ä¸ºHeadèŠ‚ç‚¹(ä¿è¯FIFOå’Œå‰é©±èŠ‚ç‚¹ä¸æ˜¯å¤´èŠ‚ç‚¹çš„çº¿ç¨‹ç”±äºä¸­æ–­è€Œè¢«å”¤é†’æƒ…å†µ)å¹¶ä¸”è·å–é”æˆåŠŸ(æ³¨æ„å¼‚å¸¸)ï¼Œå°†Nodeè®¾ç½®ä¸ºå¤´èŠ‚ç‚¹å¹¶è¿”å›æ˜¯å¦ä¸­æ–­çš„ç»“æœé€€å‡ºå¾ªç¯ï¼Œå¦åˆ™æ‰§è¡Œ3\n    * 3 è°ƒç”¨shouldParkAfterFailedAcquire()å»æ‰åœ¨é˜Ÿåˆ—ä¸­å‰é©±èŠ‚ç‚¹çš„CANCELLEDçŠ¶æ€çš„èŠ‚ç‚¹ï¼Œå€ŸåŠ©æ— é™å¾ªç¯å°†å‰é©±èŠ‚ç‚¹çŠ¶æ€é€šè¿‡CASæ“ä½œè®¾ç½®ä¸ºSIGNALï¼ŒæˆåŠŸåˆ™æ‰§è¡Œ4\n    * 4 è°ƒç”¨parkAndCheckInterrupt()æŒ‚èµ·å½“å‰èŠ‚ç‚¹æ‰€åœ¨çš„çº¿ç¨‹å¹¶åœ¨è¢«å”¤é†’ååˆ¤æ–­çº¿ç¨‹ä¸­æ–­çŠ¶æ€\n    * 5 finallyè°ƒç”¨cancelAcquire(node)å°†nodeä»é˜Ÿåˆ—ä¸­å»æ‰æˆ–è€…å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹åˆ™å”¤é†’åç½®èŠ‚ç‚¹\n    */\n    final boolean acquireQueued(final Node node, int arg) {\n        boolean failed = true;\n        try {\n            boolean interrupted = false;\n            for (;;) {//1\n                final Node p = node.predecessor();\n                if (p == head &amp;&amp; tryAcquire(arg)) {//2\n                    setHead(node);\n                    p.next = null; // help GC\n                    failed = false;\n                    return interrupted;\n                }\n                if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; //3\n                    parkAndCheckInterrupt())//4\n                    interrupted = true;\n            }\n        } finally {\n            if (failed)\n                cancelAcquire(node);//5\n        }\n    }\n    /*\n    *  åˆ¤æ–­å‰é©±èŠ‚ç‚¹æ˜¯å¦ä¸ºsignalå¹¶é€šè¿‡CASæ“ä½œå°†å‰é©±èŠ‚ç‚¹çš„ç­‰å¾…çŠ¶æ€è®¾ç½®ä¸ºsignal\n    *  1 å¦‚æœå‰ç»§èŠ‚ç‚¹çŠ¶æ€ä¸ºSIGNALï¼Œè¡¨æ˜å½“å‰èŠ‚ç‚¹éœ€è¦è¢«unpark(å”¤é†’)ï¼Œæ­¤æ—¶åˆ™è¿”å›trueã€‚\n    *  2 å¦‚æœå‰ç»§èŠ‚ç‚¹çŠ¶æ€ä¸ºCANCELLED(ws&gt;0)ï¼Œè¯´æ˜å‰ç»§èŠ‚ç‚¹å·²ç»è¢«å–æ¶ˆï¼Œåˆ™é€šè¿‡å…ˆå‰å›æº¯æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆ(éCANCELLEDçŠ¶æ€)çš„èŠ‚ç‚¹ï¼Œå¹¶è¿”å›falseã€‚\n    *  3 å¦‚æœå‰ç»§èŠ‚ç‚¹çŠ¶æ€ä¸ºéSIGNALã€éCANCELLEDï¼Œåˆ™è®¾ç½®å‰ç»§çš„çŠ¶æ€ä¸ºSIGNALï¼Œå¹¶è¿”å›false\n    */\n    private static boolean shouldParkAfterFailedAcquire(Node pred, Node node) {\n        int ws = pred.waitStatus;\n        if (ws == Node.SIGNAL)//1\n            return true;\n        if (ws &gt; 0) {//2\n            do {\n                //==&gt;pred = pred.prev;node.prev = pred;å°†å½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ¢æˆå‰é©±èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹\n                node.prev = pred = pred.prev;\n            } while (pred.waitStatus &gt; 0);\n            pred.next = node;\n        } else {//3\n            /*\n             * 1/è¿™ä¸ºä»€ä¹ˆç”¨CASï¼Œç°åœ¨å·²ç»å…¥é˜ŸæˆåŠŸäº†ï¼Œå‰é©±èŠ‚ç‚¹å°±æ˜¯predï¼Œé™¤äº†nodeå¤–åº”è¯¥æ²¡æœ‰åˆ«çš„çº¿ç¨‹åœ¨æ“ä½œè¿™ä¸ªèŠ‚ç‚¹äº†ï¼Œé‚£ä¸ºä»€ä¹ˆè¿˜è¦ç”¨CASï¼Ÿè€Œä¸ç›´æ¥èµ‹å€¼å‘¢ï¼Ÿ\n             * ï¼ˆè§£é‡Šï¼šå› ä¸ºpredå¯ä»¥è‡ªå·±å°†è‡ªå·±çš„çŠ¶æ€æ”¹ä¸ºcancelï¼Œä¹Ÿå°±æ˜¯predçš„çŠ¶æ€å¯èƒ½åŒæ—¶ä¼šæœ‰ä¸¤æ¡çº¿ç¨‹ï¼ˆpredå’Œnodeï¼‰å»æ“ä½œï¼‰\n             * 2/æ—¢ç„¶å‰é©±èŠ‚ç‚¹å·²ç»è®¾ä¸ºSIGNALäº†ï¼Œä¸ºä»€ä¹ˆæœ€åè¿˜è¦è¿”å›false\n             * ï¼ˆå› ä¸ºCASå¯èƒ½ä¼šå¤±è´¥ï¼Œè¿™é‡Œä¸ç®¡å¤±è´¥ä¸å¦ï¼Œéƒ½è¿”å›falseï¼Œä¸‹ä¸€æ¬¡æ‰§è¡Œè¯¥æ–¹æ³•çš„ä¹‹åï¼Œpredçš„ç­‰å¾…çŠ¶æ€å°±æ˜¯SIGNALäº†ï¼‰\n             */\n            compareAndSetWaitStatus(pred, ws, Node.SIGNAL);//è°ƒç”¨ä¸‹é¢çš„\n        }\n        return false;\n    }\n    \n    //æŒ‚èµ·å½“å‰çº¿ç¨‹å¹¶è¿”å›ä¸­æ–­çŠ¶æ€\n    private final boolean parkAndCheckInterrupt() {\n        LockSupport.park(this);\n        return Thread.interrupted();\n    }\n\n    /*\n    * å°†nodeä»é˜Ÿåˆ—ä¸­å»æ‰æˆ–è€…å¦‚æœå½“å‰èŠ‚ç‚¹æ˜¯å¤´ç»“ç‚¹åˆ™å”¤é†’åç½®èŠ‚ç‚¹\n    * 1 å¦‚æœnodeä¸ºnullï¼Œåˆ™å¿½ç•¥(è¢«GCå›æ”¶äº†)\n    * 2 å°†nodeçš„threadç½®ä¸ºnull\n    * 3 å¦‚æœnodeçŠ¶æ€ä¸ºCANCELLEDï¼Œåˆ™é€šè¿‡å›æº¯æ‰¾åˆ°ä¸€ä¸ªæœ‰æ•ˆ(éCANCELLEDçŠ¶æ€)çš„èŠ‚ç‚¹ä½œä¸ºå‰é©±èŠ‚ç‚¹\n    * 4 å°†nodeçŠ¶æ€è®¾ç½®ä¸ºCANCELLED\n    * 5 å¦‚æœnodeæ˜¯tailèŠ‚ç‚¹ï¼Œåˆ™ç›´æ¥å°†å‰é©±èŠ‚ç‚¹çš„åç½®èŠ‚ç‚¹è®¾ç½®ä¸ºnull\n    * 6 å¦‚æœå½“å‰èŠ‚ç‚¹Nodeä¸æ˜¯tailèŠ‚ç‚¹\n    *   6.1 å¦‚æœå½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ä¸æ˜¯headèŠ‚ç‚¹ï¼Œåˆ™å°†å½“å‰èŠ‚ç‚¹Nodeçš„åç½®èŠ‚ç‚¹ä¸å‰ç½®èŠ‚ç‚¹é€šè¿‡CASæ“ä½œè¿æ¥èµ·æ¥\n    *   6.2 å¦‚æœå½“å‰èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹æ˜¯headèŠ‚ç‚¹ï¼Œåˆ™è°ƒç”¨unparkSuccessorå”¤é†’å½“å‰èŠ‚ç‚¹çš„åç½®èŠ‚ç‚¹\n    */\n    private void cancelAcquire(Node node) {\n        if (node == null) return;//1\n\n        node.thread = null;//2\n\n        Node pred = node.prev;//3\n        while (pred.waitStatus &gt; 0)\n            node.prev = pred = pred.prev;\n\n        Node predNext = pred.next;\n\n        node.waitStatus = Node.CANCELLED;//4\n\n        if (node == tail &amp;&amp; compareAndSetTail(node, pred)) {//5\n            compareAndSetNext(pred, predNext, null);\n        } else {\n            int ws;\n            if (pred != head &amp;&amp;\n                ((ws = pred.waitStatus) == Node.SIGNAL ||\n                 (ws &lt;= 0 &amp;&amp; compareAndSetWaitStatus(pred, ws, Node.SIGNAL))) &amp;&amp;\n                pred.thread != null) {\n                Node next = node.next;\n                if (next != null &amp;&amp; next.waitStatus &lt;= 0)\n                    compareAndSetNext(pred, predNext, next);\n            } else {\n                unparkSuccessor(node);//6.2\n            }\n\n            node.next = node; // help GC\n        }\n    }\n    /*\n    * åŠŸèƒ½ å”¤é†’å½“å‰èŠ‚ç‚¹çš„åç½®èŠ‚ç‚¹\n    * 1 NodeèŠ‚ç‚¹çš„WaitStatuså¦‚æœæ˜¯éCANCELLEDåˆ™å°è¯•è®¾ç½®ä¸º0ï¼Œè®¾ç½®æˆä¸æˆåŠŸæ— æ‰€è°“\n    * 2 æ‰¾å‡ºNodeèŠ‚ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå¦‚æœä¸ºnullæˆ–è€…è¢«CANCELLEDåˆ™ä»å°¾ç»“ç‚¹è½®è¯¢åˆ°å¤´ç»“ç‚¹é€‰å‡ºä¸€ä¸ªæœªè¢«CANCELLEDç»“ç‚¹\n    * 3 å¦‚æœæ‰¾åˆ°çš„NodeèŠ‚ç‚¹ä¸ä¸ºnullåˆ™ç›´æ¥å”¤é†’è¯¥èŠ‚ç‚¹æ‰€åœ¨çš„çº¿ç¨‹\n    */\n    private void unparkSuccessor(Node node) {\n        int ws = node.waitStatus;\n        if (ws &lt; 0)\n            compareAndSetWaitStatus(node, ws, 0);//1\n            \n        Node s = node.next;//2\n        if (s == null || s.waitStatus &gt; 0) {\n            s = null;\n            for (Node t = tail; t != null &amp;&amp; t != node; t = t.prev)\n                if (t.waitStatus &lt;= 0)\n                    s = t;\n        }\n        if (s != null)\n            LockSupport.unpark(s.thread);//3\n    }\n    /*\n    * ç‹¬å é”çš„é‡Šæ”¾\n    *   1 è°ƒç”¨å­ç±»tryRelease\n    *   2 å¤´ç»“ç‚¹ä¸ä¸ºç©ºåˆ™å”¤é†’å¤´èŠ‚ç‚¹åç»§èŠ‚ç‚¹\n    */\n    public final boolean release(int arg) {\n        if (tryRelease(arg)) {//1\n            Node h = head;\n            if (h != null &amp;&amp; h.waitStatus != 0)//2\n                unparkSuccessor(h);\n            return true;\n        }\n        return false;\n    }\n</code></pre></div><h1>5. å¯ä¸­æ–­å¼è·å–é”acquireInterruptibly(int arg)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /*\n    * 1 ä¸acquireåŒºåˆ«çº¿ç¨‹å”¤é†’åå¦‚æœå¤„äºä¸­æ–­çŠ¶æ€åˆ™æŠ›å‡ºä¸­æ–­å¼‚å¸¸\n    */\n    public final void acquireInterruptibly(int arg) throws InterruptedException {\n        if (Thread.interrupted()) throw new InterruptedException();\n        if (!tryAcquire(arg))\n            doAcquireInterruptibly(arg);//3\n    }\n    private void doAcquireInterruptibly(int arg)\n        throws InterruptedException {\n        //å°†èŠ‚ç‚¹æ’å…¥åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­\n        final Node node = addWaiter(Node.EXCLUSIVE);\n        boolean failed = true;\n        try {\n            for (;;) {\n                final Node p = node.predecessor();\n                if (p == head &amp;&amp; tryAcquire(arg)) {\n                    setHead(node);\n                    p.next = null;\n                    failed = false;\n                    return;\n                }\n                if (shouldParkAfterFailedAcquire(p, node) &amp;&amp;\n                    parkAndCheckInterrupt())\n                    throw new InterruptedException();//1\n            }\n        } finally {\n            if (failed)\n                cancelAcquire(node);\n        }\n    }\n\n</code></pre></div><h1>6. è¶…æ—¶ç­‰å¾…å¼è·å–é”tryAcquireNanos(int arg, long nanosTimeout)</h1>\n<ul>\n<li>doAcquireNanos(int arg,long nanosTimeout)æ–¹æ³•å¯ä»¥è¶…æ—¶è·å–åŒæ­¥çŠ¶æ€ï¼Œå³åœ¨æŒ‡å®šçš„æ—¶é—´æ®µå†…è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœè·å–åˆ°åŒæ­¥çŠ¶æ€åˆ™è¿”å›trueï¼Œå¦åˆ™ï¼Œè¿”å›falseã€‚å¦‚æœå½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œä¼šç«‹åˆ»è¿”å›ï¼Œå¹¶æŠ›å‡ºInterruptedExceptionã€‚è€Œsynchronizedä¸å…·å¤‡è¯¥ç‰¹æ€§</li>\n<li>ç‹¬å å¼è¶…æ—¶è·å–åŒæ­¥çŠ¶æ€doAcquireNanos(int arg,long nanosTimeout)å’Œç‹¬å å¼è·å–åŒæ­¥çŠ¶æ€acquire(int args)åœ¨æµç¨‹ä¸Šéå¸¸ç›¸ä¼¼ï¼Œå½“èŠ‚ç‚¹çš„å‰é©±èŠ‚ç‚¹ä¸ºå¤´èŠ‚ç‚¹æ—¶å°è¯•è·å–åŒæ­¥çŠ¶æ€ï¼Œå¦‚æœè·å–æˆåŠŸåˆ™ä»è¯¥æ–¹æ³•è¿”å›ï¼Œå…¶ä¸»è¦åŒºåˆ«åœ¨äºæœªè·å–åˆ°åŒæ­¥çŠ¶æ€æ—¶çš„å¤„ç†é€»è¾‘ã€‚acquire(int args)åœ¨æœªè·å–åˆ°åŒæ­¥çŠ¶æ€æ—¶ï¼Œå°†ä¼šä½¿å½“å‰çº¿ç¨‹ä¸€ç›´å¤„äºç­‰å¾…çŠ¶æ€ï¼Œè€ŒdoAcquireNanos(int arg,long nanosTimeout)ä¼šåˆ¤æ–­æ˜¯å¦è¶…æ—¶ï¼ˆnanosTimeoutå°äºç­‰äº0è¡¨ç¤ºå·²ç»è¶…æ—¶ï¼‰ï¼Œå¦‚æœæ²¡æœ‰è¶…æ—¶ï¼Œé‡æ–°è®¡ç®—è¶…æ—¶é—´éš”nanosTimeoutï¼Œç„¶åä½¿å½“å‰çº¿ç¨‹ç­‰å¾…nanosTimeoutçº³ç§’ï¼Œå¦‚æœå½“å‰çº¿ç¨‹åœ¨nanosTimeoutçº³ç§’å†…æ²¡æœ‰è·å–åˆ°åŒæ­¥çŠ¶æ€ï¼Œå°†ä¼šä»ç­‰å¾…é€»è¾‘LockSupport.parkNanos(Object blocker,long nanos)ä¸­è‡ªåŠ¨è¿”å›ã€‚</li>\n<li>å¦‚æœnanosTimeoutå°äºç­‰äºspinForTimeoutThresholdï¼ˆ1000çº³ç§’ï¼‰æ—¶ï¼Œå°†ä¸ä¼šä½¿è¯¥çº¿ç¨‹è¿›è¡Œè¶…æ—¶ç­‰å¾…ï¼Œè€Œæ˜¯è¿›å…¥å¿«é€Ÿçš„è‡ªæ—‹è¿‡ç¨‹ã€‚åŸå› åœ¨äºï¼Œéå¸¸çŸ­çš„è¶…æ—¶ç­‰å¾…æ— æ³•åšåˆ°ååˆ†ç²¾ç¡®ï¼Œå¦‚æœè¿™æ—¶å†è¿›è¡Œè¶…æ—¶ç­‰å¾…ï¼Œç›¸åä¼šè®©nanosTimeoutçš„è¶…æ—¶ä»æ•´ä½“ä¸Šè¡¨ç°å¾—åè€Œä¸ç²¾ç¡®ã€‚å› æ­¤ï¼Œåœ¨è¶…æ—¶éå¸¸çŸ­çš„åœºæ™¯ä¸‹ï¼ŒåŒæ­¥å™¨ä¼šè¿›å…¥æ— æ¡ä»¶çš„å¿«é€Ÿè‡ªæ—‹ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4eeae1acd7ba26e380300.jpg\" alt=\"ç‹¬å å¼è¶…æ—¶è·å–åŒæ­¥çŠ¶æ€æµç¨‹.png\"></li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /*\n    * ä¸acquireInterruptiblyåŒºåˆ«æŒ‚èµ·æ¡ä»¶æ·»åŠ ä¸€æ¡ï¼šå‰©ä½™æ—¶é—´å¤§äº1ç§’åˆ™æŒ‰å‰©ä½™æ—¶é—´é˜»å¡å½“å‰çº¿ç¨‹\n    */\n    public final boolean tryAcquireNanos(int arg, long nanosTimeout)\n            throws InterruptedException {\n        if (Thread.interrupted()) throw new InterruptedException();\n        return tryAcquire(arg) || doAcquireNanos(arg, nanosTimeout);\n    }\n\n    static final long spinForTimeoutThreshold = 1000L;\n\n    private boolean doAcquireNanos(int arg, long nanosTimeout)\n            throws InterruptedException {\n        if (nanosTimeout &lt;= 0L)\n            return false;\n        final long deadline = System.nanoTime() + nanosTimeout;\n        final Node node = addWaiter(Node.EXCLUSIVE);\n        boolean failed = true;\n        try {\n            for (;;) {\n                final Node p = node.predecessor();\n                if (p == head &amp;&amp; tryAcquire(arg)) {\n                    setHead(node);\n                    p.next = null; // help GC\n                    failed = false;\n                    return true;\n                }\n                nanosTimeout = deadline - System.nanoTime();\n                //è®¡ç®—æ—¶é—´ï¼Œå½“å‰æ—¶é—´nowå‡å»ç¡çœ ä¹‹å‰çš„æ—¶é—´lastTimeå¾—åˆ°å·²ç»ç¡çœ \n                //çš„æ—¶é—´deltaï¼Œç„¶åè¢«åŸæœ‰è¶…æ—¶æ—¶é—´nanosTimeoutå‡å»ï¼Œå¾—åˆ°äº†\n                //è¿˜åº”è¯¥ç¡çœ çš„æ—¶é—´\n                if (nanosTimeout &lt;= 0L) return false;\n                    \n                if (shouldParkAfterFailedAcquire(p, node) &amp;&amp; \n                    nanosTimeout &gt; spinForTimeoutThreshold) \n                    LockSupport.parkNanos(this, nanosTimeout);\n                if (Thread.interrupted())\n                    throw new InterruptedException();\n            }\n        } finally {\n            if (failed)\n                cancelAcquire(node);\n        }\n    }\n</code></pre></div><h1>7. å…±äº«é”çš„è·å–acquireShared(int arg)å’Œé‡Šæ”¾releaseShared(int arg)</h1>\n<ul>\n<li>å…±äº«å¼è·å–ä¸ç‹¬å å¼è·å–æœ€ä¸»è¦çš„åŒºåˆ«åœ¨äºåŒä¸€æ—¶åˆ»èƒ½å¦æœ‰å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–åˆ°åŒæ­¥çŠ¶æ€ã€‚å†™æ“ä½œè¦æ±‚å¯¹èµ„æºçš„ç‹¬å å¼è®¿é—®ï¼Œè€Œè¯»æ“ä½œå¯ä»¥æ˜¯å…±äº«å¼è®¿é—®ï¼Œ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /*\n    * tryAcquireShared(int arg)è¿”å›å€¼å¤§äºç­‰äº0æ—¶ï¼Œè¡¨ç¤ºèƒ½å¤Ÿè·å–åˆ°åŒæ­¥çŠ¶æ€\n    * ä¸ç‹¬å é”çš„åŒºåˆ«\n    * 1 è·å–é”æˆåŠŸåå½“tryAcquireShared&gt;0æˆ–è€…æ–°æ—§å¤´ç»“ç‚¹çš„waitStatusä¸ºsignalæˆ–è€…propagateå”¤é†’åç»§èŠ‚ç‚¹\n    */\n    public final void acquireShared(int arg) {\n        if (tryAcquireShared(arg) &lt; 0)\n            doAcquireShared(arg);\n    }\n\n    private void doAcquireShared(int arg) {\n        final Node node = addWaiter(Node.SHARED);\n        boolean failed = true;\n        try {\n            boolean interrupted = false;\n            for (;;) {\n                final Node p = node.predecessor();\n                if (p == head) {\n                    int r = tryAcquireShared(arg);\n                    if (r &gt;= 0) {\n                        setHeadAndPropagate(node, r);\n                        p.next = null; // help GC\n                        if (interrupted)\n                            selfInterrupt();\n                        failed = false;\n                        return;\n                    }\n                }\n                if (shouldParkAfterFailedAcquire(p, node) &amp;&amp;\n                    parkAndCheckInterrupt())\n                    interrupted = true;\n            }\n        } finally {\n            if (failed)\n                cancelAcquire(node);\n        }\n    }\n\n    private void setHeadAndPropagate(Node node, int propagate) {\n        Node h = head; // Record old head for check below\n        setHead(node);\n        //1\n        if (propagate &gt; 0 || h == null || h.waitStatus &lt; 0 ||\n            (h = head) == null || h.waitStatus &lt; 0) {\n            Node s = node.next;\n            if (s == null || s.isShared())\n                doReleaseShared();\n        }\n    }\n\n    /*\n    * å…±äº«é”å”¤é†’åç»§èŠ‚ç‚¹\n    * 1 è°ƒç”¨æ—¶æœºï¼š\n    *    åˆšè·å–å…±äº«é”çš„çº¿ç¨‹å¹¶ä¸”tryAcquireShared&gt;0æˆ–è€…waitStatusä¸ºsignalæˆ–è€…propagateæ—¶\n    *    å·²ç»æŒæœ‰å…±äº«é”çš„çº¿ç¨‹é‡Šæ”¾é”\n    * 2 ç›®çš„ï¼šå”¤é†’å¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹\n    * 3 å”¤é†’ä¸‹ä¸€ä¸ªèŠ‚ç‚¹çš„æ¡ä»¶ï¼Ÿå¤´ç»“ç‚¹ä¸ºSIGNALä¸”CASæ“ä½œå¤´ç»“ç‚¹çš„WaitStatusè®¾ç½®ä¸º0æˆåŠŸ\n    * 4 PROPAGATEçš„ä½œç”¨?è§£å†³å¹¶å‘é‡Šæ”¾ä¿¡å·é‡æ‰€å¯¼è‡´éƒ¨åˆ†è¯·æ±‚ä¿¡å·é‡çš„çº¿ç¨‹æ— æ³•è¢«å”¤é†’çš„é—®é¢˜\n    *    https://bugs.java.com/bugdatabase/view_bug.do?bug_id=6801020\n    *    å½“çº¿ç¨‹è°ƒç”¨tryAcquireSharedè¿”å›0å¹¶å°†å¤´çš„waitstatusè®¾ç½®ä¸º0æ—¶å¹¶ä¸å”¤é†’åç»§èŠ‚ç‚¹çš„ç¬é—´\n    *    çº¿ç¨‹2è°ƒç”¨doReleaseSharedé‡Šæ”¾é”ï¼Œå¹¶è¯»å–åˆ°å¤´çš„waitstatusä¸º0æ—¶ä¹Ÿä¸å”¤é†’åç»§èŠ‚ç‚¹ï¼Œå¯¼è‡´é˜Ÿåˆ—ç­‰å¾…çº¿ç¨‹æ— æ³•è¢«å”¤é†’\n    * 5 é€€å‡ºæ¡ä»¶ä¸ºä»€ä¹ˆæ˜¯h == head?\n    *   é…åˆfor(;;)åŠ å¿«å”¤é†’åç»§èŠ‚ç‚¹çš„é€Ÿåº¦ï¼Œå³æä¾›å¤šçº¿ç¨‹ç«äº‰\n    */\n    private void doReleaseShared() {\n        for (;;) {\n            Node h = head;\n            if (h != null &amp;&amp; h != tail) {\n                int ws = h.waitStatus;\n                if (ws == Node.SIGNAL) {\n                    if (!compareAndSetWaitStatus(h, Node.SIGNAL, 0))\n                        continue;            // loop to recheck cases\n                    unparkSuccessor(h);\n                }\n                else if (ws == 0 &amp;&amp;\n                         !compareAndSetWaitStatus(h, 0, Node.PROPAGATE))\n                    continue;                // loop on failed CAS\n            }\n            if (h == head)                   // loop if head changed\n                break;\n        }\n    }\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /*\n    * tryReleaseShared(int arg)æ–¹æ³•å¿…é¡»ç¡®ä¿åŒæ­¥çŠ¶æ€ï¼ˆæˆ–è€…èµ„æºæ•°ï¼‰çº¿ç¨‹å®‰å…¨é‡Šæ”¾ï¼Œä¸€èˆ¬æ˜¯é€šè¿‡å¾ªç¯å’ŒCASæ¥ä¿è¯çš„ï¼Œå› ä¸ºé‡Šæ”¾åŒ* æ­¥çŠ¶æ€çš„æ“ä½œä¼šåŒæ—¶æ¥è‡ªå¤šä¸ªçº¿ç¨‹ã€‚\n    * å…±äº«é”çš„é‡Šæ”¾\n    * 1 è°ƒç”¨å­ç±»tryReleaseShared\n    * 2 æˆåŠŸåˆ™è°ƒç”¨doReleaseShared å”¤é†’ä¸‹ä¸€ä¸ªçº¿ç¨‹æˆ–è€…è®¾ç½®ä¼ æ’­çŠ¶æ€ã€‚\n    */\n    public final boolean releaseShared(int arg) {\n        if (tryReleaseShared(arg)) {//1\n            doReleaseShared();//2\n            return true;\n        }\n        return false;\n    }\n</code></pre></div><h1>9. å¯ä¸­æ–­acquireSharedInterruptibly()ä¸€æ ·</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    private void doAcquireSharedInterruptibly(int arg)\n            throws InterruptedException {\n        final Node node = addWaiter(Node.SHARED);\n        boolean failed = true;\n        try {\n            for (;;) {\n                final Node p = node.predecessor();\n                if (p == head) {\n                    int r = tryAcquireShared(arg);\n                    if (r &gt;= 0) {\n                        setHeadAndPropagate(node, r);\n                        p.next = null; // help GC\n                        failed = false;\n                        return;\n                    }\n                }\n                if (shouldParkAfterFailedAcquire(p, node) &amp;&amp;\n                    parkAndCheckInterrupt())\n                    throw new InterruptedException();\n            }\n        } finally {\n            if (failed)\n                cancelAcquire(node);\n        }\n    }\n</code></pre></div><h1>10. è¶…æ—¶ç­‰å¾…tryAcquireSharedNanos()ä¸€æ ·</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    private boolean doAcquireSharedNanos(int arg, long nanosTimeout)\n            throws InterruptedException {\n        if (nanosTimeout &lt;= 0L)\n            return false;\n        final long deadline = System.nanoTime() + nanosTimeout;\n        final Node node = addWaiter(Node.SHARED);\n        boolean failed = true;\n        try {\n            for (;;) {\n                final Node p = node.predecessor();\n                if (p == head) {\n                    int r = tryAcquireShared(arg);\n                    if (r &gt;= 0) {\n                        setHeadAndPropagate(node, r);\n                        p.next = null; // help GC\n                        failed = false;\n                        return true;\n                    }\n                }\n                nanosTimeout = deadline - System.nanoTime();\n                if (nanosTimeout &lt;= 0L)\n                    return false;\n                if (shouldParkAfterFailedAcquire(p, node) &amp;&amp;\n                    nanosTimeout &gt; spinForTimeoutThreshold)\n                    LockSupport.parkNanos(this, nanosTimeout);\n                if (Thread.interrupted())\n                    throw new InterruptedException();\n            }\n        } finally {\n            if (failed)\n                cancelAcquire(node);\n        }\n    }\n</code></pre></div><h1>è‡ªå®šä¹‰åŒæ­¥ç»„ä»¶â€”â€”TwinsLock</h1>\n<ul>\n<li>è®¾è®¡ä¸€ä¸ªåŒæ­¥å·¥å…·ï¼šåŒä¸€æ—¶åˆ»ï¼Œåªå…è®¸è‡³å¤šä¸¤ä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®ï¼Œè¶…è¿‡ä¸¤ä¸ªçº¿ç¨‹çš„è®¿é—®å°†è¢«é˜»å¡</li>\n<li>é¦–å…ˆï¼Œç¡®å®šè®¿é—®æ¨¡å¼ã€‚TwinsLockèƒ½å¤Ÿåœ¨åŒä¸€æ—¶åˆ»æ”¯æŒå¤šä¸ªçº¿ç¨‹çš„è®¿é—®ï¼Œè¿™æ˜¾ç„¶æ˜¯å…±äº«å¼è®¿é—®ï¼Œå› æ­¤ï¼Œéœ€è¦ä½¿ç”¨åŒæ­¥å™¨æä¾›çš„acquireShared(int args)æ–¹æ³•ç­‰å’ŒSharedç›¸å…³çš„æ–¹æ³•ï¼Œè¿™å°±è¦æ±‚TwinsLockå¿…é¡»é‡å†™tryAcquireShared(int args)æ–¹æ³•å’ŒtryReleaseShared(int args)æ–¹æ³•ï¼Œè¿™æ ·æ‰èƒ½ä¿è¯åŒæ­¥å™¨çš„å…±äº«å¼åŒæ­¥çŠ¶æ€çš„è·å–ä¸é‡Šæ”¾æ–¹æ³•å¾—ä»¥æ‰§è¡Œã€‚</li>\n<li>å…¶æ¬¡ï¼Œå®šä¹‰èµ„æºæ•°ã€‚TwinsLockåœ¨åŒä¸€æ—¶åˆ»å…è®¸è‡³å¤šä¸¤ä¸ªçº¿ç¨‹çš„åŒæ—¶è®¿é—®ï¼Œè¡¨æ˜åŒæ­¥èµ„æºæ•°ä¸º2ï¼Œè¿™æ ·å¯ä»¥è®¾ç½®åˆå§‹çŠ¶æ€statusä¸º2ï¼Œå½“ä¸€ä¸ªçº¿ç¨‹è¿›è¡Œè·å–ï¼Œstatuså‡1ï¼Œè¯¥çº¿ç¨‹é‡Šæ”¾ï¼Œåˆ™statusåŠ 1ï¼ŒçŠ¶æ€çš„åˆæ³•èŒƒå›´ä¸º0ã€1å’Œ2ï¼Œå…¶ä¸­0è¡¨ç¤ºå½“å‰å·²ç»æœ‰ä¸¤ä¸ªçº¿ç¨‹è·å–äº†åŒæ­¥èµ„æºï¼Œæ­¤æ—¶å†æœ‰å…¶ä»–çº¿ç¨‹å¯¹åŒæ­¥çŠ¶æ€è¿›è¡Œè·å–ï¼Œè¯¥çº¿ç¨‹åªèƒ½è¢«é˜»å¡ã€‚åœ¨åŒæ­¥çŠ¶æ€å˜æ›´æ—¶ï¼Œéœ€è¦ä½¿ç”¨compareAndSet(int expect,int update)æ–¹æ³•åšåŸå­æ€§ä¿éšœã€‚</li>\n<li>æœ€åï¼Œç»„åˆè‡ªå®šä¹‰åŒæ­¥å™¨ã€‚å‰é¢çš„ç« èŠ‚æåˆ°ï¼Œè‡ªå®šä¹‰åŒæ­¥ç»„ä»¶é€šè¿‡ç»„åˆè‡ªå®šä¹‰åŒæ­¥å™¨æ¥å®ŒæˆåŒæ­¥åŠŸèƒ½ï¼Œä¸€èˆ¬æƒ…å†µä¸‹è‡ªå®šä¹‰åŒæ­¥å™¨ä¼šè¢«å®šä¹‰ä¸ºè‡ªå®šä¹‰åŒæ­¥ç»„ä»¶çš„å†…éƒ¨ç±»ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TwinsLock implements Lock {\n    private final Sync sync = new Sync(2);\n    private static final class Sync extends AbstractQueuedSynchronizer {\n        Sync(int count) {\n            if (count &lt;= 0) {\n                throw new IllegalArgumentException(\"count must large\n                than zero.\");\n            }\n            setState(count);\n        }\n        public int tryAcquireShared(int reduceCount) {\n            for (;;) {\n                int current = getState();\n                int newCount = current - reduceCount;\n                if (newCount &lt; 0 || compareAndSetState(current,newCount)) {\n                    return newCount;\n                }\n            }\n        }\n        public boolean tryReleaseShared(int returnCount) {\n            for (;;) {\n                int current = getState();\n                int newCount = current + returnCount;\n                if (compareAndSetState(current, newCount)) {\n                    return true;\n                }\n            }\n        }\n    }\n    public void lock() {\n        sync.acquireShared(1);\n    }\n    public void unlock() {\n        sync.releaseShared(1);\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TwinsLockTest {\n    @Test\n    public void test() {\n        final Lock lock = new TwinsLock();\n        class Worker extends Thread {\n            public void run() {\n                while (true) {\n                    lock.lock();\n                    try {\n                        SleepUtils.second(1);\n                        System.out.println(Thread.currentThread().getName());\n                        SleepUtils.second(1);\n                    } finally {\n                        lock.unlock();\n                    }\n                }\n            }\n        }\n        // å¯åŠ¨10ä¸ªçº¿ç¨‹\n        for (int i = 0; i &lt; 10; i++) {\n            Worker w = new Worker();\n            w.setDaemon(true);\n            w.start();\n        }\n        // æ¯éš”1ç§’æ¢è¡Œ\n        for (int i = 0; i &lt; 10; i++) {\n            SleepUtils.second(1);\n            System.out.println();\n        }\n    }\n}\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/e9915cfd1e0090d670830.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æºç "
      ]
    },
    {
      "title": "é›†åˆ",
      "url": "https://javaguide.cn/backend/java/collection.html",
      "id": "https://javaguide.cn/backend/java/collection.html",
      "summary": "Collection é›†åˆä¸æ•°ç»„çš„å¼‚åŒ æ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚é›†åˆçš„é•¿åº¦æ˜¯å¯å˜çš„ã€‚ æ•°ç»„å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹ï¼›é›†åˆä¸­å­˜å‚¨çš„å…ƒç´ å¿…é¡»æ˜¯å¼•ç”¨ç±»å‹æ•°æ® æ•°ç»„å­˜å‚¨çš„å…ƒç´ å¿…é¡»æ˜¯åŒä¸€ä¸ªæ•°æ®ç±»å‹ï¼›é›†åˆå­˜å‚¨çš„å¯¹è±¡å¯ä»¥æ˜¯ä¸åŒæ•°æ®ç±»å‹ é›†åˆä¸­å­˜å‚¨å…¶å®éƒ½æ˜¯å¯¹è±¡çš„åœ°å€ é›†åˆä¸­å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°å€¼å—ï¼Ÿå¯ä»¥é€šè¿‡åŸºæœ¬ç±»å‹åŒ…è£…ç±»ï¼Œè‡ªåŠ¨è£…ç®±æ“ä½œå­˜å‚¨ æ²¡æŒ‡å®š<>æ—¶ï¼Œå…ƒç´ å­˜å‚¨æ—¶è‡ªåŠ¨...",
      "content_html": "<p>Collection</p>\n<!--more-->\n<h2>é›†åˆä¸æ•°ç»„çš„å¼‚åŒ</h2>\n<ul>\n<li>æ•°ç»„çš„é•¿åº¦æ˜¯å›ºå®šçš„ã€‚é›†åˆçš„é•¿åº¦æ˜¯å¯å˜çš„ã€‚</li>\n<li>æ•°ç»„å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°æ®ç±»å‹å’Œå¼•ç”¨æ•°æ®ç±»å‹ï¼›é›†åˆä¸­å­˜å‚¨çš„å…ƒç´ å¿…é¡»æ˜¯å¼•ç”¨ç±»å‹æ•°æ®</li>\n<li>æ•°ç»„å­˜å‚¨çš„å…ƒç´ å¿…é¡»æ˜¯åŒä¸€ä¸ªæ•°æ®ç±»å‹ï¼›é›†åˆå­˜å‚¨çš„å¯¹è±¡å¯ä»¥æ˜¯ä¸åŒæ•°æ®ç±»å‹</li>\n<li>é›†åˆä¸­å­˜å‚¨å…¶å®éƒ½æ˜¯å¯¹è±¡çš„åœ°å€</li>\n<li>é›†åˆä¸­å¯ä»¥å­˜å‚¨åŸºæœ¬æ•°å€¼å—ï¼Ÿå¯ä»¥é€šè¿‡åŸºæœ¬ç±»å‹åŒ…è£…ç±»ï¼Œè‡ªåŠ¨è£…ç®±æ“ä½œå­˜å‚¨</li>\n<li>æ²¡æŒ‡å®š&lt;&gt;æ—¶ï¼Œå…ƒç´ å­˜å‚¨æ—¶è‡ªåŠ¨æå‡ä¸ºObjectã€‚å–å‡ºæ—¶è¦ä½¿ç”¨å…ƒç´ çš„ç‰¹æœ‰å†…å®¹ï¼Œå¿…é¡»å‘ä¸‹è½¬å‹</li>\n<li>å¦‚æœé›†åˆä¸­å­˜æ”¾çš„æ˜¯å¤šä¸ªå¯¹è±¡ï¼Œè¿™æ—¶è¿›è¡Œå‘ä¸‹è½¬å‹ä¼šå‘ç”Ÿç±»å‹è½¬æ¢å¼‚å¸¸</li>\n<li>Iteratoræ¥å£ä½¿ç”¨&lt;&gt;æ§åˆ¶è¿­ä»£å…ƒç´ çš„ç±»å‹å°±ä¸éœ€è¦å¼ºè½¬äº†.è·å–åˆ°çš„å…ƒç´ ç›´æ¥å°±æ˜¯å…ƒç´ ç±»å‹</li>\n</ul>\n<h2>Iterable</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># ArrayListè¿­ä»£\nfor (int i = 0; i &lt; list.size(); i++) {\n\tString str = list.get(i);\n}\nfor (Iterator&lt;String&gt; it2 = coll.iterator(); it2.hasNext();) {\n\tSystem.out.println(it2.next());\n} \nIterator&lt;String&gt; it=list.iterator();\nwhile(it.hasNext()){\n\tString str=it.next();\n\tit.remove();//éå†åˆ é™¤\n}\n\n# Vectoræšä¸¾è¿­ä»£\nEnumeration&lt;String&gt; en=list.elements();\nwhile(en.hasMoreElements()){\n\tString str=en.nextElement();\n}\n# Mapè¿­ä»£\n# æ¨èä½¿ç”¨ entrySet éå† Map ç±»é›†åˆ KVï¼Œè€Œä¸æ˜¯ keySet æ–¹å¼è¿›è¡Œéå†ã€‚keySet å…¶å®æ˜¯éå†äº†2æ¬¡ï¼Œä¸€æ¬¡æ˜¯è½¬ä¸ºIteratorå¯¹è±¡ï¼Œå¦ä¸€æ¬¡æ˜¯ä» hashMapä¸­å–å‡ºkeyæ‰€å¯¹åº”çš„valueã€‚è€ŒentrySetåªæ˜¯éå†äº†ä¸€æ¬¡å°±æŠŠkeyå’Œvalueéƒ½æ”¾åˆ°äº†entryä¸­ï¼Œæ•ˆç‡æ›´é«˜\n\nâ‘ Entryé”®å€¼å¯¹å¯¹è±¡æ–¹å¼\nMap&lt;String, String&gt; map = new HashMap&lt;String,String&gt;();\nIterator&lt;Map.Entry&lt;String,String&gt;&gt; it = map.entrySet().iterator();\nwhile(it.hasNext()){\n\tMap.Entry&lt;String,String&gt; entry = it.next();//å¾—åˆ°æ¯ä¸€å¯¹å¯¹åº”å…³ç³»\n\tString key = entry.getKey();//é€šè¿‡æ¯ä¸€å¯¹å¯¹åº”å…³ç³»è·å–å¯¹åº”çš„key\n\tString value = entry.getValue();//é€šè¿‡æ¯ä¸€å¯¹å¯¹åº”å…³ç³»è·å–å¯¹åº”çš„value\n\tSystem.out.println(key+\"=\"+value);\n}\nfor (Map.Entry&lt;Integer, Integer&gt; entry : map.entrySet()) {  \n\tSystem.out.println(\"Key=\" + entry.getKey() + \",Value =\" +entry.getValue());  \n}\n\nâ‘¡éå†é”®æ‰¾å€¼æ–¹å¼\nMap&lt;String, String&gt; map = new HashMap&lt;String,String&gt;();\nIterator&lt;String&gt; it =map.keySet().iterator();\nwhile(it.hasNext()){\n\tString key = it.next();//å¾—åˆ°æ¯ä¸€ä¸ªkey\n\tString value = map.get(key);//é€šè¿‡keyè·å–å¯¹åº”çš„value\n}\n\nfor (String key : map.keySet()) {\n\tSystem.out.println(\"key:\" + key + \",value:\" + map.get(key));\n}\n\nâ‘¢éå†æ‰€æœ‰çš„value\nfor (String value : map.values()) {\n\tSystem.out.println(\"value:\" + value);\n}\nmap.forEach((key, value) -&gt; {\n\tSystem.out.println(\"key=\" + key + \",value=\" + value);\n});\n# å¢å¼ºfor:æ²¡æœ‰ç´¢å¼•,ä¸èƒ½æ“ä½œå®¹å™¨é‡Œé¢çš„å…ƒç´ \nfor(å…ƒç´ ç±»å‹  å˜é‡å : æ•°ç»„æˆ–è€…é›†åˆ ){\n\tsop(å˜é‡);//ç›¸å½“äºç›´æ¥æ¯æ¬¡å¾ªç¯å°†é›†åˆæˆ–è€…æ•°ç»„ä¸­çš„å…ƒç´ èµ‹ç»™å˜é‡\n}\n</code></pre></div><h2>æ³›å‹</h2>\n<ul>\n<li>æ³›å‹å®ç°äº†å‚æ•°åŒ–ç±»å‹çš„æ¦‚å¿µï¼Œä½¿ä»£ç å¯ä»¥åº”ç”¨äºå¤šç§ç±»å‹</li>\n<li>æ³›å‹å¯ä»¥ç”¨äºå†…éƒ¨ç±»</li>\n<li>æ³›å‹æ¦‚å¿µ\n<ul>\n<li>æŒ‡æ˜äº†é›†åˆä¸­å­˜å‚¨æ•°æ®çš„ç±»å‹  &lt;æ•°æ®ç±»å‹&gt;(å®‰å…¨ç®€å•)ã€‚åœ¨ç¼–è¯‘çš„æ—¶å€™æ£€æŸ¥ç±»å‹å®‰å…¨ï¼Œé¿å…äº†è¿­ä»£æ—¶ç±»å‹å¼ºè½¬çš„éº»çƒ¦</li>\n</ul>\n</li>\n<li>æ³›å‹å£°æ˜\n<ul>\n<li>æ³›å‹ç±» ä¿®é¥°ç¬¦  <code> class ç±»å&lt;ä»£è¡¨æ³›å‹çš„å˜é‡&gt; {}</code></li>\n<li>æ³›å‹æ–¹æ³• ä¿®é¥°ç¬¦ &lt;ä»£è¡¨æ³›å‹çš„å˜é‡&gt; è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å‚æ•°){} <code>public &lt;T&gt; T[] toArray(T[] a){} </code></li>\n<li>æ³›å‹æ¥å£ <code>public interface List &lt;E&gt;{abstract boolean add(E e);}</code></li>\n</ul>\n</li>\n<li>æ³›å‹æ“¦é™¤ï¼šä½¿å¾—æ³›åŒ–çš„å®¢æˆ·ç«¯å¯ä»¥ç”¨éæ³›åŒ–çš„ç±»åº“æ¥ä½¿ç”¨\n<ul>\n<li>æ³›å‹åªåœ¨ç¼–è¯‘æ—¶å­˜åœ¨,ç¼–è¯‘åå°±è¢«æ“¦é™¤,åœ¨ç¼–è¯‘ä¹‹å‰æˆ‘ä»¬å°±å¯ä»¥é™åˆ¶é›†åˆçš„ç±»å‹,èµ·åˆ°ä½œç”¨</li>\n<li>ä¾‹å¦‚:<code>ArrayList&lt;String&gt; al=new ArrayList&lt;String&gt;()</code>;ç¼–è¯‘å:ArrayList al=new ArrayList();</li>\n<li>è·å¾—æ³›å‹å£°æ˜æ‰€å£°æ˜çš„ç±»å‹å‚æ•°ï¼š<code>TypeVariable&lt;Class&lt;T&gt;&gt;[] typeParameters = al.getClass().getTypeParameters();</code></li>\n</ul>\n</li>\n<li>é€šé…ç¬¦å’Œæ³›å‹çš„é™å®šï¼šä¸ºäº†ä¼ å…¥æ³›å‹åèƒ½åšåˆ°è°ƒç”¨å…·ä½“ç±»å‹çš„æ–¹æ³•ï¼Œå¿…é¡»åšé™å®š\n<ul>\n<li>Iterator&lt;?&gt; it = coll.iterator()æ³›å‹çš„é€šé…,åŒ¹é…æ‰€æœ‰çš„æ•°æ®ç±»å‹ï¼Œè¢«æ“¦é™¤æˆObject</li>\n<li><code>&lt;? extends Employee&gt;</code> é™åˆ¶çš„æ˜¯çˆ¶ç±», ä¸Šé™é™å®š, å¯ä»¥ä¼ é€’Employeeï¼Œä¼ é€’ä»–çš„å­ç±»å¯¹è±¡ï¼Œè¢«æ“¦é™¤æˆEmployee</li>\n<li><code>&lt;? super   Employee&gt;</code> é™åˆ¶çš„æ˜¯å­ç±», ä¸‹é™é™å®š, å¯ä»¥ä¼ é€’Employeeï¼Œä¼ é€’ä»–çš„çˆ¶ç±»å¯¹è±¡ï¼Œè¢«æ“¦é™¤æˆEmployee</li>\n<li><code>&lt;? extends class &amp; interface&gt;</code>//å¤šä¸ªé™å®š</li>\n</ul>\n</li>\n<li>å…ƒç»„\n<ul>\n<li>å°†ä¸€ç»„å¯¹è±¡ä¹‹é—´æ‰“åŒ…å­˜å‚¨äºå…¶ä¸­çš„ä¸€ä¸ªå•ä¸€å¯¹è±¡ï¼Œè¿™ä¸ªå®¹å™¨å¯¹è±¡å…è®¸è¯»å–å…¶ä¸­å…ƒç´ ï¼Œä½†æ˜¯ä¸å…è®¸å‘å…¶ä¸­å­˜æ”¾æ–°çš„å¯¹è±¡</li>\n<li>å…ƒç»„å¯ä»¥æœ‰ä»»æ„é•¿åº¦ï¼Œå…ƒç»„ä¸­çš„å¯¹è±¡å¯ä»¥æ˜¯ä»»æ„ä¸åŒçš„ç±»å‹ï¼Œ</li>\n<li>å…ƒç»„å¯ä»¥å®ç°ä¸€æ¬¡æ–¹æ³•è°ƒç”¨è¿”å›å¤šä¸ªå¯¹è±¡ï¼Œå¹¶ä¸”åœ¨ç¼–è¯‘æœŸå°±èƒ½ç¡®ä¿ç±»å‹å®‰å…¨ã€‚å½“ç„¶ä¹Ÿå¯ä»¥åˆ›å»ºä¸€ä¸ªå¯¹è±¡ï¼ŒæŒæœ‰è¿”å›çš„å¤šä¸ªå¯¹è±¡</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TwoTuple&lt;A,B&gt;{\n\tpublic final A first;\n\tpublic final B second;\n\tpublic TwoTuple(A a,B b){\n\t\tthis.first = a;\n\t\tthis.second = b;\n\t}\n}\n</code></pre></div><ul>\n<li>æ³›å‹ç±»å‹å‚æ•°æ¨æ–­\n<ul>\n<li>å£°æ˜å˜é‡çš„çš„æ—¶å€™å·²ç»æŒ‡æ˜äº†å‚æ•°ç±»å‹ï¼Œåˆå§‹åŒ–å¯¹è±¡æ—¶è¿˜éœ€æŒ‡å®šï¼ˆjdk7åä¸ç”¨ï¼‰<code>Map&lt;String,Object&gt; myMap = new HashMap&lt;String,Object&gt;();</code>jdk7å=&gt;<code>HashMap&lt;String,Object&gt; map = new HashMap&lt;&gt;();</code></li>\n</ul>\n</li>\n<li>æ³›å‹æ„é€ å™¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æ³›å‹å¿…é¡»æœ‰æ— å‚æ„é€ å‡½æ•°\npublic class Generator&lt;T&gt; {\n    private Class&lt;T&gt; type;\n    public Generator(Class&lt;T&gt; type){this.type = type;}\n    public T get(){\n        try {\n            return (T) type.newInstance();\n        } catch (InstantiationException e) {\n            e.printStackTrace();\n        } catch (IllegalAccessException e) {\n            e.printStackTrace();\n        }\n        return null;\n    }\n    public T[] getArray(int size){\n        return (T[]) Array.newInstance(this.type,size);\n    }\n    public static &lt;T&gt; Generator&lt;T&gt; create(Class&lt;T&gt; type){\n        type.getTypeParameters();\n        return  new Generator&lt;&gt;(type);\n    }\n\tpublic static void main(String[] args) {\n        System.out.println(Generator.create(Test.class).get());\n\t\tSystem.out.println(Generator.create(Test.class).getArray(10));\n    }\n}\n</code></pre></div><h2>åŠ¨æ€è·å¾—å­ç±»çš„ç±»å‹</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//åœ¨çˆ¶ç±»(IBaseDaoImpl)çš„æ„é€ æ–¹æ³•ä¸­åŠ¨æ€è·å¾—entityClasså­—èŠ‚ç å¯¹è±¡\npublic IBaseDaoImpl() {\n  //è·å¾—T\n  ParameterizedType Superclass = (ParameterizedType) this.getClass().getGenericSuperclass();\n  //è·å¾—çˆ¶ç±»ä¸Šå£°æ˜çš„æ³›å‹æ•°ç»„\n  Type[] actualTypeArguments = Superclass.getActualTypeArguments();\n  entityClass=(Class&lt;T&gt;) actualTypeArguments[0];\n}\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "ConcurrentHashMap",
      "url": "https://javaguide.cn/backend/java/concurrentHashMap.html",
      "id": "https://javaguide.cn/backend/java/concurrentHashMap.html",
      "summary": "ConcurrentHashMap ConcurrentHashMap äº§ç”ŸåŸå› ï¼š å¹¶å‘ç¼–ç¨‹ä¸­ä½¿ç”¨HashMapå¯èƒ½å¯¼è‡´ç¨‹åºæ­»å¾ªç¯ã€‚å¯¼è‡´HashMapçš„Entryé“¾è¡¨å½¢æˆç¯å½¢æ•°æ®ç»“æ„ï¼Œä¸€æ—¦å½¢æˆç¯å½¢æ•°æ®ç»“æ„ï¼ŒEntryçš„nextèŠ‚ç‚¹æ°¸è¿œä¸ä¸ºç©ºï¼Œå°±ä¼šäº§ç”Ÿæ­»å¾ªç¯è·å–Entryã€‚ è€Œä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„HashTableæ•ˆç‡ä½ã€‚HashTableå®¹å™¨ä½¿ç”¨synchr...",
      "content_html": "<p>ConcurrentHashMap</p>\n<h1>ConcurrentHashMap</h1>\n<h2>äº§ç”ŸåŸå› ï¼š</h2>\n<ul>\n<li>å¹¶å‘ç¼–ç¨‹ä¸­ä½¿ç”¨HashMapå¯èƒ½å¯¼è‡´ç¨‹åºæ­»å¾ªç¯ã€‚å¯¼è‡´HashMapçš„Entryé“¾è¡¨å½¢æˆç¯å½¢æ•°æ®ç»“æ„ï¼Œä¸€æ—¦å½¢æˆç¯å½¢æ•°æ®ç»“æ„ï¼ŒEntryçš„nextèŠ‚ç‚¹æ°¸è¿œä¸ä¸ºç©ºï¼Œå°±ä¼šäº§ç”Ÿæ­»å¾ªç¯è·å–Entryã€‚</li>\n<li>è€Œä½¿ç”¨çº¿ç¨‹å®‰å…¨çš„HashTableæ•ˆç‡ä½ã€‚HashTableå®¹å™¨ä½¿ç”¨synchronizedæ¥ä¿è¯çº¿ç¨‹å®‰å…¨ï¼Œç«äº‰è¶Šæ¿€çƒˆæ•ˆç‡è¶Šä½</li>\n</ul>\n<h2>å®ç°é«˜æ€§èƒ½åŸç†</h2>\n<ul>\n<li>ConcurrentHashMapä½¿ç”¨åˆ†æ®µé”æ¥ä¿è¯åœ¨å¤šçº¿ç¨‹ä¸‹çš„æ€§èƒ½ã€‚ä¸€æ¬¡é”ä½ä¸€ä¸ªæ¡¶ã€‚å°†hashè¡¨åˆ†ä¸º16ä¸ªæ¡¶ï¼Œè¯¸å¦‚ get,put,remove ç­‰å¸¸ç”¨æ“ä½œåªé”å½“å‰éœ€è¦ç”¨åˆ°çš„æ¡¶</li>\n<li>ConcurrentHashMapä½¿ç”¨äº†ä¸€ç§ä¸åŒçš„è¿­ä»£æ–¹å¼ã€‚å½“ iteratorè¢«åˆ›å»ºåé›†åˆå†å‘ç”Ÿæ”¹å˜å°±ä¸å†æ˜¯æŠ›å‡ºConcurrentModificationExceptionå¼‚å¸¸ï¼Œè€Œæ˜¯åœ¨æ”¹å˜æ—¶newæ–°çš„æ•°æ®ä»è€Œä¸å½±å“åŸæœ‰çš„æ•°æ®ï¼Œiteratorå®Œæˆåå†å°†å¤´æŒ‡é’ˆæ›¿æ¢ä¸ºæ–°çš„æ•°æ® ï¼Œè¿™æ ·iteratorçº¿ç¨‹å¯ä»¥ä½¿ç”¨åŸæ¥è€çš„æ•°æ®ï¼Œè€Œå†™çº¿ç¨‹ä¹Ÿå¯ä»¥å¹¶å‘çš„å®Œæˆæ”¹å˜</li>\n</ul>\n<h2>ConcurrentHashMapçš„ç»“æ„</h2>\n<ul>\n<li>ConcurrentHashMapæ˜¯ç”±Segmentï¼ˆReentrantLockï¼‰æ•°ç»„ç»“æ„å’ŒHashEntry(å­˜å‚¨é”®å€¼å¯¹æ•°æ®)æ•°ç»„ç»“æ„ç»„æˆã€‚ä¸€ä¸ªConcurrentHashMapé‡ŒåŒ…å«ä¸€ä¸ªSegmentæ•°ç»„ã€‚ä¸€ä¸ªSegmenté‡ŒåŒ…å«ä¸€ä¸ªHashEntryæ•°ç»„ï¼Œæ¯ä¸ªSegmentå®ˆæŠ¤ç€ä¸€ä¸ªHashEntryæ•°ç»„é‡Œçš„å…ƒç´ ï¼Œå½“å¯¹HashEntryæ•°ç»„çš„æ•°æ®è¿›è¡Œä¿®æ”¹æ—¶ï¼Œå¿…é¡»é¦–å…ˆè·å¾—ä¸å®ƒå¯¹åº”çš„Segmenté”</li>\n<li>Segmentä¸HashMapç±»ä¼¼ï¼Œæ˜¯ä¸€ç§æ•°ç»„å’Œé“¾è¡¨ç»“æ„ã€‚æ¯ä¸ªHashEntryæ˜¯ä¸€ä¸ªé“¾è¡¨ç»“æ„çš„å…ƒç´ </li>\n</ul>\n<h2>ConcurrentHashMapçš„åˆå§‹åŒ–</h2>\n<ul>\n<li>ConcurrentHashMapåˆå§‹åŒ–æ–¹æ³•æ˜¯é€šè¿‡initialCapacityã€loadFactorå’ŒconcurrencyLevelç­‰å‡ ä¸ªå‚æ•°æ¥åˆå§‹åŒ–segmentæ•°ç»„ã€æ®µåç§»é‡segmentShiftã€æ®µæ©ç segmentMaskå’Œæ¯ä¸ªsegmenté‡Œçš„HashEntryæ•°ç»„æ¥å®ç°</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//è´Ÿè½½å› å­ï¼Œé»˜è®¤å€¼75%ã€‚å½“tableä½¿ç”¨ç‡è¾¾åˆ°75%ï¼Œä¸ºå‡å°‘hashç¢°æ’ï¼Œå°†tableçš„é•¿åº¦æ‰©å®¹ä¸€å€ã€‚\nprivate static final float LOAD_FACTOR = 0.75f;\n\n//é»˜è®¤å€¼ä¸º8ã€‚å½“é“¾è¡¨çš„é•¿åº¦å¤§äº8æ—¶ï¼Œç»“æ„ç”±é“¾è¡¨è½¬ä¸ºçº¢é»‘æ ‘ã€‚\nstatic final int TREEIFY_THRESHOLD = 8;\n\n//é»˜è®¤å€¼ä¸º6ï¼Œçº¢é»‘æ ‘è½¬ä¸ºé“¾è¡¨çš„é˜ˆå€¼ã€‚\nstatic final int UNTREEIFY_THRESHOLD = 6;\n\n//é»˜è®¤å€¼16.å½“tableæ‰©å®¹æ—¶ï¼Œæ¯ä¸ªçº¿ç¨‹æœ€å°‘è¿ç§»tableçš„æ§½ä½æ•°ã€‚\nprivate static final int MIN_TRANSFER_STRIDE = 16;\n\n//tableè¿ç§»è¿‡ç¨‹çš„ä¸´æ—¶å˜é‡ï¼Œåœ¨è¿ç§»è¿‡ç¨‹ä¸­å°†å…ƒç´ å…¨éƒ½è¿ç§»åˆ°nextTableä¸Šã€‚\nprivate transient volatile Node&lt;K,V&gt;[] nextTable;\n\n//è¡¨ç¤ºtableå®¹é‡ä»næ‰©å®¹åˆ°2næ—¶ï¼Œæ˜¯ä»ç´¢å¼•n-&gt;1å…ƒç´ å¼€å§‹è¿ç§»ï¼Œ transferIndexä»£è¡¨å½“å‰å·²ç»è¿ç§»çš„å…ƒç´ çš„ä¸‹æ ‡ã€‚\nprivate transient volatile int transferIndex; \n\n//ä¸€ä¸ªç‰¹æ®Šçš„NodeèŠ‚ç‚¹ï¼Œå…¶hashcode=MOVEDï¼Œä»£è¡¨æ­¤æ—¶tableæ­£åœ¨åšæ‰©å®¹ã€‚å½“ä¸‹ä¸€ä¸ªçº¿ç¨‹å‘è¿™ä¸ªå…ƒç´ æ’å…¥æ•°æ®æ—¶ï¼Œæ£€æŸ¥hashcode=MOVEDï¼Œå°±ä¼šå¸®ç€æ‰©å®¹ã€‚\nForwardingNode ï¼š\n\n\n//2^30è€Œä¸æ˜¯2^31åŸå› åœ¨äºintçš„èŒƒå›´æ˜¯ -2^31~2^31-1ï¼Œæ‰€ä»¥ä¼šè¶Šç•Œ(å®¹é‡æ˜¯è¦ä¸º 2^n)\nprivate static final int MAXIMUM_CAPACITY = 1 &lt;&lt; 30;\n\n/* è¡¨åˆå§‹åŒ–å’Œè°ƒæ•´å¤§å°æ§ä»¶ã€‚\n* å¦‚æœsizeCtl = 0ï¼Œè¡¨ç¤ºå“ˆå¸Œè¡¨æœªåˆå§‹åŒ–ï¼Œå¹¶ä¸”æ•°ç»„çš„åˆå§‹å®¹é‡æ˜¯16ï¼›\n* å¦‚æœsizeCtl = -1,è¡¨ç¤ºå“ˆå¸Œè¡¨æ­£åœ¨è¿›è¡Œåˆå§‹åŒ–ï¼›\n* å¦‚æœsizeCtl &lt; 0å¹¶ä¸”sizeCtl != -1ï¼Œè¡¨ç¤ºå“ˆå¸Œè¡¨æ­£åœ¨æ‰©å®¹ï¼ŒäºŒè¿›åˆ¶çš„ä½16ä½æ•°å€¼ä¸º M=(sizeCtl&amp;31)ï¼Œæ­¤æ—¶æœ‰M-1ä¸ªçº¿ç¨‹è¿›è¡Œæ‰©å®¹\n* sizeCtlé«˜16ä½è¡¨ç¤ºæ‰©å®¹æ ‡è®°ï¼Œä½16ä½è¡¨ç¤ºå¹¶è¡Œæ‰©å®¹çš„çº¿ç¨‹æ•°ï¼Œï¼ˆ16ä½ï¼‰\n* åˆå§‹åŒ–åï¼Œä¿å­˜è¦è°ƒæ•´è¡¨å¤§å°çš„ä¸‹ä¸€ä¸ªå…ƒç´ è®¡æ•°å€¼ã€‚\n*/\nprivate transient volatile int sizeCtl;\n\n\npublic ConcurrentHashMap(int initialCapacity) {\n    //æ ¡éªŒæŒ‡å®šçš„åˆå§‹å®¹é‡å¤§å°æ˜¯å¦å¤§äºç­‰äºæœ€å¤§å®¹é‡å¤§å°çš„ä¸€åŠ\n    //å¦‚æœå¤§äºç­‰äºæœ€å¤§å®¹é‡å¤§å°çš„ä¸€åŠåˆ™åœ¨åç»­ç¬¬ä¸€æ¬¡æ·»åŠ å…ƒç´ çš„æ—¶å€™ä½¿ç”¨æœ€å¤§å®¹é‡å¤§å°åˆ›å»ºæ•°ç»„\n    //å¦‚æœå°äºæœ€å¤§å®¹é‡å¤§å°çš„ä¸€åŠåˆ™æ ¹æ®æŒ‡å®šå®¹é‡æ¥è®¡ç®—æœ€æ¥è¿‘æŒ‡å®šå®¹é‡å¤§å°å¹¶å¤§äºæŒ‡å®šå®¹é‡çš„2çš„æ¬¡æ–¹\n    //æŒ‡å®šå®¹é‡å¤§å°å¦‚æœç­‰äºæœ€å¤§å®¹é‡å¤§å°çš„ä¸€åŠåˆ™è¯´æ˜æŒ‡å®šå®¹é‡å¤§å°æ˜¯2çš„29æ¬¡æ–¹,ä¸ºä»€ä¹ˆä¸ä½¿ç”¨æŒ‡å®šå®¹é‡å¤§å°,è€Œæ˜¯ä½¿ç”¨æœ€å¤§çš„å®¹é‡å¤§å°?å› ä¸ºå¦‚æœä½¿ç”¨çš„è¯å°±ä¼šè¶Šç•Œ\n    if (initialCapacity &lt; 0)\n        throw new IllegalArgumentException();\n    int cap = ((initialCapacity &gt;= (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ?\n                MAXIMUM_CAPACITY :\n                tableSizeFor(initialCapacity + (initialCapacity &gt;&gt;&gt; 1) + 1));\n    this.sizeCtl = cap;\n}\n\n/**\n* è·å¾—næœ€å¤§çš„2^næ•°\n* æ€è·¯ï¼š2^næœ¬è´¨æ˜¯1&gt;&gt;&gt;n(1åé¢å…¨éƒ¨æ˜¯0)ï¼Œå¯ä»¥ç”±n-1ä¸ª1ç»„æˆçš„æ•°åŠ 1å¾—åˆ°ï¼Œå³å…ˆæ±‚2^n-1æœ€åå†+1\n* å®ç°ï¼šä½¿ç”¨äº†æˆ–è¿ç®—æ€§è´¨å°†æŸäº›ä½ç½®ä¸º1ï¼Œç„¶åæ¯æ¬¡ç¿»å€å°†æ•°æ®ç½®ä¸º1\n* ä¹‹æ‰€ä»¥åœ¨å¼€å§‹ç§»ä½å‰å…ˆå°†å®¹é‡-1ï¼Œæ˜¯ä¸ºäº†é¿å…ç»™å®šå®¹é‡å·²ç»æ˜¯8,16è¿™æ ·2çš„å¹‚æ—¶ï¼Œä¸å‡ä¸€ç›´æ¥ç§»ä½ä¼šå¯¼è‡´å¾—åˆ°çš„ç»“æœæ¯”é¢„æœŸå¤§ã€‚æ¯”å¦‚é¢„æœŸ16å¾—åˆ°åº”è¯¥æ˜¯16ï¼Œç›´æ¥ç§»ä½çš„è¯ä¼šå¾—åˆ°32ã€‚åœ¨ä¸Šå›¾ä¸­å°±æ˜¯æ‰€æœ‰xæœ¬èº«å·²ç»æ˜¯0çš„æƒ…å†µä¸‹ï¼Œä¸å‡1å¾—åˆ°çš„ç»“æœå˜å¤§äº†ã€‚\n*/\nprivate static final int tableSizeFor(int c) {\n    int n = c - 1;\n    n |= n &gt;&gt;&gt; 1;\n    n |= n &gt;&gt;&gt; 2;\n    n |= n &gt;&gt;&gt; 4;\n    n |= n &gt;&gt;&gt; 8;\n    n |= n &gt;&gt;&gt; 16;\n    return (n &lt; 0) ? 1 : (n &gt;= MAXIMUM_CAPACITY) ? MAXIMUM_CAPACITY : n + 1;\n}\n\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1e11ee1378bca91c1d8d8.jpg\" alt=\"tableSizeForåŸç†.png\" tabindex=\"0\"><figcaption>tableSizeForåŸç†.png</figcaption></figure>\n<h2>ConcurrentHashMapçš„putæ–¹æ³•</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å€¼ä¸º-1ã€‚å½“Node.hashä¸ºMOVEDæ—¶ï¼Œä»£è¡¨tableæ­£åœ¨æ‰©å®¹ã€‚\nstatic final int MOVED = -1;\n\n//å€¼ä¸º-2ã€‚ä»£è¡¨æ­¤å…ƒç´ åæ¥çº¢é»‘æ ‘\nstatic final int TREEBIN = -2;\n\npublic V put(K key, V value) {\n    return putVal(key, value, false);\n}\n\n/** Implementation for put and putIfAbsent */\nfinal V putVal(K key, V value, boolean onlyIfAbsent) {\n    if (key == null || value == null) throw new NullPointerException();\n    int hash = spread(key.hashCode());\n    int binCount = 0;\n    for (Node&lt;K,V&gt;[] tab = table;;) {\n        Node&lt;K,V&gt; f; int n, i, fh;\n        if (tab == null || (n = tab.length) == 0)\n            tab = initTable();\n            // keyæ‰€åœ¨çš„æ¡¶æ²¡æœ‰ä¸€ä¸ªå…ƒç´ ï¼Œé‚£å°±ç›´æ¥å°†å½“å‰keyä½œä¸ºå¤´èŠ‚ç‚¹ï¼Œputæ“ä½œå®Œæˆ\n        else if ((f = tabAt(tab, i = (n - 1) &amp; hash)) == null) {\n            // CASè®¾ç½®å¤´èŠ‚ç‚¹ï¼Œå› ä¸ºå¯èƒ½æœ‰å…¶å®ƒçº¿ç¨‹ä¹Ÿåœ¨è®¾ç½®è¯¥å¤´èŠ‚ç‚¹\n            if (casTabAt(tab, i, null,\n                            new Node&lt;K,V&gt;(hash, key, value, null)))\n                break;                   // no lock when adding to empty bin\n        }\n        //å¦‚æœæ¡¶ä¸­çš„å…ƒç´ ä¸ä¸ºç©ºï¼Œé‚£å°±éœ€è¦ä»å¤´èŠ‚ç‚¹å¼€å§‹éå†ï¼Œæ³¨æ„ï¼Œè¿™é‡Œéå†çš„å¯èƒ½æ˜¯é“¾è¡¨ä¹Ÿå¯èƒ½æ˜¯çº¢é»‘æ ‘ã€‚\n        //å½“ put çš„æ—¶å€™å¦‚æœå‘ç°æ­£åœ¨æ‰©å®¹ï¼Œåˆ™éœ€è¦å¸®åŠ© map å®Œæˆæ‰©å®¹ï¼Œç›¸å½“äºæ‰©å®¹å¯èƒ½ç”±å¤šä¸ªçº¿ç¨‹æ¥å®Œæˆï¼Œ\n        else if ((fh = f.hash) == MOVED)//-1\n            tab = helpTransfer(tab, f);\n        else {\n            //æ¥ä¸‹æ¥å°±è¦ä»å¤´èŠ‚ç‚¹å¼€å§‹éå†äº†ï¼Œé“¾è¡¨ä½¿ç”¨çš„æ˜¯å°¾æ’æ³•ï¼Œå³æ–°èŠ‚ç‚¹ä½œä¸ºé“¾è¡¨æœ€åä¸€ä¸ªèŠ‚ç‚¹ã€‚\n            V oldVal = null;\n            synchronized (f) {\n                if (tabAt(tab, i) == f) {\n                    if (fh &gt;= 0) {//fh=f.hashå¦‚æœ=-1åˆ™åœ¨æ‰©å®¹ï¼Œ=-2åˆ™æ˜¯çº¢é»‘æ ‘ï¼Œæ‰€ä»¥&gt;=0æ˜¯é“¾è¡¨\n                        binCount = 1;\n                        for (Node&lt;K,V&gt; e = f;; ++binCount) {\n                            K ek;\n                            //å¦‚æœæ¯”è¾ƒhashä¸equalsæ–¹æ³•æœ‰å€¼åˆ™è¿”å›\n                            if (e.hash == hash &amp;&amp;\n                                ((ek = e.key) == key ||\n                                    (ek != null &amp;&amp; key.equals(ek)))) {\n                                oldVal = e.val;\n                                if (!onlyIfAbsent)\n                                    e.val = value;\n                                break;\n                            }\n                            //å€¼ä¸å­˜åœ¨åˆ™æ”¾å…¥é“¾è¡¨å°¾éƒ¨\n                            Node&lt;K,V&gt; pred = e;\n                            if ((e = e.next) == null) {\n                                pred.next = new Node&lt;K,V&gt;(hash, key,\n                                                            value, null);\n                                break;\n                            }\n                        }\n                    }\n                    else if (f instanceof TreeBin) {//çº¢é»‘æ ‘\n                        Node&lt;K,V&gt; p;\n                        binCount = 2;\n                        if ((p = ((TreeBin&lt;K,V&gt;)f).putTreeVal(hash, key,\n                                                        value)) != null) {\n                            oldVal = p.val;\n                            if (!onlyIfAbsent)\n                                p.val = value;\n                        }\n                    }\n                }\n            }\n            if (binCount != 0) {\n                if (binCount &gt;= TREEIFY_THRESHOLD)\n                    treeifyBin(tab, i);\n                if (oldVal != null)\n                    return oldVal;\n                break;\n            }\n        }\n    }\n    addCount(1L, binCount);\n    return null;\n}\n//å°†keyæœ¬èº«çš„hashå€¼çš„é«˜16ä½å‚åŠ è¿ç®—è·å–åˆ°æ–°çš„hashå€¼,å¦‚æœæ•°ç»„çš„é•¿åº¦çš„äºŒè¿›åˆ¶æ˜¯åœ¨ä½16ä½äºŒè¿›åˆ¶ä¸­å°±ä¼šå¯¼è‡´keyé«˜16ä½çš„äºŒè¿›åˆ¶æ²¡æœ‰å‚åŠ è¿ç®—\n//å®¹æ˜“å¯¼è‡´è¿ç®—åçš„keyçš„ç´¢å¼•ä½ç½®å‘ç”Ÿå†²çª,æ‰€ä»¥éœ€è¦å°†é«˜16ä½äºŒè¿›åˆ¶æ— ç¬¦å·å³ç§»16ä½ä¸åŸhashå€¼çš„äºŒè¿›åˆ¶è¿›è¡Œè¿ç®—å‡å°‘ç´¢å¼•å†²çªã€‚\n//static final int HASH_BITS = 0x7fffffff;\nstatic final int spread(int h) {\n    return (h ^ (h &gt;&gt;&gt; 16)) &amp; HASH_BITS;\n}\n\nprivate final Node&lt;K,V&gt;[] initTable() {\n    Node&lt;K,V&gt;[] tab; int sc;\n    //ç¬¬ã€Š1ã€‹æ­¥ï¼Œåˆ¤æ–­æ•°ç»„æ˜¯å¦æœªåˆå§‹åŒ–\n    while ((tab = table) == null || tab.length == 0) {\n        //ç¬¬ã€Š2ã€‹æ­¥ï¼Œç”¨scä¿å­˜sizeCtlçš„å€¼ï¼Œä½œä¸ºåé¢CASçš„é¢„æœŸå€¼\n        //ç¬¬ã€Š3ã€‹æ­¥åˆ¤æ–­sizeCtlçš„å€¼æ˜¯å¦&lt;0ï¼Œæ˜¯çš„è¯åˆ™å‘ç°æœ‰å…¶ä»–çº¿ç¨‹åœ¨åšæ•°æ®çš„åˆå§‹åŒ–ï¼Œè®©å‡ºCPU\n        if ((sc = sizeCtl) &lt; 0)\n            Thread.yield();\n        //èµ°åˆ°è¿™é‡Œï¼Œè¯´æ˜sizeCtl&gt;=0ï¼Œåˆ™æœ‰ä¸¤ç§æ¸…å†µï¼šä¸€æ˜¯æ•°ç»„æœªåˆå§‹åŒ–ã€‚\n        //äºŒæ˜¯æœ‰å…¶ä»–çº¿ç¨‹åœ¨ç¬¬ã€Š1ã€‹æ­¥ä¹‹åï¼Œç¬¬ã€Š2ã€‹æ­¥ä¹‹å‰å°†æ•°ç»„åˆå§‹åŒ–å®Œæˆï¼Œæ­¤æ—¶sizeCtlä¸ºæ•°ç»„çš„æ‰©å®¹é˜ˆå€¼.\n\n        //ç¬¬ã€Š4ã€‹æ­¥ï¼ŒCASå°†SIZECTLå€¼ä¿®æ”¹ä¸º-1ï¼Œè¡¨ç¤ºæœ¬çº¿ç¨‹å¼€å§‹è¿›è¡Œæ•°ç»„çš„åˆå§‹åŒ–\n        //å¦‚æœä¿®æ”¹æˆåŠŸï¼Œå¼€å§‹åˆå§‹åŒ–æ“ä½œï¼›å¦‚æœä¿®æ”¹å¤±è´¥ï¼Œåˆ™è¡¨ç¤ºæœ‰å…¶ä»–çº¿ç¨‹åœ¨ã€Š1ã€‹ã€Š2ã€‹ä¹‹åæŠ¢å…ˆä¿®æ”¹äº†SIZECTL\n        else if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {//ç«äº‰é”ï¼Œä¸ReentrantLockç›¸ä¼¼\n            try {\n                 /*ç¬¬ã€Š5ã€‹æ­¥ï¼Œdouble checkæ•°ç»„æ˜¯å¦åˆå§‹åŒ–ï¼Œè¿™é‡Œä¸ºä»€ä¹ˆè¦é‡‡ç”¨åŒé‡æ ¡éªŒå‘¢ï¼Ÿ\n                *å› ä¸ºåœ¨æ•°ç»„åˆå§‹åŒ–å®Œæˆä¹‹åï¼ŒsizeCtlçš„å€¼ä¼šï¼Œè¢«æ”¹æˆæ•°ç»„çš„æ‰©å®¹é˜ˆå€¼ï¼Œä¼šæ˜¯ä¸€ä¸ªå¤§äº0çš„å€¼ã€‚\n                *æ‰€ä»¥å®Œå…¨æœ‰å¯èƒ½æœ¬çº¿ç¨‹åœ¨ã€Š1ã€‹ä¹‹åï¼Œæœ‰å…¶ä»–çº¿ç¨‹å®Œæˆäº†æ•°ç»„çš„åˆå§‹åŒ–å…¨è¿‡ç¨‹ï¼Œ\n                * ä½¿å¾—æœ¬çº¿ç¨‹ä¹Ÿèƒ½è¿›åˆ°è¿™ä¸ªä»£ç å—é‡Œæ¥ã€‚\n                */\n                if ((tab = table) == null || tab.length == 0) {\n                    //ç¬¬ã€Š6ã€‹æ­¥ï¼Œæ‰§è¡Œå“ˆå¸Œè¡¨çš„åˆ›å»ºå·¥ä½œï¼Œ\n                    //ç¡®å®šå“ˆå¸Œè¡¨çš„å®¹é‡\n                    int n = (sc &gt; 0) ? sc : DEFAULT_CAPACITY;\n                    @SuppressWarnings(\"unchecked\")\n                    Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                    table = tab = nt;\n                    sc = n - (n &gt;&gt;&gt; 2);//ç¬¬sc=n-n/4ï¼Œä½œä¸ºæ‰©å®¹çš„é˜ˆå€¼ï¼Œèµ‹å€¼ç»™sc\n                }\n            } finally {\n                //ç¬¬ã€Š7ã€‹æ­¥ï¼Œå¦‚æœåˆå§‹åŒ–å®Œæˆï¼ŒsizeCtlè®°å½•çš„æ˜¯æ‰©å®¹é˜ˆå€¼ï¼›\n                //å¦‚æœåˆå§‹åŒ–å¤±è´¥ï¼Œåˆ™è¿˜åŸsizeCtl\n                sizeCtl = sc;\n            }\n            //èµ°åˆ°è¿™é‡Œï¼Œè¯´æ˜æœ¬çº¿ç¨‹åˆå§‹åŒ–å®Œæˆäº†æˆ–è€…å…¶ä»–çº¿ç¨‹åœ¨æœ¬çº¿ç¨‹çš„\n            //ã€Š1ã€‹ã€ã€Š2ã€‹ä¸¤æ­¥ä¹‹é—´å®Œæˆäº†å“ˆå¸Œè¡¨çš„åˆå§‹åŒ–å…¨è¿‡ç¨‹ï¼Œæ­¤æ—¶ç»“æŸå¾ªç¯\n            break;\n        }\n        //èµ°åˆ°è¿™é‡Œï¼Œè¯´æ˜åœ¨å‘ç°æ•°ç»„æœªåˆå§‹åŒ–ä¹‹åï¼Œå‡†ç¡®åˆå§‹åŒ–ä¹‹å‰ï¼Œ\n        //æœ‰å…¶ä»–çº¿ç¨‹å·²ç»æŠ¢å…ˆå¼€å§‹åˆå§‹åŒ–äº†\n        //ä½†æ˜¯å…¶ä»–çº¿ç¨‹æ˜¯å¦å°†åˆå§‹åŒ–çš„å·¥ä½œå…¨éƒ¨æ­£ç¡®çš„å®Œæˆï¼Œå¹¶ä¸çŸ¥é“ï¼Œæ‰€ä»¥é‡æ–°å¼€å§‹å¾ªç¯æ£€æŸ¥\n    }\n    return tab;\n}\n// è·å–objå¯¹è±¡ä¸­offsetåç§»åœ°å€å¯¹åº”çš„objectå‹fieldçš„å€¼,æ”¯æŒvolatile loadè¯­ä¹‰ã€‚\npublic native Object getObjectVolatile(Object obj, long offset);\n\n//è·å–æ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„åç§»é‡,ä¸arrayIndexScaleé…åˆè®¿é—®æ•°ç»„æŒ‡å®šå…ƒç´ \npublic native int arrayBaseOffset(java.lang.Class aClass);\n\n//è·å–æ•°ç»„ä¸­ä¸€ä¸ªå…ƒç´ çš„å¤§å°\npublic native int arrayIndexScale(java.lang.Class aClass);\n\n/**\n* ABASE = U.arrayBaseOffset(Node[].class);//Node[].classæ•°ç»„ä¸­ç¬¬ä¸€ä¸ªå…ƒç´ çš„åç§»é‡\n* ASHIFT = 31 - Integer.numberOfLeadingZeros(U.arrayIndexScale(Node[].class));//intèŒƒå›´2^31-1ï¼Œ31-å‰ç¼€0ä¸ªæ•°å¾—åˆ°æ¯ä¸ªå…ƒç´ å®é™…ä½æ•°\n* æ•°ç»„çš„å…ƒç´ ä½ç½®=æ•°ç»„ç¬¬ä¸€ä¸ªå…ƒç´ åç§»é‡+ç´¢å¼•i * æ¯ä¸ªå…ƒç´ å®é™…ä½æ•°\n*/\nstatic final &lt;K,V&gt; Node&lt;K,V&gt; tabAt(Node&lt;K,V&gt;[] tab, int i) {\n    return (Node&lt;K,V&gt;)U.getObjectVolatile(tab, ((long)i &lt;&lt; ASHIFT) + ABASE);\n}\n//è¿”å›æ— ç¬¦å·æ•´å‹içš„æœ€é«˜éé›¶ä½å‰é¢çš„nä¸ª0çš„ä¸ªæ•°ï¼ŒåŒ…æ‹¬ç¬¦å·ä½ã€‚å¦‚æœiå°äº0åˆ™è¿”å›0ï¼Œç­‰äº0åˆ™è¿”å›32ã€‚\n//ä¾‹ï¼š10çš„äºŒè¿›åˆ¶ä¸ºï¼š0000 0000 0000 0000 0000 0000 0000 1010 javaçš„inté•¿åº¦ä¸º32ä½ï¼Œæ–¹æ³•è¿”å›çš„å°±æ˜¯28ã€‚\npublic static int numberOfLeadingZeros(int i) {\n    // HD, Figure 5-6\n    if (i == 0)\n        return 32;\n    int n = 1;\n    if (i &gt;&gt;&gt; 16 == 0) { n += 16; i &lt;&lt;= 16; }//äºŒåˆ†æ³•32/2=16\n    if (i &gt;&gt;&gt; 24 == 0) { n +=  8; i &lt;&lt;=  8; }//äºŒåˆ†æ³•16/2=8 + 16\n    if (i &gt;&gt;&gt; 28 == 0) { n +=  4; i &lt;&lt;=  4; }//äºŒåˆ†æ³• 8/2=4 + 8 + 16\n    if (i &gt;&gt;&gt; 30 == 0) { n +=  2; i &lt;&lt;=  2; }//äºŒåˆ†æ³• 4/2=2 + 4 + 8 + 16\n    n -= i &gt;&gt;&gt; 31; //2/2=1 + 2 + 4 + 8 + 16\n    return n;\n}\n\nstatic final &lt;K,V&gt; boolean casTabAt(Node&lt;K,V&gt;[] tab, int i,\n                                    Node&lt;K,V&gt; c, Node&lt;K,V&gt; v) {\n    return U.compareAndSwapObject(tab, ((long)i &lt;&lt; ASHIFT) + ABASE, c, v);\n}\n/**\n* åˆ¤æ–­æ˜¯å¦éœ€è¦æ‰©å®¹\n*/\nprivate final void addCount(long x, int check) {\n    CounterCell[] as; long b, s;\n    if ((as = counterCells) != null ||\n        !U.compareAndSwapLong(this, BASECOUNT, b = baseCount, s = b + x)) {\n        CounterCell a; long v; int m;\n        boolean uncontended = true;\n        if (as == null || (m = as.length - 1) &lt; 0 ||\n            (a = as[ThreadLocalRandom.getProbe() &amp; m]) == null ||\n            !(uncontended =\n                U.compareAndSwapLong(a, CELLVALUE, v = a.value, v + x))) {\n            fullAddCount(x, uncontended);\n            return;\n        }\n        if (check &lt;= 1)\n            return;\n        s = sumCount();\n    }\n    if (check &gt;= 0) {\n        Node&lt;K,V&gt;[] tab, nt; int n, sc;\n        while (s &gt;= (long)(sc = sizeCtl) &amp;&amp; (tab = table) != null &amp;&amp;\n                (n = tab.length) &lt; MAXIMUM_CAPACITY) {\n            int rs = resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT;\n            if (sc &lt; 0) {\n                if (sc == rs + MAX_RESIZERS || sc == rs + 1 ||\n                    (nt = nextTable) == null || transferIndex &lt;= 0)\n                    break;\n                if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1))\n                    transfer(tab, nt);\n            }\n            else if (U.compareAndSwapInt(this, SIZECTL, sc, rs + 2))\n                transfer(tab, null);\n            s = sumCount();\n        }\n    }\n}\n//æ¡¶è¿›è¡Œæ ‘åŒ–çš„æœ€å°è¡¨å®¹é‡ã€‚(å¦‚æœä¸€ä¸ªbinä¸­çš„èŠ‚ç‚¹å¤ªå¤šï¼Œåˆ™ä¼šè°ƒæ•´è¡¨çš„å¤§å°)è¯¥å€¼åº”è‡³å°‘ä¸º4 * TREEIFY_THRESHOLDï¼Œä»¥é¿å…è°ƒæ•´å¤§å°é˜ˆå€¼ä¸æ ‘åŒ–é˜ˆå€¼ä¹‹é—´çš„å†²çªã€‚\nstatic final int MIN_TREEIFY_CAPACITY = 64;\n\nprivate final void treeifyBin(Node&lt;K,V&gt;[] tab, int index) {\n    Node&lt;K,V&gt; b; int n, sc;\n    if (tab != null) {\n        if ((n = tab.length) &lt; MIN_TREEIFY_CAPACITY)\n            tryPresize(n &lt;&lt; 1);\n        else if ((b = tabAt(tab, index)) != null &amp;&amp; b.hash &gt;= 0) {\n            synchronized (b) {\n                if (tabAt(tab, index) == b) {\n                    TreeNode&lt;K,V&gt; hd = null, tl = null;\n                    for (Node&lt;K,V&gt; e = b; e != null; e = e.next) {\n                        TreeNode&lt;K,V&gt; p =\n                            new TreeNode&lt;K,V&gt;(e.hash, e.key, e.val,\n                                                null, null);\n                        if ((p.prev = tl) == null)\n                            hd = p;\n                        else\n                            tl.next = p;\n                        tl = p;\n                    }\n                    setTabAt(tab, index, new TreeBin&lt;K,V&gt;(hd));\n                }\n            }\n        }\n    }\n}\n\n\n//2æ¬¡æ–¹ä¸ªæ•°çš„æ•°ç»„\ntransient volatile Node&lt;K,V&gt;[] table;\n\n//åœ¨sizeCtlä¸­ç”¨äºç”Ÿæˆæˆ³çš„ä½æ•°ã€‚å¯¹äº32ä½æ•°ç»„ï¼Œå¿…é¡»è‡³å°‘ä¸º6ã€‚æ— æ³•ä¿®æ”¹\nprivate static int RESIZE_STAMP_BITS = 16;\n\n//åœ¨sizeCtlä¸­è®°å½•ç”Ÿæˆæˆ³çš„ä½ç§»ã€‚æ— æ³•ä¿®æ”¹\nprivate static final int RESIZE_STAMP_SHIFT = 32 - RESIZE_STAMP_BITS;\n\n//å°è¯•è°ƒæ•´è¡¨çš„å¤§å°ä»¥å®¹çº³ç»™å®šæ•°é‡çš„å…ƒç´ ã€‚\nprivate final void tryPresize(int size) {\n    //è·å¾—næœ€æ¥è¿‘çš„2^n ï¼Œå…¶ä¸­sizeåœ¨ä¼ å…¥ä¹‹å‰å°±å·²ç»ç¿»å€äº†ï¼Œæœ€ç»ˆcæ˜¯ä¸€ä¸ªå¤§äºç­‰äºï¼ˆsize * 1.5 + 1ï¼‰çš„2çš„å¹‚æ¬¡æ–¹æ•°\n    int c = (size &gt;= (MAXIMUM_CAPACITY &gt;&gt;&gt; 1)) ? MAXIMUM_CAPACITY :\n        tableSizeFor(size + (size &gt;&gt;&gt; 1) + 1);\n    int sc;\n    while ((sc = sizeCtl) &gt;= 0) {\n        Node&lt;K,V&gt;[] tab = table; int n;\n        if (tab == null || (n = tab.length) == 0) {//å¦‚æœä¸´æ—¶æ•°ç»„ä¸ºnullï¼Œåˆ™åˆå§‹åŒ–ä¸´æ—¶æ•°ç»„ï¼Œå°è¯•å°†SIZECTLå˜ä¸º-1æ‰©å®¹ä¸­\n            n = (sc &gt; c) ? sc : c;\n            if (U.compareAndSwapInt(this, SIZECTL, sc, -1)) {\n                try {\n                    if (table == tab) {\n                        @SuppressWarnings(\"unchecked\")\n                        Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n];\n                        table = nt;\n                        sc = n - (n &gt;&gt;&gt; 2);\n                    }\n                } finally {\n                    sizeCtl = sc;\n                }\n            }\n        }\n        else if (c &lt;= sc || n &gt;= MAXIMUM_CAPACITY)//å®¹é‡å°äºæ§åˆ¶å®¹é‡ï¼Œæˆ–è€…å¤§äºæ¡¶æœ€å¤§å®¹é‡åˆ™è·³å‡ºå¾ªç¯\n            break;\n        else if (tab == table) {\n             /**\n             *  è¿”å›å€¼ä½œä¸ºæ­£åœ¨æ‰©å®¹æ•°ç»„çš„é•¿åº¦nçš„ä¸€ä¸ªæ ‡å¿—ä½,å¹¶ä¸”å½“å‘å·¦ç§»RESIZE_STAMP_SHIFT=16ä½æ—¶å¾—åˆ°ä¸€ä¸ªè´Ÿæ•°\n             * æ‰©å®¹æˆ³ä¸ºå•¥è¿™ä¹ˆè®¾ç½®æœªçŸ¥\n             * static final int resizeStamp(int n) {\n             *   return Integer.numberOfLeadingZeros(n) | (1 &lt;&lt; (RESIZE_STAMP_BITS - 1));\n             * }\n             *   Integer.numberOfLeadingZeros(n)åœ¨æŒ‡å®š int å€¼çš„äºŒè¿›åˆ¶è¡¥ç è¡¨ç¤ºå½¢å¼ä¸­æœ€é«˜ä½ï¼ˆæœ€å·¦è¾¹ï¼‰çš„ 1 ä½ä¹‹å‰ï¼Œè¿”å›é›¶ä½çš„æ•°é‡\n             * ä¾‹å¦‚ nä¸º16 0001 0000 åˆ™Integer.numberOfLeadingZeros(n)ä¸º27ï¼Œå› ä¸ºnä¸º2çš„å¹‚æ¬¡æ–¹ï¼Œå› æ­¤ä¸åŒçš„næ­¤ç»“æœä¹Ÿä¸åŒ\n             * ç„¶åä¸(1 &lt;&lt; (RESIZE_STAMP_BITS - 1)) | ï¼Œç›¸å½“äº2^15 | nä¸­å·¦è¾¹0çš„ä¸ªæ•°ã€‚\n             * (å› æ­¤å…¶å·¦ç§»16ä½åç¬¦å·ä½ä¸º1ï¼Œç»“æœè‚¯å®šæ˜¯ä¸ªè´Ÿæ•°)\n             */\n            int rs = resizeStamp(n);\n            if (sc &lt; 0) {//è¡¨æ˜åœ¨-1åˆå§‹åŒ–ä¸­æˆ–è€…-2æ ‘çŠ¶æ€\n                Node&lt;K,V&gt;[] nt;\n                /**1.ç¬¬ä¸€ä¸ªåˆ¤æ–­ scå³ç§»RESIZE_STAMP_SHIFTä½ï¼Œä¹Ÿå°±æ˜¯æ¯”è¾ƒé«˜ESIZE_STAMP_BITSä½ç”Ÿæˆæˆ³å’Œrsæ˜¯å¦ç›¸ç­‰\n                    * ç›¸ç­‰åˆ™ä»£è¡¨æ˜¯åŒä¸€ä¸ªnï¼Œæ˜¯åœ¨åŒä¸€å®¹é‡ä¸‹è¿›è¡Œçš„æ‰©å®¹ï¼Œ\n                    *  2.ç¬¬äºŒä¸ªå’Œç¬¬ä¸‰ä¸ªåˆ¤æ–­ åˆ¤æ–­å½“å‰å¸®åŠ©æ‰©å®¹çº¿ç¨‹æ•°æ˜¯å¦å·²è¾¾åˆ°MAX_RESIZERSæœ€å¤§æ‰©å®¹çº¿ç¨‹æ•°\n                    *  3.ç¬¬å››ä¸ªå’Œç¬¬äº”ä¸ªåˆ¤æ–­ ä¸ºäº†ç¡®ä¿transfer()æ–¹æ³•åˆå§‹åŒ–å®Œæ¯•\n                    */\n                if ((sc &gt;&gt;&gt; RESIZE_STAMP_SHIFT) != rs || sc == rs + 1 ||\n                    sc == rs + MAX_RESIZERS || (nt = nextTable) == null ||\n                    transferIndex &lt;= 0)\n                    break;\n                if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1))\n                    transfer(tab, nt);\n            }\n             /**å¦‚æœæ²¡æœ‰çº¿ç¨‹åœ¨è¿›è¡Œæ‰©å®¹ï¼Œé‚£ä¹ˆcasä¿®æ”¹sizeCtlå€¼ï¼Œä½œä¸ºæ‰©å®¹çš„å‘èµ·ï¼Œrså·¦ç§»RESIZE_STAMP_SHIFTä½+2\n            * ä¸Šé¢è¯´äº†ï¼Œå·¦ç§»RESIZE_STAMP_SHIFTä½ï¼Œè‚¯å®šæ˜¯ä¸ªè´Ÿæ•°ï¼Œä»£è¡¨æœ‰ä¸€ä¸ªçº¿ç¨‹æ­£åœ¨è¿›è¡Œæ‰©å®¹\n            * æ­¤æ—¶sizeCtlé«˜RESIZE_STAMP_BITSä½ä¸ºç”Ÿæˆæˆ³ï¼Œä½RESIZE_STAMP_SHIFTä½ä¸ºæ‰©å®¹çº¿ç¨‹æ•°\n            * +2åŸå› æœªçŸ¥\n            */\n            else if (U.compareAndSwapInt(this, SIZECTL, sc,\n                                            (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2))\n                transfer(tab, null);\n        }\n    }\n}\n\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>static final int NCPU = Runtime.getRuntime().availableProcessors();\n\n//æ¯ä¸ªè½¬æ¢çº¢é»‘æ ‘æ­¥éª¤çš„æœ€å°é‡æ–°ç»‘å®šæ•°ã€‚èŒƒå›´è¢«ç»†åˆ†ä»¥å…è®¸å¤šä¸ªè°ƒæ•´å¤§å°çº¿ç¨‹ã€‚æ­¤å€¼ç”¨ä½œä¸‹é™ï¼Œä»¥é¿å…è°ƒæ•´å¤§å°å™¨é‡åˆ°è¿‡å¤šçš„å†…å­˜äº‰ç”¨ã€‚è¯¥å€¼è‡³å°‘ä¸ºDEFAULT_CAPACITYã€‚\nprivate static final int MIN_TRANSFER_STRIDE = 16;\n\nprivate static final long TRANSFERINDEX = U.objectFieldOffset(k.getDeclaredField(\"transferIndex\"));\n\nprivate final void transfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt;[] nextTab) {\n    int n = tab.length, stride;\n    //å°† (n&gt;&gt;&gt;3ç›¸å½“äº n/8) ç„¶åé™¤ä»¥ CPUæ ¸å¿ƒæ•°ã€‚å¦‚æœå¾—åˆ°çš„ç»“æœå°äº 16ï¼Œé‚£ä¹ˆå°±ä½¿ç”¨16\n    //strideæ¯ä¸ªçº¿ç¨‹è´Ÿè´£è¿ç§»æ•°æ®çš„åŒºåŸŸé•¿åº¦ï¼›ç›®çš„æ˜¯è®©æ¯ä¸ª CPU å¤„ç†çš„æ¡¶ä¸€æ ·å¤šï¼Œé¿å…å‡ºç°è½¬ç§»ä»»åŠ¡ä¸å‡åŒ€çš„ç°è±¡ï¼Œé»˜è®¤16\n    if ((stride = (NCPU &gt; 1) ? (n &gt;&gt;&gt; 3) / NCPU : n) &lt; MIN_TRANSFER_STRIDE)\n        stride = MIN_TRANSFER_STRIDE; // subdivide range\n         //nextTabæœªåˆå§‹åŒ–ï¼ŒnextTabæ˜¯ç”¨æ¥æ‰©å®¹çš„nodeæ•°ç»„\n    if (nextTab == null) {            // initiating\n        try {\n            @SuppressWarnings(\"unchecked\")\n            //æ‰©å®¹2å€\n            Node&lt;K,V&gt;[] nt = (Node&lt;K,V&gt;[])new Node&lt;?,?&gt;[n &lt;&lt; 1];\n            nextTab = nt;\n        } catch (Throwable ex) {      // try to cope with OOME\n            //æ‰©å®¹å¤±è´¥ï¼ŒsizeCtlä½¿ç”¨intçš„æœ€å¤§å€¼\n            sizeCtl = Integer.MAX_VALUE;\n            return;\n        }\n        nextTable = nextTab;//èµ‹å€¼ç»™ä¸´æ—¶tableï¼Œåœ¨æ‰©å®¹æ—¶ï¼Œç”±åˆ›å»ºæ–°æ•°ç»„çš„çº¿ç¨‹åˆå§‹åŒ–è¿™ä¸ªå˜é‡ï¼›æ‰©å®¹å®Œæˆåï¼Œå°†å…¶è®¾ç½®ä¸ºnullï¼›\n        transferIndex = n;//è®°å½•ä¸‹ä¸€ä¸ªçº¿ç¨‹è¿ç§»æ•°æ®çš„èµ·å§‹ä½ç½®ï¼›transferIndex-1å°±æ˜¯ä¸‹ä¸€ä¸ªçº¿ç¨‹è¿ç§»æ•°æ®çš„èµ·å§‹ä¸‹æ ‡ï¼›\n    }\n    int nextn = nextTab.length;\n    //åˆ›å»ºä¸€ä¸ª fwd èŠ‚ç‚¹ï¼Œè¡¨ç¤ºä¸€ä¸ªæ­£åœ¨è¢«è¿ç§»çš„Nodeï¼Œå¹¶ä¸”å®ƒçš„hashå€¼ä¸º-1(MOVED)ï¼Œputvalæ–¹æ³•ä¼šæœ‰ä¸€ä¸ªåˆ¤æ–­MOVEDçš„é€»è¾‘ã€‚å®ƒçš„ä½œç”¨æ˜¯ç”¨æ¥å ä½ï¼Œè¡¨ç¤ºåŸæ•°ç»„ä¸­ä½ç½®iå¤„çš„èŠ‚ç‚¹å®Œæˆè¿ç§»ä»¥åï¼Œå°±ä¼šåœ¨iä½ç½®è®¾ç½®ä¸€ä¸ªfwdæ¥å‘Šè¯‰å…¶ä»–çº¿ç¨‹è¿™ä¸ªä½ç½®å·²ç»å¤„ç†è¿‡äº†\n    ForwardingNode&lt;K,V&gt; fwd = new ForwardingNode&lt;K,V&gt;(nextTab);\n    boolean advance = true;\n    boolean finishing = false; // to ensure sweep before committing nextTab\n    for (int i = 0, bound = 0;;) {\n        Node&lt;K,V&gt; f; int fh;\n        // è¿™ä¸ªå¾ªç¯ä½¿ç”¨CASä¸æ–­å°è¯•ä¸ºå½“å‰çº¿ç¨‹åˆ†é…ä»»åŠ¡ ç›´åˆ°åˆ†é…æˆåŠŸæˆ–ä»»åŠ¡é˜Ÿåˆ—å·²ç»è¢«å…¨éƒ¨åˆ†é…å®Œæ¯•\n        // å¦‚æœå½“å‰çº¿ç¨‹å·²ç»è¢«åˆ†é…è¿‡bucketåŒºåŸŸ é‚£ä¹ˆä¼šé€šè¿‡--iæŒ‡å‘ä¸‹ä¸€ä¸ªå¾…å¤„ç†bucketç„¶åé€€å‡ºè¯¥å¾ªç¯\n        while (advance) {\n            //nextIndex=transferIndexï¼Œæ•°æ®è¿ç§»çš„èµ·å§‹ä¸‹æ ‡\n            //nextBound=transferIndex-strideæˆ–è€…0ä¸‹ä¸€ä¸ªçº¿ç¨‹å¤„ç†çš„èµ·å§‹ä½ç½®\n            //bound(è¾¹ç•Œ)=nextBound/0æ˜¯çº¿ç¨‹è¿ç§»æ•°æ®çš„ç»“æŸä½ç½®ï¼›ç­‰äº0æˆ–è€…\n            int nextIndex, nextBound;\n            //i=nextIndex-1æ˜¯æ¯ä¸ªå¾…å¤„ç†èŠ‚ç‚¹åŒºé—´çš„ç´¢å¼•ï¼Œä»å°¾éƒ¨å¼€å§‹éå† --iè¡¨ç¤ºä¸‹ä¸€ä¸ªå¾…å¤„ç†çš„bucketï¼Œå¦‚æœå®ƒ&gt;=bound,è¡¨ç¤ºå½“å‰çº¿ç¨‹å·²ç»åˆ†é…è¿‡bucketåŒºåŸŸï¼Œé€€å‡ºwhileå¾ªç¯\n            //finishingæ˜¯è¿ç§»æ•°æ®ç»“æŸåçš„æ ‡å¿—\n            if (--i &gt;= bound || finishing)\n                advance = false;\n            //è¡¨ç¤ºæ‰€æœ‰bucketå·²ç»è¢«åˆ†é…å®Œæ¯• ç»™nextIndexèµ‹äºˆåˆå§‹å€¼ = 16(nextIndex=transferIndex=n=tab.length) =24    \n            else if ((nextIndex = transferIndex) &lt;= 0) {\n                i = -1;\n                advance = false;\n            }\n            //é€šè¿‡casæ¥ä¿®æ”¹TRANSFERINDEX(å…¶å®å°±æ˜¯transferIndex),ä¸ºå½“å‰çº¿ç¨‹åˆ†é…ä»»åŠ¡,ç¡®å®šå¤„ç†çš„èŠ‚ç‚¹åŒºé—´ä¸º[nextBound,nextIndex] =&gt; [bound,i=nextIndex-1]  \n            //transferIndexä¿®æ”¹ä¹‹å‰çš„å€¼æ˜¯è¿ç§»æ•°æ®çš„èµ·å§‹ä½ç½®ï¼Œä¿®æ”¹ä¹‹åçš„å€¼æ˜¯ç»“æŸä½ç½®ï¼›ä¹Ÿä½œä¸ºä¸‹ä¸€ä¸ªçº¿ç¨‹çš„è¿ç§»æ•°æ®çš„èµ·å§‹ä½ç½®ï¼›\n            else if (U.compareAndSwapInt\n                        (this, TRANSFERINDEX, nextIndex,\n                        nextBound = (nextIndex &gt; stride ? nextIndex - stride : 0))) {\n                bound = nextBound;\n                i = nextIndex - 1;\n                advance = false;\n            }\n        }\n        //i&lt;0è¯´æ˜å·²ç»éå†å®Œæ—§çš„æ•°ç»„ï¼Œä¹Ÿå°±æ˜¯å½“å‰çº¿ç¨‹å·²ç»å¤„ç†å®Œæ‰€æœ‰è´Ÿè´£çš„bucket\n        if (i &lt; 0 || i &gt;= n || i + n &gt;= nextn) {\n            int sc;\n             //å¦‚æœå®Œæˆäº†æ‰©å®¹\n            if (finishing) {\n                //åˆ é™¤æˆå‘˜å˜é‡\n                nextTable = null;\n                //æ›´æ–°tableæ•°ç»„\n                table = nextTab;\n                //æ›´æ–°é˜ˆå€¼ ç¿»å€å‡å» 0.25 ï¼Œä¸ºæ–°æ•°ç»„å¤§å°çš„ 0.75 å€çš„é˜ˆå€¼\n                sizeCtl = (n &lt;&lt; 1) - (n &gt;&gt;&gt; 1);\n                return;\n            }\n            // sizeCtl åœ¨è¿ç§»å‰ä¼šè®¾ç½®ä¸º (rs &lt;&lt; RESIZE_STAMP_SHIFT) + 2\n            // ç„¶åï¼Œæ¯å¢åŠ ä¸€ä¸ªçº¿ç¨‹å‚ä¸è¿ç§»å°±ä¼šå°† sizeCtl åŠ  1ï¼Œ\n            // è¿™é‡Œä½¿ç”¨ CAS æ“ä½œå¯¹ sizeCtl çš„ä½16ä½è¿›è¡Œå‡ 1ï¼Œä»£è¡¨åšå®Œäº†å±äºè‡ªå·±çš„ä»»åŠ¡\n            if (U.compareAndSwapInt(this, SIZECTL, sc = sizeCtl, sc - 1)) {\n                //ç¬¬ä¸€ä¸ªæ‰©å®¹çš„çº¿ç¨‹ï¼Œæ‰§è¡Œtransferæ–¹æ³•ä¹‹å‰ï¼Œä¼šè®¾ç½® sizeCtl = (resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT) + 2\n                //åç»­å¸®å…¶æ‰©å®¹çš„çº¿ç¨‹ï¼Œæ‰§è¡Œtransferæ–¹æ³•ä¹‹å‰ï¼Œä¼šè®¾ç½® sizeCtl = sizeCtl+1\n                //æ¯ä¸€ä¸ªé€€å‡ºtransferçš„æ–¹æ³•çš„çº¿ç¨‹ï¼Œé€€å‡ºä¹‹å‰ï¼Œä¼šè®¾ç½® sizeCtl = sizeCtl-1\n                //é‚£ä¹ˆæœ€åä¸€ä¸ªçº¿ç¨‹é€€å‡ºæ—¶ï¼šå¿…ç„¶æœ‰\n                //sc == (resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT) + 2ï¼Œå³ (sc - 2) == resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT\n                // å¦‚æœ sc - 2 ä¸ç­‰äºæ ‡è¯†ç¬¦å·¦ç§» 16 ä½ã€‚å¦‚æœä»–ä»¬ç›¸ç­‰äº†ï¼Œè¯´æ˜æ²¡æœ‰çº¿ç¨‹åœ¨å¸®åŠ©ä»–ä»¬æ‰©å®¹äº†ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œæ‰©å®¹ç»“æŸäº†ã€‚\n                if ((sc - 2) != resizeStamp(n) &lt;&lt; RESIZE_STAMP_SHIFT)\n                    return;\n                // å¦‚æœç›¸ç­‰ï¼Œæ‰©å®¹ç»“æŸäº†ï¼Œæ›´æ–° finising å˜é‡\n                finishing = advance = true;\n                // å†æ¬¡å¾ªç¯æ£€æŸ¥ä¸€ä¸‹æ•´å¼ è¡¨\n                i = n; // recheck before commit\n            }\n        }\n         // å¦‚æœä½ç½® i å¤„æ˜¯ç©ºçš„ï¼Œæ²¡æœ‰ä»»ä½•èŠ‚ç‚¹ï¼Œé‚£ä¹ˆæ”¾å…¥åˆšåˆšåˆå§‹åŒ–çš„ ForwardingNode â€ç©ºèŠ‚ç‚¹â€œ\n        else if ((f = tabAt(tab, i)) == null)\n            advance = casTabAt(tab, i, null, fwd);\n        //è¡¨ç¤ºè¯¥ä½ç½®å·²ç»å®Œæˆäº†è¿ç§»ï¼Œä¹Ÿå°±æ˜¯å¦‚æœçº¿ç¨‹Aå·²ç»å¤„ç†è¿‡è¿™ä¸ªèŠ‚ç‚¹ï¼Œé‚£ä¹ˆçº¿ç¨‹Bå¤„ç†è¿™ä¸ªèŠ‚ç‚¹æ—¶ï¼Œhashå€¼ä¸€å®šä¸ºMOVED    \n        else if ((fh = f.hash) == MOVED)\n            advance = true; // already processed\n        else {\n            //å¤„ç†èŠ‚ç‚¹\n            synchronized (f) {\n                if (tabAt(tab, i) == f) {//åŒé‡æ ¡éªŒ\n                    Node&lt;K,V&gt; ln, hn;\n                    if (fh &gt;= 0) {//fh=f.hashå¦‚æœ=-1åˆ™åœ¨æ‰©å®¹ï¼Œ=-2åˆ™æ˜¯çº¢é»‘æ ‘ï¼Œæ‰€ä»¥&gt;=0æ˜¯é“¾è¡¨\n                        int runBit = fh &amp; n;//åªæœ‰0 å’Œnä¸¤ç§å–å€¼ï¼›ç»“æœæ˜¯0ï¼Œè¡¨ç¤ºæ‰©å®¹åä½ç½®ä¸å˜ï¼›ç»“æœä¸ä¸º0ï¼Œè¡¨ç¤ºæ‰©å®¹åä½ç½®ï¼ši+nï¼›\n                        //é“¾è¡¨ä¸Šçš„èŠ‚ç‚¹ï¼Œåœ¨æ‰©å®¹ä¹‹åä¼šåˆ†æˆ2æ¡é“¾è¡¨.è€Œè¿™æ¡é“¾è¡¨ä¸Šæœ‰å“ªäº›èŠ‚ç‚¹æ‰©å®¹ä¹‹åä½ç½®è¦æ”¹å˜çš„å“ªäº›èŠ‚ç‚¹ä½ç½®æ˜¯ä¸æ”¹å˜çš„ï¼Œè¿™ä¸¤ç§èŠ‚ç‚¹åœ¨é“¾è¡¨ä¸Šçš„åˆ†å¸ƒæ˜¯ä¸ç¡®å®šçš„ï¼›\n                        //å¯ä»¥å°†è¿ç»­ç›¸åŒçš„èŠ‚ç‚¹çœ‹ä½œæ˜¯ä¸€æ®µé“¾è¡¨ï¼ˆä¸€ä¸ªèŠ‚ç‚¹ä¹Ÿæ˜¯ä¸€æ®µé“¾è¡¨ï¼‰ï¼Œé‚£ä¹ˆè¿™æ¡é“¾è¡¨å°±å¯ä»¥çœ‹ä½œ2ç§é“¾è¡¨ç»„åˆç»„æˆçš„ï¼›\n                        //è€ŒlastRunï¼Œæ˜¯æŒ‡å‘æœ€åä¸€æ®µé“¾è¡¨çš„å¤´èŠ‚ç‚¹ï¼›å†é…åˆrunBitï¼ˆåç§»é‡ï¼‰å°±å¯ä»¥ç¡®å®šæœ€åä¸€æ®µé“¾è¡¨å±äºå“ªç§èŠ‚ç‚¹ï¼›å› æ­¤å¯ä»¥çœ‹åˆ°å†æ¬¡éå†æ•°ç»„æ—¶ï¼Œéå†åˆ°lastRunå°±ç»“æŸéå†ï¼›\n                        Node&lt;K,V&gt; lastRun = f;\n                        for (Node&lt;K,V&gt; p = f.next; p != null; p = p.next) {\n                            int b = p.hash &amp; n;\n                            if (b != runBit) {\n                                runBit = b;\n                                lastRun = p;\n                            }\n                        }\n                        if (runBit == 0) {//fh &amp; n = 0ï¼›æ‰©å®¹åä¸‹æ ‡ä¸å˜ï¼›fh &amp; n = nï¼›æ‰©å®¹åä¸‹æ ‡ä½ç½®æ”¹å˜ï¼ˆi + nï¼‰ï¼›\n                            ln = lastRun;\n                            hn = null;\n                        }\n                        else {\n                            hn = lastRun;\n                            ln = null;\n                        }\n                        //ä»å¤´éå†æ¯ä¸ªé“¾è¡¨ lnä¸ºåŸé“¾è¡¨ï¼Œhnä¸ºæ‰©å®¹åé“¾è¡¨\n                        for (Node&lt;K,V&gt; p = f; p != lastRun; p = p.next) {\n                            int ph = p.hash; K pk = p.key; V pv = p.val;\n                            if ((ph &amp; n) == 0) //å¤´æ’æ³•ï¼Œp.next = ln ç„¶å ln = p ï¼Œç»„æˆlné“¾è¡¨\n                                ln = new Node&lt;K,V&gt;(ph, pk, pv, ln);\n                            else //å¤´æ’æ³•ï¼Œp.next = hn ç„¶å hn = p ï¼Œç»„æˆhné“¾è¡¨\n                                hn = new Node&lt;K,V&gt;(ph, pk, pv, hn);\n                        }\n                        //éå†å®Œæ—§æ•°ç»„çš„é“¾è¡¨åï¼Œé‡æ–°ç”Ÿæˆäº†lnï¼Œhn 2æ¡é“¾è¡¨ï¼›\n                        //lné“¾è¡¨æ’å…¥åˆ°æ–°æ•°ç»„çš„ä¸‹æ ‡ï¼ši\n                        setTabAt(nextTab, i, ln);\n                        // hnæ’å…¥åˆ°ï¼ši+nä½ç½®ï¼›\n                        setTabAt(nextTab, i + n, hn);\n                        setTabAt(tab, i, fwd);\n                        advance = true;\n                    }\n                    else if (f instanceof TreeBin) {\n                        TreeBin&lt;K,V&gt; t = (TreeBin&lt;K,V&gt;)f;\n                        //loï¼šTreeNodeé“¾è¡¨è¡¨å¤´ï¼šä¸‹æ ‡ä½ç½®ä¸å˜ï¼ši\n                        //loTail:è¡¨å°¾ï¼Œæ¯æ¬¡æ’å…¥èŠ‚ç‚¹éƒ½åœ¨è¡¨å°¾æ’å…¥\n                        TreeNode&lt;K,V&gt; lo = null, loTail = null;\n                        //hiï¼šTreeNodeé“¾è¡¨è¡¨å¤´ï¼šä¸‹æ ‡ä½ç½®ï¼ši+n;\n                        //hiTail :è¡¨å°¾ï¼Œæ¯æ¬¡æ’å…¥èŠ‚ç‚¹éƒ½åœ¨è¡¨å°¾æ’å…¥\n                        TreeNode&lt;K,V&gt; hi = null, hiTail = null;\n                        int lc = 0, hc = 0;\n                        for (Node&lt;K,V&gt; e = t.first; e != null; e = e.next) {\n                            int h = e.hash;\n                            TreeNode&lt;K,V&gt; p = new TreeNode&lt;K,V&gt;\n                                (h, e.key, e.val, null, null);\n                            if ((h &amp; n) == 0) {//h &amp; n = 0ï¼›æ‰©å®¹åä¸‹æ ‡ä¸å˜ï¼›h &amp; n = nï¼›æ‰©å®¹åä¸‹æ ‡ä½ç½®æ”¹å˜ï¼ˆi + nï¼‰ï¼›\n                                if ((p.prev = loTail) == null)\n                                    lo = p;\n                                else\n                                    loTail.next = p;//loé“¾è¡¨æ’å…¥è¡¨å°¾\n                                loTail = p;//æ›´æ–°loé“¾è¡¨è¡¨å°¾\n                                ++lc;//è®°å½•loé“¾è¡¨èŠ‚ç‚¹ä¸ªæ•°\n                            }\n                            else {\n                                if ((p.prev = hiTail) == null)\n                                    hi = p;\n                                else\n                                    hiTail.next = p;\n                                hiTail = p;\n                                ++hc;\n                            }\n                        }\n                        //åˆ†åˆ«åˆ¤æ–­lnï¼ŒhnèŠ‚ç‚¹ä¸ªæ•°æ˜¯å¦æ»¡è¶³ç”Ÿæˆçº¢é»‘æ ‘çš„æ¡ä»¶ï¼›\n                        //ä¸æ»¡è¶³åˆ™å°†TreeNodeé“¾è¡¨è½¬æ¢æˆNodeé“¾è¡¨ï¼›\n                        //æ»¡è¶³åˆ™å°†TreeNodeèŠ‚ç‚¹é‡æ–°ç”Ÿæˆçº¢é»‘æ ‘ï¼›\n                        ln = (lc &lt;= UNTREEIFY_THRESHOLD) ? untreeify(lo) :\n                            (hc != 0) ? new TreeBin&lt;K,V&gt;(lo) : t;\n                        hn = (hc &lt;= UNTREEIFY_THRESHOLD) ? untreeify(hi) :\n                            (lc != 0) ? new TreeBin&lt;K,V&gt;(hi) : t;\n                        setTabAt(nextTab, i, ln);\n                        setTabAt(nextTab, i + n, hn);\n                        setTabAt(tab, i, fwd);\n                        advance = true;\n                    }\n                }\n            }\n        }\n    }\n}\n//Helps transfer if a resize is in progress.\nfinal Node&lt;K,V&gt;[] helpTransfer(Node&lt;K,V&gt;[] tab, Node&lt;K,V&gt; f) {\n    Node&lt;K,V&gt;[] nextTab; int sc;\n    if (tab != null &amp;&amp; (f instanceof ForwardingNode) &amp;&amp;\n        (nextTab = ((ForwardingNode&lt;K,V&gt;)f).nextTable) != null) {\n        int rs = resizeStamp(tab.length) &lt;&lt; RESIZE_STAMP_SHIFT;\n        while (nextTab == nextTable &amp;&amp; table == tab &amp;&amp;\n                (sc = sizeCtl) &lt; 0) {\n            if (sc == rs + MAX_RESIZERS || sc == rs + 1 ||\n                transferIndex &lt;= 0)\n                break;\n            if (U.compareAndSwapInt(this, SIZECTL, sc, sc + 1)) {\n                transfer(tab, nextTab);\n                break;\n            }\n        }\n        return nextTab;\n    }\n    return table;\n}\n//å°†treenodeé“¾è¡¨æ¢æˆétreenodeé“¾è¡¨\nstatic &lt;K,V&gt; Node&lt;K,V&gt; untreeify(Node&lt;K,V&gt; b) {\n    //hdå¤´èŠ‚ç‚¹ï¼Œtlè¾…åŠ©æŒ‡å‘pçš„æŒ‡é’ˆ hd=p =&gt; tl=p =&gt; tl.next=p =&gt; tl=p\n    Node&lt;K,V&gt; hd = null, tl = null;\n    for (Node&lt;K,V&gt; q = b; q != null; q = q.next) {\n        Node&lt;K,V&gt; p = new Node&lt;K,V&gt;(q.hash, q.key, q.val);\n        if (tl == null)\n            hd = p;\n        else\n            tl.next = p;\n        tl = p;\n    }\n    return hd;\n}\n\n</code></pre></div><h1>getæ–¹æ³•</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public V get(Object key) {\n    Node&lt;K,V&gt;[] tab; Node&lt;K,V&gt; e, p; int n, eh; K ek;\n    //æ ¹æ®key.hashCode()è®¡ç®—hash: æ‰°åŠ¨è¿ç®—åå¾—åˆ°å¾—åˆ°æ›´æ•£åˆ—çš„hashå€¼\n    int h = spread(key.hashCode());\n    if ((tab = table) != null &amp;&amp; (n = tab.length) &gt; 0 &amp;&amp;\n        (e = tabAt(tab, (n - 1) &amp; h)) != null) {//å½“å‰keyå¯»å€çš„æ¡¶ä½æœ‰å€¼\n        if ((eh = e.hash) == h) {//å¦‚æœç¬¬ä¸€ä¸ªå…ƒç´ å°±æ˜¯è¦æ‰¾çš„å…ƒç´ ï¼Œåˆ™ç›´æ¥è¿”å›\n            if ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek)))\n                return e.val;\n        }\n        hashå°äº0 åˆ†2ç§æƒ…å†µï¼Œæ˜¯æ ‘æˆ–è€…æ­£åœ¨æ‰©å®¹,éœ€è¦å€ŸåŠ©findæ–¹æ³•å¯»æ‰¾å…ƒç´ ï¼Œfindçš„å¯»æ‰¾æ–¹å¼ä¾æ®Nodeçš„ä¸åŒå­ç±»æœ‰ä¸åŒçš„å®ç°æ–¹å¼:\n        // æƒ…å†µä¸€ï¼šeh=-1 æ˜¯fwdç»“ç‚¹ -&gt; è¯´æ˜å½“å‰tableæ­£åœ¨æ‰©å®¹ï¼Œä¸”å½“å‰æŸ¥è¯¢çš„è¿™ä¸ªæ¡¶ä½çš„æ•°æ®å·²ç»è¢«è¿ç§»èµ°äº†ï¼Œéœ€è¦å€ŸåŠ©fwdç»“ç‚¹çš„å†…éƒ¨æ–¹æ³•findå»æŸ¥è¯¢\n        // æƒ…å†µäºŒï¼šeh=-2 æ˜¯TreeBinèŠ‚ç‚¹ -&gt; éœ€è¦ä½¿ç”¨TreeBin æä¾›çš„findæ–¹æ³•æŸ¥è¯¢ã€‚\n        else if (eh &lt; 0)\n            return (p = e.find(h, key)) != null ? p.val : null;\n        //è¯´æ˜æ˜¯å½“å‰æ¡¶ä½å·²ç»å½¢æˆé“¾è¡¨çš„è¿™ç§æƒ…å†µ: éå†æ•´ä¸ªé“¾è¡¨å¯»æ‰¾å…ƒç´     \n        while ((e = e.next) != null) {\n            if (e.hash == h &amp;&amp;\n                ((ek = e.key) == key || (ek != null &amp;&amp; key.equals(ek))))\n                return e.val;\n        }\n    }\n    return null;\n}\n//TreeBinèŠ‚ç‚¹çš„findæ–¹æ³•\nfinal Node&lt;K,V&gt; find(int h, Object k) {\n    if (k != null) {\n        for (Node&lt;K,V&gt; e = first; e != null; ) {\n            int s; K ek;\n            if (((s = lockState) &amp; (WAITER|WRITER)) != 0) {\n                if (e.hash == h &amp;&amp;\n                    ((ek = e.key) == k || (ek != null &amp;&amp; k.equals(ek))))\n                    return e;\n                e = e.next;\n            }\n            else if (U.compareAndSetInt(this, LOCKSTATE, s,\n                                            s + READER)) {\n                TreeNode&lt;K,V&gt; r, p;\n                try {\n                    p = ((r = root) == null ? null :\n                            r.findTreeNode(h, k, null));\n                } finally {\n                    Thread w;\n                    if (U.getAndAddInt(this, LOCKSTATE, -READER) ==\n                        (READER|WAITER) &amp;&amp; (w = waiter) != null)\n                        LockSupport.unpark(w);\n                }\n                return p;\n            }\n        }\n    }\n    return null;\n}\n//ForwardingNodeçš„findæ–¹æ³• \nNode&lt;K,V&gt; find(int h, Object k) {\n    // loop to avoid arbitrarily deep recursion on forwarding nodes\n    outer: for (Node&lt;K,V&gt;[] tab = nextTable;;) {\n        Node&lt;K,V&gt; e; int n;\n        if (k == null || tab == null || (n = tab.length) == 0 ||\n            (e = tabAt(tab, (n - 1) &amp; h)) == null)\n            return null;\n        for (;;) {\n            int eh; K ek;\n            if ((eh = e.hash) == h &amp;&amp;\n                ((ek = e.key) == k || (ek != null &amp;&amp; k.equals(ek))))\n                return e;\n            if (eh &lt; 0) {\n                if (e instanceof ForwardingNode) {\n                    tab = ((ForwardingNode&lt;K,V&gt;)e).nextTable;\n                    continue outer;\n                }\n                else\n                    return e.find(h, k);\n            }\n            if ((e = e.next) == null)\n                return null;\n        }\n    }\n}\n\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/1e11ee1378bca91c1d8d8.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æºç "
      ]
    },
    {
      "title": "å¤šçº¿ç¨‹",
      "url": "https://javaguide.cn/backend/java/concurrentprogramming.html",
      "id": "https://javaguide.cn/backend/java/concurrentprogramming.html",
      "summary": "å¤šçº¿ç¨‹ 1. casåº•å±‚ 2. åŸå­æ“ä½œç±» 3. Semaphore(ä¿¡å·é‡)-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—® 1.8. ä»€ä¹ˆæ˜¯çº¿ç¨‹é¥¥é¥¿ï¼Ÿå¯¼è‡´åŸå› ï¼Ÿ 1.7. Javaä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ 1.5. ç¨‹åºè¿è¡ŒåŸç† 1.6. ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿå¦‚ä½•å‡å°‘æˆ–è€…é¿å…ï¼Ÿ 1.11. çº¿ç¨‹é€šä¿¡ã€çº¿ç¨‹åŒæ­¥ã€çº¿ç¨‹äº’æ–¥ä¸‰è€…å…³ç³»ï¼Ÿ 1.13. å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®...",
      "content_html": "<p>å¤šçº¿ç¨‹</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-cas%E5%BA%95%E5%B1%82\">1. casåº•å±‚</a></li>\n<li><a href=\"#2-%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E7%B1%BB\">2. åŸå­æ“ä½œç±»</a></li>\n<li><a href=\"#3-semaphore%E4%BF%A1%E5%8F%B7%E9%87%8F-%E5%85%81%E8%AE%B8%E5%A4%9A%E4%B8%AA%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%97%B6%E8%AE%BF%E9%97%AE\">3. Semaphore(ä¿¡å·é‡)-å…è®¸å¤šä¸ªçº¿ç¨‹åŒæ—¶è®¿é—®</a>\n<ul>\n<li><a href=\"#18-%E4%BB%80%E4%B9%88%E6%98%AF%E7%BA%BF%E7%A8%8B%E9%A5%A5%E9%A5%BF%E5%AF%BC%E8%87%B4%E5%8E%9F%E5%9B%A0\">1.8. ä»€ä¹ˆæ˜¯çº¿ç¨‹é¥¥é¥¿ï¼Ÿå¯¼è‡´åŸå› ï¼Ÿ</a></li>\n<li><a href=\"#17-java%E4%B8%AD%E7%94%A8%E5%88%B0%E7%9A%84%E7%BA%BF%E7%A8%8B%E8%B0%83%E5%BA%A6%E7%AE%97%E6%B3%95%E6%98%AF%E4%BB%80%E4%B9%88\">1.7. Javaä¸­ç”¨åˆ°çš„çº¿ç¨‹è°ƒåº¦ç®—æ³•æ˜¯ä»€ä¹ˆï¼Ÿ</a></li>\n<li><a href=\"#15-%E7%A8%8B%E5%BA%8F%E8%BF%90%E8%A1%8C%E5%8E%9F%E7%90%86\">1.5. ç¨‹åºè¿è¡ŒåŸç†</a></li>\n<li><a href=\"#16-%E4%BB%80%E4%B9%88%E6%98%AF%E5%A4%9A%E7%BA%BF%E7%A8%8B%E4%B8%8A%E4%B8%8B%E6%96%87%E5%88%87%E6%8D%A2%E5%A6%82%E4%BD%95%E5%87%8F%E5%B0%91%E6%88%96%E8%80%85%E9%81%BF%E5%85%8D\">1.6. ä»€ä¹ˆæ˜¯å¤šçº¿ç¨‹ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼Ÿå¦‚ä½•å‡å°‘æˆ–è€…é¿å…ï¼Ÿ</a></li>\n<li><a href=\"#111-%E7%BA%BF%E7%A8%8B%E9%80%9A%E4%BF%A1%E7%BA%BF%E7%A8%8B%E5%90%8C%E6%AD%A5%E7%BA%BF%E7%A8%8B%E4%BA%92%E6%96%A5%E4%B8%89%E8%80%85%E5%85%B3%E7%B3%BB\">1.11. çº¿ç¨‹é€šä¿¡ã€çº¿ç¨‹åŒæ­¥ã€çº¿ç¨‹äº’æ–¥ä¸‰è€…å…³ç³»ï¼Ÿ</a></li>\n<li><a href=\"#113-%E5%A6%82%E4%BD%95%E5%9C%A8%E4%B8%A4%E4%B8%AA%E7%BA%BF%E7%A8%8B%E9%97%B4%E5%85%B1%E4%BA%AB%E6%95%B0%E6%8D%AE\">1.13. å¦‚ä½•åœ¨ä¸¤ä¸ªçº¿ç¨‹é—´å…±äº«æ•°æ®ï¼Ÿ</a></li>\n<li><a href=\"#21-%E5%A4%9A%E6%A0%B8cpu%E7%BC%93%E5%AD%98%E6%9E%B6%E6%9E%84\">2.1. å¤šæ ¸CPUç¼“å­˜æ¶æ„ï¼Ÿ</a></li>\n<li><a href=\"#32-%E9%94%81%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">3.2. é”çš„å†…å­˜è¯­ä¹‰</a></li>\n<li><a href=\"#34-%E9%94%81%E7%B2%97%E5%8C%96%E6%B6%88%E9%99%A4%E5%92%8C%E8%86%A8%E8%83%80\">3.4. é”ç²—åŒ–æ¶ˆé™¤å’Œè†¨èƒ€</a></li>\n<li><a href=\"#316-volatile%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">3.16. volatileå†…å­˜è¯­ä¹‰</a></li>\n</ul>\n</li>\n<li><a href=\"#6-forkjoin%E6%A1%86%E6%9E%B6\">6. Fork/Joinæ¡†æ¶</a></li>\n<li><a href=\"#10-java%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E8%87%AA%E6%97%8B\">10. javaå¦‚ä½•å®ç°è‡ªæ—‹?</a></li>\n<li><a href=\"#6-java%E5%B9%B6%E5%8F%91%E6%9C%BA%E5%88%B6%E7%9A%84%E5%BA%95%E5%B1%82%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86\">6. Javaå¹¶å‘æœºåˆ¶çš„åº•å±‚å®ç°åŸç†</a>\n<ul>\n<li><a href=\"#61-volatile%E7%9A%84%E5%BA%94%E7%94%A8\">6.1. volatileçš„åº”ç”¨</a></li>\n<li><a href=\"#62-%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C%E7%9A%84%E5%AE%9E%E7%8E%B0%E5%8E%9F%E7%90%86\">6.2. åŸå­æ“ä½œçš„å®ç°åŸç†</a></li>\n<li><a href=\"#63-%E5%A4%84%E7%90%86%E5%99%A8%E5%A6%82%E4%BD%95%E5%AE%9E%E7%8E%B0%E5%8E%9F%E5%AD%90%E6%93%8D%E4%BD%9C\">6.3. å¤„ç†å™¨å¦‚ä½•å®ç°åŸå­æ“ä½œï¼š</a></li>\n</ul>\n</li>\n<li><a href=\"#7-java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E5%9F%BA%E7%A1%80\">7. javaå†…å­˜æ¨¡å‹åŸºç¡€</a>\n<ul>\n<li><a href=\"#71-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%E4%B8%A4%E4%B8%AA%E5%85%B3%E9%94%AE%E9%97%AE%E9%A2%98\">7.1. å¹¶å‘ç¼–ç¨‹æ¨¡å‹çš„ä¸¤ä¸ªå…³é”®é—®é¢˜</a></li>\n</ul>\n</li>\n<li><a href=\"#8-java%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B%E7%9A%84%E6%8A%BD%E8%B1%A1%E7%BB%93%E6%9E%84\">8. Javaå†…å­˜æ¨¡å‹çš„æŠ½è±¡ç»“æ„</a></li>\n<li><a href=\"#9-%E4%BB%8E%E6%BA%90%E4%BB%A3%E7%A0%81%E5%88%B0%E6%8C%87%E4%BB%A4%E5%BA%8F%E5%88%97%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F\">9. ä»æºä»£ç åˆ°æŒ‡ä»¤åºåˆ—çš„é‡æ’åº</a></li>\n<li><a href=\"#10-%E5%B9%B6%E5%8F%91%E7%BC%96%E7%A8%8B%E6%A8%A1%E5%9E%8B%E7%9A%84%E5%88%86%E7%B1%BB\">10. å¹¶å‘ç¼–ç¨‹æ¨¡å‹çš„åˆ†ç±»</a></li>\n<li><a href=\"#11-happens-before%E7%AE%80%E4%BB%8B\">11. happens-beforeç®€ä»‹</a></li>\n<li><a href=\"#12-%E9%87%8D%E6%8E%92%E5%BA%8F\">12. é‡æ’åº</a></li>\n<li><a href=\"#13-as-if-serial%E8%AF%AD%E4%B9%89\">13. as-if-serialè¯­ä¹‰</a></li>\n<li><a href=\"#14-%E9%87%8D%E6%8E%92%E5%BA%8F%E5%AF%B9%E5%A4%9A%E7%BA%BF%E7%A8%8B%E7%9A%84%E5%BD%B1%E5%93%8D\">14. é‡æ’åºå¯¹å¤šçº¿ç¨‹çš„å½±å“</a></li>\n<li><a href=\"#15-%E9%A1%BA%E5%BA%8F%E4%B8%80%E8%87%B4%E6%80%A7\">15. é¡ºåºä¸€è‡´æ€§</a></li>\n<li><a href=\"#16-%E9%A1%BA%E5%BA%8F%E4%B8%80%E8%87%B4%E6%80%A7%E5%86%85%E5%AD%98%E6%A8%A1%E5%9E%8B\">16. é¡ºåºä¸€è‡´æ€§å†…å­˜æ¨¡å‹</a></li>\n<li><a href=\"#17-volatile%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">17. volatileçš„å†…å­˜è¯­ä¹‰</a></li>\n<li><a href=\"#18-volatile%E7%9A%84%E7%89%B9%E6%80%A7\">18. volatileçš„ç‰¹æ€§</a></li>\n<li><a href=\"#19-volatile%E5%86%99-%E8%AF%BB%E5%BB%BA%E7%AB%8B%E7%9A%84happens-before%E5%85%B3%E7%B3%BB\">19. volatileå†™-è¯»å»ºç«‹çš„happens-beforeå…³ç³»</a></li>\n<li><a href=\"#20-volatile%E5%86%99-%E8%AF%BB%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">20. volatileå†™-è¯»çš„å†…å­˜è¯­ä¹‰</a></li>\n<li><a href=\"#21-volatile%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89%E7%9A%84%E5%AE%9E%E7%8E%B0\">21. volatileå†…å­˜è¯­ä¹‰çš„å®ç°</a></li>\n<li><a href=\"#22-%E9%94%81%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">22. é”çš„å†…å­˜è¯­ä¹‰</a>\n<ul>\n<li><a href=\"#221-%E9%94%81%E7%9A%84%E9%87%8A%E6%94%BE-%E8%8E%B7%E5%8F%96%E5%BB%BA%E7%AB%8B%E7%9A%84happens-before%E5%85%B3%E7%B3%BB\">22.1. é”çš„é‡Šæ”¾-è·å–å»ºç«‹çš„happens-beforeå…³ç³»</a></li>\n<li><a href=\"#222-%E9%94%81%E7%9A%84%E9%87%8A%E6%94%BE%E5%92%8C%E8%8E%B7%E5%8F%96%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">22.2. é”çš„é‡Šæ”¾å’Œè·å–çš„å†…å­˜è¯­ä¹‰</a></li>\n<li><a href=\"#223-%E9%94%81%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89%E7%9A%84%E5%AE%9E%E7%8E%B0\">22.3. é”å†…å­˜è¯­ä¹‰çš„å®ç°</a></li>\n<li><a href=\"#224-concurrent%E5%8C%85%E7%9A%84%E5%AE%9E%E7%8E%B0\">22.4. concurrentåŒ…çš„å®ç°</a></li>\n<li><a href=\"#225-final%E5%9F%9F%E7%9A%84%E5%86%85%E5%AD%98%E8%AF%AD%E4%B9%89\">22.5. finalåŸŸçš„å†…å­˜è¯­ä¹‰</a>\n<ul>\n<li><a href=\"#2251-final%E5%9F%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99\">22.5.1. finalåŸŸçš„é‡æ’åºè§„åˆ™</a></li>\n<li><a href=\"#2252-%E5%86%99final%E5%9F%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99\">22.5.2. å†™finalåŸŸçš„é‡æ’åºè§„åˆ™</a></li>\n<li><a href=\"#2253-%E8%AF%BBfinal%E5%9F%9F%E7%9A%84%E9%87%8D%E6%8E%92%E5%BA%8F%E8%A7%84%E5%88%99\">22.5.3. è¯»finalåŸŸçš„é‡æ’åºè§„åˆ™</a></li>\n<li><a href=\"#2254-final%E5%9F%9F%E4%B8%BA%E5%BC%95%E7%94%A8%E7%B1%BB%E5%9E%8B\">22.5.4. finalåŸŸä¸ºå¼•ç”¨ç±»å‹</a></li>\n<li><a href=\"#2255-%E4%B8%BA%E4%BB%80%E4%B9%88final%E5%BC%95%E7%94%A8%E4%B8%8D%E8%83%BD%E4%BB%8E%E6%9E%84%E9%80%A0%E5%87%BD%E6%95%B0%E5%86%85%E6%BA%A2%E5%87%BA\">22.5.5. ä¸ºä»€ä¹ˆfinalå¼•ç”¨ä¸èƒ½ä»æ„é€ å‡½æ•°å†…â€œæº¢å‡ºâ€</a></li>\n<li><a href=\"#2256-final%E8%AF%AD%E4%B9%89%E5%9C%A8%E5%A4%84%E7%90%86%E5%99%A8%E4%B8%AD%E7%9A%84%E5%AE%9E%E7%8E%B0\">22.5.6. finalè¯­ä¹‰åœ¨å¤„ç†å™¨ä¸­çš„å®ç°</a></li>\n<li><a href=\"#2257-happens-before\">22.5.7. happens-before</a></li>\n<li><a href=\"#2258-happens-before%E7%9A%84%E5%AE%9A%E4%B9%89\">22.5.8. happens-beforeçš„å®šä¹‰</a></li>\n<li><a href=\"#2259-happens-before%E8%A7%84%E5%88%99\">22.5.9. happens-beforeè§„åˆ™</a></li>\n<li><a href=\"#22510-%E5%8F%8C%E9%87%8D%E6%A3%80%E6%9F%A5%E9%94%81%E5%AE%9A%E4%B8%8E%E5%BB%B6%E8%BF%9F%E5%88%9D%E5%A7%8B%E5%8C%96\">22.5.10. åŒé‡æ£€æŸ¥é”å®šä¸å»¶è¿Ÿåˆå§‹åŒ–</a></li>\n<li>[22.5.11. - 3.8.1 åŒé‡æ£€æŸ¥é”å®šçš„ç”±æ¥](#22511</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/d1a3ad11e842eda9f71fa.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Exception",
      "url": "https://javaguide.cn/backend/java/exception.html",
      "id": "https://javaguide.cn/backend/java/exception.html",
      "summary": "exception 1. å¼‚å¸¸ 2. å¼‚å¸¸å¤„ç†ï¼šå½“äº§ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¿…é¡»æœ‰å¤„ç†æ–¹å¼ã€‚è¦ä¹ˆæ•è·ï¼Œè¦ä¹ˆå£°æ˜æŠ›å‡º 3. è‡ªå®šä¹‰å¼‚å¸¸ 1. å¼‚å¸¸ Javaå¼‚å¸¸æ˜¯Javaæä¾›çš„ä¸€ç§è¯†åˆ«åŠå“åº”é”™è¯¯çš„ä¸€è‡´æ€§æœºåˆ¶ã€‚ Javaå¼‚å¸¸æœºåˆ¶å¯ä»¥ä½¿ç¨‹åºä¸­å¼‚å¸¸å¤„ç†ä»£ç å’Œæ­£å¸¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ï¼Œä¿è¯ç¨‹åºä»£ç æ›´åŠ ä¼˜é›…ï¼Œå¹¶æé«˜ç¨‹åºå¥å£®æ€§ JavaæŠŠå¼‚å¸¸ä¿¡æ¯å°è£…æˆä¸€ä¸ªç±»ã€‚å¼‚å¸¸æ—¶ä¼šåˆ›å»ºå¼‚å¸¸ç±»å¯¹è±¡å¹¶æŠ›å‡º...",
      "content_html": "<p>exception</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E5%BC%82%E5%B8%B8\">1. å¼‚å¸¸</a></li>\n<li><a href=\"#2-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%BD%93%E4%BA%A7%E7%94%9F%E5%BC%82%E5%B8%B8%E6%97%B6%E5%BF%85%E9%A1%BB%E6%9C%89%E5%A4%84%E7%90%86%E6%96%B9%E5%BC%8F%E8%A6%81%E4%B9%88%E6%8D%95%E8%8E%B7%E8%A6%81%E4%B9%88%E5%A3%B0%E6%98%8E%E6%8A%9B%E5%87%BA\">2. å¼‚å¸¸å¤„ç†ï¼šå½“äº§ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¿…é¡»æœ‰å¤„ç†æ–¹å¼ã€‚è¦ä¹ˆæ•è·ï¼Œè¦ä¹ˆå£°æ˜æŠ›å‡º</a></li>\n<li><a href=\"#3-%E8%87%AA%E5%AE%9A%E4%B9%89%E5%BC%82%E5%B8%B8\">3. è‡ªå®šä¹‰å¼‚å¸¸</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. å¼‚å¸¸</h1>\n<ul>\n<li>Javaå¼‚å¸¸æ˜¯Javaæä¾›çš„ä¸€ç§è¯†åˆ«åŠå“åº”é”™è¯¯çš„ä¸€è‡´æ€§æœºåˆ¶ã€‚</li>\n<li>Javaå¼‚å¸¸æœºåˆ¶å¯ä»¥ä½¿ç¨‹åºä¸­å¼‚å¸¸å¤„ç†ä»£ç å’Œæ­£å¸¸ä¸šåŠ¡ä»£ç åˆ†ç¦»ï¼Œä¿è¯ç¨‹åºä»£ç æ›´åŠ ä¼˜é›…ï¼Œå¹¶æé«˜ç¨‹åºå¥å£®æ€§</li>\n<li>JavaæŠŠå¼‚å¸¸ä¿¡æ¯å°è£…æˆä¸€ä¸ªç±»ã€‚å¼‚å¸¸æ—¶ä¼šåˆ›å»ºå¼‚å¸¸ç±»å¯¹è±¡å¹¶æŠ›å‡ºå¼‚å¸¸ä¿¡æ¯(å¦‚å¼‚å¸¸ä½ç½®ã€åŸå› )</li>\n<li>Exception ç±»åŠå…¶å­ç±»æ˜¯ Throwable çš„ä¸€ç§å½¢å¼ï¼Œå®ƒç”¨æ¥è¡¨ç¤ºjavaç¨‹åºä¸­å¯èƒ½ä¼šäº§ç”Ÿçš„å¼‚å¸¸ï¼Œå¹¶è¦æ±‚å¯¹äº§ç”Ÿçš„å¼‚å¸¸è¿›è¡Œåˆç†çš„å¼‚å¸¸å¤„ç†</li>\n<li>å¼‚å¸¸å¤„ç†çš„æ€§èƒ½æˆæœ¬éå¸¸é«˜ï¼›ä»…åœ¨å¼‚å¸¸æƒ…å†µä¸‹ä½¿ç”¨å¼‚å¸¸ï¼›åœ¨å¯æ¢å¤çš„å¼‚å¸¸æƒ…å†µä¸‹ä½¿ç”¨å¼‚å¸¸ï¼›</li>\n</ul>\n<h1>2. å¼‚å¸¸å¤„ç†ï¼šå½“äº§ç”Ÿå¼‚å¸¸æ—¶ï¼Œå¿…é¡»æœ‰å¤„ç†æ–¹å¼ã€‚è¦ä¹ˆæ•è·ï¼Œè¦ä¹ˆå£°æ˜æŠ›å‡º</h1>\n<ul>\n<li>åœ¨ä¸€ä¸ªæ–¹æ³•ä¸­å¦‚æœå‘ç”Ÿå¼‚å¸¸ï¼Œè¿™ä¸ªæ–¹æ³•ä¼šåˆ›å»ºä¸€ä¸ªå¼‚å¸¸å¯¹è±¡ï¼Œå¹¶è½¬äº¤ç»™ JVMï¼Œè¯¥å¼‚å¸¸å¯¹è±¡åŒ…å«å¼‚å¸¸åç§°ï¼Œå¼‚å¸¸æè¿°ä»¥åŠå¼‚å¸¸å‘ç”Ÿæ—¶åº”ç”¨ç¨‹åºçš„çŠ¶æ€ã€‚åˆ›å»ºå¼‚å¸¸å¯¹è±¡å¹¶è½¬äº¤ç»™ JVM çš„è¿‡ç¨‹ç§°ä¸ºæŠ›å‡ºå¼‚å¸¸ã€‚å¯èƒ½æœ‰ä¸€ç³»åˆ—çš„æ–¹æ³•è°ƒç”¨ï¼Œæœ€ç»ˆæ‰è¿›å…¥æŠ›å‡ºå¼‚å¸¸çš„æ–¹æ³•ï¼Œè¿™ä¸€ç³»åˆ—æ–¹æ³•è°ƒç”¨çš„æœ‰åºåˆ—è¡¨å«åšè°ƒç”¨æ ˆã€‚JVM ä¼šé¡ºç€è°ƒç”¨æ ˆå»æŸ¥æ‰¾çœ‹æ˜¯å¦æœ‰å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç ï¼Œå¦‚æœæœ‰ï¼Œåˆ™è°ƒç”¨å¼‚å¸¸å¤„ç†ä»£ç ã€‚å½“ JVM å‘ç°å¯ä»¥å¤„ç†å¼‚å¸¸çš„ä»£ç æ—¶ï¼Œä¼šæŠŠå‘ç”Ÿçš„å¼‚å¸¸ä¼ é€’ç»™å®ƒã€‚å¦‚æœ JVM æ²¡æœ‰æ‰¾åˆ°å¯ä»¥å¤„ç†è¯¥å¼‚å¸¸çš„ä»£ç å—ï¼ŒJVM å°±ä¼šå°†è¯¥å¼‚å¸¸è½¬äº¤ç»™é»˜è®¤çš„å¼‚å¸¸å¤„ç†å™¨ï¼ˆé»˜è®¤å¤„ç†å™¨ä¸º JVM çš„ä¸€éƒ¨åˆ†ï¼‰ï¼Œé»˜è®¤å¼‚å¸¸å¤„ç†å™¨æ‰“å°å‡ºå¼‚å¸¸ä¿¡æ¯å¹¶ç»ˆæ­¢åº”ç”¨ç¨‹åºã€‚</li>\n<li>æŠ›å‡ºå¼‚å¸¸ï¼šthrow new å¼‚å¸¸ç±»å(å‚æ•°)ï¼šæŠ›å‡ºå¼‚å¸¸å‘ŠçŸ¥è°ƒç”¨è€…ã€‚å¯ä»¥æŠ›å‡ºæ‰€æœ‰å¼‚å¸¸ï¼›throwæŠ›å‡ºçš„å¼‚å¸¸ï¼Œæœ¬èº«ä¸æ•è·å°±è¦throwsæŠ›å‡º</li>\n<li>å£°æ˜å¼‚å¸¸ï¼šæ–¹æ³• throws å¼‚å¸¸ç±»å1,å¼‚å¸¸ç±»å2â€¦ {} å£°æ˜å¼‚å¸¸,äº¤ç»™è°ƒç”¨è€…å»å¤„ç†ã€‚éæ£€æŸ¥å¼‚å¸¸ï¼ˆErrorã€RuntimeException æˆ–å®ƒä»¬çš„å­ç±»ï¼‰ä¸å¯ä½¿ç”¨ throws å…³é”®å­—æ¥å£°æ˜è¦æŠ›å‡ºçš„å¼‚å¸¸</li>\n<li>æ•è·å¼‚å¸¸ï¼šJavaä¸­å¯¹å¼‚å¸¸æœ‰é’ˆå¯¹æ€§çš„è¯­å¥è¿›è¡Œæ•è·ï¼Œå¯ä»¥å¯¹å‡ºç°çš„å¼‚å¸¸è¿›è¡ŒæŒ‡å®šæ–¹å¼çš„å¤„ç†\n<ul>\n<li>try catch finallyï¼šæ£€æµ‹å¼‚å¸¸ï¼Œå¹¶ä¼ é€’ç»™catchå¤„ç†ï¼Œå¹¶åœ¨finallyä¸­è¿›è¡Œèµ„æºé‡Šæ”¾</li>\n<li>try catchï¼šå¯¹ä»£ç è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼Œå¹¶å¯¹æ£€æµ‹çš„å¼‚å¸¸ä¼ é€’ç»™catchå¤„ç†.å¯¹å¼‚å¸¸è¿›è¡Œæ•è·å¤„ç†</li>\n<li>try å¤šä¸ªcatchï¼šå¯¹ä»£ç è¿›è¡Œå¼‚å¸¸æ£€æµ‹ï¼Œå¹¶å¯¹æ£€æµ‹çš„å¼‚å¸¸ä¼ é€’ç»™catchå¤„ç†ï¼Œå¤šä¸ªcatchä¸­çš„å¼‚å¸¸ä¸èƒ½ç›¸åŒï¼Œå­ç±»å¼‚å¸¸è¦æ±‚åœ¨ä¸Šé¢çš„catchå¤„ç†,çˆ¶ç±»å¼‚å¸¸åœ¨ä¸‹é¢çš„catchå¤„ç†ã€‚æœ‰ç»§æ‰¿å…³ç³»çš„å¼‚å¸¸ä¼šæœ€å…ˆæ•è·</li>\n<li>try finallyï¼šå¼‚å¸¸æ˜¯æ²¡æœ‰æ•è·å¤„ç†çš„ï¼Œfinallyï¼Œåªä¸ºå…³é—­èµ„æº</li>\n<li>finallyï¼šä¸€å®šä¼šæ‰§è¡Œçš„ï¼Œå³ä½¿åœ¨try{}catch{}ä¸­æœ‰returnï¼›finallyçš„returnå†³å®šè¯¥æ–¹æ³•çš„ç»“æœ</li>\n</ul>\n</li>\n<li>å¼‚å¸¸çš„å¤„ç†ï¼ŒæŒ‡å¤„ç†å¼‚å¸¸çš„ä¸€ç§å¯èƒ½æ€§ï¼Œå³æœ‰äº†å¼‚å¸¸å¤„ç†çš„ä»£ç ï¼Œä¸ä¸€å®šä¼šäº§ç”Ÿå¼‚å¸¸ï¼›å¦‚æœæ²¡æœ‰äº§ç”Ÿå¼‚å¸¸,åˆ™ä»£ç æ­£å¸¸æ‰§è¡Œ,å¦‚æœäº§ç”Ÿå¼‚å¸¸,åˆ™ä¸­æ–­å½“å‰æ‰§è¡Œä»£ç ,æ‰§è¡Œå¼‚å¸¸å¤„ç†ä»£ç \n<ul>\n<li>String getMessage()ï¼šè¿”å›æ­¤throwableçš„è¯¦ç»†æ¶ˆæ¯å­—ç¬¦ä¸²</li>\n<li>void printStackTrace()ï¼šå°†æ­¤throwableåŠå…¶è¿½è¸ªè¾“å‡ºè‡³æ ‡å‡†é”™è¯¯æµ</li>\n<li>String toString()ï¼šè¿”å›æ­¤throwableçš„ç®€çŸ­æè¿°</li>\n</ul>\n</li>\n</ul>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">çˆ¶ç±»</th>\n<th style=\"text-align:center\">å­ç±»é‡å†™æ–¹æ³•çš„ç»†èŠ‚ï¼ˆ\"ä¸èƒ½æ¯”çˆ¶ç±»å¤š\"ï¼‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å¦‚æœçˆ¶ç±»æ–¹æ³•å£°æ˜å¼‚å¸¸</td>\n<td style=\"text-align:center\">å­ç±»åªèƒ½å£°æ˜çˆ¶ç±»å¼‚å¸¸æˆ–è€…è¯¥å¼‚å¸¸çš„å­ç±»ï¼Œæˆ–è€…ä¸å£°æ˜</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å½“çˆ¶ç±»æ–¹æ³•å£°æ˜å¤šä¸ªå¼‚å¸¸æ—¶</td>\n<td style=\"text-align:center\">å­ç±»è¦†ç›–æ—¶åªèƒ½å£°æ˜å¤šä¸ªå¼‚å¸¸çš„å­é›†</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å½“è¢«è¦†ç›–çš„æ–¹æ³•æ²¡æœ‰å¼‚å¸¸å£°æ˜æ—¶</td>\n<td style=\"text-align:center\">å­ç±»è¦†ç›–æ—¶æ— æ³•å£°æ˜å¼‚å¸¸çš„ã€‚æ­¤æ—¶å­ç±»äº§ç”Ÿè¯¥å¼‚å¸¸ï¼Œåªèƒ½æ•è·å¤„ç†ï¼Œä¸èƒ½å£°æ˜æŠ›å‡º</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å½“å¤šå¼‚å¸¸å¤„ç†æ—¶ï¼Œæ•è·å¤„ç†</td>\n<td style=\"text-align:center\">å‰è¾¹çš„ç±»ä¸èƒ½æ˜¯åè¾¹ç±»çš„çˆ¶ç±»</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æ¥å£ä¸­æ²¡æœ‰å£°æ˜å¼‚å¸¸ï¼Œè€Œå®ç°ç±»è¦†ç›–æ–¹æ³•æ—¶å‘ç”Ÿäº†å¼‚å¸¸</td>\n<td style=\"text-align:center\">åªèƒ½catchçš„æ•è·ç»§ç»­throwæŠ›å‡ºï¼Œå¹¶å°†å¼‚å¸¸è½¬æ¢æˆRuntimeExceptionå­ç±»æŠ›å‡º</td>\n</tr>\n</tbody>\n</table>\n<h1>3. è‡ªå®šä¹‰å¼‚å¸¸</h1>\n<ul>\n<li>ç»§æ‰¿Exception,å¿…é¡»throwså£°æ˜,ä¸€å£°æ˜å°±å‘ŠçŸ¥è°ƒç”¨è€…æ•è·,é—®é¢˜å¤„ç†äº†è°ƒç”¨è€…çš„ç¨‹åºä¼šç»§ç»­æ‰§è¡Œ</li>\n<li>ç»§æ‰¿RuntimeExcpetion,ä¸éœ€throwså£°æ˜çš„ï¼Œè°ƒç”¨è€…ä¸éœ€è¦ç¼–å†™æ•è·ä»£ç çš„ï¼Œå› ä¸ºè°ƒç”¨æ ¹æœ¬å°±ä¸çŸ¥é“æœ‰é—®é¢˜ã€‚ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼Œè°ƒç”¨è€…ç¨‹åºä¼šåœæ‰ï¼Œå¹¶ç”±jvmå°†ä¿¡æ¯æ˜¾ç¤ºåˆ°å±å¹•ï¼Œè®©è°ƒç”¨è€…ä¿®æ­£ä»£ç </li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Class å¼‚å¸¸å extends Exception{ \n\t//ç¼–è¯‘æ—¶å¼‚å¸¸ç»§æ‰¿Exceptionï¼Œè¿è¡Œæ—¶å¼‚å¸¸ç»§æ‰¿RuntimeExceptionã€‚\n\tpublic å¼‚å¸¸å(){\n\t\tsuper();\n\t}\n\tpublic å¼‚å¸¸å(String s){ \n\t\tsuper(s); \n\t}\n}\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "io",
      "url": "https://javaguide.cn/backend/java/io.html",
      "id": "https://javaguide.cn/backend/java/io.html",
      "summary": "io 1. IOæ¦‚è¿° 2. IOçš„ç»§æ‰¿ä½“ç³» 3. java.io.Fileï¼šJavaä¸­æŠŠæ–‡ä»¶æˆ–è€…ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰éƒ½å°è£…æˆFileå¯¹è±¡ 4. java.io.OutputStream: æŠ½è±¡ç±»ï¼Œè¡¨ç¤ºè¾“å‡ºå­—èŠ‚æµçš„æ‰€æœ‰ç±»çš„è¶…ç±» 5. java.io.FlieOutputStream 6. java.io.ObjectOutputStreamæ“ä½œå¯¹è±¡çš„æµ 7. ...",
      "content_html": "<p>io</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-io%E6%A6%82%E8%BF%B0\">1. IOæ¦‚è¿°</a></li>\n<li><a href=\"#2-io%E7%9A%84%E7%BB%A7%E6%89%BF%E4%BD%93%E7%B3%BB\">2. IOçš„ç»§æ‰¿ä½“ç³»</a></li>\n<li><a href=\"#3-javaiofilejava%E4%B8%AD%E6%8A%8A%E6%96%87%E4%BB%B6%E6%88%96%E8%80%85%E7%9B%AE%E5%BD%95%E6%96%87%E4%BB%B6%E5%A4%B9%E9%83%BD%E5%B0%81%E8%A3%85%E6%88%90file%E5%AF%B9%E8%B1%A1\">3. java.io.Fileï¼šJavaä¸­æŠŠæ–‡ä»¶æˆ–è€…ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰éƒ½å°è£…æˆFileå¯¹è±¡</a></li>\n<li><a href=\"#4-javaiooutputstream-%E6%8A%BD%E8%B1%A1%E7%B1%BB%E8%A1%A8%E7%A4%BA%E8%BE%93%E5%87%BA%E5%AD%97%E8%8A%82%E6%B5%81%E7%9A%84%E6%89%80%E6%9C%89%E7%B1%BB%E7%9A%84%E8%B6%85%E7%B1%BB\">4. java.io.OutputStream: æŠ½è±¡ç±»ï¼Œè¡¨ç¤ºè¾“å‡ºå­—èŠ‚æµçš„æ‰€æœ‰ç±»çš„è¶…ç±»</a></li>\n<li><a href=\"#5-javaioflieoutputstream\">5. java.io.FlieOutputStream</a></li>\n<li><a href=\"#6-javaioobjectoutputstream%E6%93%8D%E4%BD%9C%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%B5%81\">6. java.io.ObjectOutputStreamæ“ä½œå¯¹è±¡çš„æµ</a></li>\n<li><a href=\"#7-javaiofilteroutputstream\">7. java.io.FilterOutputStream</a></li>\n<li><a href=\"#8-javaioprintstream\">8. java.io.PrintStream</a></li>\n<li><a href=\"#9-javaiobufferedoutputstream\">9. java.io.BufferedOutputStream</a></li>\n<li><a href=\"#10-javaioinputstream\">10. java.io.InputStream</a></li>\n<li><a href=\"#11-javaiofileinputstream\">11. java.io.FileInputStream</a></li>\n<li><a href=\"#12-javaioobjectinputstream-%E5%AF%B9%E8%B1%A1%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%B5%81%E4%BB%8E%E6%B5%81%E4%B8%AD%E8%AF%BB%E5%8F%96%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%93%8D%E4%BD%9C%E6%B5%81\">12. java.io.ObjectInputStream å¯¹è±¡ååºåˆ—åŒ–æµï¼Œä»æµä¸­è¯»å–å¯¹è±¡çš„æ“ä½œæµ</a></li>\n<li><a href=\"#13-javaiofilterinputstream\">13. java.io.FilterInputStream</a></li>\n<li><a href=\"#14-javaiobufferedinputstream\">14. java.io.BufferedInputStream</a></li>\n<li><a href=\"#15-javaiowriter-%E5%86%99%E5%85%A5%E5%AD%97%E7%AC%A6%E6%B5%81%E7%9A%84%E6%8A%BD%E8%B1%A1%E7%B1%BB\">15. java.io.Writer å†™å…¥å­—ç¬¦æµçš„æŠ½è±¡ç±»</a></li>\n<li><a href=\"#16-javaiobufferedwriter-%E5%AD%97%E7%AC%A6%E7%BC%93%E5%86%B2%E8%BE%93%E5%87%BA%E6%B5%81%E6%8F%90%E9%AB%98%E4%BA%86io%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6\">16. java.io.BufferedWriter å­—ç¬¦ç¼“å†²è¾“å‡ºæµï¼Œæé«˜äº†IOè¯»å†™é€Ÿåº¦</a></li>\n<li><a href=\"#17-javaioprintwriter\">17. java.io.PrintWriter</a></li>\n<li><a href=\"#18-javaiooutputstreamwriter\">18. java.io.OutputStreamWriter</a></li>\n<li><a href=\"#19-javaiofilewriter\">19. java.io.FileWriter</a></li>\n<li><a href=\"#20-javaioreader-%E8%AF%BB%E5%8F%96%E5%AD%97%E7%AC%A6%E6%B5%81%E7%9A%84%E6%8A%BD%E8%B1%A1%E8%B6%85%E7%B1%BB\">20. java.io.Reader è¯»å–å­—ç¬¦æµçš„æŠ½è±¡è¶…ç±»</a></li>\n<li><a href=\"#21-javaiobufferedreader-%E5%AD%97%E7%AC%A6%E7%BC%93%E5%86%B2%E8%BE%93%E5%85%A5%E6%B5%81%E6%8F%90%E9%AB%98%E4%BA%86io%E8%AF%BB%E5%86%99%E9%80%9F%E5%BA%A6\">21. java.io.BufferedReader å­—ç¬¦ç¼“å†²è¾“å…¥æµï¼Œæé«˜äº†IOè¯»å†™é€Ÿåº¦</a></li>\n<li><a href=\"#22-javaioinputstreamreader-%E5%AD%97%E8%8A%82%E6%B5%81%E9%80%9A%E5%90%91%E5%AD%97%E7%AC%A6%E6%B5%81%E7%9A%84%E6%A1%A5%E6%A2%81%E5%AE%83%E4%BD%BF%E7%94%A8%E6%8C%87%E5%AE%9A%E7%9A%84%E5%AD%97%E7%AC%A6%E7%BC%96%E7%A0%81%E8%A1%A8%E8%AF%BB%E5%8F%96%E5%AD%97%E8%8A%82%E5%B9%B6%E5%B0%86%E5%85%B6%E8%A7%A3%E7%A0%81%E4%B8%BA%E5%AD%97%E7%AC%A6\">22. java.io.InputStreamReader å­—èŠ‚æµé€šå‘å­—ç¬¦æµçš„æ¡¥æ¢ï¼šå®ƒä½¿ç”¨æŒ‡å®šçš„å­—ç¬¦ç¼–ç è¡¨è¯»å–å­—èŠ‚å¹¶å°†å…¶è§£ç ä¸ºå­—ç¬¦</a></li>\n<li><a href=\"#23-javaiofilereader\">23. java.io.FileReader</a></li>\n<li><a href=\"#24-flush%E5%92%8Cclose%E7%9A%84%E5%8C%BA%E5%88%AB\">24. flush()å’Œclose()çš„åŒºåˆ«ï¼Ÿ</a></li>\n<li><a href=\"#25-%E6%96%87%E4%BB%B6%E5%A4%8D%E5%88%B6\">25. æ–‡ä»¶å¤åˆ¶</a></li>\n</ul>\n<!-- /TOC -->\n<!-- /TOC -->\n<h1>1. IOæ¦‚è¿°</h1>\n<ul>\n<li>IOå°±æ˜¯å°†å†…å­˜ä¸­çš„æ•°æ®æŒä¹…åŒ–å­˜å‚¨åˆ°æŒä¹…åŒ–è®¾å¤‡ä¸Šï¼Œä½¿ç”¨çš„æ—¶å€™ä»æŒä¹…åŒ–è®¾å¤‡ä¸Šè¯»å…¥å†…å­˜</li>\n<li>IOæ“ä½œ:å½“éœ€è¦æŠŠå†…å­˜ä¸­çš„æ•°æ®å­˜å‚¨åˆ°æŒä¹…åŒ–è®¾å¤‡ä¸Šè¿™ä¸ªåŠ¨ä½œç§°ä¸ºè¾“å‡ºï¼ˆå†™ï¼‰Outputæ“ä½œã€‚\n<ul>\n<li>å½“æŠŠæŒä¹…è®¾å¤‡ä¸Šçš„æ•°æ®è¯»å–åˆ°å†…å­˜ä¸­çš„è¿™ä¸ªåŠ¨ä½œç§°ä¸ºè¾“å…¥ï¼ˆè¯»ï¼‰Inputæ“ä½œã€‚</li>\n</ul>\n</li>\n<li>IOExcptionå¼‚å¸¸</li>\n</ul>\n<h1>2. IOçš„ç»§æ‰¿ä½“ç³»</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3e02a33c786b280333be7.png\" alt=\"IO.jpg\" tabindex=\"0\"><figcaption>IO.jpg</figcaption></figure>\n<h1>3. java.io.Fileï¼šJavaä¸­æŠŠæ–‡ä»¶æˆ–è€…ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰éƒ½å°è£…æˆFileå¯¹è±¡</h1>\n<ul>\n<li>File(\"e:\\a\\hello.java\");å°†ç»™å®šè·¯å¾„åç§°å­—ç¬¦ä¸²è½¬æ¢ä¸ºæŠ½è±¡è·¯å¾„ååˆ›å»ºFileå¯¹è±¡ï¼Œ(åŒ…æ‹¬ä¸å­˜åœ¨æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹)</li>\n<li>boolean createNewFile()åˆ›å»ºä¸å­˜åœ¨çš„æ–‡ä»¶å¹¶è¿”å›trueï¼Œå­˜åœ¨false</li>\n<li>boolean mkdir()åˆ›å»ºä¸å­˜åœ¨çš„å•å±‚æ–‡ä»¶å¤¹å¹¶è¿”å›trueï¼Œå­˜åœ¨false</li>\n<li>boolean mkdirs()åˆ›å»ºå¤šå±‚æ–‡ä»¶å¤¹</li>\n<li>boolean delete()åˆ é™¤æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æˆ–ç©ºç›®å½•</li>\n<li>boolean isFile()åˆ¤æ–­æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æ˜¯å¦ä¸ºæ ‡å‡†æ–‡ä»¶</li>\n<li>boolean isDirectory()åˆ¤æ–­æ­¤æŠ½è±¡è·¯å¾„åè¡¨ç¤ºçš„æ–‡ä»¶æ˜¯å¦æ˜¯ç›®å½•ï¼ˆæ–‡ä»¶å¤¹ï¼‰</li>\n<li>String getAbsolutePath()è·å–å½“å‰Fileå¯¹è±¡çš„ç»å¯¹è·¯å¾„åå­—ç¬¦ä¸²</li>\n<li>String getPath()å°†æ­¤æŠ½è±¡è·¯å¾„åè½¬æ¢ä¸ºä¸€ä¸ªè·¯å¾„åå­—ç¬¦ä¸²</li>\n<li>String getName()è·å–å½“å‰Fileå¯¹è±¡çš„æ–‡ä»¶æˆ–ç›®å½•çš„åç§°</li>\n<li>long length()è·å–å½“å‰Fileå¯¹è±¡çš„æ–‡ä»¶æˆ–æ–‡ä»¶å¤¹çš„å¤§å°ï¼ˆå­—èŠ‚ï¼‰</li>\n<li>boolean exists() åˆ¤æ–­Fileå¯¹è±¡å¯¹åº”çš„æ–‡ä»¶æˆ–ç›®å½•æ˜¯å¦å­˜åœ¨</li>\n<li>String[] list()è·å¾—æŠ½è±¡è·¯å¾„åç›®å½•çš„æ–‡ä»¶å’Œç›®å½•çš„å­—ç¬¦ä¸²æ•°ç»„ï¼ŒæŒ‡å®šçš„ç›®å½•å¿…é¡»æ˜¯å­˜åœ¨çš„ç›®å½•ã€‚å¦åˆ™æ•°ç»„ä¸ºnull</li>\n<li>File[] listFiles()è·å–æŠ½è±¡è·¯å¾„åç›®å½•ä¸­çš„Fileå¯¹è±¡æ•°ç»„ï¼ŒæŒ‡å®šçš„ç›®å½•å¿…é¡»æ˜¯å­˜åœ¨çš„ç›®å½•ã€‚å¦åˆ™æ•°ç»„ä¸ºnull</li>\n<li>File[] listFiles(FilenameFilter filter)è¿”å›Fileçš„ç›®å½•ä¸­æ»¡è¶³è¿‡æ»¤å™¨çš„æ–‡ä»¶å’Œç›®å½•æŠ½è±¡è·¯å¾„åæ•°ç»„</li>\n<li>File[] listFiles(FileFilter filter)è¿”å›Fileçš„ç›®å½•ä¸­æ»¡è¶³è¿‡æ»¤å™¨çš„æ–‡ä»¶å’Œç›®å½•æŠ½è±¡è·¯å¾„åæ•°ç»„</li>\n<li>FilenameFilteræ¥å£:è¿‡æ»¤æ–‡ä»¶å</li>\n<li>boolean accept(FIle dir,String name)æµ‹è¯•æŒ‡å®šè·¯å¾„åæ˜¯å¦åŒ…å«åœ¨æŸä¸ªè·¯å¾„åˆ—è¡¨ä¸­ä¸­</li>\n<li>FileFilteræ¥å£:è¿‡æ»¤æ–‡ä»¶æˆ–è€…æ–‡ä»¶å¤¹</li>\n<li>boolean accept(File pathname)æµ‹è¯•æŒ‡å®šæŠ½è±¡è·¯å¾„åæ˜¯å¦åº”è¯¥åŒ…å«åœ¨æŸä¸ªè·¯å¾„ååˆ—è¡¨ä¸­</li>\n</ul>\n<h1>4. java.io.OutputStream: æŠ½è±¡ç±»ï¼Œè¡¨ç¤ºè¾“å‡ºå­—èŠ‚æµçš„æ‰€æœ‰ç±»çš„è¶…ç±»</h1>\n<ul>\n<li>void close()å…³é—­è¾“å‡ºæµå¹¶é‡Šæ”¾ä¸æ­¤æµæœ‰å…³çš„æ‰€æœ‰ç³»ç»Ÿèµ„æº</li>\n<li>void flush()åˆ·æ–°æ­¤è¾“å‡ºæµå¹¶å¼ºåˆ¶å†™å‡ºæ‰€æœ‰è¾“å‡ºå­—èŠ‚</li>\n<li>void write(byte[] b)å°†b.lengthä¸ªå­—èŠ‚ä»æŒ‡å®šçš„byteæ•°ç»„å†™å…¥æ­¤è¾“å‡ºæµ</li>\n<li>void write(byte[] b,int off,int len)å°†åˆ¶å®šbyteæ•°ç»„ä»åç§»é‡offå¼€å§‹çš„lenä¸ªå­—èŠ‚å†™å…¥æ­¤è¾“å‡ºæµ</li>\n</ul>\n<h1>5. java.io.FlieOutputStream</h1>\n<ul>\n<li>FlieOutputStream(File file)åˆ›å»ºFlieå¯¹è±¡è¡¨ç¤ºæ–‡ä»¶ä¸­å†™å…¥æ•°æ®çš„è¾“å‡ºæµï¼ˆæ–‡ä»¶å­˜åœ¨åˆ™è¦†ç›–ï¼‰</li>\n<li>FlieOutputStream(String name)åˆ›å»ºæŒ‡å‘æŒ‡å®šåç§°æ–‡ä»¶ä¸­å†™å…¥æ•°æ®çš„è¾“å‡ºæµ(æ–‡ä»¶å­˜åœ¨åˆ™è¦†ç›–)</li>\n<li>FileOutputStream(File file,boolean append)trueåœ¨æ–‡ä»¶æœ«å°¾ç»§ç»­æ·»åŠ ï¼Œâ€œ\\r\\nâ€æ¢è¡Œ</li>\n<li>FlieOutputStream(String name,boolean append)trueå°±è¡¨ç¤ºå¯ä»¥åœ¨æ–‡ä»¶æœ«å°¾ç»§ç»­æ·»åŠ </li>\n</ul>\n<h1>6. java.io.ObjectOutputStreamæ“ä½œå¯¹è±¡çš„æµ</h1>\n<ul>\n<li>ObjectOutputStream(OutputStream out)ä¼ å…¥OutputStreamçš„å®ç°ç±»å¦‚FileOutputStreamå³å¯</li>\n<li>void writeObject(Object obj)å°†æŒ‡å®šå¯¹è±¡å†™å…¥ObjectOutputStream</li>\n<li>â‘ è¢«åºåˆ—åŒ–çš„å¯¹è±¡æ‰€å±çš„ç±»å¿…é¡»å®ç°Serializableæ¥å£ã€‚å¦åˆ™ä¼šå‘ç”Ÿå¼‚å¸¸NotSerializableExceptionå¼‚å¸¸ã€‚</li>\n<li>â‘¡ååºåˆ—åŒ–å¯¹è±¡æ—¶ï¼Œå¦‚æœå¯¹è±¡æ‰€å±çš„classæ–‡ä»¶åœ¨åºåˆ—åŒ–ä¹‹åè¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿå¼‚å¸¸InvalidClassExceptionã€‚</li>\n<li>Serializableæ ‡è®°æ¥å£ï¼Œç»™éœ€è¦åºåˆ—åŒ–çš„ç±»ï¼Œæä¾›äº†ä¸€ä¸ªåºåˆ—ç‰ˆæœ¬å·serialVersionUID. private static final long serialVersionUID = 1L;è¯¥ç‰ˆæœ¬å·çš„ç›®çš„åœ¨äºéªŒè¯åºåˆ—åŒ–çš„å¯¹è±¡å’Œå¯¹åº”ç±»æ˜¯å¦ç‰ˆæœ¬åŒ¹é…</li>\n<li>â‘¢transientä¿®é¥°çš„å±æ€§ä¸ä¼šç²åºåˆ—åŒ–</li>\n<li>â‘£é™æ€ä¿®é¥°ä¹Ÿä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œå› ä¸ºåºåˆ—åŒ–æ˜¯æŠŠå¯¹è±¡æ•°æ®è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ï¼Œè€Œé™æ€çš„å±äºç±»åŠ è½½æ—¶çš„æ•°æ®ï¼Œä¸ä¼šè¢«åºåˆ—åŒ–</li>\n</ul>\n<h1>7. java.io.FilterOutputStream</h1>\n<ul>\n<li>FilterOutputStream(OutputStream out)ä¼ å…¥OutputStreamçš„å®ç°ç±»å¦‚FileOutputStreamå³å¯</li>\n</ul>\n<h1>8. java.io.PrintStream</h1>\n<ul>\n<li>PrintStream(OutputStream out, boolean autoFlush)å¼€å¯æ–‡ä»¶è‡ªåŠ¨åˆ·æ–°</li>\n<li>void print(String str)è¾“å‡ºä»»æ„ç±»å‹çš„æ•°æ®</li>\n<li>void println(String str)è¾“å‡ºä»»æ„ç±»å‹çš„æ•°æ®ï¼Œè‡ªåŠ¨å†™å…¥æ¢è¡Œæ“ä½œ</li>\n</ul>\n<h1>9. java.io.BufferedOutputStream</h1>\n<ul>\n<li>BufferedOutputStream(OutputStream out)å­—èŠ‚ç¼“å†²è¾“å‡ºæµæé«˜äº†IOçš„è¯»å†™é€Ÿåº¦</li>\n</ul>\n<h1>10. java.io.InputStream</h1>\n<ul>\n<li>InputStreamæ­¤æŠ½è±¡ç±»ï¼Œæ˜¯è¡¨ç¤ºå­—èŠ‚è¾“å…¥æµçš„æ‰€æœ‰ç±»çš„è¶…ç±»ã€‚</li>\n<li>int read()è¯»å–ä¸€ä¸ªå­—èŠ‚å¹¶è¿”å›ï¼Œæ²¡æœ‰å­—èŠ‚è¿”å›-1.//é€Ÿåº¦æ…¢</li>\n<li>int read(byte[] b)è¯»å–ä¸€å®šé‡çš„å­—èŠ‚æ•°ï¼Œå¹¶å­˜å‚¨åˆ°å­—èŠ‚(æ¨è1024æ•´æ•°å€å­—èŠ‚)æ•°ç»„ä¸­</li>\n</ul>\n<h1>11. java.io.FileInputStream</h1>\n<ul>\n<li>FileInputStream(File file)é€šè¿‡Fileå¯¹è±¡æ¥åˆ›å»ºä¸€ä¸ªFileInputStream</li>\n<li>FileInputStream(String name)é€šè¿‡æ–‡ä»¶ç³»ç»Ÿä¸­çš„è·¯å¾„ånameæ¥åˆ›å»ºä¸€ä¸ªFileInputStream</li>\n</ul>\n<h1>12. java.io.ObjectInputStream å¯¹è±¡ååºåˆ—åŒ–æµï¼Œä»æµä¸­è¯»å–å¯¹è±¡çš„æ“ä½œæµ</h1>\n<ul>\n<li>ObjectInputStream(InputStream in)ä¼ å…¥InputStreamçš„å®ç°ç±»å¦‚FileInputStreamå³å¯</li>\n<li>Object readObject()ä»ObjectInputStreamè¯»å–å¯¹è±¡</li>\n<li>â‘ è¢«åºåˆ—åŒ–çš„å¯¹è±¡æ‰€å±çš„ç±»å¿…é¡»å®ç°Serializableæ¥å£ã€‚å¦åˆ™ä¼šå‘ç”Ÿå¼‚å¸¸NotSerializableExceptionå¼‚å¸¸ã€‚</li>\n<li>â‘¡ååºåˆ—åŒ–å¯¹è±¡æ—¶ï¼Œå¦‚æœå¯¹è±¡æ‰€å±çš„classæ–‡ä»¶åœ¨åºåˆ—åŒ–ä¹‹åè¢«ä¿®æ”¹äº†ï¼Œé‚£ä¹ˆä¼šå‘ç”Ÿå¼‚å¸¸InvalidClassExceptionã€‚</li>\n<li>Serializableæ ‡è®°æ¥å£ç»™éœ€è¦åºåˆ—åŒ–çš„ç±»æä¾›äº†ä¸€ä¸ªåºåˆ—ç‰ˆæœ¬å·serialVersionUID. private static final long serialVersionUID = 1L;è¯¥ç‰ˆæœ¬å·çš„ç›®çš„åœ¨äºéªŒè¯åºåˆ—åŒ–çš„å¯¹è±¡å’Œå¯¹åº”ç±»æ˜¯å¦ç‰ˆæœ¬åŒ¹é…</li>\n<li>â‘¢transientä¿®é¥°çš„å±æ€§ä¸ä¼šç²åºåˆ—åŒ–</li>\n<li>â‘£é™æ€ä¿®é¥°ä¹Ÿä¸ä¼šè¢«åºåˆ—åŒ–ï¼Œå› ä¸ºåºåˆ—åŒ–æ˜¯æŠŠå¯¹è±¡æ•°æ®è¿›è¡ŒæŒä¹…åŒ–å­˜å‚¨ï¼Œè€Œé™æ€çš„å±äºç±»åŠ è½½æ—¶çš„æ•°æ®ï¼Œä¸ä¼šè¢«åºåˆ—åŒ–</li>\n</ul>\n<h1>13. java.io.FilterInputStream</h1>\n<ul>\n<li>FilterInputStream(OutputStream out)ä¼ å…¥OutputStreamçš„å®ç°ç±»å¦‚FileOutputStreamå³å¯</li>\n</ul>\n<h1>14. java.io.BufferedInputStream</h1>\n<ul>\n<li>BufferedInputStream(InputStream in)å­—èŠ‚ç¼“å†²è¾“å…¥æµï¼Œæé«˜äº†IOçš„è¯»å†™é€Ÿåº¦</li>\n</ul>\n<h1>15. java.io.Writer å†™å…¥å­—ç¬¦æµçš„æŠ½è±¡ç±»</h1>\n<ul>\n<li>void write(String str)å†™å…¥å­—ç¬¦ä¸²</li>\n<li>void write(String str,int off,int len)å†™å…¥å­—ç¬¦ä¸²çš„æŸä¸€éƒ¨åˆ†</li>\n<li>void write(char[] cbuf)å†™å…¥å­—ç¬¦æ•°ç»„</li>\n<li>abstract void write(char[] cbuf,int off,int len)å†™å…¥å­—ç¬¦æ•°ç»„çš„æŸä¸€éƒ¨åˆ†</li>\n<li>void write(int c)å†™å…¥å•ä¸ªå­—ç¬¦å­—èŠ‚æµè½¬æˆå­—ç¬¦æµï¼Œå°†å­—ç¬¦ä¸²æŒ‰ç…§æŒ‡å®šçš„ç¼–ç è¡¨è½¬æˆå­—èŠ‚</li>\n</ul>\n<h1>16. java.io.BufferedWriter å­—ç¬¦ç¼“å†²è¾“å‡ºæµï¼Œæé«˜äº†IOè¯»å†™é€Ÿåº¦</h1>\n<ul>\n<li>BufferedWriter(Writer out)ä½¿ç”¨é»˜è®¤å¤§å°è¾“å‡ºç¼“å†²åŒº,ä¼ å…¥Writerå®ç°ç±»å¦‚FileWriter</li>\n<li>void newLine()æ ¹æ®å½“å‰çš„ç³»ç»Ÿï¼Œå†™å…¥ä¸€ä¸ªæ¢è¡Œç¬¦</li>\n</ul>\n<h1>17. java.io.PrintWriter</h1>\n<ul>\n<li>public PrintWriter(OutputStream out, boolean autoFlush)//å¼€å¯æ–‡ä»¶è‡ªåŠ¨åˆ·æ–°</li>\n<li>PrintWriter(Writer out, boolean autoFlush)//å¼€å¯æ–‡ä»¶è‡ªåŠ¨åˆ·æ–°</li>\n<li>void println(String str): è¾“å‡ºä»»æ„ç±»å‹çš„æ•°æ®ï¼Œè‡ªåŠ¨å†™å…¥æ¢è¡Œæ“ä½œ</li>\n<li>void print(String str)è¾“å‡ºä»»æ„ç±»å‹çš„æ•°æ®</li>\n</ul>\n<h1>18. java.io.OutputStreamWriter</h1>\n<ul>\n<li>OutputStreamWriterç±»å­—ç¬¦æµè½¬æˆå­—èŠ‚æµï¼Œå°†å­—ç¬¦ä¸²æŒ‰ç…§æŒ‡å®šçš„ç¼–ç è¡¨è½¬æˆå­—èŠ‚</li>\n<li>OutputStreamWriter(OutputStream out Charset cs)åˆ›å»ºä½¿ç”¨ç»™å®šå­—ç¬¦é›†çš„ç¼–ç å¯¹è±¡</li>\n</ul>\n<h1>19. java.io.FileWriter</h1>\n<ul>\n<li>FileWriterå‡å®šé»˜è®¤å­—ç¬¦ç¼–ç GBKå’Œé»˜è®¤å­—èŠ‚ç¼“å†²åŒºå¤§å°éƒ½æ˜¯å¯æ¥å—çš„ã€‚</li>\n<li>FileWriter(File file)æ ¹æ®Fileå¯¹è±¡æ„é€ ä¸€ä¸ªFileWriterå¯¹è±¡(è¦†ç›–)</li>\n<li>FileWriter(String FileName)æ ¹æ®æ–‡ä»¶ååˆ›å»ºFileWriterå¯¹è±¡</li>\n<li>FileWriter(File file,boolean append)Fileå¯¹è±¡æ„é€ FileWriterå¯¹è±¡(trueç»§ç»­å†™)</li>\n<li>FileWriter(String FileName,boolean append)æ–‡ä»¶ååˆ›å»ºFileWriterå¯¹è±¡(trueç»§ç»­å†™)</li>\n</ul>\n<h1>20. java.io.Reader è¯»å–å­—ç¬¦æµçš„æŠ½è±¡è¶…ç±»</h1>\n<ul>\n<li>int read()è¯»å–å•ä¸ªå­—ç¬¦å¹¶è¿”å›ï¼Œè‹¥æ²¡æœ‰åˆ™è¿”å›-1</li>\n<li>int read(char[] cbuf)å°†å­—ç¬¦è¯»å…¥æ•°ç»„ï¼Œå¹¶è¿”å›è¯»å–çš„ä¸ªæ•°</li>\n</ul>\n<h1>21. java.io.BufferedReader å­—ç¬¦ç¼“å†²è¾“å…¥æµï¼Œæé«˜äº†IOè¯»å†™é€Ÿåº¦</h1>\n<ul>\n<li>BufferedReader(Reader in)é»˜è®¤å¤§å°è¾“å…¥ç¼“å†²åŒº</li>\n<li>String readLine()è¿”å›æ–‡æœ¬è¡Œå†…å®¹å­—ç¬¦ä¸²ï¼Œä¸åŒ…å«ä»»ä½•è¡Œç»ˆæ­¢ç¬¦ï¼Œåˆ°è¾¾æµçš„æœ«å°¾è¿”å›null</li>\n</ul>\n<h1>22. java.io.InputStreamReader å­—èŠ‚æµé€šå‘å­—ç¬¦æµçš„æ¡¥æ¢ï¼šå®ƒä½¿ç”¨æŒ‡å®šçš„å­—ç¬¦ç¼–ç è¡¨è¯»å–å­—èŠ‚å¹¶å°†å…¶è§£ç ä¸ºå­—ç¬¦</h1>\n<ul>\n<li>InputStreamReader(InputStream&nbsp;in Charset&nbsp;cs)åˆ›å»ºä½¿ç”¨ç»™å®šå­—ç¬¦é›†çš„è§£ç å¯¹è±¡</li>\n</ul>\n<h1>23. java.io.FileReader</h1>\n<ul>\n<li>è¯»å–å­—ç¬¦æ–‡ä»¶çš„ä¾¿æ·ç±»ï¼Œå‡å®šé»˜è®¤å­—ç¬¦ç¼–ç GBKå’Œé»˜è®¤å­—èŠ‚ç¼“å†²åŒºå¤§å°éƒ½æ˜¯é€‚å½“çš„</li>\n<li>FileReader(File file)ä»fileå¯¹è±¡åˆ›å»ºä¸€ä¸ªæ–°çš„FileReader</li>\n<li>FileReader(String fileName)ä»è¯»å–æ•°æ®çš„æ–‡ä»¶ååˆ›å»ºä¸€ä¸ªæ–°çš„FileReader</li>\n</ul>\n<h1>24. flush()å’Œclose()çš„åŒºåˆ«ï¼Ÿ</h1>\n<ul>\n<li>flush():å°†æµä¸­çš„ç¼“å†²åŒºç¼“å†²çš„æ•°æ®åˆ·æ–°åˆ°ç›®çš„åœ°ä¸­ï¼Œåˆ·æ–°åï¼Œæµè¿˜å¯ä»¥ç»§ç»­ä½¿ç”¨ã€‚</li>\n<li>close():å…³é—­èµ„æºï¼Œä½†åœ¨å…³é—­å‰ä¼šå°†ç¼“å†²åŒºä¸­çš„æ•°æ®å…ˆåˆ·æ–°åˆ°ç›®çš„åœ°ï¼Œå¦åˆ™ä¸¢å¤±æ•°æ®ï¼Œç„¶ååœ¨å…³é—­æµã€‚æµä¸å¯ä»¥ä½¿ç”¨ã€‚å¦‚æœå†™å…¥æ•°æ®å¤šï¼Œä¸€å®šè¦ä¸€è¾¹å†™ä¸€è¾¹åˆ·æ–°ï¼Œ<br>\næœ€åä¸€æ¬¡å¯ä»¥ä¸åˆ·æ–°ï¼Œç”±closeå®Œæˆåˆ·æ–°å¹¶å…³é—­</li>\n</ul>\n<h1>25. æ–‡ä»¶å¤åˆ¶</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é‡‡ç”¨é«˜æ•ˆçš„æµï¼Œä¸€ä¸ªå¤šä¸ªå­—èŠ‚çš„æ–¹å¼èµ‹å€¼\nBufferedInputStream in = new BufferedInputStream(new FileInputStream(src));\nBufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(dest));\nbyte[] buffer = new byte[1024];\nint len = -1;\nwhile ( (len = in.read(buffer)) != -1) {\n\tout.write(buffer, 0, len);\n}\nin.close();\nout.close();\né‡‡ç”¨é«˜æ•ˆçš„æµï¼Œä¸€æ¬¡ä¸€ä¸ªå­—èŠ‚çš„æ–¹å¼å¤åˆ¶\nBufferedInputStream in = new BufferedInputStream(new FileInputStream(src));\nBufferedOutputStream out = new BufferedOutputStream(new FileOutputStream(dest));\nint ch = -1;\nwhile ((ch=in.read()) != -1) {\n\tout.write(ch);\t\n}\t\t\nin.close();\nout.close();\né‡‡ç”¨é«˜æ•ˆçš„æµæ–‡ä»¶å¤åˆ¶\nBufferedReader in = new BufferedReader(new FileReader(\"file.txt\"));\nBufferedWriter out = new BufferedWriter(new FileWriter(\"copyFile.txt\"));\nString line = null;\nwhile ( (line = in.readLine()) != null ) {\n\tout.write(line);\n\tout.newLine();\n}\nout.close();\nin.close();\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/3e02a33c786b280333be7.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "java",
      "url": "https://javaguide.cn/backend/java/java.html",
      "id": "https://javaguide.cn/backend/java/java.html",
      "summary": "java javaæ¦‚è¿° javaæ˜¯ç”¨æ¥ç¼–å†™äº’è”ç½‘(ç”µå•†ã€P2P)å’Œä¼ä¸šçº§åº”ç”¨(ERPã€CRMã€BOSã€OA)ç­‰è½¯ä»¶çš„ä¸€é—¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€ javaè·¨å¹³å°(æ“ä½œç³»ç»Ÿ:Windows\\Linux\\Mac)ç‰¹æ€§:ä¸€æ¬¡ç¼–å†™ååœ¨ä»»æ„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¾èµ–è™šæ‹ŸæœºJVMï¼ˆjava Virtual Machineï¼‰å®ç° Javaè¯­è¨€é‡‡ç”¨Unicodeç¼–ç æ ‡å‡†ï¼ŒUnico...",
      "content_html": "<p>java</p>\n<!--more-->\n<h1>javaæ¦‚è¿°</h1>\n<ul>\n<li>javaæ˜¯ç”¨æ¥ç¼–å†™äº’è”ç½‘(ç”µå•†ã€P2P)å’Œä¼ä¸šçº§åº”ç”¨(ERPã€CRMã€BOSã€OA)ç­‰è½¯ä»¶çš„ä¸€é—¨é¢å‘å¯¹è±¡ç¼–ç¨‹è¯­è¨€</li>\n<li>javaè·¨å¹³å°(æ“ä½œç³»ç»Ÿ:Windows\\Linux\\Mac)ç‰¹æ€§:ä¸€æ¬¡ç¼–å†™ååœ¨ä»»æ„æ“ä½œç³»ç»Ÿä¸Šè¿è¡Œï¼Œä¾èµ–è™šæ‹ŸæœºJVMï¼ˆjava Virtual Machineï¼‰å®ç°</li>\n<li>Javaè¯­è¨€é‡‡ç”¨Unicodeç¼–ç æ ‡å‡†ï¼ŒUnicodeï¼ˆæ ‡å‡†ç ï¼‰ï¼Œå®ƒä¸ºæ¯ä¸ªå­—ç¬¦åˆ¶è®¢äº†ä¸€ä¸ªå”¯ä¸€çš„æ•°å€¼</li>\n<li>jdk1.5ä¹‹åçš„ä¸‰å¤§ç‰ˆæœ¬\n<ul>\n<li>Java SEï¼ˆJ2SEï¼ŒJava 2 Platform Standard Editionï¼Œæ ‡å‡†ç‰ˆï¼‰æ¡Œé¢ã€æœåŠ¡å™¨ã€åµŒå…¥å¼ç¯å¢ƒ</li>\n<li>Java EEï¼ˆJ2EEï¼ŒJava 2 Platform Enterprise Editionï¼Œä¼ä¸šç‰ˆï¼‰æä¾› Web æœåŠ¡ã€ç»„ä»¶æ¨¡å‹ã€ç®¡ç†å’Œé€šä¿¡ API</li>\n<li>Java MEï¼ˆJ2MEï¼ŒJava 2 Platform Micro Editionï¼Œå¾®å‹ç‰ˆï¼‰ç§»åŠ¨è®¾å¤‡å’ŒåµŒå…¥å¼è®¾å¤‡</li>\n</ul>\n</li>\n</ul>\n<h1>javaå¼€å‘ç¯å¢ƒçš„æ­å»º</h1>\n<ul>\n<li>javaå¼€å‘ç¯å¢ƒæ¦‚è¿°ï¼ˆjavaç¨‹åºè¿è¡Œéœ€è¦çš„ç¯å¢ƒï¼‰\n<ul>\n<li>JDKï¼šjava Development Kitï¼Œç¨‹åºå‘˜çš„ç”µè„‘ä¸Šå®‰è£…JDKï¼›JDKåŒ…å«JRE</li>\n<li>JREï¼šjava Runtime Environmentï¼Œjavaè¿è¡Œç¯å¢ƒï¼Œç”¨æˆ·åœ¨ç”µè„‘ä¸Šå®‰è£…JREå³å¯</li>\n</ul>\n</li>\n<li>javaç¨‹åºè¿è¡Œè¿‡ç¨‹\n<ul>\n<li>javaæºä»£ç -&gt;ç¼–è¯‘å™¨-&gt;jvmå¯æ‰§è¡Œçš„javaå­—èŠ‚ç (å³è™šæ‹ŸæŒ‡ä»¤)-&gt;jvm-&gt;jvmä¸­è§£æå™¨-&gt;æœºå™¨å¯æ‰§è¡Œçš„äºŒè¿›åˆ¶æœºå™¨ç -&gt;ç¨‹åºè¿è¡Œ</li>\n</ul>\n</li>\n<li>ç¼–å†™HelloWorldç¨‹åº\n<ul>\n<li>ç¼–å†™javaæºä»£ç æ–‡ä»¶:ç”¨è®°äº‹æœ¬æ–°å»ºæ–‡ä»¶å¹¶å‘½åä¸ºHelloWorld.javaï¼ˆç±»åå¿…é¡»ä¸æºæ–‡ä»¶åç§°å®Œå…¨ç›¸åŒï¼‰</li>\n<li>ç¼–è¯‘ï¼šé€šè¿‡jvmç¼–è¯‘å™¨æŠŠæºæ–‡ä»¶ç¼–è¯‘æˆå­—èŠ‚ç æ–‡ä»¶(æ‰©å±•åä¸º.class)\n<ul>\n<li>ç¼–è¯‘å™¨ï¼šJDKç›®å½•ä¸‹çš„binç›®å½•javac.exe</li>\n<li>ç¼–è¯‘å‘½ä»¤ä¸ºï¼šD:\\develop\\java\\jdk1.7.0_72\\bin\\javac.exe D:\\java\\HelloWorld.java</li>\n<li>ç¼–è¯‘ä¹‹åä¼šåœ¨æºæ–‡ä»¶åŒç›®å½•ä¸‹ç”Ÿæˆå­—èŠ‚ç æ–‡ä»¶ï¼Œå­—èŠ‚ç æ–‡ä»¶çš„æ‰©å±•åä¸º.class</li>\n<li>ç¼–è¯‘æ—¶æ§åˆ¶å°ä¸Šä¸ä¼šæœ‰è¾“å‡ºï¼Œå¦‚æœæœ‰è¾“å‡ºè¯´æ˜æºä»£ç æœ‰é”™è¯¯</li>\n</ul>\n</li>\n<li>è¿è¡Œï¼šä½¿ç”¨è§£é‡Šå™¨æ¥è¿è¡Œå­—èŠ‚ç æ–‡ä»¶\n<ul>\n<li>D:\\develop\\java\\jdk1.7.0_72\\bin\\java.exe HelloWord åœ¨è¿è¡ŒHelloWorld.classæ–‡ä»¶æ—¶ä¸èƒ½ç»™å‡ºâ€œ.classâ€ï¼Œåˆ‡è®°ï¼ï¼ï¼</li>\n</ul>\n</li>\n<li>è§£é‡Šå™¨è¿è¡Œè¿‡ç¨‹ï¼š\n<ul>\n<li>æŸ¥æ‰¾classpathä¸‹é¢çš„æ‰€æœ‰çš„classæ–‡ä»¶ï¼Œä»æ ¹ç›®å½•å¼€å§‹ï¼Œè§£é‡Šå™¨è·å–åŒ…çš„åç§°å¹¶å°†æ¯ä¸ªå¥ç‚¹æ›¿æ¢æˆåæ–œæ ï¼Œä»¥ä»classpathæ ¹ä¸­äº§ç”Ÿè·¯å¾„åç§°ï¼Œå¾—åˆ°çš„è·¯å¾„ä¼šä¸classpathä¸­çš„å„ä¸ªä¸åŒçš„é¡¹ç›¸è¿æ¥ï¼Œè§£é‡Šå™¨å°±åœ¨è¿™äº›ç›®å½•ä¸­æŸ¥æ‰¾ä¸ä½ æ‰€è¦åˆ›å»ºçš„ç±»åç§°ç›¸å…³çš„.classæ–‡ä»¶</li>\n</ul>\n</li>\n<li>æŸ¥çœ‹å­—èŠ‚ç æ–‡ä»¶\n<ul>\n<li>D:\\develop\\java\\jdk1.7.0_72\\bin\\javap.exe â€“c HelloWord åœ¨è¿è¡ŒHelloWorld.classæ–‡ä»¶æ—¶ä¸èƒ½ç»™å‡ºâ€œ.classâ€ï¼Œåˆ‡è®°ï¼ï¼ï¼</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class HelloWorld {\n    public static void main(String[] args) {\n        System.out.println(\"HelloWorld\");\n    }\n}\n</code></pre></div><ul>\n<li>é…ç½®javaç¯å¢ƒå˜é‡ï¼ˆå‡å°‘è¾“å…¥JDKçš„binç›®å½•çš„éº»çƒ¦ï¼‰\n<ul>\n<li>åœ¨DOSæ§åˆ¶å°ä¸­ä½¿ç”¨çš„ç¨‹åºåªç»™å‡ºç¨‹åºåç§°ï¼Œè€Œæ²¡æœ‰ç»™å‡ºå®Œæ•´è·¯å¾„æ—¶ï¼ŒWindowsç³»ç»Ÿä¼šåˆ°Pathå˜é‡ä¿å­˜çš„è·¯å¾„ä¸­æŸ¥æ‰¾ç¨‹åº\n<ul>\n<li>é¼ æ ‡å³é”®ç‚¹å‡»è®¡ç®—æœºâ†’å±æ€§â†’é«˜çº§ç³»ç»Ÿè®¾ç½®â†’ç¯å¢ƒå˜é‡â†’ç³»ç»Ÿå˜é‡ä¸­çš„Pathâ†’ç¼–è¾‘ï¼Œå°†JDKå®‰è£…ç›®å½•\\binè·¯å¾„é…ç½®åˆ°PATHå˜é‡ä¸­ï¼Œç”¨è‹±æ–‡åˆ†å·ä¸å…¶ä»–å˜é‡éš”å¼€</li>\n<li>ç¼–è¯‘ï¼šD:&gt;javac HelloWorld.java</li>\n<li>è¿è¡Œï¼šD:&gt;java HelloWorld</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1><code>æ³¨é‡Šã€å…³é”®å­—ä¸æ ‡è¯†ç¬¦</code></h1>\n<ul>\n<li>\n<p>ç¨‹åºæ³¨é‡Š:å¯¹æºç è¿›è¡Œè§£é‡Šè¯´æ˜çš„æ–‡å­—, //å•è¡Œæ³¨é‡Šã€/*å¤šè¡Œæ³¨é‡Š*/ã€/**æ–‡æ¡£æ³¨é‡Š**/</p>\n</li>\n<li>\n<p>å…³é”®å­—:è¢«èµ‹äºˆç‰¹æ®Šå«ä¹‰ï¼Œå…·æœ‰ä¸“é—¨ç”¨é€”çš„å‡ä¸ºå°å†™çš„å•è¯,publicç­‰|</p>\n</li>\n<li>\n<p>æ ‡è¯†ç¬¦:ç±»ã€æ–¹æ³•ã€å˜é‡ã€åŒ…ã€æ¥å£å,ç»„æˆå…ƒç´  a-zA-Zã€0-9ã€_ä¸$</p>\n<ul>\n<li>è§„åˆ™:æ•°å­—ä¸èƒ½å¼€å¤´ã€ä¸å¯ä»¥ä½¿ç”¨å…³é”®å­—ã€ä¸¥æ ¼åŒºåˆ†å¤§å°å†™ï¼Œè§åçŸ¥æ„</li>\n<li>å‘½åè§„èŒƒ\n<ul>\n<li>åŒ…åï¼šå¤šå•è¯ç»„æˆæ—¶æ‰€æœ‰å­—æ¯å‡å°å†™ï¼Œä½¿ç”¨.è¿æ¥aaa.bbb.ccc</li>\n<li>ç±»å&amp;æ¥å£åï¼šå¤§é©¼å³°å¼AaaBbbCcc</li>\n<li>å˜é‡å&amp;æ–¹æ³•åï¼šå°é©¼å³°å¼aaaBbbCcc</li>\n<li>å¸¸é‡åï¼šå¤šå•è¯ç»„æˆæ˜¯æ‰€æœ‰å­—æ¯å‡å¤§å†™ï¼Œä½¿ç”¨_è¿æ¥AAA_BBB_CCC</li>\n<li>è¡¨å&amp;å­—æ®µå&amp;è§†å›¾å&amp;å­˜å‚¨è¿‡ç¨‹: å°å†™å­—æ¯æˆ–è€…æ•°å­—+ä¸‹åˆ’çº¿</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>æŸ¥çœ‹æ³¨é‡Šæ–‡æ¡£ D:\\java\\jdk1.7.0_72\\bin\\javadoc.exe â€“c HelloWord.java</p>\n</li>\n</ul>\n<h1><code>æ•°æ®ç±»å‹</code></h1>\n<ul>\n<li>æ•°æ®ç±»å‹æ•°æ®èŒƒå›´ä»å°åˆ°å¤§ï¼šbyte -&gt; short -&gt; int -&gt; long -&gt; float -&gt; double</li>\n<li>èŒƒå›´å°çš„æ•°æ®ç±»å‹å€¼ï¼ˆå¦‚byteï¼‰ï¼Œå¯ä»¥ç›´æ¥è½¬æ¢ä¸ºèŒƒå›´å¤§çš„æ•°æ®ç±»å‹å€¼ï¼ˆå¦‚intï¼‰</li>\n<li>èŒƒå›´å¤§çš„æ•°æ®ç±»å‹å€¼ï¼ˆå¦‚intï¼‰ï¼Œä¸å¯ä»¥ç›´æ¥è½¬æ¢ä¸ºèŒƒå›´å°çš„æ•°æ®ç±»å‹å€¼ï¼ˆå¦‚byteï¼‰</li>\n<li>å¤šç§ç±»å‹æ•°æ®æ··åˆè¿ç®—æ—¶ï¼Œç³»ç»Ÿè‡ªåŠ¨å°†æ‰€æœ‰æ•°æ®è½¬æ¢æˆå®¹é‡æœ€å¤§çš„é‚£ä¸€ç§æ•°æ®ç±»å‹å†è®¡ç®—</li>\n<li>æ•°æ®ç±»å‹è½¬æ¢ï¼ˆå¸ƒå°”å€¼é™¤å¤–ï¼‰ä¸åŒç±»å‹çš„å˜é‡å¯ä»¥åœ¨ä¸€èµ·è¿ç®—ï¼Œä½†è¦å…ˆè¿›è¡Œç±»å‹è½¬æ¢å†è¿ç®—\n<ul>\n<li>è‡ªåŠ¨ç±»å‹è½¬æ¢:èŒƒå›´å°çš„æ•°æ®ç±»å‹è½¬æ¢æˆèŒƒå›´å¤§çš„æ•°æ®ç±»å‹ æ ¼å¼:èŒƒå›´å¤§çš„æ•°æ®ç±»å‹ å˜é‡ = èŒƒå›´å°çš„æ•°æ®ç±»å‹å€¼</li>\n<li>å¼ºåˆ¶ç±»å‹è½¬æ¢:èŒƒå›´å¤§çš„æ•°æ®ç±»å‹è½¬æ¢æˆèŒƒå›´å°çš„æ•°æ®ç±»å‹ æ ¼å¼:èŒƒå›´å°çš„æ•°æ®ç±»å‹ å˜é‡ = (èŒƒå›´å°çš„æ•°æ®ç±»å‹) èŒƒå›´å¤§çš„æ•°æ®ç±»å‹å€¼ï¼Œ</li>\n</ul>\n</li>\n<li>åŸºæœ¬æ•°æ®ç±»å‹å­˜å‚¨åœ¨å †æ ˆä¸­ï¼Œå¯¹è±¡å­˜å‚¨åœ¨å †ä¸­</li>\n<li>æˆå‘˜å˜é‡æ—¶ä¸Šè¿°æ•°æ®ç±»å‹æ‰æœ‰é»˜è®¤å€¼ï¼Œå±€éƒ¨å˜é‡æ²¡æœ‰</li>\n</ul>\n<h1>ç›´æ¥å¸¸é‡å’Œå˜é‡</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç›´æ¥å¸¸é‡(ä¸å˜çš„æ•°æ®é‡)æ•°æ®ç±»å‹</th>\n<th style=\"text-align:center\">ä¸¾ä¾‹ï¼ˆå­—ç¬¦å‡æŒ‡æ±‰å­—æ•°å­—å’Œå­—æ¯ï¼‰</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">æ•´æ•°ç±»å‹</td>\n<td style=\"text-align:center\">äºŒè¿›åˆ¶ï¼šä»¥0é›¶b(0B)å¼€å¤´ å¦‚0b1011 ã€0B1001</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å…«è¿›åˆ¶ï¼šä»¥0å¼€å¤´   å¦‚01ã€07ã€0721</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">åè¿›åˆ¶ï¼šæ­£å¸¸æ•°å­—   å¦‚ 13ã€25ç­‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">åå…­è¿›åˆ¶ï¼šä»¥0x(0X)å¼€å¤´,æ•°å­—ä»¥0-9åŠA-Fç»„æˆ,å¦‚0x23A2ã€0xaã€0x10</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å…¶ä»–è¿›åˆ¶åˆ°åè¿›åˆ¶ï¼šæŠŠç³»æ•°*åŸºæ•°çš„æƒæ¬¡å¹‚ç›¸åŠ å³å¯ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">åè¿›åˆ¶åˆ°å…¶ä»–è¿›åˆ¶è½¬æ¢ï¼šé™¤åŸºå–ä½™ï¼Œç›´åˆ°å•†ä¸º0ï¼Œæœ€åï¼Œä½™æ•°åè½¬å°±æ˜¯ç»“æœ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">æ•´æ•°å¸¸é‡æ ¹æ®æ‰€åœ¨èŒƒå›´æ¥ç¡®å®šç±»å‹ã€é»˜è®¤çš„æ•´æ•°ç±»å‹æ˜¯intç±»å‹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">æ·»åŠ äº†â€œLâ€åç¼€çš„æ•´æ•°å¸¸é‡éƒ½æ˜¯longç±»å‹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æµ®ç‚¹ç±»å‹</td>\n<td style=\"text-align:center\">1.0ã€-3.15ã€3.168ç­‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">æ— åç¼€ä»¥åŠä½¿ç”¨â€œDâ€åç¼€çš„å°æ•°éƒ½æ˜¯doubleç±»å‹(é»˜è®¤çš„æµ®ç‚¹ç±»å‹)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">floatç±»å‹å¸¸é‡å¿…é¡»æ·»åŠ â€œFâ€åç¼€ï¼Œé»˜è®¤çš„æµ®ç‚¹ç±»å‹æ˜¯doubleç±»å‹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å­—ç¬¦ç±»å‹</td>\n<td style=\"text-align:center\">å­—ç¬¦å¿…é¡»ä½¿ç”¨â€™â€™ åŒ…è£¹ï¼Œå¹¶ä¸”å…¶ä¸­åªèƒ½ä¸”ä»…èƒ½åŒ…å«ä¸€ä¸ªå­—ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å¸ƒå°”ç±»å‹</td>\n<td style=\"text-align:center\">trueã€false</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å­—ç¬¦ä¸²ç±»å‹String(å¼•ç”¨ç±»å‹)</td>\n<td style=\"text-align:center\">å­—ç¬¦ä¸²å¿…é¡»ä½¿ç”¨\"\"åŒ…è£¹ï¼Œå¯ä»¥åŒ…å«0~Nä¸ªå­—ç¬¦</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>å˜é‡:å†…å­˜ä¸­è£…è½½æ•°æ®çš„å°ç›’å­ï¼Œç”¨æ¥å­˜æ•°æ®å’Œå–æ•°æ®</li>\n<li>å®šä¹‰å˜é‡ï¼šæ•°æ®ç±»å‹  å˜é‡å  =  æ•°æ®å€¼ï¼›</li>\n<li>å˜é‡å®šä¹‰åå¯ä»¥ä¸èµ‹å€¼ï¼Œä½¿ç”¨æ—¶å†èµ‹å€¼ã€‚ä¸èµ‹å€¼ä¸èƒ½ä½¿ç”¨</li>\n<li>å˜é‡ä¸å¯ä»¥é‡å¤å®šä¹‰</li>\n<li>å˜é‡ä½¿ç”¨æ—¶æœ‰ä½œç”¨åŸŸçš„é™åˆ¶</li>\n</ul>\n<h1>åŸç ã€åç ã€è¡¥ç ï¼ˆçœ‹è®¡ç®—æœºç»„æˆåŸç†ï¼‰</h1>\n<ul>\n<li>åŸç ï¼šäºŒè¿›åˆ¶æ•°çš„æœ‰ç¬¦å·è¡¨ç¤ºæ³•ï¼Œå³æœ€é«˜ä½ä¸ºç¬¦å·ä½ï¼Œ</li>\n<li>åç ï¼šAï¼šæ­£æ•° ä¸åŸç ç›¸åŒBï¼šè´Ÿæ•° ç¬¦å·ä½ä¸å˜ï¼Œæ•°å€¼ä½æŒ‰ä½å–åï¼Œ0å˜1,1å˜0</li>\n<li>è¡¥ç ï¼šAï¼šæ­£æ•° ä¸åŸç ç›¸åŒBï¼šè´Ÿæ•° åç åŠ 1ã€‚</li>\n</ul>\n<h1>è¿ç®—ç¬¦</h1>\n<ul>\n<li>è¿ç®—ç¬¦æ˜¯ç”¨æ¥è®¡ç®—æ•°æ®çš„ç¬¦å·ã€‚æ•°æ®ä¸ºå¸¸é‡æˆ–å˜é‡ã€‚è¢«è¿ç®—ç¬¦æ“ä½œçš„æ•°æˆ‘ä»¬ç§°ä¸ºæ“ä½œæ•°ã€‚</li>\n<li>Stringä¸å…¶ä»–åŸºæœ¬æ•°æ®ç±»å‹ç›¸åŠ ï¼Œä¼šå°†å…¶ä»–ç±»å‹è½¬æ¢ä¸ºStringå†æ‹¼æ¥</li>\n<li>å¦‚æœå¯¹charã€byteã€shortç±»å‹è¿›è¡Œç§»ä½å¤„ç†ï¼Œé‚£ä¹ˆåœ¨ç§»ä½è¿›è¡Œä¹‹å‰ï¼Œä¼šå…ˆè½¬æˆintï¼Œç»“æœä¹Ÿæ˜¯intã€‚</li>\n<li>intåªæœ‰æ•°å€¼å³ç«¯çš„ä½5ä½æœ‰æ•ˆï¼Œé˜²æ­¢æº¢å‡ºï¼Œå› ä¸º2çš„5æ¬¡æ–¹ä¸º32ï¼Œintç±»å‹åªæœ‰32ä½ï¼ŒåŒç†ï¼Œlongåªæœ‰6ä½</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">è¿ç®—ç¬¦</th>\n<th style=\"text-align:center\">ä¸¾ä¾‹</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">ç®—æœ¯è¿ç®—ç¬¦</td>\n<td style=\"text-align:center\">-(å‡ã€è´Ÿå·)ã€*ã€+(æ­£ã€åŠ å·ã€è¿æ¥å­—ç¬¦ä¸²)</td>\n<td style=\"text-align:center\">åŠ æ³•è¿ç®—ç¬¦åœ¨è¿æ¥å­—ç¬¦ä¸²æ—¶åªæœ‰ç›´æ¥ä¸å­—ç¬¦ä¸²ç›¸åŠ æ‰ä¼šè½¬æˆå­—ç¬¦ä¸²</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">%(å–æ¨¡)</td>\n<td style=\"text-align:center\">å°æ•°å–ä½™æ²¡æœ‰æ„ä¹‰ã€‚ç»“æœç¬¦å·ä¸è¢«å–ä½™ç¬¦å·ç›¸åŒ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">/</td>\n<td style=\"text-align:center\">å‡ä¸ºæ•´æ•°åˆ™å–æ•´èˆä½™ï¼Œå½“å…¶ä¸­ä¸€è¾¹ä¸ºæµ®ç‚¹å‹åˆ™æŒ‰æ­£å¸¸è§„åˆ™ç›¸é™¤ã€‚é™¤æ•°ä¸ä¸º0</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">++(è‡ªå¢)--(è‡ªå‡)</td>\n<td style=\"text-align:center\">å•ç‹¬ä½¿ç”¨ï¼Œä¸å‚ä¸è¿ç®—æ“ä½œæ—¶ï¼Œè¿ç®—ç¬¦å‰åä½ç½®å¯¼è‡´çš„è¿ç®—ç»“æœä¸€è‡´</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">åç½®æ—¶è¿ç®—åæ‰è‡ªå¢/å‡1ï¼Œå‰ç½®åˆ™è¿ç®—å‰è‡ªå¢/å‡1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">èµ‹å€¼è¿ç®—ç¬¦</td>\n<td style=\"text-align:center\">+=ã€-=ã€*=ã€/=ã€%=</td>\n<td style=\"text-align:center\">å°†ç»“æœè‡ªåŠ¨å¼ºè½¬æˆç­‰å·å·¦è¾¹çš„æ•°æ®ç±»å‹,å·¦è¾¹å¿…é¡»æ˜¯å˜é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">=</td>\n<td style=\"text-align:center\">å°†=ç¬¦å·å³è¾¹çš„å€¼ï¼Œèµ‹å€¼ç»™=ç¬¦å·å·¦è¾¹çš„å˜é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æ¯”è¾ƒè¿ç®—ç¬¦</td>\n<td style=\"text-align:center\">!=ã€&lt;ã€&gt;ã€&lt;=ã€&gt;=</td>\n<td style=\"text-align:center\">è¿”å›å¸ƒå°”å€¼ï¼Œåˆ¤æ–­ä¸¤ä¸ªæ“ä½œæ•°çš„å¤§å°å…³ç³»åŠæ˜¯å¦ç›¸ç­‰å…³ç³»</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">==</td>\n<td style=\"text-align:center\">æ¯”è¾ƒå·¦å³åŸºæœ¬æ•°å­—ç±»å‹çš„å˜é‡å€¼æˆ–è€…å¼•ç”¨æ•°æ®ç±»å‹çš„å˜é‡çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">é€»è¾‘è¿ç®—ç¬¦</td>\n<td style=\"text-align:center\">&amp;(ä¸)ã€Â¦(æˆ–)ã€</td>\n<td style=\"text-align:center\">è¿æ¥ä¸¤ä¸ªå…¶ä»–è¡¨è¾¾å¼è®¡ç®—åçš„å¸ƒå°”å€¼ç»“æœï¼Œå¹¶æ±‚å‡ºå¸ƒå°”å€¼ç»“æœ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">&amp;&amp;(çŸ­è·¯ä¸)ã€Â¦Â¦(çŸ­è·¯æˆ–)</td>\n<td style=\"text-align:center\">åªè¦èƒ½åˆ¤æ–­å‡ºç»“æœåˆ™åè¾¹çš„éƒ¨åˆ†å°±ä¸å†åˆ¤æ–­</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">é€»è¾‘é!</td>\n<td style=\"text-align:center\">å°†trueå˜falseï¼Œfalseå˜true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å¼‚æˆ–^ï¼š</td>\n<td style=\"text-align:center\">å·¦å³ä¸¤è¾¹æ¡ä»¶ç»“æœç›¸åŒï¼Œç»“æœå°±ä¸ºfalseï¼Œå¦åˆ™true</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ä¸‰å…ƒè¿ç®—ç¬¦</td>\n<td style=\"text-align:center\">(æ¡ä»¶è¡¨è¾¾å¼)ï¼Ÿè¡¨è¾¾å¼1ï¼šè¡¨è¾¾å¼2ï¼›</td>\n<td style=\"text-align:center\">æ¡ä»¶è¡¨è¾¾å¼çš„å€¼è‹¥ä¸ºtrueï¼Œç»“æœä¸ºè¡¨è¾¾å¼1ï¼›å¦åˆ™ä¸ºè¡¨è¾¾å¼2</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">System.out.println( 3&gt;2 ? â€œæ­£ç¡®â€ : â€œé”™è¯¯â€ );</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">int a = 3;int b = 4;String result = (a==b) ? â€œç›¸ç­‰â€ : â€œä¸ç›¸ç­‰â€;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">int n = (3&gt;2 &amp;&amp; 4&gt;6) ? 100 : 200;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">æŒ‰ä½æ“ä½œç¬¦</td>\n<td style=\"text-align:center\">&amp;(æŒ‰ä½ä¸)</td>\n<td style=\"text-align:center\">ä»…å½“ä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸º1æ—¶ã€‚è¾“å‡ºç»“æœæ‰ä¸º1ã€‚å¦åˆ™ä¸º0</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Â¦(æŒ‰ä½æˆ–)</td>\n<td style=\"text-align:center\">ä»…å½“ä¸¤ä¸ªæ“ä½œæ•°éƒ½ä¸º0æ—¶ï¼Œè¾“å‡ºçš„ç»“æœæ‰ä¸º0ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">~(å–å)</td>\n<td style=\"text-align:center\">å°†å„ä½æ•°å­—å–åï¼šå…¨éƒ¨çš„0ç½®ä¸º1ï¼Œ1ç½®ä¸º0</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç§»ä½æ“ä½œç¬¦</td>\n<td style=\"text-align:center\">^(å¼‚æˆ–)</td>\n<td style=\"text-align:center\">ä»…å½“ä¸¤ä¸ªæ“ä½œæ•°ä¸åŒä¸€æ—¶å€™ã€‚å¯¹åº”çš„è¾“å‡ºç»“æœæ‰ä¸º1ï¼Œå¦åˆ™ä¸º0</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">&lt;&lt;</td>\n<td style=\"text-align:center\">å·¦ç§»å°±æ˜¯æŠŠä¸€ä¸ªæ•°çš„å…¨éƒ¨ä½æ•°éƒ½å‘å·¦ç§»åŠ¨è‹¥å¹²ä½ï¼Œä½ä½è¡¥0ï¼Œä¹˜ä»¥2çš„næ¬¡å¹‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">&gt;&gt;</td>\n<td style=\"text-align:center\">å³ç§»å°±æ˜¯æŠŠä¸€ä¸ªæ•°çš„å…¨éƒ¨ä½æ•°éƒ½å‘å³ç§»åŠ¨è‹¥å¹²ä½ï¼Œè‹¥æ­£æ•°ï¼Œé«˜ä½æ’å…¥0ï¼Œå¦åˆ™æ’å…¥1ï¼Œé™¤ä»¥2çš„næ¬¡å¹‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">&gt;&gt;&gt;</td>\n<td style=\"text-align:center\">æ— ç¬¦å·å³ç§»ä¸€ä½ã€‚æ— è®ºæ­£è´Ÿéƒ½åœ¨é«˜ä½æ’å…¥0</td>\n</tr>\n</tbody>\n</table>\n<br>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">è¿ç®—ç¬¦ä¼˜å…ˆçº§</th>\n<th style=\"text-align:center\">æè¿°</th>\n<th style=\"text-align:center\">è¿ç®—ç¬¦</th>\n<th style=\"text-align:center\">ä¼˜å…ˆçº§</th>\n<th style=\"text-align:center\">æè¿°</th>\n<th style=\"text-align:center\">è¿ç®—ç¬¦</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">æ‹¬å·</td>\n<td style=\"text-align:center\">()ã€[]</td>\n<td style=\"text-align:center\">9</td>\n<td style=\"text-align:center\">æŒ‰ä½ä¸</td>\n<td style=\"text-align:center\">&amp;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">2</td>\n<td style=\"text-align:center\">æ­£è´Ÿå·</td>\n<td style=\"text-align:center\">+ã€-</td>\n<td style=\"text-align:center\">10</td>\n<td style=\"text-align:center\">æŒ‰ä½å¼‚æˆ–</td>\n<td style=\"text-align:center\">^</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">è‡ªå¢è‡ªå‡ï¼Œé</td>\n<td style=\"text-align:center\">++ã€--ã€!</td>\n<td style=\"text-align:center\">11</td>\n<td style=\"text-align:center\">æŒ‰ä½æˆ–</td>\n<td style=\"text-align:center\">|</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">ä¹˜é™¤ï¼Œå–ä½™</td>\n<td style=\"text-align:center\">*ã€/ã€%</td>\n<td style=\"text-align:center\">12</td>\n<td style=\"text-align:center\">é€»è¾‘ä¸</td>\n<td style=\"text-align:center\">&amp;&amp;</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">åŠ å‡</td>\n<td style=\"text-align:center\">+ã€-</td>\n<td style=\"text-align:center\">13</td>\n<td style=\"text-align:center\">é€»è¾‘æˆ–</td>\n<td style=\"text-align:center\">||</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">6</td>\n<td style=\"text-align:center\">ç§»ä½è¿ç®—</td>\n<td style=\"text-align:center\">&lt;&lt;ã€&gt;&gt;ã€&gt;&gt;&gt;</td>\n<td style=\"text-align:center\">14</td>\n<td style=\"text-align:center\">æ¡ä»¶è¿ç®—</td>\n<td style=\"text-align:center\">?:</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">å¤§å°å…³ç³»</td>\n<td style=\"text-align:center\">&gt;ã€&gt;=ã€&lt;ã€&lt;=</td>\n<td style=\"text-align:center\">15</td>\n<td style=\"text-align:center\">èµ‹å€¼è¿ç®—</td>\n<td style=\"text-align:center\">=ã€+=ã€-=ã€*=ã€/=ã€%=</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">8</td>\n<td style=\"text-align:center\">ç›¸ç­‰å…³ç³»</td>\n<td style=\"text-align:center\">==ã€!=</td>\n<td style=\"text-align:center\">16</td>\n<td style=\"text-align:center\">ä½èµ‹å€¼è¿ç®—</td>\n<td style=\"text-align:center\">&amp;=ã€|=ã€&lt;&lt;=ã€&gt;&gt;=ã€&gt;&gt;&gt;=</td>\n</tr>\n</tbody>\n</table>\n<h1>æµç¨‹æ§åˆ¶</h1>\n<h2>é¡ºåºç»“æ„</h2>\n<h2>é€‰æ‹©ç»“æ„</h2>\n<ul>\n<li>é€‰æ‹©ç»“æ„if</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tifè¯­å¥åˆ¤æ–­æ¡ä»¶æ˜¯ä¸€ä¸ªå¸ƒå°”å€¼ï¼Œå½“åˆ¤æ–­æ¡ä»¶ä¸ºtrueæ—¶ï¼Œ{}ä¸­çš„æ‰§è¡Œè¯­å¥æ‰ä¼šæ‰§è¡Œ\n\t\tif (æ¡ä»¶è¯­å¥){ \n\t\t\tæ‰§è¡Œè¯­å¥;\n\t\t\tâ€¦â€¦\n\t\t}\n\tifâ€¦elseè¯­å¥æŒ‡å¦‚æœåˆ¤æ–­æ¡ä»¶ä¸ºtrueæ—¶ï¼Œå°±è¿›è¡ŒæŸç§å¤„ç†ï¼Œå¦åˆ™å°±è¿›è¡Œå¦ä¸€ç§å¤„ç†\n\t\tif (åˆ¤æ–­æ¡ä»¶){\n\t\t\tæ‰§è¡Œè¯­å¥1\n\t\t\tâ€¦â€¦\n\t\t}else{\n\t\t\tæ‰§è¡Œè¯­å¥2\n\t\t\tâ€¦â€¦\n\t\t}//ä¸ä¸‰å…ƒè¿ç®—ç¬¦åŠŸèƒ½ç›¸ä¼¼\n\tifâ€¦else ifâ€¦elseè¯­å¥æ‰€æœ‰æ¡ä»¶å‡æœªæ»¡è¶³ï¼Œelseåé¢{}ä¸­çš„æ‰§è¡Œè¯­å¥n+1ä¼šæ‰§è¡Œ\n\t\tif (åˆ¤æ–­æ¡ä»¶1) {\n\t\t\tæ‰§è¡Œè¯­å¥1\n\t\t} else if (åˆ¤æ–­æ¡ä»¶2) {\n\t\t\tæ‰§è¡Œè¯­å¥2\n\t\t}\n\t\t...\n\t\telse if (åˆ¤æ–­æ¡ä»¶n) {\n\t\t\tæ‰§è¡Œè¯­å¥n\n\t\t} else {\n\t\t\tæ‰§è¡Œè¯­å¥n+1\n\t\t}\n</code></pre></div><ul>\n<li>é€‰æ‹©ç»“æ„switchï¼šifâ€¦else ifâ€¦elseè¯­å¥æ¥å®ç°ï¼Œä½†æ˜¯ç”±äºåˆ¤æ–­æ¡ä»¶æ¯”è¾ƒå¤šï¼Œå®ç°èµ·æ¥ä»£ç è¿‡é•¿ï¼Œä¸ä¾¿äºé˜…è¯»</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tswitch (è¡¨è¾¾å¼){//è¡¨è¾¾å¼çš„å€¼ä¸ºbyteã€shortã€intã€charã€enumæšä¸¾ã€String\n\tcase ç›®æ ‡å€¼1:\n\t\tæ‰§è¡Œè¯­å¥1\n\t\tbreak;\n\tcase ç›®æ ‡å€¼2:\n\tcase ç›®æ ‡å€¼3:\n\t\tæ‰§è¡Œè¯­å¥2//å¤šä¸ªæ¡ä»¶æ»¡è¶³\n\t\tbreak;\n\tï¼ï¼ï¼ï¼ï¼ï¼\n\tcase ç›®æ ‡å€¼n:\n\t\tæ‰§è¡Œè¯­å¥n\n\t\tbreak;\n\tdefault:\n\t\tæ‰§è¡Œè¯­å¥n+1\n\t\tbreak;\n\t}\n</code></pre></div><h2>å¾ªç¯ç»“æ„ï¼ˆè¿­ä»£ï¼‰</h2>\n<ul>\n<li>å¾ªç¯è¯­å¥whileï¼šåå¤è¿›è¡Œæ¡ä»¶åˆ¤æ–­ï¼Œæ¡ä»¶æˆç«‹ï¼Œ{}å†…çš„æ‰§è¡Œè¯­å¥å°±ä¼šæ‰§è¡Œï¼Œç›´åˆ°æ¡ä»¶ä¸æˆç«‹ï¼Œwhileå¾ªç¯ç»“æŸ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\twhile(å¾ªç¯æ¡ä»¶è¡¨è¾¾å¼){//å¾ªç¯ä½“\n\t\tæ‰§è¡Œè¯­å¥...\n\t\tæ§åˆ¶æ¡ä»¶è¡¨è¾¾å¼;\n\t}\n</code></pre></div><ul>\n<li>å¾ªç¯è¯­å¥doâ€¦whileï¼šå¾ªç¯ä½“ä¼šæ— æ¡ä»¶æ‰§è¡Œä¸€æ¬¡ï¼Œç„¶åå†æ ¹æ®å¾ªç¯æ¡ä»¶æ¥å†³å®šæ˜¯å¦ç»§ç»­æ‰§è¡Œ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tdo {\n\t\tæ‰§è¡Œè¯­å¥â€¦â€¦â€¦\n\t\tæ§åˆ¶æ¡ä»¶è¡¨è¾¾å¼;\n\t} while(å¾ªç¯æ¡ä»¶è¡¨è¾¾å¼);\n</code></pre></div><ul>\n<li>å¾ªç¯è¯­å¥forï¼šä¸€èˆ¬ç”¨åœ¨å¾ªç¯æ¬¡æ•°å·²çŸ¥çš„æƒ…å†µä¸‹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tforï¼ˆåˆå§‹åŒ–è¡¨è¾¾å¼; å¾ªç¯æ¡ä»¶; æ“ä½œè¡¨è¾¾å¼ï¼‰{//1,243,243\n\t\tæ‰§è¡Œè¯­å¥\n\t\tâ€¦â€¦â€¦\n\t}\n\tfor(æ•°æ®ç±»å‹ å˜é‡å : éå†çš„å˜é‡){\n\t\tæ‰§è¡Œè¯­å¥\n\t}\n</code></pre></div><ul>\n<li>æ— é™å¾ªç¯:while(true){} æˆ–for(;ğŸ˜‰{} ï¼šæ— é™å¾ªç¯å­˜åœ¨çš„åŸå› æ˜¯å¹¶ä¸çŸ¥é“å¾ªç¯å¤šå°‘æ¬¡ï¼Œè€Œæ˜¯æ ¹æ®æŸäº›æ¡ä»¶ï¼Œæ¥æ§åˆ¶å¾ªç¯</li>\n<li>å¾ªç¯åµŒå¥—:åœ¨ä¸€ä¸ªå¾ªç¯è¯­å¥çš„å¾ªç¯ä½“ä¸­å†å®šä¹‰ä¸€ä¸ªå¾ªç¯è¯­å¥çš„è¯­æ³•ç»“æ„</li>\n</ul>\n<h2>è·³è½¬è¯­å¥</h2>\n<ul>\n<li>breakè¯­å¥\n<ul>\n<li>åœ¨switchæ¡ä»¶è¯­å¥ä¸­æ—¶ï¼Œç»ˆæ­¢æŸä¸ªcaseå¹¶è·³å‡ºswitchç»“æ„</li>\n<li>åœ¨å¾ªç¯è¯­å¥ä¸­ï¼Œä½œè·³å‡ºæœ¬å±‚å¾ªç¯è¯­å¥ï¼Œæ‰§è¡Œåé¢çš„ä»£ç </li>\n<li>æ ‡è®°ï¼šå½“breakè¯­å¥å‡ºç°åœ¨åµŒå¥—å¾ªç¯ä¸­çš„å†…å±‚å¾ªç¯æ—¶ï¼Œå®ƒåªèƒ½è·³å‡ºå†…å±‚å¾ªç¯ï¼Œ</li>\n<li>å¦‚æœæƒ³ä½¿ç”¨breakè¯­å¥ç»“æŸåµŒå¥—å¾ªç¯åˆ™éœ€è¦å¯¹å¤–å±‚å¾ªç¯æ·»åŠ æ ‡ç­¾ï¼ˆåé¢è·Ÿæœ‰å†’å·çš„æ ‡è¯†ç¬¦ï¼‰ XXXï¼šç„¶åbreak XXX</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public static void main(String[] args) {\n    ok:\n    for (int i = 0; i &lt; 10; i++) {\n        for (int j = 0; j &lt; 10; j++) {\n            System.out.println(\"i=\" + i + \",j=\" + j);\n            if (j == 5) {\n                break ok;\n            }\n        }\n    }\n}\n</code></pre></div><ul>\n<li>continueè¯­å¥ï¼šç»ˆæ­¢æœ¬æ¬¡å¾ªç¯ï¼Œæ‰§è¡Œä¸‹ä¸€æ¬¡å¾ªç¯ï¼›å¯ä»¥é€šè¿‡ä½¿ç”¨æ ‡è®°çš„æ–¹å¼ç»“æŸæœ¬æ¬¡åµŒå¥—å¾ªç¯ï¼Œç”¨æ³•ä¸breakè¯­å¥ç›¸ä¼¼</li>\n</ul>\n<h1>æ•°ç»„</h1>\n<ul>\n<li>æ•°ç»„ï¼ˆé•¿åº¦å›ºå®šï¼Œæ•°ç»„ä¸­å­˜å‚¨çš„å…ƒç´ çš„æ•°æ®ç±»å‹è¦æ±‚ä¸€è‡´ï¼‰</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>|åˆ†ç±»|è¯´æ˜|ä»£ç |\n|:-:|:-:|:-:|\n|ä¸€ç»´æ•°ç»„|å®šä¹‰|åŠ¨æ€åˆå§‹åŒ–ï¼ˆå®šä¹‰æ•°ç»„æ—¶åªæŒ‡å®šæ•°ç»„é•¿åº¦ï¼Œç”±ç³»ç»Ÿè‡ªåŠ¨ä¸ºå…ƒç´ èµ‹åˆå€¼ï¼‰|\n|||æ•°æ®ç±»å‹[] æ•°ç»„å = new æ•°æ®ç±»å‹[æ•°ç»„é•¿åº¦];|\n|||é™æ€åˆå§‹åŒ–ï¼ˆå®šä¹‰æ•°ç»„æ—¶ä¸ºå…ƒç´ èµ‹å€¼ï¼‰|\n|||ç±»å‹[] æ•°ç»„å = new ç±»å‹[]{å…ƒç´ ï¼Œå…ƒç´ ï¼Œâ€¦â€¦};|\n|||ç±»å‹[] æ•°ç»„å = {å…ƒç´ ï¼Œå…ƒç´ ï¼Œå…ƒç´ ï¼Œâ€¦â€¦};(å»ºè®®)|\n||è®¿é—®|æ•°ç»„å[ç´¢å¼•]ã€æ•°ç»„å[ç´¢å¼•] =å€¼ã€æ•°ç»„å.length|\t\n||éå†|for (int i = 0; i &lt; arr.length; i++) {System.out.println(arr[i]);}|\n||æœ€å€¼|int max=arr[0];for(int x=1;x&lt;arr.length;x++){if(arr[x] &gt; max){max = arr[x];}}|\n|äºŒç»´æ•°ç»„|å®šä¹‰|int[][] arr = new int[m][n]|\n|||m:äºŒç»´æ•°ç»„ä¸­ä¸€ç»´æ•°ç»„çš„ä¸ªæ•°,n:æ¯ä¸ªä¸€ç»´æ•°ç»„ä¸­å…ƒç´ çš„ä¸ªæ•°int[][] arr = new int[3][];|\n|||æ¯ä¸€ä¸ªä¸€ç»´æ•°ç»„é€šè¿‡èµ‹å€¼æ¥ç¡®å®šæ•°ç»„é•¿åº¦int[][] arr = &amp;#123;&amp;#123;1,2&amp;#125;,&amp;#123;3,4,5,6&amp;#125;,&amp;#123;7,8,9&amp;#125;&amp;#125;|\n||è®¿é—®|æ•°ç»„å[ç´¢å¼•][ç´¢å¼•]ã€æ•°ç»„å[ç´¢å¼•][ç´¢å¼•]=å€¼ã€æ•°ç»„å.length|\n||éå†|for(int i=0;i&lt;arr2.length;i++){for(int j=0;j&lt;arr2[i].length;j++){System.out.println(arr2[i][j]);}}|\n|æ•°ç»„å¼‚å¸¸||NullPointerExceptionå˜é‡å¼•ç”¨æ•°ç»„æ—¶ï¼Œå˜é‡çš„å€¼å¿…é¡»æ˜¯æ•°ç»„å¯¹è±¡ï¼Œä¸èƒ½ä¸ºnull\n|||ArrayIndexOutOfBoundsExceptionè®¿é—®æ•°ç»„çš„å…ƒç´ æ—¶ï¼Œç´¢å¼•ä¸èƒ½è¶…å‡º0~length-1èŒƒå›´|\n</code></pre></div><h1>å¯å˜å‚æ•°ï¼š(Object... args)</h1>\n<h1>ç±»ä¸å¯¹è±¡</h1>\n<ul>\n<li>ç±»æ˜¯å¯¹æŸä¸€ç±»äº‹ç‰©çš„æŠ½è±¡æè¿°ï¼Œç±»ç”¨äºæè¿°å¤šä¸ªå¯¹è±¡çš„å…±åŒç‰¹å¾ï¼Œå®ƒæ˜¯å¯¹è±¡çš„æ¨¡æ¿ã€‚</li>\n<li>å¯¹è±¡ç”¨äºè¡¨ç¤ºç°å®ä¸­è¯¥ç±»äº‹ç‰©çš„ä¸ªä½“ï¼Œå®ƒæ˜¯ç±»çš„å®ä¾‹</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>[public] [abstract] class ç±»å{\n    è®¿é—®ä¿®é¥°ç¬¦ [static] [final] æ•°æ®ç±»å‹ å˜é‡å(s);//å˜é‡\n\n    è®¿é—®ä¿®é¥°ç¬¦ [abstract|static]  [void/è¿”å›å€¼] æ–¹æ³•å([å‚æ•°ç±»å‹ å‚æ•°å])//å‚æ•°åˆ—è¡¨//æˆå‘˜[é™æ€]æ–¹æ³•\n    [{//å±€éƒ¨ä»£ç å—\n        [æ‰§è¡Œè¯­å¥â€¦â€¦â€¦;]\n        [return è¿”å›å€¼;]\n    }](s);\n\n    è®¿é—®ä¿®é¥°ç¬¦ ç±»å{}(s);//æ„é€ æ–¹æ³•\n\n    {}(s);//æ„é€ ä»£ç å—\n    \n    static{}(s);//é™æ€ä»£ç å—\n    \n    å†…éƒ¨ç±»(s);\n}\n</code></pre></div><ul>\n<li>æˆå‘˜æ–¹æ³•\n<ul>\n<li>å½¢å¼å‚æ•°ï¼šæ–¹æ³•å®šä¹‰ä¸­å‚æ•°åˆ—è¡¨çš„å˜é‡ã€å®é™…å‚æ•°ï¼šè°ƒç”¨æ–¹æ³•æ—¶ï¼Œä¼ å…¥ç»™æ–¹æ³•çš„æ•°å€¼</li>\n<li>å½“ä¼ å…¥çš„æ•°å€¼ä¸ºåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆåŒ…å«Stringç±»å‹ï¼‰ï¼Œä¼ é€’çš„æ˜¯å˜é‡çš„å€¼</li>\n<li>å½“ä¼ å…¥çš„æ•°å€¼ä¸ºå¼•ç”¨æ•°æ®ç±»å‹ï¼ˆStringç±»å‹é™¤å¤–ï¼‰ï¼Œä¼ é€’çš„æ˜¯å˜é‡çš„åœ°å€</li>\n<li>æœ‰è¿”å›å€¼æ–¹æ³•è°ƒç”¨:â‘ å•ç‹¬è°ƒç”¨â‘¡è¾“å‡ºè°ƒç”¨â‘¢èµ‹å€¼è°ƒç”¨ã€æ— è¿”å›å€¼ç±»å‹çš„æ–¹æ³•è°ƒç”¨æ–¹å¼ï¼šå•ç‹¬è°ƒç”¨</li>\n</ul>\n</li>\n<li>æ„é€ æ–¹æ³•\n<ul>\n<li>æ„é€ æ–¹æ³•åç§°å¿…é¡»å’Œç±»å‹ä¿æŒä¸€è‡´ã€æƒ³è®©å…¶ä»–ç¨‹åºæ— æ³•åˆ›å»ºè¯¥ç±»çš„å¯¹è±¡ï¼Œåˆ™ç”¨privateä¿®é¥°</li>\n<li>æ„é€ æ–¹æ³•é»˜è®¤ç¬¬ä¸€æ¡è¯­å¥ä¸ºsuper();ç”¨æ¥è®¿é—®çˆ¶ç±»ä¸­çš„ç©ºå‚æ•°æ„é€ æ–¹æ³•ï¼Œè¿›è¡Œçˆ¶ç±»æˆå‘˜çš„åˆå§‹åŒ–æ“ä½œ</li>\n<li>super(å‚æ•°) ä¸ this(å‚æ•°) ä¸èƒ½åŒæ—¶åœ¨æ„é€ æ–¹æ³•ä¸­å­˜åœ¨</li>\n<li>é»˜è®¤å…ˆæ‰§è¡Œçˆ¶ç±»çš„æ„é€ æ–¹æ³•ï¼Œå†æ‰§è¡Œå­ç±»çš„æ„é€ æ–¹æ³•</li>\n</ul>\n</li>\n<li>å±€éƒ¨ä»£ç å—{}:å®šä¹‰åœ¨æ–¹æ³•ä¸­çš„ä»£ç å—,ç”¨æ¥é™åˆ¶å˜é‡çš„ä½œç”¨èŒƒå›´</li>\n<li>æ„é€ ä»£ç å—{}:å®šä¹‰åœ¨ç±»ä¸­æ–¹æ³•å¤–çš„ä»£ç å—ã€åˆ›å»ºå¯¹è±¡æ—¶åªæ‰§è¡Œä¸€æ¬¡ï¼Œç”¨äºå¯¹è±¡æˆå‘˜åˆå§‹åŒ–ã€ä¼˜å…ˆäºæ„é€ æ–¹æ³•æ‰§è¡Œ</li>\n<li>é™æ€ä»£ç å—static{}:å®šä¹‰åœ¨ç±»ä¸­æ–¹æ³•å¤–ä½¿ç”¨staticä¿®é¥°çš„ä»£ç å—ã€è¢«åŠ è½½æ—¶æ‰§è¡Œä¸€æ¬¡ï¼Œç”¨äºç»™é™æ€å˜é‡èµ‹å€¼ã€ç±»é™æ€æˆå‘˜åˆå§‹åŒ–èµ‹å€¼ã€‚ä¼˜äºä¸»æ–¹æ³•ã€æ„é€ ä»£ç å—æ‰§è¡Œ</li>\n<li>finalize()æ–¹æ³•ï¼šä¸€æ—¦åƒåœ¾å›æ”¶å™¨å‡†å¤‡å¥½é‡Šæ”¾å¯¹è±¡å ç”¨çš„å­˜å‚¨ç©ºé—´ï¼Œä¼šå…ˆè°ƒç”¨å™¨finalize()æ–¹æ³•ï¼Œå¹¶ä¸”åœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶åŠ¨ä½œå‘ç”Ÿæ—¶ï¼Œæ‰ä¼šçœŸæ­£å›æ”¶å¯¹è±¡å ç”¨çš„å†…å­˜\n<ul>\n<li>æœ‰æ—¶ï¼Œè‹¥åˆ†é…å†…å­˜æ—¶é‡‡ç”¨ç±»ç±»ä¼¼Cè¯­è¨€ä¸­çš„åšæ³•ï¼Œå³è°ƒç”¨æœ¬åœ°æ–¹æ³•æ—¶éœ€è¦æ¥é‡Šæ”¾å†…å­˜ï¼Œä½†ä¸è¦æ»¥ç”¨</li>\n</ul>\n</li>\n</ul>\n<h2>åŒ¿åå¯¹è±¡</h2>\n<ul>\n<li>åˆ›å»ºå¯¹è±¡æ—¶ï¼Œåªæœ‰åˆ›å»ºå¯¹è±¡çš„è¯­å¥ï¼Œå´æ²¡æœ‰æŠŠå¯¹è±¡åœ°å€å€¼èµ‹å€¼ç»™æŸä¸ªå˜é‡ new ç±»å([å‚æ•°]);</li>\n<li>åªèƒ½ä½¿ç”¨ä¸€æ¬¡ã€å¯ä½œä¸ºæ–¹æ³•æ¥æ”¶çš„å‚æ•°ã€æ–¹æ³•è¿”å›å€¼ä½¿ç”¨</li>\n</ul>\n<h1>è½¬å‹</h1>\n<ul>\n<li>å‘ä¸Šè½¬å‹:å½“æœ‰å­ç±»å¯¹è±¡èµ‹å€¼ç»™ä¸€ä¸ªçˆ¶ç±»å¼•ç”¨ï¼ˆå¤šæ€ï¼‰\n<ul>\n<li>æ–¹æ³•ä¼ å‚å¯ä»¥å®šä¹‰ä¸ºçˆ¶ç±»ï¼Œå®é™…å‚æ•°å¯ä»¥ä¼ å­ç±»</li>\n<li>çˆ¶ç±»ç±»å‹ å˜é‡å = (çˆ¶ç±»ç±»å‹) å­ç±»ç±»å‹çš„å˜é‡</li>\n<li>å¥½å¤„ï¼šéšè—äº†å­ç±»ç±»å‹ï¼Œæé«˜äº†ä»£ç çš„æ‰©å±•æ€§</li>\n<li>å¼Šç«¯ï¼šåªèƒ½ä½¿ç”¨çˆ¶ç±»å…±æ€§çš„å†…å®¹ï¼Œè€Œæ— æ³•ä½¿ç”¨å­ç±»ç‰¹æœ‰åŠŸèƒ½</li>\n</ul>\n</li>\n<li>å‘ä¸‹è½¬å‹ï¼šä¸€ä¸ªå·²ç»å‘ä¸Šè½¬å‹çš„å­ç±»å¯¹è±¡å¯ä»¥ä½¿ç”¨å¼ºåˆ¶ç±»å‹è½¬æ¢,å°†çˆ¶ç±»å¼•ç”¨è½¬ä¸ºå­ç±»å¼•ç”¨\n<ul>\n<li>å¦‚æœæ˜¯ç›´æ¥åˆ›å»ºçˆ¶ç±»å¯¹è±¡ï¼Œæ˜¯æ— æ³•å‘ä¸‹è½¬å‹çš„ï¼</li>\n<li>å­ç±»ç±»å‹ å˜é‡å = (å­ç±»ç±»å‹) çˆ¶ç±»ç±»å‹çš„å˜é‡</li>\n<li>å¥½å¤„ï¼šå¯ä»¥ä½¿ç”¨å­ç±»ç‰¹æœ‰åŠŸèƒ½</li>\n<li>å¼Šç«¯ï¼šéœ€è¦é¢å¯¹å…·ä½“çš„å­ç±»å¯¹è±¡ï¼›å®¹æ˜“å‘ç”ŸClassCastExceptionç±»å‹è½¬æ¢å¼‚å¸¸ã€‚åœ¨è½¬æ¢ä¹‹å‰å¿…é¡»åšç±»å‹åˆ¤æ–­</li>\n</ul>\n</li>\n<li>å½“ä¸éœ€è¦é¢å¯¹å­ç±»ç±»å‹æ—¶ï¼Œé€šè¿‡æé«˜æ‰©å±•æ€§ï¼Œæˆ–è€…ä½¿ç”¨çˆ¶ç±»çš„åŠŸèƒ½å°±èƒ½å®Œæˆç›¸åº”çš„æ“ä½œ å½“è¦ä½¿ç”¨å­ç±»ç‰¹æœ‰åŠŸèƒ½æ—¶ï¼Œå°±éœ€è¦ä½¿ç”¨å‘ä¸‹è½¬å‹</li>\n</ul>\n<h1>æŠ½è±¡ç±»ï¼ˆåŸºç¡€åŠŸèƒ½ï¼‰ä¸æ¥å£ï¼ˆæ‰©å±•åŠŸèƒ½ï¼‰</h1>\n<ul>\n<li>æŠ½è±¡ç±»ï¼šè¢«abstractå…³é”®å­—ä¿®é¥°çš„ç±»æ˜¯æŠ½è±¡ç±»ï¼Œå®šä¹‰äº†æŠ½è±¡æ–¹æ³•çš„ç±»\n<ul>\n<li>æŠ½è±¡ç±»å¯ä»¥ä¸å®šä¹‰æŠ½è±¡æ–¹æ³•ã€‚ä½†æŠ½è±¡æ–¹æ³•ä¸€å®šè¦å®šä¹‰åœ¨æŠ½è±¡ç±»ä¸­ï¼Œå«æœ‰æŠ½è±¡æ–¹æ³•çš„ç±»ä¸€å®šæ˜¯æŠ½è±¡ç±»</li>\n<li>æŠ½è±¡ç±»ä¸å¯ä»¥ç›´æ¥åˆ›å»ºå¯¹è±¡ï¼ŒåŸå› ï¼šè°ƒç”¨æŠ½è±¡æ–¹æ³•æ²¡æœ‰æ„ä¹‰</li>\n<li>åªæœ‰è¦†ç›–äº†æŠ½è±¡ç±»ä¸­æ‰€æœ‰æŠ½è±¡æ–¹æ³•åï¼Œå…¶å­ç±»æ‰å¯ä»¥åˆ›å»ºå¯¹è±¡ã€‚å¦åˆ™è¯¥å­ç±»è¿˜æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»</li>\n<li>æŠ½è±¡ç±»éƒ½æ˜¯çˆ¶ç±»ï¼Œå› ä¸ºä¸æ–­æŠ½å–è€Œæ¥çš„ã€‚</li>\n<li>æŠ½è±¡ç±»çš„å­˜åœ¨çš„æ„ä¹‰æ˜¯ä¸ºäº†ä¸è®©è¯¥ç±»åˆ›å»ºå¯¹è±¡,æ–¹æ³•å¯ä»¥ç›´æ¥è®©å­ç±»å»ä½¿ç”¨</li>\n<li>abstractä¸å¯ä»¥å’Œprivateã€finalã€staticå…±å­˜</li>\n<li>å­ç±»ï¼šæŠ½è±¡æ–¹æ³•çš„å®ç°ç±»ã€æŠ½è±¡ç±»</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>abstract class ç±»å {\n    [public abstract è¿”å›å€¼ç±»å‹ æ–¹æ³•å(å‚æ•°);(s)]\n}\n</code></pre></div><ul>\n<li>æ¥å£ï¼šåŠŸèƒ½çš„é›†åˆï¼Œæ˜¯æ¯”æŠ½è±¡ç±»æ›´ä¸ºæŠ½è±¡çš„â€ç±»â€ï¼ŒåªåŒ…å«äº†åŠŸèƒ½å£°æ˜çš„ç‰¹æ®Šç±»\n<ul>\n<li>ä¼˜ç‚¹ï¼šå°†åŠŸèƒ½çš„å£°æ˜ä¸å®ç°åˆ†ç¦»ï¼Œä¼˜åŒ–äº†ç¨‹åºè®¾è®¡ï¼Œè§£è€¦</li>\n<li>æ¥å£é¿å…äº†å•ç»§æ‰¿çš„å±€é™æ€§ã€‚çˆ¶ç±»ä¸­å®šä¹‰çš„äº‹ç‰©çš„åŸºæœ¬åŠŸèƒ½ï¼Œæ¥å£ä¸­å®šä¹‰çš„äº‹ç‰©çš„æ‰©å±•åŠŸèƒ½</li>\n<li>æ¥å£ä¸å¯ä»¥åˆ›å»ºå¯¹è±¡ï¼Œå¯é€šè¿‡å¤šæ€çš„æ–¹å¼ï¼Œç”±å­ç±»æ¥åˆ›å»ºå¯¹è±¡ï¼Œæ¥å£å¤šæ€</li>\n<li>å­ç±»å¿…é¡»è¦†ç›–æ‰æ¥å£ä¸­æ‰€æœ‰çš„æŠ½è±¡æ–¹æ³•åï¼Œå­ç±»æ‰å¯ä»¥å®ä¾‹åŒ–ã€‚å¦åˆ™å­ç±»æ˜¯ä¸€ä¸ªæŠ½è±¡ç±»</li>\n<li>è§£å†³äº†å¤šç»§æ‰¿æ—¶ï¼Œå½“å¤šä¸ªçˆ¶ç±»ä¸­æœ‰ç›¸åŒåŠŸèƒ½æ—¶ï¼Œå­ç±»è°ƒç”¨äº§ç”Ÿçš„ä¸ç¡®å®šæ€§ã€‚å› ä¸ºæ²¡æœ‰æ¥å£æ–¹æ³•ä½“</li>\n<li>æ¥å£ä¸ç±»å…³ç³» class ç±» implements æ¥å£1,æ¥å£2 {}</li>\n<li>æ¥å£ä¸æ¥å£å…³ç³» interface Zi extends Fu1,Fu2,Fu3{}</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface æ¥å£å{\n    [public static final] A_B=å€¼;//å¸¸é‡ï¼Œæ¥å£å˜é‡ï¼Œä¸å¯è¢«ä¿®æ”¹\n    [public abstract] è¿”å›å€¼ç±»å‹ æ–¹æ³•å(æ•°æ®ç±»å‹ å˜é‡å(s));//æŠ½è±¡æ–¹æ³•\n}\n</code></pre></div><h1>æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡åŒºåˆ«</h1>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">é¡¹ç›®</th>\n<th style=\"text-align:center\">æˆå‘˜å˜é‡</th>\n<th style=\"text-align:center\">å±€éƒ¨å˜é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">å®šä¹‰çš„ä½ç½®</td>\n<td style=\"text-align:center\">ç±»ä¸­çš„å˜é‡</td>\n<td style=\"text-align:center\">æ–¹æ³•ä¸­æˆ–è€…{}è¯­å¥é‡Œé¢çš„å˜é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">å†…å­˜ä¸­çš„ä½ç½®</td>\n<td style=\"text-align:center\">å †å†…å­˜çš„å¯¹è±¡ä¸­</td>\n<td style=\"text-align:center\">æ ˆå†…å­˜çš„æ–¹æ³•ä¸­</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ç”Ÿå‘½å‘¨æœŸ</td>\n<td style=\"text-align:center\">éšç€å¯¹è±¡çš„å‡ºç°è€Œå‡ºç°åœ¨å †ä¸­ï¼Œéšç€å¯¹è±¡çš„æ¶ˆå¤±è€Œä»å †ä¸­æ¶ˆå¤±</td>\n<td style=\"text-align:center\">éšç€æ–¹æ³•çš„è¿è¡Œè€Œå‡ºç°åœ¨æ ˆä¸­ï¼Œéšç€æ–¹æ³•çš„å¼¹æ ˆè€Œæ¶ˆå¤±</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">åˆå§‹åŒ–</td>\n<td style=\"text-align:center\">æœ‰é»˜è®¤çš„åˆå§‹åŒ–å€¼</td>\n<td style=\"text-align:center\">å¿…é¡»æ‰‹åŠ¨çš„ç»™å…¶èµ‹å€¼æ‰å¯ä»¥ä½¿ç”¨ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">ä½œç”¨åŸŸ</td>\n<td style=\"text-align:center\">é’ˆå¯¹æ•´ä¸ªç±»æœ‰æ•ˆ</td>\n<td style=\"text-align:center\">åªåœ¨æŸä¸ªèŒƒå›´å†…æœ‰æ•ˆã€‚(æ–¹æ³•,è¯­å¥ä½“å†…)</td>\n</tr>\n</tbody>\n</table>\n<h1>åŒ…çš„å£°æ˜ä¸è®¿é—®</h1>\n<ul>\n<li>ç±»ä¸­å£°æ˜çš„åŒ…å¿…é¡»ä¸å®é™…classæ–‡ä»¶æ‰€åœ¨çš„æ–‡ä»¶å¤¹æƒ…å†µç›¸ä¸€è‡´ï¼Œå¦åˆ™ï¼Œç¨‹åºè¿è¡Œæ—¶ä¼šæ‰¾ä¸åˆ°ç±»</li>\n<li>ç±»ä¸­åŒ…çš„å£°æ˜ï¼špackage åŒ…å.åŒ…å.åŒ…åâ€¦; å¿…é¡»åœ¨ç¨‹åºçš„ç¬¬ä¸€è¡Œ</li>\n<li>åŒ…åé‡‡ç”¨å…¨éƒ¨å°å†™å­—æ¯ï¼Œå¤šå±‚åŒ…ä¹‹é—´ç”¨â€.â€è¿æ¥</li>\n<li>å¸¦æœ‰åŒ…çš„ç±»åˆ›å»ºå¯¹è±¡ï¼šåŒ…å.ç±»å å˜é‡å = newåŒ…å.ç±»å();</li>\n<li>å¯¼åŒ…ï¼šimport åŒ…å.ç±»å;  import åŒ…å.*;(å¯¼å…¥åŒ…å†…æ‰€æœ‰ç±»)åœ¨å£°æ˜åŒ…packageåï¼Œå®šä¹‰æ‰€æœ‰ç±»classå‰</li>\n<li>åŒä¸€ä¸ªåŒ…ä¸­çš„ç±»ï¼ˆåŒä¸€ä¸ªæ–‡ä»¶å¤¹ä¸­ï¼‰ï¼Œæˆ–è€…java.langåŒ…ä¸­ç±»æ—¶å¯ä»¥çœç•¥åŒ…åï¼Œç›´æ¥ä½¿ç”¨è¯¥ç±»</li>\n<li>ç±»ç”¨publicä¿®é¥°ï¼Œåˆ™ç±»åå¿…é¡»ä¸æ–‡ä»¶åç›¸åŒã€‚ä¸€ä¸ªæ–‡ä»¶ä¸­åªèƒ½æœ‰ä¸€ä¸ªpublicä¿®é¥°çš„ç±»</li>\n</ul>\n<h1>å¸¸è§å…³é”®å­—(å°å†™)</h1>\n<ul>\n<li>this\n<ul>\n<li>æŒ‡å‘å½“å‰å¯¹è±¡æŒ‡é’ˆï¼Œåˆ›å»ºå¯¹è±¡çš„æ—¶å€™å°±å­˜åœ¨</li>\n<li>è°ƒç”¨æœ¬ç±»å¯¹è±¡æ„é€ æ–¹æ³•ï¼šthis([å‚æ•°åˆ—è¡¨]);å¿…é¡»å®šä¹‰åœ¨æ„é€ æ–¹æ³•çš„ç¬¬ä¸€è¡Œï¼Œå› ä¸ºåˆå§‹åŒ–åŠ¨ä½œè¦æœ€å…ˆæ‰§è¡Œ</li>\n<li>è°ƒç”¨æœ¬ç±»å¯¹è±¡ä¸€èˆ¬æ–¹æ³•ï¼šæ–¹æ³•å([å‚æ•°åˆ—è¡¨])æˆ–this.æ–¹æ³•å([å‚æ•°åˆ—è¡¨])</li>\n<li>æˆå‘˜å˜é‡åå‰é¢åŠ ä¸Šthis.åŒºåˆ«æˆå‘˜å˜é‡å’Œå±€éƒ¨å˜é‡</li>\n</ul>\n</li>\n<li>super\n<ul>\n<li>æŒ‡å‘ç›´æ¥çˆ¶ç±»çš„æŒ‡é’ˆ</li>\n<li>è°ƒç”¨çˆ¶ç±»å˜é‡ï¼šsuper.å˜é‡å</li>\n<li>è°ƒç”¨çˆ¶ç±»æ„é€ æ–¹æ³•ï¼šsuper([å®å‚åˆ—è¡¨])</li>\n<li>è°ƒç”¨çˆ¶ç±»æ–¹æ³•ï¼šsuper.æ–¹æ³•å([å®å‚åˆ—è¡¨])</li>\n<li>å¦‚æœæˆ‘ä»¬æ²¡å†™ä»»ä½•çš„æ„é€ æ–¹æ³•ï¼Œç¼–è¯‘å™¨æä¾›ç»™æˆ‘ä»¬ä¸€ä¸ªç©ºå‚æ•°æ„é€ æ–¹æ³•</li>\n<li>å¦‚æœæˆ‘ä»¬æ‰‹åŠ¨ç»™å‡ºäº†æ„é€ æ–¹æ³•ï¼Œç¼–è¯‘å™¨ä¸ä¼šåœ¨ç»™æˆ‘ä»¬æä¾›é»˜è®¤çš„ç©ºå‚æ•°æ„é€ æ–¹æ³•</li>\n<li>å­ç±»ç»§æ‰¿çˆ¶ç±»ä¸­çš„å†…å®¹,å¿…é¡»å…ˆè°ƒç”¨çˆ¶ç±»çš„æ„é€ æ–¹æ³•è¿›è¡Œåˆå§‹åŒ–ï¼Œæ•…å­ç±»ä¸­æ‰€æœ‰æ„é€ æ–¹æ³•æœ‰é»˜è®¤çš„éšå¼super();æ•…çˆ¶ç±»çš„æ„é€ æ–¹æ³•ä¼šå…ˆæ‰§è¡Œ</li>\n<li>å¦‚æœé»˜è®¤çš„éšå¼super()åœ¨çˆ¶ç±»ä¸­æ²¡æœ‰å¯¹åº”çš„æ„é€ æ–¹æ³•ï¼Œé‚£ä¹ˆå¿…é¡»åœ¨æ„é€ æ–¹æ³•ä¸­é€šè¿‡thisæˆ–è€…superçš„å½¢å¼æ˜ç¡®è¦è°ƒç”¨çš„æ„é€ æ–¹æ³•</li>\n</ul>\n</li>\n<li>final\n<ul>\n<li>ç±»ã€å˜é‡æˆ–æ–¹æ³•ä¸æƒ³è¢«ç»§æ‰¿ã€ä¿®æ”¹ã€é‡å†™ï¼Œå¯ä»¥é‡è½½</li>\n<li>ä½†æ˜¯å¯ä»¥ç»§æ‰¿å…¶ä»–ç±»,å¯ä»¥è¦†ç›–å…¶ä»–æ–¹æ³•æ—¶åŠ ä¸Šfinal</li>\n<li>ä¿®é¥°çš„å˜é‡ç§°ä¸ºå¸¸é‡ï¼Œåªèƒ½èµ‹å€¼ä¸€æ¬¡ï¼Œå¿…é¡»åœ¨åˆ›å»ºå¯¹è±¡å‰èµ‹å€¼ã€æ²¡æœ‰æ˜¾å¼èµ‹å€¼æ—¶ï¼Œå¤šä¸ªæ„é€ æ–¹æ³•éƒ½è¦ä¸ºå…¶èµ‹å€¼</li>\n<li>ä¿®é¥°å¼•ç”¨ç±»å‹çš„å˜é‡å€¼ä¸ºå¯¹è±¡åœ°å€å€¼ï¼Œåœ°å€å€¼ä¸èƒ½æ›´æ”¹ã€ä½†æ˜¯åœ°å€å†…çš„å¯¹è±¡å±æ€§å€¼å¯ä»¥ä¿®æ”¹</li>\n<li>finalæˆå‘˜å˜é‡\n<ul>\n<li>ç±»å˜é‡staticä¿®é¥°çš„å˜é‡ï¼šç›´æ¥èµ‹å€¼æˆ–è€…é™æ€ä»£ç å—ä¸­èµ‹å€¼</li>\n<li>å®ä¾‹å˜é‡ï¼šå£°æ˜å˜é‡ç›´æ¥èµ‹åˆå€¼ï¼Œéé™æ€åˆå§‹åŒ–å—ã€æ„é€ å™¨ä¸­èµ‹åˆå€¼</li>\n</ul>\n</li>\n<li>finalå±€éƒ¨å˜é‡\n<ul>\n<li>å¦‚æœfinalå±€éƒ¨å˜é‡å·²ç»è¿›è¡Œäº†åˆå§‹åŒ–åˆ™åé¢å°±ä¸èƒ½å†æ¬¡è¿›è¡Œæ›´æ”¹ï¼Œå¦‚æœfinalå˜é‡æœªè¿›è¡Œåˆå§‹åŒ–ï¼Œå¯ä»¥è¿›è¡Œèµ‹å€¼ï¼Œå½“ä¸”ä»…æœ‰ä¸€æ¬¡èµ‹å€¼</li>\n</ul>\n</li>\n<li>finalæ–¹æ³•å‚æ•°</li>\n<li>finalæ–¹æ³•ï¼š\n<ul>\n<li>ç¡®ä¿ç»§æ‰¿ä¸­ä½¿æ–¹æ³•è¡Œä¸ºä¿æŒä¸å˜ï¼Œè€Œä¸”ä¸ä¼šè¢«è¦†ç›–</li>\n<li>æ•ˆç‡ï¼Œç¼–è¯‘å™¨å°†é’ˆå¯¹è¯¥æ–¹æ³•çš„æ‰€æœ‰è°ƒç”¨è½¬ä¸ºå†…åµŒè°ƒç”¨ï¼Œè·³è¿‡æ’å…¥ç¨‹åºä»£ç çš„æ–¹å¼è€Œæ‰§è¡Œæ–¹æ³•è°ƒç”¨æœºåˆ¶ï¼ˆå°†å‚æ•°å‹å…¥æ ˆï¼Œè·³è‡³æ–¹æ³•ä»£ç å¤„æ‰§è¡Œï¼Œç„¶åè·³å›å¹¶æ¸…ç†æ ˆä¸­çš„å‚æ•°ï¼Œå¤„ç†è¿”å›å€¼ï¼‰ï¼Œå¹¶ä¸”ä»¥æ–¹æ³•ä½“ä¸­çš„å®é™…ä»£ç çš„å‰¯æœ¬æ›¿ä»£æ–¹æ³•è°ƒç”¨ï¼Œæ¶ˆé™¤æ–¹æ³•çš„å¼€é”€</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>static\n<ul>\n<li>æ— éœ€åˆ›å»ºå¯¹è±¡ï¼Œç‹¬ç«‹äºå¯¹è±¡å­˜åœ¨ï¼Œå¤šä¸ªå¯¹è±¡å…±äº«</li>\n<li>ç±»çš„åŠ è½½çš„æ—¶å€™åªæ‰§è¡Œä¸€æ¬¡ï¼ˆæ€§èƒ½ä¼˜åŒ–ï¼‰ï¼Œä¸èƒ½ä½¿ç”¨this/super</li>\n<li>é™æ€ä¿®é¥°çš„å†…å®¹ï¼ˆæ–¹æ³•ã€å˜é‡ï¼‰å­˜äºé™æ€åŒº,åŒä¸€ä¸ªç±»ä¸­ï¼Œé™æ€æˆå‘˜åªèƒ½è®¿é—®é™æ€æˆå‘˜ï¼Œä½†éé™æ€æˆå‘˜èƒ½è®¿é—®é™æ€æˆå‘˜</li>\n<li>è°ƒç”¨ï¼šç±»å.é™æ€æˆå‘˜å˜é‡å\\ç±»å.é™æ€æˆå‘˜æ–¹æ³•å(å‚æ•°)</li>\n<li>é™æ€å¸¸é‡public static final æ•°æ®ç±»å‹ AA_BB = å€¼</li>\n<li>mainæ–¹æ³•ä¸ºé™æ€æ–¹æ³•ä»…ä¸ºç¨‹åºæ‰§è¡Œå…¥å£ï¼Œä¸å±äºä»»ä½•ä¸€ä¸ªå¯¹è±¡ï¼Œå¯ä»¥å®šä¹‰åœ¨ä»»æ„ç±»ä¸­</li>\n</ul>\n</li>\n<li>instanceof\n<ul>\n<li>åˆ¤æ–­æŸä¸ªå¯¹è±¡æ˜¯å¦å±äºæŸç§æ•°æ®ç±»å‹,boolean b = å¯¹è±¡ instanceof æ•°æ®ç±»å‹</li>\n</ul>\n</li>\n</ul>\n<h1>å¸¸ç”¨ç±»api</h1>\n<ul>\n<li>apiï¼šApplication(åº”ç”¨) Programming(ç¨‹åº) Interface(æ¥å£)\n<ul>\n<li>java APIå°±æ˜¯jdkä¸­æä¾›ç»™æˆ‘ä»¬ä½¿ç”¨çš„ç±»ï¼Œè¿™äº›ç±»å°†åº•å±‚çš„ä»£ç å®ç°å°è£…äº†èµ·æ¥</li>\n<li>æºç ï¼šJDKå®‰è£…ç›®å½•çš„src.zip</li>\n</ul>\n</li>\n</ul>\n<h2>Scanner</h2>\n<ul>\n<li>Scanner(InputStream source)<a href=\"http://xn--System-9m7iy0fo4hxp2m.in\" target=\"_blank\" rel=\"noopener noreferrer\">ä¸€èˆ¬ä¼ å…¥System.in</a></li>\n<li>int nextInt(); æ¥æ”¶æ§åˆ¶å°å½•å…¥çš„æ•°å­—</li>\n<li>String next(); æ¥æ”¶æ§åˆ¶å°å½•å…¥çš„å­—ç¬¦ä¸²</li>\n</ul>\n<h2>Random</h2>\n<ul>\n<li>Random()</li>\n<li>int nextInt(int maxValue)äº§ç”Ÿ[0,maxValue)èŒƒå›´çš„éšæœºæ•´æ•°</li>\n<li>double nextDouble()  äº§ç”Ÿ[0,1)èŒƒå›´çš„éšæœºå°æ•°</li>\n</ul>\n<h2>Object:æ‰€æœ‰ç±»çš„çˆ¶ç±»</h2>\n<ul>\n<li>boolean equals(Object obj)æ¯”è¾ƒä¸¤ä¸ªå¯¹è±¡æ˜¯å¦ç›¸åŒï¼ˆé»˜è®¤ä½¿ç”¨==æ¯”è¾ƒåœ°å€ï¼‰ç»å¸¸éœ€è¦å¤å†™å®ƒæ ¹æ®å¯¹è±¡å±æ€§åˆ¤æ–­å¯¹è±¡æ˜¯å¦ç›¸åŒ</li>\n<li>String toString()è¿”å›è¯¥å¯¹è±¡çš„å­—ç¬¦ä¸²(åŒ…å.ç±»å+@+å†…å­˜åœ°å€å€¼) ç»å¸¸é‡å†™å¾—åˆ°ç›¸åº”çš„å­—ç¬¦ä¸²è¡¨ç°å½¢å¼</li>\n<li>int hashCode()è¿”å›å“ˆå¸Œç \n<ul>\n<li>ä¸ºä»€ä¹ˆè¦æœ‰ hashCodeï¼Ÿå½“ä½ æŠŠå¯¹è±¡åŠ å…¥ HashSet æ—¶ï¼ŒHashSet ä¼šå…ˆè®¡ç®—å¯¹è±¡çš„ hashcode å€¼æ¥åˆ¤æ–­å¯¹è±¡åŠ å…¥çš„ä½ç½®ï¼ŒåŒæ—¶ä¹Ÿä¼šä¸å…¶ä»–å·²ç»åŠ å…¥çš„å¯¹è±¡çš„ hashcode å€¼ä½œæ¯”è¾ƒï¼Œå¦‚æœæ²¡æœ‰ç›¸ç¬¦çš„hashcodeï¼ŒHashSetä¼šå‡è®¾å¯¹è±¡æ²¡æœ‰é‡å¤å‡ºç°ã€‚ä½†æ˜¯å¦‚æœå‘ç°æœ‰ç›¸åŒ hashcode å€¼çš„å¯¹è±¡ï¼Œè¿™æ—¶ä¼šè°ƒç”¨ equals()æ–¹æ³•æ¥æ£€æŸ¥ hashcode ç›¸ç­‰çš„å¯¹è±¡æ˜¯å¦çœŸçš„ç›¸åŒã€‚å¦‚æœä¸¤è€…ç›¸åŒï¼ŒHashSet å°±ä¸ä¼šè®©å…¶åŠ å…¥æ“ä½œæˆåŠŸã€‚å¦‚æœä¸åŒçš„è¯ï¼Œå°±ä¼šé‡æ–°æ•£åˆ—åˆ°å…¶ä»–ä½ç½®ã€‚å¤§å¤§å‡å°‘äº† equals çš„æ¬¡æ•°ï¼Œç›¸åº”å°±å¤§å¤§æé«˜äº†æ‰§è¡Œé€Ÿåº¦ã€‚</li>\n<li>å¦‚æœä¸¤ä¸ªå¯¹è±¡ç›¸ç­‰ï¼Œåˆ™hashcodeä¸€å®šä¹Ÿæ˜¯ç›¸åŒçš„ï¼Œä¸¤ä¸ªå¯¹è±¡æœ‰ç›¸åŒçš„hashcodeå€¼ï¼Œå®ƒä»¬ä¹Ÿä¸ä¸€å®šæ˜¯ç›¸ç­‰çš„</li>\n<li>equals æ–¹æ³•è¢«è¦†ç›–è¿‡ï¼Œåˆ™ hashCode æ–¹æ³•ä¹Ÿå¿…é¡»è¢«è¦†ç›–ã€‚hashCode() çš„é»˜è®¤è¡Œä¸ºæ˜¯å¯¹å †ä¸Šçš„å¯¹è±¡äº§ç”Ÿç‹¬ç‰¹å€¼ã€‚å¦‚æœæ²¡æœ‰é‡å†™ hashCode()ï¼Œåˆ™è¯¥ class çš„ä¸¤ä¸ªå¯¹è±¡æ— è®ºå¦‚ä½•éƒ½ä¸ä¼šç›¸ç­‰ï¼ˆå³ä½¿è¿™ä¸¤ä¸ªå¯¹è±¡æŒ‡å‘ç›¸åŒçš„æ•°æ®ï¼‰</li>\n<li>å¯¹è±¡çš„ç›¸ç­‰ æ¯”çš„æ˜¯å†…å­˜ä¸­å­˜æ”¾çš„å†…å®¹æ˜¯å¦ç›¸ç­‰è€Œ å¼•ç”¨ç›¸ç­‰ æ¯”è¾ƒçš„æ˜¯ä»–ä»¬æŒ‡å‘çš„å†…å­˜åœ°å€æ˜¯å¦ç›¸ç­‰</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//equalså¤å†™ä¾‹å­\nclass Person extends Object{\n\tint age ;\n\t//å¤å†™çˆ¶ç±»çš„equalsæ–¹æ³•ï¼Œå®ç°è‡ªå·±çš„æ¯”è¾ƒæ–¹å¼\n\tpublic boolean equals(Object obj) {\n\t\t//åˆ¤æ–­å½“å‰è°ƒç”¨equalsæ–¹æ³•çš„å¯¹è±¡å’Œä¼ é€’è¿›æ¥çš„å¯¹è±¡æ˜¯å¦æ˜¯åŒä¸€ä¸ª\n\t\tif(this == obj){\n\t\t\treturn true;\n\t\t}\n\t\t//åˆ¤æ–­ä¼ é€’è¿›æ¥çš„å¯¹è±¡æ˜¯å¦æ˜¯Personç±»å‹\n\t\tif(!(obj instanceof Person)){\n\t\t\treturn false;\n\t\t}\n\t\t//å°†objå‘ä¸‹è½¬å‹ä¸ºPerosnå¼•ç”¨ï¼Œè®¿é—®å…¶å±æ€§\n\t\tPerson p = (Person)obj;\n\t\treturn this.age == p.age;\n\t}\n}\n</code></pre></div><h2>Date,DateFormat,SimpleDateFormat,Calendar</h2>\n<ul>\n<li>\n<p>Date()ç³»ç»Ÿå½“å‰æ—¥æœŸæ—¶é—´ï¼Œè¡¨ç¤ºç‰¹å®šçš„ç¬é—´ï¼Œç²¾ç¡®åˆ°æ¯«ç§’</p>\n</li>\n<li>\n<p>Date(long date)1970å¹´1æœˆ1æ—¥0ç‚¹ï¼ŒåŠ ä¸Šdateæ¯«ç§’å€¼å¯¹åº”çš„æ—¥æœŸæ—¶é—´</p>\n</li>\n<li>\n<p>long getTime()è¿”å›è‡ª1970å¹´1æœˆ1æ—¥00:00ï¼šGMTä»¥æ¥æ­¤Dateå¯¹è±¡è¡¨ç¤ºçš„æ¯«ç§’æ•°</p>\n</li>\n<li>\n<p>DateFormatä¸è¯­è¨€ç¯å¢ƒæ— å…³çš„æ–¹å¼æ ¼å¼åŒ–å¹¶è§£ææ—¥æœŸæˆ–æ—¶é—´çš„æŠ½è±¡ç±»</p>\n</li>\n<li>\n<p>SimpleDateFormat</p>\n<ul>\n<li>SimpleDateFormat()é»˜è®¤çš„æ ¼å¼åŒ–æ“ä½œï¼Œå¯ä»¥å­—ç¬¦ä¸²ä¸Dateå¯¹è±¡ç›¸äº’è½¬æ¢</li>\n<li>SimpleDateFormat(String pattern)æ›¿æ¢â€yyyy-MM-dd-HH-mm-ss-SSâ€å‰©ä½™å†…å®¹åŸæ ·è¾“å‡º</li>\n<li>String format(Date date) æŠŠæ—¥æœŸæ ¼å¼åŒ–æˆå­—ç¬¦ä¸²</li>\n<li>Date parse(String source)å°†å­—ç¬¦ä¸²è½¬æˆæ—¥æœŸ</li>\n</ul>\n</li>\n<li>\n<p>Calendar</p>\n<ul>\n<li>static Calendar getInstance();ä½¿ç”¨é»˜è®¤æ—¶åŒºå’Œè¯­è¨€ç¯å¢ƒè·å¾—ä¸€ä¸ªæ—¥å†</li>\n<li>abstract void add(int field,int amount)æŒ‡å®šå­—æ®µå¢åŠ æŸå€¼12345</li>\n<li>int get(int field)è¿”å›ç»™å®šæ—¥å†å­—æ®µçš„å€¼ fieldæ˜¯æŒ‡Calendar.YEAR/MONTH/DATE/HOUR/MINUTE/SECOND</li>\n<li>final void set(int field,int value)è®¾ç½®æŒ‡å®šå­—æ®µçš„å€¼</li>\n<li>final Date getTime()è·å–è¯¥æ—¥å†å¯¹è±¡è½¬æˆçš„æ—¥æœŸå¯¹è±¡</li>\n<li>è¥¿æ–¹æ˜ŸæœŸçš„å¼€å§‹ä¸ºå‘¨æ—¥ï¼Œä¸­å›½ä¸ºå‘¨ä¸€</li>\n<li>åœ¨Calendarç±»ä¸­ï¼Œæœˆä»½çš„è¡¨ç¤ºæ˜¯ä»¥0-11ä»£è¡¨1-12æœˆ</li>\n</ul>\n</li>\n</ul>\n<h2>System</h2>\n<ul>\n<li>ä¸èƒ½æ‰‹åŠ¨åˆ›å»ºå¯¹è±¡å› ä¸ºæ„é€ æ–¹æ³•è¢«privateä¿®é¥°ï¼Œé˜»æ­¢å¤–ç•Œåˆ›å»ºå¯¹è±¡</li>\n<li>long currentTimeMillis()å½“å‰ç³»ç»Ÿæ—¶é—´ä¸1970å¹´01æœˆ01æ—¥00:00ç‚¹çš„æ¯«ç§’å·®å€¼</li>\n<li>void exit(int status)ç”¨æ¥ç»“æŸæ­£åœ¨è¿è¡Œçš„Javaç¨‹åºã€‚0æ­£å¸¸é€€å‡º</li>\n<li>void gc()ç”¨æ¥è¿è¡ŒJVMä¸­çš„åƒåœ¾å›æ”¶å™¨ï¼Œå®Œæˆå†…å­˜ä¸­åƒåœ¾çš„æ¸…é™¤</li>\n<li>String getProperty(String key)ç”¨æ¥è·å–æŒ‡ç³»ç»Ÿå±æ€§ä¿¡æ¯ï¼ˆè‡ªå·±æŸ¥è¡¨ï¼‰</li>\n<li>ä»æŒ‡å®šæºæ•°ç»„ä¸­å¤åˆ¶ä¸€ä¸ªæ•°ç»„å¤åˆ¶ä»æŒ‡å®šä½ç½®å¼€å§‹åˆ°ç›®æ ‡æ•°ç»„æŒ‡å®šä½ç½®ç»“æŸ</li>\n<li>void arrarycopy(Object src,int srcPog,Object dest,int destPes,int length</li>\n</ul>\n<h2>Math</h2>\n<ul>\n<li>Static double abs(double a)ç»å¯¹å€¼</li>\n<li>Static double ceil(double a)ç»“æœä¸ºæ¯”å‚æ•°å€¼å¤§çš„æœ€å°æ•´æ•°çš„doubleå€¼</li>\n<li>Static double floor(double a)ç»“æœä¸ºæ¯”å‚æ•°å€¼å°çš„æœ€å¤§æ•´æ•°çš„doubleå€¼</li>\n<li>Static double max(double a,double b)è¿”å›ä¸¤ä¸ªå‚æ•°å€¼ä¸­è¾ƒå¤§çš„å€¼</li>\n<li>Static double min(double a,double b)è¿”å›ä¸¤ä¸ªå‚æ•°å€¼ä¸­è¾ƒå°çš„å€¼</li>\n<li>Static double pow(double a,double b)è¿”å›ç¬¬ä¸€ä¸ªå‚æ•°çš„ç¬¬äºŒä¸ªå‚æ•°æ¬¡å¹‚çš„å€¼</li>\n<li>Static double random()äº§ç”Ÿä¸€ä¸ªå¤§äºç­‰äº0.0ä¸”å°äº1.0çš„doubleå°æ•°</li>\n</ul>\n<h2>Arrays</h2>\n<ul>\n<li>Static void sort(int[] a)å¯¹æŒ‡å®šæ•°ç»„ä¸­çš„å…ƒç´ è¿›è¡Œæ’åºï¼ˆå…ƒç´ å€¼ä»å°åˆ°å¤§è¿›è¡Œæ’åºï¼‰</li>\n<li>Static void binarySearch(int[] a,int key)åœ¨æŒ‡å®šçš„æœ‰åºæ•°ç»„ä¸­ï¼Œè¿”å›å…ƒç´ çš„ä½ç½®æˆ–-1</li>\n<li>Static String toString(int[] a)è¿”å›æŒ‡å®šæ•°ç»„å…ƒç´ å†…å®¹çš„å­—ç¬¦ä¸²å½¢å¼</li>\n</ul>\n<h2>Properties</h2>\n<ul>\n<li>æŒä¹…çš„å±æ€§é›†ã€‚å¯ä¿å­˜åœ¨æµä¸­æˆ–ä»æµä¸­åŠ è½½</li>\n<li>Hashtableçš„å­ç±»ï¼Œé”®å€¼éƒ½æ˜¯å­—ç¬¦ä¸²é”®å€¼å¯ä»¥å­˜å‚¨åˆ°é›†åˆæˆ–æ–‡ä»¶ä¸­,æ¥æºä¹Ÿå¯ä»¥æ˜¯æ–‡ä»¶</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>- void load(InputStream in)æŠŠæŒ‡å®šæµæ‰€å¯¹åº”çš„æ–‡ä»¶ä¸­çš„æ•°æ®è¯»å–å¹¶ä¿å­˜åˆ°Propertieé›†åˆä¸­\n- void load(Reader)æŒ‰é¢å‘è¡Œçš„æ ¼å¼ä»è¾“å…¥å­—ç¬¦æµä¸­è¯»å–å±æ€§åˆ—è¡¨ï¼ˆé”®å’Œå…ƒç´ å¯¹ï¼‰\n- void store(OutputStream out,String commonts)commontsä»£è¡¨å¯¹æè¿°ä¿¡æ¯ï¼Œæ— å®é™…æ„ä¹‰\n- void store(Writer writer,String comments);ä¸load(Reader)æ–¹æ³•å¯¹åº”\n- Object setProperty(String key, String value)è°ƒç”¨ Hashtable çš„æ–¹æ³• putã€‚\n- String getProperty(String key)ç”¨æŒ‡å®šçš„é”®åœ¨æ­¤å±æ€§åˆ—è¡¨ä¸­æœç´¢å±æ€§\n- Set&lt;String&gt; stringPropertyNames()è¿”å›æ­¤å±æ€§åˆ—è¡¨ä¸­çš„é”®é›†ï¼Œ\n</code></pre></div><h2>ResourceBundle</h2>\n<ul>\n<li>static ResourceBundle getBundle(String fileNmae)è·å¾—ResourceBundleå¯¹è±¡</li>\n<li>getString(String key)è·å¾—propertiesæ–‡ä»¶ä¸­é”®å¯¹åº”çš„å€¼</li>\n</ul>\n<h1>æ­£åˆ™è¡¨è¾¾å¼ï¼šRegular Expression</h1>\n<ul>\n<li>ç”¨æ¥å®šä¹‰åŒ¹é…è§„åˆ™ï¼ŒåŒ¹é…ä¸€ç³»åˆ—ç¬¦åˆæŸä¸ªå¥æ³•è§„åˆ™çš„å­—ç¬¦ä¸²ã€‚ç”¨äºæ£€ç´¢ã€æ›¿æ¢é‚£äº›ç¬¦åˆæŸä¸ªè§„åˆ™çš„æ–‡æœ¬</li>\n<li>Patternç±»</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>class RegexExample1{\n   public static void main(String[] args){\n      String content = \"I am noob \" +\n        \"from runoob.com.\";\n \n      String pattern = \".*runoob.*\";\n \n      boolean isMatch = Pattern.matches(pattern, content);\n      System.out.println(\"å­—ç¬¦ä¸²ä¸­æ˜¯å¦åŒ…å«äº† 'runoob' å­å­—ç¬¦ä¸²? \" + isMatch);\n   }\n}\n</code></pre></div><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">æ­£åˆ™è¡¨è¾¾å¼</th>\n<th style=\"text-align:center\">å«ä¹‰</th>\n<th style=\"text-align:center\">åŒ¹é…è§„åˆ™</th>\n<th style=\"text-align:center\">åŒ¹é…çš„å­—ç¬¦ä¸²å†…å®¹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">x</td>\n<td style=\"text-align:center\">å­—ç¬¦x</td>\n<td style=\"text-align:center\">a</td>\n<td style=\"text-align:center\">a</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\|åæ–œçº¿å­—ç¬¦|\\||</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\t</td>\n<td style=\"text-align:center\">åˆ¶è¡¨ç¬¦</td>\n<td style=\"text-align:center\">\\t</td>\n<td style=\"text-align:center\">äº§ç”Ÿä¸€ä¸ªåˆ¶è¡¨ç¬¦çš„ç©ºé—´</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\n</td>\n<td style=\"text-align:center\">æ¢è¡Œç¬¦</td>\n<td style=\"text-align:center\">\\n</td>\n<td style=\"text-align:center\">æ¢è¡Œ,å…‰æ ‡åœ¨åŸæœ‰ä½ç½®çš„ä¸‹ä¸€è¡Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\r</td>\n<td style=\"text-align:center\">å›è½¦ç¬¦</td>\n<td style=\"text-align:center\">\\r</td>\n<td style=\"text-align:center\">äº§ç”Ÿå›è½¦åçš„æ•ˆæœ,å…‰æ ‡æ¥åˆ°ä¸‹ä¸€è¡Œè¡Œé¦–</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[abc]</td>\n<td style=\"text-align:center\">å­—ç¬¦aã€bæˆ–c</td>\n<td style=\"text-align:center\">[abc]</td>\n<td style=\"text-align:center\">å­—ç¬¦aï¼Œæˆ–è€…å­—ç¬¦bï¼Œæˆ–å­—ç¬¦cçš„ä¸€ä¸ª</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[^abc]</td>\n<td style=\"text-align:center\">é™¤äº†aã€bã€cä»¥å¤–çš„ä»»ä½•å­—ç¬¦</td>\n<td style=\"text-align:center\">[^abc]</td>\n<td style=\"text-align:center\">ä¸æ˜¯å­—ç¬¦aï¼Œæˆ–è€…ä¸æ˜¯å­—ç¬¦bï¼Œæˆ–ä¸æ˜¯å­—ç¬¦cçš„ä»»æ„ä¸€ä¸ªå­—ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[a-zA-Z]</td>\n<td style=\"text-align:center\">a åˆ° z æˆ– A åˆ° Zï¼Œä¸¤å¤´çš„å­—æ¯åŒ…æ‹¬åœ¨å†…</td>\n<td style=\"text-align:center\">[a-zA-Z]</td>\n<td style=\"text-align:center\">ä¸€ä¸ªå¤§å†™æˆ–è€…å°å†™å­—æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[0-9]æˆ–è€…\\d</td>\n<td style=\"text-align:center\">0åˆ°9æ•°å­—ï¼Œä¸¤å¤´çš„æ•°å­—åŒ…æ‹¬åœ¨å†…</td>\n<td style=\"text-align:center\">[0-9]</td>\n<td style=\"text-align:center\">ä¸€ä¸ªæ•°å­—</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">[a-zA-Z_0-9]æˆ–è€…\\w</td>\n<td style=\"text-align:center\">å­—æ¯æˆ–è€…æ•°å­—æˆ–è€…ä¸‹åˆ’çº¿(å³å•è¯å­—ç¬¦)</td>\n<td style=\"text-align:center\">[a-zA-Z_0-9]</td>\n<td style=\"text-align:center\">ä¸€ä¸ªå­—æ¯æˆ–è€…æ˜¯ä¸€ä¸ªæ•°å­—æˆ–ä¸€ä¸ªä¸‹æ»‘çº¿</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">.</td>\n<td style=\"text-align:center\">ä»»ä½•å­—ç¬¦</td>\n<td style=\"text-align:center\">\\\\.</td>\n<td style=\"text-align:center\">ä¸€ä¸ªä»»æ„å­—ç¬¦</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">^</td>\n<td style=\"text-align:center\">è¡Œçš„å¼€å¤´</td>\n<td style=\"text-align:center\"><sup class=\"footnote-ref\"><a href=\"#footnote1\">[1]</a><a class=\"footnote-anchor\" id=\"footnote-ref1\"></a></sup><a class=\"footnote-anchor\" id=\"footnote-ref1\">[0-9]$</a></td>\n<td style=\"text-align:center\">ä»[abc]è¿™ä¸ªä½ç½®å¼€å§‹, ç›¸å½“äºå·¦åŒå¼•å·</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">$</td>\n<td style=\"text-align:center\">è¡Œçš„ç»“å°¾</td>\n<td style=\"text-align:center\"><sup class=\"footnote-ref\"><a href=\"#footnote2\">[2]</a><a class=\"footnote-anchor\" id=\"footnote-ref2\"></a></sup><a class=\"footnote-anchor\" id=\"footnote-ref2\">[0-9]$</a></td>\n<td style=\"text-align:center\">ä»¥[0-9]è¿™ä¸ªç»“æŸ, ç›¸å½“äºå³åŒå¼•å·</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">\\b</td>\n<td style=\"text-align:center\">å•è¯è¾¹ç•Œ</td>\n<td style=\"text-align:center\">\\b[abc]\\b</td>\n<td style=\"text-align:center\">å­—æ¯aæˆ–bæˆ–cçš„å·¦å³ä¸¤è¾¹éœ€è¦çš„æ˜¯éå•è¯å­—ç¬¦([a-zA-Z_0-9])</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">X?</td>\n<td style=\"text-align:center\">Xå‡ºç°ä¸€æ¬¡æˆ–ä¸€æ¬¡ä¹Ÿæ²¡æœ‰</td>\n<td style=\"text-align:center\">a?</td>\n<td style=\"text-align:center\">ä¸€ä¸ªå­—ç¬¦aï¼Œæˆ–è€…ä¸€ä¸ªaéƒ½æ²¡æœ‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">X*</td>\n<td style=\"text-align:center\">Xå‡ºç°é›¶æ¬¡æˆ–å¤šæ¬¡</td>\n<td style=\"text-align:center\">a*</td>\n<td style=\"text-align:center\">å¤šä¸ªå­—ç¬¦aï¼Œæˆ–è€…ä¸€ä¸ªaéƒ½æ²¡æœ‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">X+</td>\n<td style=\"text-align:center\">Xå‡ºç°ä¸€æ¬¡æˆ–å¤šæ¬¡</td>\n<td style=\"text-align:center\">a+</td>\n<td style=\"text-align:center\">å¤šä¸ªå­—ç¬¦aï¼Œæˆ–è€…ä¸€ä¸ªa</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">X{n}</td>\n<td style=\"text-align:center\">Xå‡ºç°æ°å¥½ n æ¬¡</td>\n<td style=\"text-align:center\">a{5}</td>\n<td style=\"text-align:center\">5ä¸ªå­—ç¬¦a</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">X{n,}</td>\n<td style=\"text-align:center\">Xå‡ºç°è‡³å°‘ n æ¬¡</td>\n<td style=\"text-align:center\">a{5, }</td>\n<td style=\"text-align:center\">æœ€å°‘æœ‰5ä¸ªå­—ç¬¦a</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">X{n,m}</td>\n<td style=\"text-align:center\">Xå‡ºç°è‡³å°‘ n æ¬¡ï¼Œä½†æ˜¯ä¸è¶…è¿‡ m æ¬¡</td>\n<td style=\"text-align:center\">a{5,8}</td>\n<td style=\"text-align:center\">æœ‰5ä¸ªå­—ç¬¦a åˆ° 8ä¸ªå­—ç¬¦aä¹‹é—´</td>\n</tr>\n</tbody>\n</table>\n<h1>åŠ¨æ€ä»£ç†</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9fed0d6aa26a8530ca255.png\" alt=\"åŠ¨æ€ä»£ç†.png\" tabindex=\"0\"><figcaption>åŠ¨æ€ä»£ç†.png</figcaption></figure>\n<ul>\n<li>JDKåŠ¨æ€ä»£ç†ï¼ˆProxyå¯¹è±¡ï¼‰ä½¿ç”¨ï¼ˆç›®æ ‡å¯¹è±¡å¿…é¡»æœ‰æ¥å£ï¼‰\n<ul>\n<li>Object o = Poxy.newProxyInstance(ClassLoader loader,Class&lt;?&gt;[] interfaces,InvocationHandler h));\n<ul>\n<li>Object:ä»£ç†å¯¹è±¡</li>\n<li>loader:ä¸ç›®æ ‡å¯¹è±¡ç›¸åŒçš„ç±»åŠ è½½å™¨:æ¥å£å®ç°ç±»Classå¯¹è±¡.getClassLoader()/Thread.currentThread().getContextClassLoader()</li>\n<li>interfaces:ä¸ç›®æ ‡å¯¹è±¡å®ç°çš„æ‰€æœ‰çš„æ¥å£Classå¯¹è±¡æ•°ç»„:new Class[]{æ¥å£Classå¯¹è±¡}/å®ç°ç±»Classå¯¹è±¡.getInterfaces()</li>\n<li>h:InvocationHandleræ¥å£å®ç°ç±»\n<ul>\n<li>Object invoke(Object proxy,Method method,Object[] args)</li>\n<li>proxy:ä»£ç†å¯¹è±¡(å®ç°ç±»å¯¹è±¡)</li>\n<li>method:ä»£ç†å¯¹è±¡(å®ç°ç±»å¯¹è±¡)å½“å‰æ‰§è¡Œæ–¹æ³•method.getName()\\method.invoke(å¯¹è±¡ï¼Œå®é™…å‚æ•°)</li>\n<li>args:æ–¹æ³•å®é™…å‚æ•°</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>æ³¨è§£</h1>\n<ul>\n<li>æ³¨è§£æ¦‚è¿°<br>\n- ä»£ç çº§åˆ«çš„è¯´æ˜ï¼Œä¸ç±»ã€æ¥å£ã€æšä¸¾åŒä¸€å±‚æ¬¡\n<ul>\n<li>æ³¨é‡Šï¼šåœ¨é˜…è¯»ç¨‹åºæ—¶æ¸…æ¥š</li>\n</ul>\n</li>\n</ul>\n<hr class=\"footnotes-sep\">\n<section class=\"footnotes\">\n<ol class=\"footnotes-list\">\n<li id=\"footnote1\" class=\"footnote-item\"><p>abc <a href=\"#footnote-ref1\" class=\"footnote-backref\">â†©ï¸</a></p>\n</li>\n<li id=\"footnote2\" class=\"footnote-item\"><p>abc <a href=\"#footnote-ref2\" class=\"footnote-backref\">â†©ï¸</a></p>\n</li>\n</ol>\n</section>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/9fed0d6aa26a8530ca255.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "jvm",
      "url": "https://javaguide.cn/backend/java/jvm.html",
      "id": "https://javaguide.cn/backend/java/jvm.html",
      "summary": "1. javaè™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ 2.1. ç¨‹åºè®¡æ•°å™¨çš„åŠŸèƒ½ï¼Ÿ 2.2. javaè™šæ‹Ÿæœºæ ˆ 2.3. javaå † 2.4. æ–¹æ³•åŒº 2.5. ç›´æ¥å†…å­˜ 2. HotSpotè™šæ‹Ÿæœºå¯¹è±¡ 2.1. å¯¹è±¡ï¼ˆæ™®é€šJavaå¯¹è±¡ï¼Œä¸åŒ…æ‹¬æ•°ç»„å’ŒClasså¯¹è±¡ç­‰ï¼‰çš„åˆ›å»º 2.4. OutOfMemoryErrorå¼‚å¸¸ 2.4.1. javaå †æº¢å‡º 2.4.2. è™šæ‹Ÿ...",
      "content_html": "<!-- TOC -->\n<ul>\n<li><a href=\"#1-java%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%90%E8%A1%8C%E6%97%B6%E6%95%B0%E6%8D%AE%E5%8C%BA%E5%9F%9F\">1. javaè™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</a>\n<ul>\n<li><a href=\"#21-%E7%A8%8B%E5%BA%8F%E8%AE%A1%E6%95%B0%E5%99%A8%E7%9A%84%E5%8A%9F%E8%83%BD\">2.1. ç¨‹åºè®¡æ•°å™¨çš„åŠŸèƒ½ï¼Ÿ</a></li>\n<li><a href=\"#22-java%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A0%88\">2.2. javaè™šæ‹Ÿæœºæ ˆ</a></li>\n<li><a href=\"#23-java%E5%A0%86\">2.3. javaå †</a></li>\n<li><a href=\"#24-%E6%96%B9%E6%B3%95%E5%8C%BA\">2.4. æ–¹æ³•åŒº</a></li>\n<li><a href=\"#25-%E7%9B%B4%E6%8E%A5%E5%86%85%E5%AD%98\">2.5. ç›´æ¥å†…å­˜</a></li>\n</ul>\n</li>\n<li><a href=\"#2-hotspot%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%AF%B9%E8%B1%A1\">2. HotSpotè™šæ‹Ÿæœºå¯¹è±¡</a>\n<ul>\n<li><a href=\"#21-%E5%AF%B9%E8%B1%A1%E6%99%AE%E9%80%9Ajava%E5%AF%B9%E8%B1%A1%E4%B8%8D%E5%8C%85%E6%8B%AC%E6%95%B0%E7%BB%84%E5%92%8Cclass%E5%AF%B9%E8%B1%A1%E7%AD%89%E7%9A%84%E5%88%9B%E5%BB%BA\">2.1. å¯¹è±¡ï¼ˆæ™®é€šJavaå¯¹è±¡ï¼Œä¸åŒ…æ‹¬æ•°ç»„å’ŒClasså¯¹è±¡ç­‰ï¼‰çš„åˆ›å»º</a></li>\n<li><a href=\"#24-outofmemoryerror%E5%BC%82%E5%B8%B8\">2.4. OutOfMemoryErrorå¼‚å¸¸</a>\n<ul>\n<li><a href=\"#241-java%E5%A0%86%E6%BA%A2%E5%87%BA\">2.4.1. javaå †æº¢å‡º</a></li>\n<li><a href=\"#242-%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%A0%88%E5%92%8C%E6%9C%AC%E5%9C%B0%E6%96%B9%E6%B3%95%E6%A0%88%E6%BA%A2%E5%87%BA\">2.4.2. è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæº¢å‡º</a></li>\n<li><a href=\"#123-%E6%96%B9%E6%B3%95%E5%8C%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E6%97%B6%E5%B8%B8%E9%87%8F%E6%B1%A0%E6%BA%A2%E5%87%BA\">1.2.3. æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡º</a></li>\n<li><a href=\"#124-%E6%96%B9%E6%B3%95%E5%8C%BA%E5%92%8C%E8%BF%90%E8%A1%8C%E6%97%B6%E5%B8%B8%E9%87%8F%E6%B1%A0%E6%BA%A2%E5%87%BA\">1.2.4. æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡º</a></li>\n<li><a href=\"#243-%E6%9C%AC%E6%9C%BA%E7%9B%B4%E6%8E%A5%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA\">2.4.3. æœ¬æœºç›´æ¥å†…å­˜æº¢å‡º</a></li>\n</ul>\n</li>\n</ul>\n</li>\n<li><a href=\"#3-%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8%E5%92%8C%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E7%AD%96%E7%95%A5\">3. åƒåœ¾æ”¶é›†å™¨å’Œå†…å­˜åˆ†é…ç­–ç•¥</a>\n<ul>\n<li><a href=\"#31-%E7%A1%AE%E5%AE%9A%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%90%A6%E5%AD%98%E6%B4%BB%E7%9A%84%E7%AE%97%E6%B3%95\">3.1. ç¡®å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„ç®—æ³•</a></li>\n<li><a href=\"#32-%E5%BC%95%E7%94%A8%E5%88%86%E7%B1%BB\">3.2. å¼•ç”¨åˆ†ç±»</a></li>\n<li><a href=\"#33-%E6%A0%87%E8%AE%B0%E5%AF%B9%E8%B1%A1%E6%AD%BB%E4%BA%A1\">3.3. æ ‡è®°å¯¹è±¡æ­»äº¡</a></li>\n<li><a href=\"#34-%E5%9B%9E%E6%94%B6%E6%96%B9%E6%B3%95%E5%8C%BA\">3.4. å›æ”¶æ–¹æ³•åŒº</a></li>\n</ul>\n</li>\n<li><a href=\"#4-%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E7%AE%97%E6%B3%95\">4. åƒåœ¾æ”¶é›†ç®—æ³•</a></li>\n<li><a href=\"#5-hotspot%E7%9A%84%E7%AE%97%E6%B3%95%E5%AE%9E%E7%8E%B0\">5. HotSpotçš„ç®—æ³•å®ç°</a>\n<ul>\n<li><a href=\"#51-%E6%9E%9A%E4%B8%BE%E6%A0%B9%E8%8A%82%E7%82%B9\">5.1. æšä¸¾æ ¹èŠ‚ç‚¹</a></li>\n<li><a href=\"#52-%E5%AE%89%E5%85%A8%E7%82%B9safepoint\">5.2. å®‰å…¨ç‚¹(Safepoint)</a></li>\n<li><a href=\"#53-%E5%AE%89%E5%85%A8%E5%8C%BA%E5%9F%9Fsafe-region\">5.3. å®‰å…¨åŒºåŸŸ(Safe Region)</a></li>\n</ul>\n</li>\n<li><a href=\"#6-%E5%9E%83%E5%9C%BE%E6%94%B6%E9%9B%86%E5%99%A8\">6. åƒåœ¾æ”¶é›†å™¨ï¼š</a>\n<ul>\n<li><a href=\"#61-serial%E6%94%B6%E9%9B%86%E5%99%A8\">6.1. Serialæ”¶é›†å™¨</a></li>\n<li><a href=\"#62-parnew%E6%94%B6%E9%9B%86%E5%99%A8\">6.2. ParNewæ”¶é›†å™¨</a></li>\n<li><a href=\"#63-parallel-scavenge%E6%94%B6%E9%9B%86%E5%99%A8\">6.3. Parallel Scavengeæ”¶é›†å™¨</a></li>\n<li><a href=\"#64-serial-old%E6%94%B6%E9%9B%86%E5%99%A8\">6.4. Serial Oldæ”¶é›†å™¨</a></li>\n<li><a href=\"#65-parallel-old%E6%94%B6%E9%9B%86%E5%99%A8\">6.5. Parallel Oldæ”¶é›†å™¨</a></li>\n<li><a href=\"#66-cms%E6%94%B6%E9%9B%86%E5%99%A8concurrent-mark-sweep\">6.6. CMSæ”¶é›†å™¨ï¼ˆConcurrent Mark Sweepï¼‰</a></li>\n<li><a href=\"#67-g1%E6%94%B6%E9%9B%86%E5%99%A8garbage-first\">6.7. G1æ”¶é›†å™¨(Garbage-First)</a></li>\n</ul>\n</li>\n<li><a href=\"#7-gc%E6%97%A5%E5%BF%97\">7. GCæ—¥å¿—</a></li>\n<li><a href=\"#8-%E5%86%85%E5%AD%98%E5%88%86%E9%85%8D%E4%B8%8E%E5%9B%9E%E6%94%B6%E7%AD%96%E7%95%A5\">8. å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥</a>\n<ul>\n<li><a href=\"#81-%E5%AF%B9%E8%B1%A1%E4%BC%98%E5%85%88%E5%9C%A8eden%E5%88%86%E9%85%8D\">8.1. å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…</a></li>\n<li><a href=\"#82-%E5%A4%A7%E5%AF%B9%E8%B1%A1%E7%9B%B4%E6%8E%A5%E8%BF%9B%E5%85%A5%E8%80%81%E5%B9%B4%E4%BB%A3\">8.2. å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</a></li>\n<li><a href=\"#83-%E9%95%BF%E6%9C%9F%E5%AD%98%E6%B4%BB%E7%9A%84%E5%AF%B9%E8%B1%A1%E5%B0%86%E8%BF%9B%E5%85%A5%E8%80%81%E5%B9%B4%E4%BB%A3\">8.3. é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</a></li>\n<li><a href=\"#84-%E5%8A%A8%E6%80%81%E5%AF%B9%E8%B1%A1%E5%B9%B4%E9%BE%84%E5%88%A4%E5%AE%9A\">8.4. åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</a></li>\n<li><a href=\"#85-%E7%A9%BA%E9%97%B4%E5%88%86%E9%85%8D%E6%8B%85%E4%BF%9D\">8.5. ç©ºé—´åˆ†é…æ‹…ä¿</a></li>\n</ul>\n</li>\n<li><a href=\"#9-%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%80%A7%E8%83%BD%E7%9B%91%E6%8E%A7%E4%B8%8E%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7\">9. è™šæ‹Ÿæœºæ€§èƒ½ç›‘æ§ä¸æ•…éšœå¤„ç†å·¥å…·</a>\n<ul>\n<li><a href=\"#91-jdk%E7%9A%84%E5%91%BD%E4%BB%A4%E8%A1%8C%E5%B7%A5%E5%85%B7\">9.1. JDKçš„å‘½ä»¤è¡Œå·¥å…·</a>\n<ul>\n<li><a href=\"#911-jps%E8%99%9A%E6%8B%9F%E6%9C%BA%E8%BF%9B%E7%A8%8B%E7%8A%B6%E5%86%B5%E5%B7%A5%E5%85%B7jvm-process-status-tool\">9.1.1. jpsï¼šè™šæ‹Ÿæœºè¿›ç¨‹çŠ¶å†µå·¥å…·ï¼ˆJVM Process Status Toolï¼‰</a></li>\n<li><a href=\"#912-jstat%E8%99%9A%E6%8B%9F%E6%9C%BA%E7%BB%9F%E8%AE%A1%E4%BF%A1%E6%81%AF%E7%9B%91%E8%A7%86%E5%B7%A5%E5%85%B7jvm-statistics-monitoring-tool\">9.1.2. jstatï¼šè™šæ‹Ÿæœºç»Ÿè®¡ä¿¡æ¯ç›‘è§†å·¥å…·ï¼ˆJVM Statistics Monitoring Toolï¼‰</a></li>\n<li><a href=\"#913-jinfojava%E9%85%8D%E7%BD%AE%E4%BF%A1%E6%81%AF%E5%B7%A5%E5%85%B7configuration-info-for-java\">9.1.3. jinfoï¼šJavaé…ç½®ä¿¡æ¯å·¥å…·ï¼ˆConfiguration Info for Javaï¼‰</a></li>\n<li><a href=\"#914-jmapjava%E5%86%85%E5%AD%98%E6%98%A0%E5%83%8F%E5%B7%A5%E5%85%B7memory-map-for-java\">9.1.4. jmapï¼šJavaå†…å­˜æ˜ åƒå·¥å…·ï¼ˆMemory Map for Javaï¼‰</a></li>\n<li><a href=\"#915-jhat%E8%99%9A%E6%8B%9F%E6%9C%BA%E5%A0%86%E8%BD%AC%E5%82%A8%E5%BF%AB%E7%85%A7%E5%88%86%E6%9E%90%E5%B7%A5%E5%85%B7jvm-heap-analysis-tool\">9.1.5. jhatï¼šè™šæ‹Ÿæœºå †è½¬å‚¨å¿«ç…§åˆ†æå·¥å…·ï¼ˆJVM Heap Analysis Toolï¼‰</a></li>\n<li><a href=\"#916-jstackjava%E5%A0%86%E6%A0%88%E8%B7%9F%E8%B8%AA%E5%B7%A5%E5%85%B7stack-trace-for-java\">9.1.6. jstackï¼šJavaå †æ ˆè·Ÿè¸ªå·¥å…·ï¼ˆStack Trace for Javaï¼‰</a></li>\n</ul>\n</li>\n<li><a href=\"#92-hsdisjit%E7%94%9F%E6%88%90%E4%BB%A3%E7%A0%81%E5%8F%8D%E6%B1%87%E7%BC%96\">9.2. HSDISï¼šJITç”Ÿæˆä»£ç åæ±‡ç¼–</a></li>\n</ul>\n</li>\n<li><a href=\"#10-jdk%E7%9A%84%E5%8F%AF%E8%A7%86%E5%8C%96%E5%B7%A5%E5%85%B7\">10. JDKçš„å¯è§†åŒ–å·¥å…·</a>\n<ul>\n<li><a href=\"#101-jconsolejava%E7%9B%91%E8%A7%86%E4%B8%8E%E7%AE%A1%E7%90%86%E6%8E%A7%E5%88%B6%E5%8F%B0\">10.1. JConsoleï¼šJavaç›‘è§†ä¸ç®¡ç†æ§åˆ¶å°</a></li>\n<li><a href=\"#102-visualvm%E5%A4%9A%E5%90%88%E4%B8%80%E6%95%85%E9%9A%9C%E5%A4%84%E7%90%86%E5%B7%A5%E5%85%B7\">10.2. VisualVMï¼šå¤šåˆä¸€æ•…éšœå¤„ç†å·¥å…·</a></li>\n</ul>\n</li>\n<li><a href=\"#11-%E8%B0%83%E4%BC%98%E6%A1%88%E4%BE%8B%E5%88%86%E6%9E%90%E4%B8%8E%E5%AE%9E%E6%88%98\">11. è°ƒä¼˜æ¡ˆä¾‹åˆ†æä¸å®æˆ˜</a>\n<ul>\n<li><a href=\"#111-%E9%AB%98%E6%80%A7%E8%83%BD%E7%A1%AC%E4%BB%B6%E4%B8%8A%E7%9A%84%E7%A8%8B%E5%BA%8F%E9%83%A8%E7%BD%B2%E7%AD%96%E7%95%A5\">11.1. é«˜æ€§èƒ½ç¡¬ä»¶ä¸Šçš„ç¨‹åºéƒ¨ç½²ç­–ç•¥</a></li>\n<li><a href=\"#112-%E9%9B%86%E7%BE%A4%E9%97%B4%E5%90%8C%E6%AD%A5%E5%AF%BC%E8%87%B4%E7%9A%84%E5%86%85%E5%AD%98%E6%BA%A2%E5%87%BA\">11.2. é›†ç¾¤é—´åŒæ­¥å¯¼è‡´çš„å†…å­˜æº¢å‡º</a></li>\n<li><a href=\"#113-%E5%A0%86%E5%A4%96%E5%86%85%E5%AD%98%E5%AF%BC%E8%87%B4%E7%9A%84%E6%BA%A2%E5%87%BA%E9%94%99%E8%AF%AF\">11.3. å †å¤–å†…å­˜å¯¼è‡´çš„æº¢å‡ºé”™è¯¯</a></li>\n<li><a href=\"#114-%E5%A4%96%E9%83%A8%E5%91%BD%E4%BB%A4%E5%AF%BC%E8%87%B4%E7%B3%BB%E7%BB%9F%E7%BC%93%E6%85%A2\">11.4. å¤–éƒ¨å‘½ä»¤å¯¼è‡´ç³»ç»Ÿç¼“æ…¢</a></li>\n<li><a href=\"#115-%E6%9C%8D%E5%8A%A1%E5%99%A8jvm%E8%BF%9B%E7%A8%8B%E5%B4%A9%E6%BA%83\">11.5. æœåŠ¡å™¨JVMè¿›ç¨‹å´©æºƒ</a></li>\n<li><a href=\"#116-%E4%B8%8D%E6%81%B0%E5%BD%93%E6%95%B0%E6%8D%AE%E7%BB%93%E6%9E%84%E5%AF%BC%E8%87%B4%E5%86%85%E5%AD%98%E5%8D%A0%E7%94%A8%E8%BF%87%E5%A4%A7\">11.6. ä¸æ°å½“æ•°æ®ç»“æ„å¯¼è‡´å†…å­˜å ç”¨è¿‡å¤§</a></li>\n<li><a href=\"#117-%E7%94%B1windows%E8%99%9A%E6%8B%9F%E5%86%85%E5%AD%98%E5%AF%BC%E8%87%B4%E7%9A%84%E9%95%BF%E6%97%B6%E9%97%B4%E5%81%9C%E9%A1%BF\">11.7. ç”±Windowsè™šæ‹Ÿå†…å­˜å¯¼è‡´çš„é•¿æ—¶é—´åœé¡¿</a></li>\n</ul>\n</li>\n<li><a href=\"#12-%E8%99%9A%E6%8B%9F%E6%9C%BA%E6%89%A7%E8%A1%8C%E5%AD%90%E7%B3%BB%E7%BB%9F\">12. è™šæ‹Ÿæœºæ‰§è¡Œå­ç³»ç»Ÿ</a>\n<ul>\n<li><a href=\"#121-%E7%B1%BB%E6%96%87%E4%BB%B6%E7%BB%93%E6%9E%84\">12.1. ç±»æ–‡ä»¶ç»“æ„</a></li>\n<li><a href=\"#122-class%E7%B1%BB%E6%96%87%E4%BB%B6%E7%9A%84%E7%BB%93%E6%9E%84\">12.2. Classç±»æ–‡ä»¶çš„ç»“æ„</a>\n<ul>\n<li><a href=\"#1221-magicminor_versionmajor_version\">12.2.1. magicï¼Œminor_versionï¼Œmajor_version</a></li>\n<li><a href=\"#1222-%E5%B8%B8%E9%87%8F%E6%B1%A0\">12.2.2. å¸¸é‡æ± </a></li>\n</ul>\n</li>\n<li><a href=\"#123-%E8%AE%BF%E9%97%AE%E6%A0%87%E5%BF%97access_flags\">12.3. è®¿é—®æ ‡å¿—ï¼ˆaccess_flagsï¼‰</a></li>\n<li><a href=\"#124-%E7%B1%BB%E7%B4%A2%E5%BC%95%E7%88%B6%E7%B1%BB%E7%B4%A2%E5%BC%95%E4%B8%8E%E6%8E%A5%E5%8F%A3%E7%B4%A2%E5%BC%95%E9%9B%86%E5%90%88\">12.4. ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ</a></li>\n<li><a href=\"#125-%E5%AD%97%E6%AE%B5%E8%A1%A8%E9%9B%86%E5%90%88\">12.5. å­—æ®µè¡¨é›†åˆ</a></li>\n<li><a href=\"#126-%E6%96%B9%E6%B3%95%E8%A1%A8%E9%9B%86%E5%90%88\">12.6. æ–¹æ³•è¡¨é›†åˆ</a></li>\n<li><a href=\"#127-%E5%B1%9E%E6%80%A7%E8%A1%A8%E9%9B%86%E5%90%88attribute_info\">12.7. å±æ€§è¡¨é›†åˆï¼ˆattribute_infoï¼‰</a>\n<ul>\n<li><a href=\"#1271-code%E5%B1%9E%E6%80%A7\">12.7.1. Codeå±æ€§</a></li>\n<li><a href=\"#1272-exceptions%E5%B1%9E%E6%80%A7\">12.7.2. Exceptionså±æ€§</a></li>\n<li><a href=\"#1273-linenumbertable%E5%B1%9E%E6%80%A7\">12.7.3. LineNumberTableå±æ€§</a></li>\n</ul>\n</li>\n<li><a href=\"#128-%E4%BB%A3%E7%A0%81%E9%87%8D%E6%8E%92%E5%BA%8F\">12.8. ä»£ç é‡æ’åº</a></li>\n<li><a href=\"#129-as-if-serial%E8%A7%84%E5%88%99%E5%92%8Chappens-before%E8%A7%84%E5%88%99\">12.9. as-if-serialè§„åˆ™å’Œhappens-beforeè§„åˆ™</a></li>\n</ul>\n</li>\n<li><a href=\"#13-gc%E5%9E%83%E5%9C%BE%E5%9B%9E%E6%94%B6%E6%9C%BA%E5%88%B6\">13. GCåƒåœ¾å›æ”¶æœºåˆ¶</a></li>\n<li><a href=\"#24-%E5%AF%B9%E8%B1%A1%E6%98%AF%E5%A6%82%E4%BD%95%E5%AE%9A%E4%BD%8D%E8%AE%BF%E9%97%AE%E7%9A%84\">24. å¯¹è±¡æ˜¯å¦‚ä½•å®šä½è®¿é—®çš„ï¼Ÿ</a></li>\n<li><a href=\"#25-monitor\">25. Monitor</a>\n<ul>\n<li><a href=\"#%E4%BB%A3%E7%A0%81%E4%BC%98%E5%8C%96\">ä»£ç ä¼˜åŒ–</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<h1>1. javaè™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºåŸŸ</h1>\n<ul>\n<li>ç›´æ¥å†…å­˜(Direct Memory)(è™šæ‹Ÿæœºè§„èŒƒä¸­å®šä¹‰çš„å†…å­˜åŒºåŸŸ)</li>\n</ul>\n<h2>2.1. ç¨‹åºè®¡æ•°å™¨çš„åŠŸèƒ½ï¼Ÿ</h2>\n<ul>\n<li>å­—èŠ‚ç è§£é‡Šå™¨å·¥ä½œæ—¶å°±æ˜¯é€šè¿‡æ”¹å˜è¿™ä¸ªè®¡æ•°å™¨çš„å€¼æ¥é€‰å–ä¸‹ä¸€æ¡è¦æ‰§è¡Œçš„å­—èŠ‚ç æŒ‡ä»¤ï¼Œåˆ†æ”¯ï¼Œå¾ªç¯ï¼Œè·³è½¬ï¼Œå¼‚å¸¸å¤„ç†ï¼Œçº¿ç¨‹æ¢å¤ç­‰åŸºç¡€åŠŸèƒ½éƒ½è¦ä¾èµ–è¿™ä¸ªè®¡æ•°å™¨å®Œæˆ</li>\n<li>javaè™šæ‹Ÿæœºçš„å¤šçº¿ç¨‹æ˜¯é€šè¿‡çº¿ç¨‹è½®æµåˆ‡æ¢å¹¶åˆ†é…å¤„ç†å™¨æ‰§è¡Œæ—¶é—´çš„æ–¹å¼æ¥å®ç°çš„ï¼Œåœ¨ä»»ä½•ä¸€ä¸ªç¡®å®šçš„æ—¶åˆ»ï¼Œä¸€ä¸ªå¤„ç†å™¨ï¼ˆå¯¹äºå¤šæ ¸å¤„ç†å™¨æ¥è¯´æ˜¯ä¸€ä¸ªå†…æ ¸ï¼‰éƒ½åªä¼šæ‰§è¡Œä¸€æ¡çº¿ç¨‹ä¸­çš„æŒ‡ä»¤ã€‚å› æ­¤ï¼Œä¸ºäº†çº¿ç¨‹åˆ‡æ¢åèƒ½æ¢å¤åˆ°æ­£ç¡®çš„æ‰§è¡Œä½ç½®ï¼Œæ¯æ¡çº¿ç¨‹éƒ½éœ€è¦æœ‰ä¸€ä¸ªç‹¬ç«‹çš„ç¨‹åºè®¡æ•°å™¨ï¼Œå„æ¡çº¿ç¨‹ä¹‹é—´è®¡æ•°å™¨äº’ä¸å½±å“ï¼Œç‹¬ç«‹å­˜å‚¨ã€‚</li>\n<li>å¦‚æœçº¿ç¨‹æ­£åœ¨æ‰§è¡ŒJavaæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨è®°å½•çš„æ˜¯æ­£åœ¨æ‰§è¡Œçš„è™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤åœ°å€ï¼›å¦‚æœæ­£åœ¨æ‰§è¡Œçš„nativeæ–¹æ³•ï¼Œè¿™ä¸ªè®¡æ•°å™¨åˆ™ä¸ºç©ºï¼ˆundefinedï¼‰</li>\n<li>åœ¨javaè™šæ‹Ÿæœºè§„èŒƒä¸­æ²¡æœ‰è§„å®šä»»ä½•OutOfMemoryErroræƒ…å†µçš„åŒºåŸŸ</li>\n</ul>\n<h2>2.2. javaè™šæ‹Ÿæœºæ ˆ</h2>\n<ul>\n<li>æ¯ä¸ªæ–¹æ³•åœ¨æ‰§è¡Œçš„åŒæ—¶éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ ˆå¸§(Stack Frame)ç”¨äºå­˜å‚¨å±€éƒ¨å˜é‡è¡¨ï¼Œæ“ä½œæ•°æ ˆï¼ŒåŠ¨æ€é“¾æ¥ï¼Œæ–¹æ³•å‡ºå£ç­‰ä¿¡æ¯ï¼Œæ¯ä¸ªæ–¹æ³•ä»è°ƒç”¨è‡³æ‰§è¡Œå®Œæˆçš„è¿‡ç¨‹ï¼Œå°±å¯¹åº”ç€ä¸€ä¸ªæ ˆå¸§åœ¨è™šæ‹Ÿæœºä¸­å…¥æ ˆåˆ°å‡ºæ ˆçš„è¿‡ç¨‹</li>\n<li>javaå†…å­˜åŒºçš„æ ˆå°±æ˜¯è™šæ‹Ÿæœºæ ˆï¼Œæˆ–è€…è¯´è™šæ‹Ÿæœºæ ˆä¸­å±€éƒ¨å˜é‡è¡¨éƒ¨åˆ†ã€‚è¯¥è¡¨å­˜æ”¾äº†ç¼–è¯‘æœŸå¯çŸ¥çš„å„ç§åŸºæœ¬æ•°æ®ç±»å‹ï¼Œå¯¹è±¡å¼•ç”¨ï¼ˆreferenceç±»å‹ï¼Œéå¯¹è±¡æœ¬èº«ï¼Œå¯èƒ½æ˜¯ä¸€ä¸ªæŒ‡å‘å¯¹è±¡èµ·å§‹åœ°å€çš„å¼•ç”¨æŒ‡é’ˆï¼Œä¹Ÿå¯èƒ½æ˜¯æŒ‡å‘ä¸€ä¸ªä»£è¡¨å¯¹è±¡çš„å¥æŸ„æˆ–å…¶ä»–ä¸æ­¤å¯¹è±¡ç›¸å…³çš„ä½ç½®ï¼‰å’ŒreturnAddressç±»å‹ï¼ˆæŒ‡å‘äº†ä¸€æ¡å­—èŠ‚ç æŒ‡ä»¤çš„åœ°å€ï¼‰ã€‚å…¶ä¸­64ä½é•¿åº¦çš„longå’Œdoubleç±»å‹çš„æ•°æ®ä¼šå ç”¨ä¸¤ä¸ªå±€éƒ¨å˜é‡ç©ºé—´(Slot),å…¶ä½™çš„æ•°æ®ç±»å‹åªå ä¸€ä¸ªã€‚å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å†…å­˜ç©ºé—´åœ¨ç¼–è¯‘æœŸé—´å®Œæˆåˆ†é…ï¼Œå½“è¿›å…¥ä¸€ä¸ªæ–¹æ³•æ—¶ï¼Œè¿™ä¸ªæ–¹æ³•åªéœ€è¦å¸§ä¸­åˆ†é…å¤šå¤§çš„å±€éƒ¨å˜é‡ç©ºé—´æ˜¯å®Œå…¨ç¡®å®šçš„ï¼Œåœ¨æ–¹æ³•è¿è¡ŒæœŸé—´ä¸ä¼šæ”¹å˜å±€éƒ¨å˜é‡è¡¨çš„å¤§å°ç©ºé—´</li>\n<li>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æ·±åº¦ï¼Œå°†æŠ›å‡ºStackOverflowErrorå¼‚å¸¸ï¼›å¦‚æœè™šæ‹Ÿæœºæ ˆå¯ä»¥åŠ¨æ€æ‰©å±•ï¼Œå¦‚æœæ‰©å±•æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿå†…å­˜ï¼Œå°±ä¼šæŠ›å‡ºOutOfMemoryå¼‚å¸¸</li>\n</ul>\n<h2>2.3. javaå †</h2>\n<ul>\n<li>è™šæ‹Ÿæœºæ‰€ç®¡ç†çš„å†…å­˜ä¸­æœ€å¤§çš„ä¸€å—ã€‚åœ¨è™šæ‹Ÿæœºå¯åŠ¨æ—¶åˆ›å»ºã€‚</li>\n<li>ä»å†…å­˜å›æ”¶çš„è§’åº¦çœ‹,åƒåœ¾æ”¶é›†ç®¡ç†çš„ä¸»è¦åŒºåŸŸ(GCå †ï¼ˆGarbage Collected Heapï¼‰)ï¼Œç”±äºç°åœ¨æ”¶é›†å™¨åŸºæœ¬é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ã€‚æ‰€ä»¥javaå †å¯ä»¥ç»†åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ï¼›å†ç»†è‡´ç‚¹æœ‰Edenç©ºé—´ From Survivorç©ºé—´ To Survivorç©ºé—´ç­‰ã€‚</li>\n<li>ä»å†…å­˜åˆ†é…çš„è§’åº¦çœ‹ï¼Œçº¿ç¨‹å…±äº«çš„javaå †ä¸­å¯èƒ½åˆ’åˆ†å‡ºå¤šä¸ªçº¿ç¨‹ç§æœ‰çš„åˆ†é…ç¼“å†²åŒº(Thread Local Allocation Buffer,TLAB)ã€‚ä¸è®ºè¿‡æ— è®ºå¦‚ä½•åˆ’åˆ†ï¼Œéƒ½ä¸å­˜æ”¾å†…å®¹æ— å…³ï¼Œæ— è®ºå“ªä¸ªåŒºåŸŸï¼Œå­˜å‚¨çš„éƒ½ä»ç„¶æ˜¯å¯¹è±¡å®ä¾‹ï¼Œè¿›ä¸€æ­¥åˆ’åˆ†çš„ç›®çš„æ˜¯ä¸ºäº†æ›´å¥½åœ°å›æ”¶å†…å­˜ï¼Œæˆ–è€…æ›´å¿«åœ°åˆ†é…å†…å­˜ã€‚</li>\n<li>æ ¹æ®javaè™šæ‹Ÿæœºè§„èŒƒï¼Œjavaå †å¯ä»¥å¤„äºç‰©ç†ä¸Šä¸è¿ç»­çš„å†…å­˜ç©ºé—´ä¸­ï¼Œåªè¦é€»è¾‘ä¸Šæ˜¯è¿ç»­çš„å³å¯ï¼Œå°±åƒç£ç›˜ç©ºé—´ä¸€æ ·ï¼Œåœ¨å®ç°æ—¶æ—¢å¯ä»¥å®ç°æˆå›ºå®šå¤§å°çš„ï¼Œä¹Ÿå¯ä»¥æ˜¯å¯æ‰©å±•çš„ï¼Œä¸è¿‡å½“å‰ä¸»æµè™šæ‹Ÿæœºéƒ½æ˜¯æŒ‰ç…§å¯æ‰©å±•æ¥å®ç°çš„ï¼ˆé€šè¿‡-Xmxå’Œ-Xmsæ§åˆ¶ï¼‰ï¼Œ</li>\n<li>å¦‚æœåœ¨å †ä¸­æ²¡æœ‰å†…å­˜å®Œæˆå®ä¾‹åˆ†é…ï¼Œå¹¶ä¸”å †ä¹Ÿæ— æ³•å†æ‰©å±•æ—¶ï¼Œå°†ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸</li>\n<li>è¯¥å†…å­˜åŒºåŸŸå­˜æ”¾äº†å¯¹è±¡å®ä¾‹åŠæ•°ç»„(æ‰€æœ‰newçš„å¯¹è±¡)ã€‚å…¶å¤§å°é€šè¿‡-Xms(æœ€å°å€¼)å’Œ-Xmx(æœ€å¤§å€¼)å‚æ•°è®¾ç½®ï¼Œ\n<ul>\n<li>-Xmsä¸ºJVMå¯åŠ¨æ—¶ç”³è¯·çš„æœ€å°å†…å­˜ï¼Œé»˜è®¤ä¸ºæ“ä½œç³»ç»Ÿç‰©ç†å†…å­˜çš„1/64ä½†å°äº1Gï¼Œ</li>\n<li>-Xmxä¸ºJVMå¯ç”³è¯·çš„æœ€å¤§å†…å­˜ï¼Œé»˜è®¤ä¸ºç‰©ç†å†…å­˜çš„1/4ä½†å°äº1Gï¼Œ</li>\n<li>é»˜è®¤å½“ç©ºä½™å †å†…å­˜å°äº40%æ—¶ï¼ŒJVMä¼šå¢å¤§Heapåˆ°-XmxæŒ‡å®šçš„å¤§å°ï¼Œå¯é€šè¿‡-XX:MinHeapFreeRation=æ¥æŒ‡å®šè¿™ä¸ªæ¯”åˆ—</li>\n<li>å½“ç©ºä½™å †å†…å­˜å¤§äº70%æ—¶ï¼ŒJVMä¼šå‡å°heapçš„å¤§å°åˆ°-XmsæŒ‡å®šçš„å¤§å°ï¼Œå¯é€šè¿‡XX:MaxHeapFreeRation=æ¥æŒ‡å®šè¿™ä¸ªæ¯”åˆ—</li>\n<li>å¯¹äºè¿è¡Œç³»ç»Ÿï¼Œä¸ºé¿å…åœ¨è¿è¡Œæ—¶é¢‘ç¹è°ƒæ•´Heapçš„å¤§å°ï¼Œé€šå¸¸-Xmsä¸-Xmxçš„å€¼è®¾æˆä¸€æ ·</li>\n</ul>\n</li>\n</ul>\n<h2>2.4. æ–¹æ³•åŒº</h2>\n<ul>\n<li>\n<p>javaè™šæ‹Ÿæœºè§„èŒƒå¯¹æ–¹æ³•å»çš„é™åˆ¶éå¸¸å®½æ¾ï¼Œé™¤äº†å’Œjavaå †ä¸€æ ·ä¸éœ€è¦è¿ç»­çš„å†…å­˜å’Œå¯ä»¥é€‰æ‹©å›ºå®šå¤§å°æˆ–è€…å¯æ‰©å±•å¤–ï¼Œè¿˜å¯ä»¥é€‰æ‹©ä¸å®ç°åƒåœ¾æ”¶é›†ã€‚åƒåœ¾æ”¶é›†åœ¨è¿™ä¸ªåŒºåŸŸæ—¶æ¯”è¾ƒå°‘å‡ºç°çš„ï¼Œä½†å¹¶éæ•°æ®è¿›å…¥æ–¹æ³•åŒºå°±æ°¸ä¹…å­˜åœ¨äº†ï¼Œè¿™ä¸ªåŒºåŸŸçš„å†…å­˜å›æ”¶ç›®æ ‡ä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»å‹çš„å¸è½½ã€‚</p>\n</li>\n<li>\n<p>æ ¹æ®javaè™šæ‹Ÿæœºè§„èŒƒï¼Œå½“æ–¹æ³•åˆ‡æ— æ³•æ»¡è¶³å†…å­˜åˆ†é…éœ€æ±‚æ—¶ï¼Œå°†æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸</p>\n</li>\n<li>\n<p>è¿è¡Œæ—¶å¸¸é‡æ± (Runtime Constant Pool)æ˜¯æ–¹æ³•åŒºä¸€éƒ¨åˆ†ã€‚Classæ–‡ä»¶ä¸­é™¤äº†æœ‰ç±»çš„ç‰ˆæœ¬ï¼Œå­—æ®µï¼Œæ–¹æ³•ï¼Œæ¥å£ç­‰æè¿°ä¿¡æ¯å¤–ï¼Œè¿˜æœ‰ä¸€é¡¹ä¿¡æ¯çš„å¸¸é‡æ± (Constant Pool Table),ç”¨äºå­˜æ”¾ç¼–è¯‘æœŸç”Ÿæˆçš„å„ç§å­—é¢é‡å’Œç¬¦å·å¼•ç”¨ï¼Œè¿™éƒ¨åˆ†å†…å®¹å°†åœ¨ç±»åŠ è½½åè¿›å…¥æ–¹æ³•åŒºçš„è¿è¡Œæ—¶å¸¸é‡æ± ä¸­å­˜æ”¾</p>\n</li>\n<li>\n<p>javaè™šæ‹Ÿæœºå¯¹Classæ–‡ä»¶æ¯ä¸€éƒ¨åˆ†ï¼ˆåŒ…æ‹¬å¸¸é‡æ± ï¼‰çš„æ ¼å¼éƒ½æœ‰ä¸¥æ ¼è§„å®šï¼Œæ¯ä¸€ä¸ªå­—èŠ‚ç”¨äºå­˜å‚¨é‚£ç§æ•°æ®éƒ½å¿…é¡»ç¬¦åˆè§„èŒƒä¸Šè¦æ±‚çš„æ‰ä¼šè¢«è™šæ‹Ÿæœºè®¤å¯ï¼Œè£…è½½å’Œæ‰§è¡Œï¼Œä½†å¯¹äºè¿è¡Œæ—¶å¸¸é‡æ± ï¼Œjavaè™šæ‹Ÿæœºè§„èŒƒæ²¡æœ‰åšä»»ä½•ç»†èŠ‚çš„è¦æ±‚ã€‚ä¸€èˆ¬æ¥è¯´ï¼Œé™¤äº†ä¿å­˜Classæ–‡ä»¶ä¸­æè¿°çš„ç¬¦å·å¼•ç”¨å¤–ï¼Œè¿˜ä¼šæŠŠç¿»è¯‘å‡ºæ¥çš„ç›´æ¥å¼•ç”¨ä¹Ÿå­˜å‚¨åœ¨è¿è¡Œæ—¶å¸¸é‡æ± ä¸­ã€‚</p>\n</li>\n<li>\n<p>è¿è¡Œæ—¶å¸¸é‡æ± ç›¸å¯¹äºClassæ–‡ä»¶å¸¸é‡æ± çš„å¦å¤–ä¸€ä¸ªé‡è¦ç‰¹å¾æ˜¯å…·å¤‡åŠ¨æ€æ€§ï¼Œjavaè¯­è¨€å¹¶ä¸è¦æ±‚å¸¸é‡ä¸€å®šåªæœ‰ç¼–è¯‘æœŸæ‰èƒ½äº§ç”Ÿï¼Œä¹Ÿå°±æ˜¯å¹¶éé¢„ç½®å…¥Classæ–‡ä»¶ä¸­å¸¸é‡æ± çš„å†…å®¹æ‰èƒ½è¿›å…¥æ–¹æ³•åŒºè¿è¡Œæ—¶å¸¸é‡æ± ï¼Œè¿è¡ŒæœŸé—´ä¹Ÿå¯èƒ½å°†æ–°çš„å¸¸é‡æ”¾å…¥æ± ä¸­ï¼Œè¿™ç§ç‰¹æ€§è¢«å¼€å‘äººå‘˜ç”¨å¾—å¤šçš„ç‰¹æ€§ä¾¿æ˜¯Stringç±»çš„intern()æ–¹æ³•</p>\n</li>\n<li>\n<p>å½“å¸¸é‡æ± æ— æ³•å†ç”³è¯·åˆ°å†…å­˜æ—¶ä¼šæŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸ï¼Œè¿™ä¸ªåŒºåŸŸçš„å†…å­˜å›æ”¶ç›®æ ‡ä¸»è¦æ˜¯é’ˆå¯¹å¸¸é‡æ± çš„å›æ”¶å’Œå¯¹ç±»å‹çš„å¸è½½ã€‚</p>\n</li>\n<li>\n<p>é»˜è®¤æœ€å°å€¼ä¸º16MBï¼Œæœ€å¤§å€¼ä¸º64MBï¼Œå¯ä»¥é€šè¿‡-XX:PermSize å’Œ -XX:MaxPermSize å‚æ•°é™åˆ¶æ–¹æ³•åŒºçš„å¤§å°ã€‚</p>\n</li>\n</ul>\n<h2>2.5. ç›´æ¥å†…å­˜</h2>\n<ul>\n<li>ä¸æ˜¯è™šæ‹Ÿæœºè¿è¡Œæ—¶æ•°æ®åŒºçš„ä¸€éƒ¨åˆ†</li>\n<li>jdk1.4å¼•å…¥çš„NIOç±»ï¼Œå¼•å…¥äº†ä¸€ç§åŸºäºé€šé“ï¼ˆChannelï¼‰ä¸ç¼“å†²åŒºBufferçš„I/Oæ–¹å¼ï¼Œå¯ä»¥ä½¿ç”¨Nativeå‡½æ•°åº“ç›´æ¥åˆ†é…å †å¤–å†…å­˜ï¼Œç„¶åé€šè¿‡ä¸€ä¸ªå­˜å‚¨åœ¨Javaå †ä¸­çš„DirectByteBufferå¯¹è±¡ä½œä¸ºè¿™å—å†…å­˜çš„å¼•ç”¨è¿›è¡Œæ“ä½œï¼Œè¿™æ ·èƒ½åœ¨ä¸€äº›åœºæ™¯ä¸­æ˜¾è‘—æé«˜æ€§èƒ½ï¼Œå› ä¸ºé¿å…äº†Javaå †å’ŒNativeå †ä¸­æ¥å›å¤åˆ¶æ•°æ®</li>\n<li>æœ¬æœºç›´æ¥å†…å­˜çš„åˆ†é…ä¸ä¼šå—åˆ°javaå †å¤§å°çš„é™åˆ¶ï¼Œä½†å—åˆ°æœ¬æœºæ€»å†…å­˜ï¼ˆåŒ…æ‹¬RAMä»¥åŠSWAPåŒºæˆ–è€…åˆ†é¡µæ–‡ä»¶ï¼‰å¤§å°ä»¥åŠå¤„ç†å™¨å¯»å€ç©ºé—´çš„é™åˆ¶ã€‚åœ¨æ ¹æ®å®é™…å†…å­˜è®¾ç½®-Xmxç­‰å‚æ•°ä¿¡æ¯ï¼Œä¸è¦å¿½ç•¥ç›´æ¥å†…å­˜ï¼Œä½¿å¾—å„ä¸ªå†…å­˜åŒºåŸŸæ€»å’Œå°äºç‰©ç†å†…å­˜é™åˆ¶ï¼ˆåŒ…æ‹¬ç‰©ç†çš„å’Œæ“ä½œç³»ç»Ÿçº§çš„é™åˆ¶ï¼‰ï¼Œé¿å…æ‰©å±•æ—¶å‡ºç°OutOfMemoryErrorå¼‚å¸¸</li>\n</ul>\n<h1>2. HotSpotè™šæ‹Ÿæœºå¯¹è±¡</h1>\n<h2>2.1. å¯¹è±¡ï¼ˆæ™®é€šJavaå¯¹è±¡ï¼Œä¸åŒ…æ‹¬æ•°ç»„å’ŒClasså¯¹è±¡ç­‰ï¼‰çš„åˆ›å»º</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>HotSpotè§£é‡Šå™¨çš„ä»£ç ç‰‡æ®µ\n//ç¡®ä¿å¸¸é‡æ± ä¸­å­˜æ”¾çš„æ˜¯å·²è§£é‡Šçš„ç±»\nifï¼ˆï¼constants-ï¼tag_atï¼ˆindexï¼‰.is_unresolved_klassï¼ˆï¼‰ï¼‰{\n//æ–­è¨€ç¡®ä¿æ˜¯klassOopå’ŒinstanceKlassOopï¼ˆè¿™éƒ¨åˆ†ä¸‹ä¸€èŠ‚ä»‹ç»ï¼‰\noop entry=ï¼ˆklassOopï¼‰*constants-ï¼obj_at_addrï¼ˆindexï¼‰ï¼›\nassertï¼ˆentry-ï¼is_klassï¼ˆï¼‰ï¼Œ\"Should be resolved klass\"ï¼‰ï¼›\nklassOop k_entry=ï¼ˆklassOopï¼‰entryï¼›\nassertï¼ˆk_entry-ï¼klass_partï¼ˆï¼‰-ï¼oop_is_instanceï¼ˆï¼‰ï¼Œ\"Should be instanceKlass\"ï¼‰ï¼›\ninstanceKlass * ik=ï¼ˆinstanceKlass*ï¼‰k_entry-ï¼klass_partï¼ˆï¼‰ï¼›\n//ç¡®ä¿å¯¹è±¡æ‰€å±ç±»å‹å·²ç»ç»è¿‡åˆå§‹åŒ–é˜¶æ®µ\nifï¼ˆik-ï¼is_initializedï¼ˆï¼‰ï¼†ï¼†ik-ï¼can_be_fastpath_allocatedï¼ˆï¼‰ï¼‰\n{\n//å–å¯¹è±¡é•¿åº¦\nsize_t obj_size=ik-ï¼size_helperï¼ˆï¼‰ï¼›\noop result=NULLï¼›\n//è®°å½•æ˜¯å¦éœ€è¦å°†å¯¹è±¡æ‰€æœ‰å­—æ®µç½®é›¶å€¼\nbool need_zero=ï¼ZeroTLABï¼›\n//æ˜¯å¦åœ¨TLABä¸­åˆ†é…å¯¹è±¡\nifï¼ˆUseTLABï¼‰{\nresult=ï¼ˆoopï¼‰THREAD-ï¼tlabï¼ˆï¼‰.allocateï¼ˆobj_sizeï¼‰ï¼›\n}\nifï¼ˆresult==NULLï¼‰{\nneed_zero=trueï¼›\n//ç›´æ¥åœ¨edenä¸­åˆ†é…å¯¹è±¡\nretryï¼š\nHeapWord * compare_to=*Universeï¼šheapï¼ˆï¼‰-ï¼top_addrï¼ˆï¼‰ï¼›\nHeapWord * new_top=compare_to+obj_sizeï¼›\n/*cmpxchgæ˜¯x86ä¸­çš„CASæŒ‡ä»¤ï¼Œè¿™é‡Œæ˜¯ä¸€ä¸ªC++æ–¹æ³•ï¼Œé€šè¿‡CASæ–¹å¼åˆ†é…ç©ºé—´ï¼Œå¦‚æœå¹¶å‘å¤±è´¥ï¼Œ\nè½¬åˆ°retryä¸­é‡è¯•ï¼Œç›´è‡³æˆåŠŸåˆ†é…ä¸ºæ­¢*/\nifï¼ˆnew_topï¼œ=*Universeï¼šheapï¼ˆï¼‰-ï¼end_addrï¼ˆï¼‰ï¼‰{\nifï¼ˆAtomicï¼šcmpxchg_ptrï¼ˆnew_top,Universeï¼šheapï¼ˆï¼‰-ï¼top_addrï¼ˆï¼‰ï¼Œcompare_toï¼‰ï¼=compare_toï¼‰{\ngoto retryï¼›\n}\nresult=ï¼ˆoopï¼‰compare_toï¼›\n}\n}\nifï¼ˆresultï¼=NULLï¼‰{\n//å¦‚æœéœ€è¦ï¼Œåˆ™ä¸ºå¯¹è±¡åˆå§‹åŒ–é›¶å€¼\nifï¼ˆneed_zeroï¼‰{\nHeapWord * to_zero=ï¼ˆHeapWord*ï¼‰result+sizeofï¼ˆoopDescï¼‰/oopSizeï¼›\nobj_size-=sizeofï¼ˆoopDescï¼‰/oopSizeï¼›\nifï¼ˆobj_sizeï¼0ï¼‰{\nmemsetï¼ˆto_zeroï¼Œ0ï¼Œobj_size * HeapWordSizeï¼‰ï¼›\n}\n}\n//æ ¹æ®æ˜¯å¦å¯ç”¨åå‘é”æ¥è®¾ç½®å¯¹è±¡å¤´ä¿¡æ¯\nifï¼ˆUseBiasedLockingï¼‰{\nresult-ï¼set_markï¼ˆik-ï¼prototype_headerï¼ˆï¼‰ï¼‰ï¼›\n}else{\nresult-ï¼set_markï¼ˆmarkOopDescï¼šprototypeï¼ˆï¼‰ï¼‰ï¼›\n}\nresult-ï¼set_klass_gapï¼ˆ0ï¼‰ï¼›\nresult-ï¼set_klassï¼ˆk_entryï¼‰ï¼›\n//å°†å¯¹è±¡å¼•ç”¨å…¥æ ˆï¼Œç»§ç»­æ‰§è¡Œä¸‹ä¸€æ¡æŒ‡ä»¤\nSET_STACK_OBJECTï¼ˆresultï¼Œ0ï¼‰ï¼›\nUPDATE_PC_AND_TOS_AND_CONTINUEï¼ˆ3ï¼Œ1ï¼‰ï¼›\n}\n}\n}\n</code></pre></div><h2>2.4. OutOfMemoryErrorå¼‚å¸¸</h2>\n<p>-verbose:gc -Xms20M -Xmx20M -Xmn10M -XX:+PrintGCDetails -XX:SurvivorRatio=8</p>\n<h3>2.4.1. javaå †æº¢å‡º</h3>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*VM Argsï¼š-Xms20m-Xmx20m-XXï¼š+HeapDumpOnOutOfMemoryError\n*å°†å †æœ€å°å€¼-Xmså‚æ•°ä¸æœ€å¤§å€¼-Xmxå‚æ•°è®¾ç½®ä¸ºä¸€æ ·å³å¯é¿å…è‡ªåŠ¨æ‰©å±•\n*XX:+HeapDunpOnOutOfMemoryErrorå¯ä»¥è®©è™šæ‹Ÿæœºåœ¨å†…å­˜æº¢å‡ºå¼‚å¸¸æ—¶Dumpå‡ºå½“å‰çš„å†…å­˜å †å­˜å‚¨å¿«ç…§ä»¥ä¾¿æ—¶å€™åˆ†æ\n*@author zzm\n*/\npublic class HeapOOM{\nstatic class OOMObject{\n}\npublic static void mainï¼ˆString[]argsï¼‰{\nListï¼œOOMObjectï¼list=new ArrayListï¼œOOMObjectï¼ï¼ˆï¼‰ï¼›\nwhileï¼ˆtrueï¼‰{\nlist.addï¼ˆnew OOMObjectï¼ˆï¼‰ï¼‰ï¼›\n}\n}\n}\n</code></pre></div><ul>\n<li>javaå †ç”¨äºå­˜å‚¨å¯¹è±¡å®ä¾‹ï¼Œåªè¦ä¸æ–­åœ°åˆ›å»ºå¯¹è±¡ï¼Œå¹¶ä¿éšœGC Rootsåˆ°å¯¹è±¡ä¹‹é—´æœ‰å¯è¾¾è·¯å¾„æ¥é¿å…åƒåœ¾å›æ”¶æœºåˆ¶æ¸…é™¤è¿™äº›å¯¹è±¡ï¼Œé‚£ä¹ˆåœ¨å¯¹è±¡æ•°é‡è¾¾åˆ°æœ€å¤§å †çš„å®¹é‡é™åˆ¶åå°±ä¼šäº§ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸</li>\n<li>è¦è§£å†³è¿™ä¸ªåŒºåŸŸçš„å¼‚å¸¸ï¼Œä¸€èˆ¬çš„æ‰‹æ®µæ˜¯é€šè¿‡å†…å­˜æ˜ åƒåˆ†æå·¥å…·ï¼ˆå¦‚Eclipse Memory Analyzerï¼‰å¯¹Dumpå‡ºæ¥çš„å †è½¬å‚¨å¿«ç…§è¿›è¡Œåˆ†æï¼Œé‡ç‚¹ç¡®è®¤å†…å­˜ä¸­çš„å¯¹è±¡æ˜¯å¦å¿…è¦ï¼Œä¹Ÿè¦åˆ†æ¸…æ¥šåˆ°åº•æ˜¯å‡ºç°å†…å­˜æ³„æ¼ï¼ˆMemory Leakï¼‰è¿˜æ˜¯å†…å­˜æº¢å‡ºï¼ˆMemory Overflowï¼‰</li>\n<li>å¦‚æœæ˜¯å†…å­˜æ³„æ¼ï¼Œå¯è¿›ä¸€æ­¥é€šè¿‡å·¥å…·æŸ¥çœ‹æ³„æ¼å¯¹è±¡åˆ°GC Rootsçš„å¼•ç”¨é“¾ï¼Œäºæ˜¯å°±èƒ½æ‰¾åˆ°æ³„æ¼å¯¹è±¡æ˜¯é€šè¿‡æ€æ ·çš„è·¯å¾„ä¸GC Rootsç›¸å…³è”å¹¶å¯¼è‡´åƒåœ¾å›æ”¶å™¨æ— æ³•è‡ªåŠ¨å›æ”¶å®ƒä»¬çš„ã€‚æŒæ¡äº†æ³„æ¼å¯¹è±¡çš„ç±»å‹ä¿¡æ¯ä»¥åŠGC Rootså¼•ç”¨é“¾çš„ä¿¡æ¯ï¼Œå°±å¯ä»¥æ¯”è¾ƒå‡†ç¡®å®šä½å‡ºæ³„æ¼ä»£ç çš„ä½ç½®</li>\n<li>å¦‚æœä¸å­˜åœ¨æ³„æ¼ï¼Œå°±æ˜¯å†…å­˜ä¸­çš„å¯¹è±¡ç¡®å®è¿˜å¿…é¡»å­˜æ´»ç€ï¼Œé‚£å°±åº”å½“æ£€æŸ¥è™šæ‹Ÿæœºå‚æ•°ï¼ˆ-Xmxå’ŒXmsï¼‰ä¸æœºå™¨ç‰©ç†å†…å­˜å¯¹æ¯”çœ‹æ˜¯å¦è¿˜å¯ä»¥è°ƒå¤§ï¼Œä»ä»£ç ä¸Šæ£€æŸ¥æ˜¯å¦å­˜åœ¨æŸäº›å¯¹è±¡ç”Ÿå‘½å‘¨æœŸè¿‡é•¿ï¼ŒæŒæœ‰çŠ¶æ€æ—¶é—´è¿‡é•¿çš„æƒ…å†µï¼Œå°è¯•å‡å°‘ç¨‹åºè¿è¡ŒæœŸçš„å†…å­˜æ¶ˆè€—</li>\n</ul>\n<h3>2.4.2. è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆæº¢å‡º</h3>\n<ul>\n<li>åœ¨HotSpotè™šæ‹Ÿæœºå¹¶ä¸åŒºåˆ†è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆï¼Œæ ˆå®¹é‡ç”±-Xsså‚æ•°è®¾å®š</li>\n<li>å¦‚æœçº¿ç¨‹è¯·æ±‚çš„æ ˆæ·±åº¦å¤§äºè™šæ‹Ÿæœºæ‰€å…è®¸çš„æœ€å¤§æ·±åº¦ï¼Œå°†æŠ›å‡ºStatckOverflowErrorå¼‚å¸¸</li>\n<li>å¦‚æœè™šæ‹Ÿæœºåœ¨æ‰©å±•æ ˆæ˜¯æ— æ³•ç”³è¯·åˆ°è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ï¼Œåˆ™æŠ›å‡ºOutOfMemoryErrorå¼‚å¸¸</li>\n<li>åœ¨å•ä¸ªçº¿ç¨‹ä¸‹ï¼Œæ— è®ºæ˜¯ç”±äºæ ˆå¸§å¤ªå¤§è¿˜æ˜¯è™šæ‹Ÿæœºæ ˆå®¹é‡å¤ªå°ï¼Œå½“å†…å­˜çºåˆ†é…çš„æ—¶å€™ï¼Œè™šæ‹ŸæœºæŠ›å‡ºçš„éƒ½æ˜¯StackOverflowå¼‚å¸¸</li>\n<li>åœ¨å¤šçº¿ç¨‹æƒ…å†µä¸‹ï¼Œé€šè¿‡ä¸æ–­å»ºç«‹çº¿ç¨‹çš„æ–¹å¼å¯ä»¥äº§ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ï¼Œä½†ä¸æ ˆç©ºé—´æ˜¯å¦è¶³å¤Ÿå¤§ä¸å­˜åœ¨ä»»ä½•è”ç³»ï¼Œåœ¨è¿™ç§æƒ…å†µä¸‹ï¼Œä¸ºæ¯ä¸ªçº¿ç¨‹çš„æ ˆåˆ†é…çš„å†…å­˜è¶Šå¤§ï¼Œåè€Œè¶Šå®¹æ˜“äº§ç”Ÿå†…å­˜æº¢å‡ºå¼‚å¸¸ï¼Œå› ä¸ºæ“ä½œç³»ç»Ÿåˆ†é…ç»™æ¯ä¸ªè¿›ç¨‹çš„å†…å­˜æ˜¯æœ‰é™åˆ¶çš„ï¼Œè™šæ‹Ÿæœºæä¾›äº†å‚æ•°æ§åˆ¶javaå †å’Œæ–¹æ³•åŒºä¸¤éƒ¨åˆ†å†…å­˜çš„æœ€å¤§å€¼ï¼Œå‰©ä½™å†…å­˜ä¸ºæ€»å†…å­˜å‡å»Xmx(æœ€å¤§å †å®¹é‡)å†å‡å»MaxPermSize(æœ€å¤§æ–¹æ³•åŒºå®¹é‡)ï¼Œç¨‹åºè®¡æ•°å™¨æ¶ˆè€—å†…å­˜å¾ˆå°ï¼Œå¯ä»¥å¿½ç•¥ï¼Œé‚£ä¹ˆå‰©ä¸‹çš„å†…å­˜å°±ç”±è™šæ‹Ÿæœºæ ˆå’Œæœ¬åœ°æ–¹æ³•æ ˆäº†ï¼Œæ¯ä¸ªçº¿ç¨‹åˆ†é…åˆ°çš„æ ˆå®¹é‡è¶Šå¤§ï¼Œå¯ä»¥å»ºç«‹çš„çº¿ç¨‹æ•°é‡è‡ªç„¶å°±è¶Šå°‘ï¼Œå»ºç«‹çº¿ç¨‹æ—¶å°±è¶Šå®¹æ˜“æŠŠå‰©ä¸‹çš„å†…å­˜è€—å°½</li>\n<li>å¤šçº¿ç¨‹åº”ç”¨å‡ºç°StackOverflowErrorå¼‚å¸¸æ—¶æœ‰é”™è¯¯å †æ ˆå¯ä»¥é˜…è¯»ï¼Œè€Œä¸”å¦‚æœä½¿ç”¨è™šæ‹Ÿæœºé»˜è®¤å‚æ•°ï¼Œæ ˆæ·±åº¦åœ¨å¤§å¤šæ•°æƒ…å†µä¸‹ï¼ˆå› ä¸ºæ¯ä¸ªæ–¹æ³•å‹å…¥æ ˆçš„å¸§å¤§å°å¹¶ä¸æ˜¯ä¸€æ ·çš„ï¼Œæ‰€ä»¥è¯´å¤§å¤šæ•°æƒ…å†µä¸‹ï¼‰è¾¾åˆ°1000-2000å®Œå…¨æ²¡æœ‰é—®é¢˜ï¼Œå¯¹äºæ­£å¸¸çš„æ–¹æ³•è°ƒç”¨ï¼ˆåŒ…æ‹¬é€’å½’ï¼‰ï¼Œè¿™ä¸ªæ·±åº¦å®Œå…¨å¤Ÿç”¨ã€‚ä½†æ˜¯å¦‚æœæ˜¯å»ºç«‹è¿‡å¤šçº¿ç¨‹å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œåœ¨ä¸èƒ½å‡å°‘çº¿ç¨‹æ•°æˆ–è€…æ›´æ¢64ä½è™šæ‹Ÿæœºçš„æƒ…å†µä¸‹ï¼Œå°±åªèƒ½é€šè¿‡å‡å°‘æœ€å¤§å †å’Œå‡å°‘æ ˆå®¹é‡æ¢å–æ›´å¤šçº¿ç¨‹ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*VM Argsï¼š-Xss2Mï¼ˆè¿™æ—¶å€™ä¸å¦¨è®¾ç½®å¤§äº›ï¼‰\n*@author zzm\n*/\npublic class JavaVMStackOOM{\nprivate void dontStopï¼ˆï¼‰{\nwhileï¼ˆtrueï¼‰{\n}\n}\npublic void stackLeakByThreadï¼ˆï¼‰{\nwhileï¼ˆtrueï¼‰{\nThread thread=new Threadï¼ˆnew Runnableï¼ˆï¼‰{\n@Override\npublic void runï¼ˆï¼‰{\ndontStopï¼ˆï¼‰ï¼›\n}\n}ï¼‰ï¼›\nthread.startï¼ˆï¼‰ï¼›\n}\n}\npublic static void mainï¼ˆString[]argsï¼‰throws Throwable{\nJavaVMStackOOM oom=new JavaVMStackOOMï¼ˆï¼‰ï¼›\noom.stackLeakByThreadï¼ˆï¼‰ï¼›\n}\n}\n\nException in thread\"main\"java.lang.OutOfMemoryErrorï¼šunable to create new native thread\n</code></pre></div><h3>1.2.3. æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡º</h3>\n<h3>1.2.4. æ–¹æ³•åŒºå’Œè¿è¡Œæ—¶å¸¸é‡æ± æº¢å‡º</h3>\n<ul>\n<li>String.intern()æ˜¯ä¸€ä¸ªnativeæ–¹æ³•ï¼Œä½œç”¨æ˜¯ï¼šå¦‚æœå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²ç»åŒ…å«ä¸€ä¸ªç­‰äºæ¬¡Stringå¯¹è±¡çš„å­—ç¬¦ä¸²ï¼Œåˆ™è¿”å›ä»£è¡¨æ± ä¸­è¿™ä¸ªå­—ç¬¦ä¸²çš„Stringå¯¹è±¡ï¼›å¦åˆ™å°†æ­¤Stringå¯¹è±¡åŒ…å«çš„å­—ç¬¦ä¸²æ·»åŠ åˆ°å¸¸é‡æ± ä¸­ï¼Œå¹¶ä¸”è¿”å›æ¬¡Stringå¯¹è±¡çš„å¼•ç”¨ã€‚åœ¨jdk1.6ä»¥åŠä»¥å‰çš„ç‰ˆæœ¬ä¸­ï¼Œç”±äºå¸¸é‡æ± åˆ†é…åœ¨æ°¸ä¹…ä»£å†…ï¼Œå¯ä»¥é€šè¿‡-XXï¼šPermSizeå’Œ-XXï¼šMaxPermSizeé™åˆ¶æ–¹æ³•åŒºçš„å¤§å°ï¼Œä»è€Œç®€ä»‹é™åˆ¶å…¶ä¸­å¸¸é‡æ± çš„å®¹é‡</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*VM Argsï¼š-XXï¼šPermSize=10M-XXï¼šMaxPermSize=10M\n*@author zzm\n*/\npublic class RuntimeConstantPoolOOM{\n  public static void mainï¼ˆString[]argsï¼‰{\n  //ä½¿ç”¨Listä¿æŒç€å¸¸é‡æ± å¼•ç”¨ï¼Œé¿å…Full GCå›æ”¶å¸¸é‡æ± è¡Œä¸º\n  Listï¼œStringï¼list=new ArrayListï¼œStringï¼ï¼ˆï¼‰ï¼›\n  //10MBçš„PermSizeåœ¨integerèŒƒå›´å†…è¶³å¤Ÿäº§ç”ŸOOMäº†\n  int i=0ï¼›\n  whileï¼ˆtrueï¼‰{\n    list.addï¼ˆString.valueOfï¼ˆi++ï¼‰.internï¼ˆï¼‰ï¼‰ï¼›\n    }\n  }\n}\n\nException in thread\"main\"java.lang.OutOfMemoryErrorï¼šPermGen space\nat java.lang.String.internï¼ˆNative Methodï¼‰\nat org.fenixsoft.oom.RuntimeConstantPoolOOM.mainï¼ˆRuntimeConstantPoolOOM.javaï¼š18ï¼‰\nPermGen spaceè¯´æ˜è¿è¡Œæ—¶å¸¸é‡æ± å±äºæ–¹æ³•åŒºï¼ˆHotSpotè™šæ‹Ÿæœºä¸­çš„æ°¸ä¹…ä»£ï¼‰çš„ä¸€éƒ¨åˆ†\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class RuntimeConstantPoolOOM{\n  public static void mainï¼ˆString[]argsï¼‰{\n    String str1=new StringBuilderï¼ˆ\"è®¡ç®—æœº\"ï¼‰.appendï¼ˆ\"è½¯ä»¶\"ï¼‰.toStringï¼ˆï¼‰ï¼›\n    System.out.printlnï¼ˆstr1.internï¼ˆï¼‰==str1ï¼‰ï¼›\n    String str2=new StringBuilderï¼ˆ\"ja\"ï¼‰.appendï¼ˆ\"va\"ï¼‰.toStringï¼ˆï¼‰ï¼›\n    System.out.printlnï¼ˆstr2.internï¼ˆï¼‰==str2ï¼‰ï¼›\n  }\n}\n\n</code></pre></div><ul>\n<li>jdk1.6ä¸­çš„åˆ°2ä¸ªfalseï¼Œjdk1.7ä¸€ä¸ªtrueä¸€ä¸ªfalseã€jdk1.6ä¸­internï¼ˆï¼‰æ–¹æ³•ä¼šæŠŠé¦–æ¬¡é‡åˆ°çš„å­—ç¬¦ä¸²å®ä¾‹å¤åˆ¶åˆ°æ°¸ä¹…ä»£ä¸­ï¼Œè¿”å›çš„ä¹Ÿæ˜¯æ°¸ä¹…ä»£ä¸­çš„è¿™ä¸ªå­—ç¬¦ä¸²å®ä¾‹çš„å¼•ç”¨ï¼Œè€Œç”±StringBuilderåˆ›å»ºçš„å­—ç¬¦ä¸²å®ä¾‹åœ¨javaå †ä¸Šï¼Œæ‰€ä»¥å¿…ç„¶ä¸æ˜¯åŒä¸€å¼•ç”¨ï¼Œå°†è¿”å›falseã€‚è€Œjdk1.7çš„intern()å®ç°ä¸ä¼šå¤åˆ¶å®ä¾‹ï¼Œåªæ˜¯åœ¨å¸¸é‡æ± ä¸­è®°å½•é¦–æ¬¡å‡ºç°çš„å®ä¾‹å¼•ç”¨ï¼Œå› æ­¤intern()è¿”å›çš„å¼•ç”¨å’Œç”±StringBuilferåˆ›å»ºçš„é‚£ä¸ªå­—ç¬¦ä¸²å®ä¾‹æ˜¯åŒä¸€ä¸ªã€‚å¯¹str2æ¯”è¾ƒè¿”å›falseæ˜¯å› ä¸ºjavaè¿™ä¸ªå­—ç¬¦ä¸²åœ¨æ‰§è¡ŒStringBuilder.toString()ä¹‹å‰å‡ºç°è¿‡ï¼Œå­—ç¬¦ä¸²å¸¸é‡æ± ä¸­å·²ç»æœ‰å¥¹çš„å¼•ç”¨äº†ï¼Œä¸ç¬¦åˆâ€œé¦–æ¬¡å‡ºç°â€çš„åŸåˆ™</li>\n<li>æ–¹æ³•åŒºç”¨äºå­˜æ”¾Classç›¸å…³ä¿¡æ¯ï¼Œå¦‚ç±»åï¼Œä¿®é¥°è®¿é—®ç¬¦ï¼Œå¸¸é‡æ± ï¼Œå­—æ®µæè¿°ï¼Œæ–¹æ³•æè¿°ç­‰ï¼Œæµ‹è¯•æ€è·¯æ˜¯è¿è¡Œæ—¶äº§ç”Ÿå¤§é‡çš„ç±»å»å¡«æ»¡æ–¹æ³•åŒºï¼Œç›´åˆ°æº¢å‡ºã€‚å¯ä»¥ç›´æ¥ä½¿ç”¨java SE APIå¯ä»¥åŠ¨æ€äº§ç”Ÿç±»ï¼ˆå¦‚åå°„æ—¶çš„GeneratedConstructorAccessorå’ŒåŠ¨æ€ä»£ç†ç­‰ï¼‰ï¼Œä¹Ÿå¯ä»¥å€ŸåŠ©CGLIBç›´æ¥æ“ä½œå­—èŠ‚ç è¿è¡Œæ—¶äº§ç”Ÿå¤§é‡åŠ¨æ€ç±»</li>\n<li>åœ¨ç»å¸¸åŠ¨æ€ç”Ÿæˆå¤§é‡Classçš„åº”ç”¨ä¸­ï¼Œéœ€è¦ç‰¹åˆ«æ³¨æ„ç±»çš„å›æ”¶æƒ…å†µï¼ŒåŒ…æ‹¬ä½¿ç”¨CGLIBå­—èŠ‚ç å¢å¼ºå’ŒåŠ¨æ€è¯­è¨€å¤–ï¼Œå¤§é‡JSPæˆ–åŠ¨æ€ç”ŸæˆJSPæ–‡ä»¶çš„åº”ç”¨ï¼ˆJSPç¬¬ä¸€æ¬¡è¿è¡Œæ—¶éœ€è¦ç¼–è¯‘ä¸ºJavaç±»ï¼‰ï¼ŒåŸºäºOSGiçš„åº”ç”¨ï¼ˆå³ä½¿æ˜¯åŒä¸€ä¸ªç±»æ–‡ä»¶ï¼Œè¢«ä¸åŒåŠ è½½å™¨åŠ è½½ä¹Ÿä¼šè§†ä¸ºä¸åŒçš„ç±»ï¼‰ç­‰</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*VM Argsï¼š-XXï¼šPermSize=10M-XXï¼šMaxPermSize=10M\n*@author zzm\n*/\npublic class JavaMethodAreaOOM{\npublic static void mainï¼ˆString[]argsï¼‰{\nwhileï¼ˆtrueï¼‰{\nEnhancer enhancer=new Enhancerï¼ˆï¼‰ï¼›\nenhancer.setSuperclassï¼ˆOOMObject.classï¼‰ï¼›\nenhancer.setUseCacheï¼ˆfalseï¼‰ï¼›\nenhancer.setCallbackï¼ˆnew MethodInterceptorï¼ˆï¼‰{\npublic Object interceptï¼ˆObject obj,Method method,Object[]args,MethodProxy proxyï¼‰throws Throwable{\nreturn proxy.invokeSuperï¼ˆobj,argsï¼‰ï¼›\n}\n}ï¼‰ï¼›\nenhancer.createï¼ˆï¼‰ï¼›\n}\n}\nstatic class OOMObject{\n}\n}\nCaused byï¼šjava.lang.OutOfMemoryErrorï¼šPermGen space\nat java.lang.ClassLoader.defineClass1ï¼ˆNative Methodï¼‰\nat java.lang.ClassLoader.defineClassCondï¼ˆClassLoader.javaï¼š632ï¼‰\nat java.lang.ClassLoader.defineClassï¼ˆClassLoader.javaï¼š616ï¼‰\nâ€¦â€¦8 more\n</code></pre></div><h3>2.4.3. æœ¬æœºç›´æ¥å†…å­˜æº¢å‡º</h3>\n<ul>\n<li>DirectMemoryå®¹é‡å¯ä»¥é€šè¿‡-XX:MaxDirectMemorySizeæŒ‡å®šï¼Œé»˜è®¤ä¸Javaå †æœ€å¤§å€¼ï¼ˆ-Xmxï¼‰ä¸€æ ·</li>\n<li>è¶Šè¿‡DirectByteBufferç±»ï¼Œç›´æ¥é€šè¿‡åå°„è·å–Unsafeå®ä¾‹è¿›è¡Œå†…å­˜åˆ†é…ï¼ˆUnsafeç±»çš„getUnsafe()æ–¹æ³•é™åˆ¶äº†åªæœ‰å¼•å¯¼ç±»åŠ è½½å™¨æ‰ä¼šè¿”å›å®ä¾‹ï¼Œè®¾è®¡è€…å¸Œæœ›åªæœ‰rt.jarä¸­çš„ç±»æ‰èƒ½ä½¿ç”¨Unsafeçš„åŠŸèƒ½ã€‚ï¼‰å› ä¸ºè™½ç„¶ä½¿ç”¨DirectByteBufferåˆ†é…å†…å­˜ä¹Ÿä¼šæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ï¼Œä½†å®ƒæ’é™¤å¼‚å¸¸æ—¶å¹¶æ²¡æœ‰çœŸæ­£å‘æ“ä½œç³»ç»Ÿç”³è¯·åˆ†é…å†…å­˜ï¼Œè€Œæ˜¯é€šè¿‡è®¡ç®—å¾—çŸ¥å†…å­˜æ— æ³•åˆ†é…ï¼Œäºæ˜¯æ‰‹åŠ¨æŠ›å‡ºå¼‚å¸¸ï¼ŒçœŸæ­£ç”³è¯·åˆ†é…å†…å­˜çš„æ–¹æ³•æ˜¯unsafe.allocateMemory();</li>\n<li>ç”±DirectMemoryå¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œåœ¨Heap Dumpæ–‡ä»¶ä¸­ä¸ä¼šçœ‹è§æ˜æ˜¾çš„å¼‚å¸¸ï¼Œè€Œä¸”æ–‡ä»¶å¾ˆå°ï¼Œå¯èƒ½æ˜¯ç¨‹åºä¸­ç›´æ¥æˆ–è€…é—´æ¥ä½¿ç”¨äº†NIO</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*VM Argsï¼š-Xmx20M-XXï¼šMaxDirectMemorySize=10M\n*@author zzm\n*/\npublic class DirectMemoryOOM{\nprivate static final int_1MB=1024*1024ï¼›\npublic static void mainï¼ˆString[]argsï¼‰throws Exception{\nField unsafeField=Unsafe.class.getDeclaredFieldsï¼ˆï¼‰[0]ï¼›\nunsafeField.setAccessibleï¼ˆtrueï¼‰ï¼›\nUnsafe unsafe=ï¼ˆUnsafeï¼‰unsafeField.getï¼ˆnullï¼‰ï¼›\nwhileï¼ˆtrueï¼‰{\nunsafe.allocateMemoryï¼ˆ_1MBï¼‰ï¼›\n}\n}\n}\nException in thread\"main\"java.lang.OutOfMemoryError\nat sun.misc.Unsafe.allocateMemoryï¼ˆNative Methodï¼‰\nat org.fenixsoft.oom.DMOOM.mainï¼ˆDMOOM.javaï¼š20ï¼‰\n</code></pre></div><h1>3. åƒåœ¾æ”¶é›†å™¨å’Œå†…å­˜åˆ†é…ç­–ç•¥</h1>\n<ul>\n<li>ç¨‹åºè®¡æ•°å™¨ï¼Œè™šæ‹Ÿæœºæ ˆï¼Œæœ¬åœ°æ–¹æ³•æ ˆ3ä¸ªåŒºåŸŸéšçº¿ç¨‹è€Œç”Ÿï¼Œéšçº¿ç¨‹è€Œç­ï¼Œæ ˆä¸­çš„æ ˆå¸§éšç€æ–¹æ³•è¿›å…¥å’Œé€€å‡ºè¿›è¡Œå‡ºæ ˆå’Œå…¥æ ˆæ“ä½œï¼Œæ¯ä¸€ä¸ªæ ˆå¸§ä¸­åˆ†é…å¤šå°‘å†…å­˜åŸºæœ¬ä¸Šæ˜¯åœ¨ç±»ç»“æœå®šä¸‹æ¥æ—¶å°±å·²çŸ¥ï¼ˆå°½ç®¡è¿è¡ŒæœŸjitç¼–è¯‘å™¨è¿›è¡Œä¸€äº›ä¼˜åŒ–ï¼‰ï¼Œå› æ­¤è¿™å‡ ä¸ªåŒºåŸŸçš„å†…å­˜åˆ†é…å’Œå›æ”¶å…·å¤‡ç¡®å®šæ€§ï¼Œåœ¨è¿™å‡ ä¸ªåŒºåŸŸå†…å°±ä¸éœ€è¦è¿‡å¤šè€ƒè™‘å›æ”¶é—®é¢˜ï¼Œå› ä¸ºæ–¹æ³•ç»“æŸæˆ–è€…çº¿ç¨‹ç»“æŸæ—¶ï¼Œå†…å­˜è‡ªç„¶å°±å›æ”¶äº†</li>\n<li>javaå †å’Œæ–¹æ³•åŒºä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ¥å£å¤šä¸ªå®ç°ç±»éœ€è¦çš„å†…å­˜å¯èƒ½ä¸ä¸€æ ·ï¼Œä¸€ä¸ªæ–¹æ³•ä¸­çš„å¤šä¸ªåˆ†æ”¯éœ€è¦çš„å†…å­˜å¯èƒ½ä¸ä¸€æ ·ï¼Œåªæœ‰ç¨‹åºå¤„äºè¿è¡ŒæœŸé—´æ‰èƒ½çŸ¥é“ä¼šåˆ›å»ºé‚£äº›å¯¹è±¡ï¼Œè¿™éƒ¨åˆ†çš„åˆ†é…å’Œå›æ”¶éƒ½æ˜¯åŠ¨æ€çš„ï¼Œåƒåœ¾æ”¶é›†å™¨å…³æ³¨çš„æ˜¯è¿™éƒ¨åˆ†å†…å­˜</li>\n</ul>\n<h2>3.1. ç¡®å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„ç®—æ³•</h2>\n<h2>3.2. å¼•ç”¨åˆ†ç±»</h2>\n<h2>3.3. æ ‡è®°å¯¹è±¡æ­»äº¡</h2>\n<ul>\n<li>æ ‡è®°å¯¹è±¡æ­»äº¡è‡³å°‘ç»è¿‡ä¸¤æ¬¡æ ‡è®°è¿‡ç¨‹ï¼šå¦‚æœå¯¹è±¡åœ¨è¿›è¡Œå¯è¾¾æ€§åˆ†æåå‘ç°æ²¡æœ‰ä¸GC Rootsç›¸è¿æ¥çš„å¼•ç”¨é“¾ï¼Œé‚£å®ƒå°†ä¼šè¢«ç¬¬ä¸€æ¬¡æ ‡è®°å¹¶ä¸”è¿›è¡Œä¸€æ¬¡ç­›é€‰ï¼Œç­›é€‰æ¡ä»¶æ˜¯æ¬¡å¯¹è±¡æ˜¯å¦æœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œå½“å¯¹è±¡æ²¡æœ‰è¦†ç›–finalize()æ–¹æ³•ï¼Œæˆ–è€…finalizeï¼ˆï¼‰æ–¹æ³•å·²ç»è¢«è™šæ‹Ÿæœºè°ƒç”¨ç”¨è¿‡ï¼Œè™šæ‹Ÿæœºé‡è¿™ä¸¤ç§æƒ…å†µè§†ä¸ºæ²¡æœ‰å¿…è¦æ‰§è¡Œ</li>\n<li>å¦‚æœå¯¹è±¡è¢«åˆ¤å®šä¸ºæœ‰å¿…è¦æ‰§è¡Œfinalize()æ–¹æ³•ï¼Œ é‚£ä¹ˆè¿™ä¸ªå¯¹è±¡å°†ä¼šæ”¾ç½®åœ¨ä¸€ä¸ªF-Queueé˜Ÿåˆ—ä¸­ï¼Œå¹¶ç¨åç”±ä¸€ä¸ªè™šæ‹Ÿæœºè‡ªåŠ¨å»ºç«‹çš„ï¼Œä½ä¼˜å…ˆçº§çš„Finalizerçº¿ç¨‹å»æ‰§è¡Œå®ƒï¼Œä½†å¹¶ä¸æ‰¿è¯ºä¼šç­‰å¾…ä»–æ‰§è¡Œè¿è¡Œç»“æŸï¼Œè¿™æ ·åšçš„åŸå› æ˜¯ï¼Œå¦‚æœä¸€ä¸ªå¯¹è±¡åœ¨finalize()æ–¹æ³•ä¸­æ‰§è¡Œç¼“æ…¢ï¼Œæˆ–è€…å‘ç”Ÿæ­»å¾ªç¯ï¼Œå°†å¾ˆå¯èƒ½åˆ°æ—¶F-Queueé˜Ÿåˆ—ä¸­å…¶å®ƒå¯¹è±¡æ°¸ä¹…å¤„äºç­‰å¾…ï¼Œç”šè‡³å¯¼è‡´æ•´ä¸ªå†…å­˜å›æ”¶ç³»ç»Ÿå´©æºƒã€‚</li>\n<li>finalize()æ–¹æ³•æ˜¯å¯¹è±¡é€ƒè„±æ­»äº¡å‘½è¿çš„æœ€åä¸€æ¬¡æœºä¼šã€‚ç¨åGCå°†å¯¹F-Queueä¸­çš„å¯¹è±¡è¿›è¡Œç¬¬äºŒæ¬¡å°è§„æ¨¡æ ‡è®°ï¼Œå¦‚æœå¯¹è±¡è¦åœ¨finalize()æ–¹æ³•ä¸­é¿å…è¢«å›æ”¶ï¼Œåªè¦é‡æ–°ä¸å¼•ç”¨è¿ä¸Šçš„ä»»ä½•ä¸€ä¸ªå¯¹è±¡å»ºç«‹å…³è”å³å¯ï¼Œæ¯”å¦‚å§è‡ªå·±ï¼ˆthisï¼‰å¤åˆ¶ç»™æŸä¸ªç±»å˜é‡æˆ–è€…å¯¹è±¡çš„æˆå‘˜å˜é‡ã€‚é‚£å†ç¬¬äºŒæ¬¡æ ‡è®°æ—¶å°†è¢«ç§»é™¤å³å°†å›æ”¶é›†åˆï¼Œå¦‚æœå¯¹è±¡è¿˜æ²¡æœ‰é€ƒè„±ï¼Œé‚£å°±çœŸçš„è¢«å›æ”¶äº†</li>\n<li>finalize()æ–¹æ³•å°½é‡å°‘ä½¿ç”¨ï¼Œä¸æ˜¯C/C++ä¸­çš„ææ„å‡½æ•°ï¼Œè¿è¡Œä»£ä»·é«˜æ˜‚ï¼Œä¸ç¡®å®šæ€§å¤§ï¼Œæ— æ³•ä¿è¯å„ä¸ªå¯¹è±¡çš„è°ƒç”¨é¡ºåºï¼Œå¯ä»¥ä½¿ç”¨try-finallyæˆ–è€…å…¶å®ƒæ–¹å¼åšçš„æ›´å¥½</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*æ­¤ä»£ç æ¼”ç¤ºäº†ä¸¤ç‚¹ï¼š\n*1.å¯¹è±¡å¯ä»¥åœ¨è¢«GCæ—¶è‡ªæˆ‘æ‹¯æ•‘ã€‚\n*2.è¿™ç§è‡ªæ•‘çš„æœºä¼šåªæœ‰ä¸€æ¬¡ï¼Œå› ä¸ºä¸€ä¸ªå¯¹è±¡çš„finalizeï¼ˆï¼‰æ–¹æ³•æœ€å¤šåªä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡\n*@author zzm\n*/\npublic class FinalizeEscapeGC{\npublic static FinalizeEscapeGC SAVE_HOOK=nullï¼›\npublic void isAliveï¼ˆï¼‰{\nSystem.out.printlnï¼ˆ\"yes,i am still aliveï¼šï¼‰\"ï¼‰ï¼›\n}\n@Override\nprotected void finalizeï¼ˆï¼‰throws Throwable{\nsuper.finalizeï¼ˆï¼‰ï¼›\nSystem.out.printlnï¼ˆ\"finalize mehtod executedï¼\"ï¼‰ï¼›\nFinalizeEscapeGC.SAVE_HOOK=thisï¼›\n}\npublic static void mainï¼ˆString[]argsï¼‰throws Throwable{\nSAVE_HOOK=new FinalizeEscapeGCï¼ˆï¼‰ï¼›\n//å¯¹è±¡ç¬¬ä¸€æ¬¡æˆåŠŸæ‹¯æ•‘è‡ªå·±\nSAVE_HOOK=nullï¼›\nSystem.gcï¼ˆï¼‰ï¼›\n//å› ä¸ºfinalizeæ–¹æ³•ä¼˜å…ˆçº§å¾ˆä½ï¼Œæ‰€ä»¥æš‚åœ0.5ç§’ä»¥ç­‰å¾…å®ƒ\nThread.sleepï¼ˆ500ï¼‰ï¼›\nifï¼ˆSAVE_HOOKï¼=nullï¼‰{\nSAVE_HOOK.isAliveï¼ˆï¼‰ï¼›\n}else{\nSystem.out.printlnï¼ˆ\"no,i am deadï¼šï¼ˆ\"ï¼‰ï¼›\n}\n//ä¸‹é¢è¿™æ®µä»£ç ä¸ä¸Šé¢çš„å®Œå…¨ç›¸åŒï¼Œä½†æ˜¯è¿™æ¬¡è‡ªæ•‘å´å¤±è´¥äº†\nSAVE_HOOK=nullï¼›\nSystem.gcï¼ˆï¼‰ï¼›\n//å› ä¸ºfinalizeæ–¹æ³•ä¼˜å…ˆçº§å¾ˆä½ï¼Œæ‰€ä»¥æš‚åœ0.5ç§’ä»¥ç­‰å¾…å®ƒ\nThread.sleepï¼ˆ500ï¼‰ï¼›\nifï¼ˆSAVE_HOOKï¼=nullï¼‰{\nSAVE_HOOK.isAliveï¼ˆï¼‰ï¼›\n}else{\nSystem.out.printlnï¼ˆ\"no,i am deadï¼šï¼ˆ\"ï¼‰ï¼›\n}\n}\n}\nè¿è¡Œç»“æœï¼š\nfinalize mehtod executedï¼\nyes,i am still aliveï¼šï¼‰\nno,i am deadï¼šï¼ˆ\næœ‰ä¸¤æ®µå®Œå…¨ä¸€æ ·çš„ä»£ç ç‰‡æ®µï¼Œæ‰§è¡Œç»“æœå´æ˜¯ä¸€æ¬¡é€ƒ\nè„±æˆåŠŸï¼Œä¸€æ¬¡å¤±è´¥ï¼Œè¿™æ˜¯å› ä¸ºä»»ä½•ä¸€ä¸ªå¯¹è±¡çš„finalizeï¼ˆï¼‰æ–¹æ³•éƒ½åªä¼šè¢«ç³»ç»Ÿè‡ªåŠ¨è°ƒç”¨ä¸€æ¬¡ï¼Œ\nå¦‚æœå¯¹è±¡é¢ä¸´ä¸‹ä¸€æ¬¡å›æ”¶ï¼Œå®ƒçš„finalizeï¼ˆï¼‰æ–¹æ³•ä¸ä¼šè¢«å†æ¬¡æ‰§è¡Œï¼Œå› æ­¤ç¬¬äºŒæ®µä»£ç çš„è‡ªæ•‘è¡Œ\nåŠ¨å¤±è´¥äº†ã€‚\n</code></pre></div><h2>3.4. å›æ”¶æ–¹æ³•åŒº</h2>\n<ul>\n<li>æ–¹æ³•åŒºï¼ˆHotSpotè™šæ‹Ÿæœºä¸­çš„æ°¸ä¹…ä»£ï¼‰æ²¡æœ‰åƒåœ¾æ”¶é›†ï¼Œè™šæ‹Ÿæœºè§„èŒƒä¸­ç¡®å®è¯´è¿‡ä¸è¦æ±‚åœ¨æ–¹æ³•åŒºå®ç°åƒåœ¾æ”¶é›†ï¼Œæ€§ä»·æ¯”æ¯”è¾ƒä½</li>\n<li>æ°¸ä¹…ä»£çš„åƒåœ¾å›æ”¶åŒ…æ‹¬ä¸¤éƒ¨åˆ†ï¼šåºŸå¼ƒå¸¸é‡å’Œæ— ç”¨ç±»ã€‚å›æ”¶åºŸå¼ƒå¸¸é‡ä¸å›æ”¶Javaå †ä¸­çš„å¯¹è±¡éå¸¸ç›¸ä¼¼ï¼Œä»¥å¸¸é‡æ± ä¸­å­—é¢é‡çš„å›æ”¶ä¸ºä¾‹ï¼Œå‡å¦‚ä¸€ä¸ªå­—ç¬¦ä¸²abcè¿›å…¥å¸¸é‡æ± ä¸­ï¼Œä½†æ˜¯å½“å‰ç³»ç»Ÿä¸­æ²¡æœ‰ä»»ä½•ä¸€ä¸ªStringå¯¹è±¡å«åšabcçš„ï¼Œæ²¡æœ‰ä»»ä½•å¯¹è±¡å¼•ç”¨å¸¸é‡æ± ä¸­çš„abcå¸¸é‡ï¼Œä¹Ÿæ²¡æœ‰å…¶å®ƒåœ°æ–¹ä½¿ç”¨äº†è¿™ä¸ªå­—é¢é‡ï¼Œå¦‚æœæ­¤æ—¶å‘ç”Ÿå†…å­˜å›æ”¶ï¼Œè€Œä¸”å¿…è¦çš„è¯ï¼Œè¿™ä¸ªabcå¸¸é‡ä¼šè¢«æ¸…ç†å‡ºå¸¸é‡æ± ï¼Œå¸¸é‡æ± ä¸­çš„å…¶å®ƒç±»ï¼ˆæ¥å£ï¼‰ï¼Œæ–¹æ³•ï¼Œå­—æ®µçš„ç¬¦å·ä¹Ÿä¸æ­¤ç±»ä¼¼</li>\n<li>åˆ¤å®šæ— ç”¨çš„ç±»çš„åŒæ—¶æ»¡è¶³3ä¸ªæ¡ä»¶ï¼šè¯¥ç±»æ‰€æœ‰çš„å®ä¾‹éƒ½å·²ç»è¢«å›æ”¶ï¼Œjavaå †ä¸­ä¸å­˜åœ¨è¯¥ç±»çš„ä»»ä½•å®ä¾‹ã€‚åŠ è½½è¯¥ç±»çš„ClassLoaderå·²ç»è¢«å›æ”¶ã€‚è¯¥ç±»å¯¹åº”çš„java.lang.Classå¯¹è±¡æ²¡æœ‰ä»»ä½•åœ°æ–¹è¢«å¼•ç”¨ï¼Œæ— æ³•åœ¨ä»»ä½•åœ°æ–¹é€šè¿‡åå°„è®¿é—®è¯¥ç±»çš„æ–¹æ³•</li>\n<li>æ˜¯å¦å¯¹ç±»è¿›è¡Œå›æ”¶ï¼ŒHotSpotæä¾›-Xnoclassgcå‚æ•°è¿›è¡Œæ§åˆ¶ï¼Œè¿˜å¯ä»¥ä½¿ç”¨-verbose:classä»¥åŠ-XX:+TranceClassLoadingï¼ˆProductç‰ˆï¼‰-XX:+TraceClassUnLoadingæŸ¥çœ‹ç±»åŠ è½½å’Œå¸è½½ä¿¡æ¯ï¼ˆFastDebugç‰ˆï¼‰</li>\n<li>åœ¨å¤§é‡ä½¿ç”¨åå°„ï¼ŒåŠ¨æ€ä»£ç†ï¼ŒCGLIbç­‰ByteCodeæ¡†æ¶ï¼ŒåŠ¨æ€ç”ŸæˆJSPä»¥åŠOSGiè¿™åˆ—é¢‘ç¹è‡ªå®šä¹‰ClassLoaderçš„åœºæ™¯<br>\néƒ½éœ€è¦è™šæ‹Ÿæœºå…·å¤‡ç±»å¸è½½åŠŸèƒ½ï¼Œä»¥ä¿è¯æ°¸ä¹…ä»£ä¸ä¼šæº¢å‡º</li>\n</ul>\n<h1>4. åƒåœ¾æ”¶é›†ç®—æ³•</h1>\n<h1>5. HotSpotçš„ç®—æ³•å®ç°</h1>\n<h2>5.1. æšä¸¾æ ¹èŠ‚ç‚¹</h2>\n<ul>\n<li>ä»å¯è¾¾æ€§åˆ†æä¸­ä»GC RootsèŠ‚ç‚¹æ‰¾å¼•ç”¨é“¾è¿™ä¸ªæ“ä½œä¸ºä¾‹ï¼Œå¯ä½œä¸ºGC Rootsçš„èŠ‚ç‚¹ä¸»è¦åœ¨å…¨å±€æ€§çš„å¼•ç”¨ï¼ˆä¾‹å¦‚å¸¸é‡æˆ–ç±»é™æ€å±æ€§ï¼‰ä¸æ‰§è¡Œä¸Šä¸‹æ–‡ï¼ˆä¾‹å¦‚æ ˆå¸§ä¸­çš„æœ¬åœ°å˜é‡è¡¨ï¼‰ä¸­ï¼Œç°åœ¨å¾ˆå¤šåº”ç”¨ä»…ä»…æ–¹æ³•åŒºå°±æœ‰æ•°ç™¾å…†ï¼Œå¦‚æœè¦é€ä¸ªæ£€æŸ¥è¿™é‡Œé¢çš„å¼•ç”¨ï¼Œé‚£ä¹ˆå¿…ç„¶ä¼šæ¶ˆè€—å¾ˆå¤šæ—¶é—´ã€‚</li>\n<li>å¦å¤–ï¼Œå¯è¾¾æ€§åˆ†æå¯¹æ‰§è¡Œæ—¶é—´çš„æ•æ„Ÿè¿˜ä½“ç°åœ¨GCåœé¡¿ä¸Šï¼Œå› ä¸ºè¿™é¡¹åˆ†æå·¥ä½œå¿…é¡»åœ¨ä¸€ä¸ªèƒ½ç¡®ä¿ä¸€è‡´æ€§çš„å¿«ç…§ä¸­è¿›è¡Œâ€”â€”è¿™é‡Œâ€œä¸€è‡´æ€§â€çš„æ„æ€æ˜¯æŒ‡åœ¨æ•´ä¸ªåˆ†ææœŸé—´æ•´ä¸ªæ‰§è¡Œç³»ç»Ÿçœ‹èµ·æ¥å°±åƒè¢«å†»ç»“åœ¨æŸä¸ªæ—¶é—´ç‚¹ä¸Šï¼Œä¸å¯ä»¥å‡ºç°åˆ†æè¿‡ç¨‹ä¸­å¯¹è±¡å¼•ç”¨å…³ç³»è¿˜åœ¨ä¸æ–­å˜åŒ–çš„æƒ…å†µï¼Œè¯¥ç‚¹ä¸æ»¡è¶³çš„è¯åˆ†æç»“æœå‡†ç¡®æ€§å°±æ— æ³•å¾—åˆ°ä¿è¯ã€‚è¿™ç‚¹æ˜¯å¯¼è‡´GCè¿›è¡Œæ—¶å¿…é¡»åœé¡¿æ‰€æœ‰Javaæ‰§è¡Œçº¿ç¨‹ï¼ˆSunå°†è¿™ä»¶äº‹æƒ…ç§°ä¸ºâ€œStop The Worldâ€ï¼‰çš„å…¶ä¸­ä¸€ä¸ªé‡è¦åŸå› ï¼Œå³ä½¿æ˜¯åœ¨å·ç§°ï¼ˆå‡ ä¹ï¼‰ä¸ä¼šå‘ç”Ÿåœé¡¿çš„CMSæ”¶é›†å™¨ä¸­ï¼Œæšä¸¾æ ¹èŠ‚ç‚¹æ—¶ä¹Ÿæ˜¯å¿…é¡»è¦åœé¡¿çš„ã€‚</li>\n<li>ç”±äºç›®å‰çš„ä¸»æµJavaè™šæ‹Ÿæœºä½¿ç”¨çš„éƒ½æ˜¯å‡†ç¡®å¼GCï¼Œæ‰€ä»¥å½“æ‰§è¡Œç³»ç»Ÿåœé¡¿ä¸‹æ¥åï¼Œå¹¶ä¸éœ€è¦ä¸€ä¸ªä¸æ¼åœ°æ£€æŸ¥å®Œæ‰€æœ‰<br>\næ‰§è¡Œä¸Šä¸‹æ–‡å’Œå…¨å±€çš„å¼•ç”¨ä½ç½®ï¼Œè™šæ‹Ÿæœºåº”å½“æ˜¯æœ‰åŠæ³•ç›´æ¥å¾—çŸ¥å“ªäº›åœ°æ–¹å­˜æ”¾ç€å¯¹è±¡å¼•ç”¨ã€‚åœ¨HotSpotçš„å®ç°ä¸­ï¼Œæ˜¯ä½¿ç”¨ä¸€ç»„ç§°ä¸ºOopMapçš„æ•°æ®ç»“æ„æ¥è¾¾åˆ°è¿™ä¸ªç›®çš„çš„ï¼Œåœ¨ç±»åŠ è½½å®Œæˆçš„æ—¶å€™ï¼ŒHotSpotå°±æŠŠå¯¹è±¡å†…ä»€ä¹ˆåç§»é‡ä¸Šæ˜¯ä»€ä¹ˆç±»å‹çš„æ•°æ®è®¡ç®—å‡ºæ¥ï¼Œåœ¨JITç¼–è¯‘è¿‡ç¨‹ä¸­ï¼Œä¹Ÿä¼šåœ¨ç‰¹å®šçš„ä½ç½®è®°å½•ä¸‹æ ˆå’Œå¯„å­˜å™¨ä¸­å“ªäº›ä½ç½®æ˜¯å¼•ç”¨ã€‚è¿™æ ·ï¼ŒGCåœ¨æ‰«ææ—¶å°±å¯ä»¥ç›´æ¥å¾—çŸ¥<br>\nè¿™äº›ä¿¡æ¯äº†ã€‚</li>\n</ul>\n<h2>5.2. å®‰å…¨ç‚¹(Safepoint)</h2>\n<ul>\n<li>åœ¨OopMapçš„ååŠ©ä¸‹ï¼ŒHotSpotå¯ä»¥å¿«é€Ÿä¸”å‡†ç¡®åœ°å®ŒæˆGC Rootsæšä¸¾ï¼Œä½†ä¸€ä¸ªå¾ˆç°å®çš„é—®é¢˜éšä¹‹è€Œæ¥ï¼šå¯èƒ½å¯¼è‡´å¼•ç”¨å…³ç³»å˜åŒ–ï¼Œæˆ–è€…è¯´OopMapå†…å®¹å˜åŒ–çš„æŒ‡ä»¤éå¸¸å¤šï¼Œå¦‚æœä¸ºæ¯ä¸€æ¡æŒ‡ä»¤éƒ½ç”Ÿæˆå¯¹åº”çš„OopMapï¼Œé‚£å°†ä¼šéœ€è¦å¤§é‡çš„é¢å¤–ç©ºé—´ï¼Œè¿™æ ·GCçš„ç©ºé—´æˆæœ¬å°†ä¼šå˜å¾—å¾ˆé«˜ã€‚</li>\n<li>å®é™…ä¸Šï¼ŒHotSpotä¹Ÿçš„ç¡®æ²¡æœ‰ä¸ºæ¯æ¡æŒ‡ä»¤éƒ½ç”ŸæˆOopMapï¼Œå‰é¢å·²ç»æåˆ°ï¼Œåªæ˜¯åœ¨â€œç‰¹å®šçš„ä½ç½®â€è®°å½•äº†è¿™äº›ä¿¡æ¯ï¼Œè¿™äº›ä½ç½®ç§°ä¸ºå®‰å…¨ç‚¹ï¼ˆSafepointï¼‰ï¼Œå³ç¨‹åºæ‰§è¡Œæ—¶å¹¶éåœ¨æ‰€æœ‰åœ°æ–¹éƒ½èƒ½åœé¡¿ä¸‹æ¥å¼€å§‹GCï¼Œåªæœ‰åœ¨åˆ°è¾¾å®‰å…¨ç‚¹æ—¶æ‰èƒ½æš‚åœã€‚Safepointçš„é€‰å®šæ—¢ä¸èƒ½å¤ªå°‘ä»¥è‡´äºè®©GCç­‰å¾…æ—¶é—´å¤ªé•¿ï¼Œä¹Ÿä¸èƒ½è¿‡äºé¢‘ç¹ä»¥è‡´äºè¿‡åˆ†å¢å¤§è¿è¡Œæ—¶çš„è´Ÿè·ã€‚æ‰€ä»¥ï¼Œå®‰å…¨ç‚¹çš„é€‰å®šåŸºæœ¬ä¸Šæ˜¯ä»¥ç¨‹åºâ€œæ˜¯å¦å…·æœ‰è®©ç¨‹åºé•¿æ—¶é—´æ‰§è¡Œçš„ç‰¹å¾â€ä¸ºæ ‡å‡†è¿›è¡Œé€‰å®šçš„â€”â€”å› ä¸ºæ¯æ¡æŒ‡ä»¤æ‰§è¡Œçš„æ—¶é—´éƒ½éå¸¸çŸ­æš‚ï¼Œç¨‹åºä¸å¤ªå¯èƒ½å› ä¸ºæŒ‡ä»¤æµé•¿åº¦å¤ªé•¿è¿™ä¸ªåŸå› è€Œè¿‡é•¿æ—¶é—´è¿è¡Œï¼Œâ€œé•¿æ—¶é—´æ‰§è¡Œâ€çš„æœ€æ˜æ˜¾ç‰¹å¾å°±æ˜¯æŒ‡ä»¤åºåˆ—å¤ç”¨ï¼Œä¾‹å¦‚æ–¹æ³•è°ƒç”¨ã€å¾ªç¯è·³è½¬ã€å¼‚å¸¸è·³è½¬ç­‰ï¼Œæ‰€ä»¥å…·æœ‰è¿™äº›åŠŸèƒ½çš„æŒ‡ä»¤æ‰ä¼šäº§ç”ŸSafepointã€‚</li>\n<li>å¯¹äºSefepointï¼Œå¦ä¸€ä¸ªéœ€è¦è€ƒè™‘çš„é—®é¢˜æ˜¯å¦‚ä½•åœ¨GCå‘ç”Ÿæ—¶è®©æ‰€æœ‰çº¿ç¨‹ï¼ˆè¿™é‡Œä¸åŒ…æ‹¬æ‰§è¡ŒJNIè°ƒç”¨çš„çº¿ç¨‹ï¼‰éƒ½â€œè·‘â€åˆ°æœ€è¿‘çš„å®‰å…¨ç‚¹ä¸Šå†åœé¡¿ä¸‹æ¥ã€‚è¿™é‡Œæœ‰ä¸¤ç§æ–¹æ¡ˆå¯ä¾›é€‰æ‹©ï¼šæŠ¢å…ˆå¼ä¸­æ–­ï¼ˆPreemptive Suspensionï¼‰å’Œä¸»åŠ¨å¼ä¸­æ–­ï¼ˆVoluntary Suspensionï¼‰ï¼Œå…¶ä¸­æŠ¢å…ˆå¼ä¸­æ–­ä¸éœ€è¦çº¿ç¨‹çš„æ‰§è¡Œä»£ç ä¸»åŠ¨å»é…åˆï¼Œåœ¨GCå‘ç”Ÿæ—¶ï¼Œé¦–å…ˆæŠŠæ‰€æœ‰çº¿ç¨‹å…¨éƒ¨ä¸­æ–­ï¼Œå¦‚æœå‘ç°æœ‰çº¿ç¨‹ä¸­æ–­çš„åœ°æ–¹ä¸åœ¨å®‰å…¨ç‚¹ä¸Šï¼Œå°±æ¢å¤çº¿ç¨‹ï¼Œè®©å®ƒâ€œè·‘â€åˆ°å®‰å…¨ç‚¹ä¸Šã€‚ç°åœ¨å‡ ä¹æ²¡æœ‰è™šæ‹Ÿæœºå®ç°é‡‡ç”¨æŠ¢å…ˆå¼ä¸­æ–­æ¥æš‚åœçº¿ç¨‹ä»è€Œå“åº”GCäº‹ä»¶ã€‚è€Œä¸»åŠ¨å¼ä¸­æ–­çš„æ€æƒ³æ˜¯å½“GCéœ€è¦ä¸­æ–­çº¿ç¨‹çš„æ—¶å€™ï¼Œä¸ç›´æ¥å¯¹çº¿ç¨‹æ“ä½œï¼Œä»…ä»…ç®€å•åœ°è®¾ç½®ä¸€ä¸ªæ ‡å¿—ï¼Œå„ä¸ªçº¿ç¨‹æ‰§è¡Œæ—¶ä¸»åŠ¨å»è½®è¯¢è¿™ä¸ªæ ‡å¿—ï¼Œå‘ç°ä¸­æ–­æ ‡å¿—ä¸ºçœŸæ—¶å°±è‡ªå·±ä¸­æ–­æŒ‚èµ·ã€‚è½®è¯¢æ ‡å¿—çš„åœ°æ–¹å’Œå®‰å…¨ç‚¹æ˜¯é‡åˆçš„ï¼Œå¦å¤–å†åŠ ä¸Šåˆ›å»ºå¯¹è±¡éœ€è¦åˆ†é…å†…å­˜çš„åœ°æ–¹ã€‚</li>\n</ul>\n<h2>5.3. å®‰å…¨åŒºåŸŸ(Safe Region)</h2>\n<ul>\n<li>ä½¿ç”¨Safepointä¼¼ä¹å·²ç»å®Œç¾åœ°è§£å†³äº†å¦‚ä½•è¿›å…¥GCçš„é—®é¢˜ï¼Œä½†å®é™…æƒ…å†µå´å¹¶ä¸ä¸€å®šã€‚<br>\nSafepointæœºåˆ¶ä¿è¯äº†ç¨‹åºæ‰§è¡Œæ—¶ï¼Œåœ¨ä¸å¤ªé•¿çš„æ—¶é—´å†…å°±ä¼šé‡åˆ°å¯è¿›å…¥GCçš„Safepointã€‚ä½†æ˜¯ï¼Œç¨‹åºâ€œä¸æ‰§è¡Œâ€çš„æ—¶å€™å‘¢ï¼Ÿæ‰€è°“çš„ç¨‹åºä¸æ‰§è¡Œå°±æ˜¯æ²¡æœ‰åˆ†é…CPUæ—¶é—´ï¼Œå…¸å‹çš„ä¾‹å­å°±æ˜¯çº¿ç¨‹å¤„äºSleepçŠ¶æ€æˆ–è€…BlockedçŠ¶æ€ï¼Œè¿™æ—¶å€™çº¿ç¨‹æ— æ³•å“åº”JVMçš„ä¸­æ–­è¯·æ±‚ï¼Œâ€œèµ°â€åˆ°å®‰å…¨çš„åœ°æ–¹å»ä¸­æ–­æŒ‚èµ·ï¼ŒJVMä¹Ÿæ˜¾ç„¶ä¸å¤ªå¯èƒ½ç­‰å¾…çº¿ç¨‹é‡æ–°è¢«åˆ†é…CPUæ—¶é—´ã€‚å¯¹äºè¿™ç§æƒ…å†µï¼Œå°±éœ€è¦å®‰å…¨åŒºåŸŸï¼ˆSafe Regionï¼‰æ¥è§£å†³ã€‚</li>\n<li>å®‰å…¨åŒºåŸŸæ˜¯æŒ‡åœ¨ä¸€æ®µä»£ç ç‰‡æ®µä¹‹ä¸­ï¼Œå¼•ç”¨å…³ç³»ä¸ä¼šå‘ç”Ÿå˜åŒ–ã€‚åœ¨è¿™ä¸ªåŒºåŸŸä¸­çš„ä»»æ„åœ°æ–¹å¼€å§‹GCéƒ½æ˜¯å®‰å…¨çš„ã€‚æˆ‘ä»¬ä¹Ÿå¯ä»¥æŠŠSafe Regionçœ‹åšæ˜¯è¢«æ‰©å±•äº†çš„Safepointã€‚</li>\n<li>åœ¨çº¿ç¨‹æ‰§è¡Œåˆ°Safe Regionä¸­çš„ä»£ç æ—¶ï¼Œé¦–å…ˆæ ‡è¯†è‡ªå·±å·²ç»è¿›å…¥äº†Safe Regionï¼Œé‚£æ ·ï¼Œå½“åœ¨è¿™æ®µæ—¶é—´é‡ŒJVMè¦å‘èµ·GCæ—¶ï¼Œå°±ä¸ç”¨ç®¡æ ‡è¯†è‡ªå·±ä¸ºSafe RegionçŠ¶æ€çš„çº¿ç¨‹äº†ã€‚åœ¨çº¿ç¨‹è¦ç¦»å¼€Safe Regionæ—¶ï¼Œå®ƒè¦æ£€æŸ¥ç³»ç»Ÿæ˜¯å¦å·²ç»å®Œæˆäº†æ ¹èŠ‚ç‚¹æšä¸¾ï¼ˆæˆ–è€…æ˜¯æ•´ä¸ªGCè¿‡ç¨‹ï¼‰ï¼Œå¦‚æœå®Œæˆäº†ï¼Œé‚£çº¿ç¨‹å°±ç»§ç»­æ‰§è¡Œï¼Œå¦åˆ™å®ƒå°±å¿…é¡»ç­‰å¾…ç›´åˆ°æ”¶åˆ°å¯ä»¥å®‰å…¨ç¦»å¼€Safe Regionçš„ä¿¡å·ä¸ºæ­¢ã€‚</li>\n<li>å†…å­˜å›æ”¶å¦‚ä½•è¿›è¡Œæ˜¯ç”±è™šæ‹Ÿæœºæ‰€é‡‡ç”¨çš„GCæ”¶é›†å™¨å†³å®šçš„ï¼Œè€Œé€šå¸¸è™šæ‹Ÿæœºä¸­å¾€å¾€ä¸æ­¢æœ‰ä¸€ç§GCæ”¶é›†å™¨ã€‚</li>\n</ul>\n<h1>6. åƒåœ¾æ”¶é›†å™¨ï¼š</h1>\n<ul>\n<li>å¦‚æœè¯´æ”¶é›†ç®—æ³•æ˜¯å†…å­˜å›æ”¶çš„æ–¹æ³•è®ºï¼Œé‚£ä¹ˆåƒåœ¾æ”¶é›†å™¨å°±æ˜¯å†…å­˜å›æ”¶çš„å…·ä½“å®ç°ã€‚è¿™é‡Œè®¨è®ºçš„æ”¶é›†å™¨åŸºäºJDK 1.7 Update 14ä¹‹åçš„HotSpotè™šæ‹Ÿæœºï¼ˆåœ¨è¿™ä¸ªç‰ˆæœ¬ä¸­æ­£å¼æä¾›äº†å•†ç”¨çš„G1æ”¶é›†å™¨ï¼Œä¹‹å‰G1ä»å¤„äºå®éªŒçŠ¶æ€ï¼‰ï¼ŒHotspotè™šæ‹ŸæœºåŒ…å«çš„æ‰€æœ‰æ”¶é›†å™¨.å¦‚æœä¸¤ä¸ªæ”¶é›†å™¨ä¹‹é—´å­˜åœ¨è¿çº¿ï¼Œå°±è¯´æ˜å®ƒä»¬å¯ä»¥æ­é…ä½¿ç”¨ã€‚è™šæ‹Ÿæœºæ‰€å¤„çš„åŒºåŸŸï¼Œåˆ™è¡¨ç¤ºå®ƒæ˜¯å±äºæ–°ç”Ÿä»£æ”¶é›†å™¨è¿˜æ˜¯è€å¹´ä»£æ”¶é›†å™¨ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/b4dfad59e848dff058479.png\" alt=\"åƒåœ¾æ”¶é›†å™¨.png\" tabindex=\"0\"><figcaption>åƒåœ¾æ”¶é›†å™¨.png</figcaption></figure>\n<h2>6.1. Serialæ”¶é›†å™¨</h2>\n<ul>\n<li>ä¸€ä¸ªå•çº¿ç¨‹çš„æ”¶é›†å™¨ï¼Œå®ƒåªä¼šä½¿ç”¨ä¸€ä¸ªCPUæˆ–ä¸€æ¡æ”¶é›†çº¿ç¨‹å»å®Œæˆåƒåœ¾æ”¶é›†å·¥ä½œï¼Œåœ¨è¿›è¡Œåƒåœ¾æ”¶é›†æ—¶ï¼Œå¿…é¡»æš‚åœå…¶ä»–æ‰€æœ‰çš„å·¥ä½œçº¿ç¨‹ï¼Œç›´åˆ°å®ƒæ”¶é›†ç»“æŸã€‚â€œStopThe Worldâ€æ˜¯ç”±è™šæ‹Ÿæœºåœ¨åå°è‡ªåŠ¨å‘èµ·å’Œè‡ªåŠ¨å®Œæˆçš„ï¼Œåœ¨ç”¨æˆ·ä¸å¯è§çš„æƒ…å†µä¸‹æŠŠç”¨æˆ·æ­£å¸¸å·¥ä½œçš„çº¿ç¨‹å…¨éƒ¨åœæ‰ï¼Œè¿™å¯¹å¾ˆå¤šåº”ç”¨æ¥è¯´éƒ½æ˜¯éš¾ä»¥æ¥å—çš„ã€‚</li>\n<li>è™šæ‹Ÿæœºè¿è¡Œåœ¨Clientæ¨¡å¼ä¸‹çš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ã€‚å®ƒä¹Ÿæœ‰ç€ä¼˜äºå…¶ä»–æ”¶é›†å™¨çš„åœ°æ–¹ï¼šç®€å•è€Œé«˜æ•ˆï¼ˆä¸å…¶ä»–æ”¶é›†å™¨çš„å•çº¿ç¨‹æ¯”ï¼‰ï¼Œå¯¹äºé™å®šå•ä¸ªCPUçš„ç¯å¢ƒæ¥è¯´ï¼ŒSerialæ”¶é›†å™¨ç”±äºæ²¡æœ‰çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œä¸“å¿ƒåšåƒåœ¾æ”¶é›†è‡ªç„¶å¯ä»¥è·å¾—æœ€é«˜çš„å•çº¿ç¨‹æ”¶é›†æ•ˆç‡ã€‚åœ¨ç”¨æˆ·çš„æ¡Œé¢åº”ç”¨åœºæ™¯ä¸­ï¼Œåˆ†é…ç»™è™šæ‹Ÿæœºç®¡ç†çš„å†…å­˜ä¸€èˆ¬æ¥è¯´ä¸ä¼šå¾ˆå¤§ï¼Œæ”¶é›†å‡ åå…†ç”šè‡³ä¸€ä¸¤ç™¾å…†çš„æ–°ç”Ÿä»£ï¼ˆä»…ä»…æ˜¯æ–°ç”Ÿä»£ä½¿ç”¨çš„å†…å­˜ï¼Œæ¡Œé¢åº”ç”¨åŸºæœ¬ä¸Šä¸ä¼šå†å¤§äº†ï¼‰ï¼Œåœé¡¿æ—¶é—´å®Œå…¨å¯ä»¥æ§åˆ¶åœ¨å‡ åæ¯«ç§’æœ€å¤šä¸€ç™¾å¤šæ¯«ç§’ä»¥å†…ï¼Œåªè¦ä¸æ˜¯é¢‘ç¹å‘ç”Ÿï¼Œè¿™ç‚¹åœé¡¿æ˜¯å¯ä»¥æ¥å—çš„ã€‚æ‰€ä»¥ï¼ŒSerialæ”¶é›†å™¨å¯¹äºè¿è¡Œåœ¨Clientæ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºæ¥è¯´æ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/137d353bad1f4276dbcd0.png\" alt=\"Serialæ”¶é›†å™¨.png\"></li>\n</ul>\n<h2>6.2. ParNewæ”¶é›†å™¨</h2>\n<ul>\n<li>Serialæ”¶é›†å™¨çš„å¤šçº¿ç¨‹ç‰ˆæœ¬ï¼ŒåŒ…æ‹¬Serialæ”¶é›†å™¨å¯ç”¨çš„æ‰€æœ‰æ§åˆ¶å‚æ•°ï¼ˆä¾‹å¦‚ï¼š-XXï¼šSurvivorRatioã€-XXï¼šPretenureSizeThresholdã€-XXï¼šHandlePromotionFailureç­‰ï¼‰ã€æ”¶é›†ç®—æ³•ã€Stop The Worldã€å¯¹è±¡åˆ†é…è§„åˆ™ã€å›æ”¶ç­–ç•¥ç­‰éƒ½ä¸Serialæ”¶é›†å™¨å®Œå…¨ä¸€æ ·ï¼Œ</li>\n<li>è¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä¸­é¦–é€‰çš„æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œå…¶ä¸­æœ‰ä¸€ä¸ªä¸æ€§èƒ½æ— å…³ä½†å¾ˆé‡è¦çš„åŸå› æ˜¯ï¼Œé™¤äº†Serialæ”¶é›†å™¨å¤–ï¼Œç›®å‰åªæœ‰å®ƒèƒ½ä¸CMSæ”¶é›†å™¨é…åˆå·¥ä½œã€‚åœ¨JDK 1.5æ—¶æœŸï¼ŒHotSpotæ¨å‡ºäº†ä¸€æ¬¾åœ¨å¼ºäº¤äº’åº”ç”¨ä¸­å‡ ä¹å¯è®¤ä¸ºæœ‰åˆ’æ—¶ä»£æ„ä¹‰çš„åƒåœ¾æ”¶é›†å™¨â€”â€”CMSæ”¶é›†å™¨ï¼ˆConcurrent Mark Sweepï¼‰ï¼Œè¿™æ¬¾æ”¶é›†å™¨æ˜¯HotSpotè™šæ‹Ÿæœºä¸­ç¬¬ä¸€æ¬¾çœŸæ­£æ„ä¹‰ä¸Šçš„å¹¶å‘ï¼ˆConcurrentï¼‰æ”¶é›†å™¨ï¼Œå®ƒç¬¬ä¸€æ¬¡å®ç°äº†è®©åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸ç”¨æˆ·çº¿ç¨‹ï¼ˆåŸºæœ¬ä¸Šï¼‰åŒæ—¶å·¥ä½œ</li>\n<li>CMSä½œä¸ºè€å¹´ä»£çš„æ”¶é›†å™¨ï¼Œå´æ— æ³•ä¸JDK 1.4.0ä¸­å·²ç»å­˜åœ¨çš„æ–°ç”Ÿä»£æ”¶é›†å™¨Parallel Scavengeé…åˆå·¥ä½œ[1]ï¼Œæ‰€ä»¥åœ¨JDK 1.5ä¸­ä½¿ç”¨CMSæ¥æ”¶é›†è€å¹´ä»£çš„æ—¶å€™ï¼Œæ–°ç”Ÿä»£åªèƒ½é€‰æ‹©ParNewæˆ–è€…Serialæ”¶é›†å™¨ä¸­çš„ä¸€ä¸ªã€‚ParNewæ”¶é›†å™¨ä¹Ÿæ˜¯ä½¿ç”¨-XXï¼š+UseConcMarkSweepGCé€‰é¡¹åçš„é»˜è®¤æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨-XXï¼š+UseParNewGCé€‰é¡¹æ¥å¼ºåˆ¶æŒ‡å®šå®ƒã€‚</li>\n<li>ParNewæ”¶é›†å™¨åœ¨å•CPUçš„ç¯å¢ƒä¸­ç»å¯¹ä¸ä¼šæœ‰æ¯”Serialæ”¶é›†å™¨æ›´å¥½çš„æ•ˆæœï¼Œç”šè‡³ç”±äºå­˜åœ¨çº¿ç¨‹äº¤äº’çš„å¼€é”€ï¼Œè¯¥æ”¶é›†å™¨åœ¨é€šè¿‡è¶…çº¿ç¨‹æŠ€æœ¯å®ç°çš„ä¸¤ä¸ªCPUçš„ç¯å¢ƒä¸­éƒ½ä¸èƒ½ç™¾åˆ†ä¹‹ç™¾åœ°ä¿è¯å¯ä»¥è¶…è¶ŠSerialæ”¶é›†å™¨ã€‚å½“ç„¶ï¼Œéšç€å¯ä»¥ä½¿ç”¨çš„CPUçš„æ•°é‡çš„å¢åŠ ï¼Œå®ƒå¯¹äºGCæ—¶ç³»ç»Ÿèµ„æºçš„æœ‰æ•ˆåˆ©ç”¨è¿˜æ˜¯å¾ˆæœ‰å¥½å¤„çš„ã€‚å®ƒé»˜è®¤å¼€å¯çš„æ”¶é›†çº¿ç¨‹æ•°ä¸CPUçš„æ•°é‡ç›¸åŒï¼Œåœ¨CPUéå¸¸å¤š<br>\nï¼ˆè­¬å¦‚32ä¸ªï¼Œç°åœ¨CPUåŠ¨è¾„å°±4æ ¸åŠ è¶…çº¿ç¨‹ï¼ŒæœåŠ¡å™¨è¶…è¿‡32ä¸ªé€»è¾‘CPUçš„æƒ…å†µè¶Šæ¥è¶Šå¤šäº†ï¼‰çš„ç¯å¢ƒä¸‹ï¼Œå¯ä»¥ä½¿ç”¨-XXï¼šParallelGCThreadså‚æ•°æ¥é™åˆ¶åƒåœ¾æ”¶é›†çš„çº¿ç¨‹æ•°ã€‚</li>\n<li>å¹¶è¡Œï¼ˆParallelï¼‰ï¼šæŒ‡å¤šæ¡åƒåœ¾æ”¶é›†çº¿ç¨‹å¹¶è¡Œå·¥ä½œï¼Œä½†æ­¤æ—¶ç”¨æˆ·çº¿ç¨‹ä»ç„¶å¤„äºç­‰å¾…çŠ¶æ€</li>\n<li>å¹¶å‘ï¼ˆConcurrentï¼‰ï¼šæŒ‡ç”¨æˆ·çº¿ç¨‹ä¸åƒåœ¾æ”¶é›†çº¿ç¨‹åŒæ—¶æ‰§è¡Œï¼ˆä½†ä¸ä¸€å®šæ˜¯å¹¶è¡Œçš„ï¼Œå¯èƒ½ä¼šäº¤æ›¿æ‰§è¡Œï¼‰ï¼Œç”¨æˆ·ç¨‹åºåœ¨ç»§ç»­è¿è¡Œï¼Œè€Œåƒåœ¾æ”¶é›†ç¨‹åºè¿è¡Œäºå¦ä¸€ä¸ªCPUä¸Šã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3f1b9ba4c2a19e239081a.png\" alt=\"ParNewæ”¶é›†å™¨.png\"></li>\n</ul>\n<h2>6.3. Parallel Scavengeæ”¶é›†å™¨</h2>\n<ul>\n<li>ä½¿ç”¨å¤åˆ¶ç®—æ³•çš„æ–°ç”Ÿä»£æ”¶é›†å™¨ï¼Œåˆæ˜¯å¹¶è¡Œçš„å¤šçº¿ç¨‹æ”¶é›†å™¨ã€‚CMSç­‰æ”¶é›†å™¨çš„å…³æ³¨ç‚¹æ˜¯å°½å¯èƒ½åœ°ç¼©çŸ­åƒåœ¾æ”¶é›†æ—¶ç”¨æˆ·çº¿ç¨‹çš„åœé¡¿æ—¶é—´ï¼Œè€ŒParallel Scavengeæ”¶é›†å™¨çš„ç›®æ ‡åˆ™æ˜¯è¾¾åˆ°ä¸€ä¸ªå¯æ§åˆ¶çš„ååé‡ï¼ˆThroughputï¼‰ã€‚æ‰€è°“ååé‡å°±æ˜¯CPUç”¨äºè¿è¡Œç”¨æˆ·ä»£ç çš„æ—¶é—´ä¸CPUæ€»æ¶ˆè€—æ—¶é—´çš„æ¯”å€¼ï¼Œå³ååé‡=è¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´/ï¼ˆè¿è¡Œç”¨æˆ·ä»£ç æ—¶é—´+åƒåœ¾æ”¶é›†æ—¶é—´ï¼‰ï¼Œè™šæ‹Ÿæœºæ€»å…±è¿è¡Œäº†100åˆ†é’Ÿï¼Œå…¶ä¸­åƒåœ¾æ”¶é›†èŠ±æ‰1åˆ†é’Ÿï¼Œé‚£ååé‡å°±æ˜¯99%ã€‚</li>\n<li>åœé¡¿æ—¶é—´è¶ŠçŸ­å°±è¶Šé€‚åˆéœ€è¦ä¸ç”¨æˆ·äº¤äº’çš„ç¨‹åºï¼Œè‰¯å¥½çš„å“åº”é€Ÿåº¦èƒ½æå‡ç”¨æˆ·ä½“éªŒï¼Œè€Œé«˜ååé‡åˆ™å¯ä»¥é«˜æ•ˆç‡åœ°åˆ©ç”¨CPUæ—¶é—´ï¼Œå°½å¿«å®Œæˆç¨‹åºçš„è¿ç®—ä»»åŠ¡ï¼Œä¸»è¦é€‚åˆåœ¨åå°è¿ç®—è€Œä¸éœ€è¦å¤ªå¤šäº¤äº’çš„ä»»åŠ¡ã€‚</li>\n<li>Parallel Scavengeæ”¶é›†å™¨æä¾›äº†ä¸¤ä¸ªå‚æ•°ç”¨äºç²¾ç¡®æ§åˆ¶ååé‡\n<ul>\n<li>æ§åˆ¶æœ€å¤§åƒåœ¾æ”¶é›†åœé¡¿æ—¶é—´çš„-XXï¼šMaxGCPauseMilliså‚æ•°ï¼ŒMaxGCPauseMilliså‚æ•°å…è®¸çš„å€¼æ˜¯ä¸€ä¸ªå¤§äº0çš„æ¯«ç§’æ•°ï¼Œæ”¶é›†å™¨å°†å°½å¯èƒ½åœ°ä¿è¯å†…å­˜å›æ”¶èŠ±è´¹çš„æ—¶é—´ä¸è¶…è¿‡è®¾å®šå€¼ã€‚ä¸è¿‡ä¸è¦è®¤ä¸ºå¦‚æœæŠŠè¿™ä¸ªå‚æ•°çš„å€¼è®¾ç½®å¾—ç¨å°ä¸€ç‚¹å°±èƒ½ä½¿å¾—ç³»ç»Ÿçš„åƒåœ¾æ”¶é›†é€Ÿåº¦å˜å¾—æ›´å¿«ï¼ŒGCåœé¡¿æ—¶é—´ç¼©çŸ­æ˜¯ä»¥ç‰ºç‰²ååé‡å’Œæ–°ç”Ÿä»£ç©ºé—´æ¥æ¢å–çš„ï¼šç³»ç»ŸæŠŠæ–°ç”Ÿä»£è°ƒå°ä¸€äº›ï¼Œæ”¶é›†300MBæ–°ç”Ÿä»£è‚¯å®šæ¯”æ”¶é›†500MBå¿«å§ï¼Œè¿™ä¹Ÿç›´æ¥å¯¼è‡´åƒåœ¾æ”¶é›†å‘ç”Ÿå¾—æ›´é¢‘ç¹ä¸€äº›ï¼ŒåŸæ¥10ç§’æ”¶é›†ä¸€æ¬¡ã€æ¯æ¬¡åœé¡¿100æ¯«ç§’ï¼Œç°åœ¨å˜æˆ5ç§’æ”¶é›†ä¸€æ¬¡ã€æ¯æ¬¡åœé¡¿70æ¯«ç§’ã€‚åœé¡¿æ—¶é—´çš„ç¡®åœ¨ä¸‹é™ï¼Œä½†ååé‡ä¹Ÿé™ä¸‹æ¥äº†ã€‚</li>\n<li>ç›´æ¥è®¾ç½®ååé‡å¤§å°çš„-XXï¼šGCTimeRatioå‚æ•°ã€‚GCTimeRatioå‚æ•°çš„å€¼åº”å½“æ˜¯ä¸€ä¸ªå¤§äº0ä¸”å°äº100çš„æ•´æ•°ï¼Œä¹Ÿå°±æ˜¯åƒåœ¾æ”¶é›†æ—¶é—´å æ€»æ—¶é—´çš„æ¯”ç‡ï¼Œç›¸å½“äºæ˜¯ååé‡çš„å€’æ•°ã€‚å¦‚æœæŠŠæ­¤å‚æ•°è®¾ç½®ä¸º19ï¼Œé‚£å…è®¸çš„æœ€å¤§GCæ—¶é—´å°±å æ€»æ—¶é—´çš„5%ï¼ˆå³1/ï¼ˆ1+19ï¼‰ï¼‰ï¼Œé»˜è®¤å€¼ä¸º99ï¼Œå°±æ˜¯å…è®¸æœ€å¤§1%ï¼ˆå³1/ï¼ˆ1+99ï¼‰ï¼‰çš„åƒåœ¾æ”¶é›†æ—¶é—´ã€‚</li>\n</ul>\n</li>\n<li>è‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥å¼€å…³å‚æ•°-XXï¼š+UseAdaptiveSizePolicyå€¼å¾—å…³æ³¨ã€‚å½“è¿™ä¸ªå‚æ•°æ‰“å¼€ä¹‹åï¼Œå°±ä¸éœ€è¦æ‰‹å·¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼ˆ-Xmnï¼‰ã€Edenä¸SurvivoråŒºçš„æ¯”ä¾‹ï¼ˆ-XXï¼šSurvivorRatioï¼‰ã€æ™‹å‡è€å¹´ä»£å¯¹è±¡å¹´é¾„ï¼ˆ-XXï¼šPretenureSizeThresholdï¼‰ç­‰ç»†èŠ‚å‚æ•°äº†ï¼Œè™šæ‹Ÿæœºä¼šæ ¹æ®å½“å‰ç³»ç»Ÿçš„è¿è¡Œæƒ…å†µæ”¶é›†æ€§èƒ½ç›‘æ§ä¿¡æ¯ï¼ŒåŠ¨æ€è°ƒæ•´è¿™äº›å‚æ•°ä»¥æä¾›æœ€åˆé€‚çš„åœé¡¿æ—¶é—´æˆ–è€…æœ€å¤§çš„ååé‡ï¼Œè¿™ç§è°ƒèŠ‚æ–¹å¼ç§°ä¸ºGCè‡ªé€‚åº”çš„è°ƒèŠ‚ç­–ç•¥ï¼ˆGC Ergonomicsï¼‰ã€‚å¦‚æœå¯¹äºæ”¶é›†å™¨è¿ä½œåŸç†ä¸å¤ªäº†è§£ï¼Œä½¿ç”¨Parallel Scavengeæ”¶é›†å™¨é…åˆè‡ªé€‚åº”è°ƒèŠ‚ç­–ç•¥ï¼ŒæŠŠå†…å­˜ç®¡ç†çš„è°ƒä¼˜ä»»åŠ¡äº¤ç»™è™šæ‹Ÿæœºå»å®Œæˆå°†æ˜¯ä¸€ä¸ªä¸é”™çš„é€‰æ‹©ã€‚åªéœ€è¦æŠŠåŸºæœ¬çš„å†…å­˜æ•°æ®è®¾ç½®å¥½ï¼ˆå¦‚-Xmxè®¾ç½®æœ€å¤§å †ï¼‰ï¼Œç„¶åä½¿ç”¨MaxGCPauseMilliså‚æ•°ï¼ˆæ›´å…³æ³¨æœ€å¤§åœé¡¿æ—¶é—´ï¼‰æˆ–GCTimeRatioï¼ˆæ›´å…³æ³¨ååé‡ï¼‰å‚æ•°ç»™è™šæ‹Ÿæœºè®¾ç«‹ä¸€ä¸ªä¼˜åŒ–ç›®æ ‡ï¼Œé‚£å…·ä½“ç»†èŠ‚å‚æ•°çš„è°ƒèŠ‚å·¥ä½œå°±ç”±è™šæ‹Ÿæœºå®Œæˆäº†ã€‚</li>\n</ul>\n<h2>6.4. Serial Oldæ”¶é›†å™¨</h2>\n<ul>\n<li>Serialæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œæ˜¯ä¸€ä¸ªå•çº¿ç¨‹æ”¶é›†å™¨ï¼Œä½¿ç”¨â€œæ ‡è®°-æ•´ç†â€ç®—æ³•ã€‚åœ¨äºç»™Clientæ¨¡å¼ä¸‹çš„è™šæ‹Ÿæœºä½¿ç”¨ã€‚å¦‚æœåœ¨Serveræ¨¡å¼ä¸‹ï¼Œé‚£ä¹ˆå®ƒä¸»è¦è¿˜æœ‰ä¸¤å¤§ç”¨é€”ï¼šä¸€ç§ç”¨é€”æ˜¯åœ¨JDK 1.5ä»¥åŠä¹‹å‰çš„ç‰ˆæœ¬ä¸­ä¸Parallel Scavengeæ”¶é›†å™¨æ­é…ä½¿ç”¨[1]ï¼Œå¦ä¸€ç§ç”¨é€”å°±æ˜¯ä½œä¸ºCMSæ”¶é›†å™¨çš„åå¤‡é¢„æ¡ˆï¼Œåœ¨å¹¶å‘æ”¶é›†å‘ç”ŸConcurrent Mode Failureæ—¶ä½¿ç”¨<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a0cd5e368bf9e098b64f4.png\" alt=\"SerialOldæ”¶é›†å™¨.png\"></li>\n</ul>\n<h2>6.5. Parallel Oldæ”¶é›†å™¨</h2>\n<ul>\n<li>Parallel Scavengeæ”¶é›†å™¨çš„è€å¹´ä»£ç‰ˆæœ¬ï¼Œä½¿ç”¨å¤šçº¿ç¨‹å’Œâ€œæ ‡è®°-æ•´ç†â€ç®—æ³•ã€‚è¿™åœ¨JDK 1.6ä¸­æ‰å¼€å§‹æä¾›çš„ï¼Œåœ¨æ­¤ä¹‹å‰ï¼Œæ–°ç”Ÿä»£çš„Parallel Scavengeæ”¶é›†å™¨ä¸€ç›´å¤„äºæ¯”è¾ƒå°´å°¬çš„çŠ¶æ€ã€‚åŸå› æ˜¯ï¼Œå¦‚æœæ–°ç”Ÿä»£é€‰æ‹©äº†Parallel Scavengeæ”¶é›†å™¨ï¼Œè€å¹´ä»£é™¤äº†Serial Oldï¼ˆPS MarkSweepï¼‰æ”¶é›†å™¨å¤–åˆ«æ— é€‰æ‹©ï¼ˆè¿˜è®°å¾—ä¸Šé¢è¯´è¿‡Parallel Scavengeæ”¶é›†å™¨æ— æ³•ä¸CMSæ”¶é›†å™¨é…åˆå·¥ä½œå—ï¼Ÿï¼‰ã€‚ç”±äºè€å¹´ä»£Serial Oldæ”¶é›†å™¨åœ¨æœåŠ¡ç«¯åº”ç”¨æ€§èƒ½ä¸Šçš„â€œæ‹–ç´¯â€ï¼Œä½¿ç”¨äº†Parallel Scavengeæ”¶é›†å™¨ä¹Ÿæœªå¿…èƒ½åœ¨æ•´ä½“åº”ç”¨ä¸Šè·å¾—ååé‡æœ€å¤§åŒ–çš„æ•ˆæœï¼Œç”±äºå•çº¿ç¨‹çš„è€å¹´ä»£æ”¶é›†ä¸­æ— æ³•å……åˆ†åˆ©ç”¨æœåŠ¡å™¨å¤šCPUçš„å¤„ç†èƒ½åŠ›ï¼Œåœ¨è€å¹´ä»£å¾ˆå¤§è€Œä¸”ç¡¬ä»¶æ¯”è¾ƒé«˜çº§çš„ç¯å¢ƒä¸­ï¼Œè¿™ç§ç»„åˆçš„ååé‡ç”šè‡³è¿˜ä¸ä¸€å®šæœ‰ParNewåŠ CMSçš„ç»„åˆâ€œç»™åŠ›â€ã€‚ç›´åˆ°Parallel Oldæ”¶é›†å™¨å‡ºç°åï¼Œâ€œååé‡ä¼˜å…ˆâ€æ”¶é›†å™¨ç»ˆäºæœ‰äº†æ¯”è¾ƒåå‰¯å…¶å®çš„åº”ç”¨ç»„åˆï¼Œåœ¨æ³¨é‡ååé‡ä»¥åŠCPUèµ„æºæ•æ„Ÿçš„åœºåˆï¼Œéƒ½å¯ä»¥ä¼˜å…ˆè€ƒè™‘Parallel ScavengeåŠ Parallel Oldæ”¶é›†å™¨ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f1f82ee058e4fbc578472.png\" alt=\"ParallelOldæ”¶é›†å™¨.png\"></li>\n</ul>\n<h2>6.6. CMSæ”¶é›†å™¨ï¼ˆConcurrent Mark Sweepï¼‰</h2>\n<ul>\n<li>ä¸€ç§ä»¥è·å–æœ€çŸ­å›æ”¶åœé¡¿æ—¶é—´ä¸ºç›®æ ‡çš„æ”¶é›†å™¨ã€‚ç›®å‰å¾ˆå¤§ä¸€éƒ¨åˆ†çš„Javaåº”ç”¨é›†ä¸­åœ¨äº’è”ç½‘ç«™æˆ–è€…B/Sç³»ç»Ÿçš„æœåŠ¡ç«¯ä¸Šï¼Œè¿™ç±»åº”ç”¨å°¤å…¶é‡è§†æœåŠ¡çš„å“åº”é€Ÿåº¦ï¼Œå¸Œæœ›ç³»ç»Ÿåœé¡¿æ—¶é—´æœ€çŸ­ï¼Œä»¥ç»™ç”¨æˆ·å¸¦æ¥è¾ƒå¥½çš„ä½“éªŒã€‚CMSæ”¶é›†å™¨å°±éå¸¸ç¬¦åˆè¿™ç±»åº”ç”¨çš„éœ€æ±‚ã€‚</li>\n<li>åŸºäºâ€œæ ‡è®°â€”æ¸…é™¤â€ç®—æ³•å®ç°,æ•´ä¸ªè¿ä½œè¿‡ç¨‹åˆ†ä¸º4ä¸ªæ­¥éª¤\n<ul>\n<li>åˆå§‹æ ‡è®°ï¼ˆCMS initial markï¼‰åˆå§‹æ ‡è®°ã€é‡æ–°æ ‡è®°è¿™ä¸¤ä¸ªæ­¥éª¤ä»ç„¶éœ€è¦â€œStop The Worldâ€ã€‚åˆå§‹æ ‡è®°ä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹GC Rootsèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œé€Ÿåº¦å¾ˆå¿«ï¼Œ</li>\n<li>å¹¶å‘æ ‡è®°ï¼ˆCMS concurrent markï¼‰å¹¶å‘æ ‡è®°é˜¶æ®µå°±æ˜¯è¿›è¡ŒGC RootsTracingçš„è¿‡ç¨‹</li>\n<li>é‡æ–°æ ‡è®°ï¼ˆCMS remarkï¼‰ä¸ºäº†ä¿®æ­£å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†å¯¹è±¡çš„æ ‡è®°è®°å½•ï¼Œè¿™ä¸ªé˜¶æ®µçš„åœé¡¿æ—¶é—´ä¸€èˆ¬ä¼šæ¯”åˆå§‹æ ‡è®°é˜¶æ®µç¨é•¿ä¸€äº›ï¼Œä½†è¿œæ¯”å¹¶å‘æ ‡è®°çš„æ—¶é—´çŸ­ã€‚</li>\n<li>å¹¶å‘æ¸…é™¤ï¼ˆCMS concurrent sweepï¼‰</li>\n</ul>\n</li>\n<li>ç”±äºæ•´ä¸ªè¿‡ç¨‹ä¸­è€—æ—¶æœ€é•¿çš„å¹¶å‘æ ‡è®°å’Œå¹¶å‘æ¸…é™¤è¿‡ç¨‹æ”¶é›†å™¨çº¿ç¨‹éƒ½å¯ä»¥ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·ã€‚ä»æ€»ä½“ä¸Šæ¥è¯´ï¼ŒCMSæ”¶é›†å™¨çš„å†…å­˜å›æ”¶è¿‡ç¨‹æ˜¯ä¸ç”¨æˆ·çº¿ç¨‹ä¸€èµ·å¹¶å‘æ‰§è¡Œçš„ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/05c6873a683a76ad9ce46.png\" alt=\"CMSæ”¶é›†å™¨.png\"></li>\n<li>ä¼˜ç‚¹ï¼šå¹¶å‘æ”¶é›†ã€ä½åœé¡¿</li>\n<li>CMSæ”¶é›†å™¨å¯¹CPUèµ„æºéå¸¸æ•æ„Ÿã€‚åœ¨å¹¶å‘é˜¶æ®µï¼Œå®ƒè™½ç„¶ä¸ä¼šå¯¼è‡´ç”¨æˆ·çº¿ç¨‹åœé¡¿ï¼Œä½†æ˜¯ä¼šå› ä¸ºå ç”¨äº†ä¸€éƒ¨åˆ†çº¿ç¨‹ï¼ˆæˆ–è€…è¯´CPUèµ„<br>\næºï¼‰è€Œå¯¼è‡´åº”ç”¨ç¨‹åºå˜æ…¢ï¼Œæ€»ååé‡ä¼šé™ä½ã€‚CMSé»˜è®¤å¯åŠ¨çš„å›æ”¶çº¿ç¨‹æ•°æ˜¯ï¼ˆCPUæ•°é‡+3ï¼‰/4ï¼Œä¹Ÿå°±æ˜¯å½“CPUåœ¨4ä¸ªä»¥ä¸Šæ—¶ï¼Œå¹¶å‘å›æ”¶æ—¶åƒåœ¾æ”¶é›†çº¿ç¨‹ä¸å°‘äº25%çš„CPUèµ„æºï¼Œå¹¶ä¸”éšç€CPUæ•°é‡çš„å¢åŠ è€Œä¸‹é™ã€‚ä½†æ˜¯å½“CPUä¸è¶³4ä¸ªï¼ˆè­¬å¦‚2ä¸ªï¼‰æ—¶ï¼ŒCMSå¯¹ç”¨æˆ·ç¨‹åºçš„å½±å“å°±å¯èƒ½å˜å¾—å¾ˆå¤§ï¼Œå¦‚æœæœ¬æ¥CPUè´Ÿè½½å°±æ¯”è¾ƒå¤§ï¼Œè¿˜åˆ†å‡ºä¸€åŠçš„è¿ç®—èƒ½åŠ›å»æ‰§è¡Œæ”¶é›†å™¨çº¿ç¨‹ï¼Œå°±<br>\nå¯èƒ½å¯¼è‡´ç”¨æˆ·ç¨‹åºçš„æ‰§è¡Œé€Ÿåº¦å¿½ç„¶é™ä½äº†50%ï¼Œå…¶å®ä¹Ÿè®©äººæ— æ³•æ¥å—ã€‚ä¸ºäº†åº”ä»˜è¿™ç§æƒ…å†µï¼Œè™šæ‹Ÿæœºæä¾›äº†ä¸€ç§ç§°ä¸ºâ€œå¢é‡å¼å¹¶å‘æ”¶é›†å™¨â€ï¼ˆIncremental Concurrent Mark Sweep/i-CMSï¼‰çš„CMSæ”¶é›†å™¨å˜ç§ï¼Œæ‰€åšçš„äº‹æƒ…å’Œå•CPUå¹´ä»£PCæœºæ“ä½œç³»ç»Ÿä½¿ç”¨æŠ¢å å¼æ¥æ¨¡æ‹Ÿå¤šä»»åŠ¡æœºåˆ¶çš„æ€æƒ³ä¸€æ ·ï¼Œå°±æ˜¯åœ¨å¹¶å‘æ ‡è®°ã€æ¸…ç†çš„æ—¶å€™è®©GCçº¿ç¨‹ã€ç”¨æˆ·çº¿ç¨‹äº¤æ›¿è¿è¡Œï¼Œå°½é‡å‡å°‘GCçº¿ç¨‹çš„ç‹¬å èµ„æºçš„æ—¶é—´ï¼Œè¿™æ ·æ•´ä¸ªåƒåœ¾æ”¶é›†çš„è¿‡ç¨‹ä¼šæ›´é•¿ï¼Œä½†å¯¹ç”¨æˆ·ç¨‹åºçš„å½±å“å°±ä¼šæ˜¾å¾—å°‘ä¸€äº›ï¼Œä¹Ÿå°±æ˜¯é€Ÿåº¦ä¸‹é™æ²¡æœ‰é‚£ä¹ˆæ˜æ˜¾ã€‚å®è·µè¯æ˜ï¼Œå¢é‡æ—¶çš„CMSæ”¶é›†å™¨æ•ˆæœå¾ˆä¸€èˆ¬ï¼Œåœ¨ç›®å‰ç‰ˆæœ¬ä¸­ï¼Œi-CMSå·²ç»è¢«å£°æ˜ä¸ºâ€œdeprecatedâ€ï¼Œå³ä¸å†æå€¡ç”¨æˆ·ä½¿ç”¨ã€‚</li>\n<li>CMSæ”¶é›†å™¨æ— æ³•å¤„ç†æµ®åŠ¨åƒåœ¾ï¼ˆFloating Garbageï¼‰ï¼Œå¯èƒ½å‡ºç°â€œConcurrent Mode Failureâ€å¤±è´¥è€Œå¯¼è‡´å¦ä¸€æ¬¡Full GCçš„äº§ç”Ÿã€‚ç”±äºCMSå¹¶å‘æ¸…ç†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜åœ¨è¿è¡Œç€ï¼Œä¼´éšç¨‹åºè¿è¡Œè‡ªç„¶å°±è¿˜ä¼šæœ‰æ–°çš„åƒåœ¾ä¸æ–­äº§ç”Ÿï¼Œè¿™ä¸€éƒ¨åˆ†åƒåœ¾å‡ºç°åœ¨æ ‡è®°è¿‡ç¨‹ä¹‹åï¼ŒCMSæ— æ³•åœ¨å½“æ¬¡æ”¶é›†ä¸­å¤„ç†æ‰å®ƒä»¬ï¼Œåªå¥½ç•™å¾…ä¸‹ä¸€æ¬¡GCæ—¶å†æ¸…ç†æ‰ã€‚è¿™ä¸€éƒ¨åˆ†åƒåœ¾å°±ç§°ä¸ºâ€œæµ®åŠ¨åƒ<br>\nåœ¾â€ã€‚ä¹Ÿæ˜¯ç”±äºåœ¨åƒåœ¾æ”¶é›†é˜¶æ®µç”¨æˆ·çº¿ç¨‹è¿˜éœ€è¦è¿è¡Œï¼Œé‚£ä¹Ÿå°±è¿˜éœ€è¦é¢„ç•™æœ‰è¶³å¤Ÿçš„å†…å­˜ç©ºé—´ç»™ç”¨æˆ·çº¿ç¨‹ä½¿ç”¨ï¼Œå› æ­¤CMSæ”¶é›†å™¨ä¸èƒ½åƒå…¶ä»–æ”¶é›†å™¨é‚£æ ·ç­‰åˆ°è€å¹´ä»£å‡ ä¹å®Œå…¨è¢«å¡«æ»¡äº†å†è¿›è¡Œæ”¶é›†ï¼Œéœ€è¦é¢„ç•™ä¸€éƒ¨åˆ†ç©ºé—´æä¾›å¹¶å‘æ”¶é›†æ—¶çš„ç¨‹åºè¿ä½œä½¿ç”¨ã€‚åœ¨JDK 1.5çš„é»˜è®¤è®¾ç½®ä¸‹ï¼ŒCMSæ”¶é›†å™¨å½“è€å¹´ä»£ä½¿ç”¨äº†68%çš„ç©ºé—´åå°±ä¼šè¢«æ¿€æ´»ï¼Œè¿™æ˜¯ä¸€ä¸ªåä¿å®ˆçš„è®¾ç½®ï¼Œå¦‚æœåœ¨åº”ç”¨ä¸­è€å¹´ä»£å¢é•¿ä¸æ˜¯å¤ªå¿«ï¼Œå¯ä»¥é€‚å½“è°ƒé«˜å‚æ•°-XXï¼šCMSInitiatingOccupancyFractionçš„å€¼æ¥æé«˜è§¦å‘ç™¾åˆ†æ¯”ï¼Œä»¥ä¾¿é™ä½å†…å­˜å›æ”¶æ¬¡æ•°ä»è€Œè·å–æ›´å¥½çš„æ€§èƒ½ï¼Œåœ¨JDK 1.6ä¸­ï¼ŒCMSæ”¶é›†å™¨çš„å¯åŠ¨é˜ˆå€¼å·²ç»æå‡è‡³92%ã€‚è¦æ˜¯CMSè¿è¡ŒæœŸé—´é¢„ç•™çš„å†…å­˜æ— æ³•æ»¡è¶³ç¨‹åºéœ€è¦ï¼Œå°±ä¼šå‡ºç°ä¸€æ¬¡â€œConcurrent Mode Failureâ€å¤±è´¥ï¼Œè¿™æ—¶è™šæ‹Ÿæœºå°†å¯åŠ¨åå¤‡é¢„æ¡ˆï¼šä¸´æ—¶å¯ç”¨Serial Oldæ”¶é›†å™¨æ¥é‡æ–°è¿›è¡Œè€å¹´ä»£çš„åƒåœ¾æ”¶é›†ï¼Œè¿™æ ·åœé¡¿æ—¶é—´å°±å¾ˆé•¿äº†ã€‚æ‰€ä»¥è¯´å‚æ•°-XXï¼šCMSInitiatingOccupancyFractionè®¾ç½®å¾—å¤ªé«˜å¾ˆå®¹æ˜“å¯¼è‡´å¤§é‡â€œConcurrent Mode Failureâ€å¤±è´¥ï¼Œæ€§èƒ½åè€Œé™ä½ã€‚</li>\n<li>CMSæ˜¯ä¸€æ¬¾åŸºäºâ€œæ ‡è®°â€”æ¸…é™¤â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ã€‚CMSæ”¶é›†ç»“æŸæ—¶ä¼šæœ‰å¤§é‡ç©ºé—´ç¢ç‰‡äº§ç”Ÿã€‚ç©ºé—´ç¢ç‰‡è¿‡å¤šæ—¶ï¼Œå°†ä¼šç»™å¤§å¯¹è±¡åˆ†é…å¸¦æ¥å¾ˆå¤§éº»çƒ¦ï¼Œå¾€å¾€ä¼šå‡ºç°è€å¹´ä»£è¿˜æœ‰å¾ˆå¤§ç©ºé—´å‰©ä½™ï¼Œä½†æ˜¯æ— æ³•æ‰¾åˆ°è¶³å¤Ÿå¤§çš„è¿ç»­ç©ºé—´æ¥åˆ†é…å½“å‰å¯¹è±¡ï¼Œä¸å¾—ä¸æå‰è§¦å‘ä¸€æ¬¡FullGCã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼ŒCMSæ”¶é›†å™¨æä¾›äº†ä¸€ä¸ª-XXï¼š+UseCMSCompactAtFullCollectionå¼€å…³å‚æ•°ï¼ˆé»˜è®¤å°±æ˜¯å¼€å¯çš„ï¼‰ï¼Œç”¨äºåœ¨CMSæ”¶é›†å™¨é¡¶ä¸ä½è¦è¿›è¡ŒFullGCæ—¶å¼€å¯å†…å­˜ç¢ç‰‡çš„åˆå¹¶æ•´ç†è¿‡ç¨‹ï¼Œå†…å­˜æ•´ç†çš„è¿‡ç¨‹æ˜¯æ— æ³•å¹¶å‘çš„ï¼Œç©ºé—´ç¢ç‰‡é—®é¢˜æ²¡æœ‰äº†ï¼Œä½†åœé¡¿æ—¶é—´ä¸å¾—ä¸å˜é•¿ã€‚è™šæ‹Ÿæœºè®¾è®¡è€…è¿˜æä¾›äº†å¦å¤–ä¸€ä¸ªå‚æ•°-XXï¼šCMSFullGCsBeforeCompactionï¼Œè¿™ä¸ªå‚æ•°æ˜¯ç”¨äºè®¾ç½®æ‰§è¡Œå¤šå°‘æ¬¡ä¸å‹ç¼©çš„Full GCåï¼Œè·Ÿç€æ¥ä¸€æ¬¡å¸¦å‹ç¼©çš„ï¼ˆé»˜è®¤å€¼ä¸º0ï¼Œè¡¨ç¤ºæ¯æ¬¡è¿›å…¥FullGCæ—¶éƒ½è¿›è¡Œç¢ç‰‡æ•´ç†ï¼‰</li>\n</ul>\n<h2>6.7. G1æ”¶é›†å™¨(Garbage-First)</h2>\n<ul>\n<li>G1æ˜¯ä¸€æ¬¾é¢å‘æœåŠ¡ç«¯åº”ç”¨çš„åƒåœ¾æ”¶é›†å™¨ã€‚å¯ä»¥æ›¿æ¢æ‰JDK 1.5ä¸­å‘å¸ƒçš„CMSæ”¶é›†å™¨</li>\n<li>å¹¶è¡Œä¸å¹¶å‘ï¼šG1èƒ½å……åˆ†åˆ©ç”¨å¤šCPUã€å¤šæ ¸ç¯å¢ƒä¸‹çš„ç¡¬ä»¶ä¼˜åŠ¿ï¼Œä½¿ç”¨å¤šä¸ªCPUï¼ˆCPUæˆ–è€…CPUæ ¸å¿ƒï¼‰æ¥ç¼©çŸ­Stop-The-Worldåœé¡¿çš„æ—¶é—´ï¼Œéƒ¨åˆ†å…¶ä»–æ”¶é›†å™¨åŸæœ¬éœ€è¦åœé¡¿Javaçº¿ç¨‹æ‰§è¡Œçš„GCåŠ¨ä½œï¼ŒG1æ”¶é›†å™¨ä»ç„¶å¯ä»¥é€šè¿‡å¹¶å‘çš„æ–¹å¼è®©Javaç¨‹åºç»§ç»­æ‰§è¡Œã€‚</li>\n<li>åˆ†ä»£æ”¶é›†ï¼šä¸å…¶ä»–æ”¶é›†å™¨ä¸€æ ·ï¼Œåˆ†ä»£æ¦‚å¿µåœ¨G1ä¸­ä¾ç„¶å¾—ä»¥ä¿ç•™ã€‚è™½ç„¶G1å¯ä»¥ä¸éœ€è¦å…¶ä»–æ”¶é›†å™¨é…åˆå°±èƒ½ç‹¬ç«‹ç®¡ç†æ•´ä¸ªGCå †ï¼Œä½†å®ƒèƒ½å¤Ÿé‡‡ç”¨ä¸åŒçš„æ–¹å¼å»å¤„ç†æ–°åˆ›å»ºçš„å¯¹è±¡å’Œå·²ç»å­˜æ´»äº†ä¸€æ®µæ—¶é—´ã€ç†¬è¿‡å¤šæ¬¡GCçš„æ—§å¯¹è±¡ä»¥è·å–æ›´å¥½çš„æ”¶é›†æ•ˆæœã€‚</li>\n<li>ç©ºé—´æ•´åˆï¼šä¸CMSçš„â€œæ ‡è®°â€”æ¸…ç†â€ç®—æ³•ä¸åŒï¼ŒG1ä»æ•´ä½“æ¥çœ‹æ˜¯åŸºäºâ€œæ ‡è®°â€”æ•´ç†â€ç®—æ³•å®ç°çš„æ”¶é›†å™¨ï¼Œä»å±€éƒ¨ï¼ˆä¸¤ä¸ªRegionä¹‹é—´ï¼‰ä¸Šæ¥çœ‹æ˜¯åŸºäºâ€œå¤åˆ¶â€ç®—æ³•å®ç°çš„ï¼Œä½†æ— è®ºå¦‚ä½•ï¼Œè¿™ä¸¤ç§ç®—æ³•éƒ½æ„å‘³ç€G1è¿ä½œæœŸé—´ä¸ä¼šäº§ç”Ÿå†…å­˜ç©ºé—´ç¢ç‰‡ï¼Œæ”¶é›†åèƒ½æä¾›è§„æ•´çš„å¯ç”¨å†…å­˜ã€‚è¿™ç§ç‰¹æ€§æœ‰åˆ©äºç¨‹åºé•¿æ—¶é—´è¿è¡Œï¼Œåˆ†é…å¤§å¯¹è±¡æ—¶ä¸ä¼šå› ä¸ºæ— æ³•æ‰¾åˆ°è¿ç»­å†…å­˜ç©ºé—´è€Œæå‰è§¦å‘ä¸‹ä¸€æ¬¡GCã€‚</li>\n<li>G1æ”¶é›†å™¨å°†æ•´ä¸ªJavaå †åˆ’åˆ†ä¸ºå¤šä¸ªå¤§å°ç›¸ç­‰çš„ç‹¬ç«‹åŒºåŸŸï¼ˆRegionï¼‰ï¼Œè™½ç„¶è¿˜ä¿ç•™æœ‰æ–°ç”Ÿä»£å’Œè€å¹´ä»£çš„æ¦‚å¿µï¼Œä½†æ–°ç”Ÿä»£å’Œè€å¹´ä»£ä¸å†æ˜¯ç‰©ç†éš”ç¦»çš„äº†ï¼Œå®ƒä»¬éƒ½æ˜¯ä¸€éƒ¨åˆ†Regionï¼ˆä¸éœ€è¦è¿ç»­ï¼‰çš„é›†åˆ</li>\n<li>å¯é¢„æµ‹çš„åœé¡¿ï¼šè¿™æ˜¯G1ç›¸å¯¹äºCMSçš„å¦ä¸€å¤§ä¼˜åŠ¿ï¼Œé™ä½åœé¡¿æ—¶é—´æ˜¯G1å’ŒCMSå…±åŒçš„å…³æ³¨ç‚¹ï¼Œä½†G1é™¤äº†è¿½æ±‚ä½åœé¡¿å¤–ï¼Œè¿˜èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œèƒ½è®©ä½¿ç”¨è€…æ˜ç¡®æŒ‡å®šåœ¨ä¸€ä¸ªé•¿åº¦ä¸ºMæ¯«ç§’çš„æ—¶é—´ç‰‡æ®µå†…ï¼Œæ¶ˆè€—åœ¨åƒåœ¾æ”¶é›†ä¸Šçš„æ—¶é—´ä¸å¾—è¶…è¿‡Næ¯«ç§’ï¼Œè¿™å‡ ä¹å·²ç»æ˜¯å®æ—¶Javaï¼ˆRTSJï¼‰çš„åƒåœ¾æ”¶é›†å™¨çš„ç‰¹å¾äº†ã€‚G1æ”¶é›†å™¨ä¹‹æ‰€ä»¥èƒ½å»ºç«‹å¯é¢„æµ‹çš„åœé¡¿æ—¶é—´æ¨¡å‹ï¼Œæ˜¯å› ä¸ºå®ƒå¯ä»¥æœ‰è®¡åˆ’åœ°é¿å…åœ¨æ•´ä¸ªJavaå †ä¸­è¿›è¡Œå…¨åŒºåŸŸçš„åƒåœ¾æ”¶é›†ã€‚G1è·Ÿè¸ªå„ä¸ªRegioné‡Œé¢çš„åƒåœ¾å †ç§¯çš„ä»·å€¼å¤§å°ï¼ˆå›æ”¶æ‰€è·å¾—çš„ç©ºé—´å¤§å°ä»¥åŠå›æ”¶æ‰€éœ€æ—¶é—´çš„ç»éªŒå€¼ï¼‰ï¼Œåœ¨åå°ç»´æŠ¤ä¸€ä¸ªä¼˜å…ˆåˆ—è¡¨ï¼Œæ¯æ¬¡æ ¹æ®å…è®¸çš„æ”¶é›†æ—¶é—´ï¼Œä¼˜å…ˆå›æ”¶ä»·å€¼æœ€å¤§çš„Regionï¼ˆè¿™ä¹Ÿå°±æ˜¯Garbage-Firståç§°çš„æ¥ç”±ï¼‰ã€‚è¿™ç§ä½¿ç”¨Regionåˆ’åˆ†å†…å­˜ç©ºé—´ä»¥åŠæœ‰ä¼˜å…ˆçº§çš„åŒºåŸŸå›æ”¶æ–¹å¼ï¼Œä¿è¯äº†G1æ”¶é›†å™¨åœ¨æœ‰é™çš„æ—¶é—´å†…å¯ä»¥è·å–å°½å¯èƒ½é«˜çš„æ”¶é›†æ•ˆç‡ã€‚</li>\n<li>æŠŠJavaå †åˆ†ä¸ºå¤šä¸ªRegionåï¼Œåƒåœ¾æ”¶é›†æ˜¯å¦å°±çœŸçš„èƒ½ä»¥Regionä¸ºå•ä½è¿›è¡Œäº†ï¼Ÿå¬èµ·æ¥é¡ºç†æˆç« ï¼Œå†ä»”ç»†æƒ³æƒ³å°±å¾ˆå®¹æ˜“å‘ç°é—®é¢˜æ‰€åœ¨ï¼šRegionä¸å¯èƒ½æ˜¯å­¤ç«‹çš„ã€‚ä¸€ä¸ªå¯¹è±¡åˆ†é…åœ¨æŸä¸ªRegionä¸­ï¼Œå®ƒå¹¶éåªèƒ½è¢«æœ¬Regionä¸­çš„å…¶ä»–å¯¹è±¡å¼•ç”¨ï¼Œè€Œæ˜¯å¯ä»¥ä¸æ•´ä¸ªJavaå †ä»»æ„çš„å¯¹è±¡å‘ç”Ÿå¼•ç”¨å…³ç³»ã€‚é‚£åœ¨åšå¯è¾¾æ€§åˆ¤å®šç¡®å®šå¯¹è±¡æ˜¯å¦å­˜æ´»çš„æ—¶å€™ï¼Œå²‚ä¸æ˜¯è¿˜å¾—æ‰«ææ•´ä¸ªJavaå †æ‰èƒ½ä¿è¯å‡†ç¡®æ€§ï¼Ÿè¿™ä¸ªé—®é¢˜å…¶å®å¹¶éåœ¨G1ä¸­æ‰æœ‰ï¼Œåªæ˜¯åœ¨G1ä¸­æ›´åŠ çªå‡ºè€Œå·²ã€‚åœ¨ä»¥å‰çš„åˆ†ä»£æ”¶é›†ä¸­ï¼Œæ–°ç”Ÿä»£çš„è§„æ¨¡ä¸€èˆ¬éƒ½æ¯”è€å¹´ä»£è¦å°è®¸å¤šï¼Œæ–°ç”Ÿä»£çš„æ”¶é›†ä¹Ÿæ¯”è€å¹´ä»£è¦é¢‘ç¹è®¸å¤šï¼Œé‚£å›æ”¶æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡æ—¶ä¹Ÿé¢ä¸´ç›¸åŒçš„é—®é¢˜ï¼Œå¦‚æœå›æ”¶æ–°ç”Ÿä»£æ—¶ä¹Ÿä¸å¾—ä¸åŒæ—¶æ‰«æè€å¹´ä»£çš„è¯ï¼Œé‚£ä¹ˆMinor GCçš„æ•ˆç‡å¯èƒ½ä¸‹é™ä¸å°‘ã€‚</li>\n<li>åœ¨G1æ”¶é›†å™¨ä¸­ï¼ŒRegionä¹‹é—´çš„å¯¹è±¡å¼•ç”¨ä»¥åŠå…¶ä»–æ”¶é›†å™¨ä¸­çš„æ–°ç”Ÿä»£ä¸è€å¹´ä»£ä¹‹é—´çš„å¯¹è±¡å¼•ç”¨ï¼Œè™šæ‹Ÿæœºéƒ½æ˜¯ä½¿Remembered Setæ¥é¿å…å…¨å †æ‰«æçš„ã€‚G1ä¸­æ¯ä¸ªRegionéƒ½æœ‰ä¸€ä¸ªä¸ä¹‹å¯¹åº”çš„Remembered Setï¼Œè™šæ‹Ÿæœºå‘ç°ç¨‹åºåœ¨å¯¹Referenceç±»å‹çš„æ•°æ®è¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šäº§ç”Ÿä¸€ä¸ªWrite Barrieræš‚æ—¶ä¸­æ–­å†™æ“ä½œï¼Œæ£€æŸ¥Referenceå¼•ç”¨çš„å¯¹è±¡æ˜¯å¦å¤„äºä¸åŒçš„Regionä¹‹ä¸­ï¼ˆåœ¨åˆ†ä»£çš„ä¾‹å­ä¸­å°±æ˜¯æ£€æŸ¥æ˜¯å¦è€å¹´ä»£ä¸­çš„å¯¹è±¡å¼•ç”¨äº†æ–°ç”Ÿä»£ä¸­çš„å¯¹è±¡ï¼‰ï¼Œå¦‚æœæ˜¯ï¼Œä¾¿é€šè¿‡CardTableæŠŠç›¸å…³å¼•ç”¨ä¿¡æ¯è®°å½•åˆ°è¢«å¼•ç”¨å¯¹è±¡æ‰€å±çš„Regionçš„Remembered Setä¹‹ä¸­ã€‚å½“è¿›è¡Œå†…å­˜å›æ”¶æ—¶ï¼Œåœ¨GCæ ¹èŠ‚ç‚¹çš„æšä¸¾èŒƒå›´ä¸­åŠ Remembered Setå³å¯ä¿è¯ä¸å¯¹å…¨å †æ‰«æä¹Ÿä¸ä¼šæœ‰é—æ¼ã€‚</li>\n<li>å¦‚æœä¸è®¡ç®—ç»´æŠ¤Remembered Setçš„æ“ä½œï¼ŒG1æ”¶é›†å™¨çš„è¿ä½œå¤§è‡´å¯åˆ’åˆ†ä¸ºä»¥ä¸‹å‡ ä¸ªæ­¥éª¤ï¼š\n<ul>\n<li>åˆå§‹æ ‡è®°ï¼ˆInitial Markingï¼‰ï¼šä»…ä»…åªæ˜¯æ ‡è®°ä¸€ä¸‹GC Rootsèƒ½ç›´æ¥å…³è”åˆ°çš„å¯¹è±¡ï¼Œå¹¶ä¸”ä¿®æ”¹TAMSï¼ˆNext Top at Mark Startï¼‰çš„å€¼ï¼Œè®©ä¸‹ä¸€é˜¶æ®µç”¨æˆ·ç¨‹åºå¹¶å‘è¿è¡Œæ—¶ï¼Œèƒ½åœ¨æ­£ç¡®å¯ç”¨çš„Regionä¸­åˆ›å»ºæ–°å¯¹è±¡ï¼Œè¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†è€—æ—¶å¾ˆçŸ­ã€‚</li>\n<li>å¹¶å‘æ ‡è®°ï¼ˆConcurrent Markingï¼‰ä»GC Rootå¼€å§‹å¯¹å †ä¸­å¯¹è±¡è¿›è¡Œå¯è¾¾æ€§åˆ†æï¼Œæ‰¾å‡ºå­˜æ´»çš„å¯¹è±¡ï¼Œè¿™é˜¶æ®µè€—æ—¶è¾ƒé•¿ï¼Œä½†å¯ä¸ç”¨æˆ·ç¨‹åºå¹¶å‘æ‰§è¡Œã€‚</li>\n<li>æœ€ç»ˆæ ‡è®°ï¼ˆFinal Markingï¼‰ä¸ºäº†ä¿®æ­£åœ¨å¹¶å‘æ ‡è®°æœŸé—´å› ç”¨æˆ·ç¨‹åºç»§ç»­è¿ä½œè€Œå¯¼è‡´æ ‡è®°äº§ç”Ÿå˜åŠ¨çš„é‚£ä¸€éƒ¨åˆ†æ ‡è®°è®°å½•ï¼Œè™šæ‹Ÿæœºå°†è¿™æ®µæ—¶é—´å¯¹è±¡å˜åŒ–è®°å½•åœ¨çº¿ç¨‹Remembered Set Logsé‡Œé¢ï¼Œæœ€ç»ˆæ ‡è®°é˜¶æ®µéœ€è¦æŠŠRemembered Set Logsçš„æ•°æ®åˆå¹¶åˆ°Remembered Setä¸­ï¼Œè¿™é˜¶æ®µéœ€è¦åœé¡¿çº¿ç¨‹ï¼Œä½†æ˜¯å¯å¹¶è¡Œæ‰§è¡Œã€‚</li>\n<li>ç­›é€‰å›æ”¶ï¼ˆLive Data Counting and Evacuationï¼‰é¦–å…ˆå¯¹å„ä¸ªRegionçš„å›æ”¶ä»·å€¼å’Œæˆæœ¬è¿›è¡Œæ’åºï¼Œæ ¹æ®ç”¨æˆ·æ‰€æœŸæœ›çš„GCåœé¡¿æ—¶é—´æ¥åˆ¶å®šå›æ”¶è®¡åˆ’ï¼Œä»Sunå…¬å¸é€éœ²å‡ºæ¥çš„ä¿¡æ¯æ¥çœ‹ï¼Œè¿™ä¸ªé˜¶æ®µå…¶å®ä¹Ÿå¯ä»¥åšåˆ°ä¸ç”¨æˆ·ç¨‹åºä¸€èµ·å¹¶å‘æ‰§è¡Œï¼Œä½†æ˜¯å› ä¸ºåªå›æ”¶ä¸€éƒ¨åˆ†Regionï¼Œæ—¶é—´æ˜¯ç”¨æˆ·å¯æ§åˆ¶çš„ï¼Œè€Œä¸”åœé¡¿ç”¨æˆ·çº¿ç¨‹å°†å¤§å¹…æé«˜æ”¶é›†æ•ˆç‡ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ed654609b4c9209ada12b.png\" alt=\"G1æ”¶é›†å™¨.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>7. GCæ—¥å¿—</h1>\n<ul>\n<li>æ¯ä¸ªæ”¶é›†å™¨çš„æ—¥å¿—æ ¼å¼éƒ½å¯ä»¥ä¸ä¸€æ ·ï¼Œä½†æ”¶é›†å™¨çš„æ—¥å¿—éƒ½ç»´æŒä¸€å®šçš„å…±æ€§</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>33.125ï¼š[GC[DefNewï¼š3324K-ï¼152Kï¼ˆ3712Kï¼‰ï¼Œ0.0025925 secs]3324K-ï¼152Kï¼ˆ11904Kï¼‰ï¼Œ0.0031680 secs]\n100.667ï¼š[Ful l G C[Tenuredï¼š0K-ï¼210K(10240K)ï¼Œ0.0149142secs]4603K-ï¼210Kï¼ˆ19456Kï¼‰ï¼Œ[Permï¼š2999K-ï¼2999Kï¼ˆ21248Kï¼‰]ï¼Œ0.0150007 secs][Timesï¼šuser=0.01 sys=0.00ï¼Œreal=0.02 secs]\n</code></pre></div><ul>\n<li>\n<p>æœ€å‰é¢çš„æ•°å­—â€œ33.125ï¼šâ€å’Œâ€œ100.667ï¼šâ€ä»£è¡¨äº†GCå‘ç”Ÿçš„æ—¶é—´(ä»Javaè™šæ‹Ÿæœºå¯åŠ¨ä»¥æ¥ç»è¿‡çš„ç§’æ•°)</p>\n</li>\n<li>\n<p>GCæ—¥å¿—å¼€å¤´çš„â€œ[GCâ€å’Œâ€œ[Full GCâ€è¯´æ˜äº†è¿™æ¬¡åƒåœ¾æ”¶é›†çš„åœé¡¿ç±»å‹ï¼Œå¦‚æœæœ‰â€œFullâ€ï¼Œè¯´æ˜è¿™æ¬¡GCæ˜¯å‘ç”Ÿäº†Stop-The-Worldçš„ï¼Œå¦‚æœæ˜¯è°ƒç”¨System.gcï¼ˆï¼‰æ–¹æ³•æ‰€è§¦å‘çš„æ”¶é›†ï¼Œé‚£ä¹ˆåœ¨è¿™é‡Œå°†æ˜¾ç¤ºâ€œ[Full GCï¼ˆSystemï¼‰â€ã€‚</p>\n</li>\n<li>\n<p>â€œ[DefNewâ€ã€â€œ[Tenuredâ€ã€â€œ[Permâ€è¡¨ç¤ºGCå‘ç”Ÿçš„åŒºåŸŸï¼Œè¿™é‡Œæ˜¾ç¤ºçš„åŒºåŸŸåç§°ä¸ä½¿ç”¨çš„GCæ”¶é›†å™¨æ˜¯å¯†åˆ‡ç›¸å…³çš„ï¼Œä¾‹å¦‚ä¸Šé¢æ ·ä¾‹æ‰€ä½¿ç”¨çš„Serialæ”¶é›†å™¨ä¸­çš„æ–°ç”Ÿä»£åä¸ºâ€œDefaultNew Generationâ€ï¼Œæ‰€ä»¥æ˜¾ç¤ºçš„æ˜¯â€œ[DefNewâ€ã€‚å¦‚æœæ˜¯ParNewæ”¶é›†å™¨ï¼Œæ–°ç”Ÿä»£åç§°å°±ä¼šå˜ä¸ºâ€œ[ParNewâ€ï¼Œæ„ä¸ºâ€œParallel New Generationâ€ã€‚å¦‚æœé‡‡ç”¨Parallel Scavengeæ”¶é›†å™¨ï¼Œé‚£å®ƒé…å¥—çš„æ–°ç”Ÿä»£ç§°ä¸ºâ€œPSYoungGenâ€ï¼Œè€å¹´ä»£å’Œæ°¸ä¹…ä»£åŒç†ï¼Œåç§°ä¹Ÿæ˜¯ç”±æ”¶é›†å™¨å†³å®šçš„ã€‚</p>\n</li>\n<li>\n<p>æ–¹æ‹¬å·å†…éƒ¨çš„â€œ3324K-ï¼152Kï¼ˆ3712Kï¼‰â€å«ä¹‰æ˜¯â€œGCå‰è¯¥å†…å­˜åŒºåŸŸå·²ä½¿ç”¨å®¹é‡-ï¼GCåè¯¥å†…å­˜åŒºåŸŸå·²ä½¿ç”¨å®¹é‡ï¼ˆè¯¥å†…å­˜åŒºåŸŸæ€»å®¹é‡ï¼‰â€ã€‚è€Œåœ¨æ–¹æ‹¬å·ä¹‹å¤–çš„â€œ3324K-ï¼152Kï¼ˆ11904Kï¼‰â€è¡¨ç¤ºâ€œGCå‰Javaå †å·²ä½¿ç”¨å®¹é‡-ï¼GCåJavaå †å·²ä½¿ç”¨å®¹é‡ï¼ˆJavaå †æ€»å®¹é‡ï¼‰â€</p>\n</li>\n<li>\n<p>â€œ0.0025925 secsâ€è¡¨ç¤ºè¯¥å†…å­˜åŒºåŸŸGCæ‰€å ç”¨çš„æ—¶é—´ï¼Œå•ä½æ˜¯ç§’ã€‚æœ‰çš„æ”¶é›†å™¨ä¼šç»™å‡ºæ›´å…·ä½“çš„æ—¶é—´æ•°æ®ï¼Œå¦‚â€œ[Timesï¼šuser=0.01 sys=0.00ï¼Œreal=0.02 secs]â€ï¼Œè¿™é‡Œé¢çš„userã€syså’Œrealä¸Linuxçš„timeå‘½ä»¤æ‰€è¾“å‡ºçš„æ—¶é—´å«ä¹‰ä¸€è‡´ï¼Œåˆ†åˆ«ä»£è¡¨ç”¨æˆ·æ€æ¶ˆè€—çš„CPUæ—¶é—´ã€å†…æ ¸æ€æ¶ˆè€—çš„CPUäº‹ä»¶å’Œæ“ä½œä»å¼€å§‹åˆ°ç»“æŸæ‰€ç»è¿‡çš„å¢™é’Ÿæ—¶é—´ï¼ˆWall Clock Timeï¼‰ã€‚CPUæ—¶é—´ä¸å¢™é’Ÿæ—¶é—´çš„åŒºåˆ«æ˜¯ï¼Œå¢™é’Ÿæ—¶é—´åŒ…æ‹¬å„ç§éè¿ç®—çš„ç­‰å¾…è€—æ—¶ï¼Œä¾‹å¦‚ç­‰å¾…ç£ç›˜I/Oã€ç­‰å¾…çº¿ç¨‹é˜»å¡ï¼Œè€ŒCPUæ—¶é—´ä¸åŒ…æ‹¬è¿™äº›è€—æ—¶ï¼Œä½†å½“ç³»ç»Ÿæœ‰å¤šCPUæˆ–è€…å¤šæ ¸çš„è¯ï¼Œå¤šçº¿ç¨‹æ“ä½œä¼šå åŠ è¿™äº›CPUæ—¶é—´ï¼Œæ‰€ä»¥useræˆ–sysæ—¶é—´è¶…è¿‡realæ—¶é—´æ˜¯å®Œå…¨æ­£å¸¸çš„</p>\n</li>\n<li>\n<p>åƒåœ¾æ”¶é›†å™¨å‚æ•°æ€»ç»“ï¼ˆJDK 1.7ï¼‰</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">å‚æ•°</th>\n<th style=\"text-align:left\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">UseSerialGC</td>\n<td style=\"text-align:left\">è™šæ‹Ÿæœºè¿è¡Œåœ¨Clientæ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼Œæ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨Serial + Serial Oldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UseParNewGC</td>\n<td style=\"text-align:left\">æ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨ParNew + Serial Oldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UseConcMarkSweepGC</td>\n<td style=\"text-align:left\">æ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨ParNew + CMS + Serial Oldçš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶ã€‚</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UseParallelGC</td>\n<td style=\"text-align:left\">è™šæ‹Ÿæœºè¿è¡Œåœ¨Serveræ¨¡å¼ä¸‹çš„é»˜è®¤å€¼ï¼Œæ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨Parallel Scavenge + Serial Oldï¼ˆPS MarkSweepï¼‰çš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UseParallelOldGC</td>\n<td style=\"text-align:left\">æ‰“å¼€æ­¤å¼€å…³åï¼Œä½¿ç”¨Parallel Scavenge + Parallel Old çš„æ”¶é›†å™¨ç»„åˆè¿›è¡Œå†…å­˜å›æ”¶</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">SurvivorRatio</td>\n<td style=\"text-align:left\">æ–°ç”Ÿä»£ä¸­EdenåŒºåŸŸä¸SurvivoråŒºåŸŸçš„å®¹é‡æ¯”å€¼ï¼Œé»˜è®¤ä¸º8ï¼Œä»£è¡¨Eden : Survivor=8:1</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">PretenureSizeThreshold</td>\n<td style=\"text-align:left\">ç›´æ¥æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¤§å°ï¼Œè®¾ç½®è¿™ä¸ªå‚æ•°åï¼Œå¤§äºè¿™ä¸ªå‚æ•°çš„å¯¹è±¡å°†ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MaxTenuringThreshold</td>\n<td style=\"text-align:left\">æ™‹å‡åˆ°è€å¹´ä»£çš„å¯¹è±¡å¹´é¾„ã€‚æ¯ä¸ªå¯¹è±¡åœ¨åšæŒè¿‡ä¸€æ¬¡Minor GCä¹‹åï¼Œå¹´é¾„å°±å¢åŠ 1ï¼Œå½“è¶…è¿‡è¿™ä¸ªå‚æ•°å€¼æ—¶å°±è¿›å…¥è€å¹´ä»£</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UseAdaptiveSizePolicy</td>\n<td style=\"text-align:left\">åŠ¨æ€è°ƒæ•´Javaå †ä¸­å„ä¸ªåŒºåŸŸçš„å¤§å°ä»¥åŠè¿›å…¥è€å¹´ä»£çš„å¹´é¾„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">HandlePromotionFailure</td>\n<td style=\"text-align:left\">æ˜¯å¦å…è®¸åˆ†é…æ‹…ä¿å¤±è´¥ï¼Œå³è€å¹´ä»£çš„å‰©ä½™ç©ºé—´ä¸è¶³ä»¥åº”ä»˜æ–°ç”Ÿä»£çš„æ•´ä¸ªEdenå’ŒSurvivoråŒºçš„æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»çš„æç«¯æƒ…å†µ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">ParallelGCThreads</td>\n<td style=\"text-align:left\">è®¾ç½®å¹¶è¡ŒGCæ—¶è¿›è¡Œå†…å­˜å›æ”¶çš„çº¿ç¨‹æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">GCTimeRatio</td>\n<td style=\"text-align:left\">GCæ—¶é—´å æ€»æ—¶é—´çš„æ¯”ç‡ï¼Œé»˜è®¤å€¼ä¸º99ï¼Œå³å…è®¸1%çš„GCæ—¶é—´ã€‚ä»…ä½¿ç”¨Parallel Scavengeæ”¶é›†å™¨æ—¶ç”Ÿæ•ˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">MaxGCPauseMillis</td>\n<td style=\"text-align:left\">è®¾ç½®GCçš„æœ€å¤§åœé¡¿æ—¶é—´ã€‚ä»…åœ¨ä½¿ç”¨Parallel Scavengeæ”¶é›†å™¨ç”Ÿæ•ˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CMSInitiatingOccupancyFraction</td>\n<td style=\"text-align:left\">è®¾ç½®CMSæ”¶é›†å™¨åœ¨è€å¹´ä»£ç©ºé—´è¢«ä½¿ç”¨å¤šå°‘åè§¦å‘åƒåœ¾æ”¶é›†ï¼Œé»˜è®¤å€¼ä¸º68%ï¼Œä»…ä½¿ç”¨CMSæ”¶é›†å™¨æ—¶ç”Ÿæ•ˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">UseCMSCompactAtFullCollection</td>\n<td style=\"text-align:left\">è®¾ç½®CMSæ”¶é›†å™¨åœ¨å®Œæˆåƒåœ¾æ”¶é›†åæ˜¯å¦è¦è¿›è¡Œä¸€æ¬¡å†…å­˜ç¢ç‰‡æ•´ç†ã€‚ä»…åœ¨ä½¿ç”¨CMSæ”¶é›†å™¨æ—¶ç”Ÿæ•ˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">CMSFullGCsBeforeCompaction</td>\n<td style=\"text-align:left\">è®¾ç½®CMSæ”¶é›†å™¨åœ¨è¿›è¡Œè‹¥å¹²æ¬¡åƒåœ¾æ”¶é›†åå†å¯åŠ¨ä¸€æ¬¡å†…å­˜ç¢ç‰‡æ•´ç†ã€‚ä»…åœ¨ä½¿ç”¨CMSæ”¶é›†å™¨æ—¶ç”Ÿæ•ˆ</td>\n</tr>\n</tbody>\n</table>\n<h1>8. å†…å­˜åˆ†é…ä¸å›æ”¶ç­–ç•¥</h1>\n<ul>\n<li>å¯¹è±¡çš„å†…å­˜åˆ†é…ï¼Œå¾€å¤§æ–¹å‘è®²ï¼Œå°±æ˜¯åœ¨å †ä¸Šåˆ†é…ï¼ˆä½†ä¹Ÿå¯èƒ½ç»è¿‡JITç¼–è¯‘åè¢«æ‹†æ•£ä¸ºæ ‡é‡ç±»å‹å¹¶é—´æ¥åœ°æ ˆä¸Šåˆ†é…ï¼‰ï¼Œå¯¹è±¡ä¸»è¦åˆ†é…åœ¨æ–°ç”Ÿä»£çš„EdenåŒºä¸Šï¼Œå¦‚æœå¯åŠ¨äº†æœ¬åœ°çº¿ç¨‹åˆ†é…ç¼“å†²ï¼Œå°†æŒ‰çº¿ç¨‹ä¼˜å…ˆåœ¨TLABä¸Šåˆ†é…ã€‚å°‘æ•°æƒ…å†µä¸‹ä¹Ÿå¯èƒ½ä¼šç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ä¸­ï¼Œåˆ†é…çš„è§„åˆ™å–å†³äºå½“å‰ä½¿ç”¨çš„æ˜¯å“ªä¸€ç§åƒåœ¾æ”¶é›†å™¨ç»„åˆï¼Œè¿˜æœ‰è™šæ‹Ÿæœºä¸­ä¸å†…å­˜ç›¸å…³çš„å‚æ•°çš„è®¾ç½®ã€‚</li>\n</ul>\n<h2>8.1. å¯¹è±¡ä¼˜å…ˆåœ¨Edenåˆ†é…</h2>\n<ul>\n<li>å¤§å¤šæ•°æƒ…å†µä¸‹ï¼Œå¯¹è±¡åœ¨æ–°ç”Ÿä»£EdenåŒºä¸­åˆ†é…ã€‚å½“EdenåŒºæ²¡æœ‰è¶³å¤Ÿç©ºé—´è¿›è¡Œåˆ†é…æ—¶ï¼Œè™šæ‹Ÿæœºå°†å‘èµ·ä¸€æ¬¡Minor GCã€‚</li>\n<li>è™šæ‹Ÿæœºæä¾›äº†-XXï¼š+PrintGCDetailsè¿™ä¸ªæ”¶é›†å™¨æ—¥å¿—å‚æ•°ï¼Œå‘Šè¯‰è™šæ‹Ÿæœºåœ¨å‘ç”Ÿåƒåœ¾æ”¶é›†è¡Œä¸ºæ—¶æ‰“å°å†…å­˜å›æ”¶æ—¥å¿—ï¼Œå¹¶ä¸”åœ¨è¿›ç¨‹é€€å‡ºçš„æ—¶å€™è¾“å‡ºå½“å‰çš„å†…å­˜å„åŒºåŸŸåˆ†é…æƒ…å†µã€‚åœ¨å®é™…åº”ç”¨ä¸­ï¼Œå†…å­˜å›æ”¶æ—¥å¿—ä¸€èˆ¬æ˜¯æ‰“å°åˆ°æ–‡ä»¶åé€šè¿‡æ—¥å¿—å·¥å…·è¿›è¡Œåˆ†æ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static final int_1MB=1024*1024ï¼›\n/**\n*VMå‚æ•°ï¼š-verboseï¼šgc-Xms20M-Xmx20M-Xmn10M-XXï¼š+PrintGCDetails\n-XXï¼šSurvivorRatio=8\n*/\npublic static void testAllocationï¼ˆï¼‰{\n  byte[]allocation1ï¼Œallocation2ï¼Œallocation3ï¼Œallocation4ï¼›\n  allocation1=new byte[2*_1MB]ï¼›\n  allocation2=new byte[2*_1MB]ï¼›\n  allocation3=new byte[2*_1MB]ï¼›\n  allocation4=new byte[4*_1MB]ï¼›//å‡ºç°ä¸€æ¬¡Minor GC\n}\n[GC[DefNewï¼š6651K-ï¼148Kï¼ˆ9216Kï¼‰ï¼Œ0.0070106 secs]6651K-ï¼6292Kï¼ˆ19456Kï¼‰ï¼Œ\n0.0070426 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\nHeap\ndef new generation total 9216K,used 4326K[0x029d0000ï¼Œ0x033d0000ï¼Œ0x033d0000ï¼‰\neden space 8192Kï¼Œ51%used[0x029d0000ï¼Œ0x02de4828ï¼Œ0x031d0000ï¼‰\nfrom space 1024Kï¼Œ14%used[0x032d0000ï¼Œ0x032f5370ï¼Œ0x033d0000ï¼‰\nto space 1024Kï¼Œ0%used[0x031d0000ï¼Œ0x031d0000ï¼Œ0x032d0000ï¼‰\ntenured generation total 10240K,used 6144K[0x033d0000ï¼Œ0x03dd0000ï¼Œ0x03dd0000ï¼‰\nthe space 10240Kï¼Œ60%used[0x033d0000ï¼Œ0x039d0030ï¼Œ0x039d0200ï¼Œ0x03dd0000ï¼‰\ncompacting perm gen total 12288K,used 2114K[0x03dd0000ï¼Œ0x049d0000ï¼Œ0x07dd0000ï¼‰\nthe space 12288Kï¼Œ17%used[0x03dd0000ï¼Œ0x03fe0998ï¼Œ0x03fe0a00ï¼Œ0x049d0000ï¼‰\nNo shared spaces configured.\n\ntestAllocationï¼ˆï¼‰æ–¹æ³•ä¸­ï¼Œå°è¯•åˆ†é…3ä¸ª2MBå¤§å°å’Œ1ä¸ª4MBå¤§å°çš„å¯¹è±¡ï¼Œåœ¨è¿è¡Œæ—¶é€šè¿‡-Xms20Mã€-Xmx20Mã€-Xmn10Mè¿™3ä¸ªå‚æ•°é™åˆ¶äº†Javaå †å¤§å°ä¸º20MBï¼Œä¸å¯æ‰©å±•ï¼Œå…¶ä¸­10MBåˆ†é…ç»™æ–°ç”Ÿä»£ï¼Œå‰©ä¸‹çš„10MBåˆ†é…ç»™è€å¹´ä»£ã€‚-XXï¼šSurvivorRatio=8å†³å®šäº†æ–°ç”Ÿä»£ä¸­EdenåŒºä¸ä¸€ä¸ªSurvivoråŒºçš„ç©ºé—´æ¯”ä¾‹æ˜¯8:1ï¼Œä»è¾“å‡ºçš„ç»“æœä¹Ÿå¯ä»¥æ¸…æ™°åœ°çœ‹åˆ°â€œeden\nspace 8192Kã€from space 1024Kã€to space 1024Kâ€çš„ä¿¡æ¯ï¼Œæ–°ç”Ÿä»£æ€»å¯ç”¨ç©ºé—´ä¸º9216KBï¼ˆEdenåŒº+1ä¸ªSurvivoråŒºçš„æ€»å®¹é‡ï¼‰ã€‚\n\næ‰§è¡ŒtestAllocationï¼ˆï¼‰ä¸­åˆ†é…allocation4å¯¹è±¡çš„è¯­å¥æ—¶ä¼šå‘ç”Ÿä¸€æ¬¡Minor GCï¼Œè¿™æ¬¡GCçš„ç»“æœæ˜¯æ–°ç”Ÿä»£6651KBå˜ä¸º148KBï¼Œè€Œæ€»å†…å­˜å ç”¨é‡åˆ™å‡ ä¹æ²¡æœ‰å‡å°‘ï¼ˆå› ä¸ºallocation1ã€allocation2ã€allocation3ä¸‰ä¸ªå¯¹è±¡éƒ½æ˜¯å­˜æ´»çš„ï¼Œè™šæ‹Ÿæœºå‡ ä¹æ²¡æœ‰æ‰¾åˆ°å¯å›æ”¶çš„å¯¹è±¡ï¼‰ã€‚è¿™æ¬¡GCå‘ç”Ÿçš„åŸå› æ˜¯ç»™allocation4åˆ†é…å†…å­˜çš„æ—¶å€™ï¼Œå‘ç°Edenå·²ç»è¢«å ç”¨äº†6MBï¼Œå‰©ä½™ç©ºé—´å·²ä¸è¶³ä»¥åˆ†é…allocation4æ‰€éœ€çš„4MBå†…å­˜ï¼Œå› æ­¤å‘ç”ŸMinor GCã€‚GCæœŸé—´è™šæ‹Ÿæœºåˆå‘ç°å·²æœ‰çš„3ä¸ª2MBå¤§å°çš„å¯¹è±¡å…¨éƒ¨æ— æ³•æ”¾å…¥Survivorç©ºé—´ï¼ˆSurvivorç©ºé—´åªæœ‰1MBå¤§å°ï¼‰ï¼Œæ‰€ä»¥åªå¥½é€šè¿‡åˆ†é…æ‹…ä¿æœºåˆ¶æå‰è½¬ç§»åˆ°è€å¹´ä»£å»ã€‚\nè¿™æ¬¡GCç»“æŸåï¼Œ4MBçš„allocation4å¯¹è±¡é¡ºåˆ©åˆ†é…åœ¨Edenä¸­ï¼Œå› æ­¤ç¨‹åºæ‰§è¡Œå®Œçš„ç»“æœæ˜¯Edenå ç”¨4MBï¼ˆè¢«allocation4å ç”¨ï¼‰ï¼ŒSurvivorç©ºé—²ï¼Œè€å¹´ä»£è¢«å ç”¨6MBï¼ˆè¢«allocation1ã€allocation2ã€allocation3å ç”¨ï¼‰ã€‚\n</code></pre></div><ul>\n<li>Minor GCå’ŒFull GCæœ‰ä»€ä¹ˆä¸ä¸€æ ·å—ï¼Ÿ\n<ul>\n<li>æ–°ç”Ÿä»£GCï¼ˆMinor GCï¼‰ï¼šæŒ‡å‘ç”Ÿåœ¨æ–°ç”Ÿä»£çš„åƒåœ¾æ”¶é›†åŠ¨ä½œï¼Œå› ä¸ºJavaå¯¹è±¡å¤§å¤šéƒ½å…·å¤‡æœç”Ÿå¤•ç­çš„ç‰¹æ€§ï¼Œæ‰€ä»¥Minor GCéå¸¸é¢‘ç¹ï¼Œä¸€èˆ¬å›æ”¶é€Ÿåº¦ä¹Ÿæ¯”è¾ƒå¿«ã€‚</li>\n<li>è€å¹´ä»£GCï¼ˆMajor GC/Full GCï¼‰ï¼šæŒ‡å‘ç”Ÿåœ¨è€å¹´ä»£çš„GCï¼Œç»å¸¸ä¼šä¼´éšè‡³å°‘ä¸€æ¬¡çš„Minor GCï¼ˆä½†éç»å¯¹çš„ï¼Œåœ¨Parallel Scavengeæ”¶é›†å™¨çš„æ”¶é›†ç­–ç•¥é‡Œå°±æœ‰ç›´æ¥è¿›è¡ŒMajor GCçš„ç­–ç•¥é€‰æ‹©è¿‡ç¨‹ï¼‰ã€‚Major GCçš„é€Ÿåº¦ä¸€èˆ¬ä¼šæ¯”Minor GCæ…¢10å€ä»¥ä¸Š</li>\n</ul>\n</li>\n</ul>\n<h2>8.2. å¤§å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£</h2>\n<ul>\n<li>å¤§å¯¹è±¡æ˜¯æŒ‡éœ€è¦å¤§é‡è¿ç»­å†…å­˜ç©ºé—´çš„Javaå¯¹è±¡ï¼Œæœ€å…¸å‹çš„å¤§å¯¹è±¡å°±æ˜¯é‚£ç§å¾ˆé•¿çš„å­—ç¬¦ä¸²ä»¥åŠæ•°ç»„ã€‚ç»å¸¸å‡ºç°å¤§å¯¹è±¡å®¹æ˜“å¯¼è‡´å†…å­˜è¿˜æœ‰ä¸å°‘ç©ºé—´æ—¶å°±æå‰è§¦å‘åƒåœ¾æ”¶é›†ä»¥è·å–è¶³å¤Ÿçš„è¿ç»­ç©ºé—´æ¥â€œå®‰ç½®â€å®ƒä»¬ã€‚å†™ç¨‹åºåº”è¯¥é¿å…äº§ç”Ÿå¤§å¯¹è±¡</li>\n<li>è™šæ‹Ÿæœºæä¾›äº†ä¸€ä¸ª-XXï¼šPretenureSizeThresholdå‚æ•°ï¼Œä»¤å¤§äºè¿™ä¸ªè®¾ç½®å€¼çš„å¯¹è±¡ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ã€‚ç›®çš„æ˜¯é¿å…åœ¨EdenåŒºåŠä¸¤ä¸ªSurvivoråŒºä¹‹é—´å‘ç”Ÿå¤§é‡çš„å†…å­˜å¤åˆ¶ï¼ˆæ–°ç”Ÿä»£é‡‡ç”¨å¤åˆ¶ç®—æ³•æ”¶é›†å†…å­˜ï¼‰ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static final int_1MB=1024*1024ï¼›\n/**\n*VMå‚æ•°ï¼š-verboseï¼šgc-Xms20M-Xmx20M-Xmn10M-XXï¼š+PrintGCDetails-XXï¼šSurvivorRatio=8\n*-XXï¼šPretenureSizeThreshold=3145728\n*/\npublic static void testPretenureSizeThresholdï¼ˆï¼‰{\n  byte[]allocationï¼›\n  allocation=new byte[4*_1MB]ï¼›//ç›´æ¥åˆ†é…åœ¨è€å¹´ä»£ä¸­\n}\nHeap\ndef new generation total 9216K,used 671K[0x029d0000ï¼Œ0x033d0000ï¼Œ0x033d0000ï¼‰\neden space 8192Kï¼Œ8%used[0x029d0000ï¼Œ0x02a77e98ï¼Œ0x031d0000ï¼‰\nfrom space 1024Kï¼Œ0%used[0x031d0000ï¼Œ0x031d0000ï¼Œ0x032d0000ï¼‰\nto space 1024Kï¼Œ0%used[0x032d0000ï¼Œ0x032d0000ï¼Œ0x033d0000ï¼‰\ntenured generation total 10240K,used 4096K[0x033d0000ï¼Œ0x03dd0000ï¼Œ0x03dd0000ï¼‰\nthe space 10240Kï¼Œ40%used[0x033d0000ï¼Œ0x037d0010ï¼Œ0x037d0200ï¼Œ0x03dd0000ï¼‰\ncompacting perm gen total 12288K,used 2107K[0x03dd0000ï¼Œ0x049d0000ï¼Œ0x07dd0000ï¼‰\nthe space 12288Kï¼Œ17%used[0x03dd0000ï¼Œ0x03fdefd0ï¼Œ0x03fdf000ï¼Œ0x049d0000ï¼‰\nNo shared spaces configured\n\ntestPretenureSizeThresholdï¼ˆï¼‰æ–¹æ³•åï¼Œæˆ‘ä»¬çœ‹åˆ°Edenç©ºé—´å‡ ä¹æ²¡æœ‰è¢«ä½¿ç”¨ï¼Œè€Œè€å¹´ä»£çš„10MBç©ºé—´è¢«ä½¿ç”¨äº†40%ï¼Œä¹Ÿå°±æ˜¯4MBçš„allocationå¯¹è±¡ç›´æ¥å°±åˆ†é…åœ¨è€å¹´ä»£ä¸­ï¼Œè¿™æ˜¯å› ä¸ºPretenureSizeThresholdè¢«è®¾ç½®ä¸º3MBï¼ˆå°±æ˜¯3145728ï¼Œè¿™ä¸ªå‚æ•°ä¸èƒ½åƒ-Xmxä¹‹ç±»çš„å‚æ•°ä¸€æ ·ç›´æ¥å†™3MBï¼‰ï¼Œå› æ­¤è¶…è¿‡3MBçš„å¯¹è±¡éƒ½ä¼šç›´æ¥åœ¨è€å¹´ä»£è¿›è¡Œåˆ†é…ã€‚æ³¨æ„\nPretenureSizeThresholdå‚æ•°åªå¯¹Serialå’ŒParNewä¸¤æ¬¾æ”¶é›†å™¨æœ‰æ•ˆï¼ŒParallel Scavengeæ”¶é›†å™¨ä¸è®¤è¯†è¿™ä¸ªå‚æ•°ï¼ŒParallel Scavengeæ”¶é›†å™¨ä¸€èˆ¬å¹¶ä¸éœ€è¦è®¾ç½®ã€‚å¦‚æœé‡åˆ°å¿…é¡»ä½¿ç”¨æ­¤å‚æ•°çš„åœºåˆï¼Œå¯ä»¥è€ƒè™‘ParNewåŠ CMSçš„æ”¶é›†å™¨ç»„åˆ\n</code></pre></div><h2>8.3. é•¿æœŸå­˜æ´»çš„å¯¹è±¡å°†è¿›å…¥è€å¹´ä»£</h2>\n<ul>\n<li>è™šæ‹Ÿæœºé‡‡ç”¨äº†åˆ†ä»£æ”¶é›†çš„æ€æƒ³æ¥ç®¡ç†å†…å­˜ï¼Œè™šæ‹Ÿæœºç»™æ¯ä¸ªå¯¹è±¡å®šä¹‰äº†ä¸€ä¸ªå¯¹è±¡å¹´é¾„ï¼ˆAgeï¼‰è®¡æ•°å™¨ã€‚å¦‚æœå¯¹è±¡åœ¨Edenå‡ºç”Ÿå¹¶ç»è¿‡ç¬¬ä¸€æ¬¡Minor GCåä»ç„¶å­˜æ´»ï¼Œå¹¶ä¸”èƒ½è¢«Survivorå®¹çº³çš„è¯ï¼Œå°†è¢«ç§»åŠ¨åˆ°Survivorç©ºé—´ä¸­ï¼Œå¹¶ä¸”å¯¹è±¡å¹´é¾„è®¾ä¸º1ã€‚å¯¹è±¡åœ¨SurvivoråŒºä¸­æ¯â€œç†¬è¿‡â€ä¸€æ¬¡Minor GCï¼Œå¹´é¾„å°±å¢åŠ 1å²ï¼Œå½“å®ƒçš„å¹´é¾„å¢åŠ åˆ°ä¸€å®šç¨‹åº¦ï¼ˆé»˜è®¤ä¸º15å²ï¼‰ï¼Œå°±å°†ä¼šè¢«æ™‹å‡åˆ°è€å¹´ä»£ä¸­ã€‚å¯¹è±¡æ™‹å‡è€å¹´ä»£çš„å¹´é¾„é˜ˆå€¼ï¼Œå¯ä»¥é€šè¿‡å‚æ•°-XXï¼šMaxTenuringThresholdè®¾ç½®ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static final int_1MB=1024*1024ï¼›\n/**\n*VMå‚æ•°ï¼š-verboseï¼šgc-Xms20M-Xmx20M-Xmn10M-XXï¼š+PrintGCDetails-XXï¼šSurvivorRatio=8-XXï¼šMaxTenuringThreshold=1\n*-XXï¼š+PrintTenuringDistribution\n*/\n@SuppressWarningsï¼ˆ\"unused\"ï¼‰\npublic static void testTenuringThresholdï¼ˆï¼‰{\n  byte[]allocation1ï¼Œallocation2ï¼Œallocation3ï¼›\n  allocation1=new byte[_1MB/4]ï¼›\n  //ä»€ä¹ˆæ—¶å€™è¿›å…¥è€å¹´ä»£å–å†³äºXXï¼šMaxTenuringThresholdè®¾ç½®\n  allocation2=new byte[4*_1MB]ï¼›\n  allocation3=new byte[4*_1MB]ï¼›\n  allocation3=nullï¼›\n  allocation3=new byte[4*_1MB]ï¼›\n}\nä»¥MaxTenuringThreshold=1å‚æ•°æ¥è¿è¡Œçš„ç»“æœï¼š\n\n[GC[DefNew\nDesired Survivor size 524288 bytes,new threshold 1ï¼ˆmax 1ï¼‰\n-age 1ï¼š414664 bytesï¼Œ414664 total ï¼š4859K-ï¼404Kï¼ˆ9216Kï¼‰ï¼Œ0.0065012 secs]4859K-ï¼4500Kï¼ˆ19456Kï¼‰ï¼Œ0.0065283 secs][Timesï¼šuser=0.02 sys=0.00ï¼Œreal=0.02 secs]\n[GC[DefNew\nDesired Survivor size 524288 bytes,new threshold 1ï¼ˆmax 1ï¼‰\nï¼š4500K-ï¼0Kï¼ˆ9216Kï¼‰ï¼Œ0.0009253 secs]8596K-ï¼4500Kï¼ˆ19456Kï¼‰ï¼Œ0.0009458 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\nHeap\ndef new generation total 9216K,used 4178K[0x029d0000ï¼Œ0x033d0000ï¼Œ0x033d0000ï¼‰\neden space 8192Kï¼Œ51%used[0x029d0000ï¼Œ0x02de4828ï¼Œ0x031d0000ï¼‰\nfrom space 1024Kï¼Œ0%used[0x031d0000ï¼Œ0x031d0000ï¼Œ0x032d0000ï¼‰\nto space 1024Kï¼Œ0%used[0x032d0000ï¼Œ0x032d0000ï¼Œ0x033d0000ï¼‰\ntenured generation total 10240K,used 4500K[0x033d0000ï¼Œ0x03dd0000ï¼Œ0x03dd0000ï¼‰\nthe space 10240Kï¼Œ43%used[0x033d0000ï¼Œ0x03835348ï¼Œ0x03835400ï¼Œ0x03dd0000ï¼‰\ncompacting perm gen total 12288K,used 2114K[0x03dd0000ï¼Œ0x049d0000ï¼Œ0x07dd0000ï¼‰\nthe space 12288Kï¼Œ17%used[0x03dd0000ï¼Œ0x03fe0998ï¼Œ0x03fe0a00ï¼Œ0x049d0000ï¼‰\nNo shared spaces configured. \n\nä»¥MaxTenuringThreshold=15å‚æ•°æ¥è¿è¡Œçš„ç»“æœï¼š\n[GC[DefNew\nDesired Survivor size 524288 bytes,new threshold 15ï¼ˆmax 15ï¼‰\n-age 1ï¼š414664 bytesï¼Œ414664 total ï¼š4859K-ï¼404Kï¼ˆ9216Kï¼‰ï¼Œ0.0049637 secs]4859K-ï¼4500Kï¼ˆ19456Kï¼‰ï¼Œ0.0049932 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\n[GC[DefNew\nDesired Survivor size 524288 bytes,new threshold 15ï¼ˆmax 15ï¼‰\n-age 2ï¼š414520 bytesï¼Œ414520 total ï¼š4500K-ï¼404Kï¼ˆ9216Kï¼‰ï¼Œ0.0008091 secs]8596K-ï¼4500Kï¼ˆ19456Kï¼‰ï¼Œ0.0008305 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\nHeap\ndef new generation total 9216K,used 4582K[0x029d0000ï¼Œ0x033d0000ï¼Œ0x033d0000ï¼‰\neden space 8192Kï¼Œ51%used[0x029d0000ï¼Œ0x02de4828ï¼Œ0x031d0000ï¼‰\nfrom space 1024Kï¼Œ39%used[0x031d0000ï¼Œ0x03235338ï¼Œ0x032d0000ï¼‰\nto space 1024Kï¼Œ0%used[0x032d0000ï¼Œ0x032d0000ï¼Œ0x033d0000ï¼‰\ntenured generation total 10240K,used 4096K[0x033d0000ï¼Œ0x03dd0000ï¼Œ0x03dd0000ï¼‰\nthe space 10240Kï¼Œ40%used[0x033d0000ï¼Œ0x037d0010ï¼Œ0x037d0200ï¼Œ0x03dd0000ï¼‰\ncompacting perm gen total 12288K,used 2114K[0x03dd0000ï¼Œ0x049d0000ï¼Œ0x07dd0000ï¼‰\nthe space 12288Kï¼Œ17%used[0x03dd0000ï¼Œ0x03fe0998ï¼Œ0x03fe0a00ï¼Œ0x049d0000ï¼‰\nNo shared spaces configured\n\nåˆ†åˆ«ä»¥-XXï¼šMaxTenuringThreshold=1å’Œ-XXï¼šMaxTenuringThreshold=15ä¸¤ç§è®¾ç½®æ¥æ‰§è¡Œä»£ç æ¸…å•3-7ä¸­çš„testTenuringThresholdï¼ˆï¼‰æ–¹æ³•ï¼Œæ­¤æ–¹æ³•ä¸­çš„allocation1å¯¹è±¡éœ€è¦256KBå†…å­˜ï¼ŒSurvivorç©ºé—´å¯ä»¥å®¹çº³ã€‚å½“MaxTenuringThreshold=1æ—¶ï¼Œallocation1å¯¹è±¡åœ¨ç¬¬äºŒæ¬¡GCå‘ç”Ÿæ—¶è¿›å…¥è€å¹´ä»£ï¼Œæ–°ç”Ÿä»£å·²ä½¿ç”¨çš„å†…å­˜GCåéå¸¸å¹²å‡€åœ°å˜æˆ0KBã€‚è€ŒMaxTenuringThreshold=15æ—¶ï¼Œç¬¬äºŒæ¬¡GCå‘ç”Ÿåï¼Œallocation1å¯¹è±¡åˆ™è¿˜ç•™åœ¨æ–°ç”Ÿä»£Survivorç©ºé—´ï¼Œè¿™æ—¶æ–°ç”Ÿä»£ä»ç„¶æœ‰404KBè¢«å ç”¨\n</code></pre></div><h2>8.4. åŠ¨æ€å¯¹è±¡å¹´é¾„åˆ¤å®š</h2>\n<ul>\n<li>ä¸ºäº†èƒ½æ›´å¥½åœ°é€‚åº”ä¸åŒç¨‹åºçš„å†…å­˜çŠ¶å†µï¼Œè™šæ‹Ÿæœºå¹¶ä¸æ˜¯æ°¸è¿œåœ°è¦æ±‚å¯¹è±¡çš„å¹´é¾„å¿…é¡»è¾¾åˆ°äº†MaxTenuringThresholdæ‰èƒ½æ™‹å‡è€å¹´ä»£ï¼Œå¦‚æœåœ¨Survivorç©ºé—´ä¸­ç›¸åŒå¹´é¾„æ‰€æœ‰å¯¹è±¡å¤§å°çš„æ€»å’Œå¤§äºSurvivorç©ºé—´çš„ä¸€åŠï¼Œå¹´é¾„å¤§äºæˆ–ç­‰äºè¯¥å¹´é¾„çš„å¯¹è±¡å°±å¯ä»¥ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œæ— é¡»ç­‰åˆ°MaxTenuringThresholdä¸­è¦æ±‚çš„å¹´é¾„ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static final int_1MB=1024*1024ï¼›\n/**\n*VMå‚æ•°ï¼š-verboseï¼šgc-Xms20M-Xmx20M-Xmn10M-XXï¼š+PrintGCDetails-XXï¼šSurvivorRatio=8-XXï¼šMaxTenuringThreshold=15\n*-XXï¼š+PrintTenuringDistribution\n*/\n@SuppressWarningsï¼ˆ\"unused\"ï¼‰\npublic static void testTenuringThreshold2ï¼ˆï¼‰{\n  byte[]allocation1ï¼Œallocation2ï¼Œallocation3ï¼Œallocation4ï¼›\n  allocation1=new byte[_1MB/4]ï¼›\n  //allocation1+allocation2å¤§äºsurvivoç©ºé—´ä¸€åŠ\n  allocation2=new byte[_1MB/4]ï¼›\n  allocation3=new byte[4*_1MB]ï¼›\n  allocation4=new byte[4*_1MB]ï¼›\n  allocation4=nullï¼›\n  allocation4=new byte[4*_1MB]ï¼›\n}\n[GC[DefNew\nDesired Survivor size 524288 bytes,new threshold 1ï¼ˆmax 15ï¼‰\n-age 1ï¼š676824 bytesï¼Œ676824 total ï¼š5115K-ï¼660Kï¼ˆ9216Kï¼‰ï¼Œ0.0050136 secs]5115K-ï¼4756Kï¼ˆ19456Kï¼‰ï¼Œ0.0050443 secs][Timesï¼šuser=0.00 sys=0.01ï¼Œreal=0.01 secs]\n[GC[DefNew\nDesired Survivor size 524288 bytes,new threshold 15ï¼ˆmax 15ï¼‰\nï¼š4756K-ï¼0Kï¼ˆ9216Kï¼‰ï¼Œ0.0010571 secs]8852K-ï¼4756Kï¼ˆ19456Kï¼‰ï¼Œ0.0011009 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\nHeap\ndef new generation total 9216K,used 4178K[0x029d0000ï¼Œ0x033d0000ï¼Œ0x033d0000ï¼‰\neden space 8192Kï¼Œ51%used[0x029d0000ï¼Œ0x02de4828ï¼Œ0x031d0000ï¼‰\nfrom space 1024Kï¼Œ0%used[0x031d0000ï¼Œ0x031d0000ï¼Œ0x032d0000ï¼‰\nto space 1024Kï¼Œ0%used[0x032d0000ï¼Œ0x032d0000ï¼Œ0x033d0000ï¼‰\ntenured generation total 10240K,used 4756K[0x033d0000ï¼Œ0x03dd0000ï¼Œ0x03dd0000ï¼‰\nthe space 10240Kï¼Œ46%used[0x033d0000ï¼Œ0x038753e8ï¼Œ0x03875400ï¼Œ0x03dd0000ï¼‰\ncompacting perm gen total 12288K,used 2114K[0x03dd0000ï¼Œ0x049d0000ï¼Œ0x07dd0000ï¼‰\nthe space 12288Kï¼Œ17%used[0x03dd0000ï¼Œ0x03fe09a0ï¼Œ0x03fe0a00ï¼Œ0x049d0000ï¼‰\nNo shared spaces configured\n\ntestTenuringThreshold2ï¼ˆï¼‰æ–¹æ³•ï¼Œå¹¶è®¾ç½®-XXï¼šMaxTenuringThreshold=15ï¼Œä¼šå‘ç°è¿è¡Œç»“æœä¸­Survivorçš„ç©ºé—´å ç”¨ä»ç„¶ä¸º0%ï¼Œè€Œè€å¹´ä»£æ¯”é¢„æœŸå¢åŠ äº†6%ï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œallocation1ã€allocation2å¯¹è±¡éƒ½ç›´æ¥è¿›å…¥äº†è€å¹´ä»£ï¼Œè€Œæ²¡æœ‰ç­‰åˆ°15å²çš„ä¸´ç•Œå¹´é¾„ã€‚å› ä¸ºè¿™ä¸¤ä¸ªå¯¹è±¡åŠ èµ·æ¥å·²ç»åˆ°è¾¾äº†512KBï¼Œå¹¶ä¸”å®ƒä»¬æ˜¯åŒå¹´çš„ï¼Œæ»¡è¶³åŒå¹´å¯¹è±¡è¾¾åˆ°Survivorç©ºé—´çš„ä¸€åŠè§„åˆ™ã€‚æˆ‘ä»¬åªè¦æ³¨é‡Šæ‰å…¶ä¸­ä¸€ä¸ªå¯¹è±¡newæ“ä½œï¼Œå°±ä¼šå‘ç°å¦å¤–ä¸€ä¸ªå°±ä¸ä¼šæ™‹å‡åˆ°è€å¹´ä»£ä¸­å»äº†ã€‚\n</code></pre></div><h2>8.5. ç©ºé—´åˆ†é…æ‹…ä¿</h2>\n<ul>\n<li>åœ¨å‘ç”ŸMinor GCä¹‹å‰ï¼Œè™šæ‹Ÿæœºä¼šå…ˆæ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºæ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡æ€»ç©ºé—´ï¼Œå¦‚æœè¿™ä¸ªæ¡ä»¶æˆç«‹ï¼Œé‚£ä¹ˆMinor GCå¯ä»¥ç¡®ä¿æ˜¯å®‰å…¨çš„ã€‚å¦‚æœä¸æˆç«‹ï¼Œåˆ™è™šæ‹Ÿæœºä¼šæŸ¥çœ‹HandlePromotionFailureè®¾ç½®å€¼æ˜¯å¦å…è®¸æ‹…ä¿å¤±è´¥ã€‚å¦‚æœå…è®¸ï¼Œé‚£ä¹ˆä¼šç»§ç»­æ£€æŸ¥è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´æ˜¯å¦å¤§äºå†æ¬¡æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡çš„å¹³å‡å¤§å°ï¼Œå¦‚æœå¤§äºï¼Œå°†å°è¯•ç€è¿›è¡Œ<br>\nä¸€æ¬¡Minor GCï¼Œå°½ç®¡è¿™æ¬¡Minor GCæ˜¯æœ‰é£é™©çš„ï¼›å¦‚æœå°äºï¼Œæˆ–è€…HandlePromotionFailureè®¾ç½®ä¸å…è®¸å†’é™©ï¼Œé‚£è¿™æ—¶ä¹Ÿè¦æ”¹ä¸ºè¿›è¡Œä¸€æ¬¡Full GCã€‚</li>\n</ul>\n<p>ä¸‹é¢è§£é‡Šä¸€ä¸‹â€œå†’é™©â€æ˜¯å†’äº†ä»€ä¹ˆé£é™©ï¼Œå‰é¢æåˆ°è¿‡ï¼Œæ–°ç”Ÿä»£ä½¿ç”¨å¤åˆ¶æ”¶é›†ç®—æ³•ï¼Œä½†ä¸ºäº†å†…å­˜åˆ©ç”¨ç‡ï¼Œåªä½¿ç”¨å…¶ä¸­ä¸€ä¸ªSurvivorç©ºé—´æ¥ä½œä¸ºè½®æ¢å¤‡ä»½ï¼Œå› æ­¤å½“å‡ºç°å¤§é‡å¯¹è±¡åœ¨Minor GCåä»ç„¶å­˜æ´»çš„æƒ…å†µï¼ˆæœ€æç«¯çš„æƒ…å†µå°±æ˜¯å†…å­˜å›æ”¶åæ–°ç”Ÿä»£ä¸­æ‰€æœ‰å¯¹è±¡éƒ½å­˜æ´»ï¼‰ï¼Œå°±éœ€è¦è€å¹´ä»£è¿›è¡Œåˆ†é…æ‹…ä¿ï¼ŒæŠŠSurvivoræ— æ³•å®¹çº³çš„å¯¹è±¡ç›´æ¥è¿›å…¥è€å¹´ä»£ã€‚è€å¹´ä»£è¦è¿›è¡Œè¿™æ ·çš„æ‹…ä¿ï¼Œå‰ææ˜¯è€å¹´ä»£æœ¬èº«è¿˜æœ‰å®¹çº³è¿™äº›å¯¹è±¡çš„å‰©ä½™ç©ºé—´ï¼Œä¸€å…±æœ‰å¤šå°‘å¯¹è±¡ä¼šæ´»ä¸‹æ¥åœ¨å®é™…å®Œæˆå†…å­˜å›æ”¶ä¹‹å‰æ˜¯æ— æ³•æ˜ç¡®çŸ¥é“çš„ï¼Œæ‰€ä»¥åªå¥½å–ä¹‹å‰æ¯ä¸€æ¬¡å›æ”¶æ™‹å‡åˆ°è€å¹´ä»£å¯¹è±¡å®¹é‡çš„å¹³å‡å¤§å°å€¼ä½œä¸ºç»éªŒå€¼ï¼Œä¸è€å¹´ä»£çš„å‰©ä½™ç©ºé—´è¿›è¡Œæ¯”è¾ƒï¼Œå†³å®šæ˜¯å¦è¿›<br>\nè¡ŒFull GCæ¥è®©è€å¹´ä»£è…¾å‡ºæ›´å¤šç©ºé—´ã€‚å–å¹³å‡å€¼è¿›è¡Œæ¯”è¾ƒå…¶å®ä»ç„¶æ˜¯ä¸€ç§åŠ¨æ€æ¦‚ç‡çš„æ‰‹æ®µï¼Œä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœæŸæ¬¡Minor GCå­˜æ´»åçš„å¯¹è±¡çªå¢ï¼Œè¿œè¿œé«˜äºå¹³å‡å€¼çš„è¯ï¼Œä¾ç„¶ä¼šå¯¼è‡´æ‹…ä¿å¤±è´¥ï¼ˆHandle Promotion Failureï¼‰ã€‚å¦‚æœå‡ºç°äº†HandlePromotionFailureå¤±è´¥ï¼Œé‚£å°±åªå¥½åœ¨å¤±è´¥åé‡æ–°å‘èµ·ä¸€æ¬¡Full GCã€‚è™½ç„¶æ‹…ä¿å¤±è´¥æ—¶ç»•çš„åœˆå­æ˜¯æœ€å¤§çš„ï¼Œä½†å¤§éƒ¨åˆ†æƒ…å†µä¸‹éƒ½è¿˜æ˜¯ä¼šå°†HandlePromotionFailureå¼€å…³æ‰“å¼€ï¼Œé¿å…Full GCè¿‡äºé¢‘ç¹</p>\n<ul>\n<li>å‚è§ä»£ç æ¸…å•3-9ï¼Œè¯·è¯»è€…åœ¨JDK 6 Update 24ä¹‹å‰çš„ç‰ˆæœ¬ä¸­è¿è¡Œæµ‹è¯•ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static final int_1MB=1024*1024ï¼›\n/**\n*VMå‚æ•°ï¼š-Xms20M-Xmx20M-Xmn10M-XXï¼š+PrintGCDetails-XXï¼šSurvivorRatio=8-XXï¼š-HandlePromotionFailure\n*/\n@SuppressWarningsï¼ˆ\"unused\"ï¼‰\npublic static void testHandlePromotionï¼ˆï¼‰{\n  byte[]allocation1ï¼Œallocation2ï¼Œallocation3ï¼Œallocation4ï¼Œallocation5ï¼Œallocation6ï¼Œallocation7ï¼›\n  allocation1=new byte[2*_1MB]ï¼›\n  allocation2=new byte[2*_1MB]ï¼›\n  allocation3=new byte[2*_1MB]ï¼›\n  allocation1=nullï¼›\n  allocation4=new byte[2*_1MB]ï¼›\n  allocation5=new byte[2*_1MB]ï¼›\n  allocation6=new byte[2*_1MB]ï¼›\n  allocation4=nullï¼›\n  allocation5=nullï¼›\n  allocation6=nullï¼›\n  allocation7=new byte[2*_1MB]ï¼›\n}\nä»¥HandlePromotionFailure=falseå‚æ•°æ¥è¿è¡Œçš„ç»“æœï¼š\n[GC[DefNewï¼š6651K-ï¼148Kï¼ˆ9216Kï¼‰ï¼Œ0.0078936 secs]6651K-ï¼4244Kï¼ˆ19456Kï¼‰ï¼Œ0.0079192 secs][Timesï¼šuser=0.00 sys=0.02ï¼Œreal=0.02 secs]\n[G C[D e f N e wï¼š6 3 7 8 K-ï¼6 3 7 8 Kï¼ˆ9 2 1 6 Kï¼‰ï¼Œ0.0 0 0 0 2 0 6 s e c s][T e n u r e dï¼š4096K-ï¼4244Kï¼ˆ10240Kï¼‰ï¼Œ0.0042901 secs]10474K-ï¼\n4244Kï¼ˆ19456Kï¼‰ï¼Œ[Permï¼š2104K-ï¼2104Kï¼ˆ12288Kï¼‰]ï¼Œ0.0043613 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\n\nä»¥HandlePromotionFailure=trueå‚æ•°æ¥è¿è¡Œçš„ç»“æœï¼š\n[GC[DefNewï¼š6651K-ï¼148Kï¼ˆ9216Kï¼‰ï¼Œ0.0054913 secs]6651K-ï¼4244Kï¼ˆ19456Kï¼‰ï¼Œ0.0055327 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\n[GC[DefNewï¼š6378K-ï¼148Kï¼ˆ9216Kï¼‰ï¼Œ0.0006584 secs]10474K-ï¼4244Kï¼ˆ19456Kï¼‰ï¼Œ0.0006857 secs][Timesï¼šuser=0.00 sys=0.00ï¼Œreal=0.00 secs]\nåœ¨JDK 6 Update 24ä¹‹åï¼Œè¿™ä¸ªæµ‹è¯•ç»“æœä¼šæœ‰å·®å¼‚ï¼ŒHandlePromotionFailureå‚æ•°ä¸ä¼šå†å½±å“åˆ°è™šæ‹Ÿæœºçš„ç©ºé—´åˆ†é…æ‹…ä¿ç­–ç•¥ï¼Œè§‚å¯ŸOpenJDKä¸­çš„æºç å˜åŒ–ï¼ˆè§ä»£ç æ¸…å•3-10ï¼‰ï¼Œè™½ç„¶æºç ä¸­è¿˜å®šä¹‰äº†HandlePromotionFailureå‚æ•°ï¼Œä½†æ˜¯åœ¨ä»£ç ä¸­å·²ç»ä¸ä¼šå†ä½¿ç”¨å®ƒã€‚JDK 6 Update 24ä¹‹åçš„è§„åˆ™å˜ä¸ºåªè¦è€å¹´ä»£çš„è¿ç»­ç©ºé—´å¤§äºæ–°ç”Ÿä»£å¯¹è±¡æ€»å¤§å°æˆ–è€…å†æ¬¡æ™‹å‡çš„å¹³å‡å¤§å°å°±ä¼šè¿›è¡ŒMinor GCï¼Œå¦åˆ™å°†è¿›è¡ŒFull GCã€‚\n</code></pre></div><p>ä»£ç æ¸…å•3-10 HotSpotä¸­ç©ºé—´åˆ†é…æ£€æŸ¥çš„ä»£ç ç‰‡æ®µ</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>bool TenuredGenerationï¼špromotion_attempt_is_safeï¼ˆsize_t\nmax_promotion_in_bytesï¼‰const{\n//è€å¹´ä»£æœ€å¤§å¯ç”¨çš„è¿ç»­ç©ºé—´\nsize_t available=max_contiguous_availableï¼ˆï¼‰ï¼›\n//æ¯æ¬¡æ™‹å‡åˆ°è€å¹´ä»£çš„å¹³å‡å¤§å°\nsize_t av_promo=ï¼ˆsize_tï¼‰gc_statsï¼ˆï¼‰-ï¼avg_promotedï¼ˆï¼‰-ï¼padded_averageï¼ˆï¼‰ï¼›\n//è€å¹´ä»£å¯ç”¨ç©ºé—´æ˜¯å¦å¤§äºå¹³å‡æ™‹å‡å¤§å°ï¼Œæˆ–è€…è€å¹´ä»£å¯ç”¨ç©ºé—´æ˜¯å¦å¤§äºå½“æ­¤GCæ—¶æ–°ç”Ÿä»£æ‰€æœ‰å¯¹è±¡å®¹é‡\nbool res=ï¼ˆavailableï¼=av_promoï¼‰||ï¼ˆavailableï¼=\nmax_promotion_in_bytesï¼‰ï¼›\nreturn resï¼›\n}\n</code></pre></div><h1>9. è™šæ‹Ÿæœºæ€§èƒ½ç›‘æ§ä¸æ•…éšœå¤„ç†å·¥å…·</h1>\n<ul>\n<li>ç»™ä¸€ä¸ªç³»ç»Ÿå®šä½é—®é¢˜çš„æ—¶å€™ï¼ŒçŸ¥è¯†ã€ç»éªŒæ˜¯å…³é”®åŸºç¡€ï¼Œæ•°æ®æ˜¯ä¾æ®ï¼Œå·¥å…·æ˜¯è¿ç”¨çŸ¥è¯†å¤„ç†æ•°æ®çš„æ‰‹æ®µã€‚è¿™é‡Œè¯´çš„æ•°æ®åŒ…æ‹¬ï¼šè¿è¡Œæ—¥å¿—ã€å¼‚å¸¸å †æ ˆã€GCæ—¥å¿—ã€çº¿ç¨‹å¿«ç…§ï¼ˆthreaddump/javacoreæ–‡ä»¶ï¼‰ã€å †è½¬å‚¨å¿«ç…§ï¼ˆheapdump/hprofæ–‡ä»¶ï¼‰ç­‰ã€‚ç»å¸¸ä½¿ç”¨é€‚å½“çš„è™šæ‹Ÿæœºç›‘æ§å’Œåˆ†æçš„å·¥å…·å¯ä»¥åŠ å¿«æˆ‘ä»¬åˆ†ææ•°æ®ã€å®šä½è§£å†³é—®é¢˜çš„é€Ÿåº¦</li>\n</ul>\n<h2>9.1. JDKçš„å‘½ä»¤è¡Œå·¥å…·</h2>\n<ul>\n<li>å¦‚æœåœ¨å·¥ä½œä¸­éœ€è¦ç›‘æ§è¿è¡ŒäºJDK 1.5çš„è™šæ‹Ÿæœºä¹‹ä¸Šçš„ç¨‹åºï¼Œåœ¨ç¨‹åºå¯åŠ¨æ—¶è¯·æ·»åŠ å‚æ•°â€œ-Dcom.sun.management.jmxremoteâ€å¼€å¯JMXç®¡ç†åŠŸèƒ½ï¼Œå¦åˆ™ç”±äºéƒ¨åˆ†å·¥å…·éƒ½æ˜¯åŸºäºJMXï¼ˆåŒ…æ‹¬4.3èŠ‚ä»‹ç»çš„å¯è§†åŒ–å·¥å…·ï¼‰ï¼Œå®ƒä»¬éƒ½å°†ä¼šæ— æ³•ä½¿ç”¨ï¼Œå¦‚æœè¢«ç›‘æ§ç¨‹åºè¿è¡ŒäºJDK1.6çš„è™šæ‹Ÿæœºä¹‹ä¸Šï¼Œé‚£JMXç®¡ç†é»˜è®¤æ˜¯å¼€å¯çš„ï¼Œè™šæ‹Ÿæœºå¯åŠ¨æ—¶æ— é¡»å†æ·»åŠ ä»»ä½•å‚æ•°ã€‚</li>\n</ul>\n<h3>9.1.1. jpsï¼šè™šæ‹Ÿæœºè¿›ç¨‹çŠ¶å†µå·¥å…·ï¼ˆJVM Process Status Toolï¼‰</h3>\n<ul>\n<li>åˆ—å‡ºæ­£åœ¨è¿è¡Œçš„è™šæ‹Ÿæœºè¿›ç¨‹ï¼Œå¹¶æ˜¾ç¤ºè™šæ‹Ÿæœºæ‰§è¡Œä¸»ç±»ï¼ˆMain Class,main()å‡½æ•°æ‰€åœ¨çš„ç±»ï¼‰åç§°ä»¥åŠè¿™äº›è¿›ç¨‹çš„æœ¬åœ°è™šæ‹Ÿæœºå”¯ä¸€IDï¼ˆLocal Virtual Machine Identifier,LVMIDï¼‰ã€‚è™½ç„¶åŠŸèƒ½æ¯”è¾ƒå•ä¸€ï¼Œä½†å®ƒæ˜¯ä½¿ç”¨é¢‘ç‡æœ€é«˜çš„JDKå‘½ä»¤è¡Œå·¥å…·ï¼Œå› ä¸ºå…¶ä»–çš„JDKå·¥å…·å¤§å¤šéœ€è¦è¾“å…¥å®ƒæŸ¥è¯¢åˆ°çš„LVMIDæ¥ç¡®å®šè¦ç›‘æ§çš„æ˜¯å“ªä¸€ä¸ªè™šæ‹Ÿæœºè¿›ç¨‹ã€‚å¯¹äºæœ¬åœ°è™šæ‹Ÿæœºè¿›ç¨‹æ¥è¯´ï¼ŒLVMIDä¸æ“ä½œç³»ç»Ÿçš„è¿›ç¨‹IDï¼ˆProcess Identifier,PIDï¼‰æ˜¯ä¸€è‡´çš„ï¼Œä½¿ç”¨Windowsçš„ä»»åŠ¡ç®¡ç†å™¨æˆ–è€…UNIXçš„pså‘½ä»¤ä¹Ÿå¯ä»¥æŸ¥è¯¢åˆ°è™šæ‹Ÿæœºè¿›ç¨‹çš„LVMIDï¼Œä½†å¦‚æœåŒæ—¶å¯åŠ¨äº†å¤šä¸ªè™šæ‹Ÿæœºè¿›ç¨‹ï¼Œæ— æ³•æ ¹æ®è¿›ç¨‹åç§°å®šä½æ—¶ï¼Œé‚£å°±åªèƒ½ä¾èµ–jpså‘½ä»¤æ˜¾ç¤ºä¸»ç±»çš„åŠŸèƒ½æ‰èƒ½åŒºåˆ†äº†</li>\n<li>jpså¯ä»¥é€šè¿‡RMIåè®®æŸ¥è¯¢å¼€å¯äº†RMIæœåŠ¡çš„è¿œç¨‹è™šæ‹Ÿæœºè¿›ç¨‹çŠ¶æ€ï¼Œhostidä¸ºRMIæ³¨å†Œè¡¨ä¸­æ³¨å†Œçš„ä¸»æœºåã€‚</li>\n<li>jpså‘½ä»¤æ ¼å¼ï¼šjps[options][hostid]</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">é€‰é¡¹</th>\n<th style=\"text-align:left\">ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">-q</td>\n<td style=\"text-align:left\">åªè¾“å‡ºLVMID,çœç•¥ä¸»ç±»çš„åç§°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-m</td>\n<td style=\"text-align:left\">è¾“å‡ºè™šæ‹Ÿæœºè¿›ç¨‹å¯åŠ¨æ—¶ä¼ é€’ç»™ä¸»ç±»main()å‡½æ•°çš„å‚æ•°</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-l</td>\n<td style=\"text-align:left\">è¾“å‡ºä¸»ç±»çš„å…¨åï¼Œå¦‚æœè¿›ç¨‹æ‰§è¡Œçš„æ˜¯JaråŒ…ï¼Œè¾“å‡ºjarè·¯å¾„</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-v</td>\n<td style=\"text-align:left\">è¾“å‡ºè™šæ‹Ÿæœºè¿›ç¨‹å¯åŠ¨æ—¶JVMå‚æ•°</td>\n</tr>\n</tbody>\n</table>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Dï¼š\\Develop\\Java\\jdk1.6.0_21\\binï¼jps -l\n2388 Dï¼š\\Develop\\glassfish\\bin\\..\\modules\\admin-cli.jar\n2764 com.sun.enterprise.glassfish.bootstrap.ASMain\n3788 sun.tools.jps.Jps\n</code></pre></div><h3>9.1.2. jstatï¼šè™šæ‹Ÿæœºç»Ÿè®¡ä¿¡æ¯ç›‘è§†å·¥å…·ï¼ˆJVM Statistics Monitoring Toolï¼‰</h3>\n<ul>\n<li>jstatæ˜¯ç”¨äºç›‘è§†è™šæ‹Ÿæœºå„ç§è¿è¡ŒçŠ¶æ€ä¿¡æ¯çš„å‘½ä»¤è¡Œå·¥å…·ã€‚å®ƒå¯ä»¥æ˜¾ç¤ºæœ¬åœ°æˆ–è€…è¿œç¨‹[1]è™šæ‹Ÿæœºè¿›ç¨‹ä¸­çš„ç±»è£…è½½ã€å†…å­˜ã€åƒåœ¾æ”¶é›†ã€JITç¼–è¯‘ç­‰è¿è¡Œæ•°æ®ï¼Œåœ¨æ²¡æœ‰GUIå›¾å½¢ç•Œé¢ï¼Œåªæä¾›äº†çº¯æ–‡æœ¬æ§åˆ¶å°ç¯å¢ƒ</li>\n<li>jstatå‘½ä»¤æ ¼å¼ä¸ºï¼šjstat[option vmid[interval[s|ms][count]]]ã€‚å¦‚æœæ˜¯æœ¬åœ°è™šæ‹Ÿæœºè¿›ç¨‹ï¼ŒVMIDä¸LVMIDæ˜¯ä¸€è‡´çš„ï¼Œå¦‚æœæ˜¯è¿œç¨‹è™šæ‹Ÿæœºè¿›ç¨‹ï¼Œé‚£VMIDçš„æ ¼å¼åº”å½“æ˜¯ï¼š[protocolï¼š][//]lvmid[@hostname[ï¼šport]/servername]å‚æ•°intervalå’Œcountä»£è¡¨æŸ¥è¯¢é—´éš”å’Œæ¬¡æ•°ï¼Œå¦‚æœçœç•¥è¿™ä¸¤ä¸ªå‚æ•°ï¼Œè¯´æ˜åªæŸ¥è¯¢ä¸€æ¬¡ã€‚å‡è®¾éœ€è¦æ¯250æ¯«ç§’æŸ¥è¯¢ä¸€æ¬¡è¿›ç¨‹2764åƒåœ¾æ”¶é›†çŠ¶å†µï¼Œä¸€å…±æŸ¥è¯¢20æ¬¡ï¼Œé‚£å‘½ä»¤åº”å½“æ˜¯ï¼šjstat-gc 2764 250 20é€‰é¡¹optionä»£è¡¨ç€ç”¨æˆ·å¸Œæœ›æŸ¥è¯¢çš„è™šæ‹Ÿæœºä¿¡æ¯ï¼Œä¸»è¦åˆ†ä¸º3ç±»ï¼šç±»è£…è½½ã€åƒåœ¾æ”¶é›†ã€è¿è¡ŒæœŸç¼–è¯‘çŠ¶å†µï¼Œå…·ä½“é€‰é¡¹åŠä½œç”¨è¯·å‚è€ƒä¸‹é¢çš„æè¿°</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">é€‰é¡¹</th>\n<th style=\"text-align:left\">ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">-class</td>\n<td style=\"text-align:left\">ç›‘è§†ç±»è£…è½½ã€å¸è½½æ•°é‡ã€æ€»ç©ºé—´ä»¥åŠç±»è£…è½½æ‰€è€—è´¹çš„æ—¶é—´</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gc</td>\n<td style=\"text-align:left\">ç›‘è§†Javaå †çŠ¶å†µï¼ŒåŒ…æ‹¬EdenåŒºã€ä¸¤ä¸ªsurvivoråŒºã€è€å¹´ä»£ã€å…ƒç©ºé—´çš„å®¹é‡ã€å·²ç”¨ç©ºé—´ã€GCæ—¶é—´åˆè®¡ç­‰ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\"></td>\n<td style=\"text-align:left\">-gccapacity</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gcutil</td>\n<td style=\"text-align:left\">ç›‘è§†å†…å®¹ä¸-gcåŸºæœ¬ç›¸åŒï¼Œä½†è¾“å‡ºä¸»è¦å…³æ³¨å·²ä½¿ç”¨ç©ºé—´å æ€»ç©ºé—´çš„ç™¾åˆ†æ¯”</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gccause</td>\n<td style=\"text-align:left\">ä¸-gcutilåŠŸèƒ½ä¸€æ ·ï¼Œä½†æ˜¯ä¼šé¢å¤–è¾“å‡ºå¯¼è‡´ä¸Šä¸€æ¬¡GCäº§ç”Ÿçš„åŸå› </td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gcnew</td>\n<td style=\"text-align:left\">ç›‘è§†æ–°ç”Ÿä»£GCçŠ¶å†µ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gcnewcapacity</td>\n<td style=\"text-align:left\">ç›‘è§†å†…å®¹ä¸-gcnewåŸºæœ¬ç›¸åŒï¼Œè¾“å‡ºä¸»è¦å…³æ³¨ä½¿ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gcold</td>\n<td style=\"text-align:left\">ç›‘è§†è€å¹´ä»£çŠ¶å†µ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gcoldcapacity</td>\n<td style=\"text-align:left\">ç›‘è§†å†…å®¹ä¸-gcoldåŸºæœ¬ç›¸åŒï¼Œè¾“å‡ºä¸»è¦å…³æ³¨ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-gcmetacapacity</td>\n<td style=\"text-align:left\">è¾“å‡ºå…ƒæ•°æ®ç”¨åˆ°çš„æœ€å¤§ã€æœ€å°ç©ºé—´</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-compiler</td>\n<td style=\"text-align:left\">è¾“å‡ºJITç¼–è¯‘å™¨ç¼–è¯‘è¿‡çš„æ–¹æ³•ã€è€—æ—¶ç­‰ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-printcompilation</td>\n<td style=\"text-align:left\">è¾“å‡ºå·²ç»è¢«JITç¼–è¯‘çš„æ–¹æ³•</td>\n</tr>\n</tbody>\n</table>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>jstatæ‰§è¡Œæ ·ä¾‹\nDï¼š\\Develop\\Java\\jdk1.6.0_21\\binï¼jstat-gcutil 2764\nS0 S1 E O P YGC YGCT FGC FGCT GCT\n0.00 0.00 6.20 41.42 47.20 16 0.105 3 0.472 0.577\næŸ¥è¯¢ç»“æœè¡¨æ˜ï¼šè¿™å°æœåŠ¡å™¨çš„æ–°ç”Ÿä»£EdenåŒºï¼ˆEï¼Œè¡¨ç¤ºEdenï¼‰ä½¿ç”¨äº†6.2%çš„ç©ºé—´ï¼Œä¸¤ä¸ªSurvivoråŒºï¼ˆS0ã€S1ï¼Œè¡¨ç¤ºSurvivor0ã€Survivor1ï¼‰é‡Œé¢éƒ½æ˜¯ç©ºçš„ï¼Œè€å¹´ä»£ï¼ˆOï¼Œè¡¨ç¤ºOldï¼‰å’Œæ°¸ä¹…ä»£ï¼ˆPï¼Œè¡¨ç¤ºPermanentï¼‰åˆ™åˆ†åˆ«ä½¿ç”¨äº†41.42%å’Œ47.20%çš„ç©ºé—´ã€‚ç¨‹åºè¿è¡Œä»¥æ¥å…±å‘ç”ŸMinor GCï¼ˆYGCï¼Œè¡¨ç¤ºYoung GCï¼‰16æ¬¡ï¼Œæ€»è€—æ—¶0.105ç§’ï¼Œå‘ç”ŸFull GCï¼ˆFGCï¼Œè¡¨ç¤ºFull GCï¼‰3æ¬¡ï¼ŒFull GCæ€»è€—æ—¶ï¼ˆFGCTï¼Œè¡¨ç¤ºFull GC Timeï¼‰ä¸º0.472ç§’ï¼Œæ‰€æœ‰GCæ€»è€—æ—¶ï¼ˆGCTï¼Œè¡¨ç¤ºGC Timeï¼‰ä¸º0.577ç§’ã€‚\n</code></pre></div><h3>9.1.3. jinfoï¼šJavaé…ç½®ä¿¡æ¯å·¥å…·ï¼ˆConfiguration Info for Javaï¼‰</h3>\n<ul>\n<li>å®æ—¶åœ°æŸ¥çœ‹å’Œè°ƒæ•´è™šæ‹Ÿæœºå„é¡¹å‚æ•°ã€‚åŒ…æ‹¬æœªè¢«æ˜¾å¼æŒ‡å®šçš„å‚æ•°çš„ç³»ç»Ÿé»˜è®¤å€¼ï¼Œå°±åªèƒ½ä½¿ç”¨jinfoçš„-flagé€‰é¡¹è¿›è¡ŒæŸ¥è¯¢äº†ï¼ˆå¦‚æœåªé™äºJDK 1.6æˆ–ä»¥ä¸Šç‰ˆæœ¬çš„è¯ï¼Œä½¿ç”¨java-XXï¼š+PrintFlagsFinalæŸ¥çœ‹å‚æ•°é»˜è®¤å€¼ä¹Ÿæ˜¯ä¸€ä¸ªå¾ˆå¥½çš„é€‰æ‹©ï¼‰ï¼Œjinfoè¿˜å¯ä»¥ä½¿ç”¨-syspropsé€‰é¡¹æŠŠè™šæ‹Ÿæœºè¿›ç¨‹çš„System.getPropertiesï¼ˆï¼‰çš„å†…å®¹æ‰“å°å‡ºæ¥ã€‚è¿™ä¸ªå‘½ä»¤åœ¨JDK 1.5æ—¶æœŸå·²ç»éšç€Linuxç‰ˆçš„JDKå‘å¸ƒï¼Œå½“æ—¶åªæä¾›äº†ä¿¡æ¯æŸ¥è¯¢çš„åŠŸèƒ½ï¼ŒJDK 1.6ä¹‹åï¼Œjinfoåœ¨Windowså’ŒLinuxå¹³å°éƒ½æœ‰æä¾›ï¼Œå¹¶ä¸”åŠ å…¥äº†è¿è¡ŒæœŸä¿®æ”¹å‚æ•°çš„èƒ½åŠ›ï¼Œå¯ä»¥ä½¿ç”¨-flag[+|-]nameæˆ–è€…-flag name=valueä¿®æ”¹ä¸€éƒ¨åˆ†è¿è¡ŒæœŸå¯å†™çš„è™šæ‹Ÿæœºå‚æ•°å€¼ã€‚JDK 1.6ä¸­ï¼Œjinfoå¯¹äºWindowså¹³å°åŠŸèƒ½ä»ç„¶æœ‰è¾ƒå¤§é™åˆ¶ï¼Œåªæä¾›äº†æœ€åŸºæœ¬çš„-flagé€‰é¡¹ã€‚</li>\n<li>jinfoå‘½ä»¤æ ¼å¼ï¼šjinfo[option]pid</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ‰§è¡Œæ ·ä¾‹ï¼šæŸ¥è¯¢CMSInitiatingOccupancyFractionå‚æ•°å€¼ã€‚\nCï¼š\\ï¼jinfo-flag CMSInitiatingOccupancyFraction 1444\n-XXï¼šCMSInitiatingOccupancyFraction=85\n</code></pre></div><h3>9.1.4. jmapï¼šJavaå†…å­˜æ˜ åƒå·¥å…·ï¼ˆMemory Map for Javaï¼‰</h3>\n<ul>\n<li>ç”¨äºç”Ÿæˆå †è½¬å‚¨å¿«ç…§ï¼ˆä¸€èˆ¬ç§°ä¸ºheapdumpæˆ–dumpæ–‡ä»¶ï¼‰ã€‚ä¹Ÿå¯ä»¥æ·»åŠ å‚æ•°-XXï¼š+HeapDumpOnOutOfMemoryErrorï¼Œå¯ä»¥è®©è™šæ‹Ÿæœºåœ¨OOMå¼‚å¸¸å‡ºç°ä¹‹åè‡ªåŠ¨ç”Ÿæˆdumpæ–‡ä»¶ï¼Œé€šè¿‡-XXï¼š+HeapDumpOnCtrlBreakå‚æ•°åˆ™å¯ä»¥ä½¿ç”¨[Ctrl]+[Break]<br>\né”®è®©è™šæ‹Ÿæœºç”Ÿæˆdumpæ–‡ä»¶ï¼Œåˆæˆ–è€…åœ¨Linuxç³»ç»Ÿä¸‹é€šè¿‡Kill-3å‘½ä»¤å‘é€è¿›ç¨‹é€€å‡ºä¿¡å·ç»™è™šæ‹Ÿæœºï¼Œä¹Ÿèƒ½æ‹¿åˆ°dumpæ–‡ä»¶ã€‚</li>\n<li>æŸ¥è¯¢finalizeæ‰§è¡Œé˜Ÿåˆ—ã€Javaå †å’Œæ°¸ä¹…ä»£çš„è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ç©ºé—´ä½¿ç”¨ç‡ã€å½“å‰ç”¨çš„æ˜¯å“ªç§æ”¶é›†å™¨ç­‰ã€‚</li>\n<li>jmapæœ‰ä¸å°‘åŠŸèƒ½åœ¨Windowså¹³å°ä¸‹éƒ½æ˜¯å—é™çš„ï¼Œé™¤äº†ç”Ÿæˆdumpæ–‡ä»¶çš„\u0002dumpé€‰é¡¹å’Œç”¨äºæŸ¥çœ‹æ¯ä¸ªç±»çš„å®ä¾‹ã€ç©ºé—´å ç”¨ç»Ÿè®¡çš„-histoé€‰é¡¹åœ¨æ‰€æœ‰æ“ä½œç³»ç»Ÿéƒ½æä¾›ä¹‹å¤–ï¼Œå…¶ä½™é€‰é¡¹éƒ½åªèƒ½åœ¨Linux/Solarisä¸‹ä½¿ç”¨ã€‚</li>\n<li>jmapå‘½ä»¤æ ¼å¼ï¼šjmap[option]vmid</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>|é€‰é¡¹|ä½œç”¨|\n|:-|:-|\n|-dump|\tç”Ÿæˆjavaå †å¿«ç…§,æ ¼å¼ä¸º:-dump[live,]format=b,file=&lt;filename&gt;,å…¶ä¸­liveå­å‚æ•°è¯´æ˜æ˜¯å¦åªdumpå‡ºå­˜æ´»çš„å¯¹è±¡|\n|-finalizerinfo|æ˜¾ç¤ºåœ¨F-Queueä¸­ç­‰å¾…Finalizerçº¿ç¨‹æ‰§è¡Œfinalizeæ–¹æ³•çš„å¯¹è±¡,åªèƒ½åœ¨Linux/Solarisä¸‹æœ‰æ•ˆ|\n|-heap|æ˜¾ç¤ºjavaå †è¯¦ç»†ä¿¡æ¯ï¼Œå¦‚ä½¿ç”¨å“ªç§å›æ”¶å™¨ã€å‚æ•°é…ç½®ã€åˆ†ä»£æƒ…å†µç­‰,åªèƒ½åœ¨Linux/Solarisä¸‹æœ‰æ•ˆ|\n|-histo|æ˜¾ç¤ºå †ä¸­å¯¹è±¡ç»Ÿè®¡ä¿¡æ¯ï¼ŒåŒ…æ‹¬ç±»ã€å®ä¾‹æ•°é‡ã€åˆè®¡å®¹é‡|\n|permstat|ä»¥ClassLoaderä¸ºç»Ÿè®¡å£å¾„æ˜¾ç¤ºæ°¸ä¹…ä»£å†…å­˜çŠ¶æ€,åªèƒ½åœ¨Linux/Solarisä¸‹æœ‰æ•ˆ|\n|-F|å¼ºåˆ¶ç”Ÿæˆå¿«ç…§,åªèƒ½åœ¨Linux/Solarisä¸‹æœ‰æ•ˆ|\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Cï¼š\\Users\\IcyFenixï¼jmap-dumpï¼šformat=b,file=eclipse.bin 3500\nDumping heap to Cï¼š\\Users\\IcyFenix\\eclipse.binâ€¦â€¦\nHeap dump file created\n</code></pre></div><h3>9.1.5. jhatï¼šè™šæ‹Ÿæœºå †è½¬å‚¨å¿«ç…§åˆ†æå·¥å…·ï¼ˆJVM Heap Analysis Toolï¼‰</h3>\n<ul>\n<li>ä¸jmapæ­é…ä½¿ç”¨ï¼Œæ¥åˆ†æjmapç”Ÿæˆçš„å †è½¬å‚¨å¿«ç…§ã€‚jhatå†…ç½®äº†ä¸€ä¸ªå¾®å‹çš„HTTP/HTMLæœåŠ¡å™¨ï¼Œç”Ÿæˆdumpæ–‡ä»¶çš„åˆ†æç»“æœåï¼Œå¯ä»¥åœ¨æµè§ˆå™¨ä¸­æŸ¥çœ‹ã€‚ä½†ä¸€èˆ¬éƒ½ä¸ä¼šå»ç›´æ¥ä½¿ç”¨jhatå‘½ä»¤æ¥åˆ†ædumpæ–‡ä»¶ï¼Œä¸»è¦åŸå› æœ‰äºŒï¼šä¸€æ˜¯ä¸€èˆ¬ä¸ä¼šåœ¨éƒ¨ç½²åº”ç”¨ç¨‹åºçš„æœåŠ¡å™¨ä¸Šç›´æ¥åˆ†ædumpæ–‡ä»¶ï¼Œå³ä½¿å¯ä»¥è¿™æ ·åšï¼Œä¹Ÿä¼šå°½é‡å°†dumpæ–‡ä»¶å¤åˆ¶åˆ°å…¶ä»–æœºå™¨ä¸Šè¿›è¡Œåˆ†æï¼Œå› ä¸ºåˆ†æå·¥ä½œæ˜¯ä¸€ä¸ªè€—æ—¶è€Œä¸”æ¶ˆè€—ç¡¬ä»¶èµ„æºçš„è¿‡ç¨‹ï¼Œæ—¢ç„¶éƒ½è¦åœ¨å…¶ä»–æœºå™¨è¿›è¡Œï¼Œå°±æ²¡æœ‰å¿…è¦å—åˆ°å‘½ä»¤è¡Œå·¥å…·çš„é™åˆ¶äº†ï¼›å¦ä¸€ä¸ªåŸå› æ˜¯jhatçš„åˆ†æåŠŸèƒ½ç›¸å¯¹æ¥è¯´æ¯”è¾ƒç®€é™‹ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä½¿ç”¨jhatåˆ†ædumpæ–‡ä»¶\nCï¼š\\Users\\IcyFenixï¼jhat eclipse.bin\nReading from eclipse.binâ€¦â€¦\nDump file created Fri Nov 19 22ï¼š07ï¼š21 CST 2010\nSnapshot read,resolvingâ€¦â€¦\nResolving 1225951 objectsâ€¦â€¦\nChasing references,expect 245 dotsâ€¦â€¦\nEliminating duplicate referencesâ€¦â€¦\nSnapshot resolved.\nStarted HTTP server on port 7000\nServer is ready.\nå±å¹•æ˜¾ç¤ºâ€œServer is ready.â€çš„æç¤ºåï¼Œç”¨æˆ·åœ¨æµè§ˆå™¨ä¸­é”®å…¥http://localhostï¼š7000/å°±å¯ä»¥çœ‹åˆ°åˆ†æç»“æœ\nåˆ†æç»“æœé»˜è®¤æ˜¯ä»¥åŒ…ä¸ºå•ä½è¿›è¡Œåˆ†ç»„æ˜¾ç¤ºï¼Œåˆ†æå†…å­˜æ³„æ¼é—®é¢˜ä¸»è¦ä¼šä½¿ç”¨åˆ°å…¶ä¸­çš„â€œHeap Histogramâ€ï¼ˆä¸jmap-histoåŠŸèƒ½ä¸€æ ·ï¼‰ä¸OQLé¡µç­¾çš„åŠŸèƒ½ï¼Œå‰è€…å¯ä»¥æ‰¾åˆ°å†…å­˜ä¸­æ€»å®¹é‡æœ€å¤§çš„å¯¹è±¡ï¼Œåè€…æ˜¯æ ‡å‡†çš„å¯¹è±¡æŸ¥è¯¢è¯­è¨€ï¼Œä½¿ç”¨ç±»ä¼¼SQLçš„è¯­æ³•å¯¹å†…å­˜ä¸­çš„å¯¹è±¡è¿›è¡ŒæŸ¥è¯¢ç»Ÿè®¡\n</code></pre></div><h3>9.1.6. jstackï¼šJavaå †æ ˆè·Ÿè¸ªå·¥å…·ï¼ˆStack Trace for Javaï¼‰</h3>\n<ul>\n<li>ç”¨äºç”Ÿæˆè™šæ‹Ÿæœºå½“å‰æ—¶åˆ»çš„çº¿ç¨‹å¿«ç…§ï¼ˆä¸€èˆ¬ç§°ä¸ºthreaddumpæˆ–è€…javacoreæ–‡ä»¶ï¼‰ã€‚çº¿ç¨‹å¿«ç…§å°±æ˜¯å½“å‰è™šæ‹Ÿæœºå†…æ¯ä¸€æ¡çº¿ç¨‹æ­£åœ¨æ‰§è¡Œçš„æ–¹æ³•å †æ ˆçš„é›†åˆï¼Œç”Ÿæˆçº¿ç¨‹å¿«ç…§çš„ä¸»è¦ç›®çš„æ˜¯å®šä½çº¿ç¨‹å‡ºç°é•¿æ—¶é—´åœé¡¿çš„åŸå› ï¼Œå¦‚çº¿ç¨‹é—´æ­»é”ã€æ­»å¾ªç¯ã€è¯·æ±‚å¤–éƒ¨èµ„æºå¯¼è‡´çš„é•¿æ—¶é—´ç­‰å¾…ç­‰éƒ½æ˜¯å¯¼è‡´çº¿ç¨‹é•¿æ—¶é—´åœé¡¿çš„å¸¸è§åŸå› ã€‚çº¿ç¨‹å‡ºç°åœé¡¿çš„æ—¶å€™é€šè¿‡jstackæ¥æŸ¥çœ‹å„ä¸ªçº¿ç¨‹çš„è°ƒç”¨å †æ ˆï¼Œå°±å¯ä»¥çŸ¥é“æ²¡æœ‰å“åº”çš„çº¿ç¨‹åˆ°åº•åœ¨åå°åšäº›ä»€ä¹ˆäº‹æƒ…ï¼Œæˆ–è€…ç­‰å¾…ç€ä»€ä¹ˆèµ„æºã€‚</li>\n<li>jstackå‘½ä»¤æ ¼å¼ï¼šjstack[option]vmid</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:left\">é€‰é¡¹</th>\n<th style=\"text-align:left\">ä½œç”¨</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:left\">-F</td>\n<td style=\"text-align:left\">å½“æ­£å¸¸è¾“å‡ºè¯·æ±‚ä¸è¢«å“åº”æ—¶ï¼Œå¼ºåˆ¶è¾“å‡ºçº¿ç¨‹å †æ ˆ</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-l</td>\n<td style=\"text-align:left\">é™¤å †æ ˆå¤–ï¼Œæ˜¾ç¤ºå…³äºé”çš„é™„åŠ ä¿¡æ¯</td>\n</tr>\n<tr>\n<td style=\"text-align:left\">-m</td>\n<td style=\"text-align:left\">å¦‚æœè°ƒç”¨åˆ°æœ¬åœ°æ–¹æ³•çš„è¯ï¼Œå¯ä»¥æ˜¾ç¤ºC/C++çš„å †æ ˆ</td>\n</tr>\n</tbody>\n</table>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Cï¼š\\Users\\IcyFenixï¼jstack-l 3500\n2010-11-19 23ï¼š11ï¼š26\nFull thread dump Java HotSpotï¼ˆTMï¼‰64-Bit Server VMï¼ˆ17.1-b03 mixed modeï¼‰ï¼š\n\"[ThreadPool Manager]-Idle Thread\"daemon prio=6 tid=0x0000000039dd4000 nid=0xf50 in Object.waitï¼ˆï¼‰[0x000000003c96f000]\njava.lang.Thread.Stateï¼šWAITINGï¼ˆon object monitorï¼‰\nat java.lang.Object.waitï¼ˆNative Methodï¼‰\n-waiting onï¼œ0x0000000016bdcc60ï¼ï¼ˆa org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executorï¼‰\nat java.lang.Object.waitï¼ˆObject.javaï¼š485ï¼‰\nat org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executor.runï¼ˆExecutor.javaï¼š106ï¼‰\n-lockedï¼œ0x0000000016bdcc60ï¼ï¼ˆa org.eclipse.equinox.internal.util.impl.tpt.threadpool.Executorï¼‰\nLocked ownable synchronizersï¼š\n-None\n</code></pre></div><ul>\n<li>åœ¨JDK 1.5ä¸­ï¼Œjava.lang.Threadç±»æ–°å¢äº†ä¸€ä¸ªgetAllStackTracesï¼ˆï¼‰æ–¹æ³•ç”¨äºè·å–è™šæ‹Ÿæœºä¸­æ‰€æœ‰çº¿ç¨‹çš„StackTraceElementå¯¹è±¡ã€‚ä½¿ç”¨è¿™ä¸ªæ–¹æ³•å¯ä»¥é€šè¿‡ç®€å•çš„å‡ è¡Œä»£ç å°±å®Œæˆjstackçš„å¤§éƒ¨åˆ†åŠŸèƒ½ï¼Œåœ¨å®é™…é¡¹ç›®ä¸­ä¸å¦¨è°ƒç”¨è¿™ä¸ªæ–¹æ³•åšä¸ªç®¡ç†å‘˜é¡µé¢ï¼Œå¯ä»¥éšæ—¶ä½¿ç”¨æµè§ˆå™¨æ¥æŸ¥çœ‹çº¿ç¨‹å †æ ˆ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æŸ¥çœ‹çº¿ç¨‹çŠ¶å†µçš„JSPé¡µé¢\nï¼œ%@page import=\"java.util.Map\"%ï¼\nï¼œhtmlï¼\nï¼œheadï¼\nï¼œtitleï¼æœåŠ¡å™¨çº¿ç¨‹ä¿¡æ¯ï¼œ/titleï¼\nï¼œ/headï¼\nï¼œbodyï¼\nï¼œpreï¼\nï¼œ%\nforï¼ˆMap.Entryï¼œThread,StackTraceElement[]ï¼stackTraceï¼šThread.\ngetAllStackTracesï¼ˆï¼‰.entrySetï¼ˆï¼‰ï¼‰{\nThread thread=ï¼ˆThreadï¼‰stackTrace.getKeyï¼ˆï¼‰ï¼›\nStackTraceElement[]stack=ï¼ˆStackTraceElement[]ï¼‰stackTrace.getValueï¼ˆï¼‰ï¼›\nifï¼ˆthread.equalsï¼ˆThread.currentThreadï¼ˆï¼‰ï¼‰ï¼‰{\ncontinueï¼›\n}\nout.printï¼ˆ\"\\nçº¿ç¨‹ï¼š\"+thread.getNameï¼ˆï¼‰+\"\\n\"ï¼‰ï¼›\nforï¼ˆStackTraceElement elementï¼šstackï¼‰{\nout.printï¼ˆ\"\\t\"+element+\"\\n\"ï¼‰ï¼›\n}\n}\n%ï¼\nï¼œ/preï¼\nï¼œ/bodyï¼\nï¼œ/htmlï¼\n\n</code></pre></div><h2>9.2. HSDISï¼šJITç”Ÿæˆä»£ç åæ±‡ç¼–</h2>\n<ul>\n<li>HSDISæ˜¯ä¸€ä¸ªSunå®˜æ–¹æ¨èçš„HotSpotè™šæ‹ŸæœºJITç¼–è¯‘ä»£ç çš„åæ±‡ç¼–æ’ä»¶ï¼Œå®ƒåŒ…å«åœ¨HotSpotè™šæ‹Ÿæœºçš„æºç ä¹‹ä¸­ï¼Œä½†æ²¡æœ‰æä¾›ç¼–è¯‘åçš„ç¨‹åºã€‚åœ¨Project Kenaiçš„ç½‘ç«™[1]ä¹Ÿå¯ä»¥ä¸‹è½½åˆ°å•ç‹¬çš„æºç ã€‚å®ƒçš„ä½œç”¨æ˜¯è®©HotSpotçš„-XXï¼š+PrintAssemblyæŒ‡ä»¤è°ƒç”¨å®ƒæ¥æŠŠåŠ¨æ€ç”Ÿæˆçš„æœ¬åœ°ä»£ç è¿˜åŸä¸ºæ±‡ç¼–ä»£ç è¾“å‡ºï¼ŒåŒæ—¶è¿˜ç”Ÿæˆäº†å¤§é‡éå¸¸æœ‰ä»·å€¼çš„æ³¨é‡Šï¼Œè¿™æ ·æˆ‘ä»¬å°±å¯ä»¥é€šè¿‡è¾“å‡ºçš„ä»£ç æ¥åˆ†æé—®é¢˜ã€‚å¯ä»¥æ ¹æ®è‡ªå·±çš„æ“ä½œç³»ç»Ÿå’ŒCPUç±»å‹ä»Project Kenaiçš„ç½‘ç«™ä¸Šä¸‹è½½ç¼–è¯‘å¥½çš„æ’ä»¶ï¼Œç›´æ¥æ”¾åˆ°JDK_HOME/jre/bin/clientå’ŒJDK_HOME/jre/bin/serverç›®å½•ä¸­å³å¯ã€‚å¦‚æœæ²¡æœ‰æ‰¾åˆ°æ‰€éœ€æ“ä½œç³»ç»Ÿï¼ˆè­¬å¦‚Windowsçš„å°±æ²¡æœ‰ï¼‰çš„æˆå“ï¼Œé‚£å°±å¾—è‡ªå·±ä½¿ç”¨æºç ç¼–è¯‘ä¸€ä¸‹[2]ã€‚è¿˜éœ€è¦æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœè¯»è€…ä½¿ç”¨çš„æ˜¯Debugæˆ–è€…FastDebugç‰ˆçš„HotSpotï¼Œé‚£å¯ä»¥ç›´æ¥é€šè¿‡-XXï¼š+PrintAssemblyæŒ‡ä»¤ä½¿ç”¨æ’ä»¶ï¼›å¦‚æœä½¿ç”¨çš„æ˜¯Productç‰ˆçš„HotSpotï¼Œé‚£è¿˜è¦é¢å¤–åŠ å…¥<br>\nä¸€ä¸ª-XXï¼š+UnlockDiagnosticVMOptionså‚æ•°ã€‚ç¬”è€…ä»¥ä»£ç æ¸…å•4-6ä¸­çš„ç®€å•æµ‹è¯•ä»£ç ä¸ºä¾‹æ¼”ç¤ºä¸€ä¸‹è¿™ä¸ªæ’ä»¶çš„ä½¿ç”¨ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Bar{\n  int a=1ï¼›\n  static int b=2ï¼›\n  public int sumï¼ˆint cï¼‰{\n    return a+b+cï¼›\n  }\n  public static void mainï¼ˆString[]argsï¼‰{\n    new Barï¼ˆï¼‰.sumï¼ˆ3ï¼‰ï¼›\n  }\n}\nç¼–è¯‘è¿™æ®µä»£ç ï¼Œå¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æ‰§è¡Œã€‚\njava-XXï¼š+PrintAssembly-Xcomp-XXï¼šCompileCommand=dontinlineï¼Œ*Bar.sum-XXï¼šCompi leCommand=compileonlyï¼Œ*Bar.sum test.Bar\n\nå‚æ•°-Xcompæ˜¯è®©è™šæ‹Ÿæœºä»¥ç¼–è¯‘æ¨¡å¼æ‰§è¡Œä»£ç ï¼Œä¸éœ€è¦æ‰§è¡Œè¶³å¤Ÿæ¬¡æ•°æ¥é¢„çƒ­å°±èƒ½è§¦å‘JITç¼–è¯‘ã€‚ä¸¤ä¸ª-XXï¼šCompileCommandæ„æ€æ˜¯è®©ç¼–è¯‘å™¨ä¸è¦å†…è”sumï¼ˆï¼‰å¹¶ä¸”åªç¼–è¯‘sumï¼ˆï¼‰ï¼Œ-XXï¼š+PrintAssemblyå°±æ˜¯è¾“å‡ºåæ±‡ç¼–å†…å®¹ã€‚\n[Disassembling for mach='i386']\n[Entry Point]\n[Constants]\n#{method}'sum''ï¼ˆIï¼‰I'in'test/Bar'\n#thisï¼šecx='test/Bar'\n#parm0ï¼šedx=int\n#[sp+0x20]ï¼ˆsp of callerï¼‰\nâ€¦â€¦\n0x01cac407ï¼šcmp 0x4ï¼ˆ%ecxï¼‰ï¼Œ%eax\n0x01cac40aï¼šjne 0x01c6b050ï¼›{runtime_call}\n[Verified Entry Point]\n0x01cac410ï¼šmov%eaxï¼Œ-0x8000ï¼ˆ%espï¼‰ //æ£€æŸ¥æ ˆæº¢ã€‚\n0x01cac417ï¼špush%ebp //ä¿å­˜ä¸Šä¸€æ ˆå¸§åŸºå€ã€‚\n0x01cac418ï¼šsub$0x18ï¼Œ%espï¼›*aload_0 ï¼›-test.Barï¼šsum@0ï¼ˆline 8ï¼‰//sub$0x18ï¼Œ%espï¼šç»™æ–°å¸§åˆ†é…ç©ºé—´\nï¼›block B0[0ï¼Œ10]\n0x01cac41bï¼šmov 0x8ï¼ˆ%ecxï¼‰ï¼Œ%eaxï¼›*getfield a ï¼›-test.Barï¼šsum@1ï¼ˆline 8ï¼‰//mov 0x8ï¼ˆ%ecxï¼‰ï¼Œ%eaxï¼šå–å®ä¾‹å˜é‡aï¼Œè¿™é‡Œ0x8ï¼ˆ%ecxï¼‰å°±æ˜¯ecx+0x8çš„æ„æ€ï¼Œå‰é¢â€œ[Constants]â€èŠ‚ä¸­æç¤ºäº†â€œthisï¼šecx='test/Bar'â€ï¼Œå³ecxå¯„å­˜å™¨ä¸­æ”¾çš„å°±æ˜¯thiså¯¹è±¡çš„åœ°å€ã€‚åç§»0x8æ˜¯è¶Šè¿‡thiså¯¹è±¡çš„å¯¹è±¡å¤´ï¼Œä¹‹åå°±æ˜¯å®ä¾‹å˜é‡açš„å†…å­˜ä½ç½®ã€‚è¿™æ¬¡æ˜¯è®¿é—®â€œJavaå †â€ä¸­çš„æ•°æ®\n0x01cac41eï¼šmov$0x3d2fad8ï¼Œ%esiï¼›{oopï¼ˆa\n'java/lang/Class'='test/Bar'ï¼‰}//mov$0x3d2fad8ï¼Œ%esiï¼šå–test.Baråœ¨æ–¹æ³•åŒºçš„æŒ‡é’ˆã€‚\n0x01cac423ï¼šmov 0x68ï¼ˆ%esiï¼‰ï¼Œ%esiï¼›*getstatic b ï¼›-test.Barï¼šsum@4ï¼ˆline 8ï¼‰//mov 0x68ï¼ˆ%esiï¼‰ï¼Œ%esiï¼šå–ç±»å˜é‡bï¼Œè¿™æ¬¡æ˜¯è®¿é—®â€œæ–¹æ³•åŒºâ€ä¸­çš„æ•°æ®ã€‚\n0x01cac426ï¼šadd%esiï¼Œ%eax //add%esiï¼Œ%eaxå’Œadd%edxï¼Œ%eaxï¼šåšä¸¤æ¬¡åŠ æ³•ï¼Œæ±‚a+b+cçš„å€¼ï¼Œå‰é¢çš„ä»£ç æŠŠaæ”¾åœ¨\neaxä¸­ï¼ŒæŠŠbæ”¾åœ¨esiä¸­ï¼Œè€Œcåœ¨[Constants]ä¸­æç¤ºäº†ï¼Œâ€œparm0ï¼šedx=intâ€ï¼Œè¯´æ˜cåœ¨edxä¸­ã€‚\n0x01cac428ï¼šadd%edxï¼Œ%eax //add$0x18ï¼Œ%espï¼šæ’¤é”€æ ˆå¸§ã€‚\n0x01cac42aï¼šadd$0x18ï¼Œ%esp //pop%ebpï¼šæ¢å¤ä¸Šä¸€æ ˆå¸§ã€‚\n0x01cac42dï¼špop%ebp\n0x01cac42eï¼štest%eaxï¼Œ0x2b0100ï¼›{poll_return} //test%eaxï¼Œ0x2b0100ï¼šè½®è¯¢æ–¹æ³•è¿”å›å¤„çš„SafePointã€‚\n0x01cac434ï¼šret //retï¼šæ–¹æ³•è¿”å›ã€‚\n\n</code></pre></div><h1>10. JDKçš„å¯è§†åŒ–å·¥å…·</h1>\n<h2>10.1. JConsoleï¼šJavaç›‘è§†ä¸ç®¡ç†æ§åˆ¶å°</h2>\n<ul>\n<li>JConsoleï¼ˆJava Monitoring and Management Consoleï¼‰æ˜¯ä¸€ç§åŸºäºJMXçš„å¯è§†åŒ–ç›‘è§†ã€ç®¡ç†å·¥å…·ã€‚å®ƒç®¡ç†éƒ¨åˆ†çš„åŠŸèƒ½æ˜¯é’ˆå¯¹JMX MBeanè¿›è¡Œç®¡ç†ï¼Œç”±äºMBeanå¯ä»¥ä½¿ç”¨ä»£ç ã€ä¸­é—´ä»¶æœåŠ¡å™¨çš„ç®¡ç†æ§åˆ¶å°æˆ–è€…æ‰€æœ‰ç¬¦åˆJMXè§„èŒƒçš„è½¯ä»¶è¿›è¡Œè®¿é—®.</li>\n<li>å¯åŠ¨JConsole:é€šè¿‡JDK/binç›®å½•ä¸‹çš„â€œjconsole.exeâ€å¯åŠ¨JConsoleåï¼Œå°†è‡ªåŠ¨æœç´¢å‡ºæœ¬æœºè¿è¡Œçš„æ‰€æœ‰è™šæ‹Ÿ<br>\næœºè¿›ç¨‹ï¼Œä¸éœ€è¦ç”¨æˆ·è‡ªå·±å†ä½¿ç”¨jpsæ¥æŸ¥è¯¢äº†ï¼Œå¦‚å›¾4-4æ‰€ç¤ºã€‚åŒå‡»é€‰æ‹©å…¶ä¸­ä¸€ä¸ªè¿›ç¨‹å³å¯å¼€<br>\nå§‹ç›‘æ§ï¼Œä¹Ÿå¯ä»¥ä½¿ç”¨ä¸‹é¢çš„â€œè¿œç¨‹è¿›ç¨‹â€åŠŸèƒ½æ¥è¿æ¥è¿œç¨‹æœåŠ¡å™¨ï¼Œå¯¹è¿œç¨‹è™šæ‹Ÿæœºè¿›è¡Œç›‘æ§ã€‚</li>\n<li>â€œæ¦‚è¿°â€é¡µç­¾æ˜¾ç¤ºçš„æ˜¯æ•´ä¸ªè™šæ‹Ÿæœºä¸»è¦è¿è¡Œæ•°æ®çš„æ¦‚è§ˆï¼Œå…¶ä¸­åŒ…æ‹¬â€œå †å†…å­˜ä½¿ç”¨æƒ…å†µâ€ã€â€œçº¿ç¨‹â€ã€â€œç±»â€ã€â€œCPUä½¿ç”¨æƒ…å†µâ€4ç§ä¿¡æ¯çš„æ›²çº¿å›¾ï¼Œè¿™äº›æ›²çº¿å›¾æ˜¯åé¢â€œå†…å­˜â€ã€â€œçº¿ç¨‹â€ã€â€œç±»â€é¡µç­¾çš„ä¿¡æ¯æ±‡æ€»</li>\n<li>â€œå†…å­˜â€é¡µç­¾ç›¸å½“äºå¯è§†åŒ–çš„jstatå‘½ä»¤ï¼Œç”¨äºç›‘è§†å—æ”¶é›†å™¨ç®¡ç†çš„è™šæ‹Ÿæœºå†…å­˜ï¼ˆJavaå †å’Œæ°¸ä¹…ä»£ï¼‰çš„å˜åŒ–è¶‹åŠ¿ã€‚</li>\n<li>è¿è¡Œæ—¶è®¾ç½®çš„è™šæ‹Ÿæœºå‚æ•°ä¸ºï¼š-Xms100m-Xmx100m-XXï¼š+UseSerialGCï¼Œè¿™æ®µä»£ç çš„ä½œç”¨æ˜¯ä»¥64KB/50æ¯«ç§’çš„é€Ÿåº¦å¾€Javaå †ä¸­å¡«å……æ•°æ®ï¼Œä¸€å…±å¡«å……1000æ¬¡ï¼Œä½¿ç”¨JConsoleçš„â€œå†…å­˜â€é¡µç­¾è¿›è¡Œç›‘è§†ï¼Œè§‚å¯Ÿæ›²çº¿å’ŒæŸ±çŠ¶æŒ‡ç¤ºå›¾çš„å˜åŒ–ã€‚ç¨‹åºè¿è¡Œåï¼Œåœ¨â€œå†…å­˜â€é¡µç­¾ä¸­å¯ä»¥çœ‹åˆ°å†…å­˜æ± EdenåŒºçš„è¿è¡Œè¶‹åŠ¿å‘ˆç°æŠ˜çº¿çŠ¶ï¼Œè€Œç›‘è§†èŒƒå›´æ‰©å¤§è‡³æ•´ä¸ªå †åï¼Œä¼šå‘ç°æ›²çº¿æ˜¯ä¸€æ¡å‘ä¸Šå¢é•¿çš„å¹³æ»‘æ›²çº¿ã€‚å¹¶ä¸”ä»æŸ±çŠ¶å›¾å¯ä»¥çœ‹å‡ºï¼Œåœ¨1000æ¬¡å¾ªç¯æ‰§è¡Œç»“æŸï¼Œè¿è¡Œäº†System.gcï¼ˆï¼‰åï¼Œè™½ç„¶æ•´ä¸ªæ–°ç”Ÿä»£Edenå’ŒSurvivoråŒºéƒ½åŸºæœ¬è¢«æ¸…ç©ºäº†ï¼Œä½†æ˜¯ä»£è¡¨è€å¹´ä»£çš„æŸ±çŠ¶å›¾ä»ç„¶ä¿æŒå³°å€¼çŠ¶æ€ï¼Œè¯´æ˜è¢«å¡«å……è¿›å †ä¸­çš„æ•°æ®åœ¨System.gcï¼ˆï¼‰æ–¹æ³•æ‰§è¡Œä¹‹åä»ç„¶å­˜æ´»ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /**\n     *å†…å­˜å ä½ç¬¦å¯¹è±¡ï¼Œä¸€ä¸ªOOMObjectå¤§çº¦å 64KB\n     */\n    static class OOMObject{\n        public byte[]placeholder=new byte[64*1024];\n    }\n    public static void fillHeap(int num)throws InterruptedException{\n        List&lt;OOMObject&gt; list = new ArrayList&lt;OOMObject&gt;();\n        for(int i=0;i&lt;num;i++){\n            //ç¨ä½œå»¶æ—¶ï¼Œä»¤ç›‘è§†æ›²çº¿çš„å˜åŒ–æ›´åŠ æ˜æ˜¾\n            Thread.sleep(50);\n            list.add(new OOMObject());\n        }\n        System.gc();\n    }\n    public static void main(String[]args)throws Exception{\n        fillHeap(1000);\n    }\n</code></pre></div><ul>\n<li>\n<p>è™šæ‹Ÿæœºå¯åŠ¨å‚æ•°åªé™åˆ¶äº†Javaå †ä¸º100MBï¼Œæ²¡æœ‰æŒ‡å®š-Xmnå‚æ•°ï¼Œèƒ½å¦ä»ç›‘æ§å›¾ä¸­ä¼°<br>\nè®¡å‡ºæ–°ç”Ÿä»£æœ‰å¤šå¤§ï¼Ÿæ˜¾ç¤ºEdenç©ºé—´ä¸º27 328KBï¼Œå› ä¸ºæ²¡æœ‰è®¾ç½®-XXï¼šSurvivorRadioå‚æ•°ï¼Œæ‰€ä»¥Edenä¸Survivorç©ºé—´æ¯”ä¾‹ä¸ºé»˜è®¤å€¼8:1ï¼Œæ•´ä¸ªæ–°ç”Ÿä»£ç©ºé—´å¤§çº¦ä¸º27 328KBÃ—125%=34160KBã€‚</p>\n</li>\n<li>\n<p>ä¸ºä½•æ‰§è¡Œäº†System.gcï¼ˆï¼‰ä¹‹åï¼Œå›¾4-6ä¸­ä»£è¡¨è€å¹´ä»£çš„æŸ±çŠ¶å›¾ä»ç„¶æ˜¾ç¤ºå³°å€¼çŠ¶æ€ï¼Œä»£<br>\nç éœ€è¦å¦‚ä½•è°ƒæ•´æ‰èƒ½è®©System.gcï¼ˆï¼‰å›æ”¶æ‰å¡«å……åˆ°å †ä¸­çš„å¯¹è±¡ï¼Ÿæ‰§è¡Œå®ŒSystem.gcï¼ˆï¼‰ä¹‹åï¼Œç©ºé—´æœªèƒ½å›æ”¶æ˜¯å› ä¸ºListï¼œOOMObjectï¼listå¯¹è±¡ä»ç„¶å­˜æ´»ï¼ŒfillHeapï¼ˆï¼‰æ–¹æ³•ä»ç„¶æ²¡æœ‰é€€å‡ºï¼Œå› æ­¤listå¯¹è±¡åœ¨System.gcï¼ˆï¼‰æ‰§è¡Œæ—¶ä»ç„¶å¤„äºä½œç”¨åŸŸä¹‹å†…ã€‚å¦‚æœæŠŠSystem.gcï¼ˆï¼‰ç§»åŠ¨åˆ°fillHeapï¼ˆï¼‰æ–¹æ³•å¤–è°ƒç”¨å°±å¯ä»¥å›æ”¶æ‰å…¨éƒ¨å†…å­˜ã€‚</p>\n</li>\n<li>\n<p>â€œçº¿ç¨‹â€é¡µç­¾çš„åŠŸèƒ½ç›¸å½“äºå¯è§†åŒ–çš„jstackå‘½ä»¤ï¼Œé‡åˆ°çº¿ç¨‹åœé¡¿æ—¶å¯ä»¥ä½¿ç”¨è¿™ä¸ªé¡µç­¾è¿›è¡Œç›‘æ§åˆ†æã€‚çº¿ç¨‹é•¿æ—¶é—´åœé¡¿çš„ä¸»è¦åŸå› ä¸»è¦æœ‰ï¼šç­‰å¾…å¤–éƒ¨èµ„æºï¼ˆæ•°æ®åº“è¿æ¥ã€ç½‘ç»œèµ„æºã€è®¾å¤‡èµ„æºç­‰ï¼‰ã€æ­»å¾ªç¯ã€é”ç­‰å¾…ï¼ˆæ´»é”å’Œæ­»é”ï¼‰ã€‚</p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n     *çº¿ç¨‹æ­»å¾ªç¯æ¼”ç¤º\n     */\n    public static void createBusyThread(){\n        Thread thread=new Thread(new Runnable(){\n            @Override\n            public void run(){\n                while(true)//ç¬¬41è¡Œ\n  ;\n            }\n        },\"testBusyThread\");\n        thread.start();\n    }\n    /**\n     *çº¿ç¨‹é”ç­‰å¾…æ¼”ç¤º\n     */\n    public static void createLockThread(final Object lock){\n        Thread thread=new Thread(new Runnable(){\n            @Override\n            public void run(){\n                synchronized(lock){\n                    try{\n                        lock.wait();\n                    }catch(InterruptedException e){\n                        e.printStackTrace();\n                    }\n                }\n            }\n        },\"testLockThread\");\n        thread.start();\n    }\n    public static void main(String[]args)throws Exception{\n        BufferedReader br=new BufferedReader(new InputStreamReader(System.in));\n        br.readLine();\n        createBusyThread();\n        br.readLine();\n        Object obj=new Object();\n        createLockThread(obj);\n    }\n\n</code></pre></div><ul>\n<li>\n<p>â€œçº¿ç¨‹â€é¡µç­¾ä¸­é€‰æ‹©mainçº¿ç¨‹ï¼Œå¦‚å›¾4-7æ‰€ç¤ºã€‚å †æ ˆè¿½è¸ªæ˜¾ç¤ºBufferedReaderåœ¨readBytesæ–¹æ³•ä¸­ç­‰å¾…System.inçš„é”®ç›˜è¾“å…¥ï¼Œè¿™æ—¶çº¿ç¨‹ä¸ºRunnableçŠ¶æ€ï¼ŒRunnableçŠ¶æ€çš„çº¿ç¨‹ä¼šè¢«åˆ†é…è¿è¡Œæ—¶é—´ï¼Œä½†readBytesæ–¹æ³•æ£€æŸ¥åˆ°æµæ²¡æœ‰æ›´æ–°æ—¶ä¼šç«‹åˆ»å½’è¿˜æ‰§è¡Œä»¤ç‰Œï¼Œè¿™ç§ç­‰å¾…åªæ¶ˆè€—å¾ˆå°çš„CPUèµ„æºã€‚</p>\n</li>\n<li>\n<p>æ¥ç€ç›‘æ§testBusyThreadçº¿ç¨‹ï¼Œå¦‚å›¾4-8æ‰€ç¤ºï¼ŒtestBusyThreadçº¿ç¨‹ä¸€ç›´åœ¨æ‰§è¡Œç©ºå¾ªç¯ï¼Œä»å †æ ˆè¿½è¸ªä¸­çœ‹åˆ°ä¸€ç›´åœ¨MonitoringTest.javaä»£ç çš„41è¡Œåœç•™ï¼Œ41è¡Œä¸ºï¼šwhileï¼ˆtrueï¼‰ã€‚è¿™æ—¶å€™çº¿ç¨‹ä¸ºRunnableçŠ¶æ€ï¼Œè€Œä¸”æ²¡æœ‰å½’è¿˜çº¿ç¨‹æ‰§è¡Œä»¤ç‰Œçš„åŠ¨ä½œï¼Œä¼šåœ¨ç©ºå¾ªç¯ä¸Šç”¨å°½å…¨éƒ¨æ‰§è¡Œæ—¶é—´ç›´åˆ°çº¿ç¨‹åˆ‡æ¢ï¼Œè¿™ç§ç­‰å¾…ä¼šæ¶ˆè€—è¾ƒå¤šçš„CPUèµ„æºã€‚</p>\n</li>\n<li>\n<p>testLockThreadçº¿ç¨‹åœ¨ç­‰å¾…ç€lockå¯¹è±¡çš„notifyæˆ–notifyAllæ–¹æ³•çš„å‡ºç°ï¼Œçº¿ç¨‹è¿™æ—¶å€™å¤„äºWAITINGçŠ¶æ€ï¼Œåœ¨è¢«å”¤é†’å‰ä¸ä¼šè¢«åˆ†é…æ‰§è¡Œæ—¶é—´ã€‚testLockThreadçº¿ç¨‹æ­£åœ¨å¤„äºæ­£å¸¸çš„æ´»é”ç­‰å¾…ï¼Œåªè¦lockå¯¹è±¡çš„notifyï¼ˆï¼‰æˆ–notifyAllï¼ˆï¼‰<br>\næ–¹æ³•è¢«è°ƒç”¨ï¼Œè¿™ä¸ªçº¿ç¨‹ä¾¿èƒ½æ¿€æ´»ä»¥ç»§ç»­æ‰§è¡Œã€‚</p>\n</li>\n<li>\n<p>æ­»é”ä»£ç æ ·ä¾‹</p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/**\n*çº¿ç¨‹æ­»é”ç­‰å¾…æ¼”ç¤º\n*/\nstatic class SynAddRunalbe implements Runnable{\n  int a,bï¼›\n  public SynAddRunalbeï¼ˆint a,int bï¼‰{\n    this.a=aï¼›\n    this.b=bï¼›\n  }\n  @Override\n  public void runï¼ˆï¼‰{\n    synchronizedï¼ˆInteger.valueOfï¼ˆaï¼‰ï¼‰{\n      synchronizedï¼ˆInteger.valueOfï¼ˆbï¼‰ï¼‰{\n      System.out.printlnï¼ˆa+bï¼‰ï¼›\n      }\n    }\n  }\n  }\n  public static void mainï¼ˆString[]argsï¼‰{\n    forï¼ˆint i=0ï¼›iï¼œ100ï¼›i++ï¼‰{\n    new Threadï¼ˆnew SynAddRunalbeï¼ˆ1ï¼Œ2ï¼‰ï¼‰.startï¼ˆï¼‰ï¼›\n    new Threadï¼ˆnew SynAddRunalbeï¼ˆ2ï¼Œ1ï¼‰ï¼‰.startï¼ˆï¼‰ï¼›\n  }\n}\n</code></pre></div><ul>\n<li>å¼€äº†200ä¸ªçº¿ç¨‹å»åˆ†åˆ«è®¡ç®—1+2ä»¥åŠ2+1çš„å€¼ï¼Œå…¶å®forå¾ªç¯æ˜¯å¯çœç•¥çš„ï¼Œä¸¤ä¸ªçº¿ç¨‹ä¹Ÿå¯èƒ½ä¼šå¯¼è‡´æ­»é”ï¼Œä¸è¿‡é‚£æ ·æ¦‚ç‡å¤ªå°ï¼Œéœ€è¦å°è¯•è¿è¡Œå¾ˆå¤šæ¬¡æ‰èƒ½çœ‹åˆ°æ•ˆæœã€‚ä¸€èˆ¬çš„è¯ï¼Œå¸¦forå¾ªç¯çš„ç‰ˆæœ¬æœ€å¤šè¿è¡Œ2ï½3æ¬¡å°±ä¼šé‡åˆ°çº¿ç¨‹æ­»é”ï¼Œç¨‹åºæ— æ³•ç»“æŸã€‚é€ æˆæ­»é”çš„åŸå› æ˜¯Integer.valueOfï¼ˆï¼‰æ–¹æ³•åŸºäºå‡å°‘å¯¹è±¡åˆ›å»ºæ¬¡æ•°å’ŒèŠ‚çœå†…å­˜çš„è€ƒè™‘ï¼Œ[-128ï¼Œ127]ä¹‹é—´çš„æ•°å­—ä¼šè¢«ç¼“å­˜[3]ï¼Œå½“valueOfï¼ˆï¼‰æ–¹æ³•ä¼ å…¥å‚æ•°åœ¨è¿™ä¸ªèŒƒå›´ä¹‹å†…ï¼Œå°†ç›´æ¥è¿”å›ç¼“å­˜ä¸­çš„å¯¹è±¡ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œä»£ç ä¸­è°ƒç”¨äº†200æ¬¡Integer.valueOfï¼ˆï¼‰æ–¹æ³•ä¸€å…±å°±åªè¿”å›äº†ä¸¤ä¸ªä¸åŒçš„å¯¹è±¡ã€‚å‡å¦‚åœ¨æŸä¸ªçº¿ç¨‹çš„ä¸¤ä¸ªsynchronizedå—ä¹‹é—´å‘ç”Ÿäº†ä¸€æ¬¡çº¿ç¨‹åˆ‡æ¢ï¼Œé‚£å°±ä¼šå‡ºç°çº¿ç¨‹Aç­‰ç€è¢«çº¿ç¨‹BæŒæœ‰çš„Integer.valueOfï¼ˆ1ï¼‰ï¼Œçº¿ç¨‹Båˆç­‰ç€è¢«çº¿ç¨‹AæŒæœ‰çš„Integer.valueOfï¼ˆ2ï¼‰ï¼Œç»“æœå‡ºç°å¤§å®¶éƒ½è·‘ä¸ä¸‹å»çš„æƒ…æ™¯ã€‚å‡ºç°çº¿ç¨‹æ­»é”ä¹‹åï¼Œç‚¹å‡»JConsoleçº¿ç¨‹é¢æ¿çš„â€œæ£€æµ‹åˆ°æ­»é”â€æŒ‰é’®ï¼Œå°†å‡ºç°ä¸€ä¸ªæ–°çš„â€œæ­»é”â€é¡µç­¾ï¼Œçº¿ç¨‹Thread-43åœ¨ç­‰å¾…ä¸€ä¸ªè¢«çº¿ç¨‹Thread-12æŒæœ‰Integerå¯¹è±¡ï¼Œè€Œç‚¹å‡»çº¿ç¨‹Thread-12åˆ™æ˜¾ç¤ºå®ƒä¹Ÿåœ¨ç­‰å¾…ä¸€ä¸ªIntegerå¯¹è±¡ï¼Œè¢«çº¿ç¨‹Thread-43æŒæœ‰ï¼Œè¿™æ ·ä¸¤ä¸ªçº¿ç¨‹å°±äº’ç›¸å¡ä½ï¼Œéƒ½ä¸å­˜åœ¨ç­‰åˆ°é”é‡Šæ”¾çš„å¸Œæœ›äº†ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ce75d2edba93bb5f498a6.png\" alt=\"çº¿ç¨‹æ­»é”.png\"></li>\n</ul>\n<h2>10.2. VisualVMï¼šå¤šåˆä¸€æ•…éšœå¤„ç†å·¥å…·</h2>\n<ul>\n<li>VisualVMï¼ˆAll-in-One Java Troubleshooting Toolï¼‰æ˜¯éšJDKå‘å¸ƒçš„åŠŸèƒ½æœ€å¼ºå¤§çš„è¿è¡Œç›‘è§†å’Œæ•…éšœå¤„ç†ç¨‹åºï¼Œå®˜æ–¹åœ¨VisualVMçš„è½¯ä»¶è¯´æ˜ä¸­å†™ä¸Šäº†â€œAll-in-Oneâ€çš„æè¿°å­—æ ·ï¼Œé¢„ç¤ºç€å®ƒé™¤äº†è¿è¡Œç›‘è§†ã€æ•…éšœå¤„ç†å¤–ï¼Œè¿˜æä¾›äº†å¾ˆå¤šå…¶ä»–æ–¹é¢çš„åŠŸèƒ½ã€‚å¦‚æ€§èƒ½åˆ†æï¼ˆProfilingï¼‰ï¼ŒVisualVMçš„ä¸éœ€è¦è¢«ç›‘è§†çš„ç¨‹åºåŸºäºç‰¹æ®ŠAgentè¿è¡Œï¼Œå› æ­¤å®ƒå¯¹åº”ç”¨ç¨‹åºçš„å®é™…æ€§èƒ½çš„å½±å“å¾ˆå°ï¼Œä½¿å¾—å®ƒå¯ä»¥ç›´æ¥åº”ç”¨åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ã€‚</li>\n<li>æ’ä»¶å®‰è£…ï¼šé€šè¿‡æ’ä»¶æ‰©å±•æ”¯æŒï¼ŒVisualVMå¯ä»¥åšåˆ°ï¼š\n<ul>\n<li>æ˜¾ç¤ºè™šæ‹Ÿæœºè¿›ç¨‹ä»¥åŠè¿›ç¨‹çš„é…ç½®ã€ç¯å¢ƒä¿¡æ¯ï¼ˆjpsã€jinfoï¼‰ã€‚</li>\n<li>ç›‘è§†åº”ç”¨ç¨‹åºçš„CPUã€GCã€å †ã€æ–¹æ³•åŒºä»¥åŠçº¿ç¨‹çš„ä¿¡æ¯ï¼ˆjstatã€jstackï¼‰ã€‚</li>\n<li>dumpä»¥åŠåˆ†æå †è½¬å‚¨å¿«ç…§ï¼ˆjmapã€jhatï¼‰ã€‚</li>\n<li>æ–¹æ³•çº§çš„ç¨‹åºè¿è¡Œæ€§èƒ½åˆ†æï¼Œæ‰¾å‡ºè¢«è°ƒç”¨æœ€å¤šã€è¿è¡Œæ—¶é—´æœ€é•¿çš„æ–¹æ³•ã€‚</li>\n<li>ç¦»çº¿ç¨‹åºå¿«ç…§ï¼šæ”¶é›†ç¨‹åºçš„è¿è¡Œæ—¶é…ç½®ã€çº¿ç¨‹dumpã€å†…å­˜dumpç­‰ä¿¡æ¯å»ºç«‹ä¸€ä¸ªå¿«ç…§ï¼Œå¯ä»¥å°†å¿«ç…§å‘é€å¼€å‘è€…å¤„è¿›è¡ŒBugåé¦ˆ</li>\n<li>å…¶ä»–pluginsçš„æ— é™çš„å¯èƒ½æ€§â€¦â€¦</li>\n</ul>\n</li>\n<li>ä½¿ç”¨VisualVMçš„è‡ªåŠ¨å®‰è£…åŠŸèƒ½å·²ç»å¯ä»¥æ‰¾åˆ°å¤§å¤šæ•°æ‰€éœ€çš„æ’ä»¶ï¼Œåœ¨æœ‰ç½‘ç»œè¿æ¥çš„ç¯å¢ƒä¸‹ï¼Œç‚¹å‡»â€œå·¥å…·â€â†’â€œæ’ä»¶èœå•â€ï¼Œåœ¨é¡µç­¾çš„â€œå¯ç”¨æ’ä»¶â€ä¸­åˆ—ä¸¾äº†å½“å‰ç‰ˆæœ¬VisualVMå¯ä»¥ä½¿ç”¨çš„æ’ä»¶ï¼Œé€‰ä¸­æ’ä»¶ååœ¨å³è¾¹çª—å£å°†æ˜¾ç¤ºè¿™ä¸ªæ’ä»¶çš„åŸºæœ¬ä¿¡æ¯ï¼Œå¦‚å¼€å‘è€…ã€ç‰ˆæœ¬ã€åŠŸèƒ½æè¿°ç­‰ã€‚</li>\n<li>ç”Ÿæˆã€æµè§ˆå †è½¬å‚¨å¿«ç…§.åœ¨VisualVMä¸­ç”Ÿæˆdumpæ–‡ä»¶æœ‰ä¸¤ç§æ–¹å¼ï¼Œå¯ä»¥æ‰§è¡Œä¸‹åˆ—ä»»ä¸€æ“ä½œï¼š\n<ul>\n<li>åœ¨â€œåº”ç”¨ç¨‹åºâ€çª—å£ä¸­å³é”®å•å‡»åº”ç”¨ç¨‹åºèŠ‚ç‚¹ï¼Œç„¶åé€‰æ‹©â€œå †Dumpâ€ã€‚</li>\n<li>åœ¨â€œåº”ç”¨ç¨‹åºâ€çª—å£ä¸­åŒå‡»åº”ç”¨ç¨‹åºèŠ‚ç‚¹ä»¥æ‰“å¼€åº”ç”¨ç¨‹åºæ ‡ç­¾ï¼Œç„¶ååœ¨â€œç›‘è§†â€æ ‡ç­¾ä¸­å•å‡»â€œå †Dumpâ€ã€‚ç”Ÿæˆäº†dumpæ–‡ä»¶ä¹‹åï¼Œåº”ç”¨ç¨‹åºé¡µç­¾å°†åœ¨è¯¥å †çš„åº”ç”¨ç¨‹åºä¸‹å¢åŠ ä¸€ä¸ªä»¥[heapdump]å¼€å¤´çš„å­èŠ‚ç‚¹ï¼Œå¹¶ä¸”åœ¨ä¸»é¡µç­¾ä¸­æ‰“å¼€äº†è¯¥è½¬å‚¨å¿«ç…§ï¼Œå¦‚å›¾4-14æ‰€ç¤ºã€‚å¦‚æœéœ€è¦æŠŠdumpæ–‡ä»¶ä¿å­˜æˆ–å‘é€å‡ºå»ï¼Œè¦åœ¨heapdumpèŠ‚ç‚¹ä¸Šå³é”®é€‰æ‹©â€œå¦å­˜ä¸ºâ€èœå•ï¼Œå¦åˆ™å½“VisualVMå…³é—­æ—¶ï¼Œç”Ÿæˆçš„dumpæ–‡ä»¶ä¼šè¢«å½“åšä¸´æ—¶æ–‡ä»¶åˆ é™¤æ‰ã€‚è¦æ‰“å¼€ä¸€ä¸ªå·²ç»å­˜åœ¨çš„dumpæ–‡ä»¶ï¼Œé€šè¿‡æ–‡ä»¶èœå•ä¸­çš„â€œè£…å…¥â€åŠŸèƒ½ï¼Œé€‰æ‹©ç¡¬ç›˜ä¸Šçš„dumpæ–‡ä»¶å³å¯ã€‚</li>\n</ul>\n</li>\n<li>ä»å †é¡µç­¾ä¸­çš„â€œæ‘˜è¦â€é¢æ¿å¯ä»¥çœ‹åˆ°åº”ç”¨ç¨‹åºdumpæ—¶çš„è¿è¡Œæ—¶å‚æ•°ã€System.getPropertiesï¼ˆï¼‰çš„å†…å®¹ã€çº¿ç¨‹å †æ ˆç­‰ä¿¡æ¯ï¼Œâ€œç±»â€é¢æ¿åˆ™æ˜¯ä»¥ç±»ä¸ºç»Ÿè®¡å£å¾„ç»Ÿè®¡ç±»çš„å®ä¾‹æ•°é‡ã€å®¹é‡ä¿¡æ¯ï¼Œâ€œå®ä¾‹â€é¢æ¿ä¸èƒ½ç›´æ¥ä½¿ç”¨ï¼Œå› ä¸ºä¸èƒ½ç¡®å®šç”¨æˆ·æƒ³æŸ¥çœ‹å“ªä¸ªç±»çš„å®ä¾‹ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡â€œç±»â€é¢æ¿è¿›å…¥ï¼Œåœ¨â€œç±»â€ä¸­é€‰æ‹©ä¸€ä¸ªå…³å¿ƒçš„ç±»ååŒå‡»é¼ æ ‡ï¼Œå³å¯åœ¨â€œå®ä¾‹â€é‡Œé¢çœ‹è§æ­¤ç±»ä¸­500ä¸ªå®ä¾‹çš„å…·ä½“å±æ€§ä¿¡æ¯ã€‚â€œOQLæ§åˆ¶å°â€é¢æ¿ä¸­å°±æ˜¯è¿è¡ŒOQLæŸ¥è¯¢è¯­å¥çš„ï¼ŒåŒjhatä¸­ä»‹ç»çš„OQLåŠŸèƒ½ä¸€æ ·ã€‚</li>\n<li>åˆ†æç¨‹åºæ€§èƒ½,åœ¨Profileré¡µç­¾ä¸­ï¼ŒVisualVMæä¾›äº†ç¨‹åºè¿è¡ŒæœŸé—´æ–¹æ³•çº§çš„CPUæ‰§è¡Œæ—¶é—´åˆ†æä»¥åŠå†…å­˜åˆ†æï¼ŒåšProfilingåˆ†æè‚¯å®šä¼šå¯¹ç¨‹åºè¿è¡Œæ€§èƒ½æœ‰æ¯”è¾ƒå¤§çš„å½±å“ï¼Œæ‰€ä»¥ä¸€èˆ¬ä¸åœ¨ç”Ÿäº§ç¯å¢ƒä¸­ä½¿ç”¨è¿™é¡¹åŠŸèƒ½ã€‚è¦å¼€å§‹åˆ†æï¼Œå…ˆé€‰æ‹©â€œCPUâ€å’Œâ€œå†…å­˜â€æŒ‰é’®ä¸­çš„ä¸€ä¸ªï¼Œç„¶ååˆ‡æ¢åˆ°åº”ç”¨ç¨‹åºä¸­å¯¹ç¨‹åºè¿›è¡Œæ“ä½œï¼ŒVisualVMä¼šè®°å½•åˆ°è¿™æ®µæ—¶é—´ä¸­åº”ç”¨ç¨‹åºæ‰§è¡Œè¿‡çš„æ–¹æ³•ã€‚å¦‚æœæ˜¯CPUåˆ†æï¼Œå°†ä¼šç»Ÿè®¡æ¯ä¸ªæ–¹æ³•çš„æ‰§è¡Œæ¬¡æ•°ã€æ‰§è¡Œè€—æ—¶ï¼›å¦‚æœæ˜¯å†…å­˜åˆ†æï¼Œåˆ™ä¼šç»Ÿè®¡æ¯ä¸ªæ–¹æ³•å…³è”çš„å¯¹è±¡æ•°ä»¥åŠè¿™äº›å¯¹è±¡æ‰€å çš„ç©ºé—´ã€‚åˆ†æç»“æŸåï¼Œç‚¹å‡»â€œåœæ­¢â€æŒ‰é’®ç»“æŸç›‘æ§è¿‡ç¨‹ï¼Œ</li>\n<li>åœ¨JDK 1.5ä¹‹åï¼Œåœ¨Clientæ¨¡å¼ä¸‹çš„è™šæ‹ŸæœºåŠ å…¥å¹¶ä¸”è‡ªåŠ¨å¼€å¯äº†ç±»å…±äº«â€”â€”è¿™æ˜¯ä¸€ä¸ªåœ¨å¤šè™šæ‹Ÿæœºè¿›ç¨‹ä¸­å…±äº«rt.jarä¸­ç±»æ•°æ®ä»¥æé«˜åŠ è½½é€Ÿåº¦å’ŒèŠ‚çœå†…å­˜çš„ä¼˜åŒ–ï¼Œè€Œæ ¹æ®ç›¸å…³BugæŠ¥å‘Šçš„åæ˜ ï¼ŒVisualVMçš„ProfileråŠŸèƒ½å¯èƒ½ä¼šå› ä¸ºç±»å…±äº«è€Œå¯¼è‡´è¢«ç›‘è§†çš„åº”ç”¨ç¨‹åºå´©æºƒï¼Œæ‰€ä»¥è¯»è€…è¿›è¡ŒProfilingå‰ï¼Œæœ€å¥½åœ¨è¢«ç›‘è§†ç¨‹åºä¸­ä½¿ç”¨-Xshareï¼šoffå‚æ•°æ¥å…³é—­ç±»å…±äº«ä¼˜åŒ–ã€‚</li>\n<li>BTraceåŠ¨æ€æ—¥å¿—è·Ÿè¸ª,æ˜¯ä¸€ä¸ªVisualVMæ’ä»¶ï¼Œæœ¬èº«ä¹Ÿæ˜¯å¯ä»¥ç‹¬ç«‹è¿è¡Œçš„ç¨‹åºã€‚å®ƒçš„ä½œç”¨æ˜¯åœ¨ä¸åœæ­¢ç›®æ ‡ç¨‹åºè¿è¡Œçš„å‰æä¸‹ï¼Œé€šè¿‡HotSpotè™šæ‹Ÿæœºçš„HotSwapæŠ€æœ¯åŠ¨æ€åŠ å…¥åŸæœ¬å¹¶ä¸å­˜åœ¨çš„è°ƒè¯•ä»£ç ã€‚è¿™é¡¹åŠŸèƒ½å¯¹å®é™…ç”Ÿäº§ä¸­çš„ç¨‹åºå¾ˆæœ‰æ„ä¹‰ï¼šç»å¸¸é‡åˆ°ç¨‹åºå‡ºç°é—®é¢˜ï¼Œä½†æ’æŸ¥é”™è¯¯çš„ä¸€äº›å¿…è¦ä¿¡æ¯ï¼Œè­¬å¦‚æ–¹æ³•å‚æ•°ã€è¿”å›å€¼ç­‰ï¼Œåœ¨å¼€å‘æ—¶å¹¶æ²¡æœ‰æ‰“å°åˆ°æ—¥å¿—ä¹‹ä¸­ï¼Œä»¥è‡³äºä¸å¾—ä¸åœæ‰æœåŠ¡ï¼Œé€šè¿‡è°ƒè¯•å¢é‡æ¥åŠ å…¥æ—¥å¿—ä»£ç ä»¥è§£å†³é—®é¢˜ã€‚å½“é‡åˆ°ç”Ÿäº§ç¯å¢ƒæœåŠ¡æ— æ³•éšä¾¿åœæ­¢æ—¶ï¼Œç¼ºä¸€ä¸¤å¥æ—¥å¿—å¯¼è‡´æ’é”™è¿›è¡Œä¸ä¸‹å»æ˜¯ä¸€ä»¶éå¸¸éƒé—·çš„äº‹æƒ…ã€‚åœ¨VisualVMä¸­å®‰è£…äº†BTraceæ’ä»¶åï¼Œåœ¨åº”ç”¨ç¨‹åºé¢æ¿ä¸­å³é”®ç‚¹å‡»è¦è°ƒè¯•çš„ç¨‹åºï¼Œä¼šå‡ºç°â€œTrace Applicationâ€¦â€¦â€èœå•ï¼Œç‚¹å‡»å°†è¿›å…¥BTraceé¢æ¿ã€‚è¿™ä¸ªé¢æ¿é‡Œé¢çœ‹èµ·æ¥å°±åƒä¸€ä¸ªç®€å•çš„Javaç¨‹åºå¼€å‘ç¯å¢ƒï¼Œé‡Œé¢è¿˜æœ‰ä¸€å°æ®µJavaä»£ç .BTraceçš„ç”¨æ³•è¿˜æœ‰è®¸å¤šï¼Œæ‰“å°è°ƒç”¨å †æ ˆã€å‚æ•°ã€è¿”å›å€¼åªæ˜¯æœ€åŸºæœ¬çš„åº”ç”¨ï¼Œåœ¨å®ƒçš„ç½‘ç«™ä¸Šæœ‰ä½¿ç”¨BTraceè¿›è¡Œæ€§èƒ½ç›‘è§†ã€å®šä½è¿æ¥æ³„æ¼å’Œå†…å­˜æ³„æ¼ã€è§£å†³å¤šçº¿ç¨‹ç«äº‰é—®é¢˜</li>\n</ul>\n<h1>11. è°ƒä¼˜æ¡ˆä¾‹åˆ†æä¸å®æˆ˜</h1>\n<h2>11.1. é«˜æ€§èƒ½ç¡¬ä»¶ä¸Šçš„ç¨‹åºéƒ¨ç½²ç­–ç•¥</h2>\n<ul>\n<li>ç®¡ç†å‘˜ä¸ºäº†å°½é‡åˆ©ç”¨ç¡¬ä»¶èµ„æºé€‰ç”¨äº†64ä½çš„JDK 1.5ï¼Œå¹¶é€šè¿‡-Xmxå’Œ-Xmså‚æ•°å°†Javaå †å›ºå®šåœ¨12GBã€‚ä½¿ç”¨ä¸€æ®µæ—¶é—´åå‘ç°ä½¿ç”¨æ•ˆæœå¹¶ä¸ç†æƒ³ï¼Œç½‘ç«™ç»å¸¸ä¸å®šæœŸå‡ºç°é•¿æ—¶é—´å¤±å»å“åº”çš„æƒ…å†µã€‚ç›‘æ§æœåŠ¡å™¨è¿è¡ŒçŠ¶å†µåå‘ç°ç½‘ç«™å¤±å»å“åº”æ˜¯ç”±GCåœé¡¿å¯¼è‡´çš„ï¼Œè™šæ‹Ÿæœºè¿è¡Œåœ¨Serveræ¨¡å¼ï¼Œé»˜è®¤ä½¿ç”¨ååé‡ä¼˜å…ˆæ”¶é›†å™¨ï¼Œå›æ”¶12GBçš„å †ï¼Œä¸€æ¬¡Full GCçš„åœé¡¿æ—¶é—´é«˜è¾¾14ç§’ã€‚å¹¶ä¸”ç”±äºç¨‹åºè®¾è®¡çš„å…³ç³»ï¼Œè®¿é—®æ–‡æ¡£æ—¶è¦æŠŠæ–‡æ¡£ä»ç£ç›˜æå–åˆ°å†…å­˜ä¸­ï¼Œå¯¼è‡´å†…å­˜ä¸­å‡ºç°å¾ˆå¤šç”±æ–‡æ¡£åºåˆ—åŒ–äº§ç”Ÿçš„å¤§å¯¹è±¡ï¼Œè¿™äº›å¤§å¯¹è±¡å¾ˆå¤šéƒ½è¿›å…¥äº†è€å¹´ä»£ï¼Œæ²¡æœ‰åœ¨Minor GCä¸­æ¸…ç†æ‰ã€‚è¿™ç§æƒ…å†µä¸‹å³ä½¿æœ‰12GBçš„å †ï¼Œå†…å­˜ä¹Ÿå¾ˆå¿«è¢«æ¶ˆè€—æ®†å°½ï¼Œç”±æ­¤å¯¼è‡´æ¯éš”åå‡ åˆ†é’Ÿå‡ºç°åå‡ ç§’çš„åœé¡¿</li>\n<li>ç¨‹åºéƒ¨ç½²ä¸Šçš„ä¸»è¦é—®é¢˜æ˜¾ç„¶æ˜¯è¿‡å¤§çš„å †å†…å­˜è¿›è¡Œå›æ”¶æ—¶å¸¦æ¥çš„é•¿æ—¶é—´çš„åœé¡¿ã€‚ç¡¬ä»¶å‡çº§å‰ä½¿ç”¨32ä½ç³»ç»Ÿ1.5GBçš„å †ï¼Œç”¨æˆ·åªæ„Ÿè§‰åˆ°ä½¿ç”¨ç½‘ç«™æ¯”è¾ƒç¼“æ…¢ï¼Œä½†ä¸ä¼šå‘ç”Ÿååˆ†æ˜æ˜¾çš„åœé¡¿ï¼Œå› æ­¤æ‰è€ƒè™‘å‡çº§ç¡¬ä»¶ä»¥æå‡ç¨‹åºæ•ˆèƒ½ï¼Œå¦‚æœé‡æ–°ç¼©å°ç»™Javaå †åˆ†é…çš„å†…å­˜ï¼Œé‚£ä¹ˆç¡¬ä»¶ä¸Šçš„æŠ•èµ„å°±æ˜¾å¾—å¾ˆæµªè´¹</li>\n<li>åœ¨é«˜æ€§èƒ½ç¡¬ä»¶ä¸Šéƒ¨ç½²ç¨‹åºï¼Œç›®å‰ä¸»è¦æœ‰ä¸¤ç§æ–¹å¼ï¼š\n<ul>\n<li>é€šè¿‡64ä½JDKæ¥ä½¿ç”¨å¤§å†…å­˜ã€‚</li>\n<li>ä½¿ç”¨è‹¥å¹²ä¸ª32ä½è™šæ‹Ÿæœºå»ºç«‹é€»è¾‘é›†ç¾¤æ¥åˆ©ç”¨ç¡¬ä»¶èµ„æºã€‚</li>\n</ul>\n</li>\n<li>æ­¤æ¡ˆä¾‹ä¸­çš„ç®¡ç†å‘˜é‡‡ç”¨äº†ç¬¬ä¸€ç§éƒ¨ç½²æ–¹å¼ã€‚å¯¹äºç”¨æˆ·äº¤äº’æ€§å¼ºã€å¯¹åœé¡¿æ—¶é—´æ•æ„Ÿçš„ç³»ç»Ÿï¼Œå¯ä»¥ç»™Javaè™šæ‹Ÿæœºåˆ†é…è¶…å¤§å †çš„å‰ææ˜¯æœ‰æŠŠæ¡æŠŠåº”ç”¨ç¨‹åºçš„Full GCé¢‘ç‡æ§åˆ¶å¾—è¶³å¤Ÿä½ï¼Œè‡³å°‘è¦ä½åˆ°ä¸ä¼šå½±å“ç”¨æˆ·ä½¿ç”¨ï¼Œè­¬å¦‚åå‡ ä¸ªå°æ—¶ä¹ƒè‡³ä¸€å¤©æ‰å‡ºç°ä¸€æ¬¡Full GCï¼Œè¿™æ ·å¯ä»¥é€šè¿‡åœ¨æ·±å¤œæ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„æ–¹å¼è§¦å‘Full GCç”šè‡³è‡ªåŠ¨é‡å¯åº”ç”¨æœåŠ¡å™¨æ¥ä¿æŒå†…å­˜å¯ç”¨ç©ºé—´åœ¨ä¸€ä¸ªç¨³å®šçš„æ°´å¹³ã€‚<br>\næ§åˆ¶Full GCé¢‘ç‡çš„å…³é”®æ˜¯çœ‹åº”ç”¨ä¸­ç»å¤§å¤šæ•°å¯¹è±¡èƒ½å¦ç¬¦åˆâ€œæœç”Ÿå¤•ç­â€çš„åŸåˆ™ï¼Œå³å¤§å¤šæ•°å¯¹è±¡çš„ç”Ÿå­˜æ—¶é—´ä¸åº”å¤ªé•¿ï¼Œå°¤å…¶æ˜¯ä¸èƒ½æœ‰æˆæ‰¹é‡çš„ã€é•¿ç”Ÿå­˜æ—¶é—´çš„å¤§å¯¹è±¡äº§ç”Ÿï¼Œè¿™æ ·æ‰èƒ½ä¿éšœè€å¹´ä»£ç©ºé—´çš„ç¨³å®šã€‚</li>\n<li>åœ¨å¤§å¤šæ•°ç½‘ç«™å½¢å¼çš„åº”ç”¨é‡Œï¼Œä¸»è¦å¯¹è±¡çš„ç”Ÿå­˜å‘¨æœŸéƒ½åº”è¯¥æ˜¯è¯·æ±‚çº§æˆ–è€…é¡µé¢çº§çš„ï¼Œä¼šè¯çº§å’Œå…¨å±€çº§çš„é•¿ç”Ÿå‘½å¯¹è±¡ç›¸å¯¹å¾ˆå°‘ã€‚åªè¦ä»£ç å†™å¾—åˆç†ï¼Œåº”å½“éƒ½èƒ½å®ç°åœ¨è¶…å¤§å †ä¸­æ­£å¸¸ä½¿ç”¨è€Œæ²¡æœ‰Full GCï¼Œè¿™æ ·çš„è¯ï¼Œä½¿ç”¨è¶…å¤§å †å†…å­˜æ—¶ï¼Œç½‘ç«™å“åº”é€Ÿåº¦æ‰ä¼šæ¯”è¾ƒæœ‰ä¿è¯ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œå¦‚æœè®¡åˆ’ä½¿ç”¨64ä½JDKæ¥ç®¡ç†å¤§å†…å­˜ï¼Œè¿˜éœ€è¦è€ƒè™‘ä¸‹é¢å¯èƒ½é¢ä¸´çš„é—®é¢˜ï¼š\n<ul>\n<li>å†…å­˜å›æ”¶å¯¼è‡´çš„é•¿æ—¶é—´åœé¡¿ã€‚</li>\n<li>64ä½JDKçš„æ€§èƒ½æµ‹è¯•ç»“æœæ™®éä½äº32ä½JDKã€‚</li>\n</ul>\n</li>\n<li>éœ€è¦ä¿è¯ç¨‹åºè¶³å¤Ÿç¨³å®šï¼Œå› ä¸ºè¿™ç§åº”ç”¨è¦æ˜¯äº§ç”Ÿå †æº¢å‡ºå‡ ä¹å°±æ— æ³•äº§ç”Ÿå †è½¬å‚¨å¿«ç…§ï¼ˆå› ä¸ºè¦äº§ç”Ÿåå‡ GBä¹ƒè‡³æ›´å¤§çš„Dumpæ–‡ä»¶ï¼‰ï¼Œå“ªæ€•äº§ç”Ÿäº†å¿«ç…§ä¹Ÿå‡ ä¹æ— æ³•è¿›è¡Œåˆ†æã€‚ç›¸åŒç¨‹åºåœ¨64ä½JDKæ¶ˆè€—çš„å†…å­˜ä¸€èˆ¬æ¯”32ä½JDKå¤§ï¼Œè¿™æ˜¯ç”±äºæŒ‡é’ˆè†¨èƒ€ï¼Œä»¥åŠæ•°æ®ç±»å‹<br>\nå¯¹é½è¡¥ç™½ç­‰å› ç´ å¯¼è‡´çš„ã€‚</li>\n<li>æ‰€ä»¥ç°é˜¶æ®µä¸å°‘ç®¡ç†å‘˜è¿˜æ˜¯é€‰æ‹©ç¬¬äºŒç§æ–¹å¼ï¼šä½¿ç”¨è‹¥å¹²ä¸ª32ä½è™šæ‹Ÿæœºå»ºç«‹é€»è¾‘é›†ç¾¤æ¥åˆ©ç”¨ç¡¬ä»¶èµ„æºã€‚å…·ä½“åšæ³•æ˜¯åœ¨ä¸€å°ç‰©ç†æœºå™¨ä¸Šå¯åŠ¨å¤šä¸ªåº”ç”¨æœåŠ¡å™¨è¿›ç¨‹ï¼Œæ¯ä¸ªæœåŠ¡å™¨è¿›ç¨‹åˆ†é…ä¸åŒç«¯å£ï¼Œç„¶ååœ¨å‰ç«¯æ­å»ºä¸€ä¸ªè´Ÿè½½å‡è¡¡å™¨ï¼Œä»¥åå‘ä»£ç†çš„æ–¹å¼æ¥åˆ†é…è®¿é—®è¯·æ±‚ã€‚ä¸éœ€è¦å¤ªè¿‡åœ¨æ„å‡è¡¡å™¨è½¬å‘æ‰€æ¶ˆè€—çš„æ€§èƒ½ï¼Œå³ä½¿ä½¿ç”¨64ä½JDKï¼Œè®¸å¤šåº”ç”¨ä¹Ÿä¸æ­¢æœ‰ä¸€å°æœåŠ¡å™¨ï¼Œå› æ­¤åœ¨è®¸å¤šåº”ç”¨ä¸­å‰ç«¯çš„å‡è¡¡å™¨æ€»æ˜¯è¦å­˜åœ¨çš„ã€‚</li>\n<li>è€ƒè™‘åˆ°åœ¨ä¸€å°ç‰©ç†æœºå™¨ä¸Šå»ºç«‹é€»è¾‘é›†ç¾¤çš„ç›®çš„ä»…ä»…æ˜¯ä¸ºäº†å°½å¯èƒ½åˆ©ç”¨ç¡¬ä»¶èµ„æºï¼Œå¹¶ä¸éœ€è¦å…³å¿ƒçŠ¶æ€ä¿ç•™ã€çƒ­è½¬ç§»ä¹‹ç±»çš„é«˜å¯ç”¨æ€§éœ€æ±‚ï¼Œä¹Ÿä¸éœ€è¦ä¿è¯æ¯ä¸ªè™šæ‹Ÿæœºè¿›ç¨‹æœ‰ç»å¯¹å‡†ç¡®çš„å‡è¡¡è´Ÿè½½ï¼Œå› æ­¤ä½¿ç”¨æ— Sessionå¤åˆ¶çš„äº²åˆå¼é›†ç¾¤æ˜¯ä¸€ä¸ªç›¸å½“ä¸é”™çš„é€‰æ‹©ã€‚æˆ‘ä»¬ä»…ä»…éœ€è¦ä¿éšœé›†ç¾¤å…·å¤‡äº²åˆæ€§ï¼Œä¹Ÿå°±æ˜¯å‡è¡¡å™¨æŒ‰ä¸€å®šçš„è§„åˆ™ç®—æ³•ï¼ˆä¸€èˆ¬æ ¹æ®SessionIDåˆ†é…ï¼‰å°†ä¸€ä¸ªå›ºå®šçš„ç”¨æˆ·è¯·æ±‚æ°¸è¿œåˆ†é…åˆ°å›ºå®šçš„ä¸€ä¸ªé›†ç¾¤èŠ‚ç‚¹è¿›è¡Œå¤„ç†å³å¯ï¼Œè¿™æ ·ç¨‹åºå¼€å‘é˜¶æ®µå°±åŸºæœ¬ä¸ç”¨ä¸ºé›†ç¾¤ç¯å¢ƒåšä»€ä¹ˆç‰¹åˆ«çš„è€ƒè™‘äº†ã€‚</li>\n<li>å¦‚æœè¯»è€…è®¡åˆ’ä½¿ç”¨é€»è¾‘é›†ç¾¤çš„æ–¹å¼æ¥éƒ¨ç½²ç¨‹åºï¼Œå¯èƒ½ä¼šé‡åˆ°ä¸‹é¢ä¸€äº›é—®é¢˜ï¼š\n<ul>\n<li>å°½é‡é¿å…èŠ‚ç‚¹ç«äº‰å…¨å±€çš„èµ„æºï¼Œæœ€å…¸å‹çš„å°±æ˜¯ç£ç›˜ç«äº‰ï¼Œå„ä¸ªèŠ‚ç‚¹å¦‚æœåŒæ—¶è®¿é—®æŸä¸ªç£ç›˜æ–‡ä»¶çš„è¯ï¼ˆå°¤å…¶æ˜¯å¹¶å‘å†™æ“ä½œå®¹æ˜“å‡ºç°é—®é¢˜ï¼‰ï¼Œå¾ˆå®¹æ˜“å¯¼è‡´IOå¼‚å¸¸ã€‚</li>\n<li>å¾ˆéš¾æœ€é«˜æ•ˆç‡åœ°åˆ©ç”¨æŸäº›èµ„æºæ± ï¼Œè­¬å¦‚è¿æ¥æ± ï¼Œä¸€èˆ¬éƒ½æ˜¯åœ¨å„ä¸ªèŠ‚ç‚¹å»ºç«‹è‡ªå·±ç‹¬ç«‹çš„è¿æ¥æ± ï¼Œè¿™æ ·æœ‰å¯èƒ½å¯¼è‡´ä¸€äº›èŠ‚ç‚¹æ± æ»¡äº†è€Œå¦å¤–ä¸€äº›èŠ‚ç‚¹ä»æœ‰è¾ƒå¤šç©ºä½™ã€‚å°½ç®¡å¯ä»¥ä½¿ç”¨é›†ä¸­å¼çš„JNDIï¼Œä½†è¿™ä¸ªæœ‰ä¸€å®šå¤æ‚æ€§å¹¶ä¸”å¯èƒ½å¸¦æ¥é¢å¤–çš„æ€§èƒ½å¼€é”€ã€‚</li>\n<li>å„ä¸ªèŠ‚ç‚¹ä»ç„¶ä¸å¯é¿å…åœ°å—åˆ°32ä½çš„å†…å­˜é™åˆ¶ï¼Œåœ¨32ä½Windowså¹³å°ä¸­æ¯ä¸ªè¿›ç¨‹åªèƒ½ä½¿ç”¨2GBçš„å†…å­˜ï¼Œè€ƒè™‘åˆ°å †ä»¥å¤–çš„å†…å­˜å¼€é”€ï¼Œå †ä¸€èˆ¬æœ€å¤šåªèƒ½å¼€åˆ°1.5GBã€‚åœ¨æŸäº›Linuxæˆ–UNIXç³»ç»Ÿï¼ˆå¦‚Solarisï¼‰ä¸­ï¼Œå¯ä»¥æå‡åˆ°3GBä¹ƒè‡³æ¥è¿‘4GBçš„å†…å­˜ï¼Œä½†32ä½ä¸­ä»ç„¶å—æœ€é«˜4GBï¼ˆ2^32ï¼‰å†…å­˜çš„é™åˆ¶ã€‚</li>\n<li>å¤§é‡ä½¿ç”¨æœ¬åœ°ç¼“å­˜ï¼ˆå¦‚å¤§é‡ä½¿ç”¨HashMapä½œä¸ºK/Vç¼“å­˜ï¼‰çš„åº”ç”¨ï¼Œåœ¨é€»è¾‘é›†ç¾¤ä¸­ä¼šé€ æˆè¾ƒå¤§çš„å†…å­˜æµªè´¹ï¼Œå› ä¸ºæ¯ä¸ªé€»è¾‘èŠ‚ç‚¹ä¸Šéƒ½æœ‰ä¸€ä»½ç¼“å­˜ï¼Œè¿™æ—¶å€™å¯ä»¥è€ƒè™‘æŠŠæœ¬åœ°ç¼“å­˜æ”¹ä¸ºé›†ä¸­å¼ç¼“å­˜ã€‚</li>\n</ul>\n</li>\n<li>è¿™ä¸ªæ¡ˆä¾‹ä¹‹ä¸­ï¼Œæœ€åçš„éƒ¨ç½²æ–¹æ¡ˆè°ƒæ•´ä¸ºå»ºç«‹5ä¸ª32ä½JDKçš„é€»è¾‘é›†ç¾¤ï¼Œæ¯ä¸ªè¿›ç¨‹æŒ‰2GBå†…å­˜è®¡ç®—ï¼ˆå…¶ä¸­å †å›ºå®šä¸º1.5GBï¼‰ï¼Œå ç”¨äº†10GBå†…å­˜ã€‚å¦å¤–å»ºç«‹ä¸€ä¸ªApacheæœåŠ¡ä½œä¸ºå‰ç«¯å‡è¡¡ä»£ç†è®¿é—®é—¨æˆ·ã€‚è€ƒè™‘åˆ°ç”¨æˆ·å¯¹å“åº”é€Ÿåº¦æ¯”è¾ƒå…³å¿ƒï¼Œå¹¶ä¸”æ–‡æ¡£æœåŠ¡çš„ä¸»è¦å‹åŠ›é›†ä¸­åœ¨ç£ç›˜å’Œå†…å­˜è®¿é—®ï¼ŒCPUèµ„æºæ•æ„Ÿåº¦è¾ƒä½ï¼Œå› æ­¤æ”¹ä¸ºCMSæ”¶é›†å™¨è¿›è¡Œåƒåœ¾å›æ”¶ã€‚éƒ¨ç½²æ–¹å¼è°ƒæ•´åï¼ŒæœåŠ¡å†æ²¡æœ‰å‡ºç°é•¿æ—¶é—´åœé¡¿ï¼Œé€Ÿåº¦æ¯”ç¡¬ä»¶å‡çº§å‰æœ‰è¾ƒå¤§æå‡ã€‚</li>\n</ul>\n<h2>11.2. é›†ç¾¤é—´åŒæ­¥å¯¼è‡´çš„å†…å­˜æº¢å‡º</h2>\n<ul>\n<li>æœ‰ä¸€ä¸ªåŸºäºB/Sçš„MISç³»ç»Ÿï¼Œç¡¬ä»¶ä¸ºä¸¤å°2ä¸ªCPUã€8GBå†…å­˜çš„HPå°å‹æœºï¼ŒæœåŠ¡å™¨æ˜¯WebLogic 9.2ï¼Œæ¯å°æœºå™¨å¯åŠ¨äº†3ä¸ªWebLogicå®ä¾‹ï¼Œæ„æˆä¸€ä¸ª6ä¸ªèŠ‚ç‚¹çš„äº²åˆå¼é›†ç¾¤ã€‚ç”±äºæ˜¯äº²åˆå¼é›†ç¾¤ï¼ŒèŠ‚ç‚¹ä¹‹é—´æ²¡æœ‰è¿›è¡ŒSessionåŒæ­¥ï¼Œä½†æ˜¯æœ‰ä¸€äº›éœ€æ±‚è¦å®ç°éƒ¨åˆ†æ•°æ®åœ¨å„ä¸ªèŠ‚ç‚¹é—´å…±äº«ã€‚å¼€å§‹è¿™äº›æ•°æ®å­˜æ”¾åœ¨æ•°æ®åº“ä¸­ï¼Œä½†ç”±äºè¯»å†™é¢‘ç¹ç«äº‰å¾ˆæ¿€çƒˆï¼Œæ€§èƒ½å½±å“è¾ƒå¤§ï¼Œåé¢ä½¿ç”¨JBossCacheæ„å»ºäº†ä¸€ä¸ªå…¨å±€ç¼“å­˜ã€‚å…¨å±€ç¼“å­˜å¯ç”¨åï¼ŒæœåŠ¡æ­£å¸¸ä½¿ç”¨äº†ä¸€æ®µè¾ƒé•¿çš„æ—¶é—´ï¼Œä½†æœ€è¿‘å´ä¸å®šæœŸåœ°å‡ºç°äº†å¤šæ¬¡çš„å†…å­˜æº¢å‡ºé—®é¢˜ã€‚</li>\n<li>åœ¨å†…å­˜æº¢å‡ºå¼‚å¸¸ä¸å‡ºç°çš„æ—¶å€™ï¼ŒæœåŠ¡å†…å­˜å›æ”¶çŠ¶å†µä¸€ç›´æ­£å¸¸ï¼Œæ¯æ¬¡å†…å­˜å›æ”¶åéƒ½èƒ½æ¢å¤åˆ°ä¸€ä¸ªç¨³å®šçš„å¯ç”¨ç©ºé—´ï¼Œå¼€å§‹æ€€ç–‘æ˜¯ç¨‹åºæŸäº›ä¸å¸¸ç”¨çš„ä»£ç è·¯å¾„ä¸­å­˜åœ¨å†…å­˜æ³„æ¼ï¼Œä½†ç®¡ç†å‘˜åæ˜ æœ€è¿‘ç¨‹åºå¹¶æœªæ›´æ–°ã€å‡çº§è¿‡ï¼Œä¹Ÿæ²¡æœ‰è¿›è¡Œä»€ä¹ˆç‰¹åˆ«æ“ä½œã€‚åªå¥½è®©æœåŠ¡å¸¦ç€-XXï¼š+HeapDumpOnOutOfMemoryErrorå‚æ•°è¿è¡Œäº†ä¸€æ®µæ—¶é—´ã€‚åœ¨æœ€è¿‘ä¸€æ¬¡æº¢å‡ºä¹‹åï¼Œç®¡ç†å‘˜å‘å›äº†heapdumpæ–‡ä»¶ï¼Œå‘ç°é‡Œé¢å­˜åœ¨ç€å¤§é‡çš„org.jgroups.protocols.pbcast.NAKACKå¯¹è±¡ã€‚</li>\n<li>JBossCacheæ˜¯åŸºäºè‡ªå®¶çš„JGroupsè¿›è¡Œé›†ç¾¤é—´çš„æ•°æ®é€šä¿¡ï¼ŒJGroupsä½¿ç”¨åè®®æ ˆçš„æ–¹å¼æ¥å®ç°æ”¶å‘æ•°æ®åŒ…çš„å„ç§æ‰€éœ€ç‰¹æ€§è‡ªç”±ç»„åˆï¼Œæ•°æ®åŒ…æ¥æ”¶å’Œå‘é€æ—¶è¦ç»è¿‡æ¯å±‚åè®®æ ˆçš„upï¼ˆï¼‰å’Œdownï¼ˆï¼‰æ–¹æ³•ï¼Œå…¶ä¸­çš„NAKACKæ ˆç”¨äºä¿éšœå„ä¸ªåŒ…çš„æœ‰æ•ˆé¡ºåºåŠé‡å‘ã€‚</li>\n<li>ç”±äºä¿¡æ¯æœ‰ä¼ è¾“å¤±è´¥éœ€è¦é‡å‘çš„å¯èƒ½æ€§ï¼Œåœ¨ç¡®è®¤æ‰€æœ‰æ³¨å†Œåœ¨GMSï¼ˆGroup Membership Serviceï¼‰çš„èŠ‚ç‚¹éƒ½æ”¶åˆ°æ­£ç¡®çš„ä¿¡æ¯å‰ï¼Œå‘é€çš„ä¿¡æ¯å¿…é¡»åœ¨å†…å­˜ä¸­ä¿ç•™ã€‚è€Œæ­¤MISçš„æœåŠ¡ç«¯ä¸­æœ‰ä¸€ä¸ªè´Ÿè´£å®‰å…¨æ ¡éªŒçš„å…¨å±€Filterï¼Œæ¯å½“æ¥æ”¶åˆ°è¯·æ±‚æ—¶ï¼Œå‡ä¼šæ›´æ–°ä¸€æ¬¡æœ€åæ“ä½œæ—¶é—´ï¼Œå¹¶ä¸”å°†è¿™ä¸ªæ—¶é—´åŒæ­¥åˆ°æ‰€æœ‰çš„èŠ‚ç‚¹å»ï¼Œä½¿å¾—ä¸€ä¸ªç”¨æˆ·åœ¨ä¸€æ®µæ—¶é—´å†…ä¸èƒ½åœ¨å¤šå°æœºå™¨ä¸Šç™»å½•ã€‚åœ¨æœåŠ¡ä½¿ç”¨è¿‡ç¨‹ä¸­ï¼Œå¾€å¾€ä¸€ä¸ªé¡µé¢ä¼šäº§ç”Ÿæ•°æ¬¡ä¹ƒè‡³æ•°åæ¬¡çš„è¯·æ±‚ï¼Œå› æ­¤è¿™ä¸ªè¿‡æ»¤å™¨å¯¼è‡´é›†ç¾¤å„ä¸ªèŠ‚ç‚¹ä¹‹é—´ç½‘ç»œäº¤äº’éå¸¸é¢‘ç¹ã€‚å½“ç½‘ç»œæƒ…å†µä¸èƒ½æ»¡è¶³ä¼ è¾“è¦æ±‚æ—¶ï¼Œé‡å‘æ•°æ®åœ¨å†…å­˜ä¸­ä¸æ–­å †ç§¯ï¼Œå¾ˆå¿«å°±äº§ç”Ÿäº†å†…å­˜æº¢å‡ºã€‚</li>\n<li>è¿™ä¸ªæ¡ˆä¾‹ä¸­çš„é—®é¢˜ï¼Œæ—¢æœ‰JBossCacheçš„ç¼ºé™·ï¼Œä¹Ÿæœ‰MISç³»ç»Ÿå®ç°æ–¹å¼ä¸Šç¼ºé™·ã€‚JBossCacheå®˜æ–¹çš„maillistä¸­è®¨è®ºè¿‡å¾ˆå¤šæ¬¡ç±»ä¼¼çš„å†…å­˜æº¢å‡ºå¼‚å¸¸é—®é¢˜ï¼Œæ®è¯´åç»­ç‰ˆæœ¬ä¹Ÿæœ‰äº†æ”¹è¿›ã€‚è€Œæ›´é‡è¦çš„ç¼ºé™·æ˜¯è¿™ä¸€ç±»è¢«é›†ç¾¤å…±äº«çš„æ•°æ®è¦ä½¿ç”¨ç±»ä¼¼JBossCacheè¿™ç§é›†ç¾¤ç¼“å­˜æ¥åŒæ­¥çš„è¯ï¼Œå¯ä»¥å…è®¸è¯»æ“ä½œé¢‘ç¹ï¼Œå› ä¸ºæ•°æ®åœ¨æœ¬åœ°å†…å­˜æœ‰ä¸€ä»½å‰¯æœ¬ï¼Œè¯»å–çš„åŠ¨ä½œä¸ä¼šè€—è´¹å¤šå°‘èµ„æºï¼Œä½†ä¸åº”å½“æœ‰è¿‡äºé¢‘ç¹çš„å†™æ“ä½œï¼Œé‚£æ ·ä¼šå¸¦æ¥å¾ˆå¤§çš„ç½‘ç»œåŒæ­¥çš„å¼€é”€ã€‚</li>\n</ul>\n<h2>11.3. å †å¤–å†…å­˜å¯¼è‡´çš„æº¢å‡ºé”™è¯¯</h2>\n<ul>\n<li>ä¸€ä¸ªå­¦æ ¡çš„å°å‹é¡¹ç›®ï¼šåŸºäºB/Sçš„ç”µå­è€ƒè¯•ç³»ç»Ÿï¼Œä¸ºäº†å®ç°å®¢æˆ·ç«¯èƒ½å®æ—¶åœ°ä»æœåŠ¡å™¨ç«¯æ¥æ”¶è€ƒè¯•æ•°æ®ï¼Œç³»ç»Ÿä½¿ç”¨äº†é€†å‘AJAXæŠ€æœ¯ï¼ˆä¹Ÿç§°ä¸ºCometæˆ–è€…Server Side Pushï¼‰ï¼Œé€‰ç”¨CometD 1.1.1ä½œä¸ºæœåŠ¡ç«¯æ¨é€æ¡†æ¶ï¼ŒæœåŠ¡å™¨æ˜¯Jetty 7.1.4ï¼Œç¡¬ä»¶ä¸ºä¸€å°æ™®é€šPCæœºï¼ŒCore i5 CPUï¼Œ4GBå†…å­˜ï¼Œè¿è¡Œ32ä½Windowsæ“ä½œç³»ç»Ÿã€‚</li>\n<li>æµ‹è¯•æœŸé—´å‘ç°æœåŠ¡ç«¯ä¸å®šæ—¶æŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ï¼ŒæœåŠ¡å™¨ä¸ä¸€å®šæ¯æ¬¡éƒ½ä¼šå‡ºç°å¼‚å¸¸ï¼Œä½†å‡å¦‚æ­£å¼è€ƒè¯•æ—¶å´©æºƒä¸€æ¬¡ï¼Œé‚£ä¼°è®¡æ•´åœºç”µå­è€ƒè¯•éƒ½ä¼šä¹±å¥—ï¼Œç½‘ç«™ç®¡ç†å‘˜å°è¯•è¿‡æŠŠå †å¼€åˆ°æœ€å¤§ï¼Œè€Œ32ä½ç³»ç»Ÿæœ€å¤šåˆ°1.6GBå°±åŸºæœ¬æ— æ³•å†åŠ å¤§äº†ï¼Œè€Œä¸”å¼€å¤§äº†åŸºæœ¬æ²¡æ•ˆæœï¼ŒæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸å¥½åƒè¿˜æ›´åŠ é¢‘ç¹äº†ã€‚åŠ å…¥-XXï¼š+HeapDumpOnOutOfMemoryErrorï¼Œå±…ç„¶ä¹Ÿæ²¡æœ‰ä»»ä½•ååº”ï¼ŒæŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸æ—¶ä»€ä¹ˆæ–‡ä»¶éƒ½æ²¡æœ‰äº§ç”Ÿã€‚æ— å¥ˆä¹‹ä¸‹åªå¥½æŒ‚ç€jstatå¹¶ä¸€ç›´ç´§ç›¯å±å¹•ï¼Œå‘ç°GCå¹¶ä¸é¢‘ç¹ï¼ŒEdenåŒºã€SurvivoråŒºã€è€å¹´ä»£ä»¥åŠæ°¸ä¹…ä»£å†…å­˜å…¨éƒ¨éƒ½è¡¨ç¤ºâ€œæƒ…ç»ªç¨³å®šï¼Œå‹åŠ›ä¸å¤§â€ï¼Œä½†å°±æ˜¯ç…§æ ·ä¸åœåœ°æŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸ï¼Œæœ€åï¼Œåœ¨å†…å­˜æº¢å‡ºåä»ç³»ç»Ÿæ—¥å¿—ä¸­æ‰¾åˆ°å¼‚å¸¸å †æ ˆ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>[org.eclipse.jetty.util.log]handle failed java.lang.OutOfMemoryErrorï¼šnull\nat sun.misc.Unsafe.allocateMemoryï¼ˆNative Methodï¼‰\nat java.nio.DirectByteBuffer.ï¼œinitï¼ï¼ˆDirectByteBuffer.javaï¼š99ï¼‰\nat java.nio.ByteBuffer.allocateDirectï¼ˆByteBuffer.javaï¼š288ï¼‰\nat org.eclipse.jetty.io.nio.DirectNIOBuffer.ï¼œinitï¼\n</code></pre></div><ul>\n<li>æ“ä½œç³»ç»Ÿå¯¹æ¯ä¸ªè¿›ç¨‹èƒ½ç®¡ç†çš„å†…å­˜æ˜¯æœ‰é™åˆ¶çš„ï¼Œè¿™å°æœåŠ¡å™¨ä½¿ç”¨çš„32ä½Windowså¹³å°çš„é™åˆ¶æ˜¯2GBï¼Œå…¶ä¸­åˆ’äº†1.6GBç»™Javaå †ï¼Œè€ŒDirect Memoryå†…å­˜å¹¶ä¸ç®—å…¥1.6GBçš„å †ä¹‹å†…ï¼Œå› æ­¤å®ƒæœ€å¤§ä¹Ÿåªèƒ½åœ¨å‰©ä½™çš„0.4GBç©ºé—´ä¸­åˆ†å‡ºä¸€éƒ¨åˆ†ã€‚åœ¨æ­¤åº”ç”¨ä¸­å¯¼è‡´æº¢å‡ºçš„å…³é”®æ˜¯ï¼šåƒåœ¾æ”¶é›†è¿›è¡Œæ—¶ï¼Œè™šæ‹Ÿæœºè™½ç„¶ä¼šå¯¹Direct Memoryè¿›è¡Œå›æ”¶ï¼Œä½†æ˜¯Direct Memoryå´ä¸èƒ½åƒæ–°ç”Ÿä»£ã€è€å¹´ä»£é‚£æ ·ï¼Œå‘ç°ç©ºé—´ä¸è¶³äº†å°±é€šçŸ¥æ”¶é›†å™¨è¿›è¡Œåƒåœ¾å›æ”¶ï¼Œå®ƒåªèƒ½ç­‰å¾…è€å¹´ä»£æ»¡äº†åFull GCï¼Œç„¶åâ€œé¡ºä¾¿åœ°â€å¸®å®ƒæ¸…ç†æ‰å†…å­˜çš„åºŸå¼ƒå¯¹è±¡ã€‚å¦åˆ™å®ƒåªèƒ½ä¸€ç›´ç­‰åˆ°æŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸æ—¶ï¼Œå…ˆcatchæ‰ï¼Œå†åœ¨catchå—é‡Œé¢â€œå¤§å–Šâ€ä¸€å£°ï¼šâ€œSystem.gcï¼ˆï¼‰ï¼â€ã€‚è¦æ˜¯è™šæ‹Ÿæœºè¿˜æ˜¯ä¸å¬ï¼ˆè­¬å¦‚æ‰“å¼€äº†-XXï¼š+DisableExplicitGCå¼€å…³ï¼‰ï¼Œé‚£å°±åªèƒ½çœ¼ççåœ°çœ‹ç€å †ä¸­è¿˜æœ‰è®¸å¤šç©ºé—²å†…å­˜ï¼Œè‡ªå·±å´ä¸å¾—ä¸æŠ›å‡ºå†…å­˜æº¢å‡ºå¼‚å¸¸äº†ã€‚è€Œæœ¬æ¡ˆä¾‹ä¸­ä½¿ç”¨çš„CometD 1.1.1æ¡†æ¶ï¼Œæ­£å¥½æœ‰å¤§é‡çš„NIOæ“ä½œéœ€è¦ä½¿ç”¨åˆ°Direct Memoryå†…å­˜ã€‚</li>\n<li>ä»å®è·µç»éªŒçš„è§’åº¦å‡ºå‘ï¼Œé™¤äº†Javaå †å’Œæ°¸ä¹…ä»£ä¹‹å¤–ï¼Œæˆ‘ä»¬æ³¨æ„åˆ°ä¸‹é¢è¿™äº›åŒºåŸŸè¿˜ä¼šå ç”¨è¾ƒå¤šçš„å†…å­˜ï¼Œè¿™é‡Œæ‰€æœ‰çš„å†…å­˜æ€»å’Œå—åˆ°æ“ä½œç³»ç»Ÿè¿›ç¨‹æœ€å¤§å†…å­˜çš„é™åˆ¶ã€‚\n<ul>\n<li>Direct Memoryï¼šå¯é€šè¿‡-XXï¼šMaxDirectMemorySizeè°ƒæ•´å¤§å°ï¼Œå†…å­˜ä¸è¶³æ—¶æŠ›å‡ºOutOfMemoryErroræˆ–è€…OutOfMemoryErrorï¼šDirect buffer memoryã€‚</li>\n<li>çº¿ç¨‹å †æ ˆï¼šå¯é€šè¿‡-Xssè°ƒæ•´å¤§å°ï¼Œå†…å­˜ä¸è¶³æ—¶æŠ›å‡ºStackOverflowErrorï¼ˆçºµå‘æ— æ³•åˆ†é…ï¼Œå³æ— æ³•åˆ†é…æ–°çš„æ ˆå¸§ï¼‰æˆ–è€…OutOfMemoryErrorï¼šunable to create new native threadï¼ˆæ¨ªå‘æ— æ³•åˆ†é…ï¼Œå³æ— æ³•å»ºç«‹æ–°çš„çº¿ç¨‹ï¼‰ã€‚</li>\n<li>Socketç¼“å­˜åŒºï¼šæ¯ä¸ªSocketè¿æ¥éƒ½Receiveå’ŒSendä¸¤ä¸ªç¼“å­˜åŒºï¼Œåˆ†åˆ«å å¤§çº¦37KBå’Œ25KBå†…å­˜ï¼Œè¿æ¥å¤šçš„è¯è¿™å—å†…å­˜å ç”¨ä¹Ÿæ¯”è¾ƒå¯è§‚ã€‚å¦‚æœæ— æ³•åˆ†é…ï¼Œåˆ™å¯èƒ½ä¼šæŠ›å‡ºIOExceptionï¼šToo many open fileså¼‚å¸¸ã€‚</li>\n<li>JNIä»£ç ï¼šå¦‚æœä»£ç ä¸­ä½¿ç”¨JNIè°ƒç”¨æœ¬åœ°åº“ï¼Œé‚£æœ¬åœ°åº“ä½¿ç”¨çš„å†…å­˜ä¹Ÿä¸åœ¨å †ä¸­ã€‚</li>\n<li>è™šæ‹Ÿæœºå’ŒGCï¼šè™šæ‹Ÿæœºã€GCçš„ä»£ç æ‰§è¡Œä¹Ÿè¦æ¶ˆè€—ä¸€å®šçš„å†…å­˜ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>11.4. å¤–éƒ¨å‘½ä»¤å¯¼è‡´ç³»ç»Ÿç¼“æ…¢</h2>\n<ul>\n<li>ä¸€ä¸ªæ•°å­—æ ¡å›­åº”ç”¨ç³»ç»Ÿï¼Œè¿è¡Œåœ¨ä¸€å°4ä¸ªCPUçš„Solaris 10æ“ä½œç³»ç»Ÿä¸Šï¼Œä¸­é—´ä»¶ä¸ºGlassFishæœåŠ¡å™¨ã€‚ç³»ç»Ÿåœ¨åšå¤§å¹¶å‘å‹åŠ›æµ‹è¯•çš„æ—¶å€™ï¼Œå‘ç°è¯·æ±‚å“åº”æ—¶é—´æ¯”è¾ƒæ…¢ï¼Œé€šè¿‡æ“ä½œç³»ç»Ÿçš„mpstatå·¥å…·å‘ç°CPUä½¿ç”¨ç‡å¾ˆé«˜ï¼Œå¹¶ä¸”ç³»ç»Ÿå ç”¨ç»å¤§å¤šæ•°çš„CPUèµ„<br>\næºçš„ç¨‹åºå¹¶ä¸æ˜¯åº”ç”¨ç³»ç»Ÿæœ¬èº«ã€‚è¿™æ˜¯ä¸ªä¸æ­£å¸¸çš„ç°è±¡ï¼Œé€šå¸¸æƒ…å†µä¸‹ç”¨æˆ·åº”ç”¨çš„CPUå ç”¨ç‡åº”è¯¥å ä¸»è¦åœ°ä½ï¼Œæ‰èƒ½è¯´æ˜ç³»ç»Ÿæ˜¯æ­£å¸¸å·¥ä½œçš„ã€‚</li>\n<li>é€šè¿‡Solaris 10çš„Dtraceè„šæœ¬å¯ä»¥æŸ¥çœ‹å½“å‰æƒ…å†µä¸‹å“ªäº›ç³»ç»Ÿè°ƒç”¨èŠ±è´¹äº†æœ€å¤šçš„CPUèµ„æºï¼ŒDtraceè¿è¡Œåå‘ç°æœ€æ¶ˆè€—CPUèµ„æºçš„ç«Ÿç„¶æ˜¯â€œforkâ€ç³»ç»Ÿè°ƒç”¨ã€‚ä¼—æ‰€å‘¨çŸ¥ï¼Œâ€œforkâ€ç³»ç»Ÿè°ƒç”¨æ˜¯Linuxç”¨æ¥äº§ç”Ÿæ–°è¿›ç¨‹çš„ï¼Œåœ¨Javaè™šæ‹Ÿæœºä¸­ï¼Œç”¨æˆ·ç¼–å†™çš„Javaä»£ç æœ€å¤šåªæœ‰çº¿ç¨‹çš„æ¦‚å¿µï¼Œä¸åº”å½“æœ‰è¿›ç¨‹çš„äº§ç”Ÿã€‚</li>\n<li>é€šè¿‡æœ¬ç³»ç»Ÿçš„å¼€å‘äººå‘˜ï¼Œæœ€ç»ˆæ‰¾åˆ°äº†ç­”æ¡ˆï¼šæ¯ä¸ªç”¨æˆ·è¯·æ±‚çš„å¤„ç†éƒ½éœ€è¦æ‰§è¡Œä¸€ä¸ªå¤–éƒ¨shellè„šæœ¬æ¥è·å¾—ç³»ç»Ÿçš„ä¸€äº›ä¿¡æ¯ã€‚æ‰§è¡Œè¿™ä¸ªshellè„šæœ¬æ˜¯é€šè¿‡Javaçš„Runtime.getRuntimeï¼ˆï¼‰.execï¼ˆï¼‰æ–¹æ³•æ¥è°ƒç”¨çš„ã€‚è¿™ç§è°ƒç”¨æ–¹å¼å¯ä»¥è¾¾åˆ°ç›®çš„ï¼Œä½†æ˜¯å®ƒåœ¨Javaè™šæ‹Ÿæœºä¸­æ˜¯éå¸¸æ¶ˆè€—èµ„æºçš„æ“ä½œï¼Œå³ä½¿å¤–éƒ¨å‘½ä»¤æœ¬èº«èƒ½å¾ˆå¿«æ‰§è¡Œå®Œæ¯•ï¼Œé¢‘ç¹è°ƒç”¨æ—¶åˆ›å»ºè¿›ç¨‹çš„å¼€é”€ä¹Ÿéå¸¸å¯è§‚ã€‚Javaè™šæ‹Ÿæœºæ‰§è¡Œè¿™ä¸ªå‘½ä»¤çš„è¿‡ç¨‹æ˜¯ï¼šé¦–å…ˆå…‹éš†ä¸€ä¸ªå’Œå½“å‰è™šæ‹Ÿæœºæ‹¥æœ‰ä¸€æ ·ç¯å¢ƒå˜é‡çš„è¿›ç¨‹ï¼Œå†ç”¨è¿™ä¸ªæ–°çš„è¿›ç¨‹å»æ‰§è¡Œå¤–éƒ¨å‘½ä»¤ï¼Œæœ€åå†é€€å‡ºè¿™ä¸ªè¿›ç¨‹ã€‚å¦‚æœé¢‘ç¹æ‰§è¡Œè¿™ä¸ªæ“ä½œï¼Œç³»ç»Ÿçš„æ¶ˆè€—ä¼šå¾ˆå¤§ï¼Œä¸ä»…æ˜¯CPUï¼Œå†…å­˜è´Ÿæ‹…ä¹Ÿå¾ˆé‡ã€‚</li>\n<li>ç”¨æˆ·æ ¹æ®å»ºè®®å»æ‰è¿™ä¸ªShellè„šæœ¬æ‰§è¡Œçš„è¯­å¥ï¼Œæ”¹ä¸ºä½¿ç”¨Javaçš„APIå»è·å–è¿™äº›ä¿¡æ¯åï¼Œç³»ç»Ÿå¾ˆå¿«æ¢å¤äº†æ­£å¸¸</li>\n</ul>\n<h2>11.5. æœåŠ¡å™¨JVMè¿›ç¨‹å´©æºƒ</h2>\n<ul>\n<li>ä¸€ä¸ªåŸºäºB/Sçš„MISç³»ç»Ÿï¼Œç¡¬ä»¶ä¸ºä¸¤å°2ä¸ªCPUã€8GBå†…å­˜çš„HPç³»ç»Ÿï¼ŒæœåŠ¡å™¨æ˜¯WebLogic 9.2ï¼ˆå°±æ˜¯5.2.2èŠ‚ä¸­çš„é‚£å¥—ç³»ç»Ÿï¼‰ã€‚æ­£å¸¸è¿è¡Œä¸€æ®µæ—¶é—´åï¼Œæœ€è¿‘å‘ç°åœ¨è¿è¡ŒæœŸé—´é¢‘ç¹å‡ºç°é›†ç¾¤èŠ‚ç‚¹çš„è™šæ‹Ÿæœºè¿›ç¨‹è‡ªåŠ¨å…³é—­çš„ç°è±¡ï¼Œç•™ä¸‹äº†ä¸€ä¸ªhs_err_pid###.logæ–‡ä»¶åï¼Œè¿›ç¨‹å°±æ¶ˆå¤±äº†ï¼Œä¸¤å°ç‰©ç†æœºå™¨é‡Œçš„æ¯ä¸ªèŠ‚ç‚¹éƒ½å‡ºç°è¿‡è¿›ç¨‹å´©æºƒçš„ç°è±¡ã€‚ä»ç³»ç»Ÿæ—¥å¿—ä¸­å¯ä»¥çœ‹å‡ºï¼Œæ¯ä¸ªèŠ‚ç‚¹çš„è™šæ‹Ÿæœºè¿›ç¨‹åœ¨å´©æºƒå‰ä¸ä¹…ï¼Œéƒ½å‘ç”Ÿè¿‡å¤§é‡ç›¸åŒçš„å¼‚å¸¸</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>java.net.SocketExceptionï¼šConnection reset\nat java.net.SocketInputStream.readï¼ˆSocketInputStream.javaï¼š168ï¼‰\nat java.io.BufferedInputStream.fillï¼ˆBufferedInputStream.javaï¼š218ï¼‰\nat java.io.BufferedInputStream.readï¼ˆBufferedInputStream.javaï¼š235ï¼‰\nat org.apache.axis.transport.http.HTTPSender.readHeadersFromSocketï¼ˆHTTPSender.javaï¼š583ï¼‰\nat org.apache.axis.transport.http.HTTPSender.invokeï¼ˆHTTPSender.javaï¼š143ï¼‰â€¦â€¦99 more\n</code></pre></div><ul>\n<li>è¿™æ˜¯ä¸€ä¸ªè¿œç«¯æ–­å¼€è¿æ¥çš„å¼‚å¸¸ï¼Œé€šè¿‡ç³»ç»Ÿç®¡ç†å‘˜äº†è§£åˆ°ç³»ç»Ÿæœ€è¿‘ä¸ä¸€ä¸ªOAé—¨æˆ·åšäº†é›†æˆï¼Œåœ¨MISç³»ç»Ÿå·¥ä½œæµçš„å¾…åŠäº‹é¡¹å˜åŒ–æ—¶ï¼Œè¦é€šè¿‡WebæœåŠ¡é€šçŸ¥OAé—¨æˆ·ç³»ç»Ÿï¼ŒæŠŠå¾…åŠäº‹é¡¹çš„å˜åŒ–åŒæ­¥åˆ°OAé—¨æˆ·ä¹‹ä¸­ã€‚é€šè¿‡SoapUIæµ‹è¯•äº†ä¸€ä¸‹åŒæ­¥å¾…åŠäº‹é¡¹çš„å‡ ä¸ªWebæœåŠ¡ï¼Œå‘ç°è°ƒç”¨åç«Ÿç„¶éœ€è¦é•¿è¾¾3åˆ†é’Ÿæ‰èƒ½è¿”å›ï¼Œå¹¶ä¸”è¿”å›ç»“æœéƒ½æ˜¯è¿æ¥ä¸­æ–­ã€‚</li>\n<li>ç”±äºMISç³»ç»Ÿçš„ç”¨æˆ·å¤šï¼Œå¾…åŠäº‹é¡¹å˜åŒ–å¾ˆå¿«ï¼Œä¸ºäº†ä¸è¢«OAç³»ç»Ÿé€Ÿåº¦æ‹–ç´¯ï¼Œä½¿ç”¨äº†å¼‚æ­¥çš„æ–¹å¼è°ƒç”¨WebæœåŠ¡ï¼Œä½†ç”±äºä¸¤è¾¹æœåŠ¡é€Ÿåº¦çš„å®Œå…¨ä¸å¯¹ç­‰ï¼Œæ—¶é—´è¶Šé•¿å°±ç´¯ç§¯äº†è¶Šå¤šWebæœåŠ¡æ²¡æœ‰è°ƒç”¨å®Œæˆï¼Œå¯¼è‡´åœ¨ç­‰å¾…çš„çº¿ç¨‹å’ŒSocketè¿æ¥è¶Šæ¥è¶Šå¤šï¼Œæœ€ç»ˆåœ¨è¶…è¿‡è™šæ‹Ÿæœºçš„æ‰¿å—èƒ½åŠ›åä½¿å¾—è™šæ‹Ÿæœºè¿›ç¨‹å´©æºƒã€‚è§£å†³æ–¹æ³•ï¼šé€šçŸ¥OAé—¨æˆ·æ–¹ä¿®å¤æ— æ³•ä½¿ç”¨çš„é›†æˆæ¥å£ï¼Œå¹¶å°†å¼‚æ­¥è°ƒç”¨æ”¹ä¸ºç”Ÿäº§è€…/æ¶ˆè´¹è€…æ¨¡å¼çš„æ¶ˆæ¯é˜Ÿåˆ—å®ç°åï¼Œç³»ç»Ÿæ¢å¤æ­£å¸¸ã€‚</li>\n</ul>\n<h2>11.6. ä¸æ°å½“æ•°æ®ç»“æ„å¯¼è‡´å†…å­˜å ç”¨è¿‡å¤§</h2>\n<ul>\n<li>æœ‰ä¸€ä¸ªåå°RPCæœåŠ¡å™¨ï¼Œä½¿ç”¨64ä½è™šæ‹Ÿæœºï¼Œå†…å­˜é…ç½®ä¸º-Xms4g-Xmx8g-Xmn1gï¼Œä½¿ç”¨ParNew+CMSçš„æ”¶é›†å™¨ç»„åˆã€‚å¹³æ—¶å¯¹å¤–æœåŠ¡çš„Minor GCæ—¶é—´çº¦åœ¨30æ¯«ç§’ä»¥å†…ï¼Œå®Œå…¨å¯ä»¥æ¥å—ã€‚ä½†ä¸šåŠ¡ä¸Šéœ€è¦æ¯10åˆ†é’ŸåŠ è½½ä¸€ä¸ªçº¦80MBçš„æ•°æ®æ–‡ä»¶åˆ°å†…å­˜è¿›è¡Œæ•°æ®åˆ†æï¼Œè¿™äº›æ•°æ®ä¼šåœ¨å†…å­˜ä¸­å½¢æˆè¶…è¿‡100ä¸‡ä¸ªHashMapï¼œLong,Longï¼Entryï¼Œåœ¨è¿™æ®µæ—¶é—´é‡Œé¢Minor GCå°±ä¼šé€ æˆè¶…è¿‡500æ¯«ç§’çš„åœé¡¿ï¼Œå¯¹äºè¿™ä¸ªåœé¡¿æ—¶é—´å°±æ¥å—ä¸äº†äº†ï¼Œå…·ä½“æƒ…å†µå¦‚ä¸‹é¢GCæ—¥å¿—æ‰€ç¤ºã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>{Heap before GC invocations=95ï¼ˆfull 4ï¼‰ï¼š\npar new generation total 903168K,used 803142K[0x00002aaaae770000ï¼Œ0x00002aaaebb70000ï¼Œ0x00002aaaebb70000ï¼‰\neden space 802816Kï¼Œ100%used[0x00002aaaae770000ï¼Œ0x00002aaadf770000ï¼Œ0x00002aaadf770000ï¼‰\nfrom space 100352Kï¼Œ0%used[0x00002aaae5970000ï¼Œ0x00002aaae59c1910ï¼Œ0x00002aaaebb70000ï¼‰\nto space 100352Kï¼Œ0%used[0x00002aaadf770000ï¼Œ0x00002aaadf770000ï¼Œ0x00002aaae5970000ï¼‰\nconcurrent mark-sweep generation total 5845540K,used 3898978K[0x00002aaaebb70000ï¼Œ0x00002aac507f9000ï¼Œ0x00002aacae770000ï¼‰\nconcurrent-mark-sweep perm gen total 65536K,used 40333K[0x00002aacae770000ï¼Œ0x00002aacb2770000ï¼Œ0x00002aacb2770000ï¼‰\n2 0 1 1-1 0-2 8 T 1 1ï¼š4 0ï¼š4 5.1 6 2+0 8 0 0ï¼š2 2 6.5 0 4ï¼š[G C 2 2 6.5 0 4ï¼š[P a r N e wï¼š803142K-ï¼100352Kï¼ˆ903168Kï¼‰ï¼Œ0.5995670 secs]4702120K-ï¼\n4056332Kï¼ˆ6748708Kï¼‰ï¼Œ0.5997560\nsecs][Timesï¼šuser=1.46 sys=0.04ï¼Œreal=0.60 secs]\nHeap after GC invocations=96ï¼ˆfull 4ï¼‰ï¼š\npar new generation total 903168K,used 100352K[0x00002aaaae770000ï¼Œ0x00002aaaebb70000ï¼Œ0x00002aaaebb70000ï¼‰\neden space 802816Kï¼Œ0%used[0x00002aaaae770000ï¼Œ0x00002aaaae770000ï¼Œ0x00002aaadf770000ï¼‰\nfrom space 100352Kï¼Œ100%used[0x00002aaadf770000ï¼Œ0x00002aaae5970000ï¼Œ\n0x00002aaae5970000ï¼‰\nto space 100352Kï¼Œ0x00002aaaebb70000ï¼‰0%used[0x00002aaae5970000ï¼Œ0x00002aaae5970000ï¼Œ\nconcurrent mark-sweep generation total 5845540K,used 3955980K[0x00002aaaebb70000ï¼Œ0x00002aac507f9000ï¼Œ0x00002aacae770000ï¼‰\nconcurrent-mark-sweep perm gen total 65536K,used 40333K[0x00002aacae770000ï¼Œ0x00002aacb2770000ï¼Œ0x00002aacb2770000ï¼‰\n}\nTotal time for which application threads were stoppedï¼š0.6070570 seconds\n</code></pre></div><ul>\n<li>å¹³æ—¶çš„Minor GCæ—¶é—´å¾ˆçŸ­ï¼ŒåŸå› æ˜¯æ–°ç”Ÿä»£çš„ç»å¤§éƒ¨åˆ†å¯¹è±¡éƒ½æ˜¯å¯æ¸…é™¤çš„ï¼Œåœ¨Minor GCä¹‹åEdenå’ŒSurvivoråŸºæœ¬ä¸Šå¤„äºå®Œå…¨ç©ºé—²çš„çŠ¶æ€ã€‚è€Œåœ¨åˆ†ææ•°æ®æ–‡ä»¶æœŸé—´ï¼Œ800MBçš„Edenç©ºé—´å¾ˆå¿«è¢«å¡«æ»¡ä»è€Œå¼•å‘GCï¼Œä½†Minor GCä¹‹åï¼Œæ–°ç”Ÿä»£ä¸­ç»å¤§éƒ¨åˆ†å¯¹è±¡ä¾ç„¶æ˜¯å­˜æ´»çš„ã€‚ParNewæ”¶é›†å™¨ä½¿ç”¨çš„æ˜¯å¤åˆ¶ç®—æ³•ï¼Œè¿™ä¸ªç®—æ³•çš„é«˜æ•ˆæ˜¯å»ºç«‹åœ¨å¤§éƒ¨åˆ†å¯¹è±¡éƒ½â€œæœç”Ÿå¤•ç­â€çš„ç‰¹æ€§ä¸Šçš„ï¼Œå¦‚æœå­˜æ´»å¯¹è±¡è¿‡å¤šï¼ŒæŠŠè¿™äº›å¯¹è±¡å¤åˆ¶åˆ°Survivorå¹¶ç»´æŒè¿™äº›å¯¹è±¡å¼•ç”¨çš„æ­£ç¡®å°±æˆä¸ºä¸€ä¸ªæ²‰é‡çš„è´Ÿæ‹…ï¼Œå› æ­¤å¯¼è‡´GCæš‚åœæ—¶é—´æ˜æ˜¾å˜é•¿ã€‚</li>\n<li>å¦‚æœä¸ä¿®æ”¹ç¨‹åºï¼Œä»…ä»GCè°ƒä¼˜çš„è§’åº¦å»è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œå¯ä»¥è€ƒè™‘å°†Survivorç©ºé—´å»æ‰ï¼ˆåŠ å…¥å‚æ•°-XXï¼šSurvivorRatio=65536ã€-XXï¼šMaxTenuringThreshold=0æˆ–è€…-XXï¼š+AlwaysTenureï¼‰ï¼Œè®©æ–°ç”Ÿä»£ä¸­å­˜æ´»çš„å¯¹è±¡åœ¨ç¬¬ä¸€æ¬¡Minor GCåç«‹å³è¿›å…¥è€å¹´ä»£ï¼Œç­‰åˆ°Major GCçš„æ—¶å€™å†æ¸…ç†å®ƒä»¬ã€‚è¿™ç§æªæ–½å¯ä»¥æ²»æ ‡ï¼Œä½†ä¹Ÿæœ‰å¾ˆå¤§å‰¯ä½œç”¨ï¼Œæ²»æœ¬çš„æ–¹æ¡ˆéœ€è¦ä¿®æ”¹ç¨‹åºï¼Œå› ä¸ºè¿™é‡Œçš„é—®é¢˜äº§ç”Ÿçš„æ ¹æœ¬åŸå› æ˜¯ç”¨HashMapï¼œLong,Longï¼ç»“æ„æ¥å­˜å‚¨æ•°æ®æ–‡ä»¶ç©ºé—´æ•ˆç‡å¤ªä½ã€‚</li>\n<li>å…·ä½“åˆ†æä¸€ä¸‹ç©ºé—´æ•ˆç‡ã€‚åœ¨HashMapï¼œLong,Longï¼ç»“æ„ä¸­ï¼Œåªæœ‰Keyå’ŒValueæ‰€å­˜æ”¾çš„ä¸¤ä¸ªé•¿æ•´å‹æ•°æ®æ˜¯æœ‰æ•ˆæ•°æ®ï¼Œå…±16Bï¼ˆ2Ã—8Bï¼‰ã€‚è¿™ä¸¤ä¸ªé•¿æ•´å‹æ•°æ®åŒ…è£…æˆjava.lang.Longå¯¹è±¡ä¹‹åï¼Œå°±åˆ†åˆ«å…·æœ‰8Bçš„MarkWordã€8Bçš„KlassæŒ‡é’ˆï¼Œåœ¨åŠ 8Bå­˜å‚¨æ•°æ®çš„longå€¼ã€‚åœ¨è¿™ä¸¤ä¸ªLongå¯¹è±¡ç»„æˆMap.Entryä¹‹åï¼Œåˆå¤šäº†16Bçš„å¯¹è±¡å¤´ï¼Œç„¶åä¸€ä¸ª8Bçš„nextå­—æ®µå’Œ4Bçš„intå‹çš„hashå­—æ®µï¼Œä¸ºäº†å¯¹é½ï¼Œè¿˜å¿…é¡»æ·»åŠ 4Bçš„ç©ºç™½å¡«å……ï¼Œæœ€åè¿˜æœ‰HashMapä¸­å¯¹è¿™ä¸ªEntryçš„8Bçš„å¼•ç”¨ï¼Œè¿™æ ·å¢åŠ ä¸¤ä¸ªé•¿æ•´å‹æ•°å­—ï¼Œå®é™…è€—è´¹çš„å†…å­˜ä¸ºï¼ˆLongï¼ˆ24Bï¼‰Ã—2ï¼‰+Entryï¼ˆ32Bï¼‰+HashMap Refï¼ˆ8Bï¼‰=88Bï¼Œç©ºé—´æ•ˆç‡ä¸º16B/88B=18%ï¼Œå®åœ¨å¤ªä½äº†ã€‚</li>\n</ul>\n<h2>11.7. ç”±Windowsè™šæ‹Ÿå†…å­˜å¯¼è‡´çš„é•¿æ—¶é—´åœé¡¿</h2>\n<ul>\n<li>æœ‰ä¸€ä¸ªå¸¦å¿ƒè·³æ£€æµ‹åŠŸèƒ½çš„GUIæ¡Œé¢ç¨‹åºï¼Œæ¯15ç§’ä¼šå‘é€ä¸€æ¬¡å¿ƒè·³æ£€æµ‹ä¿¡å·ï¼Œå¦‚æœå¯¹æ–¹30ç§’ä»¥å†…éƒ½æ²¡æœ‰ä¿¡å·è¿”å›ï¼Œé‚£å°±è®¤ä¸ºå’Œå¯¹æ–¹ç¨‹åºçš„è¿æ¥å·²ç»æ–­å¼€ã€‚ç¨‹åºä¸Šçº¿åå‘ç°å¿ƒè·³æ£€æµ‹æœ‰è¯¯æŠ¥çš„æ¦‚ç‡ï¼ŒæŸ¥è¯¢æ—¥å¿—å‘ç°è¯¯æŠ¥çš„åŸå› æ˜¯ç¨‹åºä¼šå¶å°”å‡ºç°é—´éš”çº¦ä¸€åˆ†é’Ÿå·¦å³çš„æ—¶é—´å®Œå…¨æ— æ—¥å¿—è¾“å‡ºï¼Œå¤„äºåœé¡¿çŠ¶æ€ã€‚</li>\n<li>å› ä¸ºæ˜¯æ¡Œé¢ç¨‹åºï¼Œæ‰€éœ€çš„å†…å­˜å¹¶ä¸å¤§ï¼ˆ-Xmx256mï¼‰ï¼Œæ‰€ä»¥å¼€å§‹å¹¶æ²¡æœ‰æƒ³åˆ°æ˜¯GCå¯¼è‡´çš„ç¨‹åºåœé¡¿ï¼Œä½†æ˜¯åŠ å…¥å‚æ•°-XXï¼š+PrintGCApplicationStoppedTime-XXï¼š+PrintGCDateStamps\u0002Xloggcï¼šgclog.logåï¼Œä»GCæ—¥å¿—æ–‡ä»¶ä¸­ç¡®è®¤äº†åœé¡¿ç¡®å®æ˜¯ç”±GCå¯¼è‡´çš„ï¼Œå¤§éƒ¨åˆ†GCæ—¶é—´éƒ½æ§åˆ¶åœ¨100æ¯«ç§’ä»¥å†…ï¼Œä½†å¶å°”å°±ä¼šå‡ºç°ä¸€æ¬¡æ¥è¿‘1åˆ†é’Ÿçš„GCã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Total time for which application threads were stoppedï¼š0.0112389 seconds\nTotal time for which application threads were stoppedï¼š0.0001335 seconds\nTotal time for which application threads were stoppedï¼š0.0003246 seconds\nTotal time for which application threads were stoppedï¼š41.4731411 seconds\nTotal time for which application threads were stoppedï¼š0.0489481 seconds\nTotal time for which application threads were stoppedï¼š0.1110761 seconds\nTotal time for which application threads were stoppedï¼š0.0007286 seconds\nTotal time for which application threads were stoppedï¼š0.0001268 seconds\n</code></pre></div><ul>\n<li>ä»GCæ—¥å¿—ä¸­æ‰¾åˆ°é•¿æ—¶é—´åœé¡¿çš„å…·ä½“æ—¥å¿—ä¿¡æ¯ï¼ˆæ·»åŠ äº†-XXï¼š+PrintReferenceGCå‚æ•°ï¼‰ï¼Œæ‰¾åˆ°çš„æ—¥å¿—ç‰‡æ®µå¦‚ä¸‹æ‰€ç¤ºã€‚ä»æ—¥å¿—ä¸­å¯ä»¥çœ‹å‡ºï¼ŒçœŸæ­£æ‰§è¡ŒGCåŠ¨ä½œçš„æ—¶é—´ä¸æ˜¯å¾ˆé•¿ï¼Œä½†ä»å‡†å¤‡å¼€å§‹GCï¼Œåˆ°çœŸæ­£å¼€å§‹GCä¹‹é—´æ‰€æ¶ˆè€—çš„æ—¶é—´å´å äº†ç»å¤§éƒ¨åˆ†ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>2012-08-29T19ï¼š14ï¼š30.968+0800ï¼š10069.800ï¼š[GC10099.225ï¼š[SoftReferenceï¼Œ0 refsï¼Œ0.0000109 secs]10099.226ï¼š[WeakReferenceï¼Œ4072 refsï¼Œ0.0012099\nsecs]10099.227ï¼š[FinalReferenceï¼Œ984 refsï¼Œ1.5822450 secs]10100.809ï¼š[PhantomReferenceï¼Œ251 refsï¼Œ0.0001394 secs]10100.809ï¼š[JNI Weak Referenceï¼Œ0.0994015 secs]\n[PSYoungGenï¼š175672K-ï¼8528Kï¼ˆ167360Kï¼‰]251523K-ï¼100182Kï¼ˆ353152Kï¼‰ï¼Œ31.1580402 secs][Timesï¼šuser=0.61 sys=0.52ï¼Œreal=31.16 secs]\n</code></pre></div><ul>\n<li>é™¤GCæ—¥å¿—ä¹‹å¤–ï¼Œè¿˜è§‚å¯Ÿåˆ°è¿™ä¸ªGUIç¨‹åºå†…å­˜å˜åŒ–çš„ä¸€ä¸ªç‰¹ç‚¹ï¼Œå½“å®ƒæœ€å°åŒ–çš„æ—¶å€™ï¼Œèµ„æºç®¡ç†ä¸­æ˜¾ç¤ºçš„å ç”¨å†…å­˜å¤§å¹…åº¦å‡å°ï¼Œä½†æ˜¯è™šæ‹Ÿå†…å­˜åˆ™æ²¡æœ‰å˜åŒ–ï¼Œå› æ­¤æ€€ç–‘ç¨‹åºåœ¨æœ€å°åŒ–æ—¶å®ƒçš„å·¥ä½œå†…å­˜è¢«è‡ªåŠ¨äº¤æ¢åˆ°ç£ç›˜çš„é¡µé¢æ–‡ä»¶ä¹‹ä¸­äº†ï¼Œè¿™æ ·å‘ç”ŸGCæ—¶å°±æœ‰å¯èƒ½å› ä¸ºæ¢å¤é¡µé¢æ–‡ä»¶çš„æ“ä½œè€Œå¯¼è‡´ä¸æ­£å¸¸çš„GCåœé¡¿ã€‚åœ¨Javaçš„GUIç¨‹åºä¸­è¦é¿å…è¿™ç§ç°è±¡ï¼Œå¯ä»¥åŠ å…¥å‚æ•°â€œ-Dsun.awt.keepWorkingSetOnMinimize=trueâ€æ¥è§£å†³ã€‚è¿™ä¸ªå‚æ•°åœ¨è®¸å¤šAWTçš„ç¨‹åºä¸Šéƒ½æœ‰åº”ç”¨ï¼Œä¾‹å¦‚JDKè‡ªå¸¦çš„Visual VMï¼Œç”¨äºä¿è¯ç¨‹åºåœ¨æ¢å¤æœ€å°åŒ–æ—¶èƒ½å¤Ÿç«‹å³å“åº”ã€‚åœ¨è¿™ä¸ªæ¡ˆä¾‹ä¸­åŠ å…¥è¯¥å‚æ•°åï¼Œé—®é¢˜å¾—åˆ°è§£å†³ã€‚</li>\n</ul>\n<h1>12. è™šæ‹Ÿæœºæ‰§è¡Œå­ç³»ç»Ÿ</h1>\n<h2>12.1. ç±»æ–‡ä»¶ç»“æ„</h2>\n<ul>\n<li>ä»£ç ç¼–è¯‘çš„ç»“æœä»æœ¬åœ°æœºå™¨ç è½¬å˜ä¸ºå­—èŠ‚ç ï¼Œå®ç°è¯­è¨€ï¼Œå¹³å°æ— å…³æ€§çš„åŸºç¡€æ˜¯è™šæ‹Ÿæœºå’Œå­—èŠ‚ç å­˜å‚¨æ ¼å¼ã€‚Javaè™šæ‹Ÿæœºä¸å’ŒåŒ…æ‹¬Javaåœ¨å†…çš„ä»»ä½•è¯­è¨€ç»‘å®šï¼Œå®ƒåªä¸â€œClassæ–‡ä»¶â€è¿™ç§ç‰¹å®šçš„äºŒè¿›åˆ¶æ–‡ä»¶æ ¼å¼æ‰€å…³è”ï¼ŒClassæ–‡ä»¶ä¸­åŒ…å«äº†Javaè™šæ‹ŸæœºæŒ‡ä»¤é›†å’Œç¬¦å·è¡¨ä»¥åŠè‹¥å¹²å…¶ä»–è¾…åŠ©ä¿¡æ¯ã€‚åŸºäºå®‰å…¨æ–¹é¢çš„è€ƒè™‘ï¼ŒJavaè™šæ‹Ÿæœºè§„èŒƒè¦æ±‚åœ¨Classæ–‡ä»¶ä¸­ä½¿ç”¨è®¸å¤šå¼ºåˆ¶æ€§çš„è¯­æ³•å’Œç»“æ„åŒ–çº¦æŸï¼Œä½†ä»»ä¸€é—¨åŠŸèƒ½æ€§è¯­è¨€éƒ½å¯ä»¥è¡¨ç¤ºä¸ºä¸€ä¸ªèƒ½è¢«Javaè™šæ‹Ÿæœºæ‰€æ¥å—çš„æœ‰æ•ˆçš„Classæ–‡ä»¶ã€‚ä½œä¸ºä¸€ä¸ªé€šç”¨çš„ã€æœºå™¨æ— å…³çš„æ‰§è¡Œå¹³å°ï¼Œä»»ä½•å…¶ä»–è¯­è¨€çš„å®ç°è€…éƒ½å¯ä»¥å°†Javaè™šæ‹Ÿæœºä½œä¸ºè¯­è¨€çš„äº§å“äº¤ä»˜åª’ä»‹ã€‚è™šæ‹Ÿæœºå¹¶ä¸å…³å¿ƒClassçš„æ¥æºæ˜¯ä½•ç§è¯­è¨€</li>\n<li>Javaè¯­è¨€ä¸­çš„å„ç§å˜é‡ã€å…³é”®å­—å’Œè¿ç®—ç¬¦å·çš„è¯­ä¹‰æœ€ç»ˆéƒ½æ˜¯ç”±å¤šæ¡å­—èŠ‚ç å‘½ä»¤ç»„åˆè€Œæˆçš„ï¼Œå› æ­¤å­—èŠ‚ç å‘½ä»¤æ‰€èƒ½æä¾›çš„è¯­ä¹‰æè¿°èƒ½åŠ›è‚¯å®šä¼šæ¯”Javaè¯­è¨€æœ¬èº«æ›´åŠ å¼ºå¤§ã€‚å› æ­¤ï¼Œæœ‰ä¸€äº›Javaè¯­è¨€æœ¬èº«æ— æ³•æœ‰æ•ˆæ”¯æŒçš„è¯­è¨€ç‰¹æ€§ä¸ä»£è¡¨å­—èŠ‚ç æœ¬èº«æ— æ³•æœ‰æ•ˆæ”¯æŒï¼Œè¿™ä¹Ÿä¸ºå…¶ä»–è¯­è¨€å®ç°ä¸€äº›æœ‰åˆ«äºJavaçš„è¯­è¨€ç‰¹æ€§æä¾›äº†åŸºç¡€ã€‚</li>\n</ul>\n<h2>12.2. Classç±»æ–‡ä»¶çš„ç»“æ„</h2>\n<ul>\n<li>ä»»ä½•ä¸€ä¸ªClassæ–‡ä»¶éƒ½å¯¹åº”ç€å”¯ä¸€ä¸€ä¸ªç±»æˆ–æ¥å£çš„å®šä¹‰ä¿¡æ¯ï¼Œä½†åè¿‡æ¥è¯´ï¼Œç±»æˆ–æ¥å£å¹¶ä¸ä¸€å®šéƒ½å¾—å®šä¹‰åœ¨æ–‡ä»¶é‡Œï¼ˆè­¬å¦‚ç±»æˆ–æ¥å£ä¹Ÿå¯ä»¥é€šè¿‡ç±»åŠ è½½å™¨ç›´æ¥ç”Ÿæˆï¼‰ã€‚</li>\n<li>Classæ–‡ä»¶æ˜¯ä¸€ç»„ä»¥8ä½å­—èŠ‚ä¸ºåŸºç¡€å•ä½çš„äºŒè¿›åˆ¶æµï¼Œå„ä¸ªæ•°æ®é¡¹ç›®ä¸¥æ ¼æŒ‰ç…§é¡ºåºç´§å‡‘åœ°æ’åˆ—åœ¨Classæ–‡ä»¶ä¹‹ä¸­ï¼Œä¸­é—´æ²¡æœ‰æ·»åŠ ä»»ä½•åˆ†éš”ç¬¦ï¼Œè¿™ä½¿å¾—æ•´ä¸ªClassæ–‡ä»¶ä¸­å­˜å‚¨çš„å†…å®¹å‡ ä¹å…¨éƒ¨æ˜¯ç¨‹åºè¿è¡Œçš„å¿…è¦æ•°æ®ï¼Œæ²¡æœ‰ç©ºéš™å­˜åœ¨ã€‚å½“é‡åˆ°éœ€è¦å ç”¨8ä½å­—èŠ‚ä»¥ä¸Šç©ºé—´çš„æ•°æ®é¡¹æ—¶ï¼Œåˆ™ä¼šæŒ‰ç…§é«˜ä½åœ¨å‰çš„æ–¹å¼åˆ†å‰²æˆè‹¥å¹²ä¸ª8ä½å­—èŠ‚è¿›è¡Œå­˜å‚¨ã€‚</li>\n<li>æ ¹æ®Javaè™šæ‹Ÿæœºè§„èŒƒçš„è§„å®šï¼ŒClassæ–‡ä»¶æ ¼å¼é‡‡ç”¨ä¸€ç§ç±»ä¼¼äºCè¯­è¨€ç»“æ„ä½“çš„ä¼ªç»“æ„æ¥å­˜å‚¨æ•°æ®ï¼Œè¿™ç§ä¼ªç»“æ„ä¸­åªæœ‰ä¸¤ç§æ•°æ®ç±»å‹ï¼šæ— ç¬¦å·æ•°å’Œè¡¨\n<ul>\n<li>æ— ç¬¦å·æ•°å±äºåŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œä»¥u1ã€u2ã€u4ã€u8æ¥åˆ†åˆ«ä»£è¡¨1ä¸ªå­—èŠ‚ã€2ä¸ªå­—èŠ‚ã€4ä¸ªå­—èŠ‚å’Œ8ä¸ªå­—èŠ‚çš„æ— ç¬¦å·æ•°ï¼Œæ— ç¬¦å·æ•°å¯ä»¥ç”¨æ¥æè¿°æ•°å­—ã€ç´¢å¼•å¼•ç”¨ã€æ•°é‡å€¼æˆ–è€…æŒ‰ç…§UTF-8ç¼–ç æ„æˆå­—ç¬¦ä¸²å€¼ã€‚</li>\n<li>è¡¨æ˜¯ç”±å¤šä¸ªæ— ç¬¦å·æ•°æˆ–è€…å…¶ä»–è¡¨ä½œä¸ºæ•°æ®é¡¹æ„æˆçš„å¤åˆæ•°æ®ç±»å‹ï¼Œæ‰€æœ‰è¡¨éƒ½ä¹ æƒ¯æ€§åœ°ä»¥â€œ_infoâ€ç»“å°¾ã€‚è¡¨ç”¨äºæè¿°æœ‰å±‚æ¬¡å…³ç³»çš„å¤åˆç»“æ„çš„æ•°æ®ï¼Œæ•´ä¸ªClassæ–‡ä»¶æœ¬è´¨ä¸Šå°±æ˜¯ä¸€å¼ è¡¨ï¼Œå®ƒç”±è¡¨æ‰€ç¤ºçš„æ•°æ®é¡¹æ„æˆ</li>\n</ul>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ•°é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">u4</td>\n<td style=\"text-align:center\">magic</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">minor_version</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">major_version</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">constant_pool_count</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">cp_info</td>\n<td style=\"text-align:center\">constatnt_pool</td>\n<td style=\"text-align:center\">constant_pool_count-1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">access_flags</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">this_class</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">super_class</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">interfaces_count</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">interfaces</td>\n<td style=\"text-align:center\">interfaces_count</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">fields_count</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">field_info</td>\n<td style=\"text-align:center\">fields</td>\n<td style=\"text-align:center\">fields_count</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">method_count</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">methods_info</td>\n<td style=\"text-align:center\">methods</td>\n<td style=\"text-align:center\">methods_count</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">attributes_count</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">attributes</td>\n<td style=\"text-align:center\">attributes</td>\n<td style=\"text-align:center\">attributes_count</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>\n<p>æ— è®ºæ˜¯æ— ç¬¦å·æ•°è¿˜æ˜¯è¡¨ï¼Œå½“éœ€è¦æè¿°åŒä¸€ç±»å‹ä½†æ•°é‡ä¸å®šçš„å¤šä¸ªæ•°æ®æ—¶ï¼Œç»å¸¸ä¼šä½¿ç”¨ä¸€ä¸ªå‰ç½®çš„å®¹é‡è®¡æ•°å™¨åŠ è‹¥å¹²ä¸ªè¿ç»­çš„æ•°æ®é¡¹çš„å½¢å¼ï¼Œè¿™æ—¶ç§°è¿™ä¸€ç³»åˆ—è¿ç»­çš„æŸä¸€ç±»å‹çš„æ•°æ®ä¸ºæŸä¸€ç±»å‹çš„é›†åˆ</p>\n</li>\n<li>\n<p>demoä»£ç ä¸ä½¿ç”¨WinHexæ‰“å¼€classæ–‡ä»¶çš„ç»“æœ</p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package org.fenixsoft.clazzï¼›\n  public class TestClass{\n  private int mï¼›\n  public int incï¼ˆï¼‰{\n  return m+1ï¼›\n  }\n}\n</code></pre></div><p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4d17e9d2e21e9846c612c.png\" alt=\"\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/955dbf691fa6ce075bdc5.png\" alt=\"javapTestClass.png\"></p>\n<h3>12.2.1. magicï¼Œminor_versionï¼Œmajor_version</h3>\n<ul>\n<li>æ¯ä¸ªClassæ–‡ä»¶çš„å¤´4ä¸ªå­—èŠ‚ç§°ä¸ºé­”æ•°ï¼ˆMagic Numberï¼‰ï¼Œå®ƒçš„å”¯ä¸€ä½œç”¨æ˜¯ç¡®å®šè¿™ä¸ªæ–‡ä»¶æ˜¯å¦ä¸ºä¸€ä¸ªèƒ½è¢«è™šæ‹Ÿæœºæ¥å—çš„Classæ–‡ä»¶ã€‚ä½¿ç”¨é­”æ•°è€Œä¸æ˜¯æ‰©å±•åæ¥è¿›è¡Œè¯†åˆ«ä¸»è¦æ˜¯åŸºäºå®‰å…¨æ–¹é¢çš„è€ƒè™‘ï¼Œå› ä¸ºæ–‡ä»¶æ‰©å±•åå¯ä»¥éšæ„åœ°æ”¹åŠ¨ã€‚æ–‡ä»¶æ ¼å¼çš„åˆ¶å®šè€…å¯ä»¥è‡ªç”±åœ°é€‰æ‹©é­”æ•°å€¼ï¼Œåªè¦è¿™ä¸ªé­”æ•°å€¼è¿˜æ²¡æœ‰è¢«å¹¿æ³›é‡‡ç”¨è¿‡åŒæ—¶åˆä¸ä¼šå¼•èµ·æ··æ·†å³å¯ã€‚Classæ–‡ä»¶çš„é­”æ•°å€¼ä¸ºï¼š0xCAFEBABEï¼ˆå’–å•¡å®è´ï¼Ÿï¼‰</li>\n<li>ç´§æ¥ç€é­”æ•°çš„4ä¸ªå­—èŠ‚å­˜å‚¨çš„æ˜¯Classæ–‡ä»¶çš„ç‰ˆæœ¬å·ï¼šç¬¬5å’Œç¬¬6ä¸ªå­—èŠ‚æ˜¯æ¬¡ç‰ˆæœ¬å·ï¼ˆMinor Versionï¼‰ï¼Œç¬¬7å’Œç¬¬8ä¸ªå­—èŠ‚æ˜¯ä¸»ç‰ˆæœ¬å·ï¼ˆMajor Versionï¼‰ã€‚é«˜ç‰ˆæœ¬çš„JDKèƒ½å‘ä¸‹å…¼å®¹ä»¥å‰ç‰ˆæœ¬çš„Classæ–‡ä»¶ï¼Œä½†ä¸èƒ½è¿è¡Œä»¥åç‰ˆæœ¬çš„Classæ–‡ä»¶ï¼Œå³ä½¿æ–‡ä»¶æ ¼å¼å¹¶æœªå‘ç”Ÿä»»ä½•å˜åŒ–ï¼Œè™šæ‹Ÿæœºä¹Ÿå¿…é¡»æ‹’ç»æ‰§è¡Œè¶…è¿‡å…¶ç‰ˆæœ¬å·çš„Classæ–‡ä»¶ã€‚</li>\n</ul>\n<h3>12.2.2. å¸¸é‡æ± </h3>\n<ul>\n<li>ç´§æ¥ç€ä¸»æ¬¡ç‰ˆæœ¬å·ä¹‹åçš„æ˜¯å¸¸é‡æ± å…¥å£ï¼Œå®ƒæ˜¯Classæ–‡ä»¶ç»“æ„ä¸­ä¸å…¶ä»–é¡¹ç›®å…³è”æœ€å¤šçš„æ•°æ®ç±»å‹ï¼Œä¹Ÿæ˜¯å ç”¨Classæ–‡ä»¶ç©ºé—´æœ€å¤§çš„æ•°æ®é¡¹ç›®ä¹‹ä¸€ï¼ŒåŒæ—¶å®ƒè¿˜æ˜¯åœ¨Classæ–‡ä»¶ä¸­ç¬¬ä¸€ä¸ªå‡ºç°çš„è¡¨ç±»å‹æ•°æ®é¡¹ç›®ã€‚ç”±äºå¸¸é‡æ± ä¸­å¸¸é‡çš„æ•°é‡æ˜¯ä¸å›ºå®šçš„ï¼Œæ‰€ä»¥åœ¨å¸¸é‡æ± çš„å…¥å£éœ€è¦æ”¾ç½®ä¸€é¡¹u2ç±»å‹çš„æ•°æ®ï¼Œä»£è¡¨å¸¸é‡æ± å®¹é‡è®¡æ•°å€¼ï¼ˆconstant_pool_countï¼‰ã€‚è¿™ä¸ªå®¹é‡è®¡æ•°æ˜¯ä»1è€Œä¸æ˜¯0å¼€å§‹çš„ï¼Œ</li>\n<li>åœ¨Classæ–‡ä»¶æ ¼å¼è§„èŒƒåˆ¶å®šä¹‹æ—¶ï¼Œè®¾è®¡è€…å°†ç¬¬0é¡¹å¸¸é‡ç©ºå‡ºæ¥æ˜¯æœ‰ç‰¹æ®Šè€ƒè™‘çš„ï¼Œè¿™æ ·åšçš„ç›®çš„åœ¨äºæ»¡è¶³åé¢æŸäº›æŒ‡å‘å¸¸é‡æ± çš„ç´¢å¼•å€¼çš„æ•°æ®åœ¨ç‰¹å®šæƒ…å†µä¸‹éœ€è¦è¡¨è¾¾â€œä¸å¼•ç”¨ä»»ä½•ä¸€ä¸ªå¸¸é‡æ± é¡¹ç›®â€çš„å«ä¹‰ï¼Œè¿™ç§æƒ…å†µå°±å¯ä»¥æŠŠç´¢å¼•å€¼ç½®ä¸º0æ¥è¡¨ç¤ºã€‚Classæ–‡ä»¶ç»“æ„ä¸­åªæœ‰å¸¸é‡æ± çš„å®¹é‡è®¡æ•°æ˜¯ä»1å¼€å§‹ï¼Œå¯¹äºå…¶ä»–é›†åˆç±»å‹ï¼ŒåŒ…æ‹¬æ¥å£ç´¢å¼•é›†åˆã€å­—æ®µè¡¨é›†åˆã€æ–¹æ³•è¡¨é›†åˆç­‰çš„å®¹é‡è®¡æ•°éƒ½æ˜¯ä»0å¼€å§‹çš„ã€‚</li>\n<li>å¸¸é‡æ± ä¸­ä¸»è¦å­˜æ”¾ä¸¤å¤§ç±»å¸¸é‡ï¼šå­—é¢é‡ï¼ˆLiteralï¼‰å’Œç¬¦å·å¼•ç”¨ï¼ˆSymbolic Referencesï¼‰ã€‚\n<ul>\n<li>å­—é¢é‡æ¯”è¾ƒæ¥è¿‘äºJavaè¯­è¨€å±‚é¢çš„å¸¸é‡æ¦‚å¿µï¼Œå¦‚æ–‡æœ¬å­—ç¬¦ä¸²ã€å£°æ˜ä¸ºfinalçš„å¸¸é‡å€¼ç­‰ã€‚</li>\n<li>ç¬¦å·å¼•ç”¨åˆ™å±äºç¼–è¯‘åŸç†æ–¹é¢çš„æ¦‚å¿µï¼ŒåŒ…æ‹¬äº†ä¸‹é¢ä¸‰ç±»å¸¸é‡ï¼š\n<ul>\n<li>ç±»å’Œæ¥å£çš„å…¨é™å®šåï¼ˆFully Qualified Nameï¼‰</li>\n<li>å­—æ®µçš„åç§°å’Œæè¿°ç¬¦ï¼ˆDescriptorï¼‰</li>\n<li>æ–¹æ³•çš„åç§°å’Œæè¿°ç¬¦</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Javaä»£ç åœ¨è¿›è¡ŒJavacç¼–è¯‘çš„æ—¶å€™ï¼Œåœ¨è™šæ‹ŸæœºåŠ è½½Classæ–‡ä»¶çš„æ—¶å€™è¿›è¡ŒåŠ¨æ€è¿æ¥ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œåœ¨Classæ–‡ä»¶ä¸­ä¸ä¼šä¿å­˜å„ä¸ªæ–¹æ³•ã€å­—æ®µçš„æœ€ç»ˆå†…å­˜å¸ƒå±€ä¿¡æ¯ï¼Œå› æ­¤è¿™äº›å­—æ®µã€æ–¹æ³•çš„ç¬¦å·å¼•ç”¨ä¸ç»è¿‡è¿è¡ŒæœŸè½¬æ¢çš„è¯æ— æ³•å¾—åˆ°çœŸæ­£çš„å†…å­˜å…¥å£åœ°å€ï¼Œä¹Ÿå°±æ— æ³•ç›´æ¥è¢«è™šæ‹Ÿæœºä½¿ç”¨ã€‚å½“è™šæ‹Ÿæœºè¿è¡Œæ—¶ï¼Œéœ€è¦ä»å¸¸é‡æ± è·å¾—å¯¹åº”çš„ç¬¦å·å¼•ç”¨ï¼Œå†åœ¨ç±»åˆ›å»ºæ—¶æˆ–è¿è¡Œæ—¶è§£æã€ç¿»è¯‘åˆ°å…·ä½“çš„å†…å­˜åœ°å€ä¹‹ä¸­ã€‚</li>\n<li>å¸¸é‡æ± ä¸­æ¯ä¸€é¡¹å¸¸é‡éƒ½æ˜¯ä¸€ä¸ªè¡¨ï¼Œå…±æœ‰14ç§è¡¨ï¼Œè¿™14ç§è¡¨éƒ½æœ‰ä¸€ä¸ªå…±åŒçš„ç‰¹ç‚¹ï¼Œå°±æ˜¯è¡¨å¼€å§‹çš„ç¬¬ä¸€ä½æ˜¯ä¸€ä¸ªu1ç±»å‹çš„æ ‡å¿—ä½ï¼ˆtagï¼Œå–å€¼è§è¡¨6-3ä¸­æ ‡å¿—åˆ—ï¼‰ï¼Œä»£è¡¨å½“å‰è¿™ä¸ªå¸¸é‡å±äºå“ªç§å¸¸é‡ç±»å‹ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">æ ‡å¿—</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Utf8_info</td>\n<td style=\"text-align:center\">1</td>\n<td style=\"text-align:center\">UTF-8ç¼–ç çš„å­—ç¬¦ä¸²</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Integer_info</td>\n<td style=\"text-align:center\">3</td>\n<td style=\"text-align:center\">æ•´å‹å­—é¢é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Float_info</td>\n<td style=\"text-align:center\">4</td>\n<td style=\"text-align:center\">æµ®ç‚¹å‹å­—é¢é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Long_info</td>\n<td style=\"text-align:center\">5</td>\n<td style=\"text-align:center\">é•¿æ•´å‹å­—é¢é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Double_info</td>\n<td style=\"text-align:center\">6</td>\n<td style=\"text-align:center\">åŒç²¾åº¦æµ®ç‚¹å‹é¢é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Class_info</td>\n<td style=\"text-align:center\">7</td>\n<td style=\"text-align:center\">ç±»æˆ–æ¥å£çš„ç¬¦å·å¼•ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_String_info</td>\n<td style=\"text-align:center\">8</td>\n<td style=\"text-align:center\">å­—ç¬¦ä¸²ç±»å‹å­—é¢é‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Fieldref_info</td>\n<td style=\"text-align:center\">9</td>\n<td style=\"text-align:center\">å­—æ®µçš„ç¬¦å·å¼•ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_Methodred_info</td>\n<td style=\"text-align:center\">10</td>\n<td style=\"text-align:center\">ç±»ä¸­æ–¹æ³•çš„ç¬¦å·å¼•ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_InterfaceMethodref_info</td>\n<td style=\"text-align:center\">11</td>\n<td style=\"text-align:center\">æ¥å£ä¸­æ–¹æ³•ç¬¦å·å¼•ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_NameAndType_info</td>\n<td style=\"text-align:center\">12</td>\n<td style=\"text-align:center\">å­—æ®µæˆ–æ–¹æ³•çš„éƒ¨åˆ†ç¬¦å·å¼•ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_MethodHandle_info</td>\n<td style=\"text-align:center\">15</td>\n<td style=\"text-align:center\">è¡¨ç¤ºæ–¹æ³•å¥æŸ„</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_MethodType_info</td>\n<td style=\"text-align:center\">16</td>\n<td style=\"text-align:center\">è¡¨ç¤ºæ–¹æ³•ç±»å‹</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">CONSTANT_InvokeDynamic_info</td>\n<td style=\"text-align:center\">18</td>\n<td style=\"text-align:center\">è¡¨ç¤ºä¸€ä¸ªåŠ¨æ€æ–¹æ³•è°ƒç”¨ç‚¹</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>\n<p>14ç§å¸¸é‡ç±»å‹å„è‡ªå‡æœ‰è‡ªå·±çš„ç»“æ„ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c478680fbe6480ddca3d4.png\" alt=\"å¸¸é‡æ± .png\"></p>\n</li>\n<li>\n<p>tagæ˜¯æ ‡å¿—ä½ï¼Œå®ƒç”¨äºåŒºåˆ†å¸¸é‡ç±»å‹ï¼›name_indexæ˜¯ä¸€ä¸ªç´¢å¼•å€¼ï¼Œå®ƒæŒ‡å‘å¸¸é‡æ± ä¸­ä¸€ä¸ªCONSTANT_Utf8_infoç±»å‹å¸¸é‡ï¼Œæ­¤å¸¸é‡ä»£è¡¨äº†è¿™ä¸ªç±»ï¼ˆæˆ–è€…æ¥å£ï¼‰çš„å…¨é™å®šå</p>\n</li>\n<li>\n<p>lengthå€¼è¯´æ˜äº†è¿™ä¸ªUTF-8ç¼–ç çš„å­—ç¬¦ä¸²é•¿åº¦æ˜¯å¤šå°‘å­—èŠ‚ï¼Œå®ƒåé¢ç´§è·Ÿç€çš„é•¿åº¦ä¸ºlengthå­—èŠ‚çš„è¿ç»­æ•°æ®æ˜¯ä¸€ä¸ªä½¿ç”¨UTF-8ç¼©ç•¥ç¼–ç è¡¨ç¤ºçš„å­—ç¬¦ä¸²ã€‚UTF-8ç¼©ç•¥ç¼–ç ä¸æ™®é€šUTF-8ç¼–ç çš„åŒºåˆ«æ˜¯ï¼šä»'\\u0001'åˆ°'\\u007f'ä¹‹é—´çš„å­—ç¬¦ï¼ˆç›¸å½“äº1ï½127çš„ASCIIç ï¼‰çš„ç¼©ç•¥ç¼–ç ä½¿ç”¨ä¸€ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä»'\\u0080'åˆ°'\\u07ff'ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦çš„ç¼©ç•¥ç¼–ç ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºï¼Œä»'\\u0800'åˆ°'\\uffff'ä¹‹é—´çš„æ‰€æœ‰å­—ç¬¦çš„ç¼©ç•¥ç¼–ç å°±æŒ‰ç…§æ™®é€šUTF-8ç¼–ç è§„åˆ™ä½¿ç”¨ä¸‰ä¸ªå­—èŠ‚è¡¨ç¤ºã€‚</p>\n</li>\n<li>\n<p>æœ¬ä¾‹ä¸­è¿™ä¸ªå­—ç¬¦ä¸²çš„lengthå€¼ï¼ˆåç§»åœ°å€ï¼š0x0000000Eï¼‰ä¸º0x001Dï¼Œä¹Ÿå°±æ˜¯é•¿29å­—èŠ‚ï¼Œ<br>\nå¾€å29å­—èŠ‚æ­£å¥½éƒ½åœ¨1ï½127çš„ASCIIç èŒƒå›´ä»¥å†…</p>\n</li>\n<li>\n<p>ç”±äºClassæ–‡ä»¶ä¸­æ–¹æ³•ã€å­—æ®µç­‰éƒ½éœ€è¦å¼•ç”¨CONSTANT_Utf8_infoå‹å¸¸é‡æ¥æè¿°åç§°ï¼Œæ‰€ä»¥CONSTANT_Utf8_infoå‹å¸¸é‡çš„æœ€å¤§é•¿åº¦ä¹Ÿå°±æ˜¯Javaä¸­æ–¹æ³•ã€å­—æ®µåçš„æœ€å¤§é•¿åº¦ã€‚è€Œè¿™é‡Œçš„æœ€å¤§é•¿åº¦å°±æ˜¯lengthçš„æœ€å¤§å€¼ï¼Œæ—¢u2ç±»å‹èƒ½è¡¨è¾¾çš„æœ€å¤§å€¼65535ã€‚æ‰€ä»¥Javaç¨‹åºä¸­å¦‚æœå®šä¹‰äº†è¶…è¿‡64KBè‹±æ–‡å­—ç¬¦çš„å˜é‡æˆ–æ–¹æ³•åï¼Œå°†ä¼šæ— æ³•ç¼–è¯‘ã€‚</p>\n</li>\n<li>\n<p>åœ¨JDKçš„binç›®å½•ä¸­ï¼Œä¸€ä¸ªä¸“é—¨ç”¨äºåˆ†æClassæ–‡ä»¶å­—èŠ‚ç çš„å·¥å…·ï¼šjavapï¼Œä»£ç æ¸…å•6-2ä¸­åˆ—å‡ºäº†ä½¿ç”¨javapå·¥å…·çš„-verboseå‚æ•°è¾“å‡ºçš„TestClass.classæ–‡ä»¶å­—èŠ‚ç å†…å®¹ï¼ˆæ­¤æ¸…å•ä¸­çœç•¥äº†å¸¸é‡æ± ä»¥å¤–çš„ä¿¡æ¯ï¼‰.Classæ–‡ä»¶ä¸­è¿˜æœ‰å¾ˆå¤šæ•°æ®é¡¹éƒ½è¦å¼•ç”¨å¸¸é‡æ± ä¸­çš„å¸¸é‡</p>\n</li>\n</ul>\n<h2>12.3. è®¿é—®æ ‡å¿—ï¼ˆaccess_flagsï¼‰</h2>\n<ul>\n<li>æ ‡å¿—ç”¨äºè¯†åˆ«ä¸€äº›ç±»æˆ–è€…æ¥å£å±‚æ¬¡çš„è®¿é—®ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼šè¿™ä¸ªClassæ˜¯ç±»è¿˜æ˜¯æ¥å£ï¼›æ˜¯å¦å®šä¹‰ä¸ºpublicç±»å‹ï¼›æ˜¯å¦å®šä¹‰ä¸ºabstractç±»å‹ï¼›å¦‚æœæ˜¯ç±»çš„è¯ï¼Œæ˜¯å¦è¢«å£°æ˜ä¸ºfinalç­‰ã€‚access_flagsä¸­ä¸€å…±æœ‰16ä¸ªæ ‡å¿—ä½å¯ä»¥ä½¿ç”¨ï¼Œå½“å‰åªå®šä¹‰äº†å…¶ä¸­8ä¸ªï¼Œæ²¡æœ‰ä½¿ç”¨åˆ°çš„æ ‡å¿—ä½è¦æ±‚ä¸€å¾‹ä¸º0ã€‚å°†åŒ¹é…çš„æ ‡å¿—ä½å…¨éƒ¨è¿›è¡Œæˆ–æ“ä½œï¼Œå³å¯è·å¾—è®¿é—®æ ‡å¿—çš„å€¼</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/08eaede8df6a15e54b94d.png\" alt=\"è®¿é—®æ ‡å¿—.png\" tabindex=\"0\"><figcaption>è®¿é—®æ ‡å¿—.png</figcaption></figure>\n<h2>12.4. ç±»ç´¢å¼•ã€çˆ¶ç±»ç´¢å¼•ä¸æ¥å£ç´¢å¼•é›†åˆ</h2>\n<ul>\n<li>ç±»ç´¢å¼•ï¼ˆthis_classï¼‰å’Œçˆ¶ç±»ç´¢å¼•ï¼ˆsuper_classï¼‰éƒ½æ˜¯ä¸€ä¸ªu2ç±»å‹çš„æ•°æ®ï¼Œè€Œæ¥å£ç´¢å¼•é›†åˆï¼ˆinterfacesï¼‰æ˜¯ä¸€ç»„u2ç±»å‹çš„æ•°æ®çš„é›†åˆï¼ŒClassæ–‡ä»¶ä¸­ç”±è¿™ä¸‰é¡¹æ•°æ®æ¥ç¡®å®šè¿™ä¸ªç±»çš„ç»§æ‰¿å…³ç³»ã€‚</li>\n<li>ç±»ç´¢å¼•ç”¨äºç¡®å®šè¿™ä¸ªç±»çš„å…¨é™å®šå</li>\n<li>çˆ¶ç±»ç´¢å¼•ç”¨äºç¡®å®šè¿™ä¸ªç±»çš„çˆ¶ç±»çš„å…¨é™å®šåã€‚é™¤äº†java.lang.Objectä¹‹å¤–ï¼Œæ‰€æœ‰çš„Javaç±»éƒ½æœ‰çˆ¶ç±»ï¼Œå› æ­¤é™¤äº†java.lang.Objectå¤–ï¼Œæ‰€æœ‰Javaç±»çš„çˆ¶ç±»ç´¢å¼•éƒ½ä¸ä¸º0ã€‚</li>\n<li>æ¥å£ç´¢å¼•é›†åˆå°±ç”¨æ¥æè¿°è¿™ä¸ªç±»å®ç°äº†å“ªäº›æ¥å£ï¼Œè¿™äº›è¢«å®ç°çš„æ¥å£å°†æŒ‰implementsè¯­å¥ï¼ˆå¦‚æœè¿™ä¸ªç±»æœ¬èº«æ˜¯ä¸€ä¸ªæ¥å£ï¼Œåˆ™åº”å½“æ˜¯extendsè¯­å¥ï¼‰åçš„æ¥å£é¡ºåºä»å·¦åˆ°å³æ’åˆ—åœ¨æ¥å£ç´¢å¼•é›†åˆä¸­ã€‚</li>\n<li>ç±»ç´¢å¼•å’Œçˆ¶ç±»ç´¢å¼•ç”¨ä¸¤ä¸ªu2ç±»å‹çš„ç´¢å¼•å€¼è¡¨ç¤ºï¼Œå®ƒä»¬å„è‡ªæŒ‡å‘ä¸€ä¸ªç±»å‹ä¸ºCONSTANT_Class_infoçš„ç±»æè¿°ç¬¦å¸¸é‡ï¼Œé€šè¿‡CONSTANT_Class_infoç±»å‹çš„å¸¸é‡ä¸­çš„ç´¢å¼•å€¼å¯ä»¥æ‰¾åˆ°å®šä¹‰åœ¨CONSTANT_Utf8_infoç±»å‹çš„å¸¸é‡ä¸­çš„å…¨é™å®šåå­—ç¬¦ä¸²ã€‚</li>\n<li>å¯¹äºæ¥å£ç´¢å¼•é›†åˆï¼Œç¬¬ä¸€é¡¹u2ç±»å‹çš„æ•°æ®ä¸ºæ¥å£è®¡æ•°å™¨ï¼ˆinterfaces_countï¼‰ï¼Œè¡¨ç¤ºç´¢å¼•è¡¨çš„å®¹é‡ã€‚å¦‚æœè¯¥ç±»æ²¡æœ‰å®ç°ä»»ä½•æ¥å£ï¼Œåˆ™è¯¥è®¡æ•°å™¨å€¼ä¸º0ï¼Œåé¢æ¥å£çš„ç´¢å¼•è¡¨ä¸å†å ç”¨ä»»ä½•å­—èŠ‚</li>\n</ul>\n<h2>12.5. å­—æ®µè¡¨é›†åˆ</h2>\n<ul>\n<li>å­—æ®µè¡¨ï¼ˆfield_infoï¼‰ç”¨äºæè¿°æ¥å£æˆ–è€…ç±»ä¸­å£°æ˜çš„å˜é‡ã€‚å­—æ®µï¼ˆfieldï¼‰åŒ…æ‹¬ç±»çº§å˜é‡ä»¥åŠå®ä¾‹çº§å˜é‡ï¼Œä½†ä¸åŒ…æ‹¬åœ¨æ–¹æ³•å†…éƒ¨å£°æ˜çš„å±€éƒ¨å˜é‡ã€‚Javaä¸­æè¿°ä¸€ä¸ªå­—æ®µå¯ä»¥åŒ…æ‹¬çš„ä¿¡æ¯æœ‰ï¼šå­—æ®µçš„ä½œç”¨åŸŸï¼ˆpublicã€privateã€protectedä¿®é¥°ç¬¦ï¼‰ã€æ˜¯å®ä¾‹å˜é‡è¿˜æ˜¯ç±»å˜é‡ï¼ˆstaticä¿®é¥°ç¬¦ï¼‰ã€å¯å˜æ€§ï¼ˆfinalï¼‰ã€å¹¶å‘å¯è§æ€§ï¼ˆvolatileä¿®é¥°ç¬¦ï¼Œæ˜¯å¦å¼ºåˆ¶ä»ä¸»å†…å­˜è¯»å†™ï¼‰ã€å¯å¦è¢«åºåˆ—åŒ–ï¼ˆtransientä¿®é¥°ç¬¦ï¼‰ã€å­—æ®µæ•°æ®ç±»å‹ï¼ˆåŸºæœ¬ç±»å‹ã€å¯¹è±¡ã€æ•°ç»„ï¼‰ã€å­—æ®µåç§°ã€‚ä¸Šè¿°è¿™äº›ä¿¡æ¯ä¸­ï¼Œå„ä¸ªä¿®é¥°ç¬¦éƒ½æ˜¯å¸ƒå°”å€¼ï¼Œè¦ä¹ˆæœ‰æŸä¸ªä¿®é¥°ç¬¦ï¼Œè¦ä¹ˆæ²¡æœ‰ï¼Œå¾ˆé€‚åˆä½¿ç”¨æ ‡å¿—ä½æ¥è¡¨ç¤ºã€‚è€Œå­—æ®µå«ä»€ä¹ˆåå­—ã€å­—æ®µè¢«å®šä¹‰ä¸ºä»€ä¹ˆæ•°æ®ç±»å‹ï¼Œè¿™äº›éƒ½æ˜¯æ— æ³•å›ºå®šçš„ï¼Œåªèƒ½å¼•ç”¨å¸¸é‡æ± ä¸­çš„å¸¸é‡æ¥æè¿°ã€‚å­—æ®µè¡¨çš„æœ€ç»ˆæ ¼å¼ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ•°é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">access_flags</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">name_index</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">descriptor_index</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">attributes_count</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">attributes_info</td>\n<td style=\"text-align:center\">attributes</td>\n<td style=\"text-align:center\">attributes_count</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>å­—æ®µä¿®é¥°ç¬¦æ”¾åœ¨access_flagsé¡¹ç›®ä¸­ï¼Œå…¶ä¸­å¯ä»¥è®¾ç½®çš„æ ‡å¿—ä½å’Œå«ä¹‰è§è¡¨6-9ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ec0f8f95bac2a15e549ca.png\" alt=\"å­—æ®µè®¿é—®æ ‡å¿—.png\" tabindex=\"0\"><figcaption>å­—æ®µè®¿é—®æ ‡å¿—.png</figcaption></figure>\n<ul>\n<li>\n<p>åœ¨å®é™…æƒ…å†µä¸­ï¼ŒACC_PUBLICã€ACC_PRIVATEã€ACC_PROTECTEDä¸‰ä¸ªæ ‡å¿—æœ€å¤šåªèƒ½é€‰æ‹©å…¶ä¸€ï¼ŒACC_FINALã€ACC_VOLATILEä¸èƒ½åŒæ—¶é€‰æ‹©ã€‚æ¥å£ä¹‹ä¸­çš„å­—æ®µå¿…é¡»æœ‰ACC_PUBLICã€ACC_STATICã€ACC_FINALæ ‡å¿—ï¼Œè¿™äº›éƒ½æ˜¯ç”±Javaæœ¬èº«çš„è¯­è¨€è§„åˆ™æ‰€å†³å®šçš„ã€‚</p>\n</li>\n<li>\n<p>è·Ÿéšaccess_flagsæ ‡å¿—çš„æ˜¯ä¸¤é¡¹ç´¢å¼•å€¼ï¼šname_indexå’Œdescriptor_indexã€‚å®ƒä»¬éƒ½æ˜¯å¯¹å¸¸é‡æ± çš„å¼•ç”¨ï¼Œåˆ†åˆ«ä»£è¡¨ç€å­—æ®µçš„ç®€å•åç§°ä»¥åŠå­—æ®µå’Œæ–¹æ³•çš„æè¿°ç¬¦ã€‚</p>\n</li>\n<li>\n<p>â€œorg/fenixsoft/clazz/TestClassâ€æ˜¯è¿™ä¸ªç±»çš„å…¨é™å®šåï¼Œä»…ä»…æ˜¯æŠŠç±»å…¨åä¸­çš„â€œ.â€æ›¿æ¢æˆäº†â€œ/â€è€Œå·²ï¼Œä¸ºäº†ä½¿è¿ç»­çš„å¤šä¸ªå…¨é™å®šåä¹‹é—´ä¸äº§ç”Ÿæ··æ·†ï¼Œåœ¨ä½¿ç”¨æ—¶æœ€åä¸€èˆ¬ä¼šåŠ å…¥ä¸€ä¸ªâ€œï¼›â€è¡¨ç¤ºå…¨é™å®šåç»“æŸã€‚ç®€å•åç§°æ˜¯æŒ‡æ²¡æœ‰ç±»å‹å’Œå‚æ•°ä¿®é¥°çš„æ–¹æ³•æˆ–è€…å­—æ®µåç§°ï¼Œè¿™ä¸ªç±»ä¸­çš„incï¼ˆï¼‰æ–¹æ³•å’Œmå­—æ®µçš„ç®€å•åç§°åˆ†åˆ«æ˜¯â€œincâ€å’Œâ€œmâ€ã€‚</p>\n</li>\n<li>\n<p>æè¿°ç¬¦çš„ä½œç”¨æ˜¯ç”¨æ¥æè¿°å­—æ®µçš„æ•°æ®ç±»å‹ã€æ–¹æ³•çš„å‚æ•°åˆ—è¡¨ï¼ˆåŒ…æ‹¬æ•°é‡ã€ç±»å‹ä»¥åŠé¡ºåºï¼‰å’Œè¿”å›å€¼ã€‚æ ¹æ®æè¿°ç¬¦è§„åˆ™ï¼ŒåŸºæœ¬æ•°æ®ç±»å‹ï¼ˆbyteã€charã€doubleã€floatã€intã€longã€shortã€booleanï¼‰ä»¥åŠä»£è¡¨æ— è¿”å›å€¼çš„voidç±»å‹éƒ½ç”¨ä¸€ä¸ªå¤§å†™å­—ç¬¦æ¥è¡¨ç¤ºï¼Œè€Œå¯¹è±¡ç±»å‹åˆ™ç”¨å­—ç¬¦LåŠ å¯¹è±¡çš„å…¨é™å®šåæ¥è¡¨ç¤ºã€‚</p>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f968abcf911a29d7d5459.png\" alt=\"æè¿°ç¬¦æ ‡è¯†å­—ç¬¦å«ä¹‰.png\" tabindex=\"0\"><figcaption>æè¿°ç¬¦æ ‡è¯†å­—ç¬¦å«ä¹‰.png</figcaption></figure>\n<ul>\n<li>\n<p>å¯¹äºæ•°ç»„ç±»å‹ï¼Œæ¯ä¸€ç»´åº¦å°†ä½¿ç”¨ä¸€ä¸ªå‰ç½®çš„â€œ[â€å­—ç¬¦æ¥æè¿°ï¼Œå¦‚ä¸€ä¸ªå®šä¹‰ä¸ºâ€œjava.lang.String[][]â€ç±»å‹çš„äºŒç»´æ•°ç»„ï¼Œå°†è¢«è®°å½•ä¸ºï¼šâ€œ[[Ljava/lang/Stringï¼›â€ï¼Œä¸€ä¸ªæ•´å‹æ•°ç»„â€œint[]â€å°†è¢«è®°å½•ä¸ºâ€œ[Iâ€ã€‚</p>\n</li>\n<li>\n<p>ç”¨æè¿°ç¬¦æ¥æè¿°æ–¹æ³•æ—¶ï¼ŒæŒ‰ç…§å…ˆå‚æ•°åˆ—è¡¨ï¼Œåè¿”å›å€¼çš„é¡ºåºæè¿°ï¼Œå‚æ•°åˆ—è¡¨æŒ‰ç…§å‚æ•°çš„ä¸¥æ ¼é¡ºåºæ”¾åœ¨ä¸€ç»„å°æ‹¬å·â€œï¼ˆï¼‰â€ä¹‹å†…ã€‚å¦‚æ–¹æ³•void incï¼ˆï¼‰çš„æè¿°ç¬¦ä¸ºâ€œï¼ˆï¼‰Vâ€ï¼Œæ–¹æ³•java.lang.String toStringï¼ˆï¼‰çš„æè¿°ç¬¦ä¸ºâ€œï¼ˆï¼‰Ljava/lang/Stringï¼›â€ï¼Œæ–¹æ³•int indexOfï¼ˆchar[]source,int sourceOffset,int sourceCount,char[]target,int targetOffset,int targetCount,int fromIndexï¼‰çš„æè¿°ç¬¦ä¸ºâ€œï¼ˆ[CII[CIIIï¼‰Iâ€ã€‚</p>\n</li>\n<li>\n<p>å­—æ®µè¡¨éƒ½åŒ…å«çš„å›ºå®šæ•°æ®é¡¹ç›®åˆ°descriptor_indexä¸ºæ­¢å°±ç»“æŸäº†ï¼Œä¸è¿‡åœ¨descriptor_indexä¹‹åè·Ÿéšç€ä¸€ä¸ªå±æ€§è¡¨é›†åˆç”¨äºå­˜å‚¨ä¸€äº›é¢å¤–çš„ä¿¡æ¯ï¼Œå­—æ®µéƒ½å¯ä»¥åœ¨å±æ€§è¡¨ä¸­æè¿°é›¶è‡³å¤šé¡¹çš„é¢å¤–ä¿¡æ¯ã€‚</p>\n</li>\n<li>\n<p>å­—æ®µè¡¨é›†åˆä¸­ä¸ä¼šåˆ—å‡ºä»è¶…ç±»æˆ–è€…çˆ¶æ¥å£ä¸­ç»§æ‰¿è€Œæ¥çš„å­—æ®µï¼Œä½†æœ‰å¯èƒ½åˆ—å‡ºåŸæœ¬Javaä»£ç ä¹‹ä¸­ä¸å­˜åœ¨çš„å­—æ®µï¼Œè­¬å¦‚åœ¨å†…éƒ¨ç±»ä¸­ä¸ºäº†ä¿æŒå¯¹å¤–éƒ¨ç±»çš„è®¿é—®æ€§ï¼Œä¼šè‡ªåŠ¨æ·»åŠ æŒ‡å‘å¤–éƒ¨ç±»å®ä¾‹çš„å­—æ®µã€‚å¦å¤–ï¼Œåœ¨Javaè¯­è¨€ä¸­å­—æ®µæ˜¯æ— æ³•é‡è½½çš„ï¼Œä¸¤ä¸ªå­—æ®µçš„æ•°æ®ç±»å‹ã€ä¿®é¥°ç¬¦ä¸ç®¡æ˜¯å¦ç›¸åŒï¼Œéƒ½å¿…é¡»ä½¿ç”¨ä¸ä¸€æ ·çš„åç§°ï¼Œä½†æ˜¯å¯¹äºå­—èŠ‚ç æ¥è®²ï¼Œå¦‚æœä¸¤ä¸ªå­—æ®µçš„æè¿°ç¬¦ä¸ä¸€è‡´ï¼Œé‚£å­—æ®µé‡åå°±æ˜¯åˆæ³•çš„ã€‚</p>\n</li>\n</ul>\n<h2>12.6. æ–¹æ³•è¡¨é›†åˆ</h2>\n<ul>\n<li>Classæ–‡ä»¶å­˜å‚¨æ ¼å¼ä¸­å¯¹æ–¹æ³•çš„æè¿°ä¸å¯¹å­—æ®µçš„æè¿°å‡ ä¹é‡‡ç”¨äº†å®Œå…¨ä¸€è‡´çš„æ–¹å¼ï¼Œæ–¹æ³•è¡¨çš„ç»“æ„å¦‚åŒå­—æ®µè¡¨ä¸€æ ·ï¼Œä¾æ¬¡åŒ…æ‹¬äº†è®¿é—®æ ‡å¿—ï¼ˆaccess_flagsï¼‰ã€åç§°ç´¢å¼•ï¼ˆname_indexï¼‰ã€æè¿°ç¬¦ç´¢å¼•ï¼ˆdescriptor_indexï¼‰ã€å±æ€§è¡¨é›†åˆï¼ˆattributesï¼‰å‡ é¡¹ï¼Œè¿™äº›æ•°æ®é¡¹ç›®çš„å«ä¹‰ä¹Ÿéå¸¸ç±»ä¼¼ï¼Œä»…åœ¨è®¿é—®æ ‡å¿—å’Œå±æ€§è¡¨é›†åˆçš„å¯é€‰é¡¹ä¸­æœ‰æ‰€åŒºåˆ«ã€‚</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/975a04fa962a595d6cb88.png\" alt=\"æ–¹æ³•è¡¨ç»“æ„.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1efeb44773efc042205b6.png\" alt=\"æ–¹æ³•è®¿é—®æ ‡å¿—.png\"></p>\n<ul>\n<li>\n<p>æ–¹æ³•çš„å®šä¹‰å¯ä»¥é€šè¿‡è®¿é—®æ ‡å¿—ã€åç§°ç´¢å¼•ã€æè¿°ç¬¦ç´¢å¼•è¡¨è¾¾æ¸…æ¥šï¼Œä½†æ–¹æ³•é‡Œé¢çš„ä»£ç å»å“ªé‡Œäº†ï¼Ÿæ–¹æ³•é‡Œçš„Javaä»£ç ï¼Œç»è¿‡ç¼–è¯‘å™¨ç¼–è¯‘æˆå­—èŠ‚ç æŒ‡ä»¤åï¼Œå­˜æ”¾åœ¨æ–¹æ³•å±æ€§è¡¨é›†åˆä¸­ä¸€ä¸ªåä¸ºâ€œCodeâ€çš„å±æ€§é‡Œé¢ï¼Œå±æ€§è¡¨ä½œä¸ºClassæ–‡ä»¶æ ¼å¼ä¸­æœ€å…·æ‰©å±•æ€§çš„ä¸€ç§æ•°æ®é¡¹ç›®ï¼Œå°†åœ¨6.3.7èŠ‚ä¸­è¯¦ç»†è®²è§£ã€‚</p>\n</li>\n<li>\n<p>ä¸å­—æ®µè¡¨é›†åˆç›¸å¯¹åº”çš„ï¼Œå¦‚æœçˆ¶ç±»æ–¹æ³•åœ¨å­ç±»ä¸­æ²¡æœ‰è¢«é‡å†™ï¼ˆOverrideï¼‰ï¼Œæ–¹æ³•è¡¨é›†åˆä¸­å°±ä¸ä¼šå‡ºç°æ¥è‡ªçˆ¶ç±»çš„æ–¹æ³•ä¿¡æ¯ã€‚ä½†åŒæ ·çš„ï¼Œæœ‰å¯èƒ½ä¼šå‡ºç°ç”±ç¼–è¯‘å™¨è‡ªåŠ¨æ·»åŠ çš„æ–¹æ³•ï¼Œæœ€å…¸å‹çš„ä¾¿æ˜¯ç±»æ„é€ å™¨â€œï¼œclinitï¼â€æ–¹æ³•å’Œå®ä¾‹æ„é€ å™¨â€œï¼œinitï¼â€[1]æ–¹æ³•ã€‚åœ¨Javaè¯­è¨€ä¸­ï¼Œè¦é‡è½½ï¼ˆOverloadï¼‰ä¸€ä¸ªæ–¹æ³•ï¼Œé™¤äº†è¦ä¸åŸæ–¹æ³•å…·æœ‰ç›¸åŒçš„ç®€å•åç§°ä¹‹å¤–ï¼Œè¿˜è¦æ±‚å¿…é¡»æ‹¥æœ‰ä¸€ä¸ªä¸åŸæ–¹æ³•ä¸åŒçš„ç‰¹å¾ç­¾å[2]ï¼Œç‰¹å¾ç­¾åå°±æ˜¯ä¸€ä¸ªæ–¹æ³•ä¸­å„ä¸ªå‚æ•°åœ¨å¸¸é‡æ± ä¸­çš„å­—æ®µç¬¦å·å¼•ç”¨çš„é›†åˆï¼Œä¹Ÿå°±æ˜¯å› ä¸ºè¿”å›å€¼ä¸ä¼šåŒ…å«åœ¨ç‰¹å¾ç­¾åä¸­ï¼Œå› æ­¤Javaè¯­è¨€é‡Œé¢æ˜¯æ— æ³•ä»…ä»…ä¾é è¿”å›å€¼çš„ä¸åŒæ¥å¯¹ä¸€ä¸ªå·²æœ‰æ–¹æ³•è¿›è¡Œé‡è½½çš„ã€‚ä½†æ˜¯åœ¨Classæ–‡ä»¶æ ¼å¼ä¸­ï¼Œç‰¹å¾ç­¾åçš„èŒƒå›´æ›´å¤§ä¸€äº›ï¼Œåªè¦æè¿°ç¬¦ä¸æ˜¯å®Œå…¨ä¸€è‡´çš„ä¸¤ä¸ªæ–¹æ³•ä¹Ÿå¯ä»¥å…±å­˜ã€‚ä¹Ÿå°±æ˜¯è¯´ï¼Œå¦‚æœä¸¤ä¸ªæ–¹æ³•æœ‰ç›¸åŒçš„åç§°å’Œç‰¹å¾ç­¾åï¼Œä½†è¿”å›å€¼ä¸åŒï¼Œé‚£ä¹ˆä¹Ÿæ˜¯å¯ä»¥åˆæ³•å…±å­˜äºåŒä¸€ä¸ªClassæ–‡ä»¶ä¸­çš„ã€‚</p>\n</li>\n</ul>\n<h2>12.7. å±æ€§è¡¨é›†åˆï¼ˆattribute_infoï¼‰</h2>\n<ul>\n<li>åœ¨Classæ–‡ä»¶ã€å­—æ®µè¡¨ã€æ–¹æ³•è¡¨éƒ½å¯ä»¥æºå¸¦è‡ªå·±çš„å±æ€§è¡¨ï¼ˆattribute_infoï¼‰é›†åˆï¼Œä»¥ç”¨äºæè¿°æŸäº›åœºæ™¯ä¸“æœ‰çš„ä¿¡æ¯ã€‚ä¸è¦æ±‚å„ä¸ªå±æ€§è¡¨å…·æœ‰ä¸¥æ ¼é¡ºåºï¼Œå¹¶ä¸”åªè¦ä¸ä¸å·²æœ‰å±æ€§åé‡å¤ï¼Œä»»ä½•äººå®ç°çš„ç¼–è¯‘å™¨éƒ½å¯ä»¥å‘å±æ€§è¡¨ä¸­å†™å…¥è‡ªå·±å®šä¹‰çš„å±æ€§ä¿¡æ¯ï¼ŒJavaè™šæ‹Ÿæœºè¿è¡Œæ—¶ä¼šå¿½ç•¥æ‰å®ƒä¸è®¤è¯†çš„å±æ€§ã€‚ä¸ºäº†èƒ½æ­£ç¡®è§£æClassæ–‡ä»¶ã€‚é¢„å®šä¹‰å±æ€§å…·ä½“å†…å®¹è§è¡¨6-13ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c59b86bae6cf785d75b94.png\" alt=\"è™šæ‹Ÿæœºè§„èŒƒé¢„å®šä¹‰çš„å±æ€§.png\" tabindex=\"0\"><figcaption>è™šæ‹Ÿæœºè§„èŒƒé¢„å®šä¹‰çš„å±æ€§.png</figcaption></figure>\n<ul>\n<li>å¯¹äºæ¯ä¸ªå±æ€§ï¼Œå®ƒçš„åç§°éœ€è¦ä»å¸¸é‡æ± ä¸­å¼•ç”¨ä¸€ä¸ªCONSTANT_Utf8_infoç±»å‹çš„å¸¸é‡æ¥è¡¨ç¤ºï¼Œè€Œå±æ€§å€¼çš„ç»“æ„åˆ™æ˜¯å®Œå…¨è‡ªå®šä¹‰çš„ï¼Œåªéœ€è¦é€šè¿‡ä¸€ä¸ªu4çš„é•¿åº¦å±æ€§å»è¯´æ˜å±æ€§å€¼æ‰€å ç”¨çš„ä½æ•°å³å¯ã€‚ä¸€ä¸ªç¬¦åˆè§„åˆ™çš„å±æ€§è¡¨åº”è¯¥æ»¡è¶³è¡¨6-14ä¸­æ‰€å®šä¹‰çš„ç»“æ„ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ•°é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">attribute_name_index</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u4</td>\n<td style=\"text-align:center\">attribute_length</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u1</td>\n<td style=\"text-align:center\">info</td>\n<td style=\"text-align:center\">attribute_length</td>\n</tr>\n</tbody>\n</table>\n<h3>12.7.1. Codeå±æ€§</h3>\n<ul>\n<li>Javaç¨‹åºæ–¹æ³•ä½“ä¸­çš„ä»£ç ç»è¿‡Javacç¼–è¯‘å™¨å¤„ç†åï¼Œæœ€ç»ˆå˜ä¸ºå­—èŠ‚ç æŒ‡ä»¤å­˜å‚¨åœ¨Codeå±æ€§å†…ã€‚Codeå±æ€§å‡ºç°åœ¨æ–¹æ³•è¡¨çš„å±æ€§é›†åˆä¹‹ä¸­ï¼Œä½†å¹¶éæ‰€æœ‰çš„æ–¹æ³•è¡¨éƒ½å¿…é¡»å­˜åœ¨è¿™ä¸ªå±æ€§ï¼Œè­¬å¦‚æ¥å£æˆ–è€…æŠ½è±¡ç±»ä¸­çš„æ–¹æ³•å°±ä¸å­˜åœ¨Codeå±æ€§ï¼Œå¦‚æœæ–¹æ³•è¡¨æœ‰Codeå±æ€§å­˜åœ¨ï¼Œé‚£ä¹ˆå®ƒçš„ç»“æ„å°†å¦‚è¡¨6-15æ‰€ç¤ºã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2598b64531c9556e47c1a.png\" alt=\"Codeå±æ€§è¡¨çš„ç»“æ„.png\" tabindex=\"0\"><figcaption>Codeå±æ€§è¡¨çš„ç»“æ„.png</figcaption></figure>\n<ul>\n<li>\n<p>attribute_name_indexæ˜¯ä¸€é¡¹æŒ‡å‘CONSTANT_Utf8_infoå‹å¸¸é‡çš„ç´¢å¼•ï¼Œå¸¸é‡å€¼å›ºå®šä¸ºâ€œCodeâ€ï¼Œå®ƒä»£è¡¨äº†è¯¥å±æ€§çš„å±æ€§åç§°ï¼Œattribute_lengthæŒ‡ç¤ºäº†å±æ€§å€¼çš„é•¿åº¦ï¼Œç”±äºå±æ€§åç§°ç´¢å¼•ä¸å±æ€§é•¿åº¦ä¸€å…±ä¸º6å­—èŠ‚ï¼Œæ‰€ä»¥å±æ€§å€¼çš„é•¿åº¦å›ºå®šä¸ºæ•´ä¸ªå±æ€§è¡¨é•¿åº¦å‡å»6ä¸ªå­—èŠ‚ã€‚</p>\n</li>\n<li>\n<p>max_stackä»£è¡¨äº†æ“ä½œæ•°æ ˆï¼ˆOperand Stacksï¼‰æ·±åº¦çš„æœ€å¤§å€¼ã€‚åœ¨æ–¹æ³•æ‰§è¡Œçš„ä»»æ„æ—¶åˆ»ï¼Œæ“ä½œæ•°æ ˆéƒ½ä¸ä¼šè¶…è¿‡è¿™ä¸ªæ·±åº¦ã€‚è™šæ‹Ÿæœºè¿è¡Œçš„æ—¶å€™éœ€è¦æ ¹æ®è¿™ä¸ªå€¼æ¥åˆ†é…æ ˆå¸§ï¼ˆStack Frameï¼‰ä¸­çš„æ“ä½œæ ˆæ·±åº¦ã€‚</p>\n</li>\n<li>\n<p>max_localsä»£è¡¨äº†å±€éƒ¨å˜é‡è¡¨æ‰€éœ€çš„å­˜å‚¨ç©ºé—´ã€‚å•ä½æ˜¯Slot,Slotæ˜¯è™šæ‹Ÿæœºä¸ºå±€éƒ¨å˜é‡åˆ†é…å†…å­˜æ‰€ä½¿ç”¨çš„æœ€å°å•ä½ã€‚å¯¹äºbyteã€charã€floatã€intã€shortã€booleanå’ŒreturnAddressç­‰é•¿åº¦ä¸è¶…è¿‡32ä½çš„æ•°æ®ç±»å‹ï¼Œæ¯ä¸ªå±€éƒ¨å˜é‡å ç”¨1ä¸ªSlotï¼Œè€Œdoubleå’Œlongè¿™ä¸¤ç§64ä½çš„æ•°æ®ç±»å‹åˆ™éœ€è¦ä¸¤ä¸ªSlotæ¥å­˜æ”¾ã€‚æ–¹æ³•å‚æ•°ï¼ˆåŒ…æ‹¬å®ä¾‹æ–¹æ³•ä¸­çš„éšè—å‚æ•°â€œthisâ€ï¼‰ã€æ˜¾å¼å¼‚å¸¸å¤„ç†å™¨çš„å‚æ•°ï¼ˆException Handler Parameterï¼Œå°±æ˜¯try-catchè¯­å¥ä¸­catchå—æ‰€å®šä¹‰çš„å¼‚å¸¸ï¼‰ã€æ–¹æ³•ä½“ä¸­å®šä¹‰çš„å±€éƒ¨å˜é‡éƒ½éœ€è¦ä½¿ç”¨å±€éƒ¨å˜é‡è¡¨æ¥å­˜æ”¾ã€‚å¦å¤–ï¼Œå¹¶ä¸æ˜¯åœ¨æ–¹æ³•ä¸­ç”¨åˆ°äº†å¤šå°‘ä¸ªå±€éƒ¨å˜é‡ï¼Œå°±æŠŠè¿™äº›å±€éƒ¨å˜é‡æ‰€å Slotä¹‹å’Œä½œä¸ºmax_localsçš„å€¼ï¼ŒåŸå› æ˜¯å±€éƒ¨å˜é‡è¡¨ä¸­çš„Slotå¯ä»¥é‡ç”¨ï¼Œå½“ä»£ç æ‰§è¡Œè¶…å‡ºä¸€ä¸ªå±€éƒ¨å˜é‡çš„ä½œç”¨åŸŸæ—¶ï¼Œè¿™ä¸ªå±€éƒ¨å˜é‡æ‰€å çš„Slotå¯ä»¥è¢«å…¶ä»–å±€éƒ¨å˜é‡æ‰€ä½¿ç”¨ï¼ŒJavacç¼–è¯‘å™¨ä¼šæ ¹æ®å˜é‡çš„ä½œç”¨åŸŸæ¥åˆ†é…Slotç»™å„ä¸ªå˜é‡ä½¿ç”¨ï¼Œç„¶åè®¡ç®—å‡ºmax_localsçš„å¤§å°ã€‚</p>\n</li>\n<li>\n<p>code_lengthå’Œcodeç”¨æ¥å­˜å‚¨Javaæºç¨‹åºç¼–è¯‘åç”Ÿæˆçš„å­—èŠ‚ç æŒ‡ä»¤ã€‚code_lengthä»£è¡¨å­—èŠ‚ç é•¿åº¦ï¼Œcodeæ˜¯ç”¨äºå­˜å‚¨å­—èŠ‚ç æŒ‡ä»¤çš„ä¸€ç³»åˆ—å­—èŠ‚æµã€‚æ—¢ç„¶å«å­—èŠ‚ç æŒ‡ä»¤ï¼Œé‚£ä¹ˆæ¯ä¸ªæŒ‡ä»¤å°±æ˜¯ä¸€ä¸ªu1ç±»å‹çš„å•å­—èŠ‚ï¼Œå½“è™šæ‹Ÿæœºè¯»å–åˆ°codeä¸­çš„ä¸€ä¸ªå­—èŠ‚ç æ—¶ï¼Œå°±å¯ä»¥å¯¹åº”æ‰¾å‡ºè¿™ä¸ªå­—èŠ‚ç ä»£è¡¨çš„æ˜¯ä»€ä¹ˆæŒ‡ä»¤ï¼Œå¹¶ä¸”å¯ä»¥çŸ¥é“è¿™æ¡æŒ‡ä»¤åé¢æ˜¯å¦éœ€è¦è·Ÿéšå‚æ•°ï¼Œä»¥åŠå‚æ•°åº”å½“å¦‚ä½•ç†è§£ã€‚ä¸€ä¸ªu1æ•°æ®ç±»å‹çš„å–å€¼èŒƒå›´ä¸º0x00ï½0xFFï¼Œå¯¹åº”åè¿›åˆ¶çš„0ï½255ï¼Œä¹Ÿå°±æ˜¯ä¸€å…±å¯ä»¥è¡¨è¾¾256æ¡æŒ‡ä»¤ï¼Œç¼–ç ä¸æŒ‡ä»¤ä¹‹é—´çš„å¯¹åº”å…³ç³»å¯æŸ¥é˜…æœ¬ä¹¦çš„é™„å½•Bâ€œè™šæ‹Ÿæœºå­—èŠ‚ç æŒ‡ä»¤è¡¨â€ã€‚</p>\n</li>\n<li>\n<p>code_lengthï¼Œè™½ç„¶å®ƒæ˜¯ä¸€ä¸ªu4ç±»å‹çš„é•¿åº¦å€¼ï¼Œç†è®ºä¸Šæœ€å¤§å€¼å¯ä»¥è¾¾åˆ°2^32-1ï¼Œä½†æ˜¯è™šæ‹Ÿæœºè§„èŒƒä¸­æ˜ç¡®é™åˆ¶äº†ä¸€ä¸ªæ–¹æ³•ä¸å…è®¸è¶…è¿‡65535æ¡å­—èŠ‚ç æŒ‡ä»¤ï¼Œå³å®ƒå®é™…åªä½¿ç”¨äº†u2çš„é•¿åº¦ï¼Œå¦‚æœè¶…è¿‡è¿™ä¸ªé™åˆ¶ï¼ŒJavacç¼–è¯‘å™¨ä¹Ÿä¼šæ‹’ç»ç¼–è¯‘ï¼Œä¾‹å¦‚åœ¨ç¼–è¯‘ä¸€ä¸ªå¾ˆå¤æ‚çš„JSPæ–‡ä»¶æ—¶ï¼ŒæŸäº›JSPç¼–è¯‘å™¨ä¼šæŠŠJSPå†…å®¹å’Œé¡µé¢è¾“å‡ºçš„ä¿¡æ¯å½’å¹¶äºä¸€ä¸ªæ–¹æ³•ä¹‹ä¸­ï¼Œå°±å¯èƒ½å› ä¸ºæ–¹æ³•ç”Ÿæˆå­—èŠ‚ç è¶…é•¿çš„åŸå› è€Œå¯¼è‡´ç¼–è¯‘å¤±è´¥ã€‚</p>\n</li>\n<li>\n<p>Codeå±æ€§æ˜¯Classæ–‡ä»¶ä¸­æœ€é‡è¦çš„ä¸€ä¸ªå±æ€§ï¼Œå¦‚æœæŠŠä¸€ä¸ªJavaç¨‹åºä¸­çš„ä¿¡æ¯åˆ†ä¸ºä»£ç ï¼ˆCodeï¼Œæ–¹æ³•ä½“é‡Œé¢çš„Javaä»£ç ï¼‰å’Œå…ƒæ•°æ®ï¼ˆMetadataï¼ŒåŒ…æ‹¬ç±»ã€å­—æ®µã€æ–¹æ³•å®šä¹‰åŠå…¶ä»–ä¿¡æ¯ï¼‰ä¸¤éƒ¨åˆ†ï¼Œé‚£ä¹ˆåœ¨æ•´ä¸ªClassæ–‡ä»¶ä¸­ï¼ŒCodeå±æ€§ç”¨äºæè¿°ä»£ç ï¼Œæ‰€æœ‰çš„å…¶ä»–æ•°æ®é¡¹ç›®éƒ½ç”¨äºæè¿°å…ƒæ•°æ®ã€‚</p>\n</li>\n<li>\n<p>åœ¨å­—èŠ‚ç æŒ‡ä»¤ä¹‹åçš„æ˜¯è¿™ä¸ªæ–¹æ³•çš„æ˜¾å¼å¼‚å¸¸å¤„ç†è¡¨ï¼ˆä¸‹æ–‡ç®€ç§°å¼‚å¸¸è¡¨ï¼‰é›†åˆï¼Œå¼‚å¸¸è¡¨å¯¹äºCodeå±æ€§æ¥è¯´å¹¶ä¸æ˜¯å¿…é¡»å­˜åœ¨çš„ï¼Œå¦‚ä»£ç æ¸…å•6-4ä¸­å°±æ²¡æœ‰å¼‚å¸¸è¡¨ç”Ÿæˆã€‚å¼‚å¸¸è¡¨çš„æ ¼å¼å¦‚è¡¨6-16æ‰€ç¤ºï¼Œå®ƒåŒ…å«4ä¸ªå­—æ®µï¼Œè¿™äº›å­—æ®µçš„å«ä¹‰ä¸ºï¼šå¦‚æœå½“å­—èŠ‚ç åœ¨ç¬¬start_pcè¡Œ[1]åˆ°ç¬¬end_pcè¡Œä¹‹é—´ï¼ˆä¸å«ç¬¬end_pcè¡Œï¼‰å‡ºç°äº†ç±»å‹ä¸ºcatch_typeæˆ–è€…å…¶å­ç±»çš„å¼‚å¸¸ï¼ˆcatch_typeä¸ºæŒ‡å‘ä¸€ä¸ªCONSTANT_Class_infoå‹å¸¸é‡çš„ç´¢å¼•ï¼‰ï¼Œåˆ™è½¬åˆ°ç¬¬handler_pcè¡Œç»§ç»­å¤„ç†ã€‚å½“catch_typeçš„å€¼ä¸º0æ—¶ï¼Œä»£è¡¨ä»»æ„å¼‚å¸¸æƒ…å†µéƒ½éœ€è¦è½¬å‘åˆ°handler_pcå¤„è¿›è¡Œå¤„ç†ã€‚</p>\n</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ•°é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">start_pc</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">end_pc</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">handler_pc</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">catch_pc</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n</tbody>\n</table>\n<ul>\n<li>å¼‚å¸¸è¡¨å®é™…ä¸Šæ˜¯Javaä»£ç çš„ä¸€éƒ¨åˆ†ï¼Œç¼–è¯‘å™¨ä½¿ç”¨å¼‚å¸¸è¡¨è€Œä¸æ˜¯ç®€å•çš„è·³è½¬å‘½ä»¤æ¥å®ç°Javaå¼‚å¸¸åŠfinallyå¤„ç†æœºåˆ¶[2]ã€‚<br>\nä»£ç æ¸…å•6-5æ˜¯ä¸€æ®µæ¼”ç¤ºå¼‚å¸¸è¡¨å¦‚ä½•è¿ä½œçš„ä¾‹å­ï¼Œè¿™æ®µä»£ç ä¸»è¦æ¼”ç¤ºäº†åœ¨å­—èŠ‚ç å±‚é¢ä¸­try-catch-finallyæ˜¯å¦‚ä½•å®ç°çš„ã€‚åœ¨é˜…è¯»å­—èŠ‚ç ä¹‹å‰ï¼Œå¤§å®¶ä¸å¦¨å…ˆçœ‹çœ‹ä¸‹é¢çš„Javaæºç ï¼Œæƒ³ä¸€ä¸‹è¿™æ®µä»£ç çš„è¿”å›å€¼åœ¨å‡ºç°å¼‚å¸¸å’Œä¸å‡ºç°å¼‚å¸¸çš„æƒ…å†µä¸‹åˆ†åˆ«åº”è¯¥æ˜¯å¤šå°‘ï¼Ÿ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//Javaæºç \npublic int incï¼ˆï¼‰{\nint xï¼›\ntry{\nx=1ï¼›\nreturn xï¼›\n}catchï¼ˆException eï¼‰{\nx=2ï¼›\nreturn xï¼›\n}finally{\nx=3ï¼›\n}\n}\n//ç¼–è¯‘åçš„ByteCodeå­—èŠ‚ç åŠå¼‚å¸¸è¡¨\npublic int incï¼ˆï¼‰ï¼›\nCodeï¼š\nStack=1ï¼ŒLocals=5ï¼ŒArgs_size=1\n0ï¼šiconst_1//tryå—ä¸­çš„x=1\n1ï¼šistore_1\n2ï¼šiload_1//ä¿å­˜xåˆ°returnValueä¸­ï¼Œæ­¤æ—¶x=1\n3ï¼šistore 4\n5ï¼šiconst_3//finalyå—ä¸­çš„x=3\n6ï¼šistore_1\n7ï¼šiload 4//å°†returnValueä¸­çš„å€¼æ”¾åˆ°æ ˆé¡¶ï¼Œå‡†å¤‡ç»™ireturnè¿”å›\n9ï¼šireturn\n10ï¼šastore_2//ç»™catchä¸­å®šä¹‰çš„Exception eèµ‹å€¼ï¼Œå­˜å‚¨åœ¨Slot 2ä¸­\n11ï¼šiconst_2//catchå—ä¸­çš„x=2\n12ï¼šistore_1\n13ï¼šiload_1//ä¿å­˜xåˆ°returnValueä¸­ï¼Œæ­¤æ—¶x=2\n14ï¼šistore 4\n16ï¼šiconst_3//finalyå—ä¸­çš„x=3\n17ï¼šistore_1\n18ï¼šiload 4//å°†returnValueä¸­çš„å€¼æ”¾åˆ°æ ˆé¡¶ï¼Œå‡†å¤‡ç»™ireturnè¿”å›\n20ï¼šireturn\n21ï¼šastore_3//å¦‚æœå‡ºç°äº†ä¸å±äºjava.lang.ExceptionåŠå…¶å­ç±»çš„å¼‚å¸¸æ‰ä¼šèµ°åˆ°è¿™é‡Œ\n22ï¼šiconst_3//finalyå—ä¸­çš„x=3\n23ï¼šistore_1\n24ï¼šaload_3//å°†å¼‚å¸¸æ”¾ç½®åˆ°æ ˆé¡¶ï¼Œå¹¶æŠ›å‡º\n25ï¼šathrow\nException tableï¼š\nfrom to target type\n0 5 10 Class java/lang/Exception\n0 5 21 any\n10 16 21 any\n\n</code></pre></div><ul>\n<li>ç¼–è¯‘å™¨ä¸ºè¿™æ®µJavaæºç ç”Ÿæˆäº†3æ¡å¼‚å¸¸è¡¨è®°å½•ï¼Œå¯¹åº”3æ¡å¯èƒ½å‡ºç°çš„ä»£ç æ‰§è¡Œè·¯å¾„ã€‚ä»Javaä»£ç çš„è¯­ä¹‰ä¸Šè®²ï¼Œè¿™3æ¡æ‰§è¡Œè·¯å¾„åˆ†åˆ«ä¸ºï¼šå¦‚æœtryè¯­å¥å—ä¸­å‡ºç°å±äºExceptionæˆ–å…¶å­ç±»çš„å¼‚å¸¸ï¼Œåˆ™è½¬åˆ°catchè¯­å¥å—å¤„ç†ã€‚å¦‚æœtryè¯­å¥å—ä¸­å‡ºç°ä¸å±äºExceptionæˆ–å…¶å­ç±»çš„å¼‚å¸¸ï¼Œåˆ™è½¬åˆ°finallyè¯­å¥å—å¤„ç†ã€‚å¦‚æœcatchè¯­å¥å—ä¸­å‡ºç°ä»»ä½•å¼‚å¸¸ï¼Œåˆ™è½¬åˆ°finallyè¯­å¥å—å¤„ç†ã€‚</li>\n</ul>\n<h3>12.7.2. Exceptionså±æ€§</h3>\n<ul>\n<li>Exceptionså±æ€§æ˜¯åœ¨æ–¹æ³•è¡¨ä¸­ä¸Codeå±æ€§å¹³çº§çš„ä¸€é¡¹å±æ€§ï¼ŒExceptionså±æ€§çš„ä½œç”¨æ˜¯åˆ—ä¸¾å‡ºæ–¹æ³•ä¸­å¯èƒ½æŠ›å‡ºçš„å—æŸ¥å¼‚å¸¸<br>\nï¼ˆChecked Excepitonsï¼‰ï¼Œä¹Ÿå°±æ˜¯æ–¹æ³•æè¿°æ—¶åœ¨throwså…³é”®å­—åé¢åˆ—ä¸¾çš„å¼‚å¸¸ã€‚å®ƒçš„ç»“æ„è§è¡¨6-17ã€‚</li>\n<li>Exceptionså±æ€§ä¸­çš„number_of_exceptionsé¡¹è¡¨ç¤ºæ–¹æ³•å¯èƒ½æŠ›å‡ºnumber_of_exceptionsç§å—æŸ¥å¼‚å¸¸ï¼Œæ¯ä¸€ç§å—æŸ¥å¼‚å¸¸ä½¿ç”¨ä¸€ä¸ªexception_index_tableé¡¹è¡¨ç¤ºï¼Œexception_index_tableæ˜¯ä¸€ä¸ªæŒ‡å‘å¸¸é‡æ± ä¸­CONSTANT_Class_infoå‹å¸¸é‡çš„ç´¢å¼•ï¼Œä»£è¡¨äº†è¯¥å—æŸ¥å¼‚å¸¸çš„ç±»å‹</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ•°é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">attribute_name_index</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u4</td>\n<td style=\"text-align:center\">attribute_length</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">number_of_exceptions</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">exception_index_table</td>\n<td style=\"text-align:center\">number_of_exceptions</td>\n</tr>\n</tbody>\n</table>\n<h3>12.7.3. LineNumberTableå±æ€§</h3>\n<ul>\n<li>LineNumberTableå±æ€§ç”¨äºæè¿°Javaæºç è¡Œå·ä¸å­—èŠ‚ç è¡Œå·ï¼ˆå­—èŠ‚ç çš„åç§»é‡ï¼‰ä¹‹é—´çš„å¯¹åº”å…³ç³»ã€‚å®ƒå¹¶ä¸æ˜¯è¿è¡Œæ—¶å¿…éœ€çš„å±æ€§ï¼Œä½†é»˜è®¤ä¼šç”Ÿæˆåˆ°Classæ–‡ä»¶ä¹‹ä¸­ï¼Œå¯ä»¥åœ¨Javacä¸­åˆ†åˆ«ä½¿ç”¨-gï¼šnoneæˆ–-gï¼šlinesé€‰é¡¹æ¥å–æ¶ˆæˆ–è¦æ±‚ç”Ÿæˆè¿™é¡¹ä¿¡æ¯ã€‚å¦‚æœé€‰æ‹©ä¸ç”ŸæˆLineNumberTableå±æ€§ï¼Œå¯¹ç¨‹åºè¿è¡Œäº§ç”Ÿçš„æœ€ä¸»è¦çš„å½±å“å°±æ˜¯å½“æŠ›å‡ºå¼‚å¸¸æ—¶ï¼Œå †æ ˆä¸­å°†ä¸ä¼šæ˜¾ç¤ºå‡ºé”™çš„è¡Œå·ï¼Œå¹¶ä¸”åœ¨è°ƒè¯•ç¨‹åºçš„æ—¶å€™ï¼Œä¹Ÿæ— æ³•æŒ‰ç…§æºç è¡Œæ¥è®¾ç½®æ–­ç‚¹ã€‚LineNumberTableå±æ€§çš„ç»“æ„è§è¡¨6-18ã€‚</li>\n<li>line_number_tableæ˜¯ä¸€ä¸ªæ•°é‡ä¸ºline_number_table_lengthã€ç±»å‹ä¸ºline_number_infoçš„é›†åˆï¼Œline_number_infoè¡¨åŒ…æ‹¬äº†start_pcå’Œline_numberä¸¤ä¸ªu2ç±»å‹çš„æ•°æ®é¡¹ï¼Œå‰è€…æ˜¯å­—èŠ‚ç è¡Œå·ï¼Œåè€…æ˜¯Javaæºç è¡Œå·ã€‚</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">ç±»å‹</th>\n<th style=\"text-align:center\">åç§°</th>\n<th style=\"text-align:center\">æ•°é‡</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">attribute_name_index</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u4</td>\n<td style=\"text-align:center\">attribute_length</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">u2</td>\n<td style=\"text-align:center\">line_number_table_length</td>\n<td style=\"text-align:center\">1</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">line_number_info</td>\n<td style=\"text-align:center\">line_number_table</td>\n<td style=\"text-align:center\">line_number_table_length</td>\n</tr>\n</tbody>\n</table>\n<h2>12.8. ä»£ç é‡æ’åº</h2>\n<ul>\n<li>åœ¨æ‰§è¡Œç¨‹åºæ—¶ï¼Œä¸ºäº†æä¾›æ€§èƒ½ï¼Œå¤„ç†å™¨å’Œç¼–è¯‘å™¨å¸¸å¸¸ä¼šå¯¹æŒ‡ä»¤è¿›è¡Œé‡æ’åºï¼Œé‡æ’åºä¸ä¼šå½±å“å•çº¿ç¨‹ç¯å¢ƒçš„æ‰§è¡Œç»“æœï¼Œä½†æ˜¯ä¼šç ´åå¤šçº¿ç¨‹çš„æ‰§è¡Œè¯­ä¹‰ï¼Œéœ€æ»¡è¶³ä»¥ä¸‹ä¸¤ä¸ªæ¡ä»¶\n<ul>\n<li>åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸èƒ½æ”¹å˜ç¨‹åºè¿è¡Œçš„ç»“æœï¼›</li>\n<li>å­˜åœ¨æ•°æ®ä¾èµ–å…³ç³»çš„ä¸å…è®¸é‡æ’åº</li>\n</ul>\n</li>\n<li>uniqueInstance = new Singleton(); è¿™æ®µä»£ç å…¶å®æ˜¯åˆ†ä¸ºä¸‰æ­¥æ‰§è¡Œï¼š\n<ul>\n<li>uniqueInstance åˆ†é…å†…å­˜ç©ºé—´</li>\n<li>åˆå§‹åŒ– uniqueInstance</li>\n<li>å°† uniqueInstance æŒ‡å‘åˆ†é…çš„å†…å­˜åœ°å€</li>\n<li>ç”±äº JVM å…·æœ‰æŒ‡ä»¤é‡æ’çš„ç‰¹æ€§ï¼Œæ‰§è¡Œé¡ºåºæœ‰å¯èƒ½å˜æˆ 1-&gt;3-&gt;2ã€‚æŒ‡ä»¤é‡æ’åœ¨å•çº¿ç¨‹ç¯å¢ƒä¸‹ä¸ä¼šå‡ºç°é—®é¢˜ï¼Œä½†æ˜¯åœ¨å¤šçº¿ç¨‹ç¯å¢ƒä¸‹ä¼šå¯¼è‡´ä¸€ä¸ªçº¿ç¨‹è·å¾—è¿˜æ²¡æœ‰åˆå§‹åŒ–çš„å®ä¾‹ã€‚ä¾‹å¦‚ï¼Œçº¿ç¨‹ T1 æ‰§è¡Œäº† 1 å’Œ 3ï¼Œæ­¤æ—¶ T2 è°ƒç”¨ getUniqueInstance() åå‘ç° uniqueInstance ä¸ä¸ºç©ºï¼Œå› æ­¤è¿”å› uniqueInstanceï¼Œä½†æ­¤æ—¶ uniqueInstance è¿˜æœªè¢«åˆå§‹åŒ–ã€‚</li>\n<li>ä½¿ç”¨ volatile å…³é”®å­—ä¿®é¥°å¯ä»¥é˜²æ­¢æŒ‡ä»¤é‡æ’</li>\n<li>volatile æä¾›å¤šçº¿ç¨‹å…±äº«å˜é‡å¯è§æ€§å’Œç¦æ­¢æŒ‡ä»¤é‡æ’åºä¼˜åŒ–</li>\n</ul>\n</li>\n</ul>\n<h2>12.9. as-if-serialè§„åˆ™å’Œhappens-beforeè§„åˆ™</h2>\n<ul>\n<li>as-if-serialè¯­ä¹‰ä¿è¯å•çº¿ç¨‹å†…ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ï¼Œå•çº¿ç¨‹ç¨‹åºæ˜¯æŒ‰ç¨‹åºçš„é¡ºåºæ¥æ‰§è¡Œçš„ã€‚</li>\n<li>happens-beforeå…³ç³»ä¿è¯æ­£ç¡®åŒæ­¥çš„å¤šçº¿ç¨‹ç¨‹åºçš„æ‰§è¡Œç»“æœä¸è¢«æ”¹å˜ã€‚æ­£ç¡®åŒæ­¥çš„å¤šçº¿ç¨‹ç¨‹åºæ˜¯æŒ‰happens-beforeæŒ‡å®šçš„é¡ºåºæ¥æ‰§è¡Œçš„</li>\n<li>ä¸¤è€…éƒ½æ˜¯ä¸ºäº†åœ¨ä¸æ”¹å˜ç¨‹åºæ‰§è¡Œç»“æœçš„å‰æä¸‹ï¼Œå°½å¯èƒ½åœ°æé«˜ç¨‹åºæ‰§è¡Œçš„å¹¶è¡Œåº¦ã€‚</li>\n</ul>\n<h1>13. GCåƒåœ¾å›æ”¶æœºåˆ¶</h1>\n<ul>\n<li>\n<p>åƒåœ¾å›æ”¶æ˜¯åœ¨å†…å­˜ä¸­å­˜åœ¨æ²¡æœ‰å¼•ç”¨çš„å¯¹è±¡æˆ–è¶…è¿‡ä½œç”¨åŸŸçš„å¯¹è±¡æ—¶è¿›è¡Œçš„ã€‚</p>\n</li>\n<li>\n<p>åƒåœ¾å›æ”¶çš„ç›®çš„æ˜¯è¯†åˆ«å¹¶ä¸”ä¸¢å¼ƒåº”ç”¨ä¸å†ä½¿ç”¨çš„å¯¹è±¡æ¥é‡Šæ”¾å’Œé‡ç”¨èµ„æºã€‚</p>\n</li>\n<li>\n<p>å¦‚æœå¯¹è±¡çš„å¼•ç”¨è¢«ç½®ä¸ºnullï¼Œåœ¨ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶æ—¶æ‰ä¼šé‡Šæ”¾å…¶å ç”¨çš„å†…å­˜ã€‚</p>\n</li>\n<li>\n<p>åƒåœ¾å›æ”¶å™¨ï¼ˆgarbage colectorï¼‰å†³å®šå›æ”¶æŸå¯¹è±¡æ—¶ï¼Œå°±ä¼šè¿è¡Œè¯¥å¯¹è±¡çš„finalize()æ–¹æ³•ï¼›å¯ä»¥è¦†ç›–æ­¤æ–¹æ³•æ¥å®ç°å¯¹å…¶èµ„æºçš„å›æ”¶ã€‚ä¸€æ—¦åƒåœ¾å›æ”¶å™¨å‡†å¤‡é‡Šæ”¾å¯¹è±¡å ç”¨çš„å†…å­˜ï¼Œå°†é¦–å…ˆè°ƒç”¨è¯¥å¯¹è±¡çš„finalize()æ–¹æ³•ï¼Œå¹¶ä¸”ä¸‹ä¸€æ¬¡åƒåœ¾å›æ”¶åŠ¨ä½œå‘ç”Ÿæ—¶ï¼Œæ‰çœŸæ­£å›æ”¶å¯¹è±¡å ç”¨çš„å†…å­˜ç©ºé—´</p>\n</li>\n<li>\n<p>finalizationæ„æå‡½æ•°åœ¨å¤§éƒ¨åˆ†æ—¶å€™ï¼Œä»€ä¹ˆéƒ½ä¸ç”¨åš(ä¹Ÿå°±æ˜¯ä¸éœ€è¦é‡è½½)ã€‚åªæœ‰åœ¨æŸäº›å¾ˆç‰¹æ®Šçš„æƒ…å†µä¸‹ï¼Œæ¯”å¦‚è°ƒç”¨äº†ä¸€äº›nativeçš„æ–¹æ³•(ä¸€èˆ¬æ˜¯Cå†™çš„)ï¼Œå¯ä»¥è¦åœ¨finaliztioné‡Œå»è°ƒç”¨Cçš„é‡Šæ”¾å‡½æ•°ã€‚</p>\n</li>\n<li>\n<p>monitorGC</p>\n<ul>\n<li>ç”±äºç°åœ¨æ”¶é›†å™¨éƒ½æ˜¯é‡‡ç”¨åˆ†ä»£æ”¶é›†ç®—æ³•ï¼Œå †è¢«åˆ’åˆ†ä¸ºæ–°ç”Ÿä»£å’Œè€å¹´ä»£ã€‚æ–°ç”Ÿä»£ä¸»è¦å­˜å‚¨æ–°åˆ›å»ºçš„å¯¹è±¡å’Œå°šæœªè¿›å…¥è€å¹´ä»£çš„å¯¹è±¡ã€‚è€å¹´ä»£å­˜å‚¨ç»è¿‡å¤šæ¬¡æ–°ç”Ÿä»£GC(Minor GC)ä»»ç„¶å­˜æ´»çš„å¯¹è±¡ã€‚\n<ul>\n<li>æ–°ç”Ÿä»£ï¼šç¨‹åºæ–°åˆ›å»ºçš„å¯¹è±¡éƒ½æ˜¯ä»æ–°ç”Ÿä»£åˆ†é…å†…å­˜ï¼Œæ–°ç”Ÿä»£ç”±Eden Spaceå’Œä¸¤å—ç›¸åŒå¤§å°çš„Survivor Space(é€šå¸¸åˆç§°S0å’ŒS1æˆ–Fromå’ŒTo)æ„æˆï¼Œ\n<ul>\n<li>å¯é€šè¿‡-Xmnå‚æ•°æ¥æŒ‡å®šæ–°ç”Ÿä»£çš„å¤§å°ï¼Œä¹Ÿå¯ä»¥é€šè¿‡-XX:SurvivorRationæ¥è°ƒæ•´Eden SpaceåŠSurvivor Spaceçš„å¤§å°ã€‚</li>\n</ul>\n</li>\n<li>è€å¹´ä»£ï¼šç”¨äºå­˜æ”¾ç»è¿‡å¤šæ¬¡æ–°ç”Ÿä»£GCä»»ç„¶å­˜æ´»çš„å¯¹è±¡ï¼Œä¾‹å¦‚ç¼“å­˜å¯¹è±¡ï¼Œæ–°å»ºçš„å¯¹è±¡ä¹Ÿæœ‰å¯èƒ½ç›´æ¥è¿›å…¥è€å¹´ä»£ï¼Œ\n<ul>\n<li>â‘ .å¤§å¯¹è±¡ï¼Œå¯é€šè¿‡å¯åŠ¨å‚æ•°è®¾ç½®-XX:PretenureSizeThreshold=1024(å•ä½ä¸ºå­—èŠ‚ï¼Œé»˜è®¤ä¸º0)æ¥ä»£è¡¨è¶…è¿‡å¤šå¤§æ—¶å°±ä¸åœ¨æ–°ç”Ÿä»£åˆ†é…ï¼Œè€Œæ˜¯ç›´æ¥åœ¨è€å¹´ä»£åˆ†é…ã€‚</li>\n<li>â‘¡.å¤§çš„æ•°ç»„å¯¹è±¡ï¼Œåˆ‡æ•°ç»„ä¸­æ— å¼•ç”¨å¤–éƒ¨å¯¹è±¡ã€‚ è€å¹´ä»£æ‰€å çš„å†…å­˜å¤§å°ä¸º-Xmxå¯¹åº”çš„å€¼å‡å»-Xmnå¯¹åº”çš„å€¼</li>\n</ul>\n</li>\n<li>åœ¨æ–°ç”Ÿä»£ä¸­ï¼Œè¶…è¿‡Survivor Spaceçš„åŒºåŸŸ60%çš„å¯¹è±¡ä¼šè¢«ç›´æ¥æ”¾å…¥åˆ°è€ç”Ÿä»£ä¸­ï¼Œç‰¹åˆ«æ³¨æ„</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>Full GC</p>\n<ul>\n<li>å…¨éƒ¨GCï¼šjvmè°ƒä¼˜å°±æ˜¯å‡å°‘jvmçš„full GC ï¼Œå› ä¸ºfullGCä¼šå¯¼è‡´CPUåœæ­¢è¿ä½œï¼Œæ­¤æ—¶ç”¨æˆ·è§‰å¾—æ— å“åº”ï¼Œç›´åˆ°å¤„ç†FUll GCå¤„ç†å®Œ</li>\n</ul>\n</li>\n</ul>\n<p>jdk8çš„openjdkçš„æºç åŒ…/openjdk/hotspot/src/share/vm/oopsï¼ŒMark Wordå¯¹åº”markOop.hpp</p>\n<ul>\n<li>openjdkå·¥å…·åŒ…org.openjdk.jol.jol-core-0.8.jarå¯ä»¥ç”¨æ¥è·å–å¯¹è±¡çš„ä¿¡æ¯å’Œè™šæ‹Ÿæœºçš„ä¿¡æ¯,jol-core å¸¸ç”¨çš„ä¸‰ä¸ªæ–¹æ³•\n<ul>\n<li>ClassLayout.parseInstance(object).toPrintable()ï¼šæŸ¥çœ‹å¯¹è±¡å†…éƒ¨ä¿¡æ¯.</li>\n<li>GraphLayout.parseInstance(object).toPrintable()ï¼šæŸ¥çœ‹å¯¹è±¡å¤–éƒ¨ä¿¡æ¯ï¼ŒåŒ…æ‹¬å¼•ç”¨çš„å¯¹è±¡.</li>\n<li>GraphLayout.parseInstance(object).totalSize()ï¼šæŸ¥çœ‹å¯¹è±¡æ€»å¤§å°.</li>\n<li>ç»“æœ\n<ul>\n<li>OFFSETï¼šåç§»åœ°å€ï¼Œå•ä½å­—èŠ‚ï¼›</li>\n<li>SIZEï¼šå ç”¨çš„å†…å­˜å¤§å°ï¼Œå•ä½ä¸ºå­—èŠ‚ï¼›</li>\n<li>TYPE DESCRIPTIONï¼šç±»å‹æè¿°ï¼Œå…¶ä¸­object headerä¸ºå¯¹è±¡å¤´ï¼›</li>\n<li>VALUEï¼šå¯¹åº”å†…å­˜ä¸­å½“å‰å­˜å‚¨çš„å€¼ï¼ŒäºŒè¿›åˆ¶32ä½ï¼›</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class D {\n  public static void main(String[] args) {\n      //æ™®é€šå¯¹è±¡\n      D d = new D();\n      System.out.println(ClassLayout.parseInstance(d).toPrintable());\n  }\n}\n\njdk8ç”±äºé»˜è®¤å¼€å¯äº†æŒ‡é’ˆå‹ç¼©ï¼Œdå¯¹è±¡å®ä¾‹å…±å æ®16byteï¼Œå¯¹è±¡å¤´ï¼ˆobject headerï¼‰å æ®12byteï¼ˆ96bitï¼‰ï¼Œå…¶ä¸­ mark wordå 8byteï¼ˆ64bitï¼‰ï¼Œklass pointe å 4byteï¼Œå¦å¤–å‰©ä½™4byteæ˜¯å¡«å……å¯¹é½çš„ã€‚\nå¦‚æœå…³é—­æŒ‡é’ˆå‹ç¼©-XX:-UseCompressedOops,å¯¹è±¡å¤´æ‰€å ç”¨çš„å†…å­˜å¤§å°å˜ä¸º16byteï¼ˆ128bitï¼‰ï¼Œå…¶ä¸­mark wordå 8byteï¼Œklass pointe å 8byteï¼Œæ— å¯¹é½å¡«å……ã€‚å¼€å¯æŒ‡é’ˆå‹ç¼©å¯ä»¥å‡å°‘å¯¹è±¡çš„å†…å­˜ä½¿ç”¨ã€‚ä»ä¸¤æ¬¡æ‰“å°çš„Då¯¹è±¡å¸ƒå±€ä¿¡æ¯æ¥çœ‹ï¼Œå…³é—­æŒ‡é’ˆå‹ç¼©æ—¶ï¼Œå¯¹è±¡å¤´çš„SIZEå¢åŠ äº†4byteï¼Œè¿™é‡Œç”±äºDå¯¹è±¡æ˜¯æ— å±æ€§çš„ï¼Œè¯»è€…å¯ä»¥è¯•è¯•å¢åŠ å‡ ä¸ªå±æ€§å­—æ®µæ¥çœ‹ä¸‹ï¼Œè¿™æ ·ä¼šæ˜æ˜¾çš„å‘ç°SIZEå¢é•¿ã€‚å› æ­¤å¼€å¯æŒ‡é’ˆå‹ç¼©ï¼Œç†è®ºä¸Šæ¥è®²ï¼Œå¤§çº¦èƒ½èŠ‚çœç™¾åˆ†ä¹‹äº”åçš„å†…å­˜ã€‚\n</code></pre></div><p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/042e522f1cccbc2521f93.png\" alt=\"æ™®é€šå¯¹è±¡å†…å­˜å¸ƒå±€.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/449c32a362dfab7763f0c.png\" alt=\"æ— æŒ‡é’ˆå‹ç¼©çš„å¯¹è±¡å†…å­˜å¸ƒå±€.png\"></p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public static void main(String[] args) {\n    int[] a = {1};//æ•°ç»„å¯¹è±¡\n    System.out.println(ClassLayout.parseInstance(a).toPrintable());\n}\næ€»SIZEä¸ºå…±24byteï¼Œå¯¹è±¡å¤´å 16byteï¼Œå…¶ä¸­Mark Workå 8byteï¼ŒKlass Point å 4byteï¼Œarray length å 4byteï¼Œå› ä¸ºé‡Œé¢åªæœ‰ä¸€ä¸ªint ç±»å‹çš„1ï¼Œæ‰€ä»¥æ•°ç»„å¯¹è±¡çš„å®ä¾‹æ•°æ®å æ®4byteï¼Œå‰©ä½™å¯¹é½å¡«å……å æ®4byteã€‚\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/762320af20cac0d89facc.png\" alt=\"æ•°ç»„å¯¹è±¡å†…å­˜å¸ƒå±€.png\" tabindex=\"0\"><figcaption>æ•°ç»„å¯¹è±¡å†…å­˜å¸ƒå±€.png</figcaption></figure>\n<h1>24. å¯¹è±¡æ˜¯å¦‚ä½•å®šä½è®¿é—®çš„ï¼Ÿ</h1>\n<ul>\n<li>\n<p>javaç¨‹åºéœ€è¦é€šè¿‡æ ˆä¸Šçš„referenceç±»å‹æ•°æ®æ¥è®¿é—®å †ä¸Šçš„å…·ä½“å¯¹è±¡ã€‚ä½†å…·ä½“è®¿é—®æ–¹å¼ç”±è™šæ‹Ÿæœºè€Œå®šçš„ã€‚ä¸»æµçš„è®¿é—®æ–¹å¼æœ‰ä½¿ç”¨å¥æŸ„å’Œç›´æ¥æŒ‡é’ˆä¸¤ç§ã€‚</p>\n</li>\n<li>\n<p>å¥æŸ„è®¿é—®æ–¹å¼</p>\n<ul>\n<li>åœ¨javaå †ä¸­å°†ä¼šåˆ’åˆ†å‡ºä¸€å—å†…å­˜ä½œä¸ºå¥æŸ„æ± ï¼Œreferenceä¸­å­˜å‚¨çš„å°±æ˜¯å¯¹è±¡çš„å¥æŸ„åœ°å€ï¼Œè€Œå¥æŸ„ä¸­åŒ…å«äº†å¯¹è±¡å®ä¾‹æ•°æ®ä¸ç±»å‹æ•°æ®å„è‡ªçš„å…·ä½“åœ°å€ä¿¡æ¯ã€‚</li>\n<li>å¥½å¤„ï¼šrefercenceä¸­å­˜å‚¨çš„æ˜¯ç¨³å®šçš„å¥æŸ„åœ°å€ï¼Œåœ¨å¯¹è±¡è¢«ç§»åŠ¨ï¼ˆåƒåœ¾æ”¶é›†æ—¶ç§»åŠ¨å¯¹è±¡ï¼‰æ—¶åªä¼šæ”¹å˜å¥æŸ„ä¸­çš„å®ä¾‹æ•°æ®æŒ‡é’ˆï¼Œè€Œreferenceæœ¬èº«ä¸ç”¨ä¿®æ”¹<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/adfba4af312ef43d8a748.png\" alt=\"é€šè¿‡å¥æŸ„è®¿é—®å¯¹è±¡.png\"></li>\n</ul>\n</li>\n<li>\n<p>ç›´æ¥æŒ‡é’ˆè®¿é—®æ–¹å¼(HotSpot)</p>\n<ul>\n<li>åœ¨referenceä¸­å­˜å‚¨çš„ç›´æ¥å°±æ˜¯å¯¹è±¡åœ°å€ã€‚</li>\n<li>å¥½å¤„ï¼šé€Ÿåº¦æ›´å¿«ï¼ŒèŠ‚çœäº†ä¸€æ¬¡æŒ‡é’ˆå®šä½çš„æ—¶é—´å¼€é”€ï¼Œç”±äºå¯¹è±¡çš„è®¿é—®åœ¨javaä¸­éå¸¸é¢‘ç¹ï¼Œå› æ­¤è¿™ç±»å¼€é”€ç§¯å°‘æˆå¤šåä¹Ÿæ˜¯ä¸€é¡¹éå¸¸å¯è§‚çš„æ‰§è¡Œæˆæœ¬ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/c55db80c102b0c360d692.png\" alt=\"é€šè¿‡ç›´æ¥æŒ‡é’ˆè®¿é—®å¯¹è±¡.png\"></li>\n</ul>\n</li>\n</ul>\n<h1>25. Monitor</h1>\n<ul>\n<li>ä¸€ä¸ªåŒæ­¥å·¥å…·/æœºåˆ¶ï¼Œå®ƒé€šå¸¸è¢«æè¿°ä¸ºä¸€ä¸ªå¯¹è±¡ã€‚\n<ul>\n<li>äº’æ–¥ï¼šä¸€ä¸ªMonitoråœ¨åŒä¸€æ—¶åˆ»åªèƒ½è¢«ä¸€ä¸ªçº¿ç¨‹å ç”¨</li>\n<li>ä¿¡å·æœºåˆ¶(signal)ï¼šå ç”¨Monitoré”å¤±è´¥çš„çº¿ç¨‹ä¼šæš‚æ—¶æ”¾å¼ƒç«äº‰å¹¶ç­‰å¾…é‡Šæ”¾é”é€šçŸ¥ï¼Œè€Œå ç”¨Monitoré”çš„çº¿ç¨‹æ‰§è¡Œå®Œæˆåä¼šé€šçŸ¥æ­£åœ¨ç­‰å¾…è¿™ä¸ªæ¡ä»¶å˜é‡çš„å…¶ä»–çº¿ç¨‹ï¼Œè®©å…¶å¯ä»¥é‡æ–°ç«äº‰é”ã€‚æ‰€æœ‰å¯¹è±¡éƒ½å¯æˆä¸ºMonitor</li>\n</ul>\n</li>\n<li>æ¯ä¸€ä¸ªçº¿ç¨‹éƒ½æœ‰ç§æœ‰å¯ç”¨Monitor Recordåˆ—è¡¨ï¼ŒåŒæ—¶è¿˜æœ‰ä¸€ä¸ªå…¨å±€çš„å¯ç”¨åˆ—è¡¨ã€‚ æ¯ä¸€ä¸ªè¢«é”ä½çš„å¯¹è±¡éƒ½ä¼šå’Œä¸€ä¸ªMonitor Recordå…³è”ï¼ˆå¯¹è±¡å¤´çš„ MarkWordä¸­çš„LockWordæŒ‡å‘Monitorèµ·å§‹åœ°å€ï¼‰ï¼ŒMonitor Recordä¸­æœ‰ä¸€ä¸ªOwnerå­—æ®µï¼Œå­˜æ”¾æ‹¥æœ‰è¯¥é”çš„çº¿ç¨‹çš„å”¯ä¸€æ ‡è¯†ï¼Œè¡¨ç¤ºè¯¥é”è¢«è¿™ä¸ªçº¿ç¨‹å ç”¨ã€‚åŒ…å«\n<ul>\n<li>Ownerï¼š1ï¼‰åˆå§‹æ—¶ä¸º NULL è¡¨ç¤ºå½“å‰æ²¡æœ‰ä»»ä½•çº¿ç¨‹æ‹¥æœ‰è¯¥ Monitor Recordï¼›2ï¼‰å½“çº¿ç¨‹æˆåŠŸæ‹¥æœ‰è¯¥é”åä¿å­˜çº¿ç¨‹å”¯ä¸€æ ‡è¯†ï¼›3ï¼‰å½“é”è¢«é‡Šæ”¾æ—¶åˆè®¾ç½®ä¸º NULL ã€‚</li>\n<li>EntryQï¼šå…³è”ä¸€ä¸ªç³»ç»Ÿäº’æ–¥é”ï¼ˆ semaphore ï¼‰ï¼Œé˜»å¡æ‰€æœ‰è¯•å›¾é”ä½ Monitor Recordå¤±è´¥çš„çº¿ç¨‹ ã€‚</li>\n<li>RcThisï¼šè¡¨ç¤º blocked æˆ– waiting åœ¨è¯¥ Monitor Record ä¸Šçš„æ‰€æœ‰çº¿ç¨‹çš„ä¸ªæ•°ã€‚</li>\n<li>Nestï¼šç”¨æ¥å®ç°é‡å…¥é”çš„è®¡æ•°ã€‚</li>\n<li>HashCodeï¼šä¿å­˜ä»å¯¹è±¡å¤´æ‹·è´è¿‡æ¥çš„ HashCode å€¼ï¼ˆå¯èƒ½è¿˜åŒ…å« GC age ï¼‰ã€‚</li>\n<li>Candidateï¼šç”¨æ¥é¿å…ä¸å¿…è¦çš„é˜»å¡æˆ–ç­‰å¾…çº¿ç¨‹å”¤é†’ã€‚å› ä¸ºæ¯ä¸€æ¬¡åªæœ‰ä¸€ä¸ªçº¿ç¨‹èƒ½å¤ŸæˆåŠŸæ‹¥æœ‰é”ï¼Œå¦‚æœæ¯æ¬¡å‰ä¸€ä¸ªé‡Šæ”¾é”çš„çº¿ç¨‹å”¤é†’æ‰€æœ‰æ­£åœ¨é˜»å¡æˆ–ç­‰å¾…çš„çº¿ç¨‹ï¼Œä¼šå¼•èµ·ä¸å¿…è¦çš„ä¸Šä¸‹æ–‡åˆ‡æ¢ï¼ˆä»é˜»å¡åˆ°å°±ç»ªç„¶åå› ä¸ºç«äº‰é”å¤±è´¥åˆè¢«é˜»å¡ï¼‰ä»è€Œå¯¼è‡´æ€§èƒ½ä¸¥é‡ä¸‹é™ã€‚Candidate åªæœ‰ä¸¤ç§å¯èƒ½çš„å€¼ ï¼š1ï¼‰0 è¡¨ç¤ºæ²¡æœ‰éœ€è¦å”¤é†’çš„çº¿ç¨‹ï¼›2ï¼‰1 è¡¨ç¤ºè¦å”¤é†’ä¸€ä¸ªç»§ä»»çº¿ç¨‹æ¥ç«äº‰é”ã€‚</li>\n</ul>\n</li>\n</ul>\n<h2>ä»£ç ä¼˜åŒ–</h2>\n<ul>\n<li>å°½å¯èƒ½ä½¿ç”¨å±€éƒ¨å˜é‡</li>\n<li>å°½é‡å‡å°‘å¯¹å˜é‡çš„é‡å¤è®¡ç®— å¦‚éå†æ—¶iå°äºlist.size()å¯ä»¥æ”¹ä¸ºiå°äºlength</li>\n<li>å¼‚å¸¸ä¸åº”è¯¥ç”¨æ¥æ§åˆ¶ç¨‹åºæµç¨‹.å¼‚å¸¸å¯¹æ€§èƒ½ä¸åˆ©ã€‚æŠ›å‡ºå¼‚å¸¸é¦–å…ˆè¦åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ï¼ŒThrowableæ¥å£çš„æ„é€ å‡½æ•°è°ƒç”¨åä¸ºfillInStackTrace()çš„æœ¬åœ°åŒæ­¥æ–¹æ³•ï¼ŒfillInStackTrace()æ–¹æ³•æ£€æŸ¥å †æ ˆï¼Œæ”¶é›†è°ƒç”¨è·Ÿè¸ªä¿¡æ¯ã€‚åªè¦æœ‰å¼‚å¸¸è¢«æŠ›å‡ºï¼ŒJavaè™šæ‹Ÿæœºå°±å¿…é¡»è°ƒæ•´è°ƒç”¨å †æ ˆï¼Œå› ä¸ºåœ¨å¤„ç†è¿‡ç¨‹ä¸­åˆ›å»ºä¸€ä¸ªæ–°çš„å¯¹è±¡ã€‚å¼‚å¸¸åªèƒ½ç”¨äºé”™è¯¯å¤„ç†ï¼Œä¸åº”è¯¥ç”¨æ¥æ§åˆ¶ç¨‹åºæµç¨‹ã€‚</li>\n<li>å°½é‡é‡‡ç”¨æ‡’åŠ è½½çš„ç­–ç•¥ï¼Œå³åœ¨éœ€è¦çš„æ—¶å€™æ‰åˆ›å»º</li>\n<li>ä¸è¦å°†æ•°ç»„å£°æ˜ä¸ºpublic static final å› ä¸ºè¿™æ¯«æ— æ„ä¹‰ï¼Œæ•°ç»„çš„å†…å®¹è¿˜æ˜¯å¯ä»¥éšæ„æ”¹å˜çš„ï¼Œ</li>\n<li>ä¸è¦åˆ›å»ºä¸€äº›ä¸ä½¿ç”¨çš„å¯¹è±¡ï¼Œä¸è¦å¯¼å…¥ä¸€äº›ä¸ä½¿ç”¨çš„ç±»</li>\n<li>ç¨‹åºè¿è¡Œè¿‡ç¨‹ä¸­é¿å…ä½¿ç”¨åå°„</li>\n<li>ä½¿ç”¨æ•°æ®åº“è¿æ¥æ± å’Œçº¿ç¨‹æ± .é‡ç”¨å¯¹è±¡ï¼Œå‰è€…å¯ä»¥é¿å…é¢‘ç¹åœ°æ‰“å¼€å’Œå…³é—­è¿æ¥ï¼Œåè€…å¯ä»¥é¿å…é¢‘ç¹åœ°åˆ›å»ºå’Œé”€æ¯çº¿ç¨‹ã€‚</li>\n<li>å®¹å™¨åˆå§‹åŒ–æ—¶å°½å¯èƒ½æŒ‡å®šé•¿åº¦ã€‚é¿å…å®¹å™¨é•¿åº¦ä¸è¶³æ—¶ï¼Œæ‰©å®¹å¸¦æ¥çš„æ€§èƒ½æŸè€—ã€‚</li>\n<li>ArrayListéšæœºéå†å¿«ï¼ŒLinkedListæ·»åŠ åˆ é™¤å¿«</li>\n<li>ä½¿ç”¨Entryéå†Map</li>\n<li>ä¸è¦æ‰‹åŠ¨è°ƒç”¨System.gc();</li>\n<li>Stringå°½é‡å°‘ç”¨æ­£åˆ™è¡¨è¾¾å¼ã€‚å…¶æ•ˆç‡è¾ƒä½ï¼Œreplace() ä¸æ”¯æŒæ­£åˆ™ã€‚replaceAll() æ”¯æŒæ­£åˆ™ã€‚å¦‚æœä»…ä»…æ˜¯å­—ç¬¦çš„æ›¿æ¢å»ºè®®ä½¿ç”¨replace()ã€‚</li>\n<li>æ—¥å¿—çš„è¾“å‡ºè¦æ³¨æ„çº§åˆ«</li>\n<li>å¯¹èµ„æºçš„close()å»ºè®®åˆ†å¼€æ“ä½œ</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/b4dfad59e848dff058479.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "ReentrantLock",
      "url": "https://javaguide.cn/backend/java/reentrantLock.html",
      "id": "https://javaguide.cn/backend/java/reentrantLock.html",
      "summary": "ReentrantLock ReentrantLock ç‰¹ç‚¹ï¼šå…¬å¹³ã€éå…¬å¹³ã€å¯é‡å…¥ã€äº’æ–¥é”ã€éœ€æ‰‹åŠ¨å¼€å¯å’Œé‡Šæ”¾é”,å¼‚å¸¸ä¸è‡ªåŠ¨é‡Šæ”¾é”ï¼Œè¦åœ¨finallyé‡Œé¢å£°æ˜ã€‚åº•å±‚ä½¿ç”¨Unsafeçš„parkæ–¹æ³•åŠ é”ï¼Œ æ‰€æœ‰æ–¹æ³•å®ç°å®é™…ä¸Šéƒ½æ˜¯è°ƒç”¨äº†å…¶é™æ€å†…å­˜ç±»Syncä¸­çš„æ–¹æ³•ï¼Œè€ŒSyncç±»ç»§æ‰¿äº†åŒæ­¥å™¨AbstractQueuedSynchronizerï¼ˆAQSï¼‰æ˜¯å…³é”® !...",
      "content_html": "<p>ReentrantLock</p>\n<!--more-->\n<!-- TOC -->\n<!-- /TOC -->\n<h1>ReentrantLock</h1>\n<ul>\n<li>ç‰¹ç‚¹ï¼šå…¬å¹³ã€éå…¬å¹³ã€å¯é‡å…¥ã€äº’æ–¥é”ã€éœ€æ‰‹åŠ¨å¼€å¯å’Œé‡Šæ”¾é”,å¼‚å¸¸ä¸è‡ªåŠ¨é‡Šæ”¾é”ï¼Œè¦åœ¨finallyé‡Œé¢å£°æ˜ã€‚åº•å±‚ä½¿ç”¨Unsafeçš„parkæ–¹æ³•åŠ é”ï¼Œ</li>\n<li>æ‰€æœ‰æ–¹æ³•å®ç°å®é™…ä¸Šéƒ½æ˜¯è°ƒç”¨äº†å…¶é™æ€å†…å­˜ç±»Syncä¸­çš„æ–¹æ³•ï¼Œè€ŒSyncç±»ç»§æ‰¿äº†åŒæ­¥å™¨AbstractQueuedSynchronizerï¼ˆAQSï¼‰æ˜¯å…³é”®<br>\n<code>![](æºç -AbstractQueuedSynchronizer.md)</code></li>\n<li>volatileä¿è¯æœ‰åºå’Œå¯è§æ€§ï¼Œcasä¿è¯åŸå­æ€§ï¼Œä¿è¯çº¿ç¨‹åŒæ­¥</li>\n</ul>\n<h2>1. æ„é€ å‡½æ•°</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ReentrantLock implements Lock, java.io.Serializable {\n    private final Sync sync;\n    public ReentrantLock() {\n        sync = new NonfairSync();\n    }\n    public ReentrantLock(boolean fair) {\n        sync = fair ? new FairSync() : new NonfairSync();\n    }\n    public void lock() {\n        sync.lock();\n    }\n    public void lockInterruptibly() throws InterruptedException {\n        sync.acquireInterruptibly(1);\n    }\n    public boolean tryLock() {\n        return sync.nonfairTryAcquire(1);\n    }\n    public boolean tryLock(long timeout, TimeUnit unit)\n            throws InterruptedException {\n        return sync.tryAcquireNanos(1, unit.toNanos(timeout));\n    }\n    public void unlock() {\n        sync.release(1);\n    }\n}\n</code></pre></div><h2>2. éå…¬å¹³é”çš„è·å–nonfairTryAcquire(int acquires)ä¸é‡Šæ”¾tryRelease(int releases)</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>abstract static class Sync extends AbstractQueuedSynchronizer {\n    abstract void lock();\n    /*\n    * éå…¬å¹³é”è·å–é”-åŒæ­¥çŠ¶æ€volatileå˜é‡stateè¡¨ç¤ºé”è¢«ä¸€ä¸ªçº¿ç¨‹é‡å¤è·å–çš„æ¬¡æ•°\n    * 1 å¦‚æœstateä¸º0ï¼Œè¡¨æ˜è¯¥é”æœªè¢«ä»»ä½•çº¿ç¨‹å æœ‰ï¼Œé€šè¿‡CASæ“ä½œå°†stateæ”¹ä¸º1å¹¶è®¾ç½®ç‹¬å é”çº¿ç¨‹ä¸ºå½“å‰çº¿ç¨‹\n    * 2 å¦‚æœç‹¬å é”çº¿ç¨‹ä¸ºå½“å‰çº¿ç¨‹ï¼Œå°†stateè®¾ç½®ä¸ºstate+1 é‡å…¥é”åŸç†\n    * éå…¬å¹³æ€§é”å¯èƒ½ä½¿çº¿ç¨‹â€œé¥¥é¥¿â€ï¼Œä¸ºä»€ä¹ˆå®ƒåˆè¢«è®¾å®šæˆé»˜è®¤çš„å®ç°å‘¢ï¼Ÿå› ä¸ºéå…¬å¹³æ€§é”çš„å¼€é”€æ›´å°ã€‚å…¬å¹³æ€§é”\n    * ä¿è¯äº†é”çš„è·å–æŒ‰ç…§FIFOåŸåˆ™ï¼Œè€Œä»£ä»·æ˜¯è¿›è¡Œå¤§é‡çš„çº¿ç¨‹åˆ‡æ¢ã€‚éå…¬å¹³æ€§é”è™½ç„¶å¯èƒ½é€ æˆçº¿ç¨‹â€œé¥¥é¥¿â€ï¼Œä½†æ\n    * å°‘çš„çº¿ç¨‹åˆ‡æ¢ï¼Œä¿è¯äº†å…¶æ›´å¤§çš„ååé‡ã€‚\n    */\n    final boolean nonfairTryAcquire(int acquires) {\n        final Thread current = Thread.currentThread();\n        int c = getState();\n        if (c == 0) {\n            if (compareAndSetState(0, acquires)) {\n                setExclusiveOwnerThread(current);\n                return true;\n            }\n        }\n        else if (current == getExclusiveOwnerThread()) {\n            int nextc = c + acquires;\n            if (nextc &lt; 0) // overflow\n                throw new Error(\"Maximum lock count exceeded\");\n            setState(nextc);\n            return true;\n        }\n        return false;\n    }\n    /*\n    * é‡Šæ”¾é”\n    * 1 state-1ååˆ¤æ–­æ˜¯å¦ä¸º0ï¼Œå¦‚æœæ˜¯è®¾ç½®å½“å‰ç‹¬å é”çº¿ç¨‹ä¸ºnull\n    * 2 è®¾ç½®stateä¸ºstateçŠ¶æ€-1\n    */\n    protected final boolean tryRelease(int releases) {\n        int c = getState() - releases;\n        if (Thread.currentThread() != getExclusiveOwnerThread()) throw new IllegalMonitorStateException();\n        boolean free = false;\n        if (c == 0) {//å°†åŒæ­¥çŠ¶æ€æ˜¯å¦ä¸º0ä½œä¸ºæœ€ç»ˆé‡Šæ”¾çš„æ¡ä»¶\n            free = true;\n            setExclusiveOwnerThread(null);\n        }\n        setState(c);\n        return free;\n    }\n\n    final ConditionObject newCondition() {\n        return new ConditionObject();\n    }\n\n}\n\nstatic final class NonfairSync extends Sync {\n            \n    final void lock() {\n        if (compareAndSetState(0, 1))\n            setExclusiveOwnerThread(Thread.currentThread());\n        else\n            acquire(1);\n    }\n\n    protected final boolean tryAcquire(int acquires) {\n        return nonfairTryAcquire(acquires);\n    }\n}\n</code></pre></div><h2>3. å…¬å¹³é”çš„è·å–tryAcquire(int acquires)ä¸é‡Šæ”¾tryRelease(int releases)</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>static final class FairSync extends Sync {\n    final void lock() {\n        acquire(1);\n    }\n    /*\n    * å…¬å¹³é”æ¯æ¬¡éƒ½æ˜¯ä»åŒæ­¥é˜Ÿåˆ—ä¸­çš„ç¬¬ä¸€ä¸ªèŠ‚ç‚¹è·å–åˆ°é”ï¼Œè€Œéå…¬å¹³æ€§é”åˆ™ä¸ä¸€å®šï¼Œæœ‰å¯èƒ½åˆšé‡Šæ”¾é”çš„çº¿ç¨‹èƒ½å†æ¬¡è·å–åˆ°é”.é”çš„è·å–é¡ºåºå°±åº”è¯¥ç¬¦åˆè¯·æ±‚çš„ç»å¯¹æ—¶é—´é¡ºåºFIFOã€‚\n    * æ¯”éå…¬å¹³é”çš„è·å–å¤šhasQueuedPredecessors()\n    */\n    protected final boolean tryAcquire(int acquires) {\n        final Thread current = Thread.currentThread();\n        int c = getState();\n        if (c == 0) {\n            if (!hasQueuedPredecessors() &amp;&amp;\n                compareAndSetState(0, acquires)) {\n                setExclusiveOwnerThread(current);\n                return true;\n            }\n        }\n        else if (current == getExclusiveOwnerThread()) {\n            int nextc = c + acquires;\n            if (nextc &lt; 0)\n                throw new Error(\"Maximum lock count exceeded\");\n            setState(nextc);\n            return true;\n        }\n        return false;\n    }\n}\n    \npublic abstract class AbstractQueuedSynchronizer extends AbstractOwnableSynchronizer{\n    /*\n    * åˆ¤æ–­åŒæ­¥é˜Ÿåˆ—ä¸­å½“å‰èŠ‚ç‚¹æ˜¯å¦æœ‰å‰é©±èŠ‚ç‚¹ï¼Œå¦‚æœæœ‰åˆ™éœ€è¦ç­‰å¾…å‰é©±èŠ‚ç‚¹é‡Šæ”¾é”æ‰èƒ½ç»§ç»­è·å–é”\n    * è¿”å›trueæ¡ä»¶:ä¸”ä¸æ­¢æœ‰ä¸€ä¸ªç»“ç‚¹ï¼Œå¤´ç»“ç‚¹çš„åç»§èŠ‚ç‚¹ä¸æ˜¯å½“å‰èŠ‚ç‚¹æ—¶\n    *   1 h != tè¿”å›trueè¡¨ç¤ºé˜Ÿåˆ—ä¸­è‡³å°‘æœ‰ä¸¤ä¸ªä¸åŒèŠ‚ç‚¹å­˜åœ¨\n    *   2 (s = h.next) == nullè¿”å›trueï¼Œè¯´æ˜å¤´èŠ‚ç‚¹ä¹‹åæ˜¯æ²¡æœ‰åç»§èŠ‚ç‚¹çš„\n    *        æœ‰å¦ä¸€ä¸ªçº¿ç¨‹å·²ç»æ‰§è¡Œåˆ°åˆå§‹åŒ–é˜Ÿåˆ—çš„æ“ä½œäº†ï¼Œä»‹äºcompareAndSetHead(new Node())ä¸tail = headä¹‹é—´\n    *   3 s.thread != Thread.currentThread()è¿”å›true è¡¨ç¤ºåç»§èŠ‚ç‚¹çš„ç›¸å…³çº¿ç¨‹ä¸æ˜¯å½“å‰çº¿ç¨‹\n    *\n    */\n    public final boolean hasQueuedPredecessors() {\n        Node t = tail; \n        Node h = head;\n        Node s;\n        return h != t &amp;&amp;\n            ((s = h.next) == null || s.thread != Thread.currentThread());\n    }\n}\n</code></pre></div><h1>4. Conditionç±»çš„await()</h1>\n<ul>\n<li>1.ç­‰å¾…é˜Ÿåˆ—ï¼šFIFOçš„é˜Ÿåˆ—ï¼Œåœ¨é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹éƒ½åŒ…å«äº†ä¸€ä¸ªåœ¨Conditionå¯¹è±¡ä¸Šç­‰å¾…çº¿ç¨‹çš„å¼•ç”¨ï¼ŒåŒæ­¥é˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—ä¸­èŠ‚ç‚¹ç±»å‹éƒ½æ˜¯åŒæ­¥å™¨çš„é™æ€å†…éƒ¨ç±»AbstractQueuedSynchronizer.Nodeã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5c6c3548b7452d9f5df2c.jpg\" alt=\"ç­‰å¾…é˜Ÿåˆ—çš„åŸºæœ¬ç»“æ„.png\">\n<ul>\n<li>Conditionæ‹¥æœ‰é¦–å°¾èŠ‚ç‚¹çš„å¼•ç”¨ï¼Œè€Œæ–°å¢èŠ‚ç‚¹åªéœ€è¦å°†åŸæœ‰çš„å°¾èŠ‚ç‚¹nextWaiteræŒ‡å‘å®ƒï¼Œå¹¶ä¸”æ›´æ–°å°¾èŠ‚ç‚¹å³å¯ã€‚èŠ‚ç‚¹å¼•ç”¨æ›´æ–°çš„è¿‡ç¨‹å¹¶æ²¡æœ‰ä½¿ç”¨CASä¿è¯ï¼ŒåŸå› åœ¨äºè°ƒç”¨await()æ–¹æ³•çš„çº¿ç¨‹å¿…å®šæ˜¯è·å–äº†é”çš„çº¿ç¨‹ï¼Œç”±é”æ¥ä¿è¯çº¿ç¨‹å®‰å…¨çš„ã€‚</li>\n<li>åœ¨Objectçš„ç›‘è§†å™¨æ¨¡å‹ä¸Šï¼Œä¸€ä¸ªå¯¹è±¡æ‹¥æœ‰ä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—ï¼Œè€Œå¹¶å‘åŒ…ä¸­çš„Lockï¼ˆåŒæ­¥å™¨ï¼‰æ‹¥æœ‰ä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—å’Œå¤šä¸ªç­‰å¾…é˜Ÿåˆ—</li>\n</ul>\n</li>\n<li>2.ç­‰å¾…\n<ul>\n<li>è°ƒç”¨Conditionçš„await()æ–¹æ³•ï¼Œä¼šä½¿å½“å‰çº¿ç¨‹å˜ä¸ºç­‰å¾…çŠ¶æ€æ„é€ æˆèŠ‚ç‚¹ä»å°¾éƒ¨åŠ å…¥ç­‰å¾…é˜Ÿåˆ—å¹¶é‡Šæ”¾é”.å½“ä»await()æ–¹æ³•è¿”å›æ—¶ï¼Œå½“å‰çº¿ç¨‹ä¸€å®šè·å–äº†Conditionç›¸å…³è”çš„é”ã€‚</li>\n<li>å¦‚æœä»é˜Ÿåˆ—ï¼ˆåŒæ­¥é˜Ÿåˆ—å’Œç­‰å¾…é˜Ÿåˆ—ï¼‰çš„è§’åº¦çœ‹await()æ–¹æ³•ï¼Œå½“è°ƒç”¨await()æ–¹æ³•æ—¶ï¼Œç›¸å½“äºåŒæ­¥é˜Ÿåˆ—çš„é¦–èŠ‚ç‚¹ï¼ˆè·å–äº†é”çš„èŠ‚ç‚¹ï¼‰ç§»åŠ¨åˆ°Conditionçš„ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li>\n</ul>\n</li>\n<li>å¦‚æœä»é˜Ÿåˆ—çš„è§’åº¦å»çœ‹ï¼Œå½“å‰çº¿ç¨‹åŠ å…¥Conditionçš„ç­‰å¾…é˜Ÿåˆ—ï¼ŒåŒæ­¥é˜Ÿåˆ—çš„é¦–èŠ‚ç‚¹å¹¶ä¸ä¼šç›´æ¥åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œè€Œæ˜¯é€šè¿‡addConditionWaiter()æ–¹æ³•æŠŠå½“å‰çº¿ç¨‹æ„é€ æˆä¸€ä¸ªæ–°çš„èŠ‚ç‚¹å¹¶å°†å…¶åŠ å…¥ç­‰å¾…é˜Ÿåˆ—ä¸­ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    private transient Node firstWaiter;\n    private transient Node lastWaiter;\n    Node nextWaiter\n    /*\n    * è°ƒç”¨è¯¥æ–¹æ³•çš„çº¿ç¨‹æˆåŠŸè·å–äº†é”çš„çº¿ç¨‹ï¼Œä¹Ÿå°±æ˜¯åŒæ­¥é˜Ÿåˆ—ä¸­çš„é¦–èŠ‚ç‚¹\n    * 1 è°ƒç”¨addConditionWaiter()å°†å½“å‰çº¿ç¨‹åŒ…è£…æˆNodeï¼Œå°¾æ’å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­\n    * 2 è°ƒç”¨fullyRelease(node)é‡Šæ”¾å½“å‰çº¿ç¨‹æ‰€å ç”¨çš„lockï¼Œåœ¨é‡Šæ”¾çš„è¿‡ç¨‹ä¸­ä¼šå”¤é†’åŒæ­¥é˜Ÿåˆ—ä¸­çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹\n    * 3 whileå¾ªç¯ï¼Œé€€å‡ºæ¡ä»¶å¦‚ä¸‹\n    *   è°ƒç”¨checkInterruptWhileWaiting()é€šè¿‡Thread.interrupted()åˆ¤æ–­å½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œå¦‚æœè¢«ä¸­æ–­äº†ï¼Œ\n    *       åˆ™é€šè¿‡CASæ“ä½œåˆ¤æ–­æ˜¯å¦å·²ç»è¢«ä¿®æ”¹ä¸ºCancelã€‚å¦‚æœæ˜¯åˆ™è¡¨æ˜ä¸­æ–­ç±»å‹æ˜¯THROW_IE(signalä¹‹å‰)ï¼Œå¦åˆ™REINTERRUPT(æ²¡æœ‰ä¸­æ–­è¿‡)\n    *   è°ƒç”¨isOnSyncQueue(node)åˆ¤æ–­å½“å‰èŠ‚ç‚¹åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­(condition.signal/condition.signalAllæ–¹æ³•å½“å‰èŠ‚ç‚¹ç§»åŠ¨åˆ°äº†åŒæ­¥é˜Ÿåˆ—)\n    * 4 åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­å°è¯•è·å–é”ã€‚å”¤é†’åŒæ­¥é˜Ÿåˆ—ä¸­çš„åç»§èŠ‚ç‚¹ å½“ç­‰å¾…é˜Ÿåˆ—ä¸­çš„èŠ‚ç‚¹è¢«å”¤é†’ï¼Œåˆ™å”¤é†’èŠ‚ç‚¹çš„çº¿ç¨‹å¼€å§‹å°è¯•è·å–åŒæ­¥çŠ¶æ€ã€‚å¦‚æœä¸æ˜¯é€šè¿‡å…¶ä»–çº¿ç¨‹è°ƒç”¨Condition.signal()æ–¹æ³•å”¤é†’ï¼Œè€Œæ˜¯å¯¹ç­‰å¾…çº¿ç¨‹è¿›è¡Œä¸­æ–­ï¼Œåˆ™ä¼šæŠ›å‡ºInterruptedExceptionã€‚\n    * 5 è·å–é”æˆåŠŸåå¦‚æœæœ‰åç»§èŠ‚ç‚¹åˆ™è°ƒç”¨unlinkCancelledWaiters()æ¸…é™¤Conditioné˜Ÿåˆ—ä¸­çŠ¶æ€ä¸æ˜¯Node.CONDITIONçš„èŠ‚ç‚¹\n    * 6 å¦‚æœä¸­æ–­äº†åˆ™è°ƒç”¨reportInterruptAfterWait()å“åº”ä¸­æ–­ï¼ŒTHROW_IEæŠ›å‡ºå¼‚å¸¸ï¼ŒREINTERRUPTä¸­æ–­å½“å‰çº¿ç¨‹\n    */\n    public final void await() throws InterruptedException {\n        if (Thread.interrupted()) throw new InterruptedException();\n        Node node = addConditionWaiter();//1\n        int savedState = fullyRelease(node);//2\n        int interruptMode = 0;\n        while (!isOnSyncQueue(node)) { //3\n            LockSupport.park(this);\n            if ((interruptMode = checkInterruptWhileWaiting(node)) != 0)\n                break;\n        }\n        if (acquireQueued(node, savedState) &amp;&amp; interruptMode != THROW_IE)//4\n            interruptMode = REINTERRUPT;\n        if (node.nextWaiter != null) //5\n            unlinkCancelledWaiters();\n        if (interruptMode != 0) //6\n            reportInterruptAfterWait(interruptMode);\n    }\n    /*\n    * å°†å½“å‰çº¿ç¨‹åŒ…è£…æˆNodeï¼Œå°¾æ’å…¥åˆ°ç­‰å¾…é˜Ÿåˆ—ä¸­\n    *   1 å¦‚æœå°¾ç»“ç‚¹è¢«å–æ¶ˆäº†åˆ™è°ƒç”¨unlinkCancelledWaiters()æ¸…é™¤Conditioné˜Ÿåˆ—ä¸­çŠ¶æ€ä¸æ˜¯Node.CONDITIONçš„èŠ‚ç‚¹\n    *   2 å°†å½“å‰çº¿ç¨‹å’ŒConditionç­‰å¾…çŠ¶æ€åŒ…è£…æˆNodeæ”¾å…¥Conditioné˜Ÿåˆ—çš„å°¾èŠ‚ç‚¹ä¸­\n    */\n    private Node addConditionWaiter() {\n        Node t = lastWaiter;\n        if (t != null &amp;&amp; t.waitStatus != Node.CONDITION) {//1\n            unlinkCancelledWaiters();\n            t = lastWaiter;\n        }\n        Node node = new Node(Thread.currentThread(), Node.CONDITION);//2\n        if (t == null)\n            firstWaiter = node;\n        else\n            t.nextWaiter = node;\n        lastWaiter = node;\n        return node;\n    }\n    \n    private void unlinkCancelledWaiters() {\n        Node t = firstWaiter;\n        Node trail = null;//è®°å½•ä»å¤´ç»“ç‚¹åˆ°å°¾ç»“ç‚¹çš„æœ€åä¸€ä¸ªæœ‰æ•ˆç»“ç‚¹\n        while (t != null) {\n            Node next = t.nextWaiter;\n            if (t.waitStatus != Node.CONDITION) {\n                t.nextWaiter = null;\n                if (trail == null)// å¦‚æœtrailä¸ºnullï¼Œè¡¨ç¤ºåŸå…ˆçš„conditioné˜Ÿåˆ—å¤´èŠ‚ç‚¹å®æ•ˆï¼Œéœ€è¦è®¾ç½®æ–°çš„conditioné˜Ÿåˆ—å¤´\n                    firstWaiter = next;\n                else\n                    trail.nextWaiter = next;// å¦‚æœnextä¸ºnullï¼Œè¡¨ç¤ºåŸå…ˆçš„conditioné˜Ÿåˆ—å°¾èŠ‚ç‚¹ä¹Ÿå®æ•ˆï¼Œé‡æ–°è®¾ç½®é˜Ÿåˆ—å°¾èŠ‚ç‚¹\n                if (next == null)\n                    lastWaiter = trail;\n            }\n            else\n                trail = t;\n            t = next;\n        }\n    }\n    \n    final int fullyRelease(Node node) {\n        boolean failed = true;\n        try {\n            int savedState = getState();\n            if (release(savedState)) {\n                //æˆåŠŸé‡Šæ”¾åŒæ­¥çŠ¶æ€\n                failed = false;\n                return savedState;\n            } else {\n                //ä¸æˆåŠŸé‡Šæ”¾åŒæ­¥çŠ¶æ€æŠ›å‡ºå¼‚å¸¸\n                throw new IllegalMonitorStateException();\n            }\n        } finally {\n            if (failed)\n                node.waitStatus = Node.CANCELLED;\n        }\n    }\n\n    public final boolean release(int arg) {\n        if (tryRelease(arg)) {\n            Node h = head;\n            if (h != null &amp;&amp; h.waitStatus != 0)\n                unparkSuccessor(h);\n            return true;\n        }\n        return false;\n    }\n\n    final boolean isOnSyncQueue(Node node) {\n        if (node.waitStatus == Node.CONDITION || node.prev == null)\n            return false;\n        if (node.next != null) // If has successor, it must be on queue\n            return true;\n        return findNodeFromTail(node);\n    }\n    \n    private boolean findNodeFromTail(Node node) {\n        Node t = tail;\n        for (;;) {\n            if (t == node)\n                return true;\n            if (t == null)\n                return false;\n            t = t.prev;\n        }\n    }\n    \n    private static final int REINTERRUPT =  1;//è¡¨ç¤ºåœ¨çº¿ç¨‹ä¸­æ–­å‘ç”Ÿæ—¶è¿˜æ²¡æœ‰è°ƒç”¨è¿‡signalæ–¹æ³•\n    private static final int THROW_IE    = -1;//è¡¨ç¤ºåœ¨çº¿ç¨‹ä¸­æ–­å‘ç”Ÿæ—¶å·²ç»è°ƒç”¨è¿‡signalæ–¹æ³•äº†\n    private int checkInterruptWhileWaiting(Node node) {\n        return Thread.interrupted() ?\n            (transferAfterCancelledWait(node) ? THROW_IE : REINTERRUPT) :\n            0;\n    }\n    \n    final boolean transferAfterCancelledWait(Node node) {\n        //å¦‚æœè¿™æ­¥CASæ“ä½œæˆåŠŸçš„è¯å°±è¡¨æ˜CONDITIONè¢«ä¿®æ”¹æˆCanceläº†ï¼Œä¸­æ–­å‘ç”Ÿåœ¨signalæ–¹æ³•ä¹‹å‰\n        if (compareAndSetWaitStatus(node, Node.CONDITION, 0)) {\n            enq(node);\n            return true;\n        }\n        //è¯´æ˜ä¸­æ–­å‘ç”Ÿåœ¨signalæ–¹æ³•ä¹‹å å¦‚æœsinalæ–¹æ³•è¿˜æ²¡æœ‰å°†ç»“ç‚¹è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—, å°±é€šè¿‡è‡ªæ—‹ç­‰å¾…ä¸€ä¸‹\n        while (!isOnSyncQueue(node))\n            Thread.yield();\n        return false;\n    }\n    \n    private void reportInterruptAfterWait(int interruptMode) throws InterruptedException {\n        if (interruptMode == THROW_IE) throw new InterruptedException();\n        else if (interruptMode == REINTERRUPT) selfInterrupt();\n    }\n</code></pre></div><h1>5. Conditionç±»çš„ä¸å“åº”ä¸­æ–­awaitUninterruptibly()</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    //reportInterruptAfterWait\n    public final void awaitUninterruptibly() {\n        Node node = addConditionWaiter();\n        int savedState = fullyRelease(node);\n        boolean interrupted = false;\n        while (!isOnSyncQueue(node)) {\n            LockSupport.park(this);\n            if (Thread.interrupted())\n                interrupted = true;\n        }\n        if (acquireQueued(node, savedState) || interrupted)\n            selfInterrupt();\n    }\n</code></pre></div><h1>6. Conditionç±»çš„å°†ç­‰å¾…æ—¶é—´æœ€é•¿çš„çº¿ç¨‹æ”¾å…¥åŒæ­¥é˜Ÿåˆ—signal()</h1>\n<ul>\n<li>é€šè¿‡è°ƒç”¨åŒæ­¥å™¨çš„enq(Node node)æ–¹æ³•ï¼Œç­‰å¾…é˜Ÿåˆ—ä¸­çš„å¤´èŠ‚ç‚¹çº¿ç¨‹å®‰å…¨åœ°ç§»åŠ¨åˆ°åŒæ­¥é˜Ÿåˆ—ã€‚å½“èŠ‚ç‚¹ç§»åŠ¨åˆ°åŒæ­¥é˜Ÿåˆ—åï¼Œå½“å‰çº¿ç¨‹å†ä½¿ç”¨LockSupportå”¤é†’è¯¥èŠ‚ç‚¹çš„çº¿ç¨‹ã€‚</li>\n<li>è¢«å”¤é†’åçš„çº¿ç¨‹ï¼Œå°†ä»await()æ–¹æ³•ä¸­çš„whileå¾ªç¯ä¸­é€€å‡ºï¼ˆisOnSyncQueue(Node node)æ–¹æ³•è¿”å›trueï¼ŒèŠ‚ç‚¹å·²ç»åœ¨åŒæ­¥é˜Ÿåˆ—ä¸­ï¼‰ï¼Œè¿›è€Œè°ƒç”¨åŒæ­¥å™¨çš„acquireQueued()æ–¹æ³•åŠ å…¥åˆ°è·å–åŒæ­¥çŠ¶æ€çš„ç«äº‰ä¸­ã€‚</li>\n<li>æˆåŠŸè·å–åŒæ­¥çŠ¶æ€ï¼ˆæˆ–è€…è¯´é”ï¼‰ä¹‹åï¼Œè¢«å”¤é†’çš„çº¿ç¨‹å°†ä»å…ˆå‰è°ƒç”¨çš„await()æ–¹æ³•è¿”å›ï¼Œæ­¤æ—¶è¯¥çº¿ç¨‹å·²ç»æˆåŠŸåœ°è·å–äº†é”ã€‚</li>\n<li>Conditionçš„signalAll()æ–¹æ³•ï¼Œç›¸å½“äºå¯¹ç­‰å¾…é˜Ÿåˆ—ä¸­çš„æ¯ä¸ªèŠ‚ç‚¹å‡æ‰§è¡Œä¸€æ¬¡signal()æ–¹æ³•ï¼Œæ•ˆæœå°±æ˜¯å°†ç­‰å¾…é˜Ÿåˆ—ä¸­æ‰€æœ‰èŠ‚ç‚¹å…¨éƒ¨ç§»åŠ¨åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œå¹¶å”¤é†’æ¯ä¸ªèŠ‚ç‚¹çš„çº¿ç¨‹ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    /*\n    * å°†èŠ‚ç‚¹ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ã€‚ç„¶åå”¤é†’åœ¨ç­‰å¾…é˜Ÿåˆ—ä¸­ç­‰å¾…æ—¶é—´æœ€é•¿çš„èŠ‚ç‚¹ï¼ˆé¦–èŠ‚ç‚¹ï¼‰\n    * å°†ç­‰å¾…é˜Ÿåˆ—çš„å¤´ç»“ç‚¹\n    * 1 è°ƒç”¨isHeldExclusively()æ£€æµ‹å½“å‰çº¿ç¨‹æ˜¯å¦å·²ç»è·å–lockï¼Œæ²¡æœ‰åˆ™æŠ›å‡ºå¼‚å¸¸ï¼ˆä¿è¯å½“å‰çº¿ç¨‹å¿…é¡»è·å–äº†é”ï¼‰\n    * 2 è·å–ç­‰å¾…é˜Ÿåˆ—ä¸­ç¬¬ä¸€ä¸ªèŠ‚ç‚¹ï¼Œå°†å…¶ç§»åŠ¨åˆ°åŒæ­¥é˜Ÿåˆ—å¹¶ä½¿ç”¨LockSupportå”¤é†’èŠ‚ç‚¹ä¸­çš„çº¿ç¨‹ã€‚ä¹‹åçš„æ“ä½œéƒ½æ˜¯é’ˆå¯¹è¿™ä¸ªèŠ‚ç‚¹\n    * 3 è°ƒç”¨transferForSignal(node)é…åˆå¾ªç¯å°†å½“å‰èŠ‚ç‚¹è®¾ç½®ä¸º0å¹¶åŠ å…¥åŒæ­¥é˜Ÿåˆ—ï¼Œå…¥é˜ŸæˆåŠŸåå°è¯•è®¾ç½®ä¸ºSIGNALï¼Œè‹¥å¤±è´¥åˆ™å”¤é†’çº¿ç¨‹\n    */\n    public final void signal() {\n        if (!isHeldExclusively()) throw new IllegalMonitorStateException();//1\n        Node first = firstWaiter;//2\n        if (first != null)\n            doSignal(first);\n    }\n    protected final boolean isHeldExclusively() {\n        return getExclusiveOwnerThread() == Thread.currentThread();\n    }\n    private void doSignal(Node first) {\n        do {\n            if ( (firstWaiter = first.nextWaiter) == null)\n                lastWaiter = null;\n            first.nextWaiter = null;\n        } while (!transferForSignal(first) &amp;&amp;\n                (first = firstWaiter) != null);\n    }\n\n    final boolean transferForSignal(Node node) {\n        if (!compareAndSetWaitStatus(node, Node.CONDITION, 0))\n            return false;\n        Node p = enq(node);\n        int ws = p.waitStatus;\n        if (ws &gt; 0 || !compareAndSetWaitStatus(p, ws, Node.SIGNAL))\n            LockSupport.unpark(node.thread);\n        return true;\n    }\n\n</code></pre></div><h1>7. Conditionç±»çš„å”¤é†’æ‰€æœ‰ç­‰å¾…çº¿ç¨‹signalAll()</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    //ä»å¤´åˆ°å°¾è½®è¯¢èŠ‚ç‚¹å”¤é†’ï¼Œå¹¶é‡Šæ”¾æ‰€æœ‰èŠ‚ç‚¹çš„èµ„æº\n    private void doSignalAll(Node first) {\n        lastWaiter = firstWaiter = null;\n        do {\n            Node next = first.nextWaiter;\n            first.nextWaiter = null;\n            transferForSignal(first);\n            first = next;\n        } while (first != null);\n    }\n</code></pre></div><h1>14. ReentrantLock</h1>\n<ul>\n<li>API\n<ul>\n<li>void lock(); //è·å–é”</li>\n<li>void lockInterruptibly() throws InterruptedExceptionï¼›//è·å–é”çš„è¿‡ç¨‹èƒ½å¤Ÿå“åº”ä¸­æ–­</li>\n<li>boolean tryLock();//éé˜»å¡å¼å“åº”ä¸­æ–­èƒ½ç«‹å³è¿”å›ï¼Œè·å–é”æ”¾å›trueåä¹‹è¿”å›fasle</li>\n<li>boolean tryLock(long time, TimeUnit unit) throws InterruptedException;//è¶…æ—¶è·å–é”ï¼Œåœ¨è¶…æ—¶å†…æˆ–è€…æœªä¸­æ–­çš„æƒ…å†µä¸‹èƒ½å¤Ÿè·å–é”</li>\n<li>Condition newCondition();//è·å–ä¸lockç»‘å®šçš„ç­‰å¾…é€šçŸ¥ç»„ä»¶ï¼Œå½“å‰çº¿ç¨‹å¿…é¡»è·å¾—äº†é”æ‰èƒ½è¿›è¡Œç­‰å¾…ï¼Œè¿›è¡Œç­‰å¾…æ—¶ä¼šå…ˆé‡Šæ”¾é”ï¼Œå½“å†æ¬¡è·å–é”æ—¶æ‰èƒ½ä»ç­‰å¾…ä¸­è¿”å›</li>\n<li>void unlock();//é‡Šæ”¾é”</li>\n<li>Condition newCondition();//è¿”å›æ¡ä»¶é”å¯¹è±¡ å¯ä»¥å¤šæ¬¡è°ƒç”¨lock.newCondition()æ–¹æ³•åˆ›å»ºå¤šä¸ªconditionå¯¹è±¡</li>\n</ul>\n</li>\n<li>Lockä½¿ç”¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    lock.lock(); // ç›¸å½“äº synchronized\n    //lock.tryLock()ä¼˜å…ˆè€ƒè™‘è·å–é”ï¼Œå¾…è·å–é”æˆåŠŸåï¼Œæ‰å“åº”ä¸­æ–­\n    //lock.lockInterruptibly()ä¼˜å…ˆè€ƒè™‘å“åº”ä¸­æ–­Tread.interruptå¯ä»¥ä¸­æ–­ç­‰å¾…ï¼Œè€Œä¸æ˜¯å“åº”é”çš„æ™®é€šè·å–æˆ–é‡å…¥è·å–\n    try {\n        System.out.println(\"m2...\");\n    } finally {\n        lock.unlock();//å¿…é¡»åœ¨finallyå—ä¸­é‡Šæ”¾é”\n    }\n</code></pre></div><ul>\n<li>Conditionç±»API\n<ul>\n<li>void await():å½“å‰çº¿ç¨‹é‡Šæ”¾é”å¹¶è¿›å…¥ç­‰å¾…é˜Ÿåˆ—ï¼Œå¦‚æœå…¶ä»–çº¿ç¨‹è°ƒç”¨conditionçš„signalæˆ–è€…signalAllæ–¹æ³•å¹¶ä¸”å½“å‰çº¿ç¨‹è·å–Lockä»awaitæ–¹æ³•è¿”å›ï¼Œå¦‚æœåœ¨ç­‰å¾…çŠ¶æ€ä¸­è¢«ä¸­æ–­ä¼šæŠ›å‡ºè¢«ä¸­æ–­å¼‚å¸¸ï¼›</li>\n<li>long awaitNanos(long nanosTimeout)ï¼šå½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ°è¢«é€šçŸ¥ï¼Œä¸­æ–­æˆ–è€…è¶…æ—¶ï¼›</li>\n<li>boolean await(long time, TimeUnit unit)throws InterruptedExceptionï¼šåŒç¬¬äºŒç§ï¼Œæ”¯æŒè‡ªå®šä¹‰æ—¶é—´å•ä½</li>\n<li>boolean awaitUntil(Date deadline) throws InterruptedExceptionï¼šå½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ç›´åˆ°è¢«é€šçŸ¥ï¼Œä¸­æ–­æˆ–è€…åˆ°äº†æŸä¸ªæ—¶é—´</li>\n<li>void signal()ï¼šå”¤é†’ä¸€ä¸ªç­‰å¾…åœ¨conditionä¸Šçš„çº¿ç¨‹ï¼Œå°†è¯¥çº¿ç¨‹ä»ç­‰å¾…é˜Ÿåˆ—ä¸­è½¬ç§»åˆ°åŒæ­¥é˜Ÿåˆ—ä¸­ï¼Œå¦‚æœåœ¨åŒæ­¥é˜Ÿåˆ—ä¸­èƒ½å¤Ÿç«äº‰åˆ°Lockåˆ™å¯ä»¥ä»ç­‰å¾…æ–¹æ³•ä¸­è¿”å›ã€‚</li>\n<li>void signalAll()ï¼šä¸1çš„åŒºåˆ«åœ¨äºèƒ½å¤Ÿå”¤é†’æ‰€æœ‰ç­‰å¾…åœ¨conditionä¸Šçš„çº¿ç¨‹</li>\n</ul>\n</li>\n<li>Conditionä¸Objectçš„wait/notify/notifyAll\n<ul>\n<li>Objectçš„waitå’Œnotify/notifyæ˜¯ä¸å¯¹è±¡ç›‘è§†å™¨é…åˆå®Œæˆçº¿ç¨‹é—´çš„ç­‰å¾…/é€šçŸ¥æœºåˆ¶ï¼Œè€ŒConditionä¸Locké…åˆå®Œæˆç­‰å¾…é€šçŸ¥æœºåˆ¶</li>\n<li>Conditionèƒ½å¤Ÿæ”¯æŒä¸å“åº”ä¸­æ–­ï¼Œè€Œé€šè¿‡ä½¿ç”¨Objectæ–¹å¼ä¸æ”¯æŒï¼›</li>\n<li>Conditionèƒ½å¤Ÿæ”¯æŒä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—å’Œå¤šä¸ªç­‰å¾…é˜Ÿåˆ—ï¼Œè€ŒObjectæ–¹å¼åªèƒ½æ”¯æŒä¸€ä¸ªåŒæ­¥é˜Ÿåˆ—å’Œä¸€ä¸ªç­‰å¾…é˜Ÿåˆ—</li>\n<li>Conditionèƒ½å¤Ÿæ”¯æŒè¶…æ—¶æ—¶é—´çš„è®¾ç½®ï¼Œè€ŒObjectä¸æ”¯æŒ</li>\n</ul>\n</li>\n<li>ç”Ÿäº§è€…å’Œæ¶ˆè´¹è€…çš„åº”ç”¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ConditionTest {\n    private LinkedList&lt;String&gt; buffer;    //å®¹å™¨\n    private int maxSize ;           //å®¹å™¨æœ€å¤§\n    private Lock lock;\n    private Condition fullCondition;\n    private Condition notFullCondition;\n\n    ConditionTest(int maxSize){\n        this.maxSize = maxSize;\n        buffer = new LinkedList&lt;String&gt;();\n        lock = new ReentrantLock();\n        fullCondition = lock.newCondition();\n        notFullCondition = lock.newCondition();\n    }\n\n    public void set(String string) throws InterruptedException {\n        lock.lock();    //è·å–é”\n        try {\n            while (maxSize == buffer.size()){\n                notFullCondition.await();       //æ»¡äº†ï¼Œæ·»åŠ çš„çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€\n            }\n\n            buffer.add(string);\n            fullCondition.signal();\n        } finally {\n            lock.unlock();      //è®°å¾—é‡Šæ”¾é”\n        }\n    }\n\n    public String get() throws InterruptedException {\n        String string;\n        lock.lock();\n        try {\n            while (buffer.size() == 0){\n                fullCondition.await();\n            }\n            string = buffer.poll();\n            notFullCondition.signal();\n        } finally {\n            lock.unlock();\n        }\n        return string;\n    }\n}\n</code></pre></div><h1>6. LockSupport</h1>\n<ul>\n<li>LockSupprotæ˜¯çº¿ç¨‹çš„é˜»å¡åŸè¯­ï¼Œç”¨æ¥é˜»å¡çº¿ç¨‹å’Œå”¤é†’çº¿ç¨‹</li>\n<li>void park()ï¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œå¦‚æœè°ƒç”¨unparkæ–¹æ³•æˆ–è€…å½“å‰çº¿ç¨‹è¢«ä¸­æ–­ï¼Œä»èƒ½ä»park()æ–¹æ³•ä¸­è¿”å›</li>\n<li>void park(Object blocker)ï¼šåŠŸèƒ½åŒæ–¹æ³•1ï¼Œå…¥å‚å¢åŠ ä¸€ä¸ªObjectå¯¹è±¡ï¼Œç”¨æ¥è®°å½•å¯¼è‡´çº¿ç¨‹é˜»å¡çš„é˜»å¡å¯¹è±¡ï¼Œæ–¹ä¾¿è¿›è¡Œé—®é¢˜æ’æŸ¥ï¼›</li>\n<li>void parkNanos(long nanos)ï¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼Œæœ€é•¿ä¸è¶…è¿‡nanosçº³ç§’ï¼Œå¢åŠ äº†è¶…æ—¶è¿”å›çš„ç‰¹æ€§ï¼›</li>\n<li>void parkNanos(Object blocker, long nanos)ï¼šåŠŸèƒ½åŒæ–¹æ³•3ï¼Œå…¥å‚å¢åŠ ä¸€ä¸ªObjectå¯¹è±¡ï¼Œç”¨æ¥è®°å½•å¯¼è‡´çº¿ç¨‹é˜»å¡çš„é˜»å¡å¯¹è±¡ï¼Œæ–¹ä¾¿è¿›è¡Œé—®é¢˜æ’æŸ¥ï¼›</li>\n<li>void parkUntil(long deadline)ï¼šé˜»å¡å½“å‰çº¿ç¨‹ï¼ŒçŸ¥é“deadlineï¼›</li>\n<li>void parkUntil(Object blocker, long deadline)ï¼šåŠŸèƒ½åŒæ–¹æ³•5ï¼Œå…¥å‚å¢åŠ ä¸€ä¸ªObjectå¯¹è±¡ï¼Œç”¨æ¥è®°å½•å¯¼è‡´çº¿ç¨‹é˜»å¡çš„é˜»å¡å¯¹è±¡ï¼Œæ–¹ä¾¿è¿›è¡Œé—®é¢˜æ’æŸ¥</li>\n<li>void unpark(Thread thread):å”¤é†’å¤„äºé˜»å¡çŠ¶æ€çš„æŒ‡å®šçº¿ç¨‹</li>\n</ul>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æºç "
      ]
    },
    {
      "title": "ReentrantReadWriteLock",
      "url": "https://javaguide.cn/backend/java/reentrantReadWriteLock.html",
      "id": "https://javaguide.cn/backend/java/reentrantReadWriteLock.html",
      "summary": "ReentrantReadWriteLock 15. ReentrantReadWriteLock ç‰¹ç‚¹ï¼šå…¬å¹³ã€éå…¬å¹³é”ã€è¯»å†™é”ã€é‡å…¥é”ã€é”é™çº§ 1. æ„é€ æ–¹æ³• 2. å†™é”çš„è·å–tryAcquire(int acquires)ä¸é‡Šæ”¾tryRelease(int releases) å†™é”æ˜¯ä¸€ä¸ªæ”¯æŒé‡è¿›å…¥çš„æ’å®ƒé”ã€‚å¦‚æœå½“å‰çº¿ç¨‹å·²ç»è·å–äº†å†™é”ï¼Œåˆ™å¢åŠ å†™çŠ¶æ€ã€‚...",
      "content_html": "<p>ReentrantReadWriteLock</p>\n<!--more-->\n<!-- TOC -->\n<!-- /TOC -->\n<h1>15. ReentrantReadWriteLock</h1>\n<ul>\n<li>ç‰¹ç‚¹ï¼šå…¬å¹³ã€éå…¬å¹³é”ã€è¯»å†™é”ã€é‡å…¥é”ã€é”é™çº§</li>\n</ul>\n<h1>1. æ„é€ æ–¹æ³•</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ReentrantReadWriteLock implements ReadWriteLock, java.io.Serializable {\n    public ReentrantReadWriteLock() {\n        this(false);\n    }\n    public ReentrantReadWriteLock(boolean fair) {\n        sync = fair ? new FairSync() : new NonfairSync();\n        readerLock = new ReadLock(this);\n        writerLock = new WriteLock(this);\n    }\n    public static class ReadLock implements Lock, java.io.Serializable{\n        private final Sync sync;\n        protected ReadLock(ReentrantReadWriteLock lock) {\n            sync = lock.sync;\n        }\n    }\n    public static class WriteLock implements Lock, java.io.Serializable{\n        private final Sync sync;\n        protected WriteLock(ReentrantReadWriteLock lock) {\n            sync = lock.sync;\n        }\n    }\n    static final class FairSync extends Sync {\n        final boolean writerShouldBlock() {\n            return hasQueuedPredecessors();\n        }\n        final boolean readerShouldBlock() {\n            return hasQueuedPredecessors();\n        }\n    }\n    static final class NonfairSync extends Sync {\n        final boolean writerShouldBlock() {\n            return false; // writers can always barge\n        }\n        final boolean readerShouldBlock() {\n            return apparentlyFirstQueuedIsExclusive();\n        }\n    }\n}\n</code></pre></div><h1>2. å†™é”çš„è·å–tryAcquire(int acquires)ä¸é‡Šæ”¾tryRelease(int releases)</h1>\n<ul>\n<li>å†™é”æ˜¯ä¸€ä¸ªæ”¯æŒé‡è¿›å…¥çš„æ’å®ƒé”ã€‚å¦‚æœå½“å‰çº¿ç¨‹å·²ç»è·å–äº†å†™é”ï¼Œåˆ™å¢åŠ å†™çŠ¶æ€ã€‚å¦‚æœå½“å‰çº¿ç¨‹åœ¨è·å–å†™é”æ—¶ï¼Œè¯»é”å·²ç»è¢«è·å–ï¼ˆè¯»çŠ¶æ€ä¸ä¸º0ï¼‰æˆ–è€…è¯¥çº¿ç¨‹ä¸æ˜¯å·²ç»è·å–å†™é”çš„çº¿ç¨‹ï¼Œåˆ™å½“å‰çº¿ç¨‹è¿›å…¥ç­‰å¾…çŠ¶æ€ï¼ŒåŸå› åœ¨äºï¼šè¯»å†™é”è¦ç¡®ä¿å†™é”çš„æ“ä½œå¯¹è¯»é”å¯è§ï¼Œå¦‚æœå…è®¸è¯»é”åœ¨å·²è¢«è·å–çš„æƒ…å†µä¸‹å¯¹å†™é”çš„è·å–ï¼Œé‚£ä¹ˆæ­£åœ¨è¿è¡Œçš„å…¶ä»–è¯»çº¿ç¨‹å°±æ— æ³•æ„ŸçŸ¥åˆ°å½“å‰å†™çº¿ç¨‹çš„æ“ä½œã€‚å› æ­¤ï¼Œåªæœ‰ç­‰å¾…å…¶ä»–è¯»çº¿ç¨‹éƒ½é‡Šæ”¾äº†è¯»é”ï¼Œå†™é”æ‰èƒ½è¢«å½“å‰çº¿ç¨‹è·å–ï¼Œè€Œå†™é”ä¸€æ—¦è¢«è·å–ï¼Œåˆ™å…¶ä»–è¯»å†™çº¿ç¨‹çš„åç»­è®¿é—®å‡è¢«é˜»å¡ã€‚</li>\n<li>å†™é”çš„é‡Šæ”¾ä¸ReentrantLockçš„é‡Šæ”¾è¿‡ç¨‹åŸºæœ¬ç±»ä¼¼ï¼Œæ¯æ¬¡é‡Šæ”¾å‡å‡å°‘å†™çŠ¶æ€ï¼Œå½“å†™çŠ¶æ€ä¸º0æ—¶è¡¨ç¤ºå†™é”å·²è¢«é‡Šæ”¾ï¼Œä»è€Œç­‰å¾…çš„è¯»å†™çº¿ç¨‹èƒ½å¤Ÿç»§ç»­è®¿é—®è¯»å†™é”ï¼ŒåŒæ—¶å‰æ¬¡å†™çº¿ç¨‹çš„ä¿®æ”¹å¯¹åç»­è¯»å†™çº¿ç¨‹å¯è§ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    static final int SHARED_SHIFT   = 16;\n    static final int EXCLUSIVE_MASK = (1 &lt;&lt; SHARED_SHIFT) - 1 //1å·¦ç§»16ä½ç„¶åå‡1 0x0000FFFF\n    static int exclusiveCount(int c) { return c &amp; EXCLUSIVE_MASK; } //å–åŒæ­¥çŠ¶æ€çš„ä½16ä½ è¡¨ç¤ºå†™é”çš„è·å–æ¬¡æ•°\n    /*\n    * åœ¨åŒæ­¥çŠ¶æ€stateä¸Šç»´æŠ¤å¤šä¸ªè¯»çº¿ç¨‹å’Œä¸€ä¸ªå†™çº¿ç¨‹çš„çŠ¶æ€ã€‚è¯»å†™é”å°†å˜é‡åˆ‡åˆ†æˆäº†ä¸¤ä¸ªéƒ¨åˆ†ï¼Œé«˜16ä½è¡¨ç¤ºè¯»ï¼Œä½16ä½è¡¨ç¤ºå†™\n    * åŒæ­¥çŠ¶æ€stateä¸ç­‰äº0æ—¶ï¼Œå½“å†™çŠ¶æ€ï¼ˆstate&amp;0x0000FFFF(æŠ¹å»é«˜16ä½ä¸è¿ç®—å¾—åˆ°ä½16ä½çš„å€¼)ï¼‰ç­‰äº0æ—¶ï¼Œåˆ™è¯»çŠ¶æ€ï¼ˆstate&gt;&gt;&gt;16ï¼‰å¤§äº0ï¼Œå³è¯»é”å·²è¢«è·å–ã€‚\n    * å¦‚æœåœ¨ä¸€ä¸ªæ•´å‹å˜é‡ä¸Šç»´æŠ¤å¤šç§çŠ¶æ€ï¼Œå°±ä¸€å®šéœ€è¦â€œæŒ‰ä½åˆ‡å‰²ä½¿ç”¨â€è¿™ä¸ªå˜é‡\n    *  åŠŸèƒ½ï¼šå†™é”çš„è·å–ï¼šæŒæœ‰é”çš„çº¿ç¨‹state+1ï¼ŒéæŒæœ‰é”çš„çº¿ç¨‹CASæ“ä½œæˆåŠŸåè·å¾—é”\n    * 1 åˆ¤æ–­stateæ˜¯å¦æœ‰çº¿ç¨‹å·²ç»è·å–é”ï¼Œè‹¥ä¸ç­‰äº0æ‰§è¡Œ2ï¼Œç­‰äº0åˆ™æ‰§è¡Œ3\n    * 2 è‹¥æŒæœ‰é”çš„æ˜¯å½“å‰çº¿ç¨‹æ—¶è®¾ç½®state+1å¹¶è¿”å›trueï¼ˆé‡å…¥é”ï¼‰\n    * 3 writerShouldBlock(éå…¬å¹³é”falseï¼ˆé»˜è®¤ï¼‰ï¼Œå…¬å¹³é”hasQueuedPredecessors())æˆ–è€…CASè®¾ç½®stateå¤±è´¥ï¼Œè·å–é”å¤±è´¥\n    * 4 å°†æŒæœ‰çº¿ç¨‹çš„è®¾ç½®ä¸ºå½“å‰çº¿ç¨‹å¹¶è¿”å›true\n    */\n    protected final boolean tryAcquire(int acquires) {\n        Thread current = Thread.currentThread();\n        int c = getState();//1\n        int w = exclusiveCount(c);\n        if (c != 0) {//2\n            // å­˜åœ¨è¯»é”æˆ–è€…å½“å‰è·å–çº¿ç¨‹ä¸æ˜¯å·²ç»è·å–å†™é”çš„çº¿ç¨‹\n            if (w == 0 || current != getExclusiveOwnerThread())\n                return false;\n            if (w + exclusiveCount(acquires) &gt; MAX_COUNT)\n                throw new Error(\"Maximum lock count exceeded\");\n            setState(c + acquires);\n            return true;\n        }\n        if (writerShouldBlock() ||\n            !compareAndSetState(c, c + acquires))\n            return false;\n        setExclusiveOwnerThread(current);\n        return true;\n    }\n\n    final boolean writerShouldBlock() {//éå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰\n        return false; // writers can always barge\n    }\n    final boolean writerShouldBlock() {//å…¬å¹³é”\n        return hasQueuedPredecessors();\n    }\n    /*\n    *  å†™é”çš„é‡Šæ”¾ï¼šè®¾ç½®state=state-1å¦‚æœstate=0åˆ™ç‹¬å é”çº¿ç¨‹ä¸ºnull\n    *  1 state-1\n    *  2 å†™çŠ¶æ€ä¸º0åˆ™å æœ‰é”çš„çº¿ç¨‹ä¸ºnull\n    *  3 è®¾ç½®state\n    */\n    protected final boolean tryRelease(int releases) {\n        if (!isHeldExclusively())\n            throw new IllegalMonitorStateException();\n        int nextc = getState() - releases;//1\n        boolean free = exclusiveCount(nextc) == 0;//2\n        if (free)\n            setExclusiveOwnerThread(null);\n        setState(nextc);//3\n        return free;\n    }\n</code></pre></div><h1>3. è¯»é”çš„è·å–ä¸é‡Šæ”¾</h1>\n<ul>\n<li>è¯»é”æ˜¯ä¸€ä¸ªæ”¯æŒé‡è¿›å…¥çš„å…±äº«é”ï¼Œå®ƒèƒ½å¤Ÿè¢«å¤šä¸ªçº¿ç¨‹åŒæ—¶è·å–ï¼Œåœ¨æ²¡æœ‰å…¶ä»–å†™çº¿ç¨‹è®¿é—®ï¼ˆæˆ–è€…å†™çŠ¶æ€ä¸º0ï¼‰æ—¶ï¼Œè¯»é”æ€»ä¼šè¢«æˆåŠŸåœ°è·å–ï¼Œè€Œæ‰€åšçš„ä¹Ÿåªæ˜¯ï¼ˆçº¿ç¨‹å®‰å…¨çš„ï¼‰å¢åŠ è¯»çŠ¶æ€ã€‚å¦‚æœå½“å‰çº¿ç¨‹å·²ç»è·å–äº†è¯»é”ï¼Œåˆ™å¢åŠ è¯»çŠ¶æ€ã€‚å¦‚æœå½“å‰çº¿ç¨‹åœ¨è·å–è¯»é”æ—¶ï¼Œå†™é”å·²è¢«å…¶ä»–çº¿ç¨‹è·å–ï¼Œåˆ™è¿›å…¥ç­‰å¾…çŠ¶æ€ã€‚</li>\n<li>getReadHoldCount()æ–¹æ³•ï¼Œä½œç”¨æ˜¯è¿”å›å½“å‰çº¿ç¨‹è·å–è¯»é”çš„æ¬¡æ•°ã€‚è¯»çŠ¶æ€æ˜¯æ‰€æœ‰çº¿ç¨‹è·å–è¯»é”æ¬¡æ•°çš„æ€»å’Œï¼Œè€Œæ¯ä¸ªçº¿ç¨‹å„è‡ªè·å–è¯»é”çš„æ¬¡æ•°åªèƒ½é€‰æ‹©ä¿å­˜åœ¨ThreadLocalä¸­ï¼Œç”±çº¿ç¨‹è‡ªèº«ç»´æŠ¤ï¼Œè¿™ä½¿è·å–è¯»é”çš„å®ç°å˜å¾—å¤æ‚ã€‚å› æ­¤ï¼Œè¿™é‡Œå°†è·å–è¯»é”çš„ä»£ç åšäº†åˆ å‡ï¼Œä¿ç•™å¿…è¦çš„éƒ¨åˆ†</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    static final int SHARED_UNIT    = (1 &lt;&lt; SHARED_SHIFT);\n    static int sharedCount(int c)    { return c &gt;&gt;&gt; SHARED_SHIFT; } //åŒæ­¥çŠ¶æ€çš„é«˜16ä½ç”¨æ¥è¡¨ç¤ºè¯»é”è¢«è·å–çš„æ¬¡æ•°\n    /*\n    *  è¯»é”çš„è·å–\n    *  1 è‹¥æŒæœ‰é”çš„çº¿ç¨‹ä¸ä¸ºå½“å‰çº¿ç¨‹æ—¶ï¼Œé”è·å–å¤±è´¥ \n    *  2 è·å–åŒæ­¥çŠ¶æ€stateçš„é«˜16ä½çš„è¯»é”è·å–æ¬¡æ•°\n    *  3 å¦‚æœå¤´ç»“ç‚¹çš„ä¸‹ä¸€ä¸ªèŠ‚ç‚¹ä¸æ˜¯å…±äº«èŠ‚ç‚¹ä¸”CASæ“ä½œstateè®¾ç½®é«˜ä½æˆåŠŸåˆ™æˆåŠŸè·å–é”ï¼Œå¦‚æœä¸æˆåŠŸåˆ™æ‰§è¡Œ4\n    *  4 è°ƒç”¨fullTryAcquireShared()é‡å¤CASæ“ä½œç›´è‡³è·å–å…±äº«é”ï¼ˆå¾…çœ‹ï¼‰\n    */\n    protected final int tryAcquireShared(int unused) {\n        Thread current = Thread.currentThread();\n        int c = getState();\n        if (exclusiveCount(c) != 0 &amp;&amp;//1\n            getExclusiveOwnerThread() != current)\n            return -1;\n        int r = sharedCount(c);//2\n        if (!readerShouldBlock() &amp;&amp; //3\n            r &lt; MAX_COUNT &amp;&amp;\n            compareAndSetState(c, c + SHARED_UNIT)) {//åŒæ­¥çŠ¶æ€çš„é«˜16ä½ç”¨æ¥è¡¨ç¤ºè¯»é”è¢«è·å–çš„æ¬¡æ•°\n            //çœç•¥æ— å…³ä»£ç \n            return 1;\n        }\n        return fullTryAcquireShared(current);\n    }\n\n    final boolean readerShouldBlock() {//éå…¬å¹³é”ï¼ˆé»˜è®¤ï¼‰\n        return apparentlyFirstQueuedIsExclusive();\n    }\n\n    final boolean apparentlyFirstQueuedIsExclusive() {\n        Node h, s;\n        return (h = head) != null &amp;&amp; (s = h.next)  != null &amp;&amp;\n        !s.isShared() &amp;&amp; s.thread != null;\n    }\n\n    final boolean readerShouldBlock() {//å…¬å¹³é”\n        return hasQueuedPredecessors();\n    }\n    //å¾…çœ‹\n    final int fullTryAcquireShared(Thread current) {\n        HoldCounter rh = null;\n        for (;;) {\n            int c = getState();\n            if (exclusiveCount(c) != 0) {\n                if (getExclusiveOwnerThread() != current)\n                    return -1;\n                // else we hold the exclusive lock; blocking here\n                // would cause deadlock.\n            } else if (readerShouldBlock()) {\n                // Make sure we're not acquiring read lock reentrantly\n                if (firstReader == current) {\n                    // assert firstReaderHoldCount &gt; 0;\n                } else {\n                    if (rh == null) {\n                        rh = cachedHoldCounter;\n                        if (rh == null || rh.tid != getThreadId(current)) {\n                            rh = readHolds.get();\n                            if (rh.count == 0)\n                                readHolds.remove();\n                        }\n                    }\n                    if (rh.count == 0)\n                        return -1;\n                }\n            }\n            if (sharedCount(c) == MAX_COUNT)\n                throw new Error(\"Maximum lock count exceeded\");\n            if (compareAndSetState(c, c + SHARED_UNIT)) {\n                if (sharedCount(c) == 0) {\n                    firstReader = current;\n                    firstReaderHoldCount = 1;\n                } else if (firstReader == current) {\n                    firstReaderHoldCount++;\n                } else {\n                    if (rh == null)\n                        rh = cachedHoldCounter;\n                    if (rh == null || rh.tid != getThreadId(current))\n                        rh = readHolds.get();\n                    else if (rh.count == 0)\n                        readHolds.set(rh);\n                    rh.count++;\n                    cachedHoldCounter = rh; // cache for release\n                }\n                return 1;\n            }\n        }\n    }\n    //è¯»é”çš„é‡Šæ”¾ï¼šå°†è®¾ç½®æˆstate-SHARED_UNIT\n    //è¯»é”çš„æ¯æ¬¡é‡Šæ”¾ï¼ˆçº¿ç¨‹å®‰å…¨çš„ï¼Œå¯èƒ½æœ‰å¤šä¸ªè¯»çº¿ç¨‹åŒæ—¶é‡Šæ”¾è¯»é”ï¼‰å‡å‡å°‘è¯»çŠ¶æ€ï¼Œå‡å°‘çš„å€¼æ˜¯ï¼ˆ1&lt;&lt;16ï¼‰ã€‚\n    protected final boolean tryReleaseShared(int unused) {\n        //çœç•¥æ— å…³ä»£ç ...\n        for (;;) {\n            int c = getState();\n            int nextc = c - SHARED_UNIT;\n            if (compareAndSetState(c, nextc))\n                return nextc == 0;\n        }\n    }\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># è¯»é”ç®€åŒ–ç‰ˆ\nprotected final int tryAcquireShared(int unused) {\n    for (;;) {\n        int c = getState();\n        int nextc = c + (1 &lt;&lt; 16);\n        if (nextc &lt; c)\n            throw new Error(\"Maximum lock count exceeded\");\n        if (exclusiveCount(c) != 0 &amp;&amp; owner != Thread.currentThread())\n            return -1;\n        if (compareAndSetState(c, nextc))\n            return 1;\n    }\n}\n</code></pre></div><h1>4. é”é™çº§</h1>\n<ul>\n<li>è¯»å†™é”æ”¯æŒé”é™çº§ï¼Œéµå¾ªæŒ‰ç…§è·å–å†™é”ï¼Œè·å–è¯»é”å†é‡Šæ”¾å†™é”çš„æ¬¡åºï¼Œå†™é”èƒ½å¤Ÿé™çº§æˆä¸ºè¯»é”ï¼Œä¸æ”¯æŒé”å‡çº§</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>  class CachedData {\n    Object data;\n    volatile boolean cacheValid;\n    final ReentrantReadWriteLock rwl = new ReentrantReadWriteLock();\n    void processCachedData() {\n            rwl.readLock().lock();\n            if (!cacheValid) {\n                // Must release read lock before acquiring write lock\n                rwl.readLock().unlock();\n                rwl.writeLock().lock();\n                try {\n                    // Recheck state because another thread might have\n                    // acquired write lock and changed state before we did.\n                    if (!cacheValid) {\n                        data = ...\n                cacheValid = true;\n            }\n            // Downgrade by acquiring read lock before releasing write lock\n            rwl.readLock().lock();\n            } finally {\n            rwl.writeLock().unlock(); // Unlock write, still hold read\n            }\n        }\n    \n        try {\n            use(data);\n        } finally {\n            rwl.readLock().unlock();\n        }\n        }\n    }\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æºç "
      ]
    },
    {
      "title": "socket",
      "url": "https://javaguide.cn/backend/java/socket.html",
      "id": "https://javaguide.cn/backend/java/socket.html",
      "summary": "socket 1. TCP/IPåè®®ç»“æ„(Transmission Control Protocal/Internet Protoal ä¼ è¾“æ§åˆ¶åè®®) 2. IPåœ°å€åŠå…¶ä½¿ç”¨ 3. ç«¯å£å·åŠå…¶ä½¿ç”¨ 4. InetAddressç±»ï¼ˆå°è£…äº†IPåœ°å€ç­‰ä¿¡æ¯ï¼‰ 5. UDPåè®®(User Datagram Protocolç”¨æˆ·æ•°æ®æŠ¥åè®®/æ— è¿æ¥é€šä¿¡åè®®) 6....",
      "content_html": "<p>socket</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-tcpip%E5%8D%8F%E8%AE%AE%E7%BB%93%E6%9E%84transmission-control-protocalinternet-protoal-%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE\">1. TCP/IPåè®®ç»“æ„(Transmission Control Protocal/Internet Protoal ä¼ è¾“æ§åˆ¶åè®®)</a></li>\n<li><a href=\"#2-ip%E5%9C%B0%E5%9D%80%E5%8F%8A%E5%85%B6%E4%BD%BF%E7%94%A8\">2. IPåœ°å€åŠå…¶ä½¿ç”¨</a></li>\n<li><a href=\"#3-%E7%AB%AF%E5%8F%A3%E5%8F%B7%E5%8F%8A%E5%85%B6%E4%BD%BF%E7%94%A8\">3. ç«¯å£å·åŠå…¶ä½¿ç”¨</a></li>\n<li><a href=\"#4-inetaddress%E7%B1%BB%E5%B0%81%E8%A3%85%E4%BA%86ip%E5%9C%B0%E5%9D%80%E7%AD%89%E4%BF%A1%E6%81%AF\">4. InetAddressç±»ï¼ˆå°è£…äº†IPåœ°å€ç­‰ä¿¡æ¯ï¼‰</a></li>\n<li><a href=\"#5-udp%E5%8D%8F%E8%AE%AEuser-datagram-protocol%E7%94%A8%E6%88%B7%E6%95%B0%E6%8D%AE%E6%8A%A5%E5%8D%8F%E8%AE%AE%E6%97%A0%E8%BF%9E%E6%8E%A5%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE\">5. UDPåè®®(User Datagram Protocolç”¨æˆ·æ•°æ®æŠ¥åè®®/æ— è¿æ¥é€šä¿¡åè®®)</a></li>\n<li><a href=\"#6-tcptransmission-control-protocol%E4%BC%A0%E8%BE%93%E6%8E%A7%E5%88%B6%E5%8D%8F%E8%AE%AE%E9%9D%A2%E5%90%91%E8%BF%9E%E6%8E%A5%E7%9A%84%E9%80%9A%E4%BF%A1%E5%8D%8F%E8%AE%AE\">6. TCP(Transmission Control Protocolä¼ è¾“æ§åˆ¶åè®®/é¢å‘è¿æ¥çš„é€šä¿¡åè®®)</a></li>\n<li><a href=\"#7-tcp%E5%8D%8F%E8%AE%AE%E5%92%8Cudp%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%BC%82%E5%90%8C\">7. TCPåè®®å’ŒUDPåè®®çš„å¼‚åŒ</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. TCP/IPåè®®ç»“æ„(Transmission Control Protocal/Internet Protoal ä¼ è¾“æ§åˆ¶åè®®)</h1>\n<ul>\n<li>åº”ç”¨å±‚ï¼šä¸»è¦è´Ÿè´£åº”ç”¨ç¨‹åºçš„åè®®ï¼Œä¾‹å¦‚HTTPåè®®ã€FTPåè®®ã€DNSåè®®ç­‰ã€‚</li>\n<li>ä¼ è¾“å±‚ï¼šä¸»è¦ä½¿ç½‘ç»œç¨‹åºè¿›è¡Œé€šä¿¡ï¼Œåœ¨è¿›è¡Œç½‘ç»œé€šä¿¡æ—¶ï¼Œé‡‡ç”¨TCPåè®®/UDPåè®®</li>\n<li>ç½‘ç»œå±‚ï¼šæ•´ä¸ªTCP/IPåè®®æ ¸å¿ƒï¼Œå°†ä¼ è¾“çš„æ•°æ®è¿›è¡Œåˆ†ç»„å¹¶å°†åˆ†ç»„æ•°æ®å‘é€åˆ°ç›®æ ‡è®¡ç®—æœºæˆ–è€…ç½‘ç»œIPã€ICMPã€IOMPåè®®</li>\n<li>é“¾è·¯å±‚ï¼šå®šä¹‰ç‰©ç†ä¼ è¾“é€šé“ï¼Œé€šå¸¸æ˜¯å¯¹æŸäº›ç½‘ç»œè¿æ¥è®¾å¤‡çš„é©±åŠ¨åè®®ï¼Œä¾‹å¦‚é’ˆå¯¹å…‰çº¤ã€ç½‘çº¿æä¾›çš„é©±åŠ¨ç¨‹åºå’Œæ¥å£</li>\n</ul>\n<h1>2. IPåœ°å€åŠå…¶ä½¿ç”¨</h1>\n<ul>\n<li>å”¯ä¸€æ ‡è¯†ç½‘ç»œä¸­çš„è®¡ç®—æœºæ ‡ç¤ºå·ï¼Œå¯æŒ‡å®šæ¥å—æˆ–è¿æ¥è®¡ç®—æœºæˆ–è€…å‘é€æ•°æ®çš„è®¡ç®—æœº</li>\n<li>å¹¿æ³›ä½¿ç”¨çš„æ˜¯IPv4ç‰ˆæœ¬ï¼Œç”±4ä¸ªå­—èŠ‚çš„äºŒè¿›åˆ¶æ•°è¡¨ç¤ºï¼Œä¸ºäº†æ–¹ä¾¿å†™æˆåè¿›åˆ¶ï¼Œ</li>\n<li>æ¯ä¸ªå­—èŠ‚ç”¨ä¸€ä¸ªåè¿›åˆ¶æ•°å­—ï¼ˆ0-255ï¼‰è¡¨ç¤ºï¼Œæ•°å­—é—´ç”¨â€œ.â€è¡¨ç¤º</li>\n<li>IPv4åœ°å€æ¯ç«­ï¼Œè¯ç”Ÿäº†IPv6ï¼Œç”¨16ä¸ªå­—èŠ‚è¡¨ç¤ºIPåœ°å€</li>\n</ul>\n<h1>3. ç«¯å£å·åŠå…¶ä½¿ç”¨</h1>\n<ul>\n<li>è®¿é—®è®¡ç®—æœºçš„åº”ç”¨ç¨‹åºçš„æ ‡è¯†å·</li>\n<li>ç”¨ä¸¤ä¸ªå­—èŠ‚è¡¨ç¤ºï¼ˆ16ä½çš„äºŒè¿›åˆ¶æ•°2çš„16æ¬¡æ–¹è¡¨ç¤ºï¼š0-65535ï¼‰</li>\n<li>0-1023çš„ç«¯å£ç”¨äºçŸ¥åç½‘ç»œæœåŠ¡ï¼Œæ™®é€šç¨‹åºä½¿ç”¨1024ä»¥ä¸Šçš„ç«¯å£å·</li>\n<li>ä¸€ä¸ªç«¯å£åªèƒ½è®¿é—®ä¸€ä¸ªåº”ç”¨ç¨‹åºï¼Œè¢«å ç”¨å°±ä¸è¡Œ</li>\n</ul>\n<h1>4. InetAddressç±»ï¼ˆå°è£…äº†IPåœ°å€ç­‰ä¿¡æ¯ï¼‰</h1>\n<ul>\n<li>static InetAddress getByName(String host)åœ¨ç»™å®šä¸»æœºåçš„æƒ…å†µä¸‹ç¡®å®šä¸»æœºçš„IPåœ°å€ï¼Œä¸»æœºåå¦‚\"<a href=\"http://www.baidu.com\" target=\"_blank\" rel=\"noopener noreferrer\">www.baidu.com</a>\"</li>\n<li>static InetAddress getLocalHost()è¿”å›æœ¬åœ°ä¸»æœº</li>\n<li>String getHostName()è·å–æ­¤IPåœ°å€çš„ä¸»æœºå</li>\n<li>String getHostAddress()è¿”å›IPåœ°å€å­—ç¬¦ä¸²(ä»¥æ–‡æœ¬è¡¨ç°å½¢å¼)182.61.34.226</li>\n</ul>\n<h1>5. UDPåè®®(User Datagram Protocolç”¨æˆ·æ•°æ®æŠ¥åè®®/æ— è¿æ¥é€šä¿¡åè®®)</h1>\n<ul>\n<li>\n<p>æ•°æ®ä¼ è¾“æ—¶ï¼Œæ•°æ®çš„å‘é€ç«¯å’Œæ¥æ”¶ç«¯ä¸å»ºç«‹é€»è¾‘è¿æ¥ã€‚</p>\n</li>\n<li>\n<p>å½“ä¸€å°è®¡ç®—æœºå‘å¦å¤–ä¸€å°è®¡ç®—æœºå‘é€æ•°æ®æ—¶ï¼Œå‘é€ç«¯ä¸ä¼šç¡®è®¤æ¥æ”¶ç«¯æ˜¯å¦å­˜åœ¨ï¼Œå°±ä¼šå‘å‡ºæ•°æ®ï¼Œ</p>\n</li>\n<li>\n<p>åŒæ ·æ¥æ”¶ç«¯åœ¨æ”¶åˆ°æ•°æ®æ—¶ï¼Œä¹Ÿä¸ä¼šå‘å‘é€ç«¯åé¦ˆæ˜¯å¦æ”¶åˆ°æ•°æ®</p>\n</li>\n<li>\n<p>UDPåè®®æ¶ˆè€—èµ„æºå°ï¼Œé€šä¿¡æ•ˆç‡é«˜ï¼Œä¼ è¾“é€Ÿåº¦å¿«ï¼Œé€šå¸¸ç”¨äºéŸ³é¢‘ã€è§†é¢‘å’Œæ™®é€šæ•°æ®çš„ä¼ è¾“ä¾‹å¦‚è§†é¢‘ä¼šè®®éƒ½ä½¿ç”¨UDPåè®®ï¼Œ</p>\n</li>\n<li>\n<p>å› ä¸ºè¿™ç§æƒ…å†µå³ä½¿å¶å°”ä¸¢å¤±ä¸€ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œä¹Ÿä¸ä¼šå¯¹æ¥æ”¶ç»“æœäº§ç”Ÿå¤ªå¤§å½±å“</p>\n</li>\n<li>\n<p>åœ¨ä½¿ç”¨UDPåè®®ä¼ é€æ•°æ®æ—¶ï¼Œç”±äºUDPçš„é¢å‘æ— è¿æ¥æ€§ï¼Œä¸èƒ½ä¿è¯æ•°æ®çš„å®Œæ•´æ€§ï¼Œå› æ­¤åœ¨ä¼ è¾“é‡è¦æ•°æ®æ—¶ä¸å»ºè®®ä½¿ç”¨UDPåè®®</p>\n</li>\n<li>\n<p>DatagramPacketç±» æ•°æ®æŠ¥åŒ…ï¼šå°è£…UDPé€šä¿¡ä¸­å‘é€æˆ–è€…æ¥æ”¶çš„æ•°æ®</p>\n<ul>\n<li>DatagramPacket(byte[] buf,int length)//ç”¨äºæ¥æ”¶ç«¯ï¼Œä¸éœ€è¦æ˜ç¡®æ¥æºï¼Œåªéœ€æ¥å—æ•°æ®å³å¯</li>\n<li>DatagramPacket(byte[] buf,int lengthï¼ŒinetAddress addressï¼Œint port)//ç”¨äºå‘é€ç«¯ï¼Œå‘é€ç«¯å¿…é¡»æŒ‡å®šæ¥æ”¶ç«¯çš„ipåœ°å€å’Œ ç«¯å£å·ï¼Œè¯¥ç«¯å£å·å¿…é¡»ä¸æ¥æ”¶ç«¯DatagramSocketåˆ›å»ºå¯¹è±¡æ—¶çš„ç«¯å£å·ç›¸åŒæ‰èƒ½é€šä¿¡</li>\n<li>byte[] getData()è¿”å›æ•°æ®ç¼“å†²åŒº(å¯¹åº”æ„é€ )</li>\n<li>int getLength()è¿”å›å°†è¦å‘é€æˆ–æ¥æ”¶åˆ°çš„æ•°æ®çš„é•¿åº¦</li>\n<li>InetAddress getAddress()è¿”å›æ•°æ®æ¥æºæœºå™¨æˆ–è€…å°†è¦å‘ç»™çš„æœºå™¨çš„IPåœ°å€</li>\n<li>int getPort()è¿”å›æ•°æ®æ¥æºæœºå™¨æˆ–è€…å°†è¦å‘ç»™çš„æœºå™¨çš„ç«¯å£å·ï¼Œå¯¹åº”å‘é€ç«¯çš„æ„é€ æ–¹æ³•å‚æ•°</li>\n</ul>\n</li>\n<li>\n<p>DatagramSocketç±»æ•°æ®æŠ¥å¥—æ¥å­—ç±»ï¼šå‘é€å’Œæ¥æ”¶DatagramPacketæ•°æ®åŒ…</p>\n<ul>\n<li>DatagramSocket()åˆ›å»ºå‘é€ç«¯çš„DatagramSocketå¯¹è±¡,å¹¶ç»‘å®šåˆ°ä»»ä½•å¯ç”¨ç«¯å£</li>\n<li>DatagramSocket(int port)ä¸€èˆ¬ç”¨äºæ¥å—ç«¯ä»¥æŒ‡å®šæ¥æ”¶ç«¯çš„ç›‘å¬ç«¯å£å·ï¼Œä½†ä¹Ÿå¯ç”¨äºå‘é€ç«¯ç»‘å®šåˆ°æŒ‡å®šçš„ç«¯å£</li>\n<li>void receive(DatagramPacket p)ä»æ­¤å¥—æ¥å­—æ¥æ”¶æ•°æ®æŠ¥åŒ…</li>\n<li>void send(DataramPacket p)ä»æ­¤å¥—æ¥å­—å‘é€æ•°æ®æŠ¥åŒ…</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tUDPå‘é€ç«¯\n\tpublic class UDPSend {\n\tpublic static void main(String[] args) throws IOException {\n\t\tDatagramSocket sendSocket = new DatagramSocket();\n\t\tbyte[] buffer = \"hello,UDP\".getBytes();\n\t\tDatagramPacket dp = new DatagramPacket(buffer, buffer.length, \n\t\tInetAddress.getByName(\"192.168.75.58\"), 12306);\n\t\tsendSocket.send(dp);\n\t\tsendSocket.close();\n\t}\n\t}\n\tUDPæ¥æ”¶ç«¯\n\tpublic class UDPReceive {\n\t\tpublic static void main(String[] args) throws IOException {\n\t\t\tDatagramSocket receiveSocket = new DatagramSocket(12306);\n\t\t\tbyte[] buffer = new byte[1024];\n\t\t\tDatagramPacket dp = new DatagramPacket(buffer, 1024);\n\t\t\treceiveSocket.receive(dp);\n\t\t\tInetAddress ipAddress = dp.getAddress();\n\t\t\tString ip = ipAddress.getHostAddress();//è·å–åˆ°äº†IPåœ°å€\n\t\t\tbyte[] data = dp.getData();\t//å‘æ¥äº†ä»€ä¹ˆæ•°æ®  getData()\n\t\t\tint length = dp.getLength();\t//å‘æ¥äº†å¤šå°‘æ•°æ® getLenth()\n\t\t\tString dataStr = new String(data,0,length);\t//æ˜¾ç¤ºæ”¶åˆ°çš„æ•°æ®\n\t\t\tSystem.out.println(\"IPåœ°å€ï¼š\"+ip+ \"æ•°æ®æ˜¯\"+ dataStr);\n\t\t\treceiveSocket.close();\t\t//5,é‡Šæ”¾æµèµ„æº\n\t\t}\n\t}\n</code></pre></div><h1>6. TCP(Transmission Control Protocolä¼ è¾“æ§åˆ¶åè®®/é¢å‘è¿æ¥çš„é€šä¿¡åè®®)</h1>\n<ul>\n<li>\n<p>ä¼ è¾“æ•°æ®å‰å‘é€ç«¯å’Œæ¥æ”¶ç«¯å»ºç«‹é€»è¾‘è¿æ¥å†ä¼ è¾“æ•°æ®(å¯é æ— å·®é”™çš„æ•°æ®ä¼ è¾“)</p>\n</li>\n<li>\n<p>TCPè¿æ¥ç”±å®¢æˆ·ç«¯å‘æœåŠ¡ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œæ¯æ¬¡åˆ›å»ºè¿æ¥éƒ½ç»è¿‡â€œä¸‰æ¬¡æ¡æ‰‹â€</p>\n</li>\n<li>\n<p>ç¬¬ä¸€æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å‘æœåŠ¡å™¨ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œç­‰å¾…æœåŠ¡å™¨ç¡®è®¤ï¼Œ</p>\n</li>\n<li>\n<p>ç¬¬äºŒæ¬¡æ¡æ‰‹ï¼ŒæœåŠ¡å™¨ç«¯å‘å®¢æˆ·ç«¯å›é€ä¸€ä¸ªå“åº”ï¼Œé€šçŸ¥å®¢æˆ·ç«¯æ”¶åˆ°äº†è¿æ¥è¯·æ±‚ï¼Œ</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰æ¬¡æ¡æ‰‹ï¼Œå®¢æˆ·ç«¯å†æ¬¡å‘æœåŠ¡å™¨ç«¯å‘é€ç¡®è®¤ä¿¡æ¯ï¼Œç¡®è®¤è¿æ¥ã€‚</p>\n</li>\n<li>\n<p>é€šä¿¡æ—¶ï¼Œé¦–å…ˆåˆ›å»ºä»£è¡¨æœåŠ¡å™¨ç«¯ServerSocketå¯¹è±¡ï¼Œç›¸å½“äºå¼€å¯ä¸€ä¸ªæœåŠ¡ï¼Œå¹¶ç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥</p>\n</li>\n<li>\n<p>ç„¶ååˆ›å»ºä»£è¡¨å®¢æˆ·ç«¯Socketå¯¹è±¡å‘æœåŠ¡å™¨ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼ŒæœåŠ¡å™¨ç«¯å“åº”è¯·æ±‚</p>\n</li>\n<li>\n<p>ä¸¤è€…å»ºç«‹è¿æ¥å¼€å§‹é€šä¿¡ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ç«¯æ˜¯é€šè¿‡IOæµè¿›è¡Œäº¤äº’çš„</p>\n</li>\n<li>\n<p>ç”±äºTCPåè®®çš„é¢å‘è¿æ¥ç‰¹æ€§ï¼Œå®ƒå¯ä»¥ä¿è¯ä¼ è¾“æ•°æ®çš„å®‰å…¨æ€§å’Œç¨³å®šæ€§ï¼Œè¢«å¹¿æ³›é‡‡ç”¨</p>\n</li>\n<li>\n<p>ä¾‹å¦‚åœ¨ä¸‹è½½æˆ–ä¸Šä¼ æ–‡ä»¶æ—¶ï¼Œå¦‚æœæ•°æ®æ¥æ”¶ä¸å®Œæ•´ï¼Œå°†ä¼šå¯¼è‡´æ–‡ä»¶æ•°æ®ä¸¢å¤±è€Œä¸èƒ½è¢«æ‰“å¼€ï¼Œå› æ­¤ï¼Œä¸‹è½½æˆ–ä¸Šä¼ æ–‡ä»¶æ—¶å¿…é¡»é‡‡ç”¨TCPåè®®ã€‚</p>\n</li>\n<li>\n<p>ServerSocketæœåŠ¡å™¨ç«¯</p>\n<ul>\n<li>ServerSocket(int port)åˆ›å»ºç»‘å®šåˆ°ç‰¹å®šç«¯å£çš„æœåŠ¡å™¨å¥—æ¥å­—</li>\n<li>Socket accept()ç›‘å¬å¹¶æ¥æ”¶åˆ°æ­¤å¥—æ¥å­—çš„è¿æ¥ã€é€šè¿‡ä¸åŒsocketè¾¨åˆ«ä¸åŒè®¡ç®—æœº</li>\n<li>InetAddress getInetAddress()è¿”å›æ­¤æœåŠ¡å™¨å¥—æ¥å­—çš„æœ¬åœ°åœ°å€</li>\n<li>ServerSocketå¯¹è±¡è´Ÿè´£ç›‘å¬æŸå°è®¡ç®—æœºçš„æŸä¸ªç«¯å£å·ï¼Œåœ¨åˆ›å»ºServerSocketå¯¹è±¡åï¼Œ</li>\n<li>éœ€è¦ç»§ç»­è°ƒç”¨è¯¥å¯¹è±¡çš„accept()æ–¹æ³•ï¼Œæ¥æ”¶æ¥è‡ªå®¢æˆ·ç«¯çš„è¯·æ±‚ã€‚å½“æ‰§è¡Œäº†accept()æ–¹æ³•ä¹‹åï¼Œ</li>\n<li>æœåŠ¡å™¨ç«¯ç¨‹åºä¼šå‘ç”Ÿé˜»å¡ï¼Œç›´åˆ°å®¢æˆ·ç«¯å‘å‡ºè¿æ¥è¯·æ±‚ï¼Œaccept()æ–¹æ³•æ‰ä¼šè¿”å›ä¸€ä¸ªScoketå¯¹è±¡ç”¨äºå’Œå®¢æˆ·ç«¯å®ç°é€šä¿¡ï¼Œç¨‹åºæ‰èƒ½ç»§ç»­å‘ä¸‹æ‰§è¡Œ</li>\n</ul>\n</li>\n<li>\n<p>Socketå®¢æˆ·ç«¯</p>\n<ul>\n<li>Socket(String host,int port)å°†Socketè¿æ¥åˆ°æŒ‡å®šä¸»æœºä¸Šçš„æŒ‡å®šç«¯å£å·ï¼ˆå¸¸ç”¨ï¼‰</li>\n<li>Socket(InetAddress address,int port)å°†Socketè¿æ¥åˆ°æŒ‡å®šIPä¸Šçš„æŒ‡å®šç«¯å£å·ã€‚ä¸€æ—¦åˆ›å»ºé©¬ä¸Šè¿æ¥ï¼Œè¿æ¥ä¸åˆ°å°±æŠ¥é”™</li>\n<li>int getPort()è¿”å›ä¸€ä¸ªintç±»å‹å¯¹è±¡ï¼Œè¯¥å¯¹è±¡æ˜¯Socketå¯¹è±¡ä¸æœåŠ¡å™¨ç«¯è¿æ¥çš„ç«¯å£å·</li>\n<li>InetAddress getLocalAddress()è·å–Socketå¯¹è±¡ç»‘å®šçš„æœ¬åœ°IPåœ°å€ï¼Œå¹¶å°è£…æˆInetAddress</li>\n<li>void close()å…³é—­Socketè¿æ¥ï¼Œå…³é—­socketå‰ï¼Œåº”å°†ä¸socketç›¸å…³çš„æ‰€æœ‰è¾“å…¥/è¾“å‡ºæµå…³é—­</li>\n<li>InputStream getInputStream()è¿”å›è°ƒç”¨è€…çš„InputStream å¯¹è±¡å¹¶æ‰§è¡Œç›¸åº”æ“ä½œ</li>\n<li>OutputStream getOutputStream()è¿”å›è°ƒç”¨è€…çš„InputStream å¯¹è±¡å¹¶æ‰§è¡Œç›¸åº”æ“ä½œ</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tTCP æœåŠ¡å™¨ç«¯\n\tpublic class TCPServer {\n\t\tpublic static void main(String[] args) throws IOException {\n\t\t\tServerSocket ss = new ServerSocket(8888);\n\t\t\tSocket s = ss.accept();\n\t\t\t//è¦è¯»å–sä¸­ä¼ é€’çš„æ•°æ®ï¼Œs.getInputstreamæ˜¯å–å¾—sè¾“å…¥çš„å­—ç¬¦\n\t\t\tInputStreamReader isr=new InputStreamReader(s.getInputStream());\n\t\t\tBufferedReader br=new BufferedReader(isr);\n\t\t\t//è¯»å–brä¸­çš„å­—ç¬¦ï¼Œè¯»å–ä¸€ä¸ªæ–‡æœ¬è¡Œ\n\t\t\tString info=br.readLine();\n\t\t\tSystem.out.println(\"æœåŠ¡å™¨æ¥æ”¶åˆ°:\\t\"+info);\n\t\t\t//trueæ˜¯åŠæ—¶æ›´æ–°æ•°æ®çš„æ„æ€\ts.getOutputstreamæ˜¯å–å¾—sè¾“å‡ºçš„å­—\n\t\t\tPrintWriter pw=new PrintWriter(s.getOutputStream(),true);\n\t\t\tpw.println(\"æˆ‘æ˜¯æœåŠ¡å™¨ï¼Œå·²æ”¶åˆ°ä½ å‘é€çš„ä¿¡æ¯!\");\t\n\t\t}\n\t}\n\tTCP å®¢æˆ·ç«¯\n\tpublic class TCPClient {\n\t\tpublic static void main(String[] args) throws IOException {\n\t\t\t//Socket()å°±æ˜¯å»è¿æ¥æŸä¸ªæœåŠ¡å™¨ç«¯ 127.0.0.1è¡¨ç¤ºæœåŠ¡å™¨çš„ip 9999æ˜¯æœåŠ¡å™¨çš„ç«¯å£å·\n\t\t\tSocket s=new Socket(\"127.0.0.1\",9999);\n\n\t\t\t//å¦‚æœsè¿æ¥æˆåŠŸï¼Œå°±å¯ä»¥å‘é€æ•°æ®åˆ°æœåŠ¡å™¨ç«¯\n\t\t\t//æˆ‘ä»¬é€šè¿‡pwå‘så†™æ•°æ®,trueè¡¨ç¤ºå³æ—¶åˆ·æ–°\n\t\t\tPrintWriter pw=new PrintWriter(s.getOutputStream(),true);\n\t\t\tpw.println(\"ä½ å¥½å—ï¼Ÿæˆ‘æ˜¯å®¢æˆ·ç«¯\");\n\t\t\t//è¦è¯»å–sä¸­ä¼ é€’çš„æ•°æ®\n\t\t\tInputStreamReader isr=new InputStreamReader(s.getInputStream());\n\t\t\tBufferedReader br=new BufferedReader(isr);\n\t\t\tString info=br.readLine();\n\t\t\tSystem.out.println(\"æ¥æ”¶åˆ°æœåŠ¡å™¨ï¼š\\t\"+info);\n\t\t}\n\t}\n</code></pre></div><h1>7. TCPåè®®å’ŒUDPåè®®çš„å¼‚åŒ</h1>\n<ul>\n<li>TCPé€šä¿¡åŒUDPé€šä¿¡ä¸€æ ·ï¼Œéƒ½èƒ½å®ç°ä¸¤å°è®¡ç®—æœºä¹‹é—´çš„é€šä¿¡ï¼Œé€šä¿¡çš„ä¸¤ç«¯éƒ½éœ€è¦åˆ›å»ºsocketå¯¹è±¡</li>\n<li>UDPä¸­åªæœ‰å‘é€ç«¯å’Œæ¥æ”¶ç«¯ï¼Œä¸åŒºåˆ†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯ï¼Œè®¡ç®—æœºä¹‹é—´å¯ä»¥ä»»æ„åœ°å‘é€æ•°æ®\n<ul>\n<li>TCPä¸­æ˜¯ä¸¥æ ¼åŒºåˆ†å®¢æˆ·ç«¯ä¸æœåŠ¡å™¨ç«¯çš„ï¼Œåœ¨é€šä¿¡æ—¶ï¼Œå¿…é¡»å…ˆç”±å®¢æˆ·ç«¯å»è¿æ¥æœåŠ¡å™¨ç«¯æ‰èƒ½å®ç°é€šä¿¡</li>\n<li>æœåŠ¡å™¨ç«¯ä¸å¯ä»¥ä¸»åŠ¨è¿æ¥å®¢æˆ·ç«¯ï¼Œå¹¶ä¸”æœåŠ¡å™¨ç«¯ç¨‹åºéœ€è¦äº‹å…ˆå¯åŠ¨ï¼Œç­‰å¾…å®¢æˆ·ç«¯çš„è¿æ¥</li>\n</ul>\n</li>\n<li>UDPåè®®ä¼ è¾“é€Ÿåº¦å¿«,æ•ˆç‡é«˜,èµ„æºæ¶ˆè€—å°‘,ä½†ä¼šä¸¢å¤±æ•°æ®;TCPåè®®ä¼ è¾“å®‰å…¨ç¨³å®š,ä¸ä¸¢å¤±æ•°æ®</li>\n</ul>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Spring",
      "url": "https://javaguide.cn/backend/java/spring.html",
      "id": "https://javaguide.cn/backend/java/spring.html",
      "summary": "springæºç  1. AnnotationConfigApplicationContext extends GenericApplicationContext,AbstractApplicationContext,DefaultResourceLoader implements AnnotationConfigRegistry,BeanDefinit...",
      "content_html": "<p>springæºç </p>\n<!--more-->\n<!-- TOC -->\n<!-- /TOC -->\n<h1>1. AnnotationConfigApplicationContext extends GenericApplicationContext,AbstractApplicationContext,DefaultResourceLoader</h1>\n<p>implements AnnotationConfigRegistry,BeanDefinitionRegistry,ConfigurableApplicationContext,AliasRegistry,ApplicationContext,Lifecycle,Closeable<br>\nEnvironmentCapable, ListableBeanFactory, HierarchicalBeanFactory,MessageSource, ApplicationEventPublisher, ResourcePatternResolver,BeanFactory,ResourceLoader,AutoCloseable<br>\npublic class AnnotationConfigApplicationContext extends GenericApplicationContext implements AnnotationConfigRegistry{<br>\nprivate final AnnotatedBeanDefinitionReader reader;</p>\n<pre><code>private final ClassPathBeanDefinitionScanner scanner;\n\npublic AnnotationConfigApplicationContext() {\n\tthis.reader = new AnnotatedBeanDefinitionReader(this);\n\tthis.scanner = new ClassPathBeanDefinitionScanner(this);\n}\npublic AnnotationConfigApplicationContext(Class&lt;?&gt;... annotatedClasses) {\n\tthis();//åˆ›å»ºAnnotatedBeanDefinitionReaderå’ŒClassPathBeanDefinitionScanner\n\tregister(annotatedClasses);\n\trefresh();\n}\n//GenericApplicationContext çˆ¶ç±»æ„é€ \nprivate final DefaultListableBeanFactory beanFactory;\npublic GenericApplicationContext() {\n\tthis.beanFactory = new DefaultListableBeanFactory();//é»˜è®¤åˆ›å»ºäº†BeanFactory\n}\n//AbstractApplicationContext çˆ¶çˆ¶ç±»æ„é€ \nprivate ResourcePatternResolver resourcePatternResolver;\npublic AbstractApplicationContext() {\n\tthis.resourcePatternResolver = getResourcePatternResolver();\n}\n\nprotected ResourcePatternResolver getResourcePatternResolver() {\n\treturn new PathMatchingResourcePatternResolver(this);\n}\n\npublic void register(Class&lt;?&gt;... annotatedClasses) {\n\tAssert.notEmpty(annotatedClasses, \"At least one annotated class must be specified\");\n\tthis.reader.register(annotatedClasses);\n}\npublic void register(Class&lt;?&gt;... annotatedClasses) {\n\tfor (Class&lt;?&gt; annotatedClass : annotatedClasses) {\n\t\tregisterBean(annotatedClass);\n\t}\n}\npublic void registerBean(Class&lt;?&gt; annotatedClass) {\n\tdoRegisterBean(annotatedClass, null, null, null);\n}\n//1.åˆå§‹åŒ–AnnotatedGenericBeanDefinition\n//\t\tå±æ€§class = ä¼ å…¥çš„class\n// \t\tå±æ€§metadata=StandardAnnotationMetadata å¯¹è±¡ é‡Œé¢çš„annotations=ä¼ å…¥classçš„æ‰€æœ‰æ³¨è§£ nestedAnnotationsAsMap = true introspectedClass = ä¼ å…¥çš„class\n//2.shouldSkipåˆ¤æ–­æ˜¯å¦åº”è¯¥è·³è¿‡ï¼Œå³æ˜¯å¦æœ‰conditionalæ³¨è§£(å†…éƒ¨é€šè¿‡Processoræ¥å£å®ç°ç±»alwaysTrueAnnotationProcessorçš„è°ƒç”¨searchWithGetSemanticsåˆ¤æ–­è¿”å›nullç¡®å®šä¸è·³è¿‡)\n//3.è§£æ@Scopeæ³¨è§£ï¼Œè·å–beançš„ä½œç”¨åŸŸé…ç½®ä¿¡æ¯\n//4.è§£æå…¬å…±æ³¨è§£Lazy DependsOn Role Description\n//5.å°†å¯åŠ¨ç±»æ³¨å†Œåˆ°beanDefinitionMapä¸­\n&lt;T&gt; void doRegisterBean(Class&lt;T&gt; annotatedClass, @Nullable Supplier&lt;T&gt; instanceSupplier, @Nullable String name,\n\t\t@Nullable Class&lt;? extends Annotation&gt;[] qualifiers, BeanDefinitionCustomizer... definitionCustomizers) {\n\tAnnotatedGenericBeanDefinition abd = new AnnotatedGenericBeanDefinition(annotatedClass);\n\tif (this.conditionEvaluator.shouldSkip(abd.getMetadata())) {\n\t\treturn;\n\t}\n\n\tabd.setInstanceSupplier(instanceSupplier);\n\t//è§£æ@Scopeæ³¨è§£ï¼Œè·å–beançš„ä½œç”¨åŸŸé…ç½®ä¿¡æ¯\n\tScopeMetadata scopeMetadata = this.scopeMetadataResolver.resolveScopeMetadata(abd);\n\tabd.setScope(scopeMetadata.getScopeName());\n\tString beanName = (name != null ? name : this.beanNameGenerator.generateBeanName(abd, this.registry));//äº§ç”ŸBeanName\n\t//è§£æå…¬å…±æ³¨è§£Lazy DependsOn Role Description\n\tAnnotationConfigUtils.processCommonDefinitionAnnotations(abd);\n\tif (qualifiers != null) {\n\t\tfor (Class&lt;? extends Annotation&gt; qualifier : qualifiers) {\n\t\t\tif (Primary.class == qualifier) {\n\t\t\t\tabd.setPrimary(true);\n\t\t\t}\n\t\t\telse if (Lazy.class == qualifier) {\n\t\t\t\tabd.setLazyInit(true);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tabd.addQualifier(new AutowireCandidateQualifier(qualifier));\n\t\t\t}\n\t\t}\n\t}\n\tfor (BeanDefinitionCustomizer customizer : definitionCustomizers) {\n\t\tcustomizer.customize(abd);\n\t}\n\n\tBeanDefinitionHolder definitionHolder = new BeanDefinitionHolder(abd, beanName);\n\tdefinitionHolder = AnnotationConfigUtils.applyScopedProxyMode(scopeMetadata, definitionHolder, this.registry);\n\tBeanDefinitionReaderUtils.registerBeanDefinition(definitionHolder, this.registry);\n}\n</code></pre>\n<p>}</p>\n<h1>2. BeanDefinitionReaderUtils</h1>\n<p>public class BeanDefinitionReaderUtils {<br>\npublic static void registerBeanDefinition(<br>\nBeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry)<br>\nthrows BeanDefinitionStoreException {</p>\n<pre><code>\t// Register bean definition under primary name.\n\tString beanName = definitionHolder.getBeanName();\n\tregistry.registerBeanDefinition(beanName, definitionHolder.getBeanDefinition());\n\n\t// Register aliases for bean name, if any.\n\tString[] aliases = definitionHolder.getAliases();\n\tif (aliases != null) {\n\t\tfor (String alias : aliases) {\n\t\t\tregistry.registerAlias(beanName, alias);\n\t\t}\n\t}\n}\n</code></pre>\n<p>}</p>\n<h1>3. PathMatchingResourcePatternResolver</h1>\n<p>public class PathMatchingResourcePatternResolver implements ResourcePatternResolver {<br>\nprivate final ResourceLoader resourceLoader;<br>\npublic PathMatchingResourcePatternResolver(ResourceLoader resourceLoader) {<br>\nAssert.notNull(resourceLoader, \"ResourceLoader must not be null\");<br>\nthis.resourceLoader = resourceLoader;<br>\n}<br>\n}</p>\n<h1>4. DefaultListableBeanFactory extends AbstractAutowireCapableBeanFactory,AbstractBeanFactory,FactoryBeanRegistrySupport,DefaultSingletonBeanRegistry,SimpleAliasRegistry</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>implements ConfigurableListableBeanFactory,ListableBeanFactory, AutowireCapableBeanFactory, ConfigurableBeanFactory,BeanFactory,HierarchicalBeanFactory, SingletonBeanRegistry,AliasRegistry\n\npublic class DefaultListableBeanFactory extends AbstractAutowireCapableBeanFactory implements ConfigurableListableBeanFactory, BeanDefinitionRegistry, Serializable {\n\t\t\tprivate final Map&lt;String, BeanDefinition&gt; beanDefinitionMap = new ConcurrentHashMap&lt;&gt;(256);\n\t\t\tprivate volatile List&lt;String&gt; beanDefinitionNames = new ArrayList&lt;&gt;(256);\n\t\t\tprivate AutowireCandidateResolver autowireCandidateResolver = new SimpleAutowireCandidateResolver();\n\t\t\tprivate Comparator&lt;Object&gt; dependencyComparator;\n\t\t\tprivate final Map&lt;String, String&gt; aliasMap = new ConcurrentHashMap&lt;&gt;(16);\n\t\t\tprivate final Set&lt;String&gt; alreadyCreated = Collections.newSetFromMap(new ConcurrentHashMap&lt;&gt;(256));\n\t\t\tprivate volatile Set&lt;String&gt; manualSingletonNames = new LinkedHashSet&lt;&gt;(16);\n\t\t\t/** Cached array of bean definition names in case of frozen configuration */\n\t\t\tprivate volatile String[] frozenBeanDefinitionNames;\n\n\t\t\tDefaultListableBeanFactory{}\n\t\t\t//çˆ¶ç±»DefaultSingletonBeanRegistry\n\t\t\t/** Cache of singleton objects: bean name --&gt; bean instance */\n\t\t\tprivate final Map&lt;String, Object&gt; singletonObjects = new ConcurrentHashMap&lt;&gt;(256);\n\n\t\t\t/** Cache of singleton factories: bean name --&gt; ObjectFactory */\n\t\t\tprivate final Map&lt;String, ObjectFactory&lt;?&gt;&gt; singletonFactories = new HashMap&lt;&gt;(16);\n\n\t\t\t/** Cache of early singleton objects: bean name --&gt; bean instance */\n\t\t\tprivate final Map&lt;String, Object&gt; earlySingletonObjects = new HashMap&lt;&gt;(16);\n\t\t\t//çˆ¶ç±»AbstractBeanFactory\n\t\t\t@Nullable\n\t\t\tprivate ClassLoader beanClassLoader = ClassUtils.getDefaultClassLoader();\n\t\t}\n\n\t\tprotected boolean hasBeanCreationStarted() {\n\t\t\treturn !this.alreadyCreated.isEmpty();\n\t\t}\n\n\t\tpublic void registerBeanDefinition(String beanName, BeanDefinition beanDefinition) throws BeanDefinitionStoreException {\n\t\t\tif (beanDefinition instanceof AbstractBeanDefinition) {\n\t\t\t\ttry {\n\t\t\t\t\t((AbstractBeanDefinition) beanDefinition).validate();\n\t\t\t\t}\n\t\t\t\tcatch (BeanDefinitionValidationException ex) {\n\t\t\t\t\tthrow new BeanDefinitionStoreException(beanDefinition.getResourceDescription(), beanName,\n\t\t\t\t\t\t\t\"Validation of bean definition failed\", ex);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\tBeanDefinition existingDefinition = this.beanDefinitionMap.get(beanName);\n\t\t\tif (existingDefinition != null) {\n\t\t\t\tthis.beanDefinitionMap.put(beanName, beanDefinition);\n\t\t\t}\n\t\t\telse {\n\t\t\t\tif (hasBeanCreationStarted()) {\n\t\t\t\t\t// Cannot modify startup-time collection elements anymore (for stable iteration)\n\t\t\t\t\tsynchronized (this.beanDefinitionMap) {\n\t\t\t\t\t\tthis.beanDefinitionMap.put(beanName, beanDefinition);\n\t\t\t\t\t\tList&lt;String&gt; updatedDefinitions = new ArrayList&lt;&gt;(this.beanDefinitionNames.size() + 1);\n\t\t\t\t\t\tupdatedDefinitions.addAll(this.beanDefinitionNames);\n\t\t\t\t\t\tupdatedDefinitions.add(beanName);\n\t\t\t\t\t\tthis.beanDefinitionNames = updatedDefinitions;\n\t\t\t\t\t\tif (this.manualSingletonNames.contains(beanName)) {\n\t\t\t\t\t\t\tSet&lt;String&gt; updatedSingletons = new LinkedHashSet&lt;&gt;(this.manualSingletonNames);\n\t\t\t\t\t\t\tupdatedSingletons.remove(beanName);\n\t\t\t\t\t\t\tthis.manualSingletonNames = updatedSingletons;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tthis.beanDefinitionMap.put(beanName, beanDefinition);\n\t\t\t\t\tthis.beanDefinitionNames.add(beanName);\n\t\t\t\t\tthis.manualSingletonNames.remove(beanName);\n\t\t\t\t}\n\t\t\t\tthis.frozenBeanDefinitionNames = null;\n\t\t\t}\n\n\t\t\tif (existingDefinition != null || containsSingleton(beanName)) {\n\t\t\t\tresetBeanDefinition(beanName);\n\t\t\t}\n\t\t\telse if (isConfigurationFrozen()) {\n\t\t\t\tclearByTypeCache();\n\t\t\t}\n\t\t}\n\t\tpublic void registerAlias(String name, String alias) {\n\t\t\tsynchronized (this.aliasMap) {\n\t\t\t\tif (alias.equals(name)) {\n\t\t\t\t\tthis.aliasMap.remove(alias);\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\tString registeredName = this.aliasMap.get(alias);\n\t\t\t\t\tif (registeredName != null) {\n\t\t\t\t\t\tif (registeredName.equals(name)) {\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif (!allowAliasOverriding()) {\n\t\t\t\t\t\t\tthrow new IllegalStateException(\"Cannot define alias '\" + alias + \"' for name '\" +\n\t\t\t\t\t\t\t\t\tname + \"': It is already registered for name '\" + registeredName + \"'.\");\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcheckForAliasCircle(name, alias);\n\t\t\t\t\tthis.aliasMap.put(alias, name);\n\t\t\t\t}\n\t\t\t}\n\t}\n}\n</code></pre></div><h1>5. AnnotatedBeanDefinitionReader</h1>\n<p>public class AnnotatedBeanDefinitionReader{<br>\n// 1.getOrCreateEnvironmentåˆ¤æ–­registryæ˜¯å¦å®ç°äº†ConfigurableEnvironmentæ¥å£ï¼Œæ²¡æœ‰å®ç°ç¯å¢ƒçš„æ¥å£çš„è¯è¿”å›é»˜è®¤å®ç°çš„ç¯å¢ƒStandardEnvironment<br>\n// 2.(1)å°†registryèµ‹å€¼ç»™å½“å‰å¯¹è±¡<br>\n//(2)ç»™å½“å‰å¯¹è±¡åˆ›å»ºconditionEvaluatorï¼ˆ<br>\n// \tconditionEvaluatorå¯¹è±¡åˆå§‹åŒ–å±æ€§ ConditionContextImpl<br>\n//registry ç›´æ¥èµ‹å€¼<br>\n// resourceLoader : å–å‡ºä¼ é€’çš„resourceLoader(null)çš„ClassLoaderæˆ–è€…æ˜¯beanFactoryçš„BeanClassLoader,æœ€åæ‰è¿”å›getDefaultClassLoader<br>\n// \tbeanfactoryå±æ€§ï¼šå–å‡ºConfigurableListableBeanFactoryæ¥å£æˆ–ConfigurableApplicationContextæ¥å£çš„BeanFactoryï¼‰<br>\n// å–å‡ºå®ç°EnvironmentCapableæ¥å£çš„environmentï¼Œå¦åˆ™ä½¿ç”¨StandardEnvironment<br>\n//å–å‡ºResourceLoaderæ¥å£çš„èµ„æºé…ç½®ç±»,å¦åˆ™ä½¿ç”¨DefaultResourceLoader<br>\n//(3)ç»™å½“å‰å¯¹è±¡registryæ³¨å†ŒAnnotationConfigProcessors<br>\n//å°†registryå¼ºè½¬ä¸ºDefaultListableBeanFactoryå¹¶è®¾ç½®AnnotationAwareOrderComparatorå’ŒContextAnnotationAutowireCandidateResolverå±æ€§<br>\n<a href=\"//xn--org-zr0f.springframework.context.annotation.internalConfigurationAnnotationProcessor//%E6%B3%A8%E8%A7%A3%E5%90%8E%E7%BD%AE%E5%A4%84%E7%90%86%E5%99%A8\" target=\"_blank\" rel=\"noopener noreferrer\">//å°†org.springframework.context.annotation.internalConfigurationAnnotationProcessor//æ³¨è§£åç½®å¤„ç†å™¨</a><br>\n<a href=\"//org.springframework.context.annotation.internalAutowiredAnnotationProcessor\" target=\"_blank\" rel=\"noopener noreferrer\">//org.springframework.context.annotation.internalAutowiredAnnotationProcessor</a>\"<br>\n<a href=\"//org.springframework.context.annotation.internalRequiredAnnotationProcessor\" target=\"_blank\" rel=\"noopener noreferrer\">//org.springframework.context.annotation.internalRequiredAnnotationProcessor</a><br>\n<a href=\"//org.springframework.context.annotation.internalCommonAnnotationProcessor\" target=\"_blank\" rel=\"noopener noreferrer\">//org.springframework.context.annotation.internalCommonAnnotationProcessor</a><br>\n<a href=\"//org.springframework.context.event.internalEventListenerProcessor\" target=\"_blank\" rel=\"noopener noreferrer\">//org.springframework.context.event.internalEventListenerProcessor</a><br>\n<a href=\"//org.springframework.context.event.internalEventListenerFactory\" target=\"_blank\" rel=\"noopener noreferrer\">//org.springframework.context.event.internalEventListenerFactory</a><br>\n// æ”¾å…¥åˆ°registryä¸­<br>\nprivate final BeanDefinitionRegistry registry;<br>\nprivate ConditionEvaluator conditionEvaluator;<br>\nprivate ScopeMetadataResolver scopeMetadataResolver = new AnnotationScopeMetadataResolver();<br>\nprivate BeanNameGenerator beanNameGenerator = new AnnotationBeanNameGenerator();<br>\npublic AnnotatedBeanDefinitionReader(BeanDefinitionRegistry registry) {<br>\nthis(registry, getOrCreateEnvironment(registry));<br>\n}</p>\n<pre><code>public AnnotatedBeanDefinitionReader(BeanDefinitionRegistry registry, Environment environment) {\n\tAssert.notNull(registry, \"BeanDefinitionRegistry must not be null\");\n\tAssert.notNull(environment, \"Environment must not be null\");\n\tthis.registry = registry;\n\tthis.conditionEvaluator = new ConditionEvaluator(registry, environment, null);\n\tAnnotationConfigUtils.registerAnnotationConfigProcessors(this.registry);//å°†AnnotationConfigProcessorså°è£…æˆRootBeanDefinitionæ”¾å…¥BeanFactory\n}\n\n//åˆ¤æ–­registryæ˜¯å¦å®ç°äº†ConfigurableEnvironmentæ¥å£ï¼Œæ²¡æœ‰å®ç°ç¯å¢ƒçš„æ¥å£çš„è¯è¿”å›é»˜è®¤å®ç°çš„ç¯å¢ƒStandardEnvironment\nprivate static Environment getOrCreateEnvironment(BeanDefinitionRegistry registry) {\n\tAssert.notNull(registry, \"BeanDefinitionRegistry must not be null\");\n\tif (registry instanceof EnvironmentCapable) {\n\t\t//ç”±äºAnnotationConfigApplicationContextå®ç°äº†EnvironmentCapableä»è¿™é‡Œè¿”å›\n\t\t//é»˜è®¤ä½¿ç”¨StandardEnvironment\n\t\treturn ((EnvironmentCapable) registry).getEnvironment();\n\t}\n\treturn new StandardEnvironment();\n}\n</code></pre>\n<p>}</p>\n<h1>6. ConditionEvaluator</h1>\n<p>class ConditionEvaluator{<br>\nprivate final ConditionContextImpl context;<br>\npublic ConditionEvaluator(@Nullable BeanDefinitionRegistry registry,@Nullable Environment environment, @Nullable ResourceLoader resourceLoader) {<br>\nthis.context = new ConditionContextImpl(registry, environment, resourceLoader);//resourceLoader=null<br>\n}<br>\nprivate static class ConditionContextImpl implements ConditionContext {<br>\nprivate final BeanDefinitionRegistry registry;<br>\nprivate final ConfigurableListableBeanFactory beanFactory;<br>\nprivate final Environment environment;<br>\nprivate final ResourceLoader resourceLoader;<br>\nprivate final ClassLoader classLoader;<br>\npublic ConditionContextImpl(@Nullable BeanDefinitionRegistry registry,@Nullable Environment environment, @Nullable ResourceLoader resourceLoader) {<br>\nthis.registry = registry;<br>\nthis.beanFactory = deduceBeanFactory(registry);<br>\nthis.environment = (environment != null ? environment : deduceEnvironment(registry));<br>\nthis.resourceLoader = (resourceLoader != null ? resourceLoader : deduceResourceLoader(registry));<br>\nthis.classLoader = deduceClassLoader(resourceLoader, this.beanFactory);<br>\n}<br>\n}<br>\n//å–å‡ºConfigurableListableBeanFactoryæ¥å£æˆ–ConfigurableApplicationContextæ¥å£çš„BeanFactoryï¼Œå¦åˆ™ä¸ºnull<br>\nprivate ConfigurableListableBeanFactory deduceBeanFactory(@Nullable BeanDefinitionRegistry source) {<br>\nif (source instanceof ConfigurableListableBeanFactory) {<br>\nreturn (ConfigurableListableBeanFactory) source;<br>\n}<br>\nif (source instanceof ConfigurableApplicationContext) {<br>\nreturn (((ConfigurableApplicationContext) source).getBeanFactory());ç”±äºAnnotationConfigApplicationContextå®ç°äº†ConfigurableApplicationContextä»è¿™é‡Œè¿”å›<br>\n}<br>\nreturn null;<br>\n}<br>\n//å–å‡ºEnvironmentCapableæ¥å£çš„environmentï¼Œå¦åˆ™ä½¿ç”¨StandardEnvironment<br>\nprivate Environment deduceEnvironment(@Nullable BeanDefinitionRegistry source) {<br>\nif (source instanceof EnvironmentCapable) {<br>\nreturn ((EnvironmentCapable) source).getEnvironment();ç”±äºAnnotationConfigApplicationContextå®ç°äº†EnvironmentCapableä»è¿™é‡Œè¿”å›<br>\n}<br>\nreturn new StandardEnvironment();<br>\n}<br>\n//å–å‡ºResourceLoaderæ¥å£çš„èµ„æºé…ç½®ç±»ï¼Œå¦åˆ™ä½¿ç”¨DefaultResourceLoader<br>\nprivate ResourceLoader deduceResourceLoader(@Nullable BeanDefinitionRegistry source) {<br>\nif (source instanceof ResourceLoader) {<br>\nreturn (ResourceLoader) source;//ç”±äºAnnotationConfigApplicationContextå®ç°äº†ResourceLoaderä»è¿™é‡Œè¿”å›<br>\n}<br>\nreturn new DefaultResourceLoader();<br>\n}</p>\n<pre><code>//å–å‡ºBeanFactoryçš„classLoaderï¼Œå¦åˆ™ä½¿ç”¨DefaultClassLoader\nprivate ClassLoader deduceClassLoader(@Nullable ResourceLoader resourceLoader,@Nullable ConfigurableListableBeanFactory beanFactory) {\n\tif (resourceLoader != null) {\n\t\tClassLoader classLoader = resourceLoader.getClassLoader();\n\t\tif (classLoader != null) {\n\t\t\treturn classLoader;\n\t\t}\n\t}\n\tif (beanFactory != null) {\n\t\treturn beanFactory.getBeanClassLoader();//resourceLoaderä¸ºnullä»è¿™é‡Œè¿”å›\n\t}\n\treturn ClassUtils.getDefaultClassLoader();\n}\npublic boolean shouldSkip(AnnotatedTypeMetadata metadata) {\n\treturn shouldSkip(metadata, null);\n}\npublic boolean shouldSkip(@Nullable AnnotatedTypeMetadata metadata, @Nullable ConfigurationPhase phase) {\n\tif (metadata == null || !metadata.isAnnotated(Conditional.class.getName())) {\n\t\treturn false;\n\t}\n\n\tif (phase == null) {\n\t\tif (metadata instanceof AnnotationMetadata &amp;&amp;\n\t\t\t\tConfigurationClassUtils.isConfigurationCandidate((AnnotationMetadata) metadata)) {\n\t\t\treturn shouldSkip(metadata, ConfigurationPhase.PARSE_CONFIGURATION);\n\t\t}\n\t\treturn shouldSkip(metadata, ConfigurationPhase.REGISTER_BEAN);\n\t}\n\n\tList&lt;Condition&gt; conditions = new ArrayList&lt;&gt;();\n\tfor (String[] conditionClasses : getConditionClasses(metadata)) {\n\t\tfor (String conditionClass : conditionClasses) {\n\t\t\tCondition condition = getCondition(conditionClass, this.context.getClassLoader());\n\t\t\tconditions.add(condition);\n\t\t}\n\t}\n\n\tAnnotationAwareOrderComparator.sort(conditions);\n\n\tfor (Condition condition : conditions) {\n\t\tConfigurationPhase requiredPhase = null;\n\t\tif (condition instanceof ConfigurationCondition) {\n\t\t\trequiredPhase = ((ConfigurationCondition) condition).getConfigurationPhase();\n\t\t}\n\t\tif ((requiredPhase == null || requiredPhase == phase) &amp;&amp; !condition.matches(this.context, metadata)) {\n\t\t\treturn true;\n\t\t}\n\t}\n\n\treturn false;\n}\n</code></pre>\n<p>}</p>\n<h1>7. AnnotationConfigUtils</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class AnnotationConfigUtils{\n\tpublic static void registerAnnotationConfigProcessors(BeanDefinitionRegistry registry) {\n\t\tregisterAnnotationConfigProcessors(registry, null);\n\t}\n\tpublic static Set&lt;BeanDefinitionHolder&gt; registerAnnotationConfigProcessors(BeanDefinitionRegistry registry, @Nullable Object source) {\n\t\t//å–å‡ºDefaultListableBeanFactory\n\t\tDefaultListableBeanFactory beanFactory = unwrapDefaultListableBeanFactory(registry);\n\t\t//è®¾ç½®ç±»çš„åŠ è½½é¡ºåºå’Œè‡ªåŠ¨åŠ è½½è§£å†³è€…\n\t\tif (beanFactory != null) {\n\t\t\tif (!(beanFactory.getDependencyComparator() instanceof AnnotationAwareOrderComparator)) {\n\t\t\t\tbeanFactory.setDependencyComparator(AnnotationAwareOrderComparator.INSTANCE);//ä¸ºnullè‡ªåŠ¨å†™å…¥\n\t\t\t}\n\t\t\tif (!(beanFactory.getAutowireCandidateResolver() instanceof ContextAnnotationAutowireCandidateResolver)) {\n\t\t\t\tbeanFactory.setAutowireCandidateResolver(new ContextAnnotationAutowireCandidateResolver());//\n\t\t\t}\n\t\t}\n\n\t\tSet&lt;BeanDefinitionHolder&gt; beanDefs = new LinkedHashSet&lt;&gt;(8);\n\t\t//æ·»åŠ ä¸€å †BeanPostProcessorsï¼ˆRootBeanDefinitionï¼‰\n\t\tif (!registry.containsBeanDefinition(CONFIGURATION_ANNOTATION_PROCESSOR_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition(ConfigurationClassPostProcessor.class);\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, CONFIGURATION_ANNOTATION_PROCESSOR_BEAN_NAME));\n\t\t}\n\n\t\tif (!registry.containsBeanDefinition(AUTOWIRED_ANNOTATION_PROCESSOR_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition(AutowiredAnnotationBeanPostProcessor.class);\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, AUTOWIRED_ANNOTATION_PROCESSOR_BEAN_NAME));\n\t\t}\n\n\t\tif (!registry.containsBeanDefinition(REQUIRED_ANNOTATION_PROCESSOR_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition(RequiredAnnotationBeanPostProcessor.class);\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, REQUIRED_ANNOTATION_PROCESSOR_BEAN_NAME));\n\t\t}\n\n\t\t// Check for JSR-250 support, and if present add the CommonAnnotationBeanPostProcessor.\n\t\tif (jsr250Present &amp;&amp; !registry.containsBeanDefinition(COMMON_ANNOTATION_PROCESSOR_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition(CommonAnnotationBeanPostProcessor.class);\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, COMMON_ANNOTATION_PROCESSOR_BEAN_NAME));\n\t\t}\n\n\t\t// Check for JPA support, and if present add the PersistenceAnnotationBeanPostProcessor.\n\t\tif (jpaPresent &amp;&amp; !registry.containsBeanDefinition(PERSISTENCE_ANNOTATION_PROCESSOR_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition();\n\t\t\ttry {\n\t\t\t\tdef.setBeanClass(ClassUtils.forName(PERSISTENCE_ANNOTATION_PROCESSOR_CLASS_NAME,\n\t\t\t\t\t\tAnnotationConfigUtils.class.getClassLoader()));\n\t\t\t}\n\t\t\tcatch (ClassNotFoundException ex) {\n\t\t\t\tthrow new IllegalStateException(\n\t\t\t\t\t\t\"Cannot load optional framework class: \" + PERSISTENCE_ANNOTATION_PROCESSOR_CLASS_NAME, ex);\n\t\t\t}\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, PERSISTENCE_ANNOTATION_PROCESSOR_BEAN_NAME));\n\t\t}\n\n\t\tif (!registry.containsBeanDefinition(EVENT_LISTENER_PROCESSOR_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition(EventListenerMethodProcessor.class);\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, EVENT_LISTENER_PROCESSOR_BEAN_NAME));\n\t\t}\n\n\t\tif (!registry.containsBeanDefinition(EVENT_LISTENER_FACTORY_BEAN_NAME)) {\n\t\t\tRootBeanDefinition def = new RootBeanDefinition(DefaultEventListenerFactory.class);\n\t\t\tdef.setSource(source);\n\t\t\tbeanDefs.add(registerPostProcessor(registry, def, EVENT_LISTENER_FACTORY_BEAN_NAME));\n\t\t}\n\n\t\treturn beanDefs;\n\t}\n\n\tprivate static DefaultListableBeanFactory unwrapDefaultListableBeanFactory(BeanDefinitionRegistry registry) {\n\t\tif (registry instanceof DefaultListableBeanFactory) {\n\t\t\treturn (DefaultListableBeanFactory) registry;\n\t\t}\n\t\telse if (registry instanceof GenericApplicationContext) {\n\t\t\treturn ((GenericApplicationContext) registry).getDefaultListableBeanFactory();//ç”±äºAnnotationConfigApplicationContextå®ç°äº†GenericApplicationContext\n\t\t}\n\t\telse {\n\t\t\treturn null;\n\t\t}\n\t}\n\n\t//æ³¨å†ŒåŸºç¡€çš„registryå¹¶è¿”å›BeanDefinitionHolder\n\tprivate static BeanDefinitionHolder registerPostProcessor(BeanDefinitionRegistry registry, RootBeanDefinition definition, String beanName) {\n\t\tdefinition.setRole(BeanDefinition.ROLE_INFRASTRUCTURE);\n\t\tregistry.registerBeanDefinition(beanName, definition);\n\t\treturn new BeanDefinitionHolder(definition, beanName);\n\t}\n\t\n\t//å°†æ³¨è§£é‡Œé¢çš„methodå°è£…ä¸ºAnnotationAttributeså¯¹è±¡ç„¶åkeyä¸ºmethodçš„Nameï¼ŒValueä¸ºValueHolder\n\tstatic AnnotationAttributes attributesFor(AnnotatedTypeMetadata metadata, Class&lt;?&gt; annotationClass) {\n\t\treturn attributesFor(metadata, annotationClass.getName());\n\t}\n\tstatic AnnotationAttributes attributesFor(AnnotatedTypeMetadata metadata, String annotationClassName) {\n\t\treturn AnnotationAttributes.fromMap(metadata.getAnnotationAttributes(annotationClassName, false));\n\t}\n\n\tpublic static void processCommonDefinitionAnnotations(AnnotatedBeanDefinition abd) {\n\t\tprocessCommonDefinitionAnnotations(abd, abd.getMetadata());\n\t}\n\n\tstatic void processCommonDefinitionAnnotations(AnnotatedBeanDefinition abd, AnnotatedTypeMetadata metadata) {\n\t\tAnnotationAttributes lazy = attributesFor(metadata, Lazy.class);\n\t\tif (lazy != null) {\n\t\t\tabd.setLazyInit(lazy.getBoolean(\"value\"));\n\t\t}\n\t\telse if (abd.getMetadata() != metadata) {\n\t\t\tlazy = attributesFor(abd.getMetadata(), Lazy.class);\n\t\t\tif (lazy != null) {\n\t\t\t\tabd.setLazyInit(lazy.getBoolean(\"value\"));\n\t\t\t}\n\t\t}\n\n\t\tif (metadata.isAnnotated(Primary.class.getName())) {\n\t\t\tabd.setPrimary(true);\n\t\t}\n\t\tAnnotationAttributes dependsOn = attributesFor(metadata, DependsOn.class);\n\t\tif (dependsOn != null) {\n\t\t\tabd.setDependsOn(dependsOn.getStringArray(\"value\"));\n\t\t}\n\n\t\tif (abd instanceof AbstractBeanDefinition) {\n\t\t\tAbstractBeanDefinition absBd = (AbstractBeanDefinition) abd;\n\t\t\tAnnotationAttributes role = attributesFor(metadata, Role.class);\n\t\t\tif (role != null) {\n\t\t\t\tabsBd.setRole(role.getNumber(\"value\").intValue());\n\t\t\t}\n\t\t\tAnnotationAttributes description = attributesFor(metadata, Description.class);\n\t\t\tif (description != null) {\n\t\t\t\tabsBd.setDescription(description.getString(\"value\"));\n\t\t\t}\n\t\t}\n\t}\n\n\tstatic BeanDefinitionHolder applyScopedProxyMode(ScopeMetadata metadata, BeanDefinitionHolder definition, BeanDefinitionRegistry registry) {\n\n\t\tScopedProxyMode scopedProxyMode = metadata.getScopedProxyMode();\n\t\tif (scopedProxyMode.equals(ScopedProxyMode.NO)) {\n\t\t\treturn definition;\n\t\t}\n\t\tboolean proxyTargetClass = scopedProxyMode.equals(ScopedProxyMode.TARGET_CLASS);\n\t\treturn ScopedProxyCreator.createScopedProxy(definition, registry, proxyTargetClass);\n\t}\n}\n</code></pre></div><h1>8. ScopedProxyCreator</h1>\n<p>class ScopedProxyCreator {</p>\n<pre><code>public static BeanDefinitionHolder createScopedProxy(\n\t\tBeanDefinitionHolder definitionHolder, BeanDefinitionRegistry registry, boolean proxyTargetClass) {\n\n\treturn ScopedProxyUtils.createScopedProxy(definitionHolder, registry, proxyTargetClass);\n}\n\npublic static String getTargetBeanName(String originalBeanName) {\n\treturn ScopedProxyUtils.getTargetBeanName(originalBeanName);\n}\n</code></pre>\n<p>}</p>\n<h1>9. ScopedProxyUtils</h1>\n<p>public abstract class ScopedProxyUtils {<br>\npublic static BeanDefinitionHolder createScopedProxy(BeanDefinitionHolder definition,<br>\nBeanDefinitionRegistry registry, boolean proxyTargetClass) {</p>\n<pre><code>\tString originalBeanName = definition.getBeanName();\n\tBeanDefinition targetDefinition = definition.getBeanDefinition();\n\tString targetBeanName = getTargetBeanName(originalBeanName);\n\n\t// Create a scoped proxy definition for the original bean name,\n\t// \"hiding\" the target bean in an internal target definition.\n\tRootBeanDefinition proxyDefinition = new RootBeanDefinition(ScopedProxyFactoryBean.class);\n\tproxyDefinition.setDecoratedDefinition(new BeanDefinitionHolder(targetDefinition, targetBeanName));\n\tproxyDefinition.setOriginatingBeanDefinition(targetDefinition);\n\tproxyDefinition.setSource(definition.getSource());\n\tproxyDefinition.setRole(targetDefinition.getRole());\n\n\tproxyDefinition.getPropertyValues().add(\"targetBeanName\", targetBeanName);\n\tif (proxyTargetClass) {\n\t\ttargetDefinition.setAttribute(AutoProxyUtils.PRESERVE_TARGET_CLASS_ATTRIBUTE, Boolean.TRUE);\n\t\t// ScopedProxyFactoryBean's \"proxyTargetClass\" default is TRUE, so we don't need to set it explicitly here.\n\t}\n\telse {\n\t\tproxyDefinition.getPropertyValues().add(\"proxyTargetClass\", Boolean.FALSE);\n\t}\n\n\t// Copy autowire settings from original bean definition.\n\tproxyDefinition.setAutowireCandidate(targetDefinition.isAutowireCandidate());\n\tproxyDefinition.setPrimary(targetDefinition.isPrimary());\n\tif (targetDefinition instanceof AbstractBeanDefinition) {\n\t\tproxyDefinition.copyQualifiersFrom((AbstractBeanDefinition) targetDefinition);\n\t}\n\n\t// The target bean should be ignored in favor of the scoped proxy.\n\ttargetDefinition.setAutowireCandidate(false);\n\ttargetDefinition.setPrimary(false);\n\n\t// Register the target bean as separate bean in the factory.\n\tregistry.registerBeanDefinition(targetBeanName, targetDefinition);\n\n\t// Return the scoped proxy definition as primary bean definition\n\t// (potentially an inner bean).\n\treturn new BeanDefinitionHolder(proxyDefinition, originalBeanName, definition.getAliases());\n}\n</code></pre>\n<p>}</p>\n<h1>10. ClassPathBeanDefinitionScanner extends ClassPathScanningCandidateComponentProvider implements EnvironmentCapable, ResourceLoaderAwareï¼ŒAware</h1>\n<p>public class ClassPathBeanDefinitionScanner extends ClassPathScanningCandidateComponentProvider{</p>\n<pre><code>private final BeanDefinitionRegistry registry;\nprivate final List&lt;TypeFilter&gt; includeFilters = new LinkedList&lt;&gt;();\n//åˆå§‹åŒ–å¯¹è±¡å½“å‰å±æ€§\n//1. useDefaultFilters = true åŒæ—¶æ³¨å†Œç»™å½“å‰includeFiltersæ³¨å†Œä¸¤ä¸ª javax.annotation.ManagedBean å’Œjavax.inject.Named ä¸¤ä¸ª AnnotationTypeFilter\n//2. environment = getOrCreateEnvironmentåˆ¤æ–­registryæ˜¯å¦å®ç°äº†ConfigurableEnvironmentæ¥å£ï¼Œæ²¡æœ‰å®ç°ç¯å¢ƒçš„æ¥å£çš„è¯è¿”å›é»˜è®¤å®ç°çš„ç¯å¢ƒStandardEnvironment\n//3. ResourceLoader =   registryæ˜¯å¦å®ç°ResourceLoaderï¼Œå¦åˆ™ä¸ºnull\n//4. registry = ä¼ è¿‡æ¥çš„registry\n//5.this.includeFilteræ³¨å†Œä¸¤ä¸ªfilter javax.annotation.ManagedBeanå’Œjavax.inject.Named\npublic ClassPathBeanDefinitionScanner(BeanDefinitionRegistry registry) {\n\tthis(registry, true);\n}\npublic ClassPathBeanDefinitionScanner(BeanDefinitionRegistry registry, boolean useDefaultFilters) {\n\tthis(registry, useDefaultFilters, getOrCreateEnvironment(registry));\n}\npublic ClassPathBeanDefinitionScanner(BeanDefinitionRegistry registry, boolean useDefaultFilters,Environment environment) {\n\tthis(registry, useDefaultFilters, environment,(registry instanceof ResourceLoader ? (ResourceLoader) registry : null));\n}\npublic ClassPathBeanDefinitionScanner(BeanDefinitionRegistry registry, boolean useDefaultFilters,Environment environment, @Nullable ResourceLoader resourceLoader) {\n\tthis.registry = registry;\n\tif (useDefaultFilters) {\n\t\tregisterDefaultFilters();\n\t}\n\tsetEnvironment(environment);\n\tsetResourceLoader(resourceLoader);\n}\nprotected void registerDefaultFilters() {\n\tthis.includeFilters.add(new AnnotationTypeFilter(Component.class));\n\tClassLoader cl = ClassPathScanningCandidateComponentProvider.class.getClassLoader();\n\ttry {\n\t\tthis.includeFilters.add(new AnnotationTypeFilter(((Class&lt;? extends Annotation&gt;) ClassUtils.forName(\"javax.annotation.ManagedBean\", cl)), false));\n\t}\n\tcatch (ClassNotFoundException ex) {}\n\ttry {\n\t\tthis.includeFilters.add(new AnnotationTypeFilter(((Class&lt;? extends Annotation&gt;) ClassUtils.forName(\"javax.inject.Named\", cl)), false));\n\t}\n\tcatch (ClassNotFoundException ex) {}\n}\nprivate static Environment getOrCreateEnvironment(BeanDefinitionRegistry registry) {\n\tAssert.notNull(registry, \"BeanDefinitionRegistry must not be null\");\n\tif (registry instanceof EnvironmentCapable) {\n\t\treturn ((EnvironmentCapable) registry).getEnvironment();\n\t}\n\treturn new StandardEnvironment();\n}\n</code></pre>\n<p>}</p>\n<h1>11. AnnotatedGenericBeanDefinition extends GenericBeanDefinition,AbstractBeanDefinition,BeanMetadataAttributeAccessor,AttributeAccessorSupport implements AnnotatedBeanDefinition ,BeanMetadataElement,BeanDefinition, Cloneable,AttributeAccessor, BeanMetadataElement,Serializable</h1>\n<p>public class AnnotatedGenericBeanDefinition extends GenericBeanDefinition implements AnnotatedBeanDefinition {<br>\n@Nullable<br>\nprivate volatile Object beanClass;<br>\npublic AnnotatedGenericBeanDefinition(Class&lt;?&gt; beanClass) {<br>\nsetBeanClass(beanClass);<br>\nthis.metadata = new StandardAnnotationMetadata(beanClass, true);<br>\n}<br>\n}</p>\n<h1>12. StandardAnnotationMetadata extends StandardClassMetadata implements AnnotationMetadata,ClassMetadata,AnnotatedTypeMetadata</h1>\n<p>public class StandardAnnotationMetadata extends StandardClassMetadata implements AnnotationMetadata{<br>\nprivate final Annotation[] annotations;</p>\n<pre><code>private final boolean nestedAnnotationsAsMap;\npublic StandardAnnotationMetadata(Class&lt;?&gt; introspectedClass, boolean nestedAnnotationsAsMap) {\n\n\tsuper(introspectedClass);\n\tthis.annotations = introspectedClass.getAnnotations();\n\tthis.nestedAnnotationsAsMap = nestedAnnotationsAsMap;\n}\npublic boolean isAnnotated(String annotationName) {\n\treturn (this.annotations.length &gt; 0 &amp;&amp;\n\t\t\tAnnotatedElementUtils.isAnnotated(getIntrospectedClass(), annotationName));\n}\n//çˆ¶ç±»\nprivate final Class&lt;?&gt; introspectedClass;\npublic StandardClassMetadata(Class&lt;?&gt; introspectedClass) {\n\tAssert.notNull(introspectedClass, \"Class must not be null\");\n\tthis.introspectedClass = introspectedClass;\n}\n\npublic Map&lt;String, Object&gt; getAnnotationAttributes(String annotationName, boolean classValuesAsString) {\n\treturn (this.annotations.length &gt; 0 ? AnnotatedElementUtils.getMergedAnnotationAttributes(\n\t\t\tgetIntrospectedClass(), annotationName, classValuesAsString, this.nestedAnnotationsAsMap) : null);\n}\n</code></pre>\n<p>}</p>\n<h1>13. AnnotatedElementUtils</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class AnnotatedElementUtils {\n\tpublic static boolean isAnnotated(AnnotatedElement element, String annotationName) {\n\t\treturn Boolean.TRUE.equals(searchWithGetSemantics(element, null, annotationName, alwaysTrueAnnotationProcessor));\n\t}\n\tprivate interface Processor&lt;T&gt; {\n\n\t\t/**\n\t\t * Process the supplied annotation.\n\t\t * &lt;p&gt;The supplied annotation will be an actual target annotation\n\t\t * that has been found by the search algorithm, unless this processor\n\t\t * is configured to {@linkplain #alwaysProcesses always process}\n\t\t * annotations in which case it may be some other annotation within an\n\t\t * annotation hierarchy. In the latter case, the {@code metaDepth}\n\t\t * will have a value greater than {@code 0}. In any case, it is\n\t\t * up to concrete implementations of this method to decide what to\n\t\t * do with the supplied annotation.\n\t\t * &lt;p&gt;The {@code metaDepth} parameter represents the depth of the\n\t\t * annotation relative to the first annotated element in the\n\t\t * annotation hierarchy. For example, an annotation that is\n\t\t * &lt;em&gt;present&lt;/em&gt; on a non-annotation element will have a depth\n\t\t * of 0; a meta-annotation will have a depth of 1; and a\n\t\t * meta-meta-annotation will have a depth of 2; etc.\n\t\t * @param annotatedElement the element that is annotated with the\n\t\t * supplied annotation, used for contextual logging; may be\n\t\t * {@code null} if unknown\n\t\t * @param annotation the annotation to process\n\t\t * @param metaDepth the meta-depth of the annotation\n\t\t * @return the result of the processing, or {@code null} to continue\n\t\t * searching for additional annotations\n\t\t */\n\t\t@Nullable\n\t\tT process(@Nullable AnnotatedElement annotatedElement, Annotation annotation, int metaDepth);\n\n\t\t/**\n\t\t * Post-process the result returned by the {@link #process} method.\n\t\t * &lt;p&gt;The {@code annotation} supplied to this method is an annotation\n\t\t * that is present in the annotation hierarchy, between the initial\n\t\t * {@link AnnotatedElement} and an invocation of {@link #process}\n\t\t * that returned a non-null value.\n\t\t * @param annotatedElement the element that is annotated with the\n\t\t * supplied annotation, used for contextual logging; may be\n\t\t * {@code null} if unknown\n\t\t * @param annotation the annotation to post-process\n\t\t * @param result the result to post-process\n\t\t */\n\t\tvoid postProcess(@Nullable AnnotatedElement annotatedElement, Annotation annotation, T result);\n\n\t\t/**\n\t\t * Determine if this processor always processes annotations regardless of\n\t\t * whether or not the target annotation has been found.\n\t\t * @return {@code true} if this processor always processes annotations\n\t\t * @since 4.3\n\t\t */\n\t\tboolean alwaysProcesses();\n\n\t\t/**\n\t\t * Determine if this processor aggregates the results returned by {@link #process}.\n\t\t * &lt;p&gt;If this method returns {@code true}, then {@link #getAggregatedResults()}\n\t\t * must return a non-null value.\n\t\t * @return {@code true} if this processor supports aggregated results\n\t\t * @since 4.3\n\t\t * @see #getAggregatedResults\n\t\t */\n\t\tboolean aggregates();\n\n\t\t/**\n\t\t * Get the list of results aggregated by this processor.\n\t\t * &lt;p&gt;NOTE: the processor does &lt;strong&gt;not&lt;/strong&gt; aggregate the results\n\t\t * itself. Rather, the search algorithm that uses this processor is\n\t\t * responsible for asking this processor if it {@link #aggregates} results\n\t\t * and then adding the post-processed results to the list returned by this\n\t\t * method.\n\t\t * @return the list of results aggregated by this processor (never {@code null})\n\t\t * @since 4.3\n\t\t * @see #aggregates\n\t\t */\n\t\tList&lt;T&gt; getAggregatedResults();\n\t}\n\tstatic class AlwaysTrueBooleanAnnotationProcessor extends SimpleAnnotationProcessor&lt;Boolean&gt; {\n\n\t\t@Override\n\t\tpublic final Boolean process(@Nullable AnnotatedElement annotatedElement, Annotation annotation, int metaDepth) {\n\t\t\treturn Boolean.TRUE;\n\t\t}\n\t}\n\n\tprivate static class MergedAnnotationAttributesProcessor implements Processor&lt;AnnotationAttributes&gt; {\n\n\t\tprivate final boolean classValuesAsString;\n\n\t\tprivate final boolean nestedAnnotationsAsMap;\n\n\t\tprivate final boolean aggregates;\n\n\t\tprivate final List&lt;AnnotationAttributes&gt; aggregatedResults;\n\n\t\tMergedAnnotationAttributesProcessor() {\n\t\t\tthis(false, false, false);\n\t\t}\n\n\t\tMergedAnnotationAttributesProcessor(boolean classValuesAsString, boolean nestedAnnotationsAsMap) {\n\t\t\tthis(classValuesAsString, nestedAnnotationsAsMap, false);\n\t\t}\n\n\t\tMergedAnnotationAttributesProcessor(boolean classValuesAsString, boolean nestedAnnotationsAsMap,\n\t\t\t\tboolean aggregates) {\n\n\t\t\tthis.classValuesAsString = classValuesAsString;\n\t\t\tthis.nestedAnnotationsAsMap = nestedAnnotationsAsMap;\n\t\t\tthis.aggregates = aggregates;\n\t\t\tthis.aggregatedResults = (aggregates ? new ArrayList&lt;&gt;() : Collections.emptyList());\n\t\t}\n\n\t\t@Override\n\t\tpublic boolean alwaysProcesses() {\n\t\t\treturn false;\n\t\t}\n\n\t\t@Override\n\t\tpublic boolean aggregates() {\n\t\t\treturn this.aggregates;\n\t\t}\n\n\t\t@Override\n\t\tpublic List&lt;AnnotationAttributes&gt; getAggregatedResults() {\n\t\t\treturn this.aggregatedResults;\n\t\t}\n\n\t\t@Override\n\t\t@Nullable\n\t\tpublic AnnotationAttributes process(@Nullable AnnotatedElement annotatedElement, Annotation annotation, int metaDepth) {\n\t\t\treturn AnnotationUtils.retrieveAnnotationAttributes(annotatedElement, annotation,\n\t\t\t\t\tthis.classValuesAsString, this.nestedAnnotationsAsMap);\n\t\t}\n\n\t\t@Override\n\t\tpublic void postProcess(@Nullable AnnotatedElement element, Annotation annotation, AnnotationAttributes attributes) {\n\t\t\tannotation = AnnotationUtils.synthesizeAnnotation(annotation, element);\n\t\t\tClass&lt;? extends Annotation&gt; targetAnnotationType = attributes.annotationType();\n\n\t\t\t// Track which attribute values have already been replaced so that we can short\n\t\t\t// circuit the search algorithms.\n\t\t\tSet&lt;String&gt; valuesAlreadyReplaced = new HashSet&lt;&gt;();\n\n\t\t\tfor (Method attributeMethod : AnnotationUtils.getAttributeMethods(annotation.annotationType())) {\n\t\t\t\tString attributeName = attributeMethod.getName();\n\t\t\t\tString attributeOverrideName = AnnotationUtils.getAttributeOverrideName(attributeMethod, targetAnnotationType);\n\n\t\t\t\t// Explicit annotation attribute override declared via @AliasFor\n\t\t\t\tif (attributeOverrideName != null) {\n\t\t\t\t\tif (valuesAlreadyReplaced.contains(attributeOverrideName)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tList&lt;String&gt; targetAttributeNames = new ArrayList&lt;&gt;();\n\t\t\t\t\ttargetAttributeNames.add(attributeOverrideName);\n\t\t\t\t\tvaluesAlreadyReplaced.add(attributeOverrideName);\n\n\t\t\t\t\t// Ensure all aliased attributes in the target annotation are overridden. (SPR-14069)\n\t\t\t\t\tList&lt;String&gt; aliases = AnnotationUtils.getAttributeAliasMap(targetAnnotationType).get(attributeOverrideName);\n\t\t\t\t\tif (aliases != null) {\n\t\t\t\t\t\tfor (String alias : aliases) {\n\t\t\t\t\t\t\tif (!valuesAlreadyReplaced.contains(alias)) {\n\t\t\t\t\t\t\t\ttargetAttributeNames.add(alias);\n\t\t\t\t\t\t\t\tvaluesAlreadyReplaced.add(alias);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\toverrideAttributes(element, annotation, attributes, attributeName, targetAttributeNames);\n\t\t\t\t}\n\t\t\t\t// Implicit annotation attribute override based on convention\n\t\t\t\telse if (!AnnotationUtils.VALUE.equals(attributeName) &amp;&amp; attributes.containsKey(attributeName)) {\n\t\t\t\t\toverrideAttribute(element, annotation, attributes, attributeName, attributeName);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\tprivate void overrideAttributes(@Nullable AnnotatedElement element, Annotation annotation,\n\t\t\t\tAnnotationAttributes attributes, String sourceAttributeName, List&lt;String&gt; targetAttributeNames) {\n\n\t\t\tObject adaptedValue = getAdaptedValue(element, annotation, sourceAttributeName);\n\n\t\t\tfor (String targetAttributeName : targetAttributeNames) {\n\t\t\t\tattributes.put(targetAttributeName, adaptedValue);\n\t\t\t}\n\t\t}\n\n\t\tprivate void overrideAttribute(@Nullable AnnotatedElement element, Annotation annotation,\n\t\t\t\tAnnotationAttributes attributes, String sourceAttributeName, String targetAttributeName) {\n\n\t\t\tattributes.put(targetAttributeName, getAdaptedValue(element, annotation, sourceAttributeName));\n\t\t}\n\n\t\t@Nullable\n\t\tprivate Object getAdaptedValue(\n\t\t\t\t@Nullable AnnotatedElement element, Annotation annotation, String sourceAttributeName) {\n\n\t\t\tObject value = AnnotationUtils.getValue(annotation, sourceAttributeName);\n\t\t\treturn AnnotationUtils.adaptValue(element, value, this.classValuesAsString, this.nestedAnnotationsAsMap);\n\t\t}\n\t}\n\n\tprivate static &lt;T&gt; T searchWithGetSemantics(AnnotatedElement element,\n\t\t\t@Nullable Class&lt;? extends Annotation&gt; annotationType,\n\t\t\t@Nullable String annotationName, Processor&lt;T&gt; processor) {\n\n\t\treturn searchWithGetSemantics(element, annotationType, annotationName, null, processor);\n\t}\n\tprivate static &lt;T&gt; T searchWithGetSemantics(AnnotatedElement element,\n\t\t\t@Nullable Class&lt;? extends Annotation&gt; annotationType, @Nullable String annotationName,\n\t\t\t@Nullable Class&lt;? extends Annotation&gt; containerType, Processor&lt;T&gt; processor) {\n\n\t\ttry {\n\t\t\treturn searchWithGetSemantics(element, annotationType, annotationName, containerType, processor,\n\t\t\t\t\tnew HashSet&lt;&gt;(), 0);\n\t\t}\n\t\tcatch (Throwable ex) {\n\t\t\tAnnotationUtils.rethrowAnnotationConfigurationException(ex);\n\t\t\tthrow new IllegalStateException(\"Failed to introspect annotations on \" + element, ex);\n\t\t}\n\t}\n\t// åœ¨æä¾›çš„æ³¨é‡Šåˆ—è¡¨ä¸­è¿›è¡Œå®é™…æœç´¢ã€‚åº”è¯¥å…ˆç”¨æœ¬åœ°å£°æ˜çš„æ³¨é‡Šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œç„¶åå†ç”¨ç»§æ‰¿çš„æ³¨é‡Šè°ƒç”¨ï¼Œä»è€Œå…è®¸æœ¬åœ°æ³¨é‡Šä¼˜å…ˆäºç»§æ‰¿çš„æ³¨é‡Šã€‚\n\t// â‘ è®°å½•å·²ç»è®¿é—®çš„æ³¨è§£ï¼ˆç”¨seté˜²æ­¢é‡å¤ï¼‰é‡å¤åˆ™ä¸æ‰§è¡Œ\n\t// â‘¡è°ƒç”¨searchWithGetSemanticsInAnnotationsè¿”å›ç»“æœ\n\t// â‘¢æ²¡æœ‰ç»“æœå°±æ‰¾å½“å‰ç±»çš„çˆ¶ç±»çš„æ‰€æœ‰æ³¨è§£ï¼Œè°ƒç”¨searchWithGetSemanticsInAnnotationsè¿”å›ç»“æœï¼Œå†æ²¡æœ‰ç»“æœå°±è¿”å›null\n\t//æ€»ç»“ï¼šè°ƒç”¨searchWithGetSemanticsInAnnotationsè§£æå½“å‰æ³¨è§£è¿”å›ç»“æœï¼ˆtrueæˆ–è€…æ˜¯AnnotationAttributesæš‚æ—¶å‘ç°ï¼‰ï¼Œç»“æœä¸ºnullï¼Œåˆ™ç»§ç»­æ‰¾çˆ¶æ³¨è§£ï¼Œç›´åˆ°æ— ç»“æœè¿”å›\n\tprivate static &lt;T&gt; T searchWithGetSemantics(AnnotatedElement element,\n\t\t\t@Nullable Class&lt;? extends Annotation&gt; annotationType, @Nullable String annotationName,\n\t\t\t@Nullable Class&lt;? extends Annotation&gt; containerType, Processor&lt;T&gt; processor,\n\t\t\tSet&lt;AnnotatedElement&gt; visited, int metaDepth) {\n\n\t\tif (visited.add(element)) {\n\t\t\ttry {\n\t\t\t\t// Start searching within locally declared annotations\n\t\t\t\tList&lt;Annotation&gt; declaredAnnotations = Arrays.asList(element.getDeclaredAnnotations());\n\t\t\t\tT result = searchWithGetSemanticsInAnnotations(element, declaredAnnotations,\n\t\t\t\t\t\tannotationType, annotationName, containerType, processor, visited, metaDepth);\n\t\t\t\tif (result != null) {\n\t\t\t\t\treturn result;\n\t\t\t\t}\n\n\t\t\t\tif (element instanceof Class) {  // otherwise getAnnotations doesn't return anything new\n\t\t\t\t\tClass&lt;?&gt; superclass = ((Class) element).getSuperclass();\n\t\t\t\t\tif (superclass != null &amp;&amp; superclass != Object.class) {\n\t\t\t\t\t\tList&lt;Annotation&gt; inheritedAnnotations = new LinkedList&lt;&gt;();\n\t\t\t\t\t\tfor (Annotation annotation : element.getAnnotations()) {\n\t\t\t\t\t\t\tif (!declaredAnnotations.contains(annotation)) {\n\t\t\t\t\t\t\t\tinheritedAnnotations.add(annotation);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Continue searching within inherited annotations\n\t\t\t\t\t\tresult = searchWithGetSemanticsInAnnotations(element, inheritedAnnotations,\n\t\t\t\t\t\t\t\tannotationType, annotationName, containerType, processor, visited, metaDepth);\n\t\t\t\t\t\tif (result != null) {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tcatch (Throwable ex) {\n\t\t\t\tAnnotationUtils.handleIntrospectionFailure(element, ex);\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\t@Nullable\n\t// åœ¨æä¾›çš„æ³¨é‡Šåˆ—è¡¨ä¸­è¿›è¡Œå®é™…æœç´¢ã€‚åº”è¯¥å…ˆç”¨æœ¬åœ°å£°æ˜çš„æ³¨é‡Šè°ƒç”¨è¯¥æ–¹æ³•ï¼Œç„¶åå†ç”¨ç»§æ‰¿çš„æ³¨é‡Šè°ƒç”¨ï¼Œä»è€Œå…è®¸æœ¬åœ°æ³¨é‡Šä¼˜å…ˆäºç»§æ‰¿çš„æ³¨é‡Šã€‚\n\t// â‘ éå†æä¾›çš„æ³¨è§£ï¼Œå¦‚æœæ˜¯springçš„æ³¨è§£å°±è°ƒç”¨processoræ¥å£çš„å®ç°è¿”å›ç»“æœå¹¶è®°å½•æ€»ç»“æœ\n\t// â‘¡å†æ¬¡éå†æä¾›çš„æ³¨è§£ï¼Œå¦‚æœæ˜¯springçš„æ³¨è§£ï¼Œé‚£ä¹ˆè°ƒç”¨searchWithGetSemanticsè§£æç»“æœå¹¶è®°å½•æ€»ç»“æœ\n\t\t//searchWithGetSemanticså®ç°\n\t\t// â‘ è®°å½•å·²ç»è®¿é—®çš„æ³¨è§£ï¼ˆç”¨seté˜²æ­¢é‡å¤ï¼‰é‡å¤åˆ™ä¸æ‰§è¡Œ\n\t\t// â‘¡è°ƒç”¨searchWithGetSemanticsInAnnotationsè¿”å›ç»“æœ\n\t\t// â‘¢æ²¡æœ‰ç»“æœå°±æ‰¾å½“å‰ç±»çš„çˆ¶ç±»çš„æ‰€æœ‰æ³¨è§£ï¼Œè°ƒç”¨searchWithGetSemanticsInAnnotationsè¿”å›ç»“æœï¼Œå†æ²¡æœ‰ç»“æœå°±è¿”å›null\n\t\t//æ€»ç»“ï¼šè°ƒç”¨searchWithGetSemanticsInAnnotationsè§£æå½“å‰æ³¨è§£è¿”å›ç»“æœï¼Œç»“æœä¸ºnullï¼Œåˆ™ç»§ç»­æ‰¾çˆ¶æ³¨è§£ï¼Œç›´åˆ°æ— ç»“æœè¿”å›\n\tprivate static &lt;T&gt; T searchWithGetSemanticsInAnnotations(@Nullable AnnotatedElement element,\n\t\t\tList&lt;Annotation&gt; annotations, @Nullable Class&lt;? extends Annotation&gt; annotationType,\n\t\t\t@Nullable String annotationName, @Nullable Class&lt;? extends Annotation&gt; containerType,\n\t\t\tProcessor&lt;T&gt; processor, Set&lt;AnnotatedElement&gt; visited, int metaDepth) {\n\n\t\t// Search in annotations\n\t\tfor (Annotation annotation : annotations) {\n\t\t\tClass&lt;? extends Annotation&gt; currentAnnotationType = annotation.annotationType();\n\t\t\tif (!AnnotationUtils.isInJavaLangAnnotationPackage(currentAnnotationType)) {//åˆ¤æ–­æ˜¯å¦æ˜¯jdkæœ¬èº«çš„æ³¨è§£\n\t\t\t\tif (currentAnnotationType == annotationType ||\n\t\t\t\t\t\tcurrentAnnotationType.getName().equals(annotationName) ||\n\t\t\t\t\t\tprocessor.alwaysProcesses()) {\n\t\t\t\t\tT result = processor.process(element, annotation, metaDepth);\n\t\t\t\t\tif (result != null) {\n\t\t\t\t\t\tif (processor.aggregates() &amp;&amp; metaDepth == 0) {\n\t\t\t\t\t\t\tprocessor.getAggregatedResults().add(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Repeatable annotations in container?\n\t\t\t\telse if (currentAnnotationType == containerType) {\n\t\t\t\t\tfor (Annotation contained : getRawAnnotationsFromContainer(element, annotation)) {\n\t\t\t\t\t\tT result = processor.process(element, contained, metaDepth);\n\t\t\t\t\t\tif (result != null) {\n\t\t\t\t\t\t\t// No need to post-process since repeatable annotations within a\n\t\t\t\t\t\t\t// container cannot be composed annotations.\n\t\t\t\t\t\t\t//ä¸éœ€è¦è¿›è¡Œåå¤„ç†ï¼Œå› ä¸ºå®¹å™¨å†…çš„å¯é‡å¤æ³¨é‡Šä¸èƒ½ç»„æˆæ³¨é‡Š\n\t\t\t\t\t\t\tprocessor.getAggregatedResults().add(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t// Recursively search in meta-annotations\n\t\t//é€’å½’æœç´¢å…ƒæ³¨è§£\n\t\tfor (Annotation annotation : annotations) {\n\t\t\tClass&lt;? extends Annotation&gt; currentAnnotationType = annotation.annotationType();\n\t\t\tif (hasSearchableMetaAnnotations(currentAnnotationType, annotationType, annotationName)) {//æ ¹æ®ä¼ å…¥çš„ä¸‰ä¸ªç±»å‹åˆ¤æ–­æ˜¯ä¸æ˜¯Springæœ¬èº«çš„æ³¨è§£\n\t\t\t\tT result = searchWithGetSemantics(currentAnnotationType, annotationType,\n\t\t\t\t\t\tannotationName, containerType, processor, visited, metaDepth + 1);\n\t\t\t\tif (result != null) {\n\t\t\t\t\tprocessor.postProcess(element, annotation, result);\n\t\t\t\t\tif (processor.aggregates() &amp;&amp; metaDepth == 0) {\n\t\t\t\t\t\tprocessor.getAggregatedResults().add(result);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n\t\t@Nullable\n\t//è·å¾—åˆå¹¶çš„æ³¨è§£\n\t// MergedAnnotationAttributesProcessor\n\t//å°†æ³¨è§£é‡Œé¢æ‰€æœ‰çš„æ–¹æ³•åˆå¹¶ æˆkeyä¸ºMethodName,valueä¸ºholdleræˆ–è€…Stringæœ€å//å¤„ç†åˆ«å\n\tpublic static AnnotationAttributes getMergedAnnotationAttributes(AnnotatedElement element,\n\t\t\tString annotationName, boolean classValuesAsString, boolean nestedAnnotationsAsMap) {\n\n\t\tAnnotationAttributes attributes = searchWithGetSemantics(element, null, annotationName,\n\t\t\t\tnew MergedAnnotationAttributesProcessor(classValuesAsString, nestedAnnotationsAsMap));\n\t\tAnnotationUtils.postProcessAnnotationAttributes(element, attributes, classValuesAsString, nestedAnnotationsAsMap);\n\t\treturn attributes;\n\t}\n}\n</code></pre></div><h1>14. AnnotationScopeMetadataResolver implements ScopeMetadataResolver</h1>\n<p>public class AnnotationScopeMetadataResolver implements ScopeMetadataResolver {<br>\nprivate final ScopedProxyMode defaultProxyMode;</p>\n<pre><code>public AnnotationScopeMetadataResolver() {\n\tthis.defaultProxyMode = ScopedProxyMode.NO;\n}\n//è§£æScopeçš„æ³¨è§£\npublic ScopeMetadata resolveScopeMetadata(BeanDefinition definition) {\n\tScopeMetadata metadata = new ScopeMetadata();\n\tif (definition instanceof AnnotatedBeanDefinition) {\n\t\tAnnotatedBeanDefinition annDef = (AnnotatedBeanDefinition) definition;\n\t\tAnnotationAttributes attributes = AnnotationConfigUtils.attributesFor(\n\t\t\t\tannDef.getMetadata(), this.scopeAnnotationType);//è·å¾—Scopeæ‰€æœ‰çš„æ–¹æ³•åŠå±æ€§å€¼\n\t\tif (attributes != null) {\n\t\t\tmetadata.setScopeName(attributes.getString(\"value\"));\n\t\t\tScopedProxyMode proxyMode = attributes.getEnum(\"proxyMode\");\n\t\t\tif (proxyMode == ScopedProxyMode.DEFAULT) {\n\t\t\t\tproxyMode = this.defaultProxyMode;\n\t\t\t}\n\t\t\tmetadata.setScopedProxyMode(proxyMode);\n\t\t}\n\t}\n\treturn metadata;\n}\n</code></pre>\n<p>}</p>\n<h1>15. AnnotationBeanNameGenerator</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class AnnotationBeanNameGenerator implements BeanNameGenerator {\n\t\t@Override\n\tpublic String generateBeanName(BeanDefinition definition, BeanDefinitionRegistry registry) {\n\t\tif (definition instanceof AnnotatedBeanDefinition) {\n\t\t\tString beanName = determineBeanNameFromAnnotation((AnnotatedBeanDefinition) definition);\n\t\t\tif (StringUtils.hasText(beanName)) {\n\t\t\t\t// Explicit bean name found.\n\t\t\t\treturn beanName;\n\t\t\t}\n\t\t}\n\t\t// Fallback: generate a unique default bean name.\n\t\treturn buildDefaultBeanName(definition, registry);\n\t}\n\t@Nullable\n\t//ä»æ³¨è§£ä¸Šå†³å®šBeanåå­—ï¼Œä»æ‰€æœ‰çš„å±æ€§é‡Œé¢è¯»å‡ºvalueï¼Œå¦‚æœæ²¡æœ‰åˆ™è¿”å›null\n\tprotected String determineBeanNameFromAnnotation(AnnotatedBeanDefinition annotatedDef) {\n\t\tAnnotationMetadata amd = annotatedDef.getMetadata();\n\t\tSet&lt;String&gt; types = amd.getAnnotationTypes();\n\t\tString beanName = null;\n\t\tfor (String type : types) {\n\t\t\tAnnotationAttributes attributes = AnnotationConfigUtils.attributesFor(amd, type);\n\t\t\tif (attributes != null &amp;&amp; isStereotypeWithNameValue(type, amd.getMetaAnnotationTypes(type), attributes)) {\n\t\t\t\tObject value = attributes.get(\"value\");\n\t\t\t\tif (value instanceof String) {\n\t\t\t\t\tString strVal = (String) value;\n\t\t\t\t\tif (StringUtils.hasLength(strVal)) {\n\t\t\t\t\t\tif (beanName != null &amp;&amp; !strVal.equals(beanName)) {\n\t\t\t\t\t\t\tthrow new IllegalStateException(\"Stereotype annotations suggest inconsistent \" +\n\t\t\t\t\t\t\t\t\t\"component names: '\" + beanName + \"' versus '\" + strVal + \"'\");\n\t\t\t\t\t\t}\n\t\t\t\t\t\tbeanName = strVal;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn beanName;\n\t}\n\n\tprotected String buildDefaultBeanName(BeanDefinition definition, BeanDefinitionRegistry registry) {\n\t\treturn buildDefaultBeanName(definition);\n\t}\n\n\t/**\n\t * Derive a default bean name from the given bean definition.\n\t * &lt;p&gt;The default implementation simply builds a decapitalized version\n\t * of the short class name: e.g. \"mypackage.MyJdbcDao\" -&gt; \"myJdbcDao\".\n\t * &lt;p&gt;Note that inner classes will thus have names of the form\n\t * \"outerClassName.InnerClassName\", which because of the period in the\n\t * name may be an issue if you are autowiring by name.\n\t * @param definition the bean definition to build a bean name for\n\t * @return the default bean name (never {@code null})\n\t */\n\tprotected String buildDefaultBeanName(BeanDefinition definition) {\n\t\tString beanClassName = definition.getBeanClassName();\n\t\tAssert.state(beanClassName != null, \"No bean class name set\");\n\t\tString shortClassName = ClassUtils.getShortName(beanClassName);\n\t\treturn Introspector.decapitalize(shortClassName);\n\t}\n}\n</code></pre></div><h1>16. BeanDefinitionHolder implements BeanMetadataElement</h1>\n<p>public class BeanDefinitionHolder implements BeanMetadataElement {<br>\npublic BeanDefinitionHolder(BeanDefinition beanDefinition, String beanName) {<br>\nthis(beanDefinition, beanName, null);<br>\n}<br>\npublic BeanDefinitionHolder(BeanDefinition beanDefinition, String beanName, @Nullable String[] aliases) {<br>\nAssert.notNull(beanDefinition, \"BeanDefinition must not be null\");<br>\nAssert.notNull(beanName, \"Bean name must not be null\");<br>\nthis.beanDefinition = beanDefinition;<br>\nthis.beanName = beanName;<br>\nthis.aliases = aliases;<br>\n}<br>\n}</p>\n<h1>17. ClassUtils</h1>\n<p>public abstract class ClassUtils {<br>\nprivate static final char PACKAGE_SEPARATOR = '.';<br>\nprivate static final char INNER_CLASS_SEPARATOR = '$\";</p>\n<pre><code>public static String getShortName(String className) {\n\tAssert.hasLength(className, \"Class name must not be empty\");\n\tint lastDotIndex = className.lastIndexOf(PACKAGE_SEPARATOR);\n\tint nameEndIndex = className.indexOf(CGLIB_CLASS_SEPARATOR);\n\tif (nameEndIndex == -1) {\n\t\tnameEndIndex = className.length();\n\t}\n\tString shortName = className.substring(lastDotIndex + 1, nameEndIndex);\n\tshortName = shortName.replace(INNER_CLASS_SEPARATOR, PACKAGE_SEPARATOR);\n\treturn shortName;\n}\n\npublic static String getShortName(String className) {\n\tAssert.hasLength(className, \"Class name must not be empty\");\n\tint lastDotIndex = className.lastIndexOf(PACKAGE_SEPARATOR);\n\tint nameEndIndex = className.indexOf(CGLIB_CLASS_SEPARATOR);\n\tif (nameEndIndex == -1) {\n\t\tnameEndIndex = className.length();\n\t}\n\tString shortName = className.substring(lastDotIndex + 1, nameEndIndex);\n\tshortName = shortName.replace(INNER_CLASS_SEPARATOR, PACKAGE_SEPARATOR);\n\treturn shortName;\n}\n</code></pre>\n<p>}</p>\n<h1>18. Introspector</h1>\n<p>public class Introspector {<br>\npublic static String decapitalize(String name) {<br>\nif (name == null || name.length() == 0) {<br>\nreturn name;<br>\n}<br>\nif (name.length() &gt; 1 &amp;&amp; Character.isUpperCase(name.charAt(1)) &amp;&amp;<br>\nCharacter.isUpperCase(name.charAt(0))){<br>\nreturn name;<br>\n}<br>\nchar chars[] = name.toCharArray();<br>\nchars[0] = Character.toLowerCase(chars[0]);<br>\nreturn new String(chars);<br>\n}<br>\n}</p>\n<h1>19. AnnotationConfigApplicationContextåˆ›å»ºæµç¨‹</h1>\n<ul>\n<li>\n<p>åˆ›å»ºAnnotationConfigApplicationContext</p>\n<ul>\n<li>å±æ€§ResourcePatternResolver resourcePatternResolverï¼šnew PathMatchingResourcePatternResolver(this);ï¼ˆAbstractApplicationContextæ„é€ ï¼‰\n<ul>\n<li>å±æ€§ResourceLoader resourceLoaderï¼šAnnotationConfigApplicationContext:DefaultResourceLoader</li>\n</ul>\n</li>\n<li>å±æ€§ClassLoader classLoaderï¼šAppClassLoader();ï¼ˆDefaultResourceLoaderæ„é€ ï¼‰</li>\n<li>å±æ€§DefaultListableBeanFactory beanFactoryï¼šnew DefaultListableBeanFactory();ï¼ˆGenericApplicationContextæ„é€ ï¼‰\n<ul>\n<li>å±æ€§<code>Comparator&lt;Object&gt;</code> dependencyComparator: new AnnotationAwareOrderComparator();//æ’åºBeanPostprocessor</li>\n<li>å±æ€§AutowireCandidateResolver autowireCandidateResolverï¼šnew ContextAnnotationAutowireCandidateResolver();</li>\n<li>å±æ€§<code>Map&lt;String,BeanDefinition&gt;</code> beanDefinitionMap = new ConcurrentHashMap&lt;&gt;(256)\n<ul>\n<li>RootBeanDefinition(ConfigurationClassPostProcessor.class implements BeanDefinitionRegistryPostProcessor): internalConfigurationAnnotationProcessor//æ³¨è§£åç½®å¤„ç†å™¨</li>\n<li>RootBeanDefinition(AutowiredAnnotationBeanPostProcessor.class): internalAutowiredAnnotationProcessor</li>\n<li>RootBeanDefinition(RequiredAnnotationBeanPostProcessor.class): internalRequiredAnnotationProcessor</li>\n<li>RootBeanDefinition(CommonAnnotationBeanPostProcessor.class): internalCommonAnnotationProcessor</li>\n<li>RootBeanDefinition(EventListenerMethodProcessor.class): internalEventListenerProcessor</li>\n<li>RootBeanDefinition(DefaultEventListenerFactory.class): internalEventListenerFactory</li>\n</ul>\n</li>\n<li>å±æ€§<code>List&lt;String&gt;</code> beanDefinitionNames = new ArrayList&lt;&gt;(256)\n<ul>\n<li>\"org.springframework.context.annotation.internalConfigurationAnnotationProcessor\"//æ³¨è§£åç½®å¤„ç†å™¨</li>\n<li>\"org.springframework.context.annotation.internalAutowiredAnnotationProcessor\"</li>\n<li>\"org.springframework.context.annotation.internalRequiredAnnotationProcessor\"</li>\n<li>\"org.springframework.context.annotation.internalCommonAnnotationProcessor\"</li>\n<li>\"org.springframework.context.event.internalEventListenerProcessor\"</li>\n<li>\"org.springframework.context.event.internalEventListenerFactory\"</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å±æ€§ConfigurableEnvironment environmentï¼šnew StandardEnvironment();</li>\n<li>å±æ€§AnnotatedBeanDefinitionReader readerï¼šnew AnnotatedBeanDefinitionReader();\n<ul>\n<li>å±æ€§BeanDefinitionRegistry registryï¼šAnnotationConfigApplicationContext</li>\n<li>å±æ€§ConditionEvaluator conditionEvaluatorï¼šnew ConditionEvaluator();\n<ul>\n<li>å±æ€§ConditionContextImpl contextï¼šnew ConditionContextImpl();\n<ul>\n<li>å±æ€§BeanDefinitionRegistry registry: AnnotationConfigApplicationContext</li>\n<li>å±æ€§ConfigurableListableBeanFactory beanFactory: DefaultListableBeanFactory</li>\n<li>å±æ€§Environment environmentï¼šStandardEnvironment</li>\n<li>å±æ€§ResourceLoader resourceLoaderï¼šDefaultResourceLoader</li>\n<li>å±æ€§ClassLoader classLoaderï¼šAppClassLoader</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å±æ€§é»˜è®¤ScopeMetadataResolver scopeMetadataResolver = new AnnotationScopeMetadataResolver()</li>\n<li>å±æ€§é»˜è®¤BeanNameGenerator beanNameGenerator = new AnnotationBeanNameGenerator()</li>\n</ul>\n</li>\n<li>å±æ€§ClassPathBeanDefinitionScanner scannerï¼šnew ClassPathBeanDefinitionScanner()\n<ul>\n<li>å±æ€§BeanDefinitionRegistry registryï¼šAnnotationConfigApplicationContext</li>\n<li>å±æ€§<code>List&lt;TypeFilter&gt;</code> includeFilters = new LinkedList&lt;&gt;()\n<ul>\n<li>new AnnotationTypeFilter(Component.class)</li>\n</ul>\n</li>\n<li>å±æ€§Environment environmentï¼šStandardEnvironment</li>\n<li>å±æ€§ResourcePatternResolver resourcePatternResolverï¼šAnnotationConfigApplicationContextï¼ˆDefaultResourceLoaderï¼‰</li>\n<li>å±æ€§MetadataReaderFactory metadataReaderFactoryï¼šnew CachingMetadataReaderFactory()ï¼ˆå±æ€§çœç•¥ï¼‰</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>AnnotatedBeanDefinitionReader.registeræ–¹æ³•å°†classæ³¨å†Œåˆ°DefaultListableBeanFactoryçš„beanDefinitionMapä¸­</p>\n<ul>\n<li>æ„é€ AnnotatedGenericBeanDefinition\n<ul>\n<li>å±æ€§beanClassï¼šclass</li>\n<li>å±æ€§AnnotationMetadata metadataï¼šnew StandardAnnotationMetadata(beanClass, true)\n<ul>\n<li>å±æ€§Annotation[] annotations: class.getAnnotations();</li>\n<li>å±æ€§boolean nestedAnnotationsAsMapï¼štrue;</li>\n<li>å±æ€§Class&lt;?&gt; introspectedClassï¼šclass</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>è°ƒç”¨ConditionEvaluator.shouSkipåˆ¤æ–­æ˜¯å¦æ˜¯conditionalæ³¨è§£ï¼Œè‹¥æ˜¯æ— éœ€æ³¨å†Œ</li>\n<li>è°ƒç”¨scopeMetadataResolver.resolveScopeMetadataåˆ¤æ–­æ˜¯å¦è¢«@Scopeæ³¨è§£æ³¨è§£äº†ï¼Œå¹¶è§£æValueå±æ€§å’ŒproxyMode</li>\n<li>è°ƒç”¨beanNameGenerator.generateBeanNameå¾—åˆ°BeanName</li>\n<li>è°ƒç”¨processCommonDefinitionAnnotationsåˆ¤æ–­æ˜¯å¦è¢«lazyï¼ŒPrimaryï¼ŒDependsOnï¼ŒRoleï¼ŒDescriptionæ³¨è§£ï¼Œç»™AnnotatedGenericBeanDefinitionè®¾ç½®ç›¸åº”çš„å±æ€§</li>\n<li>è°ƒç”¨AnnotationConfigUtils.applyScopedProxyModeåˆ¤æ–­æ˜¯å¦è¦æ˜¯å¤šä¾‹çš„</li>\n<li>è°ƒç”¨BeanDefinitionReaderUtils.registerBeanDefinitionå°†AnnotatedGenericBeanDefinitionæ³¨å†Œåˆ°DefaultListableBeanFactoryçš„beanDefinitionMapä¸­ï¼Œæ³¨æ„åˆ«åçš„æ³¨å†Œ</li>\n</ul>\n</li>\n<li>\n<p>AnnotationConfigApplicationContextçš„refresh()æ–¹æ³•</p>\n<ul>\n<li>\n<p>prepareRefresh()</p>\n<ul>\n<li>å±æ€§long startupDateï¼šSystem.currentTimeMillis()è®°å½•å¯åŠ¨æ—¶é—´</li>\n<li>å±æ€§AtomicBoolean activeï¼štrue</li>\n<li>å±æ€§AtomicBoolean closedï¼šfalse</li>\n<li>åˆå§‹åŒ–ç³»ç»Ÿå±æ€§initPropertySourcesé’©å­æ–¹æ³•</li>\n<li>ä½¿ç”¨ConfigurablePropertyResolveræ ¡éªŒè®¾ç½®çš„setRequiredPropertiesç¯å¢ƒå‚æ•°ï¼ˆgetEnvironment().validateRequiredPropertiesï¼‰(æ²¡çœ‹)</li>\n<li>å±æ€§<code>Set&lt;ApplicationListener&lt;?&gt;&gt;</code> earlyApplicationListenersï¼šnew LinkedHashSet&lt;&gt;();</li>\n<li>å±æ€§<code>Set&lt;ApplicationEvent&gt;</code> earlyApplicationEventsï¼šnew LinkedHashSet&lt;&gt;()</li>\n</ul>\n</li>\n<li>\n<p>ConfigurableListableBeanFactory beanFactory = obtainFreshBeanFactory();</p>\n<ul>\n<li>refreshBeanFactory()ï¼›ç”±äºAnnotationConfigApplicationContextç»§æ‰¿äº†GenericApplicationContextï¼Œå¤å†™äº†refreshBeanFactory()æ–¹æ³•ï¼Œåªç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®äº†ä¸€ä¸ªSerializationId</li>\n</ul>\n</li>\n<li>\n<p>prepareBeanFactory(beanFactory);</p>\n<ul>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®ClassLoader beanClassLoaderï¼šAppClassLoader</li>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®BeanExpressionResolver beanExpressionResolverï¼šnew StandardBeanExpressionResolver(AppClassLoader)</li>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®<code>Set&lt;PropertyEditorRegistrar&gt;</code> propertyEditorRegistrarsï¼šadd ResourceEditorRegistrar(StandardEnvironment)</li>\n</ul>\n<p>// Configure the bean factory with context callbacks.</p>\n<ul>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®<code>List&lt;BeanPostProcessor&gt;</code> beanPostProcessorsï¼š\n<ul>\n<li>add new ApplicationContextAwareProcessor(this)</li>\n<li>add new ApplicationListenerDetector(this)</li>\n</ul>\n</li>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®<code>Set&lt;Class&lt;?&gt;&gt;</code> ignoredDependencyInterfacesï¼š\n<ul>\n<li>add EnvironmentAware.class</li>\n<li>add EmbeddedValueResolverAware.class</li>\n<li>add ResourceLoaderAware.class</li>\n<li>add ApplicationEventPublisherAware.class</li>\n<li>add MessageSourceAware.class</li>\n<li>add ApplicationContextAware.class</li>\n</ul>\n</li>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®<code>Map&lt;Class&lt;?&gt;</code>, Object&gt; resolvableDependencies\n<ul>\n<li>put BeanFactory.class, BeanFactory</li>\n<li>put ResourceLoader.class, this</li>\n<li>put ApplicationEventPublisher.class, this</li>\n<li>put ApplicationContext.class, this</li>\n</ul>\n</li>\n<li>if (beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {<br>\nbeanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));<br>\n// Set a temporary ClassLoader for type matching.<br>\nbeanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));<br>\n}</li>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®<code>Map&lt;String,Object&gt;</code> singletonObjects\n<ul>\n<li><code>&lt;environment,StandardEnvironment&gt;</code></li>\n<li><code>&lt;systemProperties,properties&gt;</code>,</li>\n<li><code>&lt;systemEnvironment,Map&gt;</code></li>\n</ul>\n</li>\n<li>ç»™AnnotationConfigApplicationContextçš„beanFactoryè®¾ç½®<code>Set&lt;String&gt;</code> registeredSingletonsï¼š\n<ul>\n<li>\"environment\"</li>\n<li>\"systemProperties\"</li>\n<li>\"systemEnvironment\"</li>\n</ul>\n</li>\n<li>ç»™<code>Set&lt;String&gt;</code> manualSingletonNamesæ·»åŠ \n<ul>\n<li>\"environment\"</li>\n<li>\"systemProperties\"</li>\n<li>\"systemEnvironment\"</li>\n</ul>\n</li>\n<li>å°†ä¸Šä¸€æ­¥ä¸‰ä¸ªå¯¹è±¡æ”¾å…¥åˆ°singletonObjects</li>\n</ul>\n</li>\n<li>\n<p>postProcessBeanFactory(beanFactory)é’©å­æ–¹æ³•ï¼ˆæ²¡çœ‹ï¼‰</p>\n</li>\n<li>\n<p>invokeBeanFactoryPostProcessors(beanFactory)</p>\n<ul>\n<li>è°ƒç”¨PostProcessorRegistrationDelegate.invokeBeanFactoryPostProcessors\n<ul>\n<li>åˆ¤æ–­beanFacctoryæ˜¯å¦å®ç°äº†BeanDefinitionRegistryæ¥å£\n<ul>\n<li>åˆ›å»º<code>List&lt;BeanFactoryPostProcessor&gt;</code> regularPostProcessors = new ArrayList&lt;&gt;();å­˜æ”¾å®ç°äº†BeanDefinitionRegistryPostProcessor</li>\n<li>åˆ›å»º<code>List&lt;BeanDefinitionRegistryPostProcessor&gt;</code> registryProcessors = new ArrayList&lt;&gt;();å­˜æ”¾å®ç°äº†BeanDefinitionRegistryPostProcessor</li>\n<li>éå†BeanFactoryPostProcessorï¼Œæ‰¾åˆ°BeanDefinitionRegistryPostProcessorå®ç°ç±»è°ƒç”¨postProcessBeanDefinitionRegistryæ–¹æ³•ï¼Œå¹¶æ”¾å…¥åˆ°registryProcessorsä¸­ï¼Œå…¶ä»–æ”¾å…¥regularPostProcessorsä¸­</li>\n<li>éå†beanFactoryä¸­çš„beanDefinitionNamesæ‰¾åˆ°åŒæ—¶å®ç°äº†BeanDefinitionRegistryPostProcessor.classå’ŒPriorityOrdered.classçš„ç±»ï¼ŒæŒ‰å®ç°äº†AnnotationAwareOrderComparatoræ¥å£è¿›è¡Œæ’åºï¼Œï¼ˆè¿™ä¸ªæ–¹æ³•é‡Œé¢æ‰¾åˆ°ConfigurationClassPostProcessorï¼‰è°ƒç”¨å…¶postProcessBeanDefinitionRegistryå®ç°æ¥å£æ–¹æ³•\n<ul>\n<li>ConfigurationClassPostProcessorè°ƒç”¨postProcessBeanDefinitionRegistry(æœ¬è´¨è°ƒç”¨processConfigBeanDefinitions)é‡ç‚¹\n<ul>\n<li>æ‰«æå·²ç»æ³¨å†Œçš„BeanDefinition,æ‰¾åˆ°æ‰€æœ‰Componentã€ComponentScanã€Importã€ImportResourceã€æˆ–è€…Configurationæ³¨è§£çš„ç±»å¹¶è§£æorderæ³¨è§£ï¼Œæœ€åæŒ‰orderæ’åºï¼Œåˆ›å»ºConfigurationClassParserï¼Œå¹¶å¾ªç¯åšå¦‚ä¸‹è§£æ(æœ¬è´¨doProcessConfigurationClass)\n<ul>\n<li>è§£æ@PropertySourceæ³¨è§£ï¼ˆå¾…çœ‹ï¼‰ï¼Œä½¿ç”¨componentScanParseræ‰¾ä¸Šé¢çš„è§£æ@ComponentScanï¼Œè§£æåˆ°é‚£ä¸ªç±»ä¹‹åå†doProcessConfigurationClassä¸€éï¼ˆé€’å½’ï¼‰</li>\n<li>è§£æ@Importã€@ImportResource</li>\n<li>ä»é…ç½®ç±»@Configurationä¸­è§£æ@Beanï¼Œæ‰¾åˆ°çš„æ‰€æœ‰ç±»åŠ å…¥åˆ°BeanFactoryä¸­</li>\n<li>åˆ›å»ºConfigurationClassBeanDefinitionReaderï¼Œæ‰¾åˆ°ç›¸å…³@Beané‡Œé¢çš„beanå®šä¹‰ï¼Œæ‰¾åˆ°@Importçš„èµ„æºåŠ è½½è¿›æ¥</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é™¤äº†ä¸Šé¢çš„åç½®å¤„ç†å™¨å¤–ï¼Œæ‰¾åˆ°æœ‰@orderdæ³¨è§£çš„é‡å¤ä¸Šé¢çš„æ­¥éª¤</li>\n<li>æ‰¾åˆ°é™¤äº†ä¸Šé¢2ç§åç½®å¤„ç†å™¨å¤–çš„æ¥å£ï¼Œé‡å¤ä¸Šé¢çš„æ­¥éª¤</li>\n<li>è°ƒç”¨ä¸Šé¢æ”¶é›†åˆ°çš„regularPostProcessorså’ŒregistryProcessorsçš„postProcessBeanFactoryæ–¹æ³•</li>\n</ul>\n</li>\n<li>æ²¡å®ç°åˆ™ç›´æ¥éå†BeanFactoryPostProcessorsè°ƒç”¨postProcessBeanFactoryæ–¹æ³•</li>\n<li>æœ€åè°ƒç”¨é™¤äº†ä¸Šé¢çš„æ‰€æœ‰å®ç°äº†BeanFactoryPostProcessoræ¥å£çš„ç±»ï¼Œåˆ†æˆpriorityOrdered.class\\ordered.class\\å…¶ä»–\\å„è‡ªæ’åºå®Œæˆåè°ƒç”¨postProcessBeanFactoryæ–¹æ³•</li>\n</ul>\n</li>\n<li>æ£€æŸ¥å¦‚æœæœç´¢åˆ°LoadTimeWeaverï¼Œéœ€è¦å‡†å¤‡ç»‡å…¥\n<ul>\n<li>if (beanFactory.getTempClassLoader() == null &amp;&amp; beanFactory.containsBean(LOAD_TIME_WEAVER_BEAN_NAME)) {</li>\n<li>beanFactory.addBeanPostProcessor(new LoadTimeWeaverAwareProcessor(beanFactory));</li>\n<li>beanFactory.setTempClassLoader(new ContextTypeMatchClassLoader(beanFactory.getBeanClassLoader()));</li>\n<li>}</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>registerBeanPostProcessors(beanFactory)</p>\n<ul>\n<li>æ‰¾åˆ°æ‰€æœ‰BeanPostProcessor.classçš„ç±»åå­—</li>\n<li>beanFactoryçš„BeanPostProcessoræ·»åŠ BeanPostProcessorChecker</li>\n<li>ä»beanFactoryæ‰¾åˆ°å®ç°äº†BeanPostProcessor.classçš„ç±»ï¼ŒåŒæ—¶priorityOrdered.class\\ordered.class\\nonOrderedå„è‡ªæ’åºï¼Œå¹¶å°†å…¶æ³¨å†Œåˆ°AnnotationConfigApplicationContextçš„beanPostProcessorsä¸­ï¼Œå°†ä¸Šé¢ä¸‰ç§ç±»ä¸­åŒæ—¶å®ç°äº†MergedBeanDefinitionPostProcessoræ¥å£çš„ç±»æ’åºåä¹Ÿæ³¨å†Œè¿›å»</li>\n<li>beanFactoryçš„BeanPostProcessoræ·»åŠ ApplicationListenerDetector</li>\n</ul>\n</li>\n<li>\n<p>åˆå§‹åŒ–å›½é™…åŒ–initMessageSource();</p>\n</li>\n<li>\n<p>æ³¨å†Œå¹¿æ’­initApplicationEventMulticaster()</p>\n</li>\n<li>\n<p>onRefresh()å¯åŠ¨åˆ«çš„å®¹å™¨çš„å­ç±»</p>\n</li>\n<li>\n<p>registerListeners()æ³¨å†Œç›‘å¬ç±»</p>\n</li>\n<li>\n<p>finishBeanFactoryInitialization(beanFactory)åˆå§‹åŒ–æ‰€æœ‰çš„beanï¼ˆæœ¬è´¨è°ƒç”¨preInstantiateSingletonsï¼‰</p>\n<ul>\n<li><code>beanFactoryçš„List&lt;StringValueResolver&gt;</code> embeddedValueResolversæ·»åŠ getEnvironment().resolvePlaceholders(strVal)(å¾…çœ‹)</li>\n<li>String[] weaverAwareNames = beanFactory.getBeanNamesForType(LoadTimeWeaverAware.class, false, false);<br>\nfor (String weaverAwareName : weaverAwareNames) {<br>\ngetBean(weaverAwareName);<br>\n}</li>\n<li>beanFactory.configurationFrozen = true;</li>\n<li>beanFactory.frozenBeanDefinitionNames = StringUtils.toStringArray(this.beanDefinitionNames);</li>\n<li>beanFactory.preInstantiateSingletons();\n<ul>\n<li>éå†beanDefinitionNamesã€è°ƒç”¨getMergedLocalBeanDefinitionåˆ¤æ–­BeanDefinitionå½“ä¸”ä»…å½“éæŠ½è±¡ç±»ã€å•ä¾‹ã€éæ‡’åŠ è½½æ—¶\n<ul>\n<li>isFactoryBean()åˆ¤æ–­æ˜¯å¦æ˜¯FactoryBeanå®ç°ç±»(å¾…çœ‹)\n<ul>\n<li>å¦‚æœå®ç°äº†FactoryBeanè€Œä¸”æ˜¯SmartFactoryBeanç±»å‹ä¸”isEagerInitï¼Œåˆ™getBeanåˆå§‹åŒ–</li>\n</ul>\n</li>\n<li>å½“ä¸æ˜¯FactoryBeanå®ç°ç±»æ—¶,ç›´æ¥getBeanåˆå§‹åŒ–</li>\n<li>getBean(name)-&gt;doGetBean(name)æ–¹æ³•\n<ul>\n<li>å¦‚æœè¯¥nameæ˜¯FactoryBeanï¼Œé‚£ä¹ˆæˆªå–æ‰&amp;ï¼Œå¾—åˆ°BeanName</li>\n<li>getSingleton(beanName,true)</li>\n<li>å¦‚æœgetSingleton!=null,getObjectForBeanInstance();(å¾…çœ‹)</li>\n<li>å¦‚æœgetSingleton==null,ç¬¬ä¸€æ¬¡è¿›æ¥\n<ul>\n<li>å¦‚æœprototypesCurrentlyInCreationæ‰¾åˆ°å®ƒï¼Œåˆ™æŠ›å‡ºå¾ªç¯ä¾èµ–çš„å¼‚å¸¸</li>\n<li>ä»mergedBeanDefinitionsæŸ¥æ‰¾ï¼Œæ²¡æœ‰åˆ™ä»çˆ¶å®¹å™¨ä¸­doGetBeanç»§ç»­æ‰¾</li>\n<li>å¦‚æœæ˜¯typeCheckOnly-&gt;æ·»åŠ åˆ°<code>Set&lt;String&gt;</code> alreadyCreated</li>\n<li>å¹¶å°†å…¶ä»–çš„BeanDefinitionã€GenericBeanDefinitionè½¬æˆRootBeanDefinition(getMergedBeanDefinition())</li>\n<li>åˆ¤æ–­BeanDefinitionçš„dependsOnå…³ç³»ï¼Œå¦‚æœdependentBeanMapä¸­æœ‰åˆ™æŠ›å‡ºå¾ªç¯ä¾èµ–å¼‚å¸¸ï¼Œå¦åˆ™è®°å½•åˆ°dependentBeanMapå¹¶getBeanæ‰¾åˆ°å¯¹åº”çš„ç±»</li>\n<li>å¦‚æœæ˜¯å•ä¾‹ï¼Œè°ƒç”¨getSingleton(beanName,CreatBean());\n<ul>\n<li>å¤åˆ¶RootBeanDefinitionï¼Œéå†MethodOverridesè°ƒç”¨prepareMethodOverridesï¼Œï¼ˆè§£æ@ Lookupå’Œlookup-methodæ ‡ç­¾å¾—åˆ°çš„ï¼‰</li>\n<li>è‡ªå®šä¹‰Beançš„è°ƒç”¨â€”â€”éå†BeanPostProcessorä¸­å®ç°InstantiationAwareBeanPostProcessorçš„ç±»ï¼Œè°ƒç”¨postProcessBeforeInstantiationåˆ›å»ºå¯¹è±¡ï¼Œå¦‚æœæœ‰å¯¹è±¡åˆ™è°ƒç”¨postProcessAfterInitializationï¼Œå¦‚æœæ²¡æœ‰çš„è¯ï¼Œå°±æ‰§è¡ŒdoCreateBeanç”±springäº§ç”Ÿ\n<ul>\n<li>é€šè¿‡createBeanInstanceè·å¾—BeanWrapper\n<ul>\n<li>ä»çˆ¶ç±»ä¸­æ‹¿åˆ°å®ä¾‹(å¾…çœ‹)</li>\n<li>ä»FactoryMethodä¸­æ‹¿åˆ°å®ä¾‹(å¾…çœ‹)</li>\n<li>åˆ¤æ–­æ˜¯å¦æœ‰@AutoWiredç›¸å…³çš„ï¼Œæ‰¾åˆ°åˆ™autowireConstructor(å¾…çœ‹)</li>\n<li>æ²¡æœ‰ä¸@AutoWiredç›¸å…³çš„ï¼Œè°ƒç”¨SimpleInstantiationStrategy.instantiateBeané€šè¿‡åå°„åˆ›å»º(å¾…çœ‹)</li>\n</ul>\n</li>\n<li>å°†resolvedTargetTypeèµ‹ç»™RootBeanDefinitionçš„resolvedTargetType</li>\n<li>éå†BeanPostProcessorä¸­å®ç°äº†MergedBeanDefinitionPostProcessorçš„postProcessMergedBeanDefinitionæ–¹æ³•ï¼Œå¹¶å°†å…¶postProcessedç½®ä¸ºtrue</li>\n<li>å¦‚æœæ˜¯allowCircularReferencesã€singletonsCurrentlyInCreationã€å•ä¾‹çš„æƒ…å†µä¸‹ï¼Œå…ˆæ”¾å…¥åˆ°singletonFactoriesã€registeredSingletonsã€ç§»èµ°earlySingletonObjectsä¸‰çº§ç¼“å­˜ä¸­é˜²æ­¢å¾ªç¯ä¾èµ–</li>\n<li>populateBeanï¼šå¡«å……å±æ€§\n<ul>\n<li>å¦‚æœå«æœ‰InstantiationAwareBeanPostProcessorsä¸”ésyntheticåˆæˆï¼Œåˆ™éå†BeanPostProcessorsè°ƒç”¨InstantiationAwareBeanPostProcessorçš„postProcessAfterInstantiation</li>\n<li>åˆ¤æ–­@AutoWiredå±æ€§å¹¶ä¸”å®Œæˆå±æ€§æ³¨å…¥(å¾…çœ‹)</li>\n<li>initializeBeanï¼šåˆå§‹åŒ–å±æ€§</li>\n<li>éåˆæˆç±»åˆ™éå†BeanPostProcessorè°ƒç”¨postProcessBeforeInitialization</li>\n<li>éåˆæˆç±»åˆ™éå†BeanPostProcessorè°ƒç”¨postProcessAfterInitialization</li>\n</ul>\n</li>\n<li>registerDisposableBeanIfNecessary();(å¾…çœ‹)</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å¦‚æœæ˜¯å¤šä¾‹(å¾…çœ‹)</li>\n<li>å…¶ä»–æƒ…å†µ(å¾…çœ‹)</li>\n<li>æœ€åå¤§å®¶éƒ½è°ƒç”¨getObjectForBeanInstanceï¼ˆåˆ¤æ–­æ˜¯å¦å®ç°äº†FactoryBeanï¼Œä¸æ˜¯FactoryBeanç›´æ¥è¿”å›ä¼ å…¥çš„å¯¹è±¡ï¼‰(å¾…çœ‹)</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>éå†beanDefinitionNamesè°ƒç”¨å®ç°äº†SmartInitializingSingletonæ¥å£beançš„afterSingletonsInstantiatedæ–¹æ³•</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>è§£æXML</p>\n</li>\n<li>\n<p>resourcePatternResolver().getResources(location)-&gt;new ClassPathContextResource(location) implements Resource -&gt;new EncodedResource(Resource) implements InputStreamSource<br>\n-&gt;classLoader.getResourceAsStream Inputstream -&gt;InputSource-&gt;DOMParser.Document</p>\n</li>\n<li>\n<p>PathMatchingResourcePatternResolverè§£æbasePackage</p>\n</li>\n<li>\n<p><code>Enumeration&lt;URL&gt;</code> classLoder.getResource() -&gt;<code>Set&lt;Resource&gt;</code></p>\n</li>\n</ul>\n<h1>20. Spring AnnotatedElementUtilséå†æœç´¢æ³¨è§£çš„å±æ€§çš„æ–¹æ³•</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æœç´¢æœ¬æ³¨è§£åŠå…¶çˆ¶ç±»çš„@inheritedæ³¨è§£çš„é›†åˆ\nprivate static &lt;T&gt; T searchWithGetSemantics(\n\tAnnotatedElement element,//å«æœ‰æ³¨è§£çš„ç±»\n\t@Nullable Class&lt;? extends Annotation&gt; annotationType, \n\t@Nullable String annotationName,\n\t@Nullable Class&lt;? extends Annotation&gt; containerType, //å¯é‡å¤æ³¨è§£çš„å®¹å™¨å¯¹è±¡(æš‚æ—¶çœ‹å…¨éƒ¨éƒ½æ˜¯ä¸ºnullï¼ŒåŠŸèƒ½æœªçŸ¥)\n\tProcessor&lt;T&gt; processor,//å®ç°äº†Processoræ¥å£çš„æ¥å£ç±»ï¼Œé€šè¿‡Processoræ¥å¯¹å…ƒç´ è¿›è¡Œå¤„ç†\n\tSet&lt;AnnotatedElement&gt; visited, //å·²ç»è®¿é—®çš„å…ƒç´ ï¼šç”¨seté˜²æ­¢é‡å¤ï¼Œå¹¶ç»ˆæ­¢é€’å½’\n\tint metaDepth//æ³¨è§£æ·±åº¦ï¼Œæ§åˆ¶æ³¨è§£æ”¶é›†ï¼Œprocessoråªæ”¶é›†ç¬¬ä¸€æ¬¡æ‹¿åˆ°çš„ç»“æœ\n\t) {\n\tif (visited.add(element)) {\n\t\ttry {\n\t\t\tList&lt;Annotation&gt; declaredAnnotations = Arrays.asList(element.getDeclaredAnnotations());\n\t\t\tT result = searchWithGetSemanticsInAnnotations(element, declaredAnnotations,\n\t\t\t\tannotationType, annotationName, containerType, processor, visited, metaDepth);\n\t\t\tif (result != null) {return result;}\n\t\t\tif (element instanceof Class) {  // otherwise getAnnotations doesn't return anything new\n\t\t\t\tClass&lt;?&gt; superclass = ((Class) element).getSuperclass();\n\t\t\t\tif (superclass != null &amp;&amp; superclass != Object.class) {\n\t\t\t\t\tList&lt;Annotation&gt; inheritedAnnotations = new LinkedList&lt;&gt;();\n\t\t\t\t\tfor (Annotation annotation : element.getAnnotations()) {//æ‹¿åˆ°ä»çˆ¶ç±»ç»§æ‰¿è¿‡æ¥çš„@inheritedæ³¨è§£å†æ‰¾ä¸€é\n\t\t\t\t\t\tif (!declaredAnnotations.contains(annotation)) {\n\t\t\t\t\t\t\tinheritedAnnotations.add(annotation);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\t// Continue searching within inherited annotations\n\t\t\t\t\tresult = searchWithGetSemanticsInAnnotations(element, inheritedAnnotations,\n\t\t\t\t\tannotationType, annotationName, containerType, processor, visited, metaDepth);\n\t\t\t\t\tif (result != null) {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tcatch (Throwable ex) {\n\t\t\tAnnotationUtils.handleIntrospectionFailure(element, ex);\n\t\t}\n\t}\n\n\treturn null;\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æœç´¢æœ¬æ³¨è§£åŠå…¶æ³¨è§£çš„æ³¨è§£\nprivate static &lt;T&gt; T searchWithGetSemanticsInAnnotations(\n\t@Nullable AnnotatedElement element,//å«æœ‰æ³¨è§£çš„ç±»\n\tList&lt;Annotation&gt; annotations, //è¢«æœç´¢çš„æ³¨è§£åˆ—è¡¨\n\t@Nullable Class&lt;? extends Annotation&gt; annotationType,//éœ€è¦æœç´¢çš„æ³¨è§£\n\t@Nullable String annotationName, //éœ€è¦æœç´¢çš„æ³¨è§£çš„å…¨ç±»å\n\t@Nullable Class&lt;? extends Annotation&gt; containerType,//å¯é‡å¤æ³¨è§£çš„å®¹å™¨å¯¹è±¡(æš‚æ—¶çœ‹å…¨éƒ¨éƒ½æ˜¯ä¸ºnullï¼ŒåŠŸèƒ½æœªçŸ¥)\n\tProcessor&lt;T&gt; processor, //å®ç°äº†Processoræ¥å£çš„æ¥å£ç±»ï¼Œé€šè¿‡Processoræ¥å¯¹å…ƒç´ è¿›è¡Œå¤„ç†\n\tSet&lt;AnnotatedElement&gt; visited, //å·²ç»è®¿é—®çš„å…ƒç´ ï¼šç”¨seté˜²æ­¢é‡å¤ï¼Œå¹¶ç»ˆæ­¢é€’å½’\n\tint metaDepth //æ³¨è§£æ·±åº¦ï¼Œæ§åˆ¶æ³¨è§£æ”¶é›†ï¼Œprocessoråªæ”¶é›†ç¬¬ä¸€æ¬¡æ‹¿åˆ°çš„ç»“æœ\n\t) {\n\n\t\tfor (Annotation annotation : annotations) {\n\t\t\tClass&lt;? extends Annotation&gt; currentAnnotationType = annotation.annotationType();\n\t\t\t//åˆ¤æ–­æ˜¯å¦æ˜¯jdkæœ¬èº«çš„æ³¨è§£:currentAnnotationType.getName()åˆ¤æ–­æ˜¯å¦æ˜¯java.lang.annotationå¼€å¤´\n\t\t\tif (!AnnotationUtils.isInJavaLangAnnotationPackage(currentAnnotationType)) {\n\t\t\t\t//åˆ¤æ–­ç±»å‹ä¸€è‡´ï¼Œå…¨ç±»åä¸€è‡´ã€æˆ–è€…Processoræ¥å£alwaysProcesseså†³å®šå¿…é¡»æ‰§è¡Œprocess\n\t\t\t\tif (currentAnnotationType == annotationType ||\n\t\t\t\t\tcurrentAnnotationType.getName().equals(annotationName) ||\n\t\t\t\t\tprocessor.alwaysProcesses()) {\n\t\t\t\t\tT result = processor.process(element, annotation, metaDepth);\n\t\t\t\t\tif (result != null) {\n\t\t\t\t\t\t//Processoræ¥å£aggregateså’ŒmetaDepthä¸º0æ˜¯å†³å®šæ˜¯å¦è¦æ”¶é›†ç»“æœåˆ°processor\n\t\t\t\t\t\tif (processor.aggregates() &amp;&amp; metaDepth == 0) {\n\t\t\t\t\t\t\tprocessor.getAggregatedResults().add(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\treturn result;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Repeatable annotations in container?\n\t\t\t\t//å…¨éƒ¨ä¸ºnullï¼ŒåŸºæœ¬æ²¡å•¥ç”¨è¿™ä¸ªæ–¹æ³•ï¼ŒåŠŸèƒ½æœªçŸ¥ï¼Œå¯èƒ½æ˜¯@Repeatableæ³¨è§£?\n\t\t\t\telse if (currentAnnotationType == containerType) {\n\t\t\t\t\tfor (Annotation contained : getRawAnnotationsFromContainer(element, annotation)) {\n\t\t\t\t\t\tT result = processor.process(element, contained, metaDepth);\n\t\t\t\t\t\tif (result != null) {\n\t\t\t\t\t\t\tprocessor.getAggregatedResults().add(result);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\t//é€’å½’æœç´¢æ³¨è§£ä¸Šçš„æ³¨è§£,é€’å½’æœç´¢å…ƒæ³¨è§£ï¼Œç„¶åè°ƒç”¨è¿‡postProcessåç½®å¤„ç†\n\t\tfor (Annotation annotation : annotations) {\n\t\t\tClass&lt;? extends Annotation&gt; currentAnnotationType = annotation.annotationType();\n\t\t\t//currentAnnotationTypeä¸æ˜¯java.lang.annotationå¼€å¤´ï¼ŒannotationType, annotationNameä¸æ˜¯ä»¥javaå¼€å¤´\n\t\t\tif (hasSearchableMetaAnnotations(currentAnnotationType, annotationType, annotationName)) {\n\t\t\t\t//é€’å½’æœç´¢æ³¨è§£ä¸Šçš„æ³¨è§£\n\t\t\t\tT result = searchWithGetSemantics(currentAnnotationType, annotationType,\n\t\t\t\t\t\tannotationName, containerType, processor, visited, metaDepth + 1);\n\t\t\t\tif (result != null) {\n\t\t\t\t\t//è°ƒç”¨processorçš„åç½®å¤„ç†ç»“æœå¤„ç†ç»“æœ\n\t\t\t\t\tprocessor.postProcess(element, annotation, result);\n\t\t\t\t\t//Processoræ¥å£aggregateså’ŒmetaDepthä¸º0æ˜¯å†³å®šæ˜¯å¦è¦æ”¶é›†ç»“æœåˆ°processor\n\t\t\t\t\tif (processor.aggregates() &amp;&amp; metaDepth == 0) {\n\t\t\t\t\t\tprocessor.getAggregatedResults().add(result);\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\treturn result;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\n\t\treturn null;\n\t}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Processoræ¥å£å®ç°ç±»ä¹‹ä¸€ MergedAnnotationAttributesProcessor\nprivate static class MergedAnnotationAttributesProcessor implements Processor&lt;AnnotationAttributes&gt; {\n\t\tprivate final boolean classValuesAsString;\n\t\tprivate final boolean nestedAnnotationsAsMap;\n\t\tprivate final boolean aggregates;\n\t\tprivate final List&lt;AnnotationAttributes&gt; aggregatedResults;\n\n\t\tMergedAnnotationAttributesProcessor() {this(false, false, false);}\n\n\t\tMergedAnnotationAttributesProcessor(boolean classValuesAsString, boolean nestedAnnotationsAsMap) {\n\t\t\tthis(classValuesAsString, nestedAnnotationsAsMap, false);\n\t\t}\n\n\t\tMergedAnnotationAttributesProcessor(boolean classValuesAsString, \n\t\t\tboolean nestedAnnotationsAsMap, boolean aggregates) {\n\t\t\tthis.classValuesAsString = classValuesAsString;\n\t\t\tthis.nestedAnnotationsAsMap = nestedAnnotationsAsMap;\n\t\t\tthis.aggregates = aggregates;\n\t\t\tthis.aggregatedResults = (aggregates ? new ArrayList&lt;&gt;() : Collections.emptyList());\n\t\t}\n\n\t\t@Override\n\t\tpublic boolean alwaysProcesses() {return false;}\n\n\t\t@Override\n\t\tpublic boolean aggregates() {return this.aggregates;}\n\n\t\t@Override\n\t\tpublic List&lt;AnnotationAttributes&gt; getAggregatedResults() {\n\t\t\treturn this.aggregatedResults;\n\t\t}\n\n\t\t@Override\n\t\t@Nullable\n\t\tpublic AnnotationAttributes process(@Nullable AnnotatedElement annotatedElement, Annotation annotation, int metaDepth) {\n\t\t\treturn AnnotationUtils.retrieveAnnotationAttributes(annotatedElement, annotation,\n\t\t\t\t\tthis.classValuesAsString, this.nestedAnnotationsAsMap);\n\t\t}\n\n\t\t@Override\n\t\tpublic void postProcess(@Nullable AnnotatedElement element, Annotation annotation, AnnotationAttributes attributes) {\n\t\t\tannotation = AnnotationUtils.synthesizeAnnotation(annotation, element);\n\t\t\tClass&lt;? extends Annotation&gt; targetAnnotationType = attributes.annotationType();\n\n\t\t\t// Track which attribute values have already been replaced so that we can short\n\t\t\t// circuit the search algorithms.\n\t\t\tSet&lt;String&gt; valuesAlreadyReplaced = new HashSet&lt;&gt;();\n\n\t\t\tfor (Method attributeMethod : AnnotationUtils.getAttributeMethods(annotation.annotationType())) {\n\t\t\t\tString attributeName = attributeMethod.getName();\n\t\t\t\tString attributeOverrideName = AnnotationUtils.getAttributeOverrideName(attributeMethod, targetAnnotationType);\n\n\t\t\t\t// Explicit annotation attribute override declared via @AliasFor\n\t\t\t\tif (attributeOverrideName != null) {\n\t\t\t\t\tif (valuesAlreadyReplaced.contains(attributeOverrideName)) {\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\n\t\t\t\t\tList&lt;String&gt; targetAttributeNames = new ArrayList&lt;&gt;();\n\t\t\t\t\ttargetAttributeNames.add(attributeOverrideName);\n\t\t\t\t\tvaluesAlreadyReplaced.add(attributeOverrideName);\n\n\t\t\t\t\t// Ensure all aliased attributes in the target annotation are overridden. (SPR-14069)\n\t\t\t\t\tList&lt;String&gt; aliases = AnnotationUtils.getAttributeAliasMap(targetAnnotationType).get(attributeOverrideName);\n\t\t\t\t\tif (aliases != null) {\n\t\t\t\t\t\tfor (String alias : aliases) {\n\t\t\t\t\t\t\tif (!valuesAlreadyReplaced.contains(alias)) {\n\t\t\t\t\t\t\t\ttargetAttributeNames.add(alias);\n\t\t\t\t\t\t\t\tvaluesAlreadyReplaced.add(alias);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\toverrideAttributes(element, annotation, attributes, attributeName, targetAttributeNames);\n\t\t\t\t}\n\t\t\t\t// Implicit annotation attribute override based on convention\n\t\t\t\telse if (!AnnotationUtils.VALUE.equals(attributeName) &amp;&amp; attributes.containsKey(attributeName)) {\n\t\t\t\t\toverrideAttribute(element, annotation, attributes, attributeName, attributeName);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t}\nAnnotationUtils\n//æ£€ç´¢æ³¨è§£é‡Œé¢çš„æ–¹æ³•å¹¶è¿”å›AnnotationAttributes(éå¸¸å¸¸ç”¨)\nstatic AnnotationAttributes retrieveAnnotationAttributes(\n\t@Nullable Object annotatedElement, \n\tAnnotation annotation,\n\tboolean classValuesAsString, \n\tboolean nestedAnnotationsAsMap\n\t) {\n\n\tClass&lt;? extends Annotation&gt; annotationType = annotation.annotationType();\n\tAnnotationAttributes attributes = new AnnotationAttributes(annotationType);\n\n\tfor (Method method : getAttributeMethods(annotationType)) {\n\t\ttry {\n\t\t\tObject attributeValue = method.invoke(annotation);\n\t\t\tObject defaultValue = method.getDefaultValue();\n\t\t\tif (defaultValue != null &amp;&amp; ObjectUtils.nullSafeEquals(attributeValue, defaultValue)) {\n\t\t\t\tattributeValue = new DefaultValueHolder(defaultValue);\n\t\t\t}\n\t\t\tattributes.put(method.getName(),\n\t\t\t\t\tadaptValue(annotatedElement, attributeValue, classValuesAsString, nestedAnnotationsAsMap));\n\t\t}\n\t\tcatch (Throwable ex) {\n\t\t\tif (ex instanceof InvocationTargetException) {\n\t\t\t\tThrowable targetException = ((InvocationTargetException) ex).getTargetException();\n\t\t\t\trethrowAnnotationConfigurationException(targetException);\n\t\t\t}\n\t\t\tthrow new IllegalStateException(\"Could not obtain annotation attribute value for \" + method, ex);\n\t\t}\n\t}\n\n\treturn attributes;\n}\n\n//å…ˆä»ç¼“å­˜é‡Œé¢å»ï¼Œæ²¡æœ‰åˆ™å–å‡ºä¸ä¼ å…¥æ¥å£çš„æ‰€æœ‰ç›¸å…³æ–¹æ³•å¹¶è®¾ç½®ä¸ºå…è®¸è®¿é—®ï¼Œæœ€åæŠŠç»“æœä»¥ key ä¸ºannotationType å€¼ä¸ºList&lt;Method&gt; attributeMethodsCacheç¼“å­˜èµ·æ¥ï¼Œ\nstatic List&lt;Method&gt; getAttributeMethods(Class&lt;? extends Annotation&gt; annotationType) {\n\tList&lt;Method&gt; methods = attributeMethodsCache.get(annotationType);\n\tif (methods != null) {return methods;}\n\tmethods = new ArrayList&lt;&gt;();\n\tfor (Method method : annotationType.getDeclaredMethods()) {\n\t\t//(method != null &amp;&amp; method.getParameterCount() == 0 &amp;&amp; method.getReturnType() != void.class);\n\t\tif (isAttributeMethod(method)) {//åˆ¤æ–­æ˜¯å¦æ˜¯æ³¨è§£çš„æ–¹æ³•\n\t\t\tReflectionUtils.makeAccessible(method);\n\t\t\tmethods.add(method);\n\t\t}\n\t}\n\n\tattributeMethodsCache.put(annotationType, methods);\n\treturn methods;\n}\n\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>springä¸‰çº§ç¼“å­˜\nDefaultSingletonBeanRegistry\n//ä»singletonObjectsæ‰¾\n\t// åœ¨singletonsCurrentlyInCreationçš„å•ä¾‹ï¼Œä»earlySingletonObjectsä¸­æ‰¾\n\t// allowEarlyReferenceï¼Œé‚£ä¹ˆä»singletonFactoriesæ‰¾ï¼Œå¹¶å°†å¯¹è±¡singletonFactoriesæ”¾åˆ°earlySingletonObjectsä¸­\n\tprotected Object getSingleton(String beanName, boolean allowEarlyReference) {\n\t\tObject singletonObject = this.singletonObjects.get(beanName);\n\t\tif (singletonObject == null &amp;&amp; isSingletonCurrentlyInCreation(beanName)) {\n\t\t\tsynchronized (this.singletonObjects) {\n\t\t\t\tsingletonObject = this.earlySingletonObjects.get(beanName);\n\t\t\t\tif (singletonObject == null &amp;&amp; allowEarlyReference) {\n\t\t\t\t\tObjectFactory&lt;?&gt; singletonFactory = this.singletonFactories.get(beanName);\n\t\t\t\t\tif (singletonFactory != null) {\n\t\t\t\t\t\tsingletonObject = singletonFactory.getObject();\n\t\t\t\t\t\tthis.earlySingletonObjects.put(beanName, singletonObject);\n\t\t\t\t\t\tthis.singletonFactories.remove(beanName);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\treturn singletonObject;\n\t}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//ä»mergedBeanDefinitionsä¸­æ‰¾åˆ°RootBeanDefinition\n\tprotected RootBeanDefinition getMergedLocalBeanDefinition(String beanName) throws BeansException {\n\t\tRootBeanDefinition mbd = this.mergedBeanDefinitions.get(beanName);\n\t\tif (mbd != null) {return mbd;}\n\t\treturn getMergedBeanDefinition(beanName, getBeanDefinition(beanName));//getBeanDefinitionä»beanDefinitionMapæ‰¾BeanDefinition\n\t}\n\tprotected RootBeanDefinition getMergedBeanDefinition(String beanName, BeanDefinition bd)\n\t\tthrows BeanDefinitionStoreException {\n\t\treturn getMergedBeanDefinition(beanName, bd, null);\n\t}\n\t//å¦‚æœç»™å®šbeançš„å®šä¹‰æ˜¯å­beanå®šä¹‰ï¼Œåˆ™é€šè¿‡ä¸çˆ¶beanåˆå¹¶è¿”å›ç»™å®šbeançš„RootBeanDefinition\n\t//åœ¨mergedBeanDefinitionsæ‰¾-&gt;RootBeanDefinitionç±»å‹åˆ™å¤åˆ¶ï¼Œå¦åˆ™ä¹‹é—´åˆ›å»º\n\t// -&gt;ä»çˆ¶å®¹å™¨çš„ConfigurableBeanFactoryå¾—åˆ°getMergedBeanDefinitionï¼Œæ„é€ RootBeanDefinitionï¼Œè®¾ç½®Scope\n\t//ç¼“å­˜åˆ°mergedBeanDefinitions\n\tprotected RootBeanDefinition getMergedBeanDefinition(\n\t\t\tString beanName, BeanDefinition bd, @Nullable BeanDefinition containingBd)\n\t\t\tthrows BeanDefinitionStoreException {\n\n\t\tsynchronized (this.mergedBeanDefinitions) {\n\t\t\tRootBeanDefinition mbd = null;\n\t\t\tif (containingBd == null) {\n\t\t\t\tmbd = this.mergedBeanDefinitions.get(beanName);\n\t\t\t}\n\n\t\t\tif (mbd == null) {\n\t\t\t\tif (bd.getParentName() == null) {\n\t\t\t\t\tif (bd instanceof RootBeanDefinition) {\n\t\t\t\t\t\tmbd = ((RootBeanDefinition) bd).cloneBeanDefinition();\n\t\t\t\t\t}\n\t\t\t\t\telse {\n\t\t\t\t\t\tmbd = new RootBeanDefinition(bd);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\t// Child bean definition: needs to be merged with parent.\n\t\t\t\t\tBeanDefinition pbd;\n\t\t\t\t\ttry {\n\t\t\t\t\t\tString parentBeanName = transformedBeanName(bd.getParentName());\n\t\t\t\t\t\tif (!beanName.equals(parentBeanName)) {\n\t\t\t\t\t\t\tpbd = getMergedBeanDefinition(parentBeanName);\n\t\t\t\t\t\t}\n\t\t\t\t\t\telse {\n\t\t\t\t\t\t\tBeanFactory parent = getParentBeanFactory();\n\t\t\t\t\t\t\tif (parent instanceof ConfigurableBeanFactory) {\n\t\t\t\t\t\t\t\tpbd = ((ConfigurableBeanFactory) parent).getMergedBeanDefinition(parentBeanName);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\telse {\n\t\t\t\t\t\t\t\tthrow new NoSuchBeanDefinitionException(parentBeanName,\n\t\t\t\t\t\t\t\t\t\t\"Parent name '\" + parentBeanName + \"' is equal to bean name '\" + beanName +\n\t\t\t\t\t\t\t\t\t\t\"': cannot be resolved without a ConfigurableBeanFactory parent\");\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcatch (NoSuchBeanDefinitionException ex) {\n\t\t\t\t\t\tthrow new BeanDefinitionStoreException(bd.getResourceDescription(), beanName,\n\t\t\t\t\t\t\t\t\"Could not resolve parent bean definition '\" + bd.getParentName() + \"'\", ex);\n\t\t\t\t\t}\n\t\t\t\t\t// Deep copy with overridden values.\n\t\t\t\t\tmbd = new RootBeanDefinition(pbd);\n\t\t\t\t\tmbd.overrideFrom(bd);\n\t\t\t\t}\n\n\t\t\t\t// Set default singleton scope, if not configured before.\n\t\t\t\tif (!StringUtils.hasLength(mbd.getScope())) {\n\t\t\t\t\tmbd.setScope(SCOPE_SINGLETON);\n\t\t\t\t}\n\n\t\t\t\t// A bean contained in a non-singleton bean cannot be a singleton itself.\n\t\t\t\t// Let's correct this on the fly here, since this might be the result of\n\t\t\t\t// parent-child merging for the outer bean, in which case the original inner bean\n\t\t\t\t// definition will not have inherited the merged outer bean's singleton status.\n\t\t\t\tif (containingBd != null &amp;&amp; !containingBd.isSingleton() &amp;&amp; mbd.isSingleton()) {\n\t\t\t\t\tmbd.setScope(containingBd.getScope());\n\t\t\t\t}\n\n\t\t\t\t// Cache the merged bean definition for the time being\n\t\t\t\t// (it might still get re-merged later on in order to pick up metadata changes)\n\t\t\t\tif (containingBd == null &amp;&amp; isCacheBeanMetadata()) {\n\t\t\t\t\tthis.mergedBeanDefinitions.put(beanName, mbd);\n\t\t\t\t}\n\t\t\t}\n\n\t\t\treturn mbd;\n\t\t}\n\t}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ClassUtilsä¸­è®¡ç®—classåŠå…¶çˆ¶ç±»çš„æ‰€æœ‰ç¬¦åˆçš„methodçš„ä¸ªæ•°\npublic static int getMethodCountForName(Class&lt;?&gt; clazz, String methodName) {\n\t\tAssert.notNull(clazz, \"Class must not be null\");\n\t\tAssert.notNull(methodName, \"Method name must not be null\");\n\t\tint count = 0;\n\t\tMethod[] declaredMethods = clazz.getDeclaredMethods();\n\t\tfor (Method method : declaredMethods) {\n\t\t\tif (methodName.equals(method.getName())) {\n\t\t\t\tcount++;\n\t\t\t}\n\t\t}\n\t\tClass&lt;?&gt;[] ifcs = clazz.getInterfaces();\n\t\tfor (Class&lt;?&gt; ifc : ifcs) {\n\t\t\tcount += getMethodCountForName(ifc, methodName);\n\t\t}\n\t\tif (clazz.getSuperclass() != null) {\n\t\t\tcount += getMethodCountForName(clazz.getSuperclass(), methodName);\n\t\t}\n\t\treturn count;\n\t}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class RootBeanDefinition extends AbstractBeanDefinition,BeanMetadataAttributeAccessor,AttributeAccessorSupport\n\timplements BeanDefinition,Cloneable,BeanMetadataElement,AttributeAccessor,Serializable{\n\t\n\t//RootBeanDefinition\n\tprivate BeanDefinitionHolder decoratedDefinition;\n\tprivate AnnotatedElement qualifiedElement;\n\tboolean allowCaching = true;\n\tboolean isFactoryMethodUnique = false;\n\tvolatile ResolvableType targetType;\n\tvolatile Class&lt;?&gt; resolvedTargetType;//åŒ…å¯è§çš„å­—æ®µï¼Œç”¨äºç¼“å­˜ç»™å®šbeanå®šä¹‰çš„ç¡®å®šç±»\n\tvolatile ResolvableType factoryMethodReturnType;//åŒ…å¯è§å­—æ®µï¼Œç”¨äºç¼“å­˜æ³›å‹å·¥å‚æ–¹æ³•çš„è¿”å›ç±»å‹\n\n\tfinal Object constructorArgumentLock = new Object();ä¸‹é¢å››ä¸ªæ„é€ å‡½æ•°å­—æ®µçš„å…¬å…±é”\n\tExecutable resolvedConstructorOrFactoryMethod;//åŒ…å¯è§å­—æ®µï¼Œç”¨äºç¼“å­˜å·²è§£æçš„æ„é€ å‡½æ•°æˆ–å·¥å‚æ–¹æ³•\n\tboolean constructorArgumentsResolved = false;//åŒ…å¯è§çš„å­—æ®µï¼Œå°†æ„é€ å‡½æ•°å‚æ•°æ ‡è®°ä¸ºå·²è§£æ\n\tObject[] resolvedConstructorArguments;//åŒ…å¯è§çš„å­—æ®µï¼Œç”¨äºç¼“å­˜å®Œå…¨è§£æçš„æ„é€ å‡½æ•°å‚æ•°\n\tObject[] preparedConstructorArguments;//åŒ…å¯è§çš„å­—æ®µï¼Œç”¨äºç¼“å­˜éƒ¨åˆ†å‡†å¤‡çš„æ„é€ å‡½æ•°å‚æ•°\n\n\tfinal Object postProcessingLock = new Object();//ä¸‹é¢ä¸¤ä¸ªåå¤„ç†å­—æ®µçš„é€šç”¨é”\n\tboolean postProcessed = false;//åŒ…å¯è§çš„å­—æ®µï¼ŒæŒ‡ç¤ºå·²ç»åº”ç”¨äº†MergedBeanDefinitionPostProcessor\n\tvolatile Boolean beforeInstantiationResolved;//åŒ…å¯è§å­—æ®µï¼ŒæŒ‡ç¤ºå®ä¾‹åŒ–å‰çš„åå¤„ç†ç¨‹åºå·²ç»å¯åŠ¨\n\n\tprivate Set&lt;Member&gt; externallyManagedConfigMembers;\n\tprivate Set&lt;String&gt; externallyManagedInitMethods;\n\tprivate Set&lt;String&gt; externallyManagedDestroyMethods;\n\n\t//AbstractBeanDefinition\n\tprivate String scope = SCOPE_DEFAULT;\n\tpublic static final String SCOPE_DEFAULT = \"\";//@Scopeç›¸å…³,é™¤éè¢«çˆ¶beanå®šä¹‰è¦†ç›–ï¼Œå¦åˆ™ç­‰åŒäºå•ä¾‹çŠ¶æ€\n\tpublic static final int AUTOWIRE_NO = AutowireCapableBeanFactory.AUTOWIRE_NO;//å¸¸æ•°ï¼Œè¡¨ç¤ºæ ¹æœ¬æ²¡æœ‰å¤–éƒ¨è‡ªåŠ¨è£…é…\n\tpublic static final int AUTOWIRE_BY_NAME = AutowireCapableBeanFactory.AUTOWIRE_BY_NAME;//å¸¸é‡ï¼ŒæŒ‰åç§°æŒ‡ç¤ºè‡ªåŠ¨è£…é…beanå±æ€§\n\tpublic static final int AUTOWIRE_BY_TYPE = AutowireCapableBeanFactory.AUTOWIRE_BY_TYPE;//æŒ‰ç±»å‹æŒ‡ç¤ºè‡ªåŠ¨è£…é…beanå±æ€§çš„å¸¸é‡\n\tpublic static final int AUTOWIRE_CONSTRUCTOR = AutowireCapableBeanFactory.AUTOWIRE_CONSTRUCTOR;//å¸¸é‡ï¼ŒæŒ‡ç¤ºè‡ªåŠ¨è£…é…æ„é€ å‡½æ•°\n\t@Deprecated\n\tpublic static final int AUTOWIRE_AUTODETECT = AutowireCapableBeanFactory.AUTOWIRE_AUTODETECT;//å¸¸é‡ï¼ŒæŒ‡ç¤ºé€šè¿‡beanç±»çš„å†…çœæ¥ç¡®å®šé€‚å½“çš„è‡ªåŠ¨è£…é…ç­–ç•¥\n\n\tpublic static final int DEPENDENCY_CHECK_NONE = 0;//è¡¨ç¤ºæ ¹æœ¬æ²¡æœ‰ä¾èµ–é¡¹æ£€æŸ¥çš„å¸¸é‡\n\tpublic static final int DEPENDENCY_CHECK_OBJECTS = 1;//å¸¸é‡ï¼ŒæŒ‡ç¤ºå¯¹å¯¹è±¡å¼•ç”¨è¿›è¡Œä¾èµ–é¡¹æ£€æŸ¥\n\tpublic static final int DEPENDENCY_CHECK_SIMPLE = 2;//å¸¸é‡ï¼ŒæŒ‡ç¤ºå¯¹â€œç®€å•â€å±æ€§çš„ä¾èµ–é¡¹æ£€æŸ¥\n\tpublic static final int DEPENDENCY_CHECK_ALL = 3;//å¸¸é‡ï¼ŒæŒ‡ç¤ºå¯¹æ‰€æœ‰å±æ€§è¿›è¡Œä¾èµ–é¡¹æ£€æŸ¥\n\tpublic static final String INFER_METHOD = \"(inferred)\";//å¸¸é‡ï¼ŒæŒ‡ç¤ºå®¹å™¨åº”è¯¥å°è¯•æ¨æ–­beançš„é”€æ¯æ–¹æ³•åï¼Œè€Œä¸æ˜¯æ˜¾å¼åœ°æŒ‡å®šæ–¹æ³•å \n\t//@Valueä¸“é—¨è®¾è®¡ä¸ºåœ¨æ–¹æ³•åä¸­åŒ…å«å¦åˆ™ä¸åˆæ³•çš„å­—ç¬¦ ç¡®ä¿ä¸å…·æœ‰ç›¸åŒåç§°çš„åˆæ³•å‘½åæ–¹æ³•ä¸å‘ç”Ÿå†²çª\n\n\n\tprivate volatile Object beanClass;\n\tprivate boolean abstractFlag = false;\n\tprivate boolean lazyInit = false;\n\tprivate int autowireMode = AUTOWIRE_NO;\n\tprivate int dependencyCheck = DEPENDENCY_CHECK_NONE;\n\tprivate String[] dependsOn;\n\n\tprivate boolean autowireCandidate = true;//æ˜¯å¦è¢«è®¤ä¸ºæ˜¯è‡ªåŠ¨ç±»å‹è£…é…ï¼Œä¸å½±å“åå­—è£…é…\n\tprivate boolean primary = false;//ä¼˜å…ˆè¢«ä¾èµ–çš„ç±»@primary/primaryæ ‡ç­¾\n\tprivate final Map&lt;String, AutowireCandidateQualifier&gt; qualifiers = new LinkedHashMap&lt;&gt;();\n\tprivate Supplier&lt;?&gt; instanceSupplier;\n\tprivate boolean nonPublicAccessAllowed = true;\n\tprivate boolean lenientConstructorResolution = true;//ä½¿å¤šä¸ªæ„é€ å‡½æ•°çš„å‚æ•°æ•°é‡ç›¸åŒã€ç±»å‹å­˜åœ¨çˆ¶å­ç±»ã€æ¥å£å®ç°ç±»å…³ç³»ä¹Ÿèƒ½æ­£å¸¸åˆ›å»ºbean\n\n\tprivate String factoryBeanName;\n\tprivate String factoryMethodName;\n\n\tprivate ConstructorArgumentValues constructorArgumentValues;\n\tprivate MutablePropertyValues propertyValues;\n\tprivate MethodOverrides methodOverrides = new MethodOverrides();//@lookup/&lt;lookup-method&gt;\n\n\tprivate String initMethodName;//&lt;init-method&gt;/@PostConstruct(javaè‡ªå·±çš„æ³¨è§£)\n\tprivate String destroyMethodName;//&lt;destroy-method&gt;/@PreDestroy(javaè‡ªå·±çš„æ³¨è§£)\n\tprivate boolean enforceInitMethod = true;//æ˜¯å¦æ‰§è¡Œinit-methodï¼Œç¨‹åºè®¾ç½®\n\tprivate boolean enforceDestroyMethod = true;//æ˜¯å¦æ‰§è¡Œdestroy-methodï¼Œç¨‹åºè®¾ç½®\n\t\n\tprivate boolean synthetic = false;//éåº”ç”¨è‡ªå·±å®šä¹‰çš„ï¼Œç±»ä¼¼Aopäº§ç”Ÿçš„å¯¹è±¡\n\n\tprivate int role = BeanDefinition.ROLE_APPLICATION;\n\t//BeanDefinition\n\tint ROLE_APPLICATION = 0;//ç”¨æˆ·å®šä¹‰çš„bean\n\tint ROLE_SUPPORT = 1;//æŒ‡ç¤ºBeanDefinitionæ˜¯æŸä¸ªè¾ƒå¤§é…ç½®(é€šå¸¸æ˜¯å¤–éƒ¨ç»„ä»¶å®šä¹‰)çš„æ”¯æŒéƒ¨åˆ†ã€‚\n\tint ROLE_INFRASTRUCTURE = 2;//å†…éƒ¨æ³¨å†Œçš„beanç±»ä¼¼internalConfigurationAnnotationProcessor\n\t//</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æºç "
      ]
    },
    {
      "title": "Quartz",
      "url": "https://javaguide.cn/backend/jobscheduling/quartz.html",
      "id": "https://javaguide.cn/backend/jobscheduling/quartz.html",
      "summary": "quartzæ˜¯ç”¨äºæ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„æ¡†æ¶ 1. Quartzçš„ä»‹ç» Quartzæ˜¯OpenSymphonyå¼€æºç»„ç»‡åœ¨Job schedulingé¢†åŸŸåˆä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒå¯ä»¥ä¸J2EEä¸J2SEåº”ç”¨ç¨‹åºç›¸ç»“åˆä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚ Quartzå¯ä»¥ç”¨æ¥åˆ›å»ºç®€å•æˆ–ä¸ºè¿è¡Œåä¸ªï¼Œç™¾ä¸ªï¼Œç”šè‡³æ˜¯å¥½å‡ ä¸‡ä¸ªJobsè¿™æ ·å¤æ‚çš„ç¨‹åºã€‚Jobså¯ä»¥åšæˆæ ‡å‡†çš„Javaç»„ä»¶æˆ– EJBsã€‚ ...",
      "content_html": "<p>quartzæ˜¯ç”¨äºæ‰§è¡Œå®šæ—¶ä»»åŠ¡çš„æ¡†æ¶</p>\n<!--more-->\n<h1>1. Quartzçš„ä»‹ç»</h1>\n<p>Quartzæ˜¯OpenSymphonyå¼€æºç»„ç»‡åœ¨Job schedulingé¢†åŸŸåˆä¸€ä¸ªå¼€æºé¡¹ç›®ï¼Œå®ƒå¯ä»¥ä¸J2EEä¸J2SEåº”ç”¨ç¨‹åºç›¸ç»“åˆä¹Ÿå¯ä»¥å•ç‹¬ä½¿ç”¨ã€‚<br>\nQuartzå¯ä»¥ç”¨æ¥åˆ›å»ºç®€å•æˆ–ä¸ºè¿è¡Œåä¸ªï¼Œç™¾ä¸ªï¼Œç”šè‡³æ˜¯å¥½å‡ ä¸‡ä¸ªJobsè¿™æ ·å¤æ‚çš„ç¨‹åºã€‚Jobså¯ä»¥åšæˆæ ‡å‡†çš„Javaç»„ä»¶æˆ– EJBsã€‚</p>\n<h1>2. Quartzçš„ä½¿ç”¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åˆ›å»ºmavenå·¥ç¨‹ï¼Œå¯¼å…¥springå’Œquartzç›¸å…³ä¾èµ–\n&lt;!-- å¼•å…¥quartzå¯¹åº”çš„ä¾èµ– --&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt;\n\t&lt;artifactId&gt;quartz&lt;/artifactId&gt;\n\t&lt;version&gt;2.2.3&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.quartz-scheduler&lt;/groupId&gt;\n\t&lt;artifactId&gt;quartz-jobs&lt;/artifactId&gt;\n\t&lt;version&gt;2.2.3&lt;/version&gt;\n&lt;/dependency&gt;\n\nåˆ›å»ºä»»åŠ¡ç±»\npublic class MyJob {\n\tpublic void run() {\n\t\tSystem.out.println(\"è‡ªå®šä¹‰çš„ä½œä¸šç±»æ‰§è¡Œäº†ï¼š\" + \n\t\t\t\tnew SimpleDateFormat(\"yyyy-MM-dd HH:mm:ss\").format(new Date()));\n\t}\n}\n\nåœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®ä»»åŠ¡ç±»\n&lt;!-- æ³¨å†Œè‡ªå®šä¹‰ä½œä¸šç±» --&gt;\n&lt;bean id=\"myJob\" class=\"com.itheima.quartz.MyJob\"&gt;&lt;/bean&gt;\n\nåœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®JobDetail\n&lt;!-- é…ç½®JobDetail --&gt;\n&lt;bean id=\"jobDetail\" class=\"org.springframework.scheduling.quartz.MethodInvokingJobDetailFactoryBean\"&gt;\n\t&lt;!-- æ³¨å…¥ç›®æ ‡å¯¹è±¡ --&gt;\n\t&lt;property name=\"targetObject\" ref=\"myJob\"/&gt;\n\t&lt;!-- æ³¨å…¥ç›®æ ‡æ–¹æ³• --&gt;\n\t&lt;property name=\"targetMethod\" value=\"run\"/&gt;\n&lt;/bean&gt;\n\nåœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®è§¦å‘å™¨\n&lt;!-- é…ç½®è§¦å‘å™¨ --&gt;\n&lt;bean id=\"myTrigger\" class=\"org.springframework.scheduling.quartz.CronTriggerFactoryBean\"&gt;\n\t&lt;!-- æ³¨å…¥ä»»åŠ¡è¯¦æƒ…å¯¹è±¡ --&gt;\n\t&lt;property name=\"jobDetail\" ref=\"jobDetail\"/&gt;\n\t&lt;!-- æ³¨å…¥cronè¡¨è¾¾å¼ï¼Œé€šè¿‡è¿™ä¸ªè¡¨è¾¾å¼æŒ‡å®šè§¦å‘çš„æ—¶é—´ç‚¹ --&gt;\n\t&lt;property name=\"cronExpression\"&gt;\n\t\t&lt;value&gt;0/2 * * * * ? 2017-2099&lt;/value&gt;\n\t&lt;/property&gt;\n&lt;/bean&gt;\n\nåœ¨springé…ç½®æ–‡ä»¶ä¸­é…ç½®scheduler\n&lt;!-- é…ç½®è°ƒåº¦å·¥å‚ --&gt;\n&lt;bean id=\"schedulerFactoryBean\" class=\"org.springframework.scheduling.quartz.SchedulerFactoryBean\"&gt;\n\t&lt;!-- æ³¨å…¥è§¦å‘å™¨ --&gt;\n\t&lt;property name=\"triggers\"&gt;\n\t\t&lt;list&gt;\n\t\t\t&lt;ref bean=\"myTrigger\"/&gt;\n\t\t&lt;/list&gt;\n\t&lt;/property&gt;\n&lt;/bean&gt;\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "ActiveMQ",
      "url": "https://javaguide.cn/backend/mq/activemq.html",
      "id": "https://javaguide.cn/backend/mq/activemq.html",
      "summary": "[toc] 1. ActiveMQä»‹ç» ActiveMQ æ˜¯Apacheå‡ºå“ï¼Œæœ€æµè¡Œçš„ï¼Œèƒ½åŠ›å¼ºåŠ²çš„å¼€æºæ¶ˆæ¯æ€»çº¿ã€‚ ä¸»è¦ç‰¹ç‚¹ï¼š å¤šç§è¯­è¨€å’Œåè®®ç¼–å†™å®¢æˆ·ç«¯ã€‚åº”ç”¨åè®®: OpenWire,Stomp REST,WS Notification,XMPP,AMQP å®Œå…¨æ”¯æŒJMS1.1å’ŒJ2EE 1.4è§„èŒƒ (æŒä¹…åŒ–,XAæ¶ˆæ¯,äº‹åŠ¡) é€šè¿‡äº†å¸¸è§J2EEæœåŠ¡å™¨(...",
      "content_html": "<!--more-->\n<p>[toc]</p>\n<h1>1. ActiveMQä»‹ç»</h1>\n<ul>\n<li>ActiveMQ æ˜¯Apacheå‡ºå“ï¼Œæœ€æµè¡Œçš„ï¼Œèƒ½åŠ›å¼ºåŠ²çš„å¼€æºæ¶ˆæ¯æ€»çº¿ã€‚</li>\n<li>ä¸»è¦ç‰¹ç‚¹ï¼š\n<ul>\n<li>å¤šç§è¯­è¨€å’Œåè®®ç¼–å†™å®¢æˆ·ç«¯ã€‚åº”ç”¨åè®®: OpenWire,Stomp REST,WS Notification,XMPP,AMQP</li>\n<li>å®Œå…¨æ”¯æŒJMS1.1å’ŒJ2EE 1.4è§„èŒƒ (æŒä¹…åŒ–,XAæ¶ˆæ¯,äº‹åŠ¡)</li>\n<li>é€šè¿‡äº†å¸¸è§J2EEæœåŠ¡å™¨(å¦‚ Geronimo,JBoss 4, GlassFish,WebLogic)çš„æµ‹è¯•,å…¶ä¸­é€šè¿‡JCA 1.5 resource adaptorsçš„é…ç½®,å¯ä»¥è®©ActiveMQå¯ä»¥è‡ªåŠ¨çš„éƒ¨ç½²åˆ°ä»»ä½•å…¼å®¹J2EE 1.4 å•†ä¸šæœåŠ¡å™¨ä¸Š</li>\n<li>æ”¯æŒå¤šç§ä¼ é€åè®®:in-VM,TCP,SSL,NIO,UDP,JGroups,JXTA</li>\n<li>æ”¯æŒé€šè¿‡JDBCå’Œjournalæä¾›é«˜é€Ÿçš„æ¶ˆæ¯æŒä¹…åŒ–</li>\n<li>ä»è®¾è®¡ä¸Šä¿è¯äº†é«˜æ€§èƒ½çš„é›†ç¾¤,å®¢æˆ·ç«¯-æœåŠ¡å™¨,ç‚¹å¯¹ç‚¹</li>\n<li>æ”¯æŒAjax</li>\n<li>æ”¯æŒä¸Axisçš„æ•´åˆ</li>\n<li>å¯ä»¥å¾ˆå®¹æ˜“å¾—è°ƒç”¨å†…åµŒJMS provider,è¿›è¡Œæµ‹è¯•</li>\n</ul>\n</li>\n</ul>\n<h1>2. ActiveMQçš„æ¶ˆæ¯å½¢å¼</h1>\n<ul>\n<li>ç‚¹å¯¹ç‚¹çš„ï¼Œå³ä¸€ä¸ªç”Ÿäº§è€…å’Œä¸€ä¸ªæ¶ˆè´¹è€…ä¸€ä¸€å¯¹åº”ï¼›</li>\n<li>å‘å¸ƒ/è®¢é˜…æ¨¡å¼ï¼Œå³ä¸€ä¸ªç”Ÿäº§è€…äº§ç”Ÿæ¶ˆæ¯å¹¶è¿›è¡Œå‘é€åï¼Œå¯ä»¥ç”±å¤šä¸ªæ¶ˆè´¹è€…è¿›è¡Œæ¥æ”¶ã€‚</li>\n<li>JMSå®šä¹‰äº†äº”ç§ä¸åŒçš„æ¶ˆæ¯æ­£æ–‡æ ¼å¼ï¼Œä»¥åŠè°ƒç”¨çš„æ¶ˆæ¯ç±»å‹ï¼Œå…è®¸ä½ å‘é€å¹¶æ¥æ”¶ä»¥ä¸€äº›ä¸åŒå½¢å¼çš„æ•°æ®ï¼Œæä¾›ç°æœ‰æ¶ˆæ¯æ ¼å¼çš„ä¸€äº›çº§åˆ«çš„å…¼å®¹æ€§ã€‚\n<ul>\n<li>StreamMessage -- JavaåŸå§‹å€¼çš„æ•°æ®æµ</li>\n<li>MapMessage--ä¸€å¥—åç§°-å€¼å¯¹</li>\n<li>TextMessage--ä¸€ä¸ªå­—ç¬¦ä¸²å¯¹è±¡</li>\n<li>ObjectMessage--ä¸€ä¸ªåºåˆ—åŒ–çš„ Javaå¯¹è±¡</li>\n<li>BytesMessage--ä¸€ä¸ªå­—èŠ‚çš„æ•°æ®æµ</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/92a0cb632b97d682ef936.png\" alt=\"å›¾ç‰‡1.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡1.png</figcaption></figure>\n<h1>3. ActiveMQä½¿ç”¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä½¿ç”¨binç›®å½•ä¸‹çš„activemqå‘½ä»¤å¯åŠ¨ï¼š./activemq start \nå…³é—­ï¼š./activemq stop\næŸ¥çœ‹çŠ¶æ€ï¼š./activemq status\næ³¨æ„ï¼šå¦‚æœActiveMQæ•´åˆspringä½¿ç”¨ä¸è¦ä½¿ç”¨activemq-all-5.12.0.jaråŒ…ã€‚å»ºè®®ä½¿ç”¨5.11.2\nè¿›å…¥ç®¡ç†åå°ï¼šhttp://192.168.25.168:8161/adminç”¨æˆ·åï¼šadminå¯†ç ï¼šadmin\n</code></pre></div><div class=\"language-java\" data-ext=\"java\" data-title=\"java\"><pre class=\"language-java\"><code><span class=\"token class-name\">Queue</span>\n\t<span class=\"token class-name\">Producer</span>\n\tç”Ÿäº§è€…ï¼šç”Ÿäº§æ¶ˆæ¯ï¼Œå‘é€ç«¯ã€‚\n\tæŠŠjaråŒ…æ·»åŠ åˆ°å·¥ç¨‹ä¸­ã€‚ä½¿ç”¨<span class=\"token number\">5.11</span><span class=\"token number\">.2</span>ç‰ˆæœ¬çš„jaråŒ…ã€‚\n\n\tç¬¬ä¸€æ­¥ï¼šåˆ›å»º<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡ç«¯ipåŠç«¯å£å·ã€‚\n\tç¬¬äºŒæ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Connection</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ï¼Œè°ƒç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡çš„startæ–¹æ³•ã€‚\n\tç¬¬å››æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Session</span>å¯¹è±¡ã€‚\n\tç¬¬äº”æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Destination</span>å¯¹è±¡ï¼ˆtopicã€queueï¼‰ï¼Œæ­¤å¤„åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Queue</span>å¯¹è±¡ã€‚\n\tç¬¬å…­æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Producer</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Message</span>å¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">TextMessage</span>å¯¹è±¡ã€‚\n\tç¬¬å…«æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Producer</span>å¯¹è±¡å‘é€æ¶ˆæ¯ã€‚\n\tç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æºã€‚\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testQueueProducer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºConnectionFactoryå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡ç«¯ipåŠç«¯å£å·ã€‚</span>\n\t\t<span class=\"token comment\">//brokerURLæœåŠ¡å™¨çš„ipåŠç«¯å£å·</span>\n\t\t<span class=\"token class-name\">ConnectionFactory</span> connectionFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ActiveMQConnectionFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp://192.168.25.168:61616\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ConnectionFactoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªConnectionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">Connection</span> connection <span class=\"token operator\">=</span> connectionFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ï¼Œè°ƒç”¨Connectionå¯¹è±¡çš„startæ–¹æ³•ã€‚</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å››æ­¥ï¼šä½¿ç”¨Connectionå¯¹è±¡åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token comment\">//ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯å¦å¼€å¯äº‹åŠ¡ã€‚trueï¼šå¼€å¯äº‹åŠ¡ï¼Œç¬¬äºŒä¸ªå‚æ•°å¿½ç•¥ã€‚</span>\n\t\t<span class=\"token comment\">//ç¬¬äºŒä¸ªå‚æ•°ï¼šå½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalseæ—¶ï¼Œæ‰æœ‰æ„ä¹‰ã€‚æ¶ˆæ¯çš„åº”ç­”æ¨¡å¼ã€‚1ã€è‡ªåŠ¨åº”ç­”2ã€æ‰‹åŠ¨åº”ç­”ã€‚ä¸€èˆ¬æ˜¯è‡ªåŠ¨åº”ç­”ã€‚</span>\n\t\t<span class=\"token class-name\">Session</span> session <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createSession</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Session</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO_ACKNOWLEDGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äº”æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªDestinationå¯¹è±¡ï¼ˆtopicã€queueï¼‰ï¼Œæ­¤å¤„åˆ›å»ºä¸€ä¸ªQueueå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token comment\">//å‚æ•°ï¼šé˜Ÿåˆ—çš„åç§°ã€‚</span>\n\t\t<span class=\"token class-name\">Queue</span> queue <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createQueue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test-queue\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å…­æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªProducerå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">MessageProducer</span> producer <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createProducer</span><span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªMessageå¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ªTextMessageå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token comment\">/*TextMessage message = new ActiveMQTextMessage();\n\t\tmessage.setText(\"hello activeMq,this is my first test.\");*/</span>\n\t\t<span class=\"token class-name\">TextMessage</span> textMessage <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createTextMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello activeMq,this is my first test.\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å…«æ­¥ï¼šä½¿ç”¨Producerå¯¹è±¡å‘é€æ¶ˆæ¯ã€‚</span>\n\t\tproducer<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>textMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æºã€‚</span>\n\t\tproducer<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tsession<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token class-name\">Consumer</span>\n\tæ¶ˆè´¹è€…ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚\n\tç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡ã€‚\n\tç¬¬äºŒæ­¥ï¼šä»<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡ä¸­è·å¾—ä¸€ä¸ª<span class=\"token class-name\">Connection</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ã€‚è°ƒç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡çš„startæ–¹æ³•ã€‚\n\tç¬¬å››æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Session</span>å¯¹è±¡ã€‚\n\tç¬¬äº”æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Destination</span>å¯¹è±¡ã€‚å’Œå‘é€ç«¯ä¿æŒä¸€è‡´queueï¼Œå¹¶ä¸”é˜Ÿåˆ—çš„åç§°ä¸€è‡´ã€‚\n\tç¬¬å…­æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Consumer</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸ƒæ­¥ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚\n\tç¬¬å…«æ­¥ï¼šæ‰“å°æ¶ˆæ¯ã€‚\n\tç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æº\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testQueueConsumer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªConnectionFactoryå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">ConnectionFactory</span> connectionFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ActiveMQConnectionFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp://192.168.25.168:61616\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äºŒæ­¥ï¼šä»ConnectionFactoryå¯¹è±¡ä¸­è·å¾—ä¸€ä¸ªConnectionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">Connection</span> connection <span class=\"token operator\">=</span> connectionFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ã€‚è°ƒç”¨Connectionå¯¹è±¡çš„startæ–¹æ³•ã€‚</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å››æ­¥ï¼šä½¿ç”¨Connectionå¯¹è±¡åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">Session</span> session <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createSession</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Session</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO_ACKNOWLEDGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äº”æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªDestinationå¯¹è±¡ã€‚å’Œå‘é€ç«¯ä¿æŒä¸€è‡´queueï¼Œå¹¶ä¸”é˜Ÿåˆ—çš„åç§°ä¸€è‡´ã€‚</span>\n\t\t<span class=\"token class-name\">Queue</span> queue <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createQueue</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test-queue\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å…­æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªConsumerå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">MessageConsumer</span> consumer <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createConsumer</span><span class=\"token punctuation\">(</span>queue<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸ƒæ­¥ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚</span>\n\t\tconsumer<span class=\"token punctuation\">.</span><span class=\"token function\">setMessageListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MessageListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\n\t\t\t<span class=\"token annotation punctuation\">@Override</span>\n\t\t\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onMessage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Message</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token class-name\">TextMessage</span> textMessage <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">TextMessage</span><span class=\"token punctuation\">)</span> message<span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token comment\">//å–æ¶ˆæ¯çš„å†…å®¹</span>\n\t\t\t\t\ttext <span class=\"token operator\">=</span> textMessage<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token comment\">// ç¬¬å…«æ­¥ï¼šæ‰“å°æ¶ˆæ¯ã€‚</span>\n\t\t\t\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JMSException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\te<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">//ç­‰å¾…é”®ç›˜è¾“å…¥</span>\n\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æº</span>\n\t\tconsumer<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tsession<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n</code></pre></div><div class=\"language-java\" data-ext=\"java\" data-title=\"java\"><pre class=\"language-java\"><code><span class=\"token class-name\">Topic</span>\n\t<span class=\"token class-name\">Producer</span>\n\tä½¿ç”¨æ­¥éª¤ï¼š\n\tç¬¬ä¸€æ­¥ï¼šåˆ›å»º<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡ç«¯ipåŠç«¯å£å·ã€‚\n\tç¬¬äºŒæ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Connection</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ï¼Œè°ƒç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡çš„startæ–¹æ³•ã€‚\n\tç¬¬å››æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Session</span>å¯¹è±¡ã€‚\n\tç¬¬äº”æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Destination</span>å¯¹è±¡ï¼ˆtopicã€queueï¼‰ï¼Œæ­¤å¤„åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Topic</span>å¯¹è±¡ã€‚\n\tç¬¬å…­æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Producer</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Message</span>å¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">TextMessage</span>å¯¹è±¡ã€‚\n\tç¬¬å…«æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Producer</span>å¯¹è±¡å‘é€æ¶ˆæ¯ã€‚\n\tç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æºã€‚\n\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testTopicProducer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºConnectionFactoryå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šæœåŠ¡ç«¯ipåŠç«¯å£å·ã€‚</span>\n\t\t<span class=\"token comment\">// brokerURLæœåŠ¡å™¨çš„ipåŠç«¯å£å·</span>\n\t\t<span class=\"token class-name\">ConnectionFactory</span> connectionFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ActiveMQConnectionFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp://192.168.25.168:61616\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äºŒæ­¥ï¼šä½¿ç”¨ConnectionFactoryå¯¹è±¡åˆ›å»ºä¸€ä¸ªConnectionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">Connection</span> connection <span class=\"token operator\">=</span> connectionFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ï¼Œè°ƒç”¨Connectionå¯¹è±¡çš„startæ–¹æ³•ã€‚</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å››æ­¥ï¼šä½¿ç”¨Connectionå¯¹è±¡åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸€ä¸ªå‚æ•°ï¼šæ˜¯å¦å¼€å¯äº‹åŠ¡ã€‚trueï¼šå¼€å¯äº‹åŠ¡ï¼Œç¬¬äºŒä¸ªå‚æ•°å¿½ç•¥ã€‚</span>\n\t\t<span class=\"token comment\">// ç¬¬äºŒä¸ªå‚æ•°ï¼šå½“ç¬¬ä¸€ä¸ªå‚æ•°ä¸ºfalseæ—¶ï¼Œæ‰æœ‰æ„ä¹‰ã€‚æ¶ˆæ¯çš„åº”ç­”æ¨¡å¼ã€‚1ã€è‡ªåŠ¨åº”ç­”2ã€æ‰‹åŠ¨åº”ç­”ã€‚ä¸€èˆ¬æ˜¯è‡ªåŠ¨åº”ç­”ã€‚</span>\n\t\t<span class=\"token class-name\">Session</span> session <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createSession</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Session</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO_ACKNOWLEDGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äº”æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªDestinationå¯¹è±¡ï¼ˆtopicã€queueï¼‰ï¼Œæ­¤å¤„åˆ›å»ºä¸€ä¸ªtopicå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token comment\">// å‚æ•°ï¼šè¯é¢˜çš„åç§°ã€‚</span>\n\t\t<span class=\"token class-name\">Topic</span> topic <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createTopic</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test-topic\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å…­æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªProducerå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">MessageProducer</span> producer <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createProducer</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸ƒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªMessageå¯¹è±¡ï¼Œåˆ›å»ºä¸€ä¸ªTextMessageå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token comment\">/*\n\t\t* TextMessage message = new ActiveMQTextMessage(); message.setText(\n\t\t* \"hello activeMq,this is my first test.\");\n\t\t*/</span>\n\t\t<span class=\"token class-name\">TextMessage</span> textMessage <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createTextMessage</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"hello activeMq,this is my topic test\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å…«æ­¥ï¼šä½¿ç”¨Producerå¯¹è±¡å‘é€æ¶ˆæ¯ã€‚</span>\n\t\tproducer<span class=\"token punctuation\">.</span><span class=\"token function\">send</span><span class=\"token punctuation\">(</span>textMessage<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æºã€‚</span>\n\t\tproducer<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tsession<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n\n\t<span class=\"token class-name\">Consumer</span>\n\tæ¶ˆè´¹è€…ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚\n\tç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡ã€‚\n\tç¬¬äºŒæ­¥ï¼šä»<span class=\"token class-name\">ConnectionFactory</span>å¯¹è±¡ä¸­è·å¾—ä¸€ä¸ª<span class=\"token class-name\">Connection</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ã€‚è°ƒç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡çš„startæ–¹æ³•ã€‚\n\tç¬¬å››æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Connection</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Session</span>å¯¹è±¡ã€‚\n\tç¬¬äº”æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Destination</span>å¯¹è±¡ã€‚å’Œå‘é€ç«¯ä¿æŒä¸€è‡´topicï¼Œå¹¶ä¸”è¯é¢˜çš„åç§°ä¸€è‡´ã€‚\n\tç¬¬å…­æ­¥ï¼šä½¿ç”¨<span class=\"token class-name\">Session</span>å¯¹è±¡åˆ›å»ºä¸€ä¸ª<span class=\"token class-name\">Consumer</span>å¯¹è±¡ã€‚\n\tç¬¬ä¸ƒæ­¥ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚\n\tç¬¬å…«æ­¥ï¼šæ‰“å°æ¶ˆæ¯ã€‚\n\tç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æº\n\t<span class=\"token annotation punctuation\">@Test</span>\n\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">testTopicConsumer</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token keyword\">throws</span> <span class=\"token class-name\">Exception</span> <span class=\"token punctuation\">{</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªConnectionFactoryå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">ConnectionFactory</span> connectionFactory <span class=\"token operator\">=</span> <span class=\"token keyword\">new</span> <span class=\"token class-name\">ActiveMQConnectionFactory</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"tcp://192.168.25.168:61616\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äºŒæ­¥ï¼šä»ConnectionFactoryå¯¹è±¡ä¸­è·å¾—ä¸€ä¸ªConnectionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">Connection</span> connection <span class=\"token operator\">=</span> connectionFactory<span class=\"token punctuation\">.</span><span class=\"token function\">createConnection</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸‰æ­¥ï¼šå¼€å¯è¿æ¥ã€‚è°ƒç”¨Connectionå¯¹è±¡çš„startæ–¹æ³•ã€‚</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">start</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å››æ­¥ï¼šä½¿ç”¨Connectionå¯¹è±¡åˆ›å»ºä¸€ä¸ªSessionå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">Session</span> session <span class=\"token operator\">=</span> connection<span class=\"token punctuation\">.</span><span class=\"token function\">createSession</span><span class=\"token punctuation\">(</span><span class=\"token boolean\">false</span><span class=\"token punctuation\">,</span> <span class=\"token class-name\">Session</span><span class=\"token punctuation\">.</span><span class=\"token constant\">AUTO_ACKNOWLEDGE</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬äº”æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªDestinationå¯¹è±¡ã€‚å’Œå‘é€ç«¯ä¿æŒä¸€è‡´topicï¼Œå¹¶ä¸”è¯é¢˜çš„åç§°ä¸€è‡´ã€‚</span>\n\t\t<span class=\"token class-name\">Topic</span> topic <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createTopic</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"test-topic\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬å…­æ­¥ï¼šä½¿ç”¨Sessionå¯¹è±¡åˆ›å»ºä¸€ä¸ªConsumerå¯¹è±¡ã€‚</span>\n\t\t<span class=\"token class-name\">MessageConsumer</span> consumer <span class=\"token operator\">=</span> session<span class=\"token punctuation\">.</span><span class=\"token function\">createConsumer</span><span class=\"token punctuation\">(</span>topic<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¸ƒæ­¥ï¼šæ¥æ”¶æ¶ˆæ¯ã€‚</span>\n\t\tconsumer<span class=\"token punctuation\">.</span><span class=\"token function\">setMessageListener</span><span class=\"token punctuation\">(</span><span class=\"token keyword\">new</span> <span class=\"token class-name\">MessageListener</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\n\t\t\t<span class=\"token annotation punctuation\">@Override</span>\n\t\t\t<span class=\"token keyword\">public</span> <span class=\"token keyword\">void</span> <span class=\"token function\">onMessage</span><span class=\"token punctuation\">(</span><span class=\"token class-name\">Message</span> message<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t<span class=\"token keyword\">try</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\t<span class=\"token class-name\">TextMessage</span> textMessage <span class=\"token operator\">=</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">TextMessage</span><span class=\"token punctuation\">)</span> message<span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token class-name\">String</span> text <span class=\"token operator\">=</span> <span class=\"token keyword\">null</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token comment\">// å–æ¶ˆæ¯çš„å†…å®¹</span>\n\t\t\t\t\ttext <span class=\"token operator\">=</span> textMessage<span class=\"token punctuation\">.</span><span class=\"token function\">getText</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t\t<span class=\"token comment\">// ç¬¬å…«æ­¥ï¼šæ‰“å°æ¶ˆæ¯ã€‚</span>\n\t\t\t\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span>text<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span> <span class=\"token keyword\">catch</span> <span class=\"token punctuation\">(</span><span class=\"token class-name\">JMSException</span> e<span class=\"token punctuation\">)</span> <span class=\"token punctuation\">{</span>\n\t\t\t\t\te<span class=\"token punctuation\">.</span><span class=\"token function\">printStackTrace</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t\t\t<span class=\"token punctuation\">}</span>\n\t\t\t<span class=\"token punctuation\">}</span>\n\t\t<span class=\"token punctuation\">}</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>out<span class=\"token punctuation\">.</span><span class=\"token function\">println</span><span class=\"token punctuation\">(</span><span class=\"token string\">\"topicçš„æ¶ˆè´¹ç«¯03ã€‚ã€‚ã€‚ã€‚ã€‚\"</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç­‰å¾…é”®ç›˜è¾“å…¥</span>\n\t\t<span class=\"token class-name\">System</span><span class=\"token punctuation\">.</span>in<span class=\"token punctuation\">.</span><span class=\"token function\">read</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\t<span class=\"token comment\">// ç¬¬ä¹æ­¥ï¼šå…³é—­èµ„æº</span>\n\t\tconsumer<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tsession<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t\tconnection<span class=\"token punctuation\">.</span><span class=\"token function\">close</span><span class=\"token punctuation\">(</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n\t<span class=\"token punctuation\">}</span>\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/92a0cb632b97d682ef936.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "RabbitMQ",
      "url": "https://javaguide.cn/backend/mq/rabbitmq.html",
      "id": "https://javaguide.cn/backend/mq/rabbitmq.html",
      "summary": "RabbitMQæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ RabbitMQ æ˜¯ä¸€ä¸ªç”± Erlang è¯­è¨€å¼€å‘çš„ AMQP çš„å¼€æºå®ç°ã€‚ å¯é æ€§ï¼ˆReliabilityï¼‰ çµæ´»çš„è·¯ç”±ï¼ˆFlexible Routingï¼‰ï¼šåœ¨æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—ä¹‹å‰ï¼Œé€šè¿‡ Exchange æ¥è·¯ç”±æ¶ˆæ¯çš„ã€‚å¯¹äºå…¸å‹çš„è·¯ç”±åŠŸèƒ½ï¼ŒRabbitMQ å·²ç»æä¾›äº†ä¸€äº›å†…ç½®çš„ Exchange æ¥å®ç°ã€‚é’ˆå¯¹æ›´å¤æ‚çš„...",
      "content_html": "<!--more-->\n<h2>RabbitMQæ˜¯ä»€ä¹ˆï¼Ÿæœ‰ä»€ä¹ˆç‰¹ç‚¹ï¼Ÿ</h2>\n<ul>\n<li>RabbitMQ æ˜¯ä¸€ä¸ªç”± Erlang è¯­è¨€å¼€å‘çš„ AMQP çš„å¼€æºå®ç°ã€‚</li>\n<li>å¯é æ€§ï¼ˆReliabilityï¼‰</li>\n<li>çµæ´»çš„è·¯ç”±ï¼ˆFlexible Routingï¼‰ï¼šåœ¨æ¶ˆæ¯è¿›å…¥é˜Ÿåˆ—ä¹‹å‰ï¼Œé€šè¿‡ Exchange æ¥è·¯ç”±æ¶ˆæ¯çš„ã€‚å¯¹äºå…¸å‹çš„è·¯ç”±åŠŸèƒ½ï¼ŒRabbitMQ å·²ç»æä¾›äº†ä¸€äº›å†…ç½®çš„ Exchange æ¥å®ç°ã€‚é’ˆå¯¹æ›´å¤æ‚çš„è·¯ç”±åŠŸèƒ½ï¼Œå¯ä»¥å°†å¤šä¸ª Exchange ç»‘å®šåœ¨ä¸€èµ·ï¼Œä¹Ÿé€šè¿‡æ’ä»¶æœºåˆ¶å®ç°è‡ªå·±çš„ Exchange ã€‚</li>\n<li>æ¶ˆæ¯é›†ç¾¤ï¼ˆClusteringï¼‰å¤šä¸ª RabbitMQ æœåŠ¡å™¨å¯ä»¥ç»„æˆä¸€ä¸ªé›†ç¾¤ï¼Œå½¢æˆä¸€ä¸ªé€»è¾‘ Broker ã€‚</li>\n<li>é«˜å¯ç”¨ï¼ˆHighly Available Queuesï¼‰ï¼šé˜Ÿåˆ—å¯ä»¥åœ¨é›†ç¾¤ä¸­çš„æœºå™¨ä¸Šè¿›è¡Œé•œåƒï¼Œä½¿å¾—åœ¨éƒ¨åˆ†èŠ‚ç‚¹å‡ºé—®é¢˜çš„æƒ…å†µä¸‹é˜Ÿåˆ—ä»ç„¶å¯ç”¨ã€‚</li>\n<li>å¤šç§åè®®ï¼ˆMulti-protocolï¼‰RabbitMQ æ”¯æŒå¤šç§æ¶ˆæ¯é˜Ÿåˆ—åè®®ï¼Œæ¯”å¦‚ STOMPã€MQTT ç­‰ç­‰ã€‚</li>\n<li>å¤šè¯­è¨€å®¢æˆ·ç«¯ï¼ˆMany Clientsï¼‰RabbitMQ å‡ ä¹æ”¯æŒæ‰€æœ‰å¸¸ç”¨è¯­è¨€ï¼Œæ¯”å¦‚ Javaã€.NETã€Ruby ç­‰ç­‰</li>\n<li>ç®¡ç†ç•Œé¢ï¼ˆManagement UIï¼‰RabbitMQ æä¾›äº†ä¸€ä¸ªæ˜“ç”¨çš„ç”¨æˆ·ç•Œé¢ï¼Œä½¿å¾—ç”¨æˆ·å¯ä»¥ç›‘æ§å’Œç®¡ç†æ¶ˆæ¯ Broker çš„è®¸å¤šæ–¹é¢ã€‚</li>\n<li>è·Ÿè¸ªæœºåˆ¶ï¼ˆTracingï¼‰å¦‚æœæ¶ˆæ¯å¼‚å¸¸ï¼ŒRabbitMQ æä¾›äº†æ¶ˆæ¯è·Ÿè¸ªæœºåˆ¶ï¼Œä½¿ç”¨è€…å¯ä»¥æ‰¾å‡ºå‘ç”Ÿäº†ä»€ä¹ˆã€‚</li>\n<li>æ’ä»¶æœºåˆ¶ï¼ˆPlugin Systemï¼‰RabbitMQ æä¾›äº†è®¸å¤šæ’ä»¶ï¼Œæ¥ä»å¤šæ–¹é¢è¿›è¡Œæ‰©å±•ï¼Œä¹Ÿå¯ä»¥ç¼–å†™è‡ªå·±çš„æ’ä»¶ã€‚</li>\n</ul>\n<h2>RabbitMQæ¶æ„</h2>\n<ul>\n<li>RabbitMQ æ•´ä½“ä¸Šæ˜¯ä¸€ä¸ªç”Ÿäº§è€…ä¸æ¶ˆè´¹è€…æ¨¡å‹ï¼Œä¸»è¦è´Ÿè´£æ¥æ”¶ã€å­˜å‚¨å’Œè½¬å‘æ¶ˆæ¯ã€‚ä»è®¡ç®—æœºæœ¯è¯­å±‚é¢æ¥è¯´ï¼Œ RabbitMQ æ¨¡å‹æ›´åƒæ˜¯ä¸€ç§äº¤æ¢æœºæ¨¡å‹ã€‚ RabbitMQä¸»è¦åŒ…å«ä¸‹é¢å‡ ä¸ªéƒ¨åˆ†ï¼š\n<ul>\n<li>ProduceræŠ•é€’æ¶ˆæ¯</li>\n<li>Consumeræ¥æ”¶æ¶ˆæ¯</li>\n<li>QueueRabbitMQä¸æ”¯æŒé˜Ÿåˆ—å±‚é¢å¹¿æ’­æ¶ˆè´¹</li>\n<li>Exchangeç”Ÿäº§è€…å°†æ¶ˆæ¯å‘åˆ°äº¤æ¢å™¨ï¼Œäº¤æ¢å™¨å†å°†æ•°æ®è·¯ç”±åˆ°é˜Ÿåˆ—ã€‚å¦‚æœè·¯ç”±ä¸åˆ°ï¼Œæˆ–è®¸ä¼šè¿”å›ç»™ç”Ÿäº§è€…ï¼Œæˆ–è®¸ç›´æ¥ä¸¢å¼ƒã€‚åŒ…æ‹¬fanoutã€directã€topicã€headersç±»å‹</li>\n<li>Brokerä¸€ä¸ªBrokerå¯ä»¥çœ‹åšä¸€ä¸ªRabbitMQæœåŠ¡èŠ‚ç‚¹æˆ–è€…æœåŠ¡å®ä¾‹</li>\n<li>RoutingKeyè·¯ç”±é”®ï¼ŒæŒ‡å®šè¿™ä¸ªæ¶ˆæ¯çš„è·¯ç”±è§„åˆ™</li>\n<li>BindingKeyç»‘å®šé”®ï¼Œå…³è”äº¤æ¢å™¨ä¸é˜Ÿåˆ—</li>\n<li>payloadæ¶ˆæ¯ä½“</li>\n<li>æ ‡ç­¾ï¼ˆLabelï¼‰ç”¨æ¥è¡¨è¿°æ¶ˆæ¯ï¼Œæ¯”å¦‚ä¸€ä¸ªäº¤æ¢å™¨çš„åç§°å’Œä¸€ä¸ªè·¯ç”±é”®ã€‚ç”Ÿäº§è€…æŠŠæ¶ˆæ¯äº¤ç”±RabbitMOï¼Œ RabbitMQ ä¹‹åä¼šæ ¹æ®æ ‡ç­¾æŠŠæ¶ˆæ¯å‘é€ç»™æ„Ÿå…´è¶£çš„æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰åœ¨æ¶ˆæ¯è·¯ç”±çš„è¿‡ç¨‹ä¸­ï¼Œæ¶ˆæ¯çš„æ ‡ç­¾ä¼šä¸¢å¼ƒï¼Œå­˜å…¥åˆ°é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯åªæœ‰æ¶ˆæ¯ä½“ï¼Œæ¶ˆè´¹è€…åªä¼šæ¶ˆè´¹åˆ°æ¶ˆæ¯ä½“ï¼Œä¹Ÿå°±ä¸çŸ¥é“æ¶ˆæ¯çš„ç”Ÿäº§è€…æ˜¯è°ï¼Œå½“ç„¶æ¶ˆè´¹è€…ä¹Ÿä¸éœ€è¦çŸ¥é“ã€‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d8d150d08c11c7e9502e2.jpg\" alt=\"RabbitMQæ¶æ„.jpg\"></li>\n</ul>\n</li>\n</ul>\n<h2>RabbitMQæ¶ˆæ¯æ¶ˆè´¹è¿‡ç¨‹âˆš</h2>\n<ul>\n<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯\n<ul>\n<li>ç”Ÿäº§è€…è¿æ¥åˆ° RabbitMO Brokerï¼Œå»ºç«‹ä¸€ä¸ªTCP è¿æ¥ï¼ˆConnectionï¼‰ï¼Œå¼€å¯ä¸€ä¸ªä¿¡é“ï¼ˆChannelï¼‰</li>\n<li>ç”Ÿäº§è€…å£°æ˜ä¸€ä¸ªExchange(äº¤æ¢å™¨)ï¼Œå¹¶è®¾ç½®ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚äº¤æ¢æœºç±»å‹ã€æ˜¯å¦æŒä¹…åŒ–ç­‰</li>\n<li>ç”Ÿäº§è€…å£°æ˜ä¸€ä¸ªé˜Ÿåˆ—å¹¶è®¾ç½®ç›¸å…³å±æ€§ï¼Œæ¯”å¦‚æ˜¯å¦æ’ä»–ã€æ˜¯å¦æŒä¹…åŒ–ã€æ˜¯å¦è‡ªåŠ¨åˆ é™¤ç­‰</li>\n<li>ç”Ÿäº§è€…é€šè¿‡ bindingKey(ç»‘å®š Key)å°†äº¤æ¢å™¨å’Œé˜Ÿåˆ—ç»‘å®š(binding)èµ·æ¥</li>\n<li>ç”Ÿäº§è€…å‘é€æ¶ˆæ¯è‡³ RabbitMO Brokerï¼Œå…¶ä¸­åŒ…å«routingKey(è·¯ç”±é”®)ã€äº¤æ¢å™¨ç­‰ä¿¡æ¯</li>\n<li>ç›¸åº”çš„äº¤æ¢å™¨æ ¹æ®æ¥æ”¶åˆ°çš„è·¯ç”±é”®routingKeyæŸ¥æ‰¾ç›¸åŒ¹é…çš„é˜Ÿåˆ—ã€‚</li>\n<li>å¦‚æœæ‰¾åˆ°ï¼Œåˆ™å°†ä»ç”Ÿäº§è€…å‘é€è¿‡æ¥çš„æ¶ˆæ¯å­˜å…¥ç›¸åº”çš„é˜Ÿåˆ—ä¸­ã€‚</li>\n<li>å¦‚æœæ²¡æœ‰æ‰¾åˆ°ï¼Œåˆ™æ ¹æ®ç”Ÿäº§è€…é…ç½®çš„å±æ€§é€‰æ‹©ä¸¢å¼ƒè¿˜æ˜¯å›é€€ç»™ç”Ÿäº§è€…</li>\n<li>å…³é—­ä¿¡é“ã€‚</li>\n<li>å…³é—­è¿æ¥ã€‚</li>\n</ul>\n</li>\n<li>æ¶ˆè´¹è€…æ¥æ”¶æ¶ˆæ¯\n<ul>\n<li>æ¶ˆè´¹è€…è¿æ¥åˆ° RabbitMQ Brokerï¼Œå»ºç«‹ä¸€ä¸ªè¿æ¥ï¼ˆConnectionï¼‰ï¼Œå¼€å¯ä¸€ä¸ªä¿¡é“ï¼ˆChannelï¼‰ã€‚è¿æ¥åˆ° RabbitMQï¼Œå‡†å¤‡è¿›è¡Œé€šä¿¡ã€‚</li>\n<li>æ¶ˆè´¹è€…å‘ RabbitMQ Broker è¯·æ±‚æ¶ˆè´¹ç›¸åº”é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…å£°æ˜æ¶ˆè´¹æŸä¸ªé˜Ÿåˆ—çš„æ¶ˆæ¯ï¼Œå¯èƒ½ä¼šè®¾ç½®ç›¸åº”çš„å›è°ƒå‡½æ•°ï¼Œä»¥åŠåšä¸€äº›å‡†å¤‡å·¥ä½œ</li>\n<li>ç­‰å¾… RabbitMQ Broker å›åº”å¹¶æŠ•é€’ç›¸åº”é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…å¼€å§‹ä»é˜Ÿåˆ—ä¸­æ¥æ”¶æ¶ˆæ¯ã€‚</li>\n<li>æ¶ˆè´¹è€…ç¡®è®¤ï¼ˆackï¼‰æ¥æ”¶åˆ°çš„æ¶ˆæ¯ã€‚æ”¶åˆ°æ¶ˆæ¯åï¼Œæ¶ˆè´¹è€…å‘é€ç¡®è®¤ä¿¡å·ï¼Œè¡¨ç¤ºå·²æˆåŠŸå¤„ç†è¯¥æ¶ˆæ¯ã€‚</li>\n<li>RabbitMQ ä»é˜Ÿåˆ—ä¸­åˆ é™¤ç›¸åº”å·²ç»è¢«ç¡®è®¤çš„æ¶ˆæ¯ã€‚æ¶ˆæ¯è¢«ç¡®è®¤åï¼Œä»é˜Ÿåˆ—ä¸­ç§»é™¤ï¼Œç¡®ä¿ä¸å†è¢«æŠ•é€’ã€‚</li>\n<li>å…³é—­ä¿¡é“ã€‚</li>\n<li>å…³é—­ä¸RabbitMQ Brokerçš„è¿æ¥</li>\n</ul>\n</li>\n</ul>\n<h2>å¦‚ä½•ä¿è¯æ¶ˆæ¯ä¸ä¸¢å¤±ï¼Ÿå¯é æ€§ä¼ è¾“ï¼Ÿ</h2>\n<h3>ç”Ÿäº§è€…ä¸¢å¤±äº†æ•°æ®</h3>\n<ul>\n<li>RabbitMQ æä¾›äº‹åŠ¡åŠŸèƒ½ï¼Œå°±æ˜¯ç”Ÿäº§è€…å‘é€æ•°æ®ä¹‹å‰å¼€å¯ RabbitMQ äº‹åŠ¡channel.txSelectï¼Œç„¶åå‘é€æ¶ˆæ¯ï¼Œå¦‚æœæ¶ˆæ¯æ²¡æœ‰æˆåŠŸè¢« RabbitMQ æ¥æ”¶åˆ°ï¼Œé‚£ä¹ˆç”Ÿäº§è€…ä¼šæ”¶åˆ°å¼‚å¸¸æŠ¥é”™ï¼Œæ­¤æ—¶å°±å¯ä»¥å›æ»šäº‹åŠ¡channel.txRollbackï¼Œç„¶åé‡è¯•å‘é€æ¶ˆæ¯ï¼›å¦‚æœæ”¶åˆ°äº†æ¶ˆæ¯ï¼Œé‚£ä¹ˆå¯ä»¥æäº¤äº‹åŠ¡channel.txCommit</li>\n<li>RabbitMQ æä¾› confirm æ¨¡å¼ï¼Œæ¯æ¬¡å†™çš„æ¶ˆæ¯éƒ½ä¼šåˆ†é…ä¸€ä¸ªå”¯ä¸€çš„ idï¼Œç„¶åå¦‚æœå†™å…¥äº† RabbitMQ ä¸­ï¼Œé¦–å…ˆä¼šå‘é€åˆ°Exchangeï¼Œæ— è®ºæˆåŠŸä¸å¦éƒ½å›è°ƒå‡½æ•°confirm()è¿”å›ackæ¶ˆæ¯ã€‚ç¬¬äºŒæ­¥ä»Exchangeè·¯ç”±åˆ†é…åˆ°Queueä¸­ï¼Œå¦‚æœå¤±è´¥åˆ™å›è°ƒå‡½æ•°returnedMessage()ã€‚</li>\n<li>äº‹åŠ¡æœºåˆ¶å’Œ confirm æœºåˆ¶æœ€å¤§çš„ä¸åŒåœ¨äºï¼Œäº‹åŠ¡æœºåˆ¶æ˜¯åŒæ­¥çš„ï¼Œä½ æäº¤ä¸€ä¸ªäº‹åŠ¡ä¹‹åä¼šé˜»å¡åœ¨é‚£å„¿ï¼Œä½†æ˜¯ confirm æœºåˆ¶æ˜¯å¼‚æ­¥çš„ï¼Œä½ å‘é€ä¸ªæ¶ˆæ¯ä¹‹åå°±å¯ä»¥å‘é€ä¸‹ä¸€ä¸ªæ¶ˆæ¯ï¼Œç„¶åé‚£ä¸ªæ¶ˆæ¯ RabbitMQ æ¥æ”¶äº†ä¹‹åä¼šå¼‚æ­¥å›è°ƒä½ çš„ä¸€ä¸ªæ¥å£é€šçŸ¥ä½ è¿™ä¸ªæ¶ˆæ¯æ¥æ”¶åˆ°äº†ã€‚æ‰€ä»¥ä¸€èˆ¬åœ¨ç”Ÿäº§è€…è¿™å—é¿å…æ•°æ®ä¸¢å¤±ï¼Œéƒ½æ˜¯ç”¨ confirm æœºåˆ¶çš„ã€‚</li>\n</ul>\n<h3>RabbitMQï¼ˆbrokerï¼‰ä¸¢å¤±äº†æ•°æ®</h3>\n<ul>\n<li>åˆ›å»º queue çš„æ—¶å€™å°†å…¶è®¾ç½®ä¸ºæŒä¹…åŒ–ä¿è¯ RabbitMQ æŒä¹…åŒ– queue çš„å…ƒæ•°æ®ï¼Œ durable è®¾ç½®ä¸º true.åˆ›å»ºExchangeæ—¶è®¾ç½®ä¸ºæŒä¹…åŒ–</li>\n<li>å‘é€æ¶ˆæ¯çš„æ—¶å€™å°†æ¶ˆæ¯çš„ deliveryMode è®¾ç½®ä¸º 2ã€‚å°±æ˜¯å°†æ¶ˆæ¯è®¾ç½®ä¸ºæŒä¹…åŒ–çš„ï¼Œæ­¤æ—¶ RabbitMQ å°±ä¼šå°†æ¶ˆæ¯æŒä¹…åŒ–åˆ°ç£ç›˜ä¸Šå»ã€‚</li>\n</ul>\n<h3>æ¶ˆè´¹ç«¯ä¸¢å¤±æ•°æ®</h3>\n<ul>\n<li>RabbitMQ æä¾›çš„è‡ªåŠ¨ ack æœºåˆ¶ï¼Œå°†acknowledge-modeæ”¹ä¸ºæ‰‹åŠ¨æ¨¡å¼ï¼Œä¸šåŠ¡å¤„ç†æˆåŠŸåé€šè¿‡ä¸€ä¸ª api æ¥è°ƒç”¨å…³é—­ RabbitMQ çš„è‡ªåŠ¨ack ï¼Œå¦‚æœRabbitMQè®¤ä¸ºä½ è¿˜æ²¡å¤„ç†å®Œï¼Œè¿™ä¸ªæ—¶å€™ RabbitMQ ä¼šæŠŠè¿™ä¸ªæ¶ˆè´¹åˆ†é…ç»™åˆ«çš„ consumer å»å¤„ç†ï¼Œæ¶ˆæ¯æ˜¯ä¸ä¼šä¸¢çš„ã€‚</li>\n</ul>\n<h2>é¡ºåºæ¶ˆæ¯</h2>\n<h3>é”™ä¹±åœºæ™¯</h3>\n<ul>\n<li>ä¸€ä¸ªqueueå¯¹åº”å¤šä¸ªconsumerï¼Œconsumerä»MQé‡Œé¢è¯»å–æ•°æ®æ˜¯æœ‰åºçš„ï¼Œä½†æ˜¯æ— æ³•ä¿è¯å…ˆè¯»åˆ°æ¶ˆæ¯çš„consumerä¸€å®šå…ˆå®Œæˆæ“ä½œï¼Œè¿™æ ·å°±ä¼šå‡ºç°æ¶ˆæ¯å¹¶æ²¡æœ‰æŒ‰ç…§é¡ºåºæ‰§è¡Œï¼Œé€ æˆæ•°æ®é¡ºåºé”™è¯¯ã€‚</li>\n<li>ä¸€ä¸ªqueueå¯¹åº”ä¸€ä¸ªconsumerï¼Œä½†æ˜¯consumeré‡Œé¢è¿›è¡Œäº†å¤šçº¿ç¨‹æ¶ˆè´¹</li>\n</ul>\n<h3>è§£å†³æ–¹æ¡ˆ</h3>\n<ul>\n<li>æ ¹æ®ä¸šåŠ¡æ‹†åˆ†æˆä¸åŒqueueï¼Œæ¯”å¦‚åŒä¸€ä¸ªè®¢å•å·ç”¨åŒä¸€ä¸ªqueueï¼ŒåŒä¸€ä¸ªqueueä½¿ç”¨åŒä¸€ä¸ªconsumerå»æ¶ˆè´¹</li>\n<li>ä¸€ä¸ªqueueå¯¹åº”ä¸€ä¸ªconsumerï¼Œç„¶åè¿™ä¸ªconsumerå†…éƒ¨ç”¨å†…å­˜é˜Ÿåˆ—åšæ’é˜Ÿ,åˆ†å‘ç»™ä¸åŒçº¿ç¨‹å»å¤„ç†</li>\n</ul>\n<h2>é«˜å¯ç”¨</h2>\n<h3>æ™®é€šé›†ç¾¤æ¨¡å¼(éé«˜å¯ç”¨)</h3>\n<ul>\n<li>åœ¨å¤šå°æœºå™¨ä¸Šå¯åŠ¨å¤šä¸ª RabbitMQ å®ä¾‹ï¼Œæ¯ä¸ªæœºå™¨å¯åŠ¨ä¸€ä¸ªã€‚queueåªä¼šæ”¾åœ¨ä¸€ä¸ª RabbitMQ å®ä¾‹ä¸Šï¼Œä½†æ˜¯æ¯ä¸ªå®ä¾‹éƒ½åŒæ­¥ queue çš„å…ƒæ•°æ®ï¼ˆqueue çš„ä¸€äº›é…ç½®ä¿¡æ¯åŒ…æ‹¬ queue æ‰€åœ¨å®ä¾‹ï¼‰ã€‚æ¶ˆè´¹çš„æ—¶å€™ï¼Œå®é™…ä¸Šå¦‚æœè¿æ¥åˆ°äº†å¦å¤–ä¸€ä¸ªå®ä¾‹ï¼Œé‚£ä¹ˆé‚£ä¸ªå®ä¾‹ä¼šä» queue æ‰€åœ¨å®ä¾‹ä¸Šæ‹‰å–æ•°æ®è¿‡æ¥ã€‚æ­¤æ—¶è¦ä¹ˆæ¶ˆè´¹è€…æ¯æ¬¡éšæœºè¿æ¥ä¸€ä¸ªå®ä¾‹ç„¶åæ‹‰å–æ•°æ®ï¼Œè¦ä¹ˆå›ºå®šè¿æ¥é‚£ä¸ª queue æ‰€åœ¨å®ä¾‹æ¶ˆè´¹æ•°æ®ï¼Œå‰è€…æœ‰æ•°æ®æ‹‰å–çš„å¼€é”€ï¼Œåè€…å¯¼è‡´å•å®ä¾‹æ€§èƒ½ç“¶é¢ˆã€‚è€Œä¸”å¦‚æœé‚£ä¸ªæ”¾ queue çš„å®ä¾‹å®•æœºäº†ï¼Œä¼šå¯¼è‡´æ¥ä¸‹æ¥å…¶ä»–å®ä¾‹å°±æ— æ³•ä»é‚£ä¸ªå®ä¾‹æ‹‰å–ï¼Œå¦‚æœä½ å¼€å¯äº†æ¶ˆæ¯æŒä¹…åŒ–ï¼Œè®© RabbitMQ è½åœ°å­˜å‚¨æ¶ˆæ¯çš„è¯ï¼Œæ¶ˆæ¯ä¸ä¸€å®šä¼šä¸¢ï¼Œå¾—ç­‰è¿™ä¸ªå®ä¾‹æ¢å¤äº†ï¼Œç„¶åæ‰å¯ä»¥ç»§ç»­ä»è¿™ä¸ª queue æ‹‰å–æ•°æ®ã€‚è¿™å°±æ²¡æœ‰ä»€ä¹ˆæ‰€è°“çš„é«˜å¯ç”¨æ€§ï¼Œè¿™æ–¹æ¡ˆä¸»è¦æ˜¯æé«˜ååé‡çš„ï¼Œå°±æ˜¯è¯´è®©é›†ç¾¤ä¸­å¤šä¸ªèŠ‚ç‚¹æ¥æœåŠ¡æŸä¸ª queue çš„è¯»å†™æ“ä½œ</li>\n</ul>\n<h3>åœ¨é•œåƒé›†ç¾¤æ¨¡å¼(é«˜å¯ç”¨)</h3>\n<ul>\n<li>æ¯ä¸ª RabbitMQ èŠ‚ç‚¹éƒ½æœ‰è¿™ä¸ª queue çš„ä¸€ä¸ªå®Œæ•´é•œåƒï¼ŒåŒ…å« queue çš„å…¨éƒ¨æ•°æ®(å…ƒæ•°æ®å’Œæ¶ˆæ¯)ã€‚ç„¶åæ¯æ¬¡ä½ å†™æ¶ˆæ¯åˆ° queue çš„æ—¶å€™ï¼Œéƒ½ä¼šè‡ªåŠ¨æŠŠæ¶ˆæ¯åŒæ­¥åˆ°å¤šä¸ªå®ä¾‹çš„ queue ä¸Š</li>\n<li>åœ¨RabbitMQç®¡ç†æ§åˆ¶å°æ–°å¢ä¸€ä¸ªé•œåƒé›†ç¾¤æ¨¡å¼çš„ç­–ç•¥ï¼ŒæŒ‡å®šçš„æ—¶å€™æ˜¯å¯ä»¥è¦æ±‚æ•°æ®åŒæ­¥åˆ°æ‰€æœ‰èŠ‚ç‚¹çš„ï¼Œä¹Ÿå¯ä»¥è¦æ±‚åŒæ­¥åˆ°æŒ‡å®šæ•°é‡çš„èŠ‚ç‚¹ï¼Œå†æ¬¡åˆ›å»º queue çš„æ—¶å€™ï¼Œåº”ç”¨è¿™ä¸ªç­–ç•¥ï¼Œå°±ä¼šè‡ªåŠ¨å°†æ•°æ®åŒæ­¥åˆ°å…¶ä»–çš„èŠ‚ç‚¹ä¸Šå»äº†</li>\n<li>ä¼˜ç‚¹ï¼Œé«˜å¯ç”¨ï¼ŒæŸä¸ªèŠ‚ç‚¹å®•æœºä¸å½±å“é›†ç¾¤ï¼Œåˆ«çš„ consumer éƒ½å¯ä»¥åˆ°å…¶å®ƒèŠ‚ç‚¹ä¸Šå»æ¶ˆè´¹æ•°æ®</li>\n<li>ç¼ºç‚¹ï¼Œæ€§èƒ½å¼€é”€å¤ªå¤§ï¼Œæ¶ˆæ¯éœ€è¦åŒæ­¥åˆ°æ‰€æœ‰æœºå™¨ä¸Šï¼Œå¯¼è‡´ç½‘ç»œå¸¦å®½å‹åŠ›å’Œæ¶ˆè€—å¾ˆé‡ï¼›æ‰©å±•æ€§å¯è¨€å¤ªå·®ï¼ŒåŠ çš„æœºå™¨ä¹ŸåŒ…å«äº†è¿™ä¸ª queue çš„æ‰€æœ‰æ•°æ®ï¼Œå¹¶æ²¡æœ‰åŠæ³•çº¿æ€§æ‰©å±•ä½ çš„ queue</li>\n<li>å¦å¤–ï¼Œç”±äºæ¯ä¸ªèŠ‚ç‚¹éƒ½ä¿å­˜äº†å‰¯æœ¬ï¼Œæ‰€ä»¥æˆ‘ä»¬è¿˜å¯ä»¥é€šè¿‡HAProxyå®ç°è´Ÿè½½å‡è¡¡</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/d8d150d08c11c7e9502e2.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "RocketMQ",
      "url": "https://javaguide.cn/backend/mq/rocketmq.html",
      "id": "https://javaguide.cn/backend/mq/rocketmq.html",
      "summary": "1. ä»€ä¹ˆæ˜¯rocketmqï¼Ÿ 2. RocketMQ ç”±å“ªäº›è§’è‰²ç»„æˆï¼Ÿ 3. RocketMQ çš„æ•´ä½“æµç¨‹ï¼Ÿ 4. Producer å‘é€æ¶ˆæ¯æœ‰å‡ ç§æ–¹å¼ï¼Ÿ 5. æ¶ˆè´¹è€…æ¶ˆè´¹æ¨¡å¼æœ‰å‡ ç§ï¼Ÿ 6. æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ 7. å¦‚ä½•å¯¹æ¶ˆæ¯è¿›è¡Œé‡æ”¾ï¼Ÿ 8. é¡ºåºæ¶ˆæ¯ 9. å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿå¯é æ€§ä¼ è¾“ï¼Ÿ 10. é«˜å¯ç”¨ 1. ä»€ä¹ˆæ˜¯rocketmqï¼Ÿ R...",
      "content_html": "<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E4%BB%80%E4%B9%88%E6%98%AFrocketmq\">1. ä»€ä¹ˆæ˜¯rocketmqï¼Ÿ</a></li>\n<li><a href=\"#2-rocketmq-%E7%94%B1%E5%93%AA%E4%BA%9B%E8%A7%92%E8%89%B2%E7%BB%84%E6%88%90\">2. RocketMQ ç”±å“ªäº›è§’è‰²ç»„æˆï¼Ÿ</a></li>\n<li><a href=\"#3-rocketmq-%E7%9A%84%E6%95%B4%E4%BD%93%E6%B5%81%E7%A8%8B\">3. RocketMQ çš„æ•´ä½“æµç¨‹ï¼Ÿ</a></li>\n<li><a href=\"#4-producer-%E5%8F%91%E9%80%81%E6%B6%88%E6%81%AF%E6%9C%89%E5%87%A0%E7%A7%8D%E6%96%B9%E5%BC%8F\">4. Producer å‘é€æ¶ˆæ¯æœ‰å‡ ç§æ–¹å¼ï¼Ÿ</a></li>\n<li><a href=\"#5-%E6%B6%88%E8%B4%B9%E8%80%85%E6%B6%88%E8%B4%B9%E6%A8%A1%E5%BC%8F%E6%9C%89%E5%87%A0%E7%A7%8D\">5. æ¶ˆè´¹è€…æ¶ˆè´¹æ¨¡å¼æœ‰å‡ ç§ï¼Ÿ</a></li>\n<li><a href=\"#6-%E6%B6%88%E8%B4%B9%E8%80%85%E8%8E%B7%E5%8F%96%E6%B6%88%E6%81%AF%E6%9C%89%E5%87%A0%E7%A7%8D%E6%A8%A1%E5%BC%8F\">6. æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</a></li>\n<li><a href=\"#7-%E5%A6%82%E4%BD%95%E5%AF%B9%E6%B6%88%E6%81%AF%E8%BF%9B%E8%A1%8C%E9%87%8D%E6%94%BE\">7. å¦‚ä½•å¯¹æ¶ˆæ¯è¿›è¡Œé‡æ”¾ï¼Ÿ</a></li>\n<li><a href=\"#8-%E9%A1%BA%E5%BA%8F%E6%B6%88%E6%81%AF\">8. é¡ºåºæ¶ˆæ¯</a></li>\n<li><a href=\"#9-%E5%A6%82%E4%BD%95%E9%98%B2%E6%AD%A2%E6%B6%88%E6%81%AF%E4%B8%A2%E5%A4%B1%E5%8F%AF%E9%9D%A0%E6%80%A7%E4%BC%A0%E8%BE%93\">9. å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿå¯é æ€§ä¼ è¾“ï¼Ÿ</a></li>\n<li><a href=\"#10-%E9%AB%98%E5%8F%AF%E7%94%A8\">10. é«˜å¯ç”¨</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. ä»€ä¹ˆæ˜¯rocketmqï¼Ÿ</h1>\n<ul>\n<li>RocketMQ æ˜¯é˜¿é‡Œå·´å·´åœ¨ 2012 å¹´å¼€æºçš„åˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶</li>\n<li>RocketMQåœ¨é˜¿é‡Œé›†å›¢è¢«å¹¿æ³›åº”ç”¨åœ¨è®¢å•ï¼Œäº¤æ˜“ï¼Œå……å€¼ï¼Œæµè®¡ç®—ï¼Œæ¶ˆæ¯æ¨é€ï¼Œæ—¥å¿—æµå¼å¤„ç†ï¼Œ binglog åˆ†å‘ç­‰åœºæ™¯ã€‚</li>\n</ul>\n<h1>2. RocketMQ ç”±å“ªäº›è§’è‰²ç»„æˆï¼Ÿ</h1>\n<ul>\n<li>ç”Ÿäº§è€…ï¼ˆProducerï¼‰ï¼šè´Ÿè´£äº§ç”Ÿæ¶ˆæ¯ï¼Œç”Ÿäº§è€…å‘æ¶ˆæ¯æœåŠ¡å™¨å‘é€ç”±ä¸šåŠ¡åº”ç”¨ç¨‹åºç³»ç»Ÿç”Ÿæˆçš„æ¶ˆæ¯ã€‚</li>\n<li>æ¶ˆè´¹è€…ï¼ˆConsumerï¼‰ï¼šè´Ÿè´£æ¶ˆè´¹æ¶ˆæ¯ï¼Œæ¶ˆè´¹è€…ä»æ¶ˆæ¯æœåŠ¡å™¨æ‹‰å–ä¿¡æ¯å¹¶å°†å…¶è¾“å…¥ç”¨æˆ·åº”ç”¨ç¨‹åºã€‚</li>\n<li>æ¶ˆæ¯æœåŠ¡å™¨ï¼ˆBrokerï¼‰ï¼šæ˜¯æ¶ˆæ¯å­˜å‚¨ä¸­å¿ƒï¼Œä¸»è¦ä½œç”¨æ˜¯æ¥æ”¶æ¥è‡ª Producer çš„æ¶ˆæ¯å¹¶å­˜å‚¨ï¼Œ Consumer ä»è¿™é‡Œå–å¾—æ¶ˆæ¯ã€‚</li>\n<li>åç§°æœåŠ¡å™¨ï¼ˆNameServerï¼‰ï¼šç”¨æ¥ä¿å­˜ Broker ç›¸å…³ Topic ç­‰å…ƒä¿¡æ¯å¹¶ç»™ Producer ï¼Œæä¾› Consumer æŸ¥æ‰¾ Broker ä¿¡æ¯ã€‚</li>\n</ul>\n<h1>3. RocketMQ çš„æ•´ä½“æµç¨‹ï¼Ÿ</h1>\n<ul>\n<li>Nameserverå¯åŠ¨åç›‘å¬ç«¯å£ï¼Œç­‰å¾… Brokerã€Producerã€Consumer è¿ä¸Šæ¥ï¼Œç›¸å½“äºä¸€ä¸ªè·¯ç”±æ§åˆ¶ä¸­å¿ƒã€‚</li>\n<li>Brokerå¯åŠ¨ï¼Œè·Ÿæ‰€æœ‰çš„ Namesrv ä¿æŒé•¿è¿æ¥ï¼Œå®šæ—¶å‘é€å¿ƒè·³åŒ…ï¼ˆåŒ…å«å½“å‰ Broker ä¿¡æ¯(IP+ç«¯å£ç­‰)ä»¥åŠå­˜å‚¨æ‰€æœ‰ Topic ä¿¡æ¯ã€‚æ³¨å†ŒæˆåŠŸåï¼ŒNameserveré›†ç¾¤ä¸­å°±æœ‰Topicè·ŸBrokerçš„æ˜ å°„å…³ç³»ï¼‰æ”¶å‘æ¶ˆæ¯å‰ï¼Œå…ˆåˆ›å»ºTopic ã€‚åˆ›å»º Topicæ—¶ï¼Œéœ€è¦æŒ‡å®šè¯¥Topicè¦å­˜å‚¨åœ¨å“ªäº›Brokerä¸Šã€‚ä¹Ÿå¯ä»¥åœ¨å‘é€æ¶ˆæ¯æ—¶è‡ªåŠ¨åˆ›å»ºTopic</li>\n<li>Producer å‘é€æ¶ˆæ¯ã€‚å¯åŠ¨æ—¶ï¼Œå…ˆè·Ÿ Namesrv é›†ç¾¤ä¸­çš„å…¶ä¸­ä¸€å°å»ºç«‹é•¿è¿æ¥ï¼Œå¹¶ä»Namesrv ä¸­è·å–å½“å‰å‘é€çš„ Topic å­˜åœ¨å“ªäº› Broker ä¸Šï¼Œç„¶åè·Ÿå¯¹åº”çš„ Broker å»ºç«‹é•¿è¿æ¥ï¼Œç›´æ¥å‘ Broker å‘æ¶ˆæ¯ã€‚</li>\n<li>Consumer æ¶ˆè´¹æ¶ˆæ¯ã€‚è·Ÿå…¶ä¸­ä¸€å° Namesrv å»ºç«‹é•¿è¿æ¥ï¼Œè·å–å½“å‰è®¢é˜… Topic å­˜åœ¨å“ªäº› Broker ä¸Šï¼Œç„¶åç›´æ¥è·Ÿ Broker å»ºç«‹è¿æ¥é€šé“ï¼Œå¼€å§‹æ¶ˆè´¹æ¶ˆæ¯ã€‚</li>\n</ul>\n<h1>4. Producer å‘é€æ¶ˆæ¯æœ‰å‡ ç§æ–¹å¼ï¼Ÿ</h1>\n<ul>\n<li>åŒæ­¥æ–¹å¼</li>\n<li>å¼‚æ­¥æ–¹å¼</li>\n<li>Oneway æ–¹å¼ é€‚åˆå¤§æ•°æ®åœºæ™¯ï¼Œå…è®¸æœ‰ä¸€å®šæ¶ˆæ¯ä¸¢å¤±çš„åœºæ™¯ã€‚å¦‚æ—¥å¿—</li>\n</ul>\n<h1>5. æ¶ˆè´¹è€…æ¶ˆè´¹æ¨¡å¼æœ‰å‡ ç§ï¼Ÿ</h1>\n<ul>\n<li>é›†ç¾¤æ¶ˆè´¹ï¼šä¸€ä¸ª Consumer Group ä¸­çš„å„ä¸ª Consumer å®ä¾‹åˆ†æ‘Šå»æ¶ˆè´¹æ¶ˆæ¯ï¼Œå³ä¸€æ¡æ¶ˆæ¯åªä¼šè¢« Consumer Group ä¸­çš„ä¸€ä¸ªConsumeræ¶ˆè´¹ä¸€æ¬¡ã€‚</li>\n<li>å¹¿æ’­æ¶ˆè´¹ï¼šä¸€ ä¸ªConsumer Group ä¸‹çš„å„ä¸ª Consumer å®ä¾‹éƒ½æŠ•é€’ä¸€éã€‚å³ä¸€æ¡æ¶ˆæ¯æ¶ˆæ¯ä¼šè¢« Consumer Group ä¸­çš„æ¯ä¸ªConsumeræ¶ˆè´¹ä¸€æ¬¡ã€‚</li>\n</ul>\n<h1>6. æ¶ˆè´¹è€…è·å–æ¶ˆæ¯æœ‰å‡ ç§æ¨¡å¼ï¼Ÿ</h1>\n<ul>\n<li>PushConsumeræ¨é€æ¨¡å¼:ï¼ˆè™½ç„¶ RocketMQ ä½¿ç”¨çš„æ˜¯é•¿è½®è¯¢ï¼‰çš„æ¶ˆè´¹è€…ã€‚æ¶ˆæ¯çš„èƒ½åŠæ—¶è¢«æ¶ˆè´¹ã€‚ä½¿ç”¨éå¸¸ç®€å•ï¼Œå†…éƒ¨å·²å¤„ç†å¦‚çº¿ç¨‹æ± æ¶ˆè´¹ã€æµæ§ã€è´Ÿè½½å‡è¡¡ã€å¼‚å¸¸å¤„ç†ç­‰ç­‰çš„å„ç§åœºæ™¯ã€‚</li>\n<li>PullConsumeræ‹‰å–æ¨¡å¼çš„æ¶ˆè´¹è€…ã€‚åº”ç”¨ä¸»åŠ¨æ§åˆ¶æ‹‰å–çš„æ—¶æœºï¼Œæ€ä¹ˆæ‹‰å–ï¼Œæ€ä¹ˆæ¶ˆè´¹ç­‰ã€‚ä¸»åŠ¨æƒæ›´é«˜ã€‚ä½†è¦è‡ªå·±å¤„ç†å„ç§åœºæ™¯ã€‚</li>\n</ul>\n<h1>7. å¦‚ä½•å¯¹æ¶ˆæ¯è¿›è¡Œé‡æ”¾ï¼Ÿ</h1>\n<ul>\n<li>æ¶ˆè´¹ä½ç‚¹å°±æ˜¯ä¸€ä¸ªæ•°å­—ï¼ŒæŠŠ Consumer Offset æ”¹ä¸€ä¸‹ï¼Œå°±å¯ä»¥è¾¾åˆ°é‡æ”¾çš„ç›®çš„äº†ã€‚</li>\n</ul>\n<h1>8. é¡ºåºæ¶ˆæ¯</h1>\n<ul>\n<li>ç”Ÿäº§è€…å¿…é¡»å•ä¸€ç”Ÿäº§è€…ä¸²è¡Œå‘é€,ä½¿ç”¨ MessageQueueSelector ä¸ºæŸä¸€æ‰¹æ¶ˆæ¯ï¼ˆé€šå¸¸æ˜¯æœ‰ç›¸åŒçš„å”¯ä¸€æ ‡ç¤ºidï¼‰é€‰æ‹©åŒä¸€ä¸ª Queue ï¼Œåˆ™è¿™ä¸€æ‰¹æ¶ˆæ¯çš„æ¶ˆè´¹å°†æ˜¯é¡ºåºæ¶ˆæ¯ï¼ˆå¹¶ç”±åŒä¸€ä¸ªconsumerå®Œæˆæ¶ˆè´¹ï¼‰ã€‚</li>\n<li>æ¶ˆè´¹è€…ç±»å‹å¿…é¡»ä¸ºPushConsumeræ¶ˆæ¯æ¶ˆè´¹çš„é¡ºåºæ€§éœ€è¦ç”±ä¸šåŠ¡æ–¹è‡ªè¡Œä¿è¯ã€‚</li>\n<li>æ™®é€šé¡ºåºæ¶ˆæ¯:æ­£å¸¸æƒ…å†µä¸‹å¯ä»¥ä¿è¯å®Œå…¨çš„é¡ºåºæ¶ˆæ¯ï¼Œä½†æ˜¯ä¸€æ—¦å‘ç”Ÿå¼‚å¸¸ï¼ŒBroker å®•æœºæˆ–é‡å¯ï¼Œç”±äºé˜Ÿåˆ—æ€»æ•°å‘ç”Ÿå‘åŒ–ï¼Œæ¶ˆè´¹è€…ä¼šè§¦å‘è´Ÿè½½å‡è¡¡ï¼Œè€Œé»˜è®¤åœ°è´Ÿè½½å‡è¡¡ç®—æ³•é‡‡å–å“ˆå¸Œå–æ¨¡å¹³å‡ï¼Œè¿™æ ·è´Ÿè½½å‡è¡¡åˆ†é…åˆ°å®šä½çš„é˜Ÿåˆ—ä¼šå‘åŒ–ï¼Œä½¿å¾—é˜Ÿåˆ—å¯èƒ½åˆ†é…åˆ°åˆ«çš„å®ä¾‹ä¸Šï¼Œåˆ™ä¼šçŸ­æš‚åœ°å‡ºç°æ¶ˆæ¯é¡ºåºä¸ä¸€è‡´ã€‚å¦‚æœä¸šåŠ¡èƒ½å®¹å¿åœ¨é›†ç¾¤å¼‚å¸¸æƒ…å†µï¼ˆå¦‚æŸä¸ª Broker å®•æœºæˆ–è€…é‡å¯ï¼‰ä¸‹ï¼Œæ¶ˆæ¯çŸ­æš‚çš„ä¹±åºï¼Œä½¿ç”¨æ™®é€šé¡ºåºæ–¹å¼æ¯”è¾ƒåˆé€‚ã€‚</li>\n<li>ä¸¥æ ¼é¡ºåºæ¶ˆæ¯ï¼šæ— è®ºæ­£å¸¸å¼‚å¸¸æƒ…å†µéƒ½èƒ½ä¿è¯é¡ºåºï¼Œç‰ºç‰²äº†åˆ†å¸ƒå¼ Failover ç‰¹æ€§ï¼Œå³ Broker é›†ç¾¤ä¸­åªè¦æœ‰ä¸€å°æœºå™¨ä¸å¯ç”¨ï¼Œåˆ™æ•´ä¸ªé›†ç¾¤éƒ½ä¸å¯ç”¨ï¼ŒæœåŠ¡å¯ç”¨æ€§å¤§å¤§é™ä½ã€‚å¦‚æœæœåŠ¡å™¨éƒ¨ç½²ä¸ºåŒæ­¥åŒå†™æ¨¡å¼ï¼Œæ­¤ç¼ºé™·å¯é€šè¿‡å¤‡æœºè‡ªåŠ¨åˆ‡æ¢ä¸ºä¸»é¿å…ï¼Œä¸è¿‡ä»ç„¶ä¼šå­˜åœ¨å‡ åˆ†é’Ÿçš„æœåŠ¡ä¸å¯ç”¨ã€‚ï¼ˆä¾èµ–åŒæ­¥åŒå†™ï¼Œä¸»å¤‡è‡ªåŠ¨åˆ‡æ¢ï¼Œè‡ªåŠ¨åˆ‡æ¢åŠŸèƒ½ç›®å‰å¹¶æœªå®ç°ï¼‰</li>\n</ul>\n<h1>9. å¦‚ä½•é˜²æ­¢æ¶ˆæ¯ä¸¢å¤±ï¼Ÿå¯é æ€§ä¼ è¾“ï¼Ÿ</h1>\n<ul>\n<li>\n<p>ç”Ÿäº§è€…å°†æ¶ˆæ¯å‘é€ç»™Rocket MQçš„æ—¶å€™ï¼Œå¦‚æœå‡ºç°äº†ç½‘ç»œæŠ–åŠ¨æˆ–è€…é€šä¿¡å¼‚å¸¸ç­‰é—®é¢˜ï¼Œæ¶ˆæ¯å°±æœ‰å¯èƒ½ä¼šä¸¢å¤±ã€‚ï¼ˆrocketmqäº‹åŠ¡ï¼Œå…ˆå‘é€halfæ¶ˆæ¯ï¼Œç„¶årocketmqè¿”å›ackï¼Œæ‰§è¡Œæœ¬åœ°äº‹åŠ¡ï¼ŒæˆåŠŸåˆ™å‘é€commitï¼Œå¤±è´¥rollbackï¼Œå¦‚æœcommitæˆ–è€…rollbackæ¶ˆæ¯å¤„ç†ä¼šæœ‰æ¶ˆæ¯çŠ¶æ€å›æŸ¥ï¼‰</p>\n</li>\n<li>\n<p>RocketMQä¸ºäº†å‡å°‘ç£ç›˜çš„IOï¼Œä¼šå…ˆå°†æ¶ˆæ¯å†™å…¥åˆ°os cacheä¸­ï¼Œè€Œä¸æ˜¯ç›´æ¥å†™å…¥åˆ°ç£ç›˜ä¸­ï¼Œéš”ä¸€æ®µæ—¶é—´åå¼‚æ­¥æŒä¹…åŒ–åˆ°ç£ç›˜ï¼Œåœ¨os cacheä¸­æ¶ˆæ¯å°±æœ‰å¯èƒ½ä¼šä¸¢å¤±ï¼ˆrocketmqé›†ç¾¤ï¼Œå¼‚æ­¥åˆ·ç›˜ç­–ç•¥æ”¹ä¸ºåŒæ­¥åˆ·ç›˜ï¼Œå¼‚æ­¥å¤åˆ¶æ”¹ä¸ºåŒæ­¥å¤åˆ¶ï¼‰</p>\n</li>\n<li>\n<p>æ¶ˆè´¹è€…æˆåŠŸä»RocketMQä¸­è·å–åˆ°äº†æ¶ˆæ¯ï¼Œè¿˜æ²¡æœ‰å°†æ¶ˆæ¯å®Œå…¨æ¶ˆè´¹å®Œçš„æ—¶å€™ï¼Œå°±é€šçŸ¥RocketMQæˆ‘å·²ç»å°†æ¶ˆæ¯æ¶ˆè´¹äº†ï¼Œç„¶åæ¶ˆè´¹è€…å®•æœºï¼Œä½†æ˜¯RocketMQè®¤ä¸ºæ¶ˆè´¹è€…å·²ç»æˆåŠŸæ¶ˆè´¹äº†æ•°æ®ï¼Œæ‰€ä»¥æ•°æ®ä¾æ—§ä¸¢å¤±äº†ã€‚<br>\nå½“ä½ çš„æ¶ˆæ¯å¤„ç†å®Œæ¯•ä¹‹åï¼Œæ‰ä¼šè¿”å›ConsumeConcurrentlyStatus.CONSUME_SUCCESS åªæœ‰è¿”å›äº†CONSUME_SUCCESSï¼Œæ¶ˆè´¹è€…æ‰ä¼šå‘Šè¯‰RocketMQæˆ‘å·²ç»æ¶ˆè´¹å®Œäº†ï¼Œæ­¤æ—¶å¦‚æœæ¶ˆè´¹è€…å®•æœºï¼Œæ¶ˆæ¯å·²ç»å¤„ç†å®Œäº†ï¼Œä¹Ÿå°±ä¸ä¼šä¸¢å¤±æ¶ˆæ¯äº†</p>\n</li>\n<li>\n<p>RocketMQ é‡‡ç”¨æ–‡ä»¶ç³»ç»Ÿçš„æ–¹å¼æ¥å­˜å‚¨æ¶ˆæ¯ï¼Œæ¶ˆæ¯çš„ä¸»è¦å­˜å‚¨æ–‡ä»¶åŒ…æ‹¬ CommitLog æ–‡ä»¶ã€ConsumeQueue æ–‡ä»¶ã€IndexFile æ–‡ä»¶ã€‚</p>\n</li>\n<li>\n<p>Producer å°†æ¶ˆæ¯å‘é€åˆ° Broker åï¼ŒBroker ä¼šé‡‡ç”¨åŒæ­¥æˆ–è€…å¼‚æ­¥çš„æ–¹å¼æŠŠæ¶ˆæ¯å†™å…¥åˆ° CommitLogã€‚RocketMQ æ‰€æœ‰çš„æ¶ˆæ¯éƒ½ä¼šå­˜æ”¾åœ¨ CommitLog ä¸­ã€‚å¯¹ CommitLog å†™ä¹‹å‰ä¼šåŠ é”ã€‚åªè¦æ¶ˆæ¯è¢«æŒä¹…åŒ–åˆ°ç£ç›˜æ–‡ä»¶ CommitLogï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¿è¯ Producer å‘é€çš„æ¶ˆæ¯ä¸ä¼šä¸¢å¤±ã€‚commitLogæ˜¯é¡ºåºå†™çš„</p>\n</li>\n<li>\n<p>CommitLog æŒä¹…åŒ–åï¼Œä¼šæŠŠé‡Œé¢çš„æ¶ˆæ¯ Dispatch åˆ°å¯¹åº”çš„ Consume Queue ä¸Šï¼Œæ˜¯ä¸€ä¸ªé€»è¾‘é˜Ÿåˆ—ï¼Œå­˜å‚¨äº†è¿™ä¸ª Queue åœ¨ CommitLog ä¸­çš„èµ·å§‹ Offsetï¼Œlog å¤§å°å’Œ MessageTag çš„ hashCodeã€‚</p>\n</li>\n<li>\n<p>å½“æ¶ˆè´¹è€…è¿›è¡Œæ¶ˆæ¯æ¶ˆè´¹æ—¶ï¼Œä¼šå…ˆè¯»å– ConsumerQueueï¼Œé€»è¾‘æ¶ˆè´¹é˜Ÿåˆ— ConsumeQueue ä¿å­˜äº†æŒ‡å®š Topic ä¸‹çš„é˜Ÿåˆ—æ¶ˆæ¯åœ¨ CommitLog ä¸­çš„èµ·å§‹ç‰©ç†åç§»é‡ Offsetï¼Œæ¶ˆæ¯å¤§å°ã€å’Œæ¶ˆæ¯ Tag çš„ HashCode å€¼</p>\n</li>\n<li>\n<p>ç›´æ¥ä» ConsumerQueue ä¸­è¯»å–æ¶ˆæ¯æ˜¯æ²¡æœ‰æ•°æ®çš„ï¼ŒçœŸæ­£çš„æ¶ˆæ¯ä¸»ä½“åœ¨ CommitLog ä¸­ï¼Œæ‰€ä»¥è¿˜éœ€è¦ä» CommitLog ä¸­è¯»å–æ¶ˆæ¯ã€‚</p>\n</li>\n<li>\n<p>æ¶ˆè´¹ç”¨çš„è§‚å¯Ÿè€…æ¨¡å¼</p>\n</li>\n</ul>\n<h1>10. é«˜å¯ç”¨</h1>\n<ul>\n<li>å¤šèŠ‚ç‚¹ï¼ˆé›†ç¾¤ï¼‰å¤šå‰¯æœ¬æ¨¡å¼-å¼‚æ­¥å¤åˆ¶</li>\n<li>å¤šèŠ‚ç‚¹ï¼ˆé›†ç¾¤ï¼‰å¤šå‰¯æœ¬æ¨¡å¼-åŒæ­¥å¤åˆ¶</li>\n</ul>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Hibernate",
      "url": "https://javaguide.cn/backend/ormframework/hibernate.html",
      "id": "https://javaguide.cn/backend/ormframework/hibernate.html",
      "summary": "hibernate 1. hibernateä»‹ç» 2. hibernateæ¡†æ¶5.0çš„æ­å»º 3. hibernate-API 4. hibernateå¯¹è±¡çŠ¶æ€ï¼ˆ3ç§ï¼‰ 5. hibernateä¸€çº§ç¼“å­˜+å¿«ç…§ 6. hibernateäº‹åŠ¡ 7. no-sessioné—®é¢˜åŠå…¶è§£å†³æ–¹æ¡ˆ 8. hibernateå…³ç³»æ˜ å°„ 8.1. ä¸€å¯¹å¤š|å¤šå¯¹ä¸€ 8.2. å¤š...",
      "content_html": "<p>hibernate</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-hibernate%E4%BB%8B%E7%BB%8D\">1. hibernateä»‹ç»</a></li>\n<li><a href=\"#2-hibernate%E6%A1%86%E6%9E%B650%E7%9A%84%E6%90%AD%E5%BB%BA\">2. hibernateæ¡†æ¶5.0çš„æ­å»º</a></li>\n<li><a href=\"#3-hibernate-api\">3. hibernate-API</a></li>\n<li><a href=\"#4-hibernate%E5%AF%B9%E8%B1%A1%E7%8A%B6%E6%80%813%E7%A7%8D\">4. hibernateå¯¹è±¡çŠ¶æ€ï¼ˆ3ç§ï¼‰</a></li>\n<li><a href=\"#5-hibernate%E4%B8%80%E7%BA%A7%E7%BC%93%E5%AD%98%E5%BF%AB%E7%85%A7\">5. hibernateä¸€çº§ç¼“å­˜+å¿«ç…§</a></li>\n<li><a href=\"#6-hibernate%E4%BA%8B%E5%8A%A1\">6. hibernateäº‹åŠ¡</a></li>\n<li><a href=\"#7-no-session%E9%97%AE%E9%A2%98%E5%8F%8A%E5%85%B6%E8%A7%A3%E5%86%B3%E6%96%B9%E6%A1%88\">7. no-sessioné—®é¢˜åŠå…¶è§£å†³æ–¹æ¡ˆ</a></li>\n<li><a href=\"#8-hibernate%E5%85%B3%E7%B3%BB%E6%98%A0%E5%B0%84\">8. hibernateå…³ç³»æ˜ å°„</a>\n<ul>\n<li><a href=\"#81-%E4%B8%80%E5%AF%B9%E5%A4%9A%E5%A4%9A%E5%AF%B9%E4%B8%80\">8.1. ä¸€å¯¹å¤š|å¤šå¯¹ä¸€</a></li>\n<li><a href=\"#82-%E5%A4%9A%E5%AF%B9%E5%A4%9A\">8.2. å¤šå¯¹å¤š</a></li>\n</ul>\n</li>\n<li><a href=\"#9-%E6%9F%A5%E8%AF%A2%E6%80%BB%E7%BB%93session\">9. æŸ¥è¯¢æ€»ç»“(session)</a>\n<ul>\n<li><a href=\"#91-oid%E6%9F%A5%E8%AF%A2-get\">9.1. oidæŸ¥è¯¢-get</a></li>\n<li><a href=\"#92-%E5%AF%B9%E8%B1%A1%E5%B1%9E%E6%80%A7%E5%AF%BC%E8%88%AA%E6%9F%A5%E8%AF%A2\">9.2. å¯¹è±¡å±æ€§å¯¼èˆªæŸ¥è¯¢</a></li>\n<li><a href=\"#93-hql%E6%9F%A5%E8%AF%A2-%E9%9D%A2%E5%90%91%E5%AF%B9%E8%B1%A1%E7%9A%84%E6%9F%A5%E8%AF%A2%E8%AF%AD%E8%A8%80%E5%A4%9A%E8%A1%A8%E6%9F%A5%E8%AF%A2\">9.3. HQLæŸ¥è¯¢-é¢å‘å¯¹è±¡çš„æŸ¥è¯¢è¯­è¨€(å¤šè¡¨æŸ¥è¯¢)</a></li>\n<li><a href=\"#94-%E5%8E%9F%E7%94%9Fsql%E5%A4%8D%E6%9D%82%E7%9A%84%E4%B8%9A%E5%8A%A1%E6%9F%A5%E8%AF%A2\">9.4. åŸç”ŸSQLï¼šå¤æ‚çš„ä¸šåŠ¡æŸ¥è¯¢</a></li>\n<li><a href=\"#95-criteria%E5%8D%95%E8%A1%A8%E6%9D%A1%E4%BB%B6%E6%9F%A5%E8%AF%A2\">9.5. Criteriaï¼š(å•è¡¨æ¡ä»¶æŸ¥è¯¢)</a></li>\n</ul>\n</li>\n<li><a href=\"#10-%E6%9F%A5%E8%AF%A2%E4%BC%98%E5%8C%96\">10. æŸ¥è¯¢ä¼˜åŒ–</a></li>\n<li><a href=\"#11-hibernate%E6%8C%81%E4%B9%85%E5%B1%82%E6%8A%BD%E5%8F%96\">11. hibernateæŒä¹…å±‚æŠ½å–</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. hibernateä»‹ç»</h1>\n<ul>\n<li>hibernateæ˜¯ä¸€æ¬¾ormï¼ˆorm:object relationg mapping. å¯¹è±¡å…³ç³»æ˜ å°„ï¼‰æ¡†æ¶</li>\n<li>å…¶ä¸»è¦ä½œç”¨æ˜¯åœ¨ç¼–ç¨‹ä¸­ï¼ŒæŠŠé¢å‘å¯¹è±¡çš„æ¦‚å¿µè·Ÿæ•°æ®åº“ä¸­è¡¨çš„æ¦‚å¿µå¯¹åº”èµ·æ¥</li>\n<li>hibernateå®˜ç½‘<a href=\"http://hibernate.org/\" target=\"_blank\" rel=\"noopener noreferrer\">http://hibernate.org/</a></li>\n<li>hibernateæ–‡æ¡£<a href=\"http://hibernate.org/orm/documentation/5.4/\" target=\"_blank\" rel=\"noopener noreferrer\">http://hibernate.org/orm/documentation/5.4/</a></li>\n<li>æ“ä½œæ•°æ®åº“çš„æ—¶å€™,å¯ä»¥ä»¥é¢å‘å¯¹è±¡çš„æ–¹å¼æ¥å®Œæˆ.ä¸éœ€è¦ä¹¦å†™SQLè¯­å¥</li>\n<li>ormåˆ†4çº§ï¼šhibernateå±äºå®Œå…¨é¢å‘å¯¹è±¡æ“ä½œæ•°æ®åº“ã€mybatiså±äº2çº§ã€dbutilså±äº1çº§</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2204f0c7b2f5291d24e6d.png\" alt=\"hibernate.jpg\" tabindex=\"0\"><figcaption>hibernate.jpg</figcaption></figure>\n<h1>2. hibernateæ¡†æ¶5.0çš„æ­å»º</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…ï¼šweb-content --&gt;web-INF--&gt;lib\nhibernate-commons-annotations-5.0.1.Final.jar\nhibernate-core-5.0.7.Final.jar\nhibernate-jpa-2.1-api-1.0.0.Final.jar\njandex-2.0.0.Final.jar\njavassist-3.18.1-GA.jar\njboss-logging-3.3.0.Final.jar\nantlr-2.7.7.jar\ndom4j-1.6.1.jar\ngeronimo-jta_1.1_spec-1.1.1.jar\nmysqlé©±åŠ¨åŒ…mysql-connector-java-5.1.7-bin.jar\n\nå»ºåº“å»ºè¡¨ï¼Œåˆ›å»ºå®ä½“srcç›®å½•çš„domainåŒ…ä¸‹åˆ›å»ºå®ä½“å¯¹è±¡ç±»(éµå¾ªä»¥ä¸‹è§„åˆ™)\n- ä¸è¦ç”¨finalä¿®é¥°class,hibernateç”¨cglibä»£ç†ç”Ÿæˆä»£ç†å¯¹è±¡.ä»£ç†å¯¹è±¡æ˜¯ç»§æ‰¿è¢«ä»£ç†å¯¹è±¡.è‹¥è¢«finalä¿®é¥°.å°†æ— æ³•ç”Ÿæˆä»£ç†\n- æˆå‘˜å˜é‡ç§æœ‰,å±æ€§ä½¿ç”¨åŒ…è£…ç±»å‹\n- æä¾›get/setæ–¹æ³•è®¿é—®.éœ€æä¾›å±æ€§\t\t\t\n- æä¾›æ— å‚æ•°æ„é€ \n- æŒä¹…åŒ–ç±»éœ€è¦æä¾›oid.ä¸æ•°æ®åº“ä¸­çš„ä¸»é”®åˆ—å¯¹åº”\n\normå…ƒæ•°æ®é…ç½®è¡¨ä¸å®ä½“å¯¹è±¡çš„å…³ç³»é…ç½®æ–‡ä»¶src-&gt;è¡¨å.hbm.xml\n- å¯¼å…¥mappingçº¦æŸ windowèœå•--&gt; preference--&gt;cata\n- ä½ç½®ï¼šWeb App Libraries--hibernate-core-5.0.7.final.jar-org.hibernate-hibernate-mapping-3.0.dtd\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-mapping PUBLIC \n\"-//Hibernate/Hibernate Mapping DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-mapping-3.0.dtd\"&gt;\n&lt;!-- packageå±æ€§:å¡«å†™ä¸€ä¸ªåŒ…å.åœ¨å…ƒç´ å†…éƒ¨å‡¡æ˜¯éœ€è¦ä¹¦å†™å®Œæ•´ç±»åçš„å±æ€§,å¯ä»¥ç›´æ¥å†™ç®€å•ç±»åäº†. --&gt;\n&lt;hibernate-mapping package=\"\" &gt;\n\t&lt;!--classå…ƒç´ : é…ç½®å®ä½“ä¸è¡¨çš„å¯¹åº”å…³ç³»çš„ name: å®Œæ•´ç±»å table:æ•°æ®åº“è¡¨å--&gt;\n\t&lt;class name=\"\" table=\"\" &gt;\n\t\t&lt;!-- idå…ƒç´ :é…ç½®ä¸»é”®æ˜ å°„çš„å±æ€§ name: å¡«å†™ä¸»é”®å¯¹åº”å±æ€§å\n\t\t\tcolumn(å¯é€‰): å¡«å†™è¡¨ä¸­çš„ä¸»é”®åˆ—å.é»˜è®¤å€¼:åˆ—åä¼šé»˜è®¤ä½¿ç”¨å±æ€§å\n\t\t\ttype(å¯é€‰):å¡«å†™åˆ—(å±æ€§)çš„ç±»å‹.hibernateä¼šè‡ªåŠ¨æ£€æµ‹å®ä½“çš„å±æ€§ç±»å‹.\n\t\t\t\t\tæ¯ä¸ªç±»å‹æœ‰ä¸‰ç§å¡«æ³•: javaç±»å‹|hibernateç±»å‹|æ•°æ®åº“ç±»å‹\n\t\t\tnot-null(å¯é€‰):é…ç½®è¯¥å±æ€§(åˆ—)æ˜¯å¦ä¸èƒ½ä¸ºç©º. é»˜è®¤å€¼:false\n\t\t\tlength(å¯é€‰):é…ç½®æ•°æ®åº“ä¸­åˆ—çš„é•¿åº¦. é»˜è®¤å€¼:ä½¿ç”¨æ•°æ®åº“ç±»å‹çš„æœ€å¤§é•¿åº¦--&gt;\n\t\t&lt;id name=\"\"  column=\"\"&gt;//å±æ€§åå’Œåˆ—å\n\t\t\t&lt;generator class=\"native\"&gt;&lt;/generator&gt;\n\t\t\t&lt;!--generatorä¸»é”®ç”Ÿæˆç­–ç•¥\n\t\t\tä»£ç†ä¸»é”®ï¼š\n\t\t\tidentity : ä¸»é”®è‡ªå¢.ç”±æ•°æ®åº“æ¥ç»´æŠ¤ä¸»é”®å€¼.å½•å…¥æ—¶ä¸éœ€è¦æŒ‡å®šä¸»é”®.\n\t\t\tsequence: Oracleä¸­çš„ä¸»é”®ç”Ÿæˆç­–ç•¥.\n\t\t\thilo(äº†è§£): é«˜ä½ä½ç®—æ³•.ä¸»é”®è‡ªå¢.ç”±hibernateæ¥ç»´æŠ¤.å¼€å‘æ—¶ä¸ä½¿ç”¨.\n\t\t\tnative:hilo+sequence+identity è‡ªåŠ¨ä¸‰é€‰ä¸€ç­–ç•¥.ï¼ˆä½¿ç”¨è¿™ä¸ªæ¢æ•°æ®åº“ä¸ç”¨æ”¹ï¼‰\n\t\t\tincrement(äº†è§£): ä¸»é”®è‡ªå¢.ç”±hibernateæ¥ç»´æŠ¤.æ¯æ¬¡æ’å…¥å‰å…ˆæŸ¥è¯¢è¡¨ä¸­idæœ€å¤§å€¼+1ä½œä¸ºæ–°ä¸»é”®å€¼.çº¿ç¨‹ä¸å®‰å…¨ï¼Œæ•ˆç‡ä½å¼€å‘ä¸ä½¿ç”¨\n\t\t\tuuid: äº§ç”Ÿéšæœºå­—ç¬¦ä¸²ä½œä¸ºä¸»é”®. ä¸»é”®ç±»å‹å¿…é¡»ä¸ºstring ç±»å‹.\n\n\t\t\tè‡ªç„¶ä¸»é”®ï¼šassigned:è‡ªç„¶ä¸»é”®ç”Ÿæˆç­–ç•¥. hibernateä¸ä¼šç®¡ç†ä¸»é”®å€¼.å½•å…¥æ—¶æŒ‡å®šä¸»é”®. --&gt;\n\t\t&lt;/id&gt;\n\t\t&lt;property name=\"\" column=\"\" &gt;&lt;/property&gt;&lt;!--ä¸ä¸Šé¢å·®ä¸å¤š--&gt;\n\t&lt;/class&gt;\n&lt;/hibernate-mapping&gt;\n\nä¸»é…ç½®æ–‡ä»¶(srcç›®å½•--&gt;hibernate.cfg.xml)\n- å¯¼å…¥configurationçº¦æŸwindowèœå•--&gt; preference--&gt;cata\n- ä½ç½®Web App Libraries--hibernate-core-5.0.7.final.jar-org.hibernate-hibernate-configuration-3.0.dtd\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE hibernate-configuration PUBLIC\n\"-//Hibernate/Hibernate Configuration DTD 3.0//EN\"\n\"http://www.hibernate.org/dtd/hibernate-configuration-3.0.dtd\"&gt;\n&lt;hibernate-configuration&gt;\n\t&lt;session-factory&gt;\n\t\t&lt;property name=\"hibernate.connection.driver_class\"&gt;com.mysql.jdbc.Driver&lt;/property&gt; \n\t\t&lt;property name=\"hibernate.connection.url\"&gt;jdbc:mysql:///hibernate&lt;/property&gt;\n\t\t&lt;property name=\"hibernate.connection.username\"&gt;root&lt;/property&gt;\n\t\t&lt;property name=\"hibernate.connection.password\"&gt;1234&lt;/property&gt;\n\t\t&lt;property name=\"hibernate.dialect\"&gt;org.hibernate.dialect.MySQLDialect&lt;/property&gt;\n\n\t\t&lt;property name=\"hibernate.show_sql\"&gt;true&lt;/property&gt;\n\t\t&lt;property name=\"hibernate.format_sql\"&gt;true&lt;/property&gt;\n\t\t&lt;!-- ## auto schema export  è‡ªåŠ¨å¯¼å‡ºè¡¨ç»“æ„. è‡ªåŠ¨å»ºè¡¨\n\t\tcreateè‡ªåŠ¨å»ºè¡¨.æ¯æ¬¡æ¡†æ¶è¿è¡Œéƒ½åˆ›å»ºæ–°è¡¨.ä»¥å‰è¡¨å°†ä¼šè¢«è¦†ç›–,è¡¨æ•°æ®ä¼šä¸¢å¤±.(å¼€å‘æµ‹è¯•ä½¿ç”¨)\n\t\tcreate-dropè‡ªåŠ¨å»ºè¡¨.æ¯æ¬¡æ¡†æ¶è¿è¡Œç»“æŸéƒ½ä¼šå°†æ‰€æœ‰è¡¨åˆ é™¤.(å¼€å‘ç¯å¢ƒä¸­æµ‹è¯•ä½¿ç”¨)\n\t\tupdate(æ¨è)è‡ªåŠ¨ç”Ÿæˆè¡¨.å¦‚æœå·²ç»å­˜åœ¨ä¸ä¼šå†ç”Ÿæˆ.å¦‚æœè¡¨æœ‰å˜åŠ¨.è‡ªåŠ¨æ›´æ–°è¡¨(ä¸åˆ é™¤ä»»ä½•æ•°æ®)\n\t\tvalidateæ ¡éªŒ.ä¸è‡ªåŠ¨ç”Ÿæˆè¡¨.æ¯æ¬¡å¯åŠ¨ä¼šæ ¡éªŒæ•°æ®åº“ä¸­è¡¨æ˜¯å¦æ­£ç¡®.æ ¡éªŒå¤±è´¥.--&gt;\n\t\t&lt;property name=\"hibernate.hbm2ddl.auto\"&gt;update&lt;/property&gt;\t\n\t\t&lt;mapping resource=\"com/hechuangjun/domain/Customer.hbm.xml\" /&gt;//å¼•å…¥ormå…ƒæ•°æ®\n\t\t&lt;!--æŒ‡å®šæ•°æ®åº“çš„éš”ç¦»çº§åˆ«\n\t\thibernate.connection.isolation 1|2|4|8\t\t\n\t\t0001\t1\tè¯»æœªæäº¤\n\t\t0010\t2\tè¯»å·²æäº¤\n\t\t0100\t4\tå¯é‡å¤è¯»ï¼ˆmysqlï¼‰é»˜è®¤\n\t\t1000\t8\tä¸²è¡ŒåŒ–--&gt;\n\t\t&lt;property name=\"hibernate.connection.isolation\"&gt;4&lt;/property&gt;\n\t\t&lt;!-- æŒ‡å®šsessionä¸å½“å‰çº¿ç¨‹ç»‘å®š --&gt;\n\t\t&lt;property name=\"hibernate.current_session_context_class\"&gt;thread&lt;/property&gt;\n\t&lt;/session-factory&gt;\n&lt;/hibernate-configuration&gt;\n\næµ‹è¯•\nclass Test Hibernate {\n\t@Test\n\tpublic void fun(){\n\t\tConfiguration configuration = new Configuration().configure();\n\t\tSessionFactory sessionfactory = configuration.buildSessionFactory();\n\t\tSession session = sessionfactory.openSession();\n\t\tTransaction tx = session.beginTransaction();\n\t\t//</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/2204f0c7b2f5291d24e6d.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Mybatis",
      "url": "https://javaguide.cn/backend/ormframework/mybatis.html",
      "id": "https://javaguide.cn/backend/ormframework/mybatis.html",
      "summary": "Mybatis 1. Mybatisä»‹ç» 2. Mybatisæ¶æ„ 3. Mybatiså…¥é—¨ç¨‹åº 4. MapperåŠ¨æ€ä»£ç†å¼€å‘æŒä¹…å±‚æ–¹æ³• 5. SqlMapConfig.xmlé…ç½®æ–‡ä»¶ 6. Mapper.xml 7. Mybatisæ•´åˆspring 8. Mybatisé€†å‘å·¥ç¨‹ï¼ˆäº†è§£ï¼‰ 9. åˆ†é¡µæ’ä»¶PageHelper 1. Mybatisä»‹ç» ...",
      "content_html": "<p>Mybatis</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-mybatis%E4%BB%8B%E7%BB%8D\">1. Mybatisä»‹ç»</a></li>\n<li><a href=\"#2-mybatis%E6%9E%B6%E6%9E%84\">2. Mybatisæ¶æ„</a></li>\n<li><a href=\"#3-mybatis%E5%85%A5%E9%97%A8%E7%A8%8B%E5%BA%8F\">3. Mybatiså…¥é—¨ç¨‹åº</a></li>\n<li><a href=\"#4-mapper%E5%8A%A8%E6%80%81%E4%BB%A3%E7%90%86%E5%BC%80%E5%8F%91%E6%8C%81%E4%B9%85%E5%B1%82%E6%96%B9%E6%B3%95\">4. MapperåŠ¨æ€ä»£ç†å¼€å‘æŒä¹…å±‚æ–¹æ³•</a></li>\n<li><a href=\"#5-sqlmapconfigxml%E9%85%8D%E7%BD%AE%E6%96%87%E4%BB%B6\">5. SqlMapConfig.xmlé…ç½®æ–‡ä»¶</a></li>\n<li><a href=\"#6-mapperxml\">6. Mapper.xml</a></li>\n<li><a href=\"#7-mybatis%E6%95%B4%E5%90%88spring\">7. Mybatisæ•´åˆspring</a></li>\n<li><a href=\"#8-mybatis%E9%80%86%E5%90%91%E5%B7%A5%E7%A8%8B%E4%BA%86%E8%A7%A3\">8. Mybatisé€†å‘å·¥ç¨‹ï¼ˆäº†è§£ï¼‰</a></li>\n<li><a href=\"#9-%E5%88%86%E9%A1%B5%E6%8F%92%E4%BB%B6pagehelper\">9. åˆ†é¡µæ’ä»¶PageHelper</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. Mybatisä»‹ç»</h1>\n<ul>\n<li>MyBatisæ˜¯ä¼˜ç§€çš„æŒä¹…å±‚æ¡†æ¶ï¼Œå¯¹jdbcçš„æ“ä½œæ•°æ®åº“çš„è¿‡ç¨‹è¿›è¡Œå°è£…</li>\n<li>ä½¿å¼€å‘è€…åªéœ€è¦å…³æ³¨SQLæœ¬èº«ï¼Œè€Œä¸éœ€è¦èŠ±è´¹ç²¾åŠ›å»å¤„ç†ä¾‹å¦‚æ³¨å†Œé©±åŠ¨ã€åˆ›å»ºconnectionã€åˆ›å»ºstatementã€æ‰‹åŠ¨è®¾ç½®å‚æ•°ã€ç»“æœé›†æ£€ç´¢ç­‰jdbcç¹æ‚çš„è¿‡ç¨‹ä»£ç </li>\n<li>Mybatisé€šè¿‡xmlæˆ–æ³¨è§£çš„æ–¹å¼å°†è¦æ‰§è¡Œçš„å„ç§statementï¼ˆstatementã€preparedStatemntã€CallableStatementï¼‰é…ç½®èµ·æ¥ã€‚å¹¶é€šè¿‡javaå¯¹è±¡å’Œstatementä¸­çš„sqlè¿›è¡Œæ˜ å°„ç”Ÿæˆæœ€ç»ˆæ‰§è¡Œçš„sqlè¯­å¥ï¼Œæœ€åç”±mybatisæ¡†æ¶æ‰§è¡Œsqlå¹¶å°†ç»“æœæ˜ å°„æˆjavaå¯¹è±¡å¹¶è¿”å›</li>\n</ul>\n<h1>2. Mybatisæ¶æ„</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/1500ef07f438bf61f8679.png\" alt=\"mybatis.png\" tabindex=\"0\"><figcaption>mybatis.png</figcaption></figure>\n<h1>3. Mybatiså…¥é—¨ç¨‹åº</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…\ncommons-logging-1.1.1.jar\njavassist-3.17.1-GA.jar\nlog4j-1.2.17.jar\nlog4j-api-2.0-rc1.jar\nlog4j-core-2.0-rc1.jar\nslf4j-api-1.7.5.jar\nslf4j-log4j12-1.7.5.jar\nasm-3.3.1.jar\ncglib-2.2.2.jar\n\nåœ¨srcä¸‹åˆ›å»ºlog4j.properties\n# Global logging configuration\nlog4j.rootLogger=DEBUG, stdout\n# Console output...\nlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\nlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\nlog4j.appender.stdout.layout.ConversionPattern=%5p [%t] - %m%n\nmybatisé»˜è®¤ä½¿ç”¨log4jä½œä¸ºè¾“å‡ºæ—¥å¿—ä¿¡æ¯ã€‚\n\t\nåœ¨srcä¸‹åˆ›å»ºSqlMapConfig.xml\nSqlMapConfig.xmlæ˜¯mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼Œå†…å®¹ä¸ºæ•°æ®æºã€äº‹åŠ¡ç®¡ç†\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n\t&lt;!DOCTYPE configuration\n\tPUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"\n\t\"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;\n\t&lt;configuration&gt;\n\t\t&lt;!-- å’Œspringæ•´åˆå environmentsé…ç½®å°†åºŸé™¤ --&gt;\n\t\t&lt;environments default=\"development\"&gt;\n\t\t\t&lt;environment id=\"development\"&gt;\n\t\t\t&lt;!-- ä½¿ç”¨jdbcäº‹åŠ¡ç®¡ç† --&gt;\n\t\t\t&lt;transactionManager type=\"JDBC\" /&gt;\n\t\t\t\t&lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt;\n\t\t\t\t&lt;dataSource type=\"POOLED\"&gt;\n\t\t\t\t\t&lt;property name=\"driver\" value=\"com.mysql.jdbc.Driver\" /&gt;\n\t\t\t\t\t&lt;property name=\"url\" value=\"jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8\" /&gt;\n\t\t\t\t\t&lt;property name=\"username\" value=\"root\" /&gt;\n\t\t\t\t\t&lt;property name=\"password\" value=\"root\" /&gt;\n\t\t\t\t&lt;/dataSource&gt;\n\t\t\t&lt;/environment&gt;\n\t\t&lt;/environments&gt;\n\t\t&lt;!--åŠ è½½é…ç½®æ–‡ä»¶--&gt;\n\t\t&lt;mappers&gt;\n\t\t\t&lt;mapper resource=\"sqlmap/User.xml\"/&gt;\n\t\t&lt;/mappers&gt;\n\t&lt;/configuration&gt;\n\nåˆ›å»ºpojoç±»ç”Ÿæˆsetã€getæ–¹æ³•å¹¶åˆ›å»ºå¯¹åº”çš„è¡¨\n\nåœ¨srcä¸‹çš„sqlmapç›®å½•ä¸‹åˆ›å»ºsqlæ˜ å°„æ–‡ä»¶User.xml\nmybatisæ¡†æ¶éœ€è¦åŠ è½½Mapper.xmlæ˜ å°„æ–‡ä»¶ å°†user.xmlæ·»åŠ åœ¨SqlMapConfig.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n\t&lt;!DOCTYPE mapper\n\tPUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n\t\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;\n\t&lt;!-- namespaceï¼šå‘½åç©ºé—´ï¼Œç”¨äºéš”ç¦»sql --&gt;\n\t&lt;mapper namespace=\"test\"&gt;\n\t&lt;!-- id:statementçš„id æˆ–è€…å«åšsqlçš„id--&gt;\n\t&lt;!-- parameterType:å£°æ˜è¾“å…¥å‚æ•°çš„ç±»å‹ --&gt;\n\t&lt;!-- resultType:å£°æ˜è¾“å‡ºç»“æœçš„ç±»å‹ï¼Œåº”è¯¥å¡«å†™pojoçš„å…¨è·¯å¾„ --&gt;\n\t&lt;!-- #{}ï¼šè¾“å…¥å‚æ•°çš„å ä½ç¬¦ï¼Œç›¸å½“äºjdbcçš„ï¼Ÿ --&gt;\n\t&lt;!--å®ç°æ ¹æ®idæŸ¥è¯¢ç”¨æˆ·ï¼ˆä¼ å…¥åŸºæœ¬å€¼ï¼‰--&gt;\n\t&lt;select id=\"queryUserById\" parameterType=\"int\" resultType=\"cn.mybatis.pojo.User\"&gt;\n\t\tSELECT * FROM `user` WHERE id  = #{id}\n\t&lt;/select&gt;\n\t&lt;!-- å¦‚æœè¿”å›å¤šä¸ªç»“æœï¼Œmybatisä¼šè‡ªåŠ¨æŠŠè¿”å›çš„ç»“æœæ”¾åœ¨listå®¹å™¨ä¸­ --&gt;\n\t&lt;!-- resultTypeçš„é…ç½®å’Œè¿”å›ä¸€ä¸ªç»“æœçš„é…ç½®ä¸€æ · --&gt;\n\t&lt;!-- â‘ æ–¹å¼ä¸€ï¼šå®ç°æ ¹æ®ç”¨æˆ·åæ¨¡ç³ŠæŸ¥è¯¢ç”¨æˆ· --&gt;\n\t&lt;select id=\"queryUserByUsername1\" parameterType=\"string\" resultType=\"cn.itcast.mybatis.pojo.User\"&gt;\n\t\tSELECT * FROM `user` WHERE username LIKE #{username}\n\t&lt;/select&gt;\n\t&lt;!-- â‘¡æ–¹å¼äºŒï¼šå®ç°æ ¹æ®ç”¨æˆ·åæ¨¡ç³ŠæŸ¥è¯¢ç”¨æˆ·--&gt;\n\t&lt;!-- å¦‚æœä¼ å…¥çš„å‚æ•°æ˜¯ç®€å•æ•°æ®ç±»å‹ï¼Œ${}é‡Œé¢å¿…é¡»å†™value --&gt;\n\t&lt;select id=\"queryUserByUsername2\" parameterType=\"string\" resultType=\"cn.itcast.mybatis.pojo.User\"&gt;\n\t\tSELECT * FROM `user` WHERE username LIKE '%${value}%'\n\t&lt;/select&gt;\n\t&lt;!-- å®ç°æ·»åŠ ç”¨æˆ·(ä¼ å…¥å¯¹è±¡) --&gt;\n\t&lt;insert id=\"saveUser\" parameterType=\"cn.itcast.mybatis.pojo.User\"&gt;\n\t\tINSERT INTO `user`\n\t\t(username,birthday,sex,address) VALUES\n\t\t(#{username},#{birthday},#{sex},#{address})\n\t&lt;/insert&gt;\t\n\t&lt;!-- mysqlè‡ªå¢ä¸»é”®è¿”å›--&gt;\n\t&lt;insert id=\"saveUser\" parameterType=\"cn.mybatis.pojo.User\"&gt;\n\t&lt;!-- selectKey æ ‡ç­¾å®ç°ä¸»é”®è¿”å› --&gt;\n\t&lt;!-- keyColumn:ä¸»é”®å¯¹åº”çš„è¡¨ä¸­çš„å“ªä¸€åˆ— --&gt;\n\t&lt;!-- keyPropertyï¼šä¸»é”®å¯¹åº”çš„pojoä¸­çš„å“ªä¸€ä¸ªå±æ€§ --&gt;\n\t&lt;!-- orderï¼šè®¾ç½®åœ¨æ‰§è¡Œinsertè¯­å¥å‰æ‰§è¡ŒæŸ¥è¯¢idçš„sqlï¼Œ\n\tåœ¨æ‰§è¡Œinsertè¯­å¥ä¹‹åæ‰§è¡ŒæŸ¥è¯¢idçš„sql --&gt;\n\t&lt;!-- resultTypeï¼šè®¾ç½®è¿”å›çš„idçš„ç±»å‹ --&gt;\n\t&lt;!-- LAST_INSERT_ID():æ˜¯mysqlçš„å‡½æ•°ï¼Œè¿”å›auto_incrementè‡ªå¢åˆ—æ–°è®°å½•idå€¼--&gt;\n\t&lt;selectKey keyColumn=\"id\" keyProperty=\"id\" order=\"AFTER\" resultType=\"int\"&gt;\n\t\tSELECT LAST_INSERT_ID()\n\t&lt;/selectKey&gt;\n\t\tINSERT INTO `user`\n\t\t(username,birthday,sex,address) VALUES\n\t\t(#{username},#{birthday},#{sex},#{address})\n\t&lt;/insert&gt;\n\t&lt;!--mysql uuidå®ç°ä¸»é”®è¿”å› æ³¨æ„è¿™é‡Œä½¿ç”¨çš„orderæ˜¯â€œBEFOREâ€--&gt;\n\t&lt;selectKey keyColumn=\"id\" keyProperty=\"id\" order=\"BEFORE\" resultType=\"string\"&gt;\n\t\tSELECT LAST_INSERT_ID()\n\t&lt;/selectKey&gt;\n\t\tINSERT INTO `user`\n\t\t(username,birthday,sex,address) VALUES\n\t\t(#{username},#{birthday},#{sex},#{address})\n\t&lt;/insert&gt;\n\t&lt;!--ä¿®æ”¹ç”¨æˆ·ï¼ˆä¼ å…¥å¯¹è±¡ï¼‰--&gt;\n\t&lt;update id=\"updateUserById\" parameterType=\"cn.mybatis.pojo.User\"&gt;\n\t\tUPDATE `user` SET username = #{username} WHERE id = #{id}\n\t&lt;/update&gt;\t\t\n\t&lt;!-- åˆ é™¤ç”¨æˆ· --&gt;\n\t&lt;delete id=\"deleteUserById\" parameterType=\"int\"&gt;\n\t\tdelete from user where id=#{id}\n\t&lt;/delete&gt;\t\n&lt;/mapper&gt;\n\t\t\næµ‹è¯•ç¨‹åºï¼š\n1. åˆ›å»ºSqlSessionFactoryBuilderå¯¹è±¡\n2. åŠ è½½SqlMapConfig.xmlé…ç½®æ–‡ä»¶\n3. åˆ›å»ºSqlSessionFactoryå¯¹è±¡\n4. åˆ›å»ºSqlSessionå¯¹è±¡\n5. æ‰§è¡ŒSqlSessionå¯¹è±¡æ‰§è¡ŒæŸ¥è¯¢ï¼Œè·å–ç»“æœUser\n6. æ‰“å°ç»“æœ\n7. é‡Šæ”¾èµ„æº\n\npublic class MybatisTest {\n\tprivate SqlSessionFactory sqlSessionFactory = null;\n\t@Before\n\tpublic void init() throws Exception {\n\t\tSqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();\n\t\tInputStream inputStream = Resources.getResourceAsStream(\"SqlMapConfig.xml\");\n\t\tthis.sqlSessionFactory = sqlSessionFactoryBuilder.build(inputStream);\n\t}\n\t@Test\n\tpublic void testQueryUserById() throws Exception {\n\t\tSqlSession sqlSession = sqlSessionFactory.openSession();\n\t\tObject user = sqlSession.selectOne(\"queryUserById\", 1);\n\t\tsqlSession.close();\n\t}\n\t@Test\n\tpublic void testQueryUserByUsername1() throws Exception {\n\t\tSqlSession sqlSession = sqlSessionFactory.openSession();\n\t\tList&lt;Object&gt; list =  sqlSession.selectList(\"queryUserByUsername1\", \"%ç‹%\");\n\t\tfor (Object user : list) {\n\t\t\tSystem.out.println(user);\n\t\t}\n\t\tsqlSession.close();\n\t}\n\t@Test\n\tpublic void testQueryUserByUsername2() throws Exception {\n\t\tSqlSession sqlSession = sqlSessionFactory.openSession();\n\t\tList&lt;Object&gt; list = sqlSession.selectList(\"queryUserByUsername2\", \"ç‹\");\n\t\tfor (Object user : list) {\n\t\t\tSystem.out.println(user);\n\t\t}\n\t\tsqlSession.close();\n\t}\t\n\t@Test\n\tpublic void testSaveUser() {\n\t\tSqlSession sqlSession = sqlSessionFactory.openSession();\n\t\tUser user = new User();\n\t\tuser.setUsername(\"å¼ é£\");\n\t\tuser.setSex(\"1\");\n\t\tuser.setBirthday(new Date());\n\t\tuser.setAddress(\"èœ€å›½\");\n\t\tsqlSession.insert(\"saveUser\", user);\n\t\tSystem.out.println(user);\n\t\tsqlSession.commit();\n\t\tsqlSession.close();\n\t}\n\t@Test\n\tpublic void testUpdateUserById() {\n\t\tSqlSession sqlSession = sqlSessionFactory.openSession();\n\t\tUser user = new User();\n\t\tuser.setId(26);\n\t\tuser.setUsername(\"å…³ç¾½\");\n\t\tuser.setSex(\"1\");\n\t\tuser.setBirthday(new Date());\n\t\tuser.setAddress(\"èœ€å›½\");\n\t\tsqlSession.update(\"updateUserById\", user);\n\t\tsqlSession.commit();\n\t\tsqlSession.close();\n\t}\n\t@Test\n\tpublic void testDeleteUserById() {\n\t\tSqlSession sqlSession = sqlSessionFactory.openSession();\n\t\tsqlSession.delete(\"deleteUserById\", 48);\n\t\tsqlSession.commit();\n\t\tsqlSession.close();\n\t}\n}\n</code></pre></div><h1>4. MapperåŠ¨æ€ä»£ç†å¼€å‘æŒä¹…å±‚æ–¹æ³•</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tMapperæ¥å£å¼€å‘æ–¹æ³•åªéœ€ç¼–å†™Mapperæ¥å£ï¼ˆDaoæ¥å£ï¼‰ï¼Œç”±Mybatisæ¡†æ¶æ ¹æ®æ¥å£å®šä¹‰åˆ›å»ºæ¥å£çš„åŠ¨æ€ä»£ç†å¯¹è±¡éµå¾ªä»¥ä¸‹è§„èŒƒï¼š\n\t1ã€Mapper.xmlæ–‡ä»¶ä¸­çš„namespaceä¸mapperæ¥å£çš„å®Œæ•´ç±»åç›¸åŒã€‚\n\t2ã€Mapperæ¥å£æ–¹æ³•åå’ŒMapper.xmlä¸­å®šä¹‰çš„æ¯ä¸ªstatementçš„idç›¸åŒ \n\t3ã€Mapperæ¥å£æ–¹æ³•çš„è¾“å…¥å‚æ•°ç±»å‹å’Œmapper.xmlä¸­å®šä¹‰çš„æ¯ä¸ªsqlçš„parameterTypeçš„ç±»å‹ç›¸åŒ\n\t4ã€Mapperæ¥å£æ–¹æ³•çš„è¾“å‡ºå‚æ•°ç±»å‹å’Œmapper.xmlä¸­å®šä¹‰çš„æ¯ä¸ªsqlçš„resultTypeçš„ç±»å‹ç›¸åŒ\n\n\tMapper.xml(æ˜ å°„æ–‡ä»¶)å¿…é¡»æ»¡è¶³è§„èŒƒ\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n\t\t&lt;!DOCTYPE mapper\n\t\tPUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n\t\t\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;\n\t\t&lt;!-- namespaceï¼šå‘½åç©ºé—´ï¼Œç”¨äºéš”ç¦»sql è¿˜æœ‰ä¸€ä¸ªå¾ˆé‡è¦çš„ä½œç”¨ï¼Œä½¿ç”¨åŠ¨æ€ä»£ç†å¼€å‘DAOï¼Œ\n\t\t1. namespaceå¿…é¡»å’ŒMapperæ¥å£ç±»è·¯å¾„ä¸€è‡´ --&gt;\n\t\t&lt;mapper namespace=\"cn.itcast.mybatis.mapper.UserMapper\"&gt;\n\t\t\t&lt;!-- æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ç”¨æˆ· --&gt;\n\t\t\t&lt;!-- 2. idå¿…é¡»å’ŒMapperæ¥å£æ–¹æ³•åä¸€è‡´ --&gt;\n\t\t\t&lt;!-- 3. parameterTypeå¿…é¡»å’Œæ¥å£æ–¹æ³•å‚æ•°ç±»å‹ä¸€è‡´ --&gt;\n\t\t\t&lt;!-- 4. resultTypeå¿…é¡»å’Œæ¥å£æ–¹æ³•è¿”å›å€¼ç±»å‹ä¸€è‡´ --&gt;\n\t\t\t&lt;select id=\"queryUserById\" parameterType=\"int\" resultType=\"cn.itcast.mybatis.pojo.User\"&gt;\n\t\t\t\tselect * from user where id = #{id}\n\t\t\t&lt;/select&gt;\n\n\t\t\t&lt;!-- æ ¹æ®ç”¨æˆ·åæŸ¥è¯¢ç”¨æˆ· --&gt;\n\t\t\t&lt;select id=\"queryUserByUsername\" parameterType=\"string\" resultType=\"cn.itcast.mybatis.pojo.User\"&gt;\n\t\t\t\tselect * from user where username like '%${value}%'\n\t\t\t&lt;/select&gt;\n\t\t&lt;/mapper&gt;\n\tUserMapper(æ¥å£æ–‡ä»¶)\n\tpublic interface UserMapper {\n\t\tUser queryUserById(int id);\n\t\tList&lt;User&gt; queryUserByUsername(String username);\n\t\t}\n\tSqlMapConfig.xmlæ–‡ä»¶(ä¸€æ ·)\n\tæµ‹è¯•\n\tpublic class UserMapperTest {\n\t\tprivate SqlSessionFactory sqlSessionFactory;\n\t\t@Before\n\t\tpublic void init() throws Exception {\n\t\t\tSqlSessionFactoryBuilder sqlSessionFactoryBuilder = new SqlSessionFactoryBuilder();\n\t\t\tInputStream inputStream = Resources.getResourceAsStream(\"SqlMapConfig.xml\");\n\t\t\tthis.sqlSessionFactory = sqlSessionFactoryBuilder.build(inputStream);\n\t\t}\n\t\t@Test\n\t\tpublic void testQueryUserById() {\n\t\t\tSqlSession sqlSession = this.sqlSessionFactory.openSession();\n\t\t\tUserMapper userMapper = sqlSession.getMapper(UserMapper.class);\n\t\t\tUser user = userMapper.queryUserById(1);\n\t\t\tSystem.out.println(user);\n\t\t\tsqlSession.close();\n\t\t}\n\n\t\t@Test\n\t\tpublic void testQueryUserByUsername() {\n\t\t\tSqlSession sqlSession = this.sqlSessionFactory.openSession();\n\t\t\tUserMapper userMapper = sqlSession.getMapper(UserMapper.class);\n\t\t\tList&lt;User&gt; list = userMapper.queryUserByUsername(\"å¼ \");\n\t\t\tfor (User user : list) {\n\t\t\t\tSystem.out.println(user);\n\t\t\t}\n\t\t\tsqlSession.close();\n\t\t\t}\n\t\t}\n\t}\n</code></pre></div><h1>5. SqlMapConfig.xmlé…ç½®æ–‡ä»¶</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tSqlMapConfig.xmlä¸­é…ç½®çš„å†…å®¹å’Œé¡ºåºå¦‚ä¸‹ï¼š\n\tpropertiesï¼ˆå±æ€§ï¼‰\n\tsettingsï¼ˆå…¨å±€é…ç½®å‚æ•°ï¼‰\n\ttypeAliasesï¼ˆç±»å‹åˆ«åï¼‰\n\ttypeHandlersï¼ˆç±»å‹å¤„ç†å™¨ï¼‰\n\tobjectFactoryï¼ˆå¯¹è±¡å·¥å‚ï¼‰\n\tpluginsï¼ˆæ’ä»¶ï¼‰\n\tenvironmentsï¼ˆç¯å¢ƒé›†åˆå±æ€§å¯¹è±¡ï¼‰\n\tenvironmentï¼ˆç¯å¢ƒå­å±æ€§å¯¹è±¡ï¼‰\n\ttransactionManagerï¼ˆäº‹åŠ¡ç®¡ç†ï¼‰\n\tdataSourceï¼ˆæ•°æ®æºï¼‰\n\tmappersï¼ˆæ˜ å°„å™¨ï¼‰\n\t\n\tpropertiesï¼ˆå±æ€§ï¼‰\n\tSqlMapConfig.xmlå¯ä»¥å¼•ç”¨javaå±æ€§æ–‡ä»¶ä¸­çš„é…ç½®ä¿¡æ¯å¦‚ä¸‹ï¼š\n\tåœ¨srcä¸‹å®šä¹‰db.propertiesæ–‡ä»¶\n\tjdbc.driver=com.mysql.jdbc.Driver\n\tjdbc.url=jdbc:mysql://localhost:3306/mybatis?characterEncoding=utf-8\n\tjdbc.username=root\n\tjdbc.password=root\n\n\tMyBatisåŠ è½½å±æ€§é¡ºåºï¼šåœ¨propertieså…ƒç´ ä¸­resourceæˆ– url åŠ è½½çš„å±æ€§ï¼Œå®ƒä¼šè¦†ç›–å·²è¯»å–çš„åŒåå±æ€§ã€‚ \n\n\t&lt;configuration&gt;\n\t\t&lt;!-- æ˜¯ç”¨resourceå±æ€§åŠ è½½å¤–éƒ¨é…ç½®æ–‡ä»¶ --&gt;\n\t\t&lt;properties resource=\"db.properties\"&gt;\n\t\t\t&lt;!-- åœ¨propertieså†…éƒ¨ç”¨propertyå®šä¹‰å±æ€§ --&gt;\n\t\t\t&lt;!-- å¦‚æœå¤–éƒ¨é…ç½®æ–‡ä»¶æœ‰è¯¥å±æ€§ï¼Œåˆ™å†…éƒ¨å®šä¹‰å±æ€§è¢«å¤–éƒ¨å±æ€§è¦†ç›– --&gt;\n\t\t\t&lt;property name=\"jdbc.username\" value=\"root123\" /&gt;\n\t\t\t&lt;property name=\"jdbc.password\" value=\"root123\" /&gt;\t\n\t\t&lt;/properties&gt;\n\t\t&lt;typeAliases&gt;\n\t\t\t&lt;!-- å•ä¸ªåˆ«åå®šä¹‰ åœ¨mapper.xmlé…ç½®æ–‡ä»¶ä¸­ï¼Œå°±å¯ä»¥ä½¿ç”¨è®¾ç½®çš„åˆ«åuseräº†ï¼Œåˆ«åå¤§å°å†™ä¸æ•æ„Ÿ--&gt;\n\t\t\t&lt;typeAlias alias=\"user\" type=\"cn.itcast.mybatis.pojo.User\" /&gt;\n\t\t\t&lt;!-- æ‰¹é‡åˆ«åå®šä¹‰ï¼Œæ‰«ææ•´ä¸ªåŒ…ä¸‹çš„ç±»ï¼Œåˆ«åä¸ºç±»åï¼ˆå¤§å°å†™ä¸æ•æ„Ÿï¼‰ --&gt;\n\t\t\t&lt;package name=\"cn.itcast.mybatis.pojo\" /&gt;\n\t\t\t&lt;package name=\"å…¶å®ƒåŒ…\" /&gt;\n\t\t&lt;/typeAliases&gt;\n\t\t&lt;!-- å’Œspringæ•´åˆå environmentsé…ç½®å°†åºŸé™¤ --&gt;\n\t\t&lt;environments default=\"development\"&gt;\n\t\t\t&lt;environment id=\"development\"&gt;\n\t\t\t\t&lt;!-- ä½¿ç”¨jdbcäº‹åŠ¡ç®¡ç† --&gt;\n\t\t\t\t&lt;transactionManager type=\"JDBC\" /&gt;\n\t\t\t\t&lt;!-- æ•°æ®åº“è¿æ¥æ±  --&gt;\n\t\t\t\t&lt;dataSource type=\"POOLED\"&gt;\n\t\t\t\t\t&lt;property name=\"driver\" value=\"${jdbc.driver}\" /&gt;\n\t\t\t\t\t&lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n\t\t\t\t\t&lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n\t\t\t\t\t&lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n\t\t\t\t&lt;/dataSource&gt;\n\t\t\t&lt;/environment&gt;\n\t\t&lt;/environments&gt;\n\t\t&lt;mappers&gt;\n\t\t\t&lt;!-- mappersï¼ˆæ˜ å°„å™¨ï¼‰åŠ è½½Mapper.xmlé…ç½®æ–‡ä»¶ --&gt;\n\t\t\t&lt;!-- â‘ ä½¿ç”¨ç›¸å¯¹äºç±»è·¯å¾„çš„èµ„æºï¼ˆç°åœ¨çš„ä½¿ç”¨æ–¹å¼ï¼‰åŸå§‹daoç¬¬ä¸€ç§æœ‰ç”¨--&gt;\n\t\t\t&lt;mapper resource=\"sqlmap/User.xml\" /&gt;\n\t\t\t&lt;!-- â‘¡ä½¿ç”¨mapperæ¥å£ç±»è·¯å¾„--&gt;\n\t\t\t&lt;!-- è¦æ±‚mapperæ¥å£åç§°å’Œmapperæ˜ å°„æ–‡ä»¶åç§°ç›¸åŒï¼Œä¸”åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ --&gt;\n\t\t\t&lt;!-- &lt;mapper class=\"cn.mybatis.mapper.UserMapper\"/&gt;--&gt;\n\t\t\t&lt;!--â‘¢æ³¨å†ŒæŒ‡å®šåŒ…ä¸‹çš„æ‰€æœ‰mapperæ¥å£--&gt;\n\t\t\t&lt;!--&lt;package name=\"cn.itcast.mybatis.mapper\"/&gt;--&gt;\n\t\t\t&lt;!--è¦æ±‚mapperæ¥å£åç§°å’Œmapperæ˜ å°„æ–‡ä»¶åç§°ç›¸åŒï¼Œä¸”æ”¾åœ¨åŒä¸€ä¸ªç›®å½•ä¸­ã€‚--&gt;\n\t\t\t&lt;!--æ•´åˆspringåç”¨ä»£ç†æ–¹å¼å¼€å‘çš„è¯ï¼Œåä¸¤è€…æ²¡æœ‰ç”¨ï¼ˆé»˜è®¤ï¼‰--&gt;\t\t\t\n\t\t&lt;/mappers&gt;\n\t&lt;/configuration&gt;\n\n</code></pre></div><table>\n<thead>\n<tr>\n<th style=\"text-align:center\">mybatisæ”¯æŒåˆ«å</th>\n<th style=\"text-align:center\">æ˜ å°„çš„ç±»å‹</th>\n<th style=\"text-align:center\">åˆ«å</th>\n<th style=\"text-align:center\">æ˜ å°„çš„ç±»å‹</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">_byte</td>\n<td style=\"text-align:center\">byte</td>\n<td style=\"text-align:center\">byte</td>\n<td style=\"text-align:center\">Byte</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_long</td>\n<td style=\"text-align:center\">long</td>\n<td style=\"text-align:center\">long</td>\n<td style=\"text-align:center\">Long</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_short</td>\n<td style=\"text-align:center\">short</td>\n<td style=\"text-align:center\">short</td>\n<td style=\"text-align:center\">Short</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_int</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">Integer</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_integer</td>\n<td style=\"text-align:center\">int</td>\n<td style=\"text-align:center\">integer</td>\n<td style=\"text-align:center\">Integer</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_double</td>\n<td style=\"text-align:center\">double</td>\n<td style=\"text-align:center\">double</td>\n<td style=\"text-align:center\">Double</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_float</td>\n<td style=\"text-align:center\">float</td>\n<td style=\"text-align:center\">float</td>\n<td style=\"text-align:center\">Float</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">_boolean</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">boolean</td>\n<td style=\"text-align:center\">Boolean</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">string</td>\n<td style=\"text-align:center\">String</td>\n<td style=\"text-align:center\">date</td>\n<td style=\"text-align:center\">Date</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">decimal</td>\n<td style=\"text-align:center\">BigDecimal</td>\n<td style=\"text-align:center\">bigdecimal</td>\n<td style=\"text-align:center\">BigDecimal</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">map</td>\n<td style=\"text-align:center\">Map</td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n</tr>\n</tbody>\n</table>\n<h1>6. Mapper.xml</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Ifæ ‡ç­¾\n&lt;!--æ³¨æ„å­—ç¬¦ä¸²ç±»å‹çš„æ•°æ®éœ€è¦è¦åšä¸ç­‰äºç©ºå­—ç¬¦ä¸²æ ¡éªŒã€‚--&gt;\n&lt;select id=\"queryUserByWhere\" parameterType=\"user\" resultType=\"user\"&gt;\n\tSELECT id, username, birthday, sex, address FROM `user`\n\tWHERE 1=1\n\t&lt;if test=\"sex != null and sex != ''\"&gt;\n\t\tAND sex = #{sex}\n\t&lt;/if&gt;\n\t&lt;if test=\"username != null and username != ''\"&gt;\n\t\tAND username LIKE\n\t\t'%${username}%'\n\t&lt;/if&gt;\n&lt;/select&gt;\n\nWhereæ ‡ç­¾\nä¸Šé¢çš„sqlè¿˜æœ‰where 1=1 è¿™æ ·çš„è¯­å¥ï¼Œå¾ˆéº»çƒ¦ï¼Œå¯ä»¥ä½¿ç”¨whereæ ‡ç­¾è¿›è¡Œæ”¹é€ ,åªèƒ½å¤„ç†å‰é¢çš„andï¼Œä¸èƒ½å¤„ç†åç½®and\n\tæ”¹é€ UserMapper.xmlï¼Œå¦‚ä¸‹\n\t&lt;select id=\"queryUserByWhere\" parameterType=\"user\" resultType=\"user\"&gt;\n\t\tSELECT id, username, birthday, sex, address FROM `user`\n\t\t&lt;!-- whereæ ‡ç­¾å¯ä»¥è‡ªåŠ¨æ·»åŠ whereï¼ŒåŒæ—¶å¤„ç†sqlè¯­å¥ä¸­ç¬¬ä¸€ä¸ªandå…³é”®å­— --&gt;\n\t\t&lt;where&gt;\n\t\t\t&lt;if test=\"sex != null\"&gt;\n\t\t\t\tAND sex = #{sex}\n\t\t\t&lt;/if&gt;\n\t\t\t&lt;if test=\"username != null and username != ''\"&gt;\n\t\t\t\tAND username LIKE\n\t\t\t\t'%${username}%'\n\t\t\t&lt;/if&gt;\n\t\t&lt;/where&gt;\n\t&lt;/select&gt;\n\nSqlç‰‡æ®µ\nSqlä¸­å¯å°†é‡å¤çš„sqlæå–å‡ºæ¥ï¼Œä½¿ç”¨æ—¶ç”¨includeå¼•ç”¨å³å¯ï¼Œè¾¾åˆ°sqlé‡ç”¨çš„ç›®çš„\n&lt;select id=\"queryUserByWhere\" parameterType=\"user\" resultType=\"user\"&gt;\n\t&lt;!-- SELECT id, username, birthday, sex, address FROM `user` --&gt;\n\t&lt;!-- ä½¿ç”¨includeæ ‡ç­¾åŠ è½½sqlç‰‡æ®µï¼›refidæ˜¯sqlç‰‡æ®µid --&gt;\n\tSELECT &lt;include refid=\"userFields\" /&gt; FROM `user`\n&lt;/select&gt;\n\n&lt;!-- å£°æ˜sqlç‰‡æ®µ å¦‚æœè¦ä½¿ç”¨åˆ«çš„Mapper.xmlé…ç½®çš„sqlç‰‡æ®µï¼Œå¯ä»¥åœ¨refidå‰é¢åŠ ä¸Šå¯¹åº”çš„Mapper.xmlçš„namespace\nrefid=\"com.junye.userFields\"--&gt;\n&lt;sql id=\"userFields\"&gt;\n\tid, username, birthday, sex, address\n&lt;/sql&gt;\n\nforeachæ ‡ç­¾\nå‘sqlä¼ é€’æ•°ç»„æˆ–Listï¼Œmybatisä½¿ç”¨foreachè§£æ\nInteger[]â†’ collection=\"array\"ã€\nList&lt;Integer&gt;â†’ collection=\"list\"\nå¦‚æœä»¥ä¸Šä¸¤ä¸ªä¸œè¥¿æ”¾è¿›ç±»ä¸­è¢«åŒ…è£…äº†ï¼Œé‚£ä¹ˆç”¨å±æ€§åè¡¨ç¤º\n&lt;select id=\"queryUserByIds\" parameterType=\"queryVo\" resultType=\"user\"&gt;\n\tSELECT * FROM `user`\n\t&lt;where&gt;\n\t\t&lt;!-- foreachæ ‡ç­¾ï¼Œè¿›è¡Œéå† --&gt;\n\t\t&lt;!-- collectionï¼šéå†çš„é›†åˆï¼Œè¿™é‡Œæ˜¯QueryVoçš„idså±æ€§ --&gt;\n\t\t&lt;!-- itemï¼šéå†çš„é¡¹ç›®ï¼Œå¯ä»¥éšä¾¿å†™ï¼Œï¼Œä½†æ˜¯å’Œåé¢çš„#{}é‡Œé¢è¦ä¸€è‡´ --&gt;\n\t\t&lt;!-- openï¼šåœ¨å‰é¢æ·»åŠ çš„sqlç‰‡æ®µ --&gt;\n\t\t&lt;!-- closeï¼šåœ¨ç»“å°¾å¤„æ·»åŠ çš„sqlç‰‡æ®µ --&gt;\n\t\t&lt;!-- separatorï¼šæŒ‡å®šéå†çš„å…ƒç´ ä¹‹é—´ä½¿ç”¨çš„åˆ†éš”ç¬¦ --&gt;\n\t\t&lt;foreach collection=\"ids\" item=\"item\" open=\"id IN (\" close=\")\" separator=\",\"&gt;\n\t\t\t#{item}\n\t\t&lt;/foreach&gt;\n\t&lt;/where&gt;\n&lt;/select&gt;\n\nä¸€å¯¹å¤šæŸ¥è¯¢\nåœ¨UserMapper.xmlæ·»åŠ sqlï¼Œå¦‚ä¸‹ï¼š\nresultMapï¼Œæ•°æ®åº“å­—æ®µä¸å¯¹è±¡å­—æ®µä¸ä¸€è‡´æ—¶ä½¿ç”¨\n&lt;resultMap type=\"user\" id=\"userOrderResultMap\"&gt;\n\t&lt;id property=\"id\" column=\"id\" /&gt;\n\t&lt;result property=\"username\" column=\"username\" /&gt;\n\t&lt;result property=\"birthday\" column=\"birthday\" /&gt;\n\t&lt;result property=\"sex\" column=\"sex\" /&gt;\n\t&lt;result property=\"address\" column=\"address\" /&gt;\n\n\t&lt;!-- é…ç½®ä¸€å¯¹å¤šçš„å…³ç³» --&gt;\n\t&lt;collection property=\"orders\" javaType=\"list\" ofType=\"order\"&gt;\n\t\t&lt;!-- é…ç½®ä¸»é”®ï¼Œæ˜¯å…³è”Orderçš„å”¯ä¸€æ ‡è¯† --&gt;\n\t\t&lt;id property=\"id\" column=\"oid\" /&gt;\n\t\t&lt;result property=\"number\" column=\"number\" /&gt;\n\t\t&lt;result property=\"createtime\" column=\"createtime\" /&gt;\n\t\t&lt;result property=\"note\" column=\"note\" /&gt;\n\t&lt;/collection&gt;\n&lt;/resultMap&gt;\n</code></pre></div><h1>7. Mybatisæ•´åˆspring</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ•´åˆæ€è·¯\nSqlSessionFactoryå¯¹è±¡åº”è¯¥æ”¾åˆ°springå®¹å™¨ä¸­ä½œä¸ºå•ä¾‹å­˜åœ¨\nMapperä»£ç†å½¢å¼ä¸­ï¼Œåº”è¯¥ä»springå®¹å™¨ä¸­ç›´æ¥è·å¾—mapperçš„ä»£ç†å¯¹è±¡\næ•°æ®åº“çš„è¿æ¥ä»¥åŠæ•°æ®åº“è¿æ¥æ± äº‹åŠ¡ç®¡ç†éƒ½äº¤ç»™springå®¹å™¨æ¥å®Œæˆã€‚\n\nmybatisæ•´åˆåŸç†\nSqlSessionFactoryBean implements FactoryBean&lt;SqlSessionFactory&gt;é‡å†™getobjectæ–¹æ³•è¿”å›SqlSessionFactoryæ³¨å…¥åˆ°springä¸­ï¼Œ\nè€ŒSqlSessionFactoryBeanå°†ç”±å¼€å‘äººå‘˜åœ¨springä¸­å£°æ˜ï¼Œå®Œç¾æ•´åˆ\n\næ•´åˆéœ€è¦çš„jaråŒ…\nspring-core-4.1.3.RELEASE.jar\nspring-expression-4.1.3.RELEASE.jar\nspring-jdbc-4.1.3.RELEASE.jar\nspring-jms-4.1.3.RELEASE.jar\nspring-messaging-4.1.3.RELEASE.jar\nspring-tx-4.1.3.RELEASE.jar\nspring-web-4.1.3.RELEASE.jar\nspring-webmvc-4.1.3.RELEASE.jar\naopalliance-1.0.jar\nasm-3.3.1.jar\naspectjweaver-1.6.11.jar\ncglib-2.2.2.jar\ncommons-dbcp-1.2.2.jar\ncommons-logging-1.1.1.jar\ncommons-pool-1.3.jar\njavassist-3.17.1-GA.jar\njstl-1.2.jar\njunit-4.9.jar\nlog4j-1.2.17.jar\nlog4j-api-2.0-rc1.jar\nlog4j-core-2.0-rc1.jar\nmybatis-3.2.7.jar\nmybatis-spring-1.2.2.jar\nmysql-connector-java-5.1.7-bin.jar\nslf4j-api-1.7.5.jar\nslf4j-log4j12-1.7.5.jar\nspring-aop-4.1.3.RELEASE.jar\nspring-aspects-4.1.3.RELEASE.jar\nspring-beans-4.1.3.RELEASE.jar\nspring-context-4.1.3.RELEASE.jar\nspring-context-support-4.1.3.RELEASE.jar\n\n\nåˆ›å»ºå·¥ç¨‹\nsqlmapConfig.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n\t&lt;!DOCTYPE configuration\n\tPUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"\n\t\"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;\n&lt;configuration&gt;\n\t&lt;!-- è®¾ç½®åˆ«å --&gt;\n\t&lt;typeAliases&gt;\n\t\t&lt;!-- 2. æŒ‡å®šæ‰«æåŒ…ï¼Œä¼šæŠŠåŒ…å†…æ‰€æœ‰çš„ç±»éƒ½è®¾ç½®åˆ«åï¼Œåˆ«åçš„åç§°å°±æ˜¯ç±»åï¼Œå¤§å°å†™ä¸æ•æ„Ÿ --&gt;\n\t\t&lt;package name=\"cn.itcast.mybatis.pojo\" /&gt;\n\t&lt;/typeAliases&gt;\n&lt;/configuration&gt;\n\napplicationContext.xml\n\tSqlSessionFactoryBeanå±äºmybatis-springè¿™ä¸ªjaråŒ…\n\tå¯¹äºspringæ¥è¯´ï¼Œmybatisæ˜¯å¦å¤–ä¸€ä¸ªæ¶æ„ï¼Œéœ€è¦æ•´åˆjaråŒ…ã€‚\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\t&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n\txmlns:context=\"http://www.springframework.org/schema/context\" \n\txmlns:p=\"http://www.springframework.org/schema/p\"\n\txmlns:aop=\"http://www.springframework.org/schema/aop\" \n\txmlns:tx=\"http://www.springframework.org/schema/tx\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd\n\thttp://www.springframework.org/schema/context \n\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd\n\thttp://www.springframework.org/schema/aop \n\thttp://www.springframework.org/schema/aop/spring-aop-4.0.xsd \n\thttp://www.springframework.org/schema/tx \n\thttp://www.springframework.org/schema/tx/spring-tx-4.0.xsd\n\thttp://www.springframework.org/schema/util \n\thttp://www.springframework.org/schema/util/spring-util-4.0.xsd\"&gt;\n\t&lt;context:property-placeholder location=\"classpath:db.properties\" /&gt;\n\t&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n\t\t&lt;property name=\"driverClassName\" value=\"${jdbc.driver}\" /&gt;\n\t\t&lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n\t\t&lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n\t\t&lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n\t\t&lt;property name=\"maxActive\" value=\"10\" /&gt;\n\t\t&lt;property name=\"maxIdle\" value=\"5\" /&gt;\n\t&lt;/bean&gt;\n\t&lt;!-- é…ç½®SqlSessionFactory --&gt;\n\t&lt;bean id=\"sqlSessionFactory\" class=\"org.mybatis.spring.SqlSessionFactoryBean\"&gt;\n\t\t&lt;!-- é…ç½®mybatisæ ¸å¿ƒé…ç½®æ–‡ä»¶ --&gt;\n\t\t&lt;property name=\"configLocation\" value=\"classpath:SqlMapConfig.xml\" /&gt;\n\t\t&lt;!-- é…ç½®æ•°æ®æº --&gt;\n\t\t&lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n\t&lt;/bean&gt;\n&lt;/beans&gt;\ndb.propertiesã€log4j.properties\n\nDaoå¼€å‘(ä½¿ç”¨Mapperä»£ç†å¼€å‘æ–¹å¼)\nç¼–å†™UserMapper.xmlé…ç½®æ–‡ä»¶ï¼Œå¦‚ä¸‹ï¼š\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;\n\t&lt;!DOCTYPE mapper\n\tPUBLIC \"-//mybatis.org//DTD Mapper 3.0//EN\"\n\t\"http://mybatis.org/dtd/mybatis-3-mapper.dtd\"&gt;\n\t&lt;mapper namespace=\"cn.itcast.mybatis.mapper.UserMapper\"&gt;\n\t\t&lt;!-- æ ¹æ®ç”¨æˆ·idæŸ¥è¯¢ --&gt;\n\t\t&lt;select id=\"queryUserById\" parameterType=\"int\" resultType=\"user\"&gt;\n\t\t\tselect * from user where id = #{id}\n\t\t&lt;/select&gt;\n\t&lt;/mapper&gt;\n\nUserMapperæ¥å£å®ç°ç±»\npublic interface UserMapper {\n\tUser queryUserById(int id);\n}\næ‰«æåŒ…å½¢å¼é…ç½®mapperï¼ˆæ³¨æ„è¿™ä¸ªè‡ªåŠ¨å¯»æ‰¾sqlsessionï¼Œæ‰€ä»¥ä¸ç”¨æ³¨å…¥sqlsessionï¼Œè‡ªåŠ¨æ‰«æè¯¥åŒ…ä¸‹ï¼Œ\nä¸åŒ…æ‹¬å­åŒ…çš„æ‰€æœ‰æ¥å£ï¼Œé»˜è®¤åŠ è½½è¯¥åŒ…ä¸‹çš„ä¸æ¥å£åŒåçš„xmlæ–‡ä»¶ä½œä¸ºMapperï¼Œä¹Ÿå¯ä»¥åœ¨sqlMapperä¸­é…ç½®mapper resourceä»¥åŠ è½½å…¶ä»–çš„Mapper\næ²¡æ‰¾åˆ°mapper.xmlå°±æŠ¥é”™ï¼Œå¯ä»¥åœ¨sqlMapperConfig.xmlé…ç½®mapper resourceè§£å†³å½“é»˜è®¤å’Œè‡ªå·±é…çš„æ–‡ä»¶ä¸€æ ·çš„æ—¶å€™ï¼Œä¼˜å…ˆåŠ è½½é»˜è®¤ä½ç½®çš„\næ¯ä¸ªmapperä»£ç†å¯¹è±¡çš„idå°±æ˜¯ç±»åï¼Œé¦–å­—æ¯å°å†™\n&lt;!-- æ‰«æåŒ…æ–¹å¼é…ç½®ä»£ç† --&gt;\n&lt;bean class=\"org.mybatis.spring.mapper.MapperScannerConfigurer\"&gt;\n\t&lt;!-- é…ç½®Mapperæ¥å£ --&gt;\n\t&lt;property name=\"basePackage\" value=\"cn.mybatis.mapper\" /&gt;\n&lt;/bean&gt;\n</code></pre></div><h1>8. Mybatisé€†å‘å·¥ç¨‹ï¼ˆäº†è§£ï¼‰</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tç”Ÿæˆé€†å‘å·¥ç¨‹ä»£ç \n\tæ‰¾åˆ°ä¸‹å›¾æ‰€ç¤ºçš„javaæ–‡ä»¶ï¼Œæ‰§è¡Œå·¥ç¨‹mainä¸»å‡½æ•°,\n\tåˆ·æ–°å·¥ç¨‹ï¼Œå‘ç°ä»£ç ç”Ÿæˆ\n\n\tæ³¨æ„\n\t1.é€†å‘å·¥ç¨‹ç”Ÿæˆçš„ä»£ç åªèƒ½åšå•è¡¨æŸ¥è¯¢\n\t2.ä¸èƒ½åœ¨ç”Ÿæˆçš„ä»£ç ä¸Šè¿›è¡Œæ‰©å±•ï¼Œå› ä¸ºå¦‚æœæ•°æ®åº“å˜æ›´ï¼Œ\n\téœ€è¦é‡æ–°ä½¿ç”¨é€†å‘å·¥ç¨‹ç”Ÿæˆä»£ç ï¼ŒåŸæ¥ç¼–å†™çš„ä»£ç å°±è¢«è¦†ç›–äº†ã€‚\n\t3.ä¸€å¼ è¡¨ä¼šç”Ÿæˆ4ä¸ªæ–‡ä»¶\n\n\tä½¿ç”¨å®˜æ–¹ç½‘ç«™çš„Mapperè‡ªåŠ¨ç”Ÿæˆå·¥å…·mybatis-generator-core-1.3.2\n\tæ¥ç”Ÿæˆpoç±»å’ŒMapperæ˜ å°„æ–‡ä»¶\n\tå¯¼å…¥é€†å‘å·¥ç¨‹\n\tä¿®æ”¹é…ç½®æ–‡ä»¶\n\tåœ¨generatorConfig.xmlä¸­é…ç½®Mapperç”Ÿæˆçš„è¯¦ç»†ä¿¡æ¯ï¼Œ\n\t1.ä¿®æ”¹è¦ç”Ÿæˆçš„æ•°æ®åº“è¡¨\n\t2.pojoæ–‡ä»¶æ‰€åœ¨åŒ…è·¯å¾„\n\t3.Mapperæ‰€åœ¨çš„åŒ…è·¯å¾„\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\t&lt;!DOCTYPE generatorConfiguration\n\tPUBLIC \"-//mybatis.org//DTD MyBatis Generator Configuration 1.0//EN\"\n\t\"http://mybatis.org/dtd/mybatis-generator-config_1_0.dtd\"&gt;\n\n\t&lt;generatorConfiguration&gt;\n\t\t&lt;context id=\"testTables\" targetRuntime=\"MyBatis3\"&gt;\n\t\t&lt;commentGenerator&gt;\n\t\t\t&lt;!-- æ˜¯å¦å»é™¤è‡ªåŠ¨ç”Ÿæˆçš„æ³¨é‡Š trueï¼šæ˜¯ ï¼š false:å¦ --&gt;\n\t\t\t&lt;property name=\"suppressAllComments\" value=\"true\" /&gt;\n\t\t&lt;/commentGenerator&gt;\n\t\t\t&lt;!--æ•°æ®åº“è¿æ¥çš„ä¿¡æ¯ï¼šé©±åŠ¨ç±»ã€è¿æ¥åœ°å€ã€ç”¨æˆ·åã€å¯†ç  --&gt;\n\t\t\t&lt;jdbcConnection driverClass=\"com.mysql.jdbc.Driver\" connectionURL=\"jdbc:mysql://localhost:3306/mybatis\" \n\t\t\t\tuserId=\"root\" password=\"root\"&gt;\n\t\t\t&lt;/jdbcConnection&gt;\n\t\t\t&lt;!-- &lt;jdbcConnection driverClass=\"oracle.jdbc.OracleDriver\" connectionURL=\"jdbc:oracle:thin:@127.0.0.1:1521:yycg\" \n\t\t\t\tuserId=\"yycg\" password=\"yycg\"&gt; &lt;/jdbcConnection&gt; --&gt;\n\t\t\t&lt;!-- é»˜è®¤falseï¼ŒæŠŠJDBC DECIMAL å’Œ NUMERIC ç±»å‹è§£æä¸º Integerï¼Œä¸º trueæ—¶æŠŠJDBC DECIMAL å’Œ NUMERIC ç±»å‹è§£æä¸ºjava.math.BigDecimal --&gt;\n\t\t\t&lt;javaTypeResolver&gt;\n\t\t\t\t&lt;property name=\"forceBigDecimals\" value=\"false\" /&gt;\n\t\t\t&lt;/javaTypeResolver&gt;\n\n\t\t&lt;!-- targetProject:ç”ŸæˆPOç±»çš„ä½ç½® --&gt;\n\t\t&lt;javaModelGenerator targetPackage=\"cn.itcast.ssm.po\" targetProject=\".\\src\"&gt;\n\t\t\t&lt;!-- enableSubPackages:æ˜¯å¦è®©schemaä½œä¸ºåŒ…çš„åç¼€ --&gt;\n\t\t\t&lt;property name=\"enableSubPackages\" value=\"false\" /&gt;\n\t\t\t&lt;!-- ä»æ•°æ®åº“è¿”å›çš„å€¼è¢«æ¸…ç†å‰åçš„ç©ºæ ¼ --&gt;\n\t\t\t&lt;property name=\"trimStrings\" value=\"true\" /&gt;\n\t\t&lt;/javaModelGenerator&gt;\n\n\t\t&lt;!-- targetProject:mapperæ˜ å°„æ–‡ä»¶ç”Ÿæˆçš„ä½ç½® --&gt;\n\t\t&lt;sqlMapGenerator targetPackage=\"cn.itcast.ssm.mapper\" targetProject=\".\\src\"&gt;\n\t\t\t&lt;!-- enableSubPackages:æ˜¯å¦è®©schemaä½œä¸ºåŒ…çš„åç¼€ --&gt;\n\t\t\t&lt;property name=\"enableSubPackages\" value=\"false\" /&gt;\n\t\t&lt;/sqlMapGenerator&gt;\n\t\t&lt;!-- targetPackageï¼šmapperæ¥å£ç”Ÿæˆçš„ä½ç½® --&gt;\n\t\t&lt;javaClientGenerator type=\"XMLMAPPER\" targetPackage=\"cn.itcast.ssm.mapper\" targetProject=\".\\src\"&gt;\n\t\t\t&lt;!-- enableSubPackages:æ˜¯å¦è®©schemaä½œä¸ºåŒ…çš„åç¼€ --&gt;\n\t\t&lt;property name=\"enableSubPackages\" value=\"false\" /&gt;\n\t\t\t&lt;/javaClientGenerator&gt;\n\t\t\t&lt;!-- æŒ‡å®šæ•°æ®åº“è¡¨ --&gt;\n\t\t\t&lt;table schema=\"\" tableName=\"user\"&gt;&lt;/table&gt;\n\t\t\t&lt;table schema=\"\" tableName=\"order\"&gt;&lt;/table&gt;\n\t\t&lt;/context&gt;\n\t&lt;/generatorConfiguration&gt;\n\t\n\n</code></pre></div><h1>9. åˆ†é¡µæ’ä»¶PageHelper</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç›®å‰æ”¯æŒOracle,Mysql,MariaDB,SQLite,Hsqldb,PostgreSQLå…­ç§æ•°æ®åº“åˆ†é¡µã€‚\n\næŠŠPageHelperä¾èµ–çš„jaråŒ…æ·»åŠ åˆ°å·¥ç¨‹ä¸­ã€‚å®˜æ–¹æä¾›çš„ä»£ç å¯¹é€†å‘å·¥ç¨‹æ”¯æŒçš„ä¸å¥½ï¼Œä½¿ç”¨å‚è€ƒèµ„æ–™ä¸­çš„pagehelper-fixã€‚\n\nç¬¬äºŒæ­¥ï¼šåœ¨Mybatisé…ç½®xmlä¸­é…ç½®æ‹¦æˆªå™¨æ’ä»¶:\n&lt;plugins&gt;\n    &lt;!-- com.github.pagehelperä¸ºPageHelperç±»æ‰€åœ¨åŒ…å --&gt;\n    &lt;plugin interceptor=\"com.github.pagehelper.PageHelper\"&gt;\n        &lt;!-- è®¾ç½®æ•°æ®åº“ç±»å‹ Oracle,Mysql,MariaDB,SQLite,Hsqldb,PostgreSQLå…­ç§æ•°æ®åº“--&gt;        \n        &lt;property name=\"dialect\" value=\"mysql\"/&gt;\n    &lt;/plugin&gt;\n&lt;/plugins&gt;\n\nç¬¬ä¸‰æ­¥ï¼šåœ¨ä»£ç ä¸­ä½¿ç”¨\n1ã€è®¾ç½®åˆ†é¡µä¿¡æ¯ï¼š\n//è·å–ç¬¬1é¡µï¼Œ10æ¡å†…å®¹ï¼Œé»˜è®¤æŸ¥è¯¢æ€»æ•°count\nPageHelper.startPage(1, 10);\n\n//ç´§è·Ÿç€çš„ç¬¬ä¸€ä¸ªselectæ–¹æ³•ä¼šè¢«åˆ†é¡µ\nList&lt;Country&gt; list = countryMapper.selectIf(1);\n\n2ã€å–åˆ†é¡µä¿¡æ¯\n//åˆ†é¡µåï¼Œå®é™…è¿”å›çš„ç»“æœlistç±»å‹æ˜¯Page&lt;E&gt;ï¼Œå¦‚æœæƒ³å–å‡ºåˆ†é¡µä¿¡æ¯ï¼Œéœ€è¦å¼ºåˆ¶è½¬æ¢ä¸ºPage&lt;E&gt;ï¼Œ\nPage&lt;Country&gt; listCountry = (Page&lt;Country&gt;)list;\nlistCountry.getTotal();\n\n3ã€å–åˆ†é¡µä¿¡æ¯çš„ç¬¬äºŒç§æ–¹æ³•\n//è·å–ç¬¬1é¡µï¼Œ10æ¡å†…å®¹ï¼Œé»˜è®¤æŸ¥è¯¢æ€»æ•°count\nPageHelper.startPage(1, 10);\nList&lt;Country&gt; list = countryMapper.selectAll();\n//ç”¨PageInfoå¯¹ç»“æœè¿›è¡ŒåŒ…è£…\nPageInfo page = new PageInfo(list);\n//æµ‹è¯•PageInfoå…¨éƒ¨å±æ€§\n//PageInfoåŒ…å«äº†éå¸¸å…¨é¢çš„åˆ†é¡µå±æ€§\nassertEquals(1, page.getPageNum());\nassertEquals(10, page.getPageSize());\nassertEquals(1, page.getStartRow());\nassertEquals(10, page.getEndRow());\nassertEquals(183, page.getTotal());\nassertEquals(19, page.getPages());\nassertEquals(1, page.getFirstPage());\nassertEquals(8, page.getLastPage());\nassertEquals(true, page.isFirstPage());\nassertEquals(false, page.isLastPage());\nassertEquals(false, page.isHasPreviousPage());\nassertEquals(true, page.isHasNextPage());\n\n@Test\npublic void testPageHelper() throws Exception {\n\t//åˆå§‹åŒ–springå®¹å™¨\n\tApplicationContext applicationContext = new ClassPathXmlApplicationContext(\"classpath:spring/applicationContext-*.xml\");\n\t//è·å¾—Mapperçš„ä»£ç†å¯¹è±¡\n\tTbItemMapper itemMapper = applicationContext.getBean(TbItemMapper.class);\n\t//è®¾ç½®åˆ†é¡µä¿¡æ¯\n\tPageHelper.startPage(1, 30);\n\t//æ‰§è¡ŒæŸ¥è¯¢\n\tTbItemExample example = new TbItemExample();\n\tList&lt;TbItem&gt; list = itemMapper.selectByExample(example);\n\t//å–åˆ†é¡µä¿¡æ¯\n\tPageInfo&lt;TbItem&gt; pageInfo = new PageInfo&lt;&gt;(list);\n\tSystem.out.println(pageInfo.getTotal());\n\tSystem.out.println(pageInfo.getPages());\n\tSystem.out.println(pageInfo.getPageNum());\n\tSystem.out.println(pageInfo.getPageSize());\n}\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/1500ef07f438bf61f8679.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Http",
      "url": "https://javaguide.cn/backend/protocol/http.html",
      "id": "https://javaguide.cn/backend/protocol/http.html",
      "summary": "http 1. httpåè®® 2. Tomcat(è½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œæ”¯æŒServletå’Œjspè§„èŒƒ)ç›®å½•ç»“æ„ï¼ˆäº†è§£ï¼‰ 3. WEBé¡¹ç›®ç›®å½•ç»“æ„ 4. è½¯ä»¶æ¶æ„ 5. WEBæœåŠ¡å™¨ 6. WEBèµ„æºï¼šå­˜åœ¨äºwebåº”ç”¨æœåŠ¡å™¨å¯ä¾›å¤–ç•Œè®¿é—®çš„èµ„æºå°±æ˜¯webèµ„æº 1. httpåè®® è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºå®šä¹‰WEBæœåŠ¡å™¨å’ŒWEBæµè§ˆå™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹ ç‰¹ç‚¹ï¼šHT...",
      "content_html": "<p>http</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-http%E5%8D%8F%E8%AE%AE\">1. httpåè®®</a></li>\n<li><a href=\"#2-tomcat%E8%BD%BB%E9%87%8F%E7%BA%A7%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E6%94%AF%E6%8C%81servlet%E5%92%8Cjsp%E8%A7%84%E8%8C%83%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84%E4%BA%86%E8%A7%A3\">2. Tomcat(è½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œæ”¯æŒServletå’Œjspè§„èŒƒ)ç›®å½•ç»“æ„ï¼ˆäº†è§£ï¼‰</a></li>\n<li><a href=\"#3-web%E9%A1%B9%E7%9B%AE%E7%9B%AE%E5%BD%95%E7%BB%93%E6%9E%84\">3. WEBé¡¹ç›®ç›®å½•ç»“æ„</a></li>\n<li><a href=\"#4-%E8%BD%AF%E4%BB%B6%E6%9E%B6%E6%9E%84\">4. è½¯ä»¶æ¶æ„</a></li>\n<li><a href=\"#5-web%E6%9C%8D%E5%8A%A1%E5%99%A8\">5. WEBæœåŠ¡å™¨</a></li>\n<li><a href=\"#6-web%E8%B5%84%E6%BA%90%E5%AD%98%E5%9C%A8%E4%BA%8Eweb%E5%BA%94%E7%94%A8%E6%9C%8D%E5%8A%A1%E5%99%A8%E5%8F%AF%E4%BE%9B%E5%A4%96%E7%95%8C%E8%AE%BF%E9%97%AE%E7%9A%84%E8%B5%84%E6%BA%90%E5%B0%B1%E6%98%AFweb%E8%B5%84%E6%BA%90\">6. WEBèµ„æºï¼šå­˜åœ¨äºwebåº”ç”¨æœåŠ¡å™¨å¯ä¾›å¤–ç•Œè®¿é—®çš„èµ„æºå°±æ˜¯webèµ„æº</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. httpåè®®</h1>\n<ul>\n<li>è¶…æ–‡æœ¬ä¼ è¾“åè®®ï¼Œç”¨äºå®šä¹‰WEBæœåŠ¡å™¨å’ŒWEBæµè§ˆå™¨ä¹‹é—´äº¤æ¢æ•°æ®çš„è¿‡ç¨‹</li>\n<li>ç‰¹ç‚¹ï¼šHTTPåè®®é»˜è®¤ç«¯å£80ï¼Œå“åº”å’Œè¯·æ±‚å¿…é¡»æˆå¯¹ï¼Œå…ˆæœ‰è¯·æ±‚åæœ‰å“åº”</li>\n</ul>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">httpåè®®ç»„æˆ</th>\n<th style=\"text-align:center\">ç»„æˆ</th>\n<th style=\"text-align:center\">æè¿°</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Httpè¯·æ±‚åè®®</td>\n<td style=\"text-align:center\">è¯·æ±‚è¡Œ</td>\n<td style=\"text-align:center\">POST/day09/01.http/from.html HTTP/1.1è¯·æ±‚æ ¼å¼çš„ç¬¬ä¸€è¡Œ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">â‘ è¯·æ±‚æ–¹å¼getï¼šè¯·æ±‚å‚æ•°åœ¨urlåé¢,ä¾‹:x.html?a=a&amp;b=b urlé•¿åº¦é™åˆ¶getè¯·æ±‚æ•°æ®å¤§å°ï¼Œæ²¡æœ‰è¯·æ±‚ä½“ï¼Œä¸å®‰å…¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Postï¼šè¯·æ±‚å‚æ•°åœ¨è¯·æ±‚ä½“ï¼Œé•¿åº¦æ— é™åˆ¶ï¼Œå®‰å…¨,é™¤äº†è¡¨å•çš„methodä¸ºpostå¤–ï¼Œå…¶ä»–éƒ½æ˜¯getè¯·æ±‚</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">â‘¡ç»Ÿä¸€èµ„æºå®šä½ç¬¦URl åè®®://åŸŸå:ç«¯å£å·/èµ„æºä½ç½®?å‚æ•°=å€¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">â‘¢åè®®ç‰ˆæœ¬</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">è¯·æ±‚å¤´</td>\n<td style=\"text-align:center\">Hostï¼šlocalhost:8080</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">User-Agent\\refer:é˜²ç›—é“¾ï¼ˆåˆ¤æ–­å®ƒæ˜¯ä¸æ˜¯ä»¥ä»€ä¹ˆå¼€å¤´å°±è¡Œstartswithï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">if-modified-since:æµè§ˆå™¨æœ€åä¸€æ¬¡ç¼“å­˜æ—¶é—´</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">cookie:æµè§ˆå™¨ç¼“å­˜çš„ä¸€ç§</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">è¯·æ±‚ä½“</td>\n<td style=\"text-align:center\">a=a&amp;b=b ä¸€èˆ¬åªæœ‰postè¯·æ±‚æ–¹å¼æ‰æœ‰ï¼Œéƒ½æ˜¯ç”¨æˆ·è¡¨å•æäº¤çš„æ•°æ®</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Httpå“åº”åè®®</td>\n<td style=\"text-align:center\">å“åº”è¡Œ</td>\n<td style=\"text-align:center\">HTTP/1.1 200 OK åè®®/ç‰ˆæœ¬ çŠ¶æ€ç </td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">200ï¼šæˆåŠŸ302ï¼šé‡å®šå‘304ï¼šè®¿é—®æœ¬åœ°ç¼“å­˜404ï¼šæ‰¾ä¸åˆ°èµ„æº500ï¼šæœåŠ¡å™¨å†…éƒ¨é”™è¯¯</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å“åº”å¤´</td>\n<td style=\"text-align:center\">æœåŠ¡å™¨é€šè¿‡å“åº”å¤´æ¥æ§åˆ¶æµè§ˆå™¨çš„è¡Œä¸ºï¼Œä¸åŒå¤´æµè§ˆå™¨çš„æ“ä½œä¸åŒ</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Location:æŒ‡å®šå“åº”çš„è·¯å¾„ï¼Œéœ€è¦ä¸çŠ¶æ€ç 302é…åˆä½¿ç”¨</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Content-Type:å“åº”æ­£æ–‡çš„ç±»å‹(MIMEç±»å‹)text/html:charset=UTF-8</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Content-Disposition:é€šè¿‡æµè§ˆå™¨ä»¥ä¸‹è½½çš„æ–¹å¼è§£ææ­£æ–‡attachment;filename=xx.zip</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">Set-Cookie:æœåŠ¡å™¨å‘æµè§ˆå™¨å†™å…¥cookie</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">å“åº”ä½“</td>\n<td style=\"text-align:center\">æœåŠ¡å™¨å‘ç»™æµè§ˆå™¨çš„æ­£æ–‡ã€å“åº”ä½“æ˜¯æœåŠ¡å™¨å›å†™ç»™å®¢æˆ·ç«¯çš„é¡µé¢æ­£æ–‡</td>\n</tr>\n<tr>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\"></td>\n<td style=\"text-align:center\">æµè§ˆå™¨å°†æ­£æ–‡åŠ è½½åˆ°å†…å­˜ï¼Œç„¶åè§£ææ¸²æŸ“æ˜¾ç¤ºé¡µé¢å†…å®¹</td>\n</tr>\n</tbody>\n</table>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/306a175def763027c2977.png\" alt=\"httpè¯·æ±‚.png\" tabindex=\"0\"><figcaption>httpè¯·æ±‚.png</figcaption></figure>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e60aaac0f67769eb9b331.png\" alt=\"httpå“åº”.png\" tabindex=\"0\"><figcaption>httpå“åº”.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯ä»¥ç”¨ telnet ç¨‹åºæµ‹è¯• telnet 192.168.80.1 8080\nget è¯·æ±‚ç¤ºä¾‹\n\nGET /test2?name=1i&amp;age=10 HTTP/1.1\nHost:1ocalhost\n\npost è¯·æ±‚ç¤ºä¾‹\nPosT /test2 HTTP/1.1 \nHost: localhost\nContent-Type:application/x-www-form-urlencoded\nContent-Length:10\n\nname=zhang&amp;age=10\n\n// javaæ±‚urlencode utf-8\nbytel]bytes =\"å¼ \".getBytes(standardcharsets.UTF_8);\nSystem.out.println(bytes);\nbytes:[-27ï¼Œ-68ï¼Œ-96]\nå³é”®-æŸ¥çœ‹æ–¹å¼-HexæŸ¥çœ‹16è¿›åˆ¶\n\napplication/x-www-form-urlencoed æ ¼å¼ç»†èŠ‚\nã€‚å‚æ•°åˆ†æˆåå­—å’Œå€¼ï¼Œä¸­é—´ç”¨=åˆ†éš”\nã€‚å¤šä¸ªå‚æ•°ä½¿ç”¨ &amp; è¿›è¡Œåˆ†éš”\nã€‚ã€å¼ ã€‘ç­‰ç‰¹æ®Šå­—ç¬¦éœ€è¦ç”¨ encodeURIComponent()ç¼–ç ä¸ºã€%E5%BC%A0ã€‘åæ‰èƒ½å‘é€\nencodeURIComponent(\"å¼ \")\n%E5%BC%AB\n\nå¯ä»¥ç”¨è°·æ­Œæµè§ˆå™¨çš„æ§åˆ¶å°æ±‚æ•°æ®é•¿åº¦\n\"name=zhang&amp;age=18\".length\næ±‚urlencode\n\njson è¯·æ±‚ç¤ºä¾‹\nPosT /test3 HTTP/1.1\nHost: 1ocalhost\nContent-Type:application/json\nContent-Length:25\n{\"name\": \"zhang\" , \"age\" : 18}\n\nåç«¯@RequestBodyå¯¹è±¡æ¥æ”¶\n{\"å±æ€§å\":å±æ€§å€¼}\nå­—ç¬¦ä¸²\"â€\næ•°å­—\ntrue, false\nnull\nå±æ€§å€¼ä¸­æ–‡ä¹Ÿå¯ä»¥ï¼Œä¸ç”¨urlencode\næ±‚é•¿åº¦'{\"name\":\"å¼ \",\"age\":18}'.length\n\nmultipart è¯·æ±‚ç¤ºä¾‹\nPosT /test2 HTTP/1.1\nHost: 1ocalhost\nContent-Type:mutipart/form-data;boundary=123\ncontent-Length:125\n\n--123\nContent-Disposition:form-data;name-\"'name\n\n1isi\n--123\nContent-Disposition:form-data; name=\"age\"\n\n39\n--123--\n\nboundary=123 ç”¨æ¥å®šä¹‰åˆ†éš”ç¬¦\nèµ·å§‹åˆ†éš”ç¬¦æ˜¯ --åˆ†éš”ç¬¦\nç»“æŸåˆ†éš”ç¬¦æ˜¯ --åˆ†éš”ç¬¦--\n\nä½¿ç”¨lengthè®¡ç®—æ—¶ï¼Œä¼šå¿½ç•¥/r/nï¼Œå¯¼è‡´lenå‡å°‘\n\nå®¢æˆ·ç«¯å‘é€\nç¼–ç \no application/x-www-form-urlencoded :url ç¼–ç \no application/json: utf-8 ç¼–ç \no multipart/form-data:æ¯éƒ¨åˆ†ç¼–ç å¯ä»¥ä¸åŒ\nè¡¨å•åªæ”¯æŒä»¥ application/x-www-form-urlencoded å’Œmultipart/form-data æ ¼å¼å‘é€æ•°æ®\næ–‡ä»¶ä¸Šä¼ éœ€è¦ç”¨ multipart/form-data æ ¼å¼\njs ä»£ç å¯ä»¥æ”¯æŒä»»æ„æ ¼å¼å‘é€æ•°æ®\n\næœåŠ¡ç«¯æ¥æ”¶\nå¯¹application/x-www-form-urlencoded å’Œmultipart/form-dataæ ¼å¼çš„æ•°æ®ï¼ŒSpring æ¥æ”¶æ–¹å¼æ˜¯ç»Ÿä¸€çš„ï¼Œåªéœ€è¦ç”¨java bean çš„å±æ€§åå¯¹åº”è¯·æ±‚å‚æ•°åå³å¯\nå¯¹äº applicaiton/json æ ¼å¼çš„æ•°æ®ï¼ŒSpring æ¥æ”¶éœ€è¦ä½¿ç”¨@RequestBody æ³¨è§£+java bean çš„æ–¹å¼\n\nsession åŸç†\nHttp æ— çŠ¶æ€ï¼Œæœ‰ä¼šè¯\nã€‚æ— çŠ¶æ€æ˜¯æŒ‡ï¼Œè¯·æ±‚ä¹‹é—´ç›¸äº’ç›˜ç«‹ï¼Œç¬¬ä¸€æ¬¡è¯·æ±‚çš„æ•°æ®ï¼Œç¬¬äºŒæ¬¡è¯·æ±‚ä¸èƒ½é‡ç”¨name=zhang\nï¼Œæœ‰ä¼šè¯æ˜¯æŒ‡ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éƒ½æœ‰ç›¸åº”çš„æŠ€æœ¯ï¼Œå¯ä»¥æš‚å­˜æ•°æ®ï¼Œè®©æ•°æ®åœ¨è¯·æ±‚é—´å…±äº«\næœåŠ¡ç«¯ä½¿ç”¨äº† session æŠ€æœ¯æ¥æš‚å­˜æ•°æ®\nå­˜\nGET /s1?name=zhang HTTP/1.1\nHost: 1ocalhost\nå–\nGET /S2 HTTP/1.1\nHost: 1ocalhost\nCookie:ISESSIONID=BF219FEFB6FF6960DA2537CDDED6C393\n\n@RequestMapping(\"/s1\")\n@ResponseBody\npublic string sl(\nHttpSession session,string name){\n\tsession.setAttribute( name:\"name\", name);\n\treturn\"æ•°æ®å·²å­˜å‚¨\";\n}\n@RequestMapping(\"/s2\")\n#ResponseBody\npublic string s2(Httpsession session){\n\treturn \"å–å‡ºæ•°æ®\"+session.getAttribute( name:\"name\");\n}\n\nç”Ÿæˆ token\nGET /j1?name=zhang&amp;pass=123 HTTP/1.1\nHost: 1ocalhost\n\næ ¡éªŒ token\nGET /2 HTTP/1.1Host:1ocalhost\nAuthorization:\neyihbGcioijIuzIlNi19.eyzdwIioijhzGlpbi19.G4xp74SX4dECKIwhK2kRmj1w157nSAR0OBMSpQ-108\n\nRequestMapping(\"/j1\")\nResponseBody\npublic string j1(string name,string pass){\n\tif(\"zhang\".equals(name)&amp;&amp;\"123\".equals(pass)){\n\t\tstring token =wts.builder().setsubject(name).signwith(key).compact\n\t\treturn\"éªŒè¯èº«ä»½é€šè¿‡:\"+token;\n    } else {\n\t\treturnâ€œéªŒè¯èº«ä»½å¤±è´¥\";\n\t}\n}\nRequestMapping(\"/j2\")\nResponseBody\npublic string j2(@RequestHeader string authorization){\n    try {\n        System.out.println(authorization);\n        Jws&lt;Claims&gt; jws = Jwts.parserBuilder().setsigningKey(key).build().pa\n        returnâ€œæ ¡éªŒé€šè¿‡ï¼Œä½ æ˜¯:\"+jws.getBody().getSubject();\n    }catch(Exception e){\n        returnâ€œæ ¡éªŒå¤±è´¥\";\n    }\n}\n\nheader(ç­¾åç®—æ³•) payload(æ•°æ®) ç­¾å æœ€åä¸€æ®µæ•°æ®ä¸å‰ä¸¤ä¸ªæ•°åŠ æœåŠ¡å™¨çš„Keyç­¾åç”Ÿæˆ\n\nString token = \"eyJhbGci0iJIUzI1NiJ9.eyJzdWIi0iJ6aGFuZyJ9._1-P_TLLZQPb1_LCYGWPLMZaKQ8MCW_PLBbYPZ30X28\";\n\nSystem.out.printin(new string(Base64.getDecoder().decode(\"eyIhbGci0iJIUzI1NiJ9\")));\n\nSystem.out.printin(new string(Base64.getDecoder().decode(\"eyJzdWIi0iJ6aGFuZyJ9\")));\n\nString str =\"\"\"{\"sub\":\"admin\"}\"â€œ\";\nSystem.out.println(Base64.getEncoder().encodeTostring(str.getBytes(standardcharsets.UTF_8)));\n</code></pre></div><figure><img src=\"https://i2.wp.com/wx4.sinaimg.cn/large/0070JETugy1i41p4pix52j30qp0efwf5.jpg\" alt=\"1.png\" tabindex=\"0\"><figcaption>1.png</figcaption></figure>\n<figure><img src=\"https://i3.wp.com/wx4.sinaimg.cn/large/0070JETugy1i41p55yez6j30mo0e2js1.jpg\" alt=\"2.png\" tabindex=\"0\"><figcaption>2.png</figcaption></figure>\n<h1>2. Tomcat(è½»é‡çº§åº”ç”¨æœåŠ¡å™¨ï¼Œæ”¯æŒServletå’Œjspè§„èŒƒ)ç›®å½•ç»“æ„ï¼ˆäº†è§£ï¼‰</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9a417a4b6d5586ad9e533.png\" alt=\"tomcatç›®å½•.png\" tabindex=\"0\"><figcaption>tomcatç›®å½•.png</figcaption></figure>\n<ul>\n<li>confï¼šé…ç½®æ–‡ä»¶ç›®å½• (config /configuration)\n<ul>\n<li>æ ¸å¿ƒé…ç½®æ–‡ä»¶ï¼šserver.xml</li>\n<li>ç”¨æˆ·æƒé™é…ç½®æ–‡ä»¶ï¼štomcat-users.xml</li>\n<li>æ‰€æœ‰webé¡¹ç›®é»˜è®¤é…ç½®æ–‡ä»¶ï¼šweb.xml</li>\n</ul>\n</li>\n<li>binï¼šè„šæœ¬ç›®å½•\n<ul>\n<li>å¯åŠ¨è„šæœ¬ï¼šstartup.bat</li>\n<li>åœæ­¢è„šæœ¬ï¼šshutdown.bat</li>\n</ul>\n</li>\n<li>libï¼šä¾èµ–åº“ï¼Œtomcatå’Œwebé¡¹ç›®ä¸­éœ€è¦ä½¿ç”¨çš„jaråŒ…\n<ul>\n<li>logsï¼šæ—¥å¿—æ–‡ä»¶.</li>\n<li>localhost_access_log.<em>.txt tomcatè®°å½•ç”¨æˆ·è®¿é—®ä¿¡æ¯ï¼Œæ˜Ÿ</em>è¡¨ç¤ºæ—¶é—´ã€‚</li>\n<li>ä¾‹å¦‚ï¼šlocalhost_access_log.2016-02-28.txt</li>\n</ul>\n</li>\n<li>tempï¼šä¸´æ—¶æ–‡ä»¶ç›®å½•ï¼Œæ–‡ä»¶å¤¹å†…å†…å®¹å¯ä»¥ä»»æ„åˆ é™¤\n<ul>\n<li>webappsï¼šé»˜è®¤æƒ…å†µä¸‹å‘å¸ƒWEBé¡¹ç›®æ‰€å­˜æ”¾çš„ç›®å½•</li>\n<li>workï¼štomcatå¤„ç†JSPçš„å·¥ä½œç›®å½•</li>\n</ul>\n</li>\n</ul>\n<h1>3. WEBé¡¹ç›®ç›®å½•ç»“æ„</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\té¡¹ç›®åç§°(webappsï¼š)\t\t\n\t|</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/306a175def763027c2977.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "MQTT",
      "url": "https://javaguide.cn/backend/protocol/mqtt.html",
      "id": "https://javaguide.cn/backend/protocol/mqtt.html",
      "summary": "MQTTåè®® 1. æ³¨æ„äº‹é¡¹ 2. MQTTå®¢æˆ·ç«¯ 3. springæ•´åˆMQTT 1. æ³¨æ„äº‹é¡¹ åŒä¸€ä¸ªclientIdé‡å¤è¿æ¥ä¼šå¯¼è‡´è¿æ¥æ–­å¼€ MQTTè®¢é˜…ä¸Šä¸‹çº¿çš„ä¸»é¢˜ä¸º $SYS/brokers/+/clients/+/connected $SYS/brokers/+/clients/+/disconnected $SYS/brokers/+/cl...",
      "content_html": "<p>MQTTåè®®</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E6%B3%A8%E6%84%8F%E4%BA%8B%E9%A1%B9\">1. æ³¨æ„äº‹é¡¹</a></li>\n<li><a href=\"#2-mqtt%E5%AE%A2%E6%88%B7%E7%AB%AF\">2. MQTTå®¢æˆ·ç«¯</a></li>\n<li><a href=\"#3-spring%E6%95%B4%E5%90%88mqtt\">3. springæ•´åˆMQTT</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. æ³¨æ„äº‹é¡¹</h1>\n<ul>\n<li>åŒä¸€ä¸ªclientIdé‡å¤è¿æ¥ä¼šå¯¼è‡´è¿æ¥æ–­å¼€</li>\n<li>MQTTè®¢é˜…ä¸Šä¸‹çº¿çš„ä¸»é¢˜ä¸º\n<ul>\n<li>$SYS/brokers/+/clients/+/connected</li>\n<li>$SYS/brokers/+/clients/+/disconnected</li>\n<li>$SYS/brokers/+/clients/#</li>\n<li>$SYS/#</li>\n</ul>\n</li>\n</ul>\n<h1>2. MQTTå®¢æˆ·ç«¯</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>import java.io.FileNotFoundException;\nimport java.io.IOException;\nimport java.security.KeyManagementException;\nimport java.security.KeyStoreException;\nimport java.security.cert.CertificateException;\nimport org.eclipse.paho.client.mqttv3.MqttClient;\nimport org.eclipse.paho.client.mqttv3.MqttConnectOptions;\nimport org.eclipse.paho.client.mqttv3.MqttException;\nimport org.eclipse.paho.client.mqttv3.MqttMessage;\nimport org.eclipse.paho.client.mqttv3.persist.MemoryPersistence;\n\npublic class MqttPublishSample {\n\tpublic static void main(String[] args) throws KeyManagementException, CertificateException, FileNotFoundException, IOException, KeyStoreException {\n\t\tString topic        = \"MQTT Examples\";\n\t\tString content      = \"Message from MqttPublishSample\";\n\t\tint qos             = 2;\n\t\tString broker       = \"tcp://127.0.0.1:11883\";\n\t\tString broker       = \"ssl://10.110.111.251:8883\";\n\t\tString clientId     = \"JavaSample\";\n\t\tMemoryPersistence persistence = new MemoryPersistence();\n\n\t\ttry {\n\t\t\tMqttClient sampleClient = new MqttClient(broker, clientId, persistence);\n\t\t\tMqttConnectOptions connOpts = new MqttConnectOptions();\n\t\t\tconnOpts.setCleanSession(true);\n\t\t\tSystem.out.println(\"Connecting to broker: \"+broker);\n\t\t\tsampleClient.connect(connOpts);\n\t\t\tSystem.out.println(\"Connected\");\n\t\t\tSystem.out.println(\"Publishing message: \"+content);\n\t\t\tMqttMessage message = new MqttMessage(content.getBytes());\n\t\t\tmessage.setQos(qos);\n\t\t\tsampleClient.publish(topic, message);\n\t\t\tSystem.out.println(\"Message published\");\n\t\t\tsampleClient.disconnect();\n\t\t\tSystem.out.println(\"Disconnected\");\n\t\t\tSystem.exit(0);\n\t\t} catch(MqttException me) {\n\t\t\tSystem.out.println(\"reason \"+me.getReasonCode());\n\t\t\tSystem.out.println(\"msg \"+me.getMessage());\n\t\t\tSystem.out.println(\"loc \"+me.getLocalizedMessage());\n\t\t\tSystem.out.println(\"cause \"+me.getCause());\n\t\t\tSystem.out.println(\"excep \"+me);\n\t\t\tme.printStackTrace();\n\t\t} \n\t}\n}\n</code></pre></div><h1>3. springæ•´åˆMQTT</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å®šä¹‰mqttçš„é…ç½®ç±»\n\npackage com.junye.test;\nimport org.springframework.beans.factory.annotation.Value;\nimport org.springframework.context.annotation.Scope;\nimport org.springframework.stereotype.Component;\n\n@Component\n@Data\npublic class ClientConfig {\n\t@Value(\"tcp://127.0.0.1:11883\")\n\tprivate String broker;\n\t@Value(\"admin\")\n\tprivate String user;\n\t@Value(\"public\")\n\tprivate String password;\n\tprivate int qos = 2;\n\tprivate String clientId;\n}\n\n# å®šä¹‰RemoteClientæ¥å£\n\npackage com.junye.test;\nimport org.eclipse.paho.client.mqttv3.MqttException;\npublic interface RemoteClient {\n\tvoid init(String broker, String user, String password) throws MqttException;\n\tvoid publish(String topic, String message, int qos) throws MqttException;\n\tvoid subscribe(String topic, OnMessageListener listener) throws MqttException;\n\tvoid unSubscribe(String topic) throws MqttException;\n\tvoid close() throws MqttException;\n}\n\n# å®ç°RemoteClientæ¥å£RemoteClientImplç±»\n\npackage com.junye.test;\nimport java.util.UUID;\nimport org.eclipse.paho.client.mqttv3.IMqttDeliveryToken;\nimport org.eclipse.paho.client.mqttv3.MqttCallback;\nimport org.eclipse.paho.client.mqttv3.MqttClient;\nimport org.eclipse.paho.client.mqttv3.MqttConnectOptions;\nimport org.eclipse.paho.client.mqttv3.MqttException;\nimport org.eclipse.paho.client.mqttv3.MqttMessage;\nimport org.eclipse.paho.client.mqttv3.persist.MemoryPersistence;\nimport org.slf4j.Logger;\nimport org.slf4j.LoggerFactory;\nimport org.springframework.util.Assert;\n@Data\npublic class RemoteClientImpl implements RemoteClient {  \n\tprivate String broker;\n\tprivate String user;\n\tprivate String password;\n\tprivate int qos = 2;\n\tprivate String clientId;  \n\tprivate MqttClient client;  \n\n\tpublic RemoteClientImpl() {  \n\t\tthis(UUID.randomUUID().toString());  \n\t}  \n\n\tpublic BasicRemoteClient(String clientId) {  \n\t\tthis.clientId = clientId;  \n\t}  \n\n\tpublic void init(String broker, String user, String password) throws MqttException {  \n\t\tMemoryPersistence persistence = new MemoryPersistence();  \n\t\tclient = new MqttClient(broker, clientId, persistence);  \n\t\tMqttConnectOptions options = new MqttConnectOptions();  \n\n\t\toptions.setCleanSession(true);  \n\t\toptions.setUserName(user);  \n\t\toptions.setPassword(password.toCharArray());  \n\t\tclient.connect(options);  \n\t}  \n\n\tpublic void init() throws MqttException {  \n\t\tMemoryPersistence persistence = new MemoryPersistence();  \n\t\tclient = new MqttClient(broker, clientId, persistence);  \n\t\tMqttConnectOptions options = new MqttConnectOptions();  \n\t\toptions.setCleanSession(true);  \n\t\toptions.setUserName(user);  \n\t\toptions.setPassword(password.toCharArray());  \n\t\tclient.connect(options);  \n\t}  \n\n\n\tpublic void publish(String topic, String message, int qos) throws MqttException {  \n\t\tMqttMessage mqttMessage = new MqttMessage(message.getBytes());  \n\t\tmqttMessage.setQos(qos);  \n\t\tclient.publish(topic, mqttMessage);  \n\t}  \n\n\tpublic void subscribe(String topic, final OnMessageListener listener) throws MqttException {  \n\t\ttry {  \n\t\t\tclient.subscribe(topic, this.qos);\n\t\t\tclient.setCallback(new MqttCallback(){\n\t\t\t\t@Override\n\t\t\t\tpublic void connectionLost(Throwable cause) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tinit();\n\t\t\t\t\t\tSystem.out.println(\"é‡è¿\");\n\t\t\t\t\t} catch (MqttException e) {\n\t\t\t\t\t\t// TODO Auto-generated catch block\n\t\t\t\t\t\te.printStackTrace();\n\t\t\t\t\t}\n\t\t\t\t}\n\n\t\t\t\t@Override\n\t\t\t\tpublic void messageArrived(String topic2, MqttMessage message) throws Exception {\n\t\t\t\t\tlistener.handleMessage(topic2, message.toString());  \n\t\t\t\t}\n\n\t\t\t\t@Override\n\t\t\t\tpublic void deliveryComplete(IMqttDeliveryToken token) {\n\t\t\t\t\tSystem.out.println(\"æˆåŠŸ\");\n\t\t\t\t\tlogger.info(\"deliveryComplete {}\", token);\n\t\t\t\t}\n\t\t\t});\n\t\t} catch (MqttException e) {  \n\t\t\tthrow e;  \n\t\t}  \n\t}  \n\n\tpublic void unSubscribe(String topic) throws MqttException {  \n\t\tclient.unsubscribe(topic);  \n\t}  \n\n\t@Override  \n\tpublic void close() throws MqttException {  \n\t\tclient.disconnect();  \n\t}  \n\n}\n\n# å®šä¹‰ç›‘å¬æ¥å£OnMessageListenerç”¨äºä¼ å…¥RemoteClientå¤„ç†ä¿¡æ¯\npublic interface OnMessageListener {\n\tvoid handleMessage(String topic, String message);\n}\n# è‡ªå®šä¹‰Beanæ³¨å…¥\n//è‡ªå®šä¹‰Basicçš„æ³¨å…¥ï¼Œç›´æ¥å½“æˆä¸€ä¸ªæ™®é€šçš„Beanå³å¯ï¼Œåªæ˜¯åˆå§‹åŒ–çš„æ–¹æ³•è‡ªå®šä¹‰äº†\n@Component\npublic class BasicRemoteClientFactory implements FactoryBean&lt;RemoteClient&gt;{\n\n\t@Autowired\n\tprivate ClientConfig clientConfig;\n\tpublic void setClientConfig(ClientConfig clientConfig) {\n\t\tthis.clientConfig = clientConfig;\n\t}\n\t@Override\n\tpublic RemoteClient getObject() throws Exception {\n\t\tBasicRemoteClient client = new BasicRemoteClient();\n\t\tif(clientConfig.getClientId()!=null){\n\t\t\tclient.setClientId(clientConfig.getClientId());\n\t\t}\n\t\tclient.init(clientConfig.getBroker(), clientConfig.getUser(), clientConfig.getPassword());\n\t\tclient.setQos(clientConfig.getQos());\n\t\treturn (RemoteClient) client;\n\t}\n\n\t@Override\n\tpublic Class&lt;?&gt; getObjectType() {\n\t\treturn BasicRemoteClient.class;\n\t}\n\n\t@Override\n\tpublic boolean isSingleton() {\n\t\treturn false;\n\t}\n}\n# å®šä¹‰æŠ½è±¡ç±»BaseMqttSubscriberç”¨äºå¤šä¸ªControllerç»§æ‰¿ï¼ˆå¯é€‰ï¼‰\n\tpublic abstract class BaseMqttSubscriber {\n\t\tprotected Logger logger =LoggerFactory.getLogger(this.getClass());\n\t\t@Value(\"TEST\")\n\t\tprivate String clientId;\n\n\t\tpublic void setClientId(String clientId) {\n\t\t\tthis.clientId = clientId;\n\t\t}\n\n\t\t@Autowired\n\t\tprivate ClientConfig clientConfig;\n\n\t\tpublic void setClientConfig(ClientConfig clientConfig) {\n\t\t\tthis.clientConfig = clientConfig;\n\t\t}\n\n\n\t\tpublic RemoteClient getMqttClient() throws Exception {\n\t\t\tclientConfig.setClientId(clientId);//override the clientId;\n\t\t\tBasicRemoteClientFactory factory=new BasicRemoteClientFactory();\n\t\t\tfactory.setClientConfig(clientConfig);\n\t\t\treturn factory.getObject();\n\t\t}\n\t}\n# å®šä¹‰HelloControlleræµ‹è¯•\npackage com.junye.test;\nimport java.util.HashMap;\nimport java.util.Map;\nimport javax.annotation.PostConstruct;\nimport org.eclipse.paho.client.mqttv3.MqttException;\nimport org.springframework.web.bind.annotation.RequestMapping;\nimport org.springframework.web.bind.annotation.RestController;\n@RestController\npublic class HelloController extends BaseMqttSubscriber{\n\t@RequestMapping(\"/hello\")\n\tpublic Map&lt;String, Object&gt; index(String test,String test2) throws MqttException, Exception {\n\t\tMap&lt;String , Object&gt; result=new HashMap&lt;String,Object&gt;();\n\t\tresult.put(\"test\", test);\n\t\tDemo demo=new Demo(\"junye\", \"1\");\n\t\tresult.put(\"Demo\", demo);\n\t\tthis.getMqttClient().publish(\"/test\", \"hahah\", 2);\n\t\tSystem.out.println(\"chenggong\");\n\t\treturn result;\n\t}\n\t@PostConstruct\n\tpublic void init() throws MqttException, Exception {\n\t\tSystem.out.println(\"qidong\");\n\t\tthis.getMqttClient().subscribe(\"/test\", new OnMessageListener() {\n\t\t\t@Override\n\t\t\tpublic void handleMessage(String topic, String message)  {\n\t\t\tSystem.out.println(\"test\");\n\t\t\t}\n\t\t});\t\n\t}  \n}\n# å®šä¹‰springbootå…¥å£\npackage com.junye.test;\nimport org.springframework.boot.SpringApplication;\nimport org.springframework.boot.autoconfigure.EnableAutoConfiguration;\nimport org.springframework.boot.autoconfigure.SpringBootApplication;\n\n@SpringBootApplication\n@EnableAutoConfiguration\npublic class MainApplication {\n\tpublic static void main(String[] args) {\n\t\tSpringApplication.run(MainApplication.class, args);\n\t}\t\n}\n</code></pre></div><h1>4. JavaScriptè¿æ¥emq</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n&lt;head&gt;\n\t&lt;meta charset=\"UTF-8\"&gt;\n\t&lt;title&gt;Insert title here&lt;/title&gt;\n&lt;/head&gt;\n&lt;script src=\"https://cdnjs.cloudflare.com/ajax/libs/paho-mqtt/1.0.1/mqttws31.js\" type=\"text/javascript\"&gt;&lt;/script&gt;\n&lt;script&gt;\nwindow.onload=function(){\n\tclient = new Paho.MQTT.Client(location.hostname, Number(8083), \"clientId\");\n\tclient.onConnectionLost = onConnectionLost;\n\tclient.onMessageArrived = onMessageArrived;\n\tclient.connect({onSuccess:onConnect});\n\t//,onFailure : artmisMqttOnError\n\tfunction onConnect() {\n\t\t// Once a connection has been made, make a subscription and send a message.\n\t\talert(\"connect\");\n\t\tconsole.log(\"onConnect\");\n\t\tclient.subscribe(\"/World\");\n\t\tmessage = new Paho.MQTT.Message(\"Hello\");\n\t\tmessage.destinationName = \"/World\";\n\t\tclient.send(message);\n\t};\n\tfunction onConnectionLost(responseObject) {\n\t\tif (responseObject.errorCode !== 0){\n\t\t\tconsole.log(\"onConnectionLost:\"+responseObject.errorMessage);\n\t\t\talter(\"lost\");\n\t\t}\n\t};\n\tfunction onMessageArrived(message) {\n\t\tconsole.log(\"onMessageArrived:\"+message.payloadString);\n\t\talert(message.payloadString);\n\t\tclient.disconnect();\n\t};\n}\n\n&lt;/script&gt;\n&lt;body&gt;\nxxx\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "webservice",
      "url": "https://javaguide.cn/backend/protocol/webservice.html",
      "id": "https://javaguide.cn/backend/protocol/webservice.html",
      "summary": "WebServiceæ˜¯ç”¨æ¥å¼€å‘åˆ†å¸ƒå¼çš„äº’æ“ä½œåº”ç”¨ç¨‹åº 1. WebServiceä»‹ç» 2. SOAPå’ŒWSDL 3. åŸºäºjdk1.7å‘å¸ƒä¸€ä¸ªWebServiceæœåŠ¡ 4. apache CXFå…¥é—¨ 1. WebServiceä»‹ç» å›¾ç‰‡1.pngå›¾ç‰‡1.png 2. SOAPå’ŒWSDL 3. åŸºäºjdk1.7å‘å¸ƒä¸€ä¸ªWebServiceæœåŠ¡ å›¾ç‰‡2.p...",
      "content_html": "<p>WebServiceæ˜¯ç”¨æ¥å¼€å‘åˆ†å¸ƒå¼çš„äº’æ“ä½œåº”ç”¨ç¨‹åº</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-webservice%E4%BB%8B%E7%BB%8D\">1. WebServiceä»‹ç»</a></li>\n<li><a href=\"#2-soap%E5%92%8Cwsdl\">2. SOAPå’ŒWSDL</a></li>\n<li><a href=\"#3-%E5%9F%BA%E4%BA%8Ejdk17%E5%8F%91%E5%B8%83%E4%B8%80%E4%B8%AAwebservice%E6%9C%8D%E5%8A%A1\">3. åŸºäºjdk1.7å‘å¸ƒä¸€ä¸ªWebServiceæœåŠ¡</a></li>\n<li><a href=\"#4-apache-cxf%E5%85%A5%E9%97%A8\">4. apache CXFå…¥é—¨</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. WebServiceä»‹ç»</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Web serviceæ˜¯ä¸€ä¸ªå¹³å°ç‹¬ç«‹çš„ï¼Œä½è€¦åˆçš„ï¼Œè‡ªåŒ…å«çš„ã€åŸºäºå¯ç¼–ç¨‹çš„webçš„åº”ç”¨ç¨‹åºï¼Œ\nå¯ä½¿ç”¨å¼€æ”¾çš„XMLï¼ˆæ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ä¸‹çš„ä¸€ä¸ªå­é›†ï¼‰æ ‡å‡†æ¥æè¿°ã€å‘å¸ƒã€å‘ç°ã€åè°ƒå’Œé…ç½®è¿™äº›åº”ç”¨ç¨‹åºï¼Œç”¨äºå¼€å‘åˆ†å¸ƒå¼çš„äº’æ“ä½œçš„åº”ç”¨ç¨‹åº \nWeb ServiceæŠ€æœ¯ï¼Œ èƒ½ä½¿å¾—è¿è¡Œåœ¨ä¸åŒæœºå™¨ä¸Šçš„ä¸åŒåº”ç”¨æ— é¡»å€ŸåŠ©é™„åŠ çš„ã€ä¸“é—¨çš„ç¬¬ä¸‰æ–¹è½¯ä»¶æˆ–ç¡¬ä»¶ï¼Œ å°±å¯ç›¸äº’äº¤æ¢æ•°æ®æˆ–é›†æˆã€‚ä¾æ®Web Serviceè§„èŒƒå®æ–½çš„åº”ç”¨ä¹‹é—´ï¼Œ æ— è®ºå®ƒä»¬æ‰€ä½¿ç”¨çš„è¯­è¨€ã€ å¹³å°æˆ–å†…éƒ¨åè®®æ˜¯ä»€ä¹ˆï¼Œ \néƒ½å¯ä»¥ç›¸äº’äº¤æ¢æ•°æ®\nWeb Serviceæ˜¯è‡ªæè¿°ã€ è‡ªåŒ…å«çš„å¯ç”¨ç½‘ç»œæ¨¡å—ï¼Œå¯ä»¥æ‰§è¡Œå…·ä½“çš„ä¸šåŠ¡åŠŸèƒ½ã€‚\nWeb Serviceä¹Ÿå¾ˆå®¹æ˜“éƒ¨ç½²ï¼Œ å› ä¸ºå®ƒä»¬åŸºäºä¸€äº›å¸¸è§„çš„äº§ä¸šæ ‡å‡†ä»¥åŠå·²æœ‰çš„ä¸€äº›æŠ€æœ¯ï¼Œè¯¸å¦‚æ ‡å‡†é€šç”¨æ ‡è®°è¯­è¨€ä¸‹çš„å­é›†XMLã€HTTPã€‚Web Serviceå‡å°‘äº†åº”ç”¨æ¥å£çš„èŠ±è´¹ã€‚\nWeb Serviceä¸ºæ•´ä¸ªä¼ä¸šç”šè‡³å¤šä¸ªç»„ç»‡ä¹‹é—´çš„ä¸šåŠ¡æµç¨‹çš„é›†æˆæä¾›äº†ä¸€ä¸ªé€šç”¨æœºåˆ¶\n\nWebServiceé€šè¿‡HTTP POSTæ–¹å¼æ¥å—å®¢æˆ·çš„è¯·æ±‚,å®ç°ä¸¤ä¸ªç³»ç»Ÿä¹‹é—´çš„è¿œç¨‹è°ƒç”¨\nWebServiceä¸å®¢æˆ·ç«¯ä¹‹é—´ä¸€èˆ¬ä½¿ç”¨SOAPåè®®ä¼ è¾“XMLæ•°æ®\nå®ƒæœ¬èº«å°±æ˜¯ä¸ºäº†è·¨å¹³å°æˆ–è·¨è¯­è¨€è€Œè®¾è®¡çš„\n\nè°ƒç”¨ç½‘ç»œä¸Šçš„WebServiceæœåŠ¡http://webxml.com.cn/\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d9e138740635ff40f1378.png\" alt=\"å›¾ç‰‡1.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡1.png</figcaption></figure>\n<h1>2. SOAPå’ŒWSDL</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>SOAPï¼ˆSimple Object Access Protocolï¼‰ï¼šç®€å•å¯¹è±¡è®¿é—®åè®®\nSOAPä½œä¸ºä¸€ä¸ªåŸºäºXMLè¯­è¨€çš„åè®®ç”¨äºåœ¨ç½‘ä¸Šä¼ è¾“æ•°æ®ã€‚\nSOAP = åœ¨HTTPçš„åŸºç¡€ä¸Š+XMLæ•°æ®ã€‚éƒ½æ˜¯postè¯·æ±‚\nSOAPæ˜¯åŸºäºHTTPçš„ã€‚!!!!!!!!!!!!!!!!\nSOAPçš„ç»„æˆå¦‚ä¸‹ï¼š\nEnvelope â€“ å¿…é¡»çš„éƒ¨åˆ†ã€‚ä»¥XMLçš„æ ¹å…ƒç´ å‡ºç°ã€‚\nHeaders â€“ å¯é€‰çš„ã€‚\nBody â€“ å¿…é¡»çš„ã€‚åœ¨bodyéƒ¨åˆ†ï¼ŒåŒ…å«è¦æ‰§è¡Œçš„æœåŠ¡å™¨çš„æ–¹æ³•ã€‚å’Œå‘é€åˆ°æœåŠ¡å™¨çš„æ•°æ®ã€‚\n\nç¤ºä¾‹ï¼š\nPOST /WebServices/IpAddressSearchWebService.asmx HTTP/1.1\nHost: ws.webxml.com.cn\nContent-Type: text/xml; charset=utf-8\nContent-Length: length\nSOAPAction: \"http://WebXml.com.cn/getCountryCityByIp\"\n\n&lt;?xml version=\"1.0\" encoding=\"utf-8\"?&gt;\n&lt;soap:Envelope xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:xsd=\"http://www.w3.org/2001/XMLSchema\" xmlns:soap=\"http://schemas.xmlsoap.org/soap/envelope/\"&gt;\n  &lt;soap:Body&gt;\n\t&lt;getCountryCityByIp xmlns=\"http://WebXml.com.cn/\"&gt;\n\t  &lt;theIpAddress&gt;string&lt;/theIpAddress&gt;\n\t&lt;/getCountryCityByIp&gt;\n  &lt;/soap:Body&gt;\n&lt;/soap:Envelope&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>WSDL WebæœåŠ¡æè¿°è¯­è¨€\nWSDL(WebService Description Language):web æœåŠ¡æè¿°è¯­è¨€\nå°±æ˜¯ä¸€ä¸ªxmlæ–‡æ¡£ï¼Œç”¨äºæè¿°å½“å‰æœåŠ¡çš„ä¸€äº›ä¿¡æ¯ï¼ˆæœåŠ¡åç§°ã€æœåŠ¡çš„å‘å¸ƒåœ°å€ã€æœåŠ¡æä¾›çš„æ–¹æ³•ã€æ–¹æ³•çš„å‚æ•°ç±»å‹ã€æ–¹æ³•çš„è¿”å›å€¼ç±»å‹ç­‰ï¼‰\n</code></pre></div><h1>3. åŸºäºjdk1.7å‘å¸ƒä¸€ä¸ªWebServiceæœåŠ¡</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æœåŠ¡ç«¯å‘å¸ƒ\nç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªJavaé¡¹ç›®\nç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªç±»ï¼ŒåŠ å…¥Webserviceæ³¨è§£\nç¬¬ä¸‰æ­¥ï¼šæä¾›ä¸€ä¸ªæ–¹æ³•sayHello\nç¬¬å››æ­¥ï¼šåœ¨mainæ–¹æ³•ä¸­è°ƒç”¨jdkæä¾›çš„å‘å¸ƒæœåŠ¡çš„æ–¹æ³•\nç¬¬äº”æ­¥ï¼šè®¿é—®æœåŠ¡çš„wsdlæ–‡æ¡£ï¼ˆæœåŠ¡çš„å‘å¸ƒåœ°å€+?wsdlï¼‰http://192.168.115.87:8080/hello?wsdl\nimport javax.jws.WebService;\nimport javax.xml.ws.Endpoint;\n@WebService\npublic class HelloService {\n\tpublic String sayHello(String name,int i){\n\t\tSystem.out.println(\"æœåŠ¡ç«¯çš„sayHelloæ–¹æ³•è¢«è°ƒç”¨äº†ã€‚ã€‚ã€‚ã€‚\");\n\t\treturn \"helle\" + name;\n\t}\n\t\n\tpublic static void main(String[] args) {\n\t\tString address = \"http://192.168.115.87:8080/hello\";\n\t\tObject implementor = new HelloService();\n\t\tEndpoint.publish(address, implementor);\n\t}\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å®¢æˆ·ç«¯è°ƒç”¨\n//ä½¿ç”¨wsimportå‘½ä»¤è§£æwsdlæ–‡ä»¶ç”Ÿæˆæœ¬åœ°ä»£ç ,æŠŠæœ¬åœ°ä»£ç æ‹·åˆ°é¡¹ç›®ä¸­\n//é€šè¿‡æœ¬åœ°ä»£ç åˆ›å»ºä¸€ä¸ªä»£ç†å¯¹è±¡\n//é€šè¿‡ä»£ç†å¯¹è±¡å®ç°è¿œç¨‹è°ƒç”¨\npublic class App {\n\tpublic static void main(String[] args) {\n\t\tHelloServiceService ss = new HelloServiceService();\n\t\t//åˆ›å»ºå®¢æˆ·ç«¯ä»£ç†å¯¹è±¡ï¼Œç”¨äºè¿œç¨‹è°ƒç”¨\n\t\tHelloService proxy = ss.getHelloServicePort();\n\t\tString ret = proxy.sayHello(\"å°æ˜\", 10);\n\t\tSystem.out.println(ret);\n\t}\n}\n\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/f0324ee4eed25d8d96ac1.png\" alt=\"å›¾ç‰‡2.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡2.png</figcaption></figure>\n<h1>4. apache CXFå…¥é—¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å®˜ç½‘ï¼šcxf.apache.org\nApache CXF = Celtix + Xfire \næ”¯æŒå¤šç§åè®®ï¼šSOAP1.1,1.2ã€XML/HTTP\nCORBAï¼ˆCommon Object Request Broker Architectureå…¬å…±å¯¹è±¡è¯·æ±‚ä»£ç†ä½“ç³»ç»“æ„,æ—©æœŸè¯­è¨€ä½¿ç”¨çš„WSã€‚C,c++,C#ï¼‰ \nå¹¶å¯ä»¥ä¸Springè¿›è¡Œå¿«é€Ÿæ— ç¼çš„æ•´åˆ,çµæ´»çš„éƒ¨ç½²ï¼šå¯ä»¥è¿è¡Œåœ¨Tomcat,Jboss,Jetty(å†…ç½®),IBMWS,BeaWLä¸Šé¢ã€‚\n\næœåŠ¡ç«¯å¼€å‘\nç¬¬ä¸€æ­¥ï¼šåˆ›å»ºåŠ¨æ€webé¡¹ç›®\nç¬¬äºŒæ­¥ï¼šå¯¼å…¥CXFç›¸å…³jaråŒ…\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;\n\t&lt;artifactId&gt;cxf-rt-frontend-jaxws&lt;/artifactId&gt;\n\t&lt;version&gt;3.0.1&lt;/version&gt;\n&lt;/dependency&gt;\n&lt;dependency&gt;\n\t&lt;groupId&gt;org.apache.cxf&lt;/groupId&gt;\n\t&lt;artifactId&gt;cxf-rt-transports-http&lt;/artifactId&gt;\n\t&lt;version&gt;3.0.1&lt;/version&gt;\n&lt;/dependency&gt;\nç¬¬ä¸‰æ­¥ï¼šåœ¨web.xmlä¸­é…ç½®CXFæ¡†æ¶æä¾›çš„ä¸€ä¸ªServlet\n&lt;!-- é…ç½®CXFæ¡†æ¶æä¾›çš„Servlet --&gt;\n&lt;servlet&gt;\n\t&lt;servlet-name&gt;cxf&lt;/servlet-name&gt;\n\t&lt;servlet-class&gt;org.apache.cxf.transport.servlet.CXFServlet&lt;/servlet-class&gt;\n\t&lt;!-- é€šè¿‡åˆå§‹åŒ–å‚æ•°æŒ‡å®šCXFæ¡†æ¶çš„é…ç½®æ–‡ä»¶ä½ç½® é»˜è®¤cxf-servlet.xml--&gt;\n\t&lt;init-param&gt;\n\t\t&lt;param-name&gt;config-location&lt;/param-name&gt;\n\t\t&lt;param-value&gt;classpath:cxf.xml&lt;/param-value&gt;\n\t&lt;/init-param&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n\t&lt;servlet-name&gt;cxf&lt;/servlet-name&gt;\n\t&lt;url-pattern&gt;/service/*&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\nç¬¬å››æ­¥ï¼šåœ¨ç±»è·¯å¾„ä¸‹æä¾›cxf.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxmlns:jaxws=\"http://cxf.apache.org/jaxws\"\nxmlns:soap=\"http://cxf.apache.org/bindings/soap\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\t\t\t\t\thttp://www.springframework.org/schema/beans/spring-beans.xsd\n\t\t\t\t\thttp://cxf.apache.org/bindings/soap \n\t\t\t\t\thttp://cxf.apache.org/schemas/configuration/soap.xsd\n\t\t\t\t\thttp://cxf.apache.org/jaxws \n\t\t\t\t\thttp://cxf.apache.org/schemas/jaxws.xsd\"&gt;\n\t&lt;!-- å¼•å…¥CXF Beanå®šä¹‰å¦‚ä¸‹,æ—©æœŸçš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ --&gt;\n\t&lt;import resource=\"classpath:META-INF/cxf/cxf.xml\" /&gt;\n\t&lt;import resource=\"classpath:META-INF/cxf/cxf-extension-soap.xml\" /&gt;\n\t&lt;import resource=\"classpath:META-INF/cxf/cxf-servlet.xml\" /&gt;\n\n&lt;/beans&gt;\nç¬¬äº”æ­¥ï¼šå¼€å‘ä¸€ä¸ªæ¥å£å’Œå®ç°ç±»\n@WebService\npublic interface HelloService {\n\tpublic String sayHello(String name);\n}\npublic class HelloServiceImpl implements HelloService{\n\tpublic String sayHello(String name) {\n\t\tSystem.out.println(\"åŸºäºCXFå¼€å‘çš„æœåŠ¡ç«¯sayHelloæ–¹æ³•è¢«è°ƒç”¨äº†ã€‚ã€‚ã€‚ã€‚\");\n\t\treturn \"hello \" + name;\n\t}\n}\nç¬¬å…­æ­¥ï¼šåœ¨cxf.xmlä¸­æ³¨å†ŒæœåŠ¡\n&lt;bean id=\"helloService\" class=\"com.itheima.service.HelloServiceImpl\"/&gt;\n&lt;!-- æ³¨å†ŒæœåŠ¡ --&gt;\n&lt;jaxws:server id=\"myService\" address=\"/cxfService\"&gt;\n\t&lt;jaxws:serviceBean&gt;\n\t\t&lt;ref bean=\"helloService\"/&gt;\n\t&lt;/jaxws:serviceBean&gt;\n&lt;/jaxws:server&gt;\næœ€åè¯·æ±‚http://ip:port/projectName/service/cxfService\n\nå®¢æˆ·ç«¯å¼€å‘\nç¬¬ä¸€æ­¥ï¼šåˆ›å»ºJavaé¡¹ç›®å¹¶å¯¼å…¥CXFç›¸å…³jaråŒ…\nç¬¬äºŒæ­¥ï¼šä½¿ç”¨wsimportæˆ–è€…CXFæä¾›wsdl2javaç”Ÿæˆæœ¬åœ°ä»£ç ï¼Œåªéœ€è¦ç”Ÿæˆæ¥å£æ–‡ä»¶\nç¬¬ä¸‰æ­¥ï¼šå°†æ¥å£æ–‡ä»¶å¤åˆ¶åˆ°é¡¹ç›®ä¸­\nç¬¬å››æ­¥ï¼šæä¾›springé…ç½®æ–‡ä»¶ï¼Œæ³¨å†Œå®¢æˆ·ç«¯ä»£ç†å¯¹è±¡\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \nxmlns:jaxws=\"http://cxf.apache.org/jaxws\"\nxmlns:soap=\"http://cxf.apache.org/bindings/soap\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\t\t\t\t\thttp://www.springframework.org/schema/beans/spring-beans.xsd\n\t\t\t\t\thttp://cxf.apache.org/bindings/soap \n\t\t\t\t\thttp://cxf.apache.org/schemas/configuration/soap.xsd\n\t\t\t\t\thttp://cxf.apache.org/jaxws \n\t\t\t\t\thttp://cxf.apache.org/schemas/jaxws.xsd\"&gt;\n\t&lt;!-- å¼•å…¥CXF Beanå®šä¹‰å¦‚ä¸‹,æ—©æœŸçš„ç‰ˆæœ¬ä¸­ä½¿ç”¨ --&gt;\n\t&lt;import resource=\"classpath:META-INF/cxf/cxf.xml\" /&gt;\n\t&lt;import resource=\"classpath:META-INF/cxf/cxf-extension-soap.xml\" /&gt;\n\t&lt;import resource=\"classpath:META-INF/cxf/cxf-servlet.xml\" /&gt;\n\t\n\t&lt;!-- æ³¨å†ŒCXFå®¢æˆ·ç«¯ä»£ç†å¯¹è±¡ï¼Œé€šè¿‡springæ¡†æ¶åˆ›å»ºè¿™ä¸ªä»£ç†å¯¹è±¡ï¼Œä½¿ç”¨ä»£ç†å¯¹è±¡å®ç°è¿œç¨‹è°ƒç”¨ --&gt;\n\t&lt;jaxws:client id=\"myClient\" \n\t\t\t\taddress=\"http://192.168.115.87:8080/cxf_service/service/cxfService\" \n\t\t\t\tserviceClass=\"cn.itcast.client.HelloService\"&gt;\n\t&lt;/jaxws:client&gt;\n&lt;/beans&gt;\nç¬¬äº”æ­¥ï¼šè¯»å–springé…ç½®æ–‡ä»¶ï¼Œåˆ›å»ºspringå·¥å‚ï¼Œä»å·¥å‚ä¸­è·å–ä»£ç†å¯¹è±¡ï¼Œå®ç°è¿œç¨‹è°ƒç”¨\npublic class App {\n\tpublic static void main(String[] args) {\n\t\tApplicationContext ctx = new ClassPathXmlApplicationContext(\"cxf.xml\");\n\t\tHelloService proxy = (HelloService) ctx.getBean(\"myClient\");\n\t\tString ret = proxy.sayHello(\"test\");\n\t\tSystem.out.println(ret);\n\t}\n}\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/d9e138740635ff40f1378.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "websocket",
      "url": "https://javaguide.cn/backend/protocol/websocket.html",
      "id": "https://javaguide.cn/backend/protocol/websocket.html",
      "summary": "1. websocketä¸httpçš„æ¯”è¾ƒ 2. æœåŠ¡ç«¯ 2.1. pom.xml 2.2. java 3. springbootæ•´åˆwebsocket 3.1. pom.xml 3.2. WebSocketConfigã€WebSocketInterceptorã€MyWebSocketHandler 3.3. SseEmitter 4. å®¢æˆ·ç«¯è¿æ¥ å‰ç«¯...",
      "content_html": "<!-- TOC -->\n<ul>\n<li><a href=\"#1-websocket%E4%B8%8Ehttp%E7%9A%84%E6%AF%94%E8%BE%83\">1. websocketä¸httpçš„æ¯”è¾ƒ</a></li>\n<li><a href=\"#2-%E6%9C%8D%E5%8A%A1%E7%AB%AF\">2. æœåŠ¡ç«¯</a>\n<ul>\n<li><a href=\"#21-pomxml\">2.1. pom.xml</a></li>\n<li><a href=\"#22-java\">2.2. java</a></li>\n</ul>\n</li>\n<li><a href=\"#3-springboot%E6%95%B4%E5%90%88websocket\">3. springbootæ•´åˆwebsocket</a>\n<ul>\n<li><a href=\"#31-pomxml\">3.1. pom.xml</a></li>\n<li><a href=\"#32-websocketconfigwebsocketinterceptormywebsockethandler\">3.2. WebSocketConfigã€WebSocketInterceptorã€MyWebSocketHandler</a></li>\n<li><a href=\"#33-sseemitter\">3.3. SseEmitter</a></li>\n</ul>\n</li>\n<li><a href=\"#4-%E5%AE%A2%E6%88%B7%E7%AB%AF%E8%BF%9E%E6%8E%A5-%E5%89%8D%E7%AB%AFjs%E5%AF%B9%E8%B1%A1websocket%E5%92%8Ceventsource%E5%88%86%E5%88%AB%E7%94%A8%E4%BA%8E%E8%BF%9E%E6%8E%A5%E8%BF%99%E4%B8%A4%E7%A7%8D%E6%9C%8D%E5%8A%A1\">4. å®¢æˆ·ç«¯è¿æ¥ å‰ç«¯jså¯¹è±¡WebSocketå’ŒEventSourceåˆ†åˆ«ç”¨äºè¿æ¥è¿™ä¸¤ç§æœåŠ¡ã€‚</a></li>\n<li><a href=\"#5-nginx%E9%9C%80%E8%A6%81%E7%9A%84%E9%A2%9D%E5%A4%96%E9%85%8D%E7%BD%AE\">5. Nginxéœ€è¦çš„é¢å¤–é…ç½®</a>\n<ul>\n<li><a href=\"#51-eventsource\">5.1. EventSource</a></li>\n<li><a href=\"#52-websocket\">5.2. WebSocket</a></li>\n</ul>\n</li>\n<li><a href=\"#6-%E5%B7%B2%E7%9F%A5%E9%97%AE%E9%A2%98\">6. å·²çŸ¥é—®é¢˜</a></li>\n<li><a href=\"#7-%E8%8E%B7%E5%BE%97httpssession%E7%9A%84%E6%96%B9%E6%B3%95\">7. è·å¾—httpssessionçš„æ–¹æ³•</a>\n<ul>\n<li><a href=\"#71-gethttpsessionconfigurator\">7.1. GetHttpSessionConfigurator</a></li>\n<li><a href=\"#72-%E5%9C%A8serverendpoint%E6%B3%A8%E8%A7%A3%E9%87%8C%E9%9D%A2%E6%B7%BB%E5%8A%A0configurator%E5%B1%9E%E6%80%A7\">7.2. åœ¨@ServerEndpointæ³¨è§£é‡Œé¢æ·»åŠ configuratorå±æ€§</a></li>\n<li><a href=\"#73-%E5%9C%A8onopen%E6%96%B9%E6%B3%95%E9%87%8C%E5%8A%A0%E5%85%A5%E5%8F%82%E6%95%B0endpointconfig-config%E5%8D%B3%E5%8F%AF%E8%8E%B7%E5%8F%96httpsession\">7.3. åœ¨onOpenæ–¹æ³•é‡ŒåŠ å…¥å‚æ•°EndpointConfig configå³å¯è·å–HttpSession</a></li>\n</ul>\n</li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. websocketä¸httpçš„æ¯”è¾ƒ</h1>\n<ul>\n<li>WebSocketåè®®å®ç°äº†æµè§ˆå™¨ä¸æœåŠ¡å™¨çš„å…¨åŒå·¥é€šä¿¡ï¼Œæ‰©å±•äº†æµè§ˆå™¨ä¸æœåŠ¡ç«¯çš„é€šä¿¡åŠŸèƒ½ï¼Œä½¿æœåŠ¡ç«¯ä¹Ÿèƒ½ä¸»åŠ¨å‘å®¢æˆ·ç«¯å‘é€æ•°æ®ã€‚JavaEE 7ä¸­å‡ºäº†JSR-356:Java API for WebSocketè§„èŒƒã€‚ä¸å°‘Webå®¹å™¨ï¼Œå¦‚Tomcat,Nginx,Jettyç­‰éƒ½æ”¯æŒWebSocketã€‚Tomcatä»7.0.27å¼€å§‹æ”¯æŒ WebSocketï¼Œä»7.0.47å¼€å§‹æ”¯æŒJSR-356ï¼Œä¸‹é¢çš„Demoä»£ç ä¹Ÿæ˜¯éœ€è¦éƒ¨ç½²åœ¨Tomcat7.0.47ï¼ˆä¸åŒ…æ‹¬ï¼‰ä»¥ä¸Šçš„ç‰ˆæœ¬æ‰èƒ½è¿è¡Œ</li>\n<li>webscoketç›¸æ¯”äºhttpçš„ä¼˜åŠ¿ä¸»è¦æœ‰æœåŠ¡å™¨èƒ½ä¸»åŠ¨å‘ä¿¡æ¯ç»™å‰ç«¯,å‘çš„ä¿¡æ¯æ˜¯è½»é‡çº§çš„ï¼Œæ‰€ä»¥æœåŠ¡å™¨çš„å‹åŠ›è¾ƒå°‘</li>\n</ul>\n<h1>2. æœåŠ¡ç«¯</h1>\n<h2>2.1. pom.xml</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependencies&gt;\n\t&lt;dependency&gt;\n\t&lt;groupId&gt;javax&lt;/groupId&gt;\n\t&lt;artifactId&gt;javaee-api&lt;/artifactId&gt;\n\t&lt;version&gt;7.0&lt;/version&gt;\n\t&lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre></div><h2>2.2. java</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package com.junye.testwebsocket;\nimport java.io.IOException;\nimport java.util.concurrent.CopyOnWriteArraySet;\nimport javax.websocket.*;\nimport javax.websocket.server.ServerEndpoint;\n\n@ServerEndpoint(\"/websocket\")\npublic class TestWebscoket {\n\t/**\n\t* @ServerEndpoint æ³¨è§£æ˜¯ä¸€ä¸ªç±»å±‚æ¬¡çš„æ³¨è§£ï¼Œå®ƒçš„åŠŸèƒ½ä¸»è¦æ˜¯å°†ç›®å‰çš„ç±»å®šä¹‰æˆä¸€ä¸ªwebsocketæœåŠ¡å™¨ç«¯,\n\t* æ³¨è§£çš„å€¼å°†è¢«ç”¨äºç›‘å¬ç”¨æˆ·è¿æ¥çš„ç»ˆç«¯è®¿é—®URLåœ°å€,å®¢æˆ·ç«¯å¯ä»¥é€šè¿‡è¿™ä¸ªURLæ¥è¿æ¥åˆ°WebSocketæœåŠ¡å™¨ç«¯\n\t*/\n\t\n\t//ä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®\n\tprivate Session session;\n\t\n\t/**\n\t* è¿æ¥å»ºç«‹æˆåŠŸè°ƒç”¨çš„æ–¹æ³•\n\t* @param session  å¯é€‰çš„å‚æ•°ã€‚\n\t*\tsessionä¸ºä¸æŸä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ä¼šè¯ï¼Œéœ€è¦é€šè¿‡å®ƒæ¥ç»™å®¢æˆ·ç«¯å‘é€æ•°æ®\n\t*/\n\t@OnOpen\n\tpublic void onOpen(Session session){\n\t\tthis.session = session;\n\t}\n\n\t/**\n\t* è¿æ¥å…³é—­è°ƒç”¨çš„æ–¹æ³•\n\t*/\n\t@OnClose\n\tpublic void onClose(){\n\t\tSystem.out.println(\"è¿æ¥å…³é—­\");\n\t}\n\n\t/**\n\t* æ”¶åˆ°å®¢æˆ·ç«¯æ¶ˆæ¯åè°ƒç”¨çš„æ–¹æ³•\n\t* @param message å®¢æˆ·ç«¯å‘é€è¿‡æ¥çš„æ¶ˆæ¯\n\t* @param session å¯é€‰çš„å‚æ•°\n\t*/\n\t@OnMessage\n\tpublic void onMessage(String message, Session session) {\n\t\tSystem.out.println(\"æ¥è‡ªå®¢æˆ·ç«¯çš„æ¶ˆæ¯:\" + message);\n\t}\n\n\t/**\n\t* å‘ç”Ÿé”™è¯¯æ—¶è°ƒç”¨\n\t* @param session\n\t* @param error\n\t*/\n\t@OnError\n\tpublic void onError(Session session, Throwable error){\n\t\tSystem.out.println(\"å‘ç”Ÿé”™è¯¯\");\n\t\terror.printStackTrace();\n\t}\n\n\t/**\n\t* è¿™ä¸ªæ–¹æ³•ä¸ä¸Šé¢å‡ ä¸ªæ–¹æ³•ä¸ä¸€æ ·ã€‚æ²¡æœ‰ç”¨æ³¨è§£ï¼Œæ˜¯æ ¹æ®è‡ªå·±éœ€è¦æ·»åŠ çš„æ–¹æ³•ã€‚\n\t* @param message\n\t* @throws IOException\n\t*/\n\tpublic void sendMessage(String message) throws IOException{\n\t\tthis.session.getBasicRemote().sendText(message);\n\t\t//this.session.getAsyncRemote().sendText(message);\n\t}\n}\n</code></pre></div><h1>3. springbootæ•´åˆwebsocket</h1>\n<h2>3.1. pom.xml</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependencies&gt;\n\t&lt;dependency&gt;\n\t&lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n\t&lt;artifactId&gt;spring-boot-starter-websocket&lt;/artifactId&gt;\n\t&lt;/dependency&gt;\n&lt;/dependencies&gt;\n</code></pre></div><h2>3.2. WebSocketConfigã€WebSocketInterceptorã€MyWebSocketHandler</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Configuration\n@EnableWebSocket\npublic class WebSocketConfig implements WebSocketConfigurer {\n  @Bean\n  public TextWebSocketHandler myWebSocketHandler() {\n    return new MyWebSocketHandler();\n  }\n  @Override\n  public void registerWebSocketHandlers(WebSocketHandlerRegistry registry) {\n    registry.addHandler(myWebSocketHandler(), \"/myweb/socket\").addInterceptors(new WebSocketInterceptor()).setAllowedOrigins(\"*\");//https://www.cnblogs.com/exmyth/p/11720371.html  \n    //registry.addHandler(myWebSocketHandler(), \"/myweb/sockjs\").addInterceptors(new WebSocketInterceptor()).withSockJS();  \n  }\n  @Bean\n  public TaskScheduler taskScheduler() {//é¿å…æ‰¾ä¸åˆ°TaskScheduler Bean\n    ThreadPoolTaskScheduler taskScheduler = new ThreadPoolTaskScheduler();\n    taskScheduler.setPoolSize(10);\n    taskScheduler.initialize();\n    return taskScheduler;\n  }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class WebSocketInterceptor extends HttpSessionHandshakeInterceptor {\n  @Override\n  public boolean beforeHandshake(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler, Map&lt;String, Object&gt; attributes) throws Exception {\n    String channel = ((ServletServerHttpRequest)request).getServletRequest().getParameter(\"ch\");\n    attributes.put(\"channel\", channel);//ä¼ å‚\n    return super.beforeHandshake(request, response, wsHandler, attributes);\n  }\n  @Override\n  public void afterHandshake(ServerHttpRequest request, ServerHttpResponse response, WebSocketHandler wsHandler, Exception ex) {\n    super.afterHandshake(request, response, wsHandler, ex);\n  }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Slf4j\npublic class MyWebSocketHandler extends TextWebSocketHandler{\n  @Autowired MyWebSocketService myWebSocketService;//æ³¨å…¥éœ€è¦çš„Service\n  @Override\n  public void afterConnectionEstablished(WebSocketSession session) throws Exception {\n    String channel = (String)session.getAttributes().get(\"channel\");//è·å–å‚æ•°\n    //è®°ä¸‹sessionå’Œå‚æ•°ç”¨äºä¸‹ä¸€æ­¥å‘æ¶ˆæ¯...\n  }\n  @Override\n  public void afterConnectionClosed(WebSocketSession session, CloseStatus status) throws Exception {\n    String channel = (String)session.getAttributes().get(\"channel\");\n    //åšä¼šè¯å…³é—­åçš„å¤„ç†...\n  }\n  @Override\n  protected void handleTextMessage(WebSocketSession session, TextMessage message) throws Exception {\n    log.debug(\"receive text message: \" + message.getPayload());\n    //æ”¶åˆ°æ¶ˆæ¯çš„å¤„ç†...\n  }\n  public void send(WebSocketSession session, String text) {\n    try {\n      TextMessage message = new TextMessage(text);\n      session.sendMessage(message);//å‘é€æ¶ˆæ¯çš„æ–¹æ³•\n    } catch (Exception e) {\n      e.printStackTrace();\n    }\n  }\n}\n</code></pre></div><h2>3.3. SseEmitter</h2>\n<ul>\n<li>Controlleræ–¹æ³•è¿”å›SseEmitterå¯¹è±¡å³å¯ä¸ºå®¢æˆ·ç«¯æä¾›EventSource</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>private static Set&lt;SseEmitter&gt; emitters = new HashSet&lt;&gt;();\n@RequestMapping(\"/myweb/eventsource\")\n@ResponseBody\nSseEmitter eventSource(String ch) {\n\tSseEmitter emitter = new SseEmitter(0L);\n\temitters.put(emitter);//è®°ä¸‹emitterç”¨äºä¹‹åå‘é€æ•°æ®\n\temitter.onCompletion(() -&gt; {\n\t\temitters.remove(emitter);//åšè¿æ¥å…³é—­åçš„å¤„ç†(ch, emitter)...\n\t});\n\temitter.onTimeout(() -&gt; {\n\t\temitter.complete();\n\t});\n\temitter.onError((e) -&gt; {\n\t\temitter.completeWithError(e);\n\t});\n\treturn emitter;\n\t}\n\tå‘æ‰€æœ‰çš„emitterså‘é€æ•°æ®text\n\n\tSseEventBuilder builder = SseEmitter.event().data(text);\n\temitters.forEach(emitter -&gt; {\n\ttry {\n\t\temitter.send(builder);\n\t} catch (Exception e) {\n\t\terrors.add(emitter);\n\t}\n});\n</code></pre></div><h1>4. å®¢æˆ·ç«¯è¿æ¥ å‰ç«¯jså¯¹è±¡WebSocketå’ŒEventSourceåˆ†åˆ«ç”¨äºè¿æ¥è¿™ä¸¤ç§æœåŠ¡ã€‚</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;!DOCTYPE html&gt;\n&lt;html&gt;\n\t&lt;head&gt;\n\t&lt;title&gt;Javaåç«¯WebSocketçš„Tomcatå®ç°&lt;/title&gt;\n\t&lt;/head&gt;\n&lt;body&gt;\n\tWelcome&lt;br/&gt;&lt;input id=\"text\" type=\"text\"/&gt;\n\t&lt;button onclick=\"send()\"&gt;å‘é€æ¶ˆæ¯&lt;/button&gt;\n\t&lt;hr/&gt;\n\t&lt;button onclick=\"closeWebSocket()\"&gt;å…³é—­WebSocketè¿æ¥&lt;/button&gt;\n\t&lt;hr/&gt;\n\t&lt;button onclick=\"onclear()\"&gt;æ¸…ç©º&lt;/button&gt;\n\t&lt;hr/&gt;\n\t&lt;div id=\"message\"&gt;&lt;/div&gt;\n&lt;/body&gt;\n\n&lt;script type=\"text/javascript\"&gt;\n     var websocket = null;\n     //åˆ¤æ–­å½“å‰æµè§ˆå™¨æ˜¯å¦æ”¯æŒWebSocket\n     if ('WebSocket' in window) {\n         websocket = new WebSocket(\"ws://localhost:8080/testwebscoket/websocket\");\n     }\n    else {\n         alert('å½“å‰æµè§ˆå™¨ Not support websocket')\n    }\n     //è¿æ¥å‘ç”Ÿé”™è¯¯çš„å›è°ƒæ–¹æ³•\n     websocket.onerror = function () {\n         setMessageInnerHTML(\"WebSocketè¿æ¥å‘ç”Ÿé”™è¯¯\");\n    };\n \n     //è¿æ¥æˆåŠŸå»ºç«‹çš„å›è°ƒæ–¹æ³•\n     websocket.onopen = function () {\n         setMessageInnerHTML(\"WebSocketè¿æ¥æˆåŠŸ\");\n     }\n \n     //æ¥æ”¶åˆ°æ¶ˆæ¯çš„å›è°ƒæ–¹æ³•\n     websocket.onmessage = function (event) {\n         setMessageInnerHTML(event.data);\n     }\n \n     //è¿æ¥å…³é—­çš„å›è°ƒæ–¹æ³•\n     websocket.onclose = function () {\n         setMessageInnerHTML(\"WebSocketè¿æ¥å…³é—­\");\n     }\n \n     //ç›‘å¬çª—å£å…³é—­äº‹ä»¶ï¼Œå½“çª—å£å…³é—­æ—¶ï¼Œä¸»åŠ¨å»å…³é—­websocketè¿æ¥ï¼Œ\n\t //é˜²æ­¢è¿æ¥è¿˜æ²¡æ–­å¼€å°±å…³é—­çª—å£ï¼Œserverç«¯ä¼šæŠ›å¼‚å¸¸ã€‚\n     window.onbeforeunload = function () {\n         closeWebSocket();\n     }\n \n     //å°†æ¶ˆæ¯æ˜¾ç¤ºåœ¨ç½‘é¡µä¸Š\n     function setMessageInnerHTML(innerHTML) {\n         document.getElementById('message').innerHTML += innerHTML + '&lt;br/&gt;';\n    }\n \n    //å…³é—­WebSocketè¿æ¥\n     function closeWebSocket() {\n         websocket.close();\n     }\n \n     //å‘é€æ¶ˆæ¯\n     function send() {\n         var message = document.getElementById('text').value;\n         websocket.send(message);\n     }\n\t function onclear(){\n        document.getElementById('message').innerHTML = \"\";\n    }\n\t&lt;/script&gt;\n&lt;/html&gt;\n</code></pre></div><h1>5. Nginxéœ€è¦çš„é¢å¤–é…ç½®</h1>\n<h2>5.1. EventSource</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>proxy_http_version 1.1;\nproxy_set_header Connection '';\nproxy_buffering off;\nproxy_cache off;\ngzip off;\nchunked_transfer_encoding off;\n</code></pre></div><h2>5.2. WebSocket</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>proxy_http_version 1.1;\nproxy_set_header Upgrade $http_upgrade;\nproxy_set_header Connection \"Upgrade\";\n</code></pre></div><h1>6. å·²çŸ¥é—®é¢˜</h1>\n<ul>\n<li>ç«ç‹ä¸‹EventSourceä¸­æ–­ä¹‹åä¸ä¼šè‡ªåŠ¨é‡è¿ã€‚</li>\n<li>IEç³»åˆ—æµè§ˆå™¨éƒ½ä¸æ”¯æŒEventSourceã€‚</li>\n</ul>\n<h1>7. è·å¾—httpssessionçš„æ–¹æ³•</h1>\n<ul>\n<li>ç”±äºWebSocketä¸Httpåè®®çš„ä¸åŒï¼Œæ•…åœ¨ä½¿ç”¨å¸¸ç”¨çš„HttpSessionæ–¹é¢å°±å­˜åœ¨äº†ä¸€äº›é—®é¢˜ã€‚</li>\n</ul>\n<h2>7.1. GetHttpSessionConfigurator</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package per.zww.web;\nimport javax.servlet.http.HttpSession;\nimport javax.websocket.HandshakeResponse;\nimport javax.websocket.server.HandshakeRequest;\nimport javax.websocket.server.ServerEndpointConfig;\nimport javax.websocket.server.ServerEndpointConfig.Configurator;\n/*\n* è·å–HttpSession\n* \n*/\npublic class GetHttpSessionConfigurator extends Configurator {\n\t@Override\n\tpublic void modifyHandshake(ServerEndpointConfig sec,HandshakeRequest request, HandshakeResponse response) {\n\t\t// TODO Auto-generated method stub\n\t\tHttpSession httpSession=(HttpSession) request.getHttpSession();\n\t\tsec.getUserProperties().put(HttpSession.class.getName(),httpSession);\n\t}\n}\n</code></pre></div><h2>7.2. åœ¨@ServerEndpointæ³¨è§£é‡Œé¢æ·»åŠ configuratorå±æ€§</h2>\n<ul>\n<li>@ServerEndpoint(value=\"/socketTest\",configurator=GetHttpSessionConfigurator.class)</li>\n</ul>\n<h2>7.3. åœ¨onOpenæ–¹æ³•é‡ŒåŠ å…¥å‚æ•°EndpointConfig configå³å¯è·å–HttpSession</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@OnOpen\npublic void onOpen(Session session,EndpointConfig config) {\n\tHttpSession httpSession= (HttpSession) config.getUserProperties().get(HttpSession.class.getName());\n\tif (httpSession == null){  \n\t\thttpSession = new HttpSession() {  \n\t\t\t@Override  \n\t\t\tpublic long getCreationTime() {  return 0;  }  \n\n\t\t\t@Override  \n\t\t\tpublic String getId() {  return null;  }  \n\n\t\t\t@Override  \n\t\t\tpublic long getLastAccessedTime() {  return 0;  }  \n\n\t\t\t@Override  \n\t\t\tpublic ServletContext getServletContext() {  return null;  }  \n\n\t\t\t@Override  \n\t\t\tpublic void setMaxInactiveInterval(int i) {}  \n\n\t\t\t@Override  \n\t\t\tpublic int getMaxInactiveInterval() {  return 0;  }  \n\n\t\t\t@Override  \n\t\t\tpublic HttpSessionContext getSessionContext() {  return null;  }  \n\n\t\t\t@Override  \n\t\t\tpublic Object getAttribute(String s) {  return null;  }  \n\n\t\t\t@Override  \n\t\t\tpublic Object getValue(String s) {  return null;  }  \n\n\t\t\t@Override  \n\t\t\tpublic Enumeration&lt;String&gt; getAttributeNames() {  return null;  }  \n\n\t\t\t@Override  \n\t\t\tpublic String[] getValueNames() {  return new String[0];  }  \n\n\t\t\t@Override  \n\t\t\tpublic void setAttribute(String s, Object o) {}  \n\n\t\t\t@Override  \n\t\t\tpublic void putValue(String s, Object o) {}  \n\n\t\t\t@Override  \n\t\t\tpublic void removeAttribute(String s) {}  \n\n\t\t\t@Override  \n\t\t\tpublic void removeValue(String s) {}  \n\n\t\t\t@Override  \n\t\t\tpublic void invalidate() {}  \n\n\t\t\t@Override  \n\t\t\tpublic boolean isNew() {  return false; }  \n\t\t};  \n\t}\n\tsessionMap.put(session.getId(), session);\n}\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "xml",
      "url": "https://javaguide.cn/backend/protocol/xml.html",
      "id": "https://javaguide.cn/backend/protocol/xml.html",
      "summary": "xml 1. xmlä»‹ç» 2. xmlè¯­æ³•: 3. xmlçº¦æŸ 3.1. DTDçº¦æŸ 3.2. Schemaçº¦æŸ 3.3. xmlè§£æ 3.4. è§£æå¼€å‘åŒ… 3.5. DOMè§£æåŸç†åŠç»“æ„æ¨¡å‹ 1. xmlä»‹ç» xml:Extensible Markup Language å¯æ‰©å±•çš„æ ‡è®°è¯­è¨€ï¼Œæ ‡ç­¾å¯è‡ªå®šä¹‰ï¼Œå…¶ä»–ä¸Htmlç›¸ä¼¼ ç”¨ä½œ:é…ç½®æ–‡ä»¶/å­˜æ”¾æ•°æ® 2...",
      "content_html": "<p>xml</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-xml%E4%BB%8B%E7%BB%8D\">1. xmlä»‹ç»</a></li>\n<li><a href=\"#2-xml%E8%AF%AD%E6%B3%95\">2. xmlè¯­æ³•:</a></li>\n<li><a href=\"#3-xml%E7%BA%A6%E6%9D%9F\">3. xmlçº¦æŸ</a>\n<ul>\n<li><a href=\"#31-dtd%E7%BA%A6%E6%9D%9F\">3.1. DTDçº¦æŸ</a></li>\n<li><a href=\"#32-schema%E7%BA%A6%E6%9D%9F\">3.2. Schemaçº¦æŸ</a></li>\n</ul>\n</li>\n<li><a href=\"#33-xml%E8%A7%A3%E6%9E%90\">3.3. xmlè§£æ</a></li>\n<li><a href=\"#34-%E8%A7%A3%E6%9E%90%E5%BC%80%E5%8F%91%E5%8C%85\">3.4. è§£æå¼€å‘åŒ…</a></li>\n<li><a href=\"#35-dom%E8%A7%A3%E6%9E%90%E5%8E%9F%E7%90%86%E5%8F%8A%E7%BB%93%E6%9E%84%E6%A8%A1%E5%9E%8B\">3.5. DOMè§£æåŸç†åŠç»“æ„æ¨¡å‹</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. xmlä»‹ç»</h1>\n<ul>\n<li>xml:Extensible Markup Language å¯æ‰©å±•çš„æ ‡è®°è¯­è¨€ï¼Œæ ‡ç­¾å¯è‡ªå®šä¹‰ï¼Œå…¶ä»–ä¸Htmlç›¸ä¼¼</li>\n<li>ç”¨ä½œ:é…ç½®æ–‡ä»¶/å­˜æ”¾æ•°æ®</li>\n</ul>\n<h1>2. xmlè¯­æ³•:</h1>\n<ul>\n<li>æ–‡æ¡£å£°æ˜:å¿…é¡»ä»æ–‡æ¡£çš„0è¡Œ0åˆ—ä½ç½®å¼€å§‹;å¿…é¡»ä»¥&lt;?xmlå¼€å¤´ï¼Œä»¥?&gt;ç»“æŸ;\n<ul>\n<li>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;</li>\n<li>æ–‡æ¡£å£°æ˜åªæœ‰ä¸‰ä¸ªå±æ€§\n<ul>\n<li>1.versionï¼šæŒ‡å®šxmlæ–‡æ¡£ç‰ˆæœ¬ï¼Œå¿…é¡»å±æ€§ï¼Œåªé€‰1.0ç‰ˆ</li>\n<li>2.encodingï¼šæŒ‡å®šå½“å‰æ–‡æ¡£çš„ç¼–ç ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼æ˜¯utf-8;</li>\n<li>3.standalone:æŒ‡å®šæ–‡æ¡£ç‹¬ç«‹æ€§ï¼Œå¯é€‰å±æ€§ï¼Œé»˜è®¤å€¼ä¸ºyesï¼Œè¡¨ç¤ºå½“å‰æ–‡æ¡£æ˜¯ç‹¬ç«‹çš„æ–‡æ¡£ï¼›noè¡¨ç¤ºå½“å‰æ–‡æ¡£ä¸æ˜¯ç‹¬ç«‹æ–‡æ¡£ï¼Œä¾èµ–å¤–éƒ¨æ–‡ä»¶</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å…ƒç´ \n<ul>\n<li>&lt;servlet&gt;</li>\n<li>æ™®é€šå…ƒç´ çš„ç»“æ„ç”±å¼€å§‹æ ‡ç­¾ï¼Œå…ƒç´ ä½“ï¼Œç»“æŸæ ‡ç­¾ç»„æˆ&lt;a&gt;&lt;/a&gt;</li>\n<li>å…ƒç´ ä½“å¯ä»¥æ˜¯å…ƒç´ æˆ–è€…æ–‡æœ¬&lt;a&gt;&lt;b&gt;æ–‡æœ¬&lt;/b&gt;&lt;/a&gt;</li>\n<li>ç©ºå…ƒç´ åªæœ‰å¼€å§‹æ ‡ç­¾ï¼Œæ— ç»“æŸæ ‡ç­¾ï¼Œå…ƒç´ å¿…é¡»è‡ªå·±é—­åˆ&lt;c/&gt;</li>\n<li>å…ƒç´ å‘½ååŒºåˆ†å¤§å°å†™ï¼Œä¸èƒ½ç©ºæ ¼å†’å·ï¼Œä¸å»ºè®®å„ç§xmlå¼€å¤´</li>\n<li>æ ¼å¼åŒ–è‰¯å¥½çš„xmlæœ‰ä¸€ä¸ªæ ¹å…ƒç´ </li>\n</ul>\n</li>\n<li>å±æ€§\n<ul>\n<li>&lt;web-app version=\"2.5\"&gt;</li>\n<li>ä½äºå…ƒç´ çš„å¼€å§‹æ ‡ç­¾ä¸­ï¼Œå±æ€§=å±æ€§å€¼</li>\n<li>å±æ€§å€¼å¿…é¡»å•å¼•å·æˆ–è€…åŒå¼•</li>\n<li>ä¸€ä¸ªå…ƒç´ å¯ä»¥æœ‰nä¸ªä¸åŒåå±æ€§</li>\n<li>å±æ€§åä¸èƒ½ç©ºæ ¼å†’å·ï¼Œå¿…é¡»å­—æ¯å¼€å¤´</li>\n</ul>\n</li>\n<li>æ³¨é‡Š &lt;!--æ³¨é‡Š--&gt;</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d5cf38d9a11590a845bb2.png\" alt=\"xmlè½¬ä¹‰å­—ç¬¦.png\" tabindex=\"0\"><figcaption>xmlè½¬ä¹‰å­—ç¬¦.png</figcaption></figure>\n<ul>\n<li>&lt;![CDATA[éœ€è¦å¤§é‡è½¬ä¹‰å­—ç¬¦åŸæ¥çš„å­—ç¬¦]]&gt;</li>\n</ul>\n<h1>3. xmlçº¦æŸ</h1>\n<h2>3.1. DTDçº¦æŸ</h2>\n<ul>\n<li>\n<p>æ–‡æ¡£ç±»å‹å®šä¹‰ï¼Œçº¦æŸXMLå…ƒç´ åŠå…¶å­å…ƒç´ çš„åç§°åŠé¡ºåºã€å±æ€§ç­‰</p>\n</li>\n<li>\n<p>æ–‡æ¡£å£°æ˜ï¼š&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;åé¢</p>\n<ul>\n<li>å†…éƒ¨DTD:&lt;!DOCTYPE æ ¹æ ‡ç­¾å  [è¯­æ³•....]&gt;åªå¯¹å½“å‰çš„xmlæœ‰æ•ˆ</li>\n<li>å¤–éƒ¨DTD--æœ¬åœ°æ–‡ä»¶:&lt;!DOCTYPE æ ¹æ ‡ç­¾å SYSTEM \"xxxx.dtd\"&gt;</li>\n<li>å¤–éƒ¨DTD--ç½‘ç»œ:&lt;!DOCTYPE æ ¹æ ‡ç­¾å PUBLIC \"åç§°\" \"è·¯å¾„\"&gt;ä¸€èˆ¬ç”±æ¡†æ¶æä¾›</li>\n</ul>\n</li>\n<li>\n<p>å…ƒç´ å£°æ˜&lt;!ELEMENT æ ‡ç­¾å [ç¬¦å·|çº¦æŸ]&gt;</p>\n<ul>\n<li>&lt;!ELEMENT hibernate-mapping (meta*)&gt;</li>\n<li>ç¬¦å·ï¼šï¼Ÿ+ *  , | ()   â€œæ–‡å˜‰å…´â€</li>\n<li>çº¦æŸï¼š#PCDATA è¡¨ç¤ºå†…å®¹æ˜¯æ–‡æœ¬ä¸æ˜¯å­æ ‡ç­¾</li>\n<li>åé¢æ²¡åŠ ç¬¦å·çš„è¡¨ç¤ºæœ‰ä¸”åªæœ‰ä¸€æ¬¡ï¼Œ()åˆ†ç»„å¹¶æŒ‡ç¤ºå­å…ƒç´ ä¸ªæ•°åŠé¡ºåº</li>\n</ul>\n</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/71ba34c1b3ed854bd6ae4.png\" alt=\"dtdå…ƒç´ å£°æ˜.png\" tabindex=\"0\"><figcaption>dtdå…ƒç´ å£°æ˜.png</figcaption></figure>\n<ul>\n<li>å±æ€§å£°æ˜&lt;!ATTLIST æ ‡ç­¾å å±æ€§æè¿° å±æ€§æè¿°2 ...&gt;\n<ul>\n<li>&lt;!ATTLIST hibernate-mapping schema CDATA #IMPLIED&gt;</li>\n<li>å±æ€§æè¿°\n<ul>\n<li>å±æ€§åï¼šè‡ªå®šä¹‰</li>\n<li>å±æ€§ç±»å‹ï¼šCDATA ï¼ŒID ï¼Œæšä¸¾ï¼ˆxx|ï¼‰</li>\n<li>å±æ€§çº¦æŸï¼š#REQUIRED ï¼ˆå¿…é¡»ï¼‰ #IMPLIEDï¼ˆå¯é€‰ï¼‰</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h2>3.2. Schemaçº¦æŸ</h2>\n<ul>\n<li>\n<p>æ¯”DTDåŠŸèƒ½å¼ºã€æ‰©å±•åä¸ºxsdã€æ”¯æŒå‘½åç©ºé—´ã€æ•°æ®ç±»å‹æ›´å®Œå–„</p>\n</li>\n<li>\n<p>å‘½åç©ºé—´(è§£å†³å¤šä¸ªxsdçš„å…ƒç´ å’Œå±æ€§åå†²çªçš„é—®é¢˜)</p>\n<ul>\n<li>ç»™schemaæ–‡æ¡£èµ·ä¸€ä¸ªåç§°ï¼Œåªæ˜¯å»ºè®®é‡‡ç”¨æ˜¯urlè¿›è¡Œå‘½åã€‚æ˜¯ä¸æ˜¯å®˜æ–¹æ–‡æ¡£çœ‹é‚£ä¸ªurl</li>\n<li>èƒ½åœ¨xmlä¸­åŒºåˆ«å¤šä¸ªçº¦æŸæ–‡æ¡£ä¸­ï¼Œé‡åçš„å…ƒç´ ã€å±æ€§ç­‰å†…å®¹ã€‚</li>\n<li>ç¼ºçœå‘½åç©ºé—´ï¼ˆé»˜è®¤ï¼‰:&lt;xxx xmlns=\"\"   &gt;ä½¿ç”¨å…ƒç´ æˆ–å±æ€§æ—¶ä¸åŠ å‰ç¼€&lt;xxx&gt;</li>\n<li>æ˜¾ç¤ºå‘½åç©ºé—´:&lt;xsd xmlns:åˆ«å=\"\"&gt;ä½¿ç”¨å…ƒç´ æˆ–å±æ€§æ—¶åŠ å‰ç¼€&lt;åˆ«å:xxx&gt;</li>\n<li>åªè¦urlä¸€æ ·ï¼Œä¸¤ç§å£°æ˜æ–¹å¼ä¸€æ ·</li>\n</ul>\n</li>\n<li>\n<p>æ–‡æ¡£å£°æ˜</p>\n<ul>\n<li>&lt;xxx xmlns=\"....\"xmlns:xsi=\"<a href=\"http://www.w3.org/2001/XMLSchema-instance\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.w3.org/2001/XMLSchema-instance</a>\" xsi:schemaLocation=\"åç§°  è·¯å¾„   åç§°2 è·¯å¾„2  .....\"&gt;  .....</li>\n<li>&lt;web-app xmlns=\"<a href=\"http://www.example.org/web-app_2_5\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.example.org/web-app_2_5</a>\" è‡ªå®šä¹‰æ–‡æ¡£å‘½åç©ºé—´ï¼ˆåŒ…åï¼‰<br>\nxmlns:xsi=\"<a href=\"http://www.w3.org/2001/XMLSchema-instance\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.w3.org/2001/XMLSchema-instance</a>\"ï¼ˆå®˜æ–¹æ–‡æ¡£å‘½åç©ºé—´ï¼‰<br>\nxsi:schemaLocation=\"<a href=\"http://www.example.org/web-app_2_5\" target=\"_blank\" rel=\"noopener noreferrer\">http://www.example.org/web-app_2_5</a> web-app_2_5.xsd\" ä½¿ç”¨äº†å®˜æ–¹æ–‡æ¡£çš„è‡ªå®šä¹‰æ–‡æ¡£ä½ç½®å±æ€§ï¼ˆåŒ…é‡Œé¢çš„å…·ä½“ç±»ï¼‰version=\"2.5\"&gt;</li>\n</ul>\n</li>\n</ul>\n<h1>3.3. xmlè§£æ</h1>\n<ul>\n<li>DOMè§£æ\n<ul>\n<li>å°†xmlæ–‡æ¡£åŠ è½½åˆ°å†…å­˜å½¢æˆæ ‘ç»“æ„ï¼Œå½¢æˆDocumentå¯¹è±¡\n<ul>\n<li>ä¼˜ç‚¹:å…ƒç´ ä¸å…ƒç´ æœ‰ç»“æ„å…³ç³»ï¼Œèƒ½CRUDï¼Œ</li>\n<li>ç¼ºç‚¹ï¼šæ–‡æ¡£å¤ªå¤§æ˜“å†…å­˜æº¢å‡º</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>SAXè§£æ\n<ul>\n<li>äº‹ä»¶é©±åŠ¨çš„æ–¹å¼é€è¡Œè¾¹è¯»è¾¹è§£æï¼Œæ¯æ‰§è¡Œä¸€è¡Œéƒ½è§¦å‘ç›¸åº”çš„äº‹ä»¶\n<ul>\n<li>ä¼˜ç‚¹ï¼šæ–‡æ¡£å¤§ä¹Ÿä¸å†…å­˜æº¢å‡ºï¼Œé€Ÿåº¦å¿«</li>\n<li>ç¼ºç‚¹ï¼šåªè¯»ï¼Œä¸èƒ½CRUDï¼Œè¿è¡Œåé‡Šæ”¾èµ„æº</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>PULL:å®‰å“å†…ç½®çš„xmlè§£ææ–¹å¼ï¼Œç±»ä¼¼saxï¼ˆäº†è§£ï¼‰</li>\n</ul>\n<h1>3.4. è§£æå¼€å‘åŒ…</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/a77f965211515afaa58ae.png\" alt=\"xmlè§£æå¼€å‘åŒ….png\" tabindex=\"0\"><figcaption>xmlè§£æå¼€å‘åŒ….png</figcaption></figure>\n<h1>3.5. DOMè§£æåŸç†åŠç»“æ„æ¨¡å‹</h1>\n<ul>\n<li>åŸç†:å°†æ•´ä¸ªxmlæ–‡æ¡£åŠ è½½åˆ°å†…å­˜ï¼Œç”Ÿæˆä¸€ä¸ªDOMæ ‘å¹¶è·å¾—Documentå¯¹è±¡ä»¥å®ŒæˆDOMæ“ä½œ</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/d5859ea3930b7466265ed.png\" alt=\"domè§£æåŸç†.png\" tabindex=\"0\"><figcaption>domè§£æåŸç†.png</figcaption></figure>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/d5cf38d9a11590a845bb2.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "ç†è®º"
      ]
    },
    {
      "title": "ElasticSearch",
      "url": "https://javaguide.cn/backend/searchengine/elasticsearch.html",
      "id": "https://javaguide.cn/backend/searchengine/elasticsearch.html",
      "summary": "ElasticSearch ElasticSearchä»‹ç» æ³¨æ„ï¼š åœ¨æ²¡æœ‰åˆ›å»ºåº“çš„æ—¶å€™æœç´¢ï¼ŒESä¼šåˆ›å»ºä¸€ä¸ªåº“å¹¶è‡ªåŠ¨åˆ›å»ºè¯¥å­—æ®µå¹¶ä¸”è®¾ç½®ä¸ºStringç±»å‹ä¹Ÿå°±æ˜¯text ä»€ä¹ˆæ˜¯elasticsearchï¼Ÿä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¯ä»¥ç”¨æ¥å®ç°ä»æµ·é‡æ•°æ®å­˜å‚¨ã€æœç´¢ã€åˆ†æç­‰åŠŸèƒ½ã€‚åº•å±‚æ˜¯åŸºäºlucene(Javaè¯­è¨€çš„æœç´¢å¼•æ“ç±»åº“)æ¥å®ç°ã€‚ ä»€ä¹ˆæ˜¯elastic...",
      "content_html": "<!--more-->\n<h1>ElasticSearch</h1>\n<h2>ElasticSearchä»‹ç»</h2>\n<ul>\n<li>æ³¨æ„ï¼š åœ¨æ²¡æœ‰åˆ›å»ºåº“çš„æ—¶å€™æœç´¢ï¼ŒESä¼šåˆ›å»ºä¸€ä¸ªåº“å¹¶è‡ªåŠ¨åˆ›å»ºè¯¥å­—æ®µå¹¶ä¸”è®¾ç½®ä¸ºStringç±»å‹ä¹Ÿå°±æ˜¯text</li>\n<li>ä»€ä¹ˆæ˜¯elasticsearchï¼Ÿä¸€ä¸ªå¼€æºçš„åˆ†å¸ƒå¼æœç´¢å¼•æ“ï¼Œå¯ä»¥ç”¨æ¥å®ç°ä»æµ·é‡æ•°æ®å­˜å‚¨ã€æœç´¢ã€åˆ†æç­‰åŠŸèƒ½ã€‚åº•å±‚æ˜¯åŸºäºlucene(Javaè¯­è¨€çš„æœç´¢å¼•æ“ç±»åº“)æ¥å®ç°ã€‚</li>\n<li>ä»€ä¹ˆæ˜¯elastic stackï¼ˆELKï¼‰ï¼Ÿä»¥elasticsearchä¸ºæ ¸å¿ƒçš„æŠ€æœ¯æ ˆï¼ŒåŒ…æ‹¬beatsã€Logstashã€kibana(å¯è§†åŒ–ç•Œé¢)ã€elasticsearchï¼Œè¢«å¹¿æ³›åº”ç”¨åœ¨æ—¥å¿—æ•°æ®åˆ†æã€å®æ—¶ç›‘æ§ç­‰é¢†åŸŸï¼š</li>\n<li>ä»€ä¹ˆæ˜¯Luceneï¼ŸApacheçš„å¼€æºæœç´¢å¼•æ“ç±»åº“ï¼Œæä¾›äº†æœç´¢å¼•æ“çš„æ ¸å¿ƒAPI</li>\n</ul>\n<h2>eså‚è€ƒæ–‡æ¡£</h2>\n<ul>\n<li><a href=\"https://www.cnblogs.com/buchizicai/p/17093719.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.cnblogs.com/buchizicai/p/17093719.html</a></li>\n</ul>\n<h2>æ­£å‘ç´¢å¼•å’Œå€’æ’ç´¢å¼•</h2>\n<ul>\n<li>\n<p>å€’æ’ç´¢å¼•çš„æ¦‚å¿µæ˜¯åŸºäºMySQLè¿™æ ·çš„æ­£å‘ç´¢å¼•è€Œè¨€çš„ã€‚</p>\n</li>\n<li>\n<p>æ­£å‘ç´¢å¼•ï¼šè®¾ç½®äº†ç´¢å¼•çš„æŸ¥è¯¢é€Ÿåº¦å¿«ï¼Œä½†è¦æ˜¯æ¨¡ç³ŠæŸ¥è¯¢åˆ™å°±å¾ˆæ…¢ï¼éœ€è¦å…¨è¡¨æ‰«æ</p>\n</li>\n<li>\n<p>å€’æ’ç´¢å¼•</p>\n<ul>\n<li>è¯æ¡ï¼ˆTermï¼‰ï¼šå¯¹æ–‡æ¡£æ•°æ®æˆ–ç”¨æˆ·æœç´¢æ•°æ®ï¼Œåˆ©ç”¨æŸç§ç®—æ³•åˆ†è¯ï¼Œå¾—åˆ°çš„å…·å¤‡å«ä¹‰çš„è¯è¯­å°±æ˜¯è¯æ¡ã€‚ä¾‹å¦‚ï¼šæˆ‘æ˜¯ä¸­å›½äººï¼Œå°±å¯ä»¥åˆ†ä¸ºï¼šæˆ‘ã€æ˜¯ã€ä¸­å›½äººã€ä¸­å›½ã€å›½äººè¿™æ ·çš„å‡ ä¸ªè¯æ¡</li>\n<li>åˆ›å»ºå€’æ’ç´¢å¼•æµç¨‹ï¼š\n<ul>\n<li>å°†æ¯ä¸€ä¸ªæ–‡æ¡£çš„æ•°æ®åˆ©ç”¨ç®—æ³•åˆ†è¯ï¼Œå¾—åˆ°ä¸€ä¸ªä¸ªè¯æ¡</li>\n<li>åˆ›å»ºè¡¨ï¼Œæ¯è¡Œæ•°æ®åŒ…æ‹¬è¯æ¡ã€è¯æ¡æ‰€åœ¨æ–‡æ¡£idã€ä½ç½®ç­‰ä¿¡æ¯</li>\n<li>å› ä¸ºè¯æ¡å”¯ä¸€æ€§ï¼Œå¯ä»¥ç»™è¯æ¡åˆ›å»ºç´¢å¼•ï¼Œä¾‹å¦‚hashè¡¨ç»“æ„ç´¢å¼•</li>\n</ul>\n</li>\n<li>æŸ¥è¯¢æ—¶è™½ç„¶è¦å…ˆæŸ¥è¯¢å€’æ’ç´¢å¼•ï¼Œå†æŸ¥è¯¢å€’æ’ç´¢å¼•ï¼Œä½†æ˜¯æ— è®ºæ˜¯è¯æ¡ã€è¿˜æ˜¯æ–‡æ¡£idéƒ½å»ºç«‹äº†ç´¢å¼•ï¼ŒæŸ¥è¯¢é€Ÿåº¦éå¸¸å¿«ï¼æ— éœ€å…¨è¡¨æ‰«æã€‚</li>\n</ul>\n</li>\n<li>\n<p>æ­£å‘å’Œå€’æ’å¯¹æ¯”</p>\n<ul>\n<li>æ­£å‘ç´¢å¼•æ˜¯æœ€ä¼ ç»Ÿçš„ï¼Œæ ¹æ®idç´¢å¼•çš„æ–¹å¼ã€‚ä½†æ ¹æ®è¯æ¡æŸ¥è¯¢æ—¶ï¼Œå¿…é¡»å…ˆé€æ¡è·å–æ¯ä¸ªæ–‡æ¡£ï¼Œç„¶ååˆ¤æ–­æ–‡æ¡£ä¸­æ˜¯å¦åŒ…å«æ‰€éœ€è¦çš„è¯æ¡ï¼Œæ˜¯æ ¹æ®æ–‡æ¡£æ‰¾è¯æ¡çš„è¿‡ç¨‹ã€‚</li>\n<li>è€Œå€’æ’ç´¢å¼•åˆ™ç›¸åï¼Œæ˜¯å…ˆæ‰¾åˆ°ç”¨æˆ·è¦æœç´¢çš„è¯æ¡ï¼Œæ ¹æ®è¯æ¡å¾—åˆ°ä¿æŠ¤è¯æ¡çš„æ–‡æ¡£çš„idï¼Œç„¶åæ ¹æ®idè·å–æ–‡æ¡£ã€‚æ˜¯æ ¹æ®è¯æ¡æ‰¾æ–‡æ¡£çš„è¿‡ç¨‹ã€‚</li>\n</ul>\n</li>\n<li>\n<p>æ­£å‘ç´¢å¼•ï¼š</p>\n<ul>\n<li>ä¼˜ç‚¹ï¼šå¯ä»¥ç»™å¤šä¸ªå­—æ®µåˆ›å»ºç´¢å¼•ã€æ ¹æ®ç´¢å¼•å­—æ®µæœç´¢ã€æ’åºé€Ÿåº¦éå¸¸å¿«</li>\n<li>ç¼ºç‚¹ï¼šæ ¹æ®éç´¢å¼•å­—æ®µï¼Œæˆ–è€…ç´¢å¼•å­—æ®µä¸­çš„éƒ¨åˆ†è¯æ¡æŸ¥æ‰¾æ—¶ï¼Œåªèƒ½å…¨è¡¨æ‰«æã€‚</li>\n</ul>\n</li>\n<li>\n<p>å€’æ’ç´¢å¼•ï¼š</p>\n<ul>\n<li>ä¼˜ç‚¹ï¼šæ ¹æ®è¯æ¡æœç´¢ã€æ¨¡ç³Šæœç´¢æ—¶ï¼Œé€Ÿåº¦éå¸¸å¿«</li>\n<li>ç¼ºç‚¹ï¼šåªèƒ½ç»™è¯æ¡åˆ›å»ºç´¢å¼•ï¼Œè€Œä¸æ˜¯å­—æ®µã€æ— æ³•æ ¹æ®å­—æ®µåšæ’åº</li>\n</ul>\n</li>\n</ul>\n<h2>ESæ•°æ®åº“åŸºæœ¬æ¦‚å¿µ</h2>\n<table>\n<thead>\n<tr>\n<th style=\"text-align:center\">MySQL</th>\n<th style=\"text-align:center\">Elasticsearch</th>\n<th style=\"text-align:center\">è¯´æ˜</th>\n</tr>\n</thead>\n<tbody>\n<tr>\n<td style=\"text-align:center\">Table</td>\n<td style=\"text-align:center\">Index</td>\n<td style=\"text-align:center\">ç´¢å¼•(index)ï¼Œå°±æ˜¯æ–‡æ¡£çš„é›†åˆï¼Œç±»ä¼¼æ•°æ®åº“çš„è¡¨(table)</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Row</td>\n<td style=\"text-align:center\">Document</td>\n<td style=\"text-align:center\">æ–‡æ¡£ï¼ˆDocumentï¼‰ï¼Œå°±æ˜¯ä¸€æ¡æ¡çš„æ•°æ®ï¼Œç±»ä¼¼æ•°æ®åº“ä¸­çš„è¡Œï¼ˆRowï¼‰ï¼Œæ–‡æ¡£éƒ½æ˜¯JSONæ ¼å¼</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Column</td>\n<td style=\"text-align:center\">Field</td>\n<td style=\"text-align:center\">å­—æ®µï¼ˆFieldï¼‰ï¼Œå°±æ˜¯JSONæ–‡æ¡£ä¸­çš„å­—æ®µï¼Œç±»ä¼¼æ•°æ®åº“ä¸­çš„åˆ—ï¼ˆColumnï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">Schema</td>\n<td style=\"text-align:center\">Mapping</td>\n<td style=\"text-align:center\">Mappingï¼ˆæ˜ å°„ï¼‰æ˜¯ç´¢å¼•ä¸­æ–‡æ¡£çš„çº¦æŸï¼Œä¾‹å¦‚å­—æ®µç±»å‹çº¦æŸã€‚ç±»ä¼¼æ•°æ®åº“çš„è¡¨ç»“æ„ï¼ˆSchemaï¼‰</td>\n</tr>\n<tr>\n<td style=\"text-align:center\">SQL</td>\n<td style=\"text-align:center\">DSL</td>\n<td style=\"text-align:center\">DSLæ˜¯elasticsearchæä¾›çš„JSONé£æ ¼çš„è¯·æ±‚è¯­å¥ï¼Œç”¨æ¥æ“ä½œelasticsearchï¼Œå®ç°CRUD</td>\n</tr>\n</tbody>\n</table>\n<h2>Mappingå±æ€§</h2>\n<ul>\n<li>typeï¼šå­—æ®µæ•°æ®ç±»å‹ï¼Œå¸¸è§çš„ç®€å•ç±»å‹æœ‰ï¼š\n<ul>\n<li>å­—ç¬¦ä¸²ï¼štextï¼ˆå¯åˆ†è¯çš„æ–‡æœ¬ï¼‰ã€keywordï¼ˆä¸å¯åˆ†è¯ï¼Œåªèƒ½æ•´ä½“æœç´¢ï¼Œä¸æ”¯æŒæœç´¢éƒ¨åˆ†å†…å®¹ã€‚ä¾‹å¦‚ï¼šå“ç‰Œã€å›½å®¶ã€ipåœ°å€ï¼‰</li>\n<li>æ•°å€¼ï¼šlongã€integerã€shortã€byteã€doubleã€floatã€</li>\n<li>å¸ƒå°”ï¼šboolean</li>\n<li>æ—¥æœŸï¼šdate</li>\n<li>å¯¹è±¡ï¼šobject</li>\n<li>geo_pointåœ°ç†åæ ‡:ç”±çº¬åº¦(latitude)å’Œç»åº¦(longitude)ç¡®å®šçš„ä¸€ä¸ªç‚¹ã€‚ä¾‹å¦‚:\"32.8752345,120.2981576\"</li>\n<li>geo_shape:æœ‰å¤šä¸ªgeo_pointç»„æˆçš„å¤æ‚å‡ ä½•å›¾å½¢ã€‚ä¾‹å¦‚ä¸€æ¡ç›´çº¿ï¼Œ\"LINESTRING(-770365338.897676,-77009051 38.889939)\"</li>\n<li>completionï¼šç”¨æ¥å®ç°è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚è¿™ä¸ªæŸ¥è¯¢ä¼šåŒ¹é…ä»¥ç”¨æˆ·è¾“å…¥å†…å®¹å¼€å¤´çš„è¯æ¡å¹¶è¿”å›ã€‚å­—æ®µçš„å†…å®¹ä¸€èˆ¬æ˜¯ç”¨æ¥è¡¥å…¨çš„å¤šä¸ªè¯æ¡å½¢æˆçš„æ•°ç»„ã€‚</li>\n</ul>\n</li>\n<li>indexï¼šæ˜¯å¦åˆ›å»ºç´¢å¼•ï¼Œé»˜è®¤ä¸ºtrue</li>\n<li>analyzerï¼šä½¿ç”¨å“ªç§åˆ†è¯å™¨</li>\n<li>propertiesï¼šè¯¥å­—æ®µçš„å­å­—æ®µ</li>\n<li>copy_to:å°†å½“å‰å­—æ®µå€¼æ‹·è´åˆ°å¦ä¸€ä¸ªå­—æ®µä¸Šï¼Œä¾›ç”¨æˆ·æœç´¢</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä¾‹å¦‚ä¸‹é¢çš„jsonæ–‡æ¡£ï¼š\n\n{\n    \"age\": 21,\n    \"weight\": 52.1,\n    \"isMarried\": false,\n    \"info\": \"çœŸç›¸åªæœ‰ä¸€ä¸ªï¼\",\n    \"email\": \"zy@itcast.cn\",\n    \"score\": [99.1, 99.5, 98.9],\n    \"name\": {\n        \"firstName\": \"æŸ¯\",\n        \"lastName\": \"å—\"\n    }\n}\nå¯¹åº”çš„æ¯ä¸ªå­—æ®µæ˜ å°„ï¼ˆmappingï¼‰ï¼š\nageï¼šç±»å‹ä¸º integerï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›æ— éœ€åˆ†è¯å™¨\nweightï¼šç±»å‹ä¸ºfloatï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›æ— éœ€åˆ†è¯å™¨\nisMarriedï¼šç±»å‹ä¸ºbooleanï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›æ— éœ€åˆ†è¯å™¨\ninfoï¼šç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œéœ€è¦åˆ†è¯ï¼Œå› æ­¤æ˜¯textï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›åˆ†è¯å™¨å¯ä»¥ç”¨ik_smart\nemailï¼šç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä¸éœ€è¦åˆ†è¯ï¼Œå› æ­¤æ˜¯keywordï¼›ä¸å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºfalseï¼›æ— éœ€åˆ†è¯å™¨\nscoreï¼šè™½ç„¶æ˜¯æ•°ç»„ï¼Œä½†æ˜¯æˆ‘ä»¬åªçœ‹å…ƒç´ çš„ç±»å‹ï¼Œç±»å‹ä¸ºfloatï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›æ— éœ€åˆ†è¯å™¨\nnameï¼šç±»å‹ä¸ºobjectï¼Œéœ€è¦å®šä¹‰å¤šä¸ªå­å±æ€§\nname.firstNameï¼›ç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä¸éœ€è¦åˆ†è¯ï¼Œå› æ­¤æ˜¯keywordï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›æ— éœ€åˆ†è¯å™¨\nname.lastNameï¼›ç±»å‹ä¸ºå­—ç¬¦ä¸²ï¼Œä½†æ˜¯ä¸éœ€è¦åˆ†è¯ï¼Œå› æ­¤æ˜¯keywordï¼›å‚ä¸æœç´¢ï¼Œå› æ­¤éœ€è¦indexä¸ºtrueï¼›æ— éœ€åˆ†è¯å™¨\n</code></pre></div><h2>mysqlä¸elasticsearchæ¯”è¾ƒ</h2>\n<ul>\n<li>Mysqlï¼šæ“…é•¿äº‹åŠ¡ç±»å‹æ“ä½œï¼Œå¯ä»¥ç¡®ä¿æ•°æ®çš„å®‰å…¨å’Œä¸€è‡´æ€§.å¯¹å®‰å…¨æ€§è¦æ±‚è¾ƒé«˜çš„å†™æ“ä½œï¼Œä½¿ç”¨mysqlå®ç°</li>\n<li>Elasticsearchï¼šæ“…é•¿æµ·é‡æ•°æ®çš„æœç´¢ã€åˆ†æã€è®¡ç®—.å¯¹æŸ¥è¯¢æ€§èƒ½è¦æ±‚è¾ƒé«˜çš„æœç´¢éœ€æ±‚ï¼Œä½¿ç”¨elasticsearchå®ç°</li>\n<li>ä¸¤è€…å†åŸºäºæŸç§æ–¹å¼ï¼Œå®ç°æ•°æ®çš„åŒæ­¥ï¼Œä¿è¯ä¸€è‡´æ€§</li>\n</ul>\n<h2>åˆ†è¯å™¨</h2>\n<ul>\n<li>åˆ†è¯å™¨çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿåˆ›å»ºå€’æ’ç´¢å¼•æ—¶å¯¹æ–‡æ¡£åˆ†è¯ã€ç”¨æˆ·æœç´¢æ—¶ï¼Œå¯¹è¾“å…¥çš„å†…å®¹åˆ†è¯æœç´¢</li>\n<li>IKåˆ†è¯å™¨æœ‰å‡ ç§æ¨¡å¼ï¼Ÿik_smartï¼šæ™ºèƒ½åˆ‡åˆ†ã€ç²—ç²’åº¦ï¼›ik_max_wordï¼šæœ€ç»†åˆ‡åˆ†ï¼Œç»†ç²’åº¦</li>\n<li>IKåˆ†è¯å™¨å¦‚ä½•æ‹“å±•è¯æ¡ï¼Ÿå¦‚ä½•åœç”¨è¯æ¡ï¼Ÿåˆ©ç”¨configç›®å½•çš„IkAnalyzer.cfg.xmlæ–‡ä»¶æ·»åŠ æ‹“å±•è¯å…¸å’Œåœç”¨è¯å…¸ï¼›åœ¨è¯å…¸ä¸­æ·»åŠ æ‹“å±•è¯æ¡æˆ–è€…åœç”¨è¯æ¡</li>\n<li>æ³¨æ„:åªæœ‰ç±»å‹æ˜¯textçš„æ‰èƒ½åˆ†è¯</li>\n</ul>\n<h2>dockeréƒ¨ç½²å•ç‚¹es</h2>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>docker run -d \\\n\t--name es \\\n    -e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\" \\\n    -e \"discovery.type=single-node\" \\\n    -v es-data:/usr/share/elasticsearch/data \\\n    -v es-plugins:/usr/share/elasticsearch/plugins \\\n    --privileged \\\n    -p 9200:9200 \\\n    -p 9300:9300 \\\nelasticsearch:7.12.1\n</code></pre></div><p>-e \"cluster.name=es-docker-cluster\"ï¼šè®¾ç½®é›†ç¾¤åç§°<br>\n-e \"http.host=0.0.0.0\"ï¼šç›‘å¬çš„åœ°å€ï¼Œå¯ä»¥å¤–ç½‘è®¿é—®<br>\n-e \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"ï¼šå†…å­˜å¤§å°<br>\n-e \"discovery.type=single-node\"ï¼šéé›†ç¾¤æ¨¡å¼<br>\n-v es-data:/usr/share/elasticsearch/dataï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ•°æ®ç›®å½•<br>\n-v es-logs:/usr/share/elasticsearch/logsï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ—¥å¿—ç›®å½•<br>\n-v es-plugins:/usr/share/elasticsearch/pluginsï¼šæŒ‚è½½é€»è¾‘å·ï¼Œç»‘å®šesçš„æ’ä»¶ç›®å½•<br>\n--privilegedï¼šæˆäºˆé€»è¾‘å·è®¿é—®æƒ<br>\n--network es-net ï¼šåŠ å…¥ä¸€ä¸ªåä¸ºes-netçš„ç½‘ç»œä¸­<br>\n-p 9200:9200ï¼šç«¯å£æ˜ å°„é…ç½®</p>\n<ul>\n<li>ä¸‹è½½ikåˆ†è¯å™¨å¹¶å®‰è£…\n<ul>\n<li>åœ¨çº¿å®‰è£…ï¼š./bin/elasticsearch-plugin install elasticsearch-analysis-ik-7.12.1.zip</li>\n<li>ç¦»çº¿å®‰è£…ï¼šä¸‹è½½åŒ…åï¼Œæ”¾åˆ°pluginsæ–‡ä»¶å¤¹ä¸‹</li>\n<li>ä¿®æ”¹é…ç½®æ–‡ä»¶,å¹¶æ·»åŠ /åœç”¨è‡ªå®šä¹‰åˆ†è¯å­—å…¸</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE properties SYSTEM \"http://java.sun.com/dtd/properties.dtd\"&gt;\n&lt;properties&gt;\n\t&lt;comment&gt;IK Analyzer æ‰©å±•é…ç½®&lt;/comment&gt;\n\t&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;\n\t&lt;entry key=\"ext_dict\"&gt;xxx.dic&lt;/entry&gt;\n\t &lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;\n\t&lt;entry key=\"ext_stopwords\"&gt;&lt;/entry&gt;\n\t&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•å­—å…¸ --&gt;\n\t&lt;!-- &lt;entry key=\"remote_ext_dict\"&gt;words_location&lt;/entry&gt; --&gt;\n\t&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è¿œç¨‹æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;\n\t&lt;!-- &lt;entry key=\"remote_ext_stopwords\"&gt;words_location&lt;/entry&gt; --&gt;\n&lt;/properties&gt;\n</code></pre></div><ul>\n<li>ä¸‹è½½æ‹¼éŸ³åˆ†è¯å™¨å¹¶å®‰è£…\n<ul>\n<li>åœ¨çº¿å®‰è£…: ./bin/elasticsearch-plugin install <a href=\"https://github.com/medcl/elasticsearch-analysis-pinyin\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/medcl/elasticsearch-analysis-pinyin</a></li>\n<li>ç¦»çº¿å®‰è£…ï¼šä¸‹è½½åŒ…åï¼Œæ”¾åˆ°pluginsæ–‡ä»¶å¤¹ä¸‹</li>\n</ul>\n</li>\n<li>å®‰è£…/ç§»é™¤windowsæœåŠ¡./bin/elasticsearch-plugin elasticsearch-service.bat start/remove</li>\n<li>é‡ç½®å¯†ç :./bin elasticsearch-reset-password -u elastic</li>\n</ul>\n<h1>ESåŸºæœ¬å‘½ä»¤</h1>\n<ul>\n<li>åˆ†è¯åˆ†æä¸è‡ªå®šä¹‰åˆ†è¯å™¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\nPOST /_analyze\n{\n  \"analyzer\": \"ik_max_word\",//åˆ†è¯å™¨æ¨¡å¼\n  \"text\": \"é»‘é©¬ç¨‹åºå‘˜å­¦ä¹ javaå¤ªæ£’äº†\"\n}\n# elasticsearchä¸­åˆ†è¯å™¨ï¼ˆanalyzerï¼‰çš„ç»„æˆåŒ…å«ä¸‰éƒ¨åˆ†ï¼š\n  - character filtersï¼šåœ¨tokenizerä¹‹å‰å¯¹æ–‡æœ¬è¿›è¡Œå¤„ç†ã€‚ä¾‹å¦‚åˆ é™¤å­—ç¬¦ã€æ›¿æ¢å­—ç¬¦\n  - tokenizerï¼šå°†æ–‡æœ¬æŒ‰ç…§ä¸€å®šçš„è§„åˆ™åˆ‡å‰²æˆè¯æ¡ï¼ˆtermï¼‰ã€‚ä¾‹å¦‚keywordï¼Œå°±æ˜¯ä¸åˆ†è¯ï¼›è¿˜æœ‰ik_smart\n  - tokenizer filterï¼šå°†tokenizerè¾“å‡ºçš„è¯æ¡åšè¿›ä¸€æ­¥å¤„ç†ã€‚ä¾‹å¦‚å¤§å°å†™è½¬æ¢ã€åŒä¹‰è¯å¤„ç†ã€æ‹¼éŸ³å¤„ç†ç­‰\nPUT /test\n{\n  \"settings\": {\n    \"analysis\": {\n      \"analyzer\": { // è‡ªå®šä¹‰åˆ†è¯å™¨\n        \"my_analyzer\": {  // åˆ†è¯å™¨åç§°\n          \"tokenizer\": \"ik_max_word\",\n          \"filter\": \"py\"\n        }\n      },\n      \"filter\": {   // è‡ªå®šä¹‰tokenizer filter\n        \"py\": {  // è¿‡æ»¤å™¨åç§°\n          \"type\": \"pinyin\", // è¿‡æ»¤å™¨ç±»å‹ï¼Œè¿™é‡Œæ˜¯pinyin\n\t\t  \"keep_full_pinyin\": false,\n          \"keep_joined_full_pinyin\": true,\n          \"keep_original\": true,\n          \"limit_first_letter_length\": 16,\n          \"remove_duplicated_term\": true,\n          \"none_chinese_pinyin_tokenize\": false\n        }\n      }\n    }\n  },\n  \"mappings\": {\n    \"properties\": {\n      \"name\": {\n        \"type\": \"text\",\n        \"analyzer\": \"my_analyzer\",\n        \"search_analyzer\": \"ik_smart\"\n      }\n    }\n  }\n}\n</code></pre></div><ul>\n<li>ç´¢å¼•åº“çš„CRUD</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºç´¢å¼•åº“å’Œæ˜ å°„\nPUT /ç´¢å¼•åº“åç§°\n{\n  \"mappings\": {\n    \"properties\": {\n      \"testtext\":{\n        \"type\": \"text\",\n        \"analyzer\": \"ik_smart\"\n      },\n      \"testnumber\":{\n        \"type\": \"text\",\n        \"analyzer\":\"ik_max_word\"\n      },\n      \"testobject\":{\n        \"properties\": {\n          \"testobjectproperties\": {\n            \"type\": \"keyword\"\n          }\n        }\n      }\n    }\n  }\n}\n\n# æŸ¥è¯¢ç´¢å¼•åº“ GET /ç´¢å¼•åº“å\n\n# ä¿®æ”¹ç´¢å¼•åº“ï¼ˆåªèƒ½å¢åŠ æ–°çš„å­—æ®µåˆ°mappingä¸­ï¼‰/ç´¢å¼•åº“å/_mapping\n# å€’æ’ç´¢å¼•ç»“æ„ä¸€æ—¦æ•°æ®ç»“æ„æ”¹å˜ï¼ˆæ¯”å¦‚åˆ†è¯å™¨ï¼‰ï¼Œå°±éœ€è¦é‡æ–°åˆ›å»ºå€’æ’ç´¢å¼•ï¼Œå› æ­¤ç´¢å¼•åº“åˆ›å»ºåæ— æ³•ä¿®æ”¹mappingä¸­å·²æœ‰çš„å­—æ®µã€‚ä½†å¯ä»¥æ·»åŠ æ–°çš„å­—æ®µåˆ°mappingä¸­ï¼Œå› ä¸ºä¸ä¼šå¯¹å€’æ’ç´¢å¼•äº§ç”Ÿå½±å“ã€‚\n{\n  \"properties\": {\n    \"testtext2\":{\n      \"type\": \"text\",\n      \"analyzer\": \"ik_max_word\"\n    }\n  }\n}\n\n\n# åˆ é™¤ç´¢å¼•åº“ï¼šDELETE /ç´¢å¼•åº“å\n</code></pre></div><ul>\n<li>æ–‡æ¡£æ“ä½œ</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># åˆ›å»ºæ–‡æ¡£ï¼šPOST /{ç´¢å¼•åº“å}/_doc/æ–‡æ¡£idï¼ˆæ²¡æœ‰åˆ™ä¼šç«‹å³åˆ›å»ºï¼‰\nPOST /ç´¢å¼•åº“å/_doc/æ–‡æ¡£id\n{\n    \"å­—æ®µ1\": \"å€¼1\",\n    \"å­—æ®µ2\": \"å€¼2\",\n    \"å­—æ®µ3\": {\n        \"å­å±æ€§1\": \"å€¼3\",\n        \"å­å±æ€§2\": \"å€¼4\"\n    },\n    // ...\n}\n\n# æŸ¥è¯¢æ–‡æ¡£ï¼šGET /{ç´¢å¼•åº“å}/_doc/æ–‡æ¡£id\n# æ‰¹é‡æŸ¥è¯¢ï¼šæŸ¥è¯¢è¯¥ç´¢å¼•åº“ä¸‹çš„å…¨éƒ¨æ–‡æ¡£ GET /{ç´¢å¼•åº“åç§°}/_search\n\n# åˆ é™¤æ–‡æ¡£ï¼šDELETE /{ç´¢å¼•åº“å}/_doc/æ–‡æ¡£id\n\n\n# å…¨é‡ä¿®æ”¹æ–‡æ¡£ï¼šPUT /{ç´¢å¼•åº“å}/_doc/æ–‡æ¡£id\n# æœ¬è´¨ï¼šæ ¹æ®æŒ‡å®šçš„idåˆ é™¤æ–‡æ¡£ï¼Œä¸ç®¡idå­˜ä¸å­˜åœ¨éƒ½æ–°å¢ä¸€ä¸ªç›¸åŒidçš„æ–‡æ¡£\n{\n  \"testtext\":\"æ–‘çŒªæ´»åŠ¨å®åœ¨å¤ªæ£’äº†2\",\n  \"testnumber\":321,\n  \"testobject\":{\n      \"testobjectproperties\": \"æ–‘çŒªç§€ç§€ä¹Ÿä¸é”™2\"\n  }\n}\n\n\n# å¢é‡ä¿®æ”¹æ–‡æ¡£ ï¼šPOST /{ç´¢å¼•åº“å}/_update/æ–‡æ¡£id { \"doc\": {å­—æ®µ}}\n{\n  \"doc\":{\n    \"testtext\":\"æ–‘çŒªæ´»åŠ¨å®åœ¨å¤ªæ£’äº†3\",\n    \"testnumber\":321,\n    \"testobject\":{\n        \"testobjectproperties\": \"æ–‘çŒªç§€ç§€ä¹Ÿä¸é”™3\"\n    }\n  }\n}\n</code></pre></div><ul>\n<li>æŸ¥è¯¢</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># Elasticsearchæä¾›äº†åŸºäºJSONçš„DSLï¼ˆDomain Specific Languageï¼‰æ¥å®šä¹‰æŸ¥è¯¢ã€‚å¸¸è§çš„æŸ¥è¯¢ç±»å‹åŒ…æ‹¬ï¼š\n  - æŸ¥è¯¢æ‰€æœ‰ï¼šæŸ¥è¯¢å‡ºæ‰€æœ‰æ•°æ®ï¼Œä¸€èˆ¬æµ‹è¯•ç”¨ã€‚ä¾‹å¦‚ï¼šmatch_all\n  - å…¨æ–‡æ£€ç´¢ï¼ˆfull textï¼‰æŸ¥è¯¢ï¼šåˆ©ç”¨åˆ†è¯å™¨å¯¹ç”¨æˆ·è¾“å…¥å†…å®¹åˆ†è¯ï¼Œç„¶åå»å€’æ’ç´¢å¼•åº“ä¸­åŒ¹é…\n    - match:æ ¹æ®ä¸€ä¸ªå­—æ®µæŸ¥è¯¢ã€æ¨èï¼šä½¿ç”¨copy_toæ„é€ allå­—æ®µã€‘\n    - multi_match:æ ¹æ®å¤šä¸ªå­—æ®µæŸ¥è¯¢ï¼Œå‚ä¸æŸ¥è¯¢å­—æ®µè¶Šå¤šï¼ŒæŸ¥è¯¢æ€§èƒ½è¶Šå·®ã€‚å»ºè®®é‡‡ç”¨copy_toï¼Œç„¶åå•å­—æ®µæŸ¥è¯¢çš„æ–¹å¼\n  - ç²¾ç¡®æŸ¥è¯¢ï¼š\n    - term:æ ¹æ®ç²¾ç¡®è¯æ¡å€¼æŸ¥æ‰¾æ•°æ®ï¼Œä¸€èˆ¬æ˜¯æŸ¥æ‰¾keywordã€æ•°å€¼ã€æ—¥æœŸã€booleanç­‰ç±»å‹å­—æ®µã€‚ä¾‹å¦‚ï¼šidsã€rangeã€term\n    - rangeï¼šæ ¹æ®æ•°å€¼èŒƒå›´æŸ¥è¯¢ï¼Œå¯ä»¥æ˜¯æ•°å€¼ã€æ—¥æœŸçš„èŒƒå›´\n  - åœ°ç†ï¼ˆgeoï¼‰æŸ¥è¯¢ï¼šæ ¹æ®ç»çº¬åº¦æŸ¥è¯¢ã€‚é™„è¿‘çš„åœ°ç‚¹ã€‚çŸ©å½¢æ°›å›´æœç´¢ï¼ŒåŸå‹èŒƒå›´æœç´¢ ã€‚ä¾‹å¦‚ï¼šgeo_distanceã€geo_bounding_box\n  - å¤åˆï¼ˆcompoundï¼‰æŸ¥è¯¢ï¼šå¤åˆæŸ¥è¯¢å¯ä»¥å°†ä¸Šè¿°å„ç§æŸ¥è¯¢æ¡ä»¶ç»„åˆèµ·æ¥ï¼Œåˆå¹¶æŸ¥è¯¢æ¡ä»¶ã€‚ä¾‹å¦‚ï¼šboolã€function_score\n  - suggestæŸ¥è¯¢: ç”¨äºå®ç°æœç´¢æ¡†è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½\n# æŸ¥è¯¢è¯­æ³• \nGET /{ç´¢å¼•åº“å}/_search\n{\n  \"query\": {\n    \"æŸ¥è¯¢ç±»å‹\": {\n      \"æŸ¥è¯¢æ¡ä»¶(å±æ€§å)\": \"æ¡ä»¶å€¼\"\n    }\n  }\n}\n# match\n{\n  \"query\": {\n    \"match\": {\n      \"testtext\": \"æ–‘çŒª\"\n    }\n  }\n}\n# mulit_match\n{\n  \"query\": {\n    \"mulit_match\": {\n      \"query\": \"æ–‘çŒª\",\n      \"fields\": [\"testtext\", \" testtext2\"]\n    }\n  }\n}\n# term\n{\n  \"query\": {\n    \"term\": {\n      \"testtext\": \"æ–‘çŒª\"\n    }\n  }\n}\n# range:\n{\n  \"query\": {\n    \"range\": {\n      \"testnumber\": {\n        \"gte\":100,\n        \"lte\":200\n      }\n    }\n  }\n}\n# çŸ©å½¢èŒƒå›´æŸ¥è¯¢\n// geo_bounding_boxæŸ¥è¯¢\nGET /indexName/_search\n{\n  \"query\": {\n    \"geo_bounding_box\": {\n      \"testgeo_point\": {\n        \"top_left\": { // å·¦ä¸Šç‚¹\n          \"lat\": 31.1,\n          \"lon\": 121.5\n        },\n        \"bottom_right\": { // å³ä¸‹ç‚¹\n          \"lat\": 30.9,\n          \"lon\": 121.7\n        }\n      }\n    }\n  }\n}\n# é™„è¿‘(åœ†å½¢)æŸ¥è¯¢\n{\n  \"query\": {\n    \"geo_distance\": {\n      \"distance\": \"15km\", // åŠå¾„\n      \"testgeo_point\": \"31.21,121.5\" // åœ†å¿ƒ\n    }\n  }\n}\n# å¤åˆæŸ¥è¯¢\n# fuction scoreï¼šç®—åˆ†å‡½æ•°æŸ¥è¯¢ï¼Œå¯ä»¥æ§åˆ¶æ–‡æ¡£ç›¸å…³æ€§ç®—åˆ†ï¼Œæ§åˆ¶æ–‡æ¡£æ’å(å¹¿å‘Šä¼˜å…ˆ)ã€‚ä¸‰è¦ç´ ï¼šè¿‡æ»¤æ¡ä»¶(å“ªäº›æ–‡æ¡£è¦åŠ åˆ†)ã€ç®—åˆ†å‡½æ•°(å¦‚ä½•è®¡ç®—function score)ã€åŠ æƒæ–¹å¼(function score ä¸ query scoreå¦‚ä½•è¿ç®—)\n# bool queryï¼šå¸ƒå°”æŸ¥è¯¢ï¼Œåˆ©ç”¨é€»è¾‘å…³ç³»ç»„åˆå¤šä¸ªå…¶å®ƒçš„æŸ¥è¯¢ï¼Œå®ç°å¤æ‚æœç´¢\n# elasticsearchä¼šæ ¹æ®è¯æ¡å’Œæ–‡æ¡£çš„ç›¸å…³åº¦åšæ‰“åˆ†ï¼ŒåŒ…æ‹¬TF-IDFç®—æ³•ã€BM25ç®—æ³•ã€‚TF-IDFç®—æ³•ç¼ºç‚¹æ˜¯è¯æ¡é¢‘ç‡è¶Šé«˜ï¼Œæ–‡æ¡£å¾—åˆ†ä¹Ÿä¼šè¶Šé«˜ï¼Œå•ä¸ªè¯æ¡å¯¹æ–‡æ¡£å½±å“è¾ƒå¤§ã€‚è€ŒBM25åˆ™ä¼šè®©å•ä¸ªè¯æ¡çš„ç®—åˆ†æœ‰ä¸€ä¸ªä¸Šé™ï¼Œæ›²çº¿æ›´åŠ å¹³æ»‘\n# matchæŸ¥è¯¢ç»“æœä¼šæ ¹æ®æ–‡æ¡£ä¸æœç´¢è¯æ¡çš„å…³è”åº¦æ‰“åˆ†ï¼ˆ_scoreï¼‰ï¼Œè¿”å›ç»“æœæ—¶æŒ‰ç…§åˆ†å€¼é™åºæ’åˆ—\n{\n  \"query\": {\n    \"function_score\": {\n      //æœç´¢æ—¶ï¼Œå‚ä¸æ‰“åˆ†çš„å­—æ®µè¶Šå¤šï¼ŒæŸ¥è¯¢çš„æ€§èƒ½ä¹Ÿè¶Šå·®ã€‚å»ºè®®æœç´¢æ¡†çš„å…³é”®å­—æœç´¢ï¼Œæ˜¯å…¨æ–‡æ£€ç´¢æŸ¥è¯¢ï¼Œä½¿ç”¨mustæŸ¥è¯¢ï¼Œå‚ä¸ç®—åˆ†ï¼›å…¶å®ƒè¿‡æ»¤æ¡ä»¶é‡‡ç”¨filteræŸ¥è¯¢ã€‚ä¸å‚ä¸ç®—åˆ†           \n      \"query\": { // åŸå§‹æŸ¥è¯¢ç®—åˆ†ï¼Œæœç´¢æ–‡æ¡£å¹¶æ ¹æ®ç›¸å…³æ€§åŸºäºBM25ç®—æ³•æ‰“åˆ†\n          \"bool\": {\n              \"must\": [ //å¿…é¡»åŒ¹é…æ¯ä¸ªå­æŸ¥è¯¢ï¼Œç±»ä¼¼â€œä¸â€\n                  {\"term\": {\"city\": \"ä¸Šæµ·\" }}\n              ],\n              \"should\": [ //é€‰æ‹©æ€§åŒ¹é…å­æŸ¥è¯¢ï¼Œç±»ä¼¼â€œæˆ–â€\n                  {\"term\": {\"brand\": \"çš‡å† å‡æ—¥\" }},\n                  {\"term\": {\"brand\": \"åç¾è¾¾\" }}\n              ],\n              \"must_not\": [ //å¿…é¡»ä¸åŒ¹é…ï¼Œä¸å‚ä¸ç®—åˆ†ï¼Œç±»ä¼¼â€œéâ€\n                  { \"range\": { \"price\": { \"lte\": 500 } }}\n              ],\n              \"filter\": [ //å¿…é¡»åŒ¹é…ï¼Œä¸å‚ä¸ç®—åˆ†\n                  { \"range\": {\"score\": { \"gte\": 45 } }}\n              ]\n          }\n      },\n      \"functions\": [ // ç®—åˆ†å‡½æ•°ç®—åˆ†\n        {\n          \"filter\": { // ç¬¦åˆæ¡ä»¶çš„æ‰ä¼šé‡æ–°ç®—åˆ†\n            \"term\": {\n              \"brand\": \"å¦‚å®¶\"\n            }\n          },\n          \"weight\": 2 // ç®—åˆ†æƒé‡ä¸º2ï¼Œå‡½æ•°ç»“æœæ˜¯å¸¸é‡\n          \"field_value_factor\": ä»¥æ–‡æ¡£ä¸­çš„æŸä¸ªå­—æ®µå€¼ä½œä¸ºå‡½æ•°ç»“æœ\n          \"random_score\":ä»¥éšæœºæ•°ä½œä¸ºå‡½æ•°ç»“æœ\n          \"script_score\":è‡ªå®šä¹‰ç®—åˆ†å‡½æ•°ç®—æ³•\n        }\n      ],\n      \"boost_mode\": \"sum\"//ç®—åˆ†å‡½æ•°å’ŒåŸå§‹æŸ¥è¯¢çš„ç®—åˆ†ï¼Œä¸¤è€…ç»“æœçš„è¿ç®—æ–¹å¼ï¼ŒåŒ…æ‹¬sumã€avgã€maxã€minã€multiply(ç›¸ä¹˜)ã€replace(function scoreæ›¿æ¢query score)\n    }\n  }  \n}\n\n# Completion SuggesteræŸ¥è¯¢å®ç°è‡ªåŠ¨è¡¥å…¨åŠŸèƒ½ã€‚å‚ä¸è¡¥å…¨æŸ¥è¯¢çš„å­—æ®µå¿…é¡»æ˜¯completionç±»å‹ã€‚\n// åˆ›å»ºç´¢å¼•åº“\nPUT test\n{\n  \"mappings\": {\n    \"properties\": {\n      \"title\":{\n        \"type\": \"completion\"\n      }\n    }\n  }\n}\n//ç„¶åæ’å…¥ä¸‹é¢çš„æ•°æ®ï¼š\nPOST test/_doc\n{\n  \"title\": [\"Sony\", \"WH-1000XM3\"]\n}\nPOST test/_doc\n{\n  \"title\": [\"SK-II\", \"PITERA\"]\n}\nPOST test/_doc\n{\n  \"title\": [\"Nintendo\", \"switch\"]\n}\n// è‡ªåŠ¨è¡¥å…¨æŸ¥è¯¢\nGET /test/_search\n{\n  \"suggest\": {\n    \"title_suggest\": {\t//è®¾ç½®è¿™ä¸ªè‡ªåŠ¨æŸ¥è¯¢æ“ä½œçš„åç§°\n      \"text\": \"s\", // å…³é”®å­—\n      \"completion\": {\n        \"field\": \"title\", // è¡¥å…¨æŸ¥è¯¢çš„å­—æ®µå\n        \"skip_duplicates\": true, // è·³è¿‡é‡å¤çš„\n        \"size\": 10 // è·å–å‰10æ¡ç»“æœ\n      }\n    }\n  }\n}\n</code></pre></div><ul>\n<li>æœç´¢ç»“æœåˆ†ç±»</li>\n<li>æŸ¥è¯¢çš„DSLæ˜¯ä¸€ä¸ªå¤§çš„JSONå¯¹è±¡ï¼ŒåŒ…å«ä¸‹åˆ—å±æ€§ï¼š\n<ul>\n<li>queryï¼šæŸ¥è¯¢æ¡ä»¶</li>\n<li>fromå’Œsizeï¼šåˆ†é¡µæ¡ä»¶ elasticsearchä¼šç¦æ­¢from+ size è¶…è¿‡10000çš„è¯·æ±‚.é»˜è®¤æƒ…å†µä¸‹åªè¿”å›top10çš„æ•°æ®</li>\n<li>sortï¼šæ’åºæ¡ä»¶ åœ¨ä½¿ç”¨æ’åºåå°±ä¸ä¼šè¿›è¡Œç®—åˆ†äº†ï¼Œæ ¹æ®æ’åºè®¾ç½®çš„è§„åˆ™æ’åˆ—\\æ™®é€šå­—æ®µæ˜¯æ ¹æ®å­—å…¸åºæ’åº\\åœ°ç†åæ ‡æ˜¯æ ¹æ®è·ç¦»è¿œè¿‘æ’åº</li>\n<li>highlightï¼šé«˜äº®æ¡ä»¶ é«˜äº®æ˜¯å¯¹å…³é”®å­—é«˜äº®ï¼Œå› æ­¤æœç´¢æ¡ä»¶å¿…é¡»å¸¦æœ‰å…³é”®å­—ï¼Œè€Œä¸èƒ½æ˜¯èŒƒå›´è¿™æ ·çš„æŸ¥è¯¢ã€‚éæœç´¢å­—æ®µé«˜äº®ï¼Œåˆ™éœ€è¦æ·»åŠ ä¸€ä¸ªå±æ€§ï¼šrequired_field_match=false</li>\n<li>aggsï¼šå®šä¹‰èšåˆ\n<ul>\n<li>æ¡¶ï¼ˆBucketï¼‰èšåˆï¼šç”¨æ¥å¯¹æ–‡æ¡£åšåˆ†ç»„\n<ul>\n<li>termï¼šæŒ‰ç…§æ–‡æ¡£å­—æ®µå€¼åˆ†ç»„ï¼Œä¾‹å¦‚æŒ‰ç…§å“ç‰Œå€¼åˆ†ç»„ã€æŒ‰ç…§å›½å®¶åˆ†ç»„</li>\n<li>Date Histogramï¼šæŒ‰ç…§æ—¥æœŸé˜¶æ¢¯åˆ†ç»„ï¼Œä¾‹å¦‚ä¸€å‘¨ä¸ºä¸€ç»„ï¼Œæˆ–è€…ä¸€æœˆä¸ºä¸€ç»„</li>\n</ul>\n</li>\n<li>åº¦é‡ï¼ˆMetricï¼‰èšåˆï¼šç”¨ä»¥è®¡ç®—ä¸€äº›å€¼ï¼Œæ¯”å¦‚ï¼šæœ€å¤§å€¼Maxã€æœ€å°å€¼Minã€å¹³å‡å€¼Avg,Statsï¼šåŒæ—¶æ±‚maxã€minã€avgã€sumç­‰ç­‰</li>\n<li>ç®¡é“ï¼ˆpipelineï¼‰èšåˆï¼šå…¶å®ƒèšåˆçš„ç»“æœä¸ºåŸºç¡€åšèšåˆ.å¦‚ï¼šç”¨æ¡¶èšåˆå®ç°ç§ç±»æ’åºï¼Œç„¶åä½¿ç”¨åº¦é‡èšåˆå®ç°å„ä¸ªæ¡¶çš„æœ€å¤§å€¼ã€æœ€å°å€¼ã€å¹³å‡å€¼ç­‰</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>{\n  \"query\": { //æŸ¥è¯¢æ¡ä»¶\n    \"match\": {\n      \"name\":\"å¦‚å®¶\"\n    }\n  },\n  \"from\":0ï¼Œ// åˆ†é¡µå¼€å§‹çš„ä½ç½® åˆ†é¡µæ¡ä»¶\n  \"size\": 20ï¼Œ// æœŸæœ›è·å–çš„æ–‡æ¡£æ€»æ•°\n  \"sort\": [ //å½“ç¬¬ä¸€ä¸ªæ¡ä»¶ç›¸ç­‰æ—¶ï¼Œå†æŒ‰ç…§ç¬¬äºŒä¸ªæ¡ä»¶æ’åºï¼Œä»¥æ­¤ç±»æ¨\n    { \"price\":\"asc\"}ï¼Œ// æ™®é€šæ’åº\n    \"_geo_distance\" : { // è·ç¦»æ’åº\n      \"location\" : \"31.040699,121.618075\"ï¼Œ\n      \"order\" : \"asc\",\n      \"unit\" : \"km\"\n    }\n  ]\n  \"highlight\":{\n    \"fields\":{ // é«˜äº®å­—æ®µ\n      \"name\": {\n        \"pre_tags\": \"&lt;em&gt;\",ç”¨æ¥æ ‡è®°é«˜äº®å­—æ®µçš„å‰ç½®æ ‡ç­¾\n        \"post_tags\": \"&lt;/em&gt;\"ç”¨æ¥æ ‡è®°é«˜äº®å­—æ®µçš„åç½®æ ‡ç­¾\n      }\n    }\n  }\n  \"aggs\":{ //å®šä¹‰èšåˆ å‚åŠ èšåˆçš„å­—æ®µå¿…é¡»æ˜¯keywordã€æ—¥æœŸã€æ•°å€¼ã€å¸ƒå°”ç±»å‹\n    \"brandAgg\":{ //èšåˆåå­—\n      \"terms\":{ // èšåˆçš„ç±»å‹ï¼ŒæŒ‰ç…§å“ç‰Œå€¼èšåˆï¼Œæ‰€ä»¥é€‰æ‹©term\n        \"field\":\"brand\"ï¼Œ// å‚ä¸èšåˆçš„å­—æ®µ\n        \"order\":{\n          \"doc_count\": \"asc\" //.å¯¹èšåˆç»“æœæŒ‰ç…§doc_countå‡åºæ’åˆ—\n        }\n        \"size\":20 // èšåˆç»“æœæ•°é‡ã€è®¾ç½®å¤šå°‘å°±æœ€å¤šåªæ˜¾ç¤ºå¤šå°‘ã€‘\n      }\n    }\n  }\n}\n\n</code></pre></div><h1>RestAPI</h1>\n<ul>\n<li>ESå®˜æ–¹æä¾›äº†å„ç§ä¸åŒè¯­è¨€çš„å®¢æˆ·ç«¯æ“ä½œESã€‚æœ¬è´¨å°±æ˜¯ç»„è£…DSLè¯­å¥ï¼Œé€šè¿‡httpè¯·æ±‚å‘é€ç»™ESã€‚å®˜æ–¹æ–‡æ¡£åœ°å€ï¼š<a href=\"https://www.elastic.co/guide/en/elasticsearch/client/index.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.elastic.co/guide/en/elasticsearch/client/index.html</a></li>\n<li>Java HighLevel Rest Clientå®¢æˆ·ç«¯ã€‚APIæ“ä½œelasticsearchçš„æµç¨‹åŸºæœ¬ç±»ä¼¼ã€‚æ ¸å¿ƒæ˜¯client.indices()æ–¹æ³•æ¥è·å–ç´¢å¼•åº“çš„æ“ä½œå¯¹è±¡ã€‚</li>\n<li>APIç´¢å¼•åº“æ“ä½œçš„åŸºæœ¬æ­¥éª¤ï¼š\n<ul>\n<li>åˆå§‹åŒ–RestHighLevelClient</li>\n<li>åˆ›å»ºXxxIndexRequestã€‚XXXæ˜¯Createã€Getã€Delete</li>\n<li>å‡†å¤‡DSLï¼ˆ Createæ—¶éœ€è¦ï¼Œå…¶å®ƒæ˜¯æ— å‚ï¼‰</li>\n<li>å‘é€è¯·æ±‚ã€‚è°ƒç”¨RestHighLevelClient#indices().xxx()æ–¹æ³•ï¼Œxxxæ˜¯createã€existsã€delete</li>\n</ul>\n</li>\n<li>mappingæ˜ å°„åˆ†æ\n<ul>\n<li>æ ¹æ®MySQLæ•°æ®åº“è¡¨ç»“æ„ï¼ˆå»ºè¡¨è¯­å¥ï¼‰ï¼Œå»å†™ç´¢å¼•åº“ç»“æ„JSONã€‚è¡¨å’Œç´¢å¼•åº“ä¸€ä¸€å¯¹åº”</li>\n<li>æ³¨æ„ï¼šåœ°ç†åæ ‡ã€ç»„åˆå­—æ®µã€‚ç´¢å¼•åº“é‡Œçš„åœ°ç†åæ ‡æ˜¯ä¸€ä¸ªå­—æ®µï¼šåæ ‡ï¼šç»´åº¦,ç²¾åº¦ ã€‚copy_toç»„åˆå­—æ®µä½œç”¨æ˜¯ä¾›ç”¨æˆ·æŸ¥è¯¢ï¼ˆè¾“å…¥å…³é”®å­—å¯ä»¥æŸ¥è¯¢å¤šä¸ªå­—æ®µï¼‰</li>\n<li>mappingæ˜ å°„è¦è€ƒè™‘çš„ä¿¡æ¯åŒ…æ‹¬ï¼šå­—æ®µåã€å­—æ®µæ•°æ®ç±»å‹ã€æ˜¯å¦å‚ä¸æœç´¢ã€æ˜¯å¦éœ€è¦åˆ†è¯ã€åˆ†è¯çš„åˆ†è¯å™¨(ik_max_word)</li>\n</ul>\n</li>\n</ul>\n<h1>springbootæ•´åˆeså®¢æˆ·ç«¯</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependency&gt;\n    &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n    &lt;artifactId&gt;spring-boot-starter-data-elasticsearch&lt;/artifactId&gt;\n&lt;/dependency&gt;\n\nspring:\n  elasticsearch:\n    rest:\n      password: elasticBanzhu\n      username: elastic\n      connection-timeout: 1s\n      uris: 127.0.0.1:9200\n      read-timeout: 30s\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Document(indexName = \"action\", // ç´¢å¼•å\n  shards = 1, // é»˜è®¤ç´¢å¼•åˆ†åŒºæ•°\n  replicas = 0, // æ¯ä¸ªåˆ†åŒºçš„å¤‡ä»½æ•°\n  refreshInterval = \"-1\" // åˆ·æ–°é—´éš”\n)\n@Data\npublic class ActionDO {\n    CustomConversions customConversions;\n    @Id\n    private Integer id;\n\n    @Field(analyzer = \"ik_max_word\", type = FieldType.Text)\n    private String title;\n\n    @Field(analyzer = \"ik_smart\", type = FieldType.Text)\n    private String title2;\n}\n\npublic interface ActionRepository extends ElasticsearchRepository&lt;ActionDO, Integer&gt; {}\n\n@Service\npublic class ActionESServiceImpl implements ActionESService {\n\n    @Autowired\n    private ElasticsearchRestTemplate elasticsearchRestTemplate;\n    @Resource\n    private ActionRepository actionRepository;\n\n    @Override\n    public void saveAction(){\n        ActionDO actionDO = new ActionDO();\n        actionDO.setId(1);\n        actionDO.setTitle(\"æˆ‘æ˜¯æµ‹è¯•æ´»åŠ¨\");\n        elasticsearchRestTemplate.save(actionDO);\n    }\n\n    @Override\n    public void updateAction(){\n        ActionDO actionDO = new ActionDO();\n        actionDO.setId(1);\n        actionDO.setTitle(\"æˆ‘æ˜¯æµ‹è¯•æ›´æ–°æ´»åŠ¨\");\n        actionRepository.save(actionDO);\n    }\n\n    @Override\n    public void deleteActionById(){\n        actionRepository.deleteById(1);\n    }\n\n    @Override\n    public void selectById(){\n        Iterable&lt;ActionDO&gt; actionDOS = actionRepository.findAllById(Arrays.asList(1, 4));\n        actionDOS.forEach(System.out::println);\n    }\n}\n</code></pre></div><h1>ESä¸MySQLæ•°æ®åŒæ­¥</h1>\n<ul>\n<li>åŒæ­¥è°ƒç”¨:å®ç°ç®€å•ï¼Œç²—æš´ã€ä¸šåŠ¡è€¦åˆåº¦é«˜</li>\n<li>å¼‚æ­¥é€šçŸ¥ã€å¸¸ç”¨ã€‘ï¼šä½è€¦åˆï¼Œå®ç°éš¾åº¦ä¸€èˆ¬ã€ä¾èµ–mqçš„å¯é æ€§</li>\n<li>ç›‘å¬binlogï¼šè§£è€¦åˆï¼Œå¼€å¯binlogå¢åŠ æ•°æ®åº“è´Ÿæ‹…ã€å®ç°å¤æ‚åº¦é«˜ã€‚åŸºäºcanalç›‘å¬binlogå˜åŒ–ï¼Œå®æ—¶æ›´æ–°elasticsearchä¸­çš„å†…å®¹</li>\n</ul>\n<h1>ESé›†ç¾¤æ­å»º</h1>\n<ul>\n<li>åˆ›å»ºESé›†ç¾¤ï¼šè‡³å°‘æœ‰4Gçš„å†…å­˜ç©ºé—´\n<ul>\n<li>åˆ›å»ºdocker-composeæ–‡ä»¶</li>\n<li>esè¿è¡Œéœ€è¦ä¿®æ”¹ä¸€äº›linuxç³»ç»Ÿæƒé™ï¼Œä¿®æ”¹/etc/sysctl.confæ–‡ä»¶å¹¶æ·»åŠ vm.max_map_count=262144ï¼Œæ‰§è¡Œsysctl -pç”Ÿæ•ˆ</li>\n<li>docker-compose up -då¯åŠ¨é›†ç¾¤</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>version: '2.2'\nservices:\n  es01:\n    image: docker.elastic.co/elasticsearch/elasticsearch:7.12.1\n    container_name: es01\n    environment:\n      - node.name=es01\n      - cluster.name=es-docker-cluster\n      - discovery.seed_hosts=es02,es03\n      - cluster.initial_master_nodes=es01,es02,es03\n      - bootstrap.memory_lock=true\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - data01:/usr/share/elasticsearch/data\n    ports:\n      - 9200:9200\n    networks:\n      - elastic\n  es02:\n    image: docker.elastic.co/elasticsearch/elasticsearch:7.12.1\n    container_name: es02\n    environment:\n      - node.name=es02\n      - cluster.name=es-docker-cluster\n      - discovery.seed_hosts=es01,es03\n      - cluster.initial_master_nodes=es01,es02,es03\n      - bootstrap.memory_lock=true\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - data02:/usr/share/elasticsearch/data\n    networks:\n      - elastic\n  es03:\n    image: docker.elastic.co/elasticsearch/elasticsearch:7.12.1\n    container_name: es03\n    environment:\n      - node.name=es03\n      - cluster.name=es-docker-cluster\n      - discovery.seed_hosts=es01,es02\n      - cluster.initial_master_nodes=es01,es02,es03\n      - bootstrap.memory_lock=true\n      - \"ES_JAVA_OPTS=-Xms512m -Xmx512m\"\n    ulimits:\n      memlock:\n        soft: -1\n        hard: -1\n    volumes:\n      - data03:/usr/share/elasticsearch/data\n    networks:\n      - elastic\n\nvolumes:\n  data01:\n    driver: local\n  data02:\n    driver: local\n  data03:\n    driver: local\n\nnetworks:\n  elastic:\n    driver: bridge\n</code></pre></div><h1>é›†ç¾¤çŠ¶æ€ç›‘æ§</h1>\n<ul>\n<li>kibanaæˆ–è€…cerebroæ¥ç›‘æ§esé›†ç¾¤çŠ¶æ€ï¼Œå®˜æ–¹ç½‘å€ï¼š<a href=\"https://github.com/lmenezes/cerebro\" target=\"_blank\" rel=\"noopener noreferrer\">https://github.com/lmenezes/cerebro</a></li>\n</ul>\n<h1>é›†ç¾¤å…¶ä»–é—®é¢˜</h1>\n<ul>\n<li>master eligibleèŠ‚ç‚¹çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿå‚ä¸é›†ç¾¤é€‰ä¸»ï¼ˆä¸»èŠ‚ç‚¹å¯ä»¥ç®¡ç†é›†ç¾¤çŠ¶æ€ã€ç®¡ç†åˆ†ç‰‡ä¿¡æ¯ã€å¤„ç†åˆ›å»ºå’Œåˆ é™¤ç´¢å¼•åº“çš„è¯·æ±‚ï¼‰</li>\n<li>dataèŠ‚ç‚¹çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿæ•°æ®çš„CRUD</li>\n<li>coordinatorèŠ‚ç‚¹çš„ä½œç”¨æ˜¯ä»€ä¹ˆï¼Ÿè·¯ç”±è¯·æ±‚åˆ°å…¶å®ƒèŠ‚ç‚¹ã€‚åˆå¹¶æŸ¥è¯¢åˆ°çš„ç»“æœï¼Œè¿”å›ç»™ç”¨æˆ·</li>\n</ul>\n<h1>é›†ç¾¤èŒè´£åˆ’åˆ†</h1>\n<ul>\n<li>é€šè¿‡æ”¹å˜é…ç½®æ–‡ä»¶ä¸­çš„ trueâ€”â€”&gt; false æ¥æ”¹å˜èŒè´£ã€‚å¦‚dataæ•°æ®èŒè´£èŠ‚ç‚¹å°±åªä¿ç•™dataä¸ºtrueå…¶ä»–ä¸ºfalse</li>\n<li>æ³¨æ„ï¼šæ¯ä¸ªèŠ‚ç‚¹éƒ½æ˜¯è·¯ç”±ï¼Œè¿™æ ·å¯ä»¥ä¿è¯ä¸ç®¡å“ªä¸ªèŠ‚ç‚¹æ¥æ”¶åˆ°è¯·æ±‚å¯ä»¥åˆ†ç»™å…¶ä»–äººå·²ç»ä»å…¶ä»–äººé‚£æ¥æ”¶ä¿¡æ¯ã€‚</li>\n<li>é»˜è®¤æƒ…å†µä¸‹ï¼Œé›†ç¾¤ä¸­çš„ä»»ä½•ä¸€ä¸ªèŠ‚ç‚¹éƒ½åŒæ—¶å…·å¤‡ä¸‹è¿°å››ç§è§’è‰²ã€‚<br>\n|èŠ‚ç‚¹ç±»å‹|é…ç½®å‚æ•°|é»˜è®¤å€¼|èŠ‚ç‚¹èŒè´£|è¦æ±‚|<br>\n|:-ğŸ˜:-ğŸ˜:-ğŸ˜:-ğŸ˜:-ğŸ˜<br>\n|master eligible|node.master|true|å¤‡é€‰ä¸»èŠ‚ç‚¹:ä¸»èŠ‚ç‚¹å¯ä»¥ç®¡ç†å’Œè®°å½•é›†ç¾¤çŠ¶æ€ã€å†³å®šã€‚åˆ†ç‰‡åœ¨å“ªä¸ªèŠ‚ç‚¹ã€å¤„ç†åˆ›å»ºå’Œåˆ é™¤ç´¢å¼•åº“çš„è¯·æ±‚|å¯¹CPUè¦æ±‚é«˜ï¼Œä½†æ˜¯å†…å­˜è¦æ±‚ä½|<br>\n|data|node.data|true|æ•°æ®èŠ‚ç‚¹:å­˜å‚¨æ•°æ®ã€æœç´¢ã€èšåˆã€CRUD|å¯¹CPUå’Œå†…å­˜è¦æ±‚éƒ½é«˜|<br>\n|ingest|node.ingest|true|æ•°æ®å­˜å‚¨ä¹‹å‰çš„é¢„å¤„ç†|<br>\n|coordinating|ä¸Šé¢3ä¸ªå‚æ•°éƒ½ä¸ºfalseåˆ™ä¸ºcoordinatingèŠ‚ç‚¹|æ— |è·¯ç”±è¯·æ±‚åˆ°å…¶å®ƒèŠ‚ç‚¹ã€‚åˆå¹¶å…¶å®ƒèŠ‚ç‚¹å¤„ç†çš„ç»“æœï¼Œè¿”å›ç»™ç”¨æˆ·|å¯¹ç½‘ç»œå¸¦å®½ã€CPUè¦æ±‚é«˜|<br>\nimage</li>\n</ul>\n<h1>è„‘è£‚é—®é¢˜</h1>\n<ul>\n<li>ES 7.0åé»˜è®¤é…ç½®äº†(eligibleèŠ‚ç‚¹æ•°é‡+1)/2æ¥è§£å†³è„‘è£‚é—®é¢˜</li>\n<li>è„‘è£‚æ˜¯å› ä¸ºé›†ç¾¤ä¸­çš„èŠ‚ç‚¹å¤±è”å¯¼è‡´çš„ã€‚å‡è®¾é›†ç¾¤ä¸­æœ‰ä¸‰ä¸ªèŠ‚ç‚¹ï¼Œä¸»èŠ‚ç‚¹node1ä¸node2å’Œ3å¤±è”ï¼Œé‡æ–°é€‰ä¸¾ï¼Œnode3æˆä¸ºä¸»èŠ‚ç‚¹ï¼Œnode1è‡ªæˆé›†ç¾¤ï¼Œnode2ã€3è‡ªæˆé›†ç¾¤ï¼Œç½‘ç»œæ¢å¤åï¼Œ2ä¸ªé›†ç¾¤çŠ¶æ€ä¸ä¸€è‡´</li>\n<li>è§£å†³è„‘è£‚çš„æ–¹æ¡ˆæ˜¯ï¼Œè¦æ±‚é€‰ç¥¨è¶…è¿‡(eligibleèŠ‚ç‚¹æ•°é‡ + 1)/ 2 æ‰èƒ½å½“é€‰ä¸ºä¸»ï¼Œå› æ­¤eligibleèŠ‚ç‚¹æ•°é‡æœ€å¥½æ˜¯å¥‡æ•°ã€‚å¯¹åº”é…ç½®é¡¹æ˜¯discovery.zen.minimum_master_nodesï¼Œåœ¨es7.0ä»¥åï¼Œå·²ç»æˆä¸ºé»˜è®¤é…ç½®ï¼Œå› æ­¤ä¸€èˆ¬ä¸ä¼šå‘ç”Ÿè„‘è£‚é—®é¢˜</li>\n</ul>\n<h1>é›†ç¾¤åˆ†å¸ƒå¼å­˜å‚¨</h1>\n<ul>\n<li>å½“æ–°å¢æ–‡æ¡£æ—¶ï¼Œelasticsearchä¼šé€šè¿‡hashç®—æ³•æ¥è®¡ç®—æ–‡æ¡£åº”è¯¥å­˜å‚¨åˆ°å“ªä¸ªåˆ†ç‰‡ï¼Œä¿è¯æ•°æ®å‡è¡¡ï¼Œshard = hash(_routingæ–‡æ¡£id) % number_of_shardsåˆ†ç‰‡æ•°</li>\n<li>ç®—æ³•ä¸åˆ†ç‰‡æ•°é‡æœ‰å…³ï¼Œå› æ­¤ç´¢å¼•åº“ä¸€æ—¦åˆ›å»ºï¼Œåˆ†ç‰‡æ•°é‡ä¸èƒ½ä¿®æ”¹ï¼</li>\n</ul>\n<h1>é›†ç¾¤åˆ†å¸ƒå¼æŸ¥è¯¢åŸç†ï¼š</h1>\n<ul>\n<li>elasticsearchçš„æŸ¥è¯¢åˆ†æˆä¸¤ä¸ªé˜¶æ®µï¼š\n<ul>\n<li>scatter phaseï¼šåˆ†æ•£é˜¶æ®µï¼Œcoordinating nodeä¼šæŠŠè¯·æ±‚åˆ†å‘åˆ°æ¯ä¸€ä¸ªåˆ†ç‰‡</li>\n<li>gather phaseï¼šèšé›†é˜¶æ®µï¼Œcoordinating nodeæ±‡æ€»data nodeçš„æœç´¢ç»“æœï¼Œå¹¶å¤„ç†ä¸ºæœ€ç»ˆç»“æœé›†è¿”å›ç»™ç”¨æˆ·</li>\n</ul>\n</li>\n</ul>\n<h1>é›†ç¾¤æ•…éšœè½¬ç§»</h1>\n<ul>\n<li>é›†ç¾¤çš„masterèŠ‚ç‚¹ä¼šç›‘æ§é›†ç¾¤ä¸­çš„èŠ‚ç‚¹çŠ¶æ€ï¼Œå¦‚æœå‘ç°æœ‰èŠ‚ç‚¹å®•æœºï¼Œä¼šç«‹å³å°†å®•æœºèŠ‚ç‚¹çš„åˆ†ç‰‡æ•°æ®è¿ç§»åˆ°å…¶å®ƒèŠ‚ç‚¹ï¼Œç¡®ä¿æ•°æ®å®‰å…¨ï¼Œè¿™ä¸ªå«åšæ•…éšœè½¬ç§»ã€‚</li>\n<li>ESé»˜è®¤é…ç½®å¥½äº†æœ‰é›†ç¾¤æ•…éšœè½¬ç§»</li>\n</ul>\n",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "lucene",
      "url": "https://javaguide.cn/backend/searchengine/lucene.html",
      "id": "https://javaguide.cn/backend/searchengine/lucene.html",
      "summary": "lucene 1. å…¨æ–‡æ£€ç´¢ä»‹ç» 2. Luceneä»‹ç» 3. Luceneå®ç°å…¨æ–‡æ£€ç´¢çš„æµç¨‹ 4. Luceneä½¿ç”¨ 1. å…¨æ–‡æ£€ç´¢ä»‹ç» æ•°æ®åˆ†ç±» ç»“æ„åŒ–æ•°æ®ï¼šæŒ‡å…·æœ‰å›ºå®šæ ¼å¼æˆ–æœ‰é™é•¿åº¦çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“ï¼Œå…ƒæ•°æ®ç­‰ã€‚ éç»“æ„åŒ–æ•°æ®ï¼šæŒ‡ä¸å®šé•¿æˆ–æ— å›ºå®šæ ¼å¼çš„æ•°æ®ï¼Œå¦‚é‚®ä»¶ï¼Œwordæ–‡æ¡£ç­‰ç£ç›˜ä¸Šçš„æ–‡ä»¶ é¡ºåºæ‰«ææ³•(Serial Scanning)é¡ºåºéå†æ‰€æœ‰æ–‡æ¡£...",
      "content_html": "<p>lucene</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2%E4%BB%8B%E7%BB%8D\">1. å…¨æ–‡æ£€ç´¢ä»‹ç»</a></li>\n<li><a href=\"#2-lucene%E4%BB%8B%E7%BB%8D\">2. Luceneä»‹ç»</a></li>\n<li><a href=\"#3-lucene%E5%AE%9E%E7%8E%B0%E5%85%A8%E6%96%87%E6%A3%80%E7%B4%A2%E7%9A%84%E6%B5%81%E7%A8%8B\">3. Luceneå®ç°å…¨æ–‡æ£€ç´¢çš„æµç¨‹</a></li>\n<li><a href=\"#4-lucene%E4%BD%BF%E7%94%A8\">4. Luceneä½¿ç”¨</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. å…¨æ–‡æ£€ç´¢ä»‹ç»</h1>\n<ul>\n<li>æ•°æ®åˆ†ç±»\n<ul>\n<li>ç»“æ„åŒ–æ•°æ®ï¼šæŒ‡å…·æœ‰å›ºå®šæ ¼å¼æˆ–æœ‰é™é•¿åº¦çš„æ•°æ®ï¼Œå¦‚æ•°æ®åº“ï¼Œå…ƒæ•°æ®ç­‰ã€‚</li>\n<li>éç»“æ„åŒ–æ•°æ®ï¼šæŒ‡ä¸å®šé•¿æˆ–æ— å›ºå®šæ ¼å¼çš„æ•°æ®ï¼Œå¦‚é‚®ä»¶ï¼Œwordæ–‡æ¡£ç­‰ç£ç›˜ä¸Šçš„æ–‡ä»¶\n<ul>\n<li>é¡ºåºæ‰«ææ³•(Serial Scanning)é¡ºåºéå†æ‰€æœ‰æ–‡æ¡£çš„å†…å®¹,ç›´åˆ°æ‰«æå®Œæ‰€æœ‰çš„æ–‡æ¡£,å¦‚åˆ©ç”¨windowsçš„æœç´¢ä¹Ÿå¯ä»¥æœç´¢æ–‡ä»¶å†…å®¹ï¼Œåªæ˜¯æ…¢</li>\n<li>å…¨æ–‡æ£€ç´¢(Full-text Search)å…ˆä»éç»“æ„åŒ–æ•°æ®ä¸­æå–å‡ºçš„ç„¶åé‡æ–°ç»„ç»‡çš„ä¿¡æ¯(ç´¢å¼•)å†å¯¹ç´¢å¼•è¿›è¡Œæœç´¢</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h1>2. Luceneä»‹ç»</h1>\n<ul>\n<li>Luceneæ˜¯apacheä¸‹çš„ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„å…¨æ–‡æ£€ç´¢å¼•æ“å·¥å…·åŒ…ã€‚æä¾›äº†å®Œæ•´çš„æŸ¥è¯¢å¼•æ“å’Œç´¢å¼•å¼•æ“ï¼Œéƒ¨åˆ†æ–‡æœ¬åˆ†æå¼•æ“ã€‚</li>\n<li>å¯¹äºæ•°æ®é‡å¤§ã€æ•°æ®ç»“æ„ä¸å›ºå®šçš„æ•°æ®å¯é‡‡ç”¨å…¨æ–‡æ£€ç´¢æ–¹å¼æœç´¢ï¼Œæ¯”å¦‚ç™¾åº¦ã€Googleç­‰æœç´¢å¼•æ“ã€è®ºå›ç«™å†…æœç´¢ã€ç”µå•†ç½‘ç«™ç«™å†…æœç´¢ç­‰ã€‚</li>\n</ul>\n<h1>3. Luceneå®ç°å…¨æ–‡æ£€ç´¢çš„æµç¨‹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/eabbde040a19fe3ae942a.png\" alt=\"å›¾ç‰‡1.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡1.png</figcaption></figure>\n<ul>\n<li>ç»¿è‰²è¡¨ç¤ºç´¢å¼•è¿‡ç¨‹ï¼Œå¯¹è¦æœç´¢çš„åŸå§‹å†…å®¹è¿›è¡Œç´¢å¼•æ„å»ºä¸€ä¸ªç´¢å¼•åº“ï¼Œç´¢å¼•è¿‡ç¨‹åŒ…æ‹¬ï¼šç¡®å®šåŸå§‹å†…å®¹å³è¦æœç´¢çš„å†…å®¹â†’é‡‡é›†æ–‡æ¡£â†’åˆ›å»ºæ–‡æ¡£â†’åˆ†ææ–‡æ¡£â†’ç´¢å¼•æ–‡æ¡£</li>\n<li>çº¢è‰²è¡¨ç¤ºæœç´¢è¿‡ç¨‹ï¼Œä»ç´¢å¼•åº“ä¸­æœç´¢å†…å®¹ï¼Œæœç´¢è¿‡ç¨‹åŒ…æ‹¬ï¼šç”¨æˆ·é€šè¿‡æœç´¢ç•Œé¢â†’åˆ›å»ºæŸ¥è¯¢â†’æ‰§è¡Œæœç´¢ï¼Œä»ç´¢å¼•åº“æœç´¢â†’æ¸²æŸ“æœç´¢ç»“æœ</li>\n</ul>\n<h1>4. Luceneä½¿ç”¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä»å®˜æ–¹ç½‘ç«™ï¼šhttp://lucene.apache.org/ ä¸‹è½½Lucene4.10.3ï¼Œå¹¶è§£å‹ã€‚\nJdkè¦æ±‚ï¼š1.7ä»¥ä¸Š\n\njaråŒ…\nlucene-core-4.10.3.jar\nlucene-analyzers-common-4.10.3.jar\nlucene-queryparser-4.10.3.jar\nå…¶å®ƒï¼š\ncommons-io-2.4.jar\njunit-4.9.jar\n\nåŠŸèƒ½ä¸€ï¼šåˆ›å»ºç´¢å¼•åº“\nä½¿ç”¨indexwriterå¯¹è±¡åˆ›å»ºç´¢å¼•\nç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªjavaå·¥ç¨‹ï¼Œå¹¶å¯¼å…¥jaråŒ…ã€‚\nç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªindexwriterå¯¹è±¡ã€‚\n1ï¼‰æŒ‡å®šç´¢å¼•åº“çš„å­˜æ”¾ä½ç½®Directoryå¯¹è±¡\n2ï¼‰æŒ‡å®šä¸€ä¸ªåˆ†æå™¨ï¼Œå¯¹æ–‡æ¡£å†…å®¹è¿›è¡Œåˆ†æã€‚\nç¬¬äºŒæ­¥ï¼šåˆ›å»ºdocumentå¯¹è±¡ã€‚\nç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºfieldå¯¹è±¡ï¼Œå°†fieldæ·»åŠ åˆ°documentå¯¹è±¡ä¸­ã€‚\nç¬¬å››æ­¥ï¼šä½¿ç”¨indexwriterå¯¹è±¡å°†documentå¯¹è±¡å†™å…¥ç´¢å¼•åº“ï¼Œæ­¤è¿‡ç¨‹è¿›è¡Œç´¢å¼•åˆ›å»ºã€‚å¹¶å°†ç´¢å¼•å’Œdocumentå¯¹è±¡å†™å…¥ç´¢å¼•åº“ã€‚\nç¬¬äº”æ­¥ï¼šå…³é—­IndexWriterå¯¹è±¡ã€‚\n\n@Test\npublic void createIndex() throws Exception {\n\t//æŒ‡å®šç´¢å¼•åº“å­˜æ”¾çš„è·¯å¾„\n\t//D:\\temp\\0108\\index\n\tDirectory directory = FSDirectory.open(new File(\"D:\\\\temp\\\\0108\\\\index\"));\n\t//ç´¢å¼•åº“è¿˜å¯ä»¥å­˜æ”¾åˆ°å†…å­˜ä¸­\n\t//Directory directory = new RAMDirectory();\n\t//åˆ›å»ºä¸€ä¸ªæ ‡å‡†åˆ†æå™¨\n\t//Analyzer analyzer = new StandardAnalyzer();// å®˜æ–¹æ¨è\n\tAnalyzer analyzer = new IKAnalyzer();// å®˜æ–¹æ¨è\n\t//åˆ›å»ºindexwriterCofigå¯¹è±¡\n\t//ç¬¬ä¸€ä¸ªå‚æ•°ï¼š Luceneçš„ç‰ˆæœ¬ä¿¡æ¯ï¼Œå¯ä»¥é€‰æ‹©å¯¹åº”çš„luceneç‰ˆæœ¬ä¹Ÿå¯ä»¥ä½¿ç”¨LATEST\n\t//ç¬¬äºŒæ ¹å‚æ•°ï¼šåˆ†æå™¨å¯¹è±¡\n\tIndexWriterConfig config = new IndexWriterConfig(Version.LATEST, analyzer);\n\t//åˆ›å»ºindexwriterå¯¹è±¡\n\tIndexWriter indexWriter = new IndexWriter(directory, config);\n\t//åŸå§‹æ–‡æ¡£çš„è·¯å¾„D:\\ä¼ æ™ºæ’­å®¢\\01.è¯¾ç¨‹\\04.lucene\\01.å‚è€ƒèµ„æ–™\\searchsource\n\tFile dir = new File(\"D:\\\\ä¼ æ™ºæ’­å®¢\\\\01.è¯¾ç¨‹\\\\04.lucene\\\\01.å‚è€ƒèµ„æ–™\\\\searchsource\");\n\tfor (File f : dir.listFiles()) {\n\t\t//æ–‡ä»¶å\n\t\tString fileName = f.getName();\n\t\t//æ–‡ä»¶å†…å®¹\n\t\tString fileContent = FileUtils.readFileToString(f);\n\t\t//æ–‡ä»¶è·¯å¾„\n\t\tString filePath = f.getPath();\n\t\t//æ–‡ä»¶çš„å¤§å°\n\t\tlong fileSize  = FileUtils.sizeOf(f);\n\t\t//åˆ›å»ºæ–‡ä»¶ååŸŸ\n\t\t//ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸŸçš„åç§°\n\t\t//ç¬¬äºŒä¸ªå‚æ•°ï¼šåŸŸçš„å†…å®¹\n\t\t//ç¬¬ä¸‰ä¸ªå‚æ•°ï¼šæ˜¯å¦å­˜å‚¨\n\t\tField fileNameField = new TextField(\"filename\", fileName, Store.YES);\n\t\t//FieldåŸŸçš„å±æ€§\n\t\t//æ˜¯å¦åˆ†æï¼šæ˜¯å¦å¯¹åŸŸçš„å†…å®¹è¿›è¡Œåˆ†è¯å¤„ç†ã€‚å‰ææ˜¯æˆ‘ä»¬è¦å¯¹åŸŸçš„å†…å®¹è¿›è¡ŒæŸ¥è¯¢ã€‚\n\t\t//æ˜¯å¦ç´¢å¼•ï¼šå°†Fieldåˆ†æåçš„è¯æˆ–æ•´ä¸ªFieldå€¼è¿›è¡Œç´¢å¼•ï¼Œåªæœ‰ç´¢å¼•æ–¹å¯æœç´¢åˆ°ã€‚\n\t\t//æ¯”å¦‚ï¼šå•†å“åç§°ã€å•†å“ç®€ä»‹åˆ†æåè¿›è¡Œç´¢å¼•ï¼Œè®¢å•å·ã€èº«ä»½è¯å·ä¸ç”¨åˆ†æä½†ä¹Ÿè¦ç´¢å¼•ï¼Œè¿™äº›å°†æ¥éƒ½è¦ä½œä¸ºæŸ¥è¯¢æ¡ä»¶ã€‚\n\t\t//æ˜¯å¦å­˜å‚¨ï¼šå°†Fieldå€¼å­˜å‚¨åœ¨æ–‡æ¡£ä¸­ï¼Œå­˜å‚¨åœ¨æ–‡æ¡£ä¸­çš„Fieldæ‰å¯ä»¥ä»Documentä¸­è·å–\n\t\t//æ˜¯å¦å­˜å‚¨çš„æ ‡å‡†ï¼šæ˜¯å¦è¦å°†å†…å®¹å±•ç¤ºç»™ç”¨æˆ·\n\t\t//æ¯”å¦‚ï¼šå•†å“åç§°ã€è®¢å•å·ï¼Œå‡¡æ˜¯å°†æ¥è¦ä»Documentä¸­è·å–çš„Fieldéƒ½è¦å­˜å‚¨ã€‚\n\t\t//æ–‡ä»¶å†…å®¹åŸŸ\n\t\tField fileContentField = new TextField(\"content\", fileContent, Store.YES);\n\t\t//æ–‡ä»¶è·¯å¾„åŸŸï¼ˆä¸åˆ†æã€ä¸ç´¢å¼•ã€åªå­˜å‚¨ï¼‰\n\t\tField filePathField = new StoredField(\"path\", filePath);\n\t\t//æ–‡ä»¶å¤§å°åŸŸ\n\t\tField fileSizeField = new LongField(\"size\", fileSize, Store.YES);\n\t\t\n\t\t//åˆ›å»ºdocumentå¯¹è±¡\n\t\tDocument document = new Document();\n\t\tdocument.add(fileNameField);\n\t\tdocument.add(fileContentField);\n\t\tdocument.add(filePathField);\n\t\tdocument.add(fileSizeField);\n\t\t//åˆ›å»ºç´¢å¼•ï¼Œå¹¶å†™å…¥ç´¢å¼•åº“\n\t\tindexWriter.addDocument(document);\n\t}\n\t//å…³é—­indexwriter\n\tindexWriter.close();\n}\n</code></pre></div><p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ee25b2bd28aa2f116963c.png\" alt=\"å›¾ç‰‡6.png\"><br>\nä½¿ç”¨Lukeå·¥å…·æŸ¥çœ‹ç´¢å¼•æ–‡ä»¶<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/88cb3f7a269de2dce082e.png\" alt=\"å›¾ç‰‡7.png\"></p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åŠŸèƒ½äºŒï¼šæŸ¥è¯¢ç´¢å¼•\nå®ç°æ­¥éª¤\nç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªDirectoryå¯¹è±¡ï¼Œä¹Ÿå°±æ˜¯ç´¢å¼•åº“å­˜æ”¾çš„ä½ç½®ã€‚\nç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªindexReaderå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šDirectoryå¯¹è±¡ã€‚\nç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªindexsearcherå¯¹è±¡ï¼Œéœ€è¦æŒ‡å®šIndexReaderå¯¹è±¡\nç¬¬å››æ­¥ï¼šåˆ›å»ºä¸€ä¸ªTermQueryå¯¹è±¡ï¼ŒæŒ‡å®šæŸ¥è¯¢çš„åŸŸå’ŒæŸ¥è¯¢çš„å…³é”®è¯ã€‚\nç¬¬äº”æ­¥ï¼šæ‰§è¡ŒæŸ¥è¯¢ã€‚\nç¬¬å…­æ­¥ï¼šè¿”å›æŸ¥è¯¢ç»“æœã€‚éå†æŸ¥è¯¢ç»“æœå¹¶è¾“å‡ºã€‚\nç¬¬ä¸ƒæ­¥ï¼šå…³é—­IndexReaderå¯¹è±¡\n\n@Test\npublic void searchIndex() throws Exception {\n\t//æŒ‡å®šç´¢å¼•åº“å­˜æ”¾çš„è·¯å¾„\n\t//D:\\temp\\0108\\index\n\tDirectory directory = FSDirectory.open(new File(\"D:\\\\temp\\\\0108\\\\index\"));\n\t//åˆ›å»ºindexReaderå¯¹è±¡\n\tIndexReader indexReader = DirectoryReader.open(directory);\n\t//åˆ›å»ºindexsearcherå¯¹è±¡\n\tIndexSearcher indexSearcher = new IndexSearcher(indexReader);\n\t//åˆ›å»ºä¸€ä¸ªTermQueryå¯¹è±¡ï¼ŒæŒ‡å®šæŸ¥è¯¢çš„åŸŸå’ŒæŸ¥è¯¢çš„å…³é”®è¯ã€‚\n\tQuery query = new TermQuery(new Term(\"filename\", \"apache\"));\n\t//æ‰§è¡ŒæŸ¥è¯¢\n\t//ç¬¬ä¸€ä¸ªå‚æ•°æ˜¯æŸ¥è¯¢å¯¹è±¡ï¼Œç¬¬äºŒä¸ªå‚æ•°æ˜¯æŸ¥è¯¢ç»“æœè¿”å›çš„æœ€å¤§å€¼\n\t//indexSearcher.search(query, n)\tæ ¹æ®Queryæœç´¢ï¼Œè¿”å›è¯„åˆ†æœ€é«˜çš„næ¡è®°å½•\n\t//indexSearcher.search(query, filter, n)\tæ ¹æ®Queryæœç´¢ï¼Œæ·»åŠ è¿‡æ»¤ç­–ç•¥ï¼Œè¿”å›è¯„åˆ†æœ€é«˜çš„næ¡è®°å½•\n\t//indexSearcher.search(query, n, sort)\tæ ¹æ®Queryæœç´¢ï¼Œæ·»åŠ æ’åºç­–ç•¥ï¼Œè¿”å›è¯„åˆ†æœ€é«˜çš„næ¡è®°å½•\n\t//indexSearcher.search(booleanQuery, filter, n, sort)\tæ ¹æ®Queryæœç´¢ï¼Œæ·»åŠ è¿‡æ»¤ç­–ç•¥ï¼Œæ·»åŠ æ’åºç­–ç•¥ï¼Œè¿”å›è¯„åˆ†æœ€é«˜çš„næ¡è®°å½•\n\tTopDocs topDocs = indexSearcher.search(query, 10);\n\n\t//æŸ¥è¯¢ç»“æœçš„æ€»æ¡æ•°\n\t//TopDocs.totalHitsï¼šæ˜¯åŒ¹é…ç´¢å¼•åº“ä¸­æ‰€æœ‰è®°å½•çš„æ•°é‡\n\t//TopDocs.scoreDocsï¼šåŒ¹é…ç›¸å…³åº¦é«˜çš„å‰è¾¹è®°å½•æ•°ç»„ï¼ŒscoreDocsçš„é•¿åº¦å°äºç­‰äºsearchæ–¹æ³•æŒ‡å®šçš„å‚æ•°n\n\tSystem.out.println(\"æŸ¥è¯¢ç»“æœçš„æ€»æ¡æ•°ï¼š\"+ topDocs.totalHits);\n\t//éå†æŸ¥è¯¢ç»“æœ\n\t//topDocs.scoreDocså­˜å‚¨äº†documentå¯¹è±¡çš„id\n\tfor (ScoreDoc scoreDoc : topDocs.scoreDocs) {\n\t\t//scoreDoc.docå±æ€§å°±æ˜¯documentå¯¹è±¡çš„id\n\t\t//æ ¹æ®documentçš„idæ‰¾åˆ°documentå¯¹è±¡\n\t\tDocument document = indexSearcher.doc(scoreDoc.doc);\n\t\tSystem.out.println(document.get(\"filename\"));\n\t\t//System.out.println(document.get(\"content\"));\n\t\tSystem.out.println(document.get(\"path\"));\n\t\tSystem.out.println(document.get(\"size\"));\n\t}\n\t//å…³é—­indexreaderå¯¹è±¡\n\tindexReader.close();\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åŠŸèƒ½ä¸‰ï¼šæ”¯æŒä¸­æ–‡åˆ†è¯\nåˆ†æå™¨ï¼ˆAnalyzerï¼‰çš„æ‰§è¡Œè¿‡ç¨‹è¯­æ±‡å•å…ƒçš„ç”Ÿæˆè¿‡ç¨‹ï¼šReader-&gt;Tokenizer-&gt;TokenFilter-&gt;TokenFilter-&gt;TokenFilter-&gt;Tokens\nè¦çœ‹åˆ†æå™¨çš„åˆ†ææ•ˆæœï¼Œåªéœ€è¦çœ‹Tokenstreamä¸­çš„å†…å®¹å°±å¯ä»¥äº†ã€‚æ¯ä¸ªåˆ†æå™¨éƒ½æœ‰ä¸€ä¸ªæ–¹æ³•tokenStreamï¼Œè¿”å›ä¸€ä¸ªtokenStreamå¯¹è±¡ã€‚\n\nåˆ†æå™¨çš„åˆ†è¯æ•ˆæœ\n//æŸ¥çœ‹æ ‡å‡†åˆ†æå™¨çš„åˆ†è¯æ•ˆæœ\n@Test\npublic void testTokenStream() throws Exception {\n\t//åˆ›å»ºä¸€ä¸ªæ ‡å‡†åˆ†æå™¨å¯¹è±¡\n\tAnalyzer analyzer = new IKAnalyzer();\n\t//è·å¾—tokenStreamå¯¹è±¡\n\t//ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸŸåï¼Œå¯ä»¥éšä¾¿ç»™ä¸€ä¸ª\n\t//ç¬¬äºŒä¸ªå‚æ•°ï¼šè¦åˆ†æçš„æ–‡æœ¬å†…å®¹\n\tTokenStream tokenStream = analyzer.tokenStream(\"test\", \"The Spring Framework provides a comprehensive programming and configuration model.\");\n\t//æ·»åŠ ä¸€ä¸ªå¼•ç”¨ï¼Œå¯ä»¥è·å¾—æ¯ä¸ªå…³é”®è¯\n\tCharTermAttribute charTermAttribute = tokenStream.addAttribute(CharTermAttribute.class);\n\t//æ·»åŠ ä¸€ä¸ªåç§»é‡çš„å¼•ç”¨ï¼Œè®°å½•äº†å…³é”®è¯çš„å¼€å§‹ä½ç½®ä»¥åŠç»“æŸä½ç½®\n\tOffsetAttribute offsetAttribute = tokenStream.addAttribute(OffsetAttribute.class);\n\t//å°†æŒ‡é’ˆè°ƒæ•´åˆ°åˆ—è¡¨çš„å¤´éƒ¨\n\ttokenStream.reset();\n\t//éå†å…³é”®è¯åˆ—è¡¨ï¼Œé€šè¿‡incrementTokenæ–¹æ³•åˆ¤æ–­åˆ—è¡¨æ˜¯å¦ç»“æŸ\n\twhile(tokenStream.incrementToken()) {\n\t\t//å…³é”®è¯çš„èµ·å§‹ä½ç½®\n\t\tSystem.out.println(\"start-&gt;\" + offsetAttribute.startOffset());\n\t\t//å–å…³é”®è¯\n\t\tSystem.out.println(charTermAttribute);\n\t\t//ç»“æŸä½ç½®\n\t\tSystem.out.println(\"end-&gt;\" + offsetAttribute.endOffset());\n\t}\n\ttokenStream.close();\n}\nIKAnalyzer.cfg.xmlæ‰©å±•ikåˆ†æå™¨\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE properties SYSTEM \"http://java.sun.com/dtd/properties.dtd\"&gt;  \n&lt;properties&gt;  \n\t&lt;comment&gt;IK Analyzer æ‰©å±•é…ç½®&lt;/comment&gt;\n\t&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•å­—å…¸ --&gt;\n\t&lt;entry key=\"ext_dict\"&gt;ext.dic;&lt;/entry&gt; \n\t\n\t&lt;!--ç”¨æˆ·å¯ä»¥åœ¨è¿™é‡Œé…ç½®è‡ªå·±çš„æ‰©å±•åœæ­¢è¯å­—å…¸--&gt;\n\t&lt;entry key=\"ext_stopwords\"&gt;stopword.dic;&lt;/entry&gt; \n\t\n&lt;/properties&gt;\nä¸­æ–‡åˆ†æå™¨\nLuceneè‡ªå¸¦ä¸­æ–‡åˆ†è¯å™¨\nStandardAnalyzerï¼šå•å­—åˆ†è¯ï¼šå°±æ˜¯æŒ‰ç…§ä¸­æ–‡ä¸€ä¸ªå­—ä¸€ä¸ªå­—åœ°è¿›è¡Œåˆ†è¯ã€‚å¦‚ï¼šâ€œæˆ‘çˆ±ä¸­å›½â€ï¼Œ æ•ˆæœï¼šâ€œæˆ‘â€ã€â€œçˆ±â€ã€â€œä¸­â€ã€â€œå›½â€ã€‚\nCJKAnalyzerï¼šäºŒåˆ†æ³•åˆ†è¯ï¼šæŒ‰ä¸¤ä¸ªå­—è¿›è¡Œåˆ‡åˆ†ã€‚å¦‚ï¼šâ€œæˆ‘æ˜¯ä¸­å›½äººâ€ï¼Œæ•ˆæœï¼šâ€œæˆ‘æ˜¯â€ã€â€œæ˜¯ä¸­â€ã€â€œä¸­å›½â€â€œå›½äººâ€ã€‚\nä¸Šè¾¹ä¸¤ä¸ªåˆ†è¯å™¨æ— æ³•æ»¡è¶³éœ€æ±‚ã€‚SmartChineseAnalyzer å¯¹ä¸­æ–‡æ”¯æŒè¾ƒå¥½ï¼Œä½†æ‰©å±•æ€§å·®ï¼Œæ‰©å±•è¯åº“ï¼Œç¦ç”¨è¯åº“å’ŒåŒä¹‰è¯åº“ç­‰ä¸å¥½å¤„ç†\nç¬¬ä¸‰æ–¹ä¸­æ–‡åˆ†æå™¨IK-analyzer(zhongdian)ï¼š æœ€æ–°ç‰ˆåœ¨https://code.google.com/p/ik-analyzer/ä¸Šï¼Œæ”¯æŒLucene 4.10ä»2006å¹´12æœˆæ¨å‡º1.0ç‰ˆå¼€å§‹ï¼Œ \nIKAnalyzerå·²ç»æ¨å‡ºäº†4ä¸ªå¤§ç‰ˆæœ¬ã€‚æœ€åˆï¼Œå®ƒæ˜¯ä»¥å¼€æºé¡¹ç›®Luenceä¸ºåº”ç”¨ä¸»ä½“çš„ï¼Œç»“åˆè¯å…¸åˆ†è¯å’Œæ–‡æ³•åˆ†æç®—æ³•çš„ä¸­æ–‡åˆ†è¯ç»„ä»¶ã€‚\nä»3.0ç‰ˆæœ¬å¼€ å§‹ï¼ŒIKå‘å±•ä¸ºé¢å‘Javaçš„å…¬ç”¨åˆ†è¯ç»„ä»¶ï¼Œç‹¬ç«‹äºLuceneé¡¹ç›®ï¼ŒåŒæ—¶æä¾›äº†å¯¹Luceneçš„é»˜è®¤ä¼˜åŒ–å®ç°ã€‚\nåœ¨2012ç‰ˆæœ¬ä¸­ï¼ŒIKå®ç°äº†ç®€å•çš„åˆ†è¯ æ­§ä¹‰æ’é™¤ç®—æ³•ï¼Œæ ‡å¿—ç€IKåˆ†è¯å™¨ä»å•çº¯çš„è¯å…¸åˆ†è¯å‘æ¨¡æ‹Ÿè¯­ä¹‰åˆ†è¯è¡åŒ–ã€‚ \n\n\nIKAnalyzer\nä½¿ç”¨æ–¹æ³•ï¼š\nç¬¬ä¸€æ­¥ï¼šæŠŠjaråŒ…æ·»åŠ åˆ°å·¥ç¨‹ä¸­\nç¬¬äºŒæ­¥ï¼šæŠŠé…ç½®æ–‡ä»¶å’Œæ‰©å±•è¯å…¸å’Œåœç”¨è¯è¯å…¸æ·»åŠ åˆ°classpathä¸‹\næ³¨æ„ï¼šmydict.dicå’Œext_stopword.dicæ–‡ä»¶çš„æ ¼å¼ä¸ºUTF-8ï¼Œæ³¨æ„æ˜¯æ— BOM çš„UTF-8 ç¼–ç ã€‚\nä½¿ç”¨EditPlus.exeä¿å­˜ä¸ºæ— BOM çš„UTF-8 ç¼–ç æ ¼å¼\nAnalyzerä½¿ç”¨æ—¶æœº\nç´¢å¼•æ—¶ä½¿ç”¨Analyzer\nè¾“å…¥å…³é”®å­—è¿›è¡Œæœç´¢ï¼Œå½“éœ€è¦è®©è¯¥å…³é”®å­—ä¸æ–‡æ¡£åŸŸå†…å®¹æ‰€åŒ…å«çš„è¯è¿›è¡ŒåŒ¹é…æ—¶éœ€è¦å¯¹æ–‡æ¡£åŸŸå†…å®¹è¿›è¡Œåˆ†æï¼Œ\néœ€è¦ç»è¿‡Analyzeråˆ†æå™¨å¤„ç†ç”Ÿæˆè¯­æ±‡å•å…ƒï¼ˆTokenï¼‰ã€‚åˆ†æå™¨åˆ†æçš„å¯¹è±¡æ˜¯æ–‡æ¡£ä¸­çš„FieldåŸŸã€‚\nå½“Fieldçš„å±æ€§tokenizedï¼ˆæ˜¯å¦åˆ†è¯ï¼‰ä¸ºtrueæ—¶ä¼šå¯¹Fieldå€¼è¿›è¡Œåˆ†æï¼Œå¦‚ä¸‹å›¾ï¼š\nå¯¹äºä¸€äº›Fieldå¯ä»¥ä¸ç”¨åˆ†æï¼š\n1ã€ä¸ä½œä¸ºæŸ¥è¯¢æ¡ä»¶çš„å†…å®¹ï¼Œæ¯”å¦‚æ–‡ä»¶è·¯å¾„\n2ã€ä¸æ˜¯åŒ¹é…å†…å®¹ä¸­çš„è¯è€ŒåŒ¹é…Fieldçš„æ•´ä½“å†…å®¹ï¼Œæ¯”å¦‚è®¢å•å·ã€èº«ä»½è¯å·ç­‰ã€‚\n\næœç´¢æ—¶ä½¿ç”¨Analyzer\nå¯¹æœç´¢å…³é”®å­—è¿›è¡Œåˆ†æå’Œç´¢å¼•åˆ†æä¸€æ ·ï¼Œä½¿ç”¨Analyzerå¯¹æœç´¢å…³é”®å­—è¿›è¡Œåˆ†æã€åˆ†è¯å¤„ç†ï¼Œ\nä½¿ç”¨åˆ†æåæ¯ä¸ªè¯è¯­è¿›è¡Œæœç´¢ã€‚æ¯”å¦‚ï¼šæœç´¢å…³é”®å­—ï¼šspring web ï¼Œç»è¿‡åˆ†æå™¨è¿›è¡Œåˆ†è¯ï¼Œ\nå¾—å‡ºï¼šspring  webæ‹¿è¯å»ç´¢å¼•è¯å…¸è¡¨æŸ¥æ‰¾ ï¼Œæ‰¾åˆ°ç´¢å¼•é“¾æ¥åˆ°Documentï¼Œè§£æDocumentå†…å®¹ã€‚\nå¯¹äºåŒ¹é…æ•´ä½“FieldåŸŸçš„æŸ¥è¯¢å¯ä»¥åœ¨æœç´¢æ—¶ä¸åˆ†æï¼Œæ¯”å¦‚æ ¹æ®è®¢å•å·ã€èº«ä»½è¯å·æŸ¥è¯¢ç­‰ã€‚\næ³¨æ„ï¼šæœç´¢ä½¿ç”¨çš„åˆ†æå™¨è¦å’Œç´¢å¼•ä½¿ç”¨çš„åˆ†æå™¨ä¸€è‡´ã€‚\n</code></pre></div><figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/70c59e47babacadd5ed42.png\" alt=\"å›¾ç‰‡10.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡10.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç´¢å¼•åº“çš„ç»´æŠ¤\nç´¢å¼•åº“çš„æ·»åŠ \n\tå‘ç´¢å¼•åº“ä¸­æ·»åŠ documentå¯¹è±¡ã€‚\n\tç¬¬ä¸€æ­¥ï¼šå…ˆåˆ›å»ºä¸€ä¸ªindexwriterå¯¹è±¡\n\tç¬¬äºŒæ­¥ï¼šåˆ›å»ºä¸€ä¸ªdocumentå¯¹è±¡\n\tç¬¬ä¸‰æ­¥ï¼šæŠŠdocumentå¯¹è±¡å†™å…¥ç´¢å¼•åº“\n\tç¬¬å››æ­¥ï¼šå…³é—­indexwriterã€‚\n\n\t//æ·»åŠ ç´¢å¼•\n\t@Test\n\tpublic void addDocument() throws Exception {\n\t\t//ç´¢å¼•åº“å­˜æ”¾è·¯å¾„\n\t\tDirectory directory = FSDirectory.open(new File(\"D:\\\\temp\\\\0108\\\\index\"));\t\n\t\tIndexWriterConfig config = new IndexWriterConfig(Version.LATEST, new IKAnalyzer());\n\t\t//åˆ›å»ºä¸€ä¸ªindexwriterå¯¹è±¡\n\t\tIndexWriter indexWriter = new IndexWriter(directory, config);\n\t\t//åˆ›å»ºä¸€ä¸ªDocumentå¯¹è±¡\n\t\tDocument document = new Document();\n\t\t//å‘documentå¯¹è±¡ä¸­æ·»åŠ åŸŸã€‚\n\t\t//ä¸åŒçš„documentå¯ä»¥æœ‰ä¸åŒçš„åŸŸï¼ŒåŒä¸€ä¸ªdocumentå¯ä»¥æœ‰ç›¸åŒçš„åŸŸã€‚\n\t\tdocument.add(new TextField(\"filename\", \"æ–°æ·»åŠ çš„æ–‡æ¡£\", Store.YES));\n\t\tdocument.add(new TextField(\"content\", \"æ–°æ·»åŠ çš„æ–‡æ¡£çš„å†…å®¹\", Store.NO));\n\t\tdocument.add(new TextField(\"content\", \"æ–°æ·»åŠ çš„æ–‡æ¡£çš„å†…å®¹ç¬¬äºŒä¸ªcontent\", Store.YES));\n\t\tdocument.add(new TextField(\"content1\", \"æ–°æ·»åŠ çš„æ–‡æ¡£çš„å†…å®¹è¦èƒ½çœ‹åˆ°\", Store.YES));\n\t\t//æ·»åŠ æ–‡æ¡£åˆ°ç´¢å¼•åº“\n\t\tindexWriter.addDocument(document);\n\t\t//å…³é—­indexwriter\n\t\tindexWriter.close();\t\n\t}\n\nç´¢å¼•åº“åˆ é™¤\n\tå°†ç´¢å¼•ç›®å½•çš„ç´¢å¼•ä¿¡æ¯å…¨éƒ¨åˆ é™¤ï¼Œç›´æ¥å½»åº•åˆ é™¤ï¼Œæ— æ³•æ¢å¤ã€‚æ­¤æ–¹æ³•æ…ç”¨ï¼ï¼\n\t//åˆ é™¤å…¨éƒ¨ç´¢å¼•\n\t@Test\n\tpublic void deleteAllIndex() throws Exception {\n\t\tIndexWriter indexWriter = getIndexWriter();\n\t\t//åˆ é™¤å…¨éƒ¨ç´¢å¼•\n\t\tindexWriter.deleteAll();\n\t\t//å…³é—­indexwriter\n\t\tindexWriter.close();\n\t}\n\næŒ‡å®šæŸ¥è¯¢æ¡ä»¶åˆ é™¤\n\t//æ ¹æ®æŸ¥è¯¢æ¡ä»¶åˆ é™¤ç´¢å¼•\n\t@Test\n\tpublic void deleteIndexByQuery() throws Exception {\n\t\tIndexWriter indexWriter = getIndexWriter();\n\t\t//åˆ›å»ºä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶\n\t\tQuery query = new TermQuery(new Term(\"filename\", \"apache\"));\n\t\t//æ ¹æ®æŸ¥è¯¢æ¡ä»¶åˆ é™¤\n\t\tindexWriter.deleteDocuments(query);\n\t\t//å…³é—­indexwriter\n\t\tindexWriter.close();\n\t}\n\nç´¢å¼•åº“çš„ä¿®æ”¹\n\tåŸç†å°±æ˜¯å…ˆåˆ é™¤åæ·»åŠ ã€‚\n\t//ä¿®æ”¹ç´¢å¼•åº“\n\t@Test\n\tpublic void updateIndex() throws Exception {\n\t\tIndexWriter indexWriter = getIndexWriter();\n\t\t//åˆ›å»ºä¸€ä¸ªDocumentå¯¹è±¡\n\t\tDocument document = new Document();\n\t\t//å‘documentå¯¹è±¡ä¸­æ·»åŠ åŸŸã€‚\n\t\t//ä¸åŒçš„documentå¯ä»¥æœ‰ä¸åŒçš„åŸŸï¼ŒåŒä¸€ä¸ªdocumentå¯ä»¥æœ‰ç›¸åŒçš„åŸŸã€‚\n\t\tdocument.add(new TextField(\"filename\", \"è¦æ›´æ–°çš„æ–‡æ¡£\", Store.YES));\n\t\tdocument.add(new TextField(\"content\", \"2013å¹´11æœˆ18æ—¥ - Lucene ç®€ä»‹ Lucene æ˜¯ä¸€ä¸ªåŸºäº Java çš„å…¨æ–‡ä¿¡æ¯æ£€ç´¢å·¥å…·åŒ…,\"+\"\n\t\tå®ƒä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„æœç´¢åº”ç”¨ç¨‹åº,è€Œæ˜¯ä¸ºä½ çš„åº”ç”¨ç¨‹åºæä¾›ç´¢å¼•å’Œæœç´¢åŠŸèƒ½ã€‚\", Store.YES));\n\t\t//å…ˆæ ¹æ®contentåŸŸä¸ºjavaæŸ¥æ‰¾åˆ°æ–‡æ¡£ï¼Œæ–°æ–‡æ¡£è¦†ç›–è¯¥æ–‡æ¡£ï¼ŒåŸæ–‡æ¡£çš„contentåŸŸåŠå…¶æ–‡æ¡£æœ¬èº«ä¸å†å­˜åœ¨äºæ–°ç´¢å¼•åº“ä¸­ï¼Œè¢«æ•´ä¸ªæ–°æ–‡æ¡£çš„åŸŸå’Œæ–°æ–‡æ¡£æœ¬èº«å–ä»£\n\t\t//å…ˆæ ¹æ®contentåŸŸä¸ºjavaæŸ¥æ‰¾åˆ°æ–‡æ¡£ï¼Œå¦‚æœæœ‰å°±æ›´æ–°å®ƒ(å¦‚æœæœ‰å¤šæ¡ï¼Œæœ€åæ›´æ–°ååªæœ‰ä¸€æ¡)ã€‚å¦‚æœæ²¡æœ‰å°±æ–°å¢.\n\t\tindexWriter.updateDocument(new Term(\"content\", \"java\"), document);\n\t\t//å…³é—­indexWriter\n\t\tindexWriter.close();\n\t}\n\nç´¢å¼•åº“æŸ¥è¯¢ï¼ˆé‡ç‚¹ï¼‰\n\tå¯¹è¦æœç´¢çš„ä¿¡æ¯åˆ›å»ºQueryæŸ¥è¯¢å¯¹è±¡ï¼ŒLuceneä¼šæ ¹æ®QueryæŸ¥è¯¢å¯¹è±¡ç”Ÿæˆæœ€ç»ˆçš„æŸ¥è¯¢è¯­æ³•ï¼Œ\n\tå¯é€šè¿‡ä¸¤ç§æ–¹æ³•åˆ›å»ºæŸ¥è¯¢å¯¹è±¡ï¼š\n\t1ï¼‰ä½¿ç”¨Luceneæä¾›Queryå­ç±»\n\tQueryæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œluceneæä¾›äº†å¾ˆå¤šæŸ¥è¯¢å¯¹è±¡ï¼Œæ¯”å¦‚TermQueryé¡¹ç²¾ç¡®æŸ¥è¯¢ï¼ŒNumericRangeQueryæ•°å­—èŒƒå›´æŸ¥è¯¢ç­‰ã€‚\n\tQuery query = new TermQuery(new Term(\"name\", \"lucene\"));\n\n\t2ï¼‰ä½¿ç”¨QueryParseè§£ææŸ¥è¯¢è¡¨è¾¾å¼\n\tQueryParseä¼šå°†ç”¨æˆ·è¾“å…¥çš„æŸ¥è¯¢è¡¨è¾¾å¼è§£ææˆQueryå¯¹è±¡å®ä¾‹ã€‚\n\tQueryParser queryParser = new QueryParser(\"name\", new IKAnalyzer());\n\tQuery query = queryParser.parse(\"name:lucene\");\n\n\nä½¿ç”¨queryçš„å­ç±»æŸ¥è¯¢\n\tMatchAllDocsQuery\n\tä½¿ç”¨MatchAllDocsQueryæŸ¥è¯¢ç´¢å¼•ç›®å½•ä¸­çš„æ‰€æœ‰æ–‡æ¡£\n\t@Test\n\tpublic void testMatchAllDocsQuery() throws Exception {\n\t\tIndexSearcher indexSearcher = getIndexSearcher();\n\t\t//åˆ›å»ºæŸ¥è¯¢æ¡ä»¶\n\t\tQuery query = new MatchAllDocsQuery();\n\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\tprintResult(query, indexSearcher);\n\t}\n\n\tTermQuery\n\tTermQueryï¼Œé€šè¿‡é¡¹æŸ¥è¯¢ï¼ŒTermQueryä¸ä½¿ç”¨åˆ†æå™¨æ‰€ä»¥å»ºè®®åŒ¹é…ä¸åˆ†è¯çš„FieldåŸŸæŸ¥è¯¢ï¼Œæ¯”å¦‚è®¢å•å·ã€åˆ†ç±»IDå·ç­‰ã€‚\n\tæŒ‡å®šè¦æŸ¥è¯¢çš„åŸŸå’Œè¦æŸ¥è¯¢çš„å…³é”®è¯ã€‚\n\t@Test\n\tpublic void testTermQuery() throws Exception {\n\t\tIndexSearcher indexSearcher = getIndexSearcher();\n\t\t//åˆ›å»ºæŸ¥è¯¢å¯¹è±¡\n\t\tQuery query = new TermQuery(new Term(\"content\", \"lucene\"));\n\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\tTopDocs topDocs = indexSearcher.search(query, 10);\n\t\t//å…±æŸ¥è¯¢åˆ°çš„documentä¸ªæ•°\n\t\tSystem.out.println(\"æŸ¥è¯¢ç»“æœæ€»æ•°é‡ï¼š\" + topDocs.totalHits);\n\t\t//éå†æŸ¥è¯¢ç»“æœ\n\t\tfor (ScoreDoc scoreDoc : topDocs.scoreDocs) {\n\t\t\tDocument document = indexSearcher.doc(scoreDoc.doc);\n\t\t\tSystem.out.println(document.get(\"filename\"));\n\t\t\t//System.out.println(document.get(\"content\"));\n\t\t\tSystem.out.println(document.get(\"path\"));\n\t\t\tSystem.out.println(document.get(\"size\"));\n\t\t}\n\t\t//å…³é—­indexreader\n\t\tindexSearcher.getIndexReader().close();\n\t}\n\n\tNumericRangeQuery\n\tå¯ä»¥æ ¹æ®æ•°å€¼èŒƒå›´æŸ¥è¯¢ã€‚\n\t//æ•°å€¼èŒƒå›´æŸ¥è¯¢\n\t@Test\n\tpublic void testNumericRangeQuery() throws Exception {\n\t\tIndexSearcher indexSearcher = getIndexSearcher();\n\t\t//åˆ›å»ºæŸ¥è¯¢\n\t\t//å‚æ•°ï¼š\n\t\t//1.åŸŸå\n\t\t//2.æœ€å°å€¼\n\t\t//3.æœ€å¤§å€¼\n\t\t//4.æ˜¯å¦åŒ…å«æœ€å°å€¼\n\t\t//5.æ˜¯å¦åŒ…å«æœ€å¤§å€¼\n\t\tQuery query = NumericRangeQuery.newLongRange(\"size\", 1l, 1000l, true, true);\n\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\tprintResult(query, indexSearcher);\n\t}\n\n\tBooleanQuery\n\tå¯ä»¥ç»„åˆæŸ¥è¯¢æ¡ä»¶ã€‚\n\t//ç»„åˆæ¡ä»¶æŸ¥è¯¢\n\t@Test\n\tpublic void testBooleanQuery() throws Exception {\n\t\tIndexSearcher indexSearcher = getIndexSearcher();\n\t\t//åˆ›å»ºä¸€ä¸ªå¸ƒå°”æŸ¥è¯¢å¯¹è±¡\n\t\tBooleanQuery query = new BooleanQuery();\n\t\t//åˆ›å»ºç¬¬ä¸€ä¸ªæŸ¥è¯¢æ¡ä»¶\n\t\tQuery query1 = new TermQuery(new Term(\"filename\", \"apache\"));\n\t\tQuery query2 = new TermQuery(new Term(\"content\", \"apache\"));\n\t\t//ç»„åˆæŸ¥è¯¢æ¡ä»¶\n\t\t//Occur.MUSTï¼šå¿…é¡»æ»¡è¶³æ­¤æ¡ä»¶ï¼Œç›¸å½“äºand\n\t\t//Occur.SHOULDï¼šåº”è¯¥æ»¡è¶³ï¼Œä½†æ˜¯ä¸æ»¡è¶³ä¹Ÿå¯ä»¥ï¼Œç›¸å½“äºor\n\t\t//Occur.MUST_NOTï¼šå¿…é¡»ä¸æ»¡è¶³ã€‚ç›¸å½“äºnot\n\t\tquery.add(query1, Occur.MUST);\n\t\tquery.add(query2, Occur.MUST);\n\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\tprintResult(query, indexSearcher);\n\t}\n\n\t\n\n\nä½¿ç”¨queryparseræŸ¥è¯¢\n\té€šè¿‡QueryParserä¹Ÿå¯ä»¥åˆ›å»ºQueryï¼ŒQueryParseræä¾›ä¸€ä¸ªParseæ–¹æ³•ï¼Œæ­¤æ–¹æ³•å¯ä»¥ç›´æ¥æ ¹æ®æŸ¥è¯¢è¯­æ³•æ¥æŸ¥è¯¢ã€‚\n\tQueryå¯¹è±¡æ‰§è¡Œçš„æŸ¥è¯¢è¯­æ³•å¯é€šè¿‡System.out.println(query);æŸ¥è¯¢ã€‚\n\téœ€è¦ä½¿ç”¨åˆ°åˆ†æå™¨ã€‚å»ºè®®åˆ›å»ºç´¢å¼•æ—¶ä½¿ç”¨çš„åˆ†æå™¨å’ŒæŸ¥è¯¢ç´¢å¼•æ—¶ä½¿ç”¨çš„åˆ†æå™¨è¦ä¸€è‡´ã€‚\n\n\téœ€è¦åŠ å…¥queryParserä¾èµ–çš„jaråŒ…ã€‚\n\tlucene-queryparser-4.10.3.jar\n\t@Test\n\tpublic void testQueryParser() throws Exception {\n\t\tIndexSearcher indexSearcher = getIndexSearcher();\n\t\t//åˆ›å»ºqueryparserå¯¹è±¡\n\t\t//ç¬¬ä¸€ä¸ªå‚æ•°é»˜è®¤æœç´¢çš„åŸŸ*:*å…¨éƒ¨æŸ¥çš„è¯­æ³•\n\t\t//ç¬¬äºŒä¸ªå‚æ•°å°±æ˜¯åˆ†æå™¨å¯¹è±¡\n\t\tQueryParser queryParser = new QueryParser(\"content\", new IKAnalyzer());\n\t\t//æ‰§è¡Œ*:*\n\t\tQuery query = queryParser.parse(\"Luceneæ˜¯javaå¼€å‘çš„\");\n\t\t//æ‰§è¡ŒfileName:test\n\t\t//Query query = queryParser.parse(\"fileName:test\");\n\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\tprintResult(query, indexSearcher);\n\t}\n\næŸ¥è¯¢è¯­æ³•\n1ã€åŸºç¡€çš„æŸ¥è¯¢è¯­æ³•ï¼Œå…³é”®è¯æŸ¥è¯¢ï¼š\n\tåŸŸå+â€œï¼šâ€+æœç´¢çš„å…³é”®å­—\n\tä¾‹å¦‚ï¼šcontent:java\n2ã€èŒƒå›´æŸ¥è¯¢\n\tåŸŸå+â€œ:â€+[æœ€å°å€¼ TO æœ€å¤§å€¼]\n\tä¾‹å¦‚ï¼šsize:[1 TO 1000]\n\tèŒƒå›´æŸ¥è¯¢åœ¨luceneä¸­æ”¯æŒæ•°å€¼ç±»å‹ï¼Œä¸æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ã€‚åœ¨solrä¸­æ”¯æŒå­—ç¬¦ä¸²ç±»å‹ã€‚\n3ã€ç»„åˆæ¡ä»¶æŸ¥è¯¢\n1ï¼‰+æ¡ä»¶1 +æ¡ä»¶2ï¼šä¸¤ä¸ªæ¡ä»¶ä¹‹é—´æ˜¯å¹¶ä¸”çš„å…³ç³»and\nä¾‹å¦‚ï¼š+filename:apache +content:apache\n2ï¼‰+æ¡ä»¶1 æ¡ä»¶2ï¼šå¿…é¡»æ»¡è¶³ç¬¬ä¸€ä¸ªæ¡ä»¶ï¼Œåº”è¯¥æ»¡è¶³ç¬¬äºŒä¸ªæ¡ä»¶\nä¾‹å¦‚ï¼š+filename:apache content:apache\n3ï¼‰æ¡ä»¶1 æ¡ä»¶2ï¼šä¸¤ä¸ªæ¡ä»¶æ»¡è¶³å…¶ä¸€å³å¯ã€‚\nä¾‹å¦‚ï¼šfilename:apache content:apache\n4ï¼‰-æ¡ä»¶1 æ¡ä»¶2ï¼šå¿…é¡»ä¸æ»¡è¶³æ¡ä»¶1ï¼Œè¦æ»¡è¶³æ¡ä»¶2\nä¾‹å¦‚ï¼š-filename:apache content:apache\nOccur.MUST æŸ¥è¯¢æ¡ä»¶å¿…é¡»æ»¡è¶³ï¼Œç›¸å½“äºand\t+ï¼ˆåŠ å·ï¼‰\nOccur.SHOULD æŸ¥è¯¢æ¡ä»¶å¯é€‰ï¼Œç›¸å½“äºor ç©ºï¼ˆä¸ç”¨ç¬¦å·ï¼‰\nOccur.MUST_NOT æŸ¥è¯¢æ¡ä»¶ä¸èƒ½æ»¡è¶³ï¼Œç›¸å½“äºnoté\t-ï¼ˆå‡å·ï¼‰\n\nç¬¬äºŒç§å†™æ³•ï¼š\næ¡ä»¶1 AND æ¡ä»¶2\næ¡ä»¶1 OR æ¡ä»¶2\næ¡ä»¶1 NOT æ¡ä»¶2\n\nMultiFieldQueryParser\nå¯ä»¥æŒ‡å®šå¤šä¸ªé»˜è®¤æœç´¢åŸŸ\n@Test\npublic void testMultiFiledQueryParser() throws Exception {\n\tIndexSearcher indexSearcher = getIndexSearcher();\n\t//å¯ä»¥æŒ‡å®šé»˜è®¤æœç´¢çš„åŸŸæ˜¯å¤šä¸ª\n\tString[] fields = {\"filename\", \"content\"};\n\t//åˆ›å»ºä¸€ä¸ªMulitFiledQueryParserå¯¹è±¡\n\tMultiFieldQueryParser queryParser = new MultiFieldQueryParser(fields, new IKAnalyzer());\n\tQuery query = queryParser.parse(\"java AND apache\");\n\tSystem.out.println(query);\n\t//æ‰§è¡ŒæŸ¥è¯¢\n\tprintResult(query, indexSearcher);\n\t\n\t}\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/eabbde040a19fe3ae942a.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "solr",
      "url": "https://javaguide.cn/backend/searchengine/solr.html",
      "id": "https://javaguide.cn/backend/searchengine/solr.html",
      "summary": "solr 1. solrä»‹ç» 2. Solrä¸Luceneçš„åŒºåˆ« 3. Solrå®‰è£…åŠé…ç½® 4. Solrç®¡ç†ç´¢å¼•åº“ 5. ä½¿ç”¨SolrJç®¡ç†ç´¢å¼•åº“ 6. ä»€ä¹ˆæ˜¯SolrCloud 7. Solré›†ç¾¤çš„ç³»ç»Ÿæ¶æ„ 8. éœ€è¦å®ç°çš„solré›†ç¾¤æ¶æ„ 9. solrcloudçš„æ­å»º 1. solrä»‹ç» Solræ˜¯Apacheä¸‹çš„ä¸€ä¸ªé¡¶çº§å¼€æºé¡¹ç›®ï¼Œå®ƒæ˜¯åŸºäºLu...",
      "content_html": "<p>solr</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-solr%E4%BB%8B%E7%BB%8D\">1. solrä»‹ç»</a></li>\n<li><a href=\"#2-solr%E4%B8%8Elucene%E7%9A%84%E5%8C%BA%E5%88%AB\">2. Solrä¸Luceneçš„åŒºåˆ«</a></li>\n<li><a href=\"#3-solr%E5%AE%89%E8%A3%85%E5%8F%8A%E9%85%8D%E7%BD%AE\">3. Solrå®‰è£…åŠé…ç½®</a></li>\n<li><a href=\"#4-solr%E7%AE%A1%E7%90%86%E7%B4%A2%E5%BC%95%E5%BA%93\">4. Solrç®¡ç†ç´¢å¼•åº“</a></li>\n<li><a href=\"#5-%E4%BD%BF%E7%94%A8solrj%E7%AE%A1%E7%90%86%E7%B4%A2%E5%BC%95%E5%BA%93\">5. ä½¿ç”¨SolrJç®¡ç†ç´¢å¼•åº“</a></li>\n<li><a href=\"#6-%E4%BB%80%E4%B9%88%E6%98%AFsolrcloud\">6. ä»€ä¹ˆæ˜¯SolrCloud</a></li>\n<li><a href=\"#7-solr%E9%9B%86%E7%BE%A4%E7%9A%84%E7%B3%BB%E7%BB%9F%E6%9E%B6%E6%9E%84\">7. Solré›†ç¾¤çš„ç³»ç»Ÿæ¶æ„</a></li>\n<li><a href=\"#8-%E9%9C%80%E8%A6%81%E5%AE%9E%E7%8E%B0%E7%9A%84solr%E9%9B%86%E7%BE%A4%E6%9E%B6%E6%9E%84\">8. éœ€è¦å®ç°çš„solré›†ç¾¤æ¶æ„</a></li>\n<li><a href=\"#9-solrcloud%E7%9A%84%E6%90%AD%E5%BB%BA\">9. solrcloudçš„æ­å»º</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. solrä»‹ç»</h1>\n<ul>\n<li>Solræ˜¯Apacheä¸‹çš„ä¸€ä¸ªé¡¶çº§å¼€æºé¡¹ç›®ï¼Œå®ƒæ˜¯åŸºäºLuceneçš„å…¨æ–‡æœç´¢æœåŠ¡å™¨ã€‚Solræä¾›äº†æ¯”Luceneæ›´ä¸ºä¸°å¯Œçš„æŸ¥è¯¢è¯­è¨€ï¼Œ<br>\nåŒæ—¶å®ç°äº†å¯é…ç½®ã€å¯æ‰©å±•ï¼Œå¹¶å¯¹ç´¢å¼•ã€æœç´¢æ€§èƒ½è¿›è¡Œäº†ä¼˜åŒ–ã€‚</li>\n<li>Solrå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œè¿è¡Œåœ¨Jettyã€Tomcatç­‰è¿™äº›Servletå®¹å™¨ä¸­</li>\n<li>Solrç”¨ POST æ–¹æ³•å‘ Solr æœåŠ¡å™¨å‘é€ä¸€ä¸ªæè¿° Field åŠå…¶å†…å®¹çš„ XML æ–‡æ¡£ï¼ŒSolræ ¹æ®xmlæ–‡æ¡£æ·»åŠ ã€åˆ é™¤ã€æ›´æ–°ç´¢å¼• ã€‚</li>\n<li>Solr æœç´¢åªéœ€è¦å‘é€ HTTP GET è¯·æ±‚ï¼Œç„¶åå¯¹ Solr è¿”å›Xmlã€jsonç­‰æ ¼å¼çš„æŸ¥è¯¢ç»“æœè¿›è¡Œè§£æï¼Œç»„ç»‡é¡µé¢å¸ƒå±€ã€‚</li>\n<li>Solrä¸æä¾›æ„å»ºUIçš„åŠŸèƒ½ï¼ŒSolræä¾›äº†ä¸€ä¸ªç®¡ç†ç•Œé¢ï¼Œé€šè¿‡ç®¡ç†ç•Œé¢å¯ä»¥æŸ¥è¯¢Solrçš„é…ç½®å’Œè¿è¡Œæƒ…å†µã€‚</li>\n</ul>\n<h1>2. Solrä¸Luceneçš„åŒºåˆ«</h1>\n<ul>\n<li>Luceneæ˜¯ä¸€ä¸ªå¼€æ”¾æºä»£ç çš„å…¨æ–‡æ£€ç´¢å¼•æ“å·¥å…·åŒ…ï¼Œå®ƒä¸æ˜¯ä¸€ä¸ªå®Œæ•´çš„å…¨æ–‡æ£€ç´¢å¼•æ“ï¼ŒLuceneæä¾›äº†å®Œæ•´çš„æŸ¥è¯¢å¼•æ“å’Œç´¢å¼•å¼•æ“ï¼Œç›®çš„æ˜¯ä¸ºè½¯ä»¶å¼€å‘äººå‘˜æä¾›ä¸€ä¸ªç®€å•æ˜“ç”¨çš„å·¥å…·åŒ…ï¼Œä»¥æ–¹ä¾¿çš„åœ¨ç›®æ ‡ç³»ç»Ÿä¸­å®ç°å…¨æ–‡æ£€ç´¢çš„åŠŸèƒ½ï¼Œæˆ–è€…ä»¥Luceneä¸ºåŸºç¡€æ„å»ºå…¨æ–‡æ£€ç´¢å¼•æ“ã€‚</li>\n<li>Solrçš„ç›®æ ‡æ˜¯æ‰“é€ ä¸€æ¬¾ä¼ä¸šçº§çš„æœç´¢å¼•æ“ç³»ç»Ÿï¼Œå®ƒæ˜¯ä¸€ä¸ªæœç´¢å¼•æ“æœåŠ¡ï¼Œå¯ä»¥ç‹¬ç«‹è¿è¡Œï¼Œé€šè¿‡Solrå¯ä»¥éå¸¸å¿«é€Ÿçš„æ„å»ºä¼ä¸šçš„æœç´¢å¼•æ“ï¼Œé€šè¿‡Solrä¹Ÿå¯ä»¥é«˜æ•ˆçš„å®Œæˆç«™å†…æœç´¢åŠŸèƒ½ã€‚</li>\n</ul>\n<h1>3. Solrå®‰è£…åŠé…ç½®</h1>\n<ul>\n<li>ä»Solrå®˜æ–¹ç½‘ç«™ï¼ˆ<a href=\"http://lucene.apache.org/solr/\" target=\"_blank\" rel=\"noopener noreferrer\">http://lucene.apache.org/solr/</a> ï¼‰ä¸‹è½½Solr4.10.3ï¼Œæ ¹æ®Solrçš„è¿è¡Œç¯å¢ƒï¼ŒLinuxä¸‹éœ€è¦ä¸‹è½½lucene-4.10.3.tgzï¼Œwindowsä¸‹éœ€è¦ä¸‹è½½lucene-4.10.3.zipã€‚</li>\n<li>Solrä½¿ç”¨æŒ‡å—å¯å‚è€ƒï¼š<a href=\"https://wiki.apache.org/solr/FrontPage\" target=\"_blank\" rel=\"noopener noreferrer\">https://wiki.apache.org/solr/FrontPage</a></li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>Solrçš„æ–‡ä»¶å¤¹ç»“æ„\n\tbinï¼šsolrçš„è¿è¡Œè„šæœ¬\n\tcontribï¼šsolrçš„ä¸€äº›è´¡çŒ®è½¯ä»¶/æ’ä»¶ï¼Œç”¨äºå¢å¼ºsolrçš„åŠŸèƒ½ã€‚\n\tdistï¼šè¯¥ç›®å½•åŒ…å«buildè¿‡ç¨‹ä¸­äº§ç”Ÿçš„warå’Œjaræ–‡ä»¶ï¼Œä»¥åŠç›¸å…³çš„ä¾èµ–æ–‡ä»¶ã€‚\n\tdocsï¼šsolrçš„APIæ–‡æ¡£\n\tlicensesï¼šsolrç›¸å…³çš„ä¸€äº›è®¸å¯ä¿¡æ¯\n\texampleï¼šsolrå·¥ç¨‹çš„ä¾‹å­ç›®å½•ï¼š\n\t\texample/solrï¼šåŒ…å«äº†é»˜è®¤é…ç½®ä¿¡æ¯çš„Solr homeç›®å½•(Solrè¿è¡Œçš„ä¸»ç›®å½•,åŒ…æ‹¬äº†è¿è¡ŒSolrå®ä¾‹æ‰€æœ‰çš„é…ç½®æ–‡ä»¶å’Œæ•°æ®æ–‡ä»¶)ã€‚\n\t\tä¸€ä¸ªSolrHomeå¯ä»¥åŒ…æ‹¬å¤šä¸ªSolrCoreï¼ˆSolrå®ä¾‹ï¼‰ï¼Œæ¯ä¸ªSolrCoreæä¾›å•ç‹¬çš„æœç´¢å’Œç´¢å¼•æœåŠ¡ã€‚\n\t\t\texample/solr/collection1åŒ…å«äº†ä¸€ä¸ªsolr Coreå®ä¾‹ç›®å½•\n\t\t\t\tSolrCoreåç§°ä¸å›ºå®šï¼Œä¸€ä¸ªsolrè¿è¡Œå®ä¾‹å¯¹å¤–å•ç‹¬æä¾›ç´¢å¼•å’Œæœç´¢æ¥å£å’Œä¸€ä¸ªç´¢å¼•ç›®å½•ã€‚\n\t\t\t\tä¸€ä¸ªsolrcoreç›¸å½“äºmysqlä¸­ä¸€ä¸ªæ•°æ®åº“ã€‚Solrcoreä¹‹é—´æ˜¯ç›¸äº’éš”ç¦»ã€‚\n\t\t\t\tä¸€ä¸ªSolrå·¥ç¨‹å¯ä»¥è¿è¡Œå¤šä¸ªSolrCoreï¼ˆSolrå®ä¾‹ï¼‰ï¼Œä¸€ä¸ªCoreå¯¹åº”ä¸€ä¸ªç´¢å¼•ç›®å½•ã€‚\n\t\t\texample/solr/collection1/data è¯¥ç›®å½•å­˜æ”¾ç´¢å¼•æ–‡ä»¶éœ€è¦åˆ›å»º\n\t\t\texample/solr/collection1/core.propertiesé…ç½®solrcoreå®ä¾‹åå­—\n\t\t\t\texample/solr/collection1/conf/solrconfig.xmlé…ç½®å®ä¾‹çš„ç›¸å…³ä¿¡æ¯\n\t\t\t\texample/solr/collection1/conf/schema.xmlé…ç½®ä¸­æ–‡åˆ†æå™¨ï¼Œå®šä¹‰ç´¢å¼•æ•°æ®ç±»å‹\n\t\t\texample/solr/solr.xml\n\t\t\texample/solr/zoo.cfg\n\t\texample/multicoreï¼šè¯¥ç›®å½•åŒ…å«äº†åœ¨Solrçš„multicoreä¸­è®¾ç½®çš„å¤šä¸ªCoreç›®å½•ã€‚ \n\t\texample/webapps/solr.warï¼šè¯¥ç›®å½•ä¸­åŒ…æ‹¬ä¸€ä¸ªsolr.warï¼Œè¯¥warå¯ä½œä¸ºsolrçš„è¿è¡Œå®ä¾‹å·¥ç¨‹ã€‚\n\t\t\texample/webapps/solr.war/web.xmlé…ç½®äº†solrhomeçš„ä½ç½®\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>solrçš„å®‰è£…\t\n\tsolr éœ€è¦è¿è¡Œåœ¨ä¸€ä¸ªServletå®¹å™¨ä¸­ï¼ŒSolr4.10.3è¦æ±‚jdkä½¿ç”¨1.7ä»¥ä¸Šï¼ŒSolré»˜è®¤æä¾›Jetty\n\tâ‘ å°†solr.warè§£å‹åˆ°tomcatçš„webappç›®å½•ä¸­\n\tâ‘¡æŠŠ\\solr-4.10.3\\example\\lib\\extç›®å½•ä¸‹çš„æ‰€æœ‰çš„jaråŒ…æ·»åŠ åˆ°solrå·¥ç¨‹ä¸­çš„libæ–‡ä»¶å¤¹ä¸‹\n\tcp * /usr/local/solr/tomcat/webapps/solr/WEB-INF/lib/\n\tâ‘¢é…ç½®solrHomeå’ŒsolrCoreã€‚æŠŠ\\solr-4.10.3\\example\\solræ–‡ä»¶å¤¹å¤åˆ¶å¹¶é‡å‘½åä¸ºsolrhome(æ›´å®¹æ˜“ç†è§£)\n\t\tXmlçš„é…ç½®ä¿¡æ¯ï¼š\n\t\tLibï¼šsolræœåŠ¡ä¾èµ–çš„æ‰©å±•åŒ…ï¼Œé»˜è®¤çš„è·¯å¾„æ˜¯collection1\\libæ–‡ä»¶å¤¹ï¼Œå¦‚æœæ²¡æœ‰å°±åˆ›å»ºä¸€ä¸ª\n\t\tdataDirï¼šé…ç½®äº†ç´¢å¼•åº“çš„å­˜æ”¾è·¯å¾„ã€‚é»˜è®¤è·¯å¾„æ˜¯collection1\\dataæ–‡ä»¶å¤¹ï¼Œå¦‚æœæ²¡æœ‰dataæ–‡ä»¶å¤¹ï¼Œä¼šè‡ªåŠ¨åˆ›å»ºã€‚\n\t\trequestHandlerï¼š\n\t\tæŸ¥è¯¢æ—¶ç”¨urlï¼šname=\"/select\"\n\t\t&lt;requestHandler name=\"/select\" class=\"solr.SearchHandler\"&gt;\n\t\t\t&lt;lst name=\"defaults\"&gt;\n\t\t\t&lt;str name=\"echoParams\"&gt;explicit&lt;/str&gt;\n\t\t\t&lt;int name=\"rows\"&gt;10&lt;/int&gt;\n\t\t\t&lt;str name=\"df\"&gt;text&lt;/str&gt;\n\t\t\t&lt;/lst&gt;\n\t\t&lt;/requestHandler&gt;\n\t\tç»´æŠ¤ç´¢å¼•æ—¶ç”¨urlï¼šname=\"/select\"\n\t\t&lt;requestHandler name=\"/update\" class=\"solr.UpdateRequestHandler\"&gt;\n\t\t\t&lt;!-- See below for information on defining\n\t\t\t\tupdateRequestProcessorChains that can be used by name\n\t\t\t\ton each Update Request\n\t\t\t--&gt;\n\t\t\t&lt;!--\n\t\t\t&lt;lst name=\"defaults\"&gt;\n\t\t\t\t&lt;str name=\"update.chain\"&gt;dedupe&lt;/str&gt;\n\t\t\t&lt;/lst&gt;\n\t\t\t--&gt;\n\t\t&lt;/requestHandler&gt;\n\tç¬¬å…­æ­¥ï¼šå‘Šè¯‰solræœåŠ¡å™¨é…ç½®æ–‡ä»¶ä¹Ÿå°±æ˜¯solrHomeçš„ä½ç½®ã€‚\n\tä¿®æ”¹solr.warçš„web.xmlä½¿ç”¨jndiçš„æ–¹å¼å‘Šè¯‰solræœåŠ¡å™¨ã€‚Solr/homeåç§°å¿…é¡»æ˜¯å›ºå®šçš„ã€‚\n\t&lt;env-entry&gt;\n       &lt;env-entry-name&gt;solr/home&lt;/env-entry-name&gt;\n       &lt;env-entry-value&gt;/put/your/solr/home/here&lt;/env-entry-value&gt;\n       &lt;env-entry-type&gt;java.lang.String&lt;/env-entry-type&gt;\n    &lt;/env-entry&gt;\n\n\tç¬¬ä¸ƒæ­¥ï¼šå¯åŠ¨tomcat\n\tç¬¬å…«æ­¥ï¼šè®¿é—®http://localhost:8080/solr/\n\n\tSolråå°ç®¡ç†\n\tSolr Core æ˜¯Solrçš„ä¸€ä¸ªç‹¬ç«‹è¿è¡Œå®ä¾‹å•ä½ï¼Œå®ƒå¯ä»¥å¯¹å¤–æä¾›ç´¢å¼•å’Œæœç´¢æœåŠ¡ï¼Œ\n\tæ·»åŠ solrcoreï¼š\n\tç¬¬ä¸€æ­¥ï¼šå¤åˆ¶collection1æ”¹åä¸ºcollection2\n\tç¬¬äºŒæ­¥ï¼šä¿®æ”¹collectionæ–‡ä»¶å¤¹é‡Œçš„core.propertiesã€‚name=collection2\n\tç¬¬ä¸‰æ­¥ï¼šé‡å¯tomcat\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é…ç½®ä¸­æ–‡åˆ†æå™¨\n\tSchema.xmlåœ¨SolrCoreçš„confç›®å½•ä¸‹ï¼Œå®ƒæ˜¯Solræ•°æ®è¡¨é…ç½®æ–‡ä»¶ï¼Œå®ƒå®šä¹‰äº†åŠ å…¥ç´¢å¼•çš„æ•°æ®çš„æ•°æ®ç±»å‹çš„ã€‚\n\tä¸»è¦åŒ…æ‹¬FieldTypesã€Fieldså’Œå…¶ä»–çš„ä¸€äº›ç¼ºçœè®¾ç½®ã€‚\n\t\n\tFieldTypeåŸŸç±»å‹å®šä¹‰\n\ttext_generalæ˜¯Solré»˜è®¤æä¾›çš„FieldTypeï¼Œé€šè¿‡å®ƒè¯´æ˜FieldTypeå®šä¹‰çš„å†…å®¹:\n\t&lt;fieldType name=\"text_general\" class=\"solr.TextField\" positionIncrementGap=\"100\"&gt;\n\t\t&lt;!--nameï¼šæ˜¯è¿™ä¸ªFieldTypeçš„åç§°\n\t\tclassï¼šæ˜¯Solræä¾›çš„åŒ…solr.TextFieldï¼Œsolr.TextField å…è®¸ç”¨æˆ·é€šè¿‡åˆ†æå™¨æ¥å®šåˆ¶ç´¢å¼•å’ŒæŸ¥è¯¢ï¼Œåˆ†æå™¨åŒ…æ‹¬ä¸€ä¸ªåˆ†è¯å™¨ï¼ˆtokenizerï¼‰å’Œå¤šä¸ªè¿‡æ»¤å™¨ï¼ˆfilterï¼‰\n\t\tpositionIncrementGapï¼šå¯é€‰å±æ€§ï¼Œå®šä¹‰åœ¨åŒä¸€ä¸ªæ–‡æ¡£ä¸­æ­¤ç±»å‹æ•°æ®çš„ç©ºç™½é—´éš”ï¼Œé¿å…çŸ­è¯­åŒ¹é…é”™è¯¯ï¼Œæ­¤å€¼ç›¸å½“äºLuceneçš„çŸ­è¯­æŸ¥è¯¢è®¾ç½®slopå€¼ï¼Œæ ¹æ®ç»éªŒè®¾ç½®ä¸º100ã€‚--&gt;\n      &lt;analyzer type=\"index\"&gt;\n        &lt;tokenizer class=\"solr.StandardTokenizerFactory\"/&gt;\n        &lt;filter class=\"solr.StopFilterFactory\" ignoreCase=\"true\" words=\"stopwords.txt\" /&gt;\n        &lt;!-- in this example, we will only use synonyms at query time\n        \t&lt;filter class=\"solr.SynonymFilterFactory\" synonyms=\"index_synonyms.txt\" ignoreCase=\"true\" expand=\"false\"/&gt;\n        --&gt;\n        &lt;filter class=\"solr.LowerCaseFilterFactory\"/&gt;\n      &lt;/analyzer&gt;\n      &lt;analyzer type=\"query\"&gt;\n\t  \t&lt;!--\n\t\tåœ¨FieldTypeå®šä¹‰çš„æ—¶å€™æœ€é‡è¦çš„å°±æ˜¯å®šä¹‰è¿™ä¸ªç±»å‹çš„æ•°æ®åœ¨å»ºç«‹ç´¢å¼•å’Œè¿›è¡ŒæŸ¥è¯¢çš„æ—¶å€™è¦ä½¿ç”¨çš„åˆ†æå™¨analyzer,åŒ…æ‹¬åˆ†è¯å’Œè¿‡æ»¤\n\t\tç´¢å¼•åˆ†æå™¨ä¸­ï¼šä½¿ç”¨solr.StandardTokenizerFactoryæ ‡å‡†åˆ†è¯å™¨ï¼Œsolr.StopFilterFactoryåœç”¨è¯è¿‡æ»¤å™¨ï¼Œsolr.LowerCaseFilterFactoryå°å†™è¿‡æ»¤å™¨ã€‚\n\t\tæœç´¢åˆ†æå™¨ä¸­ï¼šä½¿ç”¨solr.StandardTokenizerFactoryæ ‡å‡†åˆ†è¯å™¨ï¼Œsolr.StopFilterFactoryåœç”¨è¯è¿‡æ»¤å™¨ï¼Œè¿™é‡Œè¿˜ç”¨åˆ°äº†solr.SynonymFilterFactoryåŒä¹‰è¯è¿‡æ»¤å™¨ã€‚\n\t\t--&gt;\n        &lt;tokenizer class=\"solr.StandardTokenizerFactory\"/&gt;\n        &lt;filter class=\"solr.StopFilterFactory\" ignoreCase=\"true\" words=\"stopwords.txt\" /&gt;\n        &lt;filter class=\"solr.SynonymFilterFactory\" synonyms=\"synonyms.txt\" ignoreCase=\"true\" expand=\"true\"/&gt;\n        &lt;filter class=\"solr.LowerCaseFilterFactory\"/&gt;\n      &lt;/analyzer&gt;\n    &lt;/fieldType&gt;\n\n\tFieldå®šä¹‰\n\t&lt;!--filedå®šä¹‰åŒ…æ‹¬name,typeï¼ˆä¸ºä¹‹å‰å®šä¹‰è¿‡çš„å„ç§FieldTypeï¼‰,indexedï¼ˆæ˜¯å¦è¢«ç´¢å¼•ï¼‰,\n\tstoredï¼ˆæ˜¯å¦è¢«å‚¨å­˜ï¼‰ï¼ŒmultiValuedï¼ˆæ˜¯å¦å­˜å‚¨å¤šä¸ªå€¼ï¼‰ç­‰å±æ€§ã€‚\n\tmultiValuedï¼šè¯¥Fieldå¦‚æœè¦å­˜å‚¨å¤šä¸ªå€¼æ—¶è®¾ç½®ä¸ºtrueï¼Œsolrå…è®¸ä¸€ä¸ªFieldå­˜å‚¨å¤šä¸ªå€¼ï¼Œ\n\tæ¯”å¦‚å­˜å‚¨ä¸€ä¸ªç”¨æˆ·çš„å¥½å‹idï¼ˆå¤šä¸ªï¼‰ï¼Œå•†å“çš„å›¾ç‰‡ï¼ˆå¤šä¸ªï¼Œå¤§å›¾å’Œå°å›¾ï¼‰ï¼Œé€šè¿‡ä½¿ç”¨solræŸ¥è¯¢è¦çœ‹å‡ºè¿”å›ç»™å®¢æˆ·ç«¯æ˜¯æ•°ç»„ï¼š--&gt;\n\t&lt;field name=\"name\" type=\"text_general\" indexed=\"true\" stored=\"true\"/&gt;\n\t&lt;field name=\"features\" type=\"text_general\" indexed=\"true\" stored=\"true\" multiValued=\"true\"/&gt;\n\t\n\t\n\t&lt;!--uniqueKey Solrä¸­é»˜è®¤å®šä¹‰å”¯ä¸€ä¸»é”®keyä¸ºidåŸŸï¼Œ\n\tSolråœ¨åˆ é™¤ã€æ›´æ–°ç´¢å¼•æ—¶ä½¿ç”¨idåŸŸè¿›è¡Œåˆ¤æ–­ï¼Œä¹Ÿå¯ä»¥è‡ªå®šä¹‰å”¯ä¸€ä¸»é”®ã€‚æ³¨æ„åœ¨åˆ›å»ºç´¢å¼•æ—¶å¿…é¡»æŒ‡å®šå”¯ä¸€çº¦æŸã€‚--&gt;\n\t&lt;uniqueKey&gt;id&lt;/uniqueKey&gt;\n\t\n\t\n\tcopyFieldå¤åˆ¶åŸŸ\n\t&lt;!--copyFieldå¤åˆ¶åŸŸï¼Œå¯ä»¥å°†å¤šä¸ªFieldå¤åˆ¶åˆ°ä¸€ä¸ªFieldä¸­ï¼Œä»¥ä¾¿è¿›è¡Œç»Ÿä¸€çš„æ£€ç´¢ï¼š\n\tæ ¹æ®å…³é”®å­—åªæœç´¢textåŸŸçš„å†…å®¹å°±ç›¸å½“äºæœç´¢titleå’Œcontentï¼Œå°†titleå’Œcontentå¤åˆ¶åˆ°textä¸­ï¼Œå¦‚ä¸‹ï¼š--&gt;\n\t&lt;field name=\"title\" type=\"text_general\" indexed=\"true\" stored=\"true\" multiValued=\"true\"/&gt;\n\t&lt;field name=\"content\" type=\"text_general\" indexed=\"false\" stored=\"true\" multiValued=\"true\"/&gt;\n\t&lt;field name=\"text\" type=\"text_general\" indexed=\"true\" stored=\"false\" multiValued=\"true\"/&gt;\n\t&lt;copyField source=\"title\" dest=\"text\"/&gt;\n\t&lt;copyField source=\"content\" dest=\"text\"/&gt;\n\t\n\tdynamicFieldï¼ˆåŠ¨æ€å­—æ®µï¼‰\n\t&lt;!--åŠ¨æ€å­—æ®µå°±æ˜¯ä¸ç”¨æŒ‡å®šå…·ä½“çš„åç§°ï¼Œåªè¦å®šä¹‰å­—æ®µåç§°çš„è§„åˆ™ï¼Œä¾‹å¦‚å®šä¹‰ä¸€ä¸ª dynamicFieldï¼Œname ä¸º*_iï¼Œ\n\tå®šä¹‰å®ƒçš„typeä¸ºtextï¼Œé‚£ä¹ˆåœ¨ä½¿ç”¨è¿™ä¸ªå­—æ®µçš„æ—¶å€™ï¼Œä»»ä½•ä»¥_iç»“å°¾çš„å­—æ®µéƒ½è¢«è®¤ä¸ºæ˜¯ç¬¦åˆè¿™ä¸ªå®šä¹‰çš„ï¼Œ\n\tä¾‹å¦‚ï¼šname_iï¼Œgender_iï¼Œschool_iç­‰ã€‚--&gt;\n\t&lt;dynamicField name=\"*_i\"  type=\"int\"    indexed=\"true\"  stored=\"true\"/&gt;\n\n\tå®‰è£…ä¸­æ–‡åˆ†è¯å™¨\n\tä½¿ç”¨IKAnalyzerä¸­æ–‡åˆ†æå™¨\n\tç¬¬ä¸€æ­¥ï¼šæŠŠIKAnalyzer2012FF_u1.jaræ·»åŠ åˆ°solr/WEB-INF/libç›®å½•ä¸‹ã€‚\n\tç¬¬äºŒæ­¥ï¼šå¤åˆ¶IKAnalyzerçš„é…ç½®æ–‡ä»¶\tIKAnalyzer.cfg.xmlå’Œè‡ªå®šä¹‰è¯å…¸ext.dic;å’Œåœç”¨è¯è¯å…¸stopword.dic;åˆ°solrçš„classpathä¸‹ã€‚\n\tç¬¬ä¸‰æ­¥ï¼šåœ¨schema.xmlä¸­æ·»åŠ ä¸€ä¸ªè‡ªå®šä¹‰çš„fieldTypeï¼Œä½¿ç”¨ä¸­æ–‡åˆ†æå™¨ã€‚\n\t&lt;!-- IKAnalyzer--&gt;\n\t&lt;fieldType name=\"text_ik\" class=\"solr.TextField\"&gt;\n\t\t&lt;analyzer class=\"org.wltea.analyzer.lucene.IKAnalyzer\"/&gt;\n\t&lt;/fieldType&gt;\n\n\tç¬¬å››æ­¥ï¼šå®šä¹‰fieldï¼ŒæŒ‡å®šfieldçš„typeå±æ€§ä¸ºtext_ik\n\t&lt;!--IKAnalyzer Field--&gt;\n\t&lt;field name=\"title_ik\" type=\"text_ik\" indexed=\"true\" stored=\"true\" /&gt;\n\t&lt;field name=\"content_ik\" type=\"text_ik\" indexed=\"true\" stored=\"false\" multiValued=\"true\"/&gt;\n\n\tç¬¬å››æ­¥ï¼šé‡å¯tomcat\n</code></pre></div><h1>4. Solrç®¡ç†ç´¢å¼•åº“</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tç»´æŠ¤ç´¢å¼•\n\tæ·»åŠ /æ›´æ–°å•ä¸ªæ–‡æ¡£(é€šè¿‡ç®¡ç†åå°æ·»åŠ )\n\t\n\tæ‰¹é‡å¯¼å…¥æ•°æ®\n\tä½¿ç”¨dataimportæ’ä»¶æ‰¹é‡å¯¼å…¥æ•°æ®ã€‚\n\tç¬¬ä¸€æ­¥ï¼šæŠŠdataimportæ’ä»¶ä¾èµ–çš„jaråŒ…æ·»åŠ åˆ°solrcoreï¼ˆcollection1\\libï¼‰ä¸­ï¼Œè¿˜éœ€è¦mysqlçš„æ•°æ®åº“é©±åŠ¨ã€‚\n\tç¬¬äºŒæ­¥ï¼šé…ç½®solrconfig.xmlæ–‡ä»¶ï¼Œæ·»åŠ ä¸€ä¸ªrequestHandlerã€‚\n\t&lt;requestHandler name=\"/dataimport\" class=\"org.apache.solr.handler.dataimport.DataImportHandler\"&gt;\n\t\t&lt;lst name=\"defaults\"&gt;\n\t\t\t&lt;str name=\"config\"&gt;data-config.xml&lt;/str&gt;\n\t\t&lt;/lst&gt;\n\t&lt;/requestHandler&gt;\n\tç¬¬ä¸‰æ­¥ï¼šåˆ›å»ºä¸€ä¸ªdata-config.xmlï¼Œä¿å­˜åˆ°collection1\\conf\\ç›®å½•ä¸‹\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\" ?&gt;  \n\t&lt;dataConfig&gt;   \n\t\t&lt;dataSource type=\"JdbcDataSource\"   \n\t\t\tdriver=\"com.mysql.jdbc.Driver\"   \n\t\t\turl=\"jdbc:mysql://localhost:3306/lucene\"   \n\t\t\tuser=\"root\"   \n\t\t\tpassword=\"root\"/&gt;   \n\t\t&lt;document&gt;   \n\t\t&lt;entity name=\"product\" query=\"SELECT pid,name,catalog_name,price,description,picture FROM products \"&gt;\n\t\t\t&lt;field column=\"pid\" name=\"id\"/&gt; \n\t\t\t&lt;field column=\"name\" name=\"product_name\"/&gt; \n\t\t\t&lt;field column=\"catalog_name\" name=\"product_catalog_name\"/&gt; \n\t\t\t&lt;field column=\"price\" name=\"product_price\"/&gt; \n\t\t\t&lt;field column=\"description\" name=\"product_description\"/&gt; \n\t\t\t&lt;field column=\"picture\" name=\"product_picture\"/&gt; \n\t\t&lt;/entity&gt;   \n\t\t&lt;/document&gt;\n\t&lt;/dataConfig&gt;\n\n\tç¬¬å››æ­¥ï¼šé‡å¯tomcat\n\tç¬¬äº”æ­¥ï¼šåœ¨ç®¡ç†åå°ç‚¹å‡»â€œexecuteâ€æŒ‰é’®å¯¼å…¥æ•°æ®\n\n\tåˆ°å…¥æ•°æ®å‰ä¼šå…ˆæ¸…ç©ºç´¢å¼•åº“ï¼Œç„¶åå†å¯¼å…¥ã€‚\n\t\n\tåˆ é™¤æ–‡æ¡£\n\tåˆ é™¤åˆ¶å®šIDçš„ç´¢å¼• \n\t&lt;delete&gt;\n\t\t&lt;id&gt;8&lt;/id&gt;\n\t&lt;/delete&gt;\n\t&lt;commit/&gt;\n\tåˆ é™¤æŸ¥è¯¢åˆ°çš„ç´¢å¼•æ•°æ® \n\t&lt;delete&gt;\n\t\t&lt;query&gt;product_catalog_name:å¹½é»˜æ‚è´§&lt;/query&gt;\n\t&lt;/delete&gt;\n\t&lt;commit/&gt;\n\tåˆ é™¤æ‰€æœ‰ç´¢å¼•æ•°æ®\n\t&lt;delete&gt;\n\t\t&lt;query&gt;*:*&lt;/query&gt;\n\t&lt;/delete&gt;\n\t\n\tæŸ¥è¯¢ç´¢å¼•\n\té€šè¿‡/selectæœç´¢ç´¢å¼•ï¼ŒSolråˆ¶å®šä¸€äº›å‚æ•°å®Œæˆä¸åŒéœ€æ±‚çš„æœç´¢ï¼š\n\t1.q - æŸ¥è¯¢å­—ç¬¦ä¸²ï¼Œå¿…é¡»çš„ï¼Œå¦‚æœæŸ¥è¯¢æ‰€æœ‰ä½¿ç”¨*:*ã€‚\n\t2.fq - ï¼ˆfilter queryï¼‰è¿‡è™‘æŸ¥è¯¢ï¼Œä½œç”¨ï¼šåœ¨qæŸ¥è¯¢ç¬¦åˆç»“æœä¸­åŒæ—¶æ˜¯fqæŸ¥è¯¢ç¬¦åˆçš„ï¼Œä¾‹å¦‚ï¼šï¼š\n\tè¿‡æ»¤æŸ¥è¯¢ä»·æ ¼ä»1åˆ°20çš„è®°å½•ã€‚product_price:[1 TO 20]\n\tä¹Ÿå¯ä»¥åœ¨â€œqâ€æŸ¥è¯¢æ¡ä»¶ä¸­ä½¿ç”¨product_price:[1 TO 20]\n\tä½¿ç”¨â€œ*â€è¡¨ç¤ºæ— é™ï¼Œä¾‹å¦‚ï¼š20ä»¥ä¸Šï¼šproduct_price:[20 TO *]20ä»¥ä¸‹ï¼šproduct_price:[* TO 20]\n\t3.sort - æ’åºï¼Œæ ¼å¼ï¼šsort=&lt;field name&gt;+&lt;desc|asc&gt;[,&lt;field name&gt;+&lt;desc|asc&gt;]â€¦ ã€‚ç¤ºä¾‹ï¼š \n\tæŒ‰ä»·æ ¼é™åº\n\t4.start - åˆ†é¡µæ˜¾ç¤ºä½¿ç”¨ï¼Œå¼€å§‹è®°å½•ä¸‹æ ‡ï¼Œä»0å¼€å§‹ \n\t5.rows - æŒ‡å®šè¿”å›ç»“æœæœ€å¤šæœ‰å¤šå°‘æ¡è®°å½•ï¼Œé…åˆstartæ¥å®ç°åˆ†é¡µã€‚\n\t6.fl - æŒ‡å®šè¿”å›é‚£äº›å­—æ®µå†…å®¹ï¼Œç”¨é€—å·æˆ–ç©ºæ ¼åˆ†éš”å¤šä¸ªã€‚\n\t7.df-æŒ‡å®šä¸€ä¸ªé»˜è®¤æœç´¢Field\n\tä¹Ÿå¯ä»¥åœ¨SolrCoreç›®å½• ä¸­conf/solrconfig.xmlæ–‡ä»¶ä¸­æŒ‡å®šé»˜è®¤æœç´¢Fieldï¼ŒæŒ‡å®šåå°±å¯ä»¥ç›´æ¥åœ¨â€œqâ€æŸ¥è¯¢æ¡ä»¶ä¸­è¾“å…¥å…³é”®å­—ã€‚\n\t&lt;requestHandler name=\"/select\" class=\"solr.SearchHandler\"&gt;\n    &lt;!-- default values for query parameters can be specified, these\n         will be overridden by parameters in the request\n      --&gt;\n     &lt;lst name=\"defaults\"&gt;\n       &lt;str name=\"echoParams\"&gt;explicit&lt;/str&gt;\n       &lt;int name=\"rows\"&gt;10&lt;/int&gt;\n       &lt;str name=\"df\"&gt;text&lt;/str&gt;\n     &lt;/lst&gt;\n\t&lt;/requestHandler&gt; \n\t8.wt - (writer type)æŒ‡å®šè¾“å‡ºæ ¼å¼ï¼Œå¯ä»¥æœ‰ xml, json, php, phps, \n\t9.hl æ˜¯å¦é«˜äº® ,è®¾ç½®é«˜äº®Fieldï¼Œè®¾ç½®æ ¼å¼å‰ç¼€å’Œåç¼€\n</code></pre></div><h1>5. ä½¿ç”¨SolrJç®¡ç†ç´¢å¼•åº“</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tsolrjæ˜¯è®¿é—®SolræœåŠ¡çš„javaå®¢æˆ·ç«¯ï¼Œæä¾›ç´¢å¼•å’Œæœç´¢çš„è¯·æ±‚æ–¹æ³•ï¼ŒSolrJé€šå¸¸åœ¨åµŒå…¥åœ¨ä¸šåŠ¡ç³»ç»Ÿä¸­ï¼Œé€šè¿‡SolrJçš„APIæ¥å£æ“ä½œSolræœåŠ¡ï¼Œ\n\n\tc)æ·»åŠ æ–‡æ¡£\n\tå®ç°æ­¥éª¤\n\tç¬¬ä¸€æ­¥ï¼šåˆ›å»ºä¸€ä¸ªjavaå·¥ç¨‹\n\tç¬¬äºŒæ­¥ï¼šå¯¼å…¥jaråŒ…ã€‚åŒ…æ‹¬solrJçš„jaråŒ…ã€‚è¿˜éœ€è¦\n\tç¬¬ä¸‰æ­¥ï¼šå’ŒSolræœåŠ¡å™¨å»ºç«‹è¿æ¥ã€‚HttpSolrServerå¯¹è±¡å»ºç«‹è¿æ¥ã€‚\n\tç¬¬å››æ­¥ï¼šåˆ›å»ºä¸€ä¸ªSolrInputDocumentå¯¹è±¡ï¼Œç„¶åæ·»åŠ åŸŸã€‚\n\tç¬¬äº”æ­¥ï¼šå°†SolrInputDocumentæ·»åŠ åˆ°ç´¢å¼•åº“ã€‚\n\tç¬¬å…­æ­¥ï¼šæäº¤ã€‚\n\t//å‘ç´¢å¼•åº“ä¸­æ·»åŠ ç´¢å¼•\n\t\t@Test\n\t\tpublic void addDocument() throws Exception {\n\t\t\t//å’ŒsolræœåŠ¡å™¨åˆ›å»ºè¿æ¥\n\t\t\t//å‚æ•°ï¼šsolræœåŠ¡å™¨çš„åœ°å€\n\t\t\tSolrServer solrServer = new HttpSolrServer(\"http://localhost:8080/solr/collection1\");\n\t\t\t//åˆ›å»ºä¸€ä¸ªæ–‡æ¡£å¯¹è±¡\n\t\t\tSolrInputDocument document = new SolrInputDocument();\n\t\t\t//å‘æ–‡æ¡£ä¸­æ·»åŠ åŸŸ\n\t\t\t//ç¬¬ä¸€ä¸ªå‚æ•°ï¼šåŸŸçš„åç§°ï¼ŒåŸŸçš„åç§°å¿…é¡»æ˜¯åœ¨schema.xmlä¸­å®šä¹‰çš„\n\t\t\t//ç¬¬äºŒä¸ªå‚æ•°ï¼šåŸŸçš„å€¼\n\t\t\tdocument.addField(\"id\", \"c0001\");\n\t\t\tdocument.addField(\"title_ik\", \"ä½¿ç”¨solrJæ·»åŠ çš„æ–‡æ¡£\");\n\t\t\tdocument.addField(\"content_ik\", \"æ–‡æ¡£çš„å†…å®¹\");\n\t\t\tdocument.addField(\"product_name\", \"å•†å“åç§°\");\n\t\t\t//æŠŠdocumentå¯¹è±¡æ·»åŠ åˆ°ç´¢å¼•åº“ä¸­\n\t\t\tsolrServer.add(document);\n\t\t\t//æäº¤ä¿®æ”¹\n\t\t\tsolrServer.commit();\t\t\n\t\t}\n\t//åˆ é™¤æ–‡æ¡£ï¼Œæ ¹æ®idåˆ é™¤\n\t\t@Test\n\t\tpublic void deleteDocumentByid() throws Exception {\n\t\t\t//åˆ›å»ºè¿æ¥\n\t\t\tSolrServer solrServer = new HttpSolrServer(\"http://localhost:8080/solr\");\n\t\t\t//æ ¹æ®idåˆ é™¤æ–‡æ¡£\n\t\t\tsolrServer.deleteById(\"c0001\");\n\t\t\t//æäº¤ä¿®æ”¹\n\t\t\tsolrServer.commit();\n\t\t}\n\n\tæŸ¥è¯¢è¯­æ³•å®Œå…¨æ”¯æŒLuceneçš„æŸ¥è¯¢è¯­æ³•ã€‚\n\t//æ ¹æ®æŸ¥è¯¢æ¡ä»¶åˆ é™¤æ–‡æ¡£\n\t\t@Test\n\t\tpublic void deleteDocumentByQuery() throws Exception {\n\t\t\t//åˆ›å»ºè¿æ¥\n\t\t\tSolrServer solrServer = new HttpSolrServer(\"http://localhost:8080/solr\");\n\t\t\t//æ ¹æ®æŸ¥è¯¢æ¡ä»¶åˆ é™¤æ–‡æ¡£\n\t\t\tsolrServer.deleteByQuery(\"*:*\");\n\t\t\t//æäº¤ä¿®æ”¹\n\t\t\tsolrServer.commit();\n\t\t}\n\n\n\tä¿®æ”¹æ–‡æ¡£\n\tåœ¨solrJä¸­ä¿®æ”¹æ²¡æœ‰å¯¹åº”çš„updateæ–¹æ³•ï¼Œåªæœ‰addæ–¹æ³•ï¼Œåªéœ€è¦æ·»åŠ ä¸€æ¡æ–°çš„æ–‡æ¡£ï¼Œ\n\tå’Œè¢«ä¿®æ”¹çš„æ–‡æ¡£idä¸€è‡´å°±å¯ä»¥ä¿®æ”¹äº†ã€‚æœ¬è´¨ä¸Šå°±æ˜¯å…ˆåˆ é™¤åæ·»åŠ ã€‚\n\n\tæŸ¥è¯¢æ–‡æ¡£\n\tç®€å•æŸ¥è¯¢\n\t//æŸ¥è¯¢ç´¢å¼•\n\t\t@Test\n\t\tpublic void queryIndex() throws Exception {\n\t\t\t//åˆ›å»ºè¿æ¥\n\t\t\tSolrServer solrServer = new HttpSolrServer(\"http://localhost:8080/solr\");\n\t\t\t//åˆ›å»ºä¸€ä¸ªqueryå¯¹è±¡\n\t\t\tSolrQuery query = new SolrQuery();\n\t\t\t//è®¾ç½®æŸ¥è¯¢æ¡ä»¶\n\t\t\tquery.setQuery(\"*:*\");\n\t\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\t\tQueryResponse queryResponse = solrServer.query(query);\n\t\t\t//å–æŸ¥è¯¢ç»“æœ\n\t\t\tSolrDocumentList solrDocumentList = queryResponse.getResults();\n\t\t\t//å…±æŸ¥è¯¢åˆ°å•†å“æ•°é‡\n\t\t\tSystem.out.println(\"å…±æŸ¥è¯¢åˆ°å•†å“æ•°é‡:\" + solrDocumentList.getNumFound());\n\t\t\t//éå†æŸ¥è¯¢çš„ç»“æœ\n\t\t\tfor (SolrDocument solrDocument : solrDocumentList) {\n\t\t\t\tSystem.out.println(solrDocument.get(\"id\"));\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_name\"));\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_price\"));\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_catalog_name\"));\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_picture\"));\n\t\t\t\t\n\t\t\t}\n\t\t}\n\n\tå¤æ‚æŸ¥è¯¢(æœ€å¥½ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼ï¼)\n\tå…¶ä¸­åŒ…å«æŸ¥è¯¢ã€è¿‡æ»¤ã€åˆ†é¡µã€æ’åºã€é«˜äº®æ˜¾ç¤ºç­‰å¤„ç†ã€‚\n\t//å¤æ‚æŸ¥è¯¢ç´¢å¼•\n\t\t@Test\n\t\tpublic void queryIndex2() throws Exception {\n\t\t\t//åˆ›å»ºè¿æ¥\n\t\t\tSolrServer solrServer = new HttpSolrServer(\"http://localhost:8080/solr\");\n\t\t\t//åˆ›å»ºä¸€ä¸ªqueryå¯¹è±¡\n\t\t\tSolrQuery query = new SolrQuery();\n\t\t\t//è®¾ç½®æŸ¥è¯¢æ¡ä»¶\n\t\t\tquery.setQuery(\"é’»çŸ³\");\n\t\t\t//è¿‡æ»¤æ¡ä»¶\n\t\t\tquery.setFilterQueries(\"product_catalog_name:å¹½é»˜æ‚è´§\");\n\t\t\t//æ’åºæ¡ä»¶\n\t\t\tquery.setSort(\"product_price\", ORDER.asc);\n\t\t\t//åˆ†é¡µå¤„ç†\n\t\t\tquery.setStart(0);\n\t\t\tquery.setRows(10);\n\t\t\t//ç»“æœä¸­åŸŸçš„åˆ—è¡¨\n\t\t\tquery.setFields(\"id\",\"product_name\",\"product_price\",\"product_catalog_name\",\"product_picture\");\n\t\t\t//è®¾ç½®é»˜è®¤æœç´¢åŸŸ\n\t\t\tquery.set(\"df\", \"product_keywords\");\n\t\t\t//é«˜äº®æ˜¾ç¤º\n\t\t\tquery.setHighlight(true);\n\t\t\t//é«˜äº®æ˜¾ç¤ºçš„åŸŸ\n\t\t\tquery.addHighlightField(\"product_name\");\n\t\t\t//é«˜äº®æ˜¾ç¤ºçš„å‰ç¼€\n\t\t\tquery.setHighlightSimplePre(\"&lt;em&gt;\");\n\t\t\t//é«˜äº®æ˜¾ç¤ºçš„åç¼€\n\t\t\tquery.setHighlightSimplePost(\"&lt;/em&gt;\");\n\t\t\t//æ‰§è¡ŒæŸ¥è¯¢\n\t\t\tQueryResponse queryResponse = solrServer.query(query);\n\t\t\t//å–æŸ¥è¯¢ç»“æœ\n\t\t\tSolrDocumentList solrDocumentList = queryResponse.getResults();\n\t\t\t//å…±æŸ¥è¯¢åˆ°å•†å“æ•°é‡\n\t\t\tSystem.out.println(\"å…±æŸ¥è¯¢åˆ°å•†å“æ•°é‡:\" + solrDocumentList.getNumFound());\n\t\t\t//éå†æŸ¥è¯¢çš„ç»“æœ\n\t\t\tfor (SolrDocument solrDocument : solrDocumentList) {\n\t\t\t\tSystem.out.println(solrDocument.get(\"id\"));\n\t\t\t\t//å–é«˜äº®æ˜¾ç¤º\n\t\t\t\tString productName = \"\";\n\t\t\t\tMap&lt;String, Map&lt;String, List&lt;String&gt;&gt;&gt; highlighting = queryResponse.getHighlighting();\n\t\t\t\tList&lt;String&gt; list = highlighting.get(solrDocument.get(\"id\")).get(\"product_name\");\n\t\t\t\t//åˆ¤æ–­æ˜¯å¦æœ‰é«˜äº®å†…å®¹\n\t\t\t\tif (null != list) {\n\t\t\t\t\tproductName = list.get(0);\n\t\t\t\t} else {\n\t\t\t\t\tproductName = (String) solrDocument.get(\"product_name\");\n\t\t\t\t}\n\t\t\t\t\n\t\t\t\tSystem.out.println(productName);\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_price\"));\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_catalog_name\"));\n\t\t\t\tSystem.out.println(solrDocument.get(\"product_picture\"));\n\t\t\t\t\n\t\t\t}\n\t\t}\n</code></pre></div><h1>6. ä»€ä¹ˆæ˜¯SolrCloud</h1>\n<ul>\n<li>SolrCloudæ˜¯Solræä¾›çš„åˆ†å¸ƒå¼æœç´¢æ–¹æ¡ˆï¼Œå½“ä½ éœ€è¦å¤§è§„æ¨¡ï¼Œå®¹é”™ï¼Œåˆ†å¸ƒå¼ç´¢å¼•å’Œæ£€ç´¢èƒ½åŠ›æ—¶ä½¿ç”¨ SolrCloudã€‚</li>\n<li>SolrCloudæ˜¯åŸºäºSolrå’ŒZookeeperçš„åˆ†å¸ƒå¼æœç´¢æ–¹æ¡ˆï¼Œå®ƒçš„ä¸»è¦æ€æƒ³æ˜¯ä½¿ç”¨Zookeeperä½œä¸ºé›†ç¾¤çš„é…ç½®ä¿¡æ¯ä¸­å¿ƒã€‚</li>\n<li>å®ƒæœ‰å‡ ä¸ªç‰¹è‰²åŠŸèƒ½ï¼š1ï¼‰é›†ä¸­å¼çš„é…ç½®ä¿¡æ¯2ï¼‰è‡ªåŠ¨å®¹é”™3ï¼‰è¿‘å®æ—¶æœç´¢4ï¼‰æŸ¥è¯¢æ—¶è‡ªåŠ¨è´Ÿè½½å‡è¡¡</li>\n</ul>\n<h1>7. Solré›†ç¾¤çš„ç³»ç»Ÿæ¶æ„</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/81aca86bd4364734e8d46.png\" alt=\"å›¾ç‰‡1.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡1.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ç‰©ç†ç»“æ„\nä¸‰ä¸ªSolrå®ä¾‹ï¼ˆ æ¯ä¸ªå®ä¾‹åŒ…æ‹¬ä¸¤ä¸ªCoreï¼‰ï¼Œç»„æˆä¸€ä¸ªSolrCloudã€‚\n\né€»è¾‘ç»“æ„\nç´¢å¼•é›†åˆåŒ…æ‹¬ä¸¤ä¸ªShardï¼ˆshard1å’Œshard2ï¼‰ï¼Œshard1å’Œshard2åˆ†åˆ«ç”±ä¸‰ä¸ªCoreç»„æˆï¼Œå…¶ä¸­ä¸€ä¸ªLeaderä¸¤ä¸ªReplicationï¼ŒLeaderæ˜¯ç”±zookeeperé€‰ä¸¾äº§ç”Ÿï¼Œ\nzookeeperæ§åˆ¶æ¯ä¸ªshardä¸Šä¸‰ä¸ªCoreçš„ç´¢å¼•æ•°æ®ä¸€è‡´ï¼Œè§£å†³é«˜å¯ç”¨é—®é¢˜ã€‚\nç”¨æˆ·å‘èµ·ç´¢å¼•è¯·æ±‚åˆ†åˆ«ä»shard1å’Œshard2ä¸Šè·å–ï¼Œè§£å†³é«˜å¹¶å‘é—®é¢˜ã€‚\n\t\ncollection\nCollectionåœ¨SolrCloudé›†ç¾¤ä¸­æ˜¯ä¸€ä¸ªé€»è¾‘æ„ä¹‰ä¸Šçš„å®Œæ•´çš„ç´¢å¼•ç»“æ„ã€‚å®ƒå¸¸å¸¸è¢«åˆ’åˆ†ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªShardï¼ˆåˆ†ç‰‡ï¼‰ï¼Œå®ƒä»¬ä½¿ç”¨ç›¸åŒçš„é…ç½®ä¿¡æ¯ã€‚\næ¯”å¦‚ï¼šé’ˆå¯¹å•†å“ä¿¡æ¯æœç´¢å¯ä»¥åˆ›å»ºä¸€ä¸ªcollectionã€‚\ncollection=shard1+shard2+....+shardX\nCore\næ¯ä¸ªCoreæ˜¯Solrä¸­ä¸€ä¸ªç‹¬ç«‹è¿è¡Œå•ä½ï¼Œæä¾› ç´¢å¼•å’Œæœç´¢æœåŠ¡ã€‚ä¸€ä¸ªshardéœ€è¦ç”±ä¸€ä¸ªCoreæˆ–å¤šä¸ªCoreç»„æˆã€‚ç”±äºcollectionç”±å¤šä¸ªshardç»„æˆæ‰€ä»¥collectionä¸€èˆ¬ç”±å¤šä¸ªcoreç»„æˆã€‚\nMasteræˆ–Slave\nMasteræ˜¯master-slaveç»“æ„ä¸­çš„ä¸»ç»“ç‚¹ï¼ˆé€šå¸¸è¯´ä¸»æœåŠ¡å™¨ï¼‰ï¼ŒSlaveæ˜¯master-slaveç»“æ„ä¸­çš„ä»ç»“ç‚¹ï¼ˆé€šå¸¸è¯´ä»æœåŠ¡å™¨æˆ–å¤‡æœåŠ¡å™¨ï¼‰ã€‚\nåŒä¸€ä¸ªShardä¸‹masterå’Œslaveå­˜å‚¨çš„æ•°æ®æ˜¯ä¸€è‡´çš„ï¼Œè¿™æ˜¯ä¸ºäº†è¾¾åˆ°é«˜å¯ç”¨ç›®çš„ã€‚\nShard\nCollectionçš„é€»è¾‘åˆ†ç‰‡ã€‚æ¯ä¸ªShardè¢«åŒ–æˆä¸€ä¸ªæˆ–è€…å¤šä¸ªreplicationï¼Œé€šè¿‡é€‰ä¸¾ç¡®å®šå“ªä¸ªæ˜¯Leaderã€‚\n</code></pre></div><h1>8. éœ€è¦å®ç°çš„solré›†ç¾¤æ¶æ„</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/6ede782b265996f3c120c.png\" alt=\"å›¾ç‰‡2.png\" tabindex=\"0\"><figcaption>å›¾ç‰‡2.png</figcaption></figure>\n<pre><code>Zookeeperä½œä¸ºé›†ç¾¤çš„ç®¡ç†å·¥å…·ã€‚\n1ã€é›†ç¾¤ç®¡ç†ï¼šå®¹é”™ã€è´Ÿè½½å‡è¡¡ã€‚\n2ã€é…ç½®æ–‡ä»¶çš„é›†ä¸­ç®¡ç†\n3ã€é›†ç¾¤çš„å…¥å£\néœ€è¦å®ç°zookeeper é«˜å¯ç”¨ã€‚éœ€è¦æ­å»ºé›†ç¾¤ã€‚å»ºè®®æ˜¯å¥‡æ•°èŠ‚ç‚¹ã€‚éœ€è¦ä¸‰ä¸ªzookeeperæœåŠ¡å™¨ã€‚\næ­å»ºsolré›†ç¾¤éœ€è¦7å°æœåŠ¡å™¨ã€‚\næ­å»ºä¼ªåˆ†å¸ƒå¼ï¼šéœ€è¦ä¸‰ä¸ªzookeeperèŠ‚ç‚¹éœ€è¦å››ä¸ªtomcatèŠ‚ç‚¹ã€‚å»ºè®®è™šæ‹Ÿæœºçš„å†…å®¹1Gä»¥ä¸Šã€‚\n</code></pre>\n<h1>9. solrcloudçš„æ­å»º</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tZookeeperé›†ç¾¤æ­å»º\n\n\t1ã€éœ€è¦å®‰è£…jdkç¯å¢ƒã€‚\n\t2ã€æŠŠzookeeperçš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°æœåŠ¡å™¨å¹¶è§£å‹ç¼©tar -zxvf zookeeper-3.4.6.tar.gzã€‚\n\t3ã€æŠŠzookeeperå¤åˆ¶ä¸‰ä»½ã€‚\n\t[root@localhost ~]# mkdir /usr/java/solr-cloud\n\t[root@localhost ~]# cp -r zookeeper-3.4.6 /usr/java/solr-cloud/zookeeper01\n\t[root@localhost ~]# cp -r zookeeper-3.4.6 /usr/java/solr-cloud/zookeeper02\n\t[root@localhost ~]# cp -r zookeeper-3.4.6 /usr/java/solr-cloud/zookeeper03\n\t4ã€åœ¨æ¯ä¸ªzookeeperç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªdataç›®å½•mkdir data\n\t5ã€åœ¨dataç›®å½•ä¸‹åˆ›å»ºä¸€ä¸ªmyidæ–‡ä»¶ï¼Œæ–‡ä»¶åå°±å«åšâ€œmyidâ€ã€‚å†…å®¹å°±æ˜¯æ¯ä¸ªå®ä¾‹çš„idã€‚ä¾‹å¦‚1ã€2ã€3\n\tvim data ç„¶åè¾“å…¥i è¾“å…¥1 è¾“å…¥esc è¾“å…¥ï¼šwq  ã€cat myid //æ£€æŸ¥myidçš„å†…å®¹1\n\t6ã€æ”¹é…ç½®æ–‡ä»¶ã€‚æŠŠconfç›®å½•ä¸‹çš„zoo_sample.cfgæ–‡ä»¶æ”¹åä¸ºzoo.cfgï¼Œæ¯ä¸ªä¸€æ ·é…ç½®ï¼\n\tcp zoo_sample.cfg zoo.cfg\n\tå°†datadir=æ”¹æˆdataæ–‡ä»¶å¤¹çš„åœ°å€\n\tä¿è¯clientPortä¸‰ä¸ªä¸å†²çª\n\tç„¶ååœ¨æœ€åä¸€è¡Œé…ç½®\n\tserver.1=192.168.25.135:2881:3881\n\tserver.2=192.168.25.135:2882:3882\n\tserver.3=192.168.25.135:2883:3883\n\t7ã€åˆ›å»ºå…¨éƒ¨å¯åŠ¨çš„è„šæœ¬ start-all.sh :vim start-all.sh\n\tcd zookeeper01/bin\n\t./zkServer.sh start\n\tcd ../../\n\tcd zookeeper02/bin\n\t./zkServer.sh start\n\tcd ../../\n\tcd zookeeper03/bin\n\t./zkServer.sh start\n\tcd ../../\n\t8ã€å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æˆæƒchmod u+x start-all.sh \n\t9ã€æŸ¥çœ‹zookeeperçš„çŠ¶æ€ä¸€ä¸ªleaderå…¶ä»–éƒ½æ˜¯follower zookeeper01/bin/zkServer.sh status\n\n\tUsing config: /usr/java/solr-cloud/zookeeper01/bin/../conf/zoo.cfg\n\tStopping zookeeper ... bin/zkServer.sh: ç¬¬ 143 è¡Œ:kill: (26838) - æ²¡æœ‰é‚£ä¸ªè¿›ç¨‹\n\tSTOPPED\n\tå¦‚æœå…³é—­zookeeperçš„æ—¶å€™æœ‰è¿™å¥è¯ è¯´æ˜ç«¯å£å ç”¨\n\n\tæŸ¥çœ‹å ç”¨2181ç«¯å£çš„ç¨‹åºpidï¼š\n\t[root@localhost local]# lsof -i:5432\n\n\tkillæ‰è¯¥è¿›ç¨‹\n\t[root@localhost local]# kill -9 7035\n\té‡æ–°å¯åŠ¨å³å¯\n\n\t10ã€åˆ›å»ºå…¨éƒ¨å…³é—­çš„è„šæœ¬ start-all.sh :vim shutdown-all.sh\n\tcd zookeeper01/bin\n\t./zkServer.sh stop\n\tcd ../../\n\tcd zookeeper02/bin\n\t./zkServer.sh stop\n\tcd ../../\n\tcd zookeeper03/bin\n\t./zkServer.sh stop\n\tcd ../../\n\t11ã€å¹¶ä½¿ç”¨ä»¥ä¸‹å‘½ä»¤æˆæƒchmod u+x shutdown-all.sh \n\n\t# Solré›†ç¾¤çš„æ­å»º\n\t1ã€å¤åˆ¶å››ä¸ªå•æœºç‰ˆçš„å¸¦solrçš„tomcatï¼Œå¹¶ä¿®æ”¹tomcatç«¯å£å·ã€solrhomeåœ°å€\n\t2ã€é…ç½®solrCloudç›¸å…³çš„é…ç½®ã€‚æ¯ä¸ªsolrhomeä¸‹éƒ½æœ‰ä¸€ä¸ªsolr.xmlï¼ŒæŠŠå…¶ä¸­çš„ipåŠç«¯å£å·é…ç½®å¥½ã€‚\n\tvim /usr/java/solr-cloud/solrhome01/solr.xml\n\t&lt;solrcloud&gt;\n\t\t&lt;str name=\"host\"&gt;192.168.25.135&lt;/str&gt;\n\t\t&lt;int name=\"hostPort\"&gt;8180&lt;/int&gt;\n\t\t&lt;str name=\"hostContext\"&gt;${hostContext:solr}&lt;/str&gt;\n\t\t&lt;int name=\"zkClientTimeout\"&gt;${zkClientTimeout:30000}&lt;/int&gt;\n\t\t&lt;bool name=\"genericCoreNodeNames\"&gt;${genericCoreNodeNames:true}&lt;/bool&gt;\n\t&lt;/solrcloud&gt;\n\t3ã€è®©zookeeperç»Ÿä¸€ç®¡ç†é…ç½®æ–‡ä»¶ã€‚éœ€è¦æŠŠsolrhome/collection1/confç›®å½•ä¸Šä¼ åˆ°zookeeperã€‚ä¸Šä¼ ä»»æ„solrhomeä¸­çš„é…ç½®æ–‡ä»¶å³å¯ã€‚\n\tä½¿ç”¨å·¥å…·ä¸Šä¼ é…ç½®æ–‡ä»¶ï¼š/root/solr-4.10.3/example/scripts/cloud-scripts/zkcli.sh\n\t./zkcli.sh -zkhost 192.168.25.135:2181,192.168.25.135:2182,192.168.25.135:2183 -cmd upconfig -confdir /usr/local/solr-cloud/solrhome01/collection1/conf -confname myconf\n\t4ã€ä¿®æ”¹tomcat/binç›®å½•ä¸‹çš„catalina.sh æ–‡ä»¶ï¼Œå…³è”solrå’Œzookeeperã€‚\n\tæŠŠæ­¤é…ç½®æ·»åŠ åˆ°é…ç½®æ–‡ä»¶ä¸­ï¼š\n\tJAVA_OPTS=\"-DzkHost=192.168.25.135:2181,192.168.25.135:2182,192.168.25.135:2183\"\n\t5ã€å¯åŠ¨æ¯ä¸ªtomcatå®ä¾‹ã€‚è¦åŒ…è£…zookeeperé›†ç¾¤æ˜¯å¯åŠ¨çŠ¶æ€ã€‚\n\t6ã€è®¿é—®é›†ç¾¤\n\tç¬¬åæ­¥ï¼šåˆ›å»ºæ–°çš„Collectionè¿›è¡Œåˆ†ç‰‡å¤„ç†ã€‚\n\thttp://192.168.25.135:8180/solr/admin/collections?action=CREATE&amp;name=collection2&amp;numShards=2&amp;replicationFactor=2\n\tç¬¬åä¸€æ­¥ï¼šåˆ é™¤ä¸ç”¨çš„Collectionã€‚\n\thttp://192.168.25.135:8180/solr/admin/collections?action=DELETE&amp;name=collection1\n\n</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/81aca86bd4364734e8d46.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "shiro",
      "url": "https://javaguide.cn/backend/securityframework/shiro.html",
      "id": "https://javaguide.cn/backend/securityframework/shiro.html",
      "summary": "shiroæƒé™æ§åˆ¶ 1. æƒé™æ¦‚è¿° 2. shiroçš„ä»‹ç» 3. shiroçš„ä½¿ç”¨ 36. shiroç»„ä»¶ï¼Œè®¤è¯ï¼Œæƒé™æ€ä¹ˆåšï¼Ÿ 1. æƒé™æ¦‚è¿° 2. shiroçš„ä»‹ç» 1.png1.png 3. shiroçš„ä½¿ç”¨ 36. shiroç»„ä»¶ï¼Œè®¤è¯ï¼Œæƒé™æ€ä¹ˆåšï¼Ÿ shiroç»„ä»¶ Subjectï¼šä¸»ä½“ï¼Œä»£è¡¨äº†å½“å‰â€œç”¨æˆ·â€,è¡¨ç¤ºè¦å’Œåº”ç”¨äº¤äº’çš„ä¸œè¥¿. Securi...",
      "content_html": "<p>shiroæƒé™æ§åˆ¶</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E6%9D%83%E9%99%90%E6%A6%82%E8%BF%B0\">1. æƒé™æ¦‚è¿°</a></li>\n<li><a href=\"#2-shiro%E7%9A%84%E4%BB%8B%E7%BB%8D\">2. shiroçš„ä»‹ç»</a></li>\n<li><a href=\"#3-shiro%E7%9A%84%E4%BD%BF%E7%94%A8\">3. shiroçš„ä½¿ç”¨</a></li>\n<li><a href=\"#36-shiro%E7%BB%84%E4%BB%B6%E8%AE%A4%E8%AF%81%E6%9D%83%E9%99%90%E6%80%8E%E4%B9%88%E5%81%9A\">36. shiroç»„ä»¶ï¼Œè®¤è¯ï¼Œæƒé™æ€ä¹ˆåšï¼Ÿ</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. æƒé™æ¦‚è¿°</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>è®¤è¯ï¼šç³»ç»Ÿæä¾›çš„ç”¨äºè¯†åˆ«ç”¨æˆ·èº«ä»½çš„åŠŸèƒ½ï¼Œé€šå¸¸ç™»å½•åŠŸèƒ½å°±æ˜¯è®¤è¯åŠŸèƒ½</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/a225ee4bba93bf94ffef9.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "SpringSecurity",
      "url": "https://javaguide.cn/backend/securityframework/springsecurity.html",
      "id": "https://javaguide.cn/backend/securityframework/springsecurity.html",
      "summary": "SpringSecurity 1. Spring Securityæ¦‚è§ˆ 2. Spring Securityç¯å¢ƒ 3. Spring Securityä¸­èµ„æºã€è®¤è¯ä¸æˆæƒ 4. Spring Securityå•ä½“åº”â½¤æ¨¡å¼ 5. Spring Securityå¾®æœåŠ¡æ¶æ„ 6. Spring Securityè®¤è¯æ¨¡å¼ 6.1. HTTPåŸºç¡€è®¤è¯ 6.2. H...",
      "content_html": "<p>SpringSecurity</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-spring-security%E6%A6%82%E8%A7%88\">1. Spring Securityæ¦‚è§ˆ</a></li>\n<li><a href=\"#2-spring-security%E7%8E%AF%E5%A2%83\">2. Spring Securityç¯å¢ƒ</a></li>\n<li><a href=\"#3-spring-security%E4%B8%AD%E8%B5%84%E6%BA%90%E8%AE%A4%E8%AF%81%E4%B8%8E%E6%8E%88%E6%9D%83\">3. Spring Securityä¸­èµ„æºã€è®¤è¯ä¸æˆæƒ</a></li>\n<li><a href=\"#4-spring-security%E5%8D%95%E4%BD%93%E5%BA%94%E6%A8%A1%E5%BC%8F\">4. Spring Securityå•ä½“åº”â½¤æ¨¡å¼</a></li>\n<li><a href=\"#5-spring-security%E5%BE%AE%E6%9C%8D%E5%8A%A1%E6%9E%B6%E6%9E%84\">5. Spring Securityå¾®æœåŠ¡æ¶æ„</a></li>\n<li><a href=\"#6-spring-security%E8%AE%A4%E8%AF%81%E6%A8%A1%E5%BC%8F\">6. Spring Securityè®¤è¯æ¨¡å¼</a>\n<ul>\n<li><a href=\"#61-http%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81\">6.1. HTTPåŸºç¡€è®¤è¯</a></li>\n<li><a href=\"#62-http%E8%A1%A8%E5%8D%95%E8%AE%A4%E8%AF%81%E9%BB%98%E8%AE%A4\">6.2. HTTPè¡¨å•è®¤è¯(é»˜è®¤)</a></li>\n<li><a href=\"#63-%E4%B8%A4%E7%A7%8D%E6%A8%A1%E5%BC%8F%E7%9A%84%E8%BE%83\">6.3. ä¸¤ç§æ¨¡å¼çš„â½è¾ƒ</a></li>\n</ul>\n</li>\n<li><a href=\"#7-%E5%8A%A0%E5%AF%86%E6%8E%A5%E5%8F%A3passwordencoder\">7. åŠ å¯†æ¥å£PasswordEncoder</a></li>\n<li><a href=\"#8-spring-security%E4%B8%AD%E7%9A%84%E6%88%B7%E4%B8%8E%E8%AE%A4%E8%AF%81%E5%AF%B9%E8%B1%A1\">8. Spring Securityä¸­çš„â½¤æˆ·ä¸è®¤è¯å¯¹è±¡</a>\n<ul>\n<li><a href=\"#81-%E6%88%B7%E5%AF%B9%E8%B1%A1\">8.1. â½¤æˆ·å¯¹è±¡</a></li>\n<li><a href=\"#82-%E8%AE%A4%E8%AF%81%E5%AF%B9%E8%B1%A1\">8.2. è®¤è¯å¯¹è±¡</a></li>\n</ul>\n</li>\n<li><a href=\"#9-spring-security%E7%9A%84session%E4%BC%9A%E8%AF%9D%E6%8E%A7%E5%88%B6\">9. Spring Securityçš„Sessionä¼šè¯æ§åˆ¶</a></li>\n<li><a href=\"#10-springsecurity%E7%9A%84%E8%BF%87%E6%BB%A4%E9%93%BE%E8%AE%BE%E8%AE%A1\">10. SpringSecurityçš„è¿‡æ»¤é“¾è®¾è®¡</a></li>\n<li><a href=\"#11-springsecurity%E7%9A%84securitycontextholder\">11. SpringSecurityçš„SecurityContextHolder</a></li>\n<li><a href=\"#12-rememberme%E6%9C%BA%E5%88%B6\">12. RememberMeæœºåˆ¶</a></li>\n<li><a href=\"#13-csrf%E6%94%BB%E5%87%BB\">13. CSRFæ”»å‡»</a></li>\n<li><a href=\"#14-spring-security%E5%85%A5%E9%97%A8\">14. Spring Securityå…¥é—¨</a></li>\n<li><a href=\"#15-springsecurity%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81\">15. SpringSecurityåŸºç¡€è®¤è¯</a></li>\n<li><a href=\"#16-springsecurity%E5%AE%9E%E7%8E%B0%E5%9F%BA%E4%BA%8Emysql%E5%AE%9A%E4%B9%89%E5%9F%BA%E7%A1%80%E8%AE%A4%E8%AF%81\">16. SpringSecurityå®ç°åŸºäºMySQLâ¾ƒå®šä¹‰åŸºç¡€è®¤è¯</a></li>\n<li><a href=\"#17-springsecurity%E5%88%A9passwordencoder%E5%AF%B9%E5%AF%86%E7%A0%81%E5%8A%A0%E5%AF%86%E4%BF%9D%E6%8A%A4\">17. SpringSecurityåˆ©â½¤PasswordEncoderå¯¹å¯†ç åŠ å¯†ä¿æŠ¤</a></li>\n<li><a href=\"#18-%E5%9F%BA%E4%BA%8E%E8%A1%A8%E5%8D%95%E6%A8%A1%E5%BC%8F%E5%AE%9E%E7%8E%B0%E5%AE%9A%E4%B9%89%E8%AE%A4%E8%AF%81\">18. åŸºäºè¡¨å•æ¨¡å¼å®ç°â¾ƒå®šä¹‰è®¤è¯</a></li>\n<li><a href=\"#19-springsecurity%E5%AE%9E%E7%8E%B0%E8%A1%A8%E5%8D%95%E8%AE%A4%E8%AF%81%E7%99%BB%E5%BD%95%E6%8E%A5%E8%BF%94%E5%9B%9Ejson\">19. SpringSecurityå®ç°è¡¨å•è®¤è¯ç™»å½•æ¥â¼è¿”å›JSON</a></li>\n<li><a href=\"#20-security-contextholder%E5%AE%9E%E7%8E%B0%E5%AD%90%E7%BA%BF%E7%A8%8B%E8%8E%B7%E5%BE%97%E7%94%A8%E6%88%B7%E4%BF%A1%E6%81%AF\">20. Security ContextHolderå®ç°å­çº¿ç¨‹è·å¾—ç”¨æˆ·ä¿¡æ¯</a></li>\n<li><a href=\"#21-securitycontextholder%E8%8E%B7%E5%8F%96%E5%BD%93%E5%89%8D%E7%99%BB%E5%BD%95%E5%AF%B9%E8%B1%A1\">21. SecurityContextHolderè·å–å½“å‰ç™»å½•å¯¹è±¡</a></li>\n<li><a href=\"#22-spring-security%E9%85%8D%E7%BD%AE%E5%AE%9A%E4%B9%89%E8%BF%87%E6%BB%A4%E5%99%A8\">22. Spring Securityé…ç½®â¾ƒå®šä¹‰è¿‡æ»¤å™¨</a></li>\n<li><a href=\"#23-spring-security%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6\">23. Spring Securityæƒé™æ§åˆ¶</a>\n<ul>\n<li><a href=\"#231-%E6%8E%88%E6%9D%83\">23.1. æˆæƒ</a></li>\n<li><a href=\"#232-%E9%89%B4%E6%9D%83\">23.2. é‰´æƒ</a></li>\n</ul>\n</li>\n<li><a href=\"#24-rbac%E5%9F%BA%E4%BA%8E%E6%9D%83%E9%99%90%E6%8E%A7%E5%88%B6\">24. RBACåŸºäºâ»†â¾Šæƒé™æ§åˆ¶</a></li>\n<li><a href=\"#25-spring-security-%E5%8C%B9%E9%85%8D%E5%99%A8\">25. Spring Security åŒ¹é…å™¨</a></li>\n<li><a href=\"#26-spring-security%E5%AE%9E%E7%8E%B0remember-me\">26. Spring Securityå®ç°Remember Me</a></li>\n<li><a href=\"#27-spring-security%E9%A2%84%E9%98%B2csrf%E6%94%BB%E5%87%BB\">27. Spring Securityé¢„é˜²CSRFæ”»å‡»</a></li>\n<li><a href=\"#28-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A4%E8%AF%81oauth2%E5%8D%8F%E8%AE%AE%E4%BB%8B%E7%BB%8D\">28. åˆ†å¸ƒå¼è®¤è¯Oauth2åè®®ä»‹ç»</a>\n<ul>\n<li><a href=\"#281-oauth2%E5%8D%8F%E8%AE%AE%E7%9A%84%E5%BA%94%E5%9C%BA%E6%99%AF\">28.1. OAuth2åè®®çš„åº”â½¤åœºæ™¯</a></li>\n<li><a href=\"#282-oauth2%E5%8D%8F%E8%AE%AE%E7%9A%84\">28.2. OAuth2åè®®çš„â»†â¾Š</a></li>\n<li><a href=\"#283-oauth2%E5%8D%8F%E8%AE%AE%E7%9A%84%E4%BB%A4%E7%89%8Ctoken\">28.3. OAuth2åè®®çš„ä»¤ç‰ŒToken</a></li>\n<li><a href=\"#284-oauth2%E5%8D%8F%E8%AE%AE%E4%BD%9C%E6%B5%81%E7%A8%8B\">28.4. OAuth2åè®®â¼¯ä½œæµç¨‹</a></li>\n<li><a href=\"#285-oauth2%E4%B8%ADaccess_token%E7%9A%84%E7%A7%98%E5%AF%86\">28.5. OAuth2ä¸­ACCESS_TOKENçš„ç§˜å¯†</a></li>\n<li><a href=\"#286-%E5%A6%82%E4%BD%95%E7%90%86%E8%A7%A3oauth2-scope%E5%B1%9E%E6%80%A7%E7%9A%84%E4%BD%9C\">28.6. å¦‚ä½•ç†è§£OAuth2 Scopeå±æ€§çš„ä½œâ½¤</a></li>\n</ul>\n</li>\n<li><a href=\"#29-oauth2%E5%8D%8F%E8%AE%AE%E5%9B%9B%E7%A7%8D%E6%8E%88%E6%9D%83%E6%A8%A1%E5%BC%8F\">29. Oauth2åè®®å››ç§æˆæƒæ¨¡å¼</a>\n<ul>\n<li><a href=\"#291-%E6%8E%88%E6%9D%83%E7%A0%81%E6%A8%A1%E5%BC%8Fauthorization-code\">29.1. æˆæƒç æ¨¡å¼ï¼ˆAuthorization Codeï¼‰</a></li>\n<li><a href=\"#292-%E9%9A%90%E5%BC%8F%E6%8E%88%E6%9D%83%E6%A8%A1%E5%BC%8Fimplicit\">29.2. éšå¼æˆæƒæ¨¡å¼ï¼ˆImplicitï¼‰</a></li>\n<li><a href=\"#293-%E5%AF%86%E7%A0%81%E6%A8%A1%E5%BC%8Fresource-owner-password-credentials\">29.3. å¯†ç æ¨¡å¼ï¼ˆResource Owner Password Credentialsï¼‰</a></li>\n<li><a href=\"#294-%E5%AE%A2%E6%88%B7%E7%AB%AF%E6%A8%A1%E5%BC%8Fclient-credentials\">29.4. å®¢æˆ·ç«¯æ¨¡å¼ï¼ˆClient Credentialsï¼‰</a></li>\n</ul>\n</li>\n<li><a href=\"#30-spring-security-oauth2-%E5%88%86%E5%B8%83%E5%BC%8F%E8%AE%A4%E8%AF%81%E6%B5%81%E7%A8%8B\">30. Spring Security Oauth2 åˆ†å¸ƒå¼è®¤è¯æµç¨‹</a></li>\n<li><a href=\"#31-%E6%9E%84%E5%BB%BAoauth2%E8%AE%A4%E8%AF%81%E6%8E%88%E6%9D%83%E4%B8%AD\">31. æ„å»ºOAuth2è®¤è¯æˆæƒä¸­â¼¼</a>\n<ul>\n<li><a href=\"#311-spring-authorization-server-%E6%8E%88%E6%9D%83%E4%B8%AD%E5%BF%83%E6%9E%84%E5%BB%BAauth-server\">31.1. Spring Authorization Server æˆæƒä¸­å¿ƒæ„å»º(auth-server)</a></li>\n<li><a href=\"#312-%E6%9E%84%E5%BB%BAoauth2%E8%B5%84%E6%BA%90%E6%9C%8D%E5%8A%A1%E5%99%A8res-server\">31.2. æ„å»ºOAuth2èµ„æºæœåŠ¡å™¨(res-server)</a></li>\n<li><a href=\"#313-%E6%9E%84%E5%BB%BAoauth2%E5%AE%A2%E6%88%B7%E7%AB%AFclient\">31.3. æ„å»ºOAuth2å®¢æˆ·ç«¯client</a></li>\n</ul>\n</li>\n<li><a href=\"#32-%E5%9F%BA%E4%BA%8Emysql%E7%AE%A1%E7%90%86%E6%8E%88%E6%9D%83%E4%B8%AD%E6%95%B0%E6%8D%AE\">32. åŸºäºMySQLç®¡ç†æˆæƒä¸­â¼¼æ•°æ®</a></li>\n<li><a href=\"#33-access_token%E9%99%84%E5%8A%A0roles%E6%95%B0%E6%8D%AE\">33. ACCESS_TOKENé™„åŠ â»†â¾ŠROLESæ•°æ®</a></li>\n<li><a href=\"#34-oauth2%E4%B8%8Erbac%E5%8D%8F%E5%90%8C%E4%BD%9C%E4%B8%9A\">34. OAuth2ä¸RBACååŒä½œä¸š</a></li>\n<li><a href=\"#35-%E7%8A%B6%E6%80%81%E7%9A%84access_token%E4%BB%A4%E7%89%8C%E5%A6%82%E4%BD%95%E5%8A%A8%E7%BB%AD%E7%BA%A6\">35. â½†çŠ¶æ€çš„ACCESS_TOKENä»¤ç‰Œå¦‚ä½•â¾ƒåŠ¨ç»­çº¦</a></li>\n<li><a href=\"#shiro%E4%B8%8Espring-security%E5%8C%BA%E5%88%AB\">shiroä¸spring securityåŒºåˆ«ï¼Ÿ</a></li>\n<li><a href=\"#37-%E6%97%A7%E7%89%88spring-security%E8%AE%A4%E8%AF%81%E5%92%8C%E9%89%B4%E6%9D%83\">37. æ—§ç‰ˆspring Securityè®¤è¯å’Œé‰´æƒ</a></li>\n<li><a href=\"#38-%E6%97%A7%E7%89%88spring-security-oauth2%E8%AE%A4%E8%AF%81\">38. æ—§ç‰ˆspring Security oauth2è®¤è¯</a></li>\n<li><a href=\"#39-springsecurity%E5%8E%9F%E7%90%86%E5%BE%85%E6%95%B4%E7%90%86\">39. springsecurityåŸç†ï¼ˆå¾…æ•´ç†ï¼‰</a></li>\n<li><a href=\"#40-spring-authorization-server%E5%BE%85%E6%95%B4%E7%90%86\">40. Spring Authorization Serverï¼ˆå¾…æ•´ç†ï¼‰</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. Spring Securityæ¦‚è§ˆ</h1>\n<ul>\n<li>Spring Securityï¼š<a href=\"https://spring.io/projects/spring-security\" target=\"_blank\" rel=\"noopener noreferrer\">https://spring.io/projects/spring-security</a></li>\n<li>Spring Securityå®˜â½…â½‚æ¡£ï¼š<a href=\"https://spring.io/projects/spring%EF%BF%BEsecurity#learn\" target=\"_blank\" rel=\"noopener noreferrer\">https://spring.io/projects/springï¿¾security#learn</a></li>\n<li>Spring Securityæ˜¯â¼€ä¸ªæä¾›èº«ä»½éªŒè¯ã€æˆæƒå’Œé’ˆå¯¹å¸¸â»…æ”»å‡»çš„ä¿æŠ¤çš„æ¡†æ¶ã€‚ä¸»è¦åŠŸèƒ½åŒ…æ‹¬â½¤æˆ·ä¿¡æ¯ç®¡ç†ã€æ•æ„Ÿä¿¡æ¯åŠ è§£å¯†ã€â½¤æˆ·è®¤è¯ã€æƒé™æ§åˆ¶ã€è·¨ç«™ç‚¹è¯·æ±‚ä¼ªé€ ä¿æŠ¤ã€è·¨åŸŸâ½€æŒã€å…¨å±€å®‰å…¨â½…æ³•ã€å•ç‚¹ç™»å½•</li>\n</ul>\n<h1>2. Spring Securityç¯å¢ƒ</h1>\n<ul>\n<li>jdk8+</li>\n<li>SpringBoot2.4+å’ŒSpring Security 5.7.0+ å–æ¶ˆäº†WebSecurityConfigurerAdapter</li>\n</ul>\n<h1>3. Spring Securityä¸­èµ„æºã€è®¤è¯ä¸æˆæƒ</h1>\n<ul>\n<li>èµ„æºï¼ˆresourceï¼‰:æŒ‡éœ€è¦è®¿é—®çš„å†…å®¹ï¼Œå®‰å…¨æ€§è®¾è®¡çš„æ ¸â¼¼â½¬æ ‡å°±æ˜¯å¯¹è¿™äº›èµ„æºè¿›â¾ä¿æŠ¤ï¼Œç¡®ä¿å¯¹å®ƒä»¬çš„è®¿é—®æ˜¯å®‰å…¨å—æ§çš„ã€‚ä¾‹å¦‚ï¼Œåœ¨Webåº”â½¤ç¨‹åºä¸­ï¼Œå¯¹å¤–æš´éœ²çš„HTTPç«¯ç‚¹å°±å¯ä»¥è¢«ç†è§£ä¸ºèµ„æºã€‚</li>\n<li>è®¤è¯ï¼ˆauthenticationï¼‰ï¼šå¯¹äºæ¯æ¬¡è®¿é—®è¯·æ±‚ï¼Œç³»ç»Ÿéƒ½èƒ½åˆ¤æ–­å‡ºè®¿é—®è€…æ˜¯å¦å…·æœ‰åˆæ³•çš„èº«ä»½æ ‡è¯†ã€‚æ˜ç¡®â€œä½ æ˜¯è°â€ï¼Œ</li>\n<li>æˆæƒï¼ˆauthorizationï¼‰ã€‚æˆæƒæ˜¯å¯¹èµ„æºã€æƒé™ã€â»†â¾Šå’Œâ½¤æˆ·çš„â¼€ç§ç»„åˆå¤„ç†</li>\n</ul>\n<h1>4. Spring Securityå•ä½“åº”â½¤æ¨¡å¼</h1>\n<ul>\n<li>â½¤æˆ·å…ˆé€šè¿‡è¯·æ±‚ä¼ é€’â½¤æˆ·èº«ä»½å‡­è¯å¹¶å®Œæˆâ½¤æˆ·è®¤è¯ï¼Œç„¶åæ ¹æ®è¯¥â½¤æˆ·æ‰€å…·å¤‡çš„â½¤æˆ·â»†â¾Šæ¥è·å–è®¿é—®æƒé™ï¼Œå¹¶æœ€ç»ˆå®Œæˆå¯¹HTTPç«¯ç‚¹çš„è®¿é—®æˆæƒã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/e03536d14c58fb42b04bc.jpg\" alt=\"singleservice.png\" tabindex=\"0\"><figcaption>singleservice.png</figcaption></figure>\n<h1>5. Spring Securityå¾®æœåŠ¡æ¶æ„</h1>\n<ul>\n<li>æ¶‰åŠæœåŠ¡ä¸æœåŠ¡ä¹‹é—´çš„è°ƒâ½¤å…³ç³»ã€‚æœåŠ¡æä¾›è€…æ‰€å……å½“çš„â»†â¾Šå°±æ˜¯èµ„æºæœåŠ¡å™¨ï¼Œâ½½æœåŠ¡æ¶ˆè´¹è€…å°±æ˜¯å®¢æˆ·ç«¯ã€‚æ‰€ä»¥ï¼Œå„ä¸ªæœåŠ¡æœ¬èº«æ—¢å¯ä»¥æ˜¯å®¢æˆ·ç«¯ï¼Œä¹Ÿå¯ä»¥æ˜¯èµ„æºæœåŠ¡å™¨</li>\n<li>éœ€è¦æŠŠè®¤è¯å’Œæˆæƒçš„è¿‡ç¨‹è¿›â¾é›†ä¸­åŒ–ç®¡ç†ï¼Œæˆæƒä¸­â¼¼â¾¸å…ˆä¼šè·å–å®¢æˆ·ç«¯è¯·æ±‚ä¸­çš„èº«ä»½å‡­è¯ä¿¡æ¯ï¼Œç„¶ååŸºäºè¯¥èº«ä»½å‡­è¯ä¿¡æ¯â½£æˆâ¼€ä¸ªä»¤ç‰Œï¼ˆTokenï¼‰ï¼Œè¯¥ä»¤ç‰ŒåŒ…å«è®¿é—®æƒé™èŒƒå›´å’Œæœ‰æ•ˆæœŸã€‚å®¢æˆ·ç«¯è·å–ä»¤ç‰Œä¹‹åå°±å¯ä»¥åŸºäºè¯¥ä»¤ç‰Œå‘èµ·å¯¹å¾®æœåŠ¡çš„è®¿é—®ã€‚è¿™æ—¶èµ„æºæœåŠ¡å™¨éœ€è¦å¯¹è¯¥ä»¤ç‰Œè¿›â¾è®¤è¯ï¼Œå¹¶æ ¹æ®ä»¤ç‰Œçš„æƒé™èŒƒå›´å’Œæœ‰æ•ˆæœŸä»æˆæƒä¸­â¼¼è·å–è¯¥è¯·æ±‚æ‰€èƒ½è®¿é—®çš„ç‰¹å®šèµ„æºã€‚åœ¨å¾®æœåŠ¡ç³»ç»Ÿä¸­ï¼Œå¯¹å¤–çš„èµ„æºè¡¨ç°å½¢å¼åŒæ ·å¯ä»¥ç†è§£ä¸ºâ¼€ä¸ªä¸ªHTTPç«¯ç‚¹ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/013a129d53f38109a20dc.jpg\" alt=\"microservice.png\" tabindex=\"0\"><figcaption>microservice.png</figcaption></figure>\n<h1>6. Spring Securityè®¤è¯æ¨¡å¼</h1>\n<ul>\n<li>åœ¨Spring Securityä¸­ï¼Œä¸â½¤æˆ·è®¤è¯ç›¸å…³çš„æ ¸â¼¼æ¦‚å¿µåŒ…æ‹¬â½¤æˆ·å¯¹è±¡å’Œè®¤è¯å¯¹è±¡ã€â½¤æˆ·ä¿¡æ¯å­˜å‚¨å’Œè®¤è¯â½…å¼ã€‚</li>\n<li>Spring Securityè®¤è¯æ¨¡å¼åŒ…æ‹¬HTTPåŸºç¡€è®¤è¯å’Œè¡¨å•ç™»å½•è®¤è¯<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/2750c08889738551b893d.jpg\" alt=\"authentication.png\"></li>\n</ul>\n<h2>6.1. HTTPåŸºç¡€è®¤è¯</h2>\n<ul>\n<li>é€šè¿‡HTTPçš„æ¶ˆæ¯å¤´æºå¸¦â½¤æˆ·åå’Œå¯†ç è¿›â¾ç™»å½•éªŒè¯</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/cb80a6c09cbd83bd608de.jpg\" alt=\"httpbasicheader.png\" tabindex=\"0\"><figcaption>httpbasicheader.png</figcaption></figure>\n<h2>6.2. HTTPè¡¨å•è®¤è¯(é»˜è®¤)</h2>\n<ul>\n<li>æœ‰ç™»å½•ç•Œâ¾¯å¹¶æ ¹æ®ä¸šåŠ¡åœºæ™¯è¿›â¾å®šåˆ¶åŒ–å¤„ç†ã€‚åŒæ—¶ï¼Œä¹Ÿéœ€è¦å¯¹ç™»å½•çš„è¿‡ç¨‹å’Œç»“æœè¿›â¾ç»†åŒ–æ§åˆ¶ã€‚</li>\n</ul>\n<h2>6.3. ä¸¤ç§æ¨¡å¼çš„â½è¾ƒ</h2>\n<ul>\n<li>éƒ½ä½¿â½¤â½¤æˆ·åå’Œå¯†ç æ¥å¯¹å®¢æˆ·ç«¯è¿›â¾èº«ä»½éªŒè¯</li>\n<li>åŸºç¡€è®¤è¯åœ¨RFC 7617 ä¸­æ­£å¼å®šä¹‰ï¼ŒBasic Authä½¿â½¤HTTP RequestHeaderï¼Œä»¥ä¾¿åœ¨å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚æ—¶æä¾›â½¤æˆ·åå’Œå¯†ç ã€‚æ ‡é¢˜å­—æ®µæœ¬Authorization: Basic Base64-encoded(username:password)å‡­è¯æ˜¯ç”±å•ä¸ªå†’å·è¿æ¥çš„â½¤æˆ·åå’Œå¯†ç çš„base64ç¼–ç ã€‚ ä¸åŸºäºè¡¨å•æ¨¡å¼ä¸åŒï¼Œ<strong>åŸºæœ¬èº«ä»½éªŒè¯ä¸ä½¿â½¤cookieï¼Œå› æ­¤æ²¡æœ‰ä¼šè¯æˆ–æ³¨é”€â½¤æˆ·çš„æ¦‚å¿µ</strong>ï¼Œè¿™æ„å‘³ç€æ¯ä¸ªè¯·æ±‚éƒ½å¿…é¡»æºå¸¦è¯¥Request Headeræ‰èƒ½è¿›â¾èº«ä»½éªŒè¯ã€‚</li>\n<li>è¡¨å•è®¤è¯æ²¡æœ‰è¢«ä»»ä½•RFCå½¢å¼åŒ–ã€‚æœ¬è´¨ä¸Šæ˜¯â¼€ç§ç¼–ç¨‹çš„èº«ä»½éªŒè¯â½…æ³•ï¼Œâ½¤äºå‡è½»æ¯ä¸ªè¯·æ±‚éƒ½å¿…é¡»é‡æ–°è®¤è¯çš„å‹â¼’ã€‚â¼¤å¤šæ•°åŸºäºè¡¨å•çš„èº«ä»½è®¤è¯å®ç°ä½¿â½¤æ ‡å‡†HTMLè¡¨å•å­—æ®µé€šè¿‡POSTè¯·æ±‚å°†â½¤æˆ·åå’Œå¯†ç å€¼ä¼ é€’ç»™æœåŠ¡å™¨ã€‚æœåŠ¡å™¨éªŒè¯æ‰€æä¾›çš„å‡­æ®ï¼Œ<strong>å¹¶åˆ›å»ºâ¼€ä¸ªSessionä¼šè¯ï¼ˆæœ‰çŠ¶æ€ï¼‰</strong>ï¼Œè¯¥ä¼šè¯ç»‘å®šåˆ°å­˜å‚¨åœ¨cookieä¸­çš„SessionIdï¼Œå¹¶åœ¨æ¯ä¸ªhttpè¯·æ±‚ä¸Šåœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡å™¨ä¹‹é—´ä¼ é€’ã€‚å¦‚æœcookieâ½†æ•ˆæˆ–â½¤æˆ·æ³¨é”€ï¼Œåˆ™æœåŠ¡å™¨é€šå¸¸ä¼šé‡å®šå‘åˆ°ç™»å½•â»šâ¾¯ã€‚</li>\n<li>è¡¨å•è®¤è¯â½¤äºå¯¹åŸºäºwebæµè§ˆå™¨çš„å®¢æˆ·ç«¯å’ŒAPIè¿›â¾èº«ä»½è®¤è¯ï¼Œâ½¹ç«™åº”â½¤ï¼Œä¼ä¸šçº§åº”â½¤ï¼Œæä¾›ç™»å½•ã€æ³¨é”€ç­‰æ“ä½œï¼ˆæœ‰çŠ¶æ€ï¼‰ã€‚</li>\n<li>åŸºç¡€è®¤è¯éªŒè¯â½¤äºAPIä¹‹é—´çš„èº«ä»½éªŒè¯ï¼ˆâ½†çŠ¶æ€ï¼‰ã€‚</li>\n</ul>\n<h1>7. åŠ å¯†æ¥å£PasswordEncoder</h1>\n<ul>\n<li>PasswordEncoderæ¥â¼ä»£è¡¨å¯†ç ç¼–ç å™¨ï¼Œâ½¤äºæŒ‡å®šå¯†ç çš„å…·ä½“åŠ å¯†â½…å¼ï¼Œä»¥åŠå¦‚ä½•åœ¨ç»™å®šçš„â¼€æ®µåŠ å¯†å­—ç¬¦ä¸²ä¸æ˜â½‚ä¹‹é—´å®ŒæˆåŒ¹é…æ ¡éªŒã€‚Spring Securityå†…ç½®äº†PasswordEncoderæ¥â¼çš„å®ç°ç±»ã€‚\n<ul>\n<li>NoOpPasswordEncoderï¼šä»¥æ˜â½‚å½¢å¼ä¿å­˜å¯†ç ï¼Œä¸å¯¹å¯†ç è¿›â¾ç¼–ç ã€‚é€šå¸¸åªâ½¤äºæ¼”ç¤º</li>\n<li>StandardPasswordEncoderï¼šä½¿â½¤SHA-256ç®—æ³•å¯¹å¯†ç æ‰§â¾æ•£åˆ—æ“ä½œï¼ˆè¿‡æœŸï¼‰</li>\n<li>BCryptPasswordEncoderï¼šä½¿â½¤bcryptå¼ºæ•£åˆ—ç®—æ³•å¯¹å¯†ç æ‰§â¾æ•£åˆ—æ“ä½œ</li>\n<li>Pbkdf2PasswordEncoderï¼šä½¿â½¤PBKDF2ç®—æ³•å¯¹å¯†ç æ‰§â¾æ•£åˆ—æ“ä½œ</li>\n</ul>\n</li>\n<li>BCryptå°†åœ¨å†…éƒ¨äº§â½£éšæœºç›å€¼ã€‚æ¯ä¸ªè°ƒâ½¤å°†æœ‰ä¸åŒçš„ç»“æœï¼Œåªéœ€è¦å¯¹å¯†ç è¿›â¾â¼€æ¬¡ç¼–ç ã€‚ä¸ºäº†ä½¿è¿™ç§éšæœºçš„ç›å€¼èƒ½æ­£å¸¸â¼¯ä½œï¼ŒBCryptå°†ç›å­˜å‚¨åœ¨Hashå€¼æœ¬èº«ä¸­ã€‚ä¾‹å¦‚ï¼Œä»¥ä¸‹Hashå€¼:$2aZLhnHxdpHETcxmtEStgpI./Ri1mksgJ9iDP36FmfMdYyVg9g0b2dq.â½¤ $ åˆ†éš”ä¸‰ä¸ªå­—æ®µï¼š \"2a\" ä»£è¡¨BCryptç®—æ³•ç‰ˆæœ¬ï¼Œ \"10\" è¡¨ç¤ºç®—æ³•çš„å¼ºåº¦ï¼Œ\"ZLhnHxdpHETcxmtEStgpI.\" æ ‡è¯†éšæœºâ½£æˆçš„ç›å€¼ã€‚åŸºæœ¬ä¸Šï¼Œå‰22ä¸ªå­—ç¬¦æ˜¯saltã€‚ æœ€åâ¼€ä¸ªå­—æ®µçš„å…¶ä½™éƒ¨åˆ†æ˜¯çº¯â½‚æœ¬çš„å®é™…æ•£åˆ—å†…å®¹ã€‚</li>\n<li>ä¸ºä»€ä¹ˆè¦åŠ ç›?åŠ ç›ä¿è¯å€¼ä¸èƒ½æ ¹æ®å­—å…¸å¾—åˆ°å€¼ï¼Œå³ä½¿å¾—åˆ°å€¼ä¹Ÿä¸çŸ¥é“å€¼æœ¬èº«æ˜¯ä»€ä¹ˆï¼Œå› ä¸ºåŠ ç›åå­—ç¬¦çœ‹èµ·æ¥æ— æ„ä¹‰</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package org.springframework.security.crypto.password;\npublic interface PasswordEncoder {\n  //å¯¹åŸå§‹å¯†ç è¿›â¾ç¼–ç \n  String encode(CharSequence rawPassword);\n  //å¯¹æäº¤çš„åŸå§‹å¯†ç ä¸åº“ä¸­å­˜å‚¨çš„åŠ å¯†å¯†ç è¿›â¾â½å¯¹\n  boolean matches(CharSequence rawPassword, String encodedPassword);\n  //åˆ¤æ–­åŠ å¯†å¯†ç æ˜¯å¦éœ€è¦å†æ¬¡è¿›â¾åŠ å¯†ï¼Œé»˜è®¤è¿”å›false\n  default boolean upgradeEncoding(String encodedPassword) {\n    return false;\n  }\n}\n</code></pre></div><h1>8. Spring Securityä¸­çš„â½¤æˆ·ä¸è®¤è¯å¯¹è±¡</h1>\n<h2>8.1. â½¤æˆ·å¯¹è±¡</h2>\n<ul>\n<li>â½¤æ¥æè¿°â½¤æˆ·å¹¶å®Œæˆå¯¹â½¤æˆ·ä¿¡æ¯çš„ç®¡ç†ï¼Œæ¶‰åŠ4ä¸ªæ ¸â¼¼â½¤æˆ·å¯¹è±¡</li>\n<li>UserDetailsï¼šæè¿°Spring Securityä¸­çš„â½¤æˆ·ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface UserDetails extends Serializable {\n  //è·å–è¯¥â½¤æˆ·çš„æƒé™ä¿¡æ¯\n  Collection&lt;? extends GrantedAuthority&gt; getAuthorities();\n  //è·å–å¯†ç \n  String getPassword();\n  //è·å–â½¤æˆ·å\n  String getUsername();\n  //åˆ¤æ–­è¯¥è´¦æˆ·æ˜¯å¦å·²å¤±æ•ˆ\n  boolean isAccountNonExpired();\n  //åˆ¤æ–­è¯¥è´¦æˆ·æ˜¯å¦å·²è¢«é”å®š\n  boolean isAccountNonLocked();\n  //åˆ¤æ–­è¯¥è´¦æˆ·çš„å‡­è¯ä¿¡æ¯æ˜¯å¦å·²å¤±æ•ˆ\n  boolean isCredentialsNonExpired();\n  //åˆ¤æ–­è¯¥â½¤æˆ·æ˜¯å¦å¯â½¤\n  boolean isEnabled();\n}\n</code></pre></div><ul>\n<li>GrantedAuthorityï¼šå®šä¹‰â½¤æˆ·æ‰€èƒ½æ‰§â¾çš„æ“ä½œæƒé™</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface GrantedAuthority extends Serializable {\n //è·å–æƒé™ä¿¡æ¯\n String getAuthority();\n}\n</code></pre></div><ul>\n<li>UserDetailsServiceï¼šå®šä¹‰å¯¹UserDetailsçš„æŸ¥è¯¢æ“ä½œã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface UserDetailsService {\n  //æ ¹æ®â½¤æˆ·åè·å–â½¤æˆ·ä¿¡æ¯\n  UserDetails loadUserByUsername(String username) throws UsernameNotFoundException;\n}\n</code></pre></div><ul>\n<li>UserDetailsManagerï¼šæ‰©å±•UserDetailsServiceï¼Œæ·»åŠ åˆ›å»ºâ½¤æˆ·ã€ä¿®æ”¹â½¤æˆ·å¯†ç ç­‰åŠŸèƒ½ã€‚</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface UserDetailsManager extends UserDetailsService {\n  //åˆ›å»ºâ½¤æˆ·\n  void createUser(UserDetails user);\n  //æ›´æ–°â½¤æˆ·\n  void updateUser(UserDetails user);\n  //åˆ é™¤â½¤æˆ·\n  void deleteUser(String username);\n  //ä¿®æ”¹å¯†ç \n  void changePassword(String oldPassword, String newPassword);\n  //åˆ¤æ–­æŒ‡å®šâ½¤æˆ·åçš„â½¤æˆ·æ˜¯å¦å­˜åœ¨\n  boolean userExists(String username);\n}\n</code></pre></div><h2>8.2. è®¤è¯å¯¹è±¡</h2>\n<ul>\n<li>Authentication-è®¤è¯è¯·æ±‚è¯¦ç»†ä¿¡æ¯</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface Authentication extends Principal, Serializable {\n  //å®‰å…¨ä¸»ä½“æ‰€å…·æœ‰çš„æƒé™\n  Collection&lt;? extends GrantedAuthority&gt; getAuthorities();\n  //è¯æ˜ä¸»ä½“æœ‰æ•ˆæ€§çš„å‡­è¯\n  Object getCredentials();\n  //è®¤è¯è¯·æ±‚çš„æ˜ç»†ä¿¡æ¯\n  Object getDetails();\n  //ä¸»ä½“çš„æ ‡è¯†ä¿¡æ¯\n  Object getPrincipal();\n  //æ˜¯å¦è®¤è¯é€šè¿‡\n  boolean isAuthenticated();\n  //è®¾ç½®è®¤è¯ç»“æœ\n  void setAuthenticated(boolean isAuthenticated) throws IllegalArgumentException;\n}\n</code></pre></div><ul>\n<li>AuthenticationProvider-è®¤è¯çš„ä¸šåŠ¡æ‰§â¾è€…</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public interface AuthenticationProvider {\n  //æ‰§â¾è®¤è¯ï¼Œè¿”å›è®¤è¯ç»“æœ\n  Authentication authenticate(Authentication authentication) throws AuthenticationException;\n  //åˆ¤æ–­æ˜¯å¦â½€æŒå½“å‰çš„è®¤è¯å¯¹è±¡\n  boolean supports(Class&lt;?&gt; authentication);\n}\n</code></pre></div><ul>\n<li>Explanation: In the old version you inject AuthenticationManagerBuilder, set userDetailsService,<br>\npasswordEncoder and build it. But authenticationManager is already created in this step. It is<br>\ncreated the way we wanted (with userDetailsService and the passwordEncoder).</li>\n</ul>\n<h1>9. Spring Securityçš„Sessionä¼šè¯æ§åˆ¶</h1>\n<ul>\n<li>Spring Securityæ§åˆ¶ä¼šè¯ä½•æ—¶åˆ›å»ºä»¥åŠå°†å¦‚ä½•ä¸ä¹‹äº¤äº’\n<ul>\n<li>always â€“ å¦‚æœä¼šè¯å°šä¸å­˜åœ¨ï¼Œåˆ™å§‹ç»ˆä¼šåˆ›å»ºä¼šè¯</li>\n<li>ifRequired â€“ ä»…åœ¨éœ€è¦æ—¶åˆ›å»ºä¼šè¯ (é»˜è®¤) =&gt;è¡¨å•è®¤è¯-åå°ç³»ç»Ÿæä¾›ç™»å½•ä¸æ³¨é”€</li>\n<li>never â€“ è¯¥æ¡†æ¶æ°¸è¿œä¸ä¼šåˆ›å»ºä¼šè¯æœ¬èº«ï¼Œä½†å¦‚æœå·²ç»å­˜åœ¨ï¼Œå®ƒå°†ä½¿â½¤ä¼šè¯</li>\n<li>stateless â€“ ä¸ä¼šåˆ›å»ºæˆ–ä½¿â½¤ä»»ä½•ä¼šè¯ã€‚æ­¤é…ç½®ä»…æ§åˆ¶Spring Securityçš„åŠŸèƒ½ï¼Œâ½½ä¸æ˜¯æ•´ä¸ªåº”â½¤ç¨‹åº=&gt;åŸºç¡€è®¤è¯-APIè®¤è¯</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Bean\npublic SecurityFilterChain filterChain(HttpSecurity http) throws Exception\n{\n  http.sessionManagement().sessionCreationPolicy(SessionCreationPolicy.STATELESS);\n  ...\n}\n</code></pre></div><h1>10. SpringSecurityçš„è¿‡æ»¤é“¾è®¾è®¡</h1>\n<ul>\n<li>åœ¨ Spring Security ä¸­ï¼Œè®¤è¯ã€æˆæƒç­‰åŠŸèƒ½éƒ½æ˜¯åŸºäºè¿‡æ»¤å™¨æ¥å®Œæˆçš„ã€‚å¼•â¼ŠSpring Securityä¾èµ–ä¹‹åï¼Œå¼€å‘è€…ä¸åšä»»ä½•é…ç½®æ—¶ï¼Œè‡ªåŠ¨åŠ è½½é»˜è®¤è¿‡æ»¤å™¨ã€‚è¿™äº›è¿‡æ»¤å™¨æŒ‰ç…§æ—¢å®šçš„ä¼˜å…ˆçº§æ’åˆ—ï¼Œæœ€ç»ˆå½¢æˆâ¼€ä¸ªè¿‡æ»¤å™¨é“¾ã€‚å¼€å‘è€…ä¹Ÿå¯ä»¥â¾ƒå®šä¹‰è¿‡æ»¤å™¨ï¼Œå¹¶é€šè¿‡@Order æ³¨è§£å»è°ƒæ•´â¾ƒå®šä¹‰è¿‡æ»¤å™¨åœ¨è¿‡æ»¤å™¨é“¾ä¸­çš„ä½ç½®ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/5daa71a0eb9c5c8eaa18f.jpg\" alt=\"defaultfilter.png\" tabindex=\"0\"><figcaption>defaultfilter.png</figcaption></figure>\n<ul>\n<li>é»˜è®¤è¿‡æ»¤å™¨å¹¶ä¸æ˜¯ç›´æ¥æ”¾åœ¨Webé¡¹â½¬çš„åŸâ½£è¿‡æ»¤å™¨é“¾ä¸­ï¼Œâ½½æ˜¯é€šè¿‡â¼€ä¸ªFilterChainProxyæ¥ç»Ÿâ¼€ç®¡ç†ã€‚Spring Security ä¸­çš„è¿‡æ»¤å™¨é“¾é€šè¿‡FilterChainProxyåµŒâ¼Šåˆ°Web é¡¹â½¬çš„åŸâ½£è¿‡æ»¤å™¨é“¾ä¸­ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/8db109b4aa659ed9bd2fb.jpg\" alt=\"filterchainproxy.png\" tabindex=\"0\"><figcaption>filterchainproxy.png</figcaption></figure>\n<ul>\n<li>åœ¨Spring Securityä¸­ï¼Œè¿™æ ·çš„è¿‡æ»¤å™¨é“¾ä¸ä»…ä»…åªæœ‰â¼€ä¸ªï¼Œå¯èƒ½ä¼šæœ‰å¤šä¸ªï¼Œå¦‚å›¾æ‰€ç¤ºã€‚å½“å­˜åœ¨å¤šä¸ªè¿‡æ»¤å™¨é“¾æ—¶ï¼Œå¤šä¸ªè¿‡æ»¤å™¨é“¾ä¹‹é—´è¦æŒ‡å®šä¼˜å…ˆçº§ï¼Œå½“è¯·æ±‚åˆ°è¾¾åï¼Œä¼šä»FilterChainProxy è¿›â¾åˆ†å‘ï¼Œå…ˆå’Œå“ªä¸ªè¿‡æ»¤å™¨é“¾åŒ¹é…ä¸Šï¼Œå°±â½¤å“ªä¸ªè¿‡æ»¤å™¨é“¾è¿›â¾å¤„ç†ã€‚å½“ç³»ç»Ÿä¸­å­˜åœ¨å¤šä¸ªä¸åŒçš„è®¤è¯ä½“ç³»æ—¶ï¼Œé‚£ä¹ˆä½¿â½¤å¤šä¸ªè¿‡æ»¤å™¨é“¾å°±â¾®å¸¸æœ‰æ•ˆã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/4b6e6aa7d8d7dae60d69e.jpg\" alt=\"filterchain.png\" tabindex=\"0\"><figcaption>filterchain.png</figcaption></figure>\n<h1>11. SpringSecurityçš„SecurityContextHolder</h1>\n<ul>\n<li>å½“â½¤æˆ·ç™»å½•æˆåŠŸåï¼ŒSpring Security ä¼šå°†ç™»å½•æˆåŠŸçš„â½¤æˆ·ä¿¡æ¯ä¿å­˜åˆ°SecurityContextHolder ä¸­ã€‚SecurityContextHolderä¸­çš„æ•°æ®ä¿å­˜é»˜è®¤æ˜¯é€šè¿‡ThreadLocalæ¥å®ç°çš„ï¼Œä½¿â½¤ThreadLocal åˆ›å»ºçš„å˜é‡åªèƒ½è¢«å½“å‰çº¿ç¨‹è®¿é—®ï¼Œä¸èƒ½è¢«å…¶ä»–çº¿ç¨‹è®¿é—®å’Œä¿®æ”¹ï¼Œä¹Ÿå°±æ˜¯â½¤æˆ·æ•°æ®å’Œè¯·æ±‚çº¿ç¨‹ç»‘å®šåœ¨â¼€èµ·ã€‚å½“ç™»å½•è¯·æ±‚å¤„ç†å®Œæ¯•åï¼ŒSpring Security ä¼šå°†SecurityContextHolderä¸­çš„æ•°æ®æ‹¿å‡ºæ¥ä¿å­˜åˆ°Sessionä¸­ï¼ŒåŒæ—¶å°†SecurityContextHolderä¸­çš„æ•°æ®æ¸…ç©ºã€‚ä»¥åæ¯å½“æœ‰è¯·æ±‚åˆ°æ¥æ—¶ï¼ŒSpring Securityå°±ä¼šå…ˆä» Session ä¸­å–å‡ºâ½¤æˆ·ç™»å½•æ•°æ®ï¼Œä¿å­˜åˆ°SecurityContextHolder ä¸­ï¼Œâ½…ä¾¿åœ¨è¯¥è¯·æ±‚çš„åç»­å¤„ç†è¿‡ç¨‹ä¸­ä½¿â½¤ï¼ŒåŒæ—¶åœ¨è¯·æ±‚ç»“æŸæ—¶å°†SecurityContextHolderä¸­çš„æ•°æ®æ‹¿å‡ºæ¥ä¿å­˜åˆ°Sessionä¸­ï¼Œç„¶åå°†SecurityContextHolderä¸­çš„æ•°æ®æ¸…ç©ºã€‚è¿™â¼€ç­–ç•¥â¾®å¸¸â½…ä¾¿â½¤æˆ·åœ¨Controlleræˆ–è€…Serviceå±‚è·å–å½“å‰ç™»å½•â½¤æˆ·æ•°æ®ï¼Œ</li>\n</ul>\n<h1>12. RememberMeæœºåˆ¶</h1>\n<ul>\n<li>\n<p>Remember-Meå®ç°æœºç†æ˜¯æ ¹æ®â½¤æˆ·ç™»å½•ä¿¡æ¯â½£æˆ Token å¹¶ä¿å­˜åœ¨â½¤æˆ·æµè§ˆå™¨çš„Cookie ä¸­ï¼Œå½“â½¤æˆ·éœ€è¦å†æ¬¡ç™»å½•æ—¶ï¼Œâ¾ƒåŠ¨å®ç°æ ¡éªŒå¹¶å»ºâ½´ç™»å½•æ€çš„â¼€ç§æœºåˆ¶ã€‚</p>\n</li>\n<li>\n<p>Remember-Me åŠŸèƒ½çš„å¼€å¯éœ€è¦åœ¨configure(HttpSecurity http)â½…æ³•ä¸­é€šè¿‡http.rememberMe()é…ç½®ï¼Œè¯¥é…ç½®ä¸»è¦ä¼šåœ¨è¿‡æ»¤å™¨é“¾ä¸­æ·»åŠ RememberMeAuthenticationFilterè¿‡æ»¤å™¨å®ç°â¾ƒåŠ¨ç™»å½•ã€‚ä½ç½®åœ¨å…¶å®ƒè®¤è¯è¿‡æ»¤å™¨ä¹‹åï¼Œå…¶å®ƒè®¤è¯è¿‡æ»¤å™¨æ²¡æœ‰è¿›â¾è®¤è¯å¤„ç†æ—¶å¤„ç†</p>\n</li>\n<li>\n<p>Remember-Me åŠŸèƒ½æ˜¯â½¤äºå†æ¬¡ç™»å½•ï¼ˆè®¤è¯ï¼‰çš„ï¼Œâ½½ä¸æ˜¯å†æ¬¡è¯·æ±‚<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/77d2e9e49c415e4aaa80a.jpg\" alt=\"rememberme.png\"></p>\n</li>\n<li>\n<p>â¼¯ä½œæµç¨‹å¦‚ä¸‹ï¼š</p>\n<ul>\n<li>å½“â½¤æˆ·æˆåŠŸç™»å½•è®¤è¯åï¼Œæµè§ˆå™¨ä¸­å­˜åœ¨ä¸¤ä¸ª Cookieï¼Œâ¼€ä¸ªæ˜¯remember-me+æœ‰æ•ˆæ—¶é—´ï¼Œå¦â¼€ä¸ªæ˜¯JSESSIONIDã€‚</li>\n<li>â½¤æˆ·å†æ¬¡è¯·æ±‚è®¿é—®æ—¶ï¼Œè¯·æ±‚â¾¸å…ˆè¢«SecurityContextPersistenceFilter è¿‡æ»¤å™¨æ‹¦æˆªå¹¶æ ¹æ®JSESSIONID è·å–å¯¹åº” Session ä¸­å­˜å‚¨çš„ SecurityContext å¯¹è±¡ã€‚\n<ul>\n<li>å¦‚æœè·å–åˆ°çš„ SecurityContext å¯¹è±¡ä¸­å­˜å‚¨äº†è®¤è¯â½¤æˆ·ä¿¡æ¯å¯¹è±¡ Authentiacaionï¼Œä¹Ÿå°±æ˜¯è¯´çº¿ç¨‹å¯ä»¥ç›´æ¥è·å¾—è®¤è¯â½¤æˆ·ä¿¡æ¯ï¼Œé‚£ä¹ˆåç»­çš„è®¤è¯è¿‡æ»¤å™¨ä¸éœ€è¦å¯¹è¯¥è¯·æ±‚è¿›â¾æ‹¦æˆªï¼Œremember-meä¸èµ·ä½œâ½¤ã€‚</li>\n<li>å½“ JSESSIONID è¿‡æœŸåï¼Œæµè§ˆå™¨ä¸­åªå­˜åœ¨ remember-me çš„Cookieã€‚\n<ul>\n<li>â½¤æˆ·å†æ¬¡è¯·æ±‚è®¿é—®æ—¶ï¼Œç”±äºè¯·æ±‚æ²¡æœ‰æºå¸¦ JSESSIONIDï¼ŒSecurityContextPersistenceFilter è¿‡æ»¤å™¨â½†æ³•è·å–Session ä¸­çš„ SecurityContext å¯¹è±¡ï¼Œä¹Ÿå°±æ²¡æ³•è·å¾—è®¤è¯â½¤æˆ·ä¿¡æ¯ï¼Œåç»­éœ€è¦è¿›â¾ç™»å½•è®¤è¯ã€‚\n<ul>\n<li>å¦‚æœæ²¡æœ‰ remember-me çš„ Cookieï¼Œæµè§ˆå™¨ä¼šé‡å®šå‘åˆ°ç™»å½•â»šâ¾¯è¿›â¾è¡¨å•ç™»å½•è®¤è¯ï¼›</li>\n<li>ä½†æ˜¯ remember-me çš„ Cookie å­˜åœ¨ï¼ŒRememberMeAuthenticationFilter è¿‡æ»¤å™¨ä¼šå°†è¯·æ±‚è¿›â¾æ‹¦æˆªï¼Œæ ¹æ® remember-me å­˜å‚¨çš„ Token å€¼å®ç°â¾ƒåŠ¨ç™»å½•ï¼Œå¹¶å°†æˆåŠŸç™»å½•åçš„è®¤è¯â½¤æˆ·ä¿¡æ¯å¯¹è±¡Authentiacaion å­˜å‚¨åˆ° SecurityContext ä¸­ã€‚å½“å“åº”è¿”å›æ—¶ï¼ŒSecurityContextPersistenceFilter è¿‡æ»¤å™¨ä¼šå°† SecurityContext å­˜å‚¨åœ¨ Session ä¸­ï¼Œä¸‹æ¬¡è¯·æ±‚â¼œé€šè¿‡ JSEESIONID è·å–è®¤è¯â½¤æˆ·ä¿¡æ¯ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>\n<p>remember-me åªæœ‰åœ¨ JSESSIONID å¤±æ•ˆå’Œå‰â¾¯çš„è¿‡æ»¤å™¨è®¤è¯å¤±è´¥æˆ–è€…æœªè¿›â¾è®¤è¯æ—¶æ‰å‘æŒ¥ä½œâ½¤ã€‚æ­¤æ—¶ï¼Œåªè¦ remember-me çš„Cookie ä¸è¿‡æœŸï¼Œæˆ‘ä»¬å°±ä¸éœ€è¦å¡«å†™ç™»å½•è¡¨å•ï¼Œå°±èƒ½å®ç°å†æ¬¡ç™»å½•ï¼Œå¹¶ä¸” remember-me â¾ƒåŠ¨ç™»å½•æˆåŠŸä¹‹åï¼Œä¼šâ½£æˆæ–°çš„ Token æ›¿æ¢æ—§çš„Tokenï¼Œç›¸åº” Cookie çš„ Max-Age ä¹Ÿä¼šé‡ç½®ã€‚</p>\n</li>\n</ul>\n<h1>13. CSRFæ”»å‡»</h1>\n<ul>\n<li>CSRFçš„å…¨ç§°æ˜¯Cross-Site Request Forgeryï¼Œç¿»è¯‘æˆä¸­â½‚æ˜¯è·¨ç«™è¯·æ±‚ä¼ªé€ ã€‚</li>\n<li>ä»å®‰å…¨æ€§çš„â»†åº¦æ¥è¯´ï¼ŒCSRFæ˜¯â¼€ç§æ”»å‡»â¼¿æ®µï¼Œå³æ”»å‡»è€…ç›—â½¤â½¤æˆ·èº«ä»½ï¼Œç„¶åä»¥â½¤æˆ·åä¹‰å‘ç¬¬ä¸‰â½…â½¹ç«™å‘é€æ¶æ„è¯·æ±‚ã€‚å®ƒè¯±éª—webæµè§ˆå™¨åœ¨â½¤æˆ·ç™»å½•çš„åº”â½¤ç¨‹åºä¸­æ‰§â¾ä¸éœ€è¦çš„æ“ä½œã€‚\n<ul>\n<li>â½¤æˆ·Aç™»å½•Xé“¶â¾å®˜â½¹ï¼Œé“¶â¾æœåŠ¡å™¨ä¸ºâ½¤æˆ·Aå¼€è¾ŸSessionä¿å­˜è®¤è¯é€šè¿‡æ•°æ®ï¼Œå“åº”è¿”å›åâ½¤æˆ·Aæµè§ˆå™¨çš„CookieæŒæœ‰SessionIdï¼Œä¸‹æ¬¡æ“ä½œâ½†éœ€å†æ¬¡ç™»å½•</li>\n<li>è¿™æ—¶â½¤æˆ·Aæ”¶åˆ°æœ¬åœ°ç”µè„‘æŸâ¿Šå®¢è½¯ä»¶å‘æ¥çš„â¼´å‘Šï¼Œâ½¤æˆ·ç‚¹å‡»åè·³è½¬åˆ°Xé’“â»¥ç«™ï¼ŒXé’“â»¥ç«™å‘Xé“¶â¾â½¹ç«™å‘èµ·Redirectâ€œè½¬è´¦â€è¯·æ±‚</li>\n<li>æµè§ˆå™¨æ”¶åˆ°Xé’“â»¥ç«™å‘æ¥çš„Rediectâ€œè½¬è´¦â€è¯·æ±‚ï¼Œå› ä¸ºâ½¤æˆ·ä¹‹å‰å·²ç»è®¤è¯è¿‡äº†ï¼Œå®˜â½¹å°±è®¤ä¸ºè¯¥â½¤æˆ·çœŸçš„è¦å‘èµ·â€œè½¬è´¦â€æ“ä½œï¼Œäºæ˜¯â½¤æˆ·â¾¦é’±å°±å—åˆ°æŸå¤±</li>\n</ul>\n</li>\n<li>CSRFä¿æŠ¤çš„åŸºæœ¬æ€æƒ³å°±æ˜¯ä¸ºç³»ç»Ÿä¸­çš„æ¯ä¸ªè¿æ¥è¯·æ±‚åŠ ä¸Šâ¼€ä¸ªéšæœºå€¼ï¼Œç§°ä¸ºcsrf_tokenã€‚å½“â½¤æˆ·Aå‘Xé“¶â¾å‘é€è¯·æ±‚å‰ï¼ŒXé“¶ä¸ºå…¶â½£æˆâ¼€ä¸ªTokenä»¤ç‰Œï¼Œâ½½åœ¨æµè§ˆå™¨å‘é€è¯·æ±‚æ—¶ï¼Œæ‰€æäº¤çš„æ•°æ®ï¼ˆCookieæˆ–è€…Headerï¼‰ä¸­ä¹Ÿä¼šæœ‰â¼€ä¸ªéšè—çš„csrf_tokenã€‚è¿™æ ·Xå®˜â½¹æ¥æ”¶åˆ°è¯·æ±‚ä¹‹åï¼Œâ¼€â½…â¾¯ä»Sessionæˆ–å…¶ä»–å­˜å‚¨ä»‹è´¨ä¸­æå–å‡ºcsrf_tokenï¼Œå¦â¼€â½…â¾¯è·å–æ¥â¾ƒæµè§ˆå™¨çš„csrf_tokenï¼Œå°†ä¸¤è€…è¿›â¾â½å¯¹ï¼Œå¦‚æœä¸â¼€è‡´å°±ä»£è¡¨è¿™æ˜¯â¼€ä¸ªä¼ªé€ çš„è¯·æ±‚ã€‚csrf_tokenæ˜¯â¼€æ¬¡æ€§çš„ï¼Œä½¿â½¤â¼€æ¬¡åä¼šâ½´å³ä»Sessionæ¸…æ¥šï¼Œä¸‹â¼€æ¬¡åŒæ ·æŒæœ‰ç›¸åŒcsrf_tokençš„ä¼ªé€ è¯·æ±‚å°†è¢«æ‹’ç»</li>\n<li>Spring Securityä¸“â»”æä¾›äº†â¼€ä¸ªè¿‡æ»¤å™¨ç»„ä»¶â€”â€”CsrfFilteræ¥å®ç°å¯¹CSRFçš„ä¿æŠ¤ï¼Œé»˜è®¤å¼€å¯ã€‚CsrfFilteræ‹¦æˆªè¯·æ±‚ï¼Œå¹¶å…è®¸é€šè¿‡é‚£äº›ä½¿â½¤GETã€HEADã€TRACEå’ŒOPTIONSç­‰HTTPâ½…æ³•çš„è¯·æ±‚ã€‚â½½å¯¹äºPUTã€POSTã€DELETEç­‰ä¼šä¿®æ”¹æ•°æ®çš„å…¶ä»–è¯·æ±‚CsrfFilterå¸Œæœ›æ¥æ”¶åŒ…å«csrf_tokenå€¼çš„æ¶ˆæ¯å¤´ã€‚å¦‚æœè¯¥æ¶ˆæ¯å¤´ä¸å­˜åœ¨æˆ–åŒ…å«ä¸æ­£ç¡®çš„csrf_tokenå€¼ï¼Œåˆ™Webåº”â½¤ç¨‹åºå°†æ‹’ç»è¯¥è¯·æ±‚ã€‚</li>\n<li>CsrfTokenRepositoryæ˜¯Tokenä»¤ç‰Œçš„å­˜å‚¨æ“ä½œç±»ï¼Œé»˜è®¤CsrfTokenå°†æœåŠ¡å™¨ç«¯Tokenå­˜å‚¨åˆ°åˆ°Sessionä¼šè¯ä¸­ï¼Œå¦‚æœé¡¹â½¬ä¸å…è®¸ä½¿â½¤Sessionå¯ä»¥â¾ƒâ¼°å®ç°â¼€ä¸ªCsrfTokenRepositoryå°†å…¶è½¬å­˜åˆ°MySQLã€Redisä¸­å³å¯ã€‚</li>\n</ul>\n<h1>14. Spring Securityå…¥é—¨</h1>\n<ul>\n<li>pom.xml</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;dependency&gt;\n &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n &lt;artifactId&gt;spring-boot-starter-security&lt;/artifactId&gt;\n&lt;/dependency&gt;\n</code></pre></div><ul>\n<li>application.properties</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>server.port=80\n</code></pre></div><ul>\n<li>SampleController</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>package com.example.firstspringsecurity.controller;\nimport org.springframework.web.bind.annotation.GetMapping;\nimport org.springframework.web.bind.annotation.RestController;\n@RestController\npublic class SampleController {\n  @GetMapping(\"/hello\")\n  public String hello() {\n    return \"Hello World!\";\n  }\n}\n</code></pre></div><ul>\n<li>æ—¥å¿—</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>WARN 19580 </code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/e03536d14c58fb42b04bc.jpg",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "FastDFS",
      "url": "https://javaguide.cn/backend/server/fastdfs.html",
      "id": "https://javaguide.cn/backend/server/fastdfs.html",
      "summary": "FastDFS 1. ä»€ä¹ˆæ˜¯FastDFSï¼Ÿ FastDFSæ˜¯ç”¨cè¯­è¨€ç¼–å†™çš„ä¸€æ¬¾å›½äº§å¼€æºçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚è€ƒè™‘äº†å†—ä½™å¤‡ä»½ã€è´Ÿè½½å‡è¡¡ã€çº¿æ€§æ‰©å®¹ç­‰æœºåˆ¶ï¼Œå¹¶æ³¨é‡é«˜å¯ç”¨ã€é«˜æ€§èƒ½ç­‰æŒ‡æ ‡ï¼Œä½¿ç”¨FastDFSå¾ˆå®¹æ˜“æ­å»ºä¸€å¥—é«˜æ€§èƒ½çš„æ–‡ä»¶æœåŠ¡å™¨é›†ç¾¤æä¾›æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ç­‰æœåŠ¡ã€‚ 2. FastDFSæ¶æ„ FastDFSæ¶æ„åŒ…æ‹¬Tracker serverå’ŒStorage s...",
      "content_html": "<p>FastDFS</p>\n<!--more-->\n<h1>1. ä»€ä¹ˆæ˜¯FastDFSï¼Ÿ</h1>\n<ul>\n<li>FastDFSæ˜¯ç”¨cè¯­è¨€ç¼–å†™çš„ä¸€æ¬¾å›½äº§å¼€æºçš„åˆ†å¸ƒå¼æ–‡ä»¶ç³»ç»Ÿã€‚è€ƒè™‘äº†å†—ä½™å¤‡ä»½ã€è´Ÿè½½å‡è¡¡ã€çº¿æ€§æ‰©å®¹ç­‰æœºåˆ¶ï¼Œå¹¶æ³¨é‡é«˜å¯ç”¨ã€é«˜æ€§èƒ½ç­‰æŒ‡æ ‡ï¼Œä½¿ç”¨FastDFSå¾ˆå®¹æ˜“æ­å»ºä¸€å¥—é«˜æ€§èƒ½çš„æ–‡ä»¶æœåŠ¡å™¨é›†ç¾¤æä¾›æ–‡ä»¶ä¸Šä¼ ã€ä¸‹è½½ç­‰æœåŠ¡ã€‚</li>\n</ul>\n<h1>2. FastDFSæ¶æ„</h1>\n<ul>\n<li>FastDFSæ¶æ„åŒ…æ‹¬Tracker serverå’ŒStorage server</li>\n<li>å®¢æˆ·ç«¯è¯·æ±‚Tracker serveræ¥è°ƒåº¦Storage serverå®Œæˆæ–‡ä»¶ä¸Šä¼ å’Œä¸‹è½½ã€‚</li>\n<li>Trackerï¼šç®¡ç†é›†ç¾¤ï¼Œtrackerä¹Ÿå¯ä»¥å®ç°é›†ç¾¤ã€‚æ¯ä¸ªtrackerèŠ‚ç‚¹åœ°ä½å¹³ç­‰ã€‚æ”¶é›†Storageé›†ç¾¤çš„çŠ¶æ€ã€‚</li>\n<li>Tracker serverä½œç”¨æ˜¯è´Ÿè½½å‡è¡¡å’Œè°ƒåº¦ï¼Œé€šè¿‡Tracker serveråœ¨æ–‡ä»¶ä¸Šä¼ æ—¶å¯ä»¥æ ¹æ®ä¸€äº›ç­–ç•¥æ‰¾åˆ°å¯ä»¥å°†trackerç§°ä¸ºè¿½è¸ªæœåŠ¡å™¨æˆ–è°ƒåº¦æœåŠ¡å™¨ã€‚</li>\n<li>Storageï¼šå®é™…ä¿å­˜æ–‡ä»¶,åˆ†ä¸ºå¤šä¸ªç»„ï¼Œæ¯ä¸ªç»„ä¹‹é—´ä¿å­˜çš„æ–‡ä»¶æ˜¯ä¸åŒçš„ã€‚æ¯ä¸ªç»„å†…éƒ¨å¯ä»¥æœ‰å¤šä¸ªæˆå‘˜ï¼Œç»„æˆå‘˜å†…éƒ¨ä¿å­˜çš„å†…å®¹æ˜¯ä¸€æ ·çš„ï¼Œç»„æˆå‘˜çš„åœ°ä½æ˜¯ä¸€è‡´çš„ï¼Œæ²¡æœ‰ä¸»ä»çš„æ¦‚å¿µã€‚</li>\n<li>Storage serverä½œç”¨æ˜¯æ–‡ä»¶å­˜å‚¨ï¼Œå®¢æˆ·ç«¯ä¸Šä¼ çš„æ–‡ä»¶æœ€ç»ˆå­˜å‚¨åœ¨StorageæœåŠ¡å™¨ä¸Šï¼Œæä¾›æ–‡ä»¶ä¸Šä¼ æœåŠ¡ã€‚</li>\n<li>Storage serveræ²¡æœ‰å®ç°è‡ªå·±çš„æ–‡ä»¶ç³»ç»Ÿè€Œæ˜¯åˆ©ç”¨æ“ä½œç³»ç»Ÿ çš„æ–‡ä»¶ç³»ç»Ÿæ¥ç®¡ç†æ–‡ä»¶ã€‚å¯ä»¥å°†storageç§°ä¸ºå­˜å‚¨æœåŠ¡å™¨ã€‚</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ce01ce788e74df3757f7f.png\" alt=\"FastDFSæ¶æ„.png\" tabindex=\"0\"><figcaption>FastDFSæ¶æ„.png</figcaption></figure>\n<h1>3. æ–‡ä»¶ä¸Šä¼ çš„æµç¨‹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/84401f0fda44b9e561f09.png\" alt=\"æ–‡ä»¶ä¸Šä¼ æµç¨‹.png\" tabindex=\"0\"><figcaption>æ–‡ä»¶ä¸Šä¼ æµç¨‹.png</figcaption></figure>\n<ul>\n<li>å®¢æˆ·ç«¯ä¸Šä¼ æ–‡ä»¶åå­˜å‚¨æœåŠ¡å™¨å°†æ–‡ä»¶IDè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œæ­¤æ–‡ä»¶IDç”¨äºä»¥åè®¿é—®è¯¥æ–‡ä»¶çš„ç´¢å¼•ä¿¡æ¯ã€‚</li>\n<li>æ–‡ä»¶ç´¢å¼•ä¿¡æ¯åŒ…æ‹¬ï¼šç»„åï¼Œè™šæ‹Ÿç£ç›˜è·¯å¾„ï¼Œæ•°æ®ä¸¤çº§ç›®å½•ï¼Œæ–‡ä»¶åã€‚</li>\n<li>ç»„åï¼šæ–‡ä»¶ä¸Šä¼ åæ‰€åœ¨çš„storageç»„åç§°ï¼Œåœ¨æ–‡ä»¶ä¸Šä¼ æˆåŠŸåæœ‰storageæœåŠ¡å™¨è¿”å›ï¼Œéœ€è¦å®¢æˆ·ç«¯è‡ªè¡Œä¿å­˜ã€‚</li>\n<li>è™šæ‹Ÿç£ç›˜è·¯å¾„ï¼šstorageé…ç½®çš„è™šæ‹Ÿè·¯å¾„ï¼Œä¸ç£ç›˜é€‰é¡¹store_path*å¯¹åº”ã€‚å¦‚æœé…ç½®äº†store_path0åˆ™æ˜¯M00ï¼Œå¦‚æœé…ç½®äº†store_path1åˆ™æ˜¯M01ï¼Œä»¥æ­¤ç±»æ¨ã€‚</li>\n<li>æ•°æ®ä¸¤çº§ç›®å½•ï¼šstorageæœåŠ¡å™¨åœ¨æ¯ä¸ªè™šæ‹Ÿç£ç›˜è·¯å¾„ä¸‹åˆ›å»ºçš„ä¸¤çº§ç›®å½•ï¼Œç”¨äºå­˜å‚¨æ•°æ®æ–‡ä»¶ã€‚</li>\n<li>æ–‡ä»¶åï¼šä¸æ–‡ä»¶ä¸Šä¼ æ—¶ä¸åŒã€‚æ˜¯ç”±å­˜å‚¨æœåŠ¡å™¨æ ¹æ®ç‰¹å®šä¿¡æ¯ç”Ÿæˆï¼Œæ–‡ä»¶ååŒ…å«ï¼šæºå­˜å‚¨æœåŠ¡å™¨IPåœ°å€ã€æ–‡ä»¶åˆ›å»ºæ—¶é—´æˆ³ã€æ–‡ä»¶å¤§å°ã€éšæœºæ•°å’Œæ–‡ä»¶æ‹“å±•åç­‰ä¿¡æ¯ã€‚/group1/M00/02/44/wKgDrE34E8wAAAAAAAGkEIYJK42378.sh</li>\n</ul>\n<h1>4. æ–‡ä»¶ä¸‹è½½æµç¨‹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ee213691c6dcea40845d2.png\" alt=\"æ–‡ä»¶ä¸‹è½½æµç¨‹.png\" tabindex=\"0\"><figcaption>æ–‡ä»¶ä¸‹è½½æµç¨‹.png</figcaption></figure>\n<h1>5. åç«¯FastDFSä½¿ç”¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class FastDFSTest {\n\t@Test\n\tpublic void testFileUpload() throws Exception {\n\t\t// 1ã€åŠ è½½é…ç½®æ–‡ä»¶ï¼Œé…ç½®æ–‡ä»¶ä¸­çš„å†…å®¹å°±æ˜¯trackeræœåŠ¡çš„åœ°å€ã€‚tracker_server=192.168.25.133:22122\n\t\tClientGlobal.init(\"D:/workspaces-itcast/e3-manager-web/src/main/resources/resource/client.conf\");\n\t\t// 2ã€åˆ›å»ºä¸€ä¸ªTrackerClientå¯¹è±¡ã€‚ç›´æ¥newä¸€ä¸ªã€‚\n\t\tTrackerClient trackerClient = new TrackerClient();\n\t\t// 3ã€ä½¿ç”¨TrackerClientå¯¹è±¡åˆ›å»ºè¿æ¥ï¼Œè·å¾—ä¸€ä¸ªTrackerServerå¯¹è±¡ã€‚\n\t\tTrackerServer trackerServer = trackerClient.getConnection();\n\t\t// 4ã€åˆ›å»ºä¸€ä¸ªStorageServerçš„å¼•ç”¨ï¼Œå€¼ä¸ºnull\n\t\tStorageServer storageServer = null;\n\t\t// 5ã€åˆ›å»ºä¸€ä¸ªStorageClientå¯¹è±¡ï¼Œéœ€è¦ä¸¤ä¸ªå‚æ•°TrackerServerå¯¹è±¡ã€StorageServerçš„å¼•ç”¨\n\t\tStorageClient storageClient = new StorageClient(trackerServer, storageServer);\n\t\t// 6ã€ä½¿ç”¨StorageClientå¯¹è±¡ä¸Šä¼ å›¾ç‰‡ã€‚æœ€åä¸€ä¸ªå‚æ•°æ˜¯å…ƒæ•°æ®ï¼Œå°±æ˜¯å›¾ç‰‡çš„è¯¦ç»†ä¿¡æ¯\n\t\t//æ‰©å±•åä¸å¸¦â€œ.â€\n\t\tString[] strings = storageClient.upload_file(\"D:/Documents/Pictures/images/200811281555127886.jpg\", \"jpg\", null);\n\t\t// 7ã€è¿”å›æ•°ç»„ã€‚åŒ…å«ç»„åå’Œå›¾ç‰‡çš„è·¯å¾„ã€‚\n\t\tfor (String string : strings) {\n\t\t\tSystem.out.println(string);\n\t\t}\n\t}\n}\n</code></pre></div><h1>6. å‰ç«¯å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½</h1>\n<ul>\n<li>ä½¿ç”¨çš„æ˜¯KindEditorçš„å¤šå›¾ç‰‡ä¸Šä¼ æ’ä»¶ã€‚</li>\n<li>KindEditor 4.x æ–‡æ¡£<a href=\"http://kindeditor.net/doc.php\" target=\"_blank\" rel=\"noopener noreferrer\">http://kindeditor.net/doc.php</a></li>\n<li>KindEditorçš„å¤šå›¾ç‰‡ä¸Šä¼ æ’ä»¶æœ€åå“åº”çš„content-typeæ˜¯text/planæ ¼å¼çš„jsonå­—ç¬¦ä¸²ã€‚å…¼å®¹æ€§æ˜¯æœ€å¥½çš„</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/ce01ce788e74df3757f7f.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Hexo",
      "url": "https://javaguide.cn/backend/server/hexo.html",
      "id": "https://javaguide.cn/backend/server/hexo.html",
      "summary": "è®°å½•ä¸€ä¸‹æ­å»ºåšå®¢ 1. é…ç½® 2. VSCodeé…ç½® 1. é…ç½® 2. VSCodeé…ç½®",
      "content_html": "<p>è®°å½•ä¸€ä¸‹æ­å»ºåšå®¢</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-%E9%85%8D%E7%BD%AE\">1. é…ç½®</a></li>\n<li><a href=\"#2-vscode%E9%85%8D%E7%BD%AE\">2. VSCodeé…ç½®</a></li>\n</ul>\n<!-- /TOC -->\n<h1>1. é…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code># å®‰è£…ï¼šnode.jsã€git\n# åˆ›å»ºåšå®¢æ–‡ä»¶å¤¹ \n- hexo init\n# å®‰è£…ä¾èµ–åŒ…\n- npm install\n# æœ¬åœ°è°ƒè¯• æµè§ˆå™¨ä¸­è¾“å…¥ localhost:4000\n- hexo generate \n- hexo server\n# åˆ›å»º  ç”¨æˆ·å.github.io ä»“åº“\n# ç¼–è¾‘æœ¬åœ°Hexoç›®å½•ä¸‹æ–‡ä»¶_config.yml,åœ¨æœ€åæ·»åŠ å¦‚ä¸‹ä»£ç \ndeploy:\n  type: git\n  repository: http://github.com/ç”¨æˆ·å/ç”¨æˆ·å.github.io.git\n  branch: master\n# éƒ¨ç½²åˆ°github\n- hexo generate \n- hexo deploy\n\n# ç”ŸæˆSSH\nssh-keygen -t rsa -C \"1105128664@qq.com\"ï¼Œä¸€è·¯å›è½¦\næ‰¾åˆ°æœ¬ç”¨æˆ·ä¸‹çš„C:\\Users\\${username}\\.ssh\\id_rsaæŠŠé‡Œé¢çš„å†…å®¹å¤åˆ¶\nåœ¨githubä¸Šé¢å¯¹åº”çš„ä»“åº“ç‚¹å‡»Settingï¼Œç„¶åç‚¹å‡»Deploy Keys\né»è´´åˆšæ‰çš„å†…å®¹ï¼ŒAllow write access æ‰“é’©ï¼Œç‚¹å‡»Add Key\n\n# æµ‹è¯•ä¸Šä¼ \nssh -T git@github.comï¼Œå³ä½¿æŠ¥é”™ä¹Ÿä¸€è·¯ç‚¹yes,è‡³æ­¤é…ç½®æˆåŠŸ\ngit config --global user.name \"yourusername\"\ngit config --golbal user.email \"youremail\"\né…ç½®ä»¥ä¸Šä¸¤ä¸ªå»æ‰å¾ˆå¤šè­¦å‘Š\n</code></pre></div><h1>2. VSCodeé…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ctrl+shift+P æ‰¾åˆ° Markdown Preview Enhanced: Extend Parserï¼Œæ‰“å¼€ parser.js\n\nä¿®æ”¹å…¶ä¸­ onWillParseMarkdown æ–¹æ³•ä¸ºï¼š\n  onWillParseMarkdown: async function(markdown) {\n    return new Promise((resolve, reject)=&gt; {\n      /** å¤„ç† {% asset_img xxx%}**/\n      // markdown = markdown.replace(\n      // /\\{%\\s*asset_img\\s*(.*)\\s*%\\}/g,\n      // (whole, content) =&gt; (`![](/source/_posts/${markdown.match(/title\\: (\\S*)/)[1]}/${content})`)\n      // )\n      /** å¤„ç† [](xxx.html/xxx)**/\n      // markdown = markdown.replace(\n      //   /\\[.*]\\(.*\\.html\\/.*\\)/g,\n      //   (whole, content) =&gt; (`${whole}`.replace(/\\.html\\//g,'.md/'))\n      //     )\n      /** å¤„ç† [](xxx/xxxx.png)**/\n      // markdown = markdown.replace(\n      //   /!\\[.*]\\(.*\\.(png|jpg|gif)\\)/g,\n      //   (whole, content) =&gt; (`${whole}`.replace(/]\\(/g,'](/docs/.vuepress/public/'))\n      // )\n  \n      /** å¤„ç† [](xxxx.png)**/\n      markdown = markdown.replace(\n        /!\\[.*]\\(.*\\.(png|jpg|gif)\\)/g,\n        (whole, content) =&gt; (`${whole}`.replace(/]\\(/g,`](./${markdown.match(/title\\: (\\S*)/)[1]}/`))\n      )\n  \n      return resolve(markdown)\n    })\n  },\n</code></pre></div>",
      "image": "https://javaguide.cn/source/_posts/${markdown.match(/title\\: (\\S*",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Netty",
      "url": "https://javaguide.cn/backend/server/netty.html",
      "id": "https://javaguide.cn/backend/server/netty.html",
      "summary": "linuxç½‘ç»œI/Oæ¨¡å‹(å¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€ï¼Œåº•å±‚æ”¯æŒå¼‚æ­¥I/Oé€šä¿¡) linuxçš„å†…æ ¸å°†æ‰€æœ‰å¤–éƒ¨è®¾å¤‡éƒ½çœ‹ä½œä¸€ä¸ªæ–‡ä»¶æ¥æ“ä½œï¼Œå¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œä¼šè°ƒç”¨å†…æ ¸æä¾›çš„ç³»ç»Ÿå‘½ä»¤ï¼Œè¿”å›ä¸€ä¸ªfile descriptor(fdï¼Œæ–‡ä»¶æè¿°ç¬¦)ã€‚è€Œå¯¹ä¸€ä¸ªsocketçš„è¯»å†™ä¹Ÿä¼šæœ‰ç›¸åº”çš„æè¿°ç¬¦ï¼Œæˆä¸ºsocketfd(socketæè¿°ç¬¦)ï¼Œæè¿°ç¬¦å°±æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå®ƒåªæƒ³å†…æ ¸ä¸­çš„ä¸€ä¸ªç»“...",
      "content_html": "<!-- more -->\n<ul>\n<li>linuxç½‘ç»œI/Oæ¨¡å‹(å¯¹äºæ“ä½œç³»ç»Ÿè€Œè¨€ï¼Œåº•å±‚æ”¯æŒå¼‚æ­¥I/Oé€šä¿¡)\n<ul>\n<li>linuxçš„å†…æ ¸å°†æ‰€æœ‰å¤–éƒ¨è®¾å¤‡éƒ½çœ‹ä½œä¸€ä¸ªæ–‡ä»¶æ¥æ“ä½œï¼Œå¯¹æ–‡ä»¶çš„è¯»å†™æ“ä½œä¼šè°ƒç”¨å†…æ ¸æä¾›çš„ç³»ç»Ÿå‘½ä»¤ï¼Œè¿”å›ä¸€ä¸ªfile descriptor(fdï¼Œæ–‡ä»¶æè¿°ç¬¦)ã€‚è€Œå¯¹ä¸€ä¸ªsocketçš„è¯»å†™ä¹Ÿä¼šæœ‰ç›¸åº”çš„æè¿°ç¬¦ï¼Œæˆä¸ºsocketfd(socketæè¿°ç¬¦)ï¼Œæè¿°ç¬¦å°±æ˜¯ä¸€ä¸ªæ•°å­—ï¼Œå®ƒåªæƒ³å†…æ ¸ä¸­çš„ä¸€ä¸ªç»“æ„ä½“ï¼ˆæ–‡ä»¶è·¯å¾„ï¼Œæ•°æ®åŒºç­‰ä¸€ä¸ªäº›å±æ€§ï¼‰</li>\n<li>æ ¹æ®UNIXç½‘ç»œç¼–ç¨‹å¯¹I/Oæ¨¡å‹çš„åˆ†ç±»ï¼ŒUNIXæä¾›äº†5ä¸­I/Oæ¨¡å‹\n<ul>\n<li>é˜»å¡I/Oæ¨¡å‹:ç¼ºçœæƒ…å½¢ä¸‹ï¼Œæ‰€æœ‰æ–‡ä»¶çš„æ“ä½œéƒ½æ˜¯é˜»å¡çš„ã€‚ä»¥å¥—æ¥å­—æ¥å£ä¸ºä¾‹ï¼šåœ¨è¿›ç¨‹ç©ºé—´ä¸­è°ƒç”¨recvfromï¼Œå…¶ç³»ç»Ÿè°ƒç”¨ç›´åˆ°æ•°æ®åŒ…åˆ°è¾¾ä¸”è¢«å¤åˆ¶åˆ°åº”ç”¨è¿›ç¨‹çš„ç¼“å†²åŒºä¸­æˆ–è€…å‘ç”Ÿé”™è¯¯æ—¶æ‰è¿”å›ï¼Œåœ¨æ­¤æœŸé—´ä¸€ç›´ä¼šç­‰å¾…ï¼Œè¿›ç¨‹åœ¨ä»è°ƒç”¨recvfromå¼€å§‹åˆ°å®ƒè¿”å›çš„äº‰ç«¯æ—¶é—´å†…éƒ½æ˜¯è¢«é˜»å¡çš„</li>\n<li>éé˜»å¡I/Oæ¨¡å‹:recvfromä»åº”ç”¨å±‚åˆ°å†…æ ¸çš„æ—¶å€™ï¼Œå¦‚æœè¯¥ç¼“å†²åŒºæ²¡æœ‰æ•°æ®çš„è¯ï¼Œå°±ç›´æ¥è¿”å›ä¸€ä¸ªEWOULDBLIOCKé”™è¯¯ï¼Œä¸€èˆ¬éƒ½å¯¹éé˜»å¡I/Oæ¨¡å‹è¿›è¡Œè½®è¯¢æ£€æŸ¥è¿™ä¸ªçŠ¶æ€ï¼Œçœ‹å†…æ ¸æ˜¯ä¸æ˜¯åˆæ•°æ®åˆ°æ¥</li>\n<li>I/Oå¤ç”¨æ¨¡å‹:linuxæä¾›select/pollï¼Œè¿›ç¨‹é€šè¿‡å°†ä¸€ä¸ªæˆ–å¤šä¸ªfdä¼ é€’ç»™selectæˆ–epollç³»ç»Ÿè°ƒç”¨ï¼Œé˜»å¡åœ¨selectæ“ä½œä¸Šï¼Œè¿™æ ·select/pollå¯ä»¥æ£€æµ‹åˆ°å¤šä¸ªfdæ˜¯å¦å¤„äºå°±ç»ªçŠ¶æ€ï¼Œselect/pollæ˜¯é¡ºåºæ‰«æfdæ˜¯å¦å°±ç»ªï¼Œè€Œä¸”æ”¯æŒçš„fdæ•°é‡æœ‰é™ã€‚linuxè¿˜æä¾›äº†ä¸€ä¸ªepollç³»ç»Ÿè°ƒç”¨ï¼Œepollä½¿ç”¨åŸºäºæ—¶é—´é©±åŠ¨æ–¹å¼ä»£æ›¿é¡ºåºæ‰«æï¼Œæ€§èƒ½æ›´é«˜ã€‚å½“æœ‰fdå°±ç»ªæ˜¯ï¼Œå°±ç«‹å³å›è°ƒå‡½æ•°rollback</li>\n<li>ä¿¡å·é©±åŠ¨I/Oæ¨¡å‹:é¦–å…ˆå¼€å¯å¥—æ¥æ‰£ä¿¡å·é©±åŠ¨I/OåŠŸèƒ½ï¼Œå¹¶é€šè¿‡ç³»ç»Ÿè°ƒç”¨sigactionæ‰§è¡Œä¸€ä¸ªä¿¡å·å¤„ç†å‡½æ•°ï¼ˆæ­¤ç³»ç»Ÿè°ƒç”¨ç«‹å³è¿”å›ï¼Œè¿›ç¨‹ç»§ç»­å·¥ä½œï¼Œéé˜»å¡ï¼‰ã€‚å½“æ•°æ®å‡†å¤‡å°±ç»ªæ—¶ï¼Œå°±ä¸ºè¯¥è¿›ç¨‹ç”Ÿæˆä¸€ä¸ªSIGIOä¿¡å·ï¼Œé€šè¿‡ä¿¡å·å›è°ƒé€šçŸ¥åº”ç”¨ç¨‹åºè°ƒç”¨recvfromæ¥è¯»å–æ•°æ®ï¼Œå¹¶é€šçŸ¥ä¸»å¾ªç¯å‡½æ•°å¤„ç†æ•°æ®ã€‚</li>\n<li>å¼‚æ­¥I/O:å‘ŠçŸ¥å†…æ ¸å¯åŠ¨æŸä¸ªæ“ä½œï¼Œå¹¶è®©å†…æ ¸åœ¨æ•´ä¸ªæ“ä½œå®Œæˆåï¼ˆåŒ…æ‹¬å°†æ•°æ®ä»å†…æ ¸å¤åˆ¶åˆ°ç”¨æˆ·è‡ªå·±çš„ç¼“å†²åŒºï¼‰é€šçŸ¥è°ƒç”¨è€…ï¼Œä¸ä¿¡å·é©±åŠ¨æ¨¡å‹çš„ä¸»è¦åŒºåˆ«æ˜¯ï¼šä¿¡å·é©±åŠ¨I/Oæœ‰å†…æ ¸é€šçŸ¥æˆ‘ä»¬ä»€ä¹ˆæ—¶å€™å¼€å§‹I/Oæ“ä½œï¼Œè€Œå¼‚æ­¥I/Oæ¨¡å‹è¿™ç”±å†…æ ¸é€šçŸ¥æˆ‘ä»¬I/Oæ“ä½œä½•æ—¶å®Œæˆ</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>I/Oå¤šè·¯å¤ç”¨æŠ€æœ¯\n<ul>\n<li>é€šè¿‡æŠŠå¤šä¸ªI/Oçš„é˜»å¡å¤ç”¨åˆ°åŒä¸€ä¸ªselectçš„é˜»å¡ä¸Šï¼Œä»è€Œä½¿å¾—ç³»ç»Ÿåœ¨å•çº¿ç¨‹çš„æƒ…å†µä¸‹å¯ä»¥åŒæ—¶å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯éœ€æ±‚ï¼Œä¸ä¼ ç»Ÿçš„å¤šçº¿ç¨‹/å¤šè¿›ç¨‹æ¨¡å‹ç›¸æ¯”ï¼ŒI/Oå¤šè·¯å¤ç”¨çš„æœ€å¤§ä¼˜åŠ¿æ˜¯ç³»ç»Ÿå¼€é”€å°ï¼Œç³»ç»Ÿä¸éœ€è¦åˆ›å»ºæ–°çš„é¢å¤–è¿›ç¨‹æˆ–è€…çº¿ç¨‹ã€‚ä¹Ÿä¸éœ€è¦ç»´æŠ¤è¿™äº›è¿›ç¨‹å’Œçº¿ç¨‹çš„è¿è¡Œï¼Œé™ä½äº†ç³»ç»Ÿçš„è‹‡æ¹–æ¢ï¼ŒèŠ‚çœç³»ç»Ÿèµ„æº</li>\n<li>I/Oå¤ç”¨çš„ä¸»è¦åº”ç”¨åœºæ™¯ï¼šæœåŠ¡å™¨éœ€è¦åŒæ—¶å¤„ç†å¤šä¸ªå¤„äºç›‘å¬çŠ¶æ€æˆ–è€…å¤šä¸ªè¿æ¥çŠ¶æ€çš„å¥—æ¥å­—ï¼Œå¤šç§ç½‘ç»œåè®®çš„å¥—æ¥å­—</li>\n<li>ç›®å‰æ”¯æŒI/Oå¤šè·¯å¤ç”¨çš„ç³»ç»Ÿè°ƒç”¨æœ‰selectï¼Œpselectï¼Œpollï¼Œepollï¼Œepollæ–°ç‰¹æ€§\n<ul>\n<li>æ”¯æŒä¸€ä¸ªè¿›ç¨‹çš„socketæè¿°ç¬¦ï¼ˆFDï¼‰ä¸å—é™åˆ¶ï¼ˆä»…å—é™äºæ“ä½œç³»ç»Ÿçš„æœ€å¤§æ–‡ä»¶å¥æŸ„æ•°ï¼‰ï¼šselectæœ€å¤§çš„ç¼ºé™·æ˜¯å•ä¸ªè¿›ç¨‹æ‰€æ‰“å¼€çš„FDæ˜¯æœ‰ä¸€å®šé™åˆ¶çš„ï¼Œå®ƒç”±FD_SETSIZEè®¾ç½®ï¼Œé»˜è®¤1024ã€‚å¯ä»¥é€‰æ‹©ä¿®æ”¹è¿™ä¸ªå®ç„¶åé‡æ–°ç¼–è¯‘å†…æ ¸ï¼Œä½†è¿™å›å¸¦æ¥ç½‘ç»œæ•ˆç‡çš„ä¸‹é™ã€‚ä¹Ÿå¯ä»¥é€‰æ‹©å¤šè¿›ç¨‹çš„æ–¹æ¡ˆï¼ˆApacheï¼‰ï¼Œä½†åˆ›å»ºè¿›ç¨‹éœ€è¦ä»˜å‡ºä¸€å®šä»£ä»·ï¼Œè€Œä¸”è¿›ç¨‹ä¹‹é—´çš„æ•°æ®äº¤æ¢éå¸¸éº»çƒ¦ã€‚å¯¹äºæ²¡æœ‰å…±äº«å†…å­˜çš„javaï¼Œéœ€è¦é€šè¿‡socketé€šä¿¡æˆ–è€…å…¶å®ƒæ–¹å¼è¿›è¡Œæ•°æ®åŒæ­¥ï¼Œå¸¦æ¥é¢å¤–çš„æ€§èƒ½æ¶ˆè€—ï¼Œå¢åŠ äº†ç¨‹åºå¤æ‚åº¦ã€‚1GBå†…å­˜çš„æœºå™¨ä¸Šå¤§çº¦10ä¸‡ä¸ªå¥æŸ„å·¦å³</li>\n<li>I/Oæ•ˆç‡ä¸ä¼šéšç€FDæ•°ç›®çš„å¢åŠ è€Œçº¿æ€§ä¸‹é™:ä¼ ç»Ÿçš„select/pollå¦ä¸€ä¸ªè‡´å‘½å¼±ç‚¹å°±æ˜¯å½“ä½ æ‹¥æœ‰ä¸€ä¸ªå¾ˆå¤§çš„socketé›†åˆï¼Œç”±äºç½‘ç»œå»¶æ—¶æˆ–è€…é“¾è·¯ç©ºé—²ï¼Œåœ¨ä»»ä¸€æ—¶åˆ»åªæœ‰å°‘éƒ¨åˆ†çš„socketæ˜¯\"æ´»è·ƒ\"çš„ï¼Œä½†æ˜¯select/pollæ¯æ¬¡è°ƒç”¨éƒ½ä¼šç°è¡Œæ‰«æå…¨éƒ¨çš„é›†åˆï¼Œå¯¼è‡´æ•ˆç‡å‘ˆç°çº¿æ€§ä¸‹é™ã€‚è€Œå†…æ ¸å®ç°ä¸­epollæ˜¯æ ¹æ®æ¯ä¸ªfdä¸Šé¢çš„callbackå‡½æ•°å®ç°çš„ï¼Œåªæœ‰æ´»è·ƒçš„socketæ‰ä¼šä¸»åŠ¨è°ƒç”¨callbackå‡½æ•°ï¼Œå…¶å®ƒçš„idleçŠ¶æ€socketåˆ™ä¸ä¼šã€‚epollå®ç°äº†ä¸€ä¸ªä¼ªAIO</li>\n<li>ä½¿ç”¨mmapåŠ é€Ÿå†…æ ¸ä¸ç”¨æˆ·ç©ºé—´çš„æ¶ˆæ¯ä¼ é€’:æ— è®ºselectï¼Œpollè¿˜æ˜¯epolléƒ½éœ€è¦å†…æ ¸æŠŠFDæ¶ˆæ¯é€šçŸ¥ç»™ç”¨æˆ·ç©ºé—´ï¼Œå¦‚ä½•é¿å…ä¸å¿…è¦çš„å†…å­˜å¤åˆ¶å°±æ˜¾å¾—éå¸¸é‡è¦ï¼Œepollæ˜¯é€šè¿‡å†…æ ¸å’Œç”¨æˆ·æ§ä»¶mmapåŒä¸€å—å†…å­˜å®ç°</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>NIOå…¥é—¨\n<ul>\n<li>ä¼ ç»Ÿçš„åŒæ­¥é˜»å¡BIOç¼–ç¨‹:é‡‡ç”¨BIOé€šä¿¡æ¨¡å‹çš„æœåŠ¡ç«¯ï¼Œé€šå¸¸ç”±ä¸€ä¸ªç‹¬ç«‹çš„Acceptorçº¿ç¨‹è´Ÿè´£ç›‘å¬å®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå®ƒæ¥æ”¶åˆ°å®¢æˆ·ç«¯è¿æ¥è¯·æ±‚ä¹‹åæœªæ¯ä¸ªå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªæ–°çš„çº¿ç¨‹è¿›è¡Œé“¾è·¯å¤„ç†ï¼Œå¤„ç†å®Œæˆä¹‹åï¼Œé€šè¿‡è¾“å‡ºæµè¿”å›åº”ç­”ç»™å®¢æˆ·ç«¯ï¼Œçº¿ç¨‹é”€æ¯ï¼ˆå…¸å‹çš„å·²è¯·æ±‚ä¸€åº”ç­”é€šä¿¡æ¨¡å‹ï¼‰ã€‚è¯¥æ¨¡å‹æœ€å¤§çš„é—®é¢˜æ˜¯å½“å®¢æˆ·ç«¯å¹¶å‘è®¿é—®é‡å¢åŠ åï¼ŒæœåŠ¡ç«¯çš„çº¿ç¨‹ä¸ªæ•°å’Œå®¢æˆ·ç«¯å¹¶å‘è®¿é—®æ•°æˆ1:1æ­£æ¯”å…³ç³»ï¼Œå¹¶å‘é‡å¾ˆå¤§æ˜¯ï¼Œç³»ç»Ÿä¼šå‘ç”Ÿçº¿ç¨‹å †æ ˆæº¢å‡ºã€åˆ›å»ºæ–°çº¿ç¨‹å¤±è´¥ç­‰é—®é¢˜ï¼Œå¯¼è‡´è¿›ç¨‹å®•æœºæˆ–åƒµæ­»ï¼Œä¸èƒ½å¯¹å¤–æä¾›æœåŠ¡ã€‚</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer{\n    \n    public static void main(String[] args) throws IOException{\n        int port = 6666;\n        ServerSocket serverSocket = null;\n        try {\n            serverSocket = new ServerSocket(port);\n            Socket socket = null;\n            System.out.println(\"BIOServer listening...\");\n            while (true){//é˜»å¡\n                socket = serverSocket.accept();\n                new Thread(new TimeServerHandler(socket)).start();\n            }\n        } finally {\n            if(serverSocket != null){\n              serverSocket.close();\n              serverSocket = null;\n            }\n        }\n    }\n}\n public class TimeServerHandler implements Runnable{\n \n    private  Socket socket;\n    public TimeServerHandler(Socket socket){\n        this.socket = socket;\n    }\n    @Override\n    public void run() {\n        BufferedReader bufferedReader = null;\n        PrintWriter printWriter = null;\n        try {\n            bufferedReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n            printWriter = new PrintWriter(this.socket.getOutputStream(),true);\n            String currentTime = null;\n            String body = null;\n            while (true){\n                body = bufferedReader.readLine();\n                if(body == null)break;\n                System.out.println(\"The time Server receive oder:\" + body);\n                currentTime = \"QUERY TIME ORDER\".equalsIgnoreCase(body)?new java.util.Date(System.currentTimeMillis()).toString():\"BAD ORDER\";\n                printWriter.println(currentTime);\n            }\n        } catch (IOException e) {\n            e.printStackTrace();\n            if(bufferedReader != null){\n                try {\n                    bufferedReader.close();\n                } catch (IOException e1) {\n                    e1.printStackTrace();\n                }\n            }\n            if(printWriter != null){\n                printWriter.close();\n                printWriter = null;\n            }\n            if(this.socket != null){\n                try {\n                    this.socket.close();\n                } catch (IOException e1) {\n                    e1.printStackTrace();\n                }\n                this.socket = null;\n            }\n        }\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeClient {\n    public static void main(String[] args) {\n        int port = 6666;\n        Socket socket = null;\n        BufferedReader bufferedReader = null;\n        PrintWriter printWriter = null;\n        try {\n            socket = new Socket(\"127.0.0.1\",port);\n            bufferedReader = new BufferedReader(new InputStreamReader(socket.getInputStream()));\n            printWriter = new PrintWriter(socket.getOutputStream(),true);\n            printWriter.println(\"QUERY TIME ORDER\");\n            System.out.println(\"Send oder 2 server succeed.\");\n            String resp = bufferedReader.readLine();\n            System.out.println(\"Now is : \"+ resp);\n        } catch (IOException e) {\n            e.printStackTrace();\n        } finally {\n            if(printWriter != null){\n                printWriter.close();\n            }\n            if(bufferedReader != null){\n                try {\n                    bufferedReader.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n            if(socket != null){\n                try {\n                    socket.close();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        }\n    }\n}\n</code></pre></div><ul>\n<li>ä¼ªå¼‚æ­¥I/Oç¼–ç¨‹:ä¸ºäº†è§£å†³åŒæ­¥é˜»å¡I/Oé¢ä¸´çš„ä¸€ä¸ªé“¾è·¯éœ€è¦ä¸€ä¸ªçº¿ç¨‹å¤„ç†çš„é—®é¢˜ï¼Œåæ¥å¯¹ä»–çš„çº¿ç¨‹æ¨¡å‹è¿›è¡Œä¼˜åŒ–ï¼Œåç«¯é€šè¿‡ä¸€ä¸ªçº¿ç¨‹æ± æ¥å¤„ç†å¤šä¸ªå®¢æˆ·ç«¯çš„è¯·æ±‚æ¥å…¥ï¼Œå½¢æˆå®¢æˆ·ç«¯ä¸ªæ•°Mï¼›çº¿ç¨‹æ± æœ€å¤§çº¿ç¨‹æ•°Nçš„æ¯”ä¾‹å…³ç³»ï¼Œå…¶ä¸­Må¯ä»¥è¿œè¿œå¤§äºNï¼Œé€šè¿‡çº¿ç¨‹æ± å¯ä»¥çµæ´»åœ°è°ƒé…çº¿ç¨‹èµ„æºï¼Œè®¾ç½®çº¿ç¨‹çš„æœ€å¤§å€¼ï¼Œé˜²æ­¢ç”±äºæµ·é‡å¹¶å‘æ¥å…¥å¯¼è‡´çº¿ç¨‹è€—å°½\n<ul>\n<li>ä¼ªå¼‚æ­¥I/Oé€šä¿¡å¼Šç«¯:\n<ul>\n<li>java.io.InputStreamçš„read(byte b[])æ–¹æ³•åœ¨å¯¹socketçš„è¾“å…¥æµè¿›è¡Œè¯»å–æ“ä½œçš„æ—¶å€™ï¼Œä¼šä¸€ç›´é˜»å¡ä¸‹å»ï¼Œç›´åˆ°å‘ç”Ÿ:1.æœ‰æ•°æ®å¯è¯»ï¼Œ2.å¯ç”¨æ•°æ®ä»¥åŠè¯»å–å®Œæ¯•ï¼Œ3.ç©ºæŒ‡é’ˆå¼‚å¸¸æˆ–è€…I/Oå¼‚å¸¸ã€‚å½“å¯¹æ–¹å‘é€è¯·æ±‚æˆ–è€…åº”ç­”æ¶ˆæ¯æ¯”è¾ƒç¼“æ…¢ã€æˆ–è€…ç½‘ç»œä¼ è¾“æ¯”è¾ƒæ…¢æ—¶ï¼Œè¯»å–è¾“å…¥æµçš„ä¸€æ–¹çš„é€šä¿¡çº¿ç¨‹å°†è¢«é•¿æ—¶é—´é˜»å¡ï¼Œåœ¨æ­¤æœŸé—´å…¶å®ƒæ¥å…¥æ¶ˆæ¯åªèƒ½åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­æ’é˜Ÿ</li>\n<li>java.io.OutputStreamwrite(byte b[])æ–¹æ³•åœ¨å¯¹socketçš„è¾“å‡ºæµè¿›è¡Œå†™æ“ä½œæ—¶ï¼Œä¼šä¸€ç›´é˜»å¡ä¸‹å»ï¼Œç›´åˆ°æ‰€æœ‰çš„å­—èŠ‚å…¨éƒ¨å†™å…¥å®Œæ¯•ï¼Œæˆ–è€…å‘ç”Ÿå¼‚å¸¸ã€‚å½“æ¶ˆæ¯çš„æ¥æ”¶æ–¹å¤„ç†ç¼“æ…¢çš„æ—¶å€™ï¼Œå°†ä¸èƒ½åŠæ—¶åœ°ä»TCPç¼“å†²åŒºè¯»å–æ•°æ®ï¼Œå°†å¯¼è‡´å‘é€æ–¹çš„TCP windows sizeä¸æ–­å‡å°ï¼Œç›´åˆ°ä¸º0ï¼ŒåŒæ–¹å¤„äºKeep-AliveçŠ¶æ€ï¼Œæ¶ˆæ¯å‘é€æ–¹å°†ä¸èƒ½å†å‘TCPç¼“å†²åŒºå†™å…¥æ¶ˆæ¯ï¼Œè¿™æ—¶å¦‚æœé¥¿é‡‡ç”¨çš„æ˜¯åŒæ­¥é˜»å¡I/Oï¼Œwriteæ“ä½œå°†è¢«äº”é™©é˜»å¡ï¼Œç›´åˆ°TCP windows size å¤§äº0 æˆ–è€…å‘ç”ŸI/Oå¼‚å¸¸ã€‚</li>\n</ul>\n</li>\n<li>å¯èƒ½çš„çº§è”æ•…éšœ:\n<ul>\n<li>æœåŠ¡ç«¯å¤„ç†ç¼“æ…¢ï¼Œè¿”å›åº”ç­”æ¶ˆæ¯è€—è´¹60s,å¹³æ—¶åªéœ€è¦10ms</li>\n<li>é‡‡ç”¨ä¼ªå¼‚æ­¥I/Oçš„çº¿ç¨‹æ­£åœ¨è¯»å–æ•…éšœæœåŠ¡èŠ‚ç‚¹çš„å“åº”ï¼Œç”±äºè¯»å–è¾“å…¥æµçš„é˜»å¡çš„ï¼Œå› æ­¤ï¼Œå®ƒå°†ä¼šè¢«åŒæ­¥é˜»å¡60s</li>\n<li>å‡å¦‚æ‰€æœ‰çš„å¯ç”¨çº¿ç¨‹éƒ½è¢«æ•…éšœæœåŠ¡å™¨é˜»å¡ï¼Œé‚£åç»­æ‰€æœ‰çš„I/Oæ¶ˆæ¯éƒ½å°†åœ¨é˜Ÿåˆ—ç§æ’é˜Ÿã€‚</li>\n<li>ç”±äºçº¿ç¨‹æ± é‡‡ç”¨é˜»å¡é˜Ÿåˆ—å®ç°ï¼Œå½“é˜Ÿåˆ—ç§¯æ»¡ä¹‹åï¼Œåç»­å¦‚é˜Ÿåˆ—çš„æ“ä½œå°†è¢«é˜»å¡</li>\n<li>ç”±äºå‰ç«¯åªæœ‰ä¸€ä¸ªAcceptorçº¿ç¨‹æ¥æ”¶å®¢æˆ·ç«¯æ¥å…¥ï¼Œå®ƒè¢«é˜»å¡åœ¨çº¿ç¨‹æ± åŒæ­¥é˜»å¡é˜Ÿåˆ—ä¹‹åï¼Œæ–°çš„å®¢æˆ·ç«¯è¯·æ±‚æ¶ˆæ¯å°†è¢«æ‹’ç»ï¼Œå®¢æˆ·ç«¯ä¼šå‘ç”Ÿå¤§é‡çš„è¿æ¥è¶…æ—¶ã€‚</li>\n<li>ç”±äºå‡ ä¹æ‰€æœ‰çš„è¿æ¥éƒ½è¶…æ—¶ï¼Œè°ƒç”¨è€…ä¼šè®¤ä¸ºç³»ç»Ÿå·²ç»å´©æºƒï¼Œæ— æ³•æ¥æ”¶æ–°çš„è¯·æ±‚æ¶ˆæ¯</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer{\n\n    public static void main(String[] args) throws IOException{\n        int port = 6666;\n        ServerSocket serverSocket = null;\n        try {\n            serverSocket = new ServerSocket(port);\n            Socket socket = null;\n            System.out.println(\"BIOServer listening...\");\n            ExecutorService executorService = new ThreadPoolExecutor(Runtime.getRuntime().availableProcessors(),50,120L, TimeUnit.SECONDS,new ArrayBlockingQueue&lt;Runnable&gt;(10000));\n            while (true){//é˜»å¡\n                socket = serverSocket.accept();\n                executorService.execute(new TimeServerHandler(socket));\n            }\n        } finally {\n            if(serverSocket != null){\n                serverSocket.close();\n                serverSocket = null;\n            }\n        }\n    }\n}\n</code></pre></div><ul>\n<li>NIOç¼–ç¨‹:\n<ul>\n<li>ç¼“å†²åŒºBuffer:Bufferæ˜¯ä¸€ä¸ªå¯¹è±¡ï¼ŒåŒ…å«ä¸€äº›è¦å†™å…¥æˆ–è€…è¯»å‡ºçš„æ•°æ®ï¼Œåœ¨é¢å‘æµçš„I/Oä¸­ï¼Œå¯ä»¥ç›´æ¥å°†æ•°æ®å†™å…¥æˆ–è€…å°†æ•°æ®ç›´æ¥è¯»åˆ°Streamå¯¹è±¡ä¸­ã€‚åœ¨NIOåº“ä¸­ï¼Œå†™å…¥å’Œè¯»å–æ•°æ®éƒ½æ˜¯ç”¨ç¼“å†²åŒºè¿›è¡Œå¤„ç†çš„ã€‚ç¼“å†²å™¨å®è´¨ä¸Šå¸‚ä¸€ä¸ªæ•°ç»„ã€‚é€šå¸¸æ˜¯ä¸€ä¸ªå­—èŠ‚æ•°ç»„ByteBufferï¼Œç¼“å†²åŒºæä¾›å¯¹æ•°æ®çš„ç»“æ„åŒ–è®¿é—®ä»¥åŠç»´æŠ¤è¯»å†™ä½ç½®limitç­‰ä¿¡æ¯ã€‚æ¯ä¸€ç§JavaåŸºæœ¬ç±»å‹ï¼ˆBooleané™¤å¤–ï¼‰éƒ½æœ‰å¯¹åº”çš„ç¼“å†²åŒºï¼ˆByteBufferã€CharBufferã€ShortBufferã€IntBufferã€LongBufferã€FloatBufferã€DoubleBufferï¼‰ã€‚å…¶ä¸­ByteBufferè¿˜æä¾›ç‰¹æ®Šçš„æ“ä½œï¼Œæ–¹ä¾¿ç½‘ç»œè¯»å†™</li>\n<li>é€šé“Channel:Channelæ˜¯ä¸€ä¸ªå…¨åŒå·¥é€šé“ï¼Œå¯ä»¥é€šè¿‡å®ƒå¯ä»¥åŒå‘åœ°è¯»ï¼Œå†™å…¥æˆ–è€…åŒæ—¶è¯»å†™æ•°æ®ï¼Œè€Œæµåªæ˜¯ä¸€ä¸ªæ–¹å‘ä¸Šç§»åŠ¨ï¼Œä¸€ä¸ªæµå¿…é¡»æ˜¯InputSteamæˆ–è€…OutputStreamçš„å­ç±»ã€‚Channelå¯ä»¥åˆ†æˆä¸¤å¤§ç±»ï¼šåˆ†åˆ«æ˜¯ç”¨äºç½‘ç»œè¯»å†™çš„SelectableChannelå’Œç”¨äºæ–‡ä»¶æ“ä½œçš„FileChannel</li>\n<li>å¤šè·¯å¤ç”¨å™¨Selector:æä¾›é€‰æ‹©å·²ç»å°±ç»ªçš„ä»»åŠ¡çš„èƒ½åŠ›ã€‚Selectorä¼šä¸æ–­åœ°è½®è¯¢æ³¨å†Œåœ¨å…¶ä¸Šçš„Channelï¼Œå¦‚æœæŸä¸ªChannelä¸Šé¢æœ‰æ–°çš„TCPè¿æ¥æ¥å…¥ã€è¯»å’Œå†™æ—¶é—´ï¼Œè¿™ä¸ªChannelå°±å¤„äºå°±ç»ªçŠ¶æ€ï¼Œä¼šè¢«Selectorè½®è¯¢å‡ºæ¥ï¼Œç„¶åé€šè¿‡SelectionKeyå°±å¯ä»¥è·å–å°±ç»ªChannelçš„é›†åˆï¼Œè¿›è¡Œåç»­çš„I/Oæ“ä½œã€‚ä¸€ä¸ªå¤šè·¯å¤ç”¨å™¨Selectorå¯ä»¥åŒæ—¶è½®è¯¢å¤šä¸ªChannelã€‚ä½¿ç”¨epollå®ç°ï¼Œå¹¶æ²¡æœ‰æœ€å¤§è¿æ¥å¥æŸ„1024/2048çš„é™åˆ¶ï¼ˆselectï¼‰ã€‚åªéœ€ä¸€ä¸ªçº¿ç¨‹è´Ÿè´£Selectorçš„è½®è¯¢ï¼Œå°±å¯ä»¥ä»‹å…¥æˆåƒä¸Šä¸‡çš„å®¢æˆ·ç«¯</li>\n<li>ä¼˜ç‚¹:\n<ul>\n<li>å®¢æˆ·ç«¯å‘èµ·çš„è¿æ¥æ“ä½œæ˜¯å¼‚æ­¥çš„ï¼Œå¯ä»¥é€šè¿‡å†å¤šè·¯å¤ç”¨å™¨æ³¨å†ŒOP_CONNECTç­‰å¾…åç»­ç»“æœï¼Œä¸éœ€è¦åƒä¹‹å‰å®¢æˆ·ç«¯é‚£æ ·è¢«åŒæ­¥é˜»å¡</li>\n<li>SocketChannelçš„è¯»å†™æ“ä½œéƒ½æ˜¯ä¸€æ­¥çš„ï¼Œå¦‚æœæ²¡æœ‰å¯è¯»å†™çš„æ•°æ®å®ƒä¸ä¼šåŒæ­¥ç­‰å¾…ï¼Œç›´æ¥è¿”å›ï¼Œè¿™æ ·I/Oé€šä¿¡çº¿ç¨‹å°±å¯ä»¥å¤„ç†å…¶ä»–çš„é“¾è·¯ï¼Œä¸éœ€è¦åŒæ­¥ç­‰å¾…è¿™ä¸ªé“¾è·¯å¯ç”¨</li>\n<li>çº¿ç¨‹æ¨¡å‹çš„ä¼˜åŒ–:JDKçš„Selectoråœ¨Linuxç­‰ä¸»æµæ“ä½œç³»ç»Ÿä¸Šé€šè¿‡epollå®ç°ï¼Œå®ƒæ²¡æœ‰å¥æŸ„æ•°é™åˆ¶ï¼ˆåªå—é™äºæ“ä½œç³»ç»Ÿçš„æœ€å¤§å¥æŸ„æ•°æˆ–è€…å¯¹å•ä¸ªè¿›ç¨‹çš„å¥æŸ„é™åˆ¶ï¼‰ã€‚ä¸€ä¸ªSelectorçº¿ç¨‹å¯ä»¥åŒæ—¶å¤„ç†æˆåƒä¸Šä¸‡ä¸ªå®¢æˆ·ç«¯çš„è¿æ¥ï¼Œå¹¶ä¸”æ€§èƒ½ä¸ä¼šéšç€å®¢æˆ·ç«¯çš„å¢åŠ è€Œçº¿æ€§ä¸‹é™</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer{\n\n    public static void main(String[] args) throws IOException{\n        int port = 6666;\n        MultiplexerTimeServer timeServer = new MultiplexerTimeServer(port);\n        new Thread(timeServer,\"NIO-MultplexerTimeServer-001\").start();\n    }\n\n}\npublic class MultiplexerTimeServer implements Runnable {\n    private Selector selector;\n    private ServerSocketChannel servChannnel;\n    private volatile boolean stop;\n    public MultiplexerTimeServer(int port){\n      try{\n        selector = Selector.open();\n        servChannnel = ServerSocketChannel.open();\n        servChannnel.configureBlocking(false);\n        servChannnel.socket().bind(new InetSocketAddress(port),1024);//https://www.cnblogs.com/qiumingcheng/p/9492962.html\n        servChannnel.register(selector, SelectionKey.OP_ACCEPT);\n        System.out.println(\"The time server is start in port :\" + port);\n      } catch (IOException e) {\n            e.printStackTrace();\n            System.exit(1);\n      }\n    }\n    public void stop(){\n        this.stop = true;\n    }\n    @Override\n    public void run() {\n        while (!stop){\n            try {\n                selector.select(1000);//selectoræ¯éš”1ç§’å”¤é†’ä¸€æ¬¡ã€‚å½“æœ‰å¤„äºå°±ç»ªçŠ¶æ€çš„Channelæ—¶ï¼Œselectorå°†è¿”å›å°±ç»ªçŠ¶æ€çš„SelectionKeyé›†åˆï¼Œé€šè¿‡å¯¹å°±ç»ªçŠ¶æ€çš„Channelé›†åˆè¿›è¡Œè¿­ä»£å¯ä»¥è¿›è¡Œç½‘ç»œçš„å¼‚æ­¥è¯»å†™æ“ä½œ\n                Set&lt;SelectionKey&gt; selectionKeySet = selector.selectedKeys();\n                Iterator&lt;SelectionKey&gt; it = selectionKeySet.iterator();\n                SelectionKey selectionKey = null;\n                while (it.hasNext()){\n                    selectionKey = it.next();\n                    it.remove();\n                    try {\n                        handleInput(selectionKey);\n                    }catch (Exception e){\n                        if(selectionKey != null){\n                            selectionKey.cancel();\n                            if(selectionKey.channel() != null){\n                                selectionKey.channel().close();\n                            }\n                        }\n                    }\n                }\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n        //å¤šè·¯å¤ç”¨å™¨å…³é—­åï¼Œæ‰€æœ‰æ³¨å†Œåœ¨ä¸Šé¢çš„Channelå’ŒPipeç­‰èµ„æºéƒ½ä¼šè¢«è‡ªåŠ¨å»æ³¨å†Œå¹¶å…³é—­ï¼Œæ‰€æœ‰ä¸éœ€è¦é‡å¤é‡Šæ”¾èµ„æº\n        if(selector != null){\n            try {\n                selector.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n    private void handleInput(SelectionKey selectionKey) throws IOException {\n        if(selectionKey.isValid()){\n            //æ ¹æ®SelectionKeyçš„æ“ä½œæœªè¿›è¡Œåˆ¤æ–­å³å¯è·çŸ¥ç½‘ç»œäº‹ä»¶çš„ç±»å‹\n            if(selectionKey.isAcceptable()){\n                ServerSocketChannel serverSocketChannel = (ServerSocketChannel) selectionKey.channel();//ç›¸å½“äºå®Œæˆäº†TCPçš„ä¸‰æ¬¡æ¡æ‰‹ï¼ŒTCPç‰©ç†é“¾è·¯æ­£å¼å»ºç«‹\n                SocketChannel socketChannel = serverSocketChannel.accept();\n                socketChannel.configureBlocking(false);\n                socketChannel.register(selector,SelectionKey.OP_READ);\n            }\n            if(selectionKey.isReadable()){\n                SocketChannel socketChannel = (SocketChannel) selectionKey.channel();\n                //åˆ›å»ºByteBufferï¼Œäº‹å…ˆä¸çŸ¥é“å®¢æˆ·ç«¯å‘é€çš„ç æµå¤§å°ï¼Œå…ˆå¼€è¾Ÿä¸€ä¸ª1Kçš„ç¼“å†²åŒº\n                ByteBuffer readBuffer = ByteBuffer.allocate(1024);\n                int readBytes = socketChannel.read(readBuffer);//æ­¤æ—¶çš„readéé˜»å¡\n                if(readBytes &gt; 0){//è¯»åˆ°äº†å­—èŠ‚ï¼Œå¯¹å­—èŠ‚è¿›è¡Œç¼–è§£ç \n                    //è°ƒç”¨flip()ä¹‹åï¼Œè¯»/å†™æŒ‡é’ˆpositionæŒ‡åˆ°ç¼“å†²åŒºå¤´éƒ¨ï¼Œå¹¶ä¸”è®¾ç½®äº†æœ€å¤šåªèƒ½è¯»å‡ºä¹‹å‰å†™å…¥çš„æ•°æ®é•¿åº¦(è€Œä¸æ˜¯æ•´ä¸ªç¼“å­˜çš„å®¹é‡å¤§å°)ã€‚ç›¸å½“äºlimit =&gt; position;position=&gt;0\n                    readBuffer.flip();\n                    //è¿”å›å‰©ä½™çš„å¯ç”¨é•¿åº¦ï¼Œæ­¤é•¿åº¦ä¸ºå®é™…å¯è¯»å–çš„æ•°æ®é•¿åº¦ï¼Œæœ€å¤§è‡ªç„¶æ˜¯åº•å±‚æ•°ç»„çš„é•¿åº¦\n                    byte[] bytes = new byte[readBuffer.remaining()];\n                    //ä»ByteBufferä¸­è¯»å–byte[]ã€‚å°†ç¼“å†²åŒºå¯è¯»çš„å­—èŠ‚æ•°ç»„å¤åˆ¶åˆ°æ–°åˆ›å»ºçš„å­—èŠ‚æ•°ç»„ä¸­\n                    readBuffer.get(bytes);\n                    String body = new String(bytes,\"UTF-8\");\n                    System.out.println(\"The Time server receive order:\"+body);\n                    String currentTime = \"QUERY TIME ORDER\".equalsIgnoreCase(body)?new java.util.Date(System.currentTimeMillis()).toString():\"BAD ORDER\";\n                    doWrite(socketChannel,currentTime);\n                } else if(readBytes &lt; 0){//-1 é“¾è·¯å·²ç»å…³é—­ï¼Œéœ€è¦å…³é—­SocketChannelï¼Œé‡Šæ”¾èµ„æº\n                    selectionKey.cancel();\n                    socketChannel.close();\n                } else {\n                    //è¯»åˆ°0å­—èŠ‚ï¼Œå¿½ç•¥\n                }\n            }\n        }\n    }\n\n    private void doWrite(SocketChannel socketChannel,String response) throws IOException {\n        if(response !=null &amp;&amp; response.trim().length() &gt; 0){\n            byte[] bytes = response.getBytes();\n            ByteBuffer writeBuffer = ByteBuffer.allocate(bytes.length);\n            writeBuffer.put(bytes);//å°†å­—èŠ‚æ•°ç»„å¤åˆ¶åˆ°ç¼“å†²åŒºä¸­\n            writeBuffer.flip();\n            socketChannel.write(writeBuffer);//å¹¶ä¸èƒ½ä¿è¯ä¸€æ¬¡æ€§èƒ½å¤ŸæŠŠéœ€è¦å‘é€çš„å­—èŠ‚æ•°ç»„å‘é€å®Œï¼Œä¼šå‡ºç°\"å†™åŠåŒ…\"çš„é—®é¢˜ï¼Œæ­¤æ—¶éœ€è¦æ³¨å†Œå†™æ“ä½œï¼Œä¸æ–­è½®è¯¢Selectorå°†æ²¡æœ‰å‘é€ç©çš„ByteBufferå‘é€å®Œæ¯•ã€‚å¯ä»¥é€šè¿‡ByteBufferçš„hasRemaining()æ–¹æ³•åˆ¤æ–­æ¶ˆæ¯æ˜¯å¦å‘é€å®Œæˆã€‚å¦‚æœå‘é€åŒºçš„TCPç¼“å†²åŒºæ»¡ï¼Œä¼šå¯¼è‡´å†™åŠåŒ…ï¼Œæ­¤æ—¶éœ€è¦æ³¨å†Œç›‘å¬å†™æ“ä½œä½ï¼Œå¾ªç¯å†™ï¼Œç›´åˆ°æ•´åŒ…æ¶ˆæ¯å†™å…¥TCPç¼“å†²åŒº\n        }\n    }\n\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeClient{\n  public static void main(String[] args){\n        new Thread(new TimeClientHandle(\"127.0.0.1\",6666)).start();\n    }\n}\npublic class TimeClientHandle implements Runnable{\n    private String host;\n    private int port;\n    private Selector selector;\n    private SocketChannel socketChannel;\n    private volatile boolean stop;\n\n    public TimeClientHandle(String host, int port) {\n        this.host = host;\n        this.port = port;\n        try {\n            selector = Selector.open();\n            socketChannel = SocketChannel.open();\n            socketChannel.configureBlocking(false);\n        } catch (IOException e) {\n            e.printStackTrace();\n            System.exit(1);\n        }\n\n\n    }\n\n    @Override\n    public void run() {\n        try{\n            doConnect();\n        }catch (IOException e){\n            e.printStackTrace();\n        }\n        while(!stop){\n            try {\n                selector.select(1000);\n                Set&lt;SelectionKey&gt; selectionKeySet = selector.selectedKeys();\n                Iterator&lt;SelectionKey&gt; it = selectionKeySet.iterator();\n                SelectionKey selectionKey = null;\n                while (it.hasNext()) {\n                    selectionKey = it.next();\n                    it.remove();\n                    try {\n                        handleInput(selectionKey);\n                    } catch (Exception e) {\n                        e.printStackTrace();\n                        if (selectionKey != null) {\n                            selectionKey.cancel();\n                            if (selectionKey.channel() != null) {\n                                try {\n                                    selectionKey.channel().close();\n                                } catch (IOException e1) {\n                                    e1.printStackTrace();\n                                }\n                            }\n                        }\n                    }\n                }\n            }catch (IOException e2) {\n                e2.printStackTrace();\n            }\n        }\n        // å¤šè·¯å¤ç”¨å™¨å…³é—­åï¼Œæ‰€æœ‰æ³¨å†Œåœ¨ä¸Šé¢çš„Channelå’ŒPipeç­‰èµ„æºéƒ½ä¼šè¢«è‡ªåŠ¨å»æ³¨å†Œå¹¶å…³é—­ï¼Œæ‰€ä»¥ä¸éœ€è¦é‡å¤é‡Šæ”¾èµ„æº\n        if(selector != null){\n            try {\n                selector.close();\n            } catch (IOException e) {\n                e.printStackTrace();\n            }\n        }\n    }\n\n    private void handleInput(SelectionKey key) throws IOException{\n        if(key.isValid()){\n            SocketChannel socketChannel = (SocketChannel) key.channel();\n            if(key.isConnectable()){//å¤„äºè¿æ¥çŠ¶æ€ï¼Œè¯´æ˜æœåŠ¡ç«¯ä»¥åŠè¿”å›ACKåº”ç­”æ¶ˆæ¯\n                if(socketChannel.finishConnect()){//å®¢æˆ·ç«¯è¿æ¥æˆåŠŸ\n                    socketChannel.register(selector,SelectionKey.OP_READ);\n                    doWrite(socketChannel);\n                }else{\n                    System.exit(1);\n                }\n                if(key.isReadable()){\n                    ByteBuffer readBuffer = ByteBuffer.allocate(1024);\n                    int readBytes = socketChannel.read(readBuffer);\n                    if(readBytes &gt; 0){\n                        readBuffer.flip();\n                        byte[] bytes = new byte[readBuffer.remaining()];\n                        readBuffer.get(bytes);\n                        String body = new String(bytes,\"UTF-8\");\n                        System.out.println(\"Now is:\"+body);\n                        this.stop = true;\n                    }else if(readBytes &lt; 0){\n                        //å¯¹é“¾è·¯å…³é—­\n                        key.cancel();\n                        socketChannel.close();\n                    }else{\n                        //è¯»åˆ°0å­—èŠ‚å¿½ç•¥\n                    }\n                }\n            }\n        }\n    }\n\n    private void doConnect() throws IOException {\n        if(socketChannel.connect(new InetSocketAddress(this.host,this.port))){\n            socketChannel.register(selector,SelectionKey.OP_READ);\n            doWrite(socketChannel);\n        }else{\n            socketChannel.register(selector,SelectionKey.OP_CONNECT);//å½“æœåŠ¡ç«¯è¿”å›TCP syn-ackæ¶ˆæ¯åï¼ŒSelectorå°±èƒ½å¤Ÿè½®è¯¢åˆ°è¿™ä¸ªSocketChannelå¤„äºè¿æ¥å°±ç»ªçŠ¶æ€\n        }\n    }\n\n    private void doWrite(SocketChannel socketChannel) throws IOException{\n        byte[] req = \"QUERY TIME ORDER\".getBytes();\n        ByteBuffer writeBuffer = ByteBuffer.allocate(req.length);\n        writeBuffer.put(req);\n        writeBuffer.flip();\n        socketChannel.write(writeBuffer);\n        if(!writeBuffer.hasRemaining()){\n            System.out.println(\"Send order 2 server succeed.\");\n        }\n    }\n}\n</code></pre></div><pre><code>- AIOç¼–ç¨‹:NIO2.0å¼•å…¥äº†æ–°çš„ä»¥ä¸åŒé€åˆ°çš„æ¦‚å¿µï¼Œå¹¶æä¾›äº†å¼‚æ­¥æ–‡ä»¶é€šé“å’Œå¼‚æ­¥å¥—æ¥å­—é€šé“çš„å®ç°ï¼Œå¼‚æ­¥é€šé“æä¾›ä¸¤ç§æ–¹å¼è·å–æ“ä½œç»“æœã€‚1.é€šè¿‡java.util.concurrent.Futureç±»æ¥è¡¨ç¤ºå¼‚æ­¥æ“ä½œçš„ç»“æœï¼Œ2.åœ¨æ‰§è¡Œå¼‚æ­¥æ“ä½œçš„æ—¶å€™ä¼ å…¥ä¸€ä¸ªjava.nio.channelsã€‚CompletionHandleræ¥å£å®ç°ç±»ä½œä¸ºæ“ä½œå®Œæˆçš„å›è°ƒã€‚\n- NIO2.0çš„å¼‚æ­¥å¥—æ¥å­—é€šé“æ˜¯çœŸæ­£çš„å¼‚æ­¥éé˜»å¡I/O,å®ƒå¯¹åº”UNIXç½‘ç»œç¼–ç¨‹ä¸­æ—¶é—´é©±åŠ¨I/O(AIO),å®ƒä¸éœ€è¦é€šè¿‡å¤šè·¯å¤ç”¨å™¨ï¼ˆSelectorï¼‰å¯¹æ³¨å†Œçš„é€šé“è¿›è¡Œè½®è¯¢æ“ä½œå³å¯å®ç°å¼‚æ­¥è¯»å†™ï¼Œå¼‚æ­¥Socket Channelæ˜¯è¢«åŠ¨æ‰§è¡Œå¯¹è±¡ï¼Œä¸éœ€è¦æƒ³NIOç¼–ç¨‹é‚£æ ·åˆ›å»ºä¸€ä¸ªç‹¬ç«‹çš„I/Oçº¿ç¨‹å¤„ç†è¯»å†™æ“ä½œï¼Œå¯¹äºAsynchronousServerSocketChannelå’ŒAsynChronousSocketChannelï¼Œå®ƒä»¬éƒ½ç”±JDKåº•å±‚çš„çº¿ç¨‹æ± è´Ÿè´£å›è°ƒå¹¶é©±åŠ¨è¯»å†™æ“ä½œ\n</code></pre>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer{\n    public static void main(String[] args) throws IOException{\n        AsyncTimeServerHandler timeServer = new AsyncTimeServerHandler(6666);\n        new Thread(timeServer,\"AIO-AsyncTimeServerHandler-001\").start();\n    }\n\n}\npublic class AsyncTimeServerHandler implements Runnable{\n    private int port;\n    CountDownLatch latch;\n     AsynchronousServerSocketChannel asynchronousServerSocketChannel;\n    public AsyncTimeServerHandler(int port){\n        this.port = port;\n        try {\n            asynchronousServerSocketChannel = AsynchronousServerSocketChannel.open();\n            asynchronousServerSocketChannel.bind(new InetSocketAddress(port));\n            System.out.println(\"The time server is start in port :\" + port);\n        } catch (IOException e) {\n            e.printStackTrace();\n            System.exit(1);\n        }\n    }\n\n    @Override\n    public void run() {\n        countDownLatch = new CountDownLatch(1);\n        doAccept();\n        try{\n            countDownLatch.await();\n        }catch (InterruptedException e){\n            e.printStackTrace();\n        }\n    }\n\n    private void doAccept(){\n        asynchronousServerSocketChannel.accept(this,new AcceptCompletionHandler());\n    }\n\n\n}\n\npublic class AcceptCompletionHandler implements CompletionHandler&lt;AsynchronousSocketChannel,AcceptCompletionHandler&gt; {\n\n    @Override\n    public void completed(AsynchronousSocketChannel result, AsyncTimeServerHandler attachment) {\n        attachment.asynchronousServerSocketChannel.accept(attachment,this);\n        ByteBuffer byteBuffer = ByteBuffer.allocate(1024);\n        //ByteBuffer dst;æ¥æ”¶ç¼“å†²åŒºï¼Œç”¨äºä»å¼‚æ­¥channelä¸­è¯»å–æ•°æ®åŒ…\n        //Attachment a;å¼‚æ­¥channelæºå¸¦çš„é™„ä»¶ï¼Œé€šçŸ¥å›è°ƒçš„æ—¶å€™ä½œä¸ºå…¥å‚ä½¿ç”¨\n        //CompletionHandler&lt;Integer,? super A&gt;;æ¥æ”¶é€šçŸ¥å›è°ƒä¸šåŠ¡çš„handler\n        result.read(byteBuffer,byteBuffer,new ReadCompletionHandler(result));\n    }\n\n    @Override\n    public void failed(Throwable exc, AIOSocketServer attachment) {\n        attachment.countDownLatch.countDown();\n    }\n}\n\npublic class ReadCompletionHandler implements CompletionHandler&lt;Integer,ByteBuffer&gt; {\n\n    private AsynchronousSocketChannel channel;\n\n    public ReadCompletionHandler(AsynchronousSocketChannel channel){\n        if(this.channel == null){\n            this.channel = channel;\n        }\n\n    }\n\n    @Override\n    public void completed(Integer result, ByteBuffer attachment) {\n        attachment.flip();\n        byte[] body = new byte[attachment.remaining()];\n        attachment.get(body);\n        try {\n            String req = new String(body,\"UTF-8\");\n            System.out.println(\"The time server recive order :\"+ req);\n            String currentTime = \"QUERY TIME ORDER\".equalsIgnoreCase(req)?new java.util.Date(System.currentTimeMillis()).toString():\"BAD ORDER\";\n            doWrite(currentTime);\n        } catch (UnsupportedEncodingException e) {\n            e.printStackTrace();\n        }\n    }\n\n    @Override\n    public void failed(Throwable exc, ByteBuffer attachment) {\n        try {\n            this.channel.close();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n\n    private void doWrite(String currentTime){\n        if(currentTime != null &amp;&amp; currentTime.trim().length() &gt; 0){\n            byte[] bytes = (currentTime).getBytes();\n            ByteBuffer writeBuffer = ByteBuffer.allocate(bytes.length);\n            writeBuffer.put(bytes);\n            writeBuffer.flip();\n            channel.write(writeBuffer, writeBuffer, new CompletionHandler&lt;Integer, ByteBuffer&gt;() {\n                @Override\n                public void completed(Integer result, ByteBuffer buffer) {\n                    //å¦‚æœæ²¡æœ‰å‘é€å®Œå°±ç»§ç»­å‘é€\n                    if(buffer.hasRemaining()){\n                        channel.write(buffer,buffer,this);\n                    }\n                }\n\n                @Override\n                public void failed(Throwable exc, ByteBuffer attachment) {\n                    try {\n                        channel.close();\n                    } catch (IOException e) {\n                        e.printStackTrace();\n                    }\n                }\n            });\n        }\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeClient{\n    public static void main(String[] args) throws IOException{\n        new Thread(new AsyncTimeClientHandler(6666),\"AIO-AsyncTimeClientHandler-001\").start();\n    }\n}\npublic class AsyncTimeClientHandler implements Completionhandler&lt;Void,AsycTimeClientHandler&gt;,Runnable{\n    private AsynchronousSocketChannel client;\n    private String host;\n    private int port;\n    private CountDownLatch latch;\n    public AsyncTimeClientHandler(String host,int port){\n        this.host = host;\n        this.port = port;\n        try{\n            client = AsynchronousSocketChannel.open();\n        }catch(IOException e){\n            e.printStatckTrace();\n        }\n    }\n    @Override\n    public void run() {\n        latch = new CountDownLatch(1);//é˜²æ­¢å¼‚æ­¥æ²¡æ‰§è¡Œå®Œå°±çº¿ç¨‹å°±é€€å‡º\n        //A attachment: AsynchronousSocketChannelçš„é™„ä»¶ï¼Œç”¨äºå›è°ƒé€šçŸ¥æ—¶ä½œä¸ºå…¥å‚è¢«ä¼ é€’\n        //CompletionHandler&lt;Void,? super A&gt; handler: å¼‚æ­¥æ“ä½œå›è°ƒé€šçŸ¥æ¥å£ï¼Œç”±è°ƒç”¨è€…å®ç°\n        client.connect(new InetSocketAddress(host,port),this,this);\n        try {\n            latch.await();\n        } catch (InterruptedException e1){\n            e1.printStackTrace();\n        }\n        try{\n            client.close();\n        }catch (IOException e){\n            e.printStackTrace();\n        }\n    }\n\n\n\n    @Override\n    public void completed(Void result, AIOSocketClient attachment) {\n        byte[] req = \"QUERY TIME ORDER\".getBytes();\n        ByteBuffer writeBuffer = ByteBuffer.allocate(req.length);\n        writeBuffer.put(req);\n        writeBuffer.flip();\n        client.write(writeBuffer, writeBuffer, new CompletionHandler&lt;Integer, ByteBuffer&gt;() {\n            @Override\n            public void completed(Integer result, ByteBuffer buffer) {\n                if( buffer.hasRemaining()){\n                    client.write(buffer,buffer,this);\n                }else{\n                    ByteBuffer readBuffer = ByteBuffer.allocate(1024);\n                    client.read(readBuffer, readBuffer, new CompletionHandler&lt;Integer, ByteBuffer&gt;() {\n                        @Override\n                        public void completed(Integer result, ByteBuffer buffer) {\n                            buffer.flip();\n                            byte[] bytes = new byte[buffer.remaining()];\n                            buffer.get(bytes);\n                            String body;\n                            try {\n                                body = new String(bytes,\"UTF-8\");\n                                System.out.println(\"Now is :\" + body);\n                                latch.countDown();\n                            } catch (UnsupportedEncodingException e) {\n                                e.printStackTrace();\n                            }\n                        }\n\n                        @Override\n                        public void failed(Throwable exc, ByteBuffer buffer) {\n                            try {\n                                client.close();\n                            } catch (IOException e) {\n                                e.printStackTrace();\n                            }\n                        }\n                    });\n                }\n            }\n\n            @Override\n            public void failed(Throwable exc, ByteBuffer buffer) {\n                try {\n                    client.close();\n                    latch.countDown();\n                } catch (IOException e) {\n                    e.printStackTrace();\n                }\n            }\n        });\n    }\n\n    @Override\n    public void failed(Throwable exc, AIOSocketClient attachment) {\n        exc.printStackTrace();\n        try {\n            client.close();\n            latch.countDown();\n        } catch (IOException e) {\n            e.printStackTrace();\n        }\n    }\n}\n</code></pre></div><ul>\n<li>ä¸åŒI/Oæ¨¡å‹å¯¹æ¯”</li>\n<li>Nettyå¼€å‘</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();//ä¸€ç»„NIOçº¿ç¨‹ï¼Œä¸“é—¨ç”¨äºå¤„ç†ç½‘ç»œäº‹ä»¶ æœåŠ¡ç«¯ç”¨äºæ¥æ”¶å®¢æˆ·ç«¯çš„é“¾æ¥\n        EventLoopGroup workerGroup = new NioEventLoopGroup();//è¿›è¡ŒSocketChannelçš„ç½‘ç»œè¯»å†™\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)//ç±»æ¯”ServerSocketChannel\n                    .option(ChannelOption.SO_BACKLOG,1024).\n                    childHandler(new ChildChannelHandler());//ç±»ä¼¼Reactoræ¨¡å¼ä¸­çš„handlerç±»ï¼Œä¸»è¦ç”¨äºå¤„ç†ç½‘ç»œI/Oäº‹ä»¶ï¼Œä¾‹å¦‚è®°å½•æ—¥å¿—ï¼Œå¯¹æ¶ˆæ¯è¿›è¡Œç¼–è§£ç ç­‰ã€‚\n            ChannelFuture f = serverBootstrap.bind(port).sync();//syncåŒæ­¥é˜»å¡æ–¹æ³•ç­‰å¾…ç»‘å®šå®Œæˆ,ChannelFuture ç”¨äºå¼‚æ­¥æ“ä½œçš„é€šçŸ¥å›è°ƒ\n            f.channel().closeFuture().sync();//syncé˜»å¡ç­‰å¾…æœåŠ¡ç«¯é“¾è·¯å…³é—­åmainå‡½æ•°æ‰é€€å‡º\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n\n\n    private class ChildChannelHandler extends  ChannelInitializer&lt;SocketChannel&gt;{\n\n        @Override\n        protected void initChannel(SocketChannel socketChannel) throws Exception {\n            socketChannel.pipeline().addLast(new TimeServerHandler());\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new TimeServer().bind(8080);\n    }\n}\npublic class TimeServerHandler extends ChannelHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        ByteBuf byteBuf = (ByteBuf) msg;\n        byte[] req = new byte[byteBuf.readableBytes()];//readableBytesè·å–ç¼“å†²åŒºå¯è¯»çš„å­—èŠ‚æ•°\n        byteBuf.readBytes(req);\n        String body = new String(req,\"UTF-8\");\n        System.out.println(\"The Time server recevice order :  \"+body);\n        String currentTime = \"QUERY TIME ORDER\".equalsIgnoreCase(body)?new java.util.Date(\n                System.currentTimeMillis()\n        ).toString():\"BAD ORDER\";\n        ByteBuf resp = Unpooled.copiedBuffer(currentTime.getBytes());\n        ctx.write(resp);\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        ctx.close();//é‡Šæ”¾å’ŒChannelHandlerContextç›¸å…³è”çš„å¥æŸ„ç­‰èµ„æº\n    }\n\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {\n        ctx.flush();//å°†æ¶ˆæ¯å‘é€é˜Ÿåˆ—ä¸­çš„æ¶ˆæ¯å†™å…¥åˆ°SocketChannelä¸­å‘é€ç»™å¯¹æ–¹ã€‚ä»æ€§èƒ½è§’åº¦è€ƒè™‘ï¼Œä¸ºäº†é˜²æ­¢é¢‘ç¹åœ°å”¤é†’Selectorè¿›è¡Œæ¶ˆæ¯å‘é€ï¼ŒNettyçš„writeæ–¹æ³•å¹¶ä¸ç›´æ¥å°†æ¶ˆæ¯å†™å…¥SocketChannelä¸­ï¼Œè°ƒç”¨writeæ–¹æ³•åªæ˜¯æŠŠå¾…å‘é€çš„æ¶ˆæ¯æ”¾åˆ°å‘é€ç¼“å†²æ•°ç»„ä¸­ï¼Œå†é€šè¿‡è°ƒç”¨flushæ–¹æ³•ï¼Œå°†å‘é€ç¼“å†²åŒºä¸­çš„æ¶ˆæ¯å…¨éƒ¨å†™åˆ°SocketChannelä¸­\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            socketChannel.pipeline().addLast(new TimeClentHandler());//å¤„ç†ç½‘ç»œI/Oäº‹ä»¶\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new TimeClient().connect(8080,\"127.0.0.1\");\n    }\n}\npublic class TimeClentHandler extends ChannelHandlerAdapter {\n    private final ByteBuf firstMessage;\n\n    public TimeClentHandler() {\n        byte[] req = \"QUERY TIME ORDER\".getBytes();\n        firstMessage = Unpooled.buffer(req.length);\n        firstMessage.writeBytes(req);\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        System.out.println(\"Unexpected exception from downstram :\" +cause.getMessage());\n        ctx.close();\n    }\n\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        //å½“å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯TCPé“¾è·¯å»ºç«‹æˆåŠŸä¹‹åï¼ŒNettyçš„NIOçº¿ç¨‹ä¼šè°ƒç”¨channelActiveæ–¹æ³•\n        ctx.writeAndFlush(firstMessage);\n    }\n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        ByteBuf byteBuf = (ByteBuf) msg;\n        byte[] req = new byte[byteBuf.readableBytes()];\n        byteBuf.readBytes(req);\n        String body = new String(req,\"UTF-8\");\n        System.out.println(\"Now is :\" + body);\n    }\n\n\n}\n</code></pre></div><ul>\n<li>TCPç²˜åŒ…/æ‹†åŒ…\n<ul>\n<li>TCPæ˜¯ä¸ªæµåè®®ï¼Œæ²¡æœ‰æ²¡æœ‰ç•Œé™çš„ä¸€ä¸²æ•°æ®ã€‚TCPåº•å±‚å¹¶ä¸äº†è§£ä¸Šå±‚ä¸šåŠ¡æ•°æ®çš„å…·ä½“å«ä¹‰ï¼Œä¼šæ ¹æ®TCPç¼“å†²åŒºçš„å®é™…æƒ…å†µè¿›è¡ŒæŠ¥çš„åˆ’åˆ†ï¼Œæ‰€ä»¥åœ¨ä¸šåŠ¡ä¸Šè®¤ä¸ºï¼Œä¸€ä¸ªå®Œæ•´çš„åŒ…å¯èƒ½è¢«TCPæ‹†åˆ†æˆå¤šä¸ªåŒ…è¿›è¡Œå‘é€ï¼Œä¹Ÿæœ‰å¯èƒ½å§å¤šä¸ªå°çš„åŒ…å°è£…æˆä¸€ä¸ªå¤§çš„æ•°æ®åŒ…å‘é€ï¼Œå°±æ˜¯æ‰€è°“çš„TCPçš„ç²˜åŒ…å’Œæ‹†åŒ…é—®é¢˜</li>\n<li>å‡è®¾å®¢æˆ·ç«¯åˆ†åˆ«å‘é€äº†ä¸¤ä¸ªæ•°æ®åŒ…D1å’ŒD2ç»™æœåŠ¡ç«¯ï¼Œç”±äºæœåŠ¡ç«¯ä¸€æ¬¡è¯»å–åˆ°çš„å­—èŠ‚æ•°æ˜¯ä¸ç¡®å®šçš„ï¼Œå¯èƒ½å­˜åœ¨ä»¥ä¸‹4ç§æƒ…å†µ\n<ul>\n<li>æœåŠ¡ç«¯åˆ†2æ¬¡è¯»å–åˆ°äº†ä¸¤ä¸ªç‹¬ç«‹çš„æ•°æ®åŒ…ï¼Œåˆ†åˆ«æ˜¯D1å’ŒD2ï¼Œæ²¡æœ‰ç²˜åŒ…å’Œæ‹†åŒ…</li>\n<li>æœåŠ¡ç«¯ä¸€æ¬¡æ¥å—åˆ°ä¸¤ä¸ªæ•°æ®åŒ…ï¼ŒD1å’ŒD2ç²˜åˆåœ¨ä¸€èµ·ï¼Œè¢«ç§°ä¸ºTCPç²˜åŒ…</li>\n<li>æœåŠ¡ç«¯åˆ†ä¸¤æ¬¡è¯»å–åˆ°äº†ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œç¬¬ä¸€æ¬¡è¯»å–åˆ°äº†å®Œæ•´çš„D1åŒ…å’ŒD2çš„éƒ¨åˆ†å†…å®¹ï¼Œç¬¬äºŒæ¬¡è¯»å–åˆ°äº†D2åŒ…çš„å‰©ä½™å†…å®¹ï¼Œè¿™è¢«ç§°ä¸ºTCPæ‹†åŒ…</li>\n<li>æœåŠ¡ç«¯åˆ†ä¸¤æ¬¡è¯»å–åˆ°äº†ä¸¤ä¸ªæ•°æ®åŒ…ï¼Œç¬¬ä¸€æ¬¡è¯»å–åˆ°äº†D1åŒ…çš„éƒ¨åˆ†å†…å®¹D1_1ï¼Œç¬¬äºŒæ¬¡è¯»å–åˆ°äº†D1åŒ…çš„å‰©ä½™å†…å®¹D1_2å’ŒD2åŒ…çš„æ•´åŒ…ã€‚</li>\n<li>å¦‚æœæ­¤æ—¶æœåŠ¡å™¨TCPæ¥æ”¶æ»‘åŠ¨çª—å£éå¸¸å°ï¼Œè€Œæ•°æ®åŒ…D1å’ŒD2æ¯”è¾ƒå¤§ï¼Œå¾ˆæœ‰å¯èƒ½å‘ç”Ÿç¬¬äº”ä¸­å¯èƒ½ï¼Œå³æœåŠ¡ç«¯åˆ†å¤šæ¬¡æ‰èƒ½å°†D1å’ŒD2åŒ…æ¥æ”¶å®Œå…¨ï¼ŒæœŸé—´å‘ç”Ÿå¤šæ¬¡æ‹†åŒ…</li>\n</ul>\n</li>\n<li>TCPç²˜åŒ…/æ‹†åŒ…å‘ç”Ÿçš„åŸå› \n<ul>\n<li>åº”ç”¨ç¨‹åºå†™å…¥çš„å­—èŠ‚å¤§å°å¤§äºå¥—æ¥å£å‘é€çš„ç¼“å†²åŒºå¤§å°</li>\n<li>è¿›è¡ŒMSSï¼ˆTCPåè®®çš„Maxitum Segment Size æœ€å¤§æŠ¥æ–‡æ®µé•¿åº¦é€‰é¡¹ï¼‰å¤§å°çš„TCPåˆ†æ®µ</li>\n<li>ä»¥å¤ªç½‘å¸§çš„payloadå¤§äºMTUï¼ˆMaximum Transmission Unitç½‘ç»œä¸Šä¼ é€çš„æœ€å¤§æ•°æ®åŒ… å•ä½æ˜¯å­—èŠ‚ã€‚ å¤§éƒ¨åˆ†ç½‘ç»œè®¾å¤‡çš„MTUéƒ½æ˜¯1500ï¼‰è¿›è¡ŒIPåˆ†ç‰‡</li>\n</ul>\n</li>\n<li>ç²˜åŒ…é—®é¢˜çš„è§£å†³ç­–ç•¥\n<ul>\n<li>æ¶ˆæ¯å®šé•¿ï¼šå›ºå®šé•¿åº¦ä¸ºnä¸ªå­—èŠ‚ï¼Œç©ºä½è¡¥å¼„ä¸ª</li>\n<li>åœ¨åŒ…å°¾å¢åŠ å›è½¦æ¢è¡Œç¬¦è¿›è¡Œåˆ†å‰²ï¼Œå¦‚FTPåè®®</li>\n<li>å°†æ¶ˆæ¯åˆ†ä¸ºæ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“ï¼Œæ¶ˆæ¯å¤´ä¸­åŒ…å«è¡¨ç¤ºæ¶ˆæ¯æ€»é•¿åº¦æˆ–è€…æ¶ˆæ¯ä½“é•¿åº¦çš„å­—æ®µï¼Œé€šå¸¸æ¶‰åŠæ€è·¯ä¸ºæ¶ˆæ¯å¤´çš„ç¬¬ä¸€ä¸ªå­—æ®µç”¨int32è¡¨ç¤ºæ¶ˆæ¯çš„æ€»é•¿åº¦</li>\n<li>Nettyæä¾›äº†åŠåŒ…è§£ç å™¨è§£å†³TCPç²˜åŒ…/æ‹†åŒ…é—®é¢˜</li>\n</ul>\n</li>\n<li>TCPç²˜åŒ…å¼‚å¸¸æ¡ˆä¾‹</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();//ä¸€ç»„NIOçº¿ç¨‹ï¼Œä¸“é—¨ç”¨äºå¤„ç†ç½‘ç»œäº‹ä»¶ æœåŠ¡ç«¯ç”¨äºæ¥æ”¶å®¢æˆ·ç«¯çš„é“¾æ¥\n        EventLoopGroup workerGroup = new NioEventLoopGroup();//è¿›è¡ŒSocketChannelçš„ç½‘ç»œè¯»å†™\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)//ç±»æ¯”ServerSocketChannel\n                    .option(ChannelOption.SO_BACKLOG,1024).\n                    childHandler(new ChildChannelHandler());//ç±»ä¼¼Reactoræ¨¡å¼ä¸­çš„handlerç±»ï¼Œä¸»è¦ç”¨äºå¤„ç†ç½‘ç»œI/Oäº‹ä»¶ï¼Œä¾‹å¦‚è®°å½•æ—¥å¿—ï¼Œå¯¹æ¶ˆæ¯è¿›è¡Œç¼–è§£ç ç­‰ã€‚\n            ChannelFuture f = serverBootstrap.bind(port).sync();//syncåŒæ­¥é˜»å¡æ–¹æ³•ç­‰å¾…ç»‘å®šå®Œæˆ,ChannelFuture ç”¨äºå¼‚æ­¥æ“ä½œçš„é€šçŸ¥å›è°ƒ\n            f.channel().closeFuture().sync();//syncé˜»å¡ç­‰å¾…æœåŠ¡ç«¯é“¾è·¯å…³é—­åmainå‡½æ•°æ‰é€€å‡º\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n\n\n    private class ChildChannelHandler extends  ChannelInitializer&lt;SocketChannel&gt;{\n\n        @Override\n        protected void initChannel(SocketChannel socketChannel) throws Exception {\n            socketChannel.pipeline().addLast(new TimeServerHandler());\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new TimeServer().bind(8080);\n    }\n}\npublic class TimeServerHandler extends ChannelHandlerAdapter {\n    private int counter;\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        ByteBuf byteBuf = (ByteBuf) msg;\n        byte[] req = new byte[byteBuf.readableBytes()];\n        byteBuf.readBytes(req);\n        String body = new String(req,\"UTF-8\").substring(0,req.length -System.getProperty(\"line.separator\").length());\n        System.out.println(\"The Time server recevice order :  \"+body+\"; the counter is:\" + ++counter);\n        String currentTime = \"QUERY TIME ORDER\".equalsIgnoreCase(body)?new java.util.Date(\n                System.currentTimeMillis()\n        ).toString():\"BAD ORDER\";\n        currentTime = currentTime + System.getProperty(\"line.separator\");\n        ByteBuf resp = Unpooled.copiedBuffer(currentTime.getBytes());\n        ctx.writeAndFlush(resp);\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        ctx.close();\n    }\n\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {\n        ctx.flush();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            socketChannel.pipeline().addLast(new TimeClentHandler());\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new TimeClient().connect(8080,\"127.0.0.1\");\n    }\n}\npublic class TimeClentHandler extends ChannelHandlerAdapter {\n    private byte[] req;\n    private int counter;\n\n    public TimeClentHandler() {\n        req = (\"QUERY TIME ORDER\" + System.getProperty(\"line.separator\")).getBytes();\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        System.out.println(\"Unexpected exception from downstram :\" +cause.getMessage());\n        ctx.close();\n    }\n\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        ByteBuf message = null;\n        for(int i=0;i&lt;100;i++){\n            message = Unpooled.buffer(req.length);\n            message.writeBytes(req);\n            ctx.writeAndFlush(message);\n        }\n    }\n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        ByteBuf byteBuf = (ByteBuf) msg;\n        byte[] req = new byte[byteBuf.readableBytes()];\n        byteBuf.readBytes(req);\n        String body = new String(req,\"UTF-8\");\n        System.out.println(\"Now is :\" + body + \": the counter is : \" + ++counter);\n    }\n\n}\n</code></pre></div><ul>\n<li>Nettyä½¿ç”¨LineBasedFrameDecoderè§£å†³TCPç²˜åŒ…é—®é¢˜</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeServer {\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024).\n                    childHandler(new ChildChannelHandler());\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n\n\n    private class ChildChannelHandler extends  ChannelInitializer&lt;SocketChannel&gt;{\n\n        @Override\n        protected void initChannel(SocketChannel socketChannel) throws Exception {\n            socketChannel.pipeline().addLast(new LineBasedFrameDecoder(1024));\n            socketChannel.pipeline().addLast(new StringDecoder());\n            socketChannel.pipeline().addLast(new TimeServerHandler());\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new TimeServer().bind(8080);\n    }\n}\npublic class TimeServerHandler extends ChannelHandlerAdapter {\n\n    private int counter;\n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        String body = (String) msg;\n        System.out.println(\"The Time server recevice order :  \"+body+\"; the counter is:\" + ++counter);\n        String currentTime = \"QUERY TIME ORDER\".equalsIgnoreCase(body)?new java.util.Date(\n                System.currentTimeMillis()\n        ).toString():\"BAD ORDER\";\n        currentTime = currentTime + System.getProperty(\"line.separator\");\n        ByteBuf resp = Unpooled.copiedBuffer(currentTime.getBytes());\n        ctx.write(resp);\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        ctx.close();\n    }\n\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {\n        ctx.flush();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TimeClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            socketChannel.pipeline().addLast(new LineBasedFrameDecoder(1024));\n                            socketChannel.pipeline().addLast(new StringDecoder());\n                            socketChannel.pipeline().addLast(new TimeClentHandler());\n\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new TimeClient().connect(8080,\"127.0.0.1\");\n    }\n}\npublic class TimeClentHandler extends ChannelHandlerAdapter {\n    private int counter;\n    private byte[] req;\n    public TimeClentHandler() {\n        req = (\"QUERY TIME ORDER\"+ System.getProperty(\"line.separator\")).getBytes();\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        System.out.println(\"Unexpected exception from downstram :\" +cause.getMessage());\n        ctx.close();\n    }\n\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        ByteBuf message = null;\n        for(int i=0;i&lt;100;i++){\n            message = Unpooled.buffer(req.length);\n            message.writeBytes(req);\n            ctx.writeAndFlush(message);\n        }\n    }\n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        String body = (String) msg;\n        System.out.println(\"Now is :\" + body +\"; the counter is :\" + ++counter);\n    }\n\n\n}\n</code></pre></div><ul>\n<li>LineBasedFrameDecoderå’ŒStringDecoderçš„åŸç†åˆ†æ\n<ul>\n<li>LineBasedFrameDecoderçš„å·¥ä½œåŸç†æ˜¯å®ƒä¾æ¬¡éå†ByteBufä¸­çš„å¯è¯»å­—èŠ‚ï¼Œåˆ¤æ–­çœ‹æ˜¯å¦æœ‰\"\\n\"æˆ–è€…\"\\r\\n\"ï¼Œå¦‚æœæœ‰ï¼Œå°±ä»¥æ­¤ä½ç½®ä¸ºç»“æŸä½ç½®ï¼Œä»å¯è¯»ç´¢å¼•åˆ°ç»“æŸä½ç½®åŒºé—´çš„å­—èŠ‚å°±ç»„æˆäº†ä¸€è¡Œï¼Œå®ƒæ˜¯ä»¥æ¢è¡Œç¬¦æœªç»“æŸæ ‡å¿—çš„è§£ç å™¨ï¼Œåªæ˜¯æºå¸¦ç»“æŸç¬¦æˆ–è€…ä¸æºå¸¦ç»“æŸç¬¦ä¸¤ç§è§£ç æ–¹å¼ï¼ŒåŒæ—¶æ”¯æŒé…ç½®å•è¡Œçš„æœ€å¤§é•¿åº¦ã€‚å¦‚æœè¿ç»­è¯»å–åˆ°æœ€å¤§é•¿åº¦åä»ç„¶æ²¡æœ‰å‘ç°æ¢è¡Œç¬¦ï¼Œå°±ä¼šæŠ›å‡ºå¼‚å¸¸ï¼ŒåŒæ—¶å¿½ç•¥æ‰ä¹‹å‰è¯»åˆ°çš„å¼‚å¸¸ç æµã€‚</li>\n<li>StringDecoderè®²æ¥æ”¶åˆ°çš„å¯¹è±¡è½¬æ¢æˆå­—ç¬¦ä¸²åœ¨ç»§ç»­è°ƒç”¨åé¢çš„handlerï¼ŒLineBasedFrameDecoderç»„åˆå°±æ˜¯æŒ‰è¡Œåˆ‡æ¢çš„æ–‡æœ¬è§£ç å™¨ã€‚</li>\n</ul>\n</li>\n<li>åˆ†éš”ç¬¦åˆå®šé•¿è§£ç å™¨çš„åº”ç”¨\n<ul>\n<li>TCPä»¥æµçš„æ–¹å¼è¿›è¡Œæ•°æ®ä¼ è¾“ï¼Œä¸Šå±‚çš„åº”ç”¨åè®®ä¸ºäº†å¯¹æ¶ˆæ¯è¿›è¡ŒåŒºåˆ†\n<ul>\n<li>æ¶ˆæ¯é•¿åº¦å›ºå®šï¼Œç´¯è®¡è¯»å–åˆ°é•¿åº¦ç»¼åˆä¸ºå®šé•¿LENçš„æŠ¥æ–‡åï¼Œå°±è®¤ä¸ºè¯»å–åˆ°äº†ä¸€ä¸ªå®Œæ•´çš„æ¶ˆæ¯ï¼›å°†è®¡æ•°å™¨èŒä½ï¼Œé‡æ–°å¼€å§‹è¯»å–ä¸‹ä¸€ä¸ªæ•°æ®æŠ¥</li>\n<li>å°†å›è½¦æ¢è¡Œç¬¦ä½œä¸ºæ¶ˆæ¯ç»“æŸç¬¦ï¼Œä¾‹å¦‚FTPåè®®ï¼Œè¿™ç§æ–¹å¼åœ¨æ–‡æœ¬åè®®ä¸­åº”ç”¨æ¯”è¾ƒå¹¿æ³›</li>\n<li>å°†ç‰¹æ®Šçš„åˆ†éš”ç¬¦ä½œä¸ºæ¶ˆæ¯çš„ç»“æŸæ ‡å¿—ï¼Œå›è½¦æ¢è¡Œç¬¦å°±æ˜¯ä¸€ç§ç‰¹æ®Šçš„ç»“æŸåˆ†éš”ç¬¦</li>\n<li>é€šè¿‡åœ¨æ¶ˆæ¯å¤´ä¸­å®šä¹‰é•¿åº¦å­—æ®µæ ‡è¯†æ¶ˆæ¯çš„æ€»é•¿åº¦</li>\n<li>DelimiterBasedFrameDecoderå¯ä»¥è‡ªåŠ¨å®Œæˆä»¥åˆ†éš”ç¬¦åšç»“æŸæ ‡å¿—çš„è§£ç </li>\n<li>FixedLengthFrameDecoderå¯ä»¥è‡ªåŠ¨å®Œæˆå¯¹å®šé•¿æ¶ˆæ¯çš„è§£ç </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>DelimiterBasedFrameDecoder</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class EchoServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            ByteBuf delimiter = Unpooled.copideBuffer(\"$_\".getBytes());\n                            ch.pipeline().addLast(new DelimiterBasedFrameDecoder(1024,delimiter));//å•æ¡æ¶ˆæ¯æœ€å¤§é•¿åº¦ï¼Œå½“è¾¾åˆ°è¯¥é•¿åº¦åä»ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°åˆ†éš”ç¬¦ï¼Œå°±æŠ›å‡ºTooLongFrameExceptionå¼‚å¸¸ï¼Œé˜²æ­¢ç”±äºå¼‚å¸¸ç æµç¡®å®åˆ†éš”ç¬¦å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œæ˜¯å¯é æ€§ä¿æŠ¤ï¼Œ\n                            ch.pipeline().addLast(new StringDecode());\n                            ch.pipeline().addLast(new EchoServerHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new EchoServer().bind(8080);\n    }\n}\npublic class EchoServerHandler extends ChannelHandlerAdapter{\n    int counter = 0;\n    @Override\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n        String body = (String) msg;\n        System.out.println(\"This is\" + ++counter + \"time receive clinet :{\" + body + \"}\");\n    }\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx , Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class EchoClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            ByteBuf delimiter = Unpooled.copideBuffer(\"$_\".getBytes());\n                            ch.pipeline().addLast(new DelimiterBasedFrameDecoder(1024,delimiter));//å•æ¡æ¶ˆæ¯æœ€å¤§é•¿åº¦ï¼Œå½“è¾¾åˆ°è¯¥é•¿åº¦åä»ç„¶æ²¡æœ‰æŸ¥æ‰¾åˆ°åˆ†éš”ç¬¦ï¼Œå°±æŠ›å‡ºTooLongFrameExceptionå¼‚å¸¸ï¼Œé˜²æ­¢ç”±äºå¼‚å¸¸ç æµç¡®å®åˆ†éš”ç¬¦å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œæ˜¯å¯é æ€§ä¿æŠ¤ï¼Œ\n                            ch.pipeline().addLast(new StringDecode());\n                            ch.pipeline().addLast(new EchoClientHandler());\n\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new EchoClient().connect(8080,\"127.0.0.1\");\n    }\n}\npublic class EchoClentHandler extends ChannelHandlerAdapter {\n    private int counter;\n    public EchoClentHandler() {}\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception {\n        System.out.println(\"Unexpected exception from downstram :\" +cause.getMessage());\n        ctx.close();\n    }\n\n    @Override\n    public void channelActive(ChannelHandlerContext ctx) throws Exception {\n        for(int i=0;i&lt;100;i++){\n            ctx.writeAndFlush(Unpooled.copiedBuffer(ECHO_REQ.getBytes()));\n        }\n    }\n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx, Object msg) throws Exception {\n        System.out.println(\"This is\"+ ++counter + \"times receive server : [\" + msg + \"]\");\n    }\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception {\n        ctx.flush();\n    }\n}\n</code></pre></div><ul>\n<li>FixedLengthFrameDecoderè§£ç å™¨ï¼Œæ— è®ºä¸€æ¬¡æ¥æ”¶åˆ°å¤šå°‘æ•°æ®åŒ…ï¼Œå®ƒéƒ½ä¼šæŒ‰ç…§æ„é€ å‡½æ•°ä¸­è®¾ç½®çš„å›ºå®šé•¿åº¦è¿›è¡Œè§£ç ï¼Œå¦‚æœæ˜¯åŠåŒ…æ¶ˆæ¯ï¼Œå®ƒä¼šç¼“å­˜åŠåŒ…æ¶ˆæ¯å¹¶ç­‰å¾…ä¸‹ä¸ªåŒ…åˆ°è¾¾åè¿›è¡Œæ‹¼åŒ…ï¼Œç›´åˆ°è¯»å–åˆ°ä¸€ä¸ªå®Œæ•´çš„åŒ…</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class EchoServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            ch.pipeline().addLast(new FixedLengthFrameDecoder(20));\n                            ch.pipeline().addLast(new StringDecoder());\n                            ch.pipeline().addLast(new EchoServerHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new EchoServer().bind(8080);\n    }\n}\npublic class EchoServerHandler extends ChannelHandlerAdapter{\n    int counter = 0;\n    @Override\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n        System.out.println(\"Receive client [\" + msg +\"}\");\n    }\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx , Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\nå¯ä»¥ç”¨cmdå‘½ä»¤telnet localhost 8080 é“¾æ¥æœåŠ¡ç«¯\n</code></pre></div><ul>\n<li>ç¼–è§£ç æŠ€æœ¯\n<ul>\n<li>åŸºäºjavaæä¾›çš„å¯¹è±¡è¾“å…¥/è¾“å‡ºæµObjectInputStreamå’ŒObjectOutputStreamï¼Œå¯ä»¥ç›´æ¥æŠŠjavaå¯¹è±¡ä½œä¸ºå¯å­˜å‚¨çš„å­—èŠ‚æ•°ç»„å†™å…¥æ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥ä¼ è¾“åˆ°ç½‘ç»œä¸Šã€‚javaåºåˆ—åŒ–çš„ç›®çš„ä¸»è¦æœ‰ç½‘ç»œä¼ è¾“æˆ–è€…å¯¹è±¡æŒä¹…åŒ–</li>\n<li>å½“è¿›è¡Œè¿œç¨‹è·¨è¿›ç¨‹æœåŠ¡è°ƒç”¨æ—¶ï¼Œéœ€è¦æŠŠè¢«ä¼ è¾“çš„javaå­—èŠ‚ç ç¼–ç ä¸ºå­—èŠ‚æ•°ç»„æˆ–è€…ByteBufferå¯¹è±¡ã€‚è€Œå½“è¿œç¨‹æœåŠ¡è¯»å–åˆ°ByteBufferå¯¹è±¡æˆ–è€…å­—èŠ‚æ•°ç»„æ—¶ï¼Œéœ€è¦å°†å…¶è§£ç ä¸ºå‘é€æ—¶çš„javaå¯¹è±¡ï¼Œè¢«ç§°ä¸ºjavaå¯¹è±¡ç¼–è§£ç æŠ€æœ¯ã€‚javaåºåˆ—åŒ–ä»…ä»…æ˜¯javaç¼–è§£ç æŠ€æœ¯çš„ä¸€ç§ã€‚</li>\n<li>javaåºåˆ—åŒ–ç¼ºç‚¹ï¼šæ— æ³•è·¨è¯­è¨€ï¼Œåºåˆ—åŒ–ä¹‹åçš„ç æµå¤ªå¤§ï¼Œç¼–è§£ç æ€§èƒ½å¤ªå·®</li>\n</ul>\n</li>\n<li>Googleçš„Protobuf\n<ul>\n<li>Protobufå…¨ç§°Google Protocol Buffersï¼Œå®ƒç”±è°·æ­Œå¼€æºè€Œæ¥ï¼Œå°†æ•°æ®ç»“æ„ä»¥.protoæ–‡ä»¶è¿›è¡Œæè¿°ï¼Œé€šè¿‡ä»£ç ç”Ÿæˆå·¥å…·å°±å¯ä»¥ç”Ÿæˆå¯¹åº”æ•°æ®ç»“æ„çš„POJOå¯¹è±¡å’ŒProtobufçš„æ–¹æ³•å’Œå±æ€§ã€‚å®ƒçš„ç‰¹ç‚¹åŒ…æ‹¬ç»“æ„åŒ–æ•°æ®å­˜å‚¨æ ¼å¼ï¼ˆXMLï¼ŒJSONç­‰ï¼‰ï¼Œé«˜æ•ˆçš„ç¼–è§£ç æ€§èƒ½ï¼Œè¯­è¨€æ— å…³ã€å¹³å°æ— å…³ã€æ‰©å±•æ€§å¥½ï¼Œæ”¯æŒJavaè¯­è¨€ã€‚</li>\n<li>å°½ç®¡XMLçš„å¯è¯»æ€§å’Œå¯æ‰©å±•æ€§éå¸¸å¥½ï¼Œä¹Ÿéå¸¸é€‚åˆæè¿°æ•°æ®ç»“æ„ï¼Œä½†æ˜¯XMLè§£æçš„æ—¶é—´å¼€é”€å’ŒXMLä¸ºäº†å¯è¯»æ€§è€Œç‰ºç‰²çš„ç©ºé—´å¼€é”€éƒ½éå¸¸å¤§ï¼Œä¸é€‚åˆåšé«˜æ€§èƒ½çš„é€šä¿¡åè®®ã€‚Protobufä½¿ç”¨äºŒè¿›åˆ¶ç¼–ç ï¼Œåœ¨ç©ºé—´å’Œæ€§èƒ½ä¸Šå…·æœ‰æ›´å¤§çš„ä¼˜åŠ¿</li>\n<li>Protobufå¦ä¸€ä¸ªæ¯”è¾ƒå¸å¼•äººçš„åœ°æ–¹å°±æ˜¯ä»–çš„æ•°æ®æè¿°æ–‡ä»¶å’Œä»£ç ç”Ÿæˆæœºåˆ¶ï¼Œåˆ©ç”¨æ•°æ®æè¿°æ–‡ä»¶å¯¹æ•°æ®ç»“æ„è¿›è¡Œè¯´æ˜çš„ä¼˜ç‚¹å¦‚ä¸‹\n<ul>\n<li>æ–‡æœ¬åŒ–çš„æ•°æ®ç»“æ„æè¿°è¯­è¨€ï¼Œå¯ä»¥å®ç°è¯­è¨€ä¸å¹³å°æ— å…³ï¼Œé€‚åˆæ˜“è´­ç³»ç»Ÿé—´çš„é›†æˆ</li>\n<li>é€šè¿‡æ ‡è¯†å­—æ®µçš„é¡ºåºï¼Œå¯ä»¥å®ç°åè®®çš„å‘å‰å…¼å®¹</li>\n<li>è‡ªåŠ¨ä»£ç ç”Ÿæˆï¼Œä¸éœ€è¦æ‰‹å·¥ç¼–å†™åŒæ ·æ•°æ®ç»“æ„çš„C++å’ŒJavaç‰ˆæœ¬</li>\n<li>æ–¹ä¾¿åç»­çš„ç®¡ç†å’Œç»´æŠ¤ã€‚ç›¸æ¯”äºä»£ç ï¼Œç»“æ„åŒ–çš„æ–‡æ¡£æ›´å®¹æ˜“ç®¡ç†å’Œç»´æŠ¤</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Facebookçš„Thrift\n<ul>\n<li>Thriftæ”¯æŒJavaç­‰å¤šç§è¯­è¨€ï¼Œåœ¨å¤šç§ä¸åŒè¯­è¨€ä¹‹é—´é€šä¿¡ï¼ŒThriftå¯ä»¥ä½œä¸ºé«˜æ€§èƒ½çš„é€šä¿¡ä¸­é—´ä»¶ä½¿ç”¨ï¼Œå®ƒæ”¯æŒæ•°æ®ï¼ˆå¯¹è±¡ï¼‰åºåˆ—åŒ–å’Œå¤šç§ç±»å‹çš„RPCæœåŠ¡ã€‚Thriftä½¿ç”¨äºé™æ€çš„æ•°æ®äº¤æ¢ï¼Œéœ€è¦å…ˆç¡®å®šå¥½å®ƒçš„æ•°æ®ç»“æ„ï¼Œå½“æ•°æ®ç»“æ„å‘ç”Ÿå˜åŒ–æ—¶ï¼Œå¿…é¡»é‡æ–°ç¼–è¾‘lDLæ–‡ä»¶ï¼Œç”Ÿæˆä»£ç å’Œç¼–è¯‘ï¼Œæ˜¯å¼±é¡¹ï¼Œé€‚ç”¨äºæ­å»ºå¤§å‹æ•°æ®äº¤æ¢åŠå­˜å‚¨çš„é€šç”¨å·¥å…·ï¼Œå¯¹äºå¤§å‹ç³»ç»Ÿä¸­çš„å†…éƒ¨æ•°æ®ä¼ è¾“ï¼Œç›¸å¯¹äºJSONå’ŒXMLçš„æ€§èƒ½å’Œä¼ è¾“å¤§å°ä¸Šéƒ½æœ‰æ˜æ˜¾ä¼˜åŠ¿</li>\n<li>Thriftç”±5éƒ¨åˆ†ç»„æˆ\n<ul>\n<li>è¯­è¨€ç³»ç»Ÿä¸€å±ŠIDLç¼–è¯‘å™¨ï¼Œè´Ÿè´£ç”±ç”¨æˆ·ç»™å®šçš„IDLæ–‡ä»¶ç”Ÿæˆç›¸åº”è¯­è¨€çš„æ¥å£ä»£ç </li>\n<li>TProtocolï¼šRPCåè®®å±‚ï¼Œå¯ä»¥é€‰æ‹©å¤šç§ä¸åŒçš„å¯¹è±¡åºåˆ—åŒ–æ–¹å¼ï¼Œå¦‚JSONå’ŒBinary</li>\n<li>TTransportï¼šRPCä¼ è¾“å±‚ï¼ŒåŒæ ·å¯ä»¥é€‰æ‹©ä¸åŒçš„ä¼ è¾“å±‚å®ç°ï¼Œå¦‚socketï¼ŒNIOï¼ŒMemoryBufferç­‰</li>\n<li>TProcessor:ä½œä¸ºåè®®å±‚å’Œç”¨æˆ·æä¾›çš„æœåŠ¡å®ç°ä¹‹é—´çš„çº½å¸¦ï¼Œè´Ÿè´£è°ƒç”¨æœåŠ¡å®ç°çš„æ¥å£</li>\n<li>TServer:èšåˆTrotocol,TTransportå’ŒTProcessorç­‰å¯¹è±¡</li>\n</ul>\n</li>\n<li>Thrifté€šè¿‡IDLæè¿°æ¥å£å’Œæ•°æ®ç»“æ„å®šä¹‰ï¼Œæ”¯æŒ8ä¸­JavaåŸºæœ¬ç±»å‹ï¼ŒMapï¼ŒSetå’ŒListï¼ŒåŠŸèƒ½å¼ºå¤§æ²¡å› ä¸ºå¯ä»¥å®šä¹‰æ•°æ®ç»“æ„ä¸­å­—æ®µçš„é¡ºåºï¼Œæ‰€ä»¥å®ƒä¹Ÿå¯ä»¥æ”¯æŒåè®®çš„å‘å‰å…¼å®¹</li>\n<li>Thriftæ”¯æŒä¸‰ç§æ¯”è¾ƒå…¸å‹çš„ç¼–è§£ç æ–¹å¼\n<ul>\n<li>é€šç”¨çš„äºŒè¿›åˆ¶ç¼–è§£ç </li>\n<li>å‹ç¼©çš„äºŒè¿›åˆ¶ç¼–è§£ç </li>\n<li>ä¼˜åŒ–çš„å¯é€‰å­—æ®µå‹ç¼©ç¼–è§£ç </li>\n</ul>\n</li>\n</ul>\n</li>\n<li>JBoss Marshalling\n<ul>\n<li>JBoss Marshallingæ˜¯javaå¯¹è±¡åºåˆ—åŒ–APIåŒ…ï¼Œä¿®æ­£äº†JDKè‡ªå¸¦åºåˆ—åŒ–åŒ…çš„å¾ˆå¤šé—®é¢˜ï¼Œå…¼å®¹java.io.Serializableæ¥å£çš„å…¼å®¹ï¼›åŒæ—¶å¢åŠ äº†ä¸€äº›å¯è°ƒçš„å‚æ•°å’Œé™„åŠ çš„å±æ€§ï¼Œå¹¶ä¸”è¿™äº›å‚æ•°å’Œç‰¹æ€§å¯é€šè¿‡å·¥å‚ç±»è¿›è¡Œé…ç½®</li>\n<li>ç›¸æ¯”äºä¼ ç»Ÿçš„Javaåºåˆ—åŒ–æœºåˆ¶ï¼Œä¼˜ç‚¹å¦‚ä¸‹\n<ul>\n<li>å¯æ’æ‹”çš„ç±»è§£æå™¨ï¼Œæä¾›æ›´åŠ ä¾¿æ·çš„ç±»åŠ è½½å®šåˆ¶ç­–ç•¥ï¼Œé€šè¿‡ä¸€ä¸ªæ¥å£å³å¯å®ç°å®šåˆ¶</li>\n<li>å¯æ’æ‹”çš„å¯¹è±¡æ›¿æ¢æŠ€æœ¯ï¼Œä¸éœ€è¦é€šè¿‡ç»§æ‰¿çš„æ–¹å¼</li>\n<li>å¯æ’æ‹”çš„é¢„å®šä¹‰ç±»ç¼“å­˜è¡¨ï¼Œå¯ä»¥å‡å°åºåˆ—åŒ–çš„å­—èŠ‚æ•°ç»„é•¿åº¦ï¼Œæå‡å¸¸ç”¨ç±»å‹çš„å¯¹è±¡åºåˆ—åŒ–æ€§èƒ½</li>\n<li>æ— é¡»å®ç°java.io.Serializableæ¥å£ï¼Œå³å¯å®ç°Javaåºåˆ—åŒ–</li>\n<li>é€šè¿‡ç¼“å­˜æŠ€æœ¯æå‡å¯¹è±¡çš„åºåˆ—åŒ–æ€§èƒ½</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Javaåºåˆ—åŒ–\n<ul>\n<li>æœ€ç®€å•çš„Javaçš„é»˜è®¤åºåˆ—åŒ–ï¼Œåªéœ€è¦åºåˆ—åŒ–çš„POJOå¯¹è±¡å®ç°java.io.Serializableæ¥å£ï¼Œæ ¹æ®å®é™…æƒ…å†µç”Ÿæˆåºåˆ—IDï¼Œè¿™ä¸ªç±»å°±èƒ½é€šè¿‡java.io.ObjectInputå’Œjava.io.ObjectOutputåºåˆ—åŒ–å’Œååºåˆ—åŒ–</li>\n<li>Netty Javaåºåˆ—åŒ–æœåŠ¡ç«¯å¼€å‘ï¼ˆä½¿ç”¨ObjectEncoderå’ŒObjectDecoderï¼‰å¯¹è®¢è´­è¯·æ±‚å’Œåº”ç­”æ¶ˆæ¯è¿›è¡Œåºåˆ—åŒ–</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SubscribeReq implements Serializable{//1.åºåˆ—åŒ–çš„POJOå¯¹è±¡å®ç°java.io.Serializableæ¥å£\n    private static final long serialVersionUID = 1L;\n    private int subReqID;\n    private String userName;\n    private String productName;\n    private String phoneNumber;\n    private String address;\n    @Override\n    public String toString(){\n        return \"SubscriberReq[subReqID=\" + subReqID + \", userName=\" +userName + \",productName=\" + productName + \",phoneNumber=\" + phoneNumber +\",address=\" + address + \"]\";\n    }\n}\npublic class SubscribeResp implements Serializable{\n    private static final long serialVersionUID = 1L;\n    private int subReqID;\n    private int respCode;\n    private String desc;\n    @Override\n    public String toString(){\n        return \"SubscriberResp [subReqID=\" + subReqID + \", respCode=\" + respCode + \", desc=\" + desc +\"]\";\n    }\n}\npublic class SubReqServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            //weakCachingConcurrentResolveråˆ›å»ºçº¿ç¨‹å®‰å…¨çš„WeakReferenceMapå¯¹ç±»åŠ è½½å™¨è¿›è¡Œç¼“å­˜ï¼Œ\n                            æ”¯æŒå¤šçº¿ç¨‹å¹¶å‘è®¿é—®ï¼Œå½“è™šæ‹Ÿæœºå†…å­˜ä¸è¶³æ—¶ï¼Œä¼šé‡Šæ”¾ç¼“å­˜ä¸­çš„å†…å­˜ï¼Œé˜²æ­¢å†…å­˜æ³„æ¼\n                            //ä¸ºäº†é˜²æ­¢å¼‚å¸¸ç æµå’Œè§£ç é”™ä½å¯¼è‡´çš„å†…å­˜æº¢å‡ºï¼Œå°†å•ä¸ªå¯¹è±¡æœ€å¤§åºåˆ—åŒ–åçš„å­—èŠ‚æ•°ç»„é•¿åº¦è®¾ç½®ä¸º1M\n                            ch.pipeline().addLast(new ObjectDecoder(1024 * 1024,ClassResolvers.weakCachingConcurrentResolver(this.getClass().getClassLoader())));\n                            //ObjectEncoderï¼Œå¯ä»¥åœ¨æ¶ˆæ¯å‘é€çš„æ—¶å€™è‡ªåŠ¨å°†å®ç°çš„Serializableçš„POJOå¯¹è±¡è¿›è¡Œç¼–ç ï¼Œå› æ­¤ç”¨æˆ·éœ€äº²è‡ªå¯¹å¯¹è±¡è¿›è¡Œæ‰‹å·¥åºåˆ—åŒ–ï¼Œåªéœ€è¦å…³æ³¨è‡ªå·±çš„ä¸šåŠ¡é€»è¾‘å¤„ç†å³å¯ï¼Œå¯¹è±¡åºåˆ—åŒ–å’Œååºåˆ—åŒ–éƒ½ç”±nettyçš„å¯¹è±¡è§£ç å™¨æå®š\n                            ch.pipeline().addLast(new ObejectEncoder());\n                            ch.pipeline().addLast(new EchoServerHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new EchoServer().bind(8080);\n    }\n}\npublic class SubReqServerHandler extends ChannelHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n        SubscribeReq req = (SubscribeReq) msg;\n        if(\"Lilinfeng\".equalsIgnoreCase(req.getUserName())){\n            System.out.println(\"Service accept client subscribe req : [\" + req.toString() + \"]\");\n            ctx.writeAndFlush(resp(req.getSubReqID));\n        }\n    }\n    private SubscribeResp resp(int subReqID){\n        SubscribeResp rep = new SubscribeResp();\n        resp.setSubReqID(subReqID);\n        resp.setRespCode(0);\n        resp.setDes(\"Netty book order succeed,3 days latter, sent to the designated address\");\n        return resp;\n    }\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx ,Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SubReqClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            socketChannel.pipeline().addLast(new ObjectDecoder(1024,ClassResolvers.cacheDisabled(this.getClass().getClassLoader)));\n                            socketChannel.pipeline().addLast(new ObjectEncoder());\n                            socketChannel.pipeline().addLast(new SubReqClientHandler());\n\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new SubReqClient().connect(8080,\"127.0.0.1\");\n    }\n}\npublic class SubReqClientHandler extends ChannelHandlerAdapter{\n    public SubReqClientHandler(){}\n    public void channelActive(ChannelHandlerContext ctx){\n        for(int i=0;i&lt;10;i++){\n            ctx.write(subReq(i))\n        }\n        ctx.flush();\n    }\n    private SubscriberReq subReq(int i){\n        SubsribeReq req = new SubscribeReq();\n        req.setAddress(\"å—äº¬å¸‚æ±Ÿå®åŒºæˆ¿å±±å›½å®¶åœ°è´¨å…¬å›­\")\n        req.setPhoneNumber(\"138XXXXXXXX\");\n        req.setProductName(\"Netty æƒå¨æŒ‡å—\");\n        req.setSubReqID(i);\n        req.setUserName(\"Lilinfeng\");\n        return req;\n    }\n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n        ctx.flush();\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\n</code></pre></div><ul>\n<li>Google Protobufç¼–è§£ç \n<ul>\n<li>Protobufæ”¯æŒæ•°æ®ç»“æ„åŒ–ä¸€æ¬¡å¯ä»¥åˆ°å¤„ä½¿ç”¨ï¼Œç”šè‡³è·¨è¯­è¨€ä½¿ç”¨ï¼Œé€šè¿‡ä»£ç ç”Ÿæˆå·¥å…·å¯ä»¥è‡ªåŠ¨ç”Ÿæˆä¸åŒè¯­è¨€çš„æºä»£ç ï¼Œç”šè‡³å¯ä»¥ä½¿ç”¨ä¸åŒç‰ˆæœ¬çš„æ•°æ®ç»“æ„è¿›ç¨‹é—´è¿›è¡Œæ•°æ®ä¼ é€’ï¼Œå®ç°æ•°æ®ç»“æ„çš„å‘å‰å…¼å®¹</li>\n<li>ProtobufDecoderä»…ä»…è´Ÿè´£è§£ç ï¼Œä¸æ”¯æŒè¯»åŠåŒ…ã€‚å› æ­¤ï¼Œåœ¨ProtobufDecoderå‰é¢è¡¥ä¸Šèƒ½å¤„ç†è¯»åŠåŒ…çš„è§£ç å™¨\n<ul>\n<li>ä½¿ç”¨Netttyæä¾›çš„ProtoVarint32FrameDecoder</li>\n<li>ç»§æ‰¿Nettyæä¾›çš„åŒæ ·åŠåŒ…è§£ç å™¨LengthFieldBasedFrameDecoder</li>\n<li>ç»§æ‰¿ByteToMessageDecoderç±»ï¼Œè‡ªå·±å¤„ç†åŠåŒ…æ¶ˆæ¯</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åˆ›å»ºSubscribeReq.proto\npackage netty;\noption java_package = \"com.phei.netty.codec.protobuf\";\noption java_outer_Clasaname  = \"SubscribeReqProto\";\n\nmessage SubscribeReq{\n    required int32 subReqID = 1;\n    required string userName = 2;\n    required string productName = 3;\n    required string address = 4;\n}\n\nåˆ›å»ºSubscribeResp.proto\npackage netty;\noption java_package = \"com.phei.netty.codec.protobuf\";\noption java_outer_Clasaname  = \"SubscribeRespProto\";\n\nmessage SubscribeResp{\n    required int32 subReqID = 1;\n    required string respCode = 2;\n    required string desc = 3;\n}\nä½¿ç”¨cmd proto.exe --java_out=.\\src .\\netty\\SubscribeReq.proto\nä½¿ç”¨cmd proto.exe --java_out=.\\src .\\netty\\SubscribeResp.proto\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class TestSubscribeReqProto{\n    private static byte[] encode(SubscriberReqProto.SubscrobeReq req){\n        retrun req.toByteArray();//å°†SubscribeReqç¼–ç ä¸ºbyteæ•°ç»„\n    }\n    private static SubscriberReqProto.subscribeReq decode(byte[] body)\n        {\n        return SubscribeReqProto.SubscribeReq.parseFrom(body);//å°†äºŒè¿›åˆ¶byteæ•°ç»„è§£ç ä¸ºåŸå§‹å¯¹è±¡\n    }\n    private static SubscrobeReqProto.SubscribeReq createSubscribeReq(){\n        SubscibeReqProto.SubscribeReq.Builder builder = SubscribeReqProto.,SubscribeReq.newBuilder();\n        builder.setSubReqID(1);\n        builder.setUserName(\"Lilinfeng\");\n        builder.setProductName(\"Netty Book\");\n        List&lt;String&gt; address = new ArrayList();\n        address.add(\"NanJing YuHuaTai\");\n        address.add(\"BeiJing LiuLiChang\");\n        builder.addAddAddress(address);\n        return  builder.build();\n    }\n    public static void main(String[] args)throws InvalidProtocolBufferException{\n        SubscribeReqProto.SubscribeReq req = createSubscribeReq();\n        System.out.println(\"Before encode:\"+req.toString());\n        SubscribeReqProto.SubscribeReq req2 = decode(encode(req));\n        System.out.println(\"After decode: \"+ req.toString());\n        System.out.println(\"Assert equal:--&gt;\" + req2.equals(req));\n    }\n}\n</code></pre></div><ul>\n<li>Nettyçš„Protobufå¼€å‘</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SubReqServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(new ProtobufVarint32FrameDecoder());\n                            \n                            ch.pipeline().addLast(new ProtobufDecoder(SubscribeReqProto.SubscribeReq.getDefaultInstance()));\n                            ch.pipeline().addLast(new ProtobufVarint32LengthFieldPrepender());\n                            ch.pipeline().addLast(new ProtobufEncode());\n                            ch.pipeline().addLast(new SubReqServerHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new EchoServer().bind(8080);\n    }\n}\npublic class SubReqServerHandler extends ChannelHandlerAdapter {\n    @Override\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n        SubscrobeReqProto.SubscribeReq req = (SubscribeReqProto.SubscribeReq) msg;\n        if(\"Lilinfeng\".equalsIgnoreCase(req.getUserName())){\n            System.out.print(\"Service accept client subscribe req: [\" + req.toString() + \"]\");\n            ctx.writeAndFlush(resp(req.getSubReqID()));\n        }\n    }\n    private SubscribeResp resp(int subReqID){\n        SubscribeResp rep = new SubscribeResp();\n        resp.setSubReqID(subReqID);\n        resp.setRespCode(0);\n        resp.setDes(\"Netty book order succeed,3 days latter, sent to the designated address\");\n        return resp;\n    }\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx ,Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SubReqClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            socketChannel.pipeline().addLast(new ProtobufVarint32FrameDecoder());\n                            \n                            socketChannel.pipeline().addLast(new ProtobufDecoder(SubscribeRespProto.SubscribeResp.getDefaultInstance()));\n                            socketChannel.pipeline().addLast(new ProtobufVarint32LengthFieldPrepender());\n                            socketChannel.pipeline().addLast(new ProtobufEncode());\n                            socketChannel.pipeline().addLast(new SubReqClientHandler());\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new SubReqClient().connect(8080,\"127.0.0.1\");\n    }\n}\npublic class SubReqClientHandler extends ChannelHandlerAdapter{\n    public SubReqClientHandler(){}\n    public void channelActive(ChannelHandlerContext ctx){\n        for(int i=0;i&lt;10;i++){\n            ctx.write(subReq(i))\n        }\n        ctx.flush();\n    }\n    private SubscrobeReqProto.SubscribeReq createSubscribeReq(){\n        SubscibeReqProto.SubscribeReq.Builder builder = SubscribeReqProto.,SubscribeReq.newBuilder();\n        builder.setSubReqID(1);\n        builder.setUserName(\"Lilinfeng\");\n        builder.setProductName(\"Netty Book\");\n        List&lt;String&gt; address = new ArrayList();\n        address.add(\"NanJing YuHuaTai\");\n        address.add(\"BeiJing LiuLiChang\");\n        builder.addAddAddress(address);\n        return  builder.build();\n    }       \n\n    @Override\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n       System.out.println(\"Receive server response :[\" + msg + \"]\");\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n\n    @Override\n    public void channelReadComplete(ChannelHandlerContext ctx) throws Exception{\n        ctx.flush();\n    }\n}\n</code></pre></div><ul>\n<li>JBoss Marshallingç¼–è§£ç å¼€å‘\n<ul>\n<li>JBoss Marshallingæ˜¯ä¸€ä¸ªå¯¹è±¡åºåˆ—åŒ–åŒ…ï¼Œå¯¹jdké»˜è®¤çš„åºåˆ—åŒ–æ¡†æ¶è¿›è¡Œä¼˜åŒ–ï¼Œä½†æœ‰ä¿æŒè·Ÿjava.io.Serializableæ¥å£çš„å…¼å®¹ï¼ŒåŒæ—¶å¢åŠ äº†ä¸€äº›å¯è°ƒçš„å‚æ•°å’Œé™„åŠ çš„ç‰¹æ€§</li>\n<li>Nettyçš„Marshallingæ”¯æŒåŠåŒ…å’Œç²˜åŒ…å¤„ç†</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SubReqServer{\n    public void bind(int port) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(MarshallingCodeCFactory.buildMarshallingDecoder());\n                            \n                            ch.pipeline().addLast(MarshallingCodeCFactory.buildMarshallingEncoder());\n                            ch.pipeline().addLast(new SubReqServerHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new EchoServer().bind(8080);\n    }\n}\npublic final class MarshallingCodeCFactory{\n    public static MarshallingDecoder buildMarshallingDecoder(){\n        final MarshallingFactory marshallerFactory = Marshalling.getProvidedMarshallerFactory(\"serial\");\n        final MarshallingConfigutation configuration = new MarshallingConfiguration();\n        configuration.setVersion(5);\n        UnmarshallerProvider provider = new DefalutUnmarshallerProvider(marshallerFactorymconfiguration);\n        MarshallingDecoder decoder = new MarshallingDecoder(provider,1024);\n        return decoder;\n    }\n    public static MarshallingEncoder builMarshallingEncoder(){\n        final MarshallingFactory marshallerFactory = Marshalling.getProvidedMarshallerFactory(\"serial\");\n        final MarshallingConfigutation configuration = new MarshallingConfiguration();\n        configuration.setVersion(5);\n        MarshallerProvider provider = new DefalutMarshallerProvider(marshallerFactorymconfiguration);\n        MarshallingEncoder decoder = new MarshallingEncoder(provider,1024);\n        return decoder;\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class SubReqClient {\n    public void connect(int port, String host) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try{\n            Bootstrap b = new Bootstrap();\n            b.group(group).channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitializer&lt;SocketChannel&gt;() {\n                        @Override\n                        protected void initChannel(SocketChannel socketChannel) throws Exception {\n                            socketChannel.pipeline().addLast(MarshallingCodeCFactory.buildMarshallingDecoder());\n                            \n                            socketChannel.pipeline().addLast(MarshallingCodeCFactory.buildMarshallingEncoder());\n                            socketChannel.pipeline().addLast(new SubReqClientHandler());\n                        }\n                    });\n            ChannelFuture f = b.connect(host,port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n\n    }\n    public static void main(String[] args) throws Exception {\n        new SubReqClient().connect(8080,\"127.0.0.1\");\n    }\n}\n</code></pre></div><ul>\n<li>Nettyå¤šåè®®å¼€å‘å’Œåº”ç”¨\n<ul>\n<li>HTTP(è¶…æ–‡æœ¬ä¼ è¾“åè®®)åè®®æ˜¯å»ºç«‹åœ¨TCPä¼ è¾“åè®®ä¹‹ä¸Šçš„åº”ç”¨æˆåè®®ï¼Œæ˜¯ä¸€ä¸ªå±äºåº”ç”¨å±‚çš„é¢å‘å¯¹è±¡çš„åè®®ï¼Œé€‚ç”¨äºåˆ†å¸ƒå¼è¶…åª’ä½“ä¿¡æ¯ç³»ç»Ÿï¼Œæ˜¯ç›®å‰Webå¼€å‘çš„ä¸»æµåè®®ï¼Œç‰¹å®šå¦‚ä¸‹\n<ul>\n<li>æ”¯æŒClient/Serveræ¨¡å¼</li>\n<li>ç®€å•ï¼šå®¢æˆ·æƒ³æœåŠ¡ç«¯è¯·æ±‚æœåŠ¡æ—¶ï¼Œåªéœ€æŒ‡å®šæœåŠ¡çš„URLï¼Œæºå¸¦å¿…è¦çš„è¯·æ±‚å‚æ•°æˆ–è€…æ¶ˆæ¯ä½“</li>\n<li>çµæ´»ï¼šHTTPå…è®¸ä¼ è¾“ä»»æ„ç±»å‹çš„æ•°æ®å¯¹è±¡ï¼Œä¼ è¾“çš„å†…å®¹ç±»å‹ç”±HTTPæ¶ˆæ¯å¤´ä¸­çš„Content-TypeåŠ ä»¥æ ‡è®°</li>\n<li>æ— çŠ¶æ€ï¼šHTTPåè®®æ˜¯æ— çŠ¶æ€åè®®ï¼Œæ— çŠ¶æ€æ˜¯æŒ‡åè®®å¯¹äºäº‹åŠ¡å¤„ç†æ²¡æœ‰è®°å¿†èƒ½åŠ›ï¼Œç¼ºå°‘çŠ¶æ€æ„å‘³ç€å¦‚æœåç»­éœ€è¦å¤„ç†ä¹‹å‰çš„ä¿¡æ¯ï¼Œåˆ™å®ƒå¿…é¡»é‡ä¼ ï¼Œè¿™æ ·å¯èƒ½å¯¼è‡´æ¯æ¬¡è¿æ¥ä¼ é€çš„æ•°æ®é‡å¢å¤§ã€‚å¦ä¸€æ–¹é¢ï¼Œåœ¨æœåŠ¡å™¨ä¸éœ€è¦å…ˆå‰ä¿¡æ¯æ—¶å®ƒçš„åº”ç­”æ¯”è¾ƒå¿«ï¼Œè´Ÿè½½è¾ƒè½»</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Netty HTTPæœåŠ¡ç«¯å…¥é—¨å¼€å‘\n<ul>\n<li>ç”±äºNettyæ˜¯å¼‚æ­¥äº‹ä»¶é©±åŠ¨çš„æ¶æ„ï¼Œå› æ­¤åŸºäºNIO TCPåè®®æ ˆå¼€å‘çš„HTTPåè®®æ ˆä¹Ÿæ˜¯å¼‚æ­¥éé˜»å¡çš„</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class HttpFileServer{\n    private static final String DEFAULT_URL = \"/src/com/phei/netty/\";\n\n    public void bind(int port,final String url) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BACKLOG,1024)\n                    .handler(new LoggingHandler(LogLevel.INFO))\n                    .childHandler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(\"http-decoder\",new HttpRequestDecoder());\n                            //ä½œç”¨æ˜¯è®²å¤šä¸ªæ¶ˆæ¯è½¬æ¢ä¸ºå•ä¸€çš„FullHttpRequestæˆ–è€…FullHttpResponseï¼ŒåŸå› æ˜¯HTTPè§£ç å™¨ä¼šç”Ÿæˆå¤šä¸ªæ¶ˆæ¯å¯¹è±¡ï¼ˆHttpRequest/HttpResponseã€HttpContentã€LastHttpContentï¼‰\n                            ch.pipeline().addLast(\"http-aggregator\",new HttpObjectAggregator(65536));\n                            \n                            ch.pipeline().addLast(\"http-encoder\",new HttpResponseEncoder());\n                            //ä½œç”¨æ˜¯æ”¯æŒå¼‚æ­¥å‘é€å¤§çš„ç æµï¼ˆä¾‹å¦‚å¤§çš„æ–‡ä»¶ä¼ è¾“ï¼‰ï¼Œä½†ä¸å ç”¨è¿‡å¤šçš„å†…å­˜ï¼Œé˜²æ­¢å‘ç”ŸJavaå†…å­˜æº¢å‡ºé”™è¯¯\n                            ch.pipeline().addLast(\"http-chunked\",new ChunkedWriteHandler(65536));\n\n                            ch.pipeline().addLast(\"fileServerHandler\",new HttpFileServerHandler(url));\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new HttpFileServer().run(8080,DEFAULT_URL);\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class HttpFileServerHandler extends SimpleChannelInboundHandler&lt;FullHttpRequest&gt;{\n    private final String url;\n    public HttpFileServerHandler(String url){\n        this.url = url;\n    }\n    @Override\n    public void mssageReceived(ChannelHandlerContext ctx,FullHttpRequest request) throws Exception{\n        if(!request.getDecoderResult().isSuccess()){\n            sendError(ctx,BAD_REQUEST);\n            return;\n        }\n        if(request.getMethod() != GET){\n            sendError(ctx,METHOD_NOT_ALLOWED);\n            return;\n        }\n        final String uri = request.getUri();\n        final String path = sanitizeUri(uri);\n        if(path == null){\n            sendError(ctx,FORBIDDEN);\n            return;\n        }\n        File file = new File(path);\n        if(file.isHidden() || !file.exists()){\n            sendError(ctx,NOT_FOUND);\n            return;\n        }\n        if(file.isDirectory()){\n            if(uri.endsWith(\"/\")){\n                sendListing(ctx,file);\n            }else{\n                sendRedirect(ctx, uri + '/');\n            }\n            return;\n        }\n        if(!file.isFile()){\n            sendError(ctx,FORBIDDEN);\n            return;\n        }\n        RandomAccessFile randomAccessFile = null;\n        try{\n            randomAccessFile = new RandomAccessFile(file,\"r\");//ä»¥åªè¯»çš„æ–¹å¼æ‰“å¼€æ–‡ä»¶\n        }cath(FileNotFounException fnfe){\n            sendError(ctx,NOT_FOUND);\n            return;\n        }\n        long fileLength = randomAccessFile.length();\n        HttpResponse response = new DefaultHttpResponse(HTTP_1_1,OK);\n        setContentLength(response,fileLength);\n        if(isKeepAlive(request)){\n            reponse.headers().set(CONNECTION,HttpHeaders.Values.KEEP_ALIVE);\n        }\n        ctx.wirte(response);\n        ChannelFuture sendFileFuture;\n        sendFileFuture = ctx.write(new ChunkedFile(randomAccessFile,0,fileLength,8192),ctx.newProgressivePromise());\n        sendFileFuture.addListenner(new ChannelProgressiveFutueListenner(){\n            @Override\n            public void operationProgressed(ChannelProgressiveFuture future,long progress,long total){\n                if(total &lt;0){\n                    System.out.println(\"Transfer progress :\" + progress)\n                }else {\n                    System.out.println(\"Transfer progress :\"+progress +\"/\" + total);\n                }\n            }\n            @Override\n            public void operationComplete(ChannelProgressiveFuture future)throws Exception{\n                System.out.println(\"Transfer complete.\");\n            }\n        });\n        ChannelFuture lastContentFuture = ctx.wirteAndFlush(LasHttpContent.EMPTY_LAST_CONNENT);\n        if(!isKeepAlive(request)){\n            lastContentFutue.addListener(ChannelFutureListener.CLOSE);\n        }\n    }\n\n    @Override\n    public oid exceptionCaught(ChannelHandlerContext ctx,Throwable cause) throws Exception{\n        cause.printStackTrace();\n        if(ctx.channel().isActive()){\n            sendError(ctx,INTERNAL_SERVER_ERROR);\n        }\n    }\n\n    private static final Pattern INSECURE_URI = Pattern.compile(\".*[&lt;&gt;&amp;\\\"].*\");\n    private String sanitizeUri(String uri){\n        try{\n            uri = URIDecoder.decode(uri,\"UTF-8\");\n        }catch(UnsupportedEncodeingException e){\n            try{\n                uri = URLDecoder.decode(uri,\"ISO-8859-1\");\n            }catch(UnsupporedEncodingException e1){\n                throw new Error();\n            }\n        }\n        if(!uri.startsWith(url)){\n            return null;\n        }\n        if(!uri.startsWith(\"/\")){\n            return null;\n        }\n        uri = uri.replace('/',File.separatorChar);\n        if(uri.contains(File.separator + '.') || uri.contains('.'+File.separator)||uri.startsWith(\".\")\n        || uri.endsWith(\".\")|| INSECURE_URI.matcher(uri).matches()){\n            return null;\n        }\n        return System.getProperty(\"user.dir\") + File.separtor + uri;\n    }\n    private static void sendListing(ChannelHandlerContext ctx,File dir){\n        FullHttpResponse response = new DefaultFullHttpResponse(HTTP_1_1ï¼ŒOK);\n        response.headers().set(CONTENT_TYPE,\"text/html;charset=UTF-8\");\n        StringBuilder buf = new StringBuilder();\n        String dirPath = dir.getPath();\n        buf.append(\"&lt;!DOCTYPE html&gt;\\r\\n\");\n        buf.append(\"&lt;html&gt;&lt;head&gt;&lt;title&gt;\");\n        buf.append(dirPath);\n        buf.append(\"ç›®å½•:\");\n        buf.append(\"&lt;/title&gt;&lt;/head&gt;&lt;body&gt;\\r\\n\");\n        buf.append(\"&lt;h3&gt;\");\n        buf.append(dirpatch).append(\"ç›®å½•:\");\n        buf.append(\"&lt;/h3&gt;\\r\\n\");\n        buf.append(\"&lt;li&gt;é“¾æ¥:&lt;a href=\\\"../\\\"&gt;..&lt;/a&gt;&lt;/li&gt;\\r\\n\");\n        for(File f:dir.listFiles()){\n            if(f.isHidden() || !f.canRead()){\n                continue;\n            }\n            String name = f.getName();\n            if(!ALLOWED_FILE_NAME.matcher(name).matches()){\n                continue;\n            }\n            buf.append(\"&lt;li&gt;é“¾æ¥ï¼š&lt;a href-\\\"\");\n            buf.append(name);\n            buf.append(\"\\\"&gt;\");\n            buf.append(name);\n            buf.append(\"&lt;/a&gt;&lt;/li&gt;\\r\\n\");\n        }\n        buf.append(\"&lt;/ul&gt;&lt;/body&gt;&lt;/html&gt;\\r\\n\");\n        ByteBuf buffer = Upooled.copiedBuffer(buf,CharsetUtil.UTF_8);\n        response.content().writeBytes(buffer);\n        buffer.release();\n        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);\n    }\n\n    private static void sendRedirect(ChannelHandlerContext ctx,String new Uri){\n        FullHttpResponse response = new DefaultFullHttpResponse(HTTP_1_1,FOUND);\n        response.headers().set(LOCATION,newUri);\n        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);\n    }\n    private staitc void sendError(ChannelHandlerContext ctx,HttpResponseStatus status){\n        FullHttpResponse response = new DefaultFullHttpResponse(HTTP_1_1,status,Unpooled.copiedBuffer(\"Failure:\" + status.toString() + \"\\r\\n\",CharsetUtil.UTF_8));\n        response.headers().set(CONTENT_TYPE,\"text/plain;charset=UTF-8\");\n        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);\n    }\n    private static void setContentTypeHeader(HttpResponse response,File file){\n        MimetypesFileTypeMap mineTypesMap = new MimetypesFileTypeMap();\n        response.headers().set(CONTENT_TYPE,mineTypesMap.getContetnType(file.getPath()));\n    }\n}\n</code></pre></div><ul>\n<li>Netty HTTP+XMLåè®®æ ˆå¼€å‘\n<ul>\n<li>ç”±äºHTTPåè®®çš„é€šç”¨æ€§ï¼Œå¾ˆå¤šæ˜“è´­ç³»ç»Ÿé—´çš„é€šä¿¡äº¤äº’é‡‡ç”¨HTTPåè®®ï¼Œé€šè¿‡HTTPåè®®æ‰¿è½½ä¸šåŠ¡æ•°æ®è¿›è¡Œäº¤äº’ï¼Œä¾‹å¦‚HTTP+XMLæˆ–è€…RESTFul+JSON</li>\n<li>æœ€å¸¸ç”¨çš„HTTPåè®®æ ˆå°±æ˜¯åŸºäºServletè§„èŒƒçš„Tomcatç­‰Webå®¹å™¨ï¼ŒJettyç­‰è½»é‡çº§Webå®¹å™¨ã€‚ä½†æ˜¯å¾ˆå¤šåŸºäºHTTPçš„åº”ç”¨éƒ½æ˜¯åå°åº”ç”¨ï¼ŒHTTPä¸ä»…æ˜¯æ‰¿è½½æ•°æ®äº¤æ¢çš„ä¸€ä¸ªé€šé“ï¼Œæ˜¯ä¸€ä¸ªè½½ä½“è€Œä¸æ˜¯webå®¹å™¨ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä¸€èˆ¬ä¸éœ€è¦ç±»ä¼¼tomcatè¿™æ ·é‡é‡å‹çš„Webå®¹å™¨ã€‚ç”±äºå…¶åŠŸèƒ½ç¹æ‚ï¼Œä¼šå­˜åœ¨å¾ˆå¤šå®‰å…¨æ¼æ´ï¼Œä¼šå¸¦æ¥å¼€å‘æˆ–ç»´æŠ¤æˆæœ¬çš„å¢åŠ ï¼Œåœ¨è¿™ç§åœºæ™¯ä¸‹ï¼Œä¸€ä¸ªæ›´åŠ è½»é‡çº§çš„HTTPåè®®æ ˆæ˜¯æ›´å¥½çš„é€‰æ‹©</li>\n</ul>\n</li>\n<li>é«˜æ•ˆçš„XMLç»‘å®šæ¡†æ¶jiBx\n<ul>\n<li>JiBXæ˜¯ä¸€ä¸ªéå¸¸ä¼˜ç§€çš„XMLæ•°æ®ç»‘å®šæ¡†æ¶ï¼Œæä¾›çµæ´»çš„ç»‘å®šæ˜ å°„æ–‡ä»¶ï¼Œå®ç°æ•°æ®å¯¹è±¡ä¸XMLæ–‡ä»¶ä¹‹é—´çš„è½¬æ¢ï¼Œå¹¶ä¸éœ€è¦ä¿®æ”¹æ—¢æœ‰çš„Javaç±»ï¼Œè½¬æ¢æ•ˆç‡æ˜¯ç›®å‰å¾ˆå¤šå…¶ä»–å¼€æºé¡¹ç›®æ— æ³•æ¯”æ‹Ÿçš„</li>\n<li>JiBxä¼˜ç‚¹åŒ…æ‹¬ï¼šè½¬æ¢æ•ˆç‡é«˜ï¼Œé…ç½®ç»‘å®šæ–‡ä»¶ç®€å•ã€ä¸éœ€è¦æ“ä½œxpathæ–‡ä»¶ï¼Œä¸éœ€è¦å†™å±æ€§çš„get/setæ–¹æ³•ã€å¯¹è±¡å±æ€§åä¸XMLæ–‡ä»¶åå¯ä»¥ä¸åŒç­‰ç­‰</li>\n<li>ä½¿ç”¨jiBXç»‘å®šXMLæ–‡æ¡£ä¸Javaå¯¹è±¡éœ€è¦åˆ†ä¸¤æ­¥ï¼šç¬¬ä¸€æ­¥æ˜¯ç»‘å®šXMLæ–‡ä»¶ï¼Œä¹Ÿå°±æ˜¯æ˜ å°„XMLæ–‡ä»¶ä¸Javaå¯¹è±¡ä¹‹é—´çš„å¯¹åº”å…³ç³»ï¼›ç¬¬äºŒæ­¥æ˜¯åœ¨è¿è¡Œæ—¶ï¼Œå®ç°XMLæ–‡ä»¶ä¸Javaå®ä¾‹ä¹‹é—´çš„ç›¸äº’è½¬æ¢ã€‚è¿™æ—¶ï¼Œå®ƒå·²ç»ä¸ç»‘å®šæ–‡ä»¶æ— å…³ï¼Œå¯ä»¥è¯´æ˜¯å®Œå…¨è„±è€¦äº†</li>\n<li>åœ¨ç¨‹åºè¿è¡Œä¹‹å‰ï¼Œéœ€è¦å…ˆé…ç½®ç»‘å®šæ–‡ä»¶å¹¶è¿›è¡Œç»‘å®šï¼Œåœ¨ç»‘å®šè¿‡ç¨‹ä¸­å®ƒå°†ä¼šåŠ¨æ€çš„ä¿®æ”¹ç¨‹åºä¸­ç›¸åº”çš„classæ–‡ä»¶ï¼Œä¸»è¦æ˜¯ç”Ÿæˆå¯¹åº”å¯¹è±¡å®ä¾‹æ–¹æ³•å’Œæ·»åŠ è¢«ç»‘å®šæ ‡è®°çš„å±æ€§JiBx_bindingListç­‰ã€‚å®ƒä½¿ç”¨çš„æŠ€æœ¯æ˜¯BCEL(Byte Code Engineering Library)ï¼ŒBCELæ˜¯ç›®å‰java classworkingæœ€å¹¿æ³›ä½¿ç”¨çš„ä¸€ç§æ¡†æ¶ï¼Œä»–å¯ä»¥è®©ä½ æ·±å…¥JVMæ±‡ç¼–è¯­è¨€è¿›è¡Œç±»æ“ä½œã€‚åœ¨JiBXè¿è¡Œæ—¶ï¼Œä½¿ç”¨äº†ç›®å‰æ¯”è¾ƒæµè¡Œçš„ä¸€ä¸ªæŠ€æœ¯XPP(Xml Pull Parsing)ï¼Œè¿™ä¹Ÿæ­£æ˜¯JiBXå¦‚æ­¤é«˜æ•ˆçš„åŸå› </li>\n<li>JiBxæœ‰ä¸¤ä¸ªæ¯”è¾ƒé‡è¦çš„æ¦‚å¿µ: Unmarshalï¼ˆæ•°æ®åˆ†è§£ï¼‰å’ŒMarshalï¼ˆæ•°æ®ç¼–æ’ï¼‰ï¼ŒUnmarshalæ˜¯è®²XMLæ–‡ä»¶è½¬æ¢æˆJavaå¯¹è±¡ï¼Œè€ŒMarshalåˆ™æ˜¯è®²Javaå¯¹è±¡ç¼–æ’æˆè§„èŒƒçš„XMLæ–‡ä»¶ã€‚JiBXåœ¨Unmarshal/Marshalä¸Šå¦‚æ­¤é«˜æ•ˆï¼Œè¿™è¦å½’åŠŸäºä½¿ç”¨äº†XXPæŠ€æœ¯ï¼Œè€Œä¸æ˜¯ä½¿ç”¨äº†åŸºäºæ ‘å‹ï¼ˆtree-basedï¼‰æ–¹å¼ï¼Œå°†æ•´ä¸ªæ–‡æ¡£å†™å…¥å†…å­˜ï¼Œç„¶åè¿›è¡Œæ“ä½œçš„DOM(Document Object Model)ï¼Œä¹Ÿä¸æ˜¯ä½¿ç”¨åŸºäºäº‹ä»¶æµï¼ˆevent streamï¼‰çš„SAX(Simple API for Xml)ã€‚XPPä½¿ç”¨çš„æ˜¯ä¸æ–­å¢åŠ çš„æ•°æ®æµå¤„ç†æ–¹å¼ï¼ŒåŒæ—¶å…è®¸åœ¨è§£æXMLæ–‡ä»¶æ—¶ä¸­æ–­</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class Order{\n    private long orderNumber;\n    private Customer customer;\n    private Address billTo;\n    private Shippiong shipping;\n    private Address shipTo;\n    private Float total;\n    //set ã€get\n}\npublic class Customer{\n    private long customerNumber;\n    private String firstName;\n    private String lastName;\n    private List&lt;String&gt; middleNames;\n    //å®šä¹‰set ã€get\n}\npublic class Address{\n    private String street1;\n    private String street2;\n    private String city;\n    private String state;\n    private String postCode;\n    private String country;\n    //å®šä¹‰setã€getæ–¹æ³•\n}\npublic enum Shipping{\n    STANDARD_MAIL,PRIORITY_MAIL,INTERNATIONAL_MAIL,DOMESTC_EXPRESS,INTERNATIONAL_EXPRESS\n}\npublic class TestOrder {\n    private IBindingFactory factory = null;\n    private StringWriter writer = null;\n    private StringReader reader = null;\n    private final static String CHARSET_NAME = \"UTF-8\";\n    private String encode2Xml(Order order) throws JiBXException,IOException{\n        factory = BindingDirectory.getFactory(Order.class);\n        writer = new StringWriter();\n        IMarShallingContext mctx = factory.createMarshallingContext();\n        mctx.setIndent(2);\n        mctx.marshalDocument(order,CHARSET_NAME,null,writer);\n        String xmlStr = writer.toString();\n        writer.close();\n        System.out.println(xmlStr.toString());\n        return xmlStr;\n    }\n    private Order decode2Order(String xmlBody) throws JiBXException{\n        reader = new StringReader(xmlBody);\n        IUnmarshallingContext uctx = factory.createUnmarshallingContext();\n        Order order = (Order) uctx.unmarshalDocument(reader);\n        return order;\n    }\n    public static void main(String[] args) throws JiBXExcpetion,IOExcpetion{\n        TestOrder test = new TestOrder();\n        Order order = OrderFactory.create(123);\n        String body = test.encode2Xml(order);\n        Order order2 = test.decode2Order(body);\n        System.out.prinln(order2);\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>HTTP+XML HTTPè¯·æ±‚æ¶ˆæ¯ç¼–ç ç±»\npublic class HttpXmlRequestEncoder extends AbstractHttpXmlEncoder&lt;HttpXmlRequest&gt;{\n    @Override\n    protected void encode(ChannelHandlerConetext ctx,HttpXmlRequest msg,List&lt;Object&gt; out) throws Exception{\n        ByteBuf body = encode0(ctx,msg.getBody());\n        FullHttpRequest request = msg.getRequest();\n        if(request == null){\n            request = new DefaultFullHttpRequest(HttpVersion.HTTP_1_1,HttpMethod.GET,\"/do\",body);\n            HttpHeaders headers = request.headers();\n            headers.set(HttpHeaders.Names.HOST,InetAddress.getLocalHost().getHostAddress());\n            headers.set(HttpHeaders.Names.CONNECTION,HttpHeaders.Values.CLOSE);\n            headers.set(HttpHeaders.Names.ACCEPT ENCODING,HttpHeaders.Values.GZIP.toString()+','+HttpHeaders.Values.DEFLATE.toString());\n            headers.set(HttpHeaders.Names.USER_ACCEPT_CHARSET,\"ISO-8859-1.utf-8;q=0.7*;q=0.7\")\n            headers.set(HttpHeaders.Names.ACCEPT_LANGUACGE,\"zh\");l\n            headers.set(HttpHeaders.Names.USER_AGENT,\"Netty xml Http Client side\");\n            headers.set(HttpHeaders.Names.ACCEPT,\"text/html,application/xhtml+xml,application/xml;q=0.9*/*;q=0.8\");\n            HttpHeaders.setContentLength(request,body.readableBytes());\n            out.add(request);\n        }\n\n    }\n}\npublic abstract class AbstarctHttpXmlEncoder&lt;T&gt; extends MessageToMessageEncoder&lt;T&gt;{\n    IBindingFactory factory = null;\n    StringWriter writer = null;\n    final static String CHARSET_NAME = \"UTF-8\";\n    final static Charset UTF_8 = Charset.forName(CHARSET_NAME);\n    protected ByteBuf encode0(ChannelHandlerContext ctx,Object body) throws Exception{\n        factory = BindingDirectory.getFactory(body.getClass());\n        writer = new StringWriter();\n        IMarshallingContext mctx = factory.createMarshallingContext();\n        mctx.setIndent(2);\n        mctx.marshalDocument(body, CHARSET_NAME,null,writer);\n        writer.close();\n        writer = null;\n        ByteBuf encodeBuf = Unpooled.copiedBuffer(xmlStr,UTF_8);\n        return encodeBuf;\n    }\n\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx,Throwable cause) throws Exception{\n        if(writer !=null){\n            writer.close();\n            writer = null;\n        }\n    }\n}\nHTTP+XMLè¯·æ±‚æ¶ˆæ¯HttpXmlRequest ç”¨äºå®ç°å’Œåè®®æ ˆä¹‹é—´çš„è§£è€¦\npublic class HttpXmlRequest{\n    private FullHttpRequest request;\n    private Object body;//ç¼–ç å¯¹è±¡\n    public HttpXmlRequest(FullHttpRequest request ,Object body){\n        this.request = request;\n        this.body = body;\n    }\n    public final FullHttpRequest getRequest(){\n        return request;\n    }\n    public final void setRequest(FullHttpRequest request){\n        this.request = request;\n    }\n    public final Object getBody(){\n        return body;\n    }\n    public final void setBody(Obejct body){\n        this.body = body;\n    }\n}\nHTTP+XMLè¯·æ±‚æ¶ˆæ¯è§£ç ç±»\npublic class HttpXmlRequestDecoder extends AbstractHttpXmlDecoder&lt;FullHttpRequest&gt;{\n    public HttpXmlRequestDecoder(Class&lt;?&gt; clazz){\n        this(clazz,false);\n    }\n    public HttpXmlRequestDecoder(Class&lt;?&gt; clazz,boolean isPrint){\n        super(clazz,isPrint);//æ˜¯å¦æ‰“å°Httpç æµçš„å¼€å…³\n    }\n    @Override\n    protected void decode(ChannelHandlerContext arg0,FullHttpRequest arg1,List&lt;Object&gt; arg2) throws Exception{\n        if(!arg1.getDecoderResult().isSuccess()){\n            sendError(arg0,BAD_REQUEST);\n            return;\n        }\n        HttpXmlRequest request = new HttpXmlRequest(arg1,decode0(arg0,arg1.content()));\n        arg2.add(request);\n    }\n\n    private staitc void sendError(ChannelHandlerContext ctx,HttpResponseStatus status){\n        FullHttpResponse response = new DefaultFullHttpResponse(HTTP_1_1,status,Unpooled.copiedBuffer(\"Failure:\" + status.toString() + \"\\r\\n\",CharsetUtil.UTF_8));\n        response.headers().set(CONTENT_TYPE,\"text/plain;charset=UTF-8\");\n        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);\n    }\n}\n\npublic abstract class AbstractHttpXmlDecoder&lt;T&gt; extends MessageToMessageDecoder&lt;T&gt;{\n    private IBindingFactory factory;\n    private StringReader reader;\n    private Class&lt;?&gt; clazz;\n    private boolean isPrint;\n    private final static String CHARSET_NAME = \"UTF-8\";\n    private final static Charset UTF_8 = Charset.forName(CHARSET_NAME);\n\n    protected AbstractHttpXmlDecoder(Class&lt;?&gt; clazz){\n        this(clazz,false);\n    }\n    \n    protected AbstractHttpXmlDecoder(Class&lt;?&gt; clazz,boolean isPrint){\n        this.clazz = clazz;\n        this.isPrint = isPrint;\n    }\n\n    protected Object decode0(ChannelHandlerContext arg0,ByteBuf body) throws Exception{\n        factory = BinddingDirectory.getFactory(clazz);\n        String content = body.toString(UTF_8);\n        if(isPrint) Sytem.out.print(\"The body is :\"+content);\n        reader = new StringReader(content);\n        IUnmarshallingContext uctx = factory.createUnmarshallingContext();\n        Object result = uctx.unmarshalDocument(reader);\n        reader.close();\n        reader = null;\n        return result;\n    }\n\n    @Ovrride\n    public void exceptionCaught(ChannelHandlerContext ctx,Throwable cause) throws Exception{\n        if(reader !=null){\n            reader.close();\n            reader = null;\n        }\n    }\n}\nHttp + XML å“åº”æ¶ˆæ¯ç¼–ç ç±»\npublic class HttpXmlResponse{\n    private FullHttpResponse httpResponse;\n    private Object result;\n    public HttpXmlResponse(FullHttpResponse httpResponse,Object result){\n        this.httpResponse = httpResponse;\n        this.result = result;\n    }\n    public final FullHttpResponse getHttpResponse(){\n        return httpResponse;\n    }\n    public final void setHttpResponse(FullHttpResponse httpResponse){\n        this.httpResponse = httpResponse;\n    }\n    public final Object getResult(){\n        return result;\n    }\n    public final void setResult(Object result){\n        this.result = result;\n    }\n}\n\npublic class HttpXmlResponseEncode extends AbstractHttpXmlEncoder&lt;HttpXmlResponse&gt;{\n    protected void encode(ChannelHandlerContext ctx,HttpXmlResponse msg,List&lt;Object&gt; out) throws Exception{\n        ByteBuf body = encode0(ctx,msg.getResult());\n        FullHttpResponse response = msg.getHttpResponse();\n        i(response == null){\n            response = newDefaultFullHttpResponse(HTTP_1_1,OK,body);\n        }else{//æ— æ³•é‡ç”¨ä¸šåŠ¡ä¾§è‡ªå®šä¹‰HTTPåº”ç­”æ¶ˆæ¯çš„ä¸»è¦åŸå› æ˜¯nettyçš„DefaultFullHttpResponseæ²¡æœ‰æä¾›åŠ¨æ€è®¾ç½®æ¶ˆæ¯ä½“çš„contentæ¥å£ï¼Œåªèƒ½åœ¨ç¬¬ä¸€æ¬¡æ„é€ çš„æ—¶å€™è®¾ç½®å†…å®¹\n            reponse = new DefaultFullHttpResponse(msg.getHttpResponse().getProtocolVersion(),msg.getHttpResponse.getStatus(),body);\n        }\n        response.headers().set(CONTENT_TYPE,\"text/xml\");\n        setContentLength(response,body.readableBytes());\n        out.add(response);\n    }\n}\npublic class HttpXmlResponseDecoder extends AbstractHttpXmlDecoder&lt;DefaultFullHttpResponse&gt;{\n    public httpXmlResponseDecoder(Class&lt;?&gt; clazz){\n        this(clazz,false);\n    }\n    public HttpXmlResponseDecoder(Class&lt;?&gt; clazz,boolean isPrintlog){\n        super(clazz,isPrintlog);\n    }\n    @Override\n    protect void decode(ChannelHandlerContent ctx,DefaultFullHttpResponse msg,List&lt;Object&gt; out) throws Exception {\n        HttpXmlResponse resHttpXmlResponse = new HttpXmlResponse(msg,decode0(ctx,msg.content()));\n        out.add(resHttpXmlResponse);\n    }\n}\nHTTP+XMLå®¢æˆ·ç«¯\npublic class HttpXmlClient{\n    public void connet(int port) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try {\n            ServerBootstrap b = new ServerBootstrap();\n            b.group(group)\n                    .channel(NioSocketChannel.class)\n                    .option(ChannelOption.TCP_NODELAY,true)\n                    .handler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(\"http-decoder\",new HttpResponseDecoder());\n                            //è´Ÿè´£å°†1ä¸ªHttpè¯·æ±‚æ¶ˆæ¯çš„å¤šä¸ªéƒ¨åˆ†åˆå¹¶æˆä¸€ä¸ªå®Œæ•´çš„HTTPæ¶ˆæ¯\n                            ch.pipeline().addLast(\"http-aggregator\",new HttpObjectAggregator(65536));\n                            //XMLè§£ç å™¨\n                            ch.pipeline().addLast(\"xml-decoder\",new HttpXmlResponseDecoder(Oder.class,true));\n                            ch.pipeline().addLast(\"http-encoder\",new HttpXmlRequestEncoder());\n\n                            ch.pipeline().addLast(\"xmlClientHandler\",new HttpXmlClienHandle());\n                        }\n                    });\n            ChannelFuture f = b.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            group.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new HttpXmlClient().run(8080);\n    }\n}\npublic class HttpXmlClientHandle extends SimpleChannelInboundHandle&lt;HttpXmlResponse&gt;{\n    @Override\n    public void ChannelActive(ChannelHandlerContext ctx){\n        HttpXmlRequest request = new HttpXmlRequest(null,OderFactory.create(123));\n        ctx.writeAndFlush(request);\n    }\n    @Override\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause){\n        cause.printStackTrace();\n        ctx.close();\n    }\n\n    @Override\n    protected void messageReceived(ChannelHandlerContext ctx,HttpXmlResponse msg) throws Exception{\n        System.out.println(\"The client receive response of http header is:\" + msg.getHttpResponse().headers().names());\n        System.out.println(\"Thre client receive of http body is \" + msg.getResult());\n    }\n}\npublic class OrderFactory{\n    public static Order create(long orderID){\n        Oder order = new Order();\n        order.setOrderNumber(orderID);\n        Address address = new Address();\n        address.setCity(\"å¹¿å·\");\n        address.setCounty(\"ä¸­å›½\");\n        order.setBillTo(address);\n        Customer customer = new Customer();\n        customer.setCustomerNumber(orderID);\n        order.setCustomer(customer);\n        return order;\n    }\n}\n\nHttp+XMLæœåŠ¡ç«¯å¼€å‘\npublic class HttpXmlServer{\n\n    public void bind(final int portl) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .handler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(\"http-decoder\",new HttpRequestDecoder());\n                            ch.pipeline().addLast(\"http-aggregator\",new HttpObjectAggregator(65536));\n                            \n                            ch.pipeline().addLast(\"xml-decoder\",new HttpXmlRequestDecoder(Oder.class,true));\n                            ch.pipeline().addLast(\"http-encoder\",new HttpXmlResponseEncoder());\n\n                            ch.pipeline().addLast(\"fileServerHandler\",new HttpXmlServerHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new HttpXmlServer().run(8080);\n    }\n}\npublic class HttpXmlServerHandler extends SimpleChannelInboundHandler&lt;HttpXmlRequest&gt;{\n    @Override\n    public void messagReceived(final ChannelHandlerContext ctx,HttpXmlRequest xmlRequest) throws Exception{\n        HttpRequest request = xmlRequest.getRequest();\n        Order order = (Order) xmlRequest.getBody();\n        System.out.println(\"Http server receive request:\" + order);\n        dobusiness(order);\n        if(!isKeeypAlive(request)){\n            future.addListener(new GenericFutureListener&lt;Futrue&lt;? super Void&gt;&gt;{\n                public void operationComplete(Future future) throws Exception{\n                    ctx.close();\n                }\n            })\n        }\n    }\n    private void dobusiness(Order oder){\n        order.getCustomer().setFirstName(\"xxx\");\n    }\n    public void exceptionCaught(ChannelHandlerContext ctx,Throwable cause) throws Exception{\n        cause.printStackTrace();\n        if(ctx.channel().isActive()){\n            sendError(ctx,INTERNAL_SERVER_ERROR);\n        }\n    }\n    private staitc void sendError(ChannelHandlerContext ctx,HttpResponseStatus status){\n        FullHttpResponse response = new DefaultFullHttpResponse(HTTP_1_1,status,Unpooled.copiedBuffer(\"Failure:\" + status.toString() + \"\\r\\n\",CharsetUtil.UTF_8));\n        response.headers().set(CONTENT_TYPE,\"text/plain;charset=UTF-8\");\n        ctx.writeAndFlush(response).addListener(ChannelFutureListener.CLOSE);\n    }\n}\n</code></pre></div><ul>\n<li>webSocketåè®®å¼€å‘\n<ul>\n<li>WebSocketå°†ç½‘ç»œå¥—æ¥å­—å¼•å…¥åˆ°äº†å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å¯ä»¥é€šè¿‡å¥—æ¥å­—å»ºç«‹æŒä¹…çš„è¿æ¥ï¼ŒåŒæ–¹å¯ä»¥éšæ—¶äº’å‘æ•°æ®ç»™å¯¹æ–¹ï¼Œè€Œä¸æ˜¯ä¹‹å‰ç”±å®¢æˆ·ç«¯æ§åˆ¶çš„ä¸€è¯·æ±‚ä¸€åº”ç­”æ¨¡å¼ã€‚</li>\n<li>HTTPåè®®ä¸ºåŠæ•°åŒå·¥åè®®ã€‚åŠåŒå·¥åè®®æŒ‡æ•°æ®å¯ä»¥åœ¨å®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯ä¸¤ä¸ªæ–¹å‘ä¸Šä¼ è¾“ï¼Œä½†æ˜¯ä¸èƒ½åŒæ—¶ä¼ è¾“ã€‚æ„å‘³ç€åœ¨åŒä¸€ä¸ªæ—¶åˆ»ï¼Œåªæœ‰åŒä¸€ä¸ªæ–¹å‘ä¸Šçš„æ•°æ®ä¼ é€</li>\n<li>HTTPæ¶ˆæ¯å†—é•¿è€Œç¹çã€‚HTTPæ¶ˆæ¯åŒ…å«æ¶ˆæ¯å¤´ã€æ¶ˆæ¯ä½“ã€æ¢è¡Œç¬¦ç­‰ï¼Œé€šå¸¸æƒ…å†µä¸‹é‡‡ç”¨æ–‡æœ¬æ–¹å¼ä¼ è¾“ã€ç›¸æ¯”äºå…¶ä»–çš„äºŒè¿›åˆ¶é€šä¿¡åè®®ï¼Œå†—é•¿è€Œç¹ç</li>\n<li>é’ˆå¯¹æœåŠ¡å™¨æ¨é€çš„é»‘å®¢å·¥å…·ï¼Œä¾‹å¦‚é•¿æ—¶é—´è½®è¯¢</li>\n<li>è½®è¯¢ï¼šåœ¨ç‰¹å®šæ—¶é—´é—´éš”å¦‚1ç§’ï¼Œç”±æµè§ˆå™¨å¯¹æœåŠ¡å™¨å‘é€HTTPRequestï¼Œç„¶åç”±æœåŠ¡å™¨è¿”å›çš„æœ€æ–°çš„æ•°æ®ç»™å®¢æˆ·ç«¯æµè§ˆå™¨ã€‚æµè§ˆå™¨éœ€è¦ä¸æ–­å‘æœåŠ¡å™¨å‘å‡ºè¯·æ±‚ï¼Œç„¶è€ŒHTTP requestçš„headeræ˜¯éå¸¸å†—é•¿çš„ï¼Œé‡Œé¢åŒ…å«çš„å¯ç”¨æ•°æ®æ¯”ä¾‹å¯èƒ½éå¸¸ä½ï¼Œä¼šå ç”¨å¾ˆå¤šå¸¦å®½å’ŒæœåŠ¡å™¨èµ„æº</li>\n<li>æ¯”è¾ƒæ–°çš„ä¸€ç§è½®è¯¢æŠ€æœ¯æ˜¯Cometï¼Œä½¿ç”¨äº†Ajaxï¼Œè¿™ç§æŠ€æœ¯å¯ä»¥è¾¾åˆ°åŒå‘é€šä¿¡ï¼Œä½†ä»ç„¶éœ€è¦å‘å‡ºè¯·æ±‚ï¼Œåœ¨Cometä¸­ï¼Œæ™®éé‡‡ç”¨é•¿è¿æ¥ï¼Œä¼šå¤§é‡æ¶ˆè€—æœåŠ¡å™¨å¸¦å®½å’Œèµ„æº</li>\n<li>åœ¨WebsocketAPIä¸­ï¼Œæµè§ˆå™¨å’ŒæœåŠ¡å™¨åªéœ€è¦åšä¸€ä¸ªæ¡æ‰‹åŠ¨ä½œï¼Œç„¶åæµè§ˆå™¨å’ŒæœåŠ¡å™¨ä¹‹é—´å½¢æˆäº†ä¸€æ¡å¿«é€Ÿé€šé“ï¼Œä¸¤è€…å°±å¯ä»¥ç›´æ¥ç›¸äº’ä¼ é€æ•°æ®äº†ã€‚WebSocketåŸºäºTCPåŒå‘å…¨åŒå·¥è¿›è¡Œæ¶ˆæ¯ä¼ é€’ï¼Œåœ¨åŒä¸€æ—¶åˆ»ï¼Œæ—¢å¯ä»¥å‘é€æ¶ˆæ¯ï¼Œåˆå¯ä»¥æ¥å—æ¶ˆæ¯ï¼Œæ€§èƒ½æœ‰è¾ƒå¤§æå‡ã€‚</li>\n<li>WebSocketç‰¹ç‚¹\n<ul>\n<li>å•ä¸€çš„TCPè¿æ¥ï¼Œé‡‡ç”¨å…¨åŒå·¥æ¨¡å¼é€šä¿¡</li>\n<li>å¯¹ä»£ç†ã€é˜²ç«å¢™å’Œè·¯ç”±å™¨é€æ˜</li>\n<li>æ— å¤´éƒ¨æ¶ˆæ¯â€™Cookieå’Œèº«ä»½éªŒè¯</li>\n<li>æ— å®‰å…¨å¼€é”€</li>\n<li>é€šè¿‡\"ping/pong\"å¸§ä¿æŒé“¾è·¯æ¿€æ´»</li>\n<li>æœåŠ¡å™¨å¯ä»¥ä¸»åŠ¨æ¨é€æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œä¸éœ€è¦å®¢æˆ·ç«¯è½®è¯¢</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>WebSocketç”Ÿå‘½å‘¨æœŸ\n<ul>\n<li>æ¡æ‰‹æˆåŠŸä¹‹åï¼ŒæœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å°±å¯ä»¥é€šè¿‡\"message\"çš„æ–¹å¼è¿›è¡Œé€šä¿¡äº†ï¼Œä¸€ä¸ªæ¶ˆæ¯ç”±ä¸€ä¸ªæˆ–è€…å¤šä¸ªå¸§ç»„æˆï¼ŒWebSocketçš„æ¶ˆæ¯å¹¶ä¸ä¸€å®šå¯¹åº”ä¸€ä¸ªç‰¹å®šç½‘ç»œå±‚çš„çœŸï¼Œä»–å¯ä»¥è¢«åˆ†éš”æˆå¤šä¸ªå¸§æˆ–è€…è¢«åˆå¹¶</li>\n<li>å¸§éƒ½æœ‰è‡ªå·±å¯¹åº”çš„ç±»å‹ï¼Œå±äºåŒä¸€ä¸ªæ¶ˆæ¯çš„å¤šä¸ªå¸§å…·æœ‰ç›¸åŒç±»å‹çš„æ•°æ®ã€‚ä»å¹¿ä¹‰ä¸Šå°†ï¼Œæ•°æ®ç±»å‹å¯ä»¥ä½¿æ–‡æœ¬æ•°æ®ï¼ŒäºŒè¿›åˆ¶æ•°æ®å’Œæ§åˆ¶å¸§ï¼ˆåè®®çº§ä¿¡ä»¤ï¼Œå¦‚ä¿¡å·ï¼‰</li>\n<li>WebSocketè¿æ¥å…³é—­\n<ul>\n<li>ä¸ºå…³é—­WebSocketè¿æ¥ï¼Œå®¢æˆ·ç«¯å’ŒæœåŠ¡ç«¯éœ€è¦é€šè¿‡ä¸€ä¸ªå®‰å…¨çš„æ–¹æ³•å…³é—­åº•å±‚TCPè¿æ¥ä»¥åŠTLSä¼šè¯ï¼Œå¦‚æœåˆé€‚ï¼Œä¸¢å¼ƒä»»ä½•å¯èƒ½å·²ç»æ¥æ”¶çš„å­—èŠ‚ï¼›å¿…è¦æ—¶ï¼ˆæ¯”å¦‚æ”¶åˆ°å·¥å…·ï¼‰ï¼Œå¯ä»¥é€šè¿‡ä»»ä½•å¯ç”¨çš„æ‰‹æ®µå…³é—­è¿æ¥</li>\n<li>åº•å±‚çš„TCPè¿æ¥ï¼Œåœ¨æ­£å¸¸æƒ…å†µä¸‹ï¼Œåº”è¯¥é¦–å…ˆæœ‰æœåŠ¡å™¨å…³é—­ï¼Œåœ¨å¼‚å¸¸æƒ…å†µä¸‹ï¼ˆä¾‹å¦‚åœ¨ä¸€ä¸ªåˆç†çš„æ—¶é—´å‘¨æœŸåæ²¡æœ‰æ”¶åˆ°TCP Closeï¼‰ï¼Œå®¢æˆ·ç«¯å¯ä»¥å‘èµ·TCP Closeã€‚å› æ­¤ï¼Œå½“æœåŠ¡å™¨è¢«åªæ˜¯å…³é—­WebSocketè¿æ¥æ—¶ï¼Œä»–åº”è¯¥ç«‹å³å‘èµ·ä¸€ä¸ªTCP Closeæ“ä½œï¼Œå®¢æˆ·ç«¯åº”è¯¥ç­‰å¾…æœåŠ¡å™¨çš„TCP Close</li>\n<li>Websocketçš„æ¡æ‰‹å…³é—­æ¶ˆæ¯å¸¦æœ‰ä¸€ä¸ªçŠ¶æ€ç å’Œä¸€ä¸ªå¯é€‰çš„å…³é—­åŸå› ï¼Œå®ƒå¿…é¡»æŒ‰ç…§åè®®è¦æ±‚å‘é€ä¸€ä¸ªCloseæ§åˆ¶å¸§ï¼Œå½“å¯¹ç«¯æ¥æ”¶åˆ°å…³é—­æ§åˆ¶å¸§æŒ‡ä»¤æ—¶ï¼Œéœ€è¦ä¸»åŠ¨å…³é—­WebSocketè¿æ¥</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class WebSocketServer{\n\n    public void bind(final int portl) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .handler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(\"http-codec\",new HttpServerCodec());\n                            ch.pipeline().addLast(\"aggregator\",new HttpObjectAggregator(65536));\n                            //æ”¯æŒæµè§ˆå™¨å’ŒæœåŠ¡å™¨è¿›è¡ŒWebSocketé€šä¿¡\n                            ch.pipeline().addLast(\"http-chunked\",new ChunkedWriteHandler());\n                            ch.pipeline().addLast(\"http-encoder\",new HttpXmlResponseEncoder());\n\n                            ch.pipeline().addLast(\"handler\",new WebSocketHandler());\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new WebSocketServer().run(8080);\n    }\n}\npublic class WebSocketServerHandler extends SimpleChannelInboundHandler&lt;Object&gt;{\n    private WebSocketServerHandshaker handshaker;\n    @Override\n    public void messageReceived(ChannelHandlerContext ctx,Object msg) throws Exception{\n        if(msg instanceof FullHttpRequest){\n            handleHttpRequest(ctx,(FullHttpRequest) msg);\n        }\n        else if(msg instanceof WebSocketFrame){\n            handleWebSocketFrame(ctx,(WebSocketFrame) msg);\n        }\n    }\n    @Ovrride\n    public void channelReadCompelte(ChannelHandlerContext ctx) throws Exception{\n        ctx.flush();\n    }\n    private void handleHttpRequest(ChannelHandlerContext ctx,FullHttpRequest req) throws Exception{\n        if(!reql.getDecoderResult().isSuccess()|| (!\"websocket\".equals(req.headers().get(\"upgrade\")))){\n            sendHttpResponse(ctx,req,new DefauleFullHttpResponse(HTTP_1_1,BAD_REQUEST);\n            return;\n        }\n    }\n    WebSocketServerHandshakerFactory wsFactory = new WebSoketServerHandshakerFactory(\"ws://localhost:8080/webscoket\",null,false);\n    handshaker = wsFactory.newHandshaker(req);\n    if(handshaker == null){\n        WebSocketServerHandShakerFactory.sendUnsupportedWebSocketVersionResponse(ctx.channel());\n    }else{\n        handshaker.handshake(ctx.channel(),req);\n    }\n    private void handleWebSocketFrame(ChannelHandlerContext ctxï¼ŒWebSocketFrame frame){\n        if(frame instanceof CloseWebSocketFrame){\n            handshaker.close(ctx.channel(),(CloseWebSocketFrame) frame.retain());\n            return;\n        }\n        if(frame instanceof PingWebSocketFrame){\n            ctx.channel().write(new PongWebSocketFrame(frame.content.retain()));\n            return;\n        }\n        if(!(frame instanceof TextWebSocketFrame)){\n            throw new UnsupportOperationException(String.format(\"% frame types not supported\",frame.getClass().getName()))\n        }\n        String request = ((TextWebSocketFrame) frame).text();\n        System.out.println(String.format(\"%s received %s\"),ctx.channel(),request);\n        ctx.channel().write(\n            new TextWebSocketFrame(request + \", æ¬¢è¿ä½¿ç”¨Nettty WebsocketæœåŠ¡ï¼Œç°åœ¨æ—¶åˆ»ï¼š\" +new java.util.Date().toString());\n\n        )\n    }\n    private static void sendHttpResponse(ChannelHandlerContext ctx,FullHtppRequest req,FullHttpResponse res){\n        if(res.getStatus().code()!=200){\n            ByteBuf buf = Unpooled.copiedBuffer(res.getStatus().toString(),CharsettUtil.UTF_8);\n            res.content().writeBytes(buf);\n            buf.release();\n            setContentLength(res,res.content().readableBytes());\n        }\n        ChannelFuture f = ctx.channel().writeAndFlush(res);\n        if(!isKeepAlive(req) || res.getStatus().code()!=200){\n            f.addListener(ChannelFutureListener.CLOSE);\n        }\n    }\n    @Ovrride\n    public void exceptionCaught(ChannelHandlerContext ctx, Throwable cause) throws Exception{\n        cause.printStatckTrace();\n        ctx.close();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;html&gt;\n&lt;head&gt;\n&lt;meta charset=\"UTF-8\"&gt;\nNetty WebSocket æ—¶é—´æœåŠ¡å™¨\n&lt;/head&gt;\n&lt;br&gt;\n&lt;body&gt;\n&lt;br\n&lt;script type=\"text/javascipt\"&gt;\nvar socket;\nif(!window.WebSocket){\n    window.WebSocket = windows.MozWebSocket;\n\n}\nif(window.WebSocket){\n    socket = new WebSocket(\"ws://localhost:8080/websocket\");\n    socket.onmessage = function(event){\n        var ta = document.getElementById('responseText');\n        ta.valeu = '';\n        ta.value = event.data;\n    };\n    socket.onopen = function(event){\n        var ta = document.getElementById('reseponseText');\n        ta.value = \"æ‰“å¼€WebsocketæœåŠ¡æ­£å¸¸ï¼Œæµè§ˆå™¨æ”¯æŒWebsocket\";\n    }\n    socket.onclose = function(event){\n        vat ta = document.getElementById(responseText');\n        ta.value = ''';\n        ta.value = 'webScoketå…³é—­';\n    }\n    }\n    else {\n        alert(â€œerror\");\n    }\nfunction send(message){\n    if(!window.WebSocket){return;}\n    if(socket.readState == WebSokcet.OPNE){\n        socket.send(message);\n    }else{\n        alert(\"WebSocketè¿æ¥æ²¡æœ‰å»ºç«‹æˆåŠŸ\");\n    }\n}\n&lt;/script&gt;\n&lt;form onsubmit= \"return false;\"&gt;\n&lt;input type =\"text\" name=\"message\" value =\"Nettyæœ€ä½³å®è·µ\"&gt;\n&lt;br&gt;&lt;br&gt;\n&lt;input type = \"button\" value =\"å‘é€ Websocketè¯·æ±‚æ¶ˆæ¯\" onclick =\"send(this.form.message.value)\"&gt;\n&lt;hr color\"blue\"&gt;\n&lt;h3&gt;æœåŠ¡ç«¯è¿”å›åº”ç­”æ¶ˆæ¯&lt;/h3&gt;\n&lt;textarea id=\"responseText\" style=\"width:500px;height:300px;\"&gt;&lt;/textarea&gt;\n&lt;/form&gt;\n&lt;/body&gt;\n&lt;/html&gt;\n</code></pre></div><ul>\n<li>UDPåè®®å¼€å‘\n<ul>\n<li>UDPç”¨æˆ·æ•°æ®åŒ…åè®®(User Datagram Protocol,UDP)çš„ç®€ç§°ï¼Œå…¶ä¸»è¦ä½œç”¨æ˜¯è®²ç½‘ç»œæ•°æ®æµé‡å‹ç¼©æˆæ•°æ®æŠ¥å½¢å¼ï¼Œæä¾›é¢å‘äº‹åŠ¡çš„ç®€å•ä¿¡æ¯ä¼ é€æœåŠ¡ã€‚ä¸TCPåè®®ä¸åŒï¼ŒUDPåè®®ç›´æ¥åˆ©ç”¨IPåè®®è¿›è¡ŒUDPæ•°æ®æŠ¥çš„ä¼ è¾“ï¼ŒUDPæä¾›çš„æ˜¯é¢å‘æ— è¿æ¥çš„ï¼Œä¸å¯é çš„æ•°æ®æŠ¥æŠ•é€’æœåŠ¡ã€‚å½“ä½¿ç”¨UDPåè®®ä¼ è¾“ä¿¡æ¯æ—¶ï¼Œç”¨æˆ·åº”ç”¨ç¨‹åºå¿…é¡»è´Ÿè´£è§£å†³æ•°æ®æŠ¥ä¸¢å¤±ï¼Œé‡å¤ï¼Œæ’åºï¼Œå·®é”™ç¡®è®¤ç­‰é—®é¢˜</li>\n<li>ç”±äºUDPå…·æœ‰èµ„æºæ¶ˆè€—å°ï¼Œå¤„ç†é€Ÿåº¦å¿«çš„æœ‰ç‚¹ï¼Œæ‰€ä»¥é€šå¸¸è§†é¢‘ï¼ŒéŸ³é¢‘ç­‰å¯é æ€§è¦æ±‚ä¸é«˜çš„æ•°æ®ä¼ è¾“ä¸€èˆ¬ä¼šä½¿ç”¨UDPï¼Œå³ä¾¿æœ‰ä¸€å®šçš„ä¸¢åŒ…ç‡ï¼Œä¹Ÿä¸ä¼šå¯¹åŠŸèƒ½é€ æˆä¸¥é‡çš„å½±å“</li>\n<li>UDPæ˜¯æ— è¿æ¥çš„ï¼Œé€šä¿¡åŒæ–¹ä¸éœ€è¦å»ºç«‹ç‰©ç†é“¾è·¯è¿æ¥ã€‚åœ¨ç½‘ç»œä¸­å®ƒç”¨äºå¤„ç†æ•°æ®åŒ…ï¼Œåœ¨OSIæ¨¡å‹ä¸­ï¼Œå®ƒå¤„äºç¬¬å››ä¼ è¾“å±‚ï¼Œä½äºIPåè®®çš„ä¸Šä¸€å±‚ï¼Œå®ƒä¸å¯¹æ•°æ®æŠ¥åˆ†ç»„ï¼Œç»„è£…ï¼Œæ ¡éªŒå’Œæ’åºï¼Œå› æ­¤æ˜¯ä¸å¯é çš„ã€‚æŠ¥æ–‡çš„å‘é€è€…ä¸çŸ¥é“æŠ¥æ–‡æ˜¯å¦è¢«å¯¹æ–¹æ­£ç¡®æ¥æ”¶</li>\n<li>UDPæ•°æ®æŠ¥æ ¼å¼æœ‰é¦–éƒ¨å’Œæ•°æ®ä¸¤ä¸ªéƒ¨åˆ†ï¼Œé¦–éƒ¨8ä¸ªå­—èŠ‚\n<ul>\n<li>æºç«¯å£ï¼šæºç«¯å£å·ï¼Œ2ä¸ªå­—èŠ‚ï¼Œæœ€å¤§å€¼ä¸º65535ï¼›</li>\n<li>ç›®çš„ç«¯å£ï¼šç›®çš„ç«¯å£å·ï¼Œ2ä¸ªå­—èŠ‚ï¼Œæœ€å¤§å€¼ä¸º65535ï¼›</li>\n<li>é•¿åº¦ï¼š2ä¸ªå­—èŠ‚ï¼ŒUDPç”¨æˆ·æ•°æ®æŠ¥çš„æ€»é•¿åº¦</li>\n<li>æ ¡éªŒå’Œï¼š2å­—èŠ‚ï¼Œç”¨äºæ ¡éªŒUDPæ•°æ®æŠ¥çš„æ•°å­—æ®µå’ŒåŒ…å«UDPæ•°æ®æŠ¥é¦–éƒ¨çš„â€œä¼ªé¦–éƒ¨â€ã€‚æ ¡éªŒæ–¹æ³•ç±»ä¼¼IPåˆ†ç»„é¦–éƒ¨æ ¡éªŒå’Œ</li>\n<li>ä¼ªé¦–éƒ¨ï¼Œåˆç§°ä¸ºä¼ªåŒ…å¤´ï¼Œæ˜¯æŒ‡åœ¨TCPçš„åˆ†æ®µæˆ–UDPçš„æ•°æ®æŠ¥æ ¼å¼ä¸­ï¼Œåœ¨æ•°æ®æŠ¥é¦–éƒ¨å‰é¢å¢åŠ æºIPåœ°å€ï¼Œç›®çš„IPåœ°å€ï¼ŒIPåˆ†ç»„çš„åè®®å­—æ®µï¼ŒTCPæˆ–UDPæ•°æ®æŠ¥çš„æ€»é•¿åº¦ç­‰ï¼Œå…±12å­—èŠ‚ï¼Œæ‰€æ„æˆçš„æ‰©å±•é¦–éƒ¨ç»“æ„ï¼Œæ­¤ä¼ªé¦–éƒ¨æ˜¯ä¸€ä¸ªä¸´æ—¶ç»“æ„ï¼Œæ—¢ä¸å‘ä¸Šä¹Ÿä¸å‘ä¸‹ä¼ é€’ï¼Œä»…ä»…ä¸ºäº†ä¿è¯å¯ä»¥æ ¡éªŒå¥—æ¥å­—çš„æ­£ç¡®æ€§</li>\n</ul>\n</li>\n<li>UDPåè®®çš„ç‰¹ç‚¹\n<ul>\n<li>UDPä¼ é€æ•°æ®å‰å¹¶ä¸ä¸å¯¹æ–¹å»ºç«‹è¿æ¥ï¼ŒUDPæ˜¯æ— è¿æ¥çš„ï¼Œåœ¨ä¼ è¾“æ•°æ®å‰ï¼Œå‘é€æ–¹å’Œæ¥æ”¶æ–¹ç›¸äº’äº¤æ¢ä¿¡æ¯æ˜¯åŒæ–¹åŒæ­¥</li>\n<li>UDPå¯¹æ¥æ”¶åˆ°çš„æ•°æ®åŒ…ä¸å‘é€ç¡®è®¤ä¿¡å·ï¼Œå‘é€ç«¯ä¸çŸ¥é“æ•°æ®æ˜¯å¦è¢«æ­£ç¡®æ¥æ”¶ï¼Œä¹Ÿä¸ä¼šé‡å‘æ•°æ®</li>\n<li>UDPä¼ é€æ•°æ®æ¯”TCPå¿«é€Ÿï¼Œç³»ç»Ÿå¼€é”€å°‘ï¼ŒUDPæ¯”è¾ƒç®€å•ï¼ŒUDPå¤´åŒ…å«äº†æºç«¯å£ï¼Œç›®çš„ç«¯å£ï¼Œæ¶ˆæ¯é•¿åº¦å’Œæ ¡éªŒå’Œç­‰å¾ˆå°‘çš„å­—èŠ‚ã€‚ç”±äºUDPæ¯”TCPç®€å•ï¼Œçµæ´»ï¼Œå¸¸ç”¨äºå¯é æ€§è¦æ±‚ä¸é«˜çš„æ•°æ®ä¼ è¾“ï¼Œå¦‚è§†é¢‘ï¼Œå›¾ç‰‡ä»¥åŠç®€å•æ–‡ä»¶ä¼ è¾“ç³»ç»Ÿï¼ˆTFTPï¼‰ç­‰ï¼ŒTCPé€‚ç”¨äºå¯é æ€§è¦æ±‚å¾ˆé«˜çš„ä½†å®æ—¶æ€§è¦æ±‚ä¸é«˜çš„åº”ç”¨ï¼Œå¦‚æ–‡ä»¶ä¼ è¾“åè®®FTPï¼Œè¶…æ–‡æœ¬ä¼ è¾“åè®®HTTPï¼Œç®€å•é‚®ä»¶ä¼ è¾“åè®®SMTPç­‰ã€‚</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ChineseProverbServer{\n\n    public void run(final int portl) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(group)\n                    .channel(NioDatagramChannel.class)\n                    .option(ChannelOption.SO_BROADCAST,true)\n                    .handler(new ChineseProverbServerHandler());\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new ChineseProverbServer().run(8080);\n    }\n}\npublic class ChineseProverbServerHandler extends SipmleChannelInbounHandler&lt;DataramPacket&gt;{\n    private static final String[] DICTIONARY={\"åªè¦åŠŸå¤«æ·±ï¼Œé“æŸ±ç£¨æˆé’ˆ\"};\n    private String nextQuote(){\n        int quoted = ThreadLocalRandom.current().nextInf(DICTIONARY.length);\n        return DICTIONARY(quotedId);\n    }\n    public void messageReceived(ChannelHandlerContext ctx,DatagramPacket packet)throws Exception{\n        String req = packet.content().toString(CharsetUitl.UTF_8);\n        System.out.println(req);\n        if(\"è°šè¯­å­—å…¸æŸ¥è¯¢?\".equals(req)){\n            ctx.writeAndFlush(new DatagramPacket(Unpooled.copiedBuffer(\"è°šè¯­æŸ¥è¯¢ç»“æœï¼š\" +newQuote(),CharsetUtil.UTF_8),packet.sender()));\n        }\n    }\n    public void exceptionCaught(ChannelHandlerContext ctx,Throwable cause){\n        ctx.close();\n        cause.printStatckTrace();\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class ChineseProverbClient{\n\n    public void run(final int portl) throws Exception{\n        EventLoopGroup group = new NioEventLoopGroup();\n        try {\n            Bootstrap b = new Bootstrap();\n            b .group(group)\n                    .channel(NioDatagramChannel.class)\n                    .option(ChannelOption.SO_BROADCAST,true)\n                    .handler(new ChineseProverbClientHandler());\n            Channel ch = b.bind(0).sync().channel();\n            ch.writeAndFlush(\n                new DatagramPacket(Unpooled.copiedBuffer(\"è°šè¯­å­—å…¸æŸ¥è¯¢?\",CharsetUtil.UTF_9),new InetSocketAddress(\"255.255.255.255\",port)).sync();//å‘æœ¬ç½‘æ®µå†…æ‰€æœ‰ä¸»æœºå¹¿æ’­è¯·æ±‚æ¶ˆæ¯\n            );\n            if(!ch.closeFuture().await(15000)){\n                System.out.println(\"æŸ¥è¯¢è¶…æ—¶!\")\n            }\n        }finally {\n            group.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new ChineseProverbClient().run(8080);\n    }\n}\npublic class ChineseProverbClientHandler extends SimpleChannelInboundHandler&lt;DatagramPacket&gt;{\n    public void messageReceived(channelHandlerContext ctx,DatagramPacket msg) throws Exception{\n        String response = msg.content().toString(CharsetUtil.UTF_8);\n        if(response.startsWitch(\"è°šè¯­æŸ¥è¯¢ç»“æœ:\")){\n            System.out.println(response);\n            ctx.close();\n        }\n    }\n\n    public void exceptionCaught(ChannelHandlerContext ctx,Throwable cause){\n        cause.prinStackTrace();\n        ctx.close();\n    }\n}\n</code></pre></div><ul>\n<li>æ–‡ä»¶ä¼ è¾“\n<ul>\n<li>æ–‡ä»¶æ˜¯è®¡ç®—æœºä¸­ä¸€ç§åŸºæœ¬çš„æ•°æ®å­˜å‚¨å½¢å¼ï¼Œåœ¨å®é™…å­˜å‚¨æ•°æ®æ˜¯ï¼Œå¦‚æœå¯¹äºæ•°æ®çš„è¯»å†™é€Ÿåº¦è¦æ±‚ä¸æ˜¯å¾ˆé«˜ï¼Œå­˜å‚¨çš„æ•°æ®é‡ä¸æ˜¯å¾ˆå¤§ï¼Œä½¿ç”¨æ–‡ä»¶ä½œä¸ºä¸€ç§æŒä¹…æ•°æ®å­˜å‚¨çš„æ–¹å¼æ˜¯æ¯”è¾ƒå¥½çš„é€‰æ‹©ã€‚å­˜å‚¨åœ¨æ–‡ä»¶å†…éƒ¨çš„æ•°æ®å’Œå†…å­˜ä¸­çš„æ•°æ®ä¸åŒï¼Œå­˜å‚¨åœ¨æ–‡ä»¶ä¸­çš„æ•°æ®æ˜¯ä¸€ç§æ°¸ä¹…å­˜å‚¨</li>\n<li>åœ¨ä¸åŒå­˜å‚¨ä»‹è´¨ä¸­ï¼Œæ–‡ä»¶ä¸­çš„æ•°æ®éƒ½æ˜¯ä»¥ä¸€å®šçš„é¡ºåºä¾æ¬¡å­˜å‚¨èµ·æ¥çš„ã€‚åœ¨ä¸–ç•Œè¯»å–æ—¶ç”±ç¡¬ä»¶ä»¥åŠæ“ä½œç³»ç»Ÿå®Œæˆå¯¹äºæ•°æ®çš„æ§åˆ¶ï¼Œä¿è¯ç¨‹åºè¯»å–åˆ°çš„æ•°æ®ä¸å­˜å‚¨çš„é¡ºåºä¸€è‡´ï¼Œæ¯ä¸ªæ–‡ä»¶ä»¥ä¸€ä¸ªæ–‡ä»¶è·¯å¾„å’Œæ–‡ä»¶åç§°è¿›è¡Œè¡¨ç¤ºï¼Œåœ¨éœ€è¦è®¿é—®è¯¥æ–‡ä»¶æ—¶ï¼Œåªéœ€è¦çŸ¥é“æ”¹æ–‡ä»¶çš„è·¯å¾„ä»¥åŠæ–‡ä»¶çš„å…¨åå³å¯</li>\n<li>ç»å¯¹è·¯å¾„æ˜¯æŒ‡æ–‡ä»¶çš„å®Œæ•´è·¯å¾„ï¼Œä½¿ç”¨è·¯å¾„å¯ä»¥æ‰¾åˆ°ä¸€ä¸ªå”¯ä¸€çš„æ–‡ä»¶ã€‚ä½¿ç”¨ç»å¯¹è·¯å¾„çš„æœ€å¤§ç¼ºç‚¹æ˜¯ä¸åŒæ“ä½œç³»ç»Ÿçš„æ–‡ä»¶è·¯å¾„å’Œè¡¨ç°å½¢å¼ä¸åŒï¼Œä½¿ç”¨ä¸å½“å¾€å¾€ä¼šå¯¼è‡´æ–‡ä»¶è¯»å–å¤±è´¥ï¼Œå®é™…å¾€å¾€ä½¿ç”¨ç›¸å¯¹è·¯å¾„æˆ–è€…ç±»è·¯å¾„</li>\n<li>æ–‡ä»¶ä¸€èˆ¬é‡‡ç”¨æ–‡ä»¶å.åç¼€åå½¢å¼è¿›è¡Œå‘½åï¼Œæ–‡ä»¶åè¡¨ç¤ºæ–‡ä»¶çš„ä½œç”¨ï¼Œåç¼€åè¡¨ç¤ºæ–‡ä»¶çš„ç±»å‹</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class FileServer{\n\n    public void bind(final int portl) throws Exception{\n        EventLoopGroup boosGroup = new NioEventLoopGroup();\n        EventLoopGroup workerGroup = new NioEventLoopGroup();\n        try {\n            ServerBootstrap serverBootstrap = new ServerBootstrap();\n            serverBootstrap.group(boosGroup,workerGroup)\n                    .channel(NioServerSocketChannel.class)\n                    .option(ChannelOption.SO_BAKCLOG,100)\n                    .handler(new ChannelInitalizer&lt;SocketChannel&gt;(){\n                        @Override\n                        public void initChannel(SocketChannel ch) throws Exception{\n                            \n                            ch.pipeline().addLast(new StringEncoder(CharsetUtil.UTF_8),\n                            new LineBasedFrameDecoder(1024)\n                            new StringDecoder(CharsetUtil.UTF_8),\n                            new FileServerHandler()\n                            );\n                        }\n                    });\n            ChannelFuture f = serverBootstrap.bind(port).sync();\n            f.channel().closeFuture().sync();\n        }finally {\n            boosGroup.shutdownGracefully();\n            workerGroup.shutdownGracefully();\n        }\n    }\n\n    public static void main(String[] args) throws Exception {\n        new FileServer().run(8080);\n    }\n}\npublic class FileServerHandler extends SimpleChannelInboundHandler&lt;String&gt;{\n    private static String CR = System.getProperty(\"line.separtor\");\n    public void messageReceived(ChannelHandlerContext ctx,String msg) throws Exception{\n        File file = new File(meg);\n        if(file.exist()){\n            if(!file.isFile()){\n                ctx.writeAndFlush(\"Not a file:\"+ file +CR);\n                return;\n            }\n            ctx.write(file + \" \" file.length() + CR;\n            RandomAccessFile randomAccessFile = new RandomAccessFile(msg,\"r\");\n            FileRegion region = new DefaultFileRegion(\n                //æ–‡ä»¶é€šé“ï¼Œç”¨äºå¯¹æ–‡ä»¶è¿›è¡Œè¯»å†™æ“ä½œ\n                //æ–‡ä»¶æ“ä½œä½ç½®ï¼Œè¯»å–æˆ–å†™å…¥çš„èµ·å§‹ç‚¹\n                //æ“ä½œçš„æ€»å­—èŠ‚æ•°\n                randomAccessFile.getChannel(),0,randomAccessFile.length());\n            )\n            ctx.write(region);\n            ctx.writeAndFlush(CR;\n            randomAccessFile.close();\n        }else{\n            ctx.writeAndFlush(\"File not found: \"+ file + CR);\n        }\n    }\n\n    public void exceptionCaugtht(ChannelHandlerContext ctx,Throwable cause){\n        cause.printStackrace();\n        ctx.close();\n    }\n}\n\nä½¿ç”¨telnet localhost 8080è¿›è¡Œè°ƒè¯•\n</code></pre></div><ul>\n<li>ç§æœ‰åè®®å¼€å‘\n<ul>\n<li>ç§æœ‰åè®®æœ¬è´¨ä¸Šæ˜¯å‚å•†å†…éƒ¨å‘å±•å’Œé‡‡ç”¨çš„æ ‡å‡†ï¼Œé™¤éæˆæƒï¼Œå…¶å®ƒå‚å•†ä¸€èˆ¬æ— æƒä½¿ç”¨è¯¥åè®®ã€‚åªè¦èƒ½å¤Ÿç”¨äºè·¨è¿›ç¨‹ï¼Œè·¨ä¸»æœºæ•°æ®äº¤æ¢çš„éæ ‡å‡†åè®®ï¼Œéƒ½å¯ä»¥æˆä¸ºç§æœ‰åè®®ï¼Œåœ¨ä¼ ç»Ÿçš„Javaåº”ç”¨ä¸­ï¼Œé€šå¸¸ä½¿ç”¨ä¸€ä¸‹4ç§æ–¹å¼è¿›è¡Œè·¨èŠ‚ç‚¹é€šä¿¡ã€‚\n<ul>\n<li>é€šè¿‡RMIè¿›è¡Œè¿œç¨‹æœåŠ¡è°ƒç”¨</li>\n<li>é€šè¿‡Javaçš„Socket+Javaåºåˆ—åŒ–çš„èŒƒå¼è¿›è¡Œè·¨èŠ‚ç‚¹è°ƒç”¨</li>\n<li>åˆ©ç”¨ä¸€äº›å¼€æºçš„RPCæ¡†æ¶è¿›è¡Œè¿œç¨‹æœåŠ¡è°ƒç”¨ã€‚å¦‚Facebookeçš„Thriftï¼ŒApacheçš„Avroç­‰</li>\n<li>åˆ©ç”¨æ ‡å‡†çš„å…±æœ‰åè®®è¿›è¡Œè·¨èŠ‚ç‚¹æœåŠ¡è°ƒç”¨ï¼šHTTP+XMLï¼ŒRESTful+JSONæˆ–è€…Webservice</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>ç§æœ‰åè®®æ ˆåŠŸèƒ½æè¿°\n<ul>\n<li>åŸºäºNettyçš„NIOé€šä¿¡æ¡†æ¶ï¼Œæä¾›é«˜æ€§èƒ½çš„å¼‚æ­¥é€šä¿¡èƒ½åŠ›</li>\n<li>æä¾›æ¶ˆæ¯çš„ç¼–è§£ç æ¡†æ¶ï¼Œå¯ä»¥å®ç°POJOçš„åºåˆ—åŒ–å’Œååºåˆ—åŒ–</li>\n<li>æä¾›åŸºäºIPåœ°å€çš„ç™½åå•æ¥å…¥è®¤è¯æœºåˆ¶</li>\n<li>é“¾è·¯æœ‰æ•ˆæ€§æ ¡éªŒæœºåˆ¶</li>\n<li>é“¾è·¯çš„æ–­è¿é‡è¿æœºåˆ¶</li>\n</ul>\n</li>\n<li>é€šä¿¡æ¨¡å‹\n<ul>\n<li>Nettyåè®®æ ˆå®¢æˆ·ç«¯å‘é€æ¡æ‰‹è¯·æ±‚æ¶ˆæ¯ï¼Œæºå¸¦èŠ‚ç‚¹IDç­‰æœ‰æ•ˆèº«ä»½è®¤è¯ä¿¡æ¯</li>\n<li>Nettyåè®®æ ˆæœåŠ¡ç«¯å¯¹æ¡æ‰‹è¯·æ±‚åè®®è¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼ŒåŒ…æ‹¬èŠ‚ç‚¹IDæœ‰æ•ˆæ€§æ ¡éªŒï¼ŒèŠ‚ç‚¹é‡å¤ç™»å½•æ ¡éªŒå’ŒIPåœ°å€åˆæ³•æ–°æ ¡éªŒï¼Œæ ¡éªŒé€šè¿‡åï¼Œè¿”å›ç™»å½•æˆåŠŸçš„æ¡æ‰‹åº”ç­”æ¶ˆæ¯</li>\n<li>é“¾è·¯å»ºç«‹æˆåŠŸä¹‹åï¼Œå®¢æˆ·ç«¯å‘é€ä¸šåŠ¡æ¶ˆæ¯</li>\n<li>é“¾è·¯æˆåŠŸä¹‹åï¼ŒæœåŠ¡ç«¯å‘é€å¿ƒè·³æ¶ˆæ¯</li>\n<li>é“¾è·¯å»ºç«‹æˆåŠŸä¹‹åï¼Œå®¢æˆ·ç«¯å‘é€å¿ƒè·³æ¶ˆæ¯</li>\n<li>é“¾è·¯å»ºç«‹æˆåŠŸä¹‹åï¼ŒæœåŠ¡ç«¯å‘é€ä¸šåŠ¡æ¶ˆæ¯</li>\n<li>æœåŠ¡ç«¯é€€å‡ºæ—¶ï¼ŒæœåŠ¡ç«¯å…³é—­è¿æ¥ï¼Œå®¢æˆ·ç«¯æ„ŸçŸ¥å¯¹æ–¹å…³é—­è¿æ¥åï¼Œè¢«åŠ¨å…³é—­å®¢æˆ·ç«¯è¿æ¥</li>\n<li>å¤‡æ³¨ï¼šNettyåè®®é€šä¿¡åŒæ–¹é“¾è·¯å»ºç«‹æˆåŠŸä¹‹åï¼ŒåŒæ–¹å¯ä»¥è¿›è¡Œå…¨åŒå·¥é€šä¿¡ï¼Œæ— è®ºå®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼Œéƒ½å¯ä»¥ä¸»åŠ¨å‘é€è¯·æ±‚æ¶ˆæ¯ç»™å¯¹å®‰é˜²ï¼Œé€šä¿¡æ–¹å¼å¯ä»¥æ˜¯TWOWAYæˆ–è€…ONEWAYã€‚åŒæ–¹ä¹‹é—´çš„å¿ƒè·³é‡‡ç”¨Ping-Pongæœºåˆ¶ï¼Œå½“é“¾è·¯å¤„äºç©ºé—²çŠ¶æ€æ—¶ï¼Œå®¢æˆ·ç«¯ä¸»åŠ¨å‘é€Pingæ¶ˆæ¯ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯æ¥æ”¶åˆ°Pingæ¶ˆæ¯åå‘é€åº”ç­”æ¶ˆæ¯Pongç»™å®¢æˆ·ç«¯ï¼Œå¦‚æœå®¢æˆ·ç«¯è¿ç»­å‘é€Næ¡Pingæ¶ˆæ¯æ¬§æ²¡æœ‰æ¥æ”¶åˆ°æœåŠ¡ç«¯è¿”å›çš„Pongæ¶ˆæ¯ï¼Œè¯´æ˜é“¾è·¯å·²ç»æŒ‚æ­»æˆ–è€…å¯¹æ–¹å¤„äºå¼‚å¸¸çŠ¶æ€ï¼Œå®¢æˆ·ç«¯ä¸»åŠ¨å…³é—­è¿æ¥ï¼Œé—´éš”å‘¨æœŸTåå‘èµ·é‡è¿æ“ä½œï¼Œç›´åˆ°é‡è¿æˆåŠŸ</li>\n<li>Nettyåè®®æ ˆæ¶ˆæ¯å®šä¹‰\n<ul>\n<li>æ¶ˆæ¯å¤´\n<ul>\n<li>headerï¼šHeader å˜é•¿ æ¶ˆæ¯å¤´å®šä¹‰\n<ul>\n<li>crcCode :æ•´å‹int 32 Nettyæ¶ˆæ¯çš„æ ¡éªŒç \n<ul>\n<li>0xABEF:å›ºå®šå€¼ï¼Œè¡¨æ˜è¯¥æ¶ˆæ¯æ˜¯Nettyåè®®æ¶ˆæ¯ï¼Œ2ä¸ªå­—èŠ‚</li>\n<li>ä¸»ç‰ˆæœ¬å·:1-255,1ä¸ªå­—èŠ‚</li>\n<li>æ¬¡ç‰ˆæœ¬å·:1-255,1ä¸ªå­—èŠ‚</li>\n</ul>\n</li>\n<li>length: æ•´å‹int 32 æ¶ˆæ¯é•¿åº¦ï¼Œæ•´ä¸ªæ¶ˆæ¯ï¼ŒåŒ…æ‹¬æ¶ˆæ¯å¤´å’Œæ¶ˆæ¯ä½“</li>\n<li>sessionIDï¼šé•¿æ•´å‹long 64 é›†ç¾¤èŠ‚ç‚¹å†…å…¨å±€å”¯ä¸€ï¼Œç”±ä¼šè¯IDç”Ÿæˆå™¨ç”Ÿæˆ</li>\n<li>type Byte 8 0ä¸šåŠ¡è¯·æ±‚æ¶ˆæ¯ 1ä¸šåŠ¡å“åº”æ¶ˆæ¯ 2ä¸šåŠ¡ONE WAYæ¶ˆæ¯ï¼ˆæ—¢æ˜¯è¯·æ±‚åˆæ˜¯å“åº”æ¶ˆæ¯ï¼‰3æˆ‘æ”¶è¯·æ±‚æ¶ˆæ¯ 4 æ¡æ‰‹åº”ç­”æ¶ˆæ¯5 å¿ƒè·³è¯·æ±‚æ¶ˆæ¯ 6å¿ƒè·³åº”ç­”æ¶ˆæ¯</li>\n<li>priority Byte 8 æ¶ˆæ¯ä¼˜å…ˆçº§ 0-255</li>\n<li>attachment Map&lt;String,Object&gt; å˜é•¿ å¯é€‰å­—æ®µï¼Œç”¨äºæ‰©å±•æ¶ˆæ¯å¤´</li>\n</ul>\n</li>\n<li>bodyï¼šObject å˜é•¿ å¯¹äºè¯·æ±‚æ¶ˆæ¯ï¼Œå®ƒæ˜¯æ–¹æ³•çš„å‚æ•°ï¼Œå¯¹äºå“åº”æ¶ˆæ¯ï¼Œå®ƒæ˜¯è¿”å›å€¼</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>Nettyåè®®æ”¯æŒçš„å­—æ®µç±»å‹\n<ul>\n<li>boolean/Boolean</li>\n<li>byte/Byte</li>\n<li>intå¯¹åº”C/C++int32</li>\n<li>char/Character</li>\n<li>shortå¯¹åº”C/C++int16</li>\n<li>longå¯¹åº”C/C++int64</li>\n<li>float/Float</li>\n<li>double/Double</li>\n<li>String å¯¹åº”C/C++String</li>\n<li>listæ”¯æŒå„ç§Listå®ç°</li>\n<li>arrayæ”¯æŒå„ç§æ•°ç»„å®ç°</li>\n<li>mapæ”¯æŒMapåµŒå¥—å’Œæ³›å‹</li>\n<li>setæ”¯æŒSetåµŒå¥—å’Œæ³›å‹</li>\n</ul>\n</li>\n<li>Nettyåè®®çš„ç¼–è§£ç è§„èŒƒ\n<ul>\n<li>Neetyåè®®NettyMessageçš„ç¼–ç è§„èŒƒå¦‚ä¸‹\n<ul>\n<li>crcCode:java.nio.ByteBuffer.putInt(int value),å¦‚æœé‡‡ç”¨å…¶ä»–ç¼“å†²åŒºå®ç°ï¼Œå¿…é¡»ä¸å…¶ç­‰ä»·</li>\n<li>length:java.nio.ByteBuffer.putInt(int value),å¦‚æœé‡‡ç”¨å…¶ä»–ç¼“å†²åŒºå®ç°ï¼Œå¿…é¡»ä¸å…¶ç­‰ä»·</li>\n<li>sessionID:java.nio.ByteBuffer.putLong(Long value),å¦‚æœé‡‡ç”¨å…¶ä»–ç¼“å†²åŒºå®ç°ï¼Œå¿…é¡»ä¸å…¶ç­‰ä»·</li>\n<li>type:java.nio.ByteBuffer.put(byte b),å¦‚æœé‡‡ç”¨å…¶ä»–ç¼“å†²åŒºå®ç°ï¼Œå¿…é¡»ä¸å…¶ç­‰ä»·</li>\n<li>priority:java.nio.ByteBuffer.put(byte b),å¦‚æœé‡‡ç”¨å…¶ä»–ç¼“å†²åŒºå®ç°ï¼Œå¿…é¡»ä¸å…¶ç­‰ä»·</li>\n<li>attachment:å¦‚æœattachmenté•¿åº¦ä¸º0ï¼Œè¡¨ç¤ºæ²¡æœ‰å¯é€‰é™„ä»¶ï¼Œåˆ™å°†é•¿åº¦ç¼–ç è®¾ä¸º0ï¼Œjava.nio.ByteBuffer.putInt(0);å¦‚æœå¤§äº0ï¼Œè¯´æ˜æœ‰é™„ä»¶ç¼–ç ï¼Œé¦–å…ˆå¯¹é™„ä»¶ä¸ªæ•°è¿›è¡Œç¼–ç ï¼Œjava.nio.ByteBuffer.putInt(attachment.size());ç„¶åå¯¹Keyè¿›è¡Œç¼–ç ï¼Œå…ˆç¼–ç é•¿åº¦ï¼Œå†å°†å®ƒè½¬æˆbyteæ•°ç»„ä¹‹åç¼–ç å†…å®¹</li>\n<li>bodyçš„ç¼–ç : é€šè¿‡JBossMarshallingå°†å…¶åºåˆ—åŒ–ä¸ºbyteæ•°ç»„ï¼Œç„¶åè°ƒç”¨java.nio.ByteBuffer.put(byte[] src)å°†å…¶å†™å…¥ByteBufferç¼“å†²åŒºä¸­</li>\n<li>ç”±äºæ•´ä¸ªæ¶ˆæ¯çš„é•¿åº¦å¿…é¡»ç­‰å…¨éƒ¨å­—æ®µéƒ½ç¼–ç å®Œæˆä¹‹åæ‰èƒ½ç¡®è®¤ï¼Œæ‰€ä»¥æœ€åéœ€è¦æ›´æ–°æ¶ˆæ¯å¤´ä¸­çš„lengthå­—æ®µï¼Œå°†å…¶é‡æ–°å†™å…¥ByteBufferä¸­</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>String key = null;\nbyte[] value = null;\nfor(Map.Entry&lt;String,Object&gt; param:attchment.entrySet()){\n    key = param.getKey();\n    buffer.writeString(key);\n    value = marshallier.writeObject(parm.getValue());\n    buffer.writeBinary(value);\n    key = null;\n    value = null;\n}\n\n</code></pre></div><pre><code>- Nettyåè®®çš„è§£ç \n  -  crcCode:java.nio.ByteBuffer.getInt()è·å–æ ¡éªŒç å­—æ®µï¼Œå…¶å®ƒç¼“å†²åŒºå¿…é¡»ä¸å…¶ç­‰ä»·\n  -  length:java.nio.ByteBuffer.getInt()è·å–Nettyæ¶ˆæ¯çš„é•¿åº¦ï¼Œå…¶å®ƒç¼“å†²åŒºå¿…é¡»ä¸å…¶ç­‰ä»·\n  -  sessionID:java.nio.ByteBuffer.getLong()è·å–ä¼šè¯IDï¼Œå…¶å®ƒç¼“å†²åŒºå¿…é¡»ä¸å…¶ç­‰ä»·\n  -  type:java.nio.ByteBuffer.get()è·å–æ¶ˆæ¯ç±»å‹ï¼Œå…¶å®ƒç¼“å†²åŒºå¿…é¡»ä¸å…¶ç­‰ä»·\n  -  priority:java.nio.ByteBuffer.get()è·å–æ¶ˆæ¯ä¼˜å…ˆçº§ï¼Œå…¶å®ƒç¼“å†²åŒºå¿…é¡»ä¸å…¶ç­‰ä»·\n  -  attachment:é¦–å…ˆåˆ›å»ºä¸€ä¸ªæ–°çš„attachmentå¯¹è±¡ï¼Œè°ƒç”¨java.nio.ByteBuffer.getInt()è·å–é™„ä»¶çš„é•¿åº¦ï¼Œå¦‚æœä¸º0ï¼Œè¯´æ˜é™„ä»¶ä¸ºç©ºï¼Œè§£ç ç»“æŸï¼Œç»§ç»­è§£æ¶ˆæ¯ä½“ï¼Œå¦‚æœéç©ºï¼Œåˆ™æ ¹æ®é•¿åº¦é€šè¿‡forå¾ªç¯è§£ç \n  -  body é€šè¿‡JBossçš„marshallerè¿›è¡Œè§£ç \n</code></pre>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>String key = null;\nObject value = null;\nfor(int i=0;i&lt;size;i++){\n    key = buffer.readString();\n    value = unmarshaller.readObject(buffer.readBinary());\n    this.attachment.put(key,value)l;\n}\nkey = null;\nvalue = null;\n</code></pre></div><ul>\n<li>é“¾è·¯çš„å»ºç«‹\n<ul>\n<li>Nettyåè®®æ ˆå¯¹å®¢æˆ·ç«¯çš„è¯´æ˜å¦‚ä¸‹ï¼šå¦‚æœAèŠ‚ç‚¹éœ€è¦è°ƒç”¨BèŠ‚ç‚¹çš„æœåŠ¡ï¼Œä½†æ˜¯Aå’ŒBä¹‹é—´è¿˜æ²¡æœ‰å»ºç«‹ç‰©ç†é“¾è·¯ï¼Œåˆ™ç”±è°ƒç”¨æ–¹ä¸»åŠ¨å‘èµ·è¿æ¥ï¼Œæ­¤æ—¶ï¼Œè°ƒç”¨æ–¹ä¸ºå®¢æˆ·ç«¯ï¼Œè¢«è°ƒç”¨æ–¹ä¸ºæœåŠ¡ç«¯</li>\n<li>è€ƒè™‘åˆ°å®‰å…¨ï¼Œé“¾è·¯å»ºç«‹éœ€è¦é€šè¿‡åŸºäºIPåœ°å€æˆ–è€…å·æ®µçš„é»‘ç™½åå•å®‰å…¨è®¤è¯æœºåˆ¶ã€‚</li>\n<li>å®¢æˆ·ç«¯ä¸æœåŠ¡ç«¯é“¾è·¯å»ºç«‹æˆåŠŸä¹‹åï¼Œç”±å®¢æˆ·ç«¯å‘é€æ¡æ‰‹è¯·æ±‚æ¶ˆæ¯ï¼Œæ¡æ‰‹è¯·æ±‚æ¶ˆæ¯å®šä¹‰å¦‚ä¸‹\n<ul>\n<li>æ¶ˆæ¯å¤´çš„typeå­—æ®µå€¼ä¸º3</li>\n<li>å¯é€‰é™„ä»¶ä¸ºä¸ªæ•°ä¸º0</li>\n<li>æ¶ˆæ¯ä½“ä¸ºç©º</li>\n<li>æ¡æ‰‹æ¶ˆæ¯çš„é•¿åº¦ä¸º22ä¸ªå­—èŠ‚</li>\n</ul>\n</li>\n<li>æœåŠ¡ç«¯æ”¶åˆ°å®¢æˆ·ç«¯çš„æ¡æ‰‹è¯·æ±‚æ¶ˆæ¯ä¹‹åï¼Œå¦‚æœIPæ ¡éªŒé€šè¿‡ï¼Œè¿”å›æ¡æ‰‹æˆåŠŸåº”ç­”æ¶ˆæ¯ç»™å®¢æˆ·ç«¯ï¼Œåº”ç”¨å±‚é“¾è·¯å»ºç«‹æˆåŠŸã€‚æ¡æ‰‹åº”ç­”æ¶ˆæ¯å®šä¹‰å¦‚ä¸‹\n<ul>\n<li>æ¶ˆæ¯å¤´çš„typeå­—æ®µå€¼ä¸º4</li>\n<li>å¯é€‰é™„ä»¶ä¸ªæ•°ä¸º0</li>\n<li>æ¶ˆæ¯ä½“byteç±»å‹çš„ç»“æœ 0 è®¤è¯æˆåŠŸ - è®¤è¯å¤±è´¥</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é“¾è·¯çš„å…³é—­\n<ul>\n<li>ç”±äºé‡‡ç”¨é•¿è¿æ¥é€šä¿¡ï¼Œåœ¨æ­£å¸¸çš„ä¸šåŠ¡è¿è¡ŒæœŸé—´ï¼ŒåŒæ–¹é€šè¿‡å¿ƒè·³å’Œä¸šåŠ¡æ¶ˆæ¯ç»´æŒé“¾è·¯ï¼Œä»»ä½•ä¸€æ–¹éƒ½ä¸éœ€è¦ä¸»åŠ¨å…³é—­è¿æ¥\n<ul>\n<li>å½“å¯¹æ–¹å®•æœºæˆ–è€…é‡å¯æ—¶ï¼Œä¼šä¸»åŠ¨å…³é—­é“¾è·¯ï¼Œå¦ä¸€æ–¹è¯»å–åˆ°æ“ä½œç³»ç»Ÿçš„é€šçŸ¥ä¿¡å·ï¼Œå¾—çŸ¥å¯¹æ–¹RESTé“¾è·¯ï¼Œéœ€è¦å…³é—­è¿æ¥ï¼Œé‡Šæ”¾è‡ªèº«å¥æŸ„ç­‰èµ„æºã€‚ç”±äºé‡‡ç”¨å…¨åŒå·¥é€šä¿¡ï¼Œé€šä¿¡åŒæ–¹éƒ½éœ€è¦å…³é—­è¿æ¥ï¼Œé‡Šæ”¾èµ„æº</li>\n<li>æ¶ˆæ¯è¯»å†™è¿‡ç¨‹ä¸­ï¼Œå‘ç”Ÿäº†I/Oå¼‚å¸¸ï¼Œéœ€è¦ä¸»åŠ¨å…³é—­è¿æ¥</li>\n<li>ä¿¡æ¡æ¶ˆæ¯è¯»å†™è¿‡ç¨‹ä¸­å‘ç”Ÿäº†I/Oå¼‚å¸¸ï¼Œéœ€è¦ä¸»åŠ¨å…³é—­è¿æ¥</li>\n<li>å¿ƒè·³è¶…æ—¶ï¼Œéœ€è¦ä¸»åŠ¨å…³é—­è¿æ¥</li>\n<li>å‘ç”Ÿç¼–ç å¼‚å¸¸ç­‰ä¸å¯æ¢å¤é”™è¯¯æ—¶ï¼Œéœ€è¦ä¸»åŠ¨å…³é—­è¿æ¥</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å¯é æ€§è®¾è®¡\n<ul>\n<li>Nettyåè®®æ ˆå¯èƒ½ä¼šè¿è¡Œåœ¨éå¸¸æ¶åŠ£çš„ç½‘ç»œç¯å¢ƒä¸­ï¼Œç½‘ç»œè¶…æ—¶ï¼Œé—ªæ–­ï¼Œå¯¹æ–¹è¿›ç¨‹åƒµæ­»æˆ–è€…å¤„ç†ç¼“æ…¢ç­‰æƒ…å†µéƒ½æœ‰å¯èƒ½å‘ç”Ÿã€‚ä¸ºäº†ä¿è¯åœ¨è¿™äº›æç«¯çš„å¼‚å¸¸åœºæ™¯ä¸‹Nettyåè®®æ ˆèƒ½å¤Ÿæ­£å¸¸å·¥ä½œæˆ–è€…è‡ªåŠ¨æ¢å¤ï¼Œéœ€è¦å¯¹å®ƒçš„å¯é æ€§è¿›è¡Œç»Ÿä¸€è§„åˆ’å’Œè®¾è®¡\n<ul>\n<li>å¿ƒè·³æœºåˆ¶\n<ul>\n<li>åœ¨å‡Œæ™¨ç­‰ä¸šåŠ¡ä½è°·æœŸæ—¶æ®µï¼Œå¦‚æœå‘ç”Ÿç½‘ç»œé—ªæ–­ï¼Œè¿æ¥è¢«Hangç­‰ç½‘ç»œé—®é¢˜æ—¶ï¼Œç”±äºæ²¡æœ‰ä¸šåŠ¡æ¶ˆæ¯ï¼Œåº”ç”¨è¿›ç¨‹å¾ˆéš¾å‘ç°ã€‚åˆ°äº†ç™½å¤©ä¸šåŠ¡é«˜å³°æœŸæ—¶ï¼Œä¼šå‘ç”Ÿå¤§é‡çš„ç½‘ç»œé€šä¿¡å¤±è´¥ã€‚ä¸¥é‡ä¼šå¯¼è‡´ä¸€æ®µæ—¶é—´è¿›ç¨‹æ— æ³•å¤„ç†ä¸šåŠ¡æ¶ˆæ¯ã€‚ä¸ºäº†è§£å†³è¿™ä¸ªé—®é¢˜ï¼Œåœ¨ç½‘ç»œç©ºé—²æ—¶é‡‡ç”¨å¿ƒè·³æœºåˆ¶æ¥æ£€æµ‹é“¾è·¯çš„äº’é€šæ€§ï¼Œä¸€æ—¦å‘ç”Ÿç½‘ç»œæ•…éšœï¼Œç«‹å³å…³é—­é“¾è·¯ï¼Œä¸»åŠ¨é‡è¿\n<ul>\n<li>å½“ç½‘ç»œå¤„äºç©ºé—²çŠ¶æ€æŒç»­è¾¾åˆ°Tï¼ˆè¿ç»­å‘¨æœŸTæ²¡æœ‰è¯»å†™æ¶ˆæ¯ï¼‰æ—¶ï¼Œå®¢æˆ·ç«¯ä¸»åŠ¨å‘é€Pingå¿ƒè·³æ¶ˆæ¯ç»™æœåŠ¡ç«¯</li>\n<li>å¦‚æœåœ¨ä¸‹ä¸€ä¸ªå‘¨æœŸTåˆ°æ¥å¸‚å®¢æˆ·ç«¯æ²¡æœ‰æ”¶åˆ°å¯¹æ–¹å‘é€çš„Pongå¿ƒè·³åº”ç­”æ¶ˆæ¯æˆ–è€…è¯»åˆ°æœåŠ¡ç«¯å‘é€çš„å…¶å®ƒä¸šåŠ¡æ¶ˆæ¯ï¼Œåˆ™å¿ƒè·³å¤±è´¥è®¡æ•°å™¨åŠ 1</li>\n<li>æ¯å½“å®¢æˆ·ç«¯æ”¶åˆ°æœåŠ¡çš„ä¸šåŠ¡æ¶ˆæ¯æˆ–è€…Pongåº”ç­”æ¶ˆæ¯ï¼Œå°†å¿ƒè·³å¤±è´¥è®¡æ•°å™¨æ¸…é›¶ï¼›å½“è¿ç»­Næ¬¡æ²¡æœ‰æ¥æ”¶åˆ°æœåŠ¡ç«¯çš„Pongæ¶ˆæ¯æˆ–è€…ä¸šåŠ¡æ¶ˆæ¯ï¼Œåˆ™å…³é—­é“¾è·¯ï¼Œé—´éš”INTERVALæ—¶é—´åå‘èµ·é‡è¿æ“ä½œ</li>\n<li>æœåŠ¡ç«¯ç½‘ç»œç©ºé—²çŠ¶æ€æŒç»­æ—¶é—´è¾¾åˆ°Tåï¼ŒæœåŠ¡ç«¯å°†å¿ƒè·³å¤±è´¥è®¡æ•°å™¨åŠ 1ï¼›åªè¦æ¥æ”¶åˆ°å®¢æˆ·ç«¯å‘é€çš„Pingæ¶ˆæ¯æˆ–è€…å…¶å®ƒä¸šåŠ¡æ¶ˆæ¯ï¼Œè®¡æ•°å™¨æ¸…é›¶</li>\n<li>æœåŠ¡ç«¯è¿ç»­Næ¬¡æ²¡æœ‰æ¥æ”¶åˆ°å®¢æˆ·ç«¯çš„Pingæ¶ˆæ¯æˆ–è€…å…¶å®ƒä¸šåŠ¡æ¶ˆæ¯ï¼Œåˆ™å…³é—­é“¾è·¯ï¼Œé‡Šæ”¾èµ„æºï¼Œç­‰å¾…å®¢æˆ·ç«¯é‡è¿</li>\n<li>é€šè¿‡Ping-PongåŒå‘å¿ƒè·³æœºåˆ¶ï¼Œå¯ä»¥ä¿è¯æ— è®ºé€šä¿¡å“ªä¸€æ–¹å‡ºç°ç½‘ç»œæ•…éšœï¼Œéƒ½èƒ½è¢«å‡ æ—¶åœ°æ£€æµ‹å‡ºæ¥ï¼Œä¸ºäº†é˜²æ­¢ç”±äºå¯¹æ–¹çŸ­æ—¶é—´å†…ç¹å¿™è€Œæ²¡æœ‰åŠæ—¶è¿”å›åº”ç­”é€ æˆçš„è¯¯åˆ¤ï¼Œåªæœ‰è¿ç»­Næ¬¡å¿ƒè·³æ£€æµ‹å¤±è´¥æ‰è®¤å®šé“¾è·¯å·²ç»æŸå®³ï¼Œéœ€è¦å…³é—­é“¾è·¯å¹¶é‡å»ºé“¾è·¯</li>\n<li>å½“è¯»æˆ–è€…å†™ä¿¡æ¡æ¶ˆæ¯å‘ç”ŸI/Oå¼‚å¸¸çš„æ—¶å€™ï¼Œè¯´æ˜é“¾è·¯å·²ç»ä¸­æ–­ï¼Œæ­¤æ—¶éœ€è¦ç«‹å³å…³é—­é“¾è·¯ï¼Œå¦‚æœæ˜¯å®¢æˆ·ç«¯ï¼Œéœ€è¦é‡æ–°å‘èµ·è¿æ¥ï¼Œå¦‚æœæ˜¯æœåŠ¡ç«¯ï¼Œéœ€è¦æ¸…ç©ºç¼“å­˜çš„åŠåŒ…ä¿¡æ¯ï¼Œç­‰å¾…å®¢æˆ·ç«¯é‡è¿</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>é‡è¿æœºåˆ¶\n<ul>\n<li>å¦‚æœé“¾è·¯ä¸­æ–­ï¼Œç­‰å¾…INTERVALæ—¶é—´åï¼Œç”±å®¢æˆ·ç«¯å‘èµ·é‡è¿æ“ä½œï¼Œå¦‚æœé‡è¿å¤±è´¥ï¼Œé—´éš”å‘¨æœŸINTERVALåå†æ¬¡å‘èµ·é‡è¿ï¼Œç›´åˆ°é‡è¿æˆåŠŸ</li>\n<li>ä¸ºäº†ä¿è¯æœåŠ¡ç«¯èƒ½å¤Ÿæœ‰å……è¶³çš„æ—¶é—´é‡Šæ”¾å¥æŸ„èµ„æºï¼Œåœ¨é¦–æ¬¡æ–­è¿æ—¶å®¢æˆ·ç«¯éœ€è¦ç­‰å¾…INTERVALæ—¶é—´ä¹‹åå†å‘èµ·é‡è¿ï¼Œè€Œä¸æ˜¯å¤±è´¥å°±ç«‹å³é‡è¿</li>\n<li>ä¸ºäº†ä¿è¯å¥æŸ„èµ„æºå‡ æ—¶é‡Šæ”¾ï¼Œæ— è®ºä»€ä¹ˆåœºæ™¯ä¸‹çš„é‡è¿å¤±è´¥ï¼Œå®¢æˆ·ç«¯éƒ½å¿…é¡»ä¿è¯è‡ªèº«èµ„æºè¢«åŠæ—¶é‡Šæ”¾ï¼ŒåŒ…æ‹¬ä½†ä¸é™äºSocketChannelã€‚Socketç­‰</li>\n<li>é‡è¿å¤±è´¥åï¼Œéœ€è¦æ‰“å°å¼‚å¸¸å †æ ˆä¿¡æ¯ï¼Œæ–¹ä¾¿åç»­çš„é—®é¢˜å®šä½</li>\n</ul>\n</li>\n<li>é‡å¤ç™»å½•ä¿æŠ¤\n<ul>\n<li>å½“å®¢æˆ·ç«¯æ¡æ‰‹æˆåŠŸä¹‹åï¼Œåœ¨é“¾è·¯å¤„äºæ­£å¸¸çŠ¶æ€ä¸‹ï¼Œä¸å…è®¸å®¢æˆ·ç«¯é‡å¤ç™»å½•ï¼Œä»¥é˜²æ­¢å®¢æˆ·ç«¯åœ¨å¼‚å¸¸çŠ¶æ€ä¸‹åå¤é‡è¿å¯¼è‡´å¥æŸ„èµ„æºè¢«è€—å°½</li>\n<li>æœåŠ¡ç«¯æ¥æ”¶åˆ°å®¢æˆ·ç«¯æ¡æ‰‹è¯·æ±‚æ¶ˆæ¯ä¹‹åï¼Œé¦–å…ˆå¯¹IPåœ°å€è¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œå¦‚æœæ ¡éªŒæˆåŠŸï¼Œåœ¨ç¼“å­˜çš„åœ°å€è¡¨ä¸­æŸ¥çœ‹å®¢æˆ·ç«¯æ˜¯å¦å·²ç»ç™»å½•ï¼Œå¦‚æœå·²ç»ç™»å½•ï¼Œåˆ™æ‹’ç»é‡å¤ç™»å½•ï¼Œè¿”å›é”™è¯¯ç -1ï¼ŒåŒæ—¶å…³é—­TCPé“¾è·¯ï¼Œå¹¶åœ¨æœåŠ¡ç«¯çš„æ—¥å¿—ä¸­æ‰“å°æ¡æ‰‹å¤±è´¥çš„åŸå› </li>\n<li>å®¢æˆ·ç«¯æ”¶åˆ°æ¡æ‰‹å¤±è´¥çš„åº”ç­”æ¶ˆæ¯ä¹‹åï¼Œå…³é—­å®¢æˆ·ç«¯çš„TCPè¿æ¥ï¼Œç­‰å¾…INTERVALæ—¶é—´ä¹‹åï¼Œå†æ¬¡å‘èµ·TCPè¿æ¥ï¼Œç›´åˆ°è®¤è¯æˆåŠŸ</li>\n<li>ä¸ºäº†é˜²æ­¢ç”±æœåŠ¡ç«¯å’Œå®¢æˆ·ç«¯å¯¹é“¾è·¯çŠ¶æ€ç†è§£ä¸ä¸€è‡´å¯¼è‡´çš„å®¢æˆ·ç«¯æ— æ³•æ¡æ‰‹æˆåŠŸçš„é—®é¢˜ï¼Œå½“æœåŠ¡ç«¯è¿ç»­Næ¬¡å¿ƒè·³è¶…æ—¶ä¹‹åéœ€è¦ä¸»åŠ¨å…³é—­é“¾è·¯ï¼Œæ¸…ç©ºæ”¹å®¢æˆ·ç«¯çš„åœ°å€ç¼“å­˜ä¿¡æ¯ï¼Œä¸ºäº†ä¿è¯åç»­è¯¥å®¢æˆ·ç«¯å¯ä»¥é‡è¿æˆåŠŸï¼Œé˜²æ­¢è¢«é‡å¤ç™»å½•ä¿æŠ¤æœºåˆ¶æ‹’ç»æ‰</li>\n</ul>\n</li>\n<li>æ¶ˆæ¯ç¼“å­˜é‡å‘\n<ul>\n<li>æ— è®ºå®¢æˆ·ç«¯è¿˜æ˜¯æœåŠ¡ç«¯ï¼Œå½“é“¾è·¯å‘ç”Ÿä¸­æ–­ä¹‹åï¼Œåœ¨é“¾è·¯æ¢å¤ä¹‹å‰ï¼Œç¼“å­˜åœ¨æ¶ˆæ¯é˜Ÿåˆ—ä¸­å¾…å‘é€çš„æ¶ˆæ¯ä¸èƒ½ä¸¢å¤±ï¼Œç­‰é“¾è·¯æ¢å¤ä¹‹åï¼Œé‡æ–°å‘é€è¿™äº›æ¶ˆæ¯ï¼Œä¿è¯é“¾è·¯ä¸­æ–­æœŸé—´æ¶ˆæ¯ä¸ä¸¢å¤±</li>\n<li>è€ƒè™‘åˆ°å†…å­˜æº¢å‡ºçš„é£é™©ï¼Œå»ºè®®æ¶ˆæ¯ç¼“å­˜é˜Ÿåˆ—è®¾ç½®ä¸Šé™ï¼Œå½“è¾¾åˆ°ä¸Šé™ä¹‹åï¼Œåº”è¯¥æ‹’ç»ç»§ç»­å‘è¯¥é˜Ÿåˆ—æ·»åŠ æ¶ˆæ¯</li>\n</ul>\n</li>\n</ul>\n</li>\n<li>å®‰å…¨æ€§è®¾è®¡\n<ul>\n<li>ä¸ºäº†ä¿è¯æ•´ä¸ªé›†ç¾¤ç¯å¢ƒçš„å®‰å…¨ï¼Œå†…éƒ¨é•¿è¿æ¥é‡‡ç”¨åŸºäºIPåœ°å€çš„å®‰å…¨è®¤è¯æœºåˆ¶ï¼ŒæœåŠ¡ç«¯å¯¹æ¡æ‰‹è¯·æ±‚æ¶ˆæ¯çš„IPåœ°å€è¿›è¡Œåˆæ³•æ€§æ ¡éªŒï¼Œå¦‚æœåœ¨ç™½åå•ä¹‹å†…ï¼Œåˆ™æ ¡éªŒé€šè¿‡ï¼Œå¦åˆ™ï¼Œæ‹’ç»å¯¹æ–¹è¿æ¥</li>\n<li>å¦‚æœå°†Nettyåè®®æ ˆæ”¾åˆ°å…¬ç½‘ä¸­ä½¿ç”¨ï¼Œéœ€è¦é‡‡ç”¨æ›´åŠ ä¸¥æ ¼çš„å®‰å…¨è®¤è¯æœºåˆ¶ï¼Œä¾‹å¦‚åŸºäºç§˜é’¥å’ŒAESåŠ å¯†çš„ç”¨æˆ·å+å¯†ç è®¤è¯æœºåˆ¶ï¼Œä¹Ÿå¯ä»¥é‡‡ç”¨SSL/TSLå®‰å…¨ä¼ è¾“</li>\n</ul>\n</li>\n<li>å¯æ‰©å±•æ€§è®¾è®¡\n<ul>\n<li>Nettyåè®®éœ€è¦å…·å¤‡ä¸€å®šçš„æ‰©å±•èƒ½åŠ›ï¼Œä¸šåŠ¡å¯ä»¥åœ¨æ¶ˆæ¯å¤´ä¸­è‡ªå®šä¹‰ä¸šåŠ¡åŸŸå­—æ®µï¼Œä¾‹å¦‚æ¶ˆæ¯æµæ°´å·ï¼Œä¸šåŠ¡è‡ªå®šä¹‰æ¶ˆæ¯å¤´ç­‰ï¼Œé€šè¿‡nettyæ¶ˆæ¯å¤´ä¸­çš„å¯é€‰é™„ä»¶attachmentå­—æ®µï¼Œä¸šåŠ¡å¯ä»¥æ–¹ä¾¿åœ°è¿›è¡Œè‡ªå®šä¹‰æ‰©å±•</li>\n<li>Nettyåè®®æ¶æ„éœ€è¦å…·å¤‡ä¸€å®šçš„æ‰©å±•èƒ½åŠ›ï¼Œå¦‚ç»Ÿä¸€çš„æ¶ˆæ¯æ‹¦æˆªï¼Œæ¥å£æ—¥å¿—ï¼Œå®‰å…¨ï¼ŒåŠ è§£å¯†ç­‰å¯ä»¥è¢«æ–¹ä¾¿åœ°æ·»åŠ å’Œåˆ é™¤ï¼Œä¸éœ€è¦ä¿®æ”¹ä¹‹å‰çš„é€»è¾‘ä»£ç ï¼Œç±»ä¼¼Servetçš„FilterChainå’ŒAOPï¼Œä½†è€ƒè™‘åˆ°æ€§èƒ½å› ç´ ï¼Œä¸æ¨èé€šè¿‡AOPå®ç°åŠŸèƒ½çš„æ‰©å±•</li>\n</ul>\n</li>\n<li>Nettyåè®®æ ˆå¼€å‘</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public final class NettyMessage{\n    private Header header;\n    private Object body;\n    public final Header getHeader(){\n        return header;\n    }\n    public final void setHeader(Header header){\n        this.header = header;\n    }\n    public final Object getBody(){\n        return body;\n    }\n    public final void setBody(Object body){\n        this.body = body;\n    }\n    public String toString(){\n        return \"NettyMessage [ header=\" + header + \"]\";\n    }\n}\npublic final class Header{\n    private int crcCode = 0xabef0101;\n    private int length;//æ¶ˆæ¯é•¿åº¦\n    private long sessionID;//ä¼šè¯ID\n    private byte type;//æ¶ˆæ¯ç±»å‹\n    private byte priority;//æ¶ˆæ¯æœ‰è¡”æ¥\n    private Map&lt;String,Object&gt; attachment = new HashMap&lt;String,Object&gt;();//é™„ä»¶\n    //set/get/toString();\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public final class NettyMessageEncoder extends MessageToMessageEncoder&lt;NettyMessage&gt;{\n    MarshallingEncoder marshallingEncoder;\n    public NettyMessageEncoder() throws IOException{\n        this.marshallingEncoder = new MarshallingEncoder();\n    }\n    protected void encde(ChannelHandlerContext ctx,NettyMessage msg.List&lt;Object&gt; out) throws Exception{\n        if(msg == null || msg.getHeader() == null){\n            throw new Exception(\"The encode message is null\");\n        }\n        ByteBuf sendBuf = Unpooled.buffer();\n        sendBuf.writeInt((msg.getHeader().getCrcCode()));\n        sendBuf.wirteInt((msg.getHeader().getLength()));\n        sendBuf.wirteInt((msg.getHeader().getSessionID()));\n        sendBuf.wirteInt((msg.getHeader().getType()));\n        sendBuf.wirteInt((msg.getHeader().getPriority()));\n        sendBuf.wirteInt((msg.getHeader().getAttachment().size()));\n        String key = null;\n        byte[] keyArray = null;\n        Object value = null;\n        for(Map.Entry&lt;String,Object&gt; param:msg.getHeader().getAttachment().entrySet()){\n            key = parm.getKey();\n            keyArray = key.getBytes(\"UTF-8\");\n            sendBuf.writeInt(keyArray.length);\n            sendBuf.wirteBytes(keyArray);\n            value = param.getValue();\n            marshallingEncoder.encode(value,senBuf);\n        } \n        key = null;\n        keyArray = null;\n        value = null;\n        if(msg.getBody()!=null){\n            marshallingEncoder.encode(msg.getBody(),sendBuf);\n        }else{\n            sendBuf.writeInt(0);\n            sendBuf.setInt(4,sendBuf.readableBytes());\n        }\n    }\n}\npublic class Marshalling Encoder{\n    private static final byte[] LENGTH_PLACHOLDER = new byte[4];\n    public MarshallingEncoder() throws IOException{\n        marshaller = MarshallingCodeFactory.buildmarshalling();\n    }\n    protected void encode(Object msg.ByteBuf out) throws Exception{\n        try{\n            int lengthPos = out.writerIndex();\n            out.writeBytes(LENGTH_PLACEHOLDER);\n            ChannelBufferByteOutput output = new ChannleBufferByteOutput(out);\n            marshaller.start(output);\n            marshaller.writeObject(msg);\n            marshaller.finish();\n            out.setInt(lengthPos,out.writerIndex() - lengthPos - 4);\n        }finally{\n            marshaller.close();\n        }\n    }\n}\npublic class NettyMessageDecoder extends LengthFieldBasedFrameDecoder{\n    MarshallingDecoder marshallingDecoder;\n    public NettyMessageDecoder(int max FrameLength,int lengthFieldOffset,int lengthFiedlLength) throws IOException{\n        super(maxFrameLength,lengthFieldOffset,lengthFieldLength);\n        marshallingDecode = new MarshallingDecoder();\n    }\n    protected Object decode(ChannelHandlerContext ctx,ByteBuf in) throws Exception{\n        ByteBuf frame = (ByteBuf) super.decode(ctx,in);\n        if(frame == null){//è°ƒç”¨çˆ¶ç±»LengthFieldBasedFrameDecoderè§£ç ä¹‹åï¼Œè¿”å›çš„æ˜¯æ•´åŒ…æ¶ˆæ¯æˆ–è€…ä¸ºnullï¼Œç›´æ¥è¿”å›ç»§ç»­ç”±I/Oçº¿ç¨‹è¯»å–åé¢çš„ç æµ\n            return null;\n        }\n        NettyMessage message = new NettyMessage();\n        Header header = new Header();\n        header.setCrcCode(in.readInt());\n        header.setLength(in.readInt());\n        header.setSessionID(in.readLong());\n        header.setType(in.readByte());\n        header.setPriority(in.readByte());\n\n        int size = in.readInt();\n        if(size &gt; 0){\n            Map&lt;String,Object&gt; attch = new HashMap&lt;String,Object&gt;(size);\n            int keySize = 0;\n            byte[] keyArray = null;\n            String key = null;\n            for(int i=0;i&lt;size;i++){\n                keySize = in.readInt();\n                keyArray = new byte[keySize];\n                in.readBytes(keyArray);\n                key = new String(keyArray,\"UTF-8\");\n                attch.put(key,marshallingDecoder.decode(in));\n            } \n            keyArray = null;\n            key = null;\n            header.setAttachment(attch);\n        }\n        if(in.readableBytes()&gt;4){\n            message.setBody(marshallingDecoder.decode(in));\n        }\n        message.setHeader(header);\n        return message;\n    }\n}\npublic class MarshallingDecoder{\n    private final Unmarshaller unmarshaller;\n    public MarshallingDecoder() throws IOException{\n        unmarshaller = MarshallingCodecFactory.buildUnMarshalling();\n    }\n\n    protected Object decode(ByteBuf in) throws Exception{\n        int objectSize = in.readInt();\n        ByteBuf buf = in.slice(in.readerIndex(),objectSize);\n        ByteInput input = new ChannelBufferByteInput(buf);\n        try{\n            unmarshaller.start(input);\n            Object obj = unmarshaller.readObject();\n            umarshaller.finish();\n            in.readerIndex(in.readerIndex()+objectSize);\n            return obj;\n        }finally{\n            unmarshaller.close();\n        }\n    }\n}\npublic class LoginAuthReqHandler extends ChannelHandlerAdapter{\n    public void channelActive(ChannelHandlerContext ctx) throws Exception{\n        ctx.wirteAndFlush(buildLoginReq());\n    }\n    public void channelRead(ChannelHandlerContext ctx,Object msg)throws Exception{\n        NettyMessage message = (NettyMessage) msg;\n        if(message.getHeader()!=null &amp;&amp; message.getHeader().getType() == MessaagType.LOGIN_RESP.value()){\n            byte loginResult = (byte) message.getBody();\n            if(loginResult != (byte)0){\n                ctx.close();\n            }else{\n                System.out.println(\"Login is okï¼š\" + message);\n                ctx.fireChannelRead(msg);\n            }\n        }else{\n            ctx.fireChannelRead(msg);\n        }\n    }\n    private NettyMessage buildLoginReq(){\n        NettyMessage message = new NettyMessage();\n        Header header = new Header();\n        header.setType(MessageType.LOGIN_REQ.value());\n        message.setHeader(header);\n        return message;\n    }\n\n    public void exceptionCaught(ChannelHandlerContext ctx,Throwable cause){\n        ctx.fireExceptionCaught(cause);\n    }\n}\npublic class LoginAuthRespHandler extends channelHandlerAdapter{\n    private Map&lt;String,Boolean nodeCheck&gt; = new ConcurrentHashMap&lt;String,Boolean&gt;();\n    private String[] whiteList = {\"127.0.0.1\",\"192.168.1.104\"};\n    public void channelRead(ChannelHandlerContext ctx,Object msg) throws Exception{\n            NettyMessage  message = (NettyMessage) msg;\n            if(message.getHeader!=null &amp;&amp; message.getHeader().getType()==MessageType.LOGIN_REQ.value()){\n                String nodeIndex = ctx.channel().remoteAddress().toString();\n                NettyMessagType  loginResp = null;\n                //é‡å¤ç™»å½•ï¼Œæ‹’ç»\n                if(nodeCheck.containsKey(nodeIndex)){\n                    loginResp = buildResponse((byte)-1);\n                }else{\n                    InetSocketAddress address = (InetSocketAddress) ctx.channel().remoteAddress();\n                    String ip = address.getAddress().getHostAddress();\n                    boolean isOK = false;\n                    for(String WIP:whiteList){\n                        if(WIP.equals(ip)){\n                            isOK = true;\n                            break;\n                        }\n                    }\n                }\n                loginResp = isOK? bulidResponse((byte)0):buildResponse((byte)-1);\n                if(isOK){\n                    nodeCheck.put(nodeIndex,true);\n                }\n                System.out.println(\"The login response is:\" + loginResp + \"body [\" + loginResp.getBody+\"]\");\n                ctx.writeAdnFlush(loginResp);\n            }else{\n                ctx.fireChannelread(msg);\n            }\n    }\n    private NettyMessag buildResponse(byte result){\n        NettyMessage  message = new NettyMessage();\n        Header header = new Header();\n        header.setType(MessageType.LOGIN_RESP.value());\n        message.setHeader(header);\n        message.setBody(result);\n        return message;\n    }\n    publuc void exceptionCaught(ChannelHandlerContext ctx,Throwable cause) throws Exception{\n        nodeCheck.remove(ctx.channel().remoteAddress().toString());\n        ctx.close();\n        ctx.fireExceptionCaught(cause);\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>public class HeartBeatReqHandler extends ChannelHandlerAdapter{\n    private volatile SchduledFuture&lt;?&gt; heartBeat;\n\n    public void channelRead(ChannelHandlerContext ctx,Object msg)throws Exception{\n        NettyMessage message = (NettyMessage) msg;\n        if(message.getHeader()!=null &amp;&amp; message.getHeader().getType == MessageType.LOGIN_RESP.value()){\n            hearBeat = ctx.executor().scheduleAtFixedRate(new HeartBeatReqHandler.HearBeatTask(ctx,0,5000,TimeUnit.MILLISECONDS));\n\n        }else if(message.getHeader()!=null &amp;&amp; message.getHeader().getType == MessageType.HEARTBEAT_RESP.value()){\n            Sytem.out.println(\"Client receive server heart beat message:--&gt;\" + message);\n           \n        }else{\n             ctx.fireChannelRead(msg);\n        }\n        \n    }\n    private class HearBeatTask implements Runnable{\n        private final ChannelHandlerContext ctx;\n        public HearBeatTask(final ChannelHanderContext ctx){\n            this.ctx = ctx;\n        }\n        @Override\n        public void run(){\n            NettyMessag heatBeat = buildHeatBeat();\n            System.out.println(\"client send heart beat message to server :</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Dubbo",
      "url": "https://javaguide.cn/backend/serviceinvocation/dubbo.html",
      "id": "https://javaguide.cn/backend/serviceinvocation/dubbo.html",
      "summary": "1. å¦‚ä½•å®ç°è¿œç¨‹è°ƒç”¨? 1ã€Webserviceï¼šæ•ˆç‡ä¸é«˜åŸºäºsoapåè®®ã€‚é¡¹ç›®ä¸­ä¸æ¨èä½¿ç”¨ã€‚ 2ã€ä½¿ç”¨restfulå½¢å¼çš„æœåŠ¡ï¼šhttp+jsonã€‚å¾ˆå¤šé¡¹ç›®ä¸­åº”ç”¨ã€‚å¦‚æœæœåŠ¡å¤ªå¤šï¼ŒæœåŠ¡ä¹‹é—´è°ƒç”¨å…³ç³»æ··ä¹±ï¼Œéœ€è¦æ²»ç–—æœåŠ¡ã€‚ï¼ˆä¸åŒè¯­è¨€ä¸åŒå…¬å¸ä½¿ç”¨ï¼‰ 3ã€ä½¿ç”¨dubboã€‚ä½¿ç”¨rpcåè®®è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨socketé€šä¿¡ã€‚ä¼ è¾“æ•ˆç‡é«˜ï¼Œå¹¶ä¸”å¯ä»¥ç»Ÿè®¡å‡ºç³»ç»Ÿä¹‹é—´çš„...",
      "content_html": "\n<ul>\n<li>1ã€Webserviceï¼šæ•ˆç‡ä¸é«˜åŸºäºsoapåè®®ã€‚é¡¹ç›®ä¸­ä¸æ¨èä½¿ç”¨ã€‚</li>\n<li>2ã€ä½¿ç”¨restfulå½¢å¼çš„æœåŠ¡ï¼šhttp+jsonã€‚å¾ˆå¤šé¡¹ç›®ä¸­åº”ç”¨ã€‚å¦‚æœæœåŠ¡å¤ªå¤šï¼ŒæœåŠ¡ä¹‹é—´è°ƒç”¨å…³ç³»æ··ä¹±ï¼Œéœ€è¦æ²»ç–—æœåŠ¡ã€‚ï¼ˆä¸åŒè¯­è¨€ä¸åŒå…¬å¸ä½¿ç”¨ï¼‰</li>\n<li>3ã€ä½¿ç”¨dubboã€‚ä½¿ç”¨rpcåè®®è¿›è¡Œè¿œç¨‹è°ƒç”¨ï¼Œç›´æ¥ä½¿ç”¨socketé€šä¿¡ã€‚ä¼ è¾“æ•ˆç‡é«˜ï¼Œå¹¶ä¸”å¯ä»¥ç»Ÿè®¡å‡ºç³»ç»Ÿä¹‹é—´çš„è°ƒç”¨å…³ç³»ã€è°ƒç”¨æ¬¡æ•°ã€‚ï¼ˆåŒè¯­è¨€ä½¿ç”¨ï¼‰</li>\n</ul>\n<h1>2. Dubboä½¿ç”¨</h1>\n<ul>\n<li>\n<p>Dubboé‡‡ç”¨å…¨Springé…ç½®æ–¹å¼ï¼Œé€æ˜åŒ–æ¥å…¥åº”ç”¨ï¼Œå¯¹åº”ç”¨æ²¡æœ‰ä»»ä½•APIä¾µå…¥ï¼Œåªéœ€ç”¨SpringåŠ è½½Dubboçš„é…ç½®å³å¯ï¼ŒDubboåŸºäºSpringçš„Schemaæ‰©å±•è¿›è¡ŒåŠ è½½ã€‚</p>\n</li>\n<li>\n<p>è¿œç¨‹æœåŠ¡ä¸­springçš„é…ç½®ï¼Œåœ¨æœ¬åœ°æœåŠ¡çš„åŸºç¡€ä¸Šï¼Œåªéœ€åšç®€å•é…ç½®ï¼Œå³å¯å®Œæˆè¿œç¨‹åŒ–ï¼š</p>\n</li>\n<li>\n<p>å°†ä¸Šé¢çš„local.xmlé…ç½®æ‹†åˆ†æˆä¸¤ä»½ï¼Œå°†æœåŠ¡å®šä¹‰éƒ¨åˆ†æ”¾åœ¨æœåŠ¡æä¾›æ–¹remote-provider.xmlï¼Œå°†æœåŠ¡å¼•ç”¨éƒ¨åˆ†æ”¾åœ¨æœåŠ¡æ¶ˆè´¹æ–¹remote-consumer.xmlã€‚å¹¶åœ¨æä¾›æ–¹å¢åŠ æš´éœ²æœåŠ¡é…ç½®<a href=\"dubbo:service\">dubbo:service</a>ï¼Œåœ¨æ¶ˆè´¹æ–¹å¢åŠ å¼•ç”¨æœåŠ¡é…ç½®<a href=\"dubbo:reference\">dubbo:reference</a></p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\txmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" \n\thttp://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd\n\tä»¥ä¸Šä¸¤å¥é…ç½®åœ¨xmlä¸­\n\t&lt;!-- ä½¿ç”¨dubboå‘å¸ƒæœåŠ¡ --&gt;\n\t&lt;!-- æä¾›æ–¹åº”ç”¨ä¿¡æ¯ï¼Œç”¨äºè®¡ç®—ä¾èµ–å…³ç³» --&gt;\n\t&lt;dubbo:application name=\"e3-manager\" /&gt;\n\t&lt;!-- é…ç½®æ³¨å†Œä¸­å¿ƒé›†ç¾¤ --&gt;\n\t&lt;dubbo:registry protocol=\"zookeeper\"address=\"192.168.25.154:2181,192.168.25.154:2182,192.168.25.154:2183\" /&gt;\n\t&lt;!-- ç”¨dubboåè®®åœ¨20880ç«¯å£æš´éœ²æœåŠ¡ --&gt;\n\t&lt;dubbo:protocol name=\"dubbo\" port=\"20880\" /&gt;\n\t\n\t&lt;bean id=\"xxx\" class=\"itemServiceImplå®ç°ç±»\"&gt;\n\t&lt;!-- å£°æ˜éœ€è¦æš´éœ²çš„æœåŠ¡æ¥å£ --&gt;\n\t&lt;dubbo:service interface=\"cn.e3mall.service.ItemServiceæ¥å£\" ref=\"xxx\" /&gt;\n\n\n\txmlns:dubbo=\"http://code.alibabatech.com/schema/dubbo\" \n\thttp://code.alibabatech.com/schema/dubbo http://code.alibabatech.com/schema/dubbo/dubbo.xsd\n\tä»¥ä¸Šä¸¤å¥é…ç½®åœ¨xmlä¸­\n\t&lt;!-- å¼•ç”¨dubboæœåŠ¡ --&gt;\n\t&lt;dubbo:application name=\"e3-manager-web\"/&gt;\n\t&lt;!-- é…ç½®æ³¨å†Œä¸­å¿ƒé›†ç¾¤ --&gt;\n\t&lt;dubbo:registry protocol=\"zookeeper\" address=\"192.168.25.154:2181,192.168.25.154:2182,192.168.25.154:2183\"/&gt;\n\t\n\t&lt;dubbo:reference interface=\"cn.e3mall.service.ItemServiceæ¥å£\" id=\"itemServiceèµ·ä¸€ä¸ªåå­—ï¼Œç›¸å½“äºbeançš„name\" /&gt;\n\n\tåœ¨controllerå±‚\n\t@Autowired\n\tprivate ItemService itemserviceä½¿ç”¨å³å¯\n</code></pre></div><h1>3. æ³¨å†Œä¸­å¿ƒZookeeper</h1>\n<ul>\n<li>å®˜æ–¹æ¨èä½¿ç”¨zookeeperæ³¨å†Œä¸­å¿ƒã€‚æ³¨å†Œä¸­å¿ƒè´Ÿè´£æœåŠ¡åœ°å€çš„æ³¨å†Œä¸æŸ¥æ‰¾ï¼Œç›¸å½“äºç›®å½•æœåŠ¡ï¼ŒæœåŠ¡æä¾›è€…å’Œæ¶ˆè´¹è€…åªåœ¨å¯åŠ¨æ—¶ä¸æ³¨å†Œä¸­å¿ƒäº¤äº’ï¼Œæ³¨å†Œä¸­å¿ƒä¸è½¬å‘è¯·æ±‚ï¼Œå‹åŠ›è¾ƒå°ã€‚</li>\n<li>ä½¿ç”¨dubbo-2.3.3ä»¥ä¸Šç‰ˆæœ¬ï¼Œå»ºè®®ä½¿ç”¨zookeeperæ³¨å†Œä¸­å¿ƒã€‚</li>\n<li>Zookeeperæ˜¯Apacahe Hadoopçš„å­é¡¹ç›®ï¼Œæ˜¯ä¸€ä¸ªæ ‘å‹çš„ç›®å½•æœåŠ¡ï¼Œæ”¯æŒå˜æ›´æ¨é€ï¼Œ</li>\n<li>é€‚åˆä½œä¸ºDubboæœåŠ¡çš„æ³¨å†Œä¸­å¿ƒï¼Œå·¥ä¸šå¼ºåº¦è¾ƒé«˜ï¼Œå¯ç”¨äºç”Ÿäº§ç¯å¢ƒï¼Œå¹¶æ¨èä½¿ç”¨</li>\n<li>Zookeeperä¼˜ç‚¹ï¼š\n<ul>\n<li>1ã€å¯ä»¥ä½œä¸ºé›†ç¾¤çš„ç®¡ç†å·¥å…·ä½¿ç”¨ã€‚</li>\n<li>2ã€å¯ä»¥é›†ä¸­ç®¡ç†é…ç½®æ–‡ä»¶ã€‚</li>\n</ul>\n</li>\n</ul>\n<h1>4. Dubboçš„å®‰è£…</h1>\n<ul>\n<li>\n<p>ç¬¬ä¸€æ­¥ï¼šå®‰è£…jdk</p>\n</li>\n<li>\n<p>ç¬¬äºŒæ­¥ï¼šæŠŠzookeeperçš„å‹ç¼©åŒ…ä¸Šä¼ åˆ°linuxç³»ç»Ÿï¼ˆç›®å½•éšæ„ï¼‰</p>\n</li>\n<li>\n<p>ç¬¬ä¸‰æ­¥ï¼šè§£å‹ç¼©å‹ç¼©åŒ…tar -zxvf zookeeper-3.4.6.tar.gz</p>\n</li>\n<li>\n<p>ç¬¬å››æ­¥ï¼šè¿›å…¥zookeeper-3.4.6ç›®å½•ï¼Œåˆ›å»ºdataæ–‡ä»¶å¤¹ã€‚</p>\n</li>\n<li>\n<p>ç¬¬äº”æ­¥ï¼šæŠŠzookeeper-3.4.6ç›®å½•ä¸‹çš„confç›®å½•å°†zoo_sample.cfgæ”¹åä¸ºzoo.cfg ï¼šmv zoo_sample.cfg zoo.cfg</p>\n</li>\n<li>\n<p>ç¬¬å…­æ­¥ï¼šä¿®æ”¹zoo.cfgçš„dataå±æ€§è®¾ç½®ä¸ºdataæ‰€åœ¨çš„ç›®å½•ï¼švim zoo.cfgç„¶åè¾“å…¥iç¼–è¾‘ dataDir=/usr/zookeeper-3.4.6/data ç„¶åEscï¼Œç„¶å:wqä¿å­˜å¹¶é€€å‡º</p>\n</li>\n<li>\n<p>ç¬¬ä¸ƒæ­¥ï¼šè¿›å…¥binç›®å½•å¯åŠ¨zookeeper</p>\n<ul>\n<li>./zkServer.sh start å…³é—­ï¼š./zkServer.sh stop æŸ¥çœ‹çŠ¶æ€ï¼š./zkServer.sh status</li>\n<li>æ³¨æ„ï¼šéœ€è¦å…³é—­é˜²ç«å¢™ã€‚service iptables stop æ°¸ä¹…å…³é—­ä¿®æ”¹é…ç½®å¼€æœºä¸å¯åŠ¨é˜²ç«å¢™ï¼šchkconfig iptables off</li>\n<li>å¦‚æœä¸èƒ½æˆåŠŸå¯åŠ¨zookeeperï¼Œéœ€è¦åˆ é™¤dataç›®å½•ä¸‹çš„zookeeper_server.pidæ–‡ä»¶ã€‚</li>\n</ul>\n</li>\n<li>\n<p>ç¬¬å…«æ­¥ï¼šDubboç›‘æ§ä¸­å¿ƒçš„å®‰è£…</p>\n<ul>\n<li>cp dubbo-admin-2.5.4.war apache-tomcat-7.0.47/webapps/dubbo-admin.war</li>\n<li>è¿›å…¥tomcatçš„binç›®å½•ä¸‹å¯åŠ¨tomcat</li>\n</ul>\n</li>\n<li>\n<p>ç¬¬ä¹æ­¥ï¼šè®¿é—®<a href=\"http://192.168.25.167:8080/dubbo-admin/\" target=\"_blank\" rel=\"noopener noreferrer\">http://192.168.25.167:8080/dubbo-admin/</a> ç”¨æˆ·åï¼šrootå¯†ç ï¼šroot</p>\n</li>\n<li>\n<p>å¦‚æœç›‘æ§ä¸­å¿ƒå’Œæ³¨å†Œä¸­å¿ƒåœ¨åŒä¸€å°æœåŠ¡å™¨ä¸Šï¼Œå¯ä»¥ä¸éœ€è¦ä»»ä½•é…ç½®ã€‚</p>\n</li>\n<li>\n<p>å¦‚æœä¸åœ¨åŒä¸€å°æœåŠ¡å™¨ï¼Œéœ€è¦ä¿®æ”¹é…ç½®æ–‡ä»¶dubbo.propertiesï¼š</p>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>/root/apache-tomcat-7.0.47/webapps/dubbo-admin/WEB-INF/dubbo.properties\ndubbo.registry.address=zookeeper://127.0.0.1:2181æ³¨å†Œä¸­å¿ƒåœ°å€\ndubbo.admin.root.password=root rootç”¨æˆ·çš„å¯†ç \ndubbo.admin.guest.password=guest\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "æ¶æ„è®¾è®¡",
      "url": "https://javaguide.cn/backend/systemdesign/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html",
      "id": "https://javaguide.cn/backend/systemdesign/%E6%9E%B6%E6%9E%84%E8%AE%BE%E8%AE%A1.html",
      "summary": "æ¶æ„è®¾è®¡ è½¯ä»¶çš„å¼€å‘æµç¨‹ï¼ˆç€‘å¸ƒæ¨¡å‹ï¼‰ éœ€æ±‚è°ƒç ”åˆ†æ----éœ€æ±‚è§„æ ¼è¯´æ˜ä¹¦ è®¾è®¡é˜¶æ®µï¼ˆæ¦‚è¦è®¾è®¡ã€è¯¦ç»†è®¾è®¡ï¼‰----é¡µé¢åŸå‹ã€æ•°æ®åº“è®¾è®¡ã€è®¾è®¡æ–‡æ¡£ ç¼–ç é˜¶æ®µ æµ‹è¯•é˜¶æ®µ ä¸Šçº¿å’Œè¿ç»´ æ¶æ„æ€»è§ˆ 5.png5.png ä¼ ç»Ÿæ¶æ„(å•ä¸€åº”ç”¨æ¶æ„) å½“ç½‘ç«™æµé‡å¾ˆå°æ—¶ï¼Œåªéœ€ä¸€ä¸ªåº”ç”¨ï¼Œå°†æ‰€æœ‰åŠŸèƒ½éƒ½éƒ¨ç½²åœ¨ä¸€èµ·ï¼Œä»¥å‡å°‘éƒ¨ç½²èŠ‚ç‚¹å’Œæˆæœ¬ã€‚æ­¤æ—¶ï¼Œç”¨äºç®€åŒ–å¢åˆ æ”¹æŸ¥å·¥ä½œé‡çš„ æ•°æ®è®¿é—®æ¡†...",
      "content_html": "<p>æ¶æ„è®¾è®¡</p>\n<!--more-->\n<h1>è½¯ä»¶çš„å¼€å‘æµç¨‹ï¼ˆç€‘å¸ƒæ¨¡å‹ï¼‰</h1>\n<ul>\n<li>éœ€æ±‚è°ƒç ”åˆ†æ</li>\n</ul>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/e392fe8bea5afd6941e5d.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æ¶æ„è®¾è®¡"
      ]
    },
    {
      "title": "ç§’æ€é¡¹ç›®",
      "url": "https://javaguide.cn/backend/systemdesign/%E7%A7%92%E6%9D%80%E9%A1%B9%E7%9B%AE.html",
      "id": "https://javaguide.cn/backend/systemdesign/%E7%A7%92%E6%9D%80%E9%A1%B9%E7%9B%AE.html",
      "summary": "ç”µå•†ç§’æ€ç³»ç»Ÿ-æ ¸å¿ƒé«˜æ€§èƒ½è§£å†³æ–¹æ¡ˆ åˆ†å±‚è®¾è®¡ æ¥å…¥å±‚æ¨¡å‹ View Object ä¸å‰ç«¯å¯¹æ¥çš„æ¨¡å‹ï¼Œéšè—å†…éƒ¨å®ç°ï¼Œä»…å±•ç¤ºçš„èšåˆæ¨¡å‹ ä¸šåŠ¡å±‚æ¨¡å‹ Domain Object é¢†åŸŸæ¨¡å‹ï¼Œä¸šåŠ¡æ ¸å¿ƒæ¨¡å‹ï¼Œæ‹¥æœ‰ç”Ÿå‘½å‘¨æœŸè´«è¡€ä»¥åŠæœåŠ¡è¾“å‡ºèƒ½åŠ› ï¼ˆè´«è¡€æ¨¡å‹ï¼Œåªæœ‰æ•°æ®åº“å¯¹åº”å­—æ®µï¼Œä¸æä¾›å…¶ä»–åŠŸèƒ½ï¼Œå…¶ä»–åŠŸèƒ½ç”±seviceæä¾›ï¼Œæ¯”å¦‚ç”¨æˆ·æ¨¡å‹åªæœ‰username password...",
      "content_html": "\n<h2>åˆ†å±‚è®¾è®¡</h2>\n<ul>\n<li>æ¥å…¥å±‚æ¨¡å‹ View Object ä¸å‰ç«¯å¯¹æ¥çš„æ¨¡å‹ï¼Œéšè—å†…éƒ¨å®ç°ï¼Œä»…å±•ç¤ºçš„èšåˆæ¨¡å‹</li>\n<li>ä¸šåŠ¡å±‚æ¨¡å‹ Domain Object é¢†åŸŸæ¨¡å‹ï¼Œä¸šåŠ¡æ ¸å¿ƒæ¨¡å‹ï¼Œæ‹¥æœ‰ç”Ÿå‘½å‘¨æœŸè´«è¡€ä»¥åŠæœåŠ¡è¾“å‡ºèƒ½åŠ› ï¼ˆè´«è¡€æ¨¡å‹ï¼Œåªæœ‰æ•°æ®åº“å¯¹åº”å­—æ®µï¼Œä¸æä¾›å…¶ä»–åŠŸèƒ½ï¼Œå…¶ä»–åŠŸèƒ½ç”±seviceæä¾›ï¼Œæ¯”å¦‚ç”¨æˆ·æ¨¡å‹åªæœ‰username password ä¸ä¼šæœ‰æ³¨å†Œç­‰åŠŸèƒ½ï¼Œå……è¡€æ¨¡å‹åˆ™è¡¨ç¤ºç”¨æˆ·æ¨¡å‹åŒ…æ‹¬username passwordä¹‹å¤–è¿˜èƒ½æä¾›æ³¨å†ŒåŠŸèƒ½ï¼‰å¯ä»¥å¤„ç†ç”¨æˆ·ç”Ÿå‘½å‘¨æœŸï¼Œä¾‹å¦‚ä»æ³¨å†Œç™»å½•åˆ°é€€å‡ºï¼ŒåŒ…å«å¤šä¸ªæ•°æ®æ¨¡å‹ï¼Œä¾‹å¦‚ç”¨æˆ·åŒ…æ‹¬ç”¨æˆ·åŸºç¡€ä¿¡æ¯æ•°æ®æ¨¡å‹å’Œç”¨æˆ·å¯†ç ä¿¡æ¯æ•°æ®æ¨¡å‹</li>\n<li>æ•°æ®å±‚ Data Objectæ•°æ®æ¨¡å‹ï¼ŒåŒæ•°æ®åº“æ˜ å°„ï¼Œç”¨ä»¥ORMæ–¹å¼æ“ä½œæ•°æ®åº“çš„èƒ½åŠ›æ¨¡å‹<br>\n-- ç”¨æˆ·å¯†ç ä¼šä¸ç”¨æˆ·ä¿¡æ¯åˆ†å¼€å­˜å‚¨ï¼Œç”¨æˆ·å¯†ç ä¼šæ”¾åœ¨åŠ å¯†æ•°æ®åº“ä¸­ï¼Œè€Œå¹³æ—¶åªç”¨åˆ°ç”¨æˆ·çš„åŸºç¡€ä¿¡æ¯</li>\n</ul>\n<h2>ç¯å¢ƒéƒ¨ç½²</h2>\n<h3>jdkå®‰è£…</h3>\n<ul>\n<li>ä¸‹è½½jdkçš„rpmæ–‡ä»¶</li>\n<li>æˆæƒæœ€é«˜æƒé™ chmod 777 rpmæ–‡ä»¶</li>\n<li>å®‰è£…rpmæ–‡ä»¶ rpm -ivh rpmæ–‡ä»¶ ï¼ˆé»˜è®¤å®‰è£…åˆ°/usr/javaï¼‰</li>\n<li>æ·»åŠ ç¯å¢ƒå˜é‡vim ~/.bash_profile\n<ul>\n<li>æ·»åŠ JAVA_HOME=/usr/java/jdk1.8.0_65 PATH=JAVA_HOME/bin</li>\n<li>ä¿å­˜å¹¶é€€å‡º:wq</li>\n<li>åˆ·æ–°é…ç½®æ–‡ä»¶source ~/.bash_profile</li>\n</ul>\n</li>\n</ul>\n<h3>mysqlå®‰è£…</h3>\n<ul>\n<li>å®‰è£…mysqlç›¸å…³ä¾èµ–yum install mysql*</li>\n<li>rpmæ–¹å¼ä¸éœ€è¦é•œåƒå°±èƒ½æ›´æ–°ï¼Œä½†éœ€è¦è§£å†³ä¾èµ–</li>\n<li>yumæ–¹å¼ä¸éœ€è¦è§£å†³ä¾èµ–</li>\n<li>yum install mariadb-server</li>\n<li>å¯åŠ¨mysql systemctl start mariadb.service</li>\n<li>åˆå§‹åŒ–rootè´¦æˆ·å¯†ç mysqladmin -u root password root</li>\n</ul>\n<h3>jarä¸Šä¼ </h3>\n<ul>\n<li>æ‰“åŒ…æˆspringbootåº”ç”¨</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>    &lt;plugins&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;org.apache.maven.plugins&lt;/groupId&gt;\n        &lt;artifactId&gt;maven-compiler-plugin&lt;/artifactId&gt;\n        &lt;configuration&gt;\n          &lt;source&gt;1.8&lt;/source&gt;\n          &lt;target&gt;1.8&lt;/target&gt;\n        &lt;/configuration&gt;\n      &lt;/plugin&gt;\n      &lt;plugin&gt;\n        &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n        &lt;artifactId&gt;spring-boot-maven-plugin&lt;/artifactId&gt;\n      &lt;/plugin&gt;\n    &lt;/plugins&gt;\n</code></pre></div><ul>\n<li>maven clean package</li>\n<li>ä¸Šä¼ å°†æ–‡ä»¶ä¼ é€åˆ°æœåŠ¡å™¨ scp *.sql root@ip://tmp/  -&gt; -r å¤åˆ¶æ–‡ä»¶å¤¹</li>\n<li>chmod 777 jaråŒ…</li>\n<li><a href=\"http://deploy.sh\" target=\"_blank\" rel=\"noopener noreferrer\">deploy.sh</a> æ–‡ä»¶ nohup java -Xms400m -Xmx400m -XX:NewSize=200m -XX:MaxNewSize=200m -jar miaosha.jar --spring.config.addition-location=/var/www/miaosha/application.properties</li>\n<li>chmod 777 <a href=\"http://deploy.sh\" target=\"_blank\" rel=\"noopener noreferrer\">deploy.sh</a></li>\n</ul>\n<h3>å®‰è£…nginx</h3>\n<ul>\n<li>ä¸‹è½½openresty-1.13.6.2.tar.gz</li>\n<li>chomd -R 777 openresty-1.13.6.2.tar.gz</li>\n<li>tar -xvzf openresty-1.13.6.2.tar.gz</li>\n<li>cd openresty-1.13.6.2</li>\n<li>yum install pcre-devel openssl-devel gcc curl</li>\n<li>ç¼–è¯‘ ./configure</li>\n<li>make ç¼–è¯‘</li>\n<li>make install å®‰è£…</li>\n<li>cd /usr/local/openresty\n<ul>\n<li>bin</li>\n<li>luajit</li>\n<li>nginx /sbin/nginx(è¿™ä¸ªæ–‡ä»¶æ›¿æ¢æ‰å°±èƒ½æ›¿æ¢äº†nginx)</li>\n</ul>\n</li>\n<li>å¯åŠ¨nginx nginx/sbin/nginx -c nginx/conf/nginx.conf</li>\n<li>ä¿®æ”¹é…ç½®åç›´æ¥sbin/nginx -s reload æ— ç¼é‡å¯ ä¸å½±å“å®¢æˆ·è¿æ¥</li>\n</ul>\n<h2>åˆ†å¸ƒå¼</h2>\n<h3>å•å°åº”ç”¨</h3>\n<ul>\n<li>pstree -p ç«¯å£å· | wc -l æŸ¥çœ‹javaçº¿ç¨‹æ•°</li>\n<li>top -HæŸ¥çœ‹æ€§èƒ½æ•°é‡\n<ul>\n<li>%Cpu  1ã€us ç”¨æˆ·æ€ä¸‹CPUçš„è€—æ—¶  2ã€sy å†…æ ¸ç©ºé—´å¯¹CPUçš„è€—æ—¶ï¼ˆsocket send readï¼‰ ä¸¤ä¸ªåŠ èµ·æ¥ä¸èƒ½è¶…100%</li>\n<li>load average æœ€è¿‘ 1 åˆ†é’Ÿ 5 åˆ†é’Ÿ 15åˆ†é’Ÿçš„ cpu loadæ•°é‡ï¼Œè¶Šä½è¶Šå¥½ æ§åˆ¶åœ¨CPUæ•°å†… é«˜è¡¨ç¤ºCPUå¾ˆå¿™ï¼ˆæ­»å¾ªç¯usé«˜ï¼Œä½†load averageå¾ˆä½ï¼‰</li>\n</ul>\n</li>\n<li>severç«¯çš„å¹¶å‘çº¿ç¨‹æ•°ä¸Šä¸å»ï¼ˆspring-configuration-metadata.jsonæ–‡ä»¶ï¼‰</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>server.tomcat.accept-count:ç­‰å¾…é˜Ÿåˆ—é•¿åº¦(è¶…è¿‡å°±æ‹’ç»)ï¼Œé»˜è®¤100-&gt;1000\nserver.tomcat.max-connections:æœ€å¤§å¯è¢«è¿æ¥æ•°ï¼Œé»˜è®¤10000\nserver.tomcat.max-threads:æœ€å¤§å·¥ä½œçº¿ç¨‹æ•°ï¼Œé»˜è®¤200-&gt;800 4æ ¸8G\nserver.tomcat.min-space-threads:æœ€å°å·¥ä½œçº¿ç¨‹æ•°ï¼Œé»˜è®¤10-&gt;100\n\né»˜è®¤é…ç½®ä¸‹ï¼Œè¿æ¥è¶…è¿‡10000åå‡ºç°æ‹’ç»é“¾æ¥æƒ…å†µ\né»˜è®¤é…ç½®ä¸‹ï¼Œè§¦å‘çš„è¯·æ±‚è¶…è¿‡200+100åæ‹’ç»å¤„ç†\n</code></pre></div><p>keep-aliveå‡å°‘è¿æ¥æ¶ˆè€—<br>\nkeepAliveTimeOut:å¤šå°‘æ¯«ç§’åä¸å“åº”çš„æ–­å¼€keepalive<br>\nmaxKeepAliveRequests:å¤šå°‘æ¬¡è¯·æ±‚åkeepaliveæ–­å¼€å¤±æ•ˆ</p>\n<ul>\n<li>å®šåˆ¶åŒ–å†…åµŒtomcaté…ç½®</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å½“springå®¹å™¨å†…æ²¡æœ‰TomcatEmbeddedServletContainerFactoryè¿™ä¸ªbeanæ—¶ï¼Œä¼šæŠŠæ­¤beanåŠ è½½è¿›springå®¹å™¨ä¸­\n@Component\npublic class WebServerConfiguration implements WebServerFactoryCustomizer&lt;ConfigurableWebServerFactory&gt; {\n    @Override\n    public void customize(ConfigurableWebServerFactory factory) {\n        ((TomcatServletWebServerFactory)factory).addConnectorCustomizers(new TomcatConnectorCustomizer() {\n            @Override\n            public void customize(Connector connector) {\n                Http11NioProtocol http11NioProtocol = (Http11NioProtocol) connector.getProtocolHandler();\n\n                //å®šåˆ¶åŒ–keepalivetimeout è®¾ç½®30ç§’å†…æ²¡æœ‰è¯·æ±‚åˆ™æœåŠ¡å™¨è‡ªåŠ¨æ–­å¼€keepaliveè¿æ¥\n                http11NioProtocol.setKeepAliveTimeout(30000);\n                //å½“å®¢æˆ·ç«¯å‘é€è¶…è¿‡10000ä¸ªè¯·æ±‚åˆ™è‡ªåŠ¨æ–­å¼€keepaliveè¿æ¥\n                http11NioProtocol.setMaxKeepAliveRequests(1000);\n            }\n        });\n    }\n}\n</code></pre></div><ul>\n<li>\n<p>å•æœºå®¹é‡é—®é¢˜ï¼ˆå“åº”æ—¶é—´å˜é•¿ TPSä¸Šä¸å»ï¼‰ï¼Œ</p>\n<ul>\n<li>çº¿ç¨‹æ•°é‡ï¼š4æ ¸CPU 8Gå†…å­˜å•è¿›ç¨‹è°ƒåº¦çº¿ç¨‹æ•°800-1000ä»¥ä¸Šåå³èŠ±è´¹å·¨å¤§æ—¶é—´åœ¨CPUè°ƒåº¦ä¸Š</li>\n<li>ç­‰å¾…é˜Ÿåˆ—é•¿åº¦ï¼šé˜Ÿåˆ—åšç¼“å†²æ± ç”¨ï¼Œä½†ä¹Ÿä¸èƒ½æ— é™é•¿ï¼Œæ¶ˆè€—å†…å­˜ï¼Œå‡ºé˜Ÿå…¥é˜Ÿä¹Ÿè€—CPUï¼ˆ1000-2000ï¼‰</li>\n<li>è¡¨è±¡:å•æœºCPUä½¿ç”¨ç‡å¢é«˜ï¼Œmemoryå ç”¨å¢åŠ ï¼Œç½‘ç»œå¸¦å®½ä½¿ç”¨å¢åŠ </li>\n<li>cpu us ï¼šç”¨æˆ·ç©ºé—´çš„cpuä½¿ç”¨æƒ…å†µï¼ˆç”¨æˆ·å±‚ä»£ç ï¼‰</li>\n<li>cpu syï¼šå†…æ ¸ç©ºé—´çš„cpuä½¿ç”¨æƒ…å†µï¼ˆç³»ç»Ÿè°ƒç”¨ï¼‰</li>\n<li>load averageï¼š1,5,15åˆ†é’Ÿloadå¹³å‡å€¼ï¼Œè·Ÿç€æ ¸æ•°ç³»æ•°ï¼Œ0ä»£è¡¨æ­£å¸¸1ä»£è¡¨æ‰“æ»¡1+è¡¨ç¤ºç­‰å¾…é˜»å¡</li>\n<li>memory feeç©ºé—²å†…å­˜ï¼Œusedä½¿ç”¨å†…å­˜</li>\n</ul>\n</li>\n<li>\n<p>MySql QPSå®¹é‡é—®é¢˜</p>\n<ul>\n<li>ä¸»é”®æŸ¥è¯¢:åƒä¸‡çº§åˆ«æ•°æ® = 1-10æ¯«ç§’</li>\n<li>å”¯ä¸€ç´¢å¼•æŸ¥è¯¢:åƒä¸‡çº§åˆ«æ•°æ® = 10-100æ¯«ç§’</li>\n<li>éå”¯ä¸€ç´¢å¼•æŸ¥è¯¢:åƒä¸‡çº§åˆ«æ•°æ® = 100-1000æ¯«ç§’ -&gt;åˆ†åº“åˆ†è¡¨ï¼Œæ‰©å®¹çƒ­ç‚¹æ•°æ®</li>\n<li>æ— ç´¢å¼•:ç™¾ä¸‡æ¡æ•°æ® 1000æ¯«ç§’+ -&gt;åˆ†åº“åˆ†è¡¨ï¼Œæ‰©å®¹çƒ­ç‚¹æ•°æ®</li>\n</ul>\n</li>\n<li>\n<p>Mysql TPSå®¹é‡é—®é¢˜</p>\n<ul>\n<li>éæ’å…¥æ›´æ–°åˆ é™¤æ“ä½œ:åŒæŸ¥è¯¢ -&gt;whereæ¡ä»¶</li>\n<li>æ’å…¥æ“ä½œ:1w-10w tpsï¼ˆä¾èµ–é…ç½®ä¼˜åŒ–ï¼‰</li>\n</ul>\n</li>\n</ul>\n<h3>nginxåå‘ä»£ç†(æ°´å¹³æ‰©å±•)</h3>\n<ul>\n<li>æ°´å¹³æ‰©å±•-&gt;ä½¿ç”¨nginxåå‘ä»£ç†ï¼ˆ1ä¸ªnginxï¼Œ2ä¸ªjarï¼Œ1ä¸ªmysqlå…±4ä¸ªè™šæ‹Ÿæœºï¼‰</li>\n<li>nginxä½œä¸ºwebæœåŠ¡å™¨ï¼ˆé™æ€ï¼‰</li>\n<li>nginxä½œä¸ºåŠ¨é™åˆ†ç¦»æœåŠ¡å™¨</li>\n<li>nginxä½œä¸ºåå‘ä»£ç†æœåŠ¡å™¨</li>\n<li>nginxç”Ÿäº§ç¯å¢ƒä½¿ç”¨nasï¼ˆæ— é™å®¹é‡ï¼‰ä»£æ›¿æœ¬åœ°ç£ç›˜</li>\n<li>OpenRestyæ¡†æ¶-&gt;nginxå¼€å‘å’Œè°ƒä¼˜OpenRestyæ˜¯ä¸€æ¬¾åŸºäº NGINX å’Œ LuaJIT çš„ Web å¹³å°ã€‚redis lua nginxé…ç½®éƒ½æœ‰</li>\n</ul>\n<ol>\n<li>nginxé™æ€èµ„æºè®¿é—®é…ç½®ï¼ˆè®¿é—®/resources/éƒ½æ˜¯è®¿é—®é™æ€èµ„æºï¼‰</li>\n</ol>\n<ul>\n<li>locationèŠ‚ç‚¹path:æŒ‡å®šurlæ˜ å°„key</li>\n<li>locationèŠ‚ç‚¹å†…å®¹:rootæŒ‡å®šlocation pathåå¯¹åº”çš„æ ¹è·¯å¾„ï¼ŒindexæŒ‡å®šé»˜è®¤çš„è®¿é—®é¡µ alias æŒ‡æ›¿æ¢è°ƒè·¯å¾„</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>worker_processes 1å·¥ä½œè¿›ç¨‹\nevents{\n\tworker_connections 1024;å¯ä»¥æ¥å—çš„å·¥ä½œè¿æ¥\n}\nmine.types-&gt;content-typeè®¾ç½®\n\nlocation /resources/ { -&gt;/resource/xxxx æ›¿æ¢ä¸º /usr/local/openresty/nginx/html/resources/\n\talias /usr/local/openresty/nginx/html/resources/;\n\tindex index.html index.html;\n}\n</code></pre></div><p>2.åå‘ä»£ç†é…ç½®ï¼ˆé»˜è®¤ä¸åç«¯æ²¡æœ‰é•¿è¿æ¥keep aliveï¼‰æ•°æ®åº“è¿æ¥æ± å’Œh5ä¸nginxæœ‰keepaliveï¼Œé•¿è¿æ¥<br>\n2.1è®¾ç½®upstream server</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>server{\n\tupstream back_server {\n\t\tserver ip:port weight=1;\n\t\tserver ip:port weight=1;\n\t\tkeepalive 30;//è®¾ç½®nginxä¸åç«¯é•¿è¿æ¥30sï¼Œ30å†…æ²¡æ“ä½œæ–­å¼€ ä¸ http1.1é…åˆä½¿ç”¨\n\t}\n}\n</code></pre></div><p>2.2è®¾ç½®åŠ¨æ€è¯·æ±‚locationä¸ºproxy pass è·¯å¾„</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tlocation  /{\n\t\tproxy_pass http://back_server;\n\t\tproxy_set_header Host $http_host:$proxy_port;\n\t\tproxy_set_header X-Real-IP $remote_addr;\n\t\tproxy_set_header : X-Forwared-For $proxy_add_x_forwarded_for;//ä»£è¡¨nginxè½¬å‘è¯·æ±‚\n\t\tproxy_http_version 1.1;//ä½¿ç”¨keepalive\n\t\tproxy_set_header Connection \"\";//ä½¿ç”¨keepalive\n\t\t\n\t}\n</code></pre></div><p>2.3å¼€å¯tomcat access logéªŒè¯<br>\nåœ¨application.propertiesé…ç½®<br>\nserver.tomcat.accesslog.enabled=true<br>\nserver.tomcat.accesslog.directory=/var/www/miaosha/tomcat //å…ˆåˆ›å»º<br>\nserver.tomcat.accesslog.pattern=%h %l %u %t \"%r\" %s %b %D<br>\n%h-&gt;è¿œç«¯ip<br>\n%l-&gt; -<br>\n%u-&gt;è¿œç«¯ç”¨æˆ·<br>\n%t-&gt;è€—æ—¶<br>\n%r-&gt;è¯·æ±‚ä¿¡æ¯æ–¹æ³•å’Œurl<br>\n%s-&gt;è¿”å›çŠ¶æ€ç <br>\n%b-&gt;byte sendå“åº”å¤§å°<br>\n%D-&gt;å¤„ç†è¯·æ±‚æ—¶é•¿<br>\nè®¾ç½®é•¿è¿æ¥ä¼˜åŒ– proxy_http_version 1.1;//ä½¿ç”¨keepalive proxy_ser_header Connection \"\";//ä½¿ç”¨keepalive<br>\nkeepalive 30;//è®¾ç½®nginxä¸åç«¯é•¿è¿æ¥30sï¼Œ30å†…æ²¡æ“ä½œæ–­å¼€ ä¸ http1.1é…åˆä½¿ç”¨</p>\n<ul>\n<li>\n<p>nginxé«˜æ€§èƒ½åŸå› </p>\n</li>\n<li>\n<p>epollå¤šè·¯å¤ç”¨æœºåˆ¶å®Œæˆéé˜»å¡IOæ“ä½œ</p>\n<ul>\n<li>bioæ¨¡å‹ã€‚é˜»å¡å¼è¿›ç¨‹æ¨¡å‹ï¼Œwriteè¿‡ç¨‹é˜»å¡ï¼Œç­‰åˆ°ç½‘ç»œå®Œæˆæ‰èƒ½ç»§ç»­æ‰§è¡Œã€</li>\n<li>linux selectæ¨¡å‹ å˜æ›´è§¦å‘è½®è¯¢æŸ¥æ‰¾ï¼Œ æœ‰1024æ•°é‡ä¸Šé™ é¦–å…ˆé˜»å¡è‡ªå·±ï¼Œç›‘å¬100ä¸ªå®¢æˆ·è¿æ¥æ˜¯å¦æœ‰å˜åŒ–ï¼Œè‹¥æœ‰å˜åŒ–åˆ™å”¤é†’è‡ªå·±ï¼Œå¾ªç¯éå†100è¿æ¥ï¼Œæ‰¾åˆ°å‘ç”Ÿå˜åŒ–çš„ä¸€ä¸ªæˆ–è€…å¤šä¸ªæ‰§è¡Œreadæ“ä½œã€‚éå†æ•ˆç‡ä½ï¼Œè¿æ¥æ•°é‡æœ‰ä¸Šé™</li>\n<li>epollæ¨¡å‹ï¼Œå˜æ›´è§¦å‘å›è°ƒç›´æ¥è¯»å–ï¼Œç†è®ºä¸Šæ— ä¸Šé™ï¼Œä¸ä¼šæ–­å¼€å®¢æˆ·è¿æ¥ï¼Œç›‘å¬100ä¸ªå®¢æˆ·ç«¯è¿æ¥æ˜¯å¦æœ‰å˜åŒ–ï¼Œè®¾ç½®å›è°ƒå‡½æ•°ï¼Œè‹¥æœ‰å˜åŒ–åˆ™å”¤é†’è‡ªå·±ï¼Œå¹¶æ‰§è¡Œå›è°ƒå‡½æ•°</li>\n</ul>\n</li>\n<li>\n<p>java nio-ã€‹è‡ªåŠ¨é€‰æ‹©selectæˆ–è€…epollæ¨¡å‹ã€‚linuxå†…æ ¸2.6ä»¥ä¸Šæ‰æœ‰epollæ¨¡å‹</p>\n</li>\n<li>\n<p>master worker è¿›ç¨‹æ¨¡å‹å¹³æ»‘åŠ è½½å’Œé‡å¯,ä¸ä¼šæ–­å¼€ä¸å®¢æˆ·ç«¯è¿æ¥<br>\nmaster workerçˆ¶å­è¿›ç¨‹-&gt;masterå¯ä»¥ç®¡ç†workerè¿›ç¨‹å†…å­˜ç©ºé—´ï¼ˆä¸¤è€…å…±äº«å†…å­˜ï¼Œæ ¹æ®worker_processesé…ç½®workerè¿›ç¨‹æ•°ï¼‰ï¼Œworkerè¿›ç¨‹å¯ä»¥ç«äº‰å¤„ç†å®¢æˆ·ç«¯è¿æ¥acceptè¯·æ±‚ï¼Œç”¨å†…å­˜é”ä¿è¯å¤šä¸ªworkerè¿›ç¨‹èƒ½æœ‰åºè´Ÿè´£æŸä¸ªè¿æ¥ï¼Œä¸€æ—¦acceptä¹‹åï¼Œå°±ç”±å½“æ—¶å¤„ç†çš„workerè¿›ç¨‹ä¸€ç›´å¤„ç†ä¸‹å»ã€‚reloadé…ç½®æ–‡ä»¶åªä¼šåˆ‡æ¢workerè¿›ç¨‹ï¼Œmasterè¿›ç¨‹ä¸ä¼šä¿®æ”¹ï¼Œå®¢æˆ·ç«¯ä¹Ÿä¸ä¼šæ–­å¼€socketè¿æ¥ï¼Œæ˜¯å› ä¸ºé‡å¯çš„æ—¶å€™å°†æ‰€æœ‰workerè¿›ç¨‹å¥æŸ„äº¤ç»™masterè¿›ç¨‹ï¼Œé‡å¯æ—¶ï¼Œmasterè¿›ç¨‹åˆäº¤å›ç»™æ–°çš„workerè¿›ç¨‹å»å¤„ç†ï¼Œæ¯ä¸ªworkerè¿›ç¨‹éƒ½æ˜¯å•çº¿ç¨‹çš„ï¼Œæ²¡æœ‰é˜»å¡çš„è¯ï¼Œå•çº¿ç¨‹æ¯”å¤šçº¿ç¨‹å¿«ï¼Œåªåšäº†å†…æ ¸ç©ºé—´è½¬å‘å¤–éƒ¨ç©ºé—´çš„æ‹·è´ã€‚å¹¶æ²¡æœ‰é˜»å¡ä»€ä¹ˆï¼Œæ‰€ä»¥é«˜æ€§èƒ½</p>\n</li>\n<li>\n<p>åç¨‹æœºåˆ¶ éé˜»å¡ç¼–ç¨‹ å•è¿›ç¨‹å•çº¿ç¨‹<br>\nä¾é™„äºçº¿ç¨‹çš„å†…å­˜æ¨¡å‹ï¼Œåˆ‡æ¢å¼€é”€å°ï¼ˆå†…å­˜åˆ‡æ¢ï¼‰è€Œçº¿ç¨‹æ˜¯CPUåˆ‡æ¢å¼€é”€<br>\né‡åˆ°é˜»å¡åŠå½’è¿˜æ‰§è¡Œæƒï¼Œä»£ç åŒæ­¥ï¼Œå¯ä»¥å¤„ç†å¤§é‡çš„å¼‚æ­¥å›è°ƒå‡½æ•°ï¼ˆå¤§é‡å¼‚æ­¥å‡½æ•°åµŒå¥—ï¼Œæœ¬èº«ä¸å¥½åšé¡ºåºæ§åˆ¶ï¼‰ï¼Œåç¨‹å¯ä»¥ä½œé¡ºåºæ§åˆ¶ï¼Œå†™ä»£ç å¯ä»¥ç›´æ¥return<br>\næ— éœ€åŠ é”ï¼Œä¸²è¡Œæ‰§è¡Œ</p>\n</li>\n</ul>\n<h3>åˆ†å¸ƒå¼ä¼šè¯ç®¡ç†</h3>\n<ul>\n<li>åŸºäºcookieä¼ è¾“sessionidï¼ˆjsessionidï¼‰ï¼štomcatå®ç°sessionï¼ˆè½¬ç§»åˆ°redisï¼‰(ç§»åŠ¨ç«¯ä¸è¡Œï¼Œç¦cookie)<br>\n@Autowired<br>\nprivate HttpServletRequest httpServletRequest;</li>\n</ul>\n<p>httpServletRequest.getSession.setAttribute(\"xx\",xx);</p>\n<ul>\n<li>åŸºäºtoken(ä»¤ç‰Œ)å®ç°sessionidï¼šjavaå®ç°sessionï¼ˆuuidï¼‰ï¼ˆè½¬ç§»åˆ°redisï¼‰<br>\nè¯·æ±‚å¸¦ä¸Šï¼Ÿtoken =<br>\nåç«¯ String token2 = this.httpServletRequest.getParameterMap().get(\"token\")[0];//æ‹¿åˆ°</li>\n</ul>\n<p>@Autowired<br>\nprivate RedisTemplate redisTemplate;</p>\n<p>String uuidToken = UUID.randomUUID().toString();<br>\nredisTemplate.opsForValue().set(uuidToken,userModel);<br>\nredisTemplate.expire(token,1, TimeUnit.HOURS);</p>\n<p>redisTemplate.opsForValue().get(uuidToken,userModel);</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>ä¸‹è½½redis\nchmod -R 777 redis-5.0.4.tag.gz\ntar -zxvf redis-5.0.4.tag.gz\ncd redis-5.0.4\n./configure\nmake\nmake install\ncd src\n./redis-server\n\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.boot&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-boot-starter-data-redis&lt;/artifactId&gt;\n    &lt;/dependency&gt;\n    &lt;dependency&gt;\n      &lt;groupId&gt;org.springframework.session&lt;/groupId&gt;\n      &lt;artifactId&gt;spring-session-data-redis&lt;/artifactId&gt;\n      &lt;version&gt;2.0.5.RELEASE&lt;/version&gt;\n    &lt;/dependency&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>spring.redis.host=127.0.0.1\nspring.redis.port=6379\nspring.redis.password=xxx\n#é»˜è®¤16ä¸ªæ•°æ®åº“\nspring.redis.database=0\n#è¿æ¥æ± \nspring.redis.jedis.pool.max-active=50\nspring.redis.jedis.pool.max-idle=20\n\n@Component\n@EnableRedisHttpSession(maxInactiveIntervalInSeconds = 3600)\npublic class RedisConfig {\n    //å°†javaåºåˆ—åŒ–è½¬æˆjsonåºåˆ—åŒ–\n    @Bean\n    public RedisTemplate restTemplate(RedisConnectionFactory redisConnectionFactory) {\n        RedisTemplate redisTemplate = new RedisTemplate();\n        redisTemplate.setConnectionFactory(redisConnectionFactory);\n\n        //è®¾ç½®keyåºåˆ—åŒ–æ–¹å¼-&gt;ä¸è®¾ç½®åˆ™è¡¨ç¤ºä¸€å®šè¦å®ç°åºåˆ—åŒ–æ¥å£\n        StringRedisSerializer stringRedisSerializer = new StringRedisSerializer();\n        redisTemplate.setKeySerializer(stringRedisSerializer);\n\n        //è§£å†³valueçš„åºåˆ—åŒ–æ–¹å¼-&gt;ä¸è®¾ç½®åˆ™è¡¨ç¤ºä¸€å®šè¦å®ç°åºåˆ—åŒ–æ¥å£\n        Jackson2JsonRedisSerializer jackson2JsonRedisSerializer = new Jackson2JsonRedisSerializer(Object.class);\n        ObjectMapper objectMapper = new ObjectMapper();\n        SimpleModule simpleModule = new SimpleModule();\n        simpleModule.addDeserializer(DateTime.class, new JodaDateTimeJsonDeserializer());\n        simpleModule.addSerializer(DateTime.class, new JodaDateTimeJsonSerializer());\n\n        //å„ä¸ªå±æ€§éƒ½èƒ½æœ‰å¯¹åº”çš„è§£æè¯´æ˜ï¼ŒåŠ äº†åˆ—çš„ç±»å‹è¯´æ˜\n        objectMapper.enableDefaultTyping(ObjectMapper.DefaultTyping.NON_FINAL);\n\n        objectMapper.registerModule(simpleModule);\n        jackson2JsonRedisSerializer.setObjectMapper(objectMapper);\n        redisTemplate.setValueSerializer(jackson2JsonRedisSerializer);\n\n        return redisTemplate;\n    }\n}\n\npublic class JodaDateTimeJsonDeserializer extends JsonDeserializer&lt;DateTime&gt; {\n    @Override\n    public DateTime deserialize(JsonParser jsonParser, DeserializationContext deserializationContext) throws IOException, JsonProcessingException {\n        String dateString = jsonParser.readValueAs(String.class);\n        DateTimeFormatter formatter = DateTimeFormat.forPattern(\"yyyy-MM-dd HH:ss\");\n\n        return DateTime.parse(dateString,formatter);\n    }\n}\npublic class JodaDateTimeJsonSerializer extends JsonSerializer&lt;DateTime&gt; {\n    @Override\n    public void serialize(DateTime dateTime, JsonGenerator jsonGenerator, SerializerProvider serializerProvider) throws IOException {\n        jsonGenerator.writeString(dateTime.toString(\"yyyy-MM-dd HH:mm:ss\"));\n\n    }\n}\n</code></pre></div><h2>æŸ¥è¯¢å¤šçº§ç¼“å­˜ï¼ˆä¸¢å¤±ï¼‰</h2>\n<ul>\n<li>ç¼“å­˜è®¾è®¡\n<ul>\n<li>ç”¨å†…å­˜åšç¼“å­˜</li>\n<li>å°†ç¼“å­˜æ¨åˆ°ç¦»ç”¨æˆ·æœ€è¿‘çš„åœ°æ–¹ï¼Œæ€§èƒ½è¶Šé«˜ï¼Œä½†æ˜¯æ›´æ–°è¶Šéš¾</li>\n<li>è„ç¼“å­˜æ¸…ç†-&gt;æ•°æ®æ›´æ–°äº†ç¼“å­˜æ²¡æ›´æ–°çš„æƒ…å†µï¼ˆç‰ºç‰²å†…å­˜ï¼Œå¹¶ä¸”æœ‰è„è¯»é—®é¢˜ï¼‰</li>\n</ul>\n</li>\n<li>nginx proxy cacheç¼“å­˜</li>\n<li>nginx luaç¼“å­˜</li>\n</ul>\n<h3>redisç¼“å­˜</h3>\n<ul>\n<li>redisç¼“å­˜ï¼ˆç½‘ç»œï¼Œé›†ä¸­å¼è´Ÿè½½å‡è¡¡ç“¶é¢ˆï¼‰-&gt;ä¸€èˆ¬æŠŠmodelæ”¾å…¥åˆ°redisä¸­ç¼“å­˜èµ·æ¥ï¼Œå¹¶ä¸”è®°å¾—è®¾ç½®è¶…æ—¶æ—¶é—´ï¼Œè®°å¾—å®ç°åºåˆ—åŒ–æ¥å£(é»˜è®¤)<br>\nredis nosqlæ•°æ®åº“å¯ä»¥æŒä¹…åŒ–ï¼Œé›†ä¸­å¼ç¼“å­˜ï¼Œå¯ä»¥ä¸¢å¤±<br>\nå•æœºï¼Œå®¹é‡ï¼Œæ•…éšœç“¶é¢ˆï¼Œæ‰€æœ‰ä¸šåŠ¡ç‚¸æ‰<br>\nsentinalå“¨å…µæ¨¡å¼ redis1å¯¹åº”ä¸€ä¸ªslave redis2ï¼Œåˆ™redis1ä¼šå°†æ•°æ®åŒæ­¥åˆ°redis2ï¼Œredis1æŒ‚äº†ä½¿ç”¨redis2ï¼Œä¸¤è€…ä¸»ä»å…³ç³»ã€‚redis sentinelä¸å¤šä¸ªrediså»ºç«‹é•¿è¿æ¥ï¼Œé€šè¿‡å¿ƒè·³æœºåˆ¶ï¼Œè€Œåå°è®¿é—®redis sentinelå†³å®šredisä¸»ä»é—®é¢˜ï¼Œæœ€ååå°ç›´æ¥è®¿é—®è¯¥redis<br>\nå®¹é‡é—®é¢˜æ˜æ˜¾ï¼Œmasterä¸å¥½æ‰©å®¹ï¼Œéš¾ä»¥å¤åˆ¶æ•°æ®</li>\n</ul>\n<p>clusteré›†ç¾¤æ¨¡å¼<br>\nrediséƒ½åœ¨äº’è¿ï¼Œä½¿ç”¨ç®—æ³•ä¿è¯é«˜å¯ç”¨ï¼Œåç«¯åªè¦è®¿é—®å…¶ä¸­ä¸€ä¸ªrediså°±è¡Œ</p>\n<p>//é…åˆRedisConfig<br>\nredisTemplate.opsForValue().set(uuidToken,userModel);<br>\nredisTemplate.expire(token,1, TimeUnit.HOURS);</p>\n<p>redisTemplate.opsForValue().get(uuidToken,userModel);</p>\n<h3>æœ¬åœ°ç¼“å­˜</h3>\n<ul>\n<li>å­˜æ”¾çƒ­ç‚¹æ•°æ®ï¼Œè¾ƒå°‘redisè®¿é—®ï¼Œå‡å°‘ioï¼Œåœ¨æ¯ç§’ä¸Šä¸‡æƒ…å†µä¸‹</li>\n<li>è„è¯»éå¸¸ä¸æ•æ„Ÿï¼Œåˆ†æ•£ï¼Œæ•°æ®éš¾åŒæ­¥ï¼ˆå¯ä»¥ç”¨mqè§£å†³ï¼Œä½†æ²¡å¿…è¦ï¼‰</li>\n<li>å†…å­˜å¯æ§</li>\n<li>ç”Ÿå‘½å‘¨æœŸçŸ­ï¼Œæ¯”redisçŸ­</li>\n<li>å†…å­˜jvmæœ¬åœ°ç¼“å­˜</li>\n<li>æ–¹æ¡ˆä½¿ç”¨Guava cacheæœ‰æ·˜æ±°æœºåˆ¶ï¼Œèƒ½æ”¯æŒå¹¶å‘è¯»å†™ï¼ˆçº¿ç¨‹å®‰å…¨ï¼‰\n<ul>\n<li>å¯æ§åˆ¶çš„å¤§å°å’Œè¶…æ—¶æ—¶é—´</li>\n<li>å¯é…ç½®çš„lruç­–ç•¥(æœ€è¿‘æœ€å°‘è®¿é—®ä¼˜å…ˆæ·˜æ±°)</li>\n<li>çº¿ç¨‹å®‰å…¨</li>\n</ul>\n</li>\n</ul>\n<p>å…ˆå»å–æœ¬åœ°ç¼“å­˜-&gt;redis-&gt;mysql<br>\n<br>\n@Service<br>\npublic class CacheServiceImpl implements CacheService {</p>\n<pre><code>private Cache&lt;String,Object&gt; commonCache = null;\n\n@PostConstruct\npublic void init(){\n    this.commonCache = CacheBuilder.newBuilder()\n            //è®¾ç½®ç¼“å­˜å®¹å™¨åˆå§‹å®¹é‡ä¸º10\n            .initialCapacity(10)\n            //è®¾ç½®ç¼“å­˜ä¸­æœ€å¤§å¯ä»¥å­˜å‚¨100ä¸ªKEY,è¶…è¿‡100ä¸ªä¹‹åä¼šæŒ‰ç…§LRUçš„ç­–ç•¥ç§»é™¤ç¼“å­˜é¡¹\n            .maximumSize(100)\n            //è®¾ç½®å†™ç¼“å­˜åå¤šå°‘ç§’è¿‡æœŸ\n            .expireAfterWrite(30, TimeUnit.SECONDS).build();\n}\n\n@Override\npublic void setCommonCache(String key, Object value) {\n    commonCache.put(key,value);\n}\n\n@Override\npublic Object getCommonCache(String key) {\n    return commonCache.getIfPresent(key);\n}\n</code></pre>\n<p>}</p>\n<h3>nginx proxy ç¼“å­˜ï¼ˆå°‘ç”¨ï¼Œå› ä¸ºè¿˜æ˜¯è®¿é—®æ–‡ä»¶ï¼‰</h3>\n<ul>\n<li>nginx proxy cacheç¼“å­˜ï¼ˆä¸å¥½ç”¨ï¼Œå› ä¸ºè¯»æ–‡ä»¶ï¼Œåè€Œæ¯”å…¶ä»–å†…å­˜ç¼“å­˜æ…¢ï¼‰</li>\n<li>å¿…é¡»æ˜¯nginxåå‘ä»£ç†å‰ç½®æ‰èƒ½ç”Ÿæ•ˆ</li>\n<li>ä¾é æ–‡ä»¶ç³»ç»Ÿå­˜ç´¢å¼•çº§æ–‡ä»¶ï¼ˆæŠŠè¯·æ±‚å½“åšæ–‡ä»¶ï¼Œå»æœ¬åœ°æ‰¾æ˜¯å¦æœ‰å¯¹åº”æ–‡ä»¶ï¼Œæœ‰åˆ™ç¼“å­˜ç”Ÿæ•ˆï¼‰</li>\n<li>ä¾é å†…å­˜ç¼“å­˜æ–‡ä»¶åœ°å€</li>\n</ul>\n<p>åœ¨nginx.confä¸­å£°æ˜<br>\nhttp{<br>\n#å£°æ˜ä¸€ä¸ªcacheç¼“å­˜èŠ‚ç‚¹å†…å®¹ï¼Œç”ŸæˆäºŒçº§ç›®å½•ï¼Œåœ¨urlç”Ÿæˆhashå€¼æ—¶å–æœ€åä¸€ä½å½“ç¬¬ä¸€çº§ç›®å½•ï¼Œå€’æ•°ç¬¬äºŒä½å½“äºŒçº§ç›®å½• inactive=7dä¿å­˜7å¤©<br>\nproxy_cache_path /usr/local/openresty/nginx/tmp_cache levels=1:2 keys_zone=tmp_cache:100m inactive=7d<br>\nmax_size=10g;<br>\nlocation /{<br>\nproxy_cache tmp_cache;<br>\nproxy_cache_key $uri;<br>\n# è¿”å›çŠ¶æ€ç 200 206 304 302<br>\nproxy_cache_valid 200 206 304 302 7d;<br>\n}<br>\n}</p>\n<h3>nginx luaç¼“å­˜ï¼ˆæ”¾nginxå†…å­˜ï¼Œæ¨èï¼‰</h3>\n<p>nginx å†…å­˜ç¼“å­˜(æœ€å¥½çƒ­ç‚¹æ•°æ®)</p>\n<ul>\n<li>\n<p>luaåç¨‹æœºåˆ¶ï¼Œçº¿ç¨‹ç©ºé—´æ ˆçš„æ‰§è¡Œå•å…ƒï¼Œä¸²è¡Œæ‰§è¡Œï¼Œç”¨æˆ·æ€æ¨¡æ‹Ÿå‡ºæ¥çš„å†…å­˜ç©ºé—´ï¼Œä»¥åŒæ­¥æ–¹å¼ç¼–å†™ä»£ç </p>\n</li>\n<li>\n<p>nginxåç¨‹æœºåˆ¶</p>\n</li>\n<li>\n<p>nginx luaæ’è½½ç‚¹</p>\n</li>\n<li>\n<p>OpenResty</p>\n</li>\n<li>\n<p>åç¨‹æœºåˆ¶</p>\n</li>\n<li>\n<p>ä¾é™„äºçº¿ç¨‹çš„å†…å­˜æ¨¡å‹ï¼Œåˆ‡æ¢å¼€é”€å°</p>\n</li>\n<li>\n<p>é‡é˜»å¡å³å½’è¿˜æ‰§è¡Œæƒï¼Œä»£ç åŒæ­¥</p>\n</li>\n<li>\n<p>æ— éœ€åŠ é”</p>\n</li>\n<li>\n<p>nginxåç¨‹</p>\n</li>\n<li>\n<p>nginxçš„æ¯ä¸€ä¸ªworkerè¿›ç¨‹éƒ½æ˜¯åœ¨epollæˆ–kqueueè¿™ç§äº‹ä»¶æ¨¡å‹ä¹‹ä¸Šï¼Œå°è£…æˆåç¨‹</p>\n</li>\n<li>\n<p>æ¯ä¸€ä¸ªè¯·æ±‚éƒ½æœ‰ä¸€ä¸ªåç¨‹è¿›è¡Œå¤„ç†</p>\n</li>\n<li>\n<p>å³ä½¿ngx_luaé¡»è¿è¡ŒLuaï¼Œç›¸å¯¹Cæœ‰ä¸€å®šå¼€é”€ï¼Œä½†ä¾æ—§èƒ½ä¿è¯é«˜å¹¶å‘èƒ½åŠ›</p>\n</li>\n<li>\n<p>nginxæ¯ä¸ªworkerè¿›ç¨‹éƒ½åˆ›å»ºä¸€ä¸ªluaè™šæ‹Ÿæœº</p>\n</li>\n<li>\n<p>workerè¿›ç¨‹å†…æ‰€æœ‰åç¨‹å…±äº«åŒä¸€ä¸ªluaè™šæ‹Ÿæœº</p>\n</li>\n<li>\n<p>æ¯ä¸ªå¤–éƒ¨è¯·æ±‚ç”±ä¸€ä¸ªluaåç¨‹å¤„ç†ï¼Œåç¨‹é—´æ•°æ®éš”ç¦»</p>\n</li>\n<li>\n<p>luaä»£ç  è°ƒç”¨ioç­‰å¼‚æ­¥æ¥å£æ—¶ï¼Œåç¨‹è¢«æŒ‚èµ·ï¼Œä¸Šä¸‹æ–‡æ•°æ®è‡ªåŠ¨ä¿å­˜ï¼Œä¸é˜»å¡workerè¿›ç¨‹ï¼Œioå¼‚æ­¥æ“ä½œå®Œæˆåè¿˜åŸåç¨‹ä¸Šä¸‹æ–‡ï¼Œä»£ç ç»§ç»­æ‰§è¡Œ</p>\n</li>\n</ul>\n<p>nginxå¤„ç†é˜¶æ®µ<br>\nNGX_HTTP_POST_READ_PHASE=0;//è¯»å–è¯·æ±‚å¤´<br>\nNGX_HTTP_SERVER_REWRITE_PHASE;//æ‰§è¡Œrewrite -&gt;rewrite_handlerå®šåˆ¶å¼€å‘<br>\nNGX_HTTP_FIND_CONFIG_PHASE;//æ ¹æ®uriæ›¿æ¢location<br>\nNGX_HTTP_REWRITE_PHASE;//æ ¹æ®æ›¿æ¢ç»“æœç»§ç»­æ‰§è¡Œrewrite-&gt; reweite_handlerå®šåˆ¶å¼€å‘<br>\nNGX_HTTP_POST_REWRITE_PHASE;//æ‰§è¡Œrewriteåå¤„ç†<br>\nNGX_HTTP_PREACCESS_PHASE;//è®¤è¯é¢„å¤„ç†ï¼Œè¯·æ±‚é™åˆ¶ï¼Œè¿æ¥é™åˆ¶ -&gt; limit_conn_hander_limit_req_handlerå®šåˆ¶å¼€å‘<br>\nNGX_HTTP_ACCESS_PHASE;//è®¤è¯å¤„ç†-&gt;auth_basic_handler_access_handlerå®šåˆ¶å¼€å‘<br>\nNGX_HTTP_POST_ACCESS_PHASE;//è®¤è¯åå¤„ç†ï¼Œè®¤è¯ä¸é€šè¿‡ï¼Œä¸¢åŒ…<br>\nNGX_HTTP_TRY_FILES_PHASE;//å°è¯•tryæ ‡ç­¾<br>\nNGX_HTTP_CONTENT_PHASE;//å†…å®¹å¤„ç†-&gt;static_handler å®šåˆ¶å¼€å‘<br>\nNGX_HTTP_LOG_PHASE;//æ—¥å¿—å¤„ç†-&gt;log_handler</p>\n<p>nginx luaæ’è½½ç‚¹<br>\ninit_by_lua:ç³»ç»Ÿå¯åŠ¨æ—¶è°ƒç”¨<br>\ninit_worker_by_lua:workerè¿›ç¨‹å¯åŠ¨æ—¶è°ƒç”¨<br>\nset_by_lua:NGINXå˜é‡ç”¨å¤æ‚lua return<br>\nrewrite_by_lua:é‡å†™urlè§„åˆ™<br>\naccess_by_lua:æƒé™è®¤è¯é˜¶æ®µ<br>\ncontent_by_lua:å†…å®¹è¾“å‡ºèŠ‚ç‚¹</p>\n<ul>\n<li>ä½¿ç”¨lua<br>\ninit.luaæ–‡ä»¶<br>\nngx.lua(ngx.ERR,\"init lua success\");</li>\n</ul>\n<p>content.luaæ–‡ä»¶<br>\nngx.say(\"hello\");<br>\nngx.exec(\"url\");//nginxä»£ç†è¯·æ±‚</p>\n<p>åœ¨httpæ¨¡å—ä¸‹<br>\nhttp{<br>\ninit_by_lua_file /usr/local/init.lua;<br>\nlocation /xxx/ {<br>\ndefault_type \"text/html\";<br>\ncontent_by_lua_file\t/usr/local/content.lua;<br>\n}<br>\n}</p>\n<ul>\n<li>å¼€å‘OpenRestyä¸nginxçš„lua(æ”¾å…¥nginxçš„å†…å­˜é‡Œé¢)</li>\n<li>OpenRestyç”±Nginxæ ¸å¿ƒåŠ å¾ˆå¤šç¬¬ä¸‰æ–¹æ¨¡å—ç»„æˆï¼Œé»˜è®¤é›†æˆäº†Luaå¼€å‘ç¯å¢ƒï¼Œä½¿å¾—Nginxå¯ä»¥ä½œä¸ºä¸€ä¸ªweb serverä½¿ç”¨</li>\n<li>å€ŸåŠ©äºnginxçš„æ—¶é—´é©±åŠ¨æ¨¡å‹å’Œéé˜»å¡IO,å¯ä»¥å®ç°é«˜æ€§èƒ½çš„webåº”ç”¨ç¨‹åº</li>\n<li>openRestyæä¾›äº†å¤§é‡ç»„ä»¶å¦‚mysqlï¼Œredisï¼Œmemcachedç­‰ç­‰ï¼Œä½¿åœ¨nginxä¸Šå¼€å‘webåº”ç”¨æ–¹ä¾¿ç®€å•</li>\n<li>shared dicå…±äº«å†…å­˜å­—å…¸ï¼Œæ‰€æœ‰workerè¿›ç¨‹å¯è§ï¼Œlruæ·˜æ±°<br>\nåœ¨nginx æ–‡ä»¶ä¸­<br>\nhttp{<br>\nlua_shared_dict my_cache 128m<br>\nlocation /xxx/ {<br>\ndefault_type \"application/json\";<br>\ncontent_by_lua_file\t/usr/local/sharedic.lua;<br>\n}<br>\n}</li>\n</ul>\n<p>sharedic.luaæ–‡ä»¶</p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>function get_from_cache(key)\n\tlocal cache_ngx = ngx.shared.my_cache\n\tlocal value = cache_ngx:get(key)\nreturn value\nend\n\nfunction set_to_cache(key,value,exptime)\n\tif not exptime then \n\t\texptime = 0\n\tend\n\tlocal cache_ngx = ngx.shared.my_cache\n\tlocal succ,err,forcible = cache_ngx:set(key,value,exptime)\n\treturn succ\nend\n\nlocal args = ngx.req.get_uri.args()\nlocal id = agrs[\"id\"]\nlocal item_model = get_from_cache(\"item\"..id)\nif item_model == nill then\n\tlocal resp = ngx.location.capture(\"/item/get?id=\"..id)\n\titem_model = resp.body\n\tset_to_cache(\"item_\"..id,item_model,1*60)\nend\nngx.say(item_model)\n</code></pre></div><p>openresty redisæ”¯æŒï¼ˆå‡å°‘è®¿é—®jaræ¶ˆè€—ï¼Œå‡å°‘æ•°æ®æ›´æ–°é—®é¢˜ï¼‰æ¨è</p>\n<p>åœ¨nginx æ–‡ä»¶ä¸­<br>\nhttp{<br>\nlua_shared_dict my_cache 128m<br>\nlocation /xxx/ {<br>\ndefault_type \"application/json\";<br>\ncontent_by_lua_file\t/usr/local/redis.lua;<br>\n}<br>\n}</p>\n<p>redis.lua<br>\nlocal args = ngx.req.get_uri.args()<br>\nlocal id = agrs[\"id\"]<br>\nlocal cache = redis:new()<br>\nlocal ok,err = cache:connect(\"127.0.0.1\",6379)<br>\nlocal item_model = cache:get(\"\"item_\"..id)<br>\nif item_model == ngx.null or item_model == nil then<br>\nlocal resp = ngx.location.capture(\"/item/get?id=\"..id);<br>\nitem_model =resp.body<br>\nend</p>\n<p>ngx.say(item_model)</p>\n<h3>åŠ¨æ€ç¼“å­˜cdn(è®¿é—®é™æ€èµ„æºhtml)</h3>\n<ul>\n<li>\n<p>é™æ€è¯·æ±‚CDNï¼ˆä½¿ç”¨é˜¿é‡Œäº‘CDNåŠ é€Ÿå’Œé…ç½®CNAMEï¼‰<br>\nDNSç”¨CNAMEè§£æåˆ°æºç«™ï¼ŒåŸŸåè§£æåˆ†æˆAè§£æå’ŒCNAMEè§£æç­‰Aè§£æå°±æ˜¯åŸŸå-&gt;ip,è€ŒCNAMEå°±æ˜¯å°†è¯·æ±‚å‘é€åˆ°CNAMEæŒ‡å®šçš„æœåŠ¡å™¨ï¼Œç„¶åç”±CNAMEçš„æœåŠ¡å™¨å¤„ç†ï¼Œæ­¤æ—¶CNAMEçš„æœåŠ¡å™¨ä¼šæŒ‡å‘ä¸€ä¸ªæœ€è¿‘çš„æœåŠ¡å™¨ipï¼Œè¯¥æœåŠ¡å™¨ä¼šåˆ¤æ–­æ˜¯å¦æœ‰ç¼“å­˜ï¼Œæ²¡æœ‰åˆ™è¯·æ±‚æºç«™ï¼ˆå›æºï¼‰</p>\n</li>\n<li>\n<p>å›æºç¼“å†²è®¾ç½®</p>\n</li>\n<li>\n<p>cache controlå“åº”å¤´</p>\n</li>\n<li>\n<p>private å®¢æˆ·ç«¯å¯ä»¥ç¼“å­˜ï¼ˆé»˜è®¤ï¼‰</p>\n</li>\n<li>\n<p>publicï¼šå®¢æˆ·ç«¯å’Œä»£ç†æœåŠ¡å™¨éƒ½å¯ä»¥ç¼“å­˜</p>\n</li>\n<li>\n<p>max-age=xxx:ç¼“å­˜çš„å†…å®¹å°†åœ¨xxxç§’åå¤±æ•ˆ</p>\n</li>\n<li>\n<p>no-cacheï¼šå¼ºåˆ¶å‘æœåŠ¡ç«¯å†éªŒè¯ä¸€æ¬¡</p>\n<ul>\n<li>æœ‰æ•ˆæ€§åˆ¤æ–­ï¼šETagèµ„æºå”¯ä¸€æ ‡è¯†ï¼Œ</li>\n<li>Etagä¸€è‡´åˆ™ if-None-Match å®¢æˆ·ç«¯å‘é€çš„åŒ¹é…Etagæ ‡è¯†ç¬¦-&gt;ä¸€è‡´åˆ™304</li>\n<li>Etagä¸è‡´åˆ™ -&gt;Last-modified: èµ„æºæœ€åè¢«ä¿®æ”¹æ—¶é—´ if-Modified-Since:å®¢æˆ·ç«¯å‘é€çš„åŒ¹é…èµ„æºæœ€åä¿®æ”¹æ—¶é—´çš„æ ‡è¯†ç¬¦ -&gt;ä¸€è‡´åˆ™304</li>\n</ul>\n</li>\n<li>\n<p>no-store:ä¸ç¼“å­˜è¯·æ±‚çš„ä»»ä½•è¿”å›å†…å®¹</p>\n</li>\n<li>\n<p>æµè§ˆå™¨çš„ä¸‰ç§åˆ·æ–°æ–¹å¼</p>\n</li>\n<li>\n<p>å›è½¦æˆ–aé“¾æ¥ï¼šcache-controlå¯¹åº”çš„max-ageæ˜¯å¦ä»ç„¶æœ‰æ•ˆï¼Œæœ‰æ•ˆåˆ™ç›´æ¥from cacheï¼Œè‹¥cache-controlä¸­ä¸ºno-cacheï¼Œåˆ™è¿›å…¥ç¼“å­˜åå•†é€»è¾‘</p>\n</li>\n<li>\n<p>F5åˆ·æ–°æˆ–command+Råˆ·æ–°ï¼šå»æ‰cache-controlä¸­çš„max-ageæˆ–ç›´æ¥è®¾ç½®max-ageä¸º0ï¼Œç„¶åè¿›å…¥ç¼“å­˜åå•†é€»è¾‘</p>\n</li>\n<li>\n<p>ctrl+F5æˆ–commond+shift+Råˆ·æ–°ï¼šå»æ‰cache-controlå’Œåå•†å¤´ï¼Œå¼ºåˆ¶åˆ·æ–°</p>\n</li>\n<li>\n<p>åå•†æœºåˆ¶ï¼Œæ¯”è¾ƒLast-modifiedå’ŒEtagåˆ°æœåŠ¡ç«¯ï¼Œè‹¥æœåŠ¡ç«¯åˆ¤æ–­æ²¡å˜åŒ–åˆ™304ä¸è¿”å›æ•°æ®å¦åˆ™200è¿”å›æ•°æ®</p>\n</li>\n<li>\n<p>CDNè‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥</p>\n</li>\n<li>\n<p>å¯è‡ªå®šä¹‰ç›®å½•è¿‡æœŸæ—¶é—´</p>\n</li>\n<li>\n<p>å¯è‡ªå®šä¹‰åç¼€åè¿‡æœŸæ—¶é—´</p>\n</li>\n<li>\n<p>å¯è‡ªå®šä¹‰å¯¹åº”æƒé‡</p>\n</li>\n<li>\n<p>å¯é€šè¿‡ç•Œé¢æˆ–apiå¼ºåˆ¶åˆ·æ–°cdnå¯¹åº”ç›®å½•åˆ·æ–°ï¼ˆéä¿æˆåŠŸï¼Œæœ‰é€šä¿¡é™åˆ¶ï¼‰</p>\n</li>\n<li>\n<p>é™æ€èµ„æºcdnæ·±å…¥è®²è§£--CDNè‡ªå®šä¹‰ç¼“å­˜ç­–ç•¥04:16</p>\n</li>\n<li>\n<p>é™æ€èµ„æºéƒ¨ç½²ç­–ç•¥</p>\n</li>\n<li>\n<p>htmlå¿…å®šno-cacheæˆ–è€…max-ageå¾ˆçŸ­,ä¾¿äºæ›´æ–°ã€‚htmlæ–‡ä»¶æˆ–è€…è®¾ç½®è¾ƒé•¿çš„max ageã€‚ä¾é åŠ¨æ€çš„è·å–ç‰ˆæœ¬å·è¯·æ±‚ï¼ˆå¯¹æ¯”ç‰ˆæœ¬å·ï¼‰å‘é€åˆ°åç«¯ï¼Œå¼‚æ­¥ä¸‹è½½æœ€æ–°çš„ç‰ˆæœ¬å·çš„htmlåå±•ç¤ºæ¸²æŸ“åœ¨å‰ç«¯</p>\n</li>\n<li>\n<p>css,js,imgç­‰å…ƒç´ ä½¿ç”¨å¸¦ç‰ˆæœ¬å·éƒ¨ç½²ï¼Œa.js?v=1.0ï¼Œä¸ä¾¿åˆ©ï¼Œç»´æŠ¤å›°éš¾</p>\n</li>\n<li>\n<p>css,js,imgç­‰å…ƒç´ ä½¿ç”¨å¸¦æ‘˜è¦éƒ¨ç½²ï¼Œä¾‹å¦‚a.js?v=45edwå­˜åœ¨å…ˆéƒ¨ç½²htmlè¿˜æ˜¯å…ˆéƒ¨ç½²èµ„æºçš„è¦†ç›–é—®é¢˜ï¼Œå› ä¸ºæ‰€æœ‰htmlä¸èµ„æºéƒ½è¦æ›´æ–°</p>\n</li>\n<li>\n<p>ï¼ˆæ¨èï¼‰css,js,imgç­‰å…ƒç´ ä½¿ç”¨æ‘˜è¦åšæ–‡ä»¶åï¼Œä¾‹å¦‚45edw.js,æ–°è€ç‰ˆæœ¬å¹¶å­˜ä¸”å¯å›æ»šï¼Œèµ„æºéƒ¨ç½²åå†éƒ¨ç½²html-&gt;css,js,imgå¯¹åº”é™æ€èµ„æºä¿æŒç”Ÿå‘½å‘¨æœŸå†…ä¸ä¼šå˜ï¼Œmax-ageå¯è®¾ç½®çš„å¾ˆé•¿ï¼Œæ— è§†å¤±æ•ˆæ›´æ–°å‘¨æœŸ</p>\n</li>\n<li>\n<p>åŠ¨æ€è¯·æ±‚ä¹Ÿå¯ä»¥é™æ€åŒ–æˆjsonèµ„æºæ¨é€åˆ°cdnä¸Šï¼ˆè·å–å•†å“ï¼‰</p>\n</li>\n<li>\n<p>å‰ç«¯å…ˆæ˜¾ç¤ºæ—§ç‰ˆæœ¬ï¼Œå› ä¸ºcdnæ¨é€ä¸ä¸€å®šæˆåŠŸï¼Œæ‰€ä»¥å¯ä»¥å†ä¾é å¼‚æ­¥è¯·æ±‚è·å–åç«¯èŠ‚ç‚¹æ¯”å¯¹ç‰ˆæœ¬å·ï¼Œä¸ä¸€è‡´åˆ™å¯ä»¥å¯¹å¯¹åº”èµ„æºçŠ¶æ€åšç´§æ€¥ä¸‹æ¶å¤„ç†ï¼ˆè¦†ç›–ï¼‰</p>\n</li>\n<li>\n<p>å¯é€šè¿‡è·‘æ‰¹ç´§æ€¥æ¨é€cdnå†…å®¹ä»¥ä½¿å…¶ä¸‹æ¶ç­‰æ“ä½œ</p>\n</li>\n</ul>\n<p>å¼ºæ¨å¤±æ•ˆ</p>\n<ul>\n<li>\n<p>å…¨é¡µé¢é™æ€åŒ–</p>\n</li>\n<li>\n<p>htmlï¼Œcssï¼Œjsé™æ€èµ„æºcdnåŒ–+js ajax åŠ¨æ€è¯·æ±‚cdnåŒ–=å…¨é¡µé¢é™æ€åŒ–</p>\n</li>\n<li>\n<p>åœ¨æœåŠ¡ç«¯å®Œæˆhtmlï¼Œcssï¼Œç”šè‡³jsçš„loadæ¸²æŸ“æˆhtmlæ–‡ä»¶åç›´æ¥ä»¥é™æ€èµ„æºçš„æ–¹å¼éƒ¨ç½²åˆ°cdnä¸Šï¼ˆå·²æ¸²æŸ“å¥½çš„é¡µé¢ï¼‰</p>\n</li>\n<li>\n<p>ä½¿ç”¨phantomjsï¼ˆæœ¬è´¨çˆ¬è™«ï¼‰</p>\n</li>\n<li>\n<p>æ— å¤´æµè§ˆå™¨ï¼Œå¯ä»¥å€ŸåŠ©å™¨æ¨¡æ‹Ÿwebkit jsçš„æ‰§è¡Œ<br>\nä¿®æ”¹éœ€è¦å…¨é¡µé¢é™æ€åŒ–çš„å®ç°ï¼Œé‡‡ç”¨initViewå’ŒhasInitæ–¹å¼é˜²æ­¢å¤šæ¬¡åˆå§‹åŒ–(å†™ç¨‹åºä¿è¯åªåŠ è½½ä¸€æ¬¡)<br>\nç¼–å†™å¯¹åº”è½®è¯¢ç”Ÿæˆå†…å®¹æ–¹å¼<br>\nå°†å…¨é™æ€è¯é¡µé¢ç”Ÿæˆåæ¨é€åˆ°cdn</p>\n</li>\n</ul>\n<p>xxx.js<br>\nvar page = require(\"webpage\").create();<br>\nvar fs = require(\"fs\");<br>\npage.open(\"<a href=\"http://xxxx\" target=\"_blank\" rel=\"noopener noreferrer\">http://xxxx</a>\",function(status){<br>\nconsole.log(\"status = \" + status);<br>\nsetTimeout(function(){<br>\n<a href=\"//page.evaluate\" target=\"_blank\" rel=\"noopener noreferrer\">//page.evaluate</a>(function(){<br>\n//è°ƒç”¨æ‹¿åˆ°çš„è¯·æ±‚çš„htmlé‡Œé¢çš„å‡½æ•°\t\t<br>\n//});<br>\nfs.write(\"xxxx.html\",page.content,\"w\");<br>\nphantom.exit();<br>\n},1000);</p>\n<p>})</p>\n<p>bin/phantomjs js/genitem.js</p>\n<h3>åŠ¨æ€è¯·æ±‚ç¼“å­˜</h3>\n<h3>é¡µé¢é™æ€åŒ–</h3>\n<h2>äº¤æ˜“æ³„å‹</h2>\n<h3>ç¼“å­˜åº“å­˜</h3>\n<p>äº¤æ˜“æ€§èƒ½ç“¶é¢ˆ<br>\näº¤æ˜“éªŒè¯å®Œå…¨ä¾èµ–æ•°æ®åº“(åˆ¤æ–­å•†å“å’Œç”¨æˆ·ï¼Œæ´»åŠ¨ä¿¡æ¯)<br>\næ•°æ®åº“è¡Œé”ï¼›æŸä¸ªidï¼ˆæ‰£å‡åº“å­˜ï¼‰<br>\nåç½®å¤„ç†é€»è¾‘ï¼ˆä¿å­˜è®¢å•ï¼Œå¢åŠ é”€é‡ï¼‰</p>\n<p>äº¤æ˜“éªŒè¯ä¼˜åŒ–<br>\nç”¨æˆ·é£æ§ç­–ç•¥ä¼˜åŒ–ï¼šç­–ç•¥ç¼“å­˜æ¨¡å‹ä¼˜åŒ–ï¼ˆæ”¾rediså¹¶è®¾ç½®è¶…æ—¶æ—¶é—´ï¼‰<br>\næ´»åŠ¨æ ¡éªŒç­–ç•¥ä¼˜åŒ–ï¼ˆæ”¾rediså¹¶è®¾ç½®è¶…æ—¶æ—¶é—´ï¼‰ï¼šå¼•å…¥æ´»åŠ¨å‘å¸ƒæµç¨‹ï¼Œæ¨¡å‹ç¼“å­˜åŒ–ï¼Œç´§æ€¥ä¸‹çº¿èƒ½åŠ›ï¼ˆå¼‚å¸¸å•†å“å»æ‰redisç¼“å­˜å³å¯ï¼‰</p>\n<p>åº“å­˜è¡Œé”ä¼˜åŒ–<br>\nupdateçš„æ—¶å€™å¦‚æœæ²¡æœ‰æŒ‡å®šç´¢å¼•çš„è¯ä¼šé”è¡¨ï¼Œæœ‰ç´¢å¼•çš„è¯æœ‰è¡Œé”ï¼Œè¡Œé”ä¿è¯æŸæ¡æ•°æ®çš„æ›´æ–°æ“ä½œä¸²è¡ŒåŒ–</p>\n<p>æ‰£å‡ç¼“å­˜å¼‚æ­¥åŒ–-&gt;1.æ´»åŠ¨å‘å¸ƒåŒæ­¥åº“å­˜è¿›ç¼“å­˜-&gt;2.ä¸‹å•äº¤æ˜“å‡åº“å­˜ç¼“å­˜<br>\nå¼‚æ­¥åŒæ­¥æ•°æ®åº“-&gt;3.å¼‚æ­¥äº‹åŠ¡å‹æ¶ˆæ¯æ‰£å‡æ•°æ®åº“å†…åº“å­˜ï¼ˆå¼‚æ­¥æ¶ˆæ¯é˜Ÿåˆ—rocketmqï¼‰é«˜æ€§èƒ½ï¼Œé«˜å¹¶å‘ï¼Œåˆ†å¸ƒå¼æ¶ˆæ¯ä¸­é—´ä»¶<br>\nåº”ç”¨ï¼Œåˆ†å¸ƒå¼äº‹åŠ¡ï¼Œå¼‚æ­¥è§£è€¦ï¼ˆproducerï¼Œname server consumerï¼ˆæ³¨å†Œä¸­å¿ƒï¼‰ï¼Œconsumer groupï¼ˆconsumerï¼‰ï¼Œbrokerï¼ˆqueueï¼‰ï¼‰-&gt;å¼•å…¥åº“å­˜æ“ä½œæµæ°´ï¼ˆåº“å­˜æ•°é‡ï¼Œå•†å“idï¼Œæ“ä½œæµæ°´å·ï¼Œè®¢å•çŠ¶æ€ï¼Œæ“ä½œå‰insertåˆå§‹çŠ¶æ€ï¼Œæ“ä½œå®Œupdateä¸ºå·²æ‰£å‡åº“å­˜çŠ¶æ€ï¼Œæ“ä½œä¸­selectæŸ¥çœ‹æ“ä½œçŠ¶æ€ï¼Œè‹¥ä¸ºå·²æ‰£å‡ï¼Œåˆ™æäº¤äº‹åŠ¡ï¼Œå¦åˆ™å›æ»šäº‹åŠ¡ï¼‰-&gt;åº“å­˜æ•°æ®åº“æœ€ç»ˆä¸€è‡´æ€§ä¿è¯<br>\nredisä¸èƒ½ç”¨æ—¶å¦‚ä½•å¤„ç†ï¼Ÿæ‰£å‡æµæ°´é”™è¯¯å¦‚ä½•å¤„ç†ï¼Ÿ</p>\n<p>åº“å­˜è®¾è®¡åŸåˆ™ï¼š<br>\nå®å¯å°‘å–ï¼Œä¸èƒ½è¶…å–<br>\nrediså¯ä»¥æ¯”å®é™…æ•°æ®åº“ä¸­å°‘ï¼Œè®¢å•é•¿æ—¶é—´æ²¡å¤„ç†æ—¶ï¼Œéœ€è¦è¶…æ—¶é‡Šæ”¾åº“å­˜ï¼ŒæŠŠåº“å­˜åŠ å›å»</p>\n<p>åˆ†å¸ƒå¼äº‹åŠ¡<br>\nCAPç†è®ºï¼Œæœ€ç»ˆä¸€è‡´æ€§BASE<br>\nå®‰è£…rocketmq<br>\nä¸‹è½½rocketmq<br>\nchomd -R 777<br>\nyum install unzip<br>\nunzip rocketmq-all-4.4.0-release.zip<br>\ncd rocketmq-all-4.4.0-release<br>\nnohup sh bin/mqnamesrv(9876ç«¯å£)<br>\nnohup sh bin/mqbroker -n localhost:9876</p>\n<p>mq.nameserver=xxxx:port<br>\nmq.topicname=xx</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;org.apache.rocketmq&lt;/groupId&gt;\n  &lt;artifactId&gt;rocketmq-client&lt;/artifactId&gt;\n  &lt;version&gt;4.3.0&lt;/version&gt;\n&lt;/dependency&gt;\n</code></pre>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//å¼‚æ­¥ä¿®æ”¹åº“å­˜ï¼Œè¦ä¿è¯æ•°æ®åº“æ’å…¥è®¢å•å’Œredisæ‰£å‡åº“å­˜æˆåŠŸåæ‰å¼‚æ­¥æŠŠæ•°æ®åº“æ‰£å‡\nTransactionSynchronizationManager.registerSynchronization(new TransactionSynchronizationAdapter() {\n    @Override\n    public void afterCommit() {\n\n        super.afterCommit();\n    }\n});\n\nç¡®ä¿æœ€è¿‘çš„äº‹åŠ¡æäº¤å®Œæˆåä¼šè§¦å‘\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Component\npublic class MqProducer {\n\n    @Autowired\n    private DefaultMQProducer producer;\n\n    @Autowired\n    private TransactionMQProducer transactionMQProducer;\n\n    @Value(\"${mq.nameserver.addr}\")\n    private String nameAddr;\n\n    @Value(\"${mq.topicname}\")\n    private String topicName;\n\n    @PostConstruct\n    public void init() throws MQClientException {\n        producer = new DefaultMQProducer(\"producer_group\");\n        producer.setNamesrvAddr(nameAddr);\n        producer.start();\n\n        transactionMQProducer = new TransactionMQProducer(\"transaction_producer_group\");\n        transactionMQProducer.setNamesrvAddr(nameAddr);\n        transactionMQProducer.start();\n        transactionMQProducer.setTransactionListener(new TransactionListener() {\n            @Override\n            public LocalTransactionState executeLocalTransaction(Message message, Object o) {\n                 //çœŸæ­£è¦åšçš„äº‹  åˆ›å»ºè®¢å•\n                Integer itemId = (Integer) ((Map)arg).get(\"itemId\");\n                Integer promoId = (Integer) ((Map)arg).get(\"promoId\");\n                Integer userId = (Integer) ((Map)arg).get(\"userId\");\n                Integer amount = (Integer) ((Map)arg).get(\"amount\");\n                String stockLogId = (String) ((Map)arg).get(\"stockLogId\");\n                try {\n                    orderService.createOrder(userId,itemId,promoId,amount,stockLogId);\n                } catch (BusinessException e) {\n                    e.printStackTrace();\n                    //è®¾ç½®å¯¹åº”çš„stockLogä¸ºå›æ»šçŠ¶æ€\n                    StockLogDO stockLogDO = stockLogDOMapper.selectByPrimaryKey(stockLogId);\n                    stockLogDO.setStatus(3);\n                    stockLogDOMapper.updateByPrimaryKeySelective(stockLogDO);\n                    return LocalTransactionState.ROLLBACK_MESSAGE;\n                }\n                return LocalTransactionState.COMMIT_MESSAGE;\n            }\n\n            @Override\n            //äº‹åŠ¡æ‰§è¡Œæ—¶é—´å¤ªé•¿çš„æ—¶å€™rocketmqè¦å›è°ƒè¿™ä¸ªæ–¹æ³•ï¼Œè¿™é‡Œåº”è¯¥æ£€æŸ¥redisåº“å­˜\n            public LocalTransactionState checkLocalTransaction(MessageExt messageExt) {\n\t\t        //æŸ¥è¯¢æ“ä½œæµæ°´ä¸­æ“ä½œçš„çŠ¶æ€ï¼Œç”¨æ•°æ®åº“å¹¶ä¼ å…¥æµæ°´å·\n                //å¦‚æœè®¢å•çŠ¶æ€ä¸ºå·²æ‰£å‡ï¼Œåˆ™æˆåŠŸï¼Œå¦åˆ™unknown\n                return null;\n            }\n        });\n    }\n    //äº‹åŠ¡æ€§æ‰£å‡åº“å­˜\n    //äº‹åŠ¡å‹åŒæ­¥åº“å­˜æ‰£å‡æ¶ˆæ¯\n    public boolean transactionAsyncReduceStock(Integer userId,Integer itemId,Integer promoId,Integer amount,String stockLogId){\n        Map&lt;String,Object&gt; bodyMap = new HashMap&lt;&gt;();\n        bodyMap.put(\"itemId\",itemId);\n        bodyMap.put(\"amount\",amount);\n        bodyMap.put(\"stockLogId\",stockLogId);\n\n        Map&lt;String,Object&gt; argsMap = new HashMap&lt;&gt;();\n        argsMap.put(\"itemId\",itemId);\n        argsMap.put(\"amount\",amount);\n        argsMap.put(\"userId\",userId);\n        argsMap.put(\"promoId\",promoId);\n        argsMap.put(\"stockLogId\",stockLogId);\n\n        Message message = new Message(topicName,\"increase\",\n                JSON.toJSON(bodyMap).toString().getBytes(Charset.forName(\"UTF-8\")));\n        TransactionSendResult sendResult = null;\n        try {\n\n            sendResult = transactionMQProducer.sendMessageInTransaction(message,argsMap);\n        } catch (MQClientException e) {\n            e.printStackTrace();\n            return false;\n        }\n        if(sendResult.getLocalTransactionState() == LocalTransactionState.ROLLBACK_MESSAGE){\n            return false;\n        }else if(sendResult.getLocalTransactionState() == LocalTransactionState.COMMIT_MESSAGE){\n            return true;\n        }else{\n            return false;\n        }\n\n    }\n    //æ— äº‹åŠ¡å‘é€\n    public boolean send(String itemId,Integer amount) {\n        Map&lt;String,Object&gt; bodyMap = new HashMap&lt;&gt;();\n        bodyMap.put(\"itemId\",itemId);\n        bodyMap.put(\"amount\",amount);\n        Message message = new Message(topicName,\"increse\",\n                JSON.toJSON(bodyMap).toString().getBytes(Charset.forName(\"UTF-8\")));\n        try {\n            producer.send(message);\n        } catch (MQClientException e) {\n            e.printStackTrace();\n            return false;\n        } catch (RemotingException e) {\n            e.printStackTrace();\n            return false;\n        } catch (MQBrokerException e) {\n            e.printStackTrace();\n            return false;\n        } catch (InterruptedException e) {\n            e.printStackTrace();\n            return false;\n        }\n        return true;\n    }\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>@Component\npublic class MqConsumer {\n\n    @Autowired\n    private DefaultMQPushConsumer consumer;\n\n    @Value(\"${mq.nameserver.addr}\")\n    private String nameAddr;\n\n    @Value(\"${mq.topicname}\")\n    private String topicName;\n\n    @PostConstruct\n    public void init() throws MQClientException {\n        consumer = new DefaultMQPushConsumer(\"stock_consumer_group\");\n        consumer.setNamesrvAddr(nameAddr);\n        consumer.subscribe(topicName,\"*\");\n        consumer.registerMessageListener(new MessageListenerConcurrently() {\n            @Override\n            public ConsumeConcurrentlyStatus consumeMessage(List&lt;MessageExt&gt; list, ConsumeConcurrentlyContext consumeConcurrentlyContext) {\n                Message msg = list.get(0);\n                String body = new String(msg.getBody());\n                return ConsumeConcurrentlyStatus.CONSUME_SUCCESS;\n            }\n        });\n    }\n}\n</code></pre></div><h3>äº¤æ˜“å¼‚æ­¥åŒ–</h3>\n<h3>å¼‚æ­¥åŒ–äº‹åŠ¡</h3>\n<p>æ“ä½œæµæ°´<br>\næ•°æ®ç±»å‹<br>\nä¸»ä¸šåŠ¡æ•°æ®master data<br>\næ“ä½œæ€§æ•°æ®log data</p>\n<p>åº“å­˜å”®ç½„<br>\nåº“å­˜å”®ç½„æ ‡è¯†ï¼Œæ”¾åˆ°redis<br>\nå‡ºå”®å‰åˆ¤æ–­æ˜¯å¦å”®ç½„ï¼Œå”®ç½„åä¸å»æ“ä½œåç»­æµç¨‹<br>\nå”®ç½„åé€šçŸ¥å„ç³»ç»Ÿå”®ç½„<br>\nå›è¡¥ä¸Šæ–°</p>\n<p>åç½®æµç¨‹<br>\né”€é‡é€»è¾‘å¼‚æ­¥åŒ–<br>\näº¤æ˜“å•é€»è¾‘å¼‚æ­¥åŒ–ï¼ˆç”Ÿæˆäº¤æ˜“å•sequenceåç›´æ¥å¼‚æ­¥è¿”å›ï¼Œå‰ç«¯è½®è¯¢å¼‚æ­¥å•çŠ¶æ€ï¼‰</p>\n<h2>æµé‡é”™å³°</h2>\n<p>æµé‡å‰Šå³°æŠ€æœ¯<br>\nç§’æ€ä¸‹å•æ¥å£ä¼šè¢«è„šæœ¬ä¸åœçš„åˆ·<br>\nç§’æ€éªŒè¯é€»è¾‘å’Œç§’æ€ä¸‹å•æ¥å£å¼ºå…³è”ï¼Œä»£ç å†—ä½™åº¦é«˜-&gt;å¼•å…¥ç§’æ€ä»¤ç‰Œ<br>\nç§’æ€éªŒè¯é€»è¾‘å¤æ‚ï¼Œå¯¹äº¤æ˜“ç³»ç»Ÿäº§ç”Ÿæ— å…³è”è´Ÿè½½-&gt;å¼•å…¥ç§’æ€ä»¤ç‰Œ</p>\n<h3>ç§’æ€ä»¤ç‰Œ</h3>\n<p>ç§’æ€ä»¤ç‰ŒåŸç†ï¼ˆå°‘æµé‡ï¼‰<br>\nç§’æ€æ¥å£éœ€è¦ä¾é ä»¤ç‰Œæ‰èƒ½è¿›å…¥ï¼ˆuid+å•†å“id+ç§’æ€idï¼‰<br>\nç§’æ€çš„ä»¤ç‰Œç”±ç§’æ€æ¨¡å—ç”Ÿæˆ<br>\nç§’æ€æ´»åŠ¨æ¨¡å—å¯¹ç§’æ€ä»¤ç‰Œç”Ÿæˆå…¨æƒå¤„ç†ï¼ˆå°†éªŒè¯ç”¨æˆ·ï¼Œå•†å“ï¼Œæ´»åŠ¨è¿ç§»åˆ°ä»¤ç‰Œç”Ÿæˆï¼Œæ²¡æœ‰ä»¤ç‰Œä¸èƒ½ä¸‹å•ï¼Œæ”¾redisï¼Œå‰ç«¯éœ€è¦å•ç‹¬è·å–ç§’æ€ä»¤ç‰Œï¼Œåç«¯å•ç‹¬å†™ç§’æ€ä»¤ç‰Œï¼‰ï¼Œé€»è¾‘æ”¶å£ï¼ˆæ²¡æœ‰ä»¤ç‰Œä¸å¾€ä¸‹èµ°ï¼‰<br>\nç§’æ€ä¸‹å•å‰éœ€è¦è·å¾—ç§’æ€ä»¤ç‰Œï¼Œæ²¡æœ‰ä»¤ç‰Œåˆ™ä¸èƒ½ä¸‹å•</p>\n<h3>ç§’æ€å¤§é—¸</h3>\n<p>ç§’æ€ä»¤ç‰Œåªè¦æ´»åŠ¨ä¸€å¼€å§‹å°±æ— é™åˆ¶ç”Ÿæˆï¼Œå½±å“ç³»ç»Ÿæ€§èƒ½<br>\nè§£å†³æ–¹æ¡ˆï¼šä¾é ç§’æ€ä»¤ç‰Œçš„æˆæƒåŸç†å®šåˆ¶åŒ–å‘ç‰Œé€»è¾‘ï¼Œåšåˆ°å¤§é—¸åŠŸèƒ½ï¼Œ<br>\næ ¹æ®ç§’æ€å•†å“åˆå§‹åº“å­˜é¢å‘å¯¹åº”æ•°é‡çš„ä»¤ç‰Œï¼Œæ§åˆ¶å¤§é—¸æµé‡ï¼Œåœ¨redisä¿å­˜åº“å­˜æ•°ä¹˜ä»¥ç³»æ•°ä¸ªæ•°é‡ï¼Œç„¶åæ”¾åˆ°redisä¸­ï¼Œæ¯æ¬¡ç”Ÿæˆç§’æ€ä»¤ç‰Œå‡æ‰1ç„¶åä¸º0åˆ™ä¸å†å‘ç‰Œ<br>\nç”¨æˆ·é£æ§ç­–ç•¥å‰ç½®åˆ°ç§’æ€ä»¤ç‰Œå‘æ”¾ä¸­<br>\nåº“å­˜å”®ç½„åˆ¤æ–­å‰ç½®åˆ°ç§’æ€ä»¤ç‰Œå‘æ”¾ä¸­</p>\n<h3>é˜Ÿåˆ—æ³„æ´ª</h3>\n<p>æµªæ¶Œæµé‡æ¶Œå…¥åç³»ç»Ÿæ— æ³•åº”å¯¹ï¼ˆè¶…å¤§æµé‡ï¼‰<br>\nå¤šåº“å­˜ï¼Œå¤šå•†å“ç­‰ä»¤ç‰Œé™åˆ¶èƒ½åŠ›å¼±<br>\nè§£å†³æ–¹æ¡ˆ-&gt;é˜Ÿåˆ—æ³„æ´ªåŸç†<br>\næ’é˜Ÿæœ‰æ—¶å€™æ¯”å¹¶å‘æ›´é«˜æ•ˆï¼ˆrediså•çº¿ç¨‹æ¨¡å‹ innodb mutex keyç­‰ï¼‰<br>\nä¾é æ’é˜Ÿå»é™åˆ¶å¹¶å‘æµé‡<br>\nä¾é æ’é˜Ÿå’Œä¸‹æ¸¸æ‹¥å¡çª—å£ç¨‹åº¦è°ƒæ•´é˜Ÿåˆ—é‡Šæ”¾æµé‡å¤§å°-&gt;æ”¯ä»˜å®é“¶è¡Œç½‘å…³é˜Ÿåˆ—ä¸¾ä¾‹,æ”¯ä»˜å®åšæ‹¥å¡çª—å£å¤„ç†ï¼Œä¿è¯ä¸‹æ¸¸é“¶è¡Œçš„tps</p>\n<p>å®ç° æœ¬åœ°ï¼šå°†é˜Ÿåˆ—ç»´æŠ¤åœ¨æœ¬åœ°å†…å­˜ä¸­ï¼ˆç”Ÿäº§ç¯å¢ƒï¼Œæ¨èï¼‰<br>\nåˆ†å¸ƒå¼ï¼šå°†é˜Ÿåˆ—è®¾ç½®åˆ°å¤–éƒ¨rediså†…ï¼Œæ€§èƒ½å¤ªå·®ï¼Œè´Ÿè½½å¤§<br>\nä¼ä¸šä¸€èˆ¬æ˜¯é›†ä¸­å¼å¼‚å¸¸ï¼Œè¶…æ—¶åè½¬æœ¬åœ°<br>\nprivate ExecutorService executorService;</p>\n<pre><code>@PostConstruct\npublic void init(){\n    executorService = Executors.newFixedThreadPool(20);\n\n}\n\n    Future&lt;Object&gt; submit = executorService.submit(new Callable&lt;Object&gt;() {\n        @Override\n        public Object call() throws Exception {\n\n            return null;\n\n        }\n    });\n    try {\n        submit.get();\n    } catch (InterruptedException e) {\n        e.printStackTrace();\n    } catch (ExecutionException e) {\n        e.printStackTrace();\n    }\n    return;\n</code></pre>\n<h2>é˜²åˆ·é™æµ</h2>\n<h3>éªŒè¯ç </h3>\n<p>åŒ…è£…ç§’æ€ä»¤ç‰Œå‰ç½®ï¼Œéœ€è¦éªŒè¯ç æ¥é”™å³°<br>\næ•°å­¦å…¬å¼éªŒè¯ç ç”Ÿæˆå™¨,ç”ŸæˆéªŒè¯ç è¿”å›ç»™å‰ç«¯ï¼Œç„¶åæ”¾å…¥redisåœ¨ç”Ÿæˆç§’æ€ä»¤ç‰Œæ—¶æ ¡éªŒä¸€ä¸‹ï¼Œæ²¡æœ‰æ ¡éªŒè¿‡çš„ä¸å‘æ”¾ç§’æ€ä»¤ç‰Œ</p>\n<h3>é™æµå™¨</h3>\n<p>ç³»ç»Ÿå®æ„¿åªè®©å°‘æ•°äººèƒ½ç”¨ï¼Œä¸èƒ½è®©æ‰€æœ‰äººä¸èƒ½ç”¨<br>\næ–¹æ¡ˆ<br>\n1.é™åˆ¶å¹¶å‘ tps æ¯ç§’å¤„ç†è¯·æ±‚æ•°é‡ï¼ˆä¸ç”¨ï¼‰<br>\n2.ä»¤ç‰Œæ¡¶ç®—æ³• ä»¤ç‰Œæ¡¶ç®—æ³•çš„åŸç†æ˜¯ç³»ç»Ÿä¼šä»¥ä¸€ä¸ªæ’å®šçš„é€Ÿåº¦å¾€æ¡¶é‡Œæ”¾å…¥ä»¤ç‰Œï¼Œè€Œå¦‚æœè¯·æ±‚éœ€è¦è¢«å¤„ç†ï¼Œåˆ™éœ€è¦å…ˆä»æ¡¶é‡Œè·å–ä¸€ä¸ªä»¤ç‰Œï¼Œå½“æ¡¶é‡Œæ²¡æœ‰ä»¤ç‰Œå¯å–æ—¶ï¼Œåˆ™æ‹’ç»æœåŠ¡ã€‚ï¼ˆå¸¸ç”¨ï¼‰<br>\n3.æ¼æ¡¶ç®—æ³•ï¼Œæ°´ï¼ˆè¯·æ±‚ï¼‰å…ˆè¿›å…¥åˆ°æ¼æ¡¶é‡Œï¼Œæ¼æ¡¶ä»¥ä¸€å®šçš„é€Ÿåº¦å‡ºæ°´ï¼Œå½“æ°´æµå…¥é€Ÿåº¦è¿‡å¤§ä¼šç›´æ¥æº¢å‡ºï¼Œå¯ä»¥çœ‹å‡ºæ¼æ¡¶ç®—æ³•èƒ½å¼ºè¡Œé™åˆ¶æ•°æ®çš„ä¼ è¾“é€Ÿç‡ã€‚</p>\n<p>å¯¹äºå¾ˆå¤šåº”ç”¨åœºæ™¯æ¥è¯´ï¼Œé™¤äº†è¦æ±‚èƒ½å¤Ÿé™åˆ¶æ•°æ®çš„å¹³å‡ä¼ è¾“é€Ÿç‡å¤–ï¼Œè¿˜è¦æ±‚å…è®¸æŸç§ç¨‹åº¦çš„çªå‘ä¼ è¾“ã€‚è¿™æ—¶å€™æ¼æ¡¶ç®—æ³•å¯èƒ½å°±ä¸åˆé€‚äº†ï¼Œä»¤ç‰Œæ¡¶ç®—æ³•æ›´ä¸ºé€‚åˆã€‚</p>\n<p>é™æµåŠ›åº¦<br>\næ¥å£ç»´åº¦ï¼ˆé™åˆ¶controllerï¼‰<br>\næ€»ç»´åº¦ï¼ˆè®¡ç®—æœºèµ„æºé™åˆ¶ï¼‰</p>\n<p>é™æµèŒƒå›´<br>\né›†ç¾¤é™æµï¼šä¾èµ–redisæˆ–å…¶ä»–ä¸­é—´ä»¶æŠ€æœ¯åšç»Ÿä¸€è®¡æ•°å™¨ï¼Œå¾€å¾€ä¼šäº§ç”Ÿæ€§èƒ½ç“¶é¢ˆ<br>\nå•æœºé™æµï¼šè´Ÿè½½å‡è¡¡çš„å‰æä¸‹å•æœºå¹³å‡é™æµæ•ˆæœæ›´å¥½</p>\n<pre><code>&lt;dependency&gt;\n  &lt;groupId&gt;com.google.guava&lt;/groupId&gt;\n  &lt;artifactId&gt;guava&lt;/artifactId&gt;\n  &lt;version&gt;18.0&lt;/version&gt;\n&lt;/dependency&gt;\nprivate RateLimiter rateLimiter;\n\n@PostConstruct\npublic  void init(){\n    rateLimiter = RateLimiter.create(300);\n}\n\n    if(!rateLimiter.tryAcquire()){\n        throw new RuntimeException(\"xxx\");\n    }\n</code></pre>\n<h3>é˜²é»„ç‰›</h3>\n<p>æ’é˜Ÿï¼Œé™æµï¼Œä»¤ç‰Œå‡åªèƒ½æ§åˆ¶æ€»æµé‡ï¼Œæ— æ³•æ§åˆ¶é»„ç‰›æµé‡<br>\nä¼ ç»Ÿé˜²åˆ·<br>\né™åˆ¶ä¸€ä¸ªä¼šè¯(session_id,token)åŒä¸€ç§’é’Ÿ/åˆ†é’Ÿæ¥å£è°ƒç”¨å¤šå°‘æ¬¡-&gt;å¤šä¼šè¯æ¥å£ç»•å¼€æ— æ•ˆ<br>\né™åˆ¶ä¸€ä¸ªipåŒä¸€ç§’é’Ÿ/åˆ†é’Ÿ æ¥å£è°ƒç”¨å¤šå°‘æ¬¡ï¼Œæ•°é‡ä¸å¥½æ§åˆ¶-&gt;å®¹æ˜“è¯¯ä¼¤</p>\n<p>ä½¿ç”¨è®¾å¤‡æŒ‡çº¹é˜²åˆ·<br>\né‡‡é›†ç»ˆç«¯è®¾å¤‡å„é¡¹å‚æ•°ï¼Œå¯åŠ¨åº”ç”¨æ—¶ç”Ÿæˆå”¯ä¸€è®¾å¤‡æŒ‡çº¹<br>\næ ¹æ®å¯¹åº”è®¾å¤‡æŒ‡çº¹çš„å‚æ•°çŒœæµ‹å‡ºæ¨¡æ‹Ÿå™¨ç­‰å¯ç–‘è®¾å¤‡æ¦‚ç‡</p>\n<p>å‡­è¯ç³»ç»Ÿ<br>\næ ¹æ®è®¾å¤‡æŒ‡çº¹ä¸‹å‘å‡­è¯<br>\nå…³é”®ä¸šåŠ¡é“¾è·¯ä¸Šå¸¦ä¸Šå‡­è¯å¹¶ç”±ä¸šåŠ¡ç³»ç»Ÿåˆ°å‡­è¯æœåŠ¡å™¨ä¸ŠéªŒè¯<br>\nå‡­è¯æœåŠ¡å™¨æ ¹æ®å¯¹åº”å‡­è¯æ‰€ç­‰ä»·çš„è®¾å¤‡æŒ‡çº¹å‚æ•°å¹¶æ ¹æ®å®æ—¶è¡Œä¸ºé£æ§ç³»ç»Ÿåˆ¤å®šå¯¹åº”å‡­è¯çš„å¯ç–‘åˆ†æ•°<br>\nè‹¥åˆ†æ•°ä½äºæŸä¸ªæ•°å€¼åˆ™ä¸šåŠ¡ç³»ç»Ÿè¿”å›å›ºå®šé”™è¯¯ç ï¼Œæ‹‰èµ·å‰ç«¯éªŒè¯ç éªŒèº«ï¼ŒéªŒèº«æˆåŠŸååŠ å…¥å‡­è¯æœåŠ¡å™¨å¯¹åº”åˆ†æ•°</p>\n<p>H5æœ€éš¾é˜²</p>\n<h2>æ€§èƒ½æµ‹è¯•</h2>\n<h3>jemeterå‹æµ‹</h3>\n<ul>\n<li>çº¿ç¨‹ç»„ é«˜å¹¶å‘å‹æµ‹ -&gt;å‘é€httpè¯·æ±‚ -&gt;æŸ¥çœ‹ç»“æœæ ‘ -&gt;èšåˆæŠ¥å‘Š tps qps :</li>\n<li>æ–°å»ºæµ‹è¯•è®¡åˆ’\n<ul>\n<li>æ·»åŠ çº¿ç¨‹ç»„-&gt;çº¿ç¨‹æ•°-&gt;Ramp-upæ—¶é—´ï¼ˆå¤šå°‘ç§’å†…å¯åŠ¨æ‰€æœ‰çº¿ç¨‹ï¼‰-&gt;å¾ªç¯æ¬¡æ•°(æ¯ä¸ªçº¿ç¨‹è°ƒç”¨æ¥å£å‡ æ¬¡)\n<ul>\n<li>æ·»åŠ httpè¯·æ±‚-&gt;åç§°-&gt;åè®®-&gt;æœåŠ¡å™¨åç§°ip-&gt;è¯·æ±‚æ–¹æ³•-&gt;è·¯å¾„,åŒæ—¶é€‰æ‹©keep-aliveï¼Œå› ä¸ºè¦æµ‹çš„æ˜¯è¿”å›æ—¶é—´è€Œä¸æ˜¯è¿æ¥æ–­å¼€æˆ–è€…è¿æ¥çš„æ—¶é—´\n<ul>\n<li>é«˜çº§-&gt;å®¢æˆ·ç«¯å®ç°ä¸€å®šè¦é€‰java</li>\n</ul>\n</li>\n<li>æ·»åŠ å¯Ÿçœ‹ç»“æœæ ‘</li>\n<li>æ·»åŠ èšåˆæŠ¥è¡¨\n<ul>\n<li>Throughput (tps)æ¯ç§’èƒ½æ¥å—å¤šå°‘æµé‡</li>\n<li>Averageå¹³å‡å“åº”æ—¶é—´</li>\n<li>Medianä¸­ä½çº¿å“åº”æ—¶é—´</li>\n<li>90%Line 90%å“åº”æ—¶é—´å°äºå¤šå°‘æ¯«ç§’</li>\n<li>Minæœ€å°è¿”å›æ—¶é—´</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n</li>\n</ul>\n<h3>å‹æµ‹ä¼˜åŒ–</h3>\n<h3>åˆ†å¸ƒå¼ä¼šè¯ç®¡ç†</h3>\n<p>åˆ†å¸ƒå¼ä¼šè¯æŒä¹…æ€§ç®¡ç†-&gt;æ”¾redisï¼Œä¸€å®šè¦redisé«˜å¯ç”¨ï¼ˆredis clusterï¼‰<br>\nä¼šè¯æœ‰æ•ˆæœŸæ—¶é—´ï¼Œtomcaté»˜è®¤30åˆ†é’Ÿï¼Œä¸ä¸æœåŠ¡å™¨å‘ç”Ÿäº¤äº’çš„å‘†æ»æ—¶é—´<br>\nä¼šè¯ç»­å‘½ç®¡ç†ï¼Œè§¦å‘æ“ä½œå»¶é•¿ç”Ÿå‘½å‘¨æœŸï¼Œå»¶é•¿åˆ°30minï¼Œä¸æ˜¯åŠ 30min<br>\nå®‰å…¨æ€§é—®é¢˜ï¼Œç”¨å®‰å…¨ä¼ è¾“çš„httpsï¼Œä½†ä¹Ÿä¼šè¢«æµè§ˆå™¨æ•è·ï¼Œæœ€å®‰å…¨ä½¿ç”¨è‡ªå®šä¹‰åè®®å¹¶ä½¿ç”¨appæé«˜å®‰å…¨æ€§</p>\n<p>å¼ºç™»å½•æ€ä¸å¼±ç™»å½•æ€<br>\nå¼ºç™»å½•æ€ï¼š&gt;éœ€è¦ç™»å½•æ‰èƒ½æ“ä½œ<br>\næ— éœ€ç™»å½•<br>\nå¼±ç™»å½•æ€: &gt;åƒäººåƒé¢çš„æ™ºèƒ½æ¨èï¼Œç”µå•†ï¼Œç»­å‘½èƒ½åŠ›å¼±<br>\nå¼±ç™»å½•ç»­å‘½ï¼š&gt;1.è¯·æ±‚ç»­å‘½ï¼Œ2.é¡µé¢ä½¿ç”¨å®šæ—¶å™¨è¯·æ±‚ç»­å‘½ï¼ˆkeepaliveç»­å‘½ï¼‰</p>\n<p>ssoå•ç‚¹ç™»å½•<br>\nåªè¦åŸŸåä¸ä¸€æ ·æ—¶ï¼Œcookieå°±ä¸ä¸€æ ·</p>\n<ul>\n<li>åŒåŸŸåï¼š&gt;cookieä¸€æ ·ï¼Œ<a href=\"http://wwww.xxx.com/a/\" target=\"_blank\" rel=\"noopener noreferrer\">wwww.xxx.com/a/</a> <a href=\"http://wwww.xxx.com/b/\" target=\"_blank\" rel=\"noopener noreferrer\">wwww.xxx.com/b/</a></li>\n<li>æ ¹åŸŸåç›¸åŒï¼Œå­åŸŸåä¸åŒ <a href=\"http://wap.a.com\" target=\"_blank\" rel=\"noopener noreferrer\">wap.a.com</a> <a href=\"http://www.a.com\" target=\"_blank\" rel=\"noopener noreferrer\">www.a.com</a>\n<ul>\n<li>httpOnly = false/true(é™¤äº†æµè§ˆå™¨è‡ªèº«ï¼Œjsæ— æ³•è®¿é—®cookieid)</li>\n<li>domain =/  åªè¦è®¿é—®åŒä¸€ä¸ªä¸€çº§åŸŸåæ—¶cookieåŸŸåå°±ä¸€æ ·</li>\n</ul>\n</li>\n<li>åŸŸåéƒ½ä¸ç›¸åŒ <a href=\"http://a.com\" target=\"_blank\" rel=\"noopener noreferrer\">a.com</a> <a href=\"http://b.com\" target=\"_blank\" rel=\"noopener noreferrer\">b.com</a> é€šè¿‡ssoæœåŠ¡é…åˆredirectï¼Œé¢å‘cookieï¼Œç„¶åè¿”å›éœ€è¦è¯·æ±‚çš„æœåŠ¡ï¼ŒæœåŠ¡ç¼“å­˜èµ·æ¥ï¼Œåå†å»ssoæ ¡éªŒï¼ŒæˆåŠŸåå°±ç»§ç»­æœåŠ¡ï¼Œcookieé¢å‘åä¸€å®šè¦æœ‰æœ‰æ•ˆæœŸï¼Œæˆ–è€…å¼ºåˆ¶æ›´æ”¹æ‰‹æ®µï¼Œæ‰‹åŠ¨åˆ é™¤</li>\n</ul>\n<p>mysqlåº”ç”¨æ€§èƒ½ä¼˜åŒ–æ‹“å±•:&gt;ç¼“å­˜ï¼Œå¼‚æ­¥ï¼Œæ‰¹å¤„ç†<br>\nå†™æ“ä½œï¼šæ‰¹é‡insert æ‰¹é‡update æ‰¹é‡å†™ï¼Œsqlç¼–è¯‘Næ¬¡å’Œ1æ¬¡çš„æ—¶é—´ä¸ç©ºé—´å¤æ‚åº¦ï¼Œç½‘ç»œæ¶ˆè€—çš„æ—¶é—´å¤æ‚åº¦ ç£ç›˜å¯»å€çš„å¤æ‚åº¦<br>\nè¯»æ“ä½œï¼šç´¢å¼•<br>\nmysqlå•æœºé…ç½®æ€§èƒ½ä¼˜åŒ–æ‹“å±• æ‰§è¡Œsqlå‰å…ˆå†™undo/redoæ—¥å¿—é¡ºåºå†™ï¼Œå†™æ•°æ®åˆ™æ˜¯éšæœºè¯»å†™<br>\nmax_connection=1000é»˜è®¤100<br>\ninnodb_file_per_table=1,æ¯ä¸ªtableä¸€ä¸ªæ–‡ä»¶<br>\ninnodb_buffer_pool_size=1G å†™æ•°æ®ç¼“å†²åŒºå¤§å°ï¼Œè¶Šå¤§è¶Šå®¹æ˜“å‘½ä¸­bufferç¼“å­˜ï¼Œå†…å­˜60%-80%</p>\n<p>innodb_log_file_size=256M redo/undoæ—¥å¿—å¤§å°<br>\ninnodb_log_buffer_size=16M æ—¥å¿—æ»¡äº†åˆ‡æ¢çš„æ—¶å€™æ·»åŠ bufferç¼“å†²</p>\n<p>innodb_flush_log_at_trx_commit=2éœ€è¦æ”¾åœ¨ã€mysqlId_safeã€‘èŠ‚ç‚¹ä¸‹ï¼Œé»˜è®¤1ï¼Œäº‹åŠ¡æäº¤ç«‹é©¬åˆ·ç›˜</p>\n<p>innodb_data_file_path=ibdata1:1G;ibdata2:1G;ibdata3:1G;autoextend,æ•°æ®é‡å¤§æ—¶åˆ†åŒº</p>\n<p>ç§’æ€ç³»ç»Ÿæ‰£å‡åº“å­˜</p>\n<div class=\"language-c\" data-ext=\"c\" data-title=\"c\"><pre class=\"language-c\"><code><span class=\"token operator\">--</span> åº“å­˜æœªé¢„çƒ­\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>redis<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token char\">'exists'</span><span class=\"token punctuation\">,</span> KEYS<span class=\"token punctuation\">[</span><span class=\"token number\">2</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> then\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">9</span><span class=\"token punctuation\">;</span>\nend<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">--</span> ç§’æ€å•†å“åº“å­˜å­˜åœ¨\n<span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>redis<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token char\">'exists'</span><span class=\"token punctuation\">,</span> KEYS<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span> <span class=\"token operator\">==</span> <span class=\"token number\">1</span><span class=\"token punctuation\">)</span> then\n    local stock <span class=\"token operator\">=</span> <span class=\"token function\">tonumber</span><span class=\"token punctuation\">(</span>redis<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token char\">'get'</span><span class=\"token punctuation\">,</span> KEYS<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    local num <span class=\"token operator\">=</span> <span class=\"token function\">tonumber</span><span class=\"token punctuation\">(</span>ARGV<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">--</span> å‰©ä½™åº“å­˜å°‘äºè¯·æ±‚æ•°é‡\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>stock <span class=\"token operator\">&lt;</span> num<span class=\"token punctuation\">)</span> then\n        <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">3</span>\n    end<span class=\"token punctuation\">;</span>\n    <span class=\"token operator\">--</span> æ‰£å‡åº“å­˜\n    <span class=\"token keyword\">if</span> <span class=\"token punctuation\">(</span>stock <span class=\"token operator\">&gt;=</span> num<span class=\"token punctuation\">)</span> then\n        redis<span class=\"token punctuation\">.</span><span class=\"token function\">call</span><span class=\"token punctuation\">(</span><span class=\"token char\">'incrby'</span><span class=\"token punctuation\">,</span> KEYS<span class=\"token punctuation\">[</span><span class=\"token number\">1</span><span class=\"token punctuation\">]</span><span class=\"token punctuation\">,</span> <span class=\"token number\">0</span> <span class=\"token operator\">-</span> num<span class=\"token punctuation\">)</span><span class=\"token punctuation\">;</span>\n        <span class=\"token operator\">--</span> æ‰£å‡æˆåŠŸ\n        <span class=\"token keyword\">return</span> <span class=\"token number\">1</span>\n    end<span class=\"token punctuation\">;</span>\n    <span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">2</span><span class=\"token punctuation\">;</span>\nend<span class=\"token punctuation\">;</span>\n<span class=\"token operator\">--</span> ç§’æ€å•†å“åº“å­˜ä¸å­˜åœ¨\n<span class=\"token keyword\">return</span> <span class=\"token operator\">-</span><span class=\"token number\">1</span><span class=\"token punctuation\">;</span>\n</code></pre></div>",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "æ¶æ„è®¾è®¡"
      ]
    },
    {
      "title": "é”™è¯¯è§£å†³",
      "url": "https://javaguide.cn/backend/systemdesign/%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3.html",
      "id": "https://javaguide.cn/backend/systemdesign/%E9%94%99%E8%AF%AF%E8%A7%A3%E5%86%B3.html",
      "summary": "å¸¸è§é”™è¯¯è§£å†³ å¸¸è§æŠ¥é”™è§£å†³ Spring æ•´åˆJunit4æµ‹è¯•ï¼š Junit4 jsä½¿ç”¨æ—¶ä¸€å®šè¦æ³¨æ„æ¯å¥åé¢åŠ åˆ†å· mavené”™è¯¯ Mavené¡¹ç›®å¯åŠ¨çš„æ—¶å€™ä¸€å®šè¦è®¾ç½®å¥½tomcat7çš„ç‰ˆæœ¬ï¼Œæ³¨æ„ç«¯å£å ç”¨é—®é¢˜ Mavené”™è¯¯ mavenæŠ¥é”™1.PNGmavenæŠ¥é”™1.PNG æ°¸ä¹…å»é™¤jspæŠ¥é”™ springæŠ¥é”™ struts2 Hibernate:Nam...",
      "content_html": "<p>å¸¸è§é”™è¯¯è§£å†³</p>\n<!--more-->\n<h1>å¸¸è§æŠ¥é”™è§£å†³</h1>\n<h2>Spring æ•´åˆJunit4æµ‹è¯•ï¼š</h2>\n<pre><code>log4j:WARN No appenders could be found for logger \n\t(org.springframework.test.context.junit4.SpringJUnit4ClassRunner).\n\tlog4j:WARN Please initialize the log4j system properly.\n\tè§£å†³åŠæ³•ï¼šåœ¨srcä¸‹å»ºæ–°çš„fileåä¸ºlog4j.properties\n\tç„¶åå…¶å†…å¦‚ä¸‹\n\tlog4j.rootLogger=WARN, stdout\n\tlog4j.appender.stdout=org.apache.log4j.ConsoleAppender\n\tlog4j.appender.stdout.layout=org.apache.log4j.PatternLayout\n\tlog4j.appender.stdout.layout.ConversionPattern=%d %p [%c] - %m%n\n</code></pre>\n<h2>Junit4</h2>\n<pre><code>initilizationError[Runner:JUnit4](0.00)è¡¨ç¤ºå¯èƒ½è¯¥æ–¹æ³•æ²¡åŠ @Test\n</code></pre>\n<h2>jsä½¿ç”¨æ—¶ä¸€å®šè¦æ³¨æ„æ¯å¥åé¢åŠ åˆ†å·</h2>\n<pre><code>jspé¡µé¢æ•°æ®ä¼ é€’â‘ hiddenâ‘¡ï¼Ÿå‚æ•°å=å€¼\n</code></pre>\n<h2>mavené”™è¯¯</h2>\n<pre><code>Batch update returned unexpected row count from update [0]; actual row count: 0;\n\tBatch update returned unexpected row count from update [0]; actual row count: 0; \n\texpected: 1\n\tè¿™ä¸ªå¼‚å¸¸æ˜¯ç”±äºä¸»é”®è®¾ç½®ä¸ºè‡ªå¢é•¿/uuidï¼Œè€Œåœ¨æˆ‘ä»¬æ’å…¥è®°å½•çš„æ—¶å€™è®¾ç½®äº†IDçš„å€¼å¯¼è‡´çš„\n</code></pre>\n<h2>Mavené¡¹ç›®å¯åŠ¨çš„æ—¶å€™ä¸€å®šè¦è®¾ç½®å¥½tomcat7çš„ç‰ˆæœ¬ï¼Œæ³¨æ„ç«¯å£å ç”¨é—®é¢˜</h2>\n<pre><code>&lt;plugin&gt;\n\t&lt;groupId&gt;org.apache.tomcat.maven&lt;/groupId&gt;\n\t&lt;artifactId&gt;tomcat7-maven-plugin&lt;/artifactId&gt;\n\t&lt;version&gt;2.2&lt;/version&gt;\n\t&lt;configuration&gt;\n\t&lt;!-- å¯ä»¥çµæ´»é…ç½®å·¥ç¨‹è·¯å¾„ --&gt;\n\t&lt;path&gt;/ssh&lt;/path&gt;\n\t&lt;!-- å¯ä»¥çµæ´»é…ç½®ç«¯å£å· --&gt;\n\t&lt;port&gt;8080&lt;/port&gt;\n\t&lt;/configuration&gt;\n\t&lt;/plugin&gt;\n</code></pre>\n<h2>Mavené”™è¯¯</h2>\n<pre><code>[ERROR] No compiler is provided in this environment. \n\tPerhaps you are running on a JRE rather than a JDK?\n\tå¯¹äºJavaå¼€å‘è€…æ¥è¯´, Installed JREsä¸­ä½¿ç”¨jdkç›®å½•\n\tè€Œä¸é€‚ç”¨jreç›®å½•ä¹Ÿæ˜¯æœ€å¥½çš„é€‰æ‹©. æŒ‰ä¸‹å›¾é…ç½®\n</code></pre>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/0bf9fbde3ee68241766f7.png\" alt=\"mavenæŠ¥é”™1.PNG\" tabindex=\"0\"><figcaption>mavenæŠ¥é”™1.PNG</figcaption></figure>\n<h2>æ°¸ä¹…å»é™¤jspæŠ¥é”™</h2>\n<pre><code>https://jingyan.baidu.com/article/7f766dafbb5cf34101e1d0d8.html\n</code></pre>\n<h2>springæŠ¥é”™</h2>\n<pre><code>æ³¨æ„å•ç‹¬é…ç½®åspringmvcæ”¹äº†urlåé¢é‡æ–°å¯åŠ¨é¡¹ç›®ä¸ä¼šæ›´æ–°é…ç½®ï¼Œ\n\tä¸€å®šè¦clean\n\tSpringmvcçš„ serviceç»è¿‡æ‰«æåæ— æ³•xmlé…è§£æ³¨å…¥daoæ¥å£å®ç°ç±»ï¼Œ\n\téœ€è¦ç”¨@Resourceï¼ˆname=â€xxxâ€ï¼‰æ¥æ³¨å…¥ï¼Œæ˜¯å› ä¸ºspringmvcé…ç½®ä¸ºå­å®¹å™¨ï¼Œ\n\tè€Œspringæœ¬èº«æ˜¯çˆ¶å®¹å™¨ï¼Œä¸”å­èƒ½è®¿é—®çˆ¶ï¼Œçˆ¶ä¸èƒ½è®¿é—®å­ï¼Œ\n\tæ•…ç”±äºspringmvcåœ¨è¯·æ±‚åˆ°æ¥çš„æ—¶å€™æ‰«æäº†controllerä½œä¸ºbeanï¼Œå³ä½¿æ²¡æ³¨è§£daoå±æ€§ï¼Œ\n\tä½†æ˜¯å·²ç»å°†æ•´ä¸ªè¯¥ç±»æ³¨å†Œæˆbeanï¼Œæ•…ä¹‹åçš„spring\n\tçˆ¶å®¹å™¨å†æ³¨å†Œä¹Ÿä¸èƒ½å†æ³¨å…¥daoè¿›å»äº†\n\n\tæ˜¯å› ä¸ºï¼Œç³»ç»Ÿé¦–å…ˆåŠ è½½springçˆ¶å®¹å™¨ï¼ˆapplicationã€‚Xmlæ–‡ä»¶ï¼‰\n\tç¬¬ä¸€æ¬¡æ³¨å†Œäº†serviceæ•´ä¸ªæ³¨è§£ï¼ˆåŒ…æ‹¬ä¾èµ–çš„daoæ¥å£ï¼‰ï¼Œç„¶è€Œè·Ÿspringmvcæ— å…³ï¼Œ\n\tç›¸å½“äºæ²¡æ³¨å†Œè¿›å»springmvcå®¹å™¨ã€‚\n\tç„¶åå†åŠ è½½springmvcæ–‡ä»¶ï¼Œå½“åŠ è½½åˆ°daoæ¥å£å±æ€§çš„æ—¶å€™ï¼Œ\n\tç”±äºspringmvcçš„æ‰«ææ‰«æbeançš„æ—¶å€™è¯¥æ¥å£å±æ€§æ²¡é…ç½®æ³¨è§£ï¼Œå¯¼è‡´æ²¡æ³¨å…¥daoæ¥å£ï¼ŒæŠ¥ç©ºæŒ‡é’ˆé”™è¯¯ã€‚\n\tâ‘ å¦‚æœåœ¨springmvcé‡Œé¢å†ç”¨xmlæ³¨è§£è¡¥å……daoçš„æ³¨å…¥çš„è¯ï¼Œä¼šæŠ¥\n\tThere is already handler of type [class com.junye.service.ItemsServiceImpl] \n\tmapped.é”™è¯¯ï¼Œ\n\tâ‘¡å³ä½¿æ³¨è§£å’Œxmlé…ç½®è°ƒè½¬äº†éƒ½ä¸è¡Œï¼Œä»ç„¶æŠ¥åŒæ ·çš„é”™è¯¯\n\tï¼ˆè§£é‡Šï¼šæ˜¯å› ä¸ºç³»ç»Ÿä¼˜å…ˆåŠ è½½xmlé…ç½®ï¼Œç„¶åå†åŠ è½½æ³¨è§£é…ç½®ï¼‰\n\tâ‘¢å•ç‹¬xmlé…ç½®ï¼ˆå»æ‰åŒ…æ‰«æï¼‰å®Œå…¨æ²¡é—®é¢˜ï¼Œè¯´æ˜springmvcä¸èƒ½åŒæ—¶ç”¨æ³¨è§£é…ç½®å’Œxmlé…ç½®\n\tâ‘£è€Œå¯¹äºspringæœ¬èº«æ¥è¯´å´å¯ä»¥é‡å¤é…ç½®ä¸€æ ·çš„beanè¿›å»å®¹å™¨ï¼Œä½†ä»¥xmlçš„é…ç½®ä¸ºå‡†\n\n\tè¡¥å……ï¼Œå­å®¹å™¨èƒ½è®¿é—®çˆ¶å®¹å™¨çš„å†…å®¹ï¼Œä½†æ˜¯çˆ¶å®¹å™¨ä¸èƒ½è®¿é—®å­å®¹å™¨çš„å†…å®¹\n\tç»“è®ºï¼šspringmvcå¼€å¯æ‰«æåŒ…æ‰«æbeançš„æ—¶å€™ã€‚é‡Œé¢å¿…é¡»éƒ½æ³¨è§£æ³¨å…¥ï¼Œ\n\tä¸è¦éƒ¨åˆ†å±æ€§xmlé…ç½®ã€éƒ¨åˆ†æ³¨è§£ï¼Œspringmvcä¸å…è®¸ç”¨æ³¨è§£é…ç½®å’Œxmlæ³¨å†ŒåŒä¸€ä¸ªbeanï¼Œ\n\tè€Œspringæœ¬èº«å´å¯ä»¥ï¼Œä»¥xmlä¸ºå‡†\n\n\tapplicationContexté‡Œé¢å·²ç»å£°æ˜äº† serviceçš„å¯¹è±¡beanï¼Œ\n\tåˆæ‰«æserviceç±»çš„ä¸Šé¢æ³¨è§£@Componentå£°æ˜ä¸ºbeanï¼Œ\n\té‡å¤å¯¼è‡´springå®¹å™¨ä¸èƒ½åˆ¤æ–­Serviceçš„æˆå‘˜è£…é…å“ªä¸ªå¯¹è±¡ã€‚\n\n\tXmlé…ç½®ä¼˜å…ˆäºæ³¨è§£é…ç½®ï¼ŒåŠ è½½é¡ºåºlistenerã€‹filterã€‹servletï¼Œ\n\tè€Œspringé…ç½®æ–‡ä»¶å…ˆåŠ è½½ï¼ŒååŠ è½½springmvcçš„é…ç½®æ–‡ä»¶ã€‚\n\n\tSpringmvcä½¿ç”¨å¿…é¡»ç”¨è‡ªå·±çš„springmvcæ‰«æåˆ°controlleræ³¨è§£çš„beanï¼Œ\n\tè‹¥æ˜¯springæ‰«çš„è¯æ²¡ç”¨ï¼Œ404\n</code></pre>\n<h2>struts2</h2>\n<pre><code>æ³¨æ„strutsæ•´åˆspringæ—¶actionå¿…é¡»è®¾ç½®scope=â€prototypeâ€\n\tåˆ¤æ–­æ˜¯ä¸æ˜¯ä¸ºtrueï¼Œç›´æ¥&lt;s:if test=\"#parameters.select\"&gt;ï¼Œ\n\tä¸è¦&lt;s:if test=\"#parameters.select==true\"&gt;\n</code></pre>\n<h2>Hibernate:Named query not knownå¼‚å¸¸çš„ä¸€ç§è§£å†³æ–¹æ¡ˆ</h2>\n<pre><code>è¯·æ³¨æ„æ ‡ç­¾&lt;query&gt;è¦å®šä¹‰åœ¨&lt;class&gt;ä¹‹å¤–&lt;hibernate-mapping&gt;ä¹‹å†…\n\tå¦‚æœå®šä¹‰åœ¨&lt;class&gt;ä¹‹å†…ï¼Œå°±æœ‰å¯èƒ½æŠ¥è¿™ä¸ªé”™è¯¯\n\t&lt;/class&gt;\n\t********************************************\n\t******************æ³¨æ„&lt;query&gt;æ ‡ç­¾ä½ç½®*******\n\t**********************************************\n\t&lt;query name=\"getTeacherNotInClasses\"&gt;SQLè¯­å¥&lt;/query&gt;\n\t&lt;query name=\"getClassesByTitle\"&gt;sqlè¯­å¥&lt;/query&gt;\n\t&lt;/hibernate-mapping&gt;\n</code></pre>\n<p>1ã€å­˜å‚¨jsonç”¨blobç±»å‹<br>\næ´»åŠ¨ä»‹ç»[{\"type\":\"image\",\"content\":\"<a href=\"https://bzstatic.udinovo.com/tmp_34a994ba8130b1cec3431b941a6af9f5.jpg%22%7D,%7B%22type%22:%22image%22,%22content%22:%22https://bzstatic.udinovo.com/tmp_bbd3892eba215a1d247aadef19a0f764.jpg%22%7D,%7B%22type%22:%22image%22,%22content%22:%22https://bzstatic.udinovo.com/tmp_5c72371caeb39b1ae705527c49fbeacb.gif\" target=\"_blank\" rel=\"noopener noreferrer\">https://bzstatic.udinovo.com/tmp_34a994ba8130b1cec3431b941a6af9f5.jpg\"},{\"type\":\"image\",\"content\":\"https://bzstatic.udinovo.com/tmp_bbd3892eba215a1d247aadef19a0f764.jpg\"},{\"type\":\"image\",\"content\":\"https://bzstatic.udinovo.com/tmp_5c72371caeb39b1ae705527c49fbeacb.gif</a>\"}]<br>\n2ã€åªè¦ç”¨æˆ·ç™»å…¥ç³»ç»Ÿï¼Œä¸€èˆ¬å°±è®°å½•ä¸€ä¸ªæ¸¸å®¢è®°å½•åˆ°userè¡¨ï¼Œä»¥ctype å®¢æˆ·èº«ä»½. 0:æ¸¸å®¢;1:æˆæƒç”¨æˆ·;2:å“ç‰Œç”¨æˆ·æ ‡å¿—ä¸€ä¸‹<br>\n3.ã€å­˜å‚¨è‡ªå®šä¹‰åˆ—è¡¨å¯ä»¥ç”¨,;,;<br>\n4ã€è·å–é•¿åº¦åˆ¤æ–­char_length(an.comment)&lt;=?<br>\n5ã€æœåŠ¡å™¨ä¸é‡ç”¨tcpè§£å†³æ–¹æ¡ˆ<a href=\"https://www.cnblogs.com/aoxueshou/p/13546814.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.cnblogs.com/aoxueshou/p/13546814.html</a><br>\n7ã€join onå¯ä»¥åŠ and oræ¡ä»¶<br>\n8ã€esxistç”¨äºåˆ¤æ–­æœ‰äººæŠ¥åçš„æ˜¾ç¤º<br>\n9ã€minï¼ˆdeleteï¼‰åˆ¤æ–­æ˜¯å¦æŠ¥è¿‡åbanzhu_action_bao<br>\n10\\gradlew build --refresh-dependencies<br>\n11ã€<br>\n12ã€order by xxx!=xxx<br>\n13ã€group by å·§ç”¨maxå’Œminç­›é€‰åŒ¹é…é¡¹max(if xxxx= xx,1,0)<br>\n14ã€æ•°æ®åº“ä¸­è®¡ç®—2ç‚¹çš„è·ç¦»,ifnull(st_distance(point(c.lat,c.lng),point(#{pagination.lat},#{pagination.lng})) * 111195,0) as pointdistanceå•ä½m  <a href=\"https://blog.csdn.net/worilb/article/details/124976921\" target=\"_blank\" rel=\"noopener noreferrer\">https://blog.csdn.net/worilb/article/details/124976921</a><br>\nlatæ˜¯çº¬åº¦lngæ˜¯ç»åº¦<br>\nthis AnnotationConfigServletWebServerApplicationContext<br>\nspring refresh(){<br>\nprepareRefresh-&gt;<br>\n{<br>\ninitPropertySourcesStandardServletEnvironment<br>\nearlyApplicationListeners<br>\nearlyApplicationEvents<br>\n}<br>\n}<br>\n15.æ’åºä¸åŒ…æ‹¬åŒå<br>\nrank() over (order by)<br>\nCreating sort index</p>\n<p>Your authorization verification fails, you can still continue to use the system for 5 minutes, and the system will automatically stop after 5 minutes</p>\n<p>17 ä¸€ä¸ªå­—æ®µæ˜¯å¦ä¸ºnullä¸šåŠ¡å¯ä»¥åˆ¤æ–­æ˜¯å¦å·²ç»åè¿‡ä»€ä¹ˆï¼Œå¦‚æœå­—æ®µä¸ºæ›´æ–°æ—¶é—´ï¼Œé‚£ä¹ˆå°±å¯ä»¥ä¸€ä¸ªå­—æ®µåŒæ—¶æ»¡è¶³æ˜¯å¦æ›´æ–°å’Œä»€ä¹ˆæ—¶å€™æ›´æ–°ä¸¤ä¸ªä¸šåŠ¡</p>\n<p>é›ªç‹¼æ¡†æ¶çš„åˆ†é…åˆ†å¸ƒå¼å”¯ä¸€idå¯èƒ½ä¼šå› ä¸ºå·²ç»å­˜åœ¨ç±»ä¼¼çš„idè€Œå¯¼è‡´å †æ ˆæº¢å‡º</p>\n<p>ä¸ƒç‰›äº‘æµ‹è¯•è§†é¢‘<a href=\"https://bzstatic.udinovo.com/2313.mp4\" target=\"_blank\" rel=\"noopener noreferrer\">https://bzstatic.udinovo.com/2313.mp4</a></p>\n<p>18 è‡ªå®šä¹‰è´¹ç”¨<br>\nxxx:xx;xxx,xx;</p>\n<p>SELECT s.*,u.nick,u.gender,u.avatar,t.mode<br>\nFROM banzhu_sport s inner join banzhu_user u on u.uid = s.uid</p>\n<pre><code>    WHERE s.uid IN (select fs.uid from banzhu_user_focus fs\n    inner join banzhu_user u on fs.uid = u.uid where fs.focusUid = #{pagination.uid} and fs.uid in (select focusUid from banzhu_user_focus where uid = #{pagination.uid})\n    and fs.uid != #{pagination.uid}\n    &lt;if test=\"pagination.keywords\"&gt;\n        and u.nick like \"%\"#{pagination.keywords}\"%\"\n    &lt;/if&gt;\n    and u.uid != #{pagination.uid} )\n    AND s.typeId = #{pagination.map.typeId} AND s.seconds = #{pagination.map.seconds}\n    AND NOT EXISTS (SELECT 1 FROM banzhu_sport WHERE uid = s.uid AND typeId = s.typeId AND seconds = s.seconds AND sportCnt &gt; s.sportCnt)\n    group by s.uid\n</code></pre>\n<p>select abc.*,IFNULL(max(s.sportCnt),0) as sportCnt,<a href=\"http://s.id\" target=\"_blank\" rel=\"noopener noreferrer\">s.id</a>,st.mode,s.round,s.createTime,t.mode<br>\nfrom<br>\n(select fs.uid,u.nick,u.gender,u.avatar from banzhu_user_focus fs<br>\ninner join banzhu_user u on fs.uid = u.uid where fs.focusUid = #{pagination.uid} and fs.uid in (select focusUid from banzhu_user_focus where uid = #{pagination.uid})<br>\nand fs.uid != #{pagination.uid}<br>\nand u.uid != #{pagination.uid} ) abc left join banzhu_sport s on s.uid = abc.uid and s.seconds = #{pagination.map.seconds} and s.typeId = #{pagination.map.typeId}<br>\nleft join banzhu_sport_team st on <a href=\"http://st.id\" target=\"_blank\" rel=\"noopener noreferrer\">st.id</a> = s.teamId<br>\ngroup by abc.uid<br>\nmysqlsysdate()ä¸èµ°ç´¢å¼•</p>\n<p>sseå®¢æˆ·ç«¯è§£æä»£ç <br>\næ€ä¹ˆæ¥æ”¶httpè¯·æ±‚response çš„content-type=text/event-stream<br>\nboolean processNextEvent() throws IOException {<br>\nString id = this.lastId;<br>\nString type = null;<br>\nBuffer data = new Buffer();</p>\n<pre><code>    while(true) {\n        long lineEnd = this.source.indexOfElement(CRLF);\n        if (lineEnd == -1L) {\n            return false;\n        }\n\n        switch(this.source.getBuffer().getByte(0L)) {\n        case 10:\n        case 13:\n            this.completeEvent(id, type, data);\n            return true;\n        case 100:\n            if (this.isKey(DATA)) {\n                this.parseData(data, lineEnd);\n                continue;\n            }\n            break;\n        case 101:\n            if (this.isKey(EVENT)) {\n                type = this.parseEvent(lineEnd);\n                continue;\n            }\n            break;\n        case 105:\n            if (this.isKey(ID)) {\n                id = this.parseId(lineEnd);\n                continue;\n            }\n            break;\n        case 114:\n            if (this.isKey(RETRY)) {\n                this.parseRetry(lineEnd);\n                continue;\n            }\n        }\n\n        this.source.skip(lineEnd);\n        this.skipCrAndOrLf();\n    }\n}\n</code></pre>\n<p>update xxx set xxx-1 where xxx&gt;0 and id = ?</p>\n<p>è¡¨è®¾è®¡å¯ä»¥ä½¿ç”¨action_xxxæ¥å³å¯ç”¨åˆ°actionå‰ç¼€ç´¢å¼•ï¼Œåˆèƒ½ç”¨åˆ°action_xxxç´¢å¼•ï¼Œè¿˜èƒ½åˆ†actionç±»å’Œaction_xxxå°ç±»</p>\n<p>dockeræ—¥å¿—æ”¶é›†<br>\n<a href=\"https://www.coder4.com/homs_online/ch01-architecture/micro-service-intro.html\" target=\"_blank\" rel=\"noopener noreferrer\">https://www.coder4.com/homs_online/ch01-architecture/micro-service-intro.html</a></p>\n<p>redisé›†ç¾¤æŒä¹…åŒ–<br>\n<a href=\"https://help.aliyun.com/document_detail/90529.html?spm=a2c4g.11186623.6.569.1408519e9VE04k\" target=\"_blank\" rel=\"noopener noreferrer\">https://help.aliyun.com/document_detail/90529.html?spm=a2c4g.11186623.6.569.1408519e9VE04k</a></p>\n<p>ç›®å‰è¦ä¹ˆelk efk æˆ–è€…fk-elk</p>\n<p>ps -ef |grep java |grep -w testbanzhu.jar|grep -v 'grep'|awk '{print $2}'| xargs -i{} kill -9 {}<br>\nsleep 1 &amp;&amp; nohup java -server -jar testbanzhu.jar --server.port=8888 &amp;</p>\n",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/0bf9fbde3ee68241766f7.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "springmvc",
      "url": "https://javaguide.cn/backend/webframework/springmvc.html",
      "id": "https://javaguide.cn/backend/webframework/springmvc.html",
      "summary": "springmvc 2. Springmvcæ¦‚è¿° 3. springmvcä¸struts2ä¸åŒ 5. springmvcå…¥é—¨ 6. springmvc é…ç½® 7. Handleré…ç½® 8. å¼‚å¸¸å¤„ç†å™¨ 9. ssmæ•´åˆæ€è·¯ 10. ä¸Šä¼ å›¾ç‰‡ 11. RESTfulæ”¯æŒ 12. æ‹¦æˆªå™¨ 2. Springmvcæ¦‚è¿° Spring web mvcå’ŒStru...",
      "content_html": "<p>springmvc</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#2-springmvc%E6%A6%82%E8%BF%B0\">2. Springmvcæ¦‚è¿°</a></li>\n<li><a href=\"#3-springmvc%E4%B8%8Estruts2%E4%B8%8D%E5%90%8C\">3. springmvcä¸struts2ä¸åŒ</a></li>\n<li><a href=\"#5-springmvc%E5%85%A5%E9%97%A8\">5. springmvcå…¥é—¨</a></li>\n<li><a href=\"#6-springmvc-%E9%85%8D%E7%BD%AE\">6. springmvc é…ç½®</a></li>\n<li><a href=\"#7-handler%E9%85%8D%E7%BD%AE\">7. Handleré…ç½®</a></li>\n<li><a href=\"#8-%E5%BC%82%E5%B8%B8%E5%A4%84%E7%90%86%E5%99%A8\">8. å¼‚å¸¸å¤„ç†å™¨</a></li>\n<li><a href=\"#9-ssm%E6%95%B4%E5%90%88%E6%80%9D%E8%B7%AF\">9. ssmæ•´åˆæ€è·¯</a></li>\n<li><a href=\"#10-%E4%B8%8A%E4%BC%A0%E5%9B%BE%E7%89%87\">10. ä¸Šä¼ å›¾ç‰‡</a></li>\n<li><a href=\"#11-restful%E6%94%AF%E6%8C%81\">11. RESTfulæ”¯æŒ</a></li>\n<li><a href=\"#12-%E6%8B%A6%E6%88%AA%E5%99%A8\">12. æ‹¦æˆªå™¨</a></li>\n</ul>\n<!-- /TOC -->\n<h1>2. Springmvcæ¦‚è¿°</h1>\n<ul>\n<li>Spring web mvcå’ŒStruts2éƒ½å±äºè¡¨ç°å±‚çš„æ¡†æ¶,å®ƒæ˜¯Springæ¡†æ¶çš„ä¸€éƒ¨åˆ†<br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/be7cbdbe994b2221f35c0.png\" alt=\"springmvc.png\"></li>\n</ul>\n<h1>3. springmvcä¸struts2ä¸åŒ</h1>\n<ul>\n<li>springmvcçš„å…¥å£æ˜¯ä¸€ä¸ªservletå³å‰ç«¯æ§åˆ¶å™¨ï¼Œè€Œstruts2å…¥å£æ˜¯ä¸€ä¸ªfilterè¿‡æ»¤å™¨ã€‚</li>\n<li>springmvcæ˜¯åŸºäºæ–¹æ³•å¼€å‘(ä¸€ä¸ªurlå¯¹åº”ä¸€ä¸ªæ–¹æ³•)ï¼Œè¯·æ±‚å‚æ•°ä¼ é€’åˆ°æ–¹æ³•çš„å½¢å‚ï¼Œstruts2æ˜¯åŸºäºç±»å¼€å‘ï¼Œä¼ é€’å‚æ•°æ˜¯é€šè¿‡ç±»çš„å±æ€§</li>\n<li>Strutsé‡‡ç”¨å€¼æ ˆå­˜å‚¨è¯·æ±‚å’Œå“åº”çš„æ•°æ®ï¼Œé€šè¿‡OGNLå­˜å–æ•°æ®ï¼Œ springmvcé€šè¿‡å‚æ•°è§£æå™¨æ˜¯å°†requestè¯·æ±‚å†…å®¹è§£æï¼Œå¹¶ç»™æ–¹æ³•å½¢å‚èµ‹å€¼ï¼Œ</li>\n</ul>\n<h1>5. springmvcå…¥é—¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tåˆ›å»ºåŠ¨æ€webå·¥ç¨‹(2.5)\n\tå¯¼å…¥jaråŒ…\n\tcommons-logging-1.1.1.jar\n\tjstl-1.2.jar\n\tspring-aop-4.1.3.RELEASE.jar\n\tspring-aspects-4.1.3.RELEASE.jar\n\tspring-beans-4.1.3.RELEASE.jar\n\tspring-context-4.1.3.RELEASE.jar\n\tspring-context-support-4.1.3.RELEASE.jar\n\tspring-core-4.1.3.RELEASE.jar\n\tspring-expression-4.1.3.RELEASE.jar\n\tspring-jdbc-4.1.3.RELEASE.jar\n\tspring-jms-4.1.3.RELEASE.jar\n\tspring-messaging-4.1.3.RELEASE.jar\n\tspring-tx-4.1.3.RELEASE.jar\n\tspring-web-4.1.3.RELEASE.jar\n\tspring-webmvc-4.1.3.RELEASE.jar\n\n\tåœ¨srcä¸‹åˆ›å»ºspringmvc.xml\n\tå¯¼å…¥æ‰€æœ‰çº¦æŸæ–‡ä»¶aopã€beansã€contextã€mvcã€toolã€txã€util\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\t&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" \n\txmlns:p=\"http://www.springframework.org/schema/p\"\n\txmlns:context=\"http://www.springframework.org/schema/context\"\n\txmlns:mvc=\"http://www.springframework.org/schema/mvc\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd\n\thttp://www.springframework.org/schema/mvc \n\thttp://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd\n\thttp://www.springframework.org/schema/context \n\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd\"&gt;\n\t\t&lt;!--é…ç½®æ‰«ææ³¨è§£ é…ç½®controlleræ‰«æåŒ… --&gt;\n\t\t&lt;context:component-scan base-package=\"cn.itcast.springmvc.controller\"/&gt;\n\t&lt;/beans&gt;\n\t\t\n\tåœ¨web.xmlä¸­é…ç½®SpringMVCçš„å‰ç«¯æ§åˆ¶å™¨DispatcherServlet\n\t&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n\t\t&lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\t\txmlns=\"http://java.sun.com/xml/ns/javaee\"\n\t\txsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee \n\t\thttp://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\n\t\tid=\"WebApp_ID\" version=\"2.5\"&gt;\n\t\t&lt;display-name&gt;springmvc-first&lt;/display-name&gt;\n\t\t&lt;welcome-file-list&gt;\n\t\t\t&lt;welcome-file&gt;index.html&lt;/welcome-file&gt;\n\t\t&lt;/welcome-file-list&gt;\n\n\t\t&lt;!-- é…ç½®SpringMVCå‰ç«¯æ§åˆ¶å™¨ --&gt;\n\t\t&lt;servlet&gt;\n\t\t\t&lt;servlet-name&gt;springmvc-first&lt;/servlet-name&gt;\n\t\t\t&lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet\n\t\t&lt;/servlet-class&gt;\n\t\t\t&lt;!-- æŒ‡å®šSpringMVCé…ç½®æ–‡ä»¶ --&gt;\n\t\t\t&lt;!-- SpringMVCçš„é…ç½®æ–‡ä»¶çš„é»˜è®¤è·¯å¾„æ˜¯\n\t\t\t/WEB-INF/${servlet-name}-servlet.xml --&gt;\n\t\t\t&lt;init-param&gt;\n\t\t\t\t&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n\t\t\t\t&lt;param-value&gt;classpath:springmvc.xml&lt;/param-value&gt;\n\t\t\t&lt;/init-param&gt;\n\t\t&lt;/servlet&gt;\n\n\t\t&lt;servlet-mapping&gt;\n\t\t\t&lt;servlet-name&gt;springmvc-first&lt;/servlet-name&gt;\n\t\t\t\t&lt;!-- è®¾ç½®æ‰€æœ‰ä»¥actionç»“å°¾çš„è¯·æ±‚è¿›å…¥SpringMVC --&gt;\n\t\t\t\t&lt;url-pattern&gt;*.action&lt;/url-pattern&gt;\n\t\t\t&lt;/servlet-mapping&gt;\n\t\t&lt;/web-app&gt;\n\t\tåœ¨web.Xmlä¸­ç”¨dispathcherservletç„¶åAlt+/æç¤ºç„¶åé…ç½®ä¸€ä¸‹å°±è¡Œ\n\t\n\tåŠ å…¥jspé¡µé¢\n\tæŠŠitemList.jspæ”¾åˆ°/WEB-INF/jspç›®å½•\n\t&lt;c:forEach items=\"${itemList }\" var=\"item\"&gt;\n\t\t&lt;tr&gt;\n\t\t\t&lt;td&gt;${item.name }&lt;/td&gt;\n\t\t\t&lt;td&gt;${item.price }&lt;/td&gt;\n\t\t\t&lt;td&gt;&lt;fmt:formatDate value=\"${item.createtime}\" pattern=\"yyyy-MM-dd HH:mm:ss\"/&gt;&lt;/td&gt;\n\t\t\t&lt;td&gt;${item.detail }&lt;/td&gt;\n\t\t\t&lt;td&gt;\n\t\t\t\t&lt;a href=\"${pageContext.request.contextPath}/itemEdit.action?id=${item.id}\"&gt;ä¿®æ”¹&lt;/a&gt;\n\t\t\t&lt;/td&gt;\n\t\t&lt;/tr&gt;\n\t&lt;/c:forEach&gt;\n\n\tåˆ›å»ºpojo\n\tpublic class Item {\n\t\tprivate int id;\n\t\tprivate String name;\n\t\tprivate double price;\n\t\tprivate Date createtime;\n\t\tprivate String detail;\n\t\tåˆ›å»ºå¸¦å‚æ•°çš„æ„é€ å™¨\n\t\tset/getã€‚ã€‚ã€‚\n\t\t}\n\n\tåˆ›å»ºItemControllerç±»ï¼Œä¸éœ€è¦å®ç°ä»»ä½•æ¥å£ã€‚\n\tåœ¨ç±»ä¸Šæ·»åŠ @Controlleræ³¨è§£ï¼ŒæŠŠControlleräº¤ç”±Springç®¡ç†\n\t\tåœ¨æ–¹æ³•ä¸Šé¢æ·»åŠ @RequestMappingæ³¨è§£ï¼Œé‡Œé¢æŒ‡å®šè¯·æ±‚çš„urlã€‚\n\t\tå…¶ä¸­â€œ.actionâ€å¯ä»¥åŠ ä¹Ÿå¯ä»¥ä¸åŠ ã€‚\n\t\t@Controller\n\t\tpublic class ItemController {\n\t\t\t@RequestMapping(\"/itemList.action\")\n\t\t\tpublic ModelAndView queryItemList() {\n\t\t\t\tList&lt;Item&gt; list = new ArrayList&lt;&gt;();\n\t\t\t\tlist.add(new Item(1, \"1åä¸º è£è€€8\", 2399, new Date(), \"è´¨é‡å¥½ï¼1\"));\n\t\t\t\tlist.add(new Item(2, \"2åä¸º è£è€€8\", 2399, new Date(), \"è´¨é‡å¥½ï¼2\"));\n\t\t\t\tlist.add(new Item(3, \"3åä¸º è£è€€8\", 2399, new Date(), \"è´¨é‡å¥½ï¼3\"));\n\t\t\t\tlist.add(new Item(4, \"4åä¸º è£è€€8\", 2399, new Date(), \"è´¨é‡å¥½ï¼4\"));\n\t\t\t\tlist.add(new Item(5, \"5åä¸º è£è€€8\", 2399, new Date(), \"è´¨é‡å¥½ï¼5\"));\n\t\t\t\tlist.add(new Item(6, \"6åä¸º è£è€€8\", 2399, new Date(), \"è´¨é‡å¥½ï¼6\"));\n\n\t\t\t\tModelAndView modelAndView = new ModelAndView();\n\t\t\t\tmodelAndView.addObject(\"list\", list);\n\t\t\t\tmodelAndView.setViewName(\"/WEB-INF/jsp/itemList.jsp\");\n\n\t\t\t\t//æˆ–è€…åƒä¸‹é¢è¿™ä¹ˆå†™\n\t\t\t\t// åˆ›å»ºModelAndViewï¼Œç”¨æ¥å­˜æ”¾æ•°æ®å’Œè§†å›¾\n\t\t\t\t//ModelAndView modelAndView = new ModelAndView();\n\t\t\t\t// è®¾ç½®æ•°æ®åˆ°æ¨¡å‹ä¸­\n\t\t\t\t//modelAndView.addObject(\"itemList\", list);\n\t\t\t\t// è®¾ç½®è§†å›¾jspï¼Œéœ€è¦è®¾ç½®è§†å›¾çš„ç‰©ç†åœ°å€\n\t\t\t\t// modelAndView.setViewName(\"/WEB-INF/jsp/itemList.jsp\");\n\t\t\t\t// é…ç½®å¥½è§†å›¾è§£æå™¨å‰ç¼€å’Œåç¼€ï¼Œè¿™é‡Œåªéœ€è¦è®¾ç½®é€»è¾‘è§†å›¾å°±å¯ä»¥äº†ã€‚\n\t\t\t\t// è§†å›¾è§£æå™¨æ ¹æ®å‰ç¼€+é€»è¾‘è§†å›¾å+åç¼€æ‹¼æ¥å‡ºæ¥ç‰©ç†è·¯å¾„\n\t\t\t\t//modelAndView.setViewName(\"itemList\");\n\t\t\t\t//return modelAndView;\n\n\t\t\t\treturn modelAndView;\n\t\t\t}\n\t\t}\n\tå¯åŠ¨é¡¹ç›®æµ‹è¯•\n\tæµè§ˆå™¨è®¿é—®åœ°å€http://127.0.0.1:8080/springmvc-first/itemList.action\n</code></pre></div><h1>6. springmvc é…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tç»„ä»¶æ‰«æå™¨(çœå»åœ¨springå®¹å™¨é…ç½®æ¯ä¸ªControllerç±»çš„ç¹ç)\n\tä½¿ç”¨&lt;context:component-scan&gt;è‡ªåŠ¨æ‰«ææ ‡è®°@Controllerçš„æ§åˆ¶å™¨ç±»ï¼Œ\n\tåœ¨springmvc.xmlé…ç½®æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹ï¼š\n\t&lt;!-- é…ç½®controlleræ‰«æåŒ…ï¼Œå¤šä¸ªåŒ…ä¹‹é—´ç”¨,åˆ†éš” --&gt;\n\t&lt;context:component-scan base-package=\"cn.test.springmvc\" /&gt;\n\t\n\tæ³¨è§£é©±åŠ¨ï¼ˆçœå»ç›´æ¥é…ç½®å¤„ç†å™¨æ˜ å°„å™¨å’Œå¤„ç†å™¨é€‚é…å™¨çš„éº»çƒ¦ï¼‰\n\tSpringMVCä½¿ç”¨&lt;mvc:annotation-driven&gt;\n\tè‡ªåŠ¨åŠ è½½RequestMappingHandlerMappingå’ŒRequestMappingHandlerAdapter\n\t&lt;!-- æ³¨è§£é©±åŠ¨ --&gt;\n\t&lt;mvc:annotation-driven /&gt;\n\t\n\tè§†å›¾è§£æå™¨\n\tè§†å›¾è§£æå™¨ä½¿ç”¨SpringMVCæ¡†æ¶é»˜è®¤çš„InternalResourceViewResolverï¼ˆï¼‰\n\tè¿™ä¸ªè§†å›¾è§£æå™¨æ”¯æŒJSPè§†å›¾è§£æ\n\tåœ¨springmvc.xmlé…ç½®æ–‡ä»¶ä¸­é…ç½®å¦‚ä¸‹ï¼š\n\t&lt;!-- Example: prefix=\"/WEB-INF/jsp/\",suffix=\".jsp\",viewname=\"test\" -&gt; \n\t\"/WEB-INF/jsp/test.jsp\" --&gt;\n\t&lt;!-- é…ç½®è§†å›¾è§£æå™¨ --&gt;\n\t&lt;bean class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n\t\t&lt;!-- é…ç½®é€»è¾‘è§†å›¾çš„å‰ç¼€ --&gt;\n\t\t&lt;property name=\"prefix\" value=\"/WEB-INF/jsp/\" /&gt;\n\t\t&lt;!-- é…ç½®é€»è¾‘è§†å›¾çš„åç¼€ --&gt;\n\t\t&lt;property name=\"suffix\" value=\".jsp\" /&gt;\n\t&lt;/bean&gt;\n\té€»è¾‘è§†å›¾åéœ€è¦åœ¨controllerä¸­è¿”å›ModelAndViewæŒ‡å®šï¼Œ\n\tæ¯”å¦‚é€»è¾‘è§†å›¾åä¸ºItemListï¼Œåˆ™æœ€ç»ˆè¿”å›çš„jspè§†å›¾åœ°å€:\n\tâ€œWEB-INF/jsp/itemList.jspâ€\n\tæœ€ç»ˆjspç‰©ç†åœ°å€ï¼šå‰ç¼€+é€»è¾‘è§†å›¾å+åç¼€\n</code></pre></div><h1>7. Handleré…ç½®</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å‚æ•°ç»‘å®šï¼ˆæ¥å—è¯·æ±‚å‚æ•°çš„æ–¹æ³•ï¼‰\nå¤„ç†å™¨å½¢å‚ä¸­æ·»åŠ å¦‚ä¸‹ç±»å‹çš„å‚æ•°å¤„ç†é€‚é…å™¨ä¼šé»˜è®¤è¯†åˆ«å¹¶è¿›è¡Œèµ‹å€¼ã€‚\nHttpServletRequest:é€šè¿‡requestå¯¹è±¡è·å–è¯·æ±‚ä¿¡æ¯public String editItem(HttpServletRequest request)\nHttpServletResponse:é€šè¿‡responseå¤„ç†å“åº”ä¿¡æ¯public String editItem(HttpServletResponse response)\nHttpSession:é€šè¿‡sessionå¯¹è±¡å¾—åˆ°sessionä¸­å­˜æ”¾çš„å¯¹è±¡public String editItem(HttpSession session)\nç®€å•æ•°æ®ç±»å‹(åŸºæœ¬æ•°æ®ç±»å‹ï¼ŒåŸºæœ¬ç±»å‹åŒ…è£…ç±»)å‚æ•°ç±»å‹æ¨èä½¿ç”¨åŒ…è£…æ•°æ®ç±»å‹ï¼Œå› ä¸ºåŸºç¡€æ•°æ®ç±»å‹ä¸å¯ä»¥ä¸ºnull\npublic String editItem(Model model,Integer id,Boolean status) è¯·æ±‚urlï¼šhttp://localhost:8080/xxx.action?id=2&amp;status=false\n\n@RequestParam:å¸¸ç”¨äºå¤„ç†ç®€å•ç±»å‹çš„ç»‘å®šã€‚\nvalueï¼šè¯·æ±‚å‚æ•°åå­—ï¼Œrequiredï¼šæ˜¯å¦å¿…é¡»ï¼Œé»˜è®¤æ˜¯trueã€defaultValueï¼šé»˜è®¤å€¼ï¼Œè¡¨ç¤ºå¦‚æœè¯·æ±‚ä¸­æ²¡æœ‰åŒåå‚æ•°æ—¶çš„é»˜è®¤å€¼\npublic String queryItemById(@RequestParam(value = \"itemId\", required = true, defaultValue = \"1\") Integer id)\n\nä½¿ç”¨pojoå¯¹è±¡æ¥æ”¶è¡¨å•æ•°æ®ï¼ˆæäº¤å†…å®¹å¾ˆå¤šçš„æ—¶å€™ï¼‰\nè¦æ±‚ï¼špojoå¯¹è±¡ä¸­çš„å±æ€§åå’Œè¡¨å•ä¸­inputçš„nameå±æ€§ä¸€è‡´\nå‰ç«¯ï¼šname=\"pojoå¯¹è±¡çš„å±æ€§å\" value=\"${pojo.å±æ€§å}\"\nåç«¯ï¼štest(pojo){}\npojoå®šä¹‰å¯¹åº”çš„å±æ€§å¹¶ç”Ÿæˆset/getæ–¹æ³•\nè¯·æ±‚çš„å‚æ•°åç§°å’Œpojoçš„å±æ€§åç§°ä¸€è‡´ï¼Œä¼šè‡ªåŠ¨å°†è¯·æ±‚å‚æ•°èµ‹å€¼ç»™pojoçš„å±æ€§ã€‚\næ³¨æ„ï¼šæäº¤çš„è¡¨å•ä¸­ä¸è¦æœ‰æ—¥æœŸç±»å‹çš„æ•°æ®ï¼Œå¦åˆ™ä¼šæŠ¥400é”™è¯¯ã€‚\nå¦‚æœæƒ³æäº¤æ—¥æœŸç±»å‹çš„æ•°æ®éœ€è¦ç”¨åˆ°åé¢çš„è‡ªå®šä¹‰å‚æ•°ç»‘å®šçš„å†…å®¹ã€‚\n\nä½¿ç”¨ç»‘å®šåŒ…è£…pojoï¼ˆå†…éƒ¨ç±»ï¼‰\nå‰ç«¯ï¼šname=\"å†…éƒ¨ç±».å†…éƒ¨å±æ€§å\" value=\"å¤–éƒ¨ç±».å†…éƒ¨ç±».å†…éƒ¨å±æ€§å\"\nåç«¯ï¼šå®šä¹‰pojoå†…éƒ¨ç±»\nå®šä¹‰å‚æ•°æ¥æ”¶\n@RequestMapping(\"/queryItem\")\n\tpublic String queryItem(QueryVo queryVo) {\n\tSystem.out.println(queryVo.getItem().getId());\n\tSystem.out.println(queryVo.getItem().getName());\n\treturn \"success\";\n}\n\nè‡ªå®šä¹‰å‚æ•°ç»‘å®šï¼ˆè‡ªå®šä¹‰æ—¥æœŸæ ¼å¼ï¼‰\n\tå¯ä»¥åœ¨springmvcå¤„ç†å™¨é€‚é…å™¨ä¸Šè‡ªå®šä¹‰è½¬æ¢å™¨Converterè¿›è¡Œå‚æ•°ç»‘å®šã€‚\n\tä¸€èˆ¬ä½¿ç”¨&lt;mvc:annotation-driven/&gt;æ³¨è§£é©±åŠ¨åŠ è½½å¤„ç†å™¨é€‚é…å™¨ï¼Œå¯ä»¥åœ¨æ­¤æ ‡ç­¾ä¸Šè¿›è¡Œé…ç½®ã€‚\n\tå‰ç«¯\n\t&lt;input type=\"text\" name=\"items.createtime\" value=\"&lt;fmt:formatDate value=\"${item.createtime}\" pattern=\"yyyy-MM-dd HH:mm:ss\"/&gt;\" /&gt;\n\tåç«¯è‡ªå®šä¹‰Converterï¼Œ\n\t//Converter&lt;S, T&gt;\n\t//S:source,éœ€è¦è½¬æ¢çš„æºçš„ç±»å‹\n\t//T:target,éœ€è¦è½¬æ¢çš„ç›®æ ‡ç±»å‹\n\tpublic class DateConverter implements Converter&lt;String, Date&gt; {\n\t\t@Override\n\t\tpublic Date convert(String source) {\n\t\t\ttry {\n\t\t\t\t// æŠŠå­—ç¬¦ä¸²è½¬æ¢ä¸ºæ—¥æœŸç±»å‹\n\t\t\t\tSimpleDateFormat simpleDateFormat = \n\t\t\t\tnew SimpleDateFormat(\"yyy-MM-dd HH:mm:ss\");\n\t\t\t\tDate date = simpleDateFormat.parse(source);\n\t\t\t\treturn date;\n\t\t\t} catch (ParseException e) {\n\t\t\t\te.printStackTrace();\n\t\t\t}\n\t\t\t// å¦‚æœè½¬æ¢å¼‚å¸¸åˆ™è¿”å›ç©º\n\t\t\treturn null;\n\t\t}\n\t}\n\tspringmvc.xmlé…ç½®Converter åŒæ—¶å¯ä»¥é…ç½®å¤šä¸ªçš„è½¬æ¢å™¨ã€‚\n\t&lt;!-- é…ç½®æ³¨è§£é©±åŠ¨ --&gt;\n\t&lt;!-- å¦‚æœé…ç½®æ­¤æ ‡ç­¾,å¯ä»¥ä¸ç”¨é…ç½®... --&gt;\n\t&lt;mvc:annotation-driven conversion-service=\"conversionService\" /&gt;\n\n\t&lt;!-- è½¬æ¢å™¨é…ç½® --&gt;\n\t&lt;bean id=\"conversionService\" class=\"org.springframework.format.support.FormattingConversionServiceFactoryBean\"&gt;\n\t\t&lt;property name=\"converters\"&gt;\n\t\t&lt;set&gt;\n\t\t\t&lt;bean class=\"cn.itcast.springmvc.converter.DateConverter\" /&gt;\n\t\t&lt;/set&gt;\n\t\t&lt;/property&gt;\n\t&lt;/bean&gt;\nç»‘å®šæ•°ç»„\n\tå‰ç«¯ &lt;c:forEach item=\"${itemList}\" var=\"item\"&gt;\n\t\t\t&lt;input type=\"checkbox\" name=\"ids\" value=\"${item.id}\"/&gt;\n\t\t\t&lt;input type=\"checkbox\" name=\"ids\" value=\"${item.id}\"/&gt;\n\t\t&lt;/c:forEach&gt;\n\tåç«¯ï¼špojoä¸­å®šä¹‰private integer[] ids;ç”Ÿæˆset/getæ–¹æ³•\n\tåŒ…è£…ç±»å‹ ç»‘å®šæ•°ç»„ç±»å‹ï¼Œå¯ä»¥ä½¿ç”¨ä¸¤ç§æ–¹å¼ï¼Œpojoçš„å±æ€§æ¥æ”¶å’Œç›´æ¥æ¥æ”¶\n\t@RequestMapping(\"queryItem\")\n\tpublic String queryItem(QueryVo queryVo, Integer[] ids) {\n\t\tSystem.out.println(queryVo.getItem().getId());\n\t\tSystem.out.println(queryVo.getIds().length);\n\t\tSystem.out.println(ids.length);\n\t\treturn \"success\";\n\t}\nç»‘å®šList\n\tåç«¯ï¼šåœ¨pojoä¸­å®šä¹‰private List&lt;Item&gt; itemList;ç”Ÿæˆset/getæ–¹æ³•\n\tå‰ç«¯é¡µé¢ï¼šnameå±æ€§å¿…é¡»æ˜¯listå±æ€§å+ä¸‹æ ‡+å…ƒç´ å±æ€§ã€‚\n\t&lt;c:forEach items=\"${itemList }\" var=\"item\" varStatus=\"s\"&gt;\n\t\t&lt;tr&gt;\n\t\t\t&lt;td&gt;&lt;input type=\"checkbox\" name=\"ids\" value=\"${item.id}\"/&gt;&lt;/td&gt;\n\t\t&lt;td&gt;\n\t\t\t&lt;input type=\"hidden\" name=\"itemList[${s.index}].id\" value=\"${item.id }\"/&gt;\n\t\t\t&lt;input type=\"text\" name=\"itemList[${s.index}].name\" value=\"${item.name }\"/&gt;\n\t\t&lt;/td&gt;\n\t\t&lt;/tr&gt;\n\t&lt;/c:forEach&gt;\n\t${current}\tå½“å‰è¿™æ¬¡è¿­ä»£çš„ï¼ˆé›†åˆä¸­çš„ï¼‰é¡¹\n\t${status.first}\tåˆ¤æ–­å½“å‰é¡¹æ˜¯å¦ä¸ºé›†åˆä¸­çš„ç¬¬ä¸€é¡¹ï¼Œè¿”å›å€¼ä¸ºtrueæˆ–false\n\t${status.last}\tåˆ¤æ–­å½“å‰é¡¹æ˜¯å¦ä¸ºé›†åˆä¸­çš„æœ€\n\tvarStatuså±æ€§å¸¸ç”¨å‚æ•°æ€»ç»“ä¸‹ï¼š\n\t${status.index}\tè¾“å‡ºè¡Œå·ï¼Œä»0å¼€å§‹ã€‚\n\t${status.count}\tè¾“å‡ºè¡Œå·ï¼Œä»1å¼€å§‹ã€‚\n\t${status.åä¸€é¡¹ï¼Œè¿”å›å€¼ä¸ºtrueæˆ–false\n\tbeginã€endã€stepåˆ†åˆ«è¡¨ç¤ºï¼šèµ·å§‹åºå·ï¼Œç»“æŸåºå·ï¼Œè·³è·ƒæ­¥ä¼ã€‚\n\tæ¥æ”¶Listç±»å‹çš„æ•°æ®å¿…é¡»æ˜¯pojoçš„å±æ€§ï¼Œå¦‚æœæ–¹æ³•çš„å½¢å‚ä¸ºArrayListç±»å‹æ— æ³•æ­£ç¡®æ¥æ”¶åˆ°æ•°æ®\næˆ‘ä»¬éœ€è¦ä»urlä¸Šè·å–å•†å“idï¼Œæ­¥éª¤å¦‚ä¸‹ï¼š\n\t1.@RequestMapping(\"item/{id}\")å£°æ˜è¯·æ±‚çš„url\n\t{xxx}å«åšå ä½ç¬¦ï¼Œè¯·æ±‚çš„URLå¯ä»¥æ˜¯â€œitem /1â€æˆ–â€œitem/2â€\n\t2.ä½¿ç”¨(@PathVariable() Integer id)è·å–urlä¸Šçš„æ•°æ®\t\n\t* ä½¿ç”¨RESTfulé£æ ¼å¼€å‘æ¥å£ï¼Œå®ç°æ ¹æ®idæŸ¥è¯¢å•†å“\n\t@RequestMapping(\"item/{id}\")\n\t@ResponseBody\n\tpublic Item queryItemById(@PathVariable() Integer id) {\n\t\tItem item = this.itemService.queryItemById(id);\n\t\treturn item;\n\t}\n\tå¦‚æœ@RequestMappingä¸­è¡¨ç¤ºä¸º\"item/{id}\"ï¼Œidå’Œå½¢å‚åç§°ä¸€è‡´ï¼Œ\n\t@PathVariableä¸ç”¨æŒ‡å®šåç§°ã€‚å¦‚æœä¸ä¸€è‡´ï¼Œä¾‹å¦‚\"item/{ItemId}\"\n\tåˆ™éœ€è¦æŒ‡å®šåç§°@PathVariable(\"itemId\")ã€‚\n\n\thttp://127.0.0.1/item/123?id=1\n\tæ³¨æ„ä¸¤ä¸ªåŒºåˆ«\n\t1.@PathVariableæ˜¯è·å–urlä¸Šæ•°æ®çš„ã€‚@RequestParamè·å–è¯·æ±‚å‚æ•°çš„ï¼ˆåŒ…æ‹¬postè¡¨å•æäº¤ï¼‰\n\t2.å¦‚æœåŠ ä¸Š@ResponseBodyæ³¨è§£ï¼Œå°±ä¸ä¼šèµ°è§†å›¾è§£æå™¨ï¼Œ\n\tä¸ä¼šè¿”å›é¡µé¢ï¼Œç›®å‰è¿”å›çš„jsonæ•°æ®ã€‚å¦‚æœä¸åŠ ï¼Œå°±èµ°è§†å›¾è§£æå™¨ï¼Œè¿”å›é¡µé¢\n\t@RequestMapping(\"/hello\")//æ¥æ”¶æ‰€æœ‰helloè·¯å¾„çš„è¯·æ±‚\n\t\tpublic String index(å‚æ•°åä¸æ¥æ”¶çš„å‚æ•°åä¸€è‡´) {\n\t\treturn \"Hello World\";\n\t\t}\n### æŒ‡å®šå‰ç«¯urlè¯·æ±‚å‚æ•°åç§°ä¸æ–¹æ³•åä¸€è‡´\n### é€šè¿‡HttpServletRequestæ¥è·å–å‰ç«¯é¡µé¢å‚æ•°\n### åˆ›å»ºä¸€ä¸ªJavaBeanå¯¹è±¡æ¥å°è£…è¡¨å•å‚æ•°æˆ–è€…æ˜¯è¯·æ±‚urlè·¯å¾„ä¸­çš„å‚æ•°\n### é€šè¿‡PathVariableæ³¨è§£æ¥ç»‘å®šè¯·æ±‚è·¯å¾„çš„å‚æ•°\n### é€šè¿‡RequestParamæ³¨è§£æ¥è·å–\n## springbootè¿”å›å‚æ•°\n\n### è¿”å›jspé¡µé¢ï¼ˆundertowä¸æ”¯æŒjspï¼‰\n\tå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå½“æˆ‘ä»¬ä½¿ç”¨Spring Boot 2.0 æƒ³è¦è¿”å›é¡µé¢è€Œä¸æ˜¯æä¾›jsonæˆ–è€…xmlæ•°æ®æ¥å£çš„æ—¶å€™ï¼Œ\n\t\tåˆ‡è®°ä¸èƒ½å†ä½¿ç”¨@RestControlleräº†,åªèƒ½ä½¿ç”¨@Controller.\n\n@RequestMappingï¼šå®šä¹‰ä¸åŒçš„å¤„ç†å™¨æ˜ å°„è§„åˆ™ï¼ŒURLè·¯å¾„æ˜ å°„\n\tæ·»åŠ åœ¨æ–¹æ³•ä¸Šé¢\n\t@RequestMapping(\"/item\"ï¼‰\n\tvalueçš„å€¼æ˜¯æ•°ç»„ï¼Œå¯ä»¥å°†å¤šä¸ªurlæ˜ å°„åˆ°åŒä¸€ä¸ªæ–¹æ³•\n\t@RequestMapping(value = { \"/itemList\", \"/itemListAll\" })\n\tpublic ModelAndView queryItemList() {\n\t\tList&lt;Item&gt; list = this.itemService.queryItemList();\n\t\tModelAndView mv = new ModelAndView(\"itemList\");\n\t\tmv.addObject(\"itemList\", list);\n\t\treturn mv;\n\t}\n\n\tæ·»åŠ åœ¨ç±»ä¸Šé¢ åœ¨classä¸Šæ·»åŠ @RequestMapping(url)æŒ‡å®šé€šç”¨è¯·æ±‚å‰ç¼€ï¼Œ \n\té™åˆ¶æ­¤ç±»ä¸‹çš„æ‰€æœ‰æ–¹æ³•è¯·æ±‚urlå¿…é¡»ä»¥è¯·æ±‚å‰ç¼€å¼€å¤´ï¼Œå¯ä»¥ä½¿ç”¨æ­¤æ–¹æ³•å¯¹urlè¿›è¡Œåˆ†ç±»ç®¡ç†\n\t@controller\n\t@RequestMapping(\"item\")\n\tpublic class ItemController{\n\t\t@RequestMapping(value = { \"itemList\", \"itemListAll\" })\n\t\tpublic ModelAndView queryItemList() {\n\t\t}\n\t}\n\tæ­¤æ—¶éœ€è¦è¿›å…¥queryItemList()æ–¹æ³•çš„è¯·æ±‚urlä¸ºï¼š\n\thttp://127.0.0.1:8080/springmvc-web2/item/itemList.action\n\tæˆ–è€…\n\thttp://127.0.0.1:8080/springmvc-web2/item/itemListAll.action\n\nè¯·æ±‚æ–¹æ³•é™å®š \n\té™å®šGETæ–¹æ³•\n\t@RequestMapping(method = RequestMethod.GET)å¦‚æœé€šè¿‡POSTè®¿é—®åˆ™æŠ¥é”™ï¼š\n\tHTTP Status 405 - Request method 'POST' not supported\n\t@RequestMapping(value = \"itemList\",method = RequestMethod.POST)\n\té™å®šPOSTæ–¹æ³•\n\t@RequestMapping(method = RequestMethod.POST)\n\tå¦‚æœé€šè¿‡GETè®¿é—®åˆ™æŠ¥é”™ï¼šHTTP Status 405 - Request method 'GET' not supported\n\t\n\tGETå’ŒPOSTéƒ½å¯ä»¥@RequestMapping(method = {RequestMethod.GET,RequestMethod.POST})\n\nControlleræ–¹æ³•è¿”å›å€¼\n\tè¿”å›ModelAndView\n\tcontrolleræ–¹æ³•ä¸­å®šä¹‰ModelAndViewå¯¹è±¡å¹¶è¿”å›ï¼Œå¯æ·»åŠ modelæ•°æ®ã€æŒ‡å®šview\n\t\n\tè¿”å›void\n\trequestè½¬å‘\n\trequest.getRequestDispatcher(\"é¡µé¢è·¯å¾„\").forward(request, response);\n\trequest.getRequestDispatcher(\"/WEB-INF/jsp/success.jsp\").forward(request, response);\n\tresponseé‡å®šå‘\n\tresponse.sendRedirect(\"url\")\n\tresponse.sendRedirect(\"/springmvc-web2/itemEdit.action\");\n\tresponseæŒ‡å®šå“åº”ç»“æœï¼Œä¾‹å¦‚å“åº”jsonæ•°æ®\n\tresponse.getWriter().print(\"{\\\"abc\\\":123}\");\n\t\n\tè¿”å›å­—ç¬¦ä¸²\n\té€»è¾‘è§†å›¾å\n\tcontrolleræ–¹æ³•è¿”å›å­—ç¬¦ä¸²å¯ä»¥æŒ‡å®šé€»è¾‘è§†å›¾åï¼Œé€šè¿‡è§†å›¾è§£æå™¨è§£æä¸ºç‰©ç†è§†å›¾åœ°å€ã€‚\n\t/WEB-INF/jsp/itemList.jsp\n\treturn \"itemList\";\n\tRedirecté‡å®šå‘\n\tContrlleræ–¹æ³•è¿”å›å­—ç¬¦ä¸²å¯ä»¥é‡å®šå‘åˆ°ä¸€ä¸ªurlåœ°å€,é‡å®šå‘åæµè§ˆå™¨åœ°å€æ å˜æ›´ä¸ºé‡å®šå‘çš„åœ°å€ï¼Œ\n\té‡å®šå‘ç›¸å½“äºæ‰§è¡Œäº†æ–°çš„requestå’Œresponseï¼Œæ‰€ä»¥ä¹‹å‰çš„è¯·æ±‚å‚æ•°éƒ½ä¼šä¸¢å¤±\n\tå¦‚æœè¦æŒ‡å®šè¯·æ±‚å‚æ•°ï¼Œéœ€è¦åœ¨é‡å®šå‘çš„urlåé¢æ·»åŠ  ?itemId=1 è¿™æ ·çš„è¯·æ±‚å‚æ•°\n\treturn \"redirect:/itemEdit.action?itemId=\" + item.getId();\n\tforwardè½¬å‘\n\tControlleræ–¹æ³•æ‰§è¡Œåç»§ç»­æ‰§è¡Œå¦ä¸€ä¸ªControlleræ–¹æ³•\n\tä¿®æ”¹å•†å“æˆåŠŸåï¼Œç»§ç»­æ‰§è¡Œå¦ä¸€ä¸ªæ–¹æ³•,ä½¿ç”¨è½¬å‘çš„æ–¹å¼å®ç°ã€‚è½¬å‘åæµè§ˆå™¨åœ°å€æ è¿˜æ˜¯åŸæ¥çš„è¯·æ±‚åœ°å€ï¼Œ\n\tè½¬å‘å¹¶æ²¡æœ‰æ‰§è¡Œæ–°çš„requestå’Œresponseï¼Œæ‰€ä»¥ä¹‹å‰çš„è¯·æ±‚å‚æ•°éƒ½å­˜åœ¨\n\treturn \"forward:/itemEdit.action\";\n\n\tModel/ModelMapï¼ˆè¿”å›å¤„ç†ç»“æœç»™é¡µé¢çš„æ–¹æ³•ï¼‰\n\tModel\n\té™¤äº†ModelAndViewä»¥å¤–ï¼Œè¿˜å¯ä»¥ä½¿ç”¨Modelæ¥å‘é¡µé¢ä¼ é€’æ•°æ®\n\tModelæ˜¯ä¸€ä¸ªæ¥å£ï¼Œåœ¨å‚æ•°é‡Œç›´æ¥å£°æ˜modelå³å¯\n\tå¦‚æœä½¿ç”¨Modelåˆ™å¯ä»¥ä¸ä½¿ç”¨ModelAndViewå¯¹è±¡ï¼Œ\n\tModelå¯¹è±¡å¯ä»¥å‘é¡µé¢ä¼ é€’æ•°æ®ï¼ŒViewå¯¹è±¡åˆ™å¯ä»¥ä½¿ç”¨Stringè¿”å›å€¼æ›¿ä»£ã€‚\n\tä¸ç®¡æ˜¯Modelè¿˜æ˜¯ModelAndViewï¼Œå…¶æœ¬è´¨éƒ½æ˜¯ä½¿ç”¨Requestå¯¹è±¡å‘jspä¼ é€’æ•°æ®ã€‚\n\t@RequestMapping(\"/itemEdit\")\n\tpublic String queryItemById(HttpServletRequest request, Model model) {\n\t\t// ModelAndView modelAndView = new ModelAndView();\n\t\t// modelAndView.addObject(\"item\", item);\n\t\t// è®¾ç½®é€»è¾‘è§†å›¾\n\t\t// modelAndView.setViewName(\"itemEdit\");\n\n\t\tmodel.addAttribute(\"item\", item);\n\t\treturn \"itemEdit\";\n\t}\n\tModelMap\n\tModelMapæ˜¯Modelæ¥å£çš„å®ç°ç±»ï¼Œä¹Ÿå¯ä»¥é€šè¿‡ModelMapå‘é¡µé¢ä¼ é€’æ•°æ®\n\tä½¿ç”¨Modelå’ŒModelMapçš„æ•ˆæœä¸€æ ·ï¼Œå¦‚æœç›´æ¥ä½¿ç”¨Modelï¼Œ\n\tspringmvcä¼šå®ä¾‹åŒ–ModelMapã€‚\n\t@RequestMapping(\"/itemEdit\")\n\tpublic String queryItemById(HttpServletRequest request, ModelMap model) {\n\t\tmodel.addAttribute(\"item\", item);\n\t\treturn \"itemEdit\";\n\t}\n</code></pre></div><h1>8. å¼‚å¸¸å¤„ç†å™¨</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/3687ac6947ed3a8f15d51.png\" alt=\"å¼‚å¸¸.png\" tabindex=\"0\"><figcaption>å¼‚å¸¸.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tç³»ç»Ÿçš„daoã€serviceã€controllerå‡ºç°éƒ½é€šè¿‡throws Exceptionå‘ä¸ŠæŠ›å‡ºï¼Œæœ€åç”±springmvcå‰ç«¯æ§åˆ¶å™¨äº¤ç”±å¼‚å¸¸å¤„ç†å™¨è¿›è¡Œå¼‚å¸¸å¤„ç†ï¼Œ\n\n\tè‡ªå®šä¹‰å¼‚å¸¸ç±»\n\tå¦‚æœcontrollerã€serviceã€daoæŠ›å‡ºæ­¤ç±»å¼‚å¸¸è¯´æ˜æ˜¯ç³»ç»Ÿé¢„æœŸå¤„ç†çš„å¼‚å¸¸ä¿¡æ¯ã€‚\n\tpublic class MyException extends Exception {\n\t\tprivate String message;\n\t\tpublic MyException() {\n\t\t\tsuper();\n\t\t}\n\t\tpublic MyException(String message) {\n\t\t\tsuper();\n\t\t\tthis.message = message;\n\t\t}\n\t\tpublic String getMessage() {\n\t\t\treturn message;\n\t\t}\n\t\tpublic void setMessage(String message) {\n\t\t\tthis.message = message;\n\t\t}\n\t}\n\tè‡ªå®šä¹‰å¼‚å¸¸å¤„ç†å™¨\n\tpublic class CustomHandleException implements HandlerExceptionResolver {\n\t\t@Override\n\t\tpublic ModelAndView resolveException(HttpServletRequest request, HttpServletResponse response, Object handler,Exception exception) {\n\t\t\tString msg;\n\t\t\tif (exception instanceof MyException) {\n\t\t\t\t// å¦‚æœæ˜¯è‡ªå®šä¹‰å¼‚å¸¸ï¼Œè¯»å–å¼‚å¸¸ä¿¡æ¯\n\t\t\t\tmsg = exception.getMessage();\n\t\t\t} else {\n\t\t\t\t// å¦‚æœæ˜¯è¿è¡Œæ—¶å¼‚å¸¸ï¼Œåˆ™å–é”™è¯¯å †æ ˆï¼Œä»å †æ ˆä¸­è·å–å¼‚å¸¸ä¿¡æ¯\n\t\t\t\tWriter out = new StringWriter();\n\t\t\t\tPrintWriter s = new PrintWriter(out);\n\t\t\t\texception.printStackTrace(s);\n\t\t\t\tmsg = out.toString();\n\t\t\t}\n\t\t\t// æŠŠé”™è¯¯ä¿¡æ¯å‘ç»™ç›¸å…³äººå‘˜,é‚®ä»¶,çŸ­ä¿¡ç­‰æ–¹å¼\n\t\t\t// è¿”å›é”™è¯¯é¡µé¢ï¼Œç»™ç”¨æˆ·å‹å¥½é¡µé¢æ˜¾ç¤ºé”™è¯¯ä¿¡æ¯\n\t\t\tModelAndView modelAndView = new ModelAndView();\n\t\t\tmodelAndView.addObject(\"msg\", msg);\n\t\t\tmodelAndView.setViewName(\"error\");\n\t\t\treturn modelAndView;\n\t\t}\n\t}\n\t\n\tåœ¨springmvc.xmlä¸­æ·»åŠ ï¼š\n\t&lt;!-- é…ç½®å…¨å±€å¼‚å¸¸å¤„ç†å™¨ --&gt;\n\t&lt;bean id=\"customHandleException\" class=\"cn.itcast.ssm.exception.CustomHandleException\"/&gt;\n\n\té”™è¯¯é¡µé¢\n\t&lt;%@ page language=\"java\" contentType=\"text/html; charset=UTF-8\"\n\t\tpageEncoding=\"UTF-8\"%&gt;\n\t\t&lt;!DOCTYPE html PUBLIC \"-//W3C//DTD HTML 4.01 Transitional//EN\" \"\n\t\thttp://www.w3.org/TR/html4/loose.dtd\"&gt;\n\t\t&lt;html&gt;\n\t&lt;head&gt;\n\t\t&lt;meta http-equiv=\"Content-Type\" content=\"text/html; charset=UTF-8\"&gt;\n\t\t&lt;title&gt;Insert title here&lt;/title&gt;\n\t&lt;/head&gt;\n\t&lt;body&gt;\n\t\t&lt;h1&gt;å¼‚å¸¸ä¿¡æ¯&lt;/h1&gt;&lt;br /&gt;\n\t\t&lt;h2&gt;${msg }&lt;/h2&gt;\n\t&lt;/body&gt;\n\t&lt;/html&gt;\n\tå¼‚å¸¸æµ‹è¯•\n\tä¿®æ”¹ItemControlleræ–¹æ³•â€œqueryItemListâ€ï¼ŒæŠ›å‡ºå¼‚å¸¸ï¼š\n\t@RequestMapping(value = { \"itemList\", \"itemListAll\" })\n\tpublic ModelAndView queryItemList() throws Exception {\n\t\t// è‡ªå®šä¹‰å¼‚å¸¸\n\t\tif (true) {\n\t\t\tthrow new MyException(\"è‡ªå®šä¹‰å¼‚å¸¸å‡ºç°äº†~\");\n\t\t}\n\t\t// è¿è¡Œæ—¶å¼‚å¸¸\n\t\tint a = 1 / 0;\n\t\t// æŸ¥è¯¢å•†å“æ•°æ®\n\t\tList&lt;Item&gt; list = this.itemService.queryItemList();\n\t\t// åˆ›å»ºModelAndView,è®¾ç½®é€»è¾‘è§†å›¾å\n\t\tModelAndView mv = new ModelAndView(\"itemList\");\n\t\t// æŠŠå•†å“æ•°æ®æ”¾åˆ°æ¨¡å‹ä¸­\n\t\tmv.addObject(\"itemList\", list);\n\t\treturn mv;\n\t}\n</code></pre></div><h1>9. ssmæ•´åˆæ€è·¯</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åˆ›å»ºæ•°æ®åº“å’Œè¡¨\nå¯¼å…¥çš„jaråŒ…\naopalliance-1.0.jar\nasm-3.3.1.jar\naspectjweaver-1.6.11.jar\ncglib-2.2.2.jar\ncommons-dbcp-1.2.2.jar\ncommons-logging-1.1.1.jar\ncommons-pool-1.3.jar\njavassist-3.17.1-GA.jar\njstl-1.2.jar\njunit-4.9.jar\nlog4j-1.2.17.jar\nlog4j-api-2.0-rc1.jar\nlog4j-core-2.0-rc1.jar\nmybatis-3.2.7.jar\nmybatis-spring-1.2.2.jar\nmysql-connector-java-5.1.7-bin.jar\nslf4j-api-1.7.5.jar\nslf4j-log4j12-1.7.5.jar\nspring-aop-4.1.3.RELEASE.jar\nspring-aspects-4.1.3.RELEASE.jar\nspring-beans-4.1.3.RELEASE.jar\nspring-context-4.1.3.RELEASE.jar\nspring-context-support-4.1.3.RELEASE.jar\nspring-core-4.1.3.RELEASE.jar\nspring-expression-4.1.3.RELEASE.jar\nspring-jdbc-4.1.3.RELEASE.jar\nspring-jms-4.1.3.RELEASE.jar\nspring-messaging-4.1.3.RELEASE.jar\nspring-tx-4.1.3.RELEASE.jar\nspring-web-4.1.3.RELEASE.jar\nspring-webmvc-4.1.3.RELEASE.jar\n\nåˆ›å»ºåŠ¨æ€webå·¥ç¨‹springmvc-web(2.5)\n\nåŠ å…¥sqlMapConfig.xmlé…ç½®æ–‡ä»¶\n\nåœ¨srcä¸‹åˆ›å»ºSqlMapConfig.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE configuration\nPUBLIC \"-//mybatis.org//DTD Config 3.0//EN\"\n\"http://mybatis.org/dtd/mybatis-3-config.dtd\"&gt;\n&lt;configuration&gt;\n&lt;/configuration&gt;\nåŠ å…¥UserMapper.xmlé…ç½®æ–‡ä»¶\napplicationContext-dao.xml\né…ç½®æ•°æ®æºã€é…ç½®SqlSessionFactoryã€mapperæ‰«æå™¨ã€‚\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\nxmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"\nhttp://www.springframework.org/schema/p\"\nxmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"\nhttp://www.springframework.org/schema/tx\"\nxmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxsi:schemaLocation=\"http://www.springframework.org/schema/beans \nhttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd\nhttp://www.springframework.org/schema/context \nhttp://www.springframework.org/schema/context/spring-context-4.0.xsd\nhttp://www.springframework.org/schema/aop \nhttp://www.springframework.org/schema/aop/spring-aop-4.0.xsd \nhttp://www.springframework.org/schema/tx \nhttp://www.springframework.org/schema/tx/spring-tx-4.0.xsd\nhttp://www.springframework.org/schema/util \nhttp://www.springframework.org/schema/util/spring-util-4.0.xsd\"&gt;\n&lt;!-- åŠ è½½é…ç½®æ–‡ä»¶ --&gt;\n\t&lt;context:property-placeholder location=\"classpath:db.properties\" /&gt;\n\t&lt;bean id=\"dataSource\" class=\"org.apache.commons.dbcp.BasicDataSource\" destroy-method=\"close\"&gt;\n\t\t&lt;property name=\"driverClassName\" value=\"${jdbc.driver}\" /&gt;\n\t\t&lt;property name=\"url\" value=\"${jdbc.url}\" /&gt;\n\t\t&lt;property name=\"username\" value=\"${jdbc.username}\" /&gt;\n\t\t&lt;property name=\"password\" value=\"${jdbc.password}\" /&gt;\n\t\t&lt;property name=\"maxActive\" value=\"10\" /&gt;\n\t\t&lt;property name=\"maxIdle\" value=\"5\" /&gt;\n\t&lt;/bean&gt;\n\t&lt;!-- é…ç½®SqlSessionFactory --&gt;\n\t&lt;bean id=\"sqlSessionFactory\" class=\"org.mybatis.spring.SqlSessionFactoryBean\"&gt;\n\t\t&lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n\t\t&lt;property name=\"configLocation\" value=\"classpath:mybatis/SqlMapConfig.xml\" /&gt;\n\t&lt;/bean&gt;\n\t&lt;!-- é…ç½®Mapperæ‰«æ --&gt;\n\t&lt;bean class=\"org.mybatis.spring.mapper.MapperScannerConfigurer\"&gt;\n\t\t&lt;!-- é…ç½®Mapperçš„æ¥å£æ‰€åœ¨çš„æ‰«æåŒ…ï¼Œ\n\t\tåŒæ—¶é»˜è®¤æ‰«æäº†åŒåŒ…ä¸‹çš„åŒç±»åçš„Mapper.xmlæ–‡ä»¶ mapperæ¥å£æ–¹å¼å¼€å‘ï¼Œ\n\t\tæ•´åˆåçš„springé»˜è®¤åŠ è½½ä¸æ¥å£åŒåŒ…ä¸‹ä¸æ¥å£åŒåçš„Mapperæ–‡ä»¶ï¼Œ\n\t\tè€Œdaoå¼€å‘å°±è¦æ‰‹åŠ¨é…ç½®mapperçš„ä½ç½®ï¼Œå¦‚æœæ²¡æ‰¾åˆ°å°±æŠ¥é”™ï¼Œ\n\t\tå¯ä»¥åœ¨sqlMapperConfig.xmlé…ç½®mapper resourcè§£å†³--&gt;\n\t\t&lt;property name=\"basePackage\" value=\"cn.itcast.ssm.mapper\" /&gt;\n\t&lt;/bean&gt;\n&lt;/beans&gt;\n\ndb.properties\napplicationContext-service.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n\txmlns:context=\"http://www.springframework.org/schema/context\" \n\txmlns:p=\"http://www.springframework.org/schema/p\"\n\txmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"\n\thttp://www.springframework.org/schema/tx\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd\n\thttp://www.springframework.org/schema/context \n\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd\n\thttp://www.springframework.org/schema/aop \n\thttp://www.springframework.org/schema/aop/spring-aop-4.0.xsd \n\thttp://www.springframework.org/schema/tx \n\thttp://www.springframework.org/schema/tx/spring-tx-4.0.xsd\n\thttp://www.springframework.org/schema/util \n\thttp://www.springframework.org/schema/util/spring-util-4.0.xsd\"&gt;\n&lt;!-- é…ç½®serviceæ‰«æ --&gt;\n\t&lt;context:component-scan base-package=\"cn.itcast.ssm.service\" /&gt;\n&lt;/beans&gt;\n\napplicationContext-trans.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n\txmlns:context=\"http://www.springframework.org/schema/context\" xmlns:p=\"\n\thttp://www.springframework.org/schema/p\"\n\txmlns:aop=\"http://www.springframework.org/schema/aop\" xmlns:tx=\"\n\thttp://www.springframework.org/schema/tx\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd\n\thttp://www.springframework.org/schema/context \n\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd\n\thttp://www.springframework.org/schema/aop \n\thttp://www.springframework.org/schema/aop/spring-aop-4.0.xsd \n\thttp://www.springframework.org/schema/tx \n\thttp://www.springframework.org/schema/tx/spring-tx-4.0.xsd\n\thttp://www.springframework.org/schema/util \n\thttp://www.springframework.org/schema/util/spring-util-4.0.xsd\"&gt;\n\t&lt;!-- äº‹åŠ¡ç®¡ç†å™¨ --&gt;\n\t&lt;bean id=\"transactionManager\"class=\"org.springframework.jdbc.datasource.DataSourceTransactionManager\"&gt;\n\t\t&lt;!-- æ•°æ®æº --&gt;\n\t\t&lt;property name=\"dataSource\" ref=\"dataSource\" /&gt;\n\t&lt;/bean&gt;\n\t&lt;!-- é€šçŸ¥ --&gt;\n\t&lt;tx:advice id=\"txAdvice\" transaction-manager=\"transactionManager\"&gt;\n\t\t&lt;tx:attributes&gt;\n\t\t\t&lt;tx:method name=\"find*\" propagation=\"SUPPORTS\" read-only=\"true\" /&gt;\n\t\t&lt;/tx:attributes&gt;\n\t&lt;/tx:advice&gt;\n\t&lt;aop:config&gt;\n\t\t&lt;aop:advisor advice-ref=\"txAdvice\" pointcut=\"execution(* cn.itcast.ssm.service.*.*(..))\" /&gt;\n\t&lt;/aop:config&gt;\n&lt;/beans&gt;\nspringmvc.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;beans xmlns=\"http://www.springframework.org/schema/beans\"\n\txmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\" xmlns:p=\"\n\thttp://www.springframework.org/schema/p\"\n\txmlns:context=\"http://www.springframework.org/schema/context\"\n\txmlns:mvc=\"http://www.springframework.org/schema/mvc\"\n\txsi:schemaLocation=\"http://www.springframework.org/schema/beans \n\thttp://www.springframework.org/schema/beans/spring-beans-4.0.xsd\n\thttp://www.springframework.org/schema/mvc\n\thttp://www.springframework.org/schema/mvc/spring-mvc-4.0.xsd\n\thttp://www.springframework.org/schema/context\n\thttp://www.springframework.org/schema/context/spring-context-4.0.xsd\"&gt;\n\t&lt;!-- é…ç½®controlleræ‰«æåŒ… --&gt;\n\t&lt;context:component-scan base-package=\"cn.itcast.ssm.controller\" /&gt;\n\t&lt;!-- æ³¨è§£é©±åŠ¨ --&gt;\n\t&lt;mvc:annotation-driven /&gt;\n\t&lt;!-- Example: prefix=\"/WEB-INF/jsp/\", suffix=\".jsp\", viewname=\"test\"-&gt; \n\t\"/WEB-INF/jsp/test.jsp\" --&gt;\n\t&lt;!-- é…ç½®è§†å›¾è§£æå™¨ --&gt;\n\t&lt;bean class=\"org.springframework.web.servlet.view.InternalResourceViewResolver\"&gt;\n\t\t&lt;!-- é…ç½®é€»è¾‘è§†å›¾çš„å‰ç¼€ --&gt;\n\t\t&lt;property name=\"prefix\" value=\"/WEB-INF/jsp/\" /&gt;\n\t\t&lt;!-- é…ç½®é€»è¾‘è§†å›¾çš„åç¼€ --&gt;\n\t\t&lt;property name=\"suffix\" value=\".jsp\" /&gt;\n\t&lt;/bean&gt;\n&lt;/beans&gt;\n\nweb.xml\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;web-app xmlns:xsi=\"http://www.w3.org/2001/XMLSchema-instance\"\nxmlns=\"http://java.sun.com/xml/ns/javaee\"\nxsi:schemaLocation=\"http://java.sun.com/xml/ns/javaee \nhttp://java.sun.com/xml/ns/javaee/web-app_2_5.xsd\"\nid=\"WebApp_ID\" version=\"2.5\"&gt;\n&lt;display-name&gt;springmvc-web&lt;/display-name&gt;\n&lt;welcome-file-list&gt;\n\t&lt;welcome-file&gt;index.html&lt;/welcome-file&gt;\n&lt;/welcome-file-list&gt;\n\n&lt;context-param&gt;\n\t&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n\t&lt;param-value&gt;classpath:spring/applicationContext*.xml&lt;/param-value&gt;\n&lt;/context-param&gt;\n\n&lt;listener&gt;\n\t&lt;listener-class&gt;org.springframework.web.context.ContextLoaderListener&lt;/listener-class&gt;\n&lt;/listener&gt;\n\n&lt;servlet&gt;\n\t&lt;servlet-name&gt;springmvc-web&lt;/servlet-name&gt;\n\t&lt;servlet-class&gt;org.springframework.web.servlet.DispatcherServlet&lt;/servlet-class&gt;\n\t&lt;init-param&gt;\n\t\t&lt;param-name&gt;contextConfigLocation&lt;/param-name&gt;\n\t\t&lt;param-value&gt;classpath:spring/springmvc.xml&lt;/param-value&gt;\n\t&lt;/init-param&gt;\n&lt;/servlet&gt;\n&lt;servlet-mapping&gt;\n\t&lt;servlet-name&gt;springmvc-web&lt;/servlet-name&gt;\n\t&lt;url-pattern&gt;*.action&lt;/url-pattern&gt;\n&lt;/servlet-mapping&gt;\n&lt;/web-app&gt;\n\nåŠ å…¥jspé¡µé¢\nitemList.jspå’ŒitemEdit.jspåˆ°å·¥ç¨‹ä¸­\n\nDAOå¼€å‘\nmapper.xmlé…ç½®æ–‡ä»¶\nä½¿ç”¨é€†å‘å·¥ç¨‹ï¼Œç”Ÿæˆé…ç½®æ–‡ä»¶ï¼Œå°†ç”Ÿæˆçš„åŒ…å¤åˆ¶ç²˜è´´åˆ°å·¥ç¨‹ä¸‹é¢\n\nItemServiceæ¥å£\npublic interface ItemService {\n\tList&lt;Item&gt; queryItemList();\n}\n\nItemServiceImplå®ç°ç±»\n@Service\npublic class ItemServiceImpl implements ItemService {\n\t@Autowired\n\tprivate ItemMapper itemMapper;\n\t@Override\n\tpublic List&lt;Item&gt; queryItemList() {\n\t\tList&lt;Item&gt; list = this.itemMapper.selectByExample(null);\n\t\treturn list;\n\t}\n}\nItemController\n@Controller\npublic class ItemController {\n\t@Autowired\n\tprivate ItemService itemService;\n\t@RequestMapping(\"/itemList\")\n\tpublic ModelAndView queryItemList() {\n\t\t// è·å–å•†å“æ•°æ®\n\t\tList&lt;Item&gt; list = this.itemService.queryItemList();\n\t\tModelAndView modelAndView = new ModelAndView();\n\t\tmodelAndView.addObject(\"itemList\", list);\n\t\tmodelAndView.setViewName(\"itemList\");\n\t\treturn modelAndView;\n\t}\n\n}\næµ‹è¯•è®¿é—®urlï¼šhttp://127.0.0.1:8080/springmvc-web/itemList.action\n</code></pre></div><h1>10. ä¸Šä¼ å›¾ç‰‡</h1>\n<ul>\n<li>é…ç½®è™šæ‹Ÿç›®å½•\n<ul>\n<li>åœ¨tomcatä¸Šé…ç½®å›¾ç‰‡è™šæ‹Ÿç›®å½•ï¼Œåœ¨tomcatä¸‹conf/server.xmlä¸­æ·»åŠ ï¼š</li>\n<li>\n</li>\n<li>è®¿é—®<a href=\"http://localhost:8080/pic%E5%8D%B3%E5%8F%AF%E8%AE%BF%E9%97%AED:%5Cdevelop%5Cupload%5Ctemp%E4%B8%8B%E7%9A%84%E5%9B%BE%E7%89%87%E3%80%82\" target=\"_blank\" rel=\"noopener noreferrer\">http://localhost:8080/picå³å¯è®¿é—®D:\\develop\\upload\\tempä¸‹çš„å›¾ç‰‡ã€‚</a></li>\n<li>ä¹Ÿå¯ä»¥é€šè¿‡eclipseé…ç½®ï¼Œå¦‚ä¸‹å›¾ï¼š</li>\n<li>å¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ°å­˜æ”¾å›¾ç‰‡çš„æ–‡ä»¶å¤¹ï¼Œä½¿ç”¨æµè§ˆå™¨è®¿é—®</li>\n<li>æµ‹è¯•æ•ˆæœï¼Œå¹¶å¤åˆ¶ä¸€å¼ å›¾ç‰‡åˆ°å­˜æ”¾å›¾ç‰‡çš„æ–‡ä»¶å¤¹</li>\n</ul>\n</li>\n</ul>\n<p><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/124e400cb9fbe7a173728.png\" alt=\"ä¸Šä¼ 1.png\"><br>\n<img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/9e2725e89c87cb0d490f1.png\" alt=\"ä¸Šä¼ 2.png\"></p>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>åŠ å…¥jaråŒ…\nå®ç°å›¾ç‰‡ä¸Šä¼ éœ€è¦åŠ å…¥çš„jaråŒ…ï¼Œfileuploadå’ŒioåŒ…ã€æ”¾åˆ°å·¥ç¨‹çš„libæ–‡ä»¶å¤¹ä¸­\nåœ¨springmvc.xmlä¸­é…ç½®æ–‡ä»¶ä¸Šä¼ è§£æå™¨\n&lt;!-- æ–‡ä»¶ä¸Šä¼ ,idå¿…é¡»è®¾ç½®ä¸ºmultipartResolver --&gt;\n&lt;bean id=\"multipartResolver\"class=\"org.springframework.web.multipart.commons.CommonsMultipartResolver\"&gt;\n\t!-- è®¾ç½®æ–‡ä»¶ä¸Šä¼ å¤§å° --&gt;\n\t&lt;property name=\"maxUploadSize\" value=\"5000000\" /&gt;\n&lt;/bean&gt;\n\njspé¡µé¢ä¿®æ”¹\nåœ¨å•†å“ä¿®æ”¹é¡µé¢ï¼Œæ‰“å¼€å›¾ç‰‡ä¸Šä¼ åŠŸèƒ½\n&lt;tr&gt;\n&lt;td&gt;å•†å“å›¾ç‰‡&lt;/td&gt;\n&lt;td&gt;\n&lt;!-- ä¸Šä¼ å›¾ç‰‡æ˜¯éœ€è¦æŒ‡å®šå±æ€§ enctype=\"multipart/form-data\" --&gt;\n&lt;form id=\"itemForm\" action=\"\" method=\"post\" enctype=\"multipart/form-data\"&gt;\n\t&lt;c:if test=\"${item.pic !=null}\"&gt;\n\t\t&lt;img src=\"/pic/${item.pic}\" width=100 height=100/&gt;&lt;br/&gt;\n\t&lt;/c:if&gt;\n\t&lt;input type=\"file\"  name=\"pictureFile\"/&gt; \n&lt;/form&gt;\n&lt;/td&gt;\n&lt;/tr&gt;\n\nå›¾ç‰‡ä¸Šä¼ æ–¹æ³•\n@RequestMapping(\"updateItem\")\npublic String updateItemById(Item item, MultipartFile pictureFile) throws Exception {\n\t// å›¾ç‰‡ä¸Šä¼ \n\t// è®¾ç½®å›¾ç‰‡åç§°ï¼Œä¸èƒ½é‡å¤ï¼Œå¯ä»¥ä½¿ç”¨uuid\n\tString picName = UUID.randomUUID().toString();\n\n\t// è·å–æ–‡ä»¶å\n\tString oriName = pictureFile.getOriginalFilename();\n\t// è·å–å›¾ç‰‡åç¼€\n\tString extName = oriName.substring(oriName.lastIndexOf(\".\"));\n\n\t// å¼€å§‹ä¸Šä¼ \n\tpictureFile.transferTo(new File(\"C:/upload/image/\" + picName + extName));\n\n\t// è®¾ç½®å›¾ç‰‡ååˆ°å•†å“ä¸­\n\titem.setPic(picName + extName);\n\t// </code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/be7cbdbe994b2221f35c0.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "struts2",
      "url": "https://javaguide.cn/backend/webframework/struts2.html",
      "id": "https://javaguide.cn/backend/webframework/struts2.html",
      "summary": "struts2 1. struts2è®¿é—®æµç¨‹&æ¶æ„&ä»‹ç» 2. æ­å»ºstruts2æ¡†æ¶ 3. strust.xmlé…ç½®è¯¦è§£ 4. Actionç”Ÿå‘½å‘¨æœŸ 5. ActionContextå†…å®¹ 6. è®¿é—®servletAPIæ–¹å¼ 7. jspè·å¾— 8. Actionæ¥æ”¶å‚æ•° 9. strutsã€hibernateçš„javassist-3.18.1-GA.j...",
      "content_html": "<p>struts2</p>\n<!--more-->\n<!-- TOC -->\n<ul>\n<li><a href=\"#1-struts2%E8%AE%BF%E9%97%AE%E6%B5%81%E7%A8%8B%E6%9E%B6%E6%9E%84%E4%BB%8B%E7%BB%8D\">1. struts2è®¿é—®æµç¨‹&amp;æ¶æ„&amp;ä»‹ç»</a></li>\n<li><a href=\"#2-%E6%90%AD%E5%BB%BAstruts2%E6%A1%86%E6%9E%B6\">2. æ­å»ºstruts2æ¡†æ¶</a></li>\n<li><a href=\"#3-strustxml%E9%85%8D%E7%BD%AE%E8%AF%A6%E8%A7%A3\">3. strust.xmlé…ç½®è¯¦è§£</a></li>\n<li><a href=\"#4-action%E7%94%9F%E5%91%BD%E5%91%A8%E6%9C%9F\">4. Actionç”Ÿå‘½å‘¨æœŸ</a></li>\n<li><a href=\"#5-actioncontext%E5%86%85%E5%AE%B9\">5. ActionContextå†…å®¹</a></li>\n<li><a href=\"#6-%E8%AE%BF%E9%97%AEservletapi%E6%96%B9%E5%BC%8F\">6. è®¿é—®servletAPIæ–¹å¼</a></li>\n<li><a href=\"#7-jsp%E8%8E%B7%E5%BE%97\">7. jspè·å¾—</a></li>\n<li><a href=\"#8-action%E6%8E%A5%E6%94%B6%E5%8F%82%E6%95%B0\">8. Actionæ¥æ”¶å‚æ•°</a></li>\n<li><a href=\"#9-strutshibernate%E7%9A%84javassist-3181-gajar%E5%8C%85%E9%87%8D%E5%A4%8D%E5%88%A0%E9%99%A4%E7%89%88%E6%9C%AC%E4%BD%8E%E7%9A%84\">9. strutsã€hibernateçš„javassist-3.18.1-GA.jaråŒ…é‡å¤,åˆ é™¤ç‰ˆæœ¬ä½çš„.</a></li>\n<li><a href=\"#10-ognl%E8%A1%A8%E8%BE%BE%E5%BC%8F\">10. OGNLè¡¨è¾¾å¼</a>\n<ul>\n<li><a href=\"#101-ognl%E4%B8%8Estruts2%E7%9A%84%E7%BB%93%E5%90%88%E5%8E%9F%E7%90%86\">10.1. OGNLä¸Struts2çš„ç»“åˆåŸç†</a></li>\n<li><a href=\"#102-struts2%E4%B8%8Eognl%E7%BB%93%E5%90%88%E4%BD%93%E7%8E%B0\">10.2. struts2ä¸ognlç»“åˆä½“ç°</a></li>\n</ul>\n</li>\n<li><a href=\"#11-%E8%87%AA%E5%AE%9A%E4%B9%89%E6%8B%A6%E6%88%AA%E5%99%A8\">11. è‡ªå®šä¹‰æ‹¦æˆªå™¨</a></li>\n<li><a href=\"#12-struts2%E6%A0%87%E7%AD%BE%E4%BA%86%E8%A7%A3\">12. struts2æ ‡ç­¾(äº†è§£)</a></li>\n<li><a href=\"#13-%E8%A1%A8%E7%8E%B0%E5%B1%82%E6%8A%BD%E5%8F%96\">13. è¡¨ç°å±‚æŠ½å–</a></li>\n<li><a href=\"#14-%E6%96%87%E4%BB%B6%E4%B8%8A%E4%BC%A0\">14. æ–‡ä»¶ä¸Šä¼ </a></li>\n<li><a href=\"#15-%E5%A4%84%E7%90%86ajax%E8%AF%B7%E6%B1%82\">15. å¤„ç†Ajaxè¯·æ±‚</a></li>\n</ul>\n<!-- /TOC -->\n<!--more-->\n<h1>1. struts2è®¿é—®æµç¨‹&amp;æ¶æ„&amp;ä»‹ç»</h1>\n<ul>\n<li>è‡ªåŠ¨å°è£…å‚æ•°ã€å‚æ•°æ ¡éªŒã€ç»“æœçš„å¤„ç†(è½¬å‘|é‡å®šå‘)ã€å›½é™…åŒ–ã€æ˜¾ç¤ºç­‰å¾…é¡µé¢ã€è¡¨å•çš„é˜²æ­¢é‡å¤æäº¤</li>\n<li>struts2å‰èº«ï¼šwebworkæ¡†æ¶(åŸºäºfilter)ä¸struts1(åŸºäºServlet)ä¸¤è€…æ— å…³.</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/61bb9c3bcf7d5ee3f1d3a.png\" alt=\"struts2.png\" tabindex=\"0\"><figcaption>struts2.png</figcaption></figure>\n<h1>2. æ­å»ºstruts2æ¡†æ¶</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¼åŒ…:web-content --&gt;web-INF--&gt;lib\nasm-3.3.jar\nasm-commons-3.3.jar\nasm-tree-3.3.jar\ncommons-fileupload-1.3.1.jar\ncommons-io-2.2.jar\ncommons-lang3-3.2.jar\nfreemarker-2.3.22.jar\njavassist-3.11.0.GA.jar\nlog4j-api-2.2.jar\nlog4j-core-2.2.jar\nognl-3.0.6.jar\nstruts2-core-2.3.24.jar\nxwork-core-2.3.24.jar\n\nåœ¨srcä¸‹é¢åˆ›å»º*Action.java\n\tæ–¹æ³•ä¸€ï¼šåˆ›å»ºä¸€ä¸ªç±».ä¸ç»§æ‰¿ä»»ä½•çˆ¶ç±».ä¸å®ç°ä»»ä½•æ¥å£.ä½¿struts2æ¡†æ¶çš„ä»£ç ä¾µå…¥æ€§æ›´ä½.\n\tpublic class DemoAction {\n\t\tpublic String hello(){\n\t\t\treturn \"success\";\n\t\t}\n\t}\n\tæ–¹æ³•äºŒï¼šå®ç°ä¸€ä¸ªæ¥å£Action\n\timport com.opensymphony.xwork2.Action;\n\t// é‡Œé¢æœ‰executeæ–¹æ³•,æä¾›actionæ–¹æ³•çš„è§„èŒƒ.\n\t// Actionæ¥å£é¢„ç½®äº†ä¸€äº›å­—ç¬¦ä¸².å¯ä»¥åœ¨è¿”å›ç»“æœæ—¶ä½¿ç”¨.ä¸ºäº†æ–¹ä¾¿\n\tpublic class DemoAction implements Action {\n\t\t@Override\n\t\tpublic String execute() throws Exception {\n\t\t\treturn null;\n\t\t}\n\t}\n\tæ–¹æ³•ä¸‰ï¼šç»§æ‰¿ActionSupport\n\t// å¸®æˆ‘ä»¬å®ç°äº† Validateable, ValidationAware, TextProvider, LocaleProvider .\n\t//å¦‚æœæˆ‘ä»¬éœ€è¦ç”¨åˆ°è¿™äº›æ¥å£çš„å®ç°æ—¶,ä¸éœ€è¦è‡ªå·±æ¥å®ç°äº†.\n\tpublic class Demo5Action  extends ActionSupport{}\n\nåˆ›å»ºstrutsä¸»é…ç½®æ–‡ä»¶åœ¨srcä¸‹åˆ›å»ºstruts.xml\nå¯¼å…¥çº¦æŸwindowèœå•--&gt; preference--&gt;cata åœ¨web App Libraries--struts2-core-2.3.24.jar--struts-2.3.dtd\n&lt;?xml version=\"1.0\" encoding=\"UTF-8\"?&gt;\n&lt;!DOCTYPE struts PUBLIC\n\"-//Apache Software Foundation//DTD Struts Configuration 2.3//EN\"\n\"http://struts.apache.org/dtds/struts-2.3.dtd\"&gt;\n&lt;struts&gt;\n\t\t&lt;!-- package:å°†Actioné…ç½®å°è£….å°±æ˜¯å¯ä»¥åœ¨Packageä¸­é…ç½®å¾ˆå¤šaction.\n\t\t\tnameå±æ€§: ç»™åŒ…èµ·ä¸ªåå­—,èµ·åˆ°æ ‡è¯†ä½œç”¨.éšä¾¿èµ·.ä¸èƒ½å…¶ä»–åŒ…åé‡å¤.\n\t\t\tnamespaceå±æ€§:ç»™actionçš„è®¿é—®è·¯å¾„ä¸­å®šä¹‰ä¸€ä¸ªå‘½åç©ºé—´\n\t\t\textendså±æ€§: ç»§æ‰¿ä¸€ä¸ª æŒ‡å®šåŒ…\n\t\t\tabstractå±æ€§:åŒ…æ˜¯å¦ä¸ºæŠ½è±¡çš„; æ ‡è¯†æ€§å±æ€§.æ ‡è¯†è¯¥åŒ…ä¸èƒ½ç‹¬ç«‹è¿è¡Œ.ä¸“é—¨è¢«ç»§æ‰¿ --&gt;\n\t&lt;package name=\"hello\" namespace=\"/hello\" extends=\"struts-default\"&gt;\n\t\t\t&lt;!-- actionå…ƒç´ :é…ç½®actionç±»\n\t\t\t\tnameå±æ€§: å†³å®šäº†Actionè®¿é—®èµ„æºå.\n\t\t\t\tclasså±æ€§: actionçš„å®Œæ•´ç±»å\n\t\t\t\tmethodå±æ€§: æŒ‡å®šè°ƒç”¨Actionä¸­çš„å“ªä¸ªæ–¹æ³•æ¥å¤„ç†è¯·æ±‚ --&gt;\n\t\t&lt;action name=\"TestAction\" class=\"com.junye.test.HelloAction\" method=\"fun\"&gt;\n\t\t\t&lt;!-- resultå…ƒç´ :ç»“æœé…ç½® \n\t\t\t\tnameå±æ€§: æ ‡è¯†ç»“æœå¤„ç†çš„åç§°.ä¸actionæ–¹æ³•çš„è¿”å›å€¼å¯¹åº”.\n\t\t\t\ttypeå±æ€§: æŒ‡å®šè°ƒç”¨å“ªä¸€ä¸ªresultç±»æ¥å¤„ç†ç»“æœ,é»˜è®¤ä½¿ç”¨è½¬å‘.\n\t\t\t\tæ ‡ç­¾ä½“:å¡«å†™é¡µé¢çš„ç›¸å¯¹è·¯å¾„--&gt;\n\t\t\t&lt;result name=\"success\"&gt;/hello.jsp&lt;/result&gt;\n\t\t&lt;/action&gt;\n\t&lt;/package&gt;\n\t&lt;!-- å¼•å…¥å…¶ä»–strutsé…ç½®æ–‡ä»¶ --&gt;\n\t&lt;include file=\"cn/junye/b_dynamic/struts.xml\"&gt;&lt;/include&gt;\n&lt;/struts&gt;\n\nå°†struts2æ ¸å¿ƒè¿‡æ»¤å™¨é…ç½®åˆ°web.xml,é…ç½®åœ¨æ¬¢è¿é¡µå‰é¢\n\t&lt;filter&gt;\n\t\t&lt;filter-name&gt;struts2&lt;/filter-name&gt;\n\t\t&lt;filter-class&gt;org.apache.struts2.dispatcher.ng.filter.StrutsPrepareAndExecuteFilter&lt;/filter-class&gt;\n\t&lt;/filter&gt;\n\t&lt;filter-mapping&gt;\n\t\t&lt;filter-name&gt;struts2&lt;/filter-name&gt;\n\t\t&lt;url-pattern&gt;/*&lt;/url-pattern&gt;\n\t&lt;/filter-mapping&gt;\n\t\næµ‹è¯•:è®¿é—®http://localhost:8080/mystruts/hello/TestAction\n</code></pre></div><h1>3. strust.xmlé…ç½®è¯¦è§£</h1>\n<ul>\n<li>struts2å¸¸é‡é…ç½®æ–¹å¼(å…ˆåä¹Ÿæ˜¯åŠ è½½é¡ºåº)ååŠ è½½è¦†ç›–</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ–¹å¼1:src/struts.xmlï¼ˆåªç”¨è¿™ä¸ªï¼‰\n\t&lt;constant name=\"struts.i18n.encoding\" value=\"UTF8\"&gt;&lt;/constant&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ–¹å¼2:åœ¨srcä¸‹åˆ›å»ºstruts.propertiesï¼š\nstruts.i18n.encoding=UTF8\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ–¹å¼3:åœ¨é¡¹ç›®çš„web.xmlä¸­\n&lt;context-param&gt;\n\t&lt;param-name&gt;struts.i18n.encoding&lt;/param-name&gt;\n\t&lt;param-value&gt;UTF-8&lt;/param-value&gt;\n&lt;/context-param&gt;\n</code></pre></div><ul>\n<li>struts2å¸¸é‡é…ç½®ä½ç½®App Libraries--struts2-core-2.3.24.jar--org.apache.struts2-default.properties;</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;!--å¸¸é‡é…ç½®struts.xml--&gt;\n&lt;!-- i18n:å›½é™…åŒ–. è§£å†³postæäº¤ä¹±ç  getæäº¤ï¼ŒæŒ‰ä»¥å‰çš„æ–¹å¼--&gt;\n&lt;constant name=\"struts.i18n.encoding\" value=\"UTF-8\"&gt;&lt;/constant&gt;\n&lt;!-- æŒ‡å®šè®¿é—®actionæ—¶çš„åç¼€å \nhttp://localhost:8080/struts2_day01/hello/HelloAction.ï¼Ÿé»˜è®¤.action å’Œ â€œç©ºâ€--&gt;\n&lt;constant name=\"struts.action.extension\" value=\"ï¼Ÿ\"&gt;&lt;/constant&gt;\n&lt;!-- æŒ‡å®šstruts2æ˜¯å¦ä»¥å¼€å‘æ¨¡å¼è¿è¡Œ1.çƒ­åŠ è½½ä¸»é…ç½®.(ä¸éœ€è¦é‡å¯å³å¯ç”Ÿæ•ˆ)2.æä¾›æ›´å¤šé”™è¯¯ä¿¡æ¯è¾“å‡º,æ–¹ä¾¿å¼€å‘æ—¶çš„è°ƒè¯•--&gt;\n&lt;constant name=\"struts.devMode\" value=\"true\"&gt;&lt;/constant&gt;\n</code></pre></div><ul>\n<li>struts2åŠ¨æ€æ–¹æ³•è°ƒç”¨(struts.xml)</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€šé…ç¬¦æ–¹å¼  ä½¿ç”¨{1} å–å‡ºç¬¬ä¸€ä¸ªæ˜Ÿå·é€šé…çš„å†…å®¹\n&lt;package name=\"dynamic\" namespace=\"/dynamic\" extends=\"struts-default\" &gt;\n\t&lt;action name=\"Demo1Action_*\" class=\"cn.b.Demo1Action\" method=\"{1}\" &gt;\n\t\t&lt;result name=\"success\" &gt;/{1}.jsp&lt;/result&gt;\n\t&lt;/action&gt;\n&lt;/package&gt;\t\nè®¿é—®http://localhost:8080/struts2_day01/dynamic/Demo1Action_find.actionè·³è½¬åˆ°find.jsp\n</code></pre></div><ul>\n<li>struts2ä¸­çš„é»˜è®¤é…ç½®</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;package name=\"default\" namespace=\"/default\" extends=\"struts-default\" &gt;\n\t&lt;!--ä¸å£°æ˜åˆ™é»˜è®¤è®¿é—®,ä¸ç®¡æ•´åˆæ²¡æ•´åˆ--&gt;\n\t&lt;!--&lt;default-class-ref class=\"com.opensymphony.xwork2.ActionSupport\" /&gt;--&gt;\n\t&lt;!-- å£°æ˜åæ‰¾ä¸åˆ°åŒ…ä¸‹çš„action,ä¼šä½¿ç”¨Demo2Actionä½œä¸ºé»˜è®¤actionå¤„ç†è¯·æ±‚ --&gt;\n\t&lt;default-action-ref name=\"Demo2Action\"&gt;&lt;/default-action-ref&gt;\n\t&lt;!-- methodå±æ€§:execute resultçš„nameå±æ€§:success   resultçš„typeå±æ€§:dispatcherè½¬å‘  --&gt;\n\t&lt;!-- classå±æ€§:com.opensymphony.xwork2.ActionSupport --&gt;\n\t&lt;action name=\"Demo2Action\"   &gt;\n\t\t&lt;result  &gt;/hello.jsp&lt;/result&gt;\n\t&lt;/action&gt;\n&lt;/package&gt;\nhttp://localhost:8080/struts2_day01/default/xxxx.action,é»˜è®¤è®¿é—®Demo2Action\n</code></pre></div><ul>\n<li>ç»“æœè·³è½¬æ–¹å¼struts.xmlä¸­ï¼ˆresultçš„typeå±æ€§ï¼‰ç”¨äºpost/getæäº¤</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tè½¬å‘\n\t&lt;action name=\"Demo1Action\" class=\"cn.a_result.Demo1Action\" method=\"execute\" &gt;\n\t\t&lt;result name=\"success\" type=\"dispatcher\" &gt;/hello.jsp&lt;/result&gt;\n\t&lt;/action&gt;\n\n\té‡å®šå‘åœ°å€æ å‘ç”Ÿå˜åŒ–\n\t&lt;action name=\"Demo2Action\" class=\"cn.a_result.Demo2Action\" method=\"execute\" &gt;\n\t\t&lt;result name=\"success\" type=\"redirect\" &gt;/hello.jsp&lt;/result&gt;\n\t&lt;/action&gt;\n\n\tè½¬å‘åˆ°Action\n\t&lt;action name=\"Demo3Action\" class=\"cn.a_result.Demo3Action\" method=\"execute\" &gt;\n\t\t&lt;result name=\"success\" type=\"chain\"&gt;\n\t\t\t&lt;param name=\"actionName\"&gt;Demo1Action&lt;/param&gt;\n\t\t\t&lt;param name=\"namespace\"&gt;/&lt;/param&gt;//è½¬å‘çš„å‘½åç©ºé—´\n\t\t&lt;/result&gt;\n\t&lt;/action&gt;\n\n\té‡å®šå‘åˆ°Action\n\t&lt;action name=\"Demo4Action\" class=\"cn.a_result.Demo4Action\" method=\"execute\" &gt;\n\t\t&lt;result  name=\"success\"  type=\"redirectAction\"&gt;\n\t\t\t&lt;param name=\"actionName\"&gt;Demo1Action&lt;/param&gt;\n\t\t\t&lt;param name=\"namespace\"&gt;/&lt;/param&gt;//è½¬å‘çš„å‘½åç©ºé—´\n\t\t&lt;/result&gt;\n\t&lt;/action&gt;\n</code></pre></div><ul>\n<li>å…¨å±€ç»“æœé›†</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;global-result&gt;\n\t&lt;result name=\"\" type=\"redirect\"&gt;/login.jsp&lt;/result&gt;\n&lt;/global-result&gt;\n&lt;global-exception-mappings&gt;\n\t&lt;exception-mapping result=\"error\" exception=\"java.lang.RuntimeException\"&gt;\n&lt;/exception-mapping&gt;\n&lt;/global-exception-mappings&gt;\n</code></pre></div><h1>4. Actionç”Ÿå‘½å‘¨æœŸ</h1>\n<ul>\n<li>1.æ¯æ¬¡è¯·æ±‚åˆ°æ¥æ—¶,éƒ½ä¼šåˆ›å»ºä¸€ä¸ªæ–°çš„Actionå®ä¾‹ã€</li>\n<li>2.Actionæ˜¯çº¿ç¨‹å®‰å…¨çš„.å¯ä»¥ä½¿ç”¨æˆå‘˜å˜é‡æ¥æ”¶å‚æ•°,servletçº¿ç¨‹ä¸å®‰å…¨</li>\n</ul>\n<h1>5. ActionContextå†…å®¹</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/01a9aa1dcc1e771d064fe.png\" alt=\"ActionContext.png\" tabindex=\"0\"><figcaption>ActionContext.png</figcaption></figure>\n<ul>\n<li>attråŸŸä»¥æœ€å°çš„åŸŸçš„mapçš„é”®ä¸ºå‡†ã€requeståŸŸå°±æ˜¯requestä¸­çš„ä¸€ä¸ªmap</li>\n</ul>\n<h1>6. è®¿é—®servletAPIæ–¹å¼</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€šè¿‡ActionContext,é€šè¿‡MapåŸæ¥çš„æ–¹æ³•é”®å€¼å¯¹è·å¾—,æˆ–è€…é€šè¿‡å°è£…å¥½çš„æ–¹æ³•è·å¾—\n//requeståŸŸ=&gt; map (ä¸æ¨è,ActionContextç”Ÿå‘½å‘¨æœŸå’Œrequestä¸€æ ·ï¼Œæ¨èActionContext)\n//ä¸æ¨èMap&lt;String, Object&gt; requestScope = (Map&lt;String, Object&gt;) ActionContext.getContext().get(\"request\");\nActionContext.getContext().put(\"name\", \"requestTom\");//æ¨è\n\n//sessionåŸŸ =&gt; map\nMap&lt;String, Object&gt; sessionScope = ActionContext.getContext().getSession();\nsessionScope.put(\"name\", \"sessionTom\");\né”€æ¯sessionï¼šActionContext.getContext().getSession().invalidate();\n\n//applicationåŸŸ=&gt;map\nMap&lt;String, Object&gt;applicationScope =ActionContext.getContext().getApplication(); \næ“ä½œmap put(\"name\",\"Tom\")ã€remove(\"name\", \"Tom\")ã€get(\"\",\"\");\n\n//è·å¾—åŸç”Ÿresponseçš„æ–¹æ³•(æ¨è)\nHttpServletResponse response = ServletActionContext.getResponse();\n\t\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€šè¿‡ServletActionContextï¼ˆä¸æ¨èï¼‰è·å¾—å„ç§åŸç”ŸåŸŸ\nHttpServletRequest request = ServletActionContext.getRequest();\nHttpSession session = request.getSession();\nHttpServletResponse response = ServletActionContext.getResponse();\nServletContext servletContext = ServletActionContext.getServletContext();\nPageContext pageContext = ServletActionContext.getPageContext();\næ“ä½œå„ç§åŸŸï¼šsetAttributeã€addAttributeã€getAttributeã€removeAttribute\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>é€šè¿‡å®ç°æ¥å£æ–¹å¼ï¼ˆç”¨æ‹¦æˆªå™¨å®Œæˆçš„ï¼‰\npublic class Demo7Action extends ActionSupport implements ServletRequestAware {\n\tprivate HttpServletRequest request;\n\tpublic String execute() throws Exception { \t\n\t\tSystem.out.println(\"åŸç”Ÿrequest:\"+request);\n\t\treturn SUCCESS;\n\t}\n\t@Override\n\tpublic void setServletRequest(HttpServletRequest request) {\n\t\tthis.request = request;\n\t}\t\n}\n</code></pre></div><h1>7. jspè·å¾—</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>pageï¼š${pageScope.name};\nrequest: ${requestScope.name}\nsession:${sessionScope.name}\napplication:${applicationScope.name}\n${name}æŒ‰é¡ºåºå–\n</code></pre></div><h1>8. Actionæ¥æ”¶å‚æ•°</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>è¡¨å•\n&lt;form action=\"${pageContext.request.contextPath}/Demo8Action\"&gt;\n\tç”¨æˆ·å:&lt;input type=\"text\" name=\"name\" /&gt;&lt;br&gt;\n\tå¹´é¾„:&lt;input type=\"text\" name=\"age\" /&gt;&lt;br&gt;\n\tç”Ÿæ—¥:&lt;input type=\"text\" name=\"birthday\" /&gt;&lt;br&gt;\n\t\t&lt;input type=\"submit\" value=\"æäº¤\" /&gt;\n&lt;/form&gt;\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å•ä¸ªç±»å‹ï¼šèƒ½è·å¾—radioå’Œchekboxçš„å€¼\nå±æ€§é©±åŠ¨è·å¾—å‚æ•°ï¼šset/getæ–¹æ³•\npublic class Demo8Action extends ActionSupport  {\n\t//å‡†å¤‡ä¸å‚æ•°é”®åç§°ç›¸åŒçš„å±æ€§\n\tprivate String name;\n\t//è‡ªåŠ¨ç±»å‹è½¬æ¢ åªèƒ½è½¬æ¢8å¤§åŸºæœ¬æ•°æ®ç±»å‹ä»¥åŠå¯¹åº”åŒ…è£…ç±»\n\tprivate Integer age;\n\t//æ”¯æŒç‰¹å®šç±»å‹å­—ç¬¦ä¸²è½¬æ¢ä¸ºDate ,ä¾‹å¦‚ yyyy-MM-ddï¼Œä¸€å®šè¦æœ‰set/getæ–¹æ³•\n\tprivate Date   birthday;\n\tpublic String execute() throws Exception { \n\t\tSystem.out.println(\"nameå‚æ•°å€¼:\"+name+\",ageå‚æ•°å€¼:\"+age+\",ç”Ÿæ—¥:\"+birthday);\n\t\treturn SUCCESS;\n\t}\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>å¯¹è±¡é©±åŠ¨è·å¾—å‚æ•°\npublic class Demo9Action extends ActionSupport  {\n\tprivate User user;//ç”Ÿæˆset/getæ–¹æ³•\n\tpublic String execute() throws Exception { \t\n\t\tSystem.out.println(user);\n\t\treturn SUCCESS;\n\t}\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>æ¨¡å‹é©±åŠ¨è·å¾—å‚æ•°å®ç°æ¥å£ï¼ˆåªèƒ½è¿”å›ä¸€ä¸ªå¯¹è±¡ï¼‰\npublic class Demo10Action extends ActionSupport implements ModelDriven&lt;User&gt; {\n\tprivate User user =new User();\n\tpublic String execute() throws Exception { \n\t\tSystem.out.println(user);\n\t\treturn SUCCESS;\n\t}\n\t@Override\n\tpublic User getModel() {\n\t\treturn user;\n\t}\n}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tâ‘£radioæˆ–checkboxçš„è·å–\n\tåªè¦å°†å±æ€§åå­—è®¾ç½®æˆå¯¹åº”çš„radioæˆ–checkboxçš„å€¼å³å¯è·å¾—æäº¤çš„å‚æ•°ï¼Œ\n\tradioæ˜¯å•ä¸ªå€¼ï¼Œè€Œcheckboxæ˜¯ä¸€è¡Œvalueï¼Œç©ºæ ¼valueçš„ç»“æ„ï¼Œæ‹†åˆ†å³å¯\n\tString[] split = hobby.split(\", \");\n\tfor(String s:split) {\n\t\tSystem.err.println(s);\n\t}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tâ‘¤é›†åˆç±»å‹å‚æ•°å°è£…\n\tlist:&lt;input type=\"text\" name=\"list\" /&gt;&lt;br&gt;//ä¸æŒ‡å®šç´¢å¼•åˆ™ä¸€ä¸ªä¸€ä¸ªå¡\n\tlist:&lt;input type=\"text\" name=\"list[3]\" /&gt;&lt;br&gt;//æŒ‡å®šå°±æ”¾åˆ°è§„å®šçš„åœ°æ–¹ï¼Œä¸æŒ‡å®šå°±null\n\tprivate List&lt;String&gt; list;setã€getæ–¹æ³•\n\tmap:&lt;input type=\"text\" name=\"map['haha']\" /&gt;&lt;br&gt;//å€¼å°è£…åˆ°é”®å€¼hahaä¸Š\n\tprivate Map&lt;String,String&gt; map;set/getæ–¹æ³•\n</code></pre></div><h1>9. strutsã€hibernateçš„javassist-3.18.1-GA.jaråŒ…é‡å¤,åˆ é™¤ç‰ˆæœ¬ä½çš„.</h1>\n<h1>10. OGNLè¡¨è¾¾å¼</h1>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/ade13c1a8726195fa2700.png\" alt=\"Ognl.png\" tabindex=\"0\"><figcaption>Ognl.png</figcaption></figure>\n<ul>\n<li>OGNL:å¯¹è±¡è§†å›¾å¯¼èˆªè¯­è¨€.  ${<a href=\"http://user.addr.name\" target=\"_blank\" rel=\"noopener noreferrer\">user.addr.name</a>} è¿™ç§å†™æ³•å°±å«å¯¹è±¡è§†å›¾å¯¼èˆª.</li>\n<li>OGNLä¸ä»…ä»…å¯ä»¥è§†å›¾å¯¼èˆª.æ”¯æŒæ¯”ELè¡¨è¾¾å¼ï¼ˆ11å†…ç½®å¯¹è±¡ï¼‰æ›´åŠ ä¸°å¯Œçš„åŠŸèƒ½.</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tä½¿ç”¨OGNLå‡†å¤‡å·¥ä½œï¼šstruts2 çš„åŒ…ä¸­å·²ç»åŒ…å«äº†ognl-3.0.6.jar.ä¸éœ€è¦å¯¼å…¥é¢å¤–çš„jaråŒ…\n\tä¿å­˜\n\trootå’Œcontextå¯ä»¥æ”¾å¤šä¸ªå¯¹è±¡æˆ–è€…mapï¼ŒæŸ¥æ‰¾æ—¶åªè¾“å…¥keyæˆ–è€…å±æ€§åå³å¯ã€‚ä»æ ˆé¡¶ä¸€ç›´æŸ¥åˆ°æ ˆä½ï¼Œé‡å¤çš„æŸ¥ä¸åˆ°ä¸¤ä¸ª\n\tUser rootUser = new User(\"tom\",18);\n\tMap&lt;String,User&gt; context = new HashMap&lt;String,User&gt;();\n\tcontext.put(\"user1\", new User(\"jack\",18));\n\tcontext.put(\"user2\", new User(\"rose\",22));\n\tOgnlContext oc = new OgnlContext();\n\toc.setRoot(rootUser);//å°†rootUserä½œä¸ºrootéƒ¨åˆ†\n\toc.setValues(context);//å°†contextè¿™ä¸ªMapä½œä¸ºContextéƒ¨åˆ†\n\n\tåŸºæœ¬å–å€¼\n\t//å–å‡ºrootä¸­userå¯¹è±¡çš„nameå±æ€§\n\tString name = (String) Ognl.getValue(\"name\", oc, oc.getRoot());\n\tInteger age = (Integer) Ognl.getValue(\"age\", oc, oc.getRoot());\n\t//å–å‡ºcontextä¸­é”®ä¸ºuser1å¯¹è±¡çš„nameå±æ€§#ä»£è¡¨context\n\tString name = (String) Ognl.getValue(\"#user1.name\", oc, oc.getRoot());\n\tString name2 = (String) Ognl.getValue(\"#user2.name\", oc, oc.getRoot());\n\tInteger age = (Integer) Ognl.getValue(\"#user2.age\", oc, oc.getRoot());\n\n\tèµ‹å€¼\n\t//å°†rootä¸­çš„userå¯¹è±¡çš„nameå±æ€§èµ‹å€¼\n\tOgnl.getValue(\"name='jerry'\", oc, oc.getRoot());\n\tString name2 = (String) Ognl.getValue(\"#user1.name='a',#user1.name\", oc, oc.getRoot());\n\n\tè°ƒç”¨æ–¹æ³•ï¼ˆèµ‹å€¼å’Œå–å€¼ï¼‰\n\t//è°ƒç”¨rootä¸­userå¯¹è±¡çš„setNameæ–¹æ³•\n\tOgnl.getValue(\"setName('lilei')\", oc, oc.getRoot());\n\tString name = (String) Ognl.getValue(\"getName()\", oc, oc.getRoot());\n\tString name2 = (String)Ognl.getValue(\"#user1.setName('lucy'),#user1.getName()\", oc, oc.getRoot());\n\n\tè°ƒç”¨é™æ€æ–¹æ³•ï¼ˆstaticï¼‰\n\tString name = (String) Ognl.getValue(\"@cn.a_ognl.HahaUtils@echo('hello å¼ºå‹‡!')\", oc, oc.getRoot());//@å®Œæ•´ç±»å\n\t//Double pi = (Double) Ognl.getValue(\"@java.lang.Math@PI\", oc, oc.getRoot());\n\tDouble pi = (Double) Ognl.getValue(\"@@PI\", oc, oc.getRoot())\n\n\tåˆ›å»ºå¯¹è±¡(List,Map)\n\tInteger size = (Integer) Ognl.getValue(\"{'tom','jerry','jack','rose'}.size()\", oc, oc.getRoot());\n\tString name = (String) Ognl.getValue(\"{'tom','jerry','jack','rose'}[0]\", oc, oc.getRoot());//tom\n\tString name2 = (String) Ognl.getValue(\"{'tom','jerry','jack','rose'}.get(1)\", oc, oc.getRoot());//jerry\n\tInteger size2 = (Integer) Ognl.getValue(\"#{'name':'tom','age':18}.size()\", oc, oc.getRoot());\n\tString name3  = (String) Ognl.getValue(\"#{'name':'tom','age':18}['name']\", oc, oc.getRoot());\n\tInteger age  = (Integer) Ognl.getValue(\"#{'name':'tom','age':18}.get('age')\", oc, oc.getRoot());\n</code></pre></div><h2>10.1. OGNLä¸Struts2çš„ç»“åˆåŸç†</h2>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/dee2b3721039564887ecb.png\" alt=\"Struts2ä¸Ognlç»“åˆåŸç†.png\" tabindex=\"0\"><figcaption>Struts2ä¸Ognlç»“åˆåŸç†.png</figcaption></figure>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tæ¥å£ValueStackå®ç°ç±»OgnlValueStackåŒ…æ‹¬rootå’Œcontextä¸¤éƒ¨åˆ†\n\tpublic class OgnlValueStack implements ValueStack{\n\t\tCompoundRoot root;//æ ˆç»“æ„\n\t\ttransient Map&lt;String,Object&gt; context;//mapç»“æ„\n\t}\n\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\t//rootæ˜¯æ ˆï¼Œæ˜¯ç”±ArrayListå’Œæ ˆæ–¹æ³•æ¨¡æ‹Ÿçš„ï¼Œè®¿é—®æ ˆä¸­å±æ€§çš„ç‰¹ç‚¹.ç”±ä¸Šåˆ°ä¸‹\n\t//é»˜è®¤æƒ…å†µä¸‹ï¼Œrootæ”¾ç½®çš„æ˜¯è¢«è®¿é—®çš„å½“å‰Aciton,è¯·æ±‚å‚æ•°è¢«å°è£…åˆ°Actionä¸­\n\tpublic class CompoundRoot extends ArrayList{\n\t\t//æ ˆæ–¹æ³•ï¼šå¼¹æ ˆ\n\t\tpublic Object pop(){\n\t\t\treturn remove(0);\n\t\t}\n\t\t//æ ˆæ–¹æ³•ï¼šå‹æ ˆ\n\t\tpublic Object push(Object o){\n\t\t\tadd(0,o);\n\t\t}\n\t}\n</code></pre></div><div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tæŸ¥çœ‹å€¼æ ˆä¸­ä¸¤éƒ¨åˆ†å†…å®¹\n\t(ä½¿ç”¨DEBUGæ ‡ç­¾)&lt;s:debug&gt;&lt;/s:debug&gt;\n</code></pre></div><h2>10.2. struts2ä¸ognlç»“åˆä½“ç°</h2>\n<ul>\n<li>å‚æ•°æ¥æ”¶</li>\n</ul>\n<figure><img src=\"https://290ff162.telegraph-image-eg9.pages.dev/file/01fe1aa30249f33864027.jpg\" alt=\"ognlä¸struts2ç»“åˆ.JPG\" tabindex=\"0\"><figcaption>ognlä¸struts2ç»“åˆ.JPG</figcaption></figure>\n<ul>\n<li>\n<p>è·å¾—ValueStackå’ŒActionContextçš„æ–¹æ³•</p>\n<ul>\n<li>è·å¾—ActionContextæ•°æ®ä¸­å¿ƒ:  ActionContext.getContext();</li>\n<li>è·å¾—å€¼æ ˆï¼šActionContext.getContext().getValueStack();</li>\n</ul>\n</li>\n<li>\n<p>ValueStackçš„APIï¼ˆå°‘ç”¨ï¼‰å¸¸ç”¨æ¥æ¥æ”¶è¡¨å•æ•°æ®ï¼Œå¾ˆå°‘å¾€è¿™rootæ”¾æ•°æ®</p>\n<ul>\n<li>å°†æ•°æ®objæ”¾å…¥å€¼æ ˆValueStackä¸­çš„Rootï¼šActionContext.getContext().getValueStack().push(obj);</li>\n<li>ä»å€¼æ ˆValueStackä¸­çš„Rootå°†æ•°æ®objå–å‡ºï¼šActionContext.getContext().getValueStack().pop();</li>\n<li>ä»å€¼æ ˆValueStackä¸­çš„Rootå°†æŸ¥è¯¢æ•°æ®Object findValue = ActionContext.getContext().getValueStack().findValue(\"name\");</li>\n<li>ä»å€¼æ ˆValueStackä¸­çš„Rootå°†ä¿®æ”¹æ•°æ®ActionContext.getContext().getValueStack().setParameter(\"name\", \"name\");</li>\n<li>é€šè¿‡é”®å€¼å¯¹keyå’Œvalueå°†æ•°æ®æ”¾å…¥å€¼æ ˆValueStackä¸­çš„Contextï¼šActionContext.getContext().put(key, value);</li>\n<li>é€šè¿‡é”®åæ‰¾åˆ°å€¼æ ˆValueStackä¸­çš„å¯¹è±¡Object object = ActionContext.getContext().get(\"name\");</li>\n<li>å¯ä»¥é€šè¿‡ELè¡¨è¾¾å¼${}ä»å€¼æ ˆä¸­çš„Contextå–æ•°æ®</li>\n</ul>\n</li>\n</ul>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>&lt;action name=\"Demo4Action\" class=\"cn.a_result.Demo4Action\" method=\"execute\" &gt;\n\t&lt;result  name=\"success\"  type=\"redirectAction\"&gt;\n\t\t&lt;param name=\"actionName\"&gt;Demo1Action&lt;/param&gt;\n\t\t&lt;param name=\"namespace\"&gt;/&lt;/param&gt;//è½¬å‘çš„å‘½åç©ºé—´\n\t\t&lt;param name=\"name\"&gt;{{name}}&lt;/param&gt;//è½¬å‘çš„å‘½åç©ºé—´\n\t&lt;/result&gt;\n&lt;/action&gt;\nè¯­æ³•:${ognlè¡¨è¾¾å¼}ï¼Œå°†æ•°æ®ä¼ é€’åˆ°ç»“æœé‚£è¾¹ï¼Œä¸è¿‡ä¸€èˆ¬éƒ½æ˜¯åœ¨åŸŸä¸­ä¼ é€’ï¼Œä¸å¸¸ç”¨\nå¯ä»¥é€šè¿‡ELè¡¨è¾¾å¼${}ä»å€¼æ ˆä¸­çš„Contextå–æ•°æ®\n\næ‰©å±•:requestå¯¹è±¡çš„getAttributeæ–¹æ³•\nåŒæ—¶ä¹Ÿæ˜¯ognlè¡¨è¾¾å¼è·å¾—å‚æ•°çš„æ–¹æ³•ï¼ˆæŸ¥æ‰¾é¡ºåºï¼‰\nrequest.getAttribute()\nåŸç”ŸrequeståŸŸ\næŸ¥æ‰¾valueStackçš„Rootéƒ¨åˆ†ï¼ˆæ ˆï¼‰\næŸ¥æ‰¾valueStackçš„contextéƒ¨åˆ†ï¼ˆActionContextï¼‰\n</code></pre></div><h1>11. è‡ªå®šä¹‰æ‹¦æˆªå™¨</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>//æ‹¦æˆªå™¨ç”Ÿå‘½å‘¨æœŸ:éšé¡¹ç›®çš„å¯åŠ¨è€Œåˆ›å»º,éšé¡¹ç›®å…³é—­è€Œé”€æ¯\nâ‘ æ‹¦æˆªå™¨åˆ›å»º\næ–¹æ³•ä¸€ï¼šå®ç°Interceptoræ¥å£å¹¶å®ç°å…¶ä¸‰ä¸ªæ–¹æ³•\npublic class MyInterceptor implements Intercepter{}\n\næ–¹æ³•äºŒï¼šç»§æ‰¿AbstractInterceptor\nç©ºå®ç°äº†init å’Œ destoryæ–¹æ³•. æˆ‘ä»¬å¦‚æœä¸éœ€è¦å®ç°è¿™ä¸¤ä¸ªæ–¹æ³•,å°±å¯ä»¥åªå®ç°interceptæ–¹æ³•\npublic class MyInterceptor2 extends AbstractInterceptor {}\n\næ–¹æ³•ä¸‰ï¼šç»§æ‰¿MethodFilterInterceptor æ–¹æ³•è¿‡æ»¤æ‹¦æˆªå™¨å¹¶å¤å†™doInterceptæ–¹æ³•\n//åŠŸèƒ½: å®šåˆ¶æ‹¦æˆªå™¨æ‹¦æˆªçš„æ–¹æ³•.  å®šåˆ¶å“ªäº›æ–¹æ³•éœ€è¦æ‹¦æˆªã€å“ªäº›æ–¹æ³•ä¸éœ€è¦æ‹¦æˆª\npublic class MyInterceptor3 extends MethodFilterInterceptor{\n\tdoIntercept(ActionInvocation invocation){\n\t\tæ”¾è¡Œ+å‰åå¤„ç†:\n\t\t//å‰å¤„ç†\n\t\tinvocation.invoke();\n\t\t//åå¤„ç†\n\t\t//ä¸å¤„ç†ç›´æ¥æ”¾è¡Œ\n\t\treturn invocation.invoke();\n\t\tä¸æ”¾è¡Œ,ç›´æ¥è·³è½¬åˆ°ä¸€ä¸ªç»“æœé¡µé¢\n\t\treturn \"success\";//ä¸æ‰§è¡Œåç»­çš„æ‹¦æˆªå™¨ä»¥åŠAction,ç›´æ¥äº¤ç»™Resultå¤„ç†ç»“æœ.è¿›è¡Œé¡µé¢è·³è½¬\n\t}\n}\n\nâ‘¡é…ç½®struts.xmlï¼Œåœ¨default.propertiesä¸­å¯ä»¥æ‰¾åˆ°ç›¸åº”çš„é»˜è®¤é…ç½®\næ³¨å†Œæ‹¦æˆªå™¨&lt;interceptor name=\"\" class=\"\"&gt;&lt;/interceptor&gt;\n\nå®šåˆ¶æ‹¦æˆªæ–¹æ³•å¹¶é…ç½®æ‹¦æˆªå™¨æ ˆ\n&lt;interceptor-stack name=\"myStack\"&gt;\n\t&lt;!-- è‡ªå®šä¹‰æ‹¦æˆªå™¨å¼•å…¥(å»ºè®®æ”¾åœ¨20ä¸ªæ‹¦æˆªå™¨ä¹‹å‰) --&gt;\n\t&lt;interceptor-ref name=\"myInter3\"&gt;\n\t\t&lt;!-- æŒ‡å®šå“ªäº›æ–¹æ³•ä¸æ‹¦æˆª\n\t\t&lt;param name=\"excludeMethods\"&gt;add,delete&lt;/param&gt; --&gt;\n\t\t&lt;!-- æŒ‡å®šå“ªäº›æ–¹æ³•éœ€è¦æ‹¦æˆª --&gt;\n\t\t&lt;param name=\"includeMethods\"&gt;add,delete&lt;/param&gt;\n\t&lt;/interceptor-ref&gt;\n\t&lt;!-- å¼•ç”¨é»˜è®¤çš„æ‹¦æˆªå™¨æ ˆ(20ä¸ª) --&gt;\n\t&lt;interceptor-ref name=\"defaultStack\"&gt;&lt;/interceptor-ref&gt;\n&lt;/interceptor-stack&gt;\n\næŒ‡å®šåŒ…ä¸­é»˜è®¤æ‹¦æˆªå™¨æ ˆ&lt;default-interceptor-ref name=\"myStack\"&gt;&lt;/default-interceptor-ref&gt;\n\nActionæŒ‡å®šæ‹¦æˆªå™¨\n&lt;action name=\"Demo1Action_*\" class=\"cn.interceptor.Demo1Action\" method=\"{1}\" &gt;\n\t&lt;!-- ä¸ºActionå•ç‹¬æŒ‡å®šèµ°å“ªä¸ªæ‹¦æˆªå™¨(æ ˆ) \n\t&lt;interceptor-ref name=\"myStack\"&gt;&lt;/interceptor-ref&gt;--&gt;\n\t&lt;result name=\"success\" type=\"dispatcher\" &gt;/index.jsp&lt;/result&gt;\n&lt;/action&gt;\n</code></pre></div><h1>12. struts2æ ‡ç­¾(äº†è§£)</h1>\n<div class=\"language-text\" data-ext=\"text\" data-title=\"text\"><pre class=\"language-text\"><code>\tæ§åˆ¶æ ‡ç­¾\n\téå†æ ‡ç­¾ iterator \n\t&lt;s:iterator value=\"#list\" &gt;\n\t\t&lt;s:property /&gt;&lt;br&gt;\n\t&lt;/s:iterator&gt;\n\n\t&lt;s:iterator value=\"#list\" var=\"name\" &gt;\n\t\t&lt;s:property value=\"#name\" /&gt;&lt;br&gt;\n\t&lt;/s:iterator&gt;\n\n\t&lt;s:iterator begin=\"1\" end=\"100\" step=\"1\"  &gt;\n\t\t&lt;s:property /&gt;\n\t&lt;/s:iterator&gt;\n\n\tifæ ‡ç­¾\n\t&lt;s:if test=\"#list.size()==4\"&gt;\n\t\tlisté•¿åº¦ä¸º4!\n\t&lt;/s:if&gt;\n\t&lt;s:elseif test=\"#list.size()==3\"&gt;\n\t\tlisté•¿åº¦ä¸º3!\n\t&lt;/s:elseif&gt;\n\t&lt;s:else&gt;\n\t\tlistä¸3ä¸4!\n\t&lt;/s:else&gt;\n\tåˆ¤æ–­booleanå€¼ä¸è¦è‡ªå·±ç”¨==trueåˆ¤æ–­\n\n\tæ•°æ®æ ‡ç­¾\n\t&lt;!--property é…åˆognlè¡¨è¾¾å¼é¡µé¢å–å€¼,Actionæ²¡æœ‰è¿”å›æ•°æ®æ—¶æ²¡æœ‰å€¼--&gt;\n\t&lt;s:property value=\"#list.size()\" /&gt;\n\t&lt;!--è·å¾—sessionä¸­çš„å€¼ï¼Œå¸¸ç”¨äºè¡¨è¾¾ç™»å½•ç”¨æˆ·ä¿¡æ¯--&gt;\n\t&lt;s:property value=\"#session.user.name\" /&gt;\n\n\tè¡¨å•æ ‡ç­¾\n\t&lt;!-- å¥½å¤„1: å†…ç½®äº†ä¸€å¥—æ ·å¼.  - å¥½å¤„2: è‡ªåŠ¨å›æ˜¾,æ ¹æ®æ ˆä¸­çš„å±æ€§  --&gt;\n\t&lt;!-- theme:æŒ‡å®šè¡¨å•çš„ä¸»é¢˜ï¼Œå°±æ˜¯è¡¨å•çš„styleï¼Œxhtml:é»˜è®¤ï¼Œsimple:æ²¡æœ‰ä¸»é¢˜--&gt;\n\t&lt;s:form action=\"Demo3Action\" namespace=\"/\" theme=\"xhtml\" &gt;\n\t\t&lt;s:textfield name=\"name\" label=\"ç”¨æˆ·å\"  &gt;&lt;/s:textfield&gt;\n\t\t&lt;s:password name=\"password\" label=\"å¯†ç \" &gt;&lt;/s:password&gt;\n\t\t&lt;s:radio list=\"{'ç”·','å¥³'}\" name=\"gender\" label=\"æ€§åˆ«\" &gt;&lt;/s:radio&gt;\n\t\t&lt;s:radio list=\"#{1:'ç”·',0:'å¥³'}\" name=\"gender\" label=\"æ€§åˆ«\" &gt;&lt;/s:radio&gt;\n\t\t&lt;s:checkboxlist list=\"#{2:'æŠ½çƒŸ',1:'å–é…’',0:'çƒ«å¤´'}\" name=\"habits\" label=\"çˆ±å¥½\" &gt;&lt;/s:checkboxlist&gt;\n\t\t&lt;s:select list=\"#{2:'å¤§ä¸“',1:'æœ¬ç§‘',0:'ç¡•å£«'}\" headerKey=\"\" headerValue=\"</code></pre></div>",
      "image": "https://290ff162.telegraph-image-eg9.pages.dev/file/61bb9c3bcf7d5ee3f1d3a.png",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2024-12-07T01:56:33.000Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "APISIX",
      "url": "https://javaguide.cn/backend/apigateway/apisix.html",
      "id": "https://javaguide.cn/backend/apigateway/apisix.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.790Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Kong",
      "url": "https://javaguide.cn/backend/apigateway/kong.html",
      "id": "https://javaguide.cn/backend/apigateway/kong.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.790Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Soul",
      "url": "https://javaguide.cn/backend/apigateway/soul.html",
      "id": "https://javaguide.cn/backend/apigateway/soul.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.790Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Spring Cloud Gateway",
      "url": "https://javaguide.cn/backend/apigateway/springcloudgateway.html",
      "id": "https://javaguide.cn/backend/apigateway/springcloudgateway.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.790Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Zuul",
      "url": "https://javaguide.cn/backend/apigateway/zuul.html",
      "id": "https://javaguide.cn/backend/apigateway/zuul.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.790Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Apollo",
      "url": "https://javaguide.cn/backend/configcenter/apollo.html",
      "id": "https://javaguide.cn/backend/configcenter/apollo.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.790Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Disconf",
      "url": "https://javaguide.cn/backend/configcenter/disconf.html",
      "id": "https://javaguide.cn/backend/configcenter/disconf.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.791Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Nacos",
      "url": "https://javaguide.cn/backend/configcenter/nacos.html",
      "id": "https://javaguide.cn/backend/configcenter/nacos.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.791Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    },
    {
      "title": "Spring Cloud Config",
      "url": "https://javaguide.cn/backend/configcenter/springcloudconfig.html",
      "id": "https://javaguide.cn/backend/configcenter/springcloudconfig.html",
      "content_html": "",
      "date_published": "2023-01-01T00:00:00.000Z",
      "date_modified": "2025-08-04T13:34:31.791Z",
      "authors": [],
      "tags": [
        "åç«¯"
      ]
    }
  ]
}